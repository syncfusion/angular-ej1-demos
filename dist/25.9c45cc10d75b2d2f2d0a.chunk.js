webpackJsonp([25],{1012:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.getGanttData=function(){return[{taskID:1,taskName:"Project Schedule",startDate:"02/06/2017",endDate:"03/10/2017",subtasks:[{taskID:2,taskName:"Planning",startDate:"02/06/2017",endDate:"02/10/2017",subtasks:[{taskID:3,taskName:"Plan timeline",startDate:"02/06/2017",endDate:"02/10/2017",baselinestartDate:"02/06/2017",baselineendDate:"02/10/2017",duration:5,progress:"100",resourceId:[1]},{taskID:4,taskName:"Plan budget",startDate:"02/06/2017",endDate:"02/10/2017",baselinestartDate:"02/06/2017",baselineendDate:"02/10/2017",duration:5,progress:"100",resourceId:[1]},{taskID:5,taskName:"Allocate resources",startDate:"02/06/2017",endDate:"02/10/2017",baselinestartDate:"02/06/2017",baselineendDate:"02/10/2017",duration:5,progress:"100",resourceId:[1]},{taskID:6,taskName:"Planning complete",startDate:"02/10/2017",endDate:"02/10/2017",baselinestartDate:"02/10/2017",baselineendDate:"02/10/2017",duration:0,predecessor:"3FS,4FS,5FS"}]},{taskID:7,taskName:"Design",startDate:"02/13/2017",endDate:"02/17/2017",subtasks:[{taskID:8,taskName:"Software Specification",startDate:"02/13/2017",endDate:"02/15/2017",baselinestartDate:"02/13/2017",baselineendDate:"02/15/2017",duration:3,progress:"60",predecessor:"6FS",resourceId:[2]},{taskID:9,taskName:"Develop prototype",startDate:"02/13/2017",endDate:"02/15/2017",baselinestartDate:"02/13/2017",baselineendDate:"02/15/2017",duration:3,progress:"100",predecessor:"6FS",resourceId:[3]},{taskID:10,taskName:"Get approval from customer",startDate:"02/13/2017",endDate:"02/17/2017",baselinestartDate:"02/13/2017",baselineendDate:"02/17/2017",duration:2,progress:"100",predecessor:"9FS",resourceId:[1]},{taskID:11,taskName:"Design complete",startDate:"02/17/2017",endDate:"02/17/2017",baselinestartDate:"02/17/2017",baselineendDate:"02/17/2017",duration:0,predecessor:"10FS"}]},{taskID:12,taskName:"Implementation Phase",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:13,taskName:"Phase 1",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:14,taskName:"Implementation Module 1",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:15,taskName:"Development Task 1",startDate:"02/20/2017",endDate:"02/25/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",predecessor:"11FS",resourceId:[3]},{taskID:16,taskName:"Development Task 2",startDate:"02/20/2017",endDate:"02/25/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",predecessor:"11FS",resourceId:[3]},{taskID:17,taskName:"Testing",startDate:"02/23/2017",endDate:"02/24/2017",baselinestartDate:"02/23/2017",baselineendDate:"02/24/2017",duration:2,progress:"0",predecessor:"15FS,16FS",resourceId:[4]},{taskID:18,taskName:"Bug fix",startDate:"02/27/2017",endDate:"03/03/2017",baselinestartDate:"02/27/2017",baselineendDate:"03/03/2017",duration:2,progress:"0",predecessor:"17FS",resourceId:[3]},{taskID:19,taskName:"Customer review meeting",startDate:"03/01/2017",endDate:"03/02/2017",baselinestartDate:"03/01/2017",baselineendDate:"03/02/2017",duration:2,progress:"0",predecessor:"18FS",resourceId:[1]},{taskID:20,taskName:"Phase 1 complete",startDate:"03/02/2017",endDate:"03/02/2017",baselinestartDate:"03/02/2017",baselineendDate:"03/02/2017",duration:0,predecessor:"19FS"}]}]},{taskID:21,taskName:"Phase 2",startDate:"02/20/2017",endDate:"03/03/2017",subtasks:[{taskID:22,taskName:"Implementation Module 2",startDate:"02/20/2017",endDate:"03/03/2017",subtasks:[{taskID:23,taskName:"Development Task 1",baselinestartDate:"02/20/2017",endDate:"02/23/2017",startDate:"02/20/2017",baselineendDate:"02/23/2017",duration:4,progress:"50",resourceId:[3]},{taskID:24,taskName:"Development Task 2",startDate:"02/20/2017",endDate:"02/23/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/23/2017",duration:4,progress:"50",resourceId:[3]},{taskID:25,taskName:"Testing",startDate:"02/24/2017",endDate:"02/27/2017",baselinestartDate:"02/24/2017",baselineendDate:"02/27/2017",duration:2,progress:"0",predecessor:"23FS,24FS",resourceId:[4]},{taskID:26,taskName:"Bug fix",startDate:"03/03/2017",endDate:"03/01/2017",baselinestartDate:"03/03/2017",baselineendDate:"03/01/2017",duration:2,progress:"0",predecessor:"25FS",resourceId:[3]},{taskID:27,taskName:"Customer review meeting",startDate:"03/02/2017",endDate:"03/03/2017",baselinestartDate:"03/02/2017",baselineendDate:"03/03/2017",duration:2,progress:"0",predecessor:"26FS",resourceId:[1]},{taskID:28,taskName:"Phase 2 complete",startDate:"03/03/2017",endDate:"03/03/2017",baselinestartDate:"03/03/2017",baselineendDate:"03/03/2017",duration:0,predecessor:"27FS"}]}]},{taskID:29,taskName:"Phase 3",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:30,taskName:"Implementation Module 3",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:31,taskName:"Development Task 1",baselinestartDate:"02/20/2017",endDate:"02/25/2017",startDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",resourceId:[3]},{taskID:32,taskName:"Development Task 2",startDate:"02/20/2017",endDate:"02/25/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",resourceId:[3]},{taskID:33,taskName:"Testing",startDate:"02/23/2017",endDate:"02/24/2017",baselinestartDate:"02/23/2017",baselineendDate:"02/24/2017",duration:2,progress:"0",predecessor:"31FS,32FS",resourceId:[4]},{taskID:34,taskName:"Bug fix",startDate:"02/27/2017",endDate:"03/03/2017",baselinestartDate:"02/27/2017",baselineendDate:"03/03/2017",duration:2,progress:"0",predecessor:"33FS",resourceId:[3]},{taskID:35,taskName:"Customer review meeting",startDate:"03/01/2017",endDate:"03/02/2017",baselinestartDate:"03/01/2017",baselineendDate:"03/02/2017",duration:2,progress:"0",predecessor:"34FS",resourceId:[1]},{taskID:36,taskName:"Phase 3 complete",startDate:"03/02/2017",endDate:"03/02/2017",baselinestartDate:"03/02/2017",baselineendDate:"03/02/2017",duration:0,predecessor:"35FS"}]}]}]},{taskID:37,taskName:"Integration",startDate:"03/06/2017",endDate:"03/08/2017",baselinestartDate:"03/03/2017",baselineendDate:"03/05/2017",duration:2,progress:"0",predecessor:"20FS,28FS,36FS",resourceId:[3]},{taskID:38,taskName:"Final Testing",startDate:"03/09/2017",endDate:"03/10/2017",baselinestartDate:"03/06/2017",baselineendDate:"03/10/2017",duration:2,progress:"0",predecessor:"37FS",resourceId:[4]},{taskID:39,taskName:"Final Delivery",startDate:"03/10/2017",endDate:"03/10/2017",baselinestartDate:"03/10/2017",baselineendDate:"03/10/2017",duration:0,predecessor:"38FS"}]}]},e.prototype.getResourceData=function(){return[{resourceId:1,resourceName:"Robert King"},{resourceId:2,resourceName:"Anne Dodsworth"},{resourceId:3,resourceName:"David William"},{resourceId:4,resourceName:"Nancy Davolio"},{resourceId:5,resourceName:"Janet Leverling"},{resourceId:6,resourceName:"Romey Wilson"}]},e}();t.GanttDataService=a},1018:function(e,t){e.exports="ej-gantt {\r\n    display: block;\r\n}\r\n"},1042:function(e,t,i){var a,r,n;
/*!
*  filename: ej.treegrid.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.treegrid.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(o){r=[i(15),i(94),i(4),i(21),i(65),i(47),i(16),i(55),i(95),i(223),i(31),i(92),i(93),i(224),i(79),i(226),i(80),i(66),i(222),i(225)],void 0===(n="function"==typeof(a=o)?a.apply(t,r):a)||(e.exports=n)}(function(){(function(e,t,i){"use strict";t.widget("ejTreeGrid","ej.TreeGrid",{_rootCSS:"e-treegrid",element:null,validTags:["div"],model:null,_requiresID:!0,_tags:[{tag:"columns",attr:["field","headerText","allowSorting","editType","allowFiltering","filterEditType","width","visible","editParams","format","isFrozen","allowFreezing","headerTemplateID","allowCellSelection","showCheckbox","showInColumnChooser","validationRules.minlength","isTemplateColumn","validationRules.maxlength","validationRules.range","validationRules.number","validationRules.required","displayAsCheckbox","editTemplate","priority","filterType",[{tag:"commands",attr:["type","buttonOptions"]}]],content:"template"},{tag:"summaryRows",attr:["title","summaryColumns"],content:"template"},{tag:"stackedHeaderRows",attr:["stackedHeaderColumns"],content:"template"},{tag:"summaryRows.summaryColumns",attr:["summaryType","dataMember","displayColumn","prefix","suffix","format","customSummaryValue"],content:"template"},{tag:"sortSettings.sortedColumns",attr:["field","direction"]},{tag:"sizeSettings",attr:["height","width"]},{tag:"columnResizeSettings",attr:["columnResizeMode"]}],_columns:function(e,i,a){var r,n,o,l,d,s=this.model.columns,c=!1,u=s.length,p=["allowCellSelection","allowEditing","allowFilteringBlankContent","allowFreezing","allowSorting","editParams","headerTooltip","tooltip","validationRules"];if(!t.isNullOrUndefined(e)){if("object"==typeof e){for(r=0;r<e.length;r++)if(n=e[r],!t.isNullOrUndefined(n.index)&&!t.isNullOrUndefined(n.change))for(o=0;o<u;o++)if((l=s[o]).index&&l.index==n.index){for(d in n.change)-1==p.indexOf(d)&&(c=!0);break}}else i&&a?-1==p.indexOf(d)&&(c=!0):c=!0;c&&this.updateColumns()}},keyConfigs:{focus:"e",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"36",lastRowSelection:"35",leftArrow:"37",upArrow:"38",rightArrow:"39",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",shiftDownArrow:"shift+40",shiftUpArrow:"shift+38",shiftRightArrow:"shift+39",shiftLeftArrow:"shift+37",shiftHomeButton:"shift+36",shiftEndButton:"shift+35",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38",deleteRecord:"46",spaceBar:"32",topRowSelection:"ctrl+36",bottomRowSelection:"ctrl+35",nextPage:"33",prevPage:"34"},defaults:{expandStateMapping:"",allowFiltering:!1,allowDragAndDrop:!1,dragTooltip:{showTooltip:!1,tooltipItems:[],tooltipTemplate:""},allowSorting:!1,allowColumnResize:!1,allowSelection:!0,allowPaging:!1,allowSearching:!1,dataSource:null,query:t.Query(),idMapping:"",parentIdMapping:"",hierarchyRowIndexMapping:"",readOnly:!1,showGridCellTooltip:!1,cellTooltipTemplate:null,showGridExpandCellTooltip:!1,showColumnChooser:!1,showColumnOptions:!1,enableAltRow:!0,enableLoadOnDemand:!1,totalSummaryHeight:90,collapsibleTotalSummary:!1,hasChildMapping:"",selectedItem:null,showStackedHeader:!1,stackedHeaderRows:[],toolbarSettings:{showToolbar:!1,toolbarItems:[],customToolbarItems:[]},editSettings:{allowEditing:!1,allowAdding:!0,allowDeleting:!0,editMode:"cellEditing",rowPosition:"top",beginEditAction:"dblclick",dialogEditorTemplateID:"",showDeleteConfirmDialog:!1,showConfirmDialog:!0,batchEditSettings:{editMode:"cell"}},enableVirtualization:!1,allowMultiSorting:!1,sortSettings:{sortedColumns:[]},filterSettings:{filterBarMode:"immediate",filteredColumns:[],filterType:"filterbar",maxFilterChoices:1e3,enableCaseSensitivity:!1,enableComplexBlankFilter:!0,blankValue:"",filterHierarchyMode:"parent"},printingEnabled:!1,selectionType:"single",selectionMode:"row",selectionSettings:{selectionType:"single",selectionMode:"row",enableHierarchySelection:!0,enableSelectAll:!0},searchSettings:{fields:[],key:"",operator:"contains",ignoreCase:!0,searchHierarchyMode:"parent"},selectedCellIndexes:[],selectedRowIndex:-1,showSummaryRow:!1,summaryRows:[],showTotalSummary:!1,allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",isEdit:!1,allowScrolling:!1,scrollSettings:{frozenColumns:0},groupSettings:{groupedColumns:[]},sizeSettings:{height:"",width:""},enableResize:!0,allowTextWrap:!1,isResponsive:!0,showDetailsRow:!1,showDetailsRowInfoColumn:!1,detailsTemplate:"",detailsRowHeight:100,rowDataBound:null,load:null,create:null,queryCellInfo:null,rowSelecting:null,rowSelected:null,cellSelecting:null,cellSelected:null,beginEdit:null,endEdit:null,expanding:null,expanded:null,collapsing:null,collapsed:null,dataBound:null,beforePrint:null,actionComplete:null,actionBegin:null,actionFailure:null,currentViewData:[],flatRecords:[],parentRecords:[],updatedRecords:[],summaryRowRecords:[],selectedItems:[],ids:[],columns:[{field:"",headerText:"",editType:"",filterEditType:"",allowFiltering:!1,allowFilteringBlankContent:!0,allowSorting:!1,visible:"",textAlign:t.TextAlign.Left,headerTextAlign:t.TextAlign.Left,allowCellSelection:!0,clipMode:"",headerTooltip:"",tooltip:"",showInColumnChooser:!0,commands:[{type:"",buttonOptions:{}}],filterType:null}],columnDialogFields:[],commonWidth:150,dateFormat:"MM/dd/yyyy",rowHeight:30,emptyRecordText:"No Records To Display",treeColumnIndex:0,workingTimeScale:"TimeScale8Hours",childMapping:"",enableCollapseAll:!1,rowTemplateID:"",altRowTemplateID:"",parseRowTemplate:!0,contextMenuSettings:{showContextMenu:!1,contextMenuItems:[]},contextMenuOpen:null,rowDragStart:null,rowDrag:null,rowDragStop:null,rowDropActionBegin:null,detailsDataBound:null,detailsShown:null,detailsHidden:null,toolbarClick:null,columnResizeStart:null,columnResizeEnd:null,columnResized:null,recordClick:null,recordDoubleClick:null,exportToPdfAction:"",exportToExcelAction:"",allowMultipleExporting:!1,headerTextOverflow:"none",pageSettings:{pageSize:12,pageCount:8,currentPage:1,totalPages:0,totalRecordsCount:null,pageSizeMode:"all",template:null,printMode:"allPages"},allowColumnReordering:!1,columnResizeSettings:{columnResizeMode:"normal"}},dataTypes:{columns:"array",totalSummaryHeight:"number",collapsibleTotalSummary:"boolean",summaryRows:"array",sortSettings:{sortedColumns:"array"},searchSettings:{fields:"array"},dragTooltip:{tooltipItems:"array"},columnDialogFields:"array",filterSettings:{filteredColumns:"array",filterType:"string"},dataSource:"data",query:"data",currentViewData:"array",flatRecords:"array",parentRecords:"array",updatedRecords:"array",summaryRowRecords:"array",ids:"array",contextMenuSettings:{contextMenuItems:"array"},toolbarSettings:{toolbarItems:"array",customToolbarItems:"array"},stackedHeaderRows:"array",selectedItem:"data"},ignoreOnExport:["isEdit","toolbarClick","query","queryCellInfo","selectionType","currentViewData","enableRTL","rowDataBound","rowTemplate","parseRowTemplate","detailsTemplate","editSettings","localization","cssClass","dataSource","allowKeyboardNavigation","pageSettings","columnResizeSettings"],observables:["selectedRowIndex","dataSource","selectedCellIndexes","pageSettings.currentPage"],selectedItem:t.util.valueFunction("selectedItem"),selectedRowIndex:t.util.valueFunction("selectedRowIndex"),selectedCellIndexes:t.util.valueFunction("selectedCellIndexes"),dataSource:t.util.valueFunction("dataSource"),_currentPage:t.util.valueFunction("pageSettings.currentPage"),_dataSource:t.util.valueFunction("dataSource"),_getLocalizedLabels:function(){return t.getLocalizedConstants(this.sfType,this.model.locale)},getHeaderTable:function(){return this._$gridHeaderTable},setGridHeaderTable:function(e){this._$gridHeaderTable=e},getHeaderContent:function(){return this._$gridHeaderContent},setGridHeaderContent:function(e){this._$gridHeaderContent=e},getContentTable:function(){return this._$gridContentTable},getContent:function(){return this._$gridContent},setGridContentTable:function(e){this._$gridContentTable=e},getRows:function(){return this._excludeDetailRows()},getSelectedCells:function(){var t=this,i=t.model,a=[];return this._selectedCellDetails.forEach(function(r){var n=r.data,o=i.currentViewData.indexOf(n),l=e(r.cellElement);-1!=o&&(t._frozenColumnsLength>0?l.closest(".e-frozencontentdiv").length>0?r.cellElement=t.getRows()[0][o].childNodes[r.cellIndex]:l.closest(".e-movablecontentdiv").length>0&&(r.cellElement=t.getRows()[1][o].childNodes[r.cellIndex-t._frozenColumnsLength]):r.cellElement=t.getRows()[o].childNodes[r.cellIndex]),a.push(r.cellElement)}),a},setGridRows:function(e){this._$gridRows=e},getCurrentViewData:function(){return this.model.currentViewData},getUpdatedCurrentViewData:function(){return this._updateCurrentViewData(),this.model.currentViewData},getFlatRecords:function(){return this.model.flatRecords},setHeight:function(e){this._totalHeight=e},getUpdatedRecords:function(){var e=this.model;return!this._isFromGantt&&e.allowPaging?this._updatedPageData:this._isHierarchyFiltering&&e.enableVirtualization?this._updateFilterParent:e.updatedRecords},getsummaryRowRecords:function(){return this.model.summaryRowRecords},getDataSource:function(){return this.dataSource()},getUpdatedIds:function(){return this.model.ids},getRecordsCount:function(){return this._recordsCount},setRecordsCount:function(e){this._recordsCount=e},setFocusOnTreeGridElement:function(){this._focusTreeGridElement()},updateCollapsedRecordCount:function(){var e,t=this;e=this.model.updatedRecords.filter(function(e){return 0==t.getExpandStatus(e)}),t._totalCollapsedRecordCount=e.length},_getDetailsExpandedRecords:function(e){return e.filter(function(e){return 1==e.isDetailsExpanded})},_getExpandedDetailsRowHeight:function(){var e,t,i=this,a=i.getUpdatedRecords();return e=this.getExpandedRecords(a),t=this._getDetailsExpandedRecords(e),t=i._spliceSummaryRows(t),i._detailsRowHeight*t.length},getCollapsedRecordCount:function(){return this._totalCollapsedRecordCount},_colgroupRefresh:function(){var t,i;this._frozenColumnsLength>0?(t=e(this.getHeaderTable()).find("colgroup"),i=e(this.getContentTable()).find("colgroup")):(t=e(this.getHeaderTable()).find("colgroup")[0],i=e(this.getContentTable()).find("colgroup")[0]);var a=e(t).clone(),r=e(i).clone(),n=e(i).clone();e(i).remove(),e(t).remove(),this._frozenColumnsLength>0?(e(a[0]).prependTo(this.getHeaderTable()[0]),e(a[1]).prependTo(this.getHeaderTable()[1]),e(r[0]).prependTo(this.getContentTable()[0]),e(r[1]).prependTo(this.getContentTable()[1]),this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(n[0]).prependTo(this._$footertableContent[0]),e(n[1]).prependTo(this._$footertableContent[1])),this._$totalSummaryRowContainer&&(this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this._$totalSummaryRowContainer.find("#e-movablefooter"+this._id).css("margin-left","auto")),this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this.getHeaderContent().find("#e-movableheader"+this._id).add(this.getContent().find("#e-movablecontainer"+this._id)).css("margin-left","auto"),e("#e-frozencontentdiv"+this._id).length&&e("#e-frozencontentdiv"+this._id).css("width","100%")):(e(a).prependTo(this.getHeaderTable()),e(r).prependTo(this.getContentTable()),this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(n).prependTo(this._$footertableContent)))},_detailColsRefresh:function(){if(this._$headerCols=this.getHeaderTable().children("colgroup").find("col"),this._$contentCols=this.getContentTable().children("colgroup").find("col"),this.model.detailsTemplate&&this.model.showDetailsRow&&this.model.showDetailsRowInfoColumn||this.model.isFromGantt){var e=this.model.columns.length;this._$headerCols.length>e&&this._$headerCols.splice(e,1),this._$contentCols.length>e&&this._$contentCols.splice(e,1)}},_swipeAction:function(e){var t=this._currentPage(),i=!0,a=(this.getScrollObject()||{})._scrollXdata;switch(a&&(i="swipeleft"==e.type?a.scrollable-a.sTop==0:0==a.sTop),e.type){case"swipeleft":!this.model.allowPaging||t==this.model.pageSettings.totalPages||this.model.isEdit||this._isRowEdit||(i||!this.getScrollElement().ejScroller("isHScroll"))&&this.element.ejTreeGrid("gotoPage",t+1);break;case"swiperight":this.model.allowPaging&&t>1&&!this.model.isEdit&&!this._isRowEdit&&(i||!this.getScrollElement().ejScroller("isHScroll"))&&this.element.ejTreeGrid("gotoPage",t-1)}},gotoPage:function(i){var a=this,r=a.model,n={};if(this.model.allowPaging){if(this._isLoadonDemand&&i&&i!=this._currentPage())return this._currentPage(i),a._refreshDataSource(),void(this._prevPageNo!=i&&(this._prevPageNo=i));t.isNullOrUndefined(i)?i=a._currentPage():i<=0?i=1:i>r.pageSettings.totalPages&&(i=r.pageSettings.totalPages),i=t.isNullOrUndefined(i)?a._currentPage():i,this._currentPage(i),n.previousPage=this._prevPageNo,n.currentPage=i,r.allowPaging&&(n.requestType=t.TreeGrid.Actions.Paging),a._setScrollTop(),a._updateCurrentViewData(),r.enableVirtualization&&r.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&-1==e.inArray(i,a._expandCollapsePages)&&(a._isInExpandCollapseAll=!0,"collapseAll"==a._expandCollapseSettings.state?a._collapseAllData():"expandAll"==a._expandCollapseSettings.state&&a._expandAllData(),"collapseAtLevel"==a._expandCollapseSettings.atLevel?a._collapsePageLevelData():"expandAtLevel"==a._expandCollapseSettings.atLevel&&a._expandPageLevelData(),r.enableAltRow&&a.updateAltRow()),a.renderRecords(n),a._isInExpandCollapseAll=!1,a._updateWrapRowHeights("total,header"),a.updateHeight(),a._updateScrollCss(),r.allowTextWrap&&r.enableVirtualization&&a._updateWrapRowHeights("header","refreshAll"),n.previousPage!=n.currentPage&&(a.clearSelection(-1),a.selectedRowIndex(-1),a.model.selectedItem=null,a._cancelSaveTools(),a._clearContextMenu(),a.model.allowSelection&&"multiple"==a.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&a._clearMultiSelectPopup(),this._prevPageNo=n.currentPage)}},_pagerClickHandler:function(e){var i=this;return i.model.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&i._batchEditStarts&&!i._confirmDialog.is(":visible")?(i._batchSaveLostWarning("Paging"),i._batchTempDetails.currentPage=e.currentPage,!0):this._prevPageNo==e.currentPage?void 0:(i._isNextPage=!0,i._isRowEdit?i.cancelRowEditCell():i.model.isEdit&&i.cancelEditCell(),this.gotoPage(e.currentPage),!1)},_init:function(){var e,a,r,n=this;if(n.model.isdesignMode){for(n.model.columns=[{field:"Column1",HeaderText:"Column1"},{field:"Column2",HeaderText:"Column2"},{field:"Column3",HeaderText:"Column3"},{field:"Column4",HeaderText:"Column4"}],n.model.childMapping="Children",e=[{Column1:"Value 1",Column2:"Value 2",Column3:"Value 3",Column4:"Value 4",Children:[]}],a=1;a<4;a++)r={Column1:"Value 1",Column2:"Value 2",Column3:"Value 3",Column4:"Value 4"},e[0].Children.push(r);this.dataSource(e),this.model.sizeSettings.height="250px",this.model.sizeSettings.width="600px"}n._detailsColumnWidth=35,n._summaryColumnIndex=0,n.model.summaryRows.length<=1&&(n.model.collapsibleTotalSummary=!1),n._trigger("load"),n._validateColumnFields(),n.model.isFromGantt||n._validateColumnVisible(!0),n._initPrivateProperties(),n._setCultureInfo(),this.dataSource()instanceof t.DataManager&&this.dataSource().ready!=i?((n=this)._renderWaitingPopup(),this.dataSource().ready.done(function(e){n.model.dataSource=t.DataManager(e.result),n._initDatasource()})):n._initDatasource(),n._processEditing(),n.model.showColumnChooser&&n.model.showColumnOptions&&(n.columnAddDialogTemplate(),n._renderUpdateConfirmDialog()),n._createDragTooltipTemplate(),n._createTooltipTemplate()},_renderEditDialog:function(){return t.buildTag("div.e-editdialog-padding","",{display:"none"},{id:this._id+"_dialogEdit"})},_validateColumnFields:function(){var e,i=this.model.columns;if(!t.isNullOrUndefined(i))for(e=0;e<i.length;e++)t.isNullOrUndefined(i[e].field)&&(i[e].field="",i[e].allowEditing=!1,i[e].allowSorting=!1,i[e].allowFiltering=!1),this._isCommandColumn(i[e])&&(i[e].allowEditing=!1,i[e].allowSorting=!1,i[e].allowFiltering=!1,i[e].showCheckbox=!1),t.isNullOrUndefined(i[e].editType)&&(i[e].editType="stringedit"),"maskedit"==i[e].editType&&t.isNullOrUndefined(i[e].filterEditType)&&(i[e].filterEditType="stringedit")},_validateColumnVisible:function(e){var i,a,r,n,o,l=this,d=l.model;if(l._autoHideColumns=[],l._autoShowColumns=[],d.isResponsive&&d.enableResize)if(a=null,(i=document.body.clientWidth)>=960&&i<=1120?a=6:i>=800&&i<=959?a=5:i>=640&&i<=799?a=4:i>=480&&i<=639?a=3:i>=0&&i<=479&&(a=2),n=(r=d.columns).length,e)for(o=0;o<n;o++)null!=a?r[o].priority&&(r[o].visible=!(r[o].priority>=a)):t.isNullOrUndefined(r[o].priority)||(r[o].visible=!0);else for(o=0;o<n;o++)null!=a?r[o].priority&&(r[o].priority>=a?0!=r[o].visible&&l._autoHideColumns.push(r[o]):0==r[o].visible&&l._autoShowColumns.push(r[o])):t.isNullOrUndefined(r[o].priority)||0==r[o].visible&&l._autoShowColumns.push(r[o])},_hideColumns:function(t){var i,a,r=this,n=r.model;if(t.reverse(),t.sort(function(e,t){return t.priority-e.priority}),t&&t.length>0){for(i=t.length,r.getHeaderTable().removeClass("e-table"),r.getContentTable().removeClass("e-table"),a=0;a<i;a++){var o=t[a],l=e.inArray(o,n.columns),d=o.headerText,s=e.inArray(d,r._hiddenColumns);(!o||r._isColumnHidable(o))&&(-1!=l&&l!=n.treeColumnIndex&&-1==s&&r._autoHideShowColumn(d,l,!0),-1!=(l=e.inArray(d,r._visibleColumns))&&r._visibleColumns.splice(l,1))}r.getHeaderTable().addClass("e-table"),r.getContentTable().addClass("e-table"),r._updateHideShowColumnAlignment()}},_showColumns:function(t){var i,a,r=this,n=r.model;if(t&&t.length>0){for(i=t.length,a=0;a<i;a++){var o=t[a],l=e.inArray(o,n.columns),d=o.headerText,s=e.inArray(d,r._visibleColumns);-1!=l&&-1==s&&r._autoHideShowColumn(d,l,!1),-1!=(l=e.inArray(d,r._hiddenColumns))&&r._hiddenColumns.splice(l,1)}r._updateHideShowColumnAlignment()}},_autoHideShowColumn:function(t,i,a){var r,n,o,l,d,s=this,c=s.model;s._cancelEditState(),a?(s._hiddenColumns.push(t),c.columns[i].visible=!1):(s._visibleColumns.push(t),c.columns[i].visible=!0),n=s.getHeaderTable().find("colgroup").find("col"),o=s.getHeaderTable().find("thead").find("th.e-headercell"),c.allowFiltering&&"filterbar"==c.filterSettings.filterType&&(r=s.getHeaderTable().find("thead").find("th.e-filterbarcell")),1==s.model.columns[i].isFrozen&&(s._updateFrozenColumnOnResize(i),s.setWidthToColumns());var u,p,h=s.getContentTable().find("colgroup").find("col"),g=!0,m=i;p=s.getRows(),u=s._getFooterRows(),a?(e(n).eq(i).hide(),e(o).eq(i).addClass("e-hide"),r&&e(r).eq(i).addClass("e-hide"),e(h).eq(i).hide()):(e(n).eq(i).show(),e(o).eq(i).removeClass("e-hide"),r&&e(r).eq(i).removeClass("e-hide"),e(h).eq(i).show()),s._frozenColumnsLength>0?i<s._frozenColumnsLength?(p=e(s.getRows()[0]),u=e(u[0]),s._gridRows&&e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(l=parseInt(e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),l=a?l-1:l+1,e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",l))):(p=e(s.getRows()[1]),u=e(u[1]),g=!1,m=i-this._frozenColumnsLength,s._gridRows&&e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(l=parseInt(e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),l=a?l-1:l+1,e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",l))):s._gridRows&&e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(l=parseInt(e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),l=a?l-1:l+1,e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",l)),p.each(function(){var t=e(this).children("td").eq(m);a?e(t).addClass("e-hide"):e(t).removeClass("e-hide"),c.showSummaryRow&&e(t).hasClass("e-summaryrowcell")&&g&&s._updateSummaryRowTitleCell(n,t[0].parentElement)}),c.showTotalSummary&&(d=s._$footertableContent.find("colgroup").find("col"),a?e(d).eq(i).hide():e(d).eq(i).show(),u.each(function(){var t=e(this).children("td").eq(m);a?e(t).addClass("e-hide"):e(t).removeClass("e-hide"),e(t).hasClass("e-footersummaryrowcell")&&s._updateSummaryRowTitleCell(d,t[0].parentElement)}))},_updateHideShowColumnAlignment:function(){var e,i=this,a=i.model;i._addInitTemplate(),e=i.getScrollElement(),a.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||a.isFromGantt||i._updateTableWidth(),e.ejScroller("refresh"),i._updateScrollCss(),i._updateHeaderScrollLeft(),a.showColumnChooser&&(i._renderColumnChooserList(!0),i._updateColumnMenuVisibility())},_treeGridAddEditDialog:function(){var a;if(0!=this.model.columns.length){var r,n,o,l,d,s=t.buildTag("div"),c=t.buildTag("form.e-treegridform","",{},{id:this._id+"EditFormDialog"}),u=t.buildTag("table","",{margin:"0 auto"},{});for(a=0;a<this.model.columns.length;a++)(this.model.columns[a].visible||t.isNullOrUndefined(this.model.columns[a].visible))&&"checkboxState"!=this.model.columns[a].field&&!this._isCommandColumn(this.model.columns[a])&&(l="tr",d="td",r=t.buildTag(l),n=t.buildTag(d+".e-editdialoglabel","",{"text-align":"right"}),o=t.buildTag(d+".e-editdialogrowcell","",{"text-align":"left"}),0!=this.model.columns[a].allowEditing&&r.append(n.get(0)).append(o.get(0)),this.model.columns[a].headerText==i&&(this.model.columns[a].headerText=this.model.columns[a].field),n.append("<label>"+this.model.columns[a].headerText+"</label>"),0!=this.model.columns[a].allowEditing&&this.model.columns[a].field&&t.TreeGrid._initCellEditType(this,o,this._id,a),0==this.model.columns[a].allowEditing&&o.find(".e-field").attr("disabled",!0).addClass("e-disable"),!1===this.model.columns[a].visible&&r.addClass("e-hide"),u.append(r));c.append(u),c.appendTo(s),s=this._renderDiaglogButton(c,s,u),e.templates(this._id+"_JSONDialogEditingTemplate",s.html())}},_treeGridAddEditDialogTemplate:function(){if(0!=this.model.columns.length){var i=t.buildTag("div","",{display:"none"}),a=t.buildTag("form.e-treegridform","",{},{id:this._id+"EditFormDialog"}),r=this.model.editSettings.dialogEditorTemplateID;a.html(e(r).html()),i=this._renderDiaglogButton(a,i),e.templates(this._id+"_JSONdialogTemplateMode",i.html())}},_renderDiaglogButton:function(e,i,a){var r,n,o,l,d,s,c,u=this._contextMenuTexts;return r="EditFormDialog_",t.isNullOrUndefined(a)?((n=t.buildTag("input.e-save e-button e-btnsub e-flat","",{"margin-left":"33%"},{type:"button",id:r+this._id+"_Save"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.saveText,width:"30%"}),(o=t.buildTag("input.e-cancel e-button e-btncan e-flat","",{"margin-left":"7%"},{type:"button",id:r+this._id+"_Cancel"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.cancelText,width:"30%"})):((n=t.buildTag("input.e-save e-button e-btnsub e-flat","",{"margin-left":"0px"},{type:"button",id:r+this._id+"_Save"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.saveText,width:"45%"}),(o=t.buildTag("input.e-cancel e-button e-btncan e-flat","",{"margin-left":"10%"},{type:"button",id:r+this._id+"_Cancel"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.cancelText,width:"45%"})),l=t.buildTag("div","",{},{class:"e-editform-btn e-editdialogbutton"}),t.isNullOrUndefined(a)||(d=t.buildTag("tr"),s=t.buildTag("td.e-editdialoglabel"),c=t.buildTag("td.e-editdialogrowcell")),l.append(n),l.append(o),t.isNullOrUndefined(a)||(c.append(l),d.append(s),d.append(c),a.append(d)),e.appendTo(i),t.isNullOrUndefined(a)?e.append(l):e.append(a),i},updateAllowKeyboardNavigation:function(e){this.model.allowKeyboardNavigation=e},_updateSummaryTitleColumn:function(){var t=this,i=this.model;i.collapsibleTotalSummary&&0==this._summaryColumnIndex&&(i.columns[this._summaryColumnIndex].visible&&!e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").hasClass("e-summarycell")?(e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").addClass("e-summarycell"),e("#"+t._id+"-footersummaryrow").find(".e-summarycell").css({overflow:"hidden","padding-left":"25px",float:"none"}),e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").parent().addClass("e-summaryindend").css({"padding-left":"0px"})):!i.columns[this._summaryColumnIndex].visible&&e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").hasClass("e-summarycell")&&(e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").removeClass("e-summarycell"),e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").css({"padding-left":"0px",float:"left"}),e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").parent().removeClass("e-summaryindend").css({"padding-left":"10px"})))},_refreshFooterSummaryRecords:function(){var i,a,r=this;this.model.showTotalSummary&&r._$footerContainer.length>0&&(this._frozenColumnsLength>0?(r._$footerContainer.html(this._renderSummaryByFrozenDesign()),this._renderFrozenSummary()):(i=t.buildTag("table.e-table e-zerospace#"+r._id+"summarye-table","",{top:"0px"}),a=t.buildTag("tbody"),i.append(r.getContentTable().find("colgroup").clone()).append(a),a.html(e.render[this._id+"_Template"](r._footerSummaryRecord)),r._$footerContainer.empty().append(i)),r._$footertableContent=r._$footerContainer.find(".e-table"),r._updateSummaryTitleColumn())},_updateHeaderScrollLeft:function(e){var i=this;t.isNullOrUndefined(e)&&(e=i.getScrollElement().ejScroller("option","scrollLeft")),this._frozenColumnsLength>0?(i._$gridHeaderContainer.find("#e-movableheader"+this._id).scrollLeft(e),i.model.showTotalSummary&&i._$footerContainer&&i._$footerContainer.find("#e-movablefooter"+this._id).scrollLeft(e)):(i._$gridHeaderContainer.scrollLeft(e),i.model.showTotalSummary&&i._$footerContainer&&i._$footerContainer.scrollLeft(e))},updateColumns:function(e){var i=this,a=this.model;t.isNullOrUndefined(e)||(a.columns=e),a.isFromGantt&&a.enableSerialNumber&&i._updateTreeColumnIndex(),i._refreshFrozenColumns(),i._updateWrapRowHeights(null,"refreshAll"),a.isFromGantt&&i._updateAddEditDialogTemplate()},updateToGanttColumns:function(){var t=this.model.columns;e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt").updateGanttColumns(t)},_updateAddEditDialogTemplate:function(){var t;(t=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt")).addDialogTemplate(),t.editDialogTemplate()},_refreshFrozenColumns:function(i){var a,r,n,o,l,d=this,s=this.model,c=!1;d._initFrozenColumns(),d._processEditing(),d._$gridHeaderContent.replaceWith(d._renderGridHeader()),d._addInitTemplate(),s.isFromGantt&&d._$gridContent.removeClass("e-borderbox"),this._frozenColumnsLength>0&&0==d._$frozenTableContent.length?(c=!0,a=d._$gridContent.css("width"),r=d._$gridContent.css("height"),d._$gridContent.ejScroller("destroy"),d._$gridContent.css("width",a),d._$gridContent.css("height",r),d._$gridContainer.html(d._renderByFrozenDesign()),d.setGridContentTable(d._$gridContainer.find(".e-table")),s.allowTextWrap&&!s.enableVirtualization?d._$gridContainer.find("#e-movablecontent"+d._id+",#e-movablecontentdiv"+d._id+",#e-frozencontentdiv"+d._id).css("height","auto"):d._$gridContainer.find("#e-movablecontent"+d._id+",#e-movablecontentdiv"+d._id+",#e-frozencontentdiv"+d._id).css("height",d._$gridContainer.css("height")),d._renderScroller(!0)):d._$frozenTableContent.length>0&&0==this._frozenColumnsLength&&(c=!0,d._$gridContent.find("#e-movablecontainer"+d._id).ejScroller("destroy"),n=t.buildTag("table.e-table e-zerospace#"+d._id+"e-table","",{top:"0px",position:"relative"}),o=t.buildTag("tbody"),n.append(d.getHeaderTable().find("colgroup").clone()).append(o),d._$gridContainer.html(n),d.setGridContentTable(n),d._renderScroller(!0)),d._$frozenTableContent=e("#"+d._id+"frozene-table"),d._$movableTableContent=e("#"+d._id+"movablee-table"),d._$tableContent=e("#"+d._id+"e-table"),s.showTotalSummary&&d._$footerContainer.length>0&&!i&&d._refreshFooterSummaryRecords(),c&&d.onScrollHelper(0),i||((l={}).requestType=t.TreeGrid.Actions.Refresh,d._isRendered=!1,d.sendDataRenderingRequest(l),d._isRendered=!0),d.setWidthToColumns(),d._trigger("headerRefresh"),d._isRendered=!0,i||(d._trigger("refresh"),this._eventBindings()),this._hideCollapsedDetailsRows(),i||(d.getScrollElement().ejScroller("refresh"),d._updateScrollCss(),s.isFromGantt&&d._trigger("refreshScrollCss")),(s.showColumnChooser||s.contextMenuSettings.showContextMenu)&&d._renderColumnChooserList(!0),d._updateHeaderScrollLeft(),s.isFromGantt&&(d._addEmptyColumntoGrid(),d.updateToGanttColumns())},freezePrecedingColumns:function(e){var i,a,r=this,n=this.model.columns,o=this.getColumnByField(e),l=n.indexOf(o);if(r._saveEditedElements(),this._clearContextMenu(),this._removeDetailsRow(),this._clearColumnMenu(),t.isNullOrUndefined(o)||-1==l||0==l&&l<=this._frozenColumnsLength||(i=this._getFrozenColumnWidth(l),(i+=18)>this._gridWidth))return!1;for(a=0;a<l;a++)n[a].isFrozen=!0;r._refreshFrozenColumns(),r._updateWrapRowHeights(null,"virtualRefresh")},freezeColumn:function(e,i){var a,r,n=this,o=this.model,l=o.columns,d=this.getColumnByField(e);if(n._saveEditedElements(),this._clearContextMenu(),this._removeDetailsRow(),this._clearColumnMenu(),"cell"==o.selectionSettings.selectionMode&&n.clearSelection(),t.isNullOrUndefined(d)||n._frozenColumnsLength==o.columns.length-1&&i||d.isFrozen==i||(a=this._getFrozenColumnWidth(),r=l.indexOf(d),(a+=i?this.columnsWidthCollection[r]+18:-this.columnsWidthCollection[r])>this._gridWidth))return!1;d.isFrozen=i,n._refreshFrozenColumns(),i&&(n._allowFreezingDefault=this._frozenColumnsLength>0),n._off(n.element,"mousewheel DOMMouseScroll",n._mouseWheel),this._frozenColumnsLength&&n._on(n.element,"mousewheel DOMMouseScroll",n._mouseWheel),n._updateWrapRowHeights(null,"virtualRefresh")},updateCheckboxColumn:function(i){var a,r,n,o=this,l=o.model.columns,d=o.getColumnByField(i);o._checkboxSelection&&(e.each(l,function(e,t){t.showCheckbox=!1}),t.isNullOrUndefined(d)||(a=l.indexOf(d))>-1&&(l[a].showCheckbox=!0),n={},(r={}).selectionType=t.TreeGrid.SelectionType.Checkbox,n.selectionSettings=r,o._refreshSelectionSettings(n,"selectionSettings"))},_refreshSelectionSettings:function(i,a){var r,n,o,l=this,d=l.model,s=!1;s=!t.isNullOrUndefined(i[a].selectionType)||!t.isNullOrUndefined(i[a].selectionMode),"selectionType"==a?(d.selectionSettings.selectionType=i[a],s=!0):"selectionMode"==a?(d.selectionSettings.selectionMode=i[a],s=!0,d.showColumnChooser&&d.showColumnOptions&&l.columnAddDialogTemplate()):e.extend(d.selectionSettings,i[a]),r=d.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox&&d.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row,(!t.isNullOrUndefined(i[a].enableHierarchySelection)&&d.selectedItems.length>0||!r&&l._checkboxSelection)&&(l._isFromSetmodel=!0,l.selectAllRows(!1),l._isFromSetmodel=!1),(l._checkboxSelection||r)&&(l._checkboxSelection=r,l._processEditing(),(!r&&"checkboxState"==l._checkboxColumnName||d.columns[0].nonColumn&&"checkboxState"!=l._checkboxColumnName)&&(n=d.columns[d.treeColumnIndex],d.columns[0].isFrozen&&(d.columns[0].isFrozen=!1,l._frozenColumnsLength-=1,o=l._frozenColumns.indexOf(d.columns[0]),l._frozenColumns.splice(o,1),d.scrollSettings.frozenColumns=this._frozenColumnsLength),d.columns.splice(0,1),n&&(d.treeColumnIndex=d.columns.indexOf(n))),l._checkboxSelection||(l._checkboxColumnName=null),l._$gridHeaderContent.replaceWith(l._renderGridHeader()),l._setWidthToHeaders(),l._trigger("headerRefresh"),d.allowFiltering&&l._resizeFilteringElements(),s&&(l._addInitTemplate(),this.renderRecords()),l.setWidthToColumns(),l.getScrollElement().ejScroller("refresh"),l._updateScrollCss(),l._updateHeaderScrollLeft(),d.selectedItems.length>0&&l.selectAllRows()),d.isFromGantt&&l._processEditing()},_setModel:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x,v,b,S,D,R,y=this,I=y.model,k=y.getUpdatedRecords();for(a in i)switch(a){case"enableAltRow":I.enableAltRow=i[a],y._addInitTemplate(),y.renderRecords(m),y._updateWrapRowHeights("header","refreshAll");break;case"allowFiltering":!I.allowFiltering&&y._filteredColumnValueID.length>0&&y._clearAllFilter(y._filteredColumnValue),I.allowFiltering=i[a],y._initiateSetModel(),I.allowFiltering=i[a];var M=(P=y.getScrollElement().ejScroller("instance")).scrollLeft(),E=0,H=P.scrollTop();y._$gridHeaderContent.replaceWith(y._renderGridHeader()),y._setWidthToHeaders(),y._trigger("headerRefresh"),I.showTotalSummary&&(E=y.element.find(".e-footersummaryrowdiv").outerHeight()),e("#"+y._id).addClass("e-treegrid-overflow"),y._viewPortHeight=y.element.height()-(y._getNonContentHeight()+E),e("#"+y._id).removeClass("e-treegrid-overflow"),y._frozenColumnsLength>0&&y._$gridContent.css("height",y._viewPortHeight),P.option("height","auto"==I.sizeSettings.height?0:y._viewPortHeight),I.enableVirtualization&&(C=I.currentViewData.length,T=I.rowHeight,C*(T+=I.showDetailsRow&&!I.showDetailsRowInfoColumn?I.detailsRowHeight:0)<y._viewPortHeight&&(C>0?(H-=y._viewPortHeight-(C-1)*T)<0&&(H=0):(y.processBindings(),y.renderRecords()))),I.showColumnChooser&&I.showColumnOptions&&y.columnAddDialogTemplate(),I.allowFiltering&&"menu"==I.filterSettings.filterType&&0==y._renderedFilterMenuDialog.length&&y._renderFilterMenu(),this.setWidthToColumns(),P.scrollY(H,!0),P.scrollX(M,!0),y._updateHeaderScrollLeft(M),y._updateScrollCss(),y._updateWrapRowHeights("row,total","refreshAll");break;case"enableResize":y.model.enableResize=i[a],I.enableResize?y._on(e(window),"resize",y._windowResize):y._off(e(window),"resize",y._windowResize);break;case"isResponsive":y.model.isResponsive=i[a],I.isResponsive?(y._on(e(window),"resize",y._windowResize),e("#"+y._id+"_toolbarItems").addClass("e-treegridadaptivetoolbar"),y._mediaQueryUpdate(),y._off(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),y._on(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this))):(y._off(e(window),"resize",y._windowResize),y._off(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),e("#"+y._id+"_toolbarItems").removeClass("e-treegridadaptivetoolbar"),y._mediaQueryUpdate());break;case"enableVirtualization":I.enableVirtualization=i[a],y._prevSelectedItem,r=y.selectedRowIndex()&&k[y.selectedRowIndex()],y._vScrollDist=1,y.processBindings(),I.enableVirtualization||(this._frozenColumnsLength>0?(y._$frozenTableContent.css({top:0}),y._$movableTableContent.css({top:0})):y._$tableContent.css({top:0})),r&&y.selectedRowIndex(k.indexOf(r)),(m={}).requestType=t.TreeGrid.Actions.Refresh,y.sendDataRenderingRequest(m),y._updateWrapRowHeights(null,"refreshAll"),y._isRowEdit=I.isEdit=!1,y._cancelSaveTools(),y._clearColumnMenu(),y._clearContextMenu(),this._removeDetailsRow(),y._vScrollDist=0;break;case"allowColumnResize":I.allowColumnResize=i[a],I.allowColumnResize&&(y._resizer=new t.gridFeatures.gridResize(y)),y._enableColumnResizeEvents();break;case"allowSorting":I.allowSorting=i[a],y.sortSetting(i[a]),I.showColumnChooser&&I.showColumnOptions&&y.columnAddDialogTemplate();break;case"allowPaging":if(n=y.element.find("#"+y._id+"Pager"),I.allowPaging){y._updateTotalRecordsCount(),y.element.append(y._renderGridPager()),y.element.append(n),y.element.find(".e-pager").css({width:y._gridWidth-2});M=(P=y.getScrollElement().ejScroller("instance")).scrollLeft(),H=P.scrollTop();y._viewPortHeight=y._getViewPortHeight(),I.showTotalSummary&&(y._viewPortHeight-=y._$totalSummaryRowContainer.outerHeight()),y._frozenColumnsLength>0&&y._$gridContent.css("height",y._viewPortHeight),P.option("height","auto"==I.sizeSettings.height?0:y._viewPortHeight),P.scrollY(H,!0),P.scrollX(M,!0),y._pagerHeight=e(n).outerHeight(),y.gotoPage()}else o=e(n).outerHeight(),e(n).remove(),y._viewPortHeight=y._viewPortHeight+o,this._frozenColumnsLength>0&&y._$gridContent.css("height",y._viewPortHeight),y.getScrollElement().ejScroller({height:y._viewPortHeight}),I.pageSettings.totalRecordsCount>0?(I.pageSettings.totalRecordsCount=null,y._refreshDataSource()):y.refreshContent(),y.renderRecords(),y._isRefreshAddedRecord=!1;y._updateWrapRowHeights("header","refreshAll");break;case"dragTooltip":(l=i[a].tooltipItems)&&!Array.isArray(l)&&(l=l.length>0?l.split(","):[],i[a].tooltipItems=l),e.extend(I.dragTooltip,i[a]),y._createDragTooltipTemplate(),y.refreshContent();break;case"allowDragAndDrop":I.allowDragAndDrop=i[a],jQuery.uaMatch(navigator.userAgent),y.refreshContent();break;case"sortSettings":e.extend(I.sortSettings,i[a]),y.refreshContent(),(d={}).requestType=t.TreeGrid.Actions.Sorting,y.sendDataRenderingRequest(d);break;case"allowSelection":I.allowSelection=i[a],I.allowSelection||(y._checkboxSelection&&I.selectedItems.length>0&&(y._isFromSetmodel=!0,y.selectAllRows(!1),y._isFromSetmodel=!1),y.clearSelection(-1),y.selectedRowIndex(-1),y.model.selectedItem=null,y._cancelSaveTools());break;case"allowTextWrap":case"headerTextOverflow":"allowTextWrap"==a&&(I.allowTextWrap=i[a]),"headerTextOverflow"==a&&(I.headerTextOverflow=i[a],y._$gridHeaderContent.replaceWith(y._renderGridHeader()),y.setWidthToColumns(),y._trigger("headerRefresh"),y.getScrollElement().ejScroller("refresh"),y._updateScrollCss()),"allowTextWrap"==a&&(y._addInitTemplate(),y.renderRecords(m),y.model.showTotalSummary&&y._createTotalSummaryRow()),y._updateWrapRowHeights(null,"refreshAll");break;case"selectionType":case"selectionMode":case"selectionSettings":this._initiateSetModel(),y.clearAllSelection(),y._refreshSelectionSettings(i,a),y.model.allowSelection&&"multiple"==y.model.selectionSettings.selectionType&&0==e("#"+y._id+"_selectionpopup").length&&!y.model.isFromGantt&&y._renderMultiSelectionIndicator();break;case"showSummaryRow":I.showSummaryRow=i[a],I.showSummaryRow?(y._createSummaryRow(),(d={}).requestType=t.TreeGrid.Actions.Refresh,y.sendDataRenderingRequest(d)):(e(y.element).find(".e-summaryrow").hide(),I.updatedRecords=y._spliceSummaryRows(I.updatedRecords),I.allowPaging&&(y._updateCurrentViewData(),(d={}).requestType=t.TreeGrid.Actions.Refresh,y.sendDataRenderingRequest(d))),y.updateCollapsedRecordCount(),y._updateWrapRowHeights("header"),y.updateHeight(),(I.allowTextWrap||"wrap"==I.headerTextOverflow)&&y._updateGridContentHeight();break;case"totalSummaryHeight":if(!I.showTotalSummary)return;y._createTotalSummaryRow(),y._viewPortHeight=y._getViewPortHeight(),y._viewPortHeight-=y._$totalSummaryRowContainer.outerHeight(),y._updateSummaryHeight();break;case"collapsibleTotalSummary":if(!I.showTotalSummary)return;if(1==I.summaryRows.length)return void(I.collapsibleTotalSummary=!1);y._addInitTemplate(),y._createTotalSummaryRow(),I.collapsibleTotalSummary||(y._viewPortHeight=y._getViewPortHeight(),y._viewPortHeight-=e(y._$totalSummaryRowContainer).outerHeight(),y._updateSummaryHeight());break;case"showTotalSummary":I.showTotalSummary=i[a],I.showTotalSummary?(y._createTotalSummaryRow(),y._viewPortHeight=y._getViewPortHeight(),y._viewPortHeight-=e(y._$totalSummaryRowContainer).outerHeight()):(e(y.element).find(".e-footersummaryrowdiv").remove(),y._$totalSummaryRowContainer=null,y._$footertableContent=null,y._$footerContainer=null,y._footerSummaryRecord=[],y._footerSummaryRows=[],y._viewPortHeight=y._getViewPortHeight()),y._updateSummaryHeight();break;case"selectedRowIndex":this.isEdit||this._isRowEdit?this.selectedRowIndex(k.indexOf(y._prevSelectedItem)):(this.selectedRowIndex()>=0&&!t.isNullOrUndefined(this.selectedRowIndex())&&I.allowSelection&&k.length>this.selectedRowIndex()&&this.getExpandStatus(k[this.selectedRowIndex()])?(s=this.selectedRowIndex(),y._rowSelectingEventTrigger(this._previousIndex,s)||(I.showSummaryRow&&(c=y._spliceSummaryRows(I.updatedRecords)[s],s=k.indexOf(c)),y.selectRows(s),y._rowSelectedEventTrigger(s))):(y.clearSelection(-1),y.selectedRowIndex(-1),y.model.selectedItem=null,y._previousIndex=-1),y._cancelSaveTools());break;case"selectedCellIndexes":I.allowSelection&&"cell"==I.selectionSettings.selectionMode&&y.selectCells(i[a]);break;case"showStackedHeader":case"stackedHeaderRows":I.showStackedHeader&&(I.stackedHeaderRows&&I.stackedHeaderRows.length>0||i.stackedHeaderRows&&i.stackedHeaderRows.length>0)?(t.getObject("stackedHeaderRows.length",i)&&(I.stackedHeaderRows=i.stackedHeaderRows),y.getHeaderTable().find(".e-stackedHeaderRow").length>0&&y.getHeaderTable().find(".e-stackedHeaderRow").remove(),y._refreshStackedHeader()):y.getHeaderTable().find(".e-stackedHeaderRow").length>0&&y.getHeaderTable().find(".e-stackedHeaderRow").remove();break;case"editSettings":e.extend(I.editSettings,i[a]),y._processEditing(),y._enableEditingEvents(),y._updateToolbarItems(),I.editSettings.allowDeleting&&I.editSettings.showDeleteConfirmDialog&&t.isNullOrUndefined(y._confirmDialog)&&y._renderConfirmDialog();break;case"allowKeyboardNavigation":I.allowKeyboardNavigation=i[a];break;case"dataSource":(u={}).requestType=t.TreeGrid.Actions.RefreshDataSource,u.isUpdateColumns=!1,y._isRowEdit||y.model.isEdit||y._trigger("actionBegin",u)||(y._fieldNamesToQuery=[],y._assignedIdCollections=[],y._assignedParendIDs=[],y._refreshDataSource(u));break;case"columns":I.columns=i[a].slice(0),y._validateColumnFields(),y._validateColumnVisible(!0),y._refreshFrozenColumns(),y._updateWrapRowHeights(null,"refreshAll");break;case"rowHeight":I.rowHeight=i[a],y._addInitTemplate(),y.renderRecords(m),y.model.showTotalSummary&&(y._createTotalSummaryRow(),y._viewPortHeight=y._getViewPortHeight(),y._viewPortHeight-=y._$totalSummaryRowContainer.outerHeight(),y._updateSummaryHeight()),y.updateHeight();break;case"treeColumnIndex":y.columnIndex(i[a]);break;case"showColumnChooser":I.showColumnChooser=i[a],y._$gridHeaderContent.replaceWith(y._renderGridHeader()),y.setWidthToColumns(),y._trigger("headerRefresh"),y.getScrollElement().ejScroller("refresh"),y._updateScrollCss(),I.showColumnChooser?(y._renderColumnChooser(),I.allowFiltering&&"menu"==I.filterSettings.filterType&&0==y._renderedFilterMenuDialog.length&&y._renderFilterMenu()):(y._clearColumnMenu(),e("#"+y._id+"ccDiv_wrapper").remove(),e("#"+y._id+"filterMenu_wrapper").remove()),y._updateWrapRowHeights("row,total","refreshAll"),I.isFromGantt&&(y._addEmptyColumntoGrid(),this._updateHeaderScrollLeft(this.getScrollElement().ejScroller("model.scrollLeft")));break;case"showColumnOptions":I.showColumnOptions=i[a],y._$gridHeaderContent.replaceWith(y._renderGridHeader()),y.setWidthToColumns(),y._trigger("headerRefresh"),y.getScrollElement().ejScroller("refresh"),y._updateScrollCss(),I.showColumnChooser&&I.showColumnOptions?(y.columnAddDialogTemplate(),y._renderUpdateConfirmDialog()):(y._clearColumnMenu(),e("#"+y._id+"ccDiv_wrapper").remove(),e("#"+y._id+"filterMenu_wrapper").remove()),y._updateWrapRowHeights("row,total","refreshAll"),I.isFromGantt&&y._addEmptyColumntoGrid();break;case"locale":y._clearContextMenu(),y._clearColumnMenu(),y._removeDetailsRow(),I.locale=i[a],y._setCultureInfo(),y._processEditing(),y._addInitTemplate(),y.refreshContent(),y._$gridHeaderContent.replaceWith(y._renderGridHeader()),y.renderRecords(m),y.setWidthToColumns(),y._trigger("headerRefresh"),y.getScrollElement().ejScroller("refresh"),y._updateScrollCss(),I.showColumnChooser&&y._renderColumnChooserList(!0),I.toolbarSettings.showToolbar&&y._updateToolbar(),I.allowPaging&&y.getPager().ejPager("option",i[a]).ejPager("refreshPager"),y.model.showColumnChooser&&y.model.showColumnOptions&&(y.columnAddDialogTemplate(),y._renderUpdateConfirmDialog()),I.allowFiltering&&"menu"==I.filterSettings.filterType&&y._renderFilterMenu(),y._updateWrapRowHeights(null,"refreshAll");break;case"toolbarSettings":e.extend(y.model.toolbarSettings,i[a]),y._updateToolbar(),y._updateWrapRowHeights("header","refreshAll");break;case"contextMenuSettings":e.extend(y.model.contextMenuSettings,i[a]),I.contextMenuSettings.showContextMenu||y._clearContextMenu(),this._removeDetailsRow();break;case"enableCollapseAll":I.enableCollapseAll=i[a],I.enableCollapseAll?y.collapseAll():y.expandAll();break;case"showDetailsRow":I.showDetailsRow=i[a],this._updateDetailsRowProperties("showDetailsRow");break;case"detailsRowHeight":I.detailsRowHeight=i[a],this._updateDetailsRowProperties("detailsRowHeight");break;case"detailsTemplate":I.detailsTemplate=i[a],this._updateDetailsRowProperties("detailsTemplate");break;case"showDetailsRowInfoColumn":I.showDetailsRowInfoColumn=i[a],this._updateDetailsRowProperties("showDetailsRowInfoColumn");break;case"altRowTemplateID":this._initiateSetModel(),I.altRowTemplateID=i[a],y._addInitTemplate(),y.renderRecords(m),y._updateWrapRowHeights("header"),this.updateHeight(),(I.allowTextWrap||"wrap"==I.headerTextOverflow)&&y._updateGridContentHeight();break;case"rowTemplateID":this._initiateSetModel(),I.rowTemplateID=i[a],y._addInitTemplate(),y.renderRecords(m),y._updateWrapRowHeights("header"),this.updateHeight(),(I.allowTextWrap||"wrap"==I.headerTextOverflow)&&y._updateGridContentHeight();break;case"pageSettings":this._initiateSetModel(),I.allowPaging&&(p={},e.extend(I.pageSettings,i[a]),e.extend(p,I.pageSettings),delete p.template,this.getPager().ejPager("option",p).ejPager("refreshPager"),i[a].totalRecordsCount>0?y._refreshDataSource():y.gotoPage());break;case"sizeSettings":this._initiateSetModel(),e.extend(I.sizeSettings,i[a]),this._calculateDimensions(),this._getViewPortHeight()<=0&&(I.sizeSettings.height="450px",this._updateElementHeight()),this._windowResize();break;case"readOnly":I.readOnly=i[a];break;case"showGridCellTooltip":I.showGridCellTooltip=i[a];break;case"showGridExpandCellTooltip":I.showGridExpandCellTooltip=i[a];break;case"allowMultiSorting":I.allowMultiSorting=i[a];break;case"query":I.query=t.isNullOrUndefined(i[a])?t.Query():i[a],y._refreshDataSource();break;case"filterSettings":if(I.allowFiltering){if(i.filterSettings.filterType||"filterbar"!=I.filterSettings.filterType)if(i.filterSettings.filterType){y.clearFilter(),I.allowFiltering=!0,e.extend(y.model.filterSettings,i[a]),y._initiateSetModel(),y._isExcelFilter&&(y._isExcelFilter=!1,y._excelFilter.resetExcelFilter(),y._excelFilter=null,y._excelColTypes=[]);var P;M=(P=y.getScrollElement().ejScroller("instance")).scrollLeft(),H=P.scrollTop();y._$gridHeaderContent.replaceWith(y._renderGridHeader()),y._setWidthToHeaders(),y._trigger("headerRefresh"),e("#"+y._id).addClass("e-treegrid-overflow"),y._viewPortHeight=y._getViewPortHeight(),e("#"+y._id).removeClass("e-treegrid-overflow"),"menu"==I.filterSettings.filterType&&0==y._renderedFilterMenuDialog.length?y._renderFilterMenu():"excel"==I.filterSettings.filterType&&y._renderExcelFilter(),y._frozenColumnsLength>0&&y._$gridContent.css("height",y._viewPortHeight),P.option("height","auto"==I.sizeSettings.height?0:y._viewPortHeight),I.enableVirtualization&&(C=I.currentViewData.length,T=I.rowHeight,C*(T+=I.showDetailsRow&&!I.showDetailsRowInfoColumn?I.detailsRowHeight:0)<y._viewPortHeight&&(C>0?(H-=y._viewPortHeight-(C-1)*T)<0&&(H=0):(y.processBindings(),y.renderRecords()))),I.showColumnChooser&&I.showColumnOptions&&y.columnAddDialogTemplate(),this.setWidthToColumns(),P.scrollY(H,!0),P.scrollX(M,!0),y._updateHeaderScrollLeft(M),y._updateScrollCss()}else"excel"==I.filterSettings.filterType&&(y._excelColTypes=[],y._excelFilter.resetExcelFilter(),y._excelFilter=null,y._renderExcelFilter());else{for(m={},e.extend(y.model.filterSettings,i[a]),h=y.model.filterSettings,g=t.isNullOrUndefined(h.filterBarMode)?"immediate":h.filterBarMode,_=e.extend([],h.filteredColumns),f=0;f<I.columns.length;f++)I.columns[f].allowFiltering&&y._clearFilterElementValue(I.columns[f]);for(h.filteredColumns=_,h.filterBarMode=g,m.requestType="filtering",w=0;w<_.length;w++)e("#"+y._id+"_"+_[w].field.split(".").join("")+"_filterbarcell").val(_[w].value);y._ensureDataSource(m),y._off(y.element,"keyup",".e-filterbarcell input",y._filterBarHandler),y._off(y.element,"click",".e-filterbarcell .e-checkbox",y._filterBarHandler),"immediate"==g&&(y._on(y.element,"keyup",".e-filterbarcell input",y._filterBarHandler),y._off(y.element,"click",".e-filterbarcell .e-checkbox")._on(y.element,"click",".e-filterbarcell .e-checkbox",y._filterBarHandler))}i.filterSettings.filterHierarchyMode&&y.clearFilter()}break;case"searchSettings":for(v in x=i[a])switch(v){case"searchHierarchyMode":y.model.searchSettings.searchHierarchyMode=x[v],y.element.find("input.e-searchinput").val(""),e("span.e-searchcancel").addClass("e-hide"),y.search("")}case"columnResizeSettings":this._initiateSetModel(),e.extend(I.columnResizeSettings,i[a]),this._updateGridResizeSettings(),I.columnResizeSettings.columnResizeMode==t.TreeGrid.ColumnResizeMode.FixedColumns?this._updateTableWidth():(this._frozenColumnsLength>0?(b=e(this.getHeaderTable()[1]),S=e(this.getContentTable()[1]),D=I.showTotalSummary?e(this._$footertableContent[1]):null):(b=this.getHeaderTable(),S=this.getContentTable(),D=I.showTotalSummary?e(this._$footertableContent[0]):null),b.css("width","").removeClass("e-tableLastCell"),S.css("width","").removeClass("e-tableLastCell"),D&&D.css("width","").removeClass("e-tableLastCell")),this._updateScrollCss();break;case"cssClass":for(this.element.removeClass(y._cssClass).addClass(i[a]),this.model.allowPaging&&e("#"+this._id+"Pager").ejPager("model.cssClass",i[a]),I.toolbarSettings.showToolbar&&e("#"+y._id+"_toolbarItems").ejToolbar("model.cssClass",i[a]),y._updateConfirmDialog&&y._updateConfirmDialog.data("ejDialog")&&y._updateConfirmDialog.ejDialog("model.cssClass",i[a]),R=0;R<y._renderedFilterMenuDialog.length;R++)"stringedit"==y._renderedFilterMenuDialog[R]?(e("#"+this._id+"filterStringMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[a]),e("#"+this._id+"filterStringMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[a]),e("#"+this._id+"filterStringMenuDiv_wrapper").find(".e-autocomplete").ejAutocomplete("model.cssClass",i[a])):"numericedit"==y._renderedFilterMenuDialog[R]?(e("#"+this._id+"filterNumericMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[a]),e("#"+this._id+"filterNumericMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[a]),e("#"+this._id+"filterNumericMenuDiv_wrapper").find(".e-numerictextbox").ejNumericTextbox("model.cssClass",i[a])):"datepicker"==y._renderedFilterMenuDialog[R]?(e("#"+this._id+"filterDatepickerMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[a]),e("#"+this._id+"filterDatepickerMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[a]),e("#"+this._id+"filterDatepickerMenuDiv_wrapper").find(".e-datepicker").ejDatePicker("model.cssClass",i[a])):"datetimepicker"==y._renderedFilterMenuDialog[R]?(e("#"+this._id+"filterDatetimePickerMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[a]),e("#"+this._id+"filterDatetimePickerMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[a]),e("#"+this._id+"filterDatetimePickerMenuDiv_wrapper").find(".e-datetimepicker").ejDateTimePicker("model.cssClass",i[a])):"#"+y._renderedFilterMenuDialog[R]=="dropdownedit"?(e("#"+this._id+"filterDropdownMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[a]),e("#"+this._id+"filterDropdownMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[a])):"#"+y._renderedFilterMenuDialog[R]=="booleanedit"&&(e("#"+this._id+"filterBooleanMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[a]),e("#"+this._id+"filterBooleanMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[a]));this.columnAddDialogTemplate(),e("#"+y._id+"ConfirmDialog_wrapper").find(".e-button").ejButton("model.cssClass",i[a]),this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&(t.isNullOrUndefined(y.model.editSettings.dialogEditorTemplateID)||""==y.model.editSettings.dialogEditorTemplateID)?y._treeGridAddEditDialog():this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&!t.isNullOrUndefined(y.model.editSettings.dialogEditorTemplateID)&&""!=y.model.editSettings.dialogEditorTemplateID&&y._treeGridAddEditDialogTemplate(),I.showColumnChooser&&this._renderColumnChooserList(!0),y._cssClass=i[a];break;case"enableLoadOnDemand":I.enableLoadOnDemand=i[a],y._refreshDataSource()}},_updateSummaryHeight:function(){var e,i,a,r,n=this,o=this.model,l=n.getScrollElement().ejScroller("instance"),d=l.scrollLeft(),s=l.scrollTop();e=s,n._frozenColumnsLength>0&&n._$gridContent.css("height",n._viewPortHeight),l.option("height","auto"==o.sizeSettings.height?0:n._viewPortHeight),o.enableVirtualization&&(i=o.currentViewData.length,a=o.rowHeight,i*(a+=o.showDetailsRow&&!o.showDetailsRowInfoColumn?o.detailsRowHeight:0)<n._viewPortHeight&&(i>0?(s-=n._viewPortHeight-(i-1)*a)<0&&(s=0):(n.processBindings(),n.renderRecords()))),l.scrollY(s,!0),l.scrollX(d,!0),n._updateHeaderScrollLeft(d),n._updateScrollCss(),n._updateWrapRowHeights("header","refreshAll"),e==s&&(n._updateCurrentViewData(),(r={}).requestType=t.TreeGrid.Actions.Refresh,n.sendDataRenderingRequest(r))},_initiateSetModel:function(){var e=this;e._saveEditedElements(),e._clearContextMenu(),e._clearColumnMenu(),e._removeDetailsRow()},_updateDetailsRowProperties:function(e){var i,a=this,r=this.model;(r.isEdit||this._isRowEdit)&&(this.cancelRowEditCell(),this._cancelSaveTools()),this.clearColumnMenu(),this._clearContextMenu(),this._removeDetailsRow(),a._detailsRowHeight=r.showDetailsRow&&r.detailsTemplate&&!r.showDetailsRowInfoColumn?r.detailsRowHeight:0,r.flatRecords.forEach(function(e){e.isDetailsExpanded=!(!r.showDetailsRow||!r.detailsTemplate)&&!r.showDetailsRowInfoColumn}),"detailsTemplate"!=e&&"detailsRowHeight"!=e||!r.showDetailsRowInfoColumn?(a._$gridHeaderContent.replaceWith(a._renderGridHeader()),a._addInitTemplate(),this.onScrollHelper(0),a.refreshContent(),a._isRendered=!1,(i={}).requestType=t.TreeGrid.Actions.Refresh,a.sendDataRenderingRequest(i),a.setWidthToColumns(),a._isRendered=!0,a._trigger("headerRefresh"),a._trigger("refresh"),this._eventBindings(),this._hideCollapsedDetailsRows(),a.getScrollElement().ejScroller("refresh"),a._updateScrollCss()):a._addInitTemplate(),a._updateWrapRowHeights(null,"refreshAll")},_hideCollapsedDetailsRows:function(){var t=this,i=this.model;i.showDetailsRow&&i.detailsTemplate&&!i.showDetailsRowInfoColumn&&(this._frozenColumnsLength>0?e(t.getTreeGridRows()[0]).add(t.getTreeGridRows()[1]).filter("tr.e-collapsedrowexpandeddetailsrow").css("display","none"):e(t.getTreeGridRows()).filter("tr.e-collapsedrowexpandeddetailsrow").css("display","none"))},_updateToolbar:function(){var t=this,i=t.model,a=t.getScrollElement().ejScroller("instance"),r=a.scrollLeft(),n=a.scrollTop();e("#"+t._id+"_toolbarItems").remove(),e("#"+t._id+"_toolbarItems_Main").remove(),i.toolbarSettings.showToolbar&&t._renderToolbarTemplate().insertBefore(e("#"+t._id+"e-gridheader")),i.isEdit&&t.cancelEditCell(),t._isRowEdit&&(t.cancelRowEditCell(),t._cancelSaveTools()),t._viewPortHeight=t._getViewPortHeight(),t._frozenColumnsLength>0&&t._$gridContent.css("height",t._viewPortHeight),a.option("height","auto"==i.sizeSettings.height?0:t._viewPortHeight),i.enableVirtualization&&(t.processBindings(),t.renderRecords()),a.option("scrollTop",n),a.option("scrollLeft",r),t._clearContextMenu(),this._removeDetailsRow()},_refreshDataSource:function(i){var a,r=this,n=this.model;(r._isRowEdit||r.model.isEdit)&&r.cancelRowEditCell(),r.resetModelCollections(),r._createdAt="load",i&&i.isUpdateColumns&&(r._validateColumnFields(),r._validateColumnVisible(!0),r._refreshFrozenColumns(!0)),r._dataManager=r.dataSource()instanceof t.DataManager?r.dataSource():null!=r.dataSource()?t.DataManager(r.dataSource()):null,this.dataSource()instanceof t.DataManager||this.dataSource()?(r._isForDataSourceRefresh=!0,r._initDatasource()):null==this.dataSource()&&((a={}).requestType=t.TreeGrid.Actions.RefreshDataSource,r._ensureDataSource(a),r._createdAt=null,(n.showSummaryRow||n.showTotalSummary)&&r._summaryRow()),e(".e-tooltiptable").remove()},refreshContent:function(){var e={};e.requestType=t.TreeGrid.Actions.Refresh,this.processBindings(e)},resetModelCollections:function(){var e=this,t=e.model;t.currentViewData=[],t.flatRecords=[],t.parentRecords=[],t.updatedRecords=[],t.summaryRowRecords=[],t.ids=[],e.secondaryDatasource=[],e._parentRecords=[],e._storedIndex=-1,e._idGenerator=-1,e._taskIds=[],e._jsonData=null,e._lastInsertedId=-1},_initPrivateProperties:function(){var i=this,a=this.model;i._isInManualExpandCollapse=!1,i._id=i.element.attr("id"),i.columnsWidthCollection=[],i._cSortedColumn=null,i._taskIds=[],i._maxZIndex=0,i._cSortedDirection=null,i._dataManager=null,i._persistCollapseState=!1,i._filteredRecords=[],i._disabledToolItems=[],i._currentFilterColumn=[],i._fieldColumnNames=[],i._multiSortRequest=null,i._$gridContainer=null,i._$gridContent=null,i._$gridContentTable=null,i._$gridHeaderTable=null,i._$gridHeaderContainer=null,i._$totalSummaryRowContainer=null,i._recordsCount=null,i._$gridRows=null,i._gridRows=null,i._commandColumnLength=0,this._frozenColumnsLength=0,i._initFrozenColumns(),i._allowFreezingDefault=this._frozenColumnsLength>0,i._calculateDimensions(),i._headerColumnNames=[],i._hiddenColumns=[],i._multiSelectCtrlRequest=!1,i._multiSelectShiftRequest=!1,i._ganttTouchTrigger=!1,i._moveRow=!1,i._draggedRecords=[],i._offset=0,i._previousIndex=-1,i._prevRBottom=0,i._prevRTop=0,i._prevScrollTop=0,i._prevScrollLeft=0,i._prevVBottom=0,i._resizer=null,i._scrollTop=0,i._scrollLeft=0,i._searchString="",i._fieldName="",i._selectedCellsinARow=[],i._currentRecordIndex=-1,i._sortedRecords=[],i._storedIndex=-1,i._rowIndex=-1,i._$tableContent=null,i._$footertableContent=null,i._$footerContainer=null,i._summaryExpanded=!0,i._tempsortedrecords=[],i._totalHeight=0,i._viewPortHeight=0,i._recordIndexCount=0,i._totalCollapsedRecordCount=0,i._visibleColumns=[],i._visibleRange=null,i._vScrollDir=1,i._vScrollDist=0,i._cellEditTemplate=e(),i._tooltipTimer,i._totalBorderWidth=2,i._totalBorderHeight=1,i._toolboxTooltipTexts=null,i._contextMenuTexts=null,i._columnMenuTexts=null,i._deleteColumnText=null,i._okButtonText=null,i._cancelButtonText=null,i._confirmDeleteText=null,i._dropDownListBlanksText=null,i._editTypeText=null,i._textAlignType=null,i._clipMode=null,i._dropDownListClearText=null,i._trueText=null,i._falseText=null,i._rowDragIndexes=[],i._dropCancel=!1,i._cellEditingDetails={cellValue:null,rowIndex:-1,columnIndex:-1,fieldName:null,_data:null,cellEditType:"",cancelSave:!1,defaultData:null,insertedTrCollection:[],data:null},i._previousSelectedCellDetails={rowElement:null,cellElement:null,cellIndex:-1,rowIndex:-1},i._shiftKeyFirstElementDetails={firstElementRowIndex:-1,firstElementCellIndex:-1},i._selectedCellDetails=[],i._focusingRowIndex=-1,i._rowIndexOfLastSelectedCell=-1,i._lastSelectedCellIndex=-1,i._isEnterKeyPressed=!1,i._isShiftKeyNavigation=!1,i._scrollBarHeight=18,i._removedCount=0,i._$gridHeaderContent=null,i.secondaryDatasource=[],i._contextMenuItems=null,i._subContextMenuItems=null,i._createContextMenuTemplate(),i._createColumnMenuTemplate(),i._retrivedData=this.dataSource(),i._createdAt="load",i._isInExpandCollapseAll=!1,i._isLoadonDemand=!1,i._assignedIdCollections=[],i._totalItemCounts=null,i._assignedParendIDs=[],i._fieldNamesToQuery=[],i._isForDataSourceRefresh=!1,i._allParentItems=[],i._queryForLoadonDemand=[],i._pageRecordCountOnDemand=null,i._isFromDemandMethod=!1,i._dataManager=i.dataSource()instanceof t.DataManager?i.dataSource():null!=i.dataSource()?t.DataManager(i.dataSource()):null,i._dragMouseDown=!1,i._dragTooltip=!1,i._dragMouseLeave=!1,i._timerDragDown=null,i._timerDragUp=null,i._isDataManagerUpdate=!1,i._jsonData=null,i._isRefreshAddedRecord=!1,i._isInAdd=!1,i._maxRowIndex=0,i._isRendered=!1,this._updateGridResizeSettings(),i.batchChanges={added:[],deleted:[],changed:[],updatedHierarchyRowIndexData:[]},i._batchEditCancel=!1,i._isSummaryRow=!1,i._flatChildRecords=[],i._footerSummaryRecord=[],i._filteredChildRecords=[],i._parentRecords=[],i._zerothLevelParentRecords=[],i._detailsRowHeight=0,a.showDetailsRow&&a.detailsTemplate&&!a.showDetailsRowInfoColumn&&(i._detailsRowHeight=a.detailsRowHeight),i._isEmptyRow=!1,i._prevSelectedItem=null,i._dataSourcefields=[],i._columnDialogTexts=null,i._columnDialogTitle=null,i._addColumnFields=[],i._addColumnFieldsTxt=[],i._targetColumnIndex=0,i._insertPosition=null,i._updateconfirmDialog=null,i._columnRenameDialog=null,i._renderedSubMenuType=null,i.localizedLabels=i._getLocalizedLabels(),i._gridRecordsCount=a.pageSettings.totalRecordsCount,i._gridPager=null,i._summaryRowsCount=0,i._updatedPageData=[],i._isNextPage=!1,a.selectionSettings.selectionType="single"!=a.selectionSettings.selectionType?a.selectionSettings.selectionType:"single"!=a.selectionType?a.selectionType:a.selectionSettings.selectionType,a.selectionSettings.selectionMode="row"!=a.selectionSettings.selectionMode?a.selectionSettings.selectionMode:"row"!=a.selectionMode?a.selectionMode:a.selectionSettings.selectionMode,i._idGenerator=-1,i._checkboxColumnName=null,i._isFromSetmodel=!1,i._flatFilteredRecords=[],i._checkboxSelection=a.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox&&a.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row,i._addCheckboxColumn=this._getDefaultCheckboxColumn(),i._filteredColumnValue=[],i._filteredColumnValueID=[],i._filterIconTarget=null,i._renderedFilterMenuDialog=[],i._filtermenutext=null,i._headerDragStatus="",i._draggedColumn=null,i._mouseDragged=!1,i.treeIndentLevelWidth=!t.isNullOrUndefined(a.indentLevelWidth)&&a.isFromGantt?a.indentLevelWidth:i.treeIndentLevelWidth?i.treeIndentLevelWidth:10,i._draggedColumnTemplate=null,i._viewPortWidth=i._gridLeft=0,i._responsiveMinWidth=768,i._dy=i._dx=0,i._isTouchEvent=!1,i._isTouchTrigger=!1,i._currentEditRecordDialogIndex=-1,i._isTreeAddEditDialogSave=!1,i._displayContextMenu=!!a.contextMenuSettings.showContextMenu,i._isEmptyRowDeleted=!1,i._cssClass=this.model.cssClass,i._batchEditStarts=!1,i._batchSaveCancel="",i._batchSaveConfirmText=null,i._batchSaveLostChangesText=null,i._cancelEditText=null,i._batchTempDetails={},i._autoHideColumns=[],i._autoShowColumns=[],i._textWrapRowsDatas=[],i._textWrapNoCalculate=!1,i._expandCollapsePages=[],i._expandCollapseSettings={state:"",atLevel:"",level:0},i._excelFilter=null,i._menuColTypes=[],i._excelColTypes=[],i._isExcelFilter=!1,i._customFilter=null,i._mediaStatus=!1,i._filterString="",i._isCloseFilterMenu=!1,i._isRemoteData=!1,i._lastInsertedId=-1,i._confirmDialog=null,i._shiftSelectedRecord=null,i._deleteRowIndex=-1,i._isFromContextmenu=!1,i._emptyRowIndex=-1},_getDefaultCheckboxColumn:function(){return{field:"checkboxState",headerText:"",allowEditing:!1,allowDelete:!1,allowSorting:!1,allowFiltering:!1,allowCellSelection:!1,isFrozen:!1,nonColumn:!0,editType:"booleanedit",width:50,textAlign:"center"}},_updateGridResizeSettings:function(){var e={resizeMode:"fixedcolumns"==this.model.columnResizeSettings.columnResizeMode?"control":this.model.columnResizeSettings.columnResizeMode};this.model.resizeSettings=e},_calculateDimensions:function(){var e,i,a=this,r=this.model;if(r.isFromGantt||(r.sizeSettings.width&&a.element.css("width",r.sizeSettings.width),r.sizeSettings.height?a.element.css("height",r.sizeSettings.height):a.element[0].style.height?r.sizeSettings.height=a.element[0].style.height:a.element.height(450)),a._gridHeight=Math.round(a.element.height()),a._gridWidth=Math.round(a.element.width()),this._frozenColumnsLength>0){for(e=0,i=0;i<=this._frozenColumnsLength;i++)r.columns[i]&&(e+=t.isNullOrUndefined(r.columns[i].width)?150:parseInt(r.columns[i].width));a._gridWidth<e&&(a.element.css("width",e),r.sizeSettings.width=a._gridWidth=e)}},_initFrozenColumns:function(){var i,a,r,n=[],o=[],l=0,d=0,s=this.model,c=s.columns;for(i=c[s.treeColumnIndex],s.showTotalSummary&&s.collapsibleTotalSummary&&(a=c[this._summaryColumnIndex]),r=0;r<c.length;r++)!0===c[r].isFrozen?(n.push(c[r]),(t.isNullOrUndefined(c[r].visible)||c[r].visible||c[r]==i)&&(l+=1)):(o.push(c[r]),(t.isNullOrUndefined(c[r].visible)||c[r].visible||c[r]==i)&&(d+=1));n.length>0&&(s.columns.length&&s.columns.length==n.length&&((o=n.splice(n.length-1,1))[0].isFrozen=!1),s.columns=e.merge(e.merge([],n),o)),this._frozenColumns=n,this._unFrozenColumns=o,0==l&&this._frozenColumns[0]&&(this._frozenColumns[0].visible=!0),0==d&&this._unFrozenColumns[0]&&(this._unFrozenColumns[0].visible=!0),i&&(s.treeColumnIndex=s.columns.indexOf(i)),s.showTotalSummary&&s.collapsibleTotalSummary&&(this._summaryColumnIndex=s.columns.indexOf(a)),this._frozenColumnsLength=n.length,s.scrollSettings.frozenColumns=this._frozenColumnsLength},updateAltRowOnCollapseAll:function(){var e,t,i,a=this.model;if(a.enableAltRow&&a.enableCollapseAll)for(e=a.parentRecords,i=0;i<e.length;i++)(t=e[i]).isSummaryRow||(t.isAltRow=i%2!=0)},updateAltRowOnRendering:function(){for(var e,t=this.model.updatedRecords.filter(function(e){return null==e.parentItem?e:e.parentItem.expanded?e:void 0}),i=0;i<t.length;i++)(e=t[i]).isSummaryRow||(e.isAltRow=i%2!=0)},_checkDataBinding:function(){var t=this,i=t.model;e("#"+t._id).addClass("e-treegrid-overflow"),t._createdAt=null,t.element.addClass("e-treegrid-core"),t.element.attr("tabindex","0"),i.cssClass&&this.element.addClass(i.cssClass),t._renderToolbar(),t._checkboxSelection&&t._updateCheckboxColumnName(),i.isFromGantt&&i.enableSerialNumber&&t._updateTreeColumnIndex(),t._renderAfterColumnInitialize(),(t.model.showColumnChooser||i.contextMenuSettings.showContextMenu)&&t._renderColumnChooser(),t.model.allowFiltering&&"menu"==i.filterSettings.filterType?t._renderFilterMenu():i.allowFiltering&&"excel"==i.filterSettings.filterType&&t._renderExcelFilter(),t._setWidthToHeaders(),t.model.allowPaging&&t.element.append(t._renderGridPager()),t._viewPortHeight=t._getViewPortHeight(),(t.model.editSettings.showConfirmDialog||t.model.editSettings.showDeleteConfirmDialog)&&t._renderConfirmDialog(),!i.isFromGantt&&t._viewPortHeight<0&&t._updateElementHeight(),t._searchString=i.searchSettings.key,t._ensureDataSource(),i.showSummaryRow&&t._createSummaryRow(),i.isFromGantt||t.updateAltRowOnCollapseAll(),i.expandStateMapping&&i.enableAltRow&&t.updateAltRowOnRendering(),t._initGridRender(),t._$gridContent=e("#"+t._id+"e-gridcontent"),t._$gridContainer=e("#"+t._id+"e-gridcontainer"),t._$tableContent=e("#"+t._id+"e-table"),t._$frozenTableContent=e("#"+t._id+"frozene-table"),t._$movableTableContent=e("#"+t._id+"movablee-table"),t._viewPortHeight=t._getViewPortHeight(),t._$gridContent.css({height:t._viewPortHeight+"px"}),t.element.find(".e-pager").css({width:t._gridWidth-2}),t._pagerHeight=t.element.find(".e-pager").outerHeight(),i.showTotalSummary&&(t._createTotalSummaryRow(),t._viewPortHeight=t._getViewPortHeight(),(!i.allowPaging||i.sizeSettings.height)&&(t._viewPortHeight-=t._$totalSummaryRowContainer.height()<i.totalSummaryHeight?t._$totalSummaryRowContainer.height():i.totalSummaryHeight,t._viewPortHeight=t._viewPortHeight-1)),t._updatePagerTextAlignment(),t._wireEvents(),t.setWidthToColumns(),t._trigger("headerRefresh"),t._renderScroller(),t._updateWrapRowHeights(),i.allowTextWrap&&i.enableVirtualization&&(t._textWrapRowsDatas=t._getAvgTextWrapRowHeight("getAvgHeight")),t.updateHeight(),t._updateScrollCss(),t._resizeFilteringElements(),t._updateFixedTableBorder(),t._initialEndRendering(),(i.allowTextWrap||"wrap"==i.headerTextOverflow)&&t._updateGridContentHeight(),i.isFromGantt&&t._addEmptyColumntoGrid(),i.isFromGantt?(t._isDataManagerUpdate=i.dataManagerUpdate.isDataManagerUpdate,t._jsonData=i.dataManagerUpdate.jsonData):t._checkDataManagerUpdate(),t.model.allowSelection&&"multiple"==t.model.selectionSettings.selectionType&&!t.model.isFromGantt&&t._renderMultiSelectionIndicator(),e("#"+t._id).removeClass("e-treegrid-overflow")},_renderMultiSelectionIndicator:function(){this._multiSelectPopup=t.buildTag("div.e-treegridpopup#"+this._id+"_selectionpopup","",{display:"none"});var e=t.buildTag("div.e-popupcontent"),i=t.buildTag("div.e-downtail e-tail"),a=t.buildTag("span.e-rowselect e-icon");e.append(a),this._multiSelectPopup.append(e),this._multiSelectPopup.append(i),this.element.append(this._multiSelectPopup)},getUpdatedDataManagerData:function(){return this._jsonData},_updateTreeColumnIndex:function(){var t,i,a=this.model,r=a.columns,n=+a.treeColumnIndex;e.map(r,function(e){if("taskId"==e.field)return t=e,!1}),(i=r.indexOf(t))==n&&(a.treeColumnIndex=i!=r.length-1?n+1:n-1)},_updateWrapRowHeights:function(e,i,a,r){var n,o=this,l=this.model;(l.allowTextWrap||"wrap"==l.headerTextOverflow)&&o._$frozenTableContent.length>0&&(o.getScrollElement().ejScroller("refresh"),"wrap"==l.headerTextOverflow&&(t.isNullOrUndefined(e)||-1==e.indexOf("header"))&&o._updateHeaderHeight(),l.allowTextWrap&&(t.isNullOrUndefined(e)||-1==e.indexOf("row"))&&(t.isNullOrUndefined(a)&&t.isNullOrUndefined(r)?o._updateRowHeight():o._updateRowHeight(a,r),l.showTotalSummary&&(t.isNullOrUndefined(e)||-1==e.indexOf("total"))&&o._updateTotalSummaryHeight(),o.getScrollElement().ejScroller("refresh"),n=o.getScrollElement().ejScroller("model.scrollTop"),o._getFrozenScrollElement().scrollTop(n))),"virtualRefresh"!=i||!l.allowTextWrap&&"wrap"!=l.headerTextOverflow?"refreshAll"==i&&(l.allowTextWrap||"wrap"==l.headerTextOverflow)&&(o.updateHeight(),o._updateGridContentHeight()):(l.allowTextWrap&&l.enableVirtualization&&o.updateHeight(),o._updateGridContentHeight()),"auto"==l.sizeSettings.height&&o._updateContentHeight()},_updateHeaderHeight:function(){var t=this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).find("tr")[0],i=this.getHeaderContent().find("#e-movableheaderdiv"+this._id).find("tr")[0];e(i).css("height","auto"),e(t).css("height","auto"),t.offsetHeight>i.offsetHeight?e(i).css("height",t.offsetHeight):i.offsetHeight>t.offsetHeight&&e(t).css("height",i.offsetHeight)},_updateTotalSummaryHeight:function(){for(var t,i,a=this,r=this.model,n=e(a._$footertableContent[0]).find("tr"),o=e(a._$footertableContent[1]).find("tr"),l=e(n).length,d=0;d<l;d++)e(o[d]).css("height",r.rowHeight),e(n[d]).css("height",r.rowHeight),(t=e(n[d]).height())>=(i=e(o[d]).height())?(e(o[d]).css("height",t),e(n[d]).css("height",t)):i>t&&(e(n[d]).css("height",i),e(o[d]).css("height",i));a._$totalSummaryRowContainer.hasClass("e-scroller")&&a._$totalSummaryRowContainer.ejScroller("refresh")},_updateRowHeight:function(i,a){var r;if(this.getRows().length>0){var n,o=this,l=this.model,d=0,s=0,c=0,u=0,p=[],h=[];for(t.isNullOrUndefined(i)?(s=0,u=o.getRows()[0]?o.getRows()[0].length:0,p=o.getRows()[0],h=o.getRows()[1]):(l.enableVirtualization&&"rowEdit"!=a&&(n=l.currentViewData[i],i=o.getUpdatedRecords().indexOf(n)),u=i+1,p[s=i]=e(t.TreeGrid.getRowByIndex(o,i)[0]),h[s]=e(t.TreeGrid.getRowByIndex(o,i)[1])),r=s;r<u;r++)(t.isNullOrUndefined(i)||"rowEdit"!=a&&"savecell"!=a)&&"resize"!=a||(e(p[r]).css("height",l.rowHeight),e(h[r]).css("height",l.rowHeight)),"rowEdit"!=a&&((d=e(p[r]).height())>=(c=e(h[r]).height())?(e(h[r]).css("height",d),e(p[r]).css("height",d)):c>d&&(e(p[r]).css("height",c),e(h[r]).css("height",c)))}},_checkDataManagerUpdate:function(){var e=this,i=this.dataSource();e._isDataManagerUpdate=!1,e._jsonData=null,i instanceof t.DataManager&&(i.dataSource.offline&&i.dataSource.json?(e._isDataManagerUpdate=!0,e._jsonData=i.dataSource.json):i.dataSource.offline||(e._isDataManagerUpdate=!0,e._jsonData=e._retrivedData))},_initDatasource:function(){var e,i,a=this,r=a.model;r.isFromGantt?(a._isLoadonDemand=r.isLoadonDemand,a._checkDataBinding()):this.dataSource()instanceof t.DataManager?(t.isNullOrUndefined(a._waitingPopupObj)?a._renderWaitingPopup():a._waitingPopupObj.show(),e=this.dataSource().adaptor instanceof t.UrlAdaptor||this.dataSource().adaptor instanceof t.WebMethodAdaptor||this.dataSource().adaptor instanceof t.WebApiAdaptor||this.dataSource().adaptor instanceof t.ODataAdaptor,i=0!=t.pvt.filterQueries(r.query.queries,"onTake").length||0!=t.pvt.filterQueries(r.query.queries,"onPage").length||0!=t.pvt.filterQueries(r.query.queries,"onWhere").length,a._isRemoteData=e,e&&!this.dataSource().dataSource.offline&&!i&&r.enableLoadOnDemand?(a._isLoadonDemand=!0,a._getAndRenderRecordsonDemand()):(a._isLoadonDemand=!1,r.query.requiresCount(),this.dataSource().executeQuery(r.query).done(t.proxy(function(e){a._renderQueriedRecords(e,a)})).fail(t.proxy(function(e){a._triggerFailureEvent(e,a)})))):this.dataSource()?(a._retrivedData=a.dataSource(),a._renderQueriedRecords(null,a,a._retrivedData)):a._checkDataBinding()},_intersectionObjects:function(e,t){for(var i,a=[];e.length>0&&t.length>0;)-1==(i=t.indexOf(e[0]))?e.shift():(a.push(e.shift()),t.splice(i,1));return a},_getAndRenderRecordsonDemand:function(){var i,a=this,r=a.model;r.query.requiresCount(),r.pageSettings.pageSizeMode=t.TreeGrid.PageSizeMode.Root,r.parentIdMapping?a._queryAndRenderParentRecords():(i=a._updateQueryForLoadonDemand(),a.dataSource().executeQuery(i).done(t.proxy(function(e){a._pageRecordCountOnDemand=e.count,a._renderQueriedRecords(e,a),a._setScrollTop(),a.updateHeight()})).fail(t.proxy(function(e){a._triggerFailureEvent(e,a)}))),a._allParentItems=e.extend([],r.parentRecords)},_renderWaitingPopup:function(){e(this.element).ejWaitingPopup({showOnInit:!0}),this._waitingPopupObj=e(this.element).data("ejWaitingPopup")},_renderQueriedRecords:function(e,i,a){var r,n,o=i.model;if(a)i._retrivedData=a;else if(i._retrivedData=e.result,0==i._fieldNamesToQuery.length&&i._retrivedData.length>0)for(r in e.result[0])i._fieldNamesToQuery.push(r);0==o.flatRecords.length&&(o.allowPaging&&o.parentIdMapping&&(i._isRemoteData?o.pageSettings.totalRecordsCount=e.count:t.isNullOrUndefined(o.pageSettings.totalRecordsCount)?o.pageSettings.totalRecordsCount=e&&!t.isNullOrUndefined(e.count)?e.count:null:i._retrivedData=i._retrivedData.splice(o.pageSettings.totalRecordsCount)),i._createQueriedRecords(i._retrivedData)),i._isForDataSourceRefresh?((n={}).requestType=t.TreeGrid.Actions.RefreshDataSource,i._ensureDataSource(n),o.isFromGantt||i._checkDataManagerUpdate(),-1!==i.selectedRowIndex()&&i.selectedRowIndex()<i.model.currentViewData.length&&i.selectRows(i.selectedRowIndex()),i.getScrollElement().hasClass("e-scroller")&&i.getScrollElement().ejScroller("refresh"),(o.showSummaryRow||o.showTotalSummary)&&i._summaryRow(),i._createdAt=null,i._isForDataSourceRefresh=!1):(o.showSummaryRow&&o.printingEnabled&&(i._parentRecords=i._getParentRecords(o.updatedRecords,i)),i._checkDataBinding()),e&&i._waitingPopupObj.hide()},_createQueriedRecords:function(i){var a,r,n,o=this,l=o.model;if(l.idMapping&&l.parentIdMapping&&i.length>0){for(a=[],o._taskIds=[],o._lastInsertedId=-1,r=0;r<i.length;r++)n=i[r],a.push(e.extend(!0,{},n)),t.isNullOrUndefined(n[l.idMapping])||(o._updateLastInsertedId(n[l.idMapping]),o._taskIds.push(n[l.idMapping]));o._reconstructDatasource(a),o._createRecords(o.secondaryDatasource)}else i&&o._createRecords(i)},_queryAndRenderParentRecords:function(){var i,a,r=this,n=r.model;n.hasChildMapping?r._renderRootRecords(r):0==r._assignedIdCollections.length&&0==r._assignedParendIDs.length?(i=t.Query(),a=t.pvt.filterQueries(n.query.queries,"onSelect"),i.queries=e.extend([],n.query.queries),i.requiresCount(),a.length>0&&i.queries.splice(e.inArray(a[0],i.queries),1),i.select(n.parentIdMapping,n.idMapping),this.dataSource().executeQuery(i).done(t.proxy(function(e){e.result.map(function(e){r._assignedIdCollections.push(e[n.idMapping]),e[n.parentIdMapping]&&-1==r._assignedParendIDs.indexOf(e[n.parentIdMapping])&&r._assignedParendIDs.push(e[n.parentIdMapping])}),r._totalItemCounts=e.result.length,r._renderRootRecords(r)})).fail(t.proxy(function(e){r._triggerFailureEvent(e,r)}))):r._renderRootRecords(r)},_renderRootRecords:function(e){var i=e._updateQueryForLoadonDemand();e.dataSource().executeQuery(i).done(t.proxy(function(t){e._renderZerothLevelParentItems(t)})).fail(t.proxy(function(t){e._triggerFailureEvent(t,e)}))},_renderExpandedChildRecords:function(e){var t=this,i=t.model;t._ensureDataSource(e),i.showSummaryRow&&(t._parentRecords=t._allParentItems,t._createSummaryRow()),i.enableAltRow&&t.updateAltRow(),t.sendDataRenderingRequest(e),t._setScrollTop(),t.updateHeight(),t._waitingPopupObj.hide()},_triggerFailureEvent:function(e,t){t._waitingPopupObj.hide();var i={error:e.error};t._trigger("actionFailure",i)},_renderZerothLevelParentItems:function(t){var i=this,a=i.model;i._pageRecordCountOnDemand=t.count,i._renderQueriedRecords(t,i),i._allParentItems=e.extend([],a.parentRecords),i._isForDataSourceRefresh=!1,i._maxRowIndex=i._totalItemCounts},_updateQueryForLoadonDemand:function(){var i=this,a=i.model,r=new t.Query,n=t.Predicate(a.parentIdMapping,t.FilterOperators.equal,null);return r.queries=e.extend([],a.query.queries),a.parentIdMapping&&r.where(n),a.allowPaging&&r.page(i._currentPage(),i.model.pageSettings.pageSize),r.requiresCount(),i._queryForLoadonDemand=r,r},_reconstructDatasource:function(e){var i,a,r,n,o,l=this,d=l.model;for(a=t.Predicate(d.parentIdMapping,t.FilterOperators.notEqual,"null"),i=t.DataManager(e).executeLocal(t.Query().where(a).group(d.parentIdMapping)),r=[],d.childMapping||(d.childMapping="Children"),n=0;n<i.length;n++)!t.isNullOrUndefined(i[n].key)&&(o=l._taskIds.indexOf(i[n].key))>-1?e[o][d.childMapping]=d.hierarchyRowIndexMapping&&i[n].items.length>1?t.DataManager(i[n].items).executeLocal(t.Query().sortBy(d.hierarchyRowIndexMapping,t.sortOrder.Ascending,!1)):i[n].items:r.push.apply(r,i[n].items);l.secondaryDatasource=l._intersectionObjects(e,r),d.hierarchyRowIndexMapping&&l.secondaryDatasource.length>1&&(l.secondaryDatasource=t.DataManager(l.secondaryDatasource).executeLocal(t.Query().sortBy(d.hierarchyRowIndexMapping,t.sortOrder.Ascending,!1)))},_windowResize:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_,f;if(this.element.is(":visible")){i=this,a=this.model,e("#"+i._id).addClass("e-treegrid-overflow");var w,C,T,x=i._$gridHeaderContent,v=i._$totalSummaryRowContainer,b=e("#"+i._id+"_toolbarItems"),S=a.sizeSettings.height,D=a.sizeSettings.width,R=i.element[0].style.width,y=i.element[0].style.height;if(i._clearContextMenu(),i.model.isResponsive||t.isTouchDevice()?t.isTouchDevice()||i._clearColumnMenu("resize"):(i._clearColumnMenu(),i._clearFilterMenu()),a.isResponsive&&i._isExcelFilter&&(i._checkBoxDiv&&i._checkBoxDiv.ejScroller({width:"100%"}).ejScroller("refresh"),i._customFilter&&i._customFilter.ejDialog("width","99.9%")),w=this._frozenColumnsLength>0?this.element.find("#e-movablecontainer"+this._id):e("#"+i._id+"e-gridcontent"),e("#"+this._id+"detailscellwrapper").length>0&&this._removeDetailsRow(),D&&"number"!=typeof D&&-1!=D.indexOf("%")||-1!=R.indexOf("%")){var I=D||R;C=(e(i.element).parent().width()?e(i.element).parent().width():e(i.element).width())/100*parseInt(I)}else C=e(i.element).width();if(i._gridWidth=Math.round(C),i._frozenColumnsLength>0){for(h=0,g=0;g<i._frozenColumnsLength;g++)1==a.columns[g].visible&&(h+=i.columnsWidthCollection[g]);C<h&&(i._gridWidth=C=h)}if(S&&"number"!=typeof S&&-1!=S.indexOf("%")||-1!=y.indexOf("%")?(r=S||y,n=e(i.element).parent().height()?e(i.element).parent().height():e(i.element).height(),T=e(i.element).parent().height()?n/100*parseInt(r):e(i.element).height()):T=e(i.element).height(),T-=i._totalBorderHeight,i._$totalSummaryRowContainer&&(T-=i._$totalSummaryRowContainer.outerHeight()),C=Math.round(C-i._totalBorderWidth),d=b.length>0?b.outerHeight():0,o=w.ejScroller("option","scrollTop"),l=w.ejScroller("option","scrollLeft"),s=C,c=0,a.allowPaging&&(u=i.element.find(".e-pager").outerHeight(),p=!t.isNullOrUndefined(a.pageSettings.template),T-=u,!a.sizeSettings.height)){for(h=0,u>i._pagerHeight&&!p&&(c=u-i._pagerHeight),g=0;g<i.columnsWidthCollection.length;g++)h+=i.columnsWidthCollection[g];h>i._gridWidth&&(T+=i._scrollBarHeight)}this._frozenColumnsLength>0&&(i._$gridContent.css("width",C),i._$gridContent.css("height",T-e(x).outerHeight()-d),s=C-this._getFrozenColumnWidth()-1),i.getScrollElement().ejScroller({width:s,height:T-e(x).outerHeight()-d+c}),i._updateScrollCss(),a.showTotalSummary&&i._$totalSummaryRowContainer&&(i._$totalSummaryRowContainer.height()>=a.totalSummaryHeight&&i._$totalSummaryRowContainer.hasClass("e-scroller")?i._$totalSummaryRowContainer.ejScroller("refresh"):e(v).hasClass("e-scrollcss")&&i.getScrollElement().children(".e-vscrollbar").length>0?e(v).width(C-17):e(v).width(C)),a.toolbarSettings.showToolbar&&b.length>0&&b.width(C),i.getScrollElement().ejScroller("refresh"),e(x).hasClass("e-scrollcss")&&i.getScrollElement().children(".e-vscrollbar").length>0?e(x).width(C-17):e(x).width(C),i.updateViewPortHeight(),a.showTotalSummary&&(i._viewPortHeight=i._viewPortHeight-i._$totalSummaryRowContainer.outerHeight()),i.getScrollElement().ejScroller("option","scrollTop",o),i.getScrollElement().ejScroller("option","scrollLeft",l),i._updateHeaderScrollLeft(),a.enableVirtualization&&(i.cancelRowEditCell(),m={},_=a.rowHeight,m.requestType=t.TreeGrid.Actions.Refresh,i.processBindings(m),i.sendDataRenderingRequest(m),a.showDetailsRow&&a.detailsTemplate&&!a.showDetailsRowInfoColumn&&(_+=a.detailsRowHeight),a.currentViewData.length*_<i._viewPortHeight&&((f=o-(i._viewPortHeight-a.currentViewData.length*_))<0&&(f=0),i.getScrollElement().ejScroller("scrollY",f,!0))),a.allowPaging&&i.element.find(".e-pager").css({width:i._gridWidth-2}),i._resizeFilteringElements(),a.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||a.isFromGantt||this._updateTableWidth(!0),i.model.isResponsive&&!i.model.isFromGantt&&i._mediaQueryUpdate(),i._updatePagerTextAlignment(),i._updateWrapRowHeights(null,"virtualRefresh",null,"resize"),a.allowPaging&&!a.sizeSettings.height&&i.updateHeight(),(a.allowTextWrap||"wrap"==a.headerTextOverflow)&&i.model.allowTextWrap&&i.model.enableVirtualization&&i.updateHeight(),i._updateGridContentHeight(),i.model.allowSelection&&"multiple"==i.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&i._alignMultiSelectPopup(),e("#"+i._id).removeClass("e-treegrid-overflow"),a.isResponsive&&a.enableResize&&(i._validateColumnVisible(),i._hideColumns(i._autoHideColumns),i._showColumns(i._autoShowColumns))}},_updatePagerTextAlignment:function(){var t,i,a=this;a.model.allowPaging&&(e("#"+a._id+"Pager").find(".e-pagercontainer").outerWidth()+e("#"+a._id+"Pager").find(".e-parentmsgbar").outerWidth()+10>e("#"+a._id).width()?(t=(e("#"+a._id).width()-e("#"+a._id+"Pager").find(".e-pagercontainer").outerWidth())/2,i=(e("#"+a._id).width()-e("#"+a._id+"Pager").find(".e-parentmsgbar").width())/2,t>0&&e("#"+a._id+"Pager").find(".e-pagercontainer").css("margin-left",t+"px"),i>0&&e("#"+a._id+"Pager").find(".e-parentmsgbar").css("margin-right",i-6+"px")):(e("#"+a._id+"Pager").find(".e-pagercontainer").css("margin-left",""),e("#"+a._id+"Pager").find(".e-parentmsgbar").css("margin-right","")))},_alignMultiSelectPopup:function(){var e,t,i=this,a=i._$gridContent.offset().top+i._$gridContent.outerHeight(),r=i._$gridContent.offset().left+i._$gridContent.outerWidth();(i._multiSelectPopup.offset().top+i._multiSelectPopup.outerHeight()+10>a||i._multiSelectPopup.offset().top<i._$gridContent.offset().top||i._multiSelectPopup.offset().left+i._multiSelectPopup.outerWidth()>r||i._multiSelectPopup.offset().left<i._$gridContent.offset().left)&&(e=i._$gridContent.offset().top+i._$gridContent.outerHeight()/2,t=i._$gridContent.offset().left+i._$gridContent.outerWidth()/2,i._$gridContent.find(".e-hscrollbar").length>0&&(e-=i._$gridContent.find(".e-hscrollbar").outerHeight()),i._$gridContent.find(".e-vscrollbar").length>0&&(t-=i._$gridContent.find(".e-vscrollbar").outerWidth()),i._multiSelectPopup.offset({top:e-this._multiSelectPopup.height()/2-5,left:t-this._multiSelectPopup.width()/2}))},_mediaQueryUpdate:function(){var i,a,r,n,o=this,l="",d=o.getOffsetRect(e("#"+o._id)[0]);e("#"+o._id+"_dialogColumnAdd_wrapper").length>0&&"none"!=e("#"+o._id+"_dialogColumnAdd_wrapper").css("display")&&(e(window).width()<=o._responsiveMinWidth&&o.model.isResponsive?(e("#"+o._id+"_dialogColumnAdd").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css("width",e("#"+o._id).width()-80+"px"),e("#"+o._id+"_dialogColumnAdd").ejDialog({width:e("#"+o._id).width()+"px",height:e("#"+o._id).height()+"px",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,allowDraggable:!1,enableModal:!1,isResponsive:!1}),e("#"+o._id+"_dialogColumnAdd_wrapper").css({left:d.left+"px",top:d.top+"px"}),e("#"+o._id+"_dialogColumnAdd_wrapper").removeClass("e-shadow"),e("#"+o._id+"_dialogColumnAdd").removeClass("e-shadow")):(e("#"+o._id+"_dialogColumnAdd").ejDialog({width:"auto",height:"auto",minHeight:0,minWidth:0,showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0}),e("#"+o._id+"_dialogColumnAdd").addClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").addClass("e-treegridadaptivedialog e-treegrid-dialog"),e("#"+o._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css("width","438px"),e("#"+o._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").addClass("e-shadow"))),e("#"+o._id+"ColumnRenameDialog_wrapper").length>0&&"none"!=e("#"+o._id+"ColumnRenameDialog_wrapper").css("display")&&(e(window).width()<=o._responsiveMinWidth&&o.model.isResponsive?(e("#"+o._id+"ColumnRenameDialog").removeClass("e-treegridadaptivedialog"),o._columnRenameDialog.ejDialog({width:e("#"+o._id).width()+"px",height:e("#"+o._id).height()+"px",position:{X:d.left,Y:d.top},minHeight:"50px",minWidth:"50px",showOnInit:!1,allowDraggable:!1,enableResize:!1,enableModal:!1,isResponsive:!1}),e("#"+o._id+"ColumnRenameDialog_wrapper").css({left:d.left+"px",top:d.top+"px"}),e("#"+o._id+"ColumnRenameDialog_wrapper").removeClass("e-shadow"),e("#"+o._id+"ColumnRenameDialog").removeClass("e-shadow"),e("#"+o._id+"ColumnRenameDialog_wrapper").removeClass("e-treegridadaptivedialog")):(o._columnRenameDialog.ejDialog({width:"auto",height:"auto",minHeight:0,minWidth:0,showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0}),e("#"+o._id+"ColumnRenameDialog").addClass("e-treegridadaptivedialog"),e("#"+o._id+"ColumnRenameDialog_wrapper").addClass("e-treegridadaptivedialog e-treegrid-dialog"))),o._renderedSubMenuType?(l="",-1==o._renderedSubMenuType.indexOf("Desktop")?l=o._renderedSubMenuType:(i=o._renderedSubMenuType.indexOf("Desktop"),l=o._renderedSubMenuType.slice(0,i)),e(l+"_wrapper").length>0&&"none"!=e(l+"_wrapper").css("display")?e(window).width()<=o._responsiveMinWidth&&-1==o._renderedSubMenuType.indexOf("Desktop")&&o.model.isResponsive?(n=e("#"+o._id).height()-50+"px",e(o._renderedSubMenuType+"_wrapper").find("div.e-dialog-scroller").addClass("e-treegridadaptivewidth"),e(o._renderedSubMenuType).ejDialog({width:e("#"+o._id).width()+"px",height:e("#"+o._id).height()+"px",position:{X:d.left+"px",Y:d.top+"px"},minHeight:"50px",minWidth:"50px",showOnInit:!1,enableResize:!1,enableModal:!1,isResponsive:!1}),e(o._renderedSubMenuType).height()>e(o._renderedSubMenuType+"_wrapper").height()-48?(e(o._renderedSubMenuType+"_wrapper").find("div.e-dialog-scroller").css({height:e("#"+o._id).height()-48+"px",width:"auto",padding:"0px"}),e(o._renderedSubMenuType).ejDialog("refresh")):e(o._renderedSubMenuType+"_wrapper").find("div.e-dialog-scroller").css({height:n,width:"auto"})):t.isTouchDevice()?(-1==o._renderedSubMenuType.indexOf("Desktop")&&e(window).width()>o._responsiveMinWidth||-1!=o._renderedSubMenuType.indexOf("Desktop")&&e(window).width()<=o._responsiveMinWidth)&&(o._clearColumnMenu(),o._clearFilterMenu()):o._clearFilterMenu():(t.isTouchDevice()&&!o._renderedSubMenuType||t.isTouchDevice()&&e(l+"_wrapper").length>0&&"none"==e(l+"_wrapper").css("display"))&&o._clearColumnMenu()):(t.isTouchDevice()&&!o._renderedSubMenuType||t.isTouchDevice()&&e(l+"_wrapper").length>0&&"none"==e(l+"_wrapper").css("display"))&&o._clearColumnMenu(),o._isExcelFilter&&(a=e(window).width()>o._responsiveMinWidth,(!o._mediaStatus||o._mediaStatus&&a)&&(o._excelFilter.closeXFDialog(),o._mediaStatus=!1,o._customFilter&&(r=e(o._customFilter).attr("id"),e("#"+r).css("display","none"),e("#"+r+"_CustomFDlg_wrapper").css("display","none")))),e("#"+o._id+"ccDiv_wrapper").length>0&&"none"!=e("#"+o._id+"ccDiv_wrapper").css("display")&&(e(window).width()<o._responsiveMinWidth&&0==o._renderedSubMenuType.indexOf("AdaptiveColChooser")&&o.model.isResponsive?(n=e("#"+o._id).height()-66+"px",e("#"+o._id+"ccDiv").ejDialog({width:e("#"+o._id).width()+"px",height:e("#"+o._id).height()+"px",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,enableModal:!1,isResponsive:!1}),e("#"+o._id+"ccDiv_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"ccDiv").css({width:"100%",height:"auto"}),e("#"+o._id+"ccDiv").height()>e("#"+o._id+"ccDiv_wrapper").height()-48?(e("#"+o._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:e("#"+o._id).height()-48+"px",width:"auto",padding:"0px"}),e("#"+o._id+"ccDiv").removeClass("e-columnSelector"),e("#"+o._id+"ccDiv").ejDialog("refresh")):(e("#"+o._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:n,width:"auto",padding:"8px 16px"}),e("#"+o._id+"ccDiv").css({padding:"0px"})),e("#"+o._id+"ccDiv_wrapper").removeClass("e-shadow"),e("#"+o._id+"ccDiv").removeClass("e-shadow")):o._clearColumnMenu()),e("#"+o._id+"_dialogEdit").length>0&&"none"!=e("#"+o._id+"_dialogEdit").css("display")&&(e(window).width()<=o._responsiveMinWidth&&o.model.isResponsive?(e("#"+o._id+"_dialogEdit").ejDialog({width:e("#"+o._id).width()+"px",height:e("#"+o._id).height()+"px",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,allowDraggable:!1,enableModal:!1,isResponsive:!1}),e("#"+o._id+"_dialogEdit_wrapper").css({left:d.left+"px",top:d.top+"px"}),e("#"+o._id+"_dialogEdit_wrapper").removeClass("e-shadow").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogEdit").removeClass("e-shadow")):(e("#"+o._id+"_dialogEdit").ejDialog({width:"auto",height:"auto",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0}),e("#"+o._id+"_dialogEdit_wrapper").addClass("e-shadow").addClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogEdit").addClass("e-shadow"))),o._renderedSubMenuType&&(0==o._renderedSubMenuType.indexOf("AdaptiveColChooser")||0==o._renderedSubMenuType.indexOf("ColumnDesktop"))&&o._clearColumnMenu()},updateResponsiveMinWidth:function(e){parseInt(e)<150&&(e=150),this._responsiveMinWidth=parseInt(e),this._mediaQueryUpdate()},processBindings:function(i){var a=this;if(a.model.query=new t.Query,!a._isEmptyRow&&!a._moveRow&&a._trigger("actionBegin",i))return"filtering"==i.requestType&&e("#"+a._id+"_"+i.currentFilteringColumn+"_filterbarcell").val(""),!0;a._ensureDataSource(i)},setUpdatedRecords:function(e,t,i,a,r){var n=this.model;n.flatRecords=e,n.updatedRecords=t,n.ids=i,n.parentRecords=a,this.dataSource(r)},getExpandedRecords:function(e){var t=this;return e.filter(function(e){return 1==t.getExpandStatus(e)})},updateExpandStatus:function(e,t){for(var i=e.childRecords,a=0;a<i.length;a++)i[a].isExpanded=t,i[a].hasChildRecords&&i[a].expanded&&this.updateExpandStatus(i[a],t)},_ensureDataSource:function(i){var a,r,n,o,l,d,s,c=this,u=c.model,p=u.sortSettings.sortedColumns,h=u.filterSettings.filteredColumns,g=!1,m=this.dataSource(),_=e("#"+c._id.replace("ejTreeGrid","")).data("ejGantt");if(c._filteredRecords=[],c._flatFilteredRecords=[],u.query.requiresCount(),c._queryManagar=new t.Query,c._queryManagar.requiresCount(),"array"===e.type(m)||m instanceof t.DataManager||(this.dataSource([]),m=this.dataSource()),!i||i.requestType!==t.TreeGrid.Actions.ExpandCollapse||(g=!0,c._filteredRecords=[],i.data.expanded=i.expanded,t.isNullOrUndefined(i.data.item[u.expandStateMapping])||(i.data[u.expandStateMapping]=i.expanded,i.data.item[u.expandStateMapping]=i.expanded),u.updatedRecords=[],c._flatFilteredRecords=u.flatRecords,c._filteredRecords=c._flatFilteredRecords.filter(function(e){return 1==c.getExpandStatus(e)}),u.updatedRecords=c._filteredRecords,!i.isFromExpandCollapse||i.isLastRefresh)){if(i&&"filtering"==i.requestType||(u.allowFiltering||u.isFromGantt)&&h.length){if(u.showSummaryRow&&(u.updatedRecords=c._spliceSummaryRows(u.updatedRecords),u.flatRecords=c._spliceSummaryRows(u.flatRecords)),(u.allowFiltering||u.isFromGantt)&&h.length){if(r=h[0],!c._isExcelFilter||r instanceof t.Predicate)for(r.value==c._dropDownListBlanksText?a=(a=t.Predicate(r.field,"equal",null,!0)).or(r.field,"equal","",!0):a=r.value==c._dropDownListClearText?t.Predicate(r.field,"equal","",!0):r.isComplex?r:t.Predicate(r.field,r.operator,r.value,!r.matchcase),t.isNullOrUndefined(i)&&c._storePreviousFilteredValue(r.field,r.value,r.operator),n=1;n<h.length;n++)a=h[n].isComplex?a.and(h[n]):a[h[n].predicate](h[n].field,h[n].operator,h[n].value,!h[n].matchcase),t.isNullOrUndefined(i)&&c._storePreviousFilteredValue(h[n].field,h[n].value,h[n].operator);else a=c._getExcelPredicate(i);c._queryManagar.where(a),c._filteredRecords=u.flatRecords.slice(),f=new t.DataManager(c._filteredRecords),c._tempfilteredrecords=f.executeLocal(c._queryManagar).result,c._updateFilteredRecords(c._tempfilteredrecords,!1),u.updatedRecords=c._isHierarchyFiltering&&u.enableVirtualization?c._updateFilterParent:c._filteredRecords,u.allowPaging&&u.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(u.parentRecords=c._getParentRecords(u.updatedRecords,c,!0)),u.allowSorting&&u.sortSettings.sortedColumns.length>0&&c._sortingRecords()}else u.updatedRecords=u.enableVirtualization?c.getExpandedRecords(u.flatRecords):u.flatRecords.slice(),c._updateHasFilteredChildRecordsStatus(u.updatedRecords),c._isHierarchyFiltering&&c._clearFilterLevel(c.model.flatRecords),u.allowPaging&&u.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(u.parentRecords=c._getParentRecords(u.updatedRecords,c,!0)),c._isExcelFilter&&c._getExcelPredicate(i);u.allowSearching&&0!=c._searchString.length||c._updatedFilteredRecords(i),g=!0}if(u.allowSearching&&c._searchString.length||i&&"searching"===i.requestType?(u.showSummaryRow&&(u.updatedRecords=c._spliceSummaryRows(u.updatedRecords),u.flatRecords=c._spliceSummaryRows(u.flatRecords)),o=c._searchString.length>0?u.searchSettings.operator:"contains",c._queryManagar.search(c._searchString,c.getColumnFieldNames(),o,!0),"parent"==u.filterSettings.filterHierarchyMode||c._searchString.length>0||0==u.filterSettings.filteredColumns.length?(l=!0,c._filteredRecords=u.isFromGantt?u.flatRecords.filter(function(e){return!1===e.hasChildRecords}):u.flatRecords.slice()):l=!1,u.isFromGantt&&(_.model.searchSettings={fields:c._getColumnMappingNames(),key:c._queryManagar.queries[0].e.searchKey,operator:"contains",ignoreCase:!0}),f=new t.DataManager(c._filteredRecords),c._tempfilteredrecords=f.executeLocal(c._queryManagar).result,c._updateFilteredRecords(c._tempfilteredrecords,l),u.updatedRecords=c._filteredRecords,u.allowPaging&&u.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(u.parentRecords=c._getParentRecords(u.updatedRecords,c,!0)),c._isLoadonDemand&&0==c._searchString.length&&0==c._filteredRecords&&(u.updatedRecords=u.flatRecords),u.allowSorting&&u.sortSettings.sortedColumns.length>0&&c._sortingRecords(),c._updatedFilteredRecords(i),g=!0,c.clearSelection()):(u.allowSorting&&p.length>0||i&&"sorting"==i.requestType)&&(c._sortingRecords(),u.showSummaryRow&&c._createSummaryRow(i),g||(c.updateCollapsedRecordCount(),c.updateHeight(),g=!0)),i&&("outdent"===i.requestType||"indent"===i.requestType)&&((i={}).requestType=t.TreeGrid.Actions.Refresh,g=!0),i&&u.allowPaging&&"delete"==i.requestType&&(d={},c._isLoadonDemand||(d.totalRecordsCount=c.getExpandedRecords(u.flatRecords).length,c.getPager().ejPager("option",d).ejPager("refreshPager"),s=this.getPager().ejPager("model"),c._currentPage()>s.totalPages&&c._currentPage(s.totalPages),g=!0)),g||(c._zerothLevelParentRecords=u.parentRecords.slice(),u.updatedRecords=u.enableVirtualization?u.enableCollapseAll&&!i?c._zerothLevelParentRecords:c.getExpandedRecords(u.flatRecords):u.flatRecords.slice(),c.updateCollapsedRecordCount(),c.updateHeight()),i||((i={}).requestType=u.allowPaging?t.TreeGrid.Actions.Paging:t.TreeGrid.Actions.Refresh,i.inital=!0),c._updateCurrentViewData(i.requestType),!t.isNullOrUndefined(u.printingEnabled)&&u.printingEnabled&&"currentPage"==u.pageSettings.printMode){var f,w=this.getExpandedRecords(u.updatedRecords),C=(f=new t.DataManager(w)).executeLocal(u.query);u.currentViewData=C.result}(u.isFromGantt||"save"!==i.requestType)&&"sorting"!==i.requestType&&"searching"!==i.requestType&&"delete"!==i.requestType&&"refreshDataSource"!==i.requestType&&"filtering"!==i.requestType&&"dragAndDrop"!==i.requestType&&"rowIndexUpdate"!==i.requestType&&(i.inital||"paging"!==i.requestType)||(c._isRefreshAddedRecord=!1,c.renderRecords(i),c._updateWrapRowHeights(null,"refreshAll"),c._setScrollTop(i.requestType),c._updateFixedTableBorder(i.requestType),c.getScrollElement().ejScroller("refresh"),c._updateScrollCss())}},_updatedFilteredRecords:function(t){var i=this,a=i.model;t&&("filtering"==t.requestType||"searching"==t.requestType)&&i._checkboxSelection&&a.selectionSettings.enableHierarchySelection&&("filtering"==t.requestType||"searching"==t.requestType)&&(e.each(a.updatedRecords,function(e,t){t.hasChildRecords&&i._updateParentSelection(t)}),i.selectAllRows()),a.showSummaryRow&&i._createSummaryRow(t),t&&a.showTotalSummary&&i._updateTotalSummaryRow(t),i.updateCollapsedRecordCount(),i.updateHeight(),a.enableAltRow&&i.updateAltRow()},_removeChildRecords:function(e,i){var a,r=this,n=r.model,o=t.isNullOrUndefined(i.childRecords)?[]:i.childRecords,l=e.indexOf(i);for(l>-1&&(i.checkboxState="unchecked",e.splice(l,1)),a=0;a<o.length;a++)o[a].hasChildRecords?r._removeChildRecords(e,o[a]):(l=e.indexOf(o[a]))>-1&&(o[a].checkboxState="unchecked",e.splice(l,1));i.parentItem&&n.selectionSettings.enableHierarchySelection&&r._updateParentSelection(i.parentItem)},_removeChildItem:function(e){for(var i,a,r=this,n=0;n<e.childRecords.length;n++)i=e.childRecords[n],this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json?(-1!==(a=this.dataSource().dataSource.json.indexOf(i.item))&&this.dataSource().dataSource.json.splice(a,1),i.hasChildRecords&&r._removeChildItem(i)):r._isDataManagerUpdate&&(-1!==(a=r._jsonData.indexOf(i.item))&&r._jsonData.splice(a,1),i.hasChildRecords&&r._removeChildItem(i)):(-1!==(a=this.dataSource().indexOf(i.item))&&this.dataSource().splice(a,1),i.hasChildRecords&&r._removeChildItem(i))},_updateCheckboxColumnName:function(){var e,i,a,r=this,n=r.model;if(r._checkboxSelection&&!n.rowTemplateID&&!n.altRowTemplateID){if(e=n.columns.filter(function(e){return 1==e.showCheckbox}),r._addCheckboxColumn=this._getDefaultCheckboxColumn(),r._checkboxColumnName=e.length>0?e[0].isTemplateColumn?null:e[0].field:null,t.isNullOrUndefined(r._checkboxColumnName)){if(i=n.columns[n.treeColumnIndex],n.columns[0].nonColumn)r._checkboxColumnName=n.columns[0].field;else{for(a=0;a<n.columns.length;a++)1==n.columns[a].nonColumn&&n.columns.splice(a,1);n.columns.splice(0,0,r._addCheckboxColumn),r._checkboxColumnName=r._addCheckboxColumn.field}i&&(n.treeColumnIndex=n.columns.indexOf(i))}r._frozenColumnsLength>0&&!n.columns[0].isFrozen&&r._checkboxColumnName==r._addCheckboxColumn.field&&(n.columns[0].isFrozen=!0,r._frozenColumnsLength+=1,r._frozenColumns.splice(0,0,n.columns[0]),n.scrollSettings.frozenColumns=this._frozenColumnsLength)}},batchSave:function(){var e,t,i,a=this,r=a.model,n={},o=a.batchChanges,l=o.changed,d=o.deleted,s=o.added;if(n.type="beforeBatchSave",n.batchChanges=o,a._trigger("beforeBatchSave",n))return!0;for((e=r.filterSettings.filteredColumns)&&e.length>0&&a.clearFilter(),t=0;t<l.length;t++)delete l[t].batchEditedFields;for(i=0;i<s.length;i++)delete s[i].isBatchAdd,s[i].batchEditedFields&&delete s[i].batchEditedFields;d.length&&a.deleteRow(),a._batchEditStarts&&(a._batchEditStarts=!1),a._cancelSaveTools(),a._checkboxSelection&&a._resetCheckboxState(),a.processBindings(),a.renderRecords(),n.requestType="batchSave",n.batchChanges=o,a._trigger("actionComplete",n),a.batchChanges.changed=[],a.batchChanges.added=[],a.batchChanges.deleted=[],a.batchChanges.updatedHierarchyRowIndexData=[],a._batchSaveCancel=""},batchCancel:function(){var e,t,i,a,r,n=this,o=n.model,l=n.batchChanges,d=l.changed,s=l.deleted,c=l.added,u={},p=n._mergeRecords(),h=o.filterSettings.filteredColumns;for(h&&h.length>0&&n.clearFilter(),c.length&&n.deleteRow(),e=0;e<d.length;e++){for(i in t=d[e].batchEditedFields)d[e][i]=t[i],d[e].item[i]=t[i];delete d[e].batchEditedFields}for(a=0;a<s.length;a++)n._updateBatchDeletedRecord(s[a]);if(n.batchChanges.changed=[],n.batchChanges.added=[],n.batchChanges.deleted=[],n.batchChanges.updatedHierarchyRowIndexData=[],n._batchSaveCancel="",n._batchEditStarts&&(n._batchEditStarts=!1),n._cancelSaveTools(),n._checkboxSelection&&n._resetCheckboxState(),o.showSummaryRow)for(n._batchEditCancel=!0,r=0;r<p.length;r++)u.record=p[r],n._updateSummaryRow(u);o.showTotalSummary&&(u.editType="celledit",n._updateTotalSummaryRow(u)),n.processBindings(),n.renderRecords(),n._batchEditCancel=!1},_resetCheckboxState:function(){var t,i=this,a=i.model;i._checkboxSelection&&(t=a.flatRecords,e.map(t,function(e){("checked"==e.checkboxState||"indeterminate"==e.checkboxState)&&(e.checkboxState="unchecked")}),i.selectAllRows())},_updateBatchDeletedRecord:function(e){var t,i,a,r,n=this;n.model;if(delete e.isBatchDelete,e.isBatchAdd)return n.batchChanges.added=[],n.batchChanges.added.push(e),n.deleteRow(),!0;if(e.batchEditedFields){for(i in t=e.batchEditedFields)e[i]=t[i];delete e.batchEditedFields}if(e.hasChildRecords)for(a=e.childRecords,r=0;r<a.length;r++)n._updateBatchDeletedRecord(a[r])},_processEditing:function(){var i=this,a=i.model;i._checkboxSelection&&i._updateCheckboxColumnName(),(a.editSettings.allowEditing||a.editSettings.allowAdding)&&("cellediting"===a.editSettings.editMode.toLowerCase()||"rowediting"===a.editSettings.editMode.toLowerCase()||"batchediting"==a.editSettings.editMode.toLowerCase()&&("cell"==a.editSettings.batchEditSettings.editMode||"row"==a.editSettings.batchEditSettings.editMode)||"normal"===a.editSettings.editMode.toLowerCase()&&"cell"===a.selectionSettings.selectionMode.toLowerCase()?i._addCellEditTemplate():"dialogediting"!==a.editSettings.editMode.toLowerCase()&&("batchediting"!=a.editSettings.editMode.toLowerCase()||"dialog"!=a.editSettings.batchEditSettings.editMode)||!t.isNullOrUndefined(a.editSettings.dialogEditorTemplateID)&&""!=a.editSettings.dialogEditorTemplateID?"dialogediting"!==a.editSettings.editMode.toLowerCase()&&("batchediting"!=a.editSettings.editMode.toLowerCase()||"dialog"!=a.editSettings.batchEditSettings.editMode)||t.isNullOrUndefined(a.editSettings.dialogEditorTemplateID)||""==a.editSettings.dialogEditorTemplateID||(i._treeGridAddEditDialogTemplate(),0==e("#"+this._id+"_dialogEdit").length&&this.element.append(this._renderEditDialog())):(i._treeGridAddEditDialog(),0==e("#"+this._id+"_dialogEdit").length&&this.element.append(this._renderEditDialog())))},_toolBarClick:function(t){if(t.event.which&&(3==t.event.which||2==t.event.which)||t.event.button&&2==t.event.button)return!1;this.model;var a=e(this.itemsContainer).closest(".e-treegrid"),r=a.ejTreeGrid("instance"),n=a.attr("id"),o=e("#"+r._id+"_toolbarItems");if(t.event==i&&"INPUT"==t.target.tagName&&t.currentTarget.id==n+"_search")return!1;-1!=r.model.dateFormat.toLowerCase().indexOf("hh")?e.isFunction(e.fn.ejDateTimePicker)&&e("#"+n+"EditForm").find(".e-datepicker").ejDateTimePicker("hide"):e.isFunction(e.fn.ejDatePicker)&&e("#"+n+"EditForm").find(".e-datepicker").ejDatePicker("hide");var l=t.currentTarget,d=(t.target,{itemName:t.text,currentTarget:l,model:r.model,sender:t});if(a.ejTreeGrid("instance")._trigger("toolbarClick",d))return!1;switch(e(o).ejToolbar("deselectItem",t.currentTarget),t.currentTarget.id){case n+"_add":r._toolbarOperation(n+"_add",t);break;case n+"_edit":r._toolbarOperation(n+"_edit",t);break;case n+"_delete":r._toolbarOperation(n+"_delete",t);break;case n+"_update":r._toolbarOperation(n+"_update",t);break;case n+"_cancel":r._toolbarOperation(n+"_cancel",t);break;case n+"_expandAll":r._toolbarOperation(n+"_expandAll",t);break;case n+"_collapseAll":r._toolbarOperation(n+"_collapseAll",t);break;case n+"_pdfExport":r._toolbarOperation(n+"_pdfExport",t);break;case n+"_excelExport":r._toolbarOperation(n+"_excelExport",t);break;case n+"_print":r._toolbarOperation(n+"_print",t);break;case n+"_search":r._isRowEdit?r.cancelRowEditCell():r.model.isEdit&&r.cancelEditCell()}return!1},_toolbarOperation:function(e,t){var i,a=this.element,r=a.ejTreeGrid("instance"),n=a.attr("id"),o=this,l=this.selectedItem(),d=t.target,s=o.model.allowPaging?this._updatedPageData.indexOf(l):this.selectedRowIndex();switch(r._exportTo=r.export,e){case n+"_add":"cell"==o.model.selectionSettings.selectionMode&&(o.model.editSettings.rowPosition="top"),o.model.editSettings.allowEditing&&("dialogEditing"==o.model.editSettings.editMode||"batchediting"==o.model.editSettings.editMode.toLowerCase()&&"dialog"==o.model.editSettings.batchEditSettings.editMode)?o._showTreeGridAddEditDialog(-1,"add"):o._startAdd(d,null);break;case n+"_edit":o.updateScrollBar(),o.model.editSettings.allowEditing&&("dialogEditing"==o.model.editSettings.editMode||"batchediting"==o.model.editSettings.editMode.toLowerCase()&&"dialog"==o.model.editSettings.batchEditSettings.editMode)?o._showTreeGridAddEditDialog(s):o._editRow(s);break;case n+"_delete":o.deleteRow(),o.model.editSettings.showDeleteConfirmDialog||o._cancelSaveTools(),o._isRefreshAddedRecord=!1;break;case n+"_update":"cellediting"==(i=o.model.editSettings.editMode).toLowerCase()?o._saveEditedElements():"rowediting"==i.toLowerCase()?o.saveRow():"batchediting"==i.toLowerCase()&&(o.cancelEdit(),o._batchSaveCancel="save",o.model.editSettings.showConfirmDialog?o._confirmDialog.find(".e-content").html(o._batchSaveConfirmText).end().ejDialog("open"):o.batchSave()),o._clearContextMenu(),this._removeDetailsRow(),o._focusTreeGridElement();break;case n+"_cancel":"cellediting"==(i=o.model.editSettings.editMode).toLowerCase()?o._isRowEdit?o.cancelRowEditCell():o.cancelEditCell():"rowediting"==i.toLowerCase()?o.cancelRowEditCell():"batchediting"===i.toLowerCase()&&(o._isRowEdit?o.cancelRowEditCell():o.model.isEdit&&o.cancelEditCell(),o._batchSaveCancel="cancel",o.model.editSettings.showConfirmDialog?o._confirmDialog.find(".e-content").html(o._cancelEditText).end().ejDialog("open"):o.batchCancel()),"auto"==o.model.sizeSettings.height&&o._updateContentHeight(),o._cancelSaveTools(),o._clearContextMenu(),this._removeDetailsRow();break;case n+"_expandAll":o.expandAll();break;case n+"_collapseAll":o.collapseAll();break;case n+"_pdfExport":r._exportTo(r.model.exportToPdfAction,"pdfExporting",r.model.allowMultipleExporting);break;case n+"_excelExport":r._exportTo(r.model.exportToExcelAction,"excelExporting",r.model.allowMultipleExporting);break;case n+"_print":r.print();break;case n+"_search":if(o._batchEditStarts&&!o._confirmDialog.is(":visible"))return o._batchSaveLostWarning("Searching"),o._batchTempDetails.searchTarget=t,o._batchTempDetails.searchString=t.value,!0;o._searchString!=t.value&&(o.search(t.value),o._updateToolbarItems(),o._isRefreshAddedRecord=!1)}return o._refreshToolBar(),!1},_batchSaveLostWarning:function(e){var t=this,i=t.model;"batchediting"==i.editSettings.editMode.toLowerCase()&&(i.isEdit?t.saveCell():t._isRowEdit&&t.saveRow(),t._batchSaveCancel="saveLost"+e,i.editSettings.showConfirmDialog?t._confirmDialog.find(".e-content").html(t._batchSaveLostChangesText).end().ejDialog("open"):t.batchCancel())},_renderConfirmDialog:function(){var i=this,a=t.buildTag("div.e-content",i.localizedLabels.deleteRecordText),r=t.buildTag("span.e-buttons",'<input type="button" class="e-flat e-btnsub" id='+i._id+'_ConfirmDialogOK value="'+this.localizedLabels.okButtonText+"\" /> <input type='button' class='e-flat e-btncan' id="+i._id+"_ConfirmDialogCancel value='"+i.localizedLabels.cancelButtonText+"' />",{float:"right",padding:".5em 0em"});i._confirmDialog=t.buildTag("div#"+i._id+"_ConfirmDialog",{height:"auto",width:"auto",float:"left"}),i._confirmDialog.append(a).append(r),i.element.append(i._confirmDialog),r.find("input").ejButton({cssClass:i.model.cssClass,showRoundedCorner:!0,size:"mini",click:e.proxy(i._triggerConfirm,i)}),i._confirmDialog.ejDialog({showOnInit:!1,enableAnimation:!1,showHeader:!1,width:"auto",minWidth:0,minHeight:0,enableModal:!0,enableResize:!1})},_triggerConfirm:function(t){var a,r,n=this,o=n.model;if(t!==i&&t.model.text==n.localizedLabels.okButtonText){if("save"==n._batchSaveCancel)n.batchSave();else if("cancel"==n._batchSaveCancel)n.batchCancel();else if("saveLostDrag"==n._batchSaveCancel)n._batchSaveCancel="cancel",n.batchCancel();else if("saveLostColumnMenu"==n._batchSaveCancel)n._batchSaveCancel="cancel",n.batchCancel(),n._renderColumnMenu(n._batchTempDetails.menuTarget);else if("saveLostSearching"==n._batchSaveCancel)n._batchSaveCancel="cancel",n.batchCancel(),n.search(n._batchTempDetails.searchString),n._updateToolbarItems(),n._isRefreshAddedRecord=!1;else if("saveLostPaging"==n._batchSaveCancel){if(n._batchSaveCancel="cancel",n.batchCancel(),n._prevPageNo==n._batchTempDetails.currentPage)return;n._isNextPage=!0,n._isRowEdit?n.cancelRowEditCell():n.model.isEdit&&n.cancelEditCell(),n.gotoPage(n._batchTempDetails.currentPage)}else"saveLostFiltering"==n._batchSaveCancel?(n._batchSaveCancel="cancel",n.batchCancel(),a=n._batchTempDetails,"filterbar"==o.filterSettings.filterType?n.filterColumn(a.fieldName,a.filterOperator,a.filterValue,a.predicate,a.matchcase,a.actualFilterValue):("excel"==o.filterSettings.filterType||"menu"==o.filterSettings.filterType)&&n._onHeaderClick(a.filterTarget)):n.deleteRow(null,n._isFromContextmenu,n._deleteRowIndex);n._confirmDialog.ejDialog("close"),n._cancelSaveTools()}else n._confirmDialog.ejDialog("close"),"saveLostFiltering"==n._batchSaveCancel&&"filterbar"==o.filterSettings.filterType&&((r=e(n._batchTempDetails.filterTarget)).hasClass("e-numerictextbox")?r.ejNumericTextbox({value:null}):r.hasClass("e-dropdownlist")?r.ejDropDownList({value:null}):r.closest("input").val("")),"saveLostSearching"==n._batchSaveCancel&&(n._searchString||(r=e(n._batchTempDetails.searchTarget)).hasClass("e-ejinputtext")&&r.closest("input").val("")),"saveLostPaging"==n._batchSaveCancel&&(this.getPager().ejPager("model").currentPage=n._prevPageNo,n.getPager().ejPager("refreshPager"));n._focusTreeGridElement(),n._deleteRowIndex=-1,n._isFromContextmenu=!1,n._batchSaveCancel=""},print:function(){var i,a={},r=this,n=r.model;a.requestType="print",r._trigger("actionBegin",a);var o=window.open("","print","height=452,width=1024,tabbar=no"),l=t.buildTag("div#"+r._id+"Print"),d=e.extend({},r.model),s=e.extend(!0,[],n.columns),c=s.length;if(d.toolbarSettings=e.extend({},n.toolbarSettings),d.toolbarSettings.showToolbar=d.allowPaging=!1,d.selectedItem=null,d.enableVirtualization=!1,d.query.queries=[],d.printingEnabled=!0,this._frozenColumnsLength>0){for(i=0;i<c;i++)s[i].isFrozen&&(s[i].isFrozen=!1);d.columns=s}if(this._commandColumnLength>0){for(i=0;i<c;i++)s[i].commands&&(s.splice(i,1),c--,i--);d.columns=s}n.allowPaging&&n.pageSettings.printMode==t.TreeGrid.PrintMode.CurrentPage?(d.query.queries=[{fn:"onPage",e:{pageIndex:r._currentPage(),pageSize:n.pageSettings.pageSize}}],d.dataBound=function(){this._printProcess(o)}):d.dataBound=function(){this._printProcess(o)},l.ejTreeGrid(d)},_printProcess:function(i){var a=this.element,r={requestType:"print",element:a};this.model.allowFiltering&&"filterbar"==this.model.filterSettings.filterType&&a.find(".e-filterbar").remove(),e(a).find(".e-gridheader").css({width:"auto"}),this.clearSelection(),a.show(),this._trigger("beforePrint",r),t.print(a,i),this._trigger("actionComplete",r)},contextMenuOperations:function(i){var a,r,n,o=this,l=o.model,d=o._contextMenuSelectedIndex,s=o._contextMenuEvent,c=o._contextMenuSelectedItem,u=l.editSettings,p=u.editMode.toLowerCase();switch(this._isContextMenuItems||(r=o._contextMenuColumnDetails),i){case"contextMenu_Unfreeze":0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(o._checkboxSelection&&2==o._frozenColumnsLength&&l.columns[0].nonColumn&&l.columns[0].isFrozen&&(l.columns[0].isFrozen=!1),o.freezeColumn(r.field,!1)));break;case"contextMenu_Freeze":0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(o._checkboxSelection&&l.columns[0].nonColumn&&!l.columns[0].isFrozen&&(l.columns[0].isFrozen=!0),o.freezeColumn(r.field,!0)));break;case"contextMenu_FreezePreceding":0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||o.freezePrecedingColumns(r.field));break;case"contextMenu_SortDescending":l.allowMultiSorting&&(o._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(l.isFromGantt||o.sortColumn(r.field,t.sortOrder.Descending),o._multiSortRequest=!1);break;case"contextMenu_SortAscending":l.allowMultiSorting&&(o._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(l.isFromGantt||o.sortColumn(r.field,t.sortOrder.Ascending),o._multiSortRequest=!1);break;case"Delete":o.deleteRow(null,!0,o._contextMenuSelectedIndex),o._cancelSaveTools(),o._clearContextMenu();break;case"Above":o._subContextMenuAction(c,d,"Above"),o._focusTreeGridElement();break;case"Below":o._subContextMenuAction(c,d,"Below"),o._focusTreeGridElement();break;case"Add":o._setInitialData(),o._clearContextMenu();break;case"Edit":"cellediting"==p||"batchediting"==p&&"cell"==u.batchEditSettings.editMode?(r=l.columns[o.getCellIndex(s)],t.isNullOrUndefined(r)||0==r.allowEditing||(o._focusTreeGridElement(),o._cellEditingDetails.columnIndex=o.getCellIndex(s),o._editedRowIndex=o._cellEditingDetails.rowIndex=o.getRowIndex(s),(a=o._cellEditingDetails.columnIndex>=0&&r.field)&&(o.updateScrollBar(),l.editSettings.allowEditing&&o.cellEdit(o._cellEditingDetails.rowIndex,a)&&o._editAddTools()))):"rowediting"==p||"batchediting"==p&&"row"==u.batchEditSettings.editMode?(o.updateScrollBar(),o._editRow(d)):("dialogediting"==p||"batchediting"==p&&"dialog"==u.batchEditSettings.editMode)&&o._showTreeGridAddEditDialog(d),o._clearContextMenu();break;case"Save":if("cellediting"==p||"batchediting"==p&&"cell"==u.batchEditSettings.editMode){if(!this.editFormValidate())return!0;o._isRowEdit?o._endEdit():o.saveCell()}else("rowediting"==p||"batchediting"==p&&"row"==u.batchEditSettings.editMode)&&o.saveRow();o._clearContextMenu(),o._focusTreeGridElement();break;case"Cancel":"cellediting"==p||"batchediting"==p&&"cell"==u.batchEditSettings.editMode?o._isRowEdit?o.cancelRowEditCell():l.isEdit&&o.cancelEditCell():("rowediting"==p||"batchediting"==p&&"row"==u.batchEditSettings.editMode)&&o.cancelRowEditCell(),o._clearContextMenu(),o._focusTreeGridElement();break;default:n={},this._isContextMenuItems?(n.data=c,n.menuId=i,o._triggerMenuEventHandler(i,n,!0),o._clearContextMenu()):(n.column=o._contextMenuColumnDetails,n.menuId=i,o._triggerMenuEventHandler(i,n,!1),o._clearContextMenu())}l.enableAltRow&&l.currentViewData[0]&&t.TreeGrid.updateAltRow(o,l.currentViewData[0],0,0)},_setCultureInfo:function(){var e=this,i=e.model,a=i.locale,r=e.localizedLabel,n=t.TreeGrid.Locale.default;r=i.predecessorTable||i.resourceTable?t.Gantt.Locale[a]:t.TreeGrid.Locale[a],e._toolboxTooltipTexts=r&&r.toolboxTooltipTexts?r.toolboxTooltipTexts:n.toolboxTooltipTexts,e._contextMenuTexts=r&&r.contextMenuTexts?r.contextMenuTexts:n.contextMenuTexts,e.model.isFromGantt?(e._columnMenuTexts=e.model.columnMenuTexts,e._deleteColumnText=e.model.deleteColumnText,e._okButtonText=e.model.okButtonText,e._cancelButtonText=e.model.cancelButtonText,e._columnDialogTexts=e.model.columnDialogTexts,e._columnDialogTitle=e.model.columnDialogTitle,e._confirmDeleteText=e.model.confirmDeleteText,e._editTypeText=e.model.editTypeText,e._textAlignTypeText=e.model.textAlignTypeText,e._clipModeText=e.model.clipModeText):(e._columnMenuTexts=r&&r.columnMenuTexts?r.columnMenuTexts:n.columnMenuTexts,e._columnDialogTexts=r&&r.columnDialogTexts?r.columnDialogTexts:n.columnDialogTexts,e._columnDialogTitle=r&&r.columnDialogTitle?r.columnDialogTitle:n.columnDialogTitle,e._deleteColumnText=r&&r.deleteColumnText?r.deleteColumnText:n.deleteColumnText,e._okButtonText=r&&r.okButtonText?r.okButtonText:n.okButtonText,e._cancelButtonText=r&&r.cancelButtonText?r.cancelButtonText:n.cancelButtonText,e._confirmDeleteText=r&&r.confirmDeleteText?r.confirmDeleteText:n.confirmDeleteText,e._editTypeText=r&&r.editTypeTexts?r.editTypeTexts:n.editTypeTexts,e._textAlignTypeText=r&&r.textAlignTypes?r.textAlignTypes:n.textAlignTypes,e._clipModeText=r&&r.clipModeTexts?r.clipModeTexts:n.clipModeTexts,e._dropDownListBlanksText=r&&r.dropDownListBlanksText?r.dropDownListBlanksText:n.dropDownListBlanksText,e._dropDownListClearText=r&&r.dropDownListClearText?r.dropDownListClearText:n.dropDownListClearText,e._trueText=r&&r.trueText?r.trueText:n.trueText,e._falseText=r&&r.falseText?r.falseText:n.falseText,e._batchSaveConfirmText=r&&r.batchSaveConfirmText?r.batchSaveConfirmText:n.batchSaveConfirmText,e._batchSaveLostChangesText=r&&r.batchSaveLostChangesText?r.batchSaveLostChangesText:n.batchSaveLostChangesText,e._cancelEditText=r&&r.cancelEditText?r.cancelEditText:n.cancelEditText,e.model.emptyRecordText=r&&r.emptyRecord?r.emptyRecord:n.emptyRecord,e._filterMenuTexts=r&&r.filterMenuTexts?r.filterMenuTexts:n.filterMenuTexts)},refresh:function(e,i){var a,r=this,n=r.model;t.isNullOrUndefined(e)?((a={}).requestType=t.TreeGrid.Actions.Refresh,this.sendDataRenderingRequest(a)):(r.resetModelCollections(),r._fieldNamesToQuery=[],r._assignedIdCollections=[],r._assignedParendIDs=[],n.dataSource=e,n.query=i,r.element.ejTreeGrid("destroy").ejTreeGrid(n))},_getNewIndex:function(){return this._maxRowIndex+=1,this._maxRowIndex},_getNewId:function(){return this._lastInsertedId+1},_updateLastInsertedId:function(e){var t=this,i=isNaN(parseInt(e))?t._lastInsertedId<1?1:t._lastInsertedId:parseInt(e);t._lastInsertedId=t._lastInsertedId<i?i:t._lastInsertedId},_updateHierarchyRowIndexData:function(e,t,i){var a,r=this,n=r.model,o=n.editSettings.editMode.toLowerCase();for(e.updatedHierarchyRowIndexData=[],a=i;a<t.length;a++)t[a].hierarchyRowIndex=a,n.hierarchyRowIndexMapping&&(t[a].item[n.hierarchyRowIndexMapping]=a),"batchediting"!=o?e.updatedHierarchyRowIndexData.push(t[a]):-1==r.batchChanges.updatedHierarchyRowIndexData.indexOf(t[a])&&r.batchChanges.updatedHierarchyRowIndexData.push(t[a])},_addRecord:function(i,a,r,n){var o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x=this;(x.model.isEdit||x._isRowEdit)&&x.cancelRowEditCell();var v,b,S,D,R,y,I=this.model,k=this.selectedRowIndex(),M=I.updatedRecords,E=I.flatRecords,H=I.parentRecords,P="row"==I.selectionSettings.selectionMode?this.selectedItem():M[x._rowIndexOfLastSelectedCell],F=I.columns,O=this.dataSource(),G=0,L=!1,N=!1,W=I.editSettings.editMode.toLowerCase(),A=!1,z={};if("array"===e.type(O)||O instanceof t.DataManager||(this.dataSource([]),O=this.dataSource()),t.isNullOrUndefined(i)){for(i=null,o=0;o<F.length;o++)t.isNullOrUndefined(F[o].nonColumn)&&(i=x._restoreCustomData(i,"",F[o].field));N=!0}if("batchediting"==W&&(i.isBatchAdd=!0),I.idMapping&&I.parentIdMapping&&!t.isNullOrUndefined(i[x.model.parentIdMapping])&&"child"!=a&&((l=I.flatRecords.filter(function(e){return e[I.idMapping]==i[I.parentIdMapping]})).length>0&&(P=l[0],a=t.TreeGrid.RowPosition.Child,A=!0)),(-1===k&&-1==x._rowIndexOfLastSelectedCell&&(a===t.TreeGrid.RowPosition.Above||a===t.TreeGrid.RowPosition.Below||a===t.TreeGrid.RowPosition.Child)||!a||I.selectedItems.length>1&&!x._checkboxSelection)&&(A||(a=t.TreeGrid.RowPosition.Top)),a==t.TreeGrid.RowPosition.Top||a==t.TreeGrid.RowPosition.Bottom?(R=0,y=null):a==t.TreeGrid.RowPosition.Above||a==t.TreeGrid.RowPosition.Below?(R=P.level,y=P.parentItem):a==t.TreeGrid.RowPosition.Child&&(R=P.level+1,y=P),I.idMapping&&I.parentIdMapping)if(d=i[I.idMapping],t.isNullOrUndefined(d)||""==d||"contextMenu"==n)i[I.idMapping]=x._getNewId();else if(x._validateIdValue(d))return!1;if(z.requestType="add",z.data=i,z.level=R,z.rowPosition=a,z.parentItem=y,x._trigger("actionBegin",z)){if("dialog"==n)return!1}else{switch(i=z.data,a!=z.rowPosition&&(a=z.rowPosition),i[I.childMapping]&&i[I.childMapping].length&&delete i[I.childMapping],x.selectRows(-1),S=this._getNewIndex(),a){case t.TreeGrid.RowPosition.Top:G=0,D=null,(v=x._createRecord(i,G)).index=S,E.splice(0,0,v),M.splice(0,0,v),x._isHierarchyFiltering&&x._updateFilterParent.splice(0,0,v),H.splice(0,0,v),x._updateHierarchyRowIndexData(z,H,0),x._isDataManagerUpdate?x._jsonData.splice(0,0,v.item):O.splice(0,0,v.item),b=0;break;case t.TreeGrid.RowPosition.Bottom:G=0,D=null,(v=x._createRecord(i,G)).index=S,E.push(v),M.push(v),x._isHierarchyFiltering&&x._updateFilterParent.push(v),H.push(v),x._isDataManagerUpdate?x._jsonData.push(v.item):O.push(v.item),b=M.indexOf(v);break;case t.TreeGrid.RowPosition.Above:G=P.level,D=P.parentItem,(v=x._createRecord(i,G,D)).index=S,x._isHierarchyFiltering&&P.filterLevel>-1&&(v.filterLevel=P.filterLevel),c=E.indexOf(P),u=M.indexOf(P),E.splice(c,0,v),M.splice(u,0,v),x._isHierarchyFiltering&&x._updateFilterParent.splice(u,0,v),t.isNullOrUndefined(D)?(H.splice(H.indexOf(P),0,v),x._isDataManagerUpdate?x._jsonData.splice(x._jsonData.indexOf(P.item),0,v.item):O.splice(O.indexOf(P.item),0,v.item),p=H.indexOf(P),x._updateHierarchyRowIndexData(z,H,p)):(s=D.childRecords.indexOf(P),D.childRecords.splice(s,0,v),I.parentIdMapping?(v.item[I.parentIdMapping]=v.parentItem.item[I.idMapping],v[I.parentIdMapping]=v.parentItem.item[I.idMapping],x._isDataManagerUpdate?x._jsonData.push(v.item):O.push(v.item)):D.item[I.childMapping].splice(s,0,v.item),m=D.childRecords,x._updateHierarchyRowIndexData(z,m,s)),b=u;break;case t.TreeGrid.RowPosition.Below:G=P.level,D=P.parentItem,(v=x._createRecord(i,G,D)).index=S,x._isHierarchyFiltering&&P.filterLevel>-1&&(v.filterLevel=P.filterLevel),h=E.indexOf(P),P.hasChildRecords?(c=h+x.getChildCount(P,0)+1,u=M.indexOf(P)+x._getVisibleChildRecordCount(P,0,M)+1):(c=h+1,u=M.indexOf(P)+1),E.splice(c,0,v),M.splice(u,0,v),x._isHierarchyFiltering&&x._updateFilterParent.splice(u,0,v),t.isNullOrUndefined(D)?(H.splice(H.indexOf(P)+1,0,v),x._isDataManagerUpdate?x._jsonData.splice(x._jsonData.indexOf(P.item)+1,0,v.item):O.splice(O.indexOf(P.item)+1,0,v.item),p=H.indexOf(P),x._updateHierarchyRowIndexData(z,H,p+1)):(s=D.childRecords.indexOf(P),D.childRecords.splice(s+1,0,v),I.parentIdMapping?(v.item[I.parentIdMapping]=v.parentItem.item[I.idMapping],v[I.parentIdMapping]=v.parentItem.item[I.idMapping],x._isDataManagerUpdate?x._jsonData.push(v.item):O.push(v.item)):D.item[I.childMapping].splice(s+1,0,v.item),m=D.childRecords,x._updateHierarchyRowIndexData(z,m,s+1)),b=u;break;case t.TreeGrid.RowPosition.Child:G=P.level+1,D=P,(v=x._createRecord(i,G,D)).index=S,x._isHierarchyFiltering&&P.filterLevel>-1&&(v.filterLevel=P.filterLevel+1),h=E.indexOf(P),P.hasChildRecords?(c=h+x.getChildCount(P,0)+1,P.expanded&&x.getExpandStatus(P)||((g={}).expanded=!0,g.data=P,x._isInAdd=!0,x._isRefreshAddedRecord?(g.data.expanded=!0,x.updateExpandStatus(z.data,z.expanded),x.refreshContent(),x._isRefreshAddedRecord=!1):x._expandRecord(P),M=I.updatedRecords,x._isInAdd=!1),u=M.indexOf(P)+x._getVisibleChildRecordCount(P,0,M)+1-(I.showSummaryRow?I.summaryRows.length:0)):(x._isLoadonDemand&&(P.isChildRetrieved=!0),x.getExpandStatus(P)||x._expandRecord(P.parentItem),P.hasChildRecords=!0,P.childRecords=[],P.expanded=!0,I.parentIdMapping||(P.item[I.childMapping]=[]),P.isMilestone=!1,c=h+1,u=M.indexOf(P)+1),E.splice(c,0,v),x._isHierarchyFiltering&&x._updateFilterParent.splice(u,0,v),x._isLoadonDemand?P.isChildRetrieved&&M.splice(u,0,v):M.splice(u,0,v),t.isNullOrUndefined(D)||(s=D.childRecords.indexOf(P),D.childRecords.splice(s+1,0,v),I.parentIdMapping?(v.item[I.parentIdMapping]=v.parentItem.item[I.idMapping],v[I.parentIdMapping]=v.parentItem.item[I.idMapping],x._isDataManagerUpdate?x._jsonData.push(v.item):O.push(v.item)):D.item[I.childMapping].splice(s+1,0,v.item),m=D.childRecords,x._updateHierarchyRowIndexData(z,m,0)),b=u}if(I.allowPaging&&(a==t.TreeGrid.RowPosition.Below||a==t.TreeGrid.RowPosition.Child?("root"!==I.pageSettings.pageSizeMode||t.isNullOrUndefined(P.parentItem))&&(_=x._updatedPageData[x._updatedPageData.length-1],b>(x._updatedPageData.length==I.pageSettings.pageSize?I.updatedRecords.indexOf(_):b)&&(x._currentPage(this._currentPage()+1),0)):a==t.TreeGrid.RowPosition.Top&&(x._currentPage()>1||x._currentPage()<1)?(x._currentPage(1),0):a==t.TreeGrid.RowPosition.Bottom&&x._currentPage()<I.pageSettings.totalPages&&(x._currentPage(I.pageSettings.totalPages),b)),(I.allowFiltering&&I.filterSettings.filteredColumns.length>0||x._searchString.length>0)&&x._flatFilteredRecords.push(v),N||!t.TreeGrid.RowPosition.Above&&!t.TreeGrid.RowPosition.Below)x._renderAddedRow(b,v),L=!0,x._emptyRowIndex="cell"==I.selectionSettings.selectionMode?b:null;else{z={},(F=I.columns).length;I.allowPaging||b,z.rowIndex=b,z.requestType="addNewRow",z.addedRow=i,"batchediting"!=W&&x._trigger("actionComplete",z)?M.splice(b,1):(x._updateAction(z),x._renderAddedRow(b,v),I.showSummaryRow&&("addNewRow"==z.requestType&&"child"==a&&x._createAndRenderSummaryRecords(z),x._updateSummaryRow(z)),I.showTotalSummary&&x._updateTotalSummaryRow(z),L=!0,I.idMapping&&I.parentIdMapping&&x._updateLastInsertedId(v[I.idMapping]))}"batchediting"==W&&L&&!N&&(x.batchChanges.added.push(v),x._batchEditStarts=!0),!1===I.enableVirtualization&&(I.sortSettings.sortedColumns.length>0||I.filterSettings.filteredColumns.length>0)&&(x._isRefreshAddedRecord=!0),I.allowPaging&&(M=x._updatedPageData),-1==(f=L?M.indexOf(v):k)&&(f=k),I.allowSelection&&"row"==I.selectionSettings.selectionMode&&(x._rowSelectingEventTrigger(this._previousIndex,f)||(x.selectRows(f),I.selectionSettings.enableSelectAll&&x.selectAllRows(),x._checkboxSelection&&I.selectionSettings.enableHierarchySelection&&v.parentItem&&x._updateParentSelection(v.parentItem),x._rowSelectedEventTrigger(f))),I.allowSelection||"row"!=I.selectionSettings.selectionMode||x.selectRows(f),"cell"==I.selectionSettings.selectionMode&&(x._rowIndexOfLastSelectedCell=M.indexOf(v)),x.updateScrollBar(),"isEditRow"==r?x._editRow(M.indexOf(v),v):(t.TreeGrid.refreshRow(x,I.currentViewData.indexOf(v)),x._cancelSaveTools(),I.enableAltRow&&t.TreeGrid.updateAltRow(x,x.model.currentViewData[0],0,0)),v.parentItem&&a==t.TreeGrid.RowPosition.Child&&(1==v.parentItem.childRecords.length||!v.parentItem.hasFilteredChildRecords)&&(v.parentItem.hasFilteredChildRecords=!0,t.TreeGrid.refreshRow(x,I.currentViewData.indexOf(v.parentItem))),I.allowTextWrap&&x._$frozenTableContent.length>0?(x._updateWrapRowHeights("total,header"),x.updateHeight()):I.allowTextWrap&&I.enableVirtualization&&x.updateHeight()}return x._commandColumnLength>0&&(t.isNullOrUndefined(r)&&(w=t.TreeGrid.getRowByIndex(x,f),x._refreshUnboundTemplate(w)),a==t.TreeGrid.RowPosition.Child&&(C=M.indexOf(v.parentItem),T=t.TreeGrid.getRowByIndex(x,C),x._refreshUnboundTemplate(T))),!0},_validateIdValue:function(t){var i=this,a=i.model,r=a.flatRecords;return!!(i._isLoadonDemand?e.map(i._assignedIdCollections,function(e){if(e==t)return e}):e.map(r,function(e){if(e[a.idMapping]==t)return e})).length},_closeTreegridAddEditDialog:function(t,i){var a=this,r={};if(this._off(e("#"+this._id+"_dialogEdit"),"click keypress","#EditFormDialog_"+this._id+"_Save ,#EditFormDialog_"+this._id+"_Cancel",a._buttonClick),!a._isTreeAddEditDialogSave)return r.requestType="Add"===i?"closeAddDialog":"closeEditDialog",a._trigger("actionBegin",r);a._isTreeAddEditDialogSave=!1},showAddDialog:function(){var e=this;e.model.editSettings.allowAdding&&"dialogEditing"==e.model.editSettings.editMode&&e._showTreeGridAddEditDialog(null,"add")},showEditDialog:function(e){var t=this;t.model.editSettings.allowEditing&&"dialogEditing"==t.model.editSettings.editMode&&t._showTreeGridAddEditDialog(e)},_showTreeGridAddEditDialog:function(i,a){var r,n,o,l,d=document.createElement("div"),s=this,c=e(d),u=s.getOffsetRect(e("#"+s._id)[0]),p=[],h=s.model.columns,g=s._contextMenuTexts;if((t.isNullOrUndefined(i)||-1==i)&&!a&&(i="cell"==s.model.selectionSettings.selectionMode?s.selectedCellIndexes()[0].rowIndex:s.selectedRowIndex()),p[0]=s.model.allowPaging?this._updatedPageData[i]:s.model.updatedRecords[i],a&&"add"===a.toLowerCase()){if(t.isNullOrUndefined(p[0])){for(p[0]=null,r=0;r<h.length;r++)p[0]=s._restoreCustomData(p[0],"",h[r].field);s.model.parentIdMapping&&(p[0][s.model.idMapping]=s._getNewId())}c.addClass("e-dialogaddrow")}else c.addClass("e-dialogeditedrow");t.isNullOrUndefined(s.model.editSettings.dialogEditorTemplateID)||""==s.model.editSettings.dialogEditorTemplateID?d.innerHTML=e.render[this._id+"_JSONDialogEditingTemplate"](p):t.isNullOrUndefined(s.model.editSettings.dialogEditorTemplateID)||""==s.model.editSettings.dialogEditorTemplateID||(d.innerHTML=e.render[this._id+"_JSONdialogTemplateMode"](p)),("dialogEditing"==this.model.editSettings.editMode||"batchediting"==s.model.editSettings.editMode.toLowerCase()&&"dialog"==s.model.editSettings.batchEditSettings.editMode)&&(e("#"+this._id+"_dialogEdit").html(e(d)),(n={}).cssClass=this.model.cssClass,n.enableRTL=!1,n.enableResize=!1,n.showOnInit=!1,n.content="#"+this._id,e(window).width()<=s._responsiveMinWidth&&s.model.isResponsive?(n.width=e("#"+s._id).width()+"px",n.height=e("#"+s._id).height()+"px",n.enableModal=!1,n.isResponsive=!1,n.allowDraggable=!1):(n.width="auto",n.height="auto",n.enableModal=!0,n.isResponsive=!1,n.allowDraggable=!0),n.allowKeyboardNavigation=!1,a&&"add"===a.toLowerCase()?(n.title=g.addRowText,n.beforeClose=function(e){s._closeTreegridAddEditDialog(e,"Add")&&(e.cancel=!0),s._focusTreeGridElement()}):(n.title=g.editText,n.beforeClose=function(e){s._closeTreegridAddEditDialog(e,"Edit")&&(e.cancel=!0),s._focusTreeGridElement()}),e("#"+this._id+"_dialogEdit").ejDialog(n),(o={}).data=p[0],a&&"add"===a.toLowerCase()?(o.requestType="beforeOpenAddDialog",o.rowPosition=s.model.editSettings.rowPosition):o.requestType="beforeOpenEditDialog",o.element=e("#"+s._id+"_dialogEdit"),s._trigger("actionBegin",o)||((l={}).columnIndex=i,l.data=o.data,l.requestType="beginEdit",s._refreshEditForm(l),o.data=l.data,o.requestType=a&&"add"===a.toLowerCase()?"openAddDialog":"openEditDialog",o.element=e("#"+s._id+"_dialogEdit"),s._trigger("actionBegin",o)||(e("#"+this._id+"_dialogEdit").ejDialog("open"),s._currentEditRecordDialogIndex=this.model.currentViewData.indexOf(l.data),e(window).width()<=s._responsiveMinWidth&&s.model.isResponsive?(e("#"+s._id+"_dialogEdit_wrapper").css({left:u.left+"px",top:u.top+"px"}),e("#"+s._id+"_dialogEdit_wrapper").removeClass("e-shadow").removeClass("e-treegridadaptivedialog"),e("#"+s._id+"_dialogEdit").removeClass("e-shadow")):(e("#"+s._id+"_dialogEdit_wrapper").addClass("e-shadow").addClass("e-treegridadaptivedialog"),e("#"+s._id+"_dialogEdit").addClass("e-shadow")),this._on(e("#"+this._id+"_dialogEdit"),"click keypress","#EditFormDialog_"+this._id+"_Save ,#EditFormDialog_"+this._id+"_Cancel",s._buttonClick),e("#"+s._id+"_dialogEdit").ejDialog("refresh")))),e.isFunction(e.validator)&&(s._initValidator(),s.setValidation())},addRow:function(e,t){var i=this;i.model;if(i._cancelEditState(),e)return!!i._addRecord(e,t);i._addRecord(null,t,"isEditRow")},_startAdd:function(){var e=this,t=this.model;e.model.allowSelection&&"multiple"==e.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&e._clearMultiSelectPopup(),e._addRecord(null,t.editSettings.rowPosition,"isEditRow")},_getRecordIndexByItem:function(e,i){var a=t.DataManager(i).executeLocal(t.Query().where("item",t.FilterOperators.equal,e));return a.length>0?i.indexOf(a[0]):-1},_expandRecord:function(e){if(!this._isLoadonDemand||e.isChildRetrieved)for(var i=e,a={};null!=i;)0==i.expanded&&(a.expanded=!0,a.data=i,this._isInExpandCollapseAll=!!i.parentItem,t.TreeGrid.sendExpandCollapseRequest(this,a)),i=i.parentItem},scrollOffset:function(e,t){var i=this.getScrollElement().data("ejScroller");this._saveEditedElements(),("number"==typeof t||"number"==typeof parseInt(t))&&((t=parseInt(t))>=0&&this.getMaxScrollHeight()>=t&&i.scrollY(t,!0)),("number"==typeof e||"number"==typeof parseInt(e))&&((e=parseInt(e))>=0&&this.getMaxScrollWidth()>=e&&i.scrollX(e,!0))},getScrollTopOffset:function(){return this.getScrollElement().ejScroller("model.scrollTop")},getScrollLeftOffset:function(){return this.getScrollElement().ejScroller("model.scrollLeft")},scrollToTop:function(){var e,t=this.model,i=this.getUpdatedRecords(),a=-1;this.isVScroll()&&(this._saveEditedElements(),(i=t.allowPaging?i:this.getExpandedRecords(t.updatedRecords)).length>0&&(a=0,e=i[0],a=i.indexOf(e),this.updateScrollBar(a),t.allowSelection&&!this._rowSelectingEventTrigger(this.selectedRowIndex(),a)&&(this.selectRows(a),this._rowSelectedEventTrigger(a))))},scrollToBottom:function(){var e,t,i=this.model,a=-1;this.isVScroll()&&(this._saveEditedElements(),(e=i.allowPaging?this.getUpdatedRecords():this.getExpandedRecords(i.updatedRecords)).length>0&&(t=e[a=e.length-1],a=i.allowPaging?e.indexOf(t):i.updatedRecords.indexOf(t),this.updateScrollBar(a),i.allowSelection&&!this._rowSelectingEventTrigger(this.selectedRowIndex(),a)&&(this.selectRows(a),this._rowSelectedEventTrigger(a))))},_editAddTools:function(){var t,i=this,a=i.model,r=e("#"+i._id+"_toolbarItems"),n=i.model.editSettings,o=a.toolbarSettings.toolbarItems,l=[];n.allowAdding&&-1!==o.indexOf("add")&&!e(r).find(".e-addnew").parent("li").hasClass("e-disable")&&"click"!=n.beginEditAction&&l.push(e(r).find(".e-addnew").parent()[0]),n.allowEditing&&-1!==o.indexOf("edit")&&!e(r).find(".e-edit").parent("li").hasClass("e-disable")&&l.push(e(r).find(".e-edit").parent()[0]),n.allowDeleting&&-1!==o.indexOf("delete")&&!e(r).find(".e-delete").parent("li").hasClass("e-disable")&&"click"!=a.editSettings.beginEditAction&&l.push(e(r).find(".e-delete").parent()[0]),l.forEach(function(t){e(r).ejToolbar("disableItem",t)}),t=[],("batchediting"!=n.editMode.toLowerCase()||"batchediting"==n.editMode.toLowerCase()&&i._batchEditStarts)&&(-1!==o.indexOf("cancel")&&t.push(e(r).find(".e-cancel").parent()[0]),-1!==o.indexOf("update")&&t.push(e(r).find(".e-save").parent()[0])),t.forEach(function(t){e(r).ejToolbar("enableItem",t)})},_cancelSaveTools:function(){var t=this,i=t.model,a=t.model.editSettings,r=e("#"+t._id+"_toolbarItems"),n=i.toolbarSettings.toolbarItems;if(i.isFromGantt){r=e("#"+t._id.replace("ejTreeGrid","")+"_toolbarItems");var o=[],l=[];1==i.readOnly?((l=[]).push(e(r).find(".e-addnewitem").parent()[0]),l.push(e(r).find(".e-edititem").parent()[0]),l.push(e(r).find(".e-edititem").parent()[0])):(a.allowAdding&&-1!==n.indexOf("add")&&o.push(e(r).find(".e-addnewitem").parent()[0]),a.allowEditing&&-1!==n.indexOf("edit")&&i.allowSelection&&"click"!=a.beginEditAction&&(-1!=t.selectedRowIndex()&&1==i.selectedItems.length?o.push(e(r).find(".e-edititem").parent()[0]):l.push(e(r).find(".e-edititem").parent()[0])),a.allowDeleting&&-1!==n.indexOf("delete")&&i.allowSelection&&(-1!=t.selectedRowIndex()?o.push(e(r).find(".e-deleteitem").parent()[0]):l.push(e(r).find(".e-deleteitem").parent()[0])),a.allowIndent&&(-1!==n.indexOf("indent")||-1!==n.indexOf("outdent"))&&i.allowSelection&&-1==t.selectedRowIndex()&&(l.push(e(r).find(".e-indent").parent()[0]),l.push(e(r).find(".e-outdent").parent()[0])),e(r).ejToolbar("enableItem",o),-1!==n.indexOf("cancel")&&l.push(e(r).find(".e-cancel").parent()[0]),-1!==n.indexOf("update")&&l.push(e(r).find(".e-saveitem").parent()[0])),l.forEach(function(t){e(r).ejToolbar("disableItem",t)})}else o=[],l=[],a.allowAdding?-1!==n.indexOf("add")&&o.push(e(r).find(".e-addnew").parent()[0]):l.push(e(r).find(".e-addnew").parent()[0]),a.allowEditing&&-1!==n.indexOf("edit")?-1!=t.selectedRowIndex()&&i.allowSelection&&(1==i.selectedItems.length||t._checkboxSelection)&&"click"!=a.beginEditAction?o.push(e(r).find(".e-edit").parent()[0]):e(r).find(".e-edit").parent("li").hasClass("e-disable")||l.push(e(r).find(".e-edit").parent()[0]):l.push(e(r).find(".e-edit").parent()[0]),a.allowDeleting&&-1!==n.indexOf("delete")?(t._checkboxSelection||-1!=t.selectedRowIndex()&&i.allowSelection)&&i.selectedItems.length>0?o.push(e(r).find(".e-delete").parent()[0]):e(r).find(".e-delete").parent("li").hasClass("e-disable")||l.push(e(r).find(".e-delete").parent()[0]):l.push(e(r).find(".e-delete").parent()[0]),t._getParentRecords(i.updatedRecords,t).length<=0?(-1===n.indexOf("expandAll")||e(r).find(".e-expandall").parent("li").hasClass("e-disable")||l.push(e(r).find(".e-expandall").parent()[0]),-1===n.indexOf("collapseAll")||e(r).find(".e-collapseall").parent("li").hasClass("e-disable")||l.push(e(r).find(".e-collapseall").parent()[0])):(-1!==n.indexOf("expandAll")&&o.push(e(r).find(".e-expandall").parent()[0]),-1!==n.indexOf("collapseAll")&&o.push(e(r).find(".e-collapseall").parent()[0])),"click"==a.beginEditAction&&("click"!=a.beginEditAction||i.isEdit)||("batchediting"!=a.editMode.toLowerCase()||"batchediting"==a.editMode.toLowerCase()&&!t._batchEditStarts?(-1===n.indexOf("cancel")||e(r).find(".e-cancel").parent("li").hasClass("e-disable")||l.push(e(r).find(".e-cancel").parent()[0]),-1===n.indexOf("update")||e(r).find(".e-save").parent("li").hasClass("e-disable")||l.push(e(r).find(".e-save").parent()[0])):"batchediting"==a.editMode.toLowerCase()&&t._batchEditStarts&&(-1!==n.indexOf("cancel")&&e(r).find(".e-cancel").parent("li").hasClass("e-disable")&&o.push(e(r).find(".e-cancel").parent()[0]),-1!==n.indexOf("update")&&e(r).find(".e-save").parent("li").hasClass("e-disable")&&o.push(e(r).find(".e-save").parent()[0]))),l.forEach(function(t){e(r).ejToolbar("disableItem",t)}),o.forEach(function(t){e(r).ejToolbar("enableItem",t)})},_checkIsEmptyRow:function(e){for(var i,a=this.model.columns,r=0;r<a.length;r++)if(" "!==(i=this._getCustomCellValue(e,a[r].field))&&!t.isNullOrUndefined(i)&&""!==i&&!1!==i)return!1;return!0},_beginEdit:function(){this._trigger("beginEdit",{}),this._isinBeginEdit=!0},_endEdit:function(){var i,a=this;if(a._isinBeginEdit=!1,i=this.selectedRowIndex(),t.TreeGrid.getRowByIndex(a,i),!this.editFormValidate())return!0;e("tr").hasClass("e-addedrow")||e("tr").hasClass("e-rowedit")?a.saveRow():a.saveCell()},_refreshTreeGridOnExpandCollapseAll:function(e){var i,a,r,n=this,o=this.model;if(o.enableVirtualization)o.enableAltRow&&n.updateAltRow(),n.sendDataRenderingRequest(e),o.allowTextWrap?(n._$frozenTableContent.length>0&&n._updateRowHeight(),n._setScrollTop(e.requestType),n.updateHeight(),n.getScrollElement().hasClass("e-scroller")&&n.getScrollElement().ejScroller("refresh")):(n._setScrollTop(),n.updateHeight());else{if(o.allowPaging&&((i={}).totalRecordsCount=this.getExpandedRecords(o.updatedRecords).length,n.getPager().ejPager("option",i).ejPager("refreshPager"),a=this.getPager().ejPager("model"),n._currentPage(a.currentPage),i.requestType="paging",n.processBindings(i)),n._isRefreshAddedRecord)return n.processBindings(),this.renderRecords(),void(n._isRefreshAddedRecord=!1);o.allowTextWrap&&n._$frozenTableContent.length>0?(n._updateRowHeight(),n.getScrollElement().ejScroller("refresh"),r=n.getScrollElement().ejScroller("model.scrollTop"),n._getFrozenScrollElement().scrollTop(r)):n.updateHeight(),o.enableAltRow&&o.currentViewData.length>0&&t.TreeGrid.updateAltRow(n,n.model.currentViewData[0],0,0)}},_expandCollapseInnerLevelRecord:function(e,i){for(var a=this,r=e.childRecords.length,n={},o=0;o<r;o++)if(e.childRecords[o].hasChildRecords&&(n.data=e.childRecords[o],n.expanded=i,n.recordIndex=a.model.updatedRecords.indexOf(n.data),n.requestType=t.TreeGrid.Actions.ExpandCollapse,!a._triggerExpandingCollapsingEvent(n)&&(a._expandCollapseInnerLevelRecord(e.childRecords[o],i),e.childRecords[o].expanded!=i))){if(a._isLoadonDemand&&!e.childRecords[o].isChildRetrieved){if(a._isInExpandCollapseAll=!0,n.requestType=t.TreeGrid.Actions.ExpandCollapse,t.TreeGrid.expandRowsonDemand(a,e.childRecords[o],n)){a._allParentItems.splice(a._allParentItems.indexOf(e.childRecords[o]),1),e.childRecords[o].expanded=!1;continue}return!0}t.TreeGrid.sendExpandCollapseRequest(a,n)}},_expandParentLevelRecord:function(e,i){var a=this,r={},n=a.getExpandStatus(e);e.expanded&&n||(r.data=e,r.expanded=i,r.recordIndex=a.model.updatedRecords.indexOf(e),a._triggerExpandingCollapsingEvent(r)||t.TreeGrid.sendExpandCollapseRequest(a,r),r.data.parentItem&&a._expandParentLevelRecord(r.data.parentItem,i))},expandAtLevel:function(e){var i,a,r,n=this,o=n.model,l={};if(!n._isHierarchyFiltering)if(o.allowPaging&&o.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&o.enableVirtualization)n._expandCollapseSettings.atLevel="expandAtLevel",n._expandCollapseSettings.level=e,n._expandCollapsePages=[],n._isInExpandCollapseAll=!0,n._expandPageLevelData(),l.requestType=t.TreeGrid.Actions.ExpandCollapse,o.flatRecords.length>0&&n._refreshTreeGridOnExpandCollapseAll(l),n._isInExpandCollapseAll=!1,n.updateHeight();else{for(a=n._getParentRecords(n.model.updatedRecords,n),r=0;r<a.length;r++)if((i=a[r]).level==e){if(l.data=i,l.expanded=!0,l.recordIndex=o.updatedRecords.indexOf(i),n._isLoadonDemand&&!i.isChildRetrieved){if(l.recordLevel=e,l.isExpandingParticularLevelParent=!0,l.requestType=t.TreeGrid.Actions.ExpandCollapse,t.TreeGrid.expandRowsonDemand(n,i,l)){n._allParentItems.splice(n._allParentItems.indexOf(i),1),i.expanded=!1;continue}return}n._triggerExpandingCollapsingEvent(l)||t.TreeGrid.sendExpandCollapseRequest(n,l),i.parentItem&&n._expandParentLevelRecord(i.parentItem,l.expanded),i.hasChildRecords&&n._expandCollapseInnerLevelRecord(i,!1)}o.allowPaging&&!o.enableVirtualization&&(t.isNullOrUndefined(n.getPager())||n.gotoPage())}},collapseAtLevel:function(e){var i,a,r,n=this,o={},l=n.model;if(!n._isHierarchyFiltering)if(l.allowPaging&&l.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&l.enableVirtualization)n._expandCollapseSettings.atLevel="collapseAtLevel",n._expandCollapseSettings.level=e,n._expandCollapsePages=[],n._isInExpandCollapseAll=!0,n._collapsePageLevelData(),o.requestType=t.TreeGrid.Actions.ExpandCollapse,l.flatRecords.length>0&&n._refreshTreeGridOnExpandCollapseAll(o),n._isInExpandCollapseAll=!1,n.updateHeight();else{for(a=n._getParentRecords(l.updatedRecords,n),r=0;r<a.length;r++)(i=a[r]).level==e&&i.expanded&&(n.getExpandStatus(i)&&(o.data=i,o.expanded=!1,o.recordIndex=l.updatedRecords.indexOf(i),n._triggerExpandingCollapsingEvent(o)||t.TreeGrid.sendExpandCollapseRequest(n,o)));l.allowPaging&&!l.enableVirtualization&&(t.isNullOrUndefined(n.getPager())||n.gotoPage())}},_collapsePageLevelData:function(){var i,a,r,n=this,o={},l=n.model,d=n._expandCollapseSettings.level,s=n._getParentRecords(n._updatedPageData,n),c=s.length,u=n._currentPage();for(-1==e.inArray(u,n._expandCollapsePages)&&n._expandCollapsePages.push(u),r=0;r<c;r++)a=s[r],i=n.getExpandStatus(a),a&&a.level==d&&(o.data=a,o.recordIndex=l.updatedRecords.indexOf(a),o.expanded=!1,n._triggerExpandingCollapsingEvent(o)||(t.TreeGrid.sendExpandCollapseRequest(n,o),i||n._expandParentLevelRecord(a.parentItem,!0)))},_expandPageLevelData:function(){var i,a,r=this,n={},o=r.model,l=r._expandCollapseSettings.level,d=r._getParentRecords(r._updatedPageData,r),s=d.length,c=r._currentPage();for(-1==e.inArray(c,r._expandCollapsePages)&&r._expandCollapsePages.push(c),a=0;a<s;a++)(i=d[a]).level==l&&(n.data=i,n.expanded=!0,n.recordIndex=o.updatedRecords.indexOf(i),r._triggerExpandingCollapsingEvent(n)||(t.TreeGrid.sendExpandCollapseRequest(r,n),i.parentItem&&r._expandParentLevelRecord(i.parentItem,n.expanded),i.hasChildRecords&&r._expandCollapseInnerLevelRecord(i,!1)))},expandCollapseRow:function(e){var i,a,r=this,n={};e=parseInt(e),(a=r.model.allowPaging?r.getUpdatedRecords():r.model.updatedRecords).length>e&&e>=0&&((i=a[e]).hasChildRecords&&(n.data=i,n.expanded=!i.expanded,t.TreeGrid.sendExpandCollapseRequest(r,n)))},expandAll:function(){var e=this,i=e.model,a={};if(!e.editFormValidate())return!0;e._expandCollapseSettings.state="expandAll",e._expandCollapseSettings.atLevel="",e._expandCollapseSettings.level=0,e._expandCollapsePages=[],e._isRowEdit?e.cancelRowEditCell():e.model.isEdit&&e.cancelEditCell(),a.requestType=t.TreeGrid.Actions.ExpandCollapse,e._isInExpandCollapseAll=!0,e._expandAllData(),i.flatRecords.length>0&&e._refreshTreeGridOnExpandCollapseAll(a),e._isInExpandCollapseAll=!1,e.updateHeight()},_expandAllData:function(){var e,i,a=this,r=a.model,n=0,o={};if(o.requestType=t.TreeGrid.Actions.ExpandCollapse,r.allowPaging&&r.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&r.enableVirtualization){var l=r.pageSettings.pageSize,d=a._currentPage(),s=l*d,c=l*(d-1);for(a._expandCollapsePages.push(d),n=c;n<s;n++)if((e=a._isHierarchyFiltering?a._filterParentRecords[n]:a.model.parentRecords[n])&&(o.data=e,o.recordIndex=r.updatedRecords.indexOf(e),o.expanded=!0,e.hasChildRecords&&!a._triggerExpandingCollapsingEvent(o))){if(a._expandCollapseInnerLevelRecord(e,o.expanded))return;e.expanded!=o.expanded&&t.TreeGrid.sendExpandCollapseRequest(a,o)}}else for(i=a._isHierarchyFiltering?a._filterParentRecords:a.model.parentRecords,n=0;n<i.length;n++)if(e=i[n],o.data=e,o.recordIndex=r.updatedRecords.indexOf(e),o.expanded=!0,e.hasChildRecords&&!a._triggerExpandingCollapsingEvent(o)){if(a._isLoadonDemand&&!e.isChildRetrieved){if(a._isInExpandCollapseAll=!0,t.TreeGrid.expandRowsonDemand(a,e,o)){a._allParentItems.splice(a._allParentItems.indexOf(e),1),e.expanded=!1;continue}return}if(a._expandCollapseInnerLevelRecord(e,o.expanded))return;e.expanded!=o.expanded&&t.TreeGrid.sendExpandCollapseRequest(a,o)}},_refreshToolBar:function(){e("#"+this._id+"_toolbarItems").find("li").removeClass("e-hover")},_renderToolbar:function(){var t=this,i=t.model,a=t.element;i.isFromGantt||(t.model.toolbarSettings.showToolbar&&a.append(t._renderToolbarTemplate()),t.model.isResponsive&&e("#"+t._id+"_toolbarItems").addClass("e-treegridadaptivetoolbar"))},_renderToolbarTemplate:function(){var i,a,r,n=this,o=n.model,l=t.buildTag("div.e-treegridtoolbar#"+n._id+"_toolbarItems","",{height:"36px",border:"1px solid"},{"data-unselectable":"on"});return!t.isNullOrUndefined(o.toolbarSettings.toolbarItems)&&o.toolbarSettings.toolbarItems.length&&(i=t.buildTag("ul","",{},{}),n._renderLi(i),l.append(i)),!t.isNullOrUndefined(o.toolbarSettings.customToolbarItems)&&o.toolbarSettings.customToolbarItems.length&&(a=t.buildTag("ul","",{},{}),n._renderCustomLi(a),l.append(a)),(r={}).click=n._toolBarClick,r.cssClass=n.model.cssClass,r.rtl=!1,r.itemSeparator=!1,r.itemLeave=n._toolbarItemLeave,r.width=n._gridWidth,r.fields={id:"",tooltipText:"",imageUrl:"",text:"",imageAttributes:"",spriteCSS:"",htmlAttributes:""},l.ejToolbar(r),l.ejToolbar("disableItem",n._disabledToolItems),n._disabledToolItems=e(),l},_renderCustomLi:function(i){for(var a,r,n,o=this,l=o.model.toolbarSettings.customToolbarItems,d=0;d<l.length;d++)(l[d].text||l[d].templateID)&&(l[d].text?(a=l[d].tooltipText?l[d].tooltipText:l[d].text,r=t.buildTag("li","",{},{id:o._id+"_"+l[d].text,title:a}),n=t.buildTag("a.e-toolbaricons e-icon e-treegridcustomtoolbaritem","",{}).addClass(l[d].text),r.addClass("e-treegridtoolbaritem")):(a=l[d].tooltipText?l[d].tooltipText:l[d].templateID.replace("#",""),r=t.buildTag("li","",{},{id:o._id+"_"+l[d].templateID.replace("#",""),title:a}),n=e(l[d].templateID).hide().html()),r.html(n),i.append(r))},_renderLi:function(e){for(var i,a=this,r=a.model.toolbarSettings.toolbarItems,n=r.length,o=0;o<n;o++)i=t.buildTag("li.e-treegridtoolbaritem","",{},{id:a._id+"_"+r[o]}),a._renderLiContent(i,r[o]),e.append(i)},_renderLiContent:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w=this.model.selectionSettings.selectionMode,C=this.selectedRowIndex();this.model.editSettings;switch(a){case"add":r=t.buildTag("a.e-addnew e-toolbaricons e-icon e-treegrid-add","",{}),o=this._toolboxTooltipTexts.addTool,i.attr("title",o),this.model.editSettings.allowAdding||this._disabledToolItems.push(i.get(0));break;case"edit":r=t.buildTag("a.e-edit e-toolbaricons e-icon e-treegrid-edit","",{}),l=this._toolboxTooltipTexts.editTool,i.attr("title",l),this.model.editSettings.allowEditing&&-1!=C&&(-1==C||"cell"!=w)&&this.model.allowSelection&&"click"!=this.model.editSettings.beginEditAction||this._disabledToolItems.push(i.get(0));break;case"delete":d=this._toolboxTooltipTexts.deleteTool,i.attr("title",d),r=t.buildTag("a.e-delete e-toolbaricons e-icon e-treegrid-delete","",{}),this.model.editSettings.allowDeleting&&-1!=C&&(-1==C||"cell"!=w)&&this.model.allowSelection||this._disabledToolItems.push(i.get(0));break;case"update":s=this._toolboxTooltipTexts.updateTool,i.attr("title",s),r=t.buildTag("a.e-save e-toolbaricons e-icon e-treegrid-save e-disabletool","",{}),this._disabledToolItems.push(i.get(0));break;case"cancel":c=this._toolboxTooltipTexts.cancelTool,i.attr("title",c),r=t.buildTag("a.e-cancel e-toolbaricons e-icon e-treegrid-cancel e-disabletool","",{}),this._disabledToolItems.push(i.get(0));break;case"expandAll":u=this._toolboxTooltipTexts.expandAllTool,i.attr("title",u),n=t.buildTag("a.e-expandall e-toolbaricons e-icon e-treegrid-expandall","",{},{}),i.append(n);break;case"collapseAll":p=this._toolboxTooltipTexts.collapseAllTool,i.attr("title",p),n=t.buildTag("a.e-collapseall e-toolbaricons e-icon e-treegrid-collapseall","",{},{}),i.append(n);break;case"pdfExport":h=this._toolboxTooltipTexts.pdfExportTool,i.attr("title",h),n=t.buildTag("a.e-pdfIcon e-toolbaricons e-icon","",{},{}),i.append(n);break;case"excelExport":g=this._toolboxTooltipTexts.excelExportTool,i.attr("title",g),n=t.buildTag("a.e-excelIcon e-toolbaricons e-icon","",{},{}),i.append(n);break;case"print":m=this._toolboxTooltipTexts.printTool,i.attr("title",m),n=t.buildTag("a.e-printIcon e-toolbaricons e-icon","",{},{}),i.append(n);break;case"search":var T=this._toolboxTooltipTexts.searchTool,x=this,v=x.model.searchSettings.key;r=t.buildTag("a.e-searchitem e-toolbaricons e-disabletool e-icon e-searchfind","",{position:"absolute",padding:"4px","padding-left":"7px"}),_=t.buildTag("div.e-filterdiv e-searchinputdiv","",{display:"inline-table",width:"83%"}),n=t.buildTag("input.e-ejinputtext e-searchinput","",{width:"100%"},{type:"text",placeholder:T,value:v}),f=t.buildTag("span.e-searchcancel e-cancel e-icon e-hide e-spanstyle","",{right:"1%","padding-top":"0px",top:"0px"}),i.attr("title",T),i.addClass("e-search"),_.append(n).append(f),i.append(_),i.css({width:"172px"}),this.model.allowSearching=!0,n.keydown(e.proxy(this._keyDown,this)).focus(function(){x.element.find("span.e-searchcancel").removeClass("e-hide")}),r.click(e.proxy(this._keyDown,this)),_.focusout(function(){""==x.element.find("input.e-searchinput").val()&&e("span.e-searchcancel").addClass("e-hide")}),f.click(function(){x.element.find("input.e-searchinput").val(""),e(this).addClass("e-hide"),x.search("")}).mouseover(function(){this.style.cursor="pointer"})}i.append(r)},_updateToolbarItems:function(){var t=this,i=t.model,a=(i.toolbarSettings.toolbarItems,i.editSettings),r=(e("#"+t._id+"_toolbarItems"),t.selectedRowIndex(),a.editMode);"cellediting"==r.toLowerCase()||"dialogediting"==r.toLowerCase()?t._isRowEdit?t.cancelRowEditCell():i.isEdit&&t.cancelEditCell():"rowediting"==r.toLowerCase()&&t.cancelRowEditCell(),t._cancelSaveTools()},_renderAfterColumnInitialize:function(){this.element.append(this._renderGridHeader())},filterEditType:function(e,i,a){var r,n,o,l=this,d=(l.model,e.field.split(".").join(""));switch(t.isNullOrUndefined(e.filterEditType)&&(e.filterEditType=e.editType),e.filterEditType){case"stringedit":i.html(t.buildTag("input.e-ejinputtext e-filtertext e-field e-filterwidth","",{},{id:l._id+"_"+d+"_filterbarcell",name:e.field,value:a}));break;case"numericedit":r=t.buildTag("input.e-numerictextbox e-field","",{width:e.width-15},{type:"text",id:l._id+"_"+d+"_filterbarcell",name:e.field,value:a}),i.append(r);break;case"datepicker":case"datetimepicker":n=t.buildTag("input.e-"+e.filterEditType+" e-field","",{},{type:"text",id:l._id+"_"+d+"_filterbarcell",name:e.field,value:a}),i.append(n);break;case"booleanedit":case"dropdownedit":o=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",id:l._id+"_"+d+"_filterbarcell",name:e.field,value:a}),i.append(o)}},_filteringElements:function(a){var r,n,o,l,d,s,c,u,p,h,g,m=this,_=m.model,f=!1,w={};_.selectedItem;for("filtering"==a.requestType&&(n=document.getElementById(m._id+"_filterBar"+a.fieldname.split(".").join(""))),s=c=t.TreeGrid.getColumnByField(_.columns,a.fieldname),o=(r=e(n).find("input,select")).length,p=0;p<o;p++){if(w={},h=(l=r.eq(p)).closest("div").width()-2,l.hasClass("e-numerictextbox"))d=h,D=l.val(),w.width=d,w.showSpinButton=!0,w.cssClass=_.cssClass,w.locale=_.locale,w.height=28,w.focusIn=e.proxy(m._cancelEditState,m,l),l[0].id.replace(m._id,""),w.change="immediate"==_.filterSettings.filterBarMode?e.proxy(m._filterBarHandler,m,l):null,g=l.data("ejNumericTextbox"),t.isNullOrUndefined(g)&&(w.value=D.length?parseFloat(D):null),c=t.TreeGrid.getColumnByField(m.model.columns,l.prop("name")),t.isNullOrUndefined(c)||t.isNullOrUndefined(c.editParams)||e.extend(w,c.editParams),l.ejNumericTextbox(w),l.prop("name",l.prop("name").replace(m._id,""));else if(l.hasClass("e-datepicker"))d=h,w.width=d,w.cssClass=_.cssClass,w.dateFormat=_.dateFormat,w.locale=_.locale,w.height=28,w.focusIn=e.proxy(m._cancelEditState,m,l),l[0].id.replace(m._id,""),w.select="immediate"==_.filterSettings.filterBarMode?e.proxy(m._filterBarHandler,m,l):null,(s=t.TreeGrid.getColumnByField(m.model.columns,l.prop("name"))).format!==i&&s.format.length>0&&(u=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(s.format),w.dateFormat=u[2]),t.isNullOrUndefined(s.editParams)||e.extend(w,s.editParams),-1!=_.dateFormat.toLowerCase().indexOf("hh")?l.ejDateTimePicker(w):l.ejDatePicker(w),m._preventDoubleClick(s);else if(l.hasClass("e-datetimepicker"))(w={width:d=h,rtl:_.rtl,locale:_.locale,cssClass:_.cssClass,showButton:!1,focusIn:e.proxy(m._cancelEditState,m,l)}).height=28,w.close="immediate"==_.filterSettings.filterBarMode?e.proxy(m._filterBarHandler,m,l):null,(s=t.TreeGrid.getColumnByField(m.model.columns,l.prop("name"))).format!==i&&s.format.length>0&&(u=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(s.format),w.dateTimeFormat=u[2]),t.isNullOrUndefined(s.editParams)||e.extend(w,s.editParams),l.ejDateTimePicker(w),m._preventDoubleClick(s);else if(l.hasClass("e-dropdownlist")){var C,T,x,v,b,S=(s=t.TreeGrid.getColumnByField(_.columns,a.fieldname)).editParams&&s.editParams.fields&&s.editParams.fields.text?s.editParams.fields.text:"text",D=s.editParams&&s.editParams.fields&&s.editParams.fields.value?s.editParams.fields.value:"value",R=[];s.dropdownData&&s.dropdownData.length>0?R=e.extend(!0,[],s.dropdownData):"booleanedit"==s.editType?(R=[],(v={})[S]=m._trueText,v[D]="true",R.push(v),(b={})[S]=m._falseText,b[D]="false",R.push(b)):R=m._dropDownArrayCollection(s,a.fieldname),(C={})[S]=m._dropDownListClearText,C[D]=m._dropDownListClearText,R.splice(0,0,C),(x=s.allowFilteringBlankContent==i||s.allowFilteringBlankContent)&&((T={})[S]=m._dropDownListBlanksText,T[D]=m._dropDownListBlanksText,R.push(T));var y,I={},k=l.val(),M=e("#"+l[0].id).data("ejDropDownList");M&&(y=e(M.popupList)),I.width=h,I.showCheckbox=!1,I.dataSource=R,I.height=28,I.popupShown=e.proxy(m._cancelEditState,m,l),I.fields={text:S,value:D},I.popupHide="immediate"==_.filterSettings.filterBarMode?e.proxy(m._filterBarHandler,m,l):null,l.ejDropDownList(I),y&&(y.find(".e-ul :first-child").find(".e-ddltxt").css("font-style","italic"),x&&y.find(".e-ul :last-child").find(".e-ddltxt").css("font-style","italic")),k==m._dropDownListClearText&&(k=""),l.ejDropDownList("selectItemByValue",k),m._preventDoubleClick(s)}else switch(l.prop("tagName")){case"INPUT":l.width(h-4),"stringedit"==s.filterEditType&&m._on(e("#"+m._id+"_"+s.field.split(".").join("")+"_filterbarcell"),"focus",m._cancelEditState);break;case"SELECT":l.width(h).height(15)}l.is(":disabled")||f||l.is(":hidden")&&"object"!=typeof l.data("ejDropDownList")||m._isEnterKeyPressed||(f=!0)}},_dropDownArrayCollection:function(i,a){var r,n=this.model,o=a,l=[],d=[],s=i.editType;return r=e.map(n.flatRecords,function(e){if(!t.isNullOrUndefined(e.item[o]))return e.item[o]}),e.each(r,function(t,i){i=e.trim(i),-1===e.inArray(i,l)&&l.push(i)}),"numericedit"!=s?l.sort(this.stringCompare):l=l.sort(function(e,t){return e-t}),e.each(l,function(e,t){d.push({text:t,value:t})}),d},stringCompare:function(e,t){var i=[],a=[];for(e.replace(/(\d+)|(\D+)/g,function(e,t,a){i.push([t||1/0,a||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,i){a.push([t||1/0,i||""])});i.length&&a.length;){var r=i.shift(),n=a.shift(),o=r[0]-n[0]||r[1].localeCompare(n[1]);if(o)return o}return i.length-a.length},_preventDoubleClick:function(i){var a=this,r=e("#"+a._id+"_"+i.field.split(".").join("")+"_filterbarcell_popup");0!=r.length&&e(r).on("click",function(){t.isTouchDevice()?a._off(a.element,"doubletap ",".e-gridcontent",a._editdblClickHandler):a._off(a.element,"dblclick ",".e-gridcontent",a._editdblClickHandler),setTimeout(function(){t.isTouchDevice()?a._on(a.element,"doubletap ",".e-gridcontent",a._editdblClickHandler):a._on(a.element,"dblclick ",".e-gridcontent",a._editdblClickHandler)},300)})},_renderFiltering:function(i,a){var r,n,o,l,d,s,c,u=this,p=this.model,h=p.columns,g=p.filterSettings.filteredColumns,m=t.buildTag("tr.e-filterbar","",{},{});if(u.model.allowFiltering&&(e.each(h,function(e,i){t.isNullOrUndefined(i.allowFiltering)&&(i.allowFiltering=!0)}),r=!1,e.each(h,function(e,t){if(1==t.allowFiltering)return r=!0,!1}),r))for(n=0;n<i.length;n++){if(o=t.buildTag("th.e-filterbarcell .e-editValue","",{},{}),!1===i[n].visible&&o.addClass("e-hide"),l=t.buildTag("div.e-filterdiv","",{},{id:u._id+"_filterBar"+i[n].field.split(".").join("")}),m.append(o.append(l)),0==i[n].allowFiltering)continue;if(d="",g.length>0)for(s=0;s<g.length;s++)i[n].field==g[s].field&&(d=g[s].value);this.filterEditType(i[n],l,d),c=t.buildTag("span.e-cancel e-icon e-hide e-spanstyle"),l.append(c)}return p.showDetailsRow&&p.detailsTemplate&&p.showDetailsRowInfoColumn&&a&&m.append(t.buildTag("th.e-filterbarcell e-detailheadercell",'<div style="width:'+u._detailsColumnWidth+'px;"></div>')),m},_getIndentCol:function(){return t.buildTag("col","",{width:this._detailsColumnWidth+"px"})},_renderGridHeader:function(){var e,i,a=this,r=a.model,n=(document,t.buildTag("div.e-gridheadercontainer","",{overflow:"hidden"},{"data-unselectable":"on"})),o=r.isFromGantt?t.buildTag("div.e-gridheader#"+a._id+"e-gridheader","",{"border-left-style":"solid","border-left-width":"1px"},""):t.buildTag("div.e-gridheader#"+a._id+"e-gridheader","",{"border-top-style":"solid","border-left-style":"solid","border-right-style":"solid","border-top-width":"1px","border-left-width":"1px","border-right-width":"1px",width:a._gridWidth},"");return 1==r.allowFiltering&&r.filterSettings.filterType==t.TreeGrid.FilterType.FilterBar&&n.addClass("e-headercontent-material-filterbar"),n.addClass("e-headercontent"),a.setGridHeaderContent(o),a._$gridHeaderContainer=n,a._hiddenColumns=[],a._visibleColumns=[],a.columnsWidthCollection=[],a._removePrevHeaderTemplates(),this._frozenColumnsLength>0?(n.addClass("e-frozen-header-container"),e=t.buildTag("div.e-frozenheaderdiv#e-frozenheaderdiv"+a._id,this._renderGridHeaderInternalDesign(r.columns.slice(0,this._frozenColumnsLength),!1,!0)),1==r.allowFiltering&&r.filterSettings.filterType==t.TreeGrid.FilterType.FilterBar&&e.addClass("e-filterbar-header-material"),r.showStackedHeader&&r.stackedHeaderRows.length>0&&e.addClass("e-stacked-header-material"),i=t.buildTag("div.e-movableheader#e-movableheader"+a._id,t.buildTag("div.e-movableheaderdiv#e-movableheaderdiv"+a._id,this._renderGridHeaderInternalDesign(this.model.columns.slice(this._frozenColumnsLength),!0))),n.append(e).append(i)):(n.append(this._renderGridHeaderInternalDesign(this.model.columns,!0)),n.removeClass("e-frozen-header-container")),o.html(n),this.setGridHeaderTable(this.getHeaderContent().find(".e-table")),o},_removePrevHeaderTemplates:function(){e("[id^='"+this._id+"'][type='text/x-treegridheadertemplate']").remove(),this.headerAngularTemplate&&(this.headerAngularTemplate=null)},getPager:function(){return this._gridPager},setTreeGridPager:function(e){this._gridPager=e},_renderGridPager:function(){var i,a,r=this,n=e(document.createElement("div")),o={},l=r.model.pageSettings;return n.attr({id:this._id+"Pager"}),l.change=e.proxy(r._pagerClickHandler,r),t.isNullOrUndefined(l.totalRecordsCount)&&(l.totalRecordsCount=r._isLoadonDemand?r._pageRecordCountOnDemand:l.totalRecordsCount),e.extend(o,l),o.locale=r.model.locale,delete o.template,r._currentPage()<0&&r._currentPage(1),o.currentPage=this._prevPageNo=r._currentPage(),o.masterObject=r,o.cssClass=r.model.cssClass,r.setTreeGridPager(n),n.ejPager(o),n.ejPager("refreshPager"),o=n.ejPager("model"),l.totalPages=o.totalPages,r._currentPage()!==o.currentPage&&r._currentPage(o.currentPage),!t.isNullOrUndefined(l.template)&&l.template.length>0&&(n.children().remove(),i=t.buildTag("div.e-pagercontainer"),a=this._createTemplateElement(l,!0),i.append(a.innerHTML),n.append(i)),n},_addHeaderCheckboxTemplate:function(){var e=this.model,t=e.flatRecords.length,i=e.selectedItems.length;return t>0&&t==i?'<div><span class="e-chkbox-wrap e-widget" style="margin-left:5px;padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-act"><span class="e-checkbox e-checkmark e-chk-image e-icon e-headerCheckbox"id ='+this._id+"_headerCheckbox></span></span></div></span></div>":t>i&&i>0?'<div><span class="e-chkbox-wrap e-widget" style="margin-left:5px;padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-indeter"><span class="e-checkbox e-stop e-chk-image e-icon e-headerCheckbox"id ='+this._id+"_headerCheckbox></span></span></div></span></div>":'<div><span class="e-chkbox-wrap e-widget" style="margin-left:5px;padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-inact"><span class="e-checkbox e-chk-image e-icon e-headerCheckbox"id ='+this._id+"_headerCheckbox></span></span></div></span></div>"},_createStackedRow:function(a,r){for(var n,o,l,d,s,c,u,p,h,g,m=t.buildTag("tr.e-columnheader e-stackedHeaderRow"),_=[],f=[],w=[],C=[],T=this.model,x=T.columns.length,v=a.stackedHeaderColumns,b=[],S=T.scrollSettings.frozenColumns,D=[],R=0,y=0,I=0,k=0;k<x;k++)if(0!=(l=T.columns[k]).visible||l==T.columns[T.treeColumnIndex]&&0==l.visible){var M="",E="",H="",P="";for(n=0;n<v.length;n++)d=Array.isArray(v[n].column)?v[n].column:e.map(v[n].column.split(","),e.trim),s="e-row"+e.inArray(a,T.stackedHeaderRows)+"-column"+n,-1!=e.inArray(l.field,d)&&(M=v[n].headerText,E=v[n].cssClass,H=v[n].textAlign,P=v[n].tooltip?" e-stackedtooltip "+s:"");_.push(M),f.push(E),w.push(H),C.push(P)}for(o=0;o<_.length;o++){for(u=1,p=o+1;p<_.length&&_[o]==_[p];p++)u++;b.push({spanCount:u,headerText:_[o],cssClass:f[o],txtAlign:w[o],tooltip:C[o]}),o+=u-1}if(S>0){for(o=0;o<x;o++)n=T.columns[o],o<S&&0==n.visible&&I++;for(R=S-I;R>0;)c=b[y].spanCount,b[y].spanCount<R?(D.push(b[y]),r?y++:b.splice(y,1)):b[y].spanCount>R?(b[y].spanCount=b[y].spanCount-R,r&&D.push({spanCount:R,headerText:b[y].headerText})):(D.push(b[y]),r||b.splice(y,1)),R-=c;r&&(b=D)}for(k=0;k<b.length;k++)h=t.buildTag("th.e-headercell e-stackedHeaderCell","",{},{colspan:b[k].spanCount}),g=t.buildTag("div.e-headercelldiv  e-default"+b[k].tooltip,b[k].headerText,{textAlign:b[k].txtAlign},{}),h.append(g),m.append(h),b[k].cssClass!=i&&h.addClass(b[k].cssClass),(T.allowColumnResize||T.allowColumnReordering)&&h.addClass("e-resizer");return T.detailsTemplate&&T.showDetailsRow&&T.showDetailsRowInfoColumn&&1!=r&&m.append(t.buildTag("th.e-headercell e-detailheadercell","<div></div>")),m},getHeaderCell:function(e){var i=this.model.columns.indexOf(this.getColumnByField(e)),a=null;return t.isNullOrUndefined(i)||-1==i||(a=this.getHeaderTable().find("thead tr:not('.e-stackedHeaderRow')").find(".e-headercell").not(".e-detailheadercell").eq(i)),a},_createHeaderTemplateElement:function(i){var a,r=(i.field?i.field:"")+e.inArray(i,this.model.columns)+"_HeaderTemplate",n=i.headerTemplateID,o=/^#([\w-]*)/.exec(n),l={name:"SCRIPT",type:"text/x-treegridheadertemplate",text:n,id:(this._id+r).replace(/(\\|[^0-9A-z-_])/g,"")};return(a=o&&o[1]?document.getElementById(o[1]):/^<script/i.test(n)?e(n).get(0):t.buildTag(l.name,l.text).get(0)).id=a.id||l.id,a.type=a.type||l.type,e("#"+a.id).remove(),e("body").append(a),a},_getColWidth:function(e,i){var a,r=this.model,n=r.columns;"msie"==t.browserInfo().name&&r.isFromGantt&&!t.isNullOrUndefined(n[e].width)&&parseInt(n[e].width)<42&&(a=parseInt(n[e].width)-8,i.hasClass("e-column-menu-padding")&&i.removeClass("e-column-menu-padding"),i.css("padding-right",a+"px"))},_renderGridHeaderInternalDesign:function(a,r,n){var o,l,d,s,c,u,p,h,g,m,_,f,w=this,C=w.model,T=document,x=t.buildTag("table.e-table e-zerospace"),v=t.buildTag("thead"),b=(t.buildTag("tbody.e-hide"),t.buildTag("tr.e-columnheader")),S=e(T.createElement("colgroup")),D=e(T.createElement("tr")),R=0,y=a.length,I=C.stackedHeaderRows.length;if((C.allowSorting||C.showColumnChooser||C.allowColumnReordering)&&b.css({cursor:"pointer"}),"wrap"===C.headerTextOverflow?w.element.addClass("e-wrap"):w.element.removeClass("e-wrap"),C.showStackedHeader)for(p=0;p<I;p++)h=w._createStackedRow(C.stackedHeaderRows[p],n),v.append(h);for(;R<y;R++)if(a[R]){if(g=a[R].headerTextAlign?a[R].headerTextAlign:a[R].textAlign?a[R].textAlign:t.TextAlign.Left,!C.showColumnChooser&&(C.showColumnChooser||!C.allowFiltering||"menu"!=C.filterSettings.filterType&&"excel"!=C.filterSettings.filterType)||"checkboxState"==a[R].field?o=t.buildTag("th.e-headercell","",{},{}):t.isNullOrUndefined(a[R].allowFiltering)||a[R].allowFiltering||w.model.showColumnChooser?((o=t.buildTag("th.e-headercell","",{},{})).addClass("e-column-menu-padding"),this._getColWidth(R,o)):o=t.buildTag("th.e-headercell","",{},{}),C.allowFiltering&&C.filterSettings.filterType==t.TreeGrid.FilterType.FilterBar&&o.addClass("e-filterbar-material"),l=T.createElement("td"),d=t.buildTag("div.e-headercelldiv","",{"text-align":g},{"data-ej-mappingname":a[R].field,"data-unselectable":"on"}),a[R].clipMode&&a[R].clipMode==t.TreeGrid.ClipMode.Ellipsis&&d.addClass("e-treegridtrimcell"),w._checkboxSelection&&C.selectionSettings.enableSelectAll&&w._checkboxColumnName==a[R].field&&d.append(w._addHeaderCheckboxTemplate()),"checkboxState"==a[R].field&&o.css({cursor:"default"}),m=t.buildTag("span",a[R].headerText==i?a[R].headerText=a[R].field:a[R].headerText),"wrap"==C.headerTextOverflow&&d.addClass("e-textwrapheaderdiv"),d.append(m),o.append(d),w.model.showColumnChooser&&!a[R].nonColumn)_=t.buildTag("div.e-columnmenu-icon e-icon e-columnicon","",{cursor:"pointer"}),"wrap"==C.headerTextOverflow&&_.addClass("e-textwrapcolumnicon"),_.data("isClicked",!1),o.append(_);else if(!C.showColumnChooser&&C.allowFiltering&&("menu"==C.filterSettings.filterType||"excel"==C.filterSettings.filterType)&&(t.isNullOrUndefined(a[R].allowFiltering)||a[R].allowFiltering)&&"checkboxState"!=a[R].field){if(u=-1!=w._filteredColumnValueID.indexOf(a[R].field)?t.buildTag("div.e-column-filtered-icon e-icon e-filtericon","",{cursor:"pointer"}):t.buildTag("div.e-column-filter-icon e-icon e-filtericon","",{cursor:"pointer"}),w.model.filterSettings.filteredColumns)for(f=0;f<w.model.filterSettings.filteredColumns.length;f++)w.model.filterSettings.filteredColumns[f].field==a[R].field&&""!=w.model.filterSettings.filteredColumns[f].value.toString()&&(u=t.buildTag("div.e-column-filtered-icon e-icon e-filtericon","",{cursor:"pointer"}));u.data("isClicked",!1),o.append(u)}s=T.createElement("col"),D.append(l),b.append(o),S.append(s),!1===a[R].visible&&a[R]!=C.columns[C.treeColumnIndex]?o.addClass("e-hide")&&e(s).css("display","none")&&w._hiddenColumns.push(a[R].headerText):(w._visibleColumns.push(a[R].headerText),a[R].visible=!0),!1===a[R].allowSorting&&o.css({cursor:"normal"}),t.isNullOrUndefined(a[R].headerTemplateID)||d.html(w._renderEjTemplate("#"+this._createHeaderTemplateElement(a[R]).id,a[R],0,a[R],"treegridheadertemplate")).parent().addClass("e-headertemplate"),a[R].allowCellSelection==i&&(a[R].allowCellSelection=!0),a[R].showInColumnChooser==i&&(a[R].showInColumnChooser=!0),a[R].width==i&&C.commonWidth!==i?(w.columnsWidthCollection.push(C.commonWidth),a[R].width=C.commonWidth):(w.columnsWidthCollection.push(parseFloat(a[R].width)),a[R].width=parseFloat(a[R].width)),w._fieldColumnNames[a[R].headerText]=a[R].field,w._headerColumnNames[a[R].field]=a[R].headerText}return C.isFromGantt&&w.updateToGanttColumns(),C.showDetailsRow&&C.detailsTemplate&&C.showDetailsRowInfoColumn&&r&&(b.append(t.buildTag("th.e-headercell e-detailheadercell",'<div style="width:'+w._detailsColumnWidth+'px;"></div>',{},{})),S.append(this._getIndentCol())),C.allowFiltering&&!C.isFromGantt&&"filterbar"==C.filterSettings.filterType&&(c=this._renderFiltering(a,r)),v.append(b),c&&v.append(c),x.append(S).append(v),x},_initGridRender:function(){var e=this;e._addInitTemplate(),e._renderGrid(),e.model.allowColumnResize&&(e._resizer=new t.gridFeatures.gridResize(e))},_summaryRow:function(){var i,a,r=this,n=r.model;n.showSummaryRow&&(r._createSummaryRow(),(i={}).requestType=t.TreeGrid.Actions.Refresh,r.sendDataRenderingRequest(i),r.updateCollapsedRecordCount(),r._updateWrapRowHeights("header"),r.updateHeight(),(n.allowTextWrap||"wrap"==n.headerTextOverflow)&&r._updateGridContentHeight()),n.showTotalSummary&&(a=e("#"+r._id+"-footersummaryrow").length,r._createTotalSummaryRow(),0==a&&(r._viewPortHeight=r._viewPortHeight-r._$totalSummaryRowContainer.outerHeight()),n.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||n.isFromGantt||this._updateTableWidth(),this._updateHeaderScrollLeft())},_renderGrid:function(){this._renderGridContent().insertAfter(this.element.children(".e-gridheader"))},_renderFrozenSummary:function(){this._$footerContainer.find("#e-frozenfooterdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[0]),this._$footerContainer.find("#e-movablefooterdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[1]),this._$footerContainer.find("#e-frozenfooterdiv"+this._id+" .e-table tbody").html(e.render[this._id+"_JSONFrozenTemplate"](this._footerSummaryRecord)),this._$footerContainer.find("#e-movablefooterdiv"+this._id+" .e-table tbody").html(e.render[this._id+"_Template"](this._footerSummaryRecord))},_renderSummaryByFrozenDesign:function(){var i=e(document.createElement("div")),a=this._getMetaColGroup().find("col"),r={};return r.colgroup1=i.append(t.buildTag("colgroup").append(a.splice(0,this._frozenColumnsLength))).html(),r.colgroup2=i.html(t.buildTag("colgroup").append(a)).html(),e.templates[this._id+"_FrozenSummaryTemplate"]||this.addFrozenSummaryTemplate(),e.render[this._id+"_FrozenSummaryTemplate"](r)},_spliceSummaryRows:function(e){this.model;var t=[];e.filter(function(e){e.isSummaryRow||t.push(e)});return t},addFrozenSummaryTemplate:function(){var t="<div class='e-frozenfooterdiv' id='e-frozenfooterdiv"+this._id+"'><table class='e-table e-zerospace' style='width:100%' id='"+this._id+"frozensummarye-table'>{{:colgroup1}}<tbody></tbody></table></div><div class='e-movablefooter' id='e-movablefooter"+this._id+"'><div class='e-movablefooterdiv' id='e-movablefooterdiv"+this._id+"'><table class='e-table e-zerospace' id='"+this._id+"movablesummarye-table'>{{:colgroup2}}<tbody></tbody></table></div></div>",i={};i[this._id+"_FrozenSummaryTemplate"]=t,e.templates(i)},expandCollapseTotalSummary:function(i){var a,r,n,o,l=this,d=l.model;if(d.showTotalSummary&&d.collapsibleTotalSummary){if(l._footerSummaryRecord[0].summaryExpanded==i)return;if((a={}).expanded=i,a.requestType=i?"summaryExpanding":"summaryCollapsing",a.data=l._footerSummaryRecord[0],a.columnName=d.columns[this._summaryColumnIndex].headerText,a.cellValue=t.isNullOrUndefined(a.data)?"":a.data[d.columns[this._summaryColumnIndex].field],a.isFromUserAction=l._isInManualExpandCollapse,r=e(l.element).find(".e-firstfootersummaryrow"),n=e(l.element).find(".e-footersummaryrow"),i){if(l._trigger("expanding",a),a.cancel)return;n.css({display:"table-row"}),r.find(".e-summarytreegridcollapse").removeClass("e-summarytreegridcollapse").addClass("e-summarytreegridexpand"),l._footerSummaryRecord[0].summaryExpanded=!0,(o={}).expanded=i,o.data=l._footerSummaryRecord[0],o.columnName=d.columns[this._summaryColumnIndex].headerText,o.cellValue=t.isNullOrUndefined(a.data)?"":a.data[d.columns[this._summaryColumnIndex].field],o.requestType="summaryExpanded",o.isFromUserAction=l._isInManualExpandCollapse,l._trigger("expanded",o)}else{if(l._trigger("collapsing",a),a.cancel)return;n.css({display:"none"}),r.css({display:"table-row"}),r.find(".e-summarytreegridexpand").removeClass("e-summarytreegridexpand").addClass("e-summarytreegridcollapse"),l._footerSummaryRecord[0].summaryExpanded=!1,(o={}).expanded=i,o.data=l._footerSummaryRecord[0],o.columnName=d.columns[this._summaryColumnIndex].headerText,o.cellValue=t.isNullOrUndefined(a.data)?"":a.data[d.columns[this._summaryColumnIndex].field],o.requestType="summaryCollapsed",o.isFromUserAction=l._isInManualExpandCollapse,l._trigger("collapsed",o)}l._$totalSummaryRowContainer.ejScroller({height:i?d.rowHeight:d.totalSummaryHeight}),l._updateGridContentHeight(),l._updateSummaryHeight()}},_createTotalSummaryRow:function(){var i,a,r,n,o,l,d,s=this,c=s.model,u=(c.flatRecords,c.summaryRows),p=u.length,h=(c.updatedRecords,c.parentRecords,c.columns),g=t.buildTag("tbody");for(c.totalSummaryHeight=c.totalSummaryHeight<c.rowHeight?c.rowHeight:c.totalSummaryHeight,s._footerSummaryRecord=[],s._footerSummaryRows=[],c.collapsibleTotalSummary&&0!=e("#"+s._id+"-footersummaryrow").length&&0!=e("#"+s._id+"-footersummaryrow").find(".e-summarytreegridcollapse").length&&(s._persistCollapseState=!0),e("#"+s._id+"-footersummaryrow").remove(),i=t.buildTag("div.e-footersummaryrowdiv#"+s._id+"-footersummaryrow","",{overflow:"hidden",cursor:"default"}),a=t.buildTag("div.e-footercontainer#e-footercontainer"+s._id,"",{overflow:"hidden"}),s._flatChildRecords=s._spliceSummaryRows(c.updatedRecords),r=1;r<=p;r++){for(n={},o=0;o<h.length;o++)n[h[o].field]="";n=s._createSummaryItem(n,u[r-1]),l=s._createRecord(n,0),1==r&&(l.isFirstFooterSummary=!0,c.collapsibleTotalSummary&&(l.summaryExpanded=!0)),l.footerSummaryRowRecord=!0,l.index=r,s._footerSummaryRecord.push(l)}s._$footerContainer=a,this._frozenColumnsLength>0?(a.html(this._renderSummaryByFrozenDesign()),this._renderFrozenSummary()):((d=t.buildTag("table.e-table e-zerospace#"+s._id+"summarye-table","",{top:"0px"})).append(s.getContentTable().find("colgroup").clone()).append(g),g.html(e.render[this._id+"_Template"](s._footerSummaryRecord)),a.append(d)),s._$totalSummaryRowContainer=i,s._$footertableContent=a.find(".e-table"),i.append(a),c.allowPaging?s.element.append(e("#"+this._id+"Pager").before(i)):s.element.append(i),s._flatChildRecords=[],this._setWidthToFooters(),this._$totalSummaryRowContainer.height()<=c.totalSummaryHeight?(s.isVScroll()&&s._$totalSummaryRowContainer.addClass("e-scrollcss"),c.totalSummaryHeight=this._$totalSummaryRowContainer.height()):s._$totalSummaryRowContainer.ejScroller({height:"auto"==c.sizeSettings.height?0:c.totalSummaryHeight}),"auto"==c.sizeSettings.height&&e("#"+s._id+"-footersummaryrow").width(s._gridWidth-2),s._updateSummaryTitleColumn(),1==s._persistCollapseState&&(s.expandCollapseTotalSummary(!1),s._persistCollapseState=!1),c.columnResizeSettings.columnResizeMode==t.TreeGrid.ColumnResizeMode.FixedColumns&&this._updateTableWidth()},_getFooterRows:function(){var t=e();return this.model.showTotalSummary&&this._$footertableContent&&(t=this._$footertableContent.get(0).rows,this._frozenColumnsLength>0&&(t=[t,this._$footertableContent.get(1).rows])),e(t)},_setWidthToFooters:function(){var e,t=this._gridWidth;this._frozenColumnsLength>0&&(e=this._getFrozenColumnWidth(),this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).width(t).next().css("margin-left",e+"px"),this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).outerWidth(e).end().find("#e-movablefooterdiv"+this._id).css("width","100%"))},_excludeSummaryRows:function(){var t=e();this.model;return this.getTreeGridRows()&&this.getTreeGridRows().length>0&&(t=this._frozenColumnsLength>0?[e(this.getTreeGridRows()[0]).not(".e-summaryrow"),e(this.getTreeGridRows()[1]).not(".e-summaryrow")]:e(this.getTreeGridRows()).not(".e-summaryrow")),t},_createSummaryRow:function(e){var i,a,r,n,o,l,d,s,c,u,p,h=this,g=h.model,m={},_=g.summaryRows,f=_.length,w=g.columns;if(!e||"dragAndDrop"!=e.requestType&&"addNewRow"!=e.requestType&&"sorting"!=e.requestType)i=h._isHierarchyFiltering?h._findFilteredParentRecords(h._flatFilteredRecords):h._parentRecords;else if(i=h._getParentRecords(g.updatedRecords,h),"dragAndDrop"==e.requestType)for(r=0;r<i.length;r++)n=[],n=i[r].childRecords.filter(function(e){if(!e.isSummaryRow)return!0}),i[r].childRecords=n.slice();for(o=i.length,e&&t.isNullOrUndefined(e.filterCollection)&&(e.filterCollection=[]),g.enableCollapseAll&&g.enableVirtualization&&!e&&(g.updatedRecords=g.flatRecords.slice()),g.updatedRecords=h._spliceSummaryRows(g.updatedRecords),g.flatRecords=h._spliceSummaryRows(g.flatRecords),g.summaryRowRecords=[],h._flatChildRecords=[],l=0;l<o;l++)if(d=i[l],0!=(a=h._getChildRecordsLength(d,g.updatedRecords))){for(s=1;s<=f;s++){for(c=0;c<w.length;c++)m[w[c].field]="";m=h._createSummaryItem(m,_[s-1],d),u=g.updatedRecords.indexOf(d)+a+s,p=h._createRecord(m,u),h._isHierarchyFiltering&&g.enableVirtualization&&(p.isDisplay=!0),h._isSummaryRow=!0,p.level=d.level+1,p.parentItem=d,p.isSummaryRow=!0,p.index=g.flatRecords.length+1,g.enableVirtualization?(h._isHierarchyFiltering&&(g.updatedRecords=h._updateFilterParent),g.updatedRecords.splice(u,0,p),(!e||e&&e.filterCollection)&&g.summaryRowRecords.push(g.updatedRecords[u])):(g.updatedRecords.splice(u,0,p),g.summaryRowRecords.push(g.updatedRecords[u])),u=g.flatRecords.indexOf(d)+a+s,g.flatRecords.splice(u,0,p),d.childRecords.push(p),m={},s==f&&(p.isLastSummary=!0)}h._flatChildRecords=[]}h._isSummaryRow=!1,h._summaryRowsCount=i.length,g.enableVirtualization&&(g.updatedRecords=h.getExpandedRecords(g.updatedRecords),g.enableAltRow&&h.updateAltRow()),this._updateCurrentViewData()},_getInnerParentRecords:function(e,t,i){e.childRecords.length;for(var a=0;a<e.childRecords.length;a++)e.childRecords[a].hasChildRecords&&(-1==i.indexOf(e.childRecords[a])&&i.push(e.childRecords[a]),t._getInnerParentRecords(e.childRecords[a],t,i))},_getParentRecords:function(e,i,a){for(var r,n=e.length,o=[],l=0;l<n;l++)r=e[l],a?t.isNullOrUndefined(r.parentItem)&&o.push(r):r.childRecords&&r.childRecords.length>0?i.model.enableVirtualization||i.model.allowPaging&&i.model.showSummaryRow?(-1==o.indexOf(r)&&o.push(r),i._getInnerParentRecords(r,i,o)):o.push(r):i._isLoadonDemand&&r.hasChildRecords&&-1==o.indexOf(r)&&o.push(r);return o},_getChildRecordsLength:function(e,t){for(var i,a=this,r=t.length,n=0;n<r;n++)(i=t[n]).summaryRow||e==i.parentItem&&(a._flatChildRecords.push(i),i.hasChildRecords&&a._getChildRecordsLength(i,t));return a._flatChildRecords.length},_createSummaryItem:function(e,i){for(var a,r=this,n=i.summaryColumns,o=n.length,l=0;l<o;l++){var d=n[l],s=d.prefix,c=d.suffix,u=d.displayColumn;for(a in t.isNullOrUndefined(u)&&(u=d.dataMember),t.isNullOrUndefined(s)&&(s=""),t.isNullOrUndefined(c)&&(c=""),e.summaryColumn=d,e.summaryRow=i,e)a==u&&(e[a]=e[a]?e[a]+" "+s+r._getSummaryValues(d,r._flatChildRecords)+c:s+r._getSummaryValues(d,r._flatChildRecords)+c)}return e},_getSummaryValues:function(i,a){var r,n,o,l,d,s=i.dataMember,c=i.format,u=a,p="";switch(u instanceof t.DataManager?(r=u,u=u.dataSource.json):r=t.DataManager(u),i.summaryType){case t.TreeGrid.SummaryType.Sum:p=t.sum(u,s);break;case t.TreeGrid.SummaryType.Average:p=t.avg(u,s),p=isNaN(p)||t.isNullOrUndefined(p)?"":p;break;case t.TreeGrid.SummaryType.Maximum:o=t.max(u,s),p=parseInt(this._getCustomCellValue(o,i.dataMember)),p=isNaN(p)||t.isNullOrUndefined(p)?"":p;break;case t.TreeGrid.SummaryType.Minimum:n=u.filter(function(e){if(""!==e[s])return!0}),o=t.min(n,s),p=parseInt(this._getCustomCellValue(o,i.dataMember)),p=isNaN(p)||t.isNullOrUndefined(p)?"":p;break;case t.TreeGrid.SummaryType.MaximumDate:p=this._getMaxDate(u,s),p=t.isNullOrUndefined(p)?"":p;break;case t.TreeGrid.SummaryType.MinimumDate:p=this._getMinDate(u,s),p=t.isNullOrUndefined(p)?"":p;break;case t.TreeGrid.SummaryType.Count:p=u.length;break;case t.TreeGrid.SummaryType.TrueCount:l=t.Predicate(i.dataMember,"equal",!0),p=r.executeLocal(t.Query().where(l)).length;break;case t.TreeGrid.SummaryType.FalseCount:l=t.Predicate(i.dataMember,"equal",!1),p=r.executeLocal(t.Query().where(l)).length;break;case t.TreeGrid.SummaryType.Custom:(d=i.customSummaryValue)&&("string"==typeof d&&(d=t.util.getObject(d,window)),p=e.isFunction(d)?d.call(this,i,u):i.customSummaryValue)}return t.isNullOrUndefined(c)||(p=this.formatting(c,p,this.model.locale)),p},_getMaxDate:function(e,t){for(var i=0,a=null,r=0;r<e.length;r++){var n=e[r],o=new Date(n[t]).getTime();o>i&&(i=o,a=n[t])}return a},_getMinDate:function(e,t){var i;if(0==e.length)return null;var a=new Date(e[0][t]).getTime(),r=e[0][t];for(i=0;i<e.length;i++){var n=e[i],o=new Date(n[t]).getTime();o<a&&(a=o,r=n[t])}return r},_createAndRenderSummaryRecords:function(e){var i,a=this;a._createSummaryRow(e),(i={}).requestType=t.TreeGrid.Actions.Refresh,a.sendDataRenderingRequest(i),a.updateCollapsedRecordCount(),a.updateHeight()},_mergeRecords:function(){for(var e=this.batchChanges,t=e.changed,i=e.added,a=[],r=0;r<t.length;r++)a[t[r]]||a.push(t[r]);for(r=0;r<i.length;r++)a[i[r]]||a.push(i[r]);return a},_updateSummaryRow:function(i){var a,r,n,o,l,d,s,c,u,p,h=this,g=h.model,m=[],_=[],f=h.getUpdatedRecords();if(!i||"dragAndDrop"!=i.requestType||(i.rowIndex=f.indexOf(h._droppedRecord),-1!=i.rowIndex)){if(i&&"delete"==i.requestType)return void h._updateAfterDeleteRecord(i);if(i&&"celledit"==i.editType&&("numericedit"==i.columnObject.editType&&(n=parseInt(i.value),i.value=isNaN(n)?"":n,i.data[i.columnName]=i.value),i.currentValue=i.value,o=h.getIndexByRow(i.rowElement),l=g.enableVirtualization?g.currentViewData[o]:f[o],i.rowIndex=f.indexOf(l)),i.currentValue!=i.previousValue||"dragAndDrop"==i.requestType||"addNewRow"==i.requestType||h._batchEditCancel){if(r="addNewRow"==i.requestType?g.updatedRecords[i.rowIndex]:f[i.rowIndex],h._batchEditCancel&&(r=i.record),r.parentItem&&(_=h._getpRecords(r,h)),t.isNullOrUndefined(_))return;for(d=0;d<_.length;d++)s=g.summaryRowRecords,p=[],h._getChildRecordsLength(_[d],f),e.each(s,function(n,o){var l,s,f,w,C,T;if(a=o.summaryRow,o.parentItem===_[d])for(p=[],l=a.summaryColumns.length,s=0;s<l;s++){var x=a.summaryColumns[s],v=x.prefix,b=x.suffix;t.isNullOrUndefined(v)&&(v=""),t.isNullOrUndefined(b)&&(b=""),"rowedit"==i.editType&&(i.columnName=x.dataMember,g.columns,f=h.getColumnIndexByField(i.columnName),"numericedit"==g.columns[f].editType&&(r[i.columnName]=parseInt(r[i.columnName]))),(w=x.displayColumn)||(w=x.dataMember),c=g.currentViewData.indexOf(o),u=h.getColumnIndexByField(w),i.data=o,-1!=u&&(h._frozenColumnsLength>0?h._frozenColumnsLength>u?i.rowElement=e(h.getRows()[0][c]):(i.rowElement=e(h.getRows()[1][c]),u-=h._frozenColumnsLength):i.rowElement=e(h.getRows()[c]),i.cellElement=i.rowElement.find(".e-rowcell").eq(u),C=v+h._getSummaryValues(x,h._flatChildRecords)+b,-1==p.indexOf(w)?(0!=e(i.cellElement).find(".e-summarytitle").length?(T=e(i.cellElement).find(".e-summarytitle").clone(),e(i.cellElement).empty().html(C).prepend(T)):e(i.cellElement).empty().html(C),o[w]=C,p.push(w)):(e(i.cellElement).append(" "+C),o[w]=o[w]+" "+C),m.push(o),h._updateWrapRowHeights("total,header","virtualRefresh",c,"savecell"))}}),h._flatChildRecords=[],h._summaryRowCount=_.length}}},_updateTotalSummaryRow:function(i){var a,r,n,o;if("dragAndDrop"!=i.requestType&&!i.isDragAndDropDelete){var l,d,s,c,u,p,h=this,g=h.model,m=g.summaryRows,_=m.length;for(a=0;a<_;a++)for(d=(l=m[a].summaryColumns).length,s=h._footerSummaryRecord[a],r=[],n=0;n<d;n++){var f=l[n],w=f.prefix,C=f.suffix;if(t.isNullOrUndefined(w)&&(w=""),t.isNullOrUndefined(C)&&(C=""),("rowedit"==i.editType||"celledit"==i.editType)&&(i.columnName=f.dataMember),c||(c=f.dataMember),(f.dataMember==i.columnName||"delete"==i.requestType||"filtering"==i.requestType||"addNewRow"==i.requestType||"searching"==i.requestType)&&(c=f.displayColumn,u=h._footerSummaryRecord.indexOf(s),p=h.getColumnIndexByField(c),i.data=s,-1!=p)){this._frozenColumnsLength>0?this._frozenColumnsLength>p?i.rowElement=this._getFooterRows()[0][u]:(i.rowElement=this._getFooterRows()[1][u],p-=this._frozenColumnsLength):i.rowElement=this._getFooterRows()[u],i.cellElement=i.rowElement.childNodes[p];var T=h._spliceSummaryRows(g.updatedRecords),x=w+h._getSummaryValues(f,T)+C;-1==r.indexOf(c)?(0!=e(i.cellElement).find(".e-summarytitle").length||e(i.cellElement).find(".e-icon").length>0?(o=e(i.cellElement).find(".e-summarytitle, .e-icon").clone(),e(i.cellElement).empty().html(x).prepend(o)):e(i.cellElement).empty().html(x),r.push(c),s[c]=x):(e(i.cellElement).find(".e-summarytitle").length>0||e(i.cellElement).find(".e-icon").length>0?e(i.cellElement).find(".e-summarycell").append(" "+x):e(i.cellElement).append(" "+x),s[c]=s[c]+" "+x)}}g.allowTextWrap&&h._updateTotalSummaryHeight()}},_updateAfterDeleteRecord:function(i){var a,r,n,o,l,d=this,s=d.model,c=[],u=i.data;if(u.parentItem&&(r=d._getpRecords(u,d)),!t.isNullOrUndefined(r))for(o=0;o<r.length;o++)l=s.summaryRowRecords,0!=r[o].childRecords.length&&(d._getChildRecordsLength(r[o],s.updatedRecords),e.each(l,function(l,u){var p,h,g,m;if(a=u.summaryRow,u.parentItem===r[o]){for(n=[],p=a.summaryColumns.length,h=0;h<p;h++){var _=a.summaryColumns[h],f=_.displayColumn,w=s.currentViewData.indexOf(u),C=d.getColumnIndexByField(f),T=_.prefix,x=_.suffix;t.isNullOrUndefined(T)&&(T=""),t.isNullOrUndefined(x)&&(x=""),i.data=u,d._frozenColumnsLength>0?d._frozenColumnsLength>C?i.tr=e(d.getRows()[0][w]):(i.tr=e(d.getRows()[1][w]),C-=d._frozenColumnsLength):i.tr=e(d.getRows()[w]),i.tr=e(d.getRows()[w]),i.cellElement=i.tr.find(".e-rowcell").eq(C),g=T+d._getSummaryValues(_,d._flatChildRecords)+x,-1==n.indexOf(f)?(0!=e(i.cellElement).find(".e-summarytitle").length?(m=e(i.cellElement).find(".e-summarytitle").clone(),e(i.cellElement).empty().html(g).prepend(m)):i.cellElement.empty().html(g),u[f]=g,n.push(f)):(e(i.cellElement).append(" "+g),u[f]=u[f]+" "+g)}c.push(u)}}),d._flatChildRecords=[])},_getpRecords:function(e){var t=[];do{e=e.parentItem,t.push(e)}while(e.parentItem);return t},_renderGridContent:function(){var i,a,r,n=this,o=document,l=n.model,d=e(o.createElement("tbody")),s=t.buildTag("div.e-gridcontent#"+n._id+"e-gridcontent","",{height:n._viewPortHeight}),c=t.buildTag("div.e-gridcontainer#"+n._id+"e-gridcontainer","",{},{}),u=t.buildTag("div",{},{width:"auto",height:"auto"});return u.append(c),(l.enableVirtualization||l.allowPaging)&&c.css({height:n._totalHeight}),this._frozenColumnsLength>0?(c.html(n._renderByFrozenDesign()),n.setGridContentTable(c.find(".e-table"))):((i=t.buildTag("table.e-table e-zerospace#"+n._id+"e-table","",{top:"0px",position:"relative"})).append(n.getHeaderTable().find("colgroup").clone()).append(d),c.html(i),n.setGridContentTable(i)),s.html(u),n._$gridContent=s,null===this.dataSource()||0==this.model.currentViewData.length?this._frozenColumnsLength>0?(a=n._getFrozenHiddenCol(),r=t.buildTag("td",l.emptyRecordText,{},{colSpan:this._frozenColumns.length-a.frozen}),c.find("#e-frozencontentdiv"+n._id+" .e-table tbody").append(e(o.createElement("tr")).addClass("e-emptyText").height(30).append(r)),r=t.buildTag("td",l.emptyRecordText,{visibility:"hidden"},{colSpan:this._unFrozenColumns.length-a.moveable}),c.find("#e-movablecontentdiv"+n._id+" .e-table tbody").append(e(o.createElement("tr")).addClass("e-emptyText").height(30).append(r))):(r=t.buildTag("td",l.emptyRecordText,{},{colSpan:n.model.columns.length-n._hiddenColumns.length}),d.append(e(o.createElement("tr")).addClass("e-emptyText").height(30).append(r)),c.css("height",l.rowHeight)):n.renderRecords(),l.isFromGantt?s.css({"border-left-style":"solid","border-left-width":"1px"}):s.css({"border-bottom-style":"solid","border-bottom-width":"1px","border-left-style":"solid","border-left-width":"1px","border-right-style":"solid","border-right-width":"1px",width:"auto",height:"auto",cursor:"default"}),s},_getFrozenHiddenCol:function(){var e,t=this.model.columns,i={};if(i.frozen=0,i.moveable=0,this._hiddenColumns.length)for(e=0;e<t.length;e++)!t[e].visible&&t[e].isFrozen?i.frozen=i.frozen+1:t[e].visible||t[e].isFrozen||(i.moveable=i.moveable+1);return i},_initialEndRendering:function(){var e,t=this,i=t.model,a=(t.getExpandedRecords(i.updatedRecords),t.selectedRowIndex()),r=t.selectedCellIndexes();i.allowSelection&&("row"!=i.selectionSettings.selectionMode||-1==a||i.isFromGantt||(i.showSummaryRow&&(e=t._spliceSummaryRows(i.updatedRecords)[a],a=i.updatedRecords.indexOf(e)),t._rowSelectingEventTrigger(this._previousIndex,a)||(t.selectRows(a),t._cancelSaveTools(),t._rowSelectedEventTrigger(a))),"cell"==i.selectionSettings.selectionMode&&r.length>0&&(t.selectedRowIndex(-1),t.selectCells(r),t._cancelSaveTools())),t._isRendered=!0,this._trigger("dataBound",{}),t._trigger("refresh"),t._eventBindings(),t._hideCollapsedDetailsRows(),t.getScrollElement().ejScroller("refresh"),t._updateScrollCss()},_addCellEditTemplate:function(){var i,a,r,n,o=this,l=o.model.columns,d=0,s=t.buildTag("div","",{display:"none"},{id:o._id+"_CellEditTemplate"});for(d=0;d<l.length;d++)l[d]&&(a=o._getFieldValue(l[d].field,d),o._isCommandColumn(l[d])?(i=t.buildTag("td.e-rowcell e-unboundcell","",{},{id:a+"_CellEdit"}),r=l[d],e("#"+this._id+d+"_UnboundTemplate").remove(),n=this._createCommandElement(r,d),i.addClass("e-unboundcell").html("{{:~_"+this._id+"UnboundTemplate('"+n.id+"')}}")):(i=t.buildTag("div","",{},{id:a+"_CellEdit"}),t.TreeGrid._initCellEditType(o,i,o._id,d)),s.append(i));s.children().length&&(o._cellEditTemplate=s)},_getState:function(){return!this.data.parentItem},_getCellIndex:function(e,t){for(var i=[],a=0;a<e.length;a++)i[a]=e[a][t];return i},_getSelectedCellClass:function(e,i){var a,r=this,n=r.model,o=parseInt(i),l=r._selectedCellDetails;return"cell"==n.selectionSettings.selectionMode&&l.length>0&&(r._getSelectedCellsinARow(e.index,l),r._selectedCellsinARow.length>0&&(-1!=(a="msie"==t.browserInfo().name&&t.browserInfo().version<9?r._getCellIndex(r._selectedCellsinARow,"cellIndex").indexOf(o):r._selectedCellsinARow.map(function(e){return e.cellIndex}).indexOf(o))&&r._selectedCellsinARow[a].cellIndex==o))?"e-selectingcell":""},_getBatchEditState:function(e,t){this.model;return(!this._checkboxSelection||"checkboxState"!=t)&&(!!(e.isBatchAdd||e.batchEditedFields&&null!=e.batchEditedFields[t])||void 0)},_getSelectedCellsinARow:function(e,t){var i=this;i._selectedCellsinARow=[],t.forEach(function(t){t.data.index==e&&i._selectedCellsinARow.push(t)}),i._currentRecordIndex=e},_getrowName:function(){return"gridrowIndex"+this.data.index.toString()+"level"+this.data.level.toString()},_getDetailsColSpan:function(e){var t=this.model;return this._frozenColumnsLength>0?e?this._frozenColumns.filter(function(e){return!1!==e.visible}).length:this._unFrozenColumns.filter(function(e){return!1!==e.visible}).length:t.showDetailsRowInfoColumn?this._visibleColumns.length+1:this._visibleColumns.length},_getDetailsExpandStatus:function(e){return!(!this.getExpandStatus(e)||!e.isDetailsExpanded)},_createDetailsRowTemplate:function(t){var i,a,r,n,o=this,l=this.model,d={};return d["_"+o._id+"getDetailsColSpan"]=e.proxy(o._getDetailsColSpan,o),d["_"+o._id+"getDetailsExpandStatus"]=e.proxy(o._getDetailsExpandStatus,o),d["_"+o._id+"getExpandStatus"]=e.proxy(o.getExpandStatus,o),e.views.helpers(d),i="{{if !isSummaryRow && !footerSummaryRowRecord}}<tr class='e-detailsrow e-treegridrows detailsrow{{:~_"+o._id+"rowClassName()}} {{if isDetailsExpanded}}e-detailsrowexpanded{{else}}e-detailsrowcollapsed{{/if}}{{if !~_"+o._id+"getExpandStatus(#data) && isDetailsExpanded}} e-collapsedrowexpandeddetailsrow{{/if}}' style='{{if ~_"+o._id+"getDetailsExpandStatus(#data)}}display:table-row;{{else}}visibility:none;{{/if}}height:"+l.detailsRowHeight+"px;'><td class='e-detailsrowcell' colspan='{{:~_"+o._id+"getDetailsColSpan("+t+")}}'><div class='e-detailscellwrapper' style='height:"+(l.detailsRowHeight-1)+"px;'>",a="",l.detailsTemplate&&l.detailsTemplate.length>0&&(a=document.getElementById(l.detailsTemplate)?"#"+l.detailsTemplate:l.detailsTemplate),t||(e("#treeGridDetailsRowTemplateElement"+o._id).remove(),r=this._createDetailRowTemplateElement(a),i+="{{:~_"+o._id+"treeGridTemplating('"+r.id+"')}}"),i+="</div></td></tr>",i+="{{/if}}",t||((n={})[o._id+"_detailRowTemplate"]=i,e.templates(n)),i},_SelectState:function(){return!!this.model.allowSelection},_unboundClickHandler:function(t){var i,a,r,n=this,o=this.model,l=e(t.target).closest("button");(l.hasClass("e-deletebutton")||l.hasClass("e-editbutton")||l.hasClass("e-savebutton")||l.hasClass("e-cancelbutton"))&&(l.hasClass("e-button")&&(l.hasClass("e-disable")||l.prop("disabled"))||e(t.target).hasClass("e-unboundcelldiv")||(i="dialogEditing"==n.model.editSettings.editMode?e("#"+n._id+"EditFormDialog"):e("#"+n._id+"EditForm"),a=l.hasClass("e-savebutton")||l.hasClass("e-cancelbutton")?n.getIndexByRow(i.closest("tr")):n.getIndexByRow(l.closest("tr")),n.selectRows(n.getUpdatedRecords().indexOf(o.currentViewData[a])),l.hasClass("e-editbutton")&&o.editSettings.allowEditing?(n._isRowEdit&&n.cancelEdit(),"dialogEditing"!=o.editSettings.editMode?(r=n.getCellIndex(t),n._editRow(n.getUpdatedRecords().indexOf(o.currentViewData[a]),null,r)):n.showEditDialog(n.getUpdatedRecords().indexOf(o.currentViewData[a]))):l.hasClass("e-deletebutton")?n.deleteRow(null,!0):l.hasClass("e-savebutton")?n.saveRow():l.hasClass("e-cancelbutton")&&n.cancelEdit()))},_createCommandElement:function(i,a){var r,n,o,l,d=document.createElement("div");for(d.id=this._id+a+"_UnboundTemplate",r=t.buildTag("div.e-unboundcelldiv"),n=i.commands,o=0;o<n.length;o++)t.isNullOrUndefined(n[o].type)||((l=t.buildTag("button.e-"+n[o].type.replace(/\s+/g,"")+"button","",{},{type:"button"})).val(n[o].type),r.append(l));return e("body").append(e(d).html(r).hide()),d},_refreshUnboundTemplate:function(i){var a,r,n,o,l,d=this,s=d.model;if(d._commandColumnLength>0)for(a=0;a<s.columns.length;a++){if(!d._isCommandColumn(s.columns[a]))continue;for(r=i.find(".e-unboundcell").find(".e-unboundcelldiv"),n=e.extend(!0,[],s.columns[a].commands),o=0;o<n.length;o++)t.isNullOrUndefined(n[o].buttonOptions)&&(n[o].buttonOptions={}),n[o].buttonOptions.width=t.isNullOrUndefined(n[o].buttonOptions.width)?"52":n[o].buttonOptions.width,n[o].buttonOptions.height=t.isNullOrUndefined(n[o].buttonOptions.height)?"22":n[o].buttonOptions.height,n[o].buttonOptions.showRoundedCorner=!!t.isNullOrUndefined(n[o].buttonOptions.showRoundedCorner)||n[o].buttonOptions.showRoundedCorner,n[o].buttonOptions.size=t.isNullOrUndefined(n[o].buttonOptions.size)?"small":n[o].buttonOptions.size,t.isNullOrUndefined(n[o].type)||(l=r.find(".e-"+n[o].type.replace(/\s+/g,"")+"button"),i.find(".e-unboundeditedcell").length>0?"save"==n[o].type||"cancel"==n[o].type?l.show():(l.hasClass("e-deletebutton")&&l.hide(),l.hasClass("e-editbutton")&&l.hide()):"save"==n[o].type||"cancel"==n[o].type?l.hide():(l.hasClass("e-deletebutton")&&l.show(),l.hasClass("e-editbutton")&&l.show()),l.ejButton(n[o].buttonOptions))}},_unboundTemplateRendering:function(t){return e("#"+t).html()},_collapsibleSummary:function(e,t){var i=this.model;i.columns;if(i.showTotalSummary&&i.collapsibleTotalSummary&&this._summaryColumnIndex==parseInt(e)&&t.isFirstFooterSummary)return!0},_summaryIndendCell:function(e){var t=this.model;t.columns;if(t.showTotalSummary&&t.collapsibleTotalSummary&&this._summaryColumnIndex==parseInt(e)){if(0!=this._summaryColumnIndex)return!0;if(0==this._summaryColumnIndex)return!1}},_getsummaryExpandStatus:function(e){return t.isNullOrUndefined(e.summaryExpanded)||e.summaryExpanded||(this._summaryExpanded=!1),this.model.collapsibleTotalSummary&&!this._summaryExpanded?e.isFirstFooterSummary?"table-row":"none":"table-row"},_addInitTemplate:function(){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x,v,b,S,D=this,R=D.model,y=R.columns,I=0,k=y.length,M=!1,E={};if(D._commandColumnLength=0,0===y.length)return!1;if(this._frozenColumnsLength>0&&(this.addFrozenTemplate(),R.showTotalSummary&&this.addFrozenSummaryTemplate()),E["_"+D._id+"rowClassName"]=t.TreeGrid._getrowClassName,E["_"+D._id+"SummaryRowtdClassName"]=t.TreeGrid._getSummaryRowtdClassName,E["_"+D._id+"summaryIndendCell"]=e.proxy(D._summaryIndendCell,D),E["_"+D._id+"collapsibleSummary"]=e.proxy(D._collapsibleSummary,D),E["_"+D._id+"isSelectedCell"]=e.proxy(D._getSelectedCellClass,D),E["_"+D._id+"batchEditState"]=e.proxy(D._getBatchEditState,D),E["_"+D._id+"summaryTitle"]=D._getSummaryTitle,E["_"+D._id+"rowName"]=D._getrowName,E["_"+D._id+"getState"]=D._getState,E["_"+D._id+"SelectState"]=e.proxy(D._SelectState,D),E["_"+D._id+"summaryExpandStatus"]=e.proxy(D._getsummaryExpandStatus,D),E["_"+D._id+"expandStatus"]=e.proxy(D._getExpandStatusRecord,D),E["_"+D._id+"cellValue"]=e.proxy(D._getCellValue,D),E["_"+D._id+"TemplateCellValue"]=e.proxy(D._getTemplateCellValue,D),E["_"+D._id+"isTreeColumnIndex"]=e.proxy(D._isTreeColumnIndex,D),E["_"+D._id+"getIndentWidth"]=e.proxy(D._getIndentWidth,D),E["_"+D._id+"checkColumn"]=e.proxy(D._getCellColumn,D),E["_"+D._id+"formatting"]=e.proxy(D.formatting,D),E["_"+D._id+"treeGridTemplating"]=t.proxy(D._gridTemplate,null,D),E["_"+D._id+"getCheckboxState"]=e.proxy(D._getCheckboxState,D),E["_"+D._id+"UnboundTemplate"]=e.proxy(D._unboundTemplateRendering,D),E["_"+D._id+"isTrimCell"]=e.proxy(D._checkIsTrimCell,D),E["_"+D._id+"getRowHeight"]=e.proxy(D._getTemplateRowHeight,D),e.views.helpers(E),R.allowTextWrap&&(M=D.model.allowTextWrap),R.parseRowTemplate&&(R.rowTemplateID.length>0||R.altRowTemplateID.length>0)){var H=t.buildTag("tbody","",{},{}),P=t.buildTag("tbody","",{},{}),F="",O="",G=R.altRowTemplateID.length>0?e("#"+R.altRowTemplateID):e("#"+R.rowTemplateID),L=R.rowTemplateID.length>0?e("#"+R.rowTemplateID):e("#"+R.altRowTemplateID),N=G[0].innerHTML,W=L[0].innerHTML;if(e(H[0]).html(N),e(P[0]).html(W),P[0].childNodes.length>0)for(l=0;l<P[0].childNodes.length;l++)if("TR"==P[0].childNodes[l].nodeName&&(P[0].className=P[0].childNodes[l].className,P[0].style.cssText=P[0].childNodes[l].style.cssText,P[0].childNodes[l].childNodes.length>0))for(d=0,s=0;s<P[0].childNodes[l].childNodes.length;s++)"TD"==(c=P[0].childNodes[l].childNodes[s]).nodeName&&(u=c.innerHTML,p=D._id+"RowTemplateElement"+d,e("#"+p).remove(),x=this._createRowTemplateElement(u,p,L[0].type),c.innerHTML="{{:~_"+D._id+"treeGridTemplating('"+x.id+"')}}",c.className+=" e-rowcell e-templatecell",y[d]&&(a=(r=y[d]).field,w=r.visible==i||r.visible,h="",r.headerText==D._visibleColumns[0]&&(h="{{if isSummaryRow || footerSummaryRowRecord}}<div class='e-summarytitle{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='float:left;display:block;'>{{:~_"+D._id+"summaryTitle()}}</div>{{/if}}"),d==R.treeColumnIndex?(g="<div class='e-inner-treecolumn-container' style='min-height:20px;' data-unselectable='on'>{{if hasChildRecords && hasFilteredChildRecords}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:((filterLevel)*"+D.treeIndentLevelWidth+")}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:((level)*"+D.treeIndentLevelWidth+")}}px; display:inline-block;'>{{/if}}{{if !~_"+D._id+"getState() || !hasChildRecords }}<div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-childIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-cancelIcon e-icon' style='position:relative;float:right;display:none;'></span></div>{{/if}}</div>{{else !hasChildRecords || (!hasFilteredChildRecords && hasChildRecords)}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:(filterLevel*"+D.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:(level*"+D.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{/if}}{{if !~_"+D._id+"getState() || !hasChildRecords || !hasFilteredChildRecords }}<div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon iconMargin e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-childIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-cancelIcon iconMargin e-icon' style='float:right;display:none;'></span></div>{{/if}}</div>{{/if}}{{if ~_"+D._id+"getState() && hasChildRecords && hasFilteredChildRecords}}<div class='e-intendparent'><div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:left;display:none;'></span><span class='e-belowIcon e-icon' style='float:left;display:none;'></span><span class='e-childIcon e-icon' style='float:left;display:none;'></span><span class='e-cancelIcon e-icon' style='float:left;display:none;'></span></div></div>{{/if}}<div class='{{if expanded && hasFilteredChildRecords}}e-treegridexpand e-icon{{else hasChildRecords && hasFilteredChildRecords}}e-treegridcollapse e-icon{{/if}}' style='float:left;display:inline-block;font-size:10px;'></div><div class='e-cell{{if "+(r.showCheckbox&&this.model.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox)+"}} e-treecheckboxcolumn{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}' style='overflow: hidden;'>",c.style.cssText="padding-left:0px;",F+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+D._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"'>"+g+"{{else}}'>{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+d+"',#data)}}<div class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+h+"{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",F+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}",F+="{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}</div>{{/if}}</div></div></td>"):(F+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+D._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"{{/if}}'>{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+d+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+h+"{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",F+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}",F+="{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}</div>{{/if}}</td>"),this._frozenColumnsLength>0&&this._frozenColumnsLength==d+1&&(o="",o+=F,o+="</tr>",F=""),d++));if(H[0].childNodes.length>0)for(l=0;l<H[0].childNodes.length;l++)if("TR"==H[0].childNodes[l].nodeName)for(H[0].className=H[0].childNodes[l].className,H[0].style.cssText=H[0].childNodes[l].style.cssText,d=0,s=0;s<H[0].childNodes[l].childNodes.length;s++)"TD"==(c=H[0].childNodes[l].childNodes[s]).nodeName&&(u=c.innerHTML,p=D._id+"AltRowTemplateElement"+d,e("#"+p).remove(),x=this._createRowTemplateElement(u,p,G[0].type),c.innerHTML="{{:~_"+D._id+"treeGridTemplating('"+x.id+"')}}",c.className+=" e-rowcell e-templatecell",y[d]&&(a=(r=y[d]).field,w=r.visible==i||r.visible,h="",r.headerText==D._visibleColumns[0]&&(h="{{if isSummaryRow || footerSummaryRowRecord}}<div class='e-summarytitle{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='float:left;display:block;'>{{:~_"+D._id+"summaryTitle()}}</div>{{/if}}"),d==R.treeColumnIndex?(g="<div class='e-inner-treecolumn-container' style='min-height:20px;'>{{if hasChildRecords && hasFilteredChildRecords}}{{if filterLevel > -1}}<div class='e-dragintend' style='height:1px; float:left;width:{{:((filterLevel)*"+D.treeIndentLevelWidth+")}}px; display:inline-block;'>{{else}}<div class='e-dragintend' style='height:1px; float:left;width:{{:((level)*"+D.treeIndentLevelWidth+")}}px; display:inline-block;'>{{/if}}{{if !~_"+D._id+"getState() || !hasChildRecords }}<div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-childIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-cancelIcon e-icon' style='position:relative;float:right;display:none;'></span></div>{{/if}}</div>{{else !hasChildRecords || (!hasFilteredChildRecords && hasChildRecords)}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:(filterLevel*"+D.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:(level*"+D.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{/if}}{{if !~_"+D._id+"getState() || !hasChildRecords || !hasFilteredChildRecords}}<div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon iconMargin e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-childIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-cancelIcon iconMargin e-icon' style='float:right;display:none;'></span></div>{{/if}}</div>{{/if}}{{if ~_"+D._id+"getState() && hasChildRecords && hasFilteredChildRecords}}<div class='e-intendparent'><div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:left;display:none;'></span><span class='e-belowIcon e-icon' style='float:left;display:none;'></span><span class='e-childIcon e-icon' style='float:left;display:none;'></span><span class='e-cancelIcon e-icon' style='float:left;display:none;'></span></div></div>{{/if}}<div class='{{if expanded&& hasFilteredChildRecords}}e-treegridexpand e-icon{{else hasChildRecords && hasFilteredChildRecords}}e-treegridcollapse e-icon{{/if}}' style='float:left;display:inline-block;font-size:10px;'></div><div class='e-cell{{if "+r.showCheckbox+"}} e-treecheckboxcolumn{{/if}}{{if  ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}' style='overflow:hidden'>",c.style.cssText="padding-left:0px;",O+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+D._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"'>"+g+"{{else}}'>{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+d+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+h+"{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",O+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}",O+="{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}</div>{{/if}}</div></div></td>"):(O+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+D._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"{{/if}}'>{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+d+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+h+"{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",O+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}",O+="{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+d+")}}</div>{{/if}}</td>"),this._frozenColumnsLength>0&&this._frozenColumnsLength==d+1&&(m="",m+=O,m+="</tr>",O=""),d++));R.showDetailsRow&&R.detailsTemplate&&R.showDetailsRowInfoColumn&&(O+="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-selectionbackground{{/if}} {{if isDetailsExpanded}}e-detailsrowexpand{{else}}e-detailsrowcollapse{{/if}}  e-detailsrowcell{{if isLastSummary}} e-lastsummaryrow{{/if}}'>{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-detailsiconcell e-icon {{if isDetailsExpanded}}e-detailsinfoiconhide{{else}}e-detailsinfoiconshow{{/if}}'></div>{{/if}}",F+="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-selectionbackground{{/if}} {{if isDetailsExpanded}}e-detailsrowexpand{{else}}e-detailsrowcollapse{{/if}}  e-detailsrowcell{{if isLastSummary}} e-lastsummaryrow{{/if}}'>{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-detailsiconcell e-icon {{if isDetailsExpanded}}e-detailsinfoiconhide{{else}}e-detailsinfoiconshow{{/if}}'></div>{{/if}}"),_="{{if isAltRow}}<tr class='{{:~_"+D._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+H[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+H[0].style.cssText+"{{else}}height:"+R.rowHeight+"px;{{/if}}display:{{if footerSummaryRowRecord}}{{:~_"+D._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+D._id+"expandStatus(#data)}}{{/if}}''>"+O+"</tr>{{else}}<tr class='{{:~_"+D._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+P[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+P[0].style.cssText+"{{else}}height:"+R.rowHeight+"px;{{/if}}display:{{if footerSummaryRowRecord}}{{:~_"+D._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+D._id+"expandStatus(#data)}}{{/if}}''>"+F+"</tr>{{/if}}",b="{{if isAltRow}}<tr class='{{:~_"+D._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+H[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+H[0].style.cssText+"{{else}}height:"+R.rowHeight+"px;{{/if}} display:{{if footerSummaryRowRecord}}{{:~_"+D._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+D._id+"expandStatus(#data)}}{{/if}}''>"+o+"</tr>{{else}}<tr class='{{:~_"+D._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+P[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+P[0].style.cssText+"{{else}}height:"+R.rowHeight+"px;{{/if}} display:{{if footerSummaryRowRecord}}{{:~_"+D._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+D._id+"expandStatus(#data)}}{{/if}}''>"+m+"</tr>{{/if}}"}else if(!R.parseRowTemplate&&(R.rowTemplateID.length>0||R.altRowTemplateID.length>0))R.rowTemplateID&&R.altRowTemplateID?_="{{if isAltRow}}"+e.trim(e("#"+R.rowTemplateID).html())+"{{else}}"+e.trim(e("#"+R.altRowTemplateID).html())+"{{/if}}":R.rowTemplateID.length>0?_=e.trim(e("#"+R.rowTemplateID).html()):R.altRowTemplateID.length>0&&(_=e.trim(e("#"+R.altRowTemplateID).html()));else{for(_="<tr class='e-treegridrows {{:~_"+D._id+"rowClassName()}} ",R.enableAltRow&&(_+="{{if isAltRow}}e-alt-row{{/if}} "),f="",I=0;I<k;I++)y[I]&&(a=y[I].field,r=y[I],w=y[I].visible==i||y[I].visible,C=y[I].textAlign,h="",r.headerText==D._visibleColumns[0]&&(h="{{if isSummaryRow || footerSummaryRowRecord}}<div class='e-summarytitle{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='float:left;display:block;'>{{:~_"+D._id+"summaryTitle()}}</div>{{/if}}"),r.isTemplateColumn&&(r.angularTemplate||r.templateID||r.template)?(_+="e-templaterow ",T=r.headerText,t.isNullOrUndefined(T)||t.isNullOrUndefined(T.match(/(\\|[^0-9A-z-_])/g))||(T=T.replace(/(\\|[^0-9A-z-_])/g,"")),e("#"+D._id+T+e.inArray(r,this.model.columns)+"_Template").remove(),x=this._createTemplateElement(r),n="<td class='{{if !isSummaryRow && !footerSummaryRowRecord}} e-intend{{/if}} e-rowcell e-templatecell{{if isSelected && ~_"+D._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}} e-hide{{/if}}{{:~_"+D._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}} e-summaryintend{{/if}}{{if ~_"+D._id+"batchEditState(#data,'"+a+"')}}e-updatedtd e-tgupdatenotify{{/if}}'style='text-Align:"+C+";'role='row'>{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+I+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+D._id+"treeGridTemplating('"+x.id+"','"+I+"')}}{{else}}"+h+"{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",n+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}",n+="{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}</div>{{/if}}</td>"):I===R.treeColumnIndex?(n="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if !isSummaryRow && !footerSummaryRowRecord}} e-intend{{/if}} {{/if}} {{:~_"+D._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}} e-summaryintend{{/if}}{{if ~_"+D._id+"batchEditState(#data,'"+a+"')}}e-updatedtd e-tgupdatenotify{{/if}} {{if hasChildRecords && hasFilteredChildRecords}} e-parentcell{{/if}}'style='padding-left:{{if ~_"+D._id+"isTreeColumnIndex('"+a+"') && isSummaryRow }}{{:((level)*"+D.treeIndentLevelWidth+")}}px{{/if}};background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+I+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-inner-treecolumn-container' style='min-height:20px;'>{{if hasChildRecords && hasFilteredChildRecords}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:((filterLevel)*"+D.treeIndentLevelWidth+")}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:((level)*"+D.treeIndentLevelWidth+")}}px; display:inline-block;'>{{/if}}{{if !~_"+D._id+"getState() || !hasChildRecords}}<div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}}  e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}}  e-icon' style='position:relative;float:right;display:none;'></span><span class='e-childIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}}  e-icon' style='position:relative;float:right;display:none;'></span><span class='e-cancelIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}} e-icon' style='position:relative;float:right;display:none;'></span></div>{{/if}}</div>{{else !hasChildRecords || (!hasFilteredChildRecords && hasChildRecords)}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:(filterLevel*"+D.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:(level*"+D.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{/if}}{{if !~_"+D._id+"getState() || !hasChildRecords || !hasFilteredChildRecords}}<div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon e-iconMargin e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon e-iconMargin e-icon' style='float:right;display:none;'></span><span class='e-childIcon e-iconMargin e-icon' style='float:right;display:none;'></span><span class='e-cancelIcon e-iconMargin e-icon' style='float:right;display:none;'></span></div>{{/if}}</div>{{/if}}{{if ~_"+D._id+"getState() && hasChildRecords && hasFilteredChildRecords}}<div class='e-intendparent'><div class={{:~_"+D._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:left;display:none;'></span><span class='e-belowIcon e-icon' style='float:left;display:none;'></span><span class='e-childIcon e-icon' style='float:left;display:none;'></span><span class='e-cancelIcon e-icon' style='float:left;display:none;'></span></div></div>{{/if}}<div class='{{if expanded && hasFilteredChildRecords}}e-treegridexpand e-icon{{else hasChildRecords && hasFilteredChildRecords}}e-treegridcollapse e-icon{{/if}}'style='float:left;display:inline-block; font-size:10px;'></div><div class='e-cell{{if "+(r.showCheckbox&&this.model.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox)+"}} e-treecheckboxcolumn{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='overflow: hidden;padding-left:{{if ~_"+D._id+"isTreeColumnIndex('"+a+"') && isSummaryRow}}{{:(level*"+D.treeIndentLevelWidth+")+24}}px{{/if}};'>{{/if}}{{:~_"+D._id+"getCheckboxState(#data, '"+a+"', '"+D._checkboxColumnName+"')}}",t.isNullOrUndefined(r.format)?R.isFromGantt&&r.mappingName===R.resourceInfoMapping?((E={})["_"+D._id+"resourceName"]=D._getResourceName,e.views.helpers(E),n+="{{:~_"+D._id+"resourceName('"+D._id+"Object','"+R.resourceNameMapping+"','"+R.resourceUnitMapping+"','"+a+"')}}</div></div></td>"):R.isFromGantt&&r.mappingName===R.predecessorMapping?((E={})["_"+D._id+"predecessor"]=e.proxy(D._getPredecessorsValue,D),e.views.helpers(E),n+="{{:~_"+D._id+"predecessor(#data)}}</div></div></td>"):(n+=h+"{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}</div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}</div></div></td>{{/if}}",h=""):n+="{{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+D._id+"formatting('"+r.format+"',~_"+D._id+"TemplateCellValue(#data,'"+a+"'),'"+this.model.locale+"')}}{{else}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}"):R.isFromGantt&&r.mappingName===R.resourceInfoMapping?((E={})["_"+D._id+"resourceName"]=D._getResourceName,e.views.helpers(E),n="<td  class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}}e-hide{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{:~_"+D._id+"resourceName('"+D._id+"Object','"+R.resourceNameMapping+"','"+R.resourceUnitMapping+"','"+a+"')}}</td>"):R.isFromGantt&&r.mappingName===R.predecessorMapping?((E={})["_"+D._id+"predecessor"]=e.proxy(D._getPredecessorsValue,D),e.views.helpers(E),n="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}}e-hide{{/if}}' style='background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{:~_"+D._id+"predecessor(#data)}}</td>"):R.isFromGantt&&r.mappingName===R.durationMapping?((E={})["_"+D._id+"getDurationString"]=e.proxy(D._getDurationString,D),e.views.helpers(E),n="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}}e-hide{{/if}}' style='background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{:~_"+D._id+"getDurationString(#data)}}</td>"):"booleanedit"==r.editType&&D._checkboxSelection&&"checkboxState"==a?n="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell{{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}}e-hide{{/if}}{{:~_"+D._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}} e-summaryintend {{/if}}{{if ~_"+D._id+"batchEditState(#data,'"+a+"')}}e-updatedtd e-tgupdatenotify{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};text-Align: center;'role='row'> {{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+I+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}"+h+"{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"', '"+D._checkboxColumnName+"')}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}</div>{{/if}}":D._isCommandColumn(r)?(e("#"+this._id+I+"_UnboundTemplate").remove(),v=D._createCommandElement(r,I),n="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-unboundcell e-selectionbackground {{else}}e-rowcell e-unboundcell {{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}}e-hide{{/if}}{{:~_"+D._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}} e-summaryintend{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};text-Align:"+C+"'role='row'> {{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+D._id+"UnboundTemplate('"+v.id+"')}}{{else}}{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+I+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}"+h+"{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"', '"+D._checkboxColumnName+"')}}{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}</div>{{/if}}",D._commandColumnLength=D._commandColumnLength+1,n+="</td>"):(n="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+D._id+"isSelectedCell(#data,'"+I+"')}} {{if "+!w+"}}e-hide{{/if}} {{:~_"+D._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+D._id+"isTrimCell('"+r.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}} e-summaryintend{{/if}}{{if ~_"+D._id+"batchEditState(#data,'"+a+"')}}e-updatedtd e-tgupdatenotify{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+D._id+"checkColumn('"+a+"',#data)=='"+a+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};text-Align:"+C+"'role='row'>{{:~_"+D._id+"getCheckboxState(#data, '"+a+"', '"+D._checkboxColumnName+"')}}{{if footerSummaryRowRecord && ~_"+D._id+"collapsibleSummary('"+I+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}"+h+"{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",n+=t.isNullOrUndefined(r.format)?"{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}":"{{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+D._id+"formatting('"+r.format+"',~_"+D._id+"TemplateCellValue(#data,'"+a+"'),'"+this.model.locale+"')}}{{else}}{{:~_"+D._id+"TemplateCellValue(#data,'"+a+"')}}{{/if}}",n+="{{if footerSummaryRowRecord && ~_"+D._id+"summaryIndendCell("+I+")}}</div>{{/if}}</td>",h=""),f+=n),this._frozenColumnsLength>0&&this._frozenColumnsLength==I+1&&(b="",b+=f,b+="</tr>",f="");R.showDetailsRow&&R.detailsTemplate&&R.showDetailsRowInfoColumn&&(f+="<td class='{{if isSelected && ~_"+D._id+"SelectState()}}e-selectionbackground{{/if}} {{if isDetailsExpanded}}e-detailsrowexpand{{else}}e-detailsrowcollapse{{/if}}  e-detailsrowcell{{if isLastSummary}} e-lastsummaryrow{{/if}}'>{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-detailsiconcell e-icon {{if isDetailsExpanded}}e-detailsinfoiconhide{{else}}e-detailsinfoiconshow{{/if}}'></div>{{/if}}"),b=(_+="{{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}}{{if isBatchDelete}}e-batchdisable {{/if}}'style='background-color:{{if rowBackgroundColor }}{{:rowBackgroundColor}}{{else}}none{{/if}}; height:{{:~_"+D._id+"getRowHeight(#data)}}px;display:{{if footerSummaryRowRecord}}{{:~_"+D._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+D._id+"expandStatus(#data)}}{{/if}}'role='treegrid'>")+b,_+=f,_+=R.isFromGantt?"<td class='e-extendcolumn'></td></tr>":"</tr>"}R.showDetailsRow&&R.detailsTemplate&&(_+="{{if isDetailsExpanded}}"+D._createDetailsRowTemplate()+"{{/if}}",b+="{{if isDetailsExpanded}}"+D._createDetailsRowTemplate(!0)+"{{/if}}"),D._summaryExpanded=!0,(S={})[D._id+"_Template"]=_,S[D._id+"_JSONFrozenTemplate"]=b,e.templates(S)},_gridTemplate:function(e,i,a){var r;return t.isNullOrUndefined(a)||(r=e.model.columns[a]),e._renderEjTemplate("#"+i,this.data,this.data.index,r)},_getIndentWidth:function(e){return e.level*this.treeIndentLevelWidth+"px"},_createDetailRowTemplateElement:function(i){var a,r=/^#([\w-]*)/.exec(i),n={name:"SCRIPT",type:"text/x-template",text:i,id:"treeGridDetailsRowTemplateElement"+this._id};return(a=r&&r[1]?document.getElementById(r[1]):/^<script/i.test(i)?e(i).get(0):t.buildTag(n.name,n.text).get(0)).id=a.id||n.id,a.type=a.type||n.type,e("body").append(a),a},_createRowTemplateElement:function(t,i,a){var r=document.createElement("script");return r.id=i,r.type=a||"text/x-template",r.text=t,e("body").append(r),r},_createTemplateElement:function(i,a){var r,n,o,l=a?"Pager":i.headerText+e.inArray(i,this.model.columns)+"_Template",d="template"in i?"template":"templateID"in i?"templateID":"angularTemplate",s=i[d];return"templateID"==d&&-1==s.indexOf("#")&&(s="#"+s),n=/^#([\w-]*)/.exec(s),o={name:"SCRIPT",type:"text/x-template",text:s,id:(this._id+l).replace(/(\\|[^0-9A-z-_])/g,"")},(r=n&&n[1]?document.getElementById(n[1]):/^<script/i.test(s)?e(s).get(0):t.buildTag(o.name,o.text).get(0)).id=r.id||o.id,r.type=r.type||o.type,e("#"+r.id).remove(),e("body").append(r),r},_getCheckboxState:function(e,t,i){if(t==i)return 1==e.isSummaryRow||e.summaryColumn||e.summaryRow?void 0:"indeterminate"==e.checkboxState?'<span class="e-chkbox-wrap e-widget" style="padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-indeter"><span class="e-checkbox e-chk-image e-icon e-stop" id ='+this._id+"_checkbox"+e.ejRowId+"></span></span></div></span>":"unchecked"==e.checkboxState?'<span class="e-chkbox-wrap e-widget" style="padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-inact"><span class="e-checkbox e-chk-image e-icon" id ='+this._id+"_checkbox"+e.ejRowId+"></span></span></div></span>":'<span class="e-chkbox-wrap e-widget" style="padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-act"><span class=" e-checkbox e-chk-image e-icon e-checkmark" id ='+this._id+"_checkbox"+e.ejRowId+"></span></span></div></span>"},_checkIsTrimCell:function(e){return!(!e||"ellipsis"!=e)},_getTemplateRowHeight:function(e){return this.model.isFromGantt&&"resourceView"==this.model.viewType?e.eOverlapIndex*this.model.rowHeight:this.model.rowHeight},_getCustomCellValue:function(e,i){var a,r,n;if(!t.isNullOrUndefined(e)){if((a=(i||"").split(".")).length<=1)r=e[i];else{if(r=e[a[0]],t.isNullOrUndefined(r))return null;for(n=1;n<a.length;n++)if(r=r[a[n]],t.isNullOrUndefined(r))return null}return r}},_restoreCustomData:function(e,i,a){var r,n,o=0,l=0;if(t.isNullOrUndefined(a)&&(a=this._cellEditingDetails.fieldName),n={},(r=(a||"").split(".")).length<=1)t.isNullOrUndefined(e)?(e={})[a]=i:e[a]=i;else{for(t.isNullOrUndefined(e)?(n=e={},l=0):(n=e[r[0]],t.isNullOrUndefined(n)&&(n={},e[r[0]]=n),l=1),o=l;o<r.length-1;o++)t.isNullOrUndefined(n[r[o]])&&(n[r[o]]={}),n=n[r[o]];n[r[o]]=i}return e},_getTemplateCellValue:function(a,r,n){var o,l,d,s,c,u,p,h,g,m=this,_=m.getColumnByField(r),f=_.editType,w=m._getCustomCellValue(a,r);if(w=t.isNullOrUndefined(w)?a.item&&a.item[r]:w,f==t.TreeGrid.EditingType.Boolean&&r==n?w=m._getCheckboxState(a,r,n):a.isSummaryRow||a.footerSummaryRowRecord||f!=t.TreeGrid.EditingType.Boolean||r==n||!(t.isNullOrUndefined(_.displayAsCheckbox)||_.displayAsCheckbox)||(w="true"==w||1==w?"<input class='e-treegrid-chekboxcell' type='checkbox' disabled='disabled' checked/>":"<input class='e-treegrid-chekboxcell' type='checkbox' disabled='disabled'/>"),m.model.isFromGantt&&("work"==r&&(w+=" "+m.model.workUnit),"taskMode"==r&&(w=!a.isAutoSchedule),"unit"==r&&(w+="%"),"duration"==r&&(w=m._getDurationString(a)),("startDate"==r||"endDate"==r||"duration"==r)&&(t.isNullOrUndefined(w)||""==w)&&(w=_.showNullText?m.model.nullText:"")),f==t.TreeGrid.EditingType.Dropdown&&!a.isSummaryRow&&!a.footerSummaryRowRecord)if(d=_.editParams,w=null!=w||w!=i?w:"",d&&d.fields?(l=d.fields.text?d.fields.text:"text",o=d.fields.value?d.fields.value:"value"):(o="value",l="text"),d&&(d.showCheckbox||d.multiSelectMode)){if(g=_.dropdownData,p=d&&!t.isNullOrUndefined(d.delimiterChar)?d.delimiterChar:",","string"==typeof w&&w.indexOf(p)>-1?c=(s=w.split(p)).length:s=w,w="",_.dropdownData)if(c)for(h=0;h<c;h++)(u=e.map(g,function(e){if(t.isNullOrUndefined(e[o])){if(e[l]==s[h])return e[l]}else if(e[o].toString()==s[h].toString())return e[l]}))[0]=u[0]?u[0]:"",w+=0==h?u[0]:p+u[0];else e.map(g,function(e){(t.isNullOrUndefined(e[o])||s.toString()!==e[o].toString())&&s!==e[l]||(w=e[l])})}else _.dropdownData&&(g=_.dropdownData,(u=e.map(g,function(e){if(t.isNullOrUndefined(e[o])){if(e[l].toString()==w)return e[l]}else if(e[o].toString()==w.toString())return e[l]}))[0]=t.isNullOrUndefined(u[0])?"":u[0],w=u[0]);return w},_getCellValue:function(e,t){var i=this._getCustomCellValue(e,t);return i||0===i?i:e.item&&e.item[t]},_isCommandColumn:function(e){this.model;var i=e.commands;return!(!t.isNullOrUndefined(i)&&0==i.length||t.isNullOrUndefined(i))},_isTreeColumnIndex:function(e){var t=this.model,i=t.columns[t.treeColumnIndex];return!(!i||i.field!=e)},_getSummaryTitle:function(){var e=this,t=e.data.summaryRow.title;return t||e.data.item&&e.data.item.summaryRow.title},_getCellColumn:function(e,t){return-1!==t.treeMappingName.indexOf(e)?e:"none"},_getResourceName:function(e,t,i,a){var r,n,o=this.data[a],l=0,d=o&&o.length,s=[];if(o&&o.length>0)for(;l<d;l++)r=o[l][t],100!=(n=o[l][i])&&(r+="["+n+"%]"),s.push(r);return s},_removeSeparator:function(e){var i=e.toString(),a=t.preferredCulture(this.model.locale).numberFormat;return i.replace(".",a["."])},_getDurationString:function(e){var i,a,r="";return t.isNullOrUndefined(e.duration)||""===e.duration?r=this.getColumnByField("duration").showNullText?this.model.nullText:r:("string"==typeof e.duration?(i=parseFloat(e.duration),r+=isNaN(i)?"":this._removeSeparator(parseFloat(i.toFixed(2)))+" "):r=this._removeSeparator(parseFloat(e.duration.toFixed(2)))+" ",null!=e.durationUnit&&(a=1!=e.duration,r+="day"==e.durationUnit?a?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:"hour"==e.durationUnit?a?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:a?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute)),r},_getPredecessorsValue:function(e){var t,i,a,r,n,o=e.predecessor,l="";if(o)for(t=o.length,i=0;i<t;i++)r="",(a=o[i]).from!=e.taskId&&(r=a.from+a.predecessorsType,0!=a.offset&&(r+=a.offset>0?"+"+a.offset+" ":a.offset+" ",n=1!=Math.abs(a.offset),r+="day"==a.offsetDurationUnit?n?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:"hour"==a.offsetDurationUnit?n?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:n?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute),l=l.length>0?l+","+r:r);return l},_getExpandStatusRecord:function(e){return this.getExpandStatus(e)||this._isHierarchyFiltering&&e.isDisplay?"table-row":"none"},_createRecords:function(e){var i,a=this,r=a.model,n=a.model.ids,o=r.flatRecords,l=e.length,d=0,s=!0,c=r.parentRecords;for(!r.isFromGantt&&r.enableCollapseAll&&(s=!1);d<l;d++)(i=a._createRecord(e[d],0,null,s)).hierarchyRowIndex=d,a._storedIndex++,i.isAltRow=a._storedIndex%2!=0,c.push(i),i.index=a._storedIndex,n[a._storedIndex]=i.index,o.push(i),i.hasChildRecords&&a._parentRecords.push(i),i.childRecords&&a._addNestedRecords(i.childRecords),this.dataSource()instanceof t.DataManager&&a._isLoadonDemand&&(i.item[r.hasChildMapping]||-1!=a._assignedParendIDs.indexOf(i.item[r.idMapping]))&&(i.hasChildRecords=!0,i.childRecords=[],i.isChildRetrieved=!1);r.allowPaging&&!a._isRemoteData&&a._updateTotalRecordsCount(),a._maxRowIndex=this.model.flatRecords.length},_updateTotalRecordsCount:function(){var e,i=this.model,a=i.flatRecords;!t.isNullOrUndefined(i.pageSettings.totalRecordsCount)&&i.pageSettings.totalRecordsCount<=a.length?(e=i.pageSettings.totalRecordsCount,i.flatRecords=a.slice(0,e),i.flatRecords[e-1].hasChildRecords&&(i.flatRecords[e-1].hasChildRecords=!1,i.flatRecords[e-1].expanded=!1,i.flatRecords[e-1].childRecords=null,i.flatRecords[e-1].hasFilteredChildRecords=!1)):t.isNullOrUndefined(i.pageSettings.totalRecordsCount)&&(i.pageSettings.totalRecordsCount=a.length)},_createRecord:function(a,r,n,o){var l,d,s,c,u=this,p=a[u.model.childMapping],h=this.model;return l=e.extend({},a),h.parentIdMapping&&"load"===u._createdAt?(d=a[h.idMapping],s=u._taskIds.indexOf(d),l.item=s>-1?u._retrivedData[s]:[]):this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.json&&this.dataSource().dataSource.offline&&"load"===u._createdAt&&h.parentIdMapping?(d=a[h.idMapping],s=u._taskIds.indexOf(d),l.item=s>-1?u._retrivedData[s]:[]):l.item=a,l.parentItem=n,l.childRecords=p&&p.length>0&&u._createChildRecords(p,r+1,l),l.hasChildRecords=!!(p&&p.length>0),h.expandStateMapping&&l.hasChildRecords?(t.isNullOrUndefined(a[h.expandStateMapping])?t.isNullOrUndefined(a[h.expandStateMapping])&&!h.enableCollapseAll?l[h.expandStateMapping]=l.item[h.expandStateMapping]=a[h.expandStateMapping]=!0:t.isNullOrUndefined(a[h.expandStateMapping])&&h.enableCollapseAll&&(l[h.expandStateMapping]=l.item[h.expandStateMapping]=a[h.expandStateMapping]=!1):l[h.expandStateMapping]=l.item[h.expandStateMapping]=a[h.expandStateMapping],c=a[h.expandStateMapping]):c=!0,l.expanded=o!==i&&p!==i&&1==l.hasChildRecords&&c?o:!(!c||!p)&&p.length>0,l.dragState=!0,l.isSelected=!1,l.hasFilteredChildRecords=!0,l.level=r,l.canDrag=!0,l.canDrop=!0,l.cellBackgroundColor=null,l.rowBackgroundColor=null,l.textWrapRowHeight=h.rowHeight,l.treeMappingName=[],l.isDetailsExpanded=!(!h.showDetailsRow||!h.detailsTemplate)&&!h.showDetailsRowInfoColumn,h.isFromGantt||(l.ejRowId=++u._idGenerator),l.checkboxState="unchecked",delete l[h.childMapping],l},_createChildRecords:function(e,t,i){var a,r,n=this.model,o=[],l=0,d=e.length,s=null;for(!n.isFromGantt&&n.enableCollapseAll&&(a=!1),l=0;l<d;l++)(s=e[l])&&((r=this._createRecord(s,t,i,a)).hierarchyRowIndex=l,o.push(r));return o},_addNestedRecords:function(e){var t,i=this,a=i.model,r=i.model.ids,n=a.flatRecords,o=a.updatedRecords,l=0,d=e.length,s=[];for(l=0;l<d;l++)if(t=e[l],i._storedIndex++,t.isAltRow=i._storedIndex%2!=0,t.index=i._storedIndex,r[i._storedIndex]=t.index,n.push(t),o.push(t),t.hasChildRecords&&i._parentRecords.push(t),s=t.childRecords){var c=0,u=s.length,p=null;for(c=0;c<u;c++)p=s[c],i._storedIndex++,p.index=i._storedIndex,r[i._storedIndex]=p.index,p.isAltRow=i._storedIndex%2!=0,n.push(p),o.push(t),p.hasChildRecords&&i._parentRecords.push(p),p.childRecords&&i._addNestedRecords(p.childRecords)}},_enableColumnResizeEvents:function(){var e=this;e.model.allowColumnResize?e._on(e.element,"mousemove",e._mouseMove):e._off(e.element,"mousemove",e._mouseMove)},_wireEvents:function(){var i=this,a=i.model;jQuery.uaMatch(navigator.userAgent);t.isTouchDevice()?(i._on(i.element,"tap",i._onRecordClick),i._on(i.element,"doubletap",".e-gridcontent > div",i._onRecordDoubleClick),i._on(i.element,"tap",i._onClick)):(i._on(i.element,"click",i._onRecordClick),i._on(i.element,"dblclick",".e-gridcontent > div",i._onRecordDoubleClick),i._on(i.element,"click",i._onClick)),i._on(i.element,"keydown",i._keyDown),i._on(i.element,"click","#"+i._id+"e-gridheader",i._onHeaderClick),i._on(i.element,"mousedown touchstart","#"+i._id+"e-gridheader",i._headerMouseDown),i._on(e(document),"mousedown touchstart",i._mouseDownHandler),i._on(i.element,"mousedown touchstart",".e-gridcontent",i._contentMouseDown),this.model.isResponsive&&this._on(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),i.model.allowColumnResize&&i._on(i.element,"mousemove",i._mouseMove),"immediate"==a.filterSettings.filterBarMode&&(i._on(i.element,"keyup",".e-filterbarcell input",i._filterBarHandler),i._off(i.element,"click",".e-filterbarcell .e-checkbox")._on(i.element,"click",".e-filterbarcell .e-checkbox",i._filterBarHandler)),i._on(i.element,"focus click",".e-filterbarcell input",i._filterBarClose),i._on(i.element,"click",".e-filterbarcell .e-cancel",i._filterBarClose),(i.model.showGridCellTooltip||i.model.showGridExpandCellTooltip)&&i._on(i.element,"mousemove",".e-rowcell",i._mouseHover),i.model.showGridCellTooltip&&i._on(i.element,"mousemove",".e-headercelldiv",i._headermouseHover),i._on(i.element,"mouseleave",".e-rowcell",i._cellMouseLeave),i._on(i.element,"mouseleave",i._cellMouseLeave),i._on(i.element,"mouseleave",".e-headercelldiv",i._headerMouseLeave),i._on(i.element,"mouseleave",i._headerMouseLeave),(a.isFromGantt||this._frozenColumnsLength)&&i._on(i.element,"mousewheel DOMMouseScroll",i._mouseWheel),a.enableResize&&a.isResponsive&&!a.isFromGantt&&i._on(e(window),"resize",i._windowResize),i._enableEditingEvents(),this._on(this.element,"click",".e-unboundcelldiv button",this._unboundClickHandler),a.contextMenuSettings.showContextMenu&&i._on(i.element,"keyup contextmenu taphold",this._preventContextMenu)},_preventContextMenu:function(e){if(93==e.keyCode||"contextmenu"==e.type||"taphold"==e.type)return e.preventDefault(),e.stopPropagation(),!1},_mouseDownHandler:function(t){var i=this,a=e(t.target);0!=a.closest("div.e-tgheaderContextmenu").length||0!=a.closest("div.e-columnmenuitem").length||0!=a.closest("div.e-columnMenuListDiv").length||(a.hasClass("e-columnmenu-icon")||a.hasClass("e-column-filter-icon")||a.hasClass("e-column-filtered-icon"))&&0!=e(t.target).closest("#"+i._id).length||0!=a.closest("div.e-"+i._id+"filterStringSelector").length||0!=a.closest("div#"+i._id+"filterStringDropDown_popup_list_wrapper").length||0!=a.closest("div#"+i._id+"filterStringInputBox_suggestion").length||0!=a.closest("div.e-"+i._id+"filterNumericSelector").length||0!=a.closest("div#"+i._id+"filterNumericDropDown_popup_list_wrapper").length||0!=a.closest("div.e-"+i._id+"filterDatepickerSelector").length||0!=a.closest("div#"+i._id+"filterDatepickerDropDown_popup_list_wrapper").length||0!=a.closest("div#e-"+i._id+"filterDatepickerInputBox").length||0!=a.closest("div.e-"+i._id+"filterDatetimepickerSelector").length||0!=a.closest("div#"+i._id+"filterDatetimepickerDropDown_popup_list_wrapper").length||0!=a.closest("div#"+i._id+"filterDatetimepickerInputBox_popup").length||0!=a.closest("div.e-"+i._id+"filterDropdownSelector").length||0!=a.closest("div#"+i._id+"filterDropdownDropDown_popup_list_wrapper").length||0!=a.closest("div.e-"+i._id+"filterBooleanSelector").length||0!=a.closest("div.e-excelfilter").length||i._isExcelFilterClick(a)||i._clearColumnMenu(),a.hasClass("e-tgheaderContextmenu")||0==a.closest("div.e-menuitem").length&&0==a.closest("div.e-columnmenuselection").length&&0==a.closest("div.e-columnMenuListDiv").length&&i._clearContextMenu(),0==a.closest("div.e-detailscellwrapperfly").length&&i._removeDetailsRow(t)},_isExcelFilterClick:function(e){var t=this._id;return 0!=e.closest("#"+t+"number_CustomDrop1_popup").length||0!=e.closest("#"+t+"number_CustomDrop2_popup").length||0!=e.closest("#"+t+"datetime_CustomDrop1_popup").length||0!=e.closest("#"+t+"datetime_CustomDrop2_popup").length||0!=e.closest("#"+t+"date_CustomDrop1_popup").length||0!=e.closest("#"+t+"date_CustomDrop2_popup").length||0!=e.closest("#"+t+"string_CustomDrop1_popup").length||0!=e.closest("#"+t+"string_CustomDrop2_popup").length||0!=e.closest("#"+t+"datetime_CustomValue2_popup").length||0!=e.closest("#"+t+"datetime_CustomValue1_popup").length||0!=e.closest("#e-"+t+"date_CustomValue2").length||0!=e.closest("#e-"+t+"date_CustomValue1").length||0!=e.closest("#"+t+"string_CustomValue1_suggestion").length||0!=e.closest("#"+t+"string_CustomValue1_suggestion").length},_mouseout:function(t){var i,a,r,n,o=this,l=o.model,d=o._gridPosition,s=d.top,c=o._gridHeight,u=o._$gridHeaderContent.outerHeight()+s;if(l.toolbarSettings.showToolbar&&(p=l.isFromGantt?o._id.replace("ejTreeGrid",""):o._id,u+=e("#"+p+"_toolbarItems").length>0?e("#"+p+"_toolbarItems").outerHeight():0),l.allowPaging&&(c-=o.element.find(".e-pager").first().outerHeight()),l.showTotalSummary&&(c-=o._$totalSummaryRowContainer.outerHeight()),o._dragMouseDown){if(d.left,n=t.pageY,o.model.isFromGantt){var p=o._id.replace("ejTreeGrid",""),h=e("#"+p).find(".e-ganttviewerbodyContianer"),g=h.ejScroller("isVScroll")?h.find(".e-content").get(0).scrollHeight-1:0;a=h.ejScroller("isHScroll")?c+s-l.rowHeight/2-18:c+s-l.rowHeight/2}else g=o.isVScroll()?o.getMaxScrollHeight()+1:0,a=o.getScrollElement().ejScroller("isHScroll")?c+s-l.rowHeight/2-18:c+s-l.rowHeight/2;r=u+l.rowHeight/2,n>a&&g>o._scrollTop?o._timerDragDown||(o._timerDragDown=window.setInterval(function(){g>o._scrollTop&&(i=(i=o._scrollTop+20)>g?g:i,o.model.isFromGantt?h.ejScroller("scrollY",i,!0):o.getScrollElement().ejScroller("scrollY",i,!0))},100)):o._timerDragDown&&(o._timerDragDown=window.clearInterval(o._timerDragDown)),n<r&&0!=o._scrollTop&&o._scrollTop>0?o._timerDragUp||(o._timerDragUp=window.setInterval(function(){o._scrollTop>0&&((i=o._scrollTop-20)<0&&(i=0),o.model.isFromGantt?h.ejScroller("scrollY",i,!0):o.getScrollElement().ejScroller("scrollY",i,!0))},100)):o._timerDragUp&&(o._timerDragUp=window.clearInterval(o._timerDragUp))}},getRange:function(t,i,a){var r,n,o=this,l=o.model,d=0,s=0;r=0==a.length?l.rowHeight:a[0].offsetHeight,c=o.getOffsetRect(e("#"+o._id)[0]),n=o._$gridHeaderContent.outerHeight()+c.top,r+=o._detailsRowHeight,l.enableVirtualization||(o._scrollTop=o.getScrollElement().ejScroller("scrollTop")),l.toolbarSettings.showToolbar&&(n+=e("#"+o._id+"_toolbarItems").length>0?e("#"+o._id+"_toolbarItems").outerHeight():0),l.allowTextWrap?(0==a.length&&(a=o._lastRow),s=a.offset().top):0!=o._scrollTop?s=i*r+n+(d=r-o._scrollTop%r):s=i*r+n+d;var c,u=((0==a.length?s+l.rowHeight:s+a[0].offsetHeight)-s)/3,p=s+u,h=p+u;return c={topRowSegment:p,middleRowSegment:h,bottomRowSegment:h+u}},_childValidation:function(e){var t,i=this._draggedRecord.parentItem;i&&(t=i.childRecords.indexOf(this._draggedRecord),e==i&&-1!=t&&(this._childItem=!0))},_isColumnHidable:function(e){this.model;var t,i,a=!0;return t=this._frozenColumns.filter(function(e){return 1==e.visible}),i=this._unFrozenColumns.filter(function(e){return 1==e.visible}),1==t.length&&t[0].field==e.field&&(a=!1),1==i.length&&i[0].field==e.field&&(a=!1),a},_updateColumnMenuVisibility:function(){var t,i=this.model,a=[],r=[];(i.showColumnChooser||i.contextMenuSettings.showContextMenu)&&(a=this._frozenColumns.filter(function(e){return 1==e.visible}),r=this._unFrozenColumns.filter(function(e){return 1==e.visible}),1==a.length&&((t=e("#"+this._id+"_columnMenu_"+a[0].field.split(".").join("")).data("ejCheckBox"))&&t.option("enabled",!1)),1==r.length&&((t=e("#"+this._id+"_columnMenu_"+r[0].field.split(".").join("")).data("ejCheckBox"))&&t.option("enabled",!1)))},_validDrop:function(t,i){var a=this;t.filter(function(t){if(t.hasChildRecords&&1==i.dragState){if(-1!=e.inArray(i,t.childRecords))return void(i.dragState=!1);a._validDrop(t.childRecords,i)}})},_renderToolTip:function(t,i,a,r){var n,o,l,d,s,c,u=this,p=this.model,h=[],g=(document,u.model.columns,p.dragTooltip.tooltipItems.length,r.closest("tr"));e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"}),e(".e-error").css({display:"none"}),e(".e-treegridexpand").css({display:"inline-block"}),e(".e-treegridcollapse").css({display:"inline-block"}),u._isHierarchyFiltering&&e("#"+u._id+"e-gridcontent").css({cursor:"no-drop"}),u._isHierarchyFiltering?(n=u.getIndexByRow(g),u._currentRecord=p.currentViewData[n]):0==g.length&&(r.hasClass("e-movablecontainer")||r.hasClass("e-gridcontent")||r.hasClass("e-content"))&&(n=u._recordIndex,u._currentRecord.parentItem||u._currentRecord.hasChildRecords&&(u._currentRecord.expanded?u._lastRow.find(".e-treegridexpand").css({display:"none"}):u._lastRow.find(".e-treegridcollapse").css({display:"none"}))),h={},o=u.getUpdatedRecords(),u._insertAbove=!1,u._insertAsChild=!1,u._insertBelow=!1,u._childItem=!1,u._draggedRecord,n!=u._draggedIndex&&(u._displayContextMenu=!1),l=u.getExpandedRecords(o),u.getVisibleRange(),d=l.slice(u._visibleRange.top,u._visibleRange.bottom),0!=u._scrollTop?(o.indexOf(u._draggedRecord)-1,s=d.indexOf(u._currentRecord)-1):(o.indexOf(u._draggedRecord),s=d.indexOf(u._currentRecord));var m=o.indexOf(u._currentRecord),_=u._currentRecord&&u._checkPrevNextRecord(u._draggedRecord,m,u._currentRecord.level,"next"),f=u._currentRecord&&u._checkPrevNextRecord(u._draggedRecord,m,u._currentRecord.level,"prev"),w=u._gridPosition.left,C=t.pageY;u._currentRecord&&(h=u.getRange(u._currentRecord,s,g));var T=C<=h.topRowSegment,x=C>h.topRowSegment&&C<=h.middleRowSegment,v=C>h.middleRowSegment&&C<=h.bottomRowSegment;u._currentRecord&&(u.data=u._currentRecord,c=this._getrowName(),u._childValidation(u._currentRecord),u._isHierarchyFiltering||(u._currentRecord.parentItem?u._currentRecord.hasChildRecords&&(u._currentRecord.expanded?g.find(".e-treegridexpand").css({display:"inline-block"}):g.find(".e-treegridcollapse").css({display:"inline-block"})):u._currentRecord.hasChildRecords&&(u._currentRecord.expanded?g.find(".e-treegridexpand").css({display:"none"}):g.find(".e-treegridcollapse").css({display:"none"})),u._validDrop(u._draggedRecords,u._currentRecord),a.dropPosition=1==u._currentRecord.dragState&&0!=a.canDrop?T&&!f?"insertAbove":x&&0==u._childItem?"insertAsChild":x&&1==u._childItem?"invalidPosition":v&&!_||0==g.length?"insertBelow":"invalidPosition":"invalidPosition",u._trigger("rowDrag",a),1==u._currentRecord.dragState&&0!=a.canDrop?T&&!f?(e(u.element).find("."+c).find(".e-aboveIcon").css({display:"block"}),u._insertAbove=!0):x&&0==u._childItem?(e(u.element).find("."+c).find(".e-childIcon").css({display:"block"}),u._insertAsChild=!0):x&&1==u._childItem?(e(u.element).find("."+c).find(".e-cancelIcon").css({display:"block"}),u.cancelDrop=!0):(v&&!_||0==g.length)&&(e(u.element).find("."+c).find(".e-belowIcon").css({display:"block"}),u._insertBelow=!0):(e(u.element).find("."+c).find(".e-cancelIcon").css({display:"block"}),u.cancelDrop=!0))),e(u._dragmouseOverTooltip).css({top:C+20+"px",left:w+15+"px",position:"absolute","z-index":u.getMaxZIndex()+1,padding:"0","border-right":"0","border-bottom":"0","border-radius":"3px",height:"auto"})},_checkPrevNextRecord:function(e,t,i,a){this.model;var r=this.getUpdatedRecords(),n=t;for("next"==a?t++:t--;r[t];){if(r[t].level==i)return r[t]==e&&e.parentItem==r[n].parentItem;"next"==a?t++:t--}return!1},_createDragTooltipTemplate:function(){var t,i,a=this,r=a.model.dragTooltip.tooltipTemplate;r&&(t="#"==r.charAt(0)?e(a.model.dragTooltip.tooltipTemplate)[0].innerHTML:a.model.dragTooltip.tooltipTemplate),(i={})[a._id+"dragtooltipTemplate"]=t,e.templates(i)},_updateDragStateFalse:function(e,t){var i,a,r;if(e.dragState=!1,e.hasChildRecords)for(a=e.childRecords.length,r=0;r<a;r++)(i=e.childRecords[r]).dragState=!1,i.hasChildRecords&&(t=this._updateDragStateFalse(i,t))},_updateDragStateTrue:function(e,i){var a,r,n;if(!t.isNullOrUndefined(e)&&(e.dragState=!0,e.hasChildRecords))for(r=e.childRecords.length,n=0;n<r;n++)(a=e.childRecords[n]).dragState=!0,a.hasChildRecords&&(i=this._updateDragStateTrue(a,i))},_getCoordinate:function(e){var t=e;return("touchmove"==e.type||"touchstart"==e.type||"touchend"==e.type||"taphold"==e.type||"tap"==e.type)&&(t=e.originalEvent.changedTouches[0]),t},_getElementByPosition:function(t,i){return e(document.elementFromPoint(t-window.pageXOffset,i-window.pageYOffset))},dragRecord:function(i){var a,r,n,o,l,d,s,c,u,p;if(i.ctrlKey||i.shiftKey||2==i.which||3==i.which)return!0;var h,g,m,_=this,f=_.model,w={},C=_._getCoordinate(i),T=e(i.target),x=T.closest("tr"),v=_.getUpdatedRecords(),b=!0;if(window.clearTimeout(this._dragTooltipTimer),this._dragTooltipTimer=null,!_._mouseDown)return!0;if(!x.hasClass("e-editedrow")&&_.editFormValidate()){if("cell"==f.selectionSettings.selectionMode&&_.clearSelection(),_._clearColumnMenu(),_._removeDetailsRow(),_._saveCellHandler(i),_._posx=C.pageX,_._posy=C.pageY,T.hasClass("e-summaryrowcell")||T.hasClass("e-footersummaryrowcell")||T.hasClass("e-summarytitle")||T.closest("tr").hasClass("e-detailsrowexpanded"))return;if(f.enableVirtualization?(_._currentIndex=_.getIndexByRow(x),g=f.currentViewData[_._currentIndex],_._currentIndex=v.indexOf(g)):_._currentIndex=_.getIndexByRow(x),_._draggedIndex=h=_.getIndexByRow(x),_._draggedRecord=_.model.currentViewData[h],t.isNullOrUndefined(_._draggedRecord))return;w.draggedRowIndex=h,w.draggedRow=_._draggedRecord,!f.isFromGantt&&("checkbox"==f.selectionSettings.selectionType&&f.selectedItems.length>1&&"checked"==f.currentViewData[_.getIndexByRow(x)].checkboxState||"multiple"==f.selectionSettings.selectionType&&f.selectedItems.length>1)?_._draggedRecords=e.extend([],f.selectedItems).reverse():_._draggedRecords.push(_._draggedRecord),w.draggedRecords=_._draggedRecords,_._trigger("rowDragStart",w),w.draggedRow&&w.draggedRow.isSummaryRow&&(w.cancel=!0,w.draggedRow.canDrag=!1),0==w.draggedRow.canDrag&&(b=!1),e.extend([],_._draggedRecords).filter(function(e){0==e.canDrag&&(_._draggedRecords.splice(_._draggedRecords.indexOf(e),1),e.canDrag=!0)}),_._gridPosition=_.getOffsetRect(e("#"+_._id)[0]),_._frozenColumnsLength>0&&-1!=h&&(x.index(),a=x.closest(".e-movablecontentdiv").length>0?e(_._gridRows[0])[h]:e(_._gridRows[1])[h],x=x.add(a));var S=_._gridPosition.left,D=C.pageY,R=f.isFromGantt?f.ganttElement.width():_._gridWidth,y=x.clone();if(R-=50,y.find(".e-hide").remove(),r=f.dragTooltip.tooltipItems.length,n=t.buildTag("table.e-zerospace","",{padding:"1",width:R-1,"border-collapse":"collapse"}),_.model.dragTooltip.showTooltip&&0==_._dragTooltip)if(_.model.dragTooltip.tooltipTemplate||0!=_.model.dragTooltip.tooltipItems.length)if(0!=r){for(o=f.columns,m=t.buildTag("tbody","",{},{}),l=t.buildTag("tr.e-dragtooltipbackground","",{},{}),s=0;s<r;s++)for(c=0;c<o.length;c++)if(0!=o[c].visible&&(d=f.isFromGantt?o[c].mappingName:o[c].field,f.dragTooltip.tooltipItems[s]==d)){u=_._getCustomCellValue(_._draggedRecord,o[c].field),o[c].format&&(u=_.formatting(o[c].format,u,f.locale)),t.isNullOrUndefined(u)||(p=t.buildTag("td.e-dragrowcell",u.toString(),{padding:"5px",width:_.columnsWidthCollection[c],height:f.rowHeight},{}),l.append(p)),l.append(p);break}m.append(l),n.append(m),_._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltiptreegrid"+_._id,n,{top:D+20+"px",left:S+15+"px",position:"absolute","z-index":_.getMaxZIndex()+1,padding:"0","border-right":"0","border-bottom":"0","border-radius":"3px",height:"auto",width:R,overflow:"hidden"},{}),f.cssClass&&e(_._dragmouseOverTooltip).addClass(f.cssClass),e(_._dragmouseOverTooltip).addClass("e-dragtooltipbackground").addClass("e-dragrowcell"),_._dragTooltip=!0}else _.model.dragTooltip.tooltipTemplate&&(_._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltiptreegrid"+_._id,"",{top:D+20+"px",left:S+15+"px",position:"absolute","z-index":_.getMaxZIndex()+1,padding:"0","border-right":"0","border-bottom":"0","border-radius":"3px",height:"auto"},{}),f.cssClass&&e(_._dragmouseOverTooltip).addClass(f.cssClass),_.tooltipState="TemplateID",m=t.buildTag("tbody",e.render[_._id+"dragtooltipTemplate"](_._draggedRecord),{},{}),_._dragmouseOverTooltip[0].innerHTML="<table>"+m[0].innerHTML+"</table>",_._dragTooltip=!0);else m=t.buildTag("tbody","",{},{}),y.find(".e-treegridexpand").css({display:"none"}),y.find("td.e-unboundcell").css({display:"none"}),y.find("td.e-detailsrowcell").css({display:"none"}),y.find(".e-treegridcollapse").css({display:"none"}),e(y.find(".e-dragintend")).css({width:0}),y.find(".e-intend").removeClass("e-intend"),y.find(".e-rowcell ").removeClass("e-rowcell ").addClass("e-dragrowcell"),y.addClass("e-dragtooltipbackground"),f.isFromGantt&&y.find("td:last").remove(),2==y.length&&this._frozenColumnsLength>0&&(e(y[0]).append(e(y[1].childNodes)),y.splice(1,1)),m.append(y),n.append(m),_._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltiptreegrid"+_._id,n,{top:D+20+"px",left:S+15+"px",position:"absolute",overflow:"hidden","z-index":_.getMaxZIndex()+1,padding:"0","border-radius":"3px","border-right":"0","border-bottom":"0",width:R},{}),f.cssClass&&e(_._dragmouseOverTooltip).addClass(f.cssClass),e(_._dragmouseOverTooltip).addClass("e-dragtooltipbackground").addClass("e-dragrowcell"),_._dragTooltip=!0;_._draggedRecord&&(_._draggedElement=x,_._updateDragStateFalse(_._draggedRecord),_._dragMouseDown=!0,"touchstart"==i.type?(_._isHierarchyFiltering||e(document.body).append(_._dragmouseOverTooltip),_._off(_.element,"touchmove","#"+_._id+"e-gridcontent",_._touchScroll),_._on(_.element,"touchmove",".e-treegridrows, .e-templatecell",_.dragToolTip)):(_._off(_.element,"mousemove","#"+_._id+"e-gridcontent",_._touchScroll),_._on(_.element,"mousemove",".e-gridcontent, .e-templatecell",_.dragToolTip))),(w.cancel||!b)&&(_._dragMouseDown=!1,_._updateDragStateTrue(_._draggedRecord),_._dragTooltip=!1,_._dragmouseOverTooltip&&_._dragmouseOverTooltip.remove(),_._dragmouseOverTooltip=null,"touchstart"==i.type?_._off(_.element,"touchmove",".e-treegridrows, .e-templatecell",_.dragToolTip):_._off(_.element,"mousemove",".e-gridcontent, .e-templatecell",_.dragToolTip))}},dragToolTip:function(i){var a,r,n,o,l,d,s,c,u,p,h,g=this,m=g.model,_=m.currentViewData,f={},w=g._getCoordinate(i);if(i.preventDefault(),d=Math.abs(w.pageX-g._posx),s=Math.abs(w.pageY-g._posy),!(t.isNullOrUndefined(g._posx)||t.isNullOrUndefined(g._posy)||d<10&&s<10)&&1==g._dragMouseDown&&1==g.model.allowDragAndDrop){if(g._batchEditStarts)return g._batchSaveLostWarning("Drag"),!0;"touchmove"==i.type?n=g._getElementByPosition(w.pageX,w.pageY):(n=e(i.target),e(document.body).append(g._dragmouseOverTooltip)),o=n.closest("tr"),1!=m.allowSelection||t.isNullOrUndefined(g._draggedRecord)||0!=g._draggedRecord.isSelected||(g.clearSelection(-1),g._selectDraggedRow(o),g._cancelSaveTools()),0==o.length&&(n.hasClass("e-movablecontainer")||n.hasClass("e-gridcontent")||n.hasClass("e-content"))?(m.enableVirtualization?(g._currentRecord=_[_.length-1],g._insertBelow=!0,g._lastRow=t.TreeGrid.getRowByIndex(g,_.length-1),g._recordIndex=_.length-1):(c=g.getExpandedRecords(_),g._currentRecord=c[c.length-1],m.allowPaging?g._lastRow=t.TreeGrid.getRowByIndex(g,_.length-1):(u=m.updatedRecords.indexOf(g._currentRecord),g._lastRow=t.TreeGrid.getRowByIndex(g,u)),g._recordIndex=g._indexOfLastRow=g.getIndexByRow(g._lastRow)),p=g._recordIndex):(p=g.getIndexByRow(o),g._currentRecord=m.currentViewData[p]),h=g.getUpdatedRecords(),-1!=p?(a=g.model.currentViewData[p],(r=(o=t.TreeGrid.getRowByIndex(g,g._currentIndex)).clone()).find(".e-hide").remove(),g._dragTargetItem=a,f.targetRowIndex=p,f.targetRow=a,f.canDrop=!0,f.draggedRow=g._draggedRecord,f.draggedRowIndex=h.indexOf(g._draggedRecord),f.draggedRecords=g._draggedRecords,g._renderToolTip(w,r,f,n),f.targetRow&&f.targetRow.isSummaryRow?(g._draggedRecord.canDrop=!1,e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"})):g._draggedRecord.canDrop=0!=f.canDrop):g._draggedRecord&&g._dragMouseDown&&(a=null,r=(o=t.TreeGrid.getRowByIndex(g,g._currentIndex)).clone(),l=n.closest("tr"),f.targetRowIndex=null,f.targetRow=null,g._dragTargetItem=null,f.canDrop=!0,f.draggedRow=g._draggedRecord,f.draggedRowIndex=g._draggedRecord.index,f.dropPosition="invalidPosition",g._trigger("rowDrag",f),l.hasClass("e-footersummaryrow")||g._renderToolTip(w,r,f,n)),g._mouseout(w)}},_mouseupHandler:function(t){var i=this,a=i.model;"touchend"==t.type?i._off(i.element,"touchmove","#"+i._id+"e-gridcontent",i._touchScroll):i._off(i.element,"mousemove","#"+i._id+"e-gridcontent",i._touchScroll),i._off(e(document),"mouseup touchend",i._mouseupHandler),i._mouseDown=!1,i._isTouchEvent=!1,window.clearTimeout(i._dragTooltipTimer),a.allowDragAndDrop&&i._dragMouseDown&&i.dragMouseUp(t),a.contextMenuSettings.showContextMenu&&i._contextMenuHandler&&i._displayContextMenu?i._rightClick(t):i._contextMenuHandler=!1,i._displayContextMenu=!0,i._dy=i._dx=0},_performDragAndDrop:function(i,a,r,n,o){for(var l,d,s,c,u,p,h,g,m,_=this,f=_.model,w=(f.editSettings.editMode.toLowerCase(),0),C=f.selectedItems.length,T=_._draggedRecords.length,x=[],v={},b=0;b<T;b++){if(i=_._draggedRecord=_._draggedRecords[b],l=f.flatRecords,n.previousParentItem=i.parentItem?e.extend({},i.parentItem):i.parentItem,t.isNullOrUndefined(i.parentItem)||(n.previousParentItem.childRecords=e.extend([],i.parentItem.childRecords),n.parentChildState=i.parentItem.hasChildRecords,n.parentExpandedState=i.parentItem.expanded),"rowIndexUpdate"!=n.requestType&&(o.targetRow=e.extend({},_._droppedRecord),o.targetRow.item=e.extend({},_._droppedRecord.item),o.targetRowIndex=f.updatedRecords.indexOf(a),o.draggedRow=e.extend({},_._draggedRecord),o.draggedRow.item=e.extend({},_._draggedRecord.item),o.draggedRowIndex=f.updatedRecords.indexOf(i)),n.previousItem=t.isNullOrUndefined(o)?e.extend({},_._draggedRecord):o.draggedRow,n.previousItemIndex=l.indexOf(_._draggedRecord),n.previousTarget=_._droppedRecord,n.previousTargetItemIndex=l.indexOf(_._droppedRecord),n.clonedTarget=e.extend({},_._droppedRecord),n.hasChildRecords=a.hasChildRecords,n.expanded=a.expanded,n.childIndex=n.previousParentItem?n.previousParentItem.childRecords.indexOf(i):0,n.previousLevel=i.level,[],1==a.dragState){if(_._updateDragStateTrue(i),1==_._insertAbove||1==_._insertBelow||1==_._insertAsChild){for(_.model.isEdit||_._isRowEdit||_._cancelSaveTools(),d=0;d<C;d++)_.clearSelection(f.selectedItems[d]);_._deleteDragRow(),s=l.indexOf(a),_._checkboxSelection&&f.selectionSettings.enableHierarchySelection&&i.parentItem&&_._updateParentSelection(i.parentItem),1==_._insertAbove?(n.index=s,i.parentItem=l[s].parentItem,i.level=l[s].level,l.splice(s,0,i),f.updatedRecords.splice(s,0,i),f.isFromGantt&&f.ids.splice(s,0,i.taskId.toString()),i.hasChildRecords&&(c=1,_._updateChildRecord(i,s),_._updateChildRecordLevel(i,c)),a.parentItem&&(m=(g=a.parentItem.childRecords).indexOf(a),g.splice(m,0,i),_._updateHierarchyRowIndexData(n,g,m))):1==_._insertBelow?(n.index=s+1,a.hasChildRecords?(w=_.getChildCount(a,0),l.splice(s+w+1,0,i),f.updatedRecords.splice(s+w+1,0,i),f.isFromGantt&&f.ids.splice(s+w+1,0,i.taskId.toString())):(l.splice(s+1,0,i),f.updatedRecords.splice(s+1,0,i),f.isFromGantt&&f.ids.splice(s+1,0,i.taskId.toString())),i.parentItem=l[s].parentItem,i.level=l[s].level,i.hasChildRecords&&(c=1,_._updateChildRecordLevel(i,c),_._updateChildRecord(i,s+w+1)),a.parentItem&&(m=(g=a.parentItem.childRecords).indexOf(a)+1,g.splice(m,0,i),_._updateHierarchyRowIndexData(n,g,m))):1==_._insertAsChild&&(n.index=s+1,i.hasChildRecords?(l.splice(s+1,0,i),f.updatedRecords.splice(s+1,0,i),f.isFromGantt&&f.ids.splice(s+1,0,i.taskId.toString()),_._recordLevel(r,n),a.hasChildRecords&&(a.expanded=_._isLoadonDemand?a.isChildRetrieved:a.expanded),_._updateChildRecord(i,s+1,a.expanded)):(l.splice(s+1,0,i),f.updatedRecords.splice(s+1,0,i),f.isFromGantt&&f.ids.splice(s+1,0,i.taskId.toString()),_._recordLevel(r,n)))}_._checkboxSelection&&f.selectionSettings.enableHierarchySelection&&(i.parentItem&&_._updateParentSelection(i.parentItem),_.selectAllRows()),null==i.parentItem&&(p=(u=f.parentRecords).indexOf(_._droppedRecord),1==_._insertBelow?u.splice(p+1,0,i):1==_._insertAbove&&u.splice(p,0,i),h=1==_._insertBelow?p+1:p,_._updateHierarchyRowIndexData(n,u,h))}x.push(i)}return v.draggedRecords=x,v.draggedRecord=i,v.droppedRecord=a,v},_updatedMovedRow:function(e,i,a,r,n,o){var l,d,s,c,u=this,p=u.model;if(r.draggedRow=e,r.targetRow=i,r.droppedPosition=a,!p.isFromGantt&&o)for(l=0;l<o.length;l++)u._draggedRecord=o[l],u._updateDataSource();else u._updateDataSource();if(p.showSummaryRow&&1==u._insertAsChild&&u._createSummaryRow(r),p.enableWBS){e.parentItem?d=e.parentItem.childRecords:d=p.flatRecords.filter(function(e){return e&&0==e.level});var h=d.indexOf(e),g=d.slice(h,d.length),m=e.parentItem?e.parentItem.WBS:null,_=h+1;u.reCalculateWBS(g,_,m)}p.isFromGantt&&(c=(s=p.flatRecords.indexOf(e))<n?s:n,u.updateSerialNumber(c),p.enableSerialNumber&&("insertAsChild"==a&&(c-=1),u.updateSerialNumberPredecessors(c))),u.processBindings(r),p.enableAltRow&&p.currentViewData.length>0&&t.TreeGrid.updateAltRow(u,u.model.currentViewData[0],0,0)},_navigatePager:function(e){var i,a,r=this,n=r.model,o=n.pageSettings.pageSize;n.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&(a=r._getRootParent(n.updatedRecords[e]),e=n.parentRecords.indexOf(a)),i=Math.ceil((e+1)/o),r.gotoPage(i)},_getRootParent:function(e){return t.isNullOrUndefined(e.parentItem)?e:this._getRootParent(e.parentItem)},moveRow:function(i,a,r){var n,o,l,d=this,s=d.model,c={},u={};if(d._cancelEditState(),"batchediting"==s.editSettings.editMode.toLowerCase()&&d._batchEditStarts||(t.isNullOrUndefined(a)&&("above"==r||"child"==r?a=i-1:"below"==r&&(a=i+1)),n=s.updatedRecords[i],(o=s.updatedRecords[a])&&o.isSummaryRow&&(o=d._getNextRecord(a,s.updatedRecords,r)),t.isNullOrUndefined(n)||t.isNullOrUndefined(o)||1==n.isSummaryRow||1==o.isSummaryRow||!d.getExpandStatus(n)||!d.getExpandStatus(o)))return!1;if(d._draggedRecord=n,d._droppedRecord=o,d._draggedRecords.push(n),c.currentRecord=n,c.targetRecord=o,c.currentRowIndex=i,c.targetRowIndex=a,c.dropPosition=r,c.requestType="rowIndexUpdate",d._moveRow=!0,!d._trigger("actionBegin",c)){if(d._validDrop(d._draggedRecords,o),1==o.dragState){if("above"==r)d._insertAbove=!0;else if("below"==r)d._insertBelow=!0;else{if("child"!=r||-1!=e.inArray(n,o.childRecords))return d._resetPrivateProperties(),!1;d._insertAsChild=!0}return d._performDragAndDrop(n,o,i,c),d._updatedMovedRow(n,o,r,c),s.allowPaging&&d._navigatePager(s.updatedRecords.indexOf(n)),d.updateScrollBar(d.getUpdatedRecords().indexOf(n)),1==s.allowSelection&&(d.clearSelection(-1),d._selectDraggedRow(),d._cancelSaveTools()),u.currentRecord=n,u.targetRecord=o,u.currentRowIndex=s.updatedRecords.indexOf(n),u.targetRowIndex=s.updatedRecords.indexOf(o),u.dropPosition=c.dropPosition,u.requestType=c.requestType,d._trigger("actionComplete",u),(l={}).draggedRowIndex=u.currentRowIndex,l.targetRowIndex=u.targetRowIndex,l.requestType="dragAndDrop",d._updateAction(l),d._resetPrivateProperties(),!0}return o.dragState=!0,d._resetPrivateProperties(),!1}},dragMouseUp:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C={},T={},x={},v=this,b=v.model,S=v._draggedRecord,D=(v._currentRecord,v._getCoordinate(i)),R=b.flatRecords.indexOf(S);if(S.isDragged=!0,v._timerDragDown&&(v._timerDragDown=window.clearInterval(v._timerDragDown)),v._timerDragUp&&(v._timerDragUp=window.clearInterval(v._timerDragUp)),b.allowDragAndDrop&&("touchstart"==i.type?v._off(v.element,"touchmove",".e-treegridrows, .e-templatecell",v.dragToolTip):v._off(v.element,"mousemove",".e-gridcontent, .e-templatecell",v.dragToolTip),l=!!(t.isNullOrUndefined(S)||v._draggedRecords.length>1)||S.canDrop),window.clearTimeout(v._dragTooltipTimer),v._dragMouseDown=!1,e(v._dragmouseOverTooltip).remove(),v._dragTooltip=!1,r=(a="touchend"==i.type?v._getElementByPosition(D.pageX,D.pageY):e(i.target)).closest("tr"),v._isHierarchyFiltering&&e("#"+v._id+"e-gridcontent").css({cursor:"default"}),e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"}),s=b.currentViewData[v.getIndexByRow(r)],1!=this.cancelDrop||t.isNullOrUndefined(s)||null!=s.parentItem||(c=t.TreeGrid.getRowByIndex(this,b.updatedRecords.indexOf(s)),s.expanded?c.find(".e-treegridexpand").css({display:"inline-block"}):c.find(".e-treegridcollapse").css({display:"inline-block"})),v._dragMouseLeave=!0,1!=a.closest("#"+v._id).length||1!=a.closest(".e-gridcontent").length||t.isNullOrUndefined(S)||0!=v._dropCancel)v._updateDragStateTrue(S);else{if(!b.allowDragAndDrop||!l)return v._updateDragStateTrue(S),v._resetPrivateProperties(),0;v._dragMouseLeave=!1,0==r.length?(u=h=v._indexOfLastRow,b.enableVirtualization?v._droppedRecord=b.currentViewData[b.currentViewData.length-1]:b.currentViewData[b.currentViewData.length-1].expanded?(v._insertBelow=!0,v._droppedRecord=b.currentViewData[b.currentViewData.length-1]):(p=v.getExpandedRecords(b.currentViewData),v._droppedRecord=p[p.length-1])):(h=v.getIndexByRow(r),v._droppedRecord=b.currentViewData[h],u=b.updatedRecords.indexOf(v._droppedRecord)),u!=v._currentIndex&&-1!=h&&0!=v._draggedRecords.length?(1==v._droppedRecord.dragState&&(-1!=e.inArray(v._droppedRecord,v._draggedRecords)&&(g=v._draggedRecords.indexOf(v._droppedRecord),v._draggedRecords.splice(g,1)),"checkbox"==b.selectionSettings.selectionType&&1==b.selectionSettings.enableHierarchySelection&&e.extend([],v._draggedRecords).filter(function(e){e.parentItem&&"checked"==e.parentItem.checkboxState&&v._draggedRecords.splice(v._draggedRecords.indexOf(e),1)})),1==v._insertAbove&&v._draggedRecords.length>1&&v._draggedRecords.reverse(),v._insertAbove?d="insertAbove":v._insertBelow?d="insertBelow":v._insertAsChild&&(d="insertAsChild"),x.draggedRecords=v._draggedRecords,x.draggedRow=S,x.draggedRow.item=S.item,x.targetRow=v._droppedRecord,x.draggedRowIndex=b.updatedRecords.indexOf(S),x.targetRowIndex=b.updatedRecords.indexOf(v._droppedRecord),x.dropPosition=d,o=v._droppedRecord,v._trigger("rowDropActionBegin",x)||(e.extend([],v._draggedRecords).filter(function(e){0==e.canDrop&&(v._draggedRecords.splice(v._draggedRecords.indexOf(e),1),e.canDrop=!0),0==v._draggedRecords.length&&(o.dragState=!1)}),S=(m=this._performDragAndDrop(S,o,h,C,T)).draggedRecord,n=m.draggedRecords,o=m.droppedRecord,C.requestType="dragAndDrop",1!=o.dragState||v._isHierarchyFiltering?v._updateDragStateTrue(S):(v._updatedMovedRow(S,o,d,C,R,n),b.isFromGantt||(T.draggedRecords=n),T.draggedRow=C.draggedRow,T.draggedRow.item=C.draggedRow.item,T.draggedRowIndex=b.updatedRecords.indexOf(S),T.targetRowIndex=b.updatedRecords.indexOf(o),T.requestType=d,C.isFromRevertDragging=!1,v._trigger("rowDragStop",T),T.cancel?(C.isFromRevertDragging=!0,v._revertDragging(C)):((_={}).draggedRecords=n,_.draggedRowIndex=T.draggedRowIndex,_.targetRowIndex=T.targetRowIndex,_.requestType="dragAndDrop",v._updateAction(_)),b.allowSelection&&("row"==b.selectionSettings.selectionMode&&(!b.isFromGantt&&("checkbox"==b.selectionSettings.selectionType&&-1!=e.inArray(S,b.selectedItems)||"multiple"==b.selectionSettings.selectionType)&&b.selectedItems.length>1?(f=b.selectedItems.filter(function(e){if(1==e.isDragged)return e.isDragged=!1,e}),w=v.getUpdatedRecords().indexOf(f[0]),v.clearSelection(w),v._multiSelectCtrlRequest=!0,-1!=w&&b.allowSelection&&!v._rowSelectingEventTrigger(this.selectedRowIndex(),w)&&(v.selectRows(w),v._rowSelectedEventTrigger(w))):v._selectDraggedRow(r)),"cell"==b.selectionSettings.selectionMode&&v.updateScrollBar(b.updatedRecords.indexOf(v._draggedRecord)))))):(v._updateDragStateTrue(S),v.model.isEdit||v._isRowEdit||v._cancelSaveTools())}t.isNullOrUndefined(v._currentRecord)||null==v._currentRecord.parentItem&&(r=b.allowPaging?t.TreeGrid.getRowByIndex(v,v.getUpdatedRecords().indexOf(v._currentRecord)):t.TreeGrid.getRowByIndex(v,b.updatedRecords.indexOf(v._currentRecord)),v._currentRecord.expanded?r.find(".e-treegridexpand").css({display:"inline-block"}):r.find(".e-treegridcollapse").css({display:"inline-block"})),b.showSummaryRow&&"dragAndDrop"==C.requestType&&1!=v._insertAsChild&&!v._isHierarchyFiltering&&v._updateSummaryRow(C),v._dropCancel=!1,t.isNullOrUndefined(o)||(o.dragState=!0),v._resetPrivateProperties(),t.isNullOrUndefined(S)||v.model.isEdit||v._isRowEdit||v._cancelSaveTools(),t.isNullOrUndefined(S)||1!=S.isDragged||(S.isDragged=!1)},dragColumn:function(i){var a,r,n=e(i.target),o=this,l=o._getCoordinate(i);if(o._posx=l.pageX,o._posy=l.pageY,i.ctrlKey||i.shiftKey||2==i.which||3==i.which)return!0;var d,s=o.model,c=s.columns,u={};if("col-resize"!=n.css("cursor")&&n.closest(".e-headercelldiv")&&!n.hasClass("e-columnmenu-icon")){if(a=n.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),t.isNullOrUndefined(a)&&t.isNullOrUndefined(this.getColumnByField(a)))return;if(o._saveEditedElements(),n.hasClass("e-checkbox"))return!1;if(o._draggedColumn=this.getColumnByField(a),d=c.indexOf(o._draggedColumn),u.draggedColumnIndex=d,u.draggedColumn=o._draggedColumn,u.requestType="columnDragStart",o._draggedColumnTemplate=t.isNullOrUndefined(o._draggedColumn.headerTemplateID)?null:n.closest(".e-headertemplate"),!t.isNullOrUndefined(o._draggedColumn.nonColumn))return;if(o._trigger("columnDragStart",u),u.cancel)return;"cell"==s.selectionSettings.selectionMode&&o.clearSelection(),o._headerDragStatus="mousedown",o._dragMouseDown=!0,o._mouseDragged=!1,r=o.getOffsetRect(o.element[0]),o._gridLeft=r.left,o._gridTop=r.top,o._touchstart=!0,"touchstart"!=i.type&&o._on(o.element,"mousemove",o.dragColumnToolTip)}},dragColumnToolTip:function(i){var a,r,n,o,l,d,s=this,c=s.model,u={},p=c.columns,h={},g=s._getCoordinate(i),m=g.pageX,_=g.pageY;if(s._touchstart)s._touchstart=!1;else if("touchmove"==i.type?(i.preventDefault(),a=s._getElementByPosition(g.pageX,g.pageY)):a=e(i.target),s._headerDragStatus.length>0&&1==c.allowColumnReordering){"cell"==c.selectionSettings.selectionMode&&"mousemove"!=s._headerDragStatus&&s.clearSelection();var f=a.closest(".e-headercell"),w=f.find(".e-headercelldiv").attr("data-ej-mappingname"),C=s._gridLeft+s._gridWidth-10,T=s._gridHeight+s._gridTop,x=m,v=_;if(t.isNullOrUndefined(s._dragmouseOverTooltip)||(r=s._dragmouseOverTooltip.width/2,n=s._dragmouseOverTooltip.height+5,x=x-r<s._gridLeft?s._gridLeft:x+r>C?C-2*r-4:x-r,v+n>T&&(v=T-n)),t.isNullOrUndefined(w)||t.isNullOrUndefined(this.getColumnByField(w)))t.isNullOrUndefined(s._dragmouseOverTooltip)||e(s._dragmouseOverTooltip).css({top:v+"px",left:x+"px"});else{if(o=this.getColumnByField(w),s._currentIndex=p.indexOf(o),u.targetColumnIndex=s._currentIndex,u.draggedColumnIndex=p.indexOf(s._draggedColumn),u.draggedColumn=s._draggedColumn,u.targetColumn=o,u.requestType="columnDrag",u.canDrop=!0,s._trigger("columnDrag",u),u.cancel)return;u.direction=u.draggedColumnIndex>=u.targetColumnIndex?"left":"right",h.pos=s.getOffsetRect(f[0]),h.height=e(f).height(),h.width=e(f).outerWidth(),h.pos.top=s.getOffsetRect(f.closest(".e-gridheader")[0]).top,h.display="block",h.pos.left="left"==u.direction&&s._gridLeft>h.pos.left?s._gridLeft:"right"==u.direction&&C<h.pos.left+h.width?C-10:u.draggedColumnIndex>u.targetColumnIndex?h.pos.left-2:h.pos.left+h.width-2,u.column=h,s._autoHscroll(m,_,u),u.draggedColumnIndex!=u.targetColumnIndex&&(s._displayContextMenu=!1),(u.draggedColumnIndex==u.targetColumnIndex||!t.isNullOrUndefined(u.targetColumn.nonColumn)||h.pos.left-8>s._gridWidth+s._gridLeft)&&(h.display="none"),"mousemove"==s._headerDragStatus||s._dragTooltip?(e(s._reordervline).css({height:s._reordervline.height,width:0,"border-width":0,position:"absolute",top:h.pos.top+"px",left:h.pos.left+"px","border-left-width":"3px","border-style":"solid",display:h.display}),e(s._dragmouseOverTooltip).css({top:v+"px",left:x+"px"})):(l=s._gridHeight-1,s.model.toolbarSettings.showToolbar&&(l-=t.isNullOrUndefined(e("#"+s._id+"_toolbarItems").outerHeight())?0:e("#"+s._id+"_toolbarItems").outerHeight()),l-=s.getScrollElement().ejScroller("isHScroll")?18:0,d=t.buildTag("div",s._draggedColumn.headerText,{"margin-top":"5px"}),t.isNullOrUndefined(s._draggedColumnTemplate)||t.isNullOrUndefined(s._draggedColumn)||t.isNullOrUndefined(s._draggedColumn.headerTemplateID)||(d[0].innerHTML=s._draggedColumnTemplate[0].innerHTML),s._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#columnreordertooltip"+s._id,d,{top:_+10+"px",left:m-57+"px",position:"absolute","z-index":s.getMaxZIndex()+1},{}),c.cssClass&&s._dragmouseOverTooltip.addClass(c.cssClass),s._reordervline=t.buildTag("div.e-vline e-js#reorderline"+s._id,{height:l,width:0,"border-width":0,position:"absolute",top:h.pos.top+"px",left:h.pos.left+"px","border-left-width":"3px","border-style":"solid",display:h.display}),c.cssClass&&s._reordervline.addClass(c.cssClass),e(document.body).append(s._dragmouseOverTooltip),e(document.body).append(s._reordervline),e(s._dragmouseOverTooltip).addClass("e-headertooltip"),e(s._reordervline).addClass("e-headervline"),s._dragmouseOverTooltip.width=e(s._dragmouseOverTooltip).outerWidth(),s._dragmouseOverTooltip.height=e(s._dragmouseOverTooltip).outerHeight(),s._reordervline.height="auto"==c.sizeSettings.height?e("#"+s._id+"e-gridcontent").height()+e("#"+s._id+"e-gridheader").height():l,s._dragTooltip=!0),s._headerDragStatus="mousemove"}}},reorderColumn:function(e,i){var a,r,n,o,l,d,s,c=this,u=c.model,p=u.columns;if(u.showTotalSummary&&u.collapsibleTotalSummary&&(d=p[c._summaryColumnIndex]),l=p[u.treeColumnIndex],a=c.getColumnByField(e),r=p.indexOf(a),o=c.columnsWidthCollection[r],n=p[i],!(t.isNullOrUndefined(a)||t.isNullOrUndefined(n)||n&&n.nonColumn)){if(c._frozenColumnsLength>0)if(s=this._getFrozenColumnWidth(),c._frozenColumnsLength<=r&&c._frozenColumnsLength>i&&-1==c._frozenColumns.indexOf(a)){if((s+=this.columnsWidthCollection[r]+18)>this._gridWidth)return!1;a.isFrozen=!0,c._frozenColumns.splice(i,0,a)}else c._frozenColumnsLength>r&&c._frozenColumnsLength<=i&&-1!=c._frozenColumns.indexOf(a)&&(a.isFrozen=!1,c._frozenColumns.splice(r,1),c._checkboxSelection&&1==c._frozenColumns.length&&c._frozenColumns[0].nonColumn&&(c._frozenColumns[0].isFrozen=!1,c._frozenColumns.splice(0,1)));p.splice(r,1),c.columnsWidthCollection.splice(r,1),p.splice(i,0,a),c.columnsWidthCollection.splice(i,0,o),u.treeColumnIndex=p.indexOf(l),u.showTotalSummary&&u.collapsibleTotalSummary&&(c._summaryColumnIndex=p.indexOf(d)),c._refreshFrozenColumns(),c._updateWrapRowHeights(null,"virtualRefresh")}},_refreshStackedHeader:function(){var t,i,a,r=this,n=r.model;if(n.showStackedHeader){for(t=n.stackedHeaderRows,i=0;i<t.length;i++)if(0!=r._frozenColumnsLength){var o=e(r.getHeaderContent().find(".e-frozenheaderdiv")),l=e(r.getHeaderContent().find(".e-movableheader")),d=r._createStackedRow(t[i],!0),s=r._createStackedRow(t[i],!1);e(o.find("tr.e-stackedHeaderRow")[i]).replaceWith(d),e(l.find("tr.e-stackedHeaderRow")[i]).replaceWith(s)}else a=r._createStackedRow(t[i],!1),r.getHeaderTable().find("tr.e-stackedHeaderRow")[i]?e(r.getHeaderTable().find("tr.e-stackedHeaderRow")[i]).replaceWith(a):a.insertBefore(r.getHeaderTable().find("tr.e-columnheader:last"));({}).requestType="refresh",r._updateScrollCss()}},_autoHscroll:function(e){var t,i,a=this,r=(a.model.columns,0),n=(a.columnsWidthCollection,a.getScrollElement());i=n.ejScroller("isHScroll"),t=i?n.find(".e-content").get(0).scrollWidth:0,a._viewPortWidth=n.find(".e-content").width(),a._frozenColumnsLength>0&&(r=this._getFrozenColumnWidth());var o=Math.round((a._gridLeft+a._gridWidth)/10)+18,l=Math.round(a._gridLeft/10)+18,d=0;a._gridLeft+a._gridWidth-o<e?a._timerDragDown||(a._timerDragDown=window.setInterval(function(){t>a._scrollLeft+a._viewPortWidth&&(d=a._scrollLeft,d+=50,a.getScrollElement().ejScroller("scrollX",d,!0))},300)):a._timerDragDown&&(a._timerDragDown=window.clearInterval(a._timerDragDown)),e<a._gridLeft+r+l&&e>a._gridLeft+r&&0!=a._scrollLeft&&a._scrollLeft>0?a._timerDragUp||(a._timerDragUp=window.setInterval(function(){a._scrollLeft>0&&(d=a._scrollLeft,(d-=50)<0&&(d=0),a.getScrollElement().ejScroller("scrollX",d,!0))},300)):a._timerDragUp&&(a._timerDragUp=window.clearInterval(a._timerDragUp))},_resetPrivateProperties:function(){this._timerDragDown&&(this._timerDragDown=window.clearInterval(this._timerDragDown)),this._timerDragUp&&(this._timerDragUp=window.clearInterval(this._timerDragUp));var i=this,a=i.model;i.cancelDrop=!1,i._draggedRecord=null,i._draggedRecords=[],i._dragMouseDown=!1,i._timerDragDown=null,i._timerDragUp=null,i._childItem=!1,i._dragMouseLeave=!1,i._moveRow=!1,i._currentRecord=null,i._currentIndex=null,i._droppedRecord=null,i._insertAsChild=!1,i._insertAbove=!1,i._insertBelow=!1,a.allowDragAndDrop&&a.enableVirtualization&&("chrome"==t.browserInfo().name||t.isTouchDevice())&&(i._dummyElement&&e(i._draggedElement).remove(),i._dummyElement=!1,i._draggedElement=null),i._dragTooltipTimer=null,i._dragColumnTooltipTimer=null,i._dragmouseOverTooltip=null},_selectDraggedRow:function(){var e=this,t=e.model,i=e.getUpdatedRecords().indexOf(e._draggedRecord);-1!=i&&(e._focusTreeGridElement(),t.allowSelection&&"row"==t.selectionSettings.selectionMode&&!e._rowSelectingEventTrigger(this.selectedRowIndex(),i)&&(e.selectRows(i),e._rowSelectedEventTrigger(i)))},_addChildItem:function(e){for(var i,a=this,r=e.childRecords.length,n=0;n<r;n++)i=e.childRecords[n],a.dataSource()instanceof t.DataManager?a.dataSource().dataSource.offline&&a.dataSource().dataSource.json&&(a.dataSource().dataSource.json.push(i.item),i.hasChildRecords&&a._addChildItem(i)):(a.dataSource().push(i.item),i.hasChildRecords&&a._addChildItem(i))},_updateDataSource:function(){var e,i,a,r,n=this,o=n.model,l=n._draggedRecord,d=n._droppedRecord;if(n.dataSource()instanceof t.DataManager?n.dataSource().dataSource.offline&&n.dataSource().dataSource.json&&(e=n.dataSource().dataSource.json):e=n.dataSource(),e&&!d.parentItem)i=e.indexOf(d.item),n._insertAbove?o.parentIdMapping||e.splice(i,0,l.item):n._insertBelow&&(o.parentIdMapping||e.splice(i+1,0,l.item));else if(!o.parentIdMapping&&d.parentItem&&(n._insertAbove||n._insertBelow))for(d.parentItem.item[n.model.childMapping]=[],a=d.parentItem.childRecords,r=0;r<a.length;r++)d.parentItem.item[n.model.childMapping].splice(r,0,a[r].item);o.parentIdMapping&&(l.parentItem?n._insertAbove||n._insertBelow?1==o.isFromGantt?l.item[o.parentIdMapping]=d.item[n.model.parentIdMapping]:(l[o.parentIdMapping]=d[n.model.parentIdMapping],l.item[o.parentIdMapping]=d[n.model.parentIdMapping]):1==o.isFromGantt?l.item[o.parentIdMapping]=d.item[n.model.idMapping]:(l[o.parentIdMapping]=d[n.model.idMapping],l.item[o.parentIdMapping]=d[n.model.idMapping]):(l.item[o.parentIdMapping]=null,l[o.parentIdMapping]=null),n.dataSource()instanceof t.DataManager?n.dataSource().dataSource.offline&&n.dataSource().dataSource.json&&n.dataSource().dataSource.json.push(l.item):((n._insertAbove||n._insertBelow||n._insertAsChild)&&n.dataSource().push(l.item),l.hasChildRecords&&n._addChildItem(l)))},_deleteDragRow:function(e){var i,a=this,r=a.model,n={},o=a.getUpdatedRecords(),l=r.flatRecords;-1!=o.indexOf(a._draggedRecord)?i=o[o.indexOf(a._draggedRecord)]:i=l[l.indexOf(a._draggedRecord)],n.tr=e,n.data=i,n.requestType=t.TreeGrid.Actions.Delete,n.isDragAndDropDelete=!0,a._removeRecords(n),a._previousIndex=-1},_revertDragging:function(i){var a,r,n,o=this,l=o.model,d=l.flatRecords;if(o._draggedRecord=i.draggedRow,o._deleteDragRow(),o._draggedRecord.hasChildRecords?(d.splice(i.previousItemIndex,0,o._draggedRecord),l.isFromGantt&&l.ids.splice(i.previousItemIndex,0,o._draggedRecord.taskId.toString()),t.isNullOrUndefined(d[i.previousItemIndex].parentItem)||(d[i.previousItemIndex].parentItem=i.previousParentItem,t.isNullOrUndefined(i.previousParentItem)||d[i.previousItemIndex].parentItem.childRecords.splice(i.childIndex,0,o._draggedRecord)),a=l.flatRecords.indexOf(o._draggedRecord),o._updateChildRecord(o._draggedRecord,a,i.previousItem.index),o._draggedRecord.level=i.previousLevel,o._updateChildRecordLevel(o._draggedRecord,i.previousLevel)):(d.splice(i.previousItemIndex,0,o._draggedRecord),l.isFromGantt&&l.ids.splice(i.previousItemIndex,0,o._draggedRecord.taskId.toString()),d[i.previousItemIndex].parentItem=i.previousItem.parentItem,t.isNullOrUndefined(i.previousParentItem)||(d[i.previousItemIndex].parentItem.childRecords.splice(i.childIndex,0,o._draggedRecord),d[i.previousItemIndex].parentItem.hasChildRecords=!0,d[i.previousItemIndex].parentItem.hasFilteredChildRecords=!0,d[i.previousItemIndex].parentItem.expanded=!0),d[i.previousItemIndex].level=i.previousLevel),l.parentIdMapping&&(d[i.previousItemIndex][l.parentIdMapping]=i.previousItem[l.parentIdMapping],d[i.previousItemIndex].item[l.parentIdMapping]=i.previousItem[l.parentIdMapping]),t.isNullOrUndefined(i.previousItem.parentItem)||(i.previousItem.parentItem.hasChildRecords=i.parentChildState,i.previousItem.parentItem.expanded=i.parentExpandedState,l.childMapping&&i.previousItem.parentItem.item[o.model.childMapping]&&i.previousItem.parentItem.item[o.model.childMapping].splice(i.childIndex,0,i.previousItem.item)),l.isFromGantt&&(d[i.previousTargetItemIndex]=i.previousTarget,1==i.previousTarget.isAutoSchedule?(i.previousTarget.startDate=i.previousTarget.item[i.model.startDateMapping]=new Date(i.clonedTarget.startDate),i.previousTarget.endDate=new Date(i.clonedTarget.endDate),i.previousTarget.duration=i.clonedTarget.duration,i.previousTarget.status=i.clonedTarget.status,i.model.endDateMapping&&(i.previousTarget.item[i.model.endDateMapping]=new Date(i.clonedTarget.endDate)),i.model.progressMapping&&(i.previousTarget.item[i.model.progressMapping]=i.clonedTarget.status),i.model.durationMapping&&(i.previousTarget.item[i.model.durationMapping]=i.clonedTarget.duration),i.previousTarget.expanded=i.clonedTarget.expanded,e("#"+o._id.replace("ejTreeGrid","")).data("ejGantt")._updateTargetGanttRecord(i.previousTarget)):(i.previousTarget.manualStartDate=new Date(i.clonedTarget.manualStartDate),i.previousTarget.manualEndDate=new Date(i.clonedTarget.manualEndDate),i.previousTarget.manualDuration=i.clonedTarget.manualDuration,i.previousTarget.status=i.clonedTarget.status,i.model.progressMapping&&(i.previousTarget.item[i.model.progressMapping]=i.clonedTarget.status),i.previousTarget.expanded=i.clonedTarget.expanded,e("#"+o._id.replace("ejTreeGrid","")).data("ejGantt")._updateGanttRecord(i.previousTarget))),l.enableWBS){(n=o._draggedRecord).parentItem?r=n.parentItem.childRecords:r=l.flatRecords.filter(function(e){return e&&0==e.level});var s=r.indexOf(n),c=r.slice(s,r.length),u=n.parentItem?n.parentItem.WBS:null,p=s+1;o.reCalculateWBS(c,p,u)}o.processBindings(i),l.currentViewData.length>0&&t.TreeGrid.updateAltRow(o,l.currentViewData[0],0,0)},_updateChildRecord:function(e,t){var i,a,r,n=this.model;if(!e.hasChildRecords)return 0;for(a=e.childRecords.length,r=0;r<a;r++)i=e.childRecords[r],t++,n.flatRecords.splice(t,0,i),n.updatedRecords.splice(t,0,i),n.isFromGantt&&n.ids.splice(t,0,i.taskId.toString()),i.hasChildRecords&&(t=this._updateChildRecord(i,t));return t},_recordLevel:function(i,a){var r,n,o=this,l=o.model,d=o._draggedRecord,s=o._droppedRecord,c=o.model.childMapping;s.hasChildRecords||(s.hasChildRecords=!0,s.hasFilteredChildRecords=!0,o._isLoadonDemand&&(s.isChildRetrieved=!0),(t.util.isNullOrUndefined(s.childRecords)||e.isEmptyObject(s.childRecords))&&(s.childRecords=[],l.parentIdMapping||(s.item[c]=[]))),o._insertAsChild&&(d.parentItem=s,s.childRecords.splice(0,0,d),r=s.childRecords,o._updateHierarchyRowIndexData(a,r,0),t.isNullOrUndefined(d)||t.isNullOrUndefined(s.item[c])||l.parentIdMapping||s.item[c].splice(0,0,d.item),d.hasChildRecords?(n=1,d.level=s.level+1,o._updateChildRecordLevel(d,n)):d.level=s.level+1,!s.expanded&&s.hasChildRecords&&l.isFromGantt&&!l.enableVirtualization&&o.updateExpandStatus(s,!0),s.expanded=!0,o._isLoadonDemand&&!s.isChildRetrieved&&(s.expanded=!1),o._parentRecords.push(s))},_updateChildRecordLevel:function(e,t){var i,a,r;if(t++,!e.hasChildRecords)return 0;for(i=e.childRecords.length,r=0;r<i;r++)(a=e.childRecords[r]).level=e.parentItem?e.parentItem.level+t:e.level+1,a.hasChildRecords&&(t--,t=this._updateChildRecordLevel(a,t));return t},_filterBarClose:function(t){var i,a=e(t.target);"click"==t.type&&a.hasClass("e-cancel")&&((i=a.prev()).focus().val(""),i.prop("checked",!1),i.trigger("keyup"),t.stopPropagation()),"focusin"==t.type&&(a=e(t.target).next(),this.getHeaderTable().find(".e-cancel").addClass("e-hide"),a.removeClass("e-hide"))},_checkIdenticalValue:function(e,t){for(var i,a=this.model.filterSettings.filteredColumns,r=a.length,n=0;n<r;n++)if(a[n].value===e&&a[n].field==t.field){i=!0;break}return i},_filterBarHandler:function(a){var r,n,o,l,d,s,c,u,p,h=this,g=h.model;if(h.model.isEdit?h.cancelEditCell():h._isRowEdit&&h.cancelRowEditCell(),h._isRefreshAddedRecord=!1,h.clearAllSelection(),r=a.target==i?e(a):e(a.target),this.model.allowFiltering){if(h.model.columns,h._cellEditingDetails,h._queryManagar.queries[0],n=r.hasClass("e-ddl")?r.find("input.e-field"):r,h._fieldName=n[0].id.replace(h._id+"_","").replace("_filterbarcell",""),this._currentFilterColumn=t.TreeGrid.getColumnByField(g.columns,h._fieldName),h._fieldName=this._currentFilterColumn.field,o=this._currentFilterColumn,r.hasClass("e-checkbox"))h._filterString=r[0].checked;else if(r.hasClass("e-ddl")){if(r=r.find("input.e-dropdownlist"),-1==(d=e("#"+r[0].id).data("ejDropDownList")).selectedIndexValue||h._checkIdenticalValue(d._selectedValue,this._currentFilterColumn))return!0;h._filterString=d._selectedValue}else if(r.hasClass("e-dropdownlist")){if(-1==(s=e("#"+r[0].id).data("ejDropDownList")).selectedIndexValue||h._checkIdenticalValue(s._selectedValue,this._currentFilterColumn))return!0;h._filterString=s._selectedValue==h._dropDownListClearText?"":s._selectedValue}else if(r.hasClass("e-numerictextbox")){if(u=null==(c=e("#"+r[0].id).data("ejNumericTextbox")).model.value?"":c.model.value.toString(),t.isNullOrUndefined(a.type)){var m=g.filterSettings.filteredColumns,_=m.length,f=!1;for(""==u&&0==_&&(f=!0),p=0;p<_;p++)if((t.isNullOrUndefined(m[p].value)?"":m[p].value.toString())==u&&m[p].field==this._currentFilterColumn.field){f=!0;break}if(f)return!0}h._filterString=r.closest("input").val()}else h._filterString=r.closest("input").val();if(("datepicker"==this._currentFilterColumn.filterEditType||"datetimepicker"==this._currentFilterColumn.filterEditType)&&""!=h._filterString&&h._filterString&&(l=o.format?h._getDateFormat(this._currentFilterColumn.format):h.model.dateFormat,h._filterString=t.isNullOrUndefined(t.parseDate(h._filterString,l,g.locale))?"":t.parseDate(h._filterString,l,g.locale)),""==h._filterString&&!g.filterSettings.filteredColumns.filter(function(e){if(e.field===h._fieldName)return!0}).length)return h._resizeFilteringElements(),!0;h._validateFilterValue(h._filterString),h._batchEditStarts&&(h._batchTempDetails.filterTarget=r),h.filterColumn(h._fieldName,this._operator,h._filterString,this._predicate),h._storePreviousFilteredValue(h._fieldName,h._filterString,this._operator),h.model.currentViewData.length>0&&h.model.enableAltRow&&t.TreeGrid.updateAltRow(h,h.model.currentViewData[0],0,0),h._cancelSaveTools()}},_validateFilterValue:function(e){var a,r,n=this;switch(this._predicate="and",this._currentFilterColumn.filterEditType){case"numericedit":this._operator=t.FilterOperators.equal;break;case"datepicker":this._operator=t.FilterOperators.equal,a=""==this._currentFilterColumn.format||this._currentFilterColumn.format==i?t.preferredCulture().calendar.patterns.d:this._currentFilterColumn.format.split(":")[1].replace("}",""),""!=this._currentFilterbarValue&&(this._currentFilterbarValue=t.format(e,a,this.model.locale));break;case"datetimepicker":this._operator=t.FilterOperators.equal,a=""==this._currentFilterColumn.format||this._currentFilterColumn.format==i?t.preferredCulture().calendar.patterns.f:this._currentFilterColumn.format.split(":")[1].replace("}",""),""!=this._currentFilterbarValue&&(this._currentFilterbarValue=t.format(e,a,this.model.locale));break;case"stringedit":this._operator=t.FilterOperators.startsWith;break;case"dropdownedit":r=this._currentFilterColumn,this._operator="dropdownedit"==r.editType&&r.editParams&&r.editParams.showCheckbox?t.FilterOperators.contains:t.FilterOperators.equal;break;case"booleanedit":1==n._filterString||"1"==n._filterString?n._filterString=!0:("false"==n._filterString||"0"==n._filterString)&&(n._filterString=!1),this._operator=t.FilterOperators.equal;break;default:this._operator=t.FilterOperators.equal}},_getStackedColumnByTarget:function(e){var i=(e.get(0)||{}).className,a=/e-row([0-9])-column([0-9])/.exec(i),r=[a[1],"stackedHeaderColumns",a[2]].join(".");return t.getObject(r,this.model.stackedHeaderRows)},_headermouseHover:function(i){var a,r,n,o;if(i.preventDefault(),(r=(a=this).model).showGridCellTooltip&&!a._dragTooltip){var l,d,s,c,u,p,h,g,m,_,f=e(i.target),w=0,C=0,T=f.closest("div.e-headercelldiv");a._headerMouseLeave(),i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(w=i.originalEvent.pageX,C=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(w=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,C=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),(s=T.clone()).find(".e-ascending").length>0?s.find(".e-ascending").remove():s.find(".e-descending").length>0&&s.find(".e-descending").remove(),s.find(".e-chkbox-wrap").remove(),s=f.closest(".e-headercell").hasClass("e-headertemplate")?s.clone():s.find("span").clone(),f.hasClass("e-stackedtooltip")&&(_=a._getStackedColumnByTarget(f),t.isNullOrUndefined(_.tooltip)||"#"===_.tooltip.slice(0,1)?s=e(_.tooltip).clone().html():s=_.tooltip),l=t.buildTag("table.e-tooltiptable e-zerospace","",{padding:"0"}),d=t.buildTag("tbody",s,{},{}),l.append(d),o=e(s).text().replace(/[ \t\r]+/g,"").length>0,d&&(m=f.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),(g=this.getColumnByField(m))&&(t.isNullOrUndefined(g.headerTooltip)||""==g.headerTooltip)&&r.showGridCellTooltip&&o||f.hasClass("e-stackedtooltip")?(a._headerMouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#headertooltip"+a._id,l,{top:C+10+"px",left:w+15+"px",position:"absolute","z-index":a.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),r.cssClass&&a._headerMouseOverTooltip.addClass(r.cssClass),a._headerTooltipTimer=setTimeout(function(){e(document.body).append(a._headerMouseOverTooltip);var t=e("#"+a._id.replace("ejTreeGrid","")),i=a.getOffsetRect(t[0]);p=e(t).width()+i.left,h=e(t).height()+i.top,c=e(a._headerMouseOverTooltip).width(),u=e(a._headerMouseOverTooltip).height(),w+c+15>=p&&(w=w-c-15),C+u+10>=h&&(C=C-u-10),e(a._headerMouseOverTooltip).css({top:C,left:w})},700)):g&&!t.isNullOrUndefined(g.headerTooltip)&&""!=g.headerTooltip&&((n={}).column=g,a._createColumnTooltipTemplate(g.headerTooltip),a._headerMouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#headertooltip"+a._id,"",{top:C+10+"px",left:w+15+"px",position:"absolute","z-index":a.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),r.cssClass&&a._headerMouseOverTooltip.addClass(r.cssClass),d=t.buildTag("tbody",e.render[a._id+"columnTooltipTemplate"](n),{},{}),a._headerMouseOverTooltip[0].innerHTML="<table>"+d[0].innerHTML+"</table>",(o=e(d).text().replace(/[ \t\r]+/g,"").length>0)&&(a._headerTooltipTimer=setTimeout(function(){var t,i;e(document.body).append(a._headerMouseOverTooltip),r.isFromGantt?(t=e("#"+a._id.replace("ejTreeGrid","")),i=a.getOffsetRect(t[0]),p=e(t).width()+i.left,h=e(t).height()+i.top):(i=a.getOffsetRect(a.element[0]),p=e(a.element).width()+i.left,h=e(a.element).height()+i.top),c=e(a._headerMouseOverTooltip).width(),u=e(a._headerMouseOverTooltip).height(),w+c+15>=p&&(w=w-c-15),C+u+10>=h&&(C=C-u-10),e(a._headerMouseOverTooltip).css({top:C,left:w})},700))))}},_mouseHover:function(i){var a,r,n,o,l=this,d=l.model;if(d.showGridCellTooltip&&1!=this._dragMouseDown){var s,c,u,p,h,g,m,_,f=e(i.target),w=0,C=0,T=(l.getRows(),f.closest("tr")),x=f.closest("td.e-rowcell"),v=this.getIndexByRow(T),b=d.currentViewData[v],S=d.columns;T.hasClass("e-footersummaryrow")&&(v=l._getFooterRows().index(T),b=l._footerSummaryRecord[v]),(v>=0||T.hasClass("e-footersummaryrow"))&&(a=l.getCellIndex(i),l._cellMouseLeave(),_=S[a],i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(w=i.originalEvent.pageX,C=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(w=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,C=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),(b||T.hasClass("e-footersummaryrow"))&&(a!=d.treeColumnIndex?((r=x.clone()).find(".e-chkbox-wrap").remove(),u=r.children().length?r.children().clone():r.clone()):x.find(".e-cell").length>0?(u=x.find(".e-cell").clone()).find(".e-chkbox-wrap").remove():x.hasClass("e-summaryrowcell")&&(x.find(".e-summarytitle").length>0?u=x.find(".e-summarytitle").clone():(u=x.clone(),e(u).css({cssText:"padding-left: 0px;"}))),u&&u.addClass("e-treegrid-textWrap"),s=t.buildTag("table.e-tooltiptable e-zerospace","",{padding:"0"}),(!d.showGridExpandCellTooltip||d.showGridExpandCellTooltip&&a==l.model.treeColumnIndex)&&(c=t.buildTag("tbody",u,{},{})),s.append(c),o=e(u).text().replace(/[ \t\r]+/g,"").length>0,c&&0==e(x).find("#"+l._id+"EditForm").length&&!l._isCommandColumn(_)&&(!d.cellTooltipTemplate&&(t.isNullOrUndefined(_.tooltip)||""==_.tooltip)||d.cellTooltipTemplate&&!t.isNullOrUndefined(_.tooltip)&&""==_.tooltip?(!d.showGridExpandCellTooltip&&o||d.showGridExpandCellTooltip&&o)&&(e("#"+this._id+"detailscellwrapper").length>0?110:5,l._mouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+l._id,s,{top:C+10+"px",left:"auto",position:"absolute","z-index":l.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),d.cssClass&&l._mouseOverTooltip.addClass(d.cssClass),l._tooltipTimer=setTimeout(function(){var t,i;e(document.body).append(l._mouseOverTooltip),d.isFromGantt?(t=e("#"+l._id.replace("ejTreeGrid","")),i=l.getOffsetRect(t[0]),g=e(t).width()+i.left,m=e(t).height()+i.top):(i=l.getOffsetRect(l.element[0]),g=e(l.element).width()+i.left,m=e(l.element).height()+i.top),p=e(l._mouseOverTooltip).width(),h=e(l._mouseOverTooltip).height();var a=e(window).width(),r=i.left+w,n=a-(i.left+w);w+p+15>=g&&r>n&&((w=g-p-15)<0&&(w=i.left)),C+h+10>=m&&(C=C-h-10),e(l._mouseOverTooltip).css({top:C,left:w})},700)):(d.cellTooltipTemplate||!t.isNullOrUndefined(_.tooltip)&&""!=_.tooltip)&&(e("#"+this._id+"detailscellwrapper").length>0?110:5,(n={}).record=b,n.column=S[a],t.isNullOrUndefined(_.tooltip)||l._createColumnTooltipTemplate(_.tooltip),l._mouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+l._id,"",{top:C+10+"px",left:w+15+"px",position:"absolute","z-index":l.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),d.cssClass&&l._mouseOverTooltip.addClass(d.cssClass),l.tooltipState="Template",c=t.isNullOrUndefined(_.tooltip)?t.buildTag("tbody",e.render[l._id+"tooltipTemplate"](n),{},{}):t.buildTag("tbody",e.render[l._id+"columnTooltipTemplate"](n),{},{}),l._mouseOverTooltip[0].innerHTML="<table>"+c[0].innerHTML+"</table>",(o=e(c).text().replace(/[ \t\r\n]+/g,"").length>0)&&(l._tooltipTimer=setTimeout(function(){var t,i;e(document.body).append(l._mouseOverTooltip),d.isFromGantt?(t=e("#"+l._id.replace("ejTreeGrid","")),i=l.getOffsetRect(t[0]),g=e(t).width()+i.left,m=e(t).height()+i.top):(i=l.getOffsetRect(l.element[0]),g=e(l.element).width()+i.left,m=e(l.element).height()+i.top),p=e(l._mouseOverTooltip).width(),h=e(l._mouseOverTooltip).height(),w+p+15>=g&&(w=w-p-15),C+h+10>=m&&(C=C-h-10),e(l._mouseOverTooltip).css({top:C,left:w})},700))))))}},_cellMouseLeave:function(){var t=this;null!=t._mouseOverTooltip&&(e("#tooltipgantt").remove(),window.clearTimeout(t._tooltipTimer),e(t._mouseOverTooltip).remove())},_headerMouseLeave:function(){var t=this;null!=t._headerMouseOverTooltip&&(e("#headertooltip").remove(),window.clearTimeout(t._headerTooltipTimer),e(t._headerMouseOverTooltip).remove())},disableTooltip:function(){this._cellMouseLeave(),this._headerMouseLeave()},_createTooltipTemplate:function(){var t,i=this,a=(i.model.columnHeaderTexts,{}),r=i.model.cellTooltipTemplate,n=null;a["_"+i._id+"getTaskName"]=i._tooltipTaskName,e.views.helpers(a),r?n=document.getElementById(r)?e("#"+r)[0].innerHTML:r:(n="<tr class='e-tooltip_rowcell'>",n+="{{if ~_"+i._id+"getTaskName()}}<td class='e-tooltiptaskname' style='height:auto;width:auto;font-weight:normal;'>{{:ttiptaskname}}</td>{{/if}}",n+="</tr>"),(t={})[i._id+"tooltipTemplate"]=n,e.templates(t)},_tooltipTaskName:function(){return this.data.ttiptaskname},_createColumnTooltipTemplate:function(t){var i,a=null;t&&(a=document.getElementById(t)?e("#"+t)[0].innerHTML:"#"===t.slice(0,1)&&document.getElementById(t.slice(1,t.length))?e(t)[0].innerHTML:t),(i={})[this._id+"columnTooltipTemplate"]=a,e.templates(i)},getMaxZIndex:function(){var e,t,i,a=document.getElementsByTagName("div"),r=0,n=a.length;if(0==this._maxZIndex){for(e=0;e<n;e++)t=a[e].style.zIndex,(i=parseInt(t))>r&&"auto"!=t&&!isNaN(i)&&(r=i);this._maxZIndex=r}return this._maxZIndex},_onScroll:function(a){var r,n=this,o=this.model;if(n._popupHide(),n._clearContextMenu(),e("#"+this._id+"detailscellwrapper").length>0&&this._removeDetailsRow(),n.model.showGridCellTooltip&&(n._cellMouseLeave(),n._headerMouseLeave()),o.isFromGantt||!n._dragTooltip||n._timerDragDown||n._timerDragUp)if(n.isVScroll()||n.model.isFromGantt||"wheel"!==a.source){if(a.scrollLeft!=i&&(n._scrollLeft=a.scrollLeft,r=Math.abs(n._scrollLeft-n._prevScrollLeft)),a.scrollTop!=i&&(n._scrollTop=a.scrollTop,Math.abs(n._scrollTop-n._preVScrollTop)),r&&(n._updateHeaderScrollLeft(n._scrollLeft),n._prevScrollLeft=n._scrollLeft),a.scrollTop!=i){if(n.model.isEdit?(n.cancelEditCell(),n._focusTreeGridElement()):n._isRowEdit&&(n.cancelRowEditCell(),n._focusTreeGridElement()),n._vScrollDist=Math.abs(n._scrollTop-n._prevScrollTop),n._preVScrollTop=n._scrollTop,n.model.enableVirtualization){if(n._vScrollDir=n._prevScrollTop<=n._scrollTop?1:-1,o.allowPaging&&!n.model.sizeSettings.height)return;n._vScrollDist&&n._scrollTop!=n._prevScrollTop&&(n._updateCurrentViewData(t.TreeGrid.Actions.Scroll),n._prevScrollTop=n._scrollTop)}n._scrollTop=a.scrollTop,this._frozenColumnsLength&&n.getContent().find("#e-frozencontainer"+n._id).scrollTop(n._scrollTop),n._vScrollDist=0}}else a.cancel=!0;else a.cancel=!0},editFormValidate:function(){var t,i,a,r=this.model.editSettings;return!e.isFunction(e.validator)||(this._frozenColumnsLength>0?(t=this.element.find(".e-treegridform"),this.setValidation(),t.length>1?(i=t.eq(0).validate().form(),a=t.eq(1).validate().form(),!(!i||!a)):!(t.length>0)||t.validate().form()):e("#"+this._id+"EditFormDialog").length>0?("dialogEditing"==r.editMode||"batchediting"==r.editMode.toLowerCase()&&"dialog"==r.batchEditSettings.editMode.toLowerCase())&&!e("#"+this._id+"_dialogEdit").ejDialog("isOpen")||(this.setValidation(),e("#"+this._id+"EditFormDialog").validate().form()):!(e("#"+this._id+"EditForm").length>0)||(this.setValidation(),e("#"+this._id+"EditForm").validate().form()))},_checkModfiedCellValue:function(i,a,r){var n,o,l,d=this.model,s=!1;return"datepicker"==r.editType||"datetimepicker"==r.editType?i instanceof Date&&a instanceof Date?"datepicker"==r.editType?(n=new Date(i),o=new Date(a),n.setHours(0,0,0,0)!=o.setHours(0,0,0,0)&&(s=!0)):i.getTime()!=a.getTime()&&(s=!0):i!==a&&(s=!0):"dropdownedit"==r.editType?i!==a&&(s=!0):(i=t.isNullOrUndefined(i)?"":i,a=t.isNullOrUndefined(a)?"":a,d.isFromGantt&&"duration"==r.field&&((l=a.match(/(\d*\.*\d+|[A-z]+)/g))&&l.length<=2&&(a=parseFloat(l[0]))),i instanceof Array&&a instanceof Array?e.each(i,function(t,i){-1==e.inArray(i,a)&&(s=!0)}):i.toString()!==a.toString()&&(s=!0)),s},saveRow:function(){var i,a,r,n,o,l,d,s,c,u=this,p=u.model,h=p.editSettings.editMode.toLowerCase();if(u.model.editSettings.allowEditing&&("dialogediting"==h||"batchediting"==h&&"dialog"==p.editSettings.batchEditSettings.editMode)?(i=e("#"+u._id+"EditFormDialog"),a=u._currentEditRecordDialogIndex,r=!0):(i=e("#"+u._id+"EditForm"),a=this.getIndexByRow(i.closest("tr"))),i&&!u.editFormValidate())return!0;var g,m=e("#"+u._id+"EditFrozenForm"),_=(m.add(i).find("td"),i.closest("tr").hasClass("e-addedrow")),f=p.columns,w=f.length,C=p.currentViewData[a],T={},x=t.copyObject({},C.item),v=!0,b=!1;if(u._focusTreeGridElement(),!(i.length<=0)||-1!=a){for(o=0;o<w;o++)if(!(""==(d=(l=f[o]).field)||u._checkboxSelection&&l.nonColumn)&&(l.visible||("dialogEditing"==p.editSettings.editMode||"batchediting"==u.model.editSettings.editMode.toLowerCase()&&"dialog"==p.editSettings.batchEditSettings.editMode.toLowerCase())&&!t.isNullOrUndefined(p.editSettings.dialogEditorTemplateID)&&""!=p.editSettings.dialogEditorTemplateID)){if(n=t.isNullOrUndefined(l.editType)?"stringedit":l.editType,g=u.getCurrentEditCellDataForRowEdit(d,n,o),g=t.isNullOrUndefined(g)||l.editType==t.TreeGrid.EditingType.Numeric&&isNaN(g)?null:g,p.idMapping&&p.parentIdMapping&&d==p.idMapping&&u._validateIdValue(g)&&(g=C[d]),!u._checkModfiedCellValue(t.getObject(d,x),g,l))continue;-1!=d.indexOf(".")?t.createObject(d,g,x):x[d]=g,b=!0,"batchediting"!=h||_||(u._createBatchEditedFields(C,d,g,l),u._batchEditStarts=!0,u._updateBatchChanges(C))}if(_){if(u._isEmptyRow=u._checkIsEmptyRow(x),T.rowIndex=u.selectedRowIndex(),T.previousValue=C.item,T.requestType="addNewRow",T.addedRow=u._isEmptyRow?null:x,T.rowElement=i.closest("tr"),!u._isEmptyRow){if("batchediting"==h)u.batchChanges.added.push(C),u._batchEditStarts=!0;else if(u._trigger("actionComplete",T))return!0;t.copyObject(C,x),t.copyObject(C.item,x),v=u._updateAction(T),p.idMapping&&p.parentIdMapping&&u._updateLastInsertedId(C[p.idMapping])}}else if(T.requestType="update",T.rowIndex=u.getUpdatedRecords().indexOf(C),T.currentValue=x,T.previousValue=C.item,r){if(T.element=e("#"+u._id+"_dialogEdit"),u._isRemoteData||(b=!0),b&&u._trigger("actionBegin",T))return!0;for(v=u._updateAction(T),p.idMapping&&p.parentIdMapping&&u._updateLastInsertedId(T.currentValue[p.idMapping]),s=0;s<f.length;s++)(f[s].editType==t.TreeGrid.EditingType.Dropdown||f[s].editType==t.TreeGrid.EditingType.DatePicker||f[s].editType==t.TreeGrid.EditingType.DateTimePicker)&&((c=e("#"+u._id+u._getFieldValue(f[s].field))).data("ejWidgets")&&c[c.data("ejWidgets")[0]]("destroy"))}else T.rowElement=i.add(m).closest("tr"),(b||!u._isRemoteData)&&(b&&"batchediting"==h||"batchediting"!=h&&!u._trigger("endEdit",T))&&(v=u._updateAction(T),p.idMapping&&p.parentIdMapping&&u._updateLastInsertedId(T.currentValue[p.idMapping]));v&&u._refreshAfterSaveRow(T,!0)}},_refreshAfterSaveRow:function(i,a){var r,n,o,l,d,s,c,u=this,p=u.model,h=p.columns,g=u.getUpdatedRecords()[i.rowIndex],m=p.currentViewData.indexOf(g);u._isEmptyRow&&"addNewRow"==i.requestType?(r=!1,p.editSettings.allowDeleting||(r=!0,p.editSettings.allowDeleting=!0),u.deleteRow(null,!0,null),u._isEmptyRow=!1,u._isEmptyRowDeleted=!0,r&&(p.editSettings.allowDeleting=!1)):(t.TreeGrid.refreshRow(u,m),"addNewRow"==i.requestType&&g.parentItem&&1==g.parentItem.childRecords.length&&t.TreeGrid.refreshRow(u,p.currentViewData.indexOf(g.parentItem)),p.showSummaryRow&&(i.editType="rowedit","addNewRow"==i.requestType&&"child"==p.editSettings.rowPosition&&u._createAndRenderSummaryRecords(i),u._updateSummaryRow(i)),p.showTotalSummary&&(i.editType="rowedit",u._updateTotalSummaryRow(i)),a&&"dialogEditing"==p.editSettings.editMode&&((n={}).data=g,n.item=g.item,n.requestType="recordUpdate",u._trigger("actionComplete",n),p.idMapping&&p.parentIdMapping&&u._updateLastInsertedId(n.item[p.idMapping]))),u._isRowEdit=!1,p.currentViewData.length>0&&p.enableAltRow&&!p.enableVirtualization&&t.TreeGrid.updateAltRow(u,p.currentViewData[0],0,0),u._cancelSaveTools(),o=h.filter(function(e){if("dropdownedit"==e.filterEditType&&"dropdownedit"!=e.editType)return!0}),p.allowFiltering&&o.length&&u._resizeFilteringElements(),u._commandColumnLength>0&&(l=t.TreeGrid.getRowByIndex(u,u.getUpdatedRecords().indexOf(g)),u._refreshUnboundTemplate(l),"addNewRow"==i.requestType&&p.editSettings.rowPosition==t.TreeGrid.RowPosition.Child&&(d=t.TreeGrid.getRowByIndex(u,u.getUpdatedRecords().indexOf(g.parentItem)),u._refreshUnboundTemplate(d))),p.allowTextWrap&&u._$frozenTableContent.length>0?(u._updateRowHeight(m),u._updateGridContentHeight(),u.getScrollElement().ejScroller("refresh"),s=u.getScrollElement().ejScroller("model.scrollTop"),u._getFrozenScrollElement().scrollTop(s),u.model.enableVirtualization&&u.updateHeight()):p.allowTextWrap&&(p.allowPaging&&!p.sizeSettings.height?u.updateHeight():u.getScrollElement().ejScroller("refresh")),p.allowTextWrap&&0==u._$frozenTableContent.length&&(c=u._getViewPortHeight(),u._$gridContainer.css({height:c+"px"}),e("#"+u._id+"e-gridcontent").css("height",c),u.getScrollElement().ejScroller("refresh"))},_updateAction:function(i){var a,r,n,o,l,d,s=this,c=s.model,u=c.idMapping,p="dragAndDrop"==i.requestType?i.draggedRowIndex:i.rowIndex,h=s.getUpdatedRecords()[p],g=!1,m={added:[],changed:[],deleted:[]};if(s._isRemoteData&&(r=c.selectionSettings.selectionType,n=s._dataManager.dataSource.batchUrl,t.isNullOrUndefined(n)&&"multiple"!=r&&"checkbox"!=r||(g=!0)),"addNewRow"==i.requestType)s._isRemoteData&&(g?m.added.push(i.addedRow):a=s._dataManager.insert(i.addedRow,s.model.query));else if("update"==i.requestType)s._isRemoteData?g?m.changed.push(i.currentValue):a=this._dataManager.update(u,i.currentValue,s.model.query):(t.copyObject(h,i.currentValue),t.copyObject(h.item,i.currentValue));else if("dragAndDrop"==i.requestType){if(s._isRemoteData)if(g)for(o=i.draggedRecords,l=0;l<o.length;l++)m.changed.push(o[l].item);else a=this._dataManager.update(u,h.item,s.model.query)}else"saveCellValue"==i.requestType?(d=i.data.item,s._isRemoteData&&e.isPlainObject(d)&&(g?m.changed.push(d):a=s._dataManager.update(u,d,s.model.query))):i.requestType==t.TreeGrid.Actions.Delete&&s._isRemoteData&&(g?m.deleted=s._getParentChildItem(i.deletedItems):(d=i.data.item,a=s._dataManager.remove(u,d[u],this.model.query)));return g&&(a=s._dataManager.saveChanges(m,u,this.model.query._fromTable,this.model.query)),a&&e.isFunction(a.promise)&&!s._dataManager.dataSource.offline&&(s._waitingPopupObj.show(),a.done(function(a){if(i.requestType==t.TreeGrid.Actions.Delete)s._updateDeleteAction(i),s._cancelSaveTools();else if("addNewRow"==i.requestType||"update"==i.requestType){var r="addNewRow"==i.requestType?i.addedRow:i.currentValue;t.isNullOrUndefined(a)||t.isNullOrUndefined(a.record)||!e.isPlainObject(a.record)||t.copyObject(r,a.record),t.copyObject(h,r),t.copyObject(h.item,r),s._refreshAfterSaveRow(i,!0)}else"saveCellValue"==i.requestType&&s._refreshAfterSaveCell(i,!0);s._waitingPopupObj.hide()}),a.fail(function(e){if(i.error=e&&e.error?e.error:e,"update"==i.requestType)s._refreshAfterSaveRow(i,!0);else if("addNewRow"==i.requestType){var a=s.getUpdatedRecords().indexOf(h);s._isEmptyRow=!0,s.deleteRow(null,!0,a),s._isEmptyRow=!1}else"saveCellValue"==i.requestType&&(i.data[i.columnName]=i.previousValue,i.data.item[i.columnObject.field]=i.previousValue,s.selectRows(s.selectedRowIndex()),t.TreeGrid.refreshRow(s,c.currentViewData.indexOf(i.data)));s._waitingPopupObj.hide(),s._trigger("actionFailure",i)})),!s._isRemoteData},_getParentChildItem:function(e,i){for(var a,r=e.length,n=(i=t.isNullOrUndefined(i)?[]:i,0);n<r;n++)a=e[n],-1==i.indexOf(a.item)&&i.push(a.item),a.hasChildRecords&&this._getParentChildItem(a.childRecords,i);return i},_excludeDetailRows:function(){var t=e(),i=this.model;return this.getTreeGridRows()&&this.getTreeGridRows().length>0&&(t=i.showDetailsRow&&i.detailsTemplate?this._frozenColumnsLength>0?[e(this.getTreeGridRows()[0]).not(".e-detailsrow"),e(this.getTreeGridRows()[1]).not(".e-detailsrow")]:e(this.getTreeGridRows()).not(".e-detailsrow"):this._frozenColumnsLength>0?[e(this.getTreeGridRows()[0]),e(this.getTreeGridRows()[1])]:e(this.getTreeGridRows())),t},getIndexByRow:function(t){var i=this._excludeDetailRows(),a=-1;return this._frozenColumnsLength>0?(-1==(a=e(i[0]).index(t))&&(a=e(i[1]).index(t)),a):i.index(t)},getTreeGridRows:function(){return this._gridRows},_keyDown:function(i){var a,r=this;if(i.shiftKey&&-1==r._shiftKeyFirstElementDetails.firstElementRowIndex)r._shiftKeyFirstElementDetails.firstElementRowIndex=r._focusingRowIndex,r._shiftKeyFirstElementDetails.firstElementCellIndex=r._cellIndex;else if(13==i.which&&null!=this._excelFilter&&!t.isNullOrUndefined(this._excelFilter._openedFltr)&&this._excelFilter._openedFltr.length&&this._excelFilter._openedFltr.is(":visible"))a=this._id+this._excelFilter._$colType,this._excelFilter._openedFltr.hasClass("e-dlgcustom")&&(a+="Custom"),this._excelFilter._openedFltr.find("#"+a+"_OkBtn").trigger("click");else{if(13===i.which&&e(i.target).hasClass("e-searchinput")&&e(i.target).closest("#"+r._id+"_toolbarItems"))return this._toolbarOperation(this._id+"_search",i.currentTarget),i.preventDefault(),!1;if("click"==i.type&&e(i.target).hasClass("e-searchitem"))return this._toolbarOperation(this._id+"_search",e(i.currentTarget).prev()[0].firstChild),i.preventDefault(),!1}},_focusTreeGridElement:function(){if("msie"==t.browserInfo().name)try{this.element[0].setActive()}catch(e){}else{var i=e(window).scrollTop();this.element[0].focus(),e(window).scrollTop(i)}},_onRecordClick:function(e){this._recordClickAction(e,"recordClick")},_onRecordDoubleClick:function(e){this._recordClickAction(e,"recordDoubleClick")},_recordClickAction:function(i,a){var r,n=this,o=e(i.target),l=n.model,d=o.closest("td"),s={},c=o.closest("tr");!(o.hasClass("e-rowcell")||o.parent().hasClass("e-rowcell")||o.closest("td").hasClass("e-rowcell")||o.closest("td").hasClass("e-rowcell")&&o.hasClass("e-cell"))||0!=c.find(".e-editedcell").length||c.hasClass("e-summaryrow")||d.hasClass("e-unboundcell")||(s.cell=d,s.cellIndex=n.getCellIndex(i),s.row=c,s.rowIndex=n.getIndexByRow(s.row),s.data=n.model.currentViewData[s.rowIndex],r=l.columns[s.cellIndex],s.columnName=r.headerText,s.cellValue=t.isNullOrUndefined(s.data)?"":s.data[r.field],s.targetElement=o,n._trigger(a,s))},_addRemoveAnimateClass:function(t){this._$gridContentTable&&this._$gridContentTable.find(".e-treegrid-animate").removeClass("e-treegrid-animate"),this._$gridHeaderContainer&&this._$gridHeaderContainer.find(".e-treegrid-animate").removeClass("e-treegrid-animate"),e(t).addClass("e-treegrid-animate")},_onClick:function(i){var a,r,n,o,l,d,s,c,u,p=this,h=p.model,g=e(i.target),m={},_=g.closest(".e-treegrid").attr("id"),f=p.getUpdatedRecords();if(g.closest(".e-treegrid").attr("id")!==this._id)return!1;if(p._clearContextMenu(),this._removeDetailsRow(i),h.allowDragAndDrop&&window.clearTimeout(p._dragTooltipTimer),h.allowColumnReordering&&(window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null),p._cellIndex=p.getCellIndex(i),g.hasClass("e-filtertext")||g.hasClass("e-cancel")||p.getHeaderTable().find(".e-cancel").addClass("e-hide"),"cell"==h.selectionSettings.selectionMode&&"dialogEditing"!=h.editSettings.editMode&&(h.editSettings.editMode="cellEditing"),r=p.getRowIndex(i),("click"==h.editSettings.beginEditAction||g.hasClass("e-treegridexpand")||g.hasClass("e-treegridcollapse"))&&0==g.closest(".e-scrollbar").length&&0==g.closest(".e-toolbaricons").length&&0==g.closest(".e-treegridtoolbaritem").length&&(("cellediting"==h.editSettings.editMode.toLowerCase()||"batchediting"==h.editSettings.editMode.toLowerCase()&&"cell"==h.editSettings.batchEditSettings.editMode.toLowerCase())&&(p._cellEditingDetails.rowIndex=r),n=h.currentViewData&&h.currentViewData[r]),!p.model.allowSelection||"multiple"!=p.model.selectionSettings.selectionType||p.model.isFromGantt||g.hasClass("e-downtail")||(g.hasClass("e-rowselect")?g.hasClass("e-spanclicked")?p._clearMultiSelectPopup():g.addClass("e-spanclicked"):e("#"+_+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")||this._multiSelectPopup.hide()),p._saveCellHandler(i),g.hasClass("e-summarytreegridexpand")||g.hasClass("e-summarytreegridcollapse"))return m.expanded=!g.hasClass("e-summarytreegridexpand"),p._isInManualExpandCollapse=!0,p.expandCollapseTotalSummary(m.expanded),p._isInManualExpandCollapse=!1,void p._addRemoveAnimateClass(g);if(!g.hasClass("e-summaryrowcell")&&!g.hasClass("e-footersummaryrowcell")&&!g.hasClass("e-summarytitle")){if((g.hasClass("e-treegridexpand")||g.hasClass("e-treegridcollapse"))&&-1!=r&&p.editFormValidate()){var w=g.closest("tr"),C=f.indexOf(n);m={};g.removeClass("e-treegrid-animate"),m.data=T,m.data=n,m.recordIndex=C,m.expanded=!w.hasClass("e-treegridrowexpand"),0!=e("#"+p._id+"EditForm").length||!g.hasClass("e-rowcell")&&g.closest(".e-rowcell").hasClass("e-templatecell")?p._cancelEditState():p._focusTreeGridElement(),(m.expanded?p._trigger("expanding",m):p._trigger("collapsing",m))||h.isFromGantt||(p._isRefreshAddedRecord?(m.data.expanded=m.expanded,p.updateExpandStatus(m.data,m.expanded),p.refreshContent(),p.renderRecords(),h.allowTextWrap&&p._frozenColumnsLength>0&&(p._updateRowHeight(),"auto"==h.sizeSettings.height&&p._updateContentHeight(),p.getScrollElement().ejScroller("refresh"),p._updateScrollCss()),p._isRefreshAddedRecord=!1):t.TreeGrid.sendExpandCollapseRequest(p,m)),h.allowPaging||h.enableVirtualization?(o=p.getUpdatedRecords(),(l=t.TreeGrid.getRowByIndex(this,o.indexOf(n)))&&p._addRemoveAnimateClass(e(l).find(".e-treegridcollapse,.e-treegridexpand"))):p._addRemoveAnimateClass(g)}else if(g.hasClass("e-rowcell")||g.parent().hasClass("e-rowcell")||g.closest("td").hasClass("e-rowcell")||g.parent().hasClass("e-detailsrowcell")||g.hasClass("e-detailsrowcell")||g.closest("td").hasClass("e-rowcell")&&g.hasClass("e-cell")){if(this._shiftSelectedRecord=null,e("#"+_+"_selectionpopup").is(":visible")&&(e("#"+_+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")?(i.ctrlKey=!0,h.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row&&(p._multiSelectCtrlRequest=!0)):(i.ctrlKey=!1,p._multiSelectCtrlRequest=!1)),h.isFromGantt&&p._ganttTouchTrigger&&(m={target:g,ctrlKey:i.ctrlKey},p._trigger("getCtrlRequestValue",m),i.ctrlKey=m.ctrlKey),0==e("#"+p._id+"EditForm").length&&(g.hasClass("e-rowcell")||!g.closest(".e-rowcell").hasClass("e-templatecell"))&&p._focusTreeGridElement(),a=p.getIndexByRow(g.closest("tr")),h.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row){if(p._checkboxSelection&&(0==e("#"+p._id+"EditForm").length||"click"==h.editSettings.beginEditAction)&&p.editFormValidate()){var T=p.model.currentViewData[a],x=(C=f.indexOf(T),!1);g.hasClass("e-checkbox")&&(x=!0),-1==C||p._rowSelectingEventTrigger(this.selectedRowIndex(),C,x,i.type)||(p.selectRows(C,null,x),p._cancelSaveTools(),p._rowSelectedEventTrigger(C,null,x,i.type))}h.selectionSettings.selectionType==t.TreeGrid.SelectionType.Multiple&&(p._multiSelectCtrlRequest=!!i.ctrlKey,i.shiftKey&&1==h.allowSelection&&(a=p.getIndexByRow(g.closest("tr")),T=h.currentViewData[a],a=f.indexOf(T),p._multiSelectShiftRequest=!0,p._rowSelectingEventTrigger(this.selectedRowIndex(),a,!1,i.type)||(p.getRows()&&null!=p._prevSelectedItem?p.getExpandStatus(p._prevSelectedItem)?p.selectRows(f.indexOf(p._prevSelectedItem),a):p.selectRows(a):p.getRows()&&null==p._prevSelectedItem&&p.selectRows(0,a),p._cancelSaveTools(),h.isFromGantt&&i.shiftKey?p._rowSelectedEventTrigger(a,t.isNullOrUndefined(p._prevSelectedItem)?0:h.updatedRecords.indexOf(p._prevSelectedItem)):p._rowSelectedEventTrigger(a,null,!1,i.type)))),p._checkboxSelection||p._multiSelectShiftRequest||0!=e("#"+p._id+"EditForm").length||-1!=r&&(T=h.currentViewData[r],a=f.indexOf(T),h.allowSelection&&!p._rowSelectingEventTrigger(this.selectedRowIndex(),a,!1,i.type)&&(p.selectRows(a),p._cancelSaveTools(),p._rowSelectedEventTrigger(a,null,!1,i.type))),p._multiSelectShiftRequest=!1}if(h.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Cell&&0==e("#"+p._id+"EditForm").length&&-1!=p._cellIndex&&-1!=a&&h.allowSelection){d=p._cellIndex>=p._frozenColumnsLength?1:0,s=p._frozenColumnsLength>0?p.getRows()[d][a]:p.getRows()[a];var v,b=h.columns,S=(T=h.currentViewData&&h.currentViewData[a],f.indexOf(T)),D=p._cellIndex>=p._frozenColumnsLength?p._cellIndex-p._frozenColumnsLength:p._cellIndex,R=s.childNodes[D],y=(p._previousSelectedCellDetails.rowIndex,p._previousSelectedCellDetails.cellIndex,e(R).closest("td"));if(p._focusingRowIndex=S,-1!=a){if(T.isSummaryRow)return;m={rowIndex:S,cellIndex:p._cellIndex,rowElement:s,cellElement:y[0]},c={rowIndex:S,cellIndex:p._cellIndex,cellElement:y[0],data:T},!p._cellSelectingEventTrigger(m)&&b[p._cellIndex].allowCellSelection&&("multiple"==h.selectionSettings.selectionType&&(i.ctrlKey||i.shiftKey)?i.ctrlKey?-1==(v="msie"==t.browserInfo().name&&t.browserInfo().version<9?p._getCellIndex(p._selectedCellDetails,"cellElement").indexOf(y[0]):p._selectedCellDetails.map(function(e){return e.cellElement}).indexOf(y[0]))?(e(y[0]).addClass("e-selectingcell"),p._selectedCellDetails.push(c),h.selectedCellIndexes.push({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),p._cellSelectedEventTrigger(m,p._previousSelectedCellDetails)):(e(y[0]).removeClass("e-selectingcell"),p._selectedCellDetails.splice(v,1),h.selectedCellIndexes.splice(v,1)):i.shiftKey&&(m={rowIndex:S,cellIndex:p._cellIndex},p._shiftKeySelectCells(m),p._rowIndexOfLastSelectedCell=S,p._focusingRowIndex=p._shiftKeyFirstElementDetails.firstElementRowIndex):(p._selectedCellDetails=[],h.selectedCellIndexes=[],e("#"+p._id).find(".e-selectingcell").removeClass("e-selectingcell"),e(y[0]).addClass("e-selectingcell"),p._selectedCellDetails.push(c),h.selectedCellIndexes.push({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),p._cellSelectedEventTrigger(m,p._previousSelectedCellDetails),p._shiftKeyFirstElementDetails={firstElementRowIndex:-1,firstElementCellIndex:-1},p._updateSecondRowIndexBy=1),i.shiftKey||(p._previousSelectedCellDetails={rowElement:s,cellElement:y[0],cellIndex:m.cellIndex,rowIndex:S},p._rowIndexOfLastSelectedCell=p._focusingRowIndex,p._isShiftKeyNavigation=!1)),i.shiftKey||(p._rowIndexOfLastSelectedCell=p._focusingRowIndex),p._cancelSaveTools(),p._lastSelectedCellIndex=p._cellIndex}}p._isTouchTrigger&&p.model.allowSelection&&"multiple"==this.model.selectionSettings.selectionType&&!p.model.isFromGantt&&(p._isTouchTrigger&&null!=this._multiSelectPopup&&!this._multiSelectPopup.is(":visible")&&this._multiSelectPopup.find(".e-rowselect").hasClass("e-spanclicked")&&this._multiSelectPopup.show(),p._isTouchTrigger&&null!=this._multiSelectPopup&&!this._multiSelectPopup.find(".e-rowselect").hasClass("e-spanclicked")&&(g.hasClass("e-detailsrowcell")||g.parent("td").hasClass("e-detailsrowcell")||g.closest("tr").hasClass("e-detailsrow")||(this._multiSelectPopup.removeAttr("style"),u=g.closest(".e-rowcell").offset(),this._multiSelectPopup.offset({top:0,left:0}).offset({left:u.left+(g.closest(".e-rowcell").outerWidth()/2-this._multiSelectPopup.width()/2),top:u.top-this._multiSelectPopup.outerHeight()-10}).show())),p._isTouchTrigger=!1)}(g.hasClass("e-detailsrowcell")||g.parent("td").hasClass("e-detailsrowcell"))&&!g.closest("tr").hasClass("e-detailsrow")&&(i.ctrlKey||i.shiftKey||(!(e("#"+this._id+"EditForm").length>0)||!!this.editFormValidate())&&(p._isRowEdit?this.saveRow():p._detailsExpandCollapse(g))),p._isRowEdit&&g.focus(),g.closest("#"+p._id+"_ColumnMenu").hasClass("e-columnmenu")||0!=g.closest("div.e-excelfilter").length||g.hasClass("e-overlay")||p._clearColumnMenu(),"click"!=h.editSettings.beginEditAction||0!=g.closest("#"+p._id+"EditForm").length||p._isShiftKeyNavigation||p._isEmptyRowDeleted||p._editdblClickHandler(i),p._isEmptyRowDeleted=!1}},_isInFilteredState:function(){return this.model.allowFiltering&&this.model.filterSettings.filteredColumns.length>0||this._searchString.length>0},selectAllRows:function(i){var a,r=this,n=r.model,o=-1,l=r._isInFilteredState()?r._flatFilteredRecords:n.flatRecords,d=(r.getUpdatedRecords(),0);if(n.selectionSettings.enableSelectAll||r._isFromSetmodel){if(n.showSummaryRow&&(l=r._spliceSummaryRows(l)),!t.isNullOrUndefined(i)){for(i||(l=r._isInFilteredState()?r._flatFilteredRecords:e.extend([],n.selectedItems)),a=0;a<l.length;a++)if(i){if("checked"==l[a].checkboxState)continue;l[a].checkboxState="checked",n.selectedItems.push(l[a]),e("#"+this._id+"_checkbox"+l[a].ejRowId).removeClass("e-stop").addClass("e-checkmark"),e("#"+this._id+"_checkbox"+l[a].ejRowId).parent("span").removeAttr("class").addClass("e-chk-act")}else(o=n.selectedItems.indexOf(l[a]))>-1&&(l[a].checkboxState="unchecked",n.selectedItems.splice(o,1),e("#"+this._id+"_checkbox"+l[a].ejRowId).removeClass("e-checkmark"),e("#"+this._id+"_checkbox"+l[a].ejRowId).parent("span").removeAttr("class").addClass("e-chk-inact"),(n.selectionSettings.enableHierarchySelection||r._isFromSetmodel)&&r._updateParentSelection(l[a]));r._cancelSaveTools()}r._isInFilteredState()&&r._flatFilteredRecords.length>0&&n.selectedItems.length>0?d=r._flatFilteredRecords.filter(function(e){return"checked"==e.checkboxState}).length:d=n.selectedItems.length,d>0&&l.length>0?d!=l.length?(e("#"+this._id+"_headerCheckbox").removeClass("e-checkmark").addClass("e-stop"),e("#"+this._id+"_headerCheckbox").parent("span").removeAttr("class").addClass("e-chk-indeter")):(e("#"+this._id+"_headerCheckbox").removeClass("e-stop").addClass("e-checkmark"),e("#"+this._id+"_headerCheckbox").parent("span").removeAttr("class").addClass("e-chk-act")):(e("#"+this._id+"_headerCheckbox").removeClass("e-stop e-checkmark"),e("#"+this._id+"_headerCheckbox").parent("span").removeAttr("class").addClass("e-chk-inact"))}},_updateSelectedItems:function(t,i){var a,r,n=this.model;r=this.getUpdatedRecords().indexOf(t),t.checkboxState=i,a=e.inArray(t,n.selectedItems),"unchecked"==t.checkboxState?(-1!=a&&n.selectedItems.splice(a,1),r>-1&&(e("#"+this._id+"_checkbox"+t.ejRowId).removeClass("e-checkmark e-stop"),e("#"+this._id+"_checkbox"+t.ejRowId).parent("span").removeAttr("class").addClass("e-chk-inact"))):"checked"==t.checkboxState&&(-1==a&&n.selectedItems.push(t),r>-1&&(e("#"+this._id+"_checkbox"+t.ejRowId).removeClass("e-stop").addClass("e-checkmark"),e("#"+this._id+"_checkbox"+t.ejRowId).parent("span").removeAttr("class").addClass("e-chk-act")))},_traverseSelection:function(e,t,i){var a,r,n=this,o=0,l=this.model;if(n._updateSelectedItems(e,t),!i&&e.parentItem&&l.selectionSettings.enableHierarchySelection&&n._updateParentSelection(e.parentItem),e.hasChildRecords&&l.selectionSettings.enableHierarchySelection)for(a=e.childRecords,n._flatFilteredRecords.length>0&&(a=a.filter(function(e){return n._flatFilteredRecords.indexOf(e)>-1})),o=a.length,r=0;r<o;r++)a[r].hasChildRecords?n._traverseSelection(a[r],t,!0):a[r].isSummaryRow||n._updateSelectedItems(a[r],t)},_updateParentSelection:function(t){var i,a=this,r=this.model,n=[];t&&t.childRecords&&(n=a._spliceSummaryRows(t.childRecords)),a._flatFilteredRecords.length>0&&r.selectionSettings.enableHierarchySelection&&(n=n.filter(function(e){return a._flatFilteredRecords.indexOf(e)>-1})),i=n&&n.length;var o=!1,l=n.filter(function(e){return"indeterminate"==e.checkboxState}),d=n.filter(function(e){return"checked"==e.checkboxState});l.length>0||d.length>0&&d.length!=i?("checked"==t.checkboxState?(this._updateSelectedItems(t,"unchecked"),o=!0):"unchecked"==t.checkboxState&&(o=!0),o&&(e("#"+this._id+"_checkbox"+t.ejRowId).addClass("e-stop"),e("#"+this._id+"_checkbox"+t.ejRowId).parent("span").removeAttr("class").addClass("e-chk-indeter"),t.checkboxState="indeterminate",t.parentItem&&this._updateParentSelection(t.parentItem))):0==d.length&&0==l.length?(e("#"+this._id+"_checkbox"+t.ejRowId).removeClass("e-stop e-checkmark").parent("span").removeClass("e-chk-indeter"),"checked"==t.checkboxState?this._updateSelectedItems(t,"unchecked"):t.checkboxState="unchecked",t.parentItem&&this._updateParentSelection(t.parentItem)):(t.checkboxState="checked",this._updateSelectedItems(t,"checked"),t.parentItem&&this._updateParentSelection(t.parentItem))},_removeInnerDetailRows:function(i,a){for(var r,n=e(".e-detailscellwrapperfly"),o=n.length,l=0;l<o;l++)if(e.contains(n[l],i[0])||i==n[l]){!0;break}r=!1,t.isNullOrUndefined(n[l])&&(l=n.index(e("#"+this._id+"detailscellwrapper")),r=!0);var d=r?"":",",s=e(n[l]).attr("parentTreeGridIds"),c=e("[parentTreeGridIds$='"+d+s+"']");c.length;this._triggerDetailRowHideEvent(c,a)},_triggerDetailRowHideEvent:function(t,i){var a,r=this.model,n=t.length,o=0;if(n>0&&e("#"+this._id+"detailscellwrapper").length>0){e("#"+this._id+"detailscellwrapper");var l=r.selectedItem,d={};if(d.rowData=l,!this._trigger("detailsHidden",d)||i)for(;o<n;o++)a=e(t[o]).attr("id").replace("detailscellwrapper",""),e("#"+a).find(".e-detailsrowexpand").removeClass("e-detailsrowexpand").addClass("e-detailsrowcollapse"),e("#"+a).find(".e-detailsinfoiconhide").removeClass("e-detailsinfoiconhide").addClass("e-detailsinfoiconshow"),e(t[o]).remove()}},_removeDetailsRow:function(i,a){var r,n,o;this.model;if(i){if(n=r=e(i.target),r.parent("td").hasClass("e-detailsrowcell")&&(n=r.parent("td")),0==r.closest(".e-popup").length&&r[0]!=e("html").get(0)){for(var l=e(".e-detailscellwrapperfly"),d=l.length,s=0,c=!1;s<d;s++)if(e.contains(l[s],r[0])||r[0]==l[s]){c=!0;break}if(r.hasClass("e-detailscellwrapperfly")||n.hasClass("e-detailsrowexpand")||n.hasClass("e-detailsrowcollapse")||c||this._removeInnerDetailRows(e("#"+this._id+"detailscellwrapper"),a),r.hasClass("e-detailscellwrapperfly")||n.hasClass("e-detailsrowcollapse")||!n.hasClass("e-detailsrowexpand")&&c){o=!1,t.isNullOrUndefined(l[s])&&(s=l.index(e("#"+this._id+"detailscellwrapper")),o=!0);var u=o?"":",",p=e(l[s]).attr("parentTreeGridIds"),h=e("[parentTreeGridIds$='"+u+p+"']");this._triggerDetailRowHideEvent(h,a)}}}else e("#"+this._id+"detailscellwrapper").length>0&&this._removeInnerDetailRows(e("#"+this._id+"detailscellwrapper")[0],a),this._triggerDetailRowHideEvent(e("#"+this._id+"detailscellwrapper"),a)},showHideDetailsRow:function(i){var a,r,n=this,o=this.model;n._saveEditedElements(),o.showDetailsRow&&o.detailsTemplate&&o.showDetailsRowInfoColumn&&!t.isNullOrUndefined(i)&&i<=o.updatedRecords.length&&n.getExpandStatus(o.updatedRecords[i])&&(i!=this.selectedRowIndex()&&-1!=i&&e.inArray(i,-1==n._selectedRowsIndexes)&&o.allowSelection&&o.updatedRecords.length>i&&(n._rowSelectingEventTrigger(this.selectedRowIndex(),i)||(n.selectRows(i),n._rowSelectedEventTrigger(i))),this.updateScrollBar(i),(a=e(t.TreeGrid.getRowByIndex(n,i))).length>0&&o.updatedRecords[i]&&n.getExpandStatus(o.updatedRecords[i])&&(r=e(a).find(".e-detailsrowcell"),e(r).length>0&&e(r).hasClass("e-detailsrowcell")&&(this.element.find(".e-detailsrowexpand")[0]!=r[0]&&this._removeDetailsRow(),this._detailsExpandCollapse(e(r)))))},_detailsExpandCollapse:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_=this,f=this.model;if(i.parent("td").hasClass("e-detailsrowcell")&&(i=i.parent("td")),(r=(a=i.closest("tr")).find(".e-detailsrowcell")).hasClass("e-detailsrowcollapse")){if(n=this.getIndexByRow(a),o=this.model.currentViewData[n],t.isNullOrUndefined(o)||o.isSummaryRow)return;for(var w=this.getOffsetRect(a[0]),C=e(e.render[_._id+"_detailRowTemplate"](o)),T=e(C).find(".e-detailscellwrapper").attr({id:this._id+"detailscellwrapper"}),x=_._gridWidth-(_.element.find(".e-scrollcss").length>0?18:0)-2,v=this.element.parents().filter(".e-detailscellwrapperfly"),b=this._id,S="";v.length>0;)b+=","+(S=v.attr("id").replace("detailscellwrapper","")),v=e("#"+S).parents().filter(".e-detailscellwrapperfly");T.attr("parentTreeGridIds",b),(l=this.getOffsetRect(_._$gridContent[0])).bottom=l.top+_._$gridContent[0].offsetHeight,s=(d=w.top+a[0].offsetHeight)+f.detailsRowHeight,(d>l.bottom||s>l.bottom)&&((c=w.top-f.detailsRowHeight)>l.top&&(d=c)),T.removeClass("e-detailscellwrapper").addClass("e-detailscellwrapperfly"),f.cssClass&&T.addClass(f.cssClass),u=_.getScrollElement().ejScroller("isHScroll")?_.getScrollElement().ejScroller("option","scrollLeft"):0,(p=_.getMaxScrollWidth())>0&&u>p&&(u=p),h=0,this._frozenColumnsLength>0&&(h=e(this.element).find("#e-frozencontentdiv"+this._id).width()),T.css({top:d,left:w.left+u-h,"z-index":_.getMaxZIndex()+1,position:"absolute",width:x}).appendTo(this.element),this._trigger("refresh"),(g={}).detailsElement=T,g.data=o,g.rowIndex=this.selectedRowIndex(),this._trigger("detailsDataBound",g),(m={}).detailsElement=T,m.data=o,m.rowIndex=this.selectedRowIndex(),m.appendTarget=null,this._trigger("detailsShown",m)?this._removeInnerDetailRows(i):(r.find(".e-detailsinfoiconshow").removeClass("e-detailsinfoiconshow").addClass("e-detailsinfoiconhide"),r.removeClass("e-detailsrowcollapse").addClass("e-detailsrowexpand"),m.appendTarget&&(e(T).css({top:"auto",left:"auto",position:"auto"}),e(T).detach().appendTo(e("#"+m.appendTarget))))}else this._removeInnerDetailRows(i)},_onHeaderClick:function(i){var a,r,n,o,l,d,s,c,u,p,h,g=this,m=g.model;if(g._cellMouseLeave(),g._headerMouseLeave(),g._clearContextMenu(),this._removeDetailsRow(),e(i.target).is(".e-ascending, .e-descending")&&(i.target=i.target.parentNode),a=e(i.target),l=!0,g.getHeaderTable().find(".e-columnheader").find(".e-headercellactive").removeClass("e-headercellactive"),g._mouseDragged&&m.allowColumnReordering&&(l=!1),g._checkboxSelection&&m.allowSelection&&m.selectionSettings.enableSelectAll&&a.hasClass("e-headerCheckbox")&&(g.selectAllRows(!a.hasClass("e-checkmark")&&!a.hasClass("e-stop")),l=!1),!a.closest(".e-headercelldiv")||a.hasClass("e-columnmenu-icon")||a.hasClass("e-column-filter-icon")||a.hasClass("e-column-filtered-icon")||(r=a.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),!l||t.isNullOrUndefined(r)&&t.isNullOrUndefined(this.getColumnByField(r))||0==this.getColumnByField(r).allowSorting?g._saveEditedElements():l&&m.allowSorting&&(o=this.getColumnByField(r),n=a.closest(".e-headercell").find("span").hasClass("e-ascending")?t.sortOrder.Descending:t.sortOrder.Ascending,m.allowMultiSorting&&i.ctrlKey&&(g._multiSortRequest=!0),g._isRefreshAddedRecord=!1,m.isFromGantt?g.sortColumn(o.mappingName?o.mappingName:o.field,n):g.sortColumn(o.field,n),g.model.isFromGantt&&this.selectedRowIndex()>=0&&((d={}).data=g.model.selectedItem,d.target="ejTreeGrid",d.recordIndex=this.selectedRowIndex(),g._trigger("rowSelected",d)))),a.hasClass("e-column-filter-icon")||a.hasClass("e-column-filtered-icon")){if(g._batchEditStarts)return g._batchSaveLostWarning("Filtering"),g._batchTempDetails.filterTarget=i,!1;if(r=a.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),o=g.getColumnByField(r),g._checkFilterType(o),a.data("isClicked"))g._clearColumnMenu(),a.data("isClicked",!1);else if("menu"==m.filterSettings.filterType&&"excel"!=o.filterType||"excel"==m.filterSettings.filterType&&"menu"==o.filterType)g._updateFilterMenuList(i),e(".e-filtericon").data("isClicked",!1),a.data("isClicked",!0);else{var _=a.offset(),f=a.offsetParent(),w=f.offset();w={top:w.top+jQuery.css(f[0],"borderTopWidth",!0),left:w.left+jQuery.css(f[0],"borderLeftWidth",!0)},s=_.left-w.left-jQuery.css(a[0],"marginLeft",!0)+18,c=_.top-w.top-jQuery.css(a[0],"marginTop",!0)+2,"relative"==a.closest(".e-headercell").css("position")&&(s=a.offset().left+15,c=a.offset().top+20);var C=a[0].offsetWidth,T=g.getOffsetRect(g.element[0]).left+g.element.width(),x=o.filterEditType?o.filterEditType:o.editType;switch(x=x.toLowerCase()){case"numericedit":x="number";break;case"stringedit":case"maskedit":case"dropdownedit":x="string";break;case"booleanedit":x="boolean";break;case"datepicker":case"datetimepicker":x=x.replace("picker","")}"excel"==m.filterSettings.filterType&&g._saveEditedElements(),e(window).width()<=g._responsiveMinWidth&&m.isResponsive&&m.enableResize?(g._renderResponsiveExcelFilter(o,x),e(".e-filtericon").data("isClicked",!1),g._mediaStatus=!0):(-1==e.inArray(x,g._excelColTypes)&&(g._clearFilterMenu(),e("#"+g._id+x+"_excelDlg").remove(),e("#"+g._id+x+"_CustomFDlg_wrapper").remove(),e("#"+g._id+x+"_CustomFDlg").remove(),g._excelFilter._openedFltr=null,g._excelColTypes.push(x),g._excelFilter.renderDialog(x)),u={True:g.localizedLabels.trueText,False:g.localizedLabels.falseText},p=[],e.grep(g.model.flatRecords,function(e){e.isSummaryRow||p.push(e.item)}),T<s+(h=e("#"+g._id+x+"_excelDlg").width())&&(s=s-h-C),g._excelFilter.openXFDialog({field:o.field,enableResponsiveRow:!0,displayName:o.headerText,dataSource:p,query:null,position:{X:s,Y:c},dimension:{height:e(window).height(),width:e(window).width()},cssClass:"resFilter",type:x,format:o.format,localizedStrings:u}),e(".e-filtericon").data("isClicked",!1),a.data("isClicked",!0),g._customFilter=null),g._filterIconTarget=i}this._addRemoveAnimateClass(a)}else a.hasClass("e-columnmenu-icon")?(a.data("isClicked")?(g._clearColumnMenu(),a.data("isClicked",!1)):(g._renderColumnMenu(i),e(".e-columnicon").data("isClicked",!1),a.data("isClicked",!0)),this._addRemoveAnimateClass(a)):g._clearColumnMenu();return!!a.hasClass("e-checkbox")||!(a.hasClass("e-columnmenu-icon")||a.hasClass("e-column-filter-icon")||a.hasClass("e-column-filtered-icon"))&&void 0},_renderResponsiveExcelFilter:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m=this,_=e.inArray(a,m._excelColTypes),f=e(window).width(),w=e(window).height();-1!=_&&(e("#"+m._id+a+"_excelDlg").remove(),m._excelColTypes.splice(_,1),m._excelFilter._openedFltr=null),m._excelFilter.renderDialog(a),r=t.buildTag("div.e-treegird-filterDialogHeaderDiv","",{width:"100%"}),n=t.buildTag("div.e-treegrid-label","<span>"+m._columnMenuTexts.menuFilter+"</span>",{"padding-top":"10px","font-weight":"bold","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"}),e(".e-filterMenuBtn").length>0&&e(".e-filterMenuBtn").remove();var C,T=t.buildTag("div.e-filterMenuBtn"),x=t.buildTag("input.e-responsiveFilterBtnLeft e-flat e-btnsub","",{"margin-left":"15px"}),v=t.buildTag("input.e-responsiveFilterBtnRight e-flat e-btncan","",{"margin-right":"12px"});r.append(n),m._excelDlg=C="#"+m._id+a+"_excelDlg",x.ejButton({text:m.localizedLabels.okButtonText,type:"button",click:function(){m._excelFilter._fltrBtnHandler(),e(C).css("display","none")}}),v.ejButton({text:m.localizedLabels.cancelButtonText,type:"button",click:function(){e(C).css("display","none"),m.element.css("display","block")}}),e(C).children().not(".e-searchcontainer").remove();var b=m._excelFilter,S=t.buildTag("div.e-treegrid-resFilterleftIcon","",{"padding-top":"10px"},{closeDialogue:C.slice(1),openDialogue:"responsiveFilter"}),D=t.buildTag("span.e-icon e-treegrid-resIcon e-treegrid-responsiveBack","",{},{closeDialogue:C.slice(1),openDialogue:"responsiveFilter"});S.click(function(t){e.proxy(m._closeDivIcon(t),this)}),r.append(S.append(D)),o=t.buildTag("div.e-treegrid-resFilterRigthIcon","",{"padding-top":"10px"},{closeDialogue:C.slice(1),gridEle:!0}),l=t.buildTag("span.e-icon e-treegrid-resIcon e-responsiveCustomFilter","",{},{closeDialogue:C.slice(1),gridEle:!0}),"boolean"!=a&&r.append(o.append(l)),(p=(d=e(C).css({height:w-20,padding:"0px",width:"99.7%"})).find(".e-searchcontainer .e-searchbox").css("margin-top","10px")).children().css("margin-top","10px"),s=d.find(".e-checkboxlist"),c=.65*w,m._checkBoxDiv=s,e(d.find(".e-searchcontainer")).addClass("e-treegrid-resultSearch"),d.find(".e-treegrid-resultSearch .e-btncontainer").remove(),x.addClass("e-treegrid-responsiveFilterBtnLeft").css({width:"43.6%"}),v.addClass("e-treegrid-responsiveFilterBtnRight").css("width","43.6%"),d.find(".e-excelLabel").remove(),u=t.buildTag("div.e-excelLabel",i.headerText,{"margin-top":"10px"}),p=d.find(".e-searchcontainer"),u.insertBefore(p.find(".e-searchbox")),d.prepend(r),d.find(".e-searchbox span").css("top","23px"),e(C).append(T.append(x).append(v)),s.ejScroller({height:c,width:"98%"}).ejScroller("refresh"),h={True:m.localizedLabels.trueText,False:m.localizedLabels.falseText},g=[],e.grep(m.model.flatRecords,function(e){e.isSummaryRow||g.push(e.item)}),m._excelFilter.openXFDialog({field:i.field,enableResponsiveRow:!0,displayName:i.headerText,dataSource:g,query:null,position:{X:0,Y:0},dimension:{height:w,width:f},cssClass:"resFilter",type:a,format:i.format,localizedStrings:h}),e(C).insertAfter(m.element),o.click(function(r){var n,o,l,d,s,c,u,p,h,g,_,S,D,R,y,I;e.proxy(m._closeDivIcon(r),this),n=w-30,b._openCustomFilter("customfilter"),o=e("#"+m._id+a+"_CustomFDlg").addClass("e-responsviesExcelFilter"),m._customFilter=o,t.isNullOrUndefined(o.find(".e-treegird-filterDialogHeaderDiv")[0])&&(l=t.buildTag("div.e-treegird-filterDialogHeaderDiv"),d=t.buildTag("div.e-treegrid-label","<span>"+b.localizedLabels.title+"</span>",{"font-weight":"bold","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"}),l.append(d),s=t.buildTag("div.e-treegrid-resFilterleftIcon","",{},{closeDialogue:m._id+a+"_CustomFDlg",openDialogue:C.slice(1)}),c=t.buildTag("span.e-icon e-treegrid-resIcon e-treegrid-responsiveBack","",{},{closeDialogue:m._id+a+"_CustomFDlg",openDialogue:C.slice(1)}),s.click(function(){o.css("display","none"),e("#"+m._id+a+"_CustomFDlg_wrapper").css("display","none");var t={True:m.localizedLabels.trueText,False:m.localizedLabels.falseText},r=[];e.grep(m.model.flatRecords,function(e){e.isSummaryRow||r.push(e.item)}),m._excelFilter.openXFDialog({field:i.field,enableResponsiveRow:!1,displayName:i.headerText,dataSource:r,query:null,position:{X:0,Y:0},dimension:{height:w,width:f},type:a,format:i.format,localizedStrings:t})}),l.append(s.append(c)),u=t.buildTag("div.e-treegrid-resFilterRigthIcon","",{},{closeDialogue:m._id+a+"_CustomFDlg",gridEle:!0}),p=t.buildTag("span.e-icon e-treegrid-resIcon e-treegrid-responsiveClose","",{},{closeDialogue:m._id+a+"_CustomFDlg",gridEle:!0}),l.append(u.append(p)),u.click(function(){o.css("display","none"),e("#"+m._id+a+"_CustomFDlg_wrapper").css("display","none"),m.element.css("display","block")}),o.prepend(l),o.insertAfter(m.element),o.find(".e-dlgfields").css("width","98%"),(h=o.find(".e-dlgfields:first").css("width","92%").css({"margin-left":"6px","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"})).css("margin-top","4%"),g=o.find(".e-dlgfields").find(".e-fieldset legend").text(),t.buildTag("div.e-responsiveLabelDiv",g,{"margin-left":"6px","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"}).insertAfter(h),_=o.find(".e-dlgfields").find(".e-fieldset").find("table").css("width","100%"),o.find(".e-dlgfields").find(".e-fieldset").replaceWith(_),_.parent("div").addClass("e-responsiveExcelFilterFieldDiv"),_.find(".e-dropdownlist"),_.find(".e-dropdownlist").each(function(t,i){var a=e(i).ejDropDownList("model.dataSource");e(i).ejDropDownList("destroy").ejDropDownList({width:"80%",dataSource:a})}),_.find(".e-autocomplete").each(function(t,i){var a=e(i).ejAutocomplete("model");e(i).ejAutocomplete("destroy").ejAutocomplete({width:"90%",dataSource:a.dataSource,fields:a.fields,enableDistinct:!0})}),_.find(".e-datepicker").each(function(t,i){e(i).ejDatePicker("instance").option("width","90%")}),_.find(".e-datetimepicker").each(function(t,i){e(i).ejDateTimePicker("instance").option("width","90%")}),_.find(".e-numerictextbox").each(function(t,i){e(i).ejNumericTextbox("instance").option("width","90%")})),S=x.clone(),D=v.clone(),S.ejButton({text:m.localizedLabels.okButtonText,type:"button",click:function(){m._excelFilter._openedFltr=o,m._excelFilter._fltrBtnHandler(),o.css("display","none"),e("#"+m._id+a+"_CustomFDlg_wrapper").css("display","none")}}),D.ejButton({text:m.localizedLabels.cancelButtonText,type:"button",click:function(){o.css("display","none"),e("#"+m._id+a+"_CustomFDlg_wrapper").css("display","none")}}),o.append(T.clone().append(S).append(D)),S.css("width","43.6%"),D.css("width","43.6%"),(R=o.find(".e-dlgfields .e-btncontainer").remove()).find("input:first").addClass("e-responsiveFilterBtnLeft").css("width","45.6%"),R.find("input:last").addClass("e-responsiveFilterBtnRight"),o.ejDialog({enableModal:!1,height:n,width:"100%",position:{X:0,Y:0},enableResize:!1,showHeader:!1}).ejDialog("open"),y=(y=m.getMaxZIndex()+1)>(I=e("#"+m._id+a+"_CustomFDlg_wrapper").css("z-index"))?y:I,o.css({position:"absolute",top:"0px",left:"0px","z-index":y,width:"95.5%"}),m._mediaStatus=!0})},_closeDivIcon:function(i){var a,r=e(i.target);t.isNullOrUndefined(r.attr("closeDialogue"))||(a=e("#"+r.attr("closeDialogue")),t.isNullOrUndefined(a.data("ejDialog"))?a.css("display","none"):a.ejDialog("close")),t.isNullOrUndefined(r.attr("gridEle"))||this.element.css("display","block"),t.isNullOrUndefined(r.attr("openDialogue"))||(this.model.enableResponsiveRow||-1!=r.attr("closeDialogue").indexOf("Custom")?(a=e("#"+r.attr("openDialogue")),t.isNullOrUndefined(a.data("ejDialog"))?a.css("display","block"):a.ejDialog("open")):this.element.css("display","block"))},_getExcelPredicate:function(a){var r,n,o,l,d,s=this,c=s.model,u=e.extend(!0,[],c.filterSettings.filteredColumns),p=u.length;for(s._excelFilter.getPredicate(u,null,!0),n=s._excelFilter._predicates[0],o=0;o<p;o++)(l=u[o]).value==s._dropDownListBlanksText?(d=(d=t.Predicate(l.field,"equal",null,!0)).or(l.field,"equal","",!0),n[l.field]=d,r=r!=i?r.and(d):d):r=t.isNullOrUndefined(r)?t.Predicate(l.field,l.operator,l.value,!l.matchcase):l.isComplex?r.and(l):r[l.predicate](l.field,l.operator,l.value,!l.matchcase),t.isNullOrUndefined(a)&&s._storePreviousFilteredValue(l.field,l.value,l.operator);return r},_checkFilterType:function(i){var a,r,n=this,o=n.model.filterSettings,l=i.filterEditType?i.filterEditType:i.editType;if(l=l.toLowerCase(),"excel"==o.filterType&&"menu"==i.filterType&&-1==e.inArray(l,n._menuColTypes)){switch(l){case"stringedit":a="String";break;case"numericedit":a="Numeric";break;case"datepicker":a="Datepicker";break;case"datetimepicker":a="Datetimepicker";break;case"dropdownedit":a="Dropdown",r=i;break;case"booleanedit":a="Boolean";break;default:a="String",l="stringedit"}n._renderEdittypeFilterMenu(a,r),n._menuColTypes.push(l)}else"menu"==o.filterType&&"excel"==i.filterType&&t.isNullOrUndefined(n._excelFilter)&&n._renderExcelFilter()},_triggerColumnResize:function(i,a,r){var n,o,l,d,s=this,c=s.model,u=s.getHeaderTable().find(".e-columnheader"),p=u.find(".e-headercell"),h=s._cellIndex,g=(e(s._target),0),m=e(r.target);return"columnResizeStart"==i&&(this._isFrozenStackedResize=!1,s._orgX=a,-1!=(h=s._currentCell=s._cellIndex=s.getCellIndex(r))&&this._frozenColumnsLength>0&&c.showStackedHeader&&c.stackedHeaderRows.length>0&&(m.closest(".e-movablecontentdiv").length>0||m.closest(".e-movableheaderdiv").length>0||m.closest(".e-movablefooterdiv").length>0?g+=this._frozenColumnsLength:m.closest(".e-frozenheaderdiv").length>0&&(m.hasClass("e-stackedHeaderCell")?this._isFrozenStackedResize=!0:g+=e(this.getHeaderTable()[0]).find(".e-stackedHeaderCell").length))),-1!=s._currentCell?(o=(n=p[s._currentCell+g]).offsetWidth,"columnResizeStart"==i?(s._isStackedResize=e(n).hasClass("e-stackedHeaderCell"),l={},l={columnIndex:h,column:s.model.columns[h],target:e(n),oldWidth:o},s._trigger("columnResizeStart",l)):"columnResizeEnd"==i?(u.find(".e-headercell").not(".e-detailheadercell").filter(":visible"),d=a-s._orgX,s._newWidth=o+d,s.__oldWidth=o,l={},l={columnIndex:h,column:c.columns[h],target:e(n),oldWidth:o,newWidth:s._newWidth,extra:d},s._trigger("columnResizeEnd",l)):(this.model.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||this.model.isFromGantt?!this.model.isFromGantt&&this.model.columnResizeSettings.columnResizeMode==t.TreeGrid.ColumnResizeMode.NextColumn&&this.model.showTotalSummary&&this._colgroupRefresh():this._updateTableWidth(),l={},o+(d=a-s._orgX),l={columnIndex:h,column:c.columns[h],oldWidth:s.__oldWidth,newWidth:s._newWidth},s._trigger("columnResized",l))):void 0},_headerMouseDown:function(t){var i,a,r,n,o=this,l=o._getCoordinate(t),d=o.model;if(o._cellMouseLeave(),o._headerMouseLeave(),!o.model.isFromGantt&&d.contextMenuSettings.showContextMenu&&o._contextMenuEventBinding(t),"touchstart"==t.type?(i=o._getElementByPosition(l.pageX,l.pageY),o._on(o.element,"touchmove",o._mouseMove),o._resizer&&o._resizer._touchStart(t)):i=e(t.target),o._on(e(document),"mouseup touchend",o._headerMouseUp),d.allowColumnReordering&&(i.closest(".e-columnheader").length>0&&o.dragColumn(t),"touchstart"==t.type&&(o._dragColumnTooltipTimer=window.setTimeout(function(){o._touchstart=!1,o._dragTooltip||"touchstart"!=t.type||(o.dragColumnToolTip(t),o._dragTooltip&&o._on(o.element,"touchmove",o.dragColumnToolTip))},550))),o.model.allowColumnResize){if(d.isFromGantt?o._on(o.element.closest(".e-gantt"),"mouseup touchend",o._mouseUp):o._on(o.element,"mouseup touchend",o._mouseUp),a=i.closest("tr"),this._target=i,r=l.pageX,l.pageY,-1!=navigator.userAgent.indexOf("WebKit")&&(r=l.pageX,l.pageY-document.body.scrollTop),a.length>0&&e(a[0]).hasClass("e-resizedragicon")&&!i.hasClass("e-columnicon")&&(i.is(".e-headercelldiv")&&(i=e(i[0].parentNode)),t.target=i,o._frozenColumnsLength>0&&(n=i.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),o.getColumnByField(n)),this._triggerColumnResize("columnResizeStart",r,t)))return;"touchstart"!=t.type&&o._resizer._mouseDown(t)}},_headerMouseUp:function(i){var a,r,n=this,o=n.model,l={},d=n._getCoordinate(i);"touchend"==i.type?(a=n._getElementByPosition(d.pageX,d.pageY),n._off(n.element,"touchmove",n._mouseMove)):a=e(i.target),n._off(e(document),"mouseup touchend",n._headerMouseUp),o.contextMenuSettings.showContextMenu&&n._contextMenuHandler&&n._displayContextMenu?n._headerRightClick(i):n._contextMenuHandler=!1,n._displayContextMenu=!0,n.model.allowColumnResize&&(o.isFromGantt?n._off(n.element.closest(".e-gantt"),"mouseup touchend",n._mouseUp):n._off(n.element,"mouseup touchend",n._mouseUp),this.element.find(".e-reSizeColbg").remove(),this.element.find(".e-columnheader").removeClass("e-resizedragicon"),n._resizer._expand=!1),o.allowColumnReordering&&(window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null,n._off(n.element,"mousemove touchmove",n.dragColumnToolTip),e(n._reordervline).remove(),e(n._dragmouseOverTooltip).remove(),(n._posx!=d.pageX||n._posy!=d.pageY)&&(n._mouseDragged=!0),o.allowColumnReordering&&a.closest(".e-headercell").length>0&&"mousemove"==n._headerDragStatus&&(r=o.columns,l.targetColumn=r[n._currentIndex],l.targetColumnIndex=n._currentIndex,l.draggedColumn=n._draggedColumn,l.draggedColumnIndex=r.indexOf(n._draggedColumn),t.isNullOrUndefined(l.targetColumn.nonColumn)&&!t.isNullOrUndefined(l.targetColumnIndex)&&l.targetColumnIndex!=l.draggedColumnIndex&&(n._trigger("columnDrop",l),l.cancel||n.reorderColumn(l.draggedColumn.field,l.targetColumnIndex)))),n._resetHeaderPrivateProperties()},_resetHeaderPrivateProperties:function(){this._timerDragDown&&(this._timerDragDown=window.clearInterval(this._timerDragDown)),this._timerDragUp&&(this._timerDragUp=window.clearInterval(this._timerDragUp));var e=this;e.model;e._draggedColumn=null,e._dragMouseDown=!1,e._dragTooltip=!1,e._headerDragStatus="",e._timerDragDown=null,e._timerDragUp=null,e._currentIndex=null,e._dragmouseOverTooltip=null},_contentMouseDown:function(i){var a,r=e(i.target),n=this,o=n.model,l=n._getCoordinate(i),d=r.closest(".e-treegrid").attr("id");return n._contentPageY=l.pageY,n._contentPageX=l.pageX,n._on(e(document),"mouseup touchend",n._mouseupHandler),o.isFromGantt&&("touchstart"==i.type&&(n._ganttTouchTrigger=!0),a={ctrlKey:i.ctrlKey},n._trigger("touchHandler",a),i.ctrlKey=a.ctrlKey),"touchstart"==i.type&&(n._isTouchEvent=!0,n._isTouchTrigger=!0),e("#"+d+"_selectionpopup").is(":visible")&&(e("#"+d+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")?(i.ctrlKey=!0,n.model.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row&&(n._multiSelectCtrlRequest=!0)):(i.ctrlKey=!1,n._multiSelectCtrlRequest=!1)),!n.model.isFromGantt&&o.contextMenuSettings.showContextMenu&&n._contextMenuEventBinding(i),!(r.hasClass("e-vhandle")||r.hasClass("e-vscrollbar")||r.hasClass("e-vup")||r.hasClass("e-vdown")||r.hasClass("e-vhandlespace")||r.hasClass("e-hhandle")||r.hasClass("e-hscrollbar")||r.hasClass("e-hdown")||r.hasClass("e-hhandlespace")||r.closest(".e-editedcell").length>0||r.closest(".e-unboundeditedcell").length>0||r.parent().hasClass("e-unboundcelldiv")||(n._mouseDown=!0,t.isTouchDevice()&&i.preventDefault(),o.allowDragAndDrop&&(r.closest(".e-treegridrows").length>0||r.closest(".e-templatecell").length>0)&&("touchstart"==i.type?n._dragTooltipTimer=window.setTimeout(function(){n.dragRecord(i),n._multiSelectPopup&&n._multiSelectPopup.is(":visible")&&n._dragTooltip&&n._clearMultiSelectPopup()},550):n.dragRecord(i)),o.isFromGantt||"touchstart"==i.type&&n._on(n.element,"touchmove","#"+n._id+"e-gridcontent",n._touchScroll),!i.ctrlKey&&!i.shiftKey&&2!=i.which&&3!=i.which))||void 0},_touchScroll:function(t){var i,a,r,n,o,l=this,d=l.model,s=l._getCoordinate(t),c=l._contentPageX,u=l._contentPageY,p=s.pageX,h=s.pageY;l._isTouchTrigger=!1,n=p-c,o=h-u,"touchmove"==t.type&&t.preventDefault(),l._mouseDown&&!l._dragMouseDown&&(window.clearTimeout(this._dragTooltipTimer),this._dragTooltipTimer=null,window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null,i="touchmove"==t.type?l._getElementByPosition(s.pageX,s.pageY):e(t.target),!d.isFromGantt&&i.closest("div").find(".e-content")&&(r=u<h?-Math.abs(o):Math.abs(o),a=c<p?-Math.abs(n):Math.abs(n),l._contentPageX=p,l._contentPageY=h,l._updateScrollPosition(i,a,r)))},_updateScrollPosition:function(e,t,i){var a=this,r=a.getScrollElement().ejScroller("option","scrollTop"),n=a.getScrollElement().ejScroller("option","scrollLeft"),o=n+t,l=r+i,d=a.isVScroll()?a.getMaxScrollHeight():null,s=a.getScrollElement().ejScroller("isHScroll")?a.getScrollElement().find(".e-content").get(0).scrollWidth:null;d&&(((l=d<l?d:l<0?0:l)>0&&r>0||l<d&&r<d)&&(a._$gridContent.scrollTop(0),a.getScrollElement().ejScroller("scrollY",l,!0))),s&&(((o=s<o?s:o<0?0:o)>0&&n>0||o<s&&n<s)&&(a._$gridContent.scrollLeft(0),a.getScrollElement().ejScroller("scrollX",o,!0)))},_mouseMove:function(t){var i=this,a=this.model;window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null,"touchmove"==t.type&&i._resizer&&i._resizer._allowStart&&(i._headerDragStatus=""),i.model.allowColumnResize&&0==i._headerDragStatus.length&&(i._resizer._mouseMove(t),i._resizer._expand&&i._cancelEditState(),"col-resize"!==e(t.target).parent().css("cursor")&&(!(a.allowSorting||a.showColumnChooser||!a.showColumnChooser&&a.allowFiltering&&"menu"==a.filterSettings.filterType)||e(t.target).closest("th").hasClass("e-detailheadercell")||e(t.target).closest("th").hasClass("e-stackedHeaderCell")?i.getHeaderTable().find(".e-columnheader").css({cursor:"default"}):i.getHeaderTable().find(".e-columnheader").css({cursor:"pointer"})))},_frozenWidth:function(){for(var e=this.getContentTable().find("colgroup").find("col").slice(0,this.model.scrollSettings.frozenColumns),t=0,i=0;i<e.length;i++)t+="none"==e[i].style.display?0:parseInt(e[i].style.width.replace("px",""));return t},_mouseUp:function(i){var a,r,n,o=this,l=o.model;if("mousemove"!=o._headerDragStatus&&l.allowColumnResize)if((e(i.target).hasClass("e-headercelldiv")||e(i.target).hasClass("e-reSizeColbg"))&&(o._focusTreeGridElement(),o._clearColumnMenu()),e(i.target).hasClass("e-reSizeColbg")||e(i.target).closest(".e-gridheader").length>0){if(o._resizer._expand){if(a=i.clientX,i.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(a=i.pageX,i.pageY),"touchend"==i.type&&(a=i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY),!t.isNullOrUndefined(o._currentCell)&&this._triggerColumnResize("columnResizeEnd",a,i))return this.element.find(".e-reSizeColbg").remove(),o._resizer._expand=!1,void(l.isFromGantt?o._off(o.element.closest(".e-gantt"),"mouseup touchend",o._mouseUp):o._off(o.element,"mouseup touchend",o._mouseUp));if(!t.isNullOrUndefined(o._currentCell)&&1==l.columns[o._currentCell].isFrozen&&a+100>this._gridWidth)return;o._resizer._mouseUp(i),r=parseInt(l.columns[o._currentCell].width),l.isFromGantt&&"msie"==t.browserInfo().name&&l.showColumnChooser&&!t.isNullOrUndefined(r)&&(n=e(o.getHeaderTable().find("thead").find("th")[o._currentCell]),r<42?this._getColWidth(o._currentCell,n):n.hasClass("e-column-menu-padding")||n.addClass("e-column-menu-padding")),!t.isNullOrUndefined(o._currentCell)&&o._currentCell>=0&&o._currentCell<l.columns.length&&l.columns[o._currentCell]&&(l.columns[o._currentCell].width=o._resizer._newWidth),t.isNullOrUndefined(o._currentCell)||this._triggerColumnResize("columnResized",a,i),l.allowTextWrap&&l.allowColumnResize&&o._updateRowHeight(),"auto"==l.sizeSettings.height&&l.allowColumnResize&&(o.getScrollElement().ejScroller("refresh"),o._updateContentHeight()),o.getScrollElement().ejScroller("refresh"),o._updateHeaderScrollLeft(),o._updateScrollCss(),l.isFromGantt&&o._trigger("refreshScrollCss")}}else this.element.find(".e-reSizeColbg").remove(),o._resizer._expand=!1,l.isFromGantt?o._off(o.element.closest(".e-gantt"),"mouseup touchend",o._mouseUp):o._off(o.element,"mouseup touchend",o._mouseUp)},_resizeFilteringElements:function(){var e,i,a,r=this;if(r.model.allowFiltering)for(e={},i=r.model.columns.length,e.requestType=t.TreeGrid.Actions.Filter,a=0;a<i;a++)r.model.columns[a].width=r.columnsWidthCollection[a],e.fieldname=r.model.columns[a].field,this._filteringElements(e)},_enableEditingEvents:function(){var e=this;e.model.editSettings.allowEditing?t.isTouchDevice()?(e._off(e.element,"doubletap ",".e-gridcontent",e._editdblClickHandler),e._on(e.element,"doubletap ",".e-gridcontent",e._editdblClickHandler)):(e._off(e.element,"dblclick ",".e-gridcontent",e._editdblClickHandler),e._on(e.element,"dblclick ",".e-gridcontent",e._editdblClickHandler)):t.isTouchDevice()?e._off(e.element,"doubletap ",".e-gridcontent",e._editdblClickHandler):e._off(e.element,"dblclick ",".e-gridcontent",e._editdblClickHandler)},_saveCellHandler:function(i){var a,r=e(i.target),n=this,o=n.model;if(o.isFromGantt&&r.closest("tr").length){var l=r.closest("tr"),d=(n.getRows(),this.getIndexByRow(l)),s=o.currentViewData&&o.currentViewData[d];a=o.updatedRecords.indexOf(s)}r.hasClass("e-vhandle")||r.hasClass("e-vscrollbar")||r.hasClass("e-vup")||r.hasClass("e-vdown")||r.hasClass("e-vhandlespace")||r.hasClass("e-vscroll")||r.hasClass("e-hhandle")||r.hasClass("e-hscrollbar")||r.hasClass("e-hup")||r.hasClass("e-hdown")||r.hasClass("e-hhandlespace")||r.hasClass("e-hscroll")||((r.closest(".e-gridcontent").length>0||r.hasClass(".e-gridcontent")||r.hasClass("e-summarytreegridexpand")||r.hasClass("e-summarytreegridcollapse"))&&(n._isRowEdit?0==r.closest("form#"+n._id+"EditForm").length&&0==r.closest("form#"+n._id+"EditFrozenForm").length&&e("#"+n._id+"EditForm").length>0&&n.saveRow():0==r.closest(".e-popup").length&&0==r.closest(".e-rowcell").find("#"+n._id+"EditForm").length&&0==r.closest("form#"+n._id+"EditFrozenForm").length&&e("#"+n._id+"EditForm").length>0&&n.saveCell()),"row"!=o.selectedMode||!o.isFromGantt||!o.updatedRecords.length||t.isNullOrUndefined(a)||r.hasClass("e-treegridexpand")||r.hasClass("e-treegridcollapse")||this.selectedRowIndex()==a||n._rowSelectingEventTrigger(this.selectedRowIndex(),a)||(o.allowSelection&&n.selectRows(a),n._rowSelectedEventTrigger(a)))},_contextMenuAction:function(t){var i,a=this,r=a.model,n=a._getCoordinate(t);if(i="taphold"==t.type?a._getElementByPosition(n.pageX,n.pageY):e(t.target),r.contextMenuSettings.showContextMenu){if(a._multiSelectCtrlRequest&&(a._multiSelectCtrlRequest=!1),3!=t.which||a._isTouchEvent)return a._contextMenuHandler=!0,!0;i.closest(".e-gridcontent").length>0?a._rightClick(t):i.closest(".e-gridheader").length>0&&a._headerRightClick(t)}else t.stopPropagation()},_rightClick:function(i){var a,r,n,o,l=this,d=l.model,s=e(i.target),c=(s[0].parentNode,{}),u=!1,p=l.getUpdatedRecords();if(s.closest(".e-treegrid").attr("id")!==this._id)return!1;if("cell"==d.selectionSettings.selectionMode&&"dialogEditing"!=d.editSettings.editMode&&(d.editSettings.editMode="cellEditing"),l.model.contextMenuSettings.showContextMenu){if(l._clearContextMenu(),this._removeDetailsRow(),l.disableTooltip(),s.hasClass("e-summaryrowcell")||s.hasClass("e-summarytitle"))return;if((s.hasClass("e-cell")||s.hasClass("e-treegridexpand"))&&s.closest("tr"),a=s.closest("tr"),r=l.getIndexByRow(a),l.model.currentViewData=l.getCurrentViewData(),n=l.model.currentViewData[r],r=p.indexOf(n),c.data=n,c.recordIndex=r,d.isEdit?u=s.closest(".e-rowcell").find("form#"+l._id+"EditForm").length>0||s.closest(".e-rowcell").find("form#"+l._id+"EditFrozenForm").length>0:this._isRowEdit&&(u=s.closest(".e-rowedit").find("form#"+l._id+"EditForm").length>0||s.closest(".e-rowedit").find("form#"+l._id+"EditFrozenForm").length>0||s.closest(".e-addedrow").find("form#"+l._id+"EditForm").length>0||s.closest(".e-addedrow").find("form#"+l._id+"EditFrozenForm").length>0),!u){if(!this.editFormValidate())return!0;l._saveEditedElements()}null==l.dataSource()||0==l.dataSource().length||u||0==d.flatRecords.length?(l._contextMenuItems=[],l._contextMenuItems=l._getContextMenuItems(),l._subContextMenuItems=[],l._updateContextmenuOption(r,n),l._clearContextMenu(),l._contextMenuItems.length>0&&l._renderContextMenu(i,r,n,u)):n&&(i.preventDefault(),l._contextMenuItems=[],l._contextMenuItems=l._getContextMenuItems(),l._subContextMenuItems=[],l._subContextMenuItems=l._getsubContextMenuItems(),l._updateContextmenuOption(r,n),l._clearContextMenu(),"row"==d.selectionSettings.selectionMode&&d.allowSelection&&!l._rowSelectingEventTrigger(this.selectedRowIndex(),r,!1,i.type)&&(l.selectRows(r),l._rowSelectedEventTrigger(r,null,!1,i.type)),"cell"==d.selectionSettings.selectionMode&&(o=l.getCellIndex(i),l.selectCells([{rowIndex:r,cellIndex:o}]),l._rowIndexOfLastSelectedCell=r),l._contextMenuItems.length>0&&l._renderContextMenu(i,r,n,u),l.editFormValidate()&&l._cancelSaveTools())}l._clearColumnMenu(),l._contextMenuHandler=!1,!l.model.isFromGantt&&d.contextMenuSettings.showContextMenu&&(t.isTouchDevice()?l._off(l.element,"taphold",l._contextMenuAction):l._off(l.element,"contextmenu",l._contextMenuAction))},_contextMenuEventBinding:function(){var e=this;t.isTouchDevice()?(e._off(e.element,"taphold",e._contextMenuAction),e._on(e.element,"taphold",e._contextMenuAction)):(e._off(e.element,"contextmenu",e._contextMenuAction),e._on(e.element,"contextmenu",e._contextMenuAction))},_headerRightClick:function(i){var a,r,n=this,o=n.model,l=e(i.target);i.preventDefault(),o.contextMenuSettings.showContextMenu&&(n._clearColumnMenu(),n._removeDetailsRow(),n.disableTooltip(),n._headerContextMenuItems=[],n._headerContextMenuItems=n._getHeaderContextMenuItems(i),a=l.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),r=n.getColumnByField(a),n._headerContextMenuItems.length>0&&!r.nonColumn&&n._renderHeaderContextMenu(i),n.editFormValidate()&&n._cancelSaveTools(),n._contextMenuHandler=!1,!o.isFromGantt&&o.contextMenuSettings.showContextMenu&&(t.isTouchDevice()?n._off(n.element,"taphold",n._contextMenuAction):n._off(n.element,"contextmenu",n._contextMenuAction)))},_editdblClickHandler:function(a){var r,n,o,l,d,s=this,c=s.model,u=e("#"+s._id+"EditForm"),p={},h=e(a.target),g=h.closest("tr"),m=s._cellEditingDetails;if(c.isFromGantt&&1==c.readOnly||h.hasClass("e-unboundcelldiv")||h.hasClass("e-unboundcell")||h.closest("td").hasClass("e-unboundcell")||a.ctrlKey)return!0;if(!(n=s.getUpdatedRecords(),h.hasClass("e-vhandle")||h.hasClass("e-vscrollbar")||h.hasClass("e-vup")||h.hasClass("e-vdown")||h.hasClass("e-vhandlespace")||h.hasClass("e-treegridexpand")||h.hasClass("e-treegridcollapse")||h.hasClass("e-hhandle")||h.hasClass("e-hscrollbar")||h.hasClass("e-hup")||h.hasClass("e-hdown")||h.hasClass("e-hhandlespace")||h.hasClass("e-summaryrowcell")||h.hasClass("e-footersummaryrowcell")||h.hasClass("e-summarytitle")||h.hasClass("e-lastsummaryrow"))){if(h.closest(".e-treegrid").length&&h.closest(".e-treegrid").attr("id")!==this._id)return!1;if(h.hasClass("e-rowcell")||h.parent().hasClass("e-rowcell")||h.closest("td").hasClass("e-rowcell")||h.closest("td").hasClass("e-rowcell")&&h.hasClass("e-cell")){if("normal"===c.editSettings.editMode&&c.editSettings.allowEditing){if("resourceView"==c.viewType)return!0;p.requestType=t.TreeGrid.Actions.BeginEdit,s._trigger("actionBegin",p)}if(s._cellEditingDetails.cancelSave)return void(s._cellEditingDetails.cancelSave=!1);if(0===u.length&&null!==s.getRows()){if("cellediting"==c.editSettings.editMode.toLowerCase()||"batchediting"==c.editSettings.editMode.toLowerCase()&&"cell"==c.editSettings.batchEditSettings.editMode.toLowerCase()){if(s._focusTreeGridElement(),s._cellEditingDetails.columnIndex=s.getCellIndex(a),"click"!=c.editSettings.beginEditAction&&(s._cellEditingDetails.rowIndex=s.getRowIndex(a)),(r=c.currentViewData[s._cellEditingDetails.rowIndex]).summaryRow)return;if(c.selectedItem=r,0==c.columns[m.columnIndex].allowEditing||"resourceView"==c.viewType&&"unassignedTask"==r.eResourceTaskType)return;(o=s._cellEditingDetails.columnIndex>=0&&c.columns[s._cellEditingDetails.columnIndex].field)&&(s.updateScrollBar(),c.editSettings.allowEditing&&s.cellEdit(s._cellEditingDetails.rowIndex,o))}else("rowediting"==c.editSettings.editMode.toLowerCase()||"dialogediting"==c.editSettings.editMode.toLowerCase()||"batchediting"==c.editSettings.editMode.toLowerCase()&&("row"==c.editSettings.batchEditSettings.editMode.toLowerCase()||"dialog"==c.editSettings.batchEditSettings.editMode.toLowerCase()))&&(c.currentViewData=s.getCurrentViewData(),-1!=s.getCellIndex(a)&&-1!=s.getRowIndex(a)&&(s._cellEditingDetails.columnIndex=s.getCellIndex(a),l=s.getRowIndex(a),c.enableVirtualization&&(d="row"==c.selectionSettings.selectionMode?c.selectedItem:c.updatedRecords[s._rowIndexOfLastSelectedCell],l=n.indexOf(d)),"dialogediting"==s.model.editSettings.editMode.toLowerCase()||"batchediting"==s.model.editSettings.editMode.toLowerCase()&&"dialog"==c.editSettings.batchEditSettings.editMode.toLowerCase()?s._showTreeGridAddEditDialog(l):(s.updateScrollBar(),s._editRow(l,i,s._cellEditingDetails.columnIndex))));(u=e("#"+s._id+"EditForm")).length>0&&s._editAddTools(),e.isFunction(e.validator)&&s._initValidator()}s.model.allowSelection||g.find(".e-active").removeClass("e-active").removeClass("e-selectionbackground"),s._clearContextMenu(),this._removeDetailsRow()}}},_popupHide:function(i){var a,r,n=this,o=n.model.columns,l=null,d=null,s=null,c=i&&e(i).closest("td");for(n.model.allowFiltering&&"filterbar"==n.model.filterSettings.filterType&&(c=i&&e(i).closest("td, th")),e("#"+n._id+"_ColumnMenu").length>0&&(t.isTouchDevice()||n._clearColumnMenu()),a=0;a<o.length;a++)l=null,o[a]&&(s=o[a].field.split(".").join(""),"datepicker"==o[a].editType||"datetimepicker"==o[a].editType?l=e("#"+n._id+s).data("ejDatePicker"):"dropdownedit"==o[a].editType&&((r=e("#"+n._id+s).data("ejDropDownList"))&&0==e(c).find("#"+r._id).length&&r.model&&r.hidePopup()),l&&0==e(c).find("#"+l._id).length&&l.hide(),("datepicker"==o[a].filterEditType||"datetimepicker"==o[a].filterEditType)&&((d=e("#"+n._id+"_"+s+"_filterbarcell").data("ejDatePicker"))&&0==e(c).find("#"+d._id).length&&d.hide()),"dropdownedit"==o[a].filterEditType&&((r=e("#"+n._id+"_"+s+"_filterbarcell").data("ejDropDownList"))&&0==e(c).find("#"+r._id).length&&r.hidePopup()))},_mouseWheel:function(t){var i=this,a=i.model,r=null,n=t;if(i._popupHide(),t=t.originalEvent,!e(t.target).hasClass("e-footersummaryrowcell")){if(i.getScrollElement().height()>i._$gridContainer.height())return void i.getScrollElement().ejScroller("scrollY",0,!0);if(t.wheelDelta?(r=-t.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(r=-r)):t.detail&&(r=t.detail/3),!r)return!1;var o=i.getScrollElement().ejScroller("option","scrollTop"),l=o+57*r,d=this.model.isFromGantt?parseInt(this.getRecordsHeight())-(i._viewPortHeight-18):"auto"==a.sizeSettings.height?0:this.getMaxScrollHeight();if(l>d&&(l=d),l<0&&(l=0),o!=l)try{t.preventDefault?t.preventDefault():n.preventDefault()}catch(e){}return i.updateScrollTop(l),!0}},_getCollapsedParentItem:function(e){var t=e.parentItem;return t?!0===this.getExpandStatus(t)?t:this._getCollapsedParentItem(t):null},_getRecordTopPosition:function(e,t){var i,a={},r=0,n=this.model;if("resourceView"==n.viewType){for(i=0;i<=t;i++)i==t?a.bottom=r+this._getTemplateRowHeight(e[i]):r+=this._getTemplateRowHeight(e[i]);a.top=r}else a.top=t*(n.rowHeight+this._detailsRowHeight),a.bottom+=n.rowHeight+this._detailsRowHeight;return a},updateScrollBar:function(e){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_,f=this,w=f.model,C=0,T=f.getUpdatedRecords();d=w.allowSelection?"row"==w.selectionSettings.selectionMode?this.selectedItem():T[f._rowIndexOfLastSelectedCell]:this.selectedItem(),i=w.allowPaging?T:f._isHierarchyFiltering&&w.enableVirtualization?f._updateFilterParent:f.getExpandedRecords(T),c=e||0==e?i.indexOf(T[e]):i.indexOf(d),w.allowTextWrap?(c=(s=f.getUpdatedRecords()).indexOf(d),w.enableVirtualization?(a=f._getAvgTextWrapRowHeight("updateHeight",c).height,r=s[c].textWrapRowHeight+f._detailsRowHeight):(u=t.TreeGrid.getRowByIndex(f,c)).length>0?(r=u.height()+f._detailsRowHeight,a=u[0].offsetTop):a=c*(r=w.rowHeight+f._detailsRowHeight)):(p=this._getRecordTopPosition(i,c),r=w.rowHeight+this._detailsRowHeight,a=p.top),h=a+r,g=(m=f.getScrollElement().children(".e-content").length)?f.getScrollElement().children(".e-content").scrollTop():f.getScrollElement().scrollTop(),n=w.allowTextWrap?f.model.enableVirtualization?f._getAvgTextWrapRowHeight("updateHeight").height:f._$gridContentTable.height():this.getRecordsHeight(),(f.getScrollElement().ejScroller("isHScroll")||f.element.find(".e-borderbox").length>0)&&(C=18),o=a<g,l="auto"!=w.sizeSettings.height&&g+f._viewPortHeight-C<h,(o||l)&&(a+f._viewPortHeight>n&&(a=n-f._viewPortHeight,l&&(a+=C)),_={requestType:t.TreeGrid.Actions.Scroll,delta:a},m?f.updateScrollTop(a):(f.getScrollElement().scrollTop(_.delta),f._completeAction(_)),w.enableVirtualization&&f._focusTreeGridElement())},_selectedItemDown:function(e){var t,i,a,r=this,n=this.model,o=r.getUpdatedRecords(),l=r.getExpandedRecords(o);t=r._prevSelectedItem&&this._getExpandStatusRecord(r._prevSelectedItem)?n.updatedRecords.indexOf(r._prevSelectedItem):0,r._shiftSelectedRecord&&this._getExpandStatusRecord(r._shiftSelectedRecord)?(a=l.indexOf(r._shiftSelectedRecord),i=n.updatedRecords.indexOf(l[a+1])):(a=l.indexOf(n.updatedRecords[t]),i=n.updatedRecords.indexOf(l[a+1])),(i>=o.length||-1==i)&&(i=o.length-1),r.updateScrollBar(i),r._multiSelectShiftRequest=!0,r.selectRows(t,i),r._rowSelectedEventTrigger(t,i,!1,e),r._multiSelectShiftRequest=!1,r._shiftSelectedRecord=n.updatedRecords[i]},_selectedItemUp:function(e){var t,i,a,r=this,n=this.model,o=r.getUpdatedRecords(),l=r.getExpandedRecords(o);t=r._prevSelectedItem&&this._getExpandStatusRecord(r._prevSelectedItem)?n.updatedRecords.indexOf(r._prevSelectedItem):0,r._shiftSelectedRecord&&this._getExpandStatusRecord(r._shiftSelectedRecord)?(a=l.indexOf(r._shiftSelectedRecord),i=n.updatedRecords.indexOf(l[a-1])):(a=l.indexOf(n.updatedRecords[t]),i=n.updatedRecords.indexOf(l[a-1])),i<0&&(i=0),r.updateScrollBar(i),r._multiSelectShiftRequest=!0,r.selectRows(t,i),r._rowSelectedEventTrigger(t,i,!1,e),r._multiSelectShiftRequest=!1,r._shiftSelectedRecord=n.updatedRecords[i]},_keyPressed:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x,v,b,S,D,R,y,I,k,M,E,H,P,F,O,G,L,N,W,A,z,j,U,B,V,$=this,q=this.model,Y=$.getUpdatedRecords(),X=q.allowPaging?Y:$.getExpandedRecords(q.updatedRecords);if(this._removeDetailsRow(),!q.allowKeyboardNavigation)return!1;if("dialogEditing"==this.model.editSettings.editMode&&e(a).closest("#"+this._id+"_dialogEdit").length)return!0;var K=!1,Q=e(a),Z=e("#"+$._id+"EditForm");if("downArrow"!=i&&"upArrow"!=i&&"saveRequest"!=i&&"moveCellLeft"!=i&&"moveCellRight"!=i&&"cancelRequest"!=i&&"INPUT"==Q.prop("tagName"))return!0;switch(q.isFromGantt?(h=e("#"+$._id.replace("ejTreeGrid","")+"_ContextMenu"),g=e("#"+$._id.replace("ejTreeGrid","")+"_SubContextMenu")):(h=e("#"+$._id+"_ContextMenu"),g=e("#"+$._id+"_SubContextMenu")),m=e("#"+$._id+"_ColumnMenu"),_=e("#"+$._id+"ccDiv_wrapper"),c=e("#"+$._id+"_headerContextMenu"),u=e("#"+$._id+"ccDiv_wrapper"),$._columnMenuTarget&&(x=e.trim($._columnMenuTarget.prev("div.e-headercelldiv").attr("data-ej-mappingname")),(R=$.getColumnByField(x))&&(R.filterEditType?(I=R.filterEditType.indexOf("edit"),T=R.filterEditType):(I=R.editType.indexOf("edit"),T=R.editType),-1!=I?(l=(o=T.slice(0,I)).charAt(0).toUpperCase()+o.slice(1),d=e("#"+$._id+"filter"+l+"MenuDiv_wrapper")):(l=T.charAt(0).toUpperCase()+T.slice(1),d=e("#"+$._id+"filter"+l+"MenuDiv_wrapper"))),C=!t.isNullOrUndefined(d)&&d.is(":visible")),f="visible"==g.css("visibility"),w=_.is(":visible"),p=u.is(":visible"),i){case"saveRequest":if(0==h.length&&0==m.length&&0==c.length)($._isRowEdit||$.model.isEdit)&&(Q.blur(),$._endEdit(),$._focusTreeGridElement()),"onEnter"==q.filterSettings.filterBarMode&&"filterbar"==q.filterSettings.filterType&&q.allowFiltering&&Q.closest("th").hasClass("e-filterbarcell")&&$._filterBarHandler(a);else if(h.length)$._moveToNextMenuItem("save");else if(c.length)if("contextMenu_Columns"==e("#"+$._activeMenuItemId).attr("id")){if(A=null,z=u.find("div.e-columnmenuselection"),w?A=z.data("column"):(ae=c.find("div.e-columnmenuselection")).length>0&&(A=ae[0].id),!t.isNullOrUndefined(A))switch(R=$._contextMenuColumnDetails,A){case"contextMenu_Columns":$._showKeyboardColumnChooser(!1,c,u,e("#contextMenu_Columns"));break;default:z.find("span").hasClass("e-disable")||("true"==z.find("span").attr("aria-checked")?$.hideColumn(A):$.showColumn(A))}}else $._moveToNextMenuItem("save");else if(m.length&&(A=null,z=_.find("div.e-columnmenuselection"),w?A=z.data("column"):(ae=m.find("div.e-columnmenuselection")).length>0&&(A=ae[0].id),!t.isNullOrUndefined(A)))switch(Q=$._columnMenuTarget,x=e.trim(Q.prev("div.e-headercelldiv").attr("data-ej-mappingname")),R=$.getColumnByField(x),A){case $._id+"_SortAscendingChooser":$.model.allowMultiSorting&&($._multiSortRequest=!0),q.isFromGantt?$.sortColumn(R.mappingName?R.mappingName:R.field,t.sortOrder.Ascending):$.sortColumn(R.field,t.sortOrder.Ascending),$._multiSortRequest=!1;break;case $._id+"_SortDescendingChooser":$.model.allowMultiSorting&&($._multiSortRequest=!0),q.isFromGantt?$.sortColumn(R.mappingName?R.mappingName:R.field,t.sortOrder.Descending):$.sortColumn(R.field,t.sortOrder.Descending),$._multiSortRequest=!1;break;case $._id+"_FreezeColumnsChooser":R&&!e($._id+"_FreezeColumnChooser").hasClass("e-disable")&&($._checkboxSelection&&q.columns[0].nonColumn&&!q.columns[0].isFrozen&&(q.columns[0].isFrozen=!0),$.freezeColumn(R.field,!0));break;case $._id+"_UnfreezeColumnsChooser":R&&!e($._id+"_UnfreezeColumnChooser").hasClass("e-disable")&&($._checkboxSelection&&2==$._frozenColumnsLength&&q.columns[0].nonColumn&&q.columns[0].isFrozen&&(q.columns[0].isFrozen=!1),$.freezeColumn(R.field,!1));break;case $._id+"_FreezePrecedingColumnsChooser":R&&!e($._id+"_FreezePrecedingColumnsChooser").hasClass("e-disable")&&$.freezePrecedingColumns(R.field);break;case $._id+"_ColumnLeftChooser":R&&!e($._id+"_ColumnLeftChooser").hasClass("e-disable")&&$.insertColumnChooser(R,"left");break;case $._id+"_ColumnRightChooser":R&&!e($._id+"_ColumnRightChooser").hasClass("e-disable")&&$.insertColumnChooser(R,"right");break;case $._id+"_DeleteColumnChooser":R&&!e($._id+"_DeleteColumnChooser").hasClass("e-disable")&&($._targetColumnIndex=q.columns.indexOf(R),$._updateConfirmDialog.ejDialog("open"),$._clearColumnMenu());break;case $._id+"_RenameColumnChooser":R&&!e($._id+"_RenameColumnChooser").hasClass("e-disable")&&($._targetColumnIndex=q.columns.indexOf(R),$._renderColumnRenameDialog(R),$._columnRenameDialog.ejDialog("open"),$._clearColumnMenu());break;case $._id+"_FilterChooser":R&&e("#"+$._id+"_ColumnMenu").find(".e-expander").hasClass("e-treegridadaptivesubicon")&&(v=d[0].id.substring($._id.length,d[0].id.indexOf("MenuDiv")),$._showFilterMenu(null,v,null,null,null,null,null,null,R,null));break;case $._id+"_ColumnsChooser":R&&e("#"+$._id+"_ColumnMenu").find(".e-expander").hasClass("e-treegridadaptivesubicon")&&!$.model.isFromGantt&&$._adaptiveColumnChooser();break;default:z.find("span").hasClass("e-disable")||("true"==z.find("span").attr("aria-checked")?$.hideColumn(A):$.showColumn(A))}break;case"cancelRequest":0==h.length&&0==m.length&&0==c.length?(Z.length>0&&("cellediting"==(D=q.editSettings.editMode).toLowerCase()||"batchediting"==D.toLowerCase()&&"cell"==q.editSettings.batchEditSettings.editMode?$._isRowEdit?$.cancelRowEditCell():$.cancelEditCell():("rowediting"==D.toLowerCase()||"batchediting"==D.toLowerCase()&&"row"==q.editSettings.batchEditSettings.editMode)&&$.cancelRowEditCell(),$._cancelSaveTools()),$._focusTreeGridElement(),1==$._dragMouseDown&&(e($._dragmouseOverTooltip).remove(),e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"}),$._dropCancel=!0,$._dragMouseDown=!1,$._dragTooltip=!1,$._headerDragStatus="",$._dragTargetItem&&$._dragTargetItem.hasChildRecords&&0==$._dragTargetItem.level&&(b=t.TreeGrid.getRowByIndex(this,Y.indexOf($._dragTargetItem)),$._dragTargetItem?b.find(".e-treegridexpand").css({display:"inline-block"}):b.find(".e-treegridcollapse").css({display:"inline-block"})),$._off($.element,"touchmove",".e-treegridrows, .e-templatecell",$.dragToolTip),$._off($.element,"mousemove",".e-gridcontent, .e-templatecell",$.dragToolTip))):($._clearContextMenu(),$._clearColumnMenu());break;case"editRecord":if(q.isFromGantt&&1==q.readOnly)return;if(0==h.length&&0==m.length&&("cell"==q.selectionSettings.selectionMode&&"dialogEditing"!=q.editSettings.editMode&&(q.editSettings.editMode="cellEditing"),D=(S=q.editSettings).editMode,S.allowEditing&&1==q.selectedItems.length||S.allowEditing&&"cell"==q.selectionSettings.selectionMode||S.allowEditing&&q.selectedItem&&$._checkboxSelection))if("cellediting"==D.toLowerCase()||"cell"==q.selectionSettings.selectionMode){if(R=$.model.columns[$._cellIndex],t.isNullOrUndefined(R)||!R.visible||0==R.allowEditing)return;$._cellEditingDetails.rowIndex="cell"===q.selectionSettings.selectionMode?this._rowIndexOfLastSelectedCell:this.selectedRowIndex(),$._cellEditingDetails.columnIndex=$._cellIndex,q.selectedItem=Y[this.selectedRowIndex()],$._cellEditingDetails.columnIndex>-1&&($.updateScrollBar(),y=R.field,"dialogEditing"==$.model.editSettings.editMode?y&&$._showTreeGridAddEditDialog():y&&$.cellEdit($._cellEditingDetails.rowIndex,y),$._editAddTools())}else"rowediting"!=D.toLowerCase()||$._isRowEdit||"cell"==q.selectionSettings.selectionMode?"dialogediting"==D.toLowerCase()&&"cell"!=q.selectionSettings.selectionMode&&((I=$.selectedRowIndex())>=0&&$._showTreeGridAddEditDialog(I)):(I=$.selectedRowIndex())>=0&&($.updateScrollBar(),$._editRow(I));break;case"topRowSelection":if(q.allowPaging&&0==h.length&&0==m.length){if($._isRowEdit||$.model.isEdit)return!0;Y.length>0&&(k=0,Y[0].isSummaryRow&&(ie=$._getNextRecord(k+1,Y,i),k=Y.indexOf(ie)),$._rowSelectingEventTrigger(this.selectedRowIndex(),k,!1,i)||($.selectRows(k),$._focusTreeGridElement(),$.updateScrollBar(),$._rowSelectedEventTrigger(k,null,!1,i)))}break;case"nextPage":if($._currentPage()<q.pageSettings.totalPages&&$.model.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&$._batchEditStarts&&!$._confirmDialog.is(":visible"))return $._batchSaveLostWarning("Paging"),$._batchTempDetails.currentPage=$._currentPage()+1,!0;q.allowPaging&&(M=$._currentPage(),$._focusTreeGridElement(),M<q.pageSettings.totalPages&&$.gotoPage(M+1));break;case"prevPage":if(1!=$._currentPage()&&$.model.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&$._batchEditStarts&&!$._confirmDialog.is(":visible"))return $._batchSaveLostWarning("Paging"),$._batchTempDetails.currentPage=$._currentPage()-1,!0;q.allowPaging&&(M=$._currentPage(),$._focusTreeGridElement(),1!=M&&$.gotoPage(M-1));break;case"bottomRowSelection":if(0==h.length&&0==m.length){if($._isRowEdit||$.model.isEdit)return!0;Y.length>0&&(Y[E=Y.length-1].isSummaryRow&&(ie=$._getNextRecord(E-1,Y,i),E=Y.indexOf(ie)),$._rowSelectingEventTrigger(this.selectedRowIndex(),E,!1,i)||($.selectRows(E),$._focusTreeGridElement(),$.updateScrollBar(),$._rowSelectedEventTrigger(E,null,!1,i)))}break;case"firstRowSelection":if(0==h.length&&0==m.length){if($._isRowEdit||$.model.isEdit)return!0;Y.length>0&&("row"==q.selectionSettings.selectionMode?(q.allowPaging&&$.gotoPage(1),q.allowSelection&&!$._rowSelectingEventTrigger(this.selectedRowIndex(),0,!1,i)&&($.selectRows(0),$.updateScrollBar(),$._focusTreeGridElement(),$._rowSelectedEventTrigger(0,null,!1,i))):"cell"==q.selectionSettings.selectionMode&&(F={rowIndex:J=$._focusingRowIndex,cellIndex:0},$._isShiftKeyNavigation=!1,$._cellIndex=0,$.selectCells([F])),$._cancelSaveTools())}break;case"lastRowSelection":if(0==h.length&&0==m.length){if($._isRowEdit||$.model.isEdit)return!0;Y.length>0&&((s=X[r=X.length-1]).isSummaryRow&&(s=$._getNextRecord(r-1,X,i)),q.allowPaging&&s&&($.gotoPage(q.pageSettings.totalPages),Y=$._updatedPageData),n=Y.indexOf(s),"row"==q.selectionSettings.selectionMode?q.allowSelection&&!$._rowSelectingEventTrigger(this.selectedRowIndex(),n,!1,i)&&($.selectRows(n),$._focusTreeGridElement(),$.updateScrollBar(),$._rowSelectedEventTrigger(n,null,!1,i)):"cell"==q.selectionSettings.selectionMode&&(J=$._focusingRowIndex,V=q.columns,$._isShiftKeyNavigation=!1,$._cellIndex=$._getLastVisibleColumnIndex(),F={rowIndex:J,cellIndex:$._cellIndex},$.selectCells([F])),$._cancelSaveTools())}break;case"moveCellLeft":0==h.length&&0==m.length&&($._isRowEdit?(ee=Q.closest("td").prev("td").length>0?Q.closest("td").prev("td")[0].cellIndex:-1,this._frozenColumnsLength>0&&e("#"+$._id+"EditForm").has(Q).length>0&&(ee+=this._frozenColumnsLength),(H=-1!=ee&&$._getPreviousElement(Q,ee)).length&&$._focusElementsForRowEdit(H)):q.editSettings.allowEditing&&"cellediting"==q.editSettings.editMode.toLowerCase()&&Z.length>0&&$.editFormValidate()&&(Q.blur(),K=$._moveCurrentCell("left")),q.allowSelection&&"cell"==q.selectionSettings.selectionMode&&!$._isRowEdit&&(0!=$._focusingRowIndex||0!=$._cellIndex)&&($.model.isEdit?(ie=q.currentViewData[$._cellEditingDetails.rowIndex],$._focusingRowIndex=Y.indexOf(ie),$._cellIndex=$._cellEditingDetails.columnIndex,F={rowIndex:$._focusingRowIndex,cellIndex:$._cellIndex},$.selectCells([F])):$._selectNextCell("left",i)));break;case"moveCellRight":0==h.length&&0==m.length&&($._isRowEdit?(ee=-1==(ee=Q.closest("td").next("td").length>0?Q.closest("td").next("td")[0].cellIndex:-1)&&e("#"+$._id+"EditFrozenForm").has(Q).length>0?e("#"+$._id+"EditForm").find("td").eq(0).index():ee,this._frozenColumnsLength>0&&-1!=ee&&e("#"+$._id+"EditForm").has(Q).length>0&&(ee+=this._frozenColumnsLength),(P=-1!=ee&&$._getNextElement(Q,ee)).length&&$._focusElementsForRowEdit(P)):q.editSettings.allowEditing&&("cellEditing"==q.editSettings.editMode||"batchEditing"==q.editSettings.editMode||"cell"==q.selectionSettings.selectionMode)&&Q&&Z.length>0&&this.editFormValidate()&&(Q.blur(),K=$._moveCurrentCell("right")),q.allowSelection&&"cell"==q.selectionSettings.selectionMode&&!$._isRowEdit&&($._focusingRowIndex!=$.getRows().length-1||$._cellIndex!=B-1)&&($.model.isEdit?(ie=q.currentViewData[$._cellEditingDetails.rowIndex],$._focusingRowIndex=Y.indexOf(ie),$._cellIndex=$._cellEditingDetails.columnIndex,F={rowIndex:$._focusingRowIndex,cellIndex:$._cellIndex},$.selectCells([F])):$._selectNextCell("right",i)));break;case"downArrow":if(q.allowSelection)if(0==h.length&&0==m.length&&0==c.length){if($._isRowEdit||$.model.isEdit)return!0;if(Y.length>0&&q.selectedItem&&$.selectedRowIndex()>-1&&"row"==q.selectionSettings.selectionMode)r=Y.length-1,$.selectedRowIndex()!=r&&(ge=Y[$.selectedRowIndex()],(s=X[(n=X.indexOf(ge))+1])&&s.isSummaryRow&&(s=$._getNextRecord(n+1,X)),n=Y.indexOf(s),s&&n<=r&&q.allowSelection&&!$._rowSelectingEventTrigger(this.selectedRowIndex(),n,!1,i)&&($.selectRows(n),$.updateScrollBar(),$._focusTreeGridElement(),$._rowSelectedEventTrigger($.selectedRowIndex(),null,!1,i))),$._cancelSaveTools();else if("cell"==q.selectionSettings.selectionMode&&$.selectedCellIndexes().length>0){var J=$._focusingRowIndex+1,ee=$._cellIndex,te=Y.length;$._isShiftKeyNavigation=!1,J<te&&(ge=Y[$._rowIndexOfLastSelectedCell],(s=X[(n=X.indexOf(ge))+1])&&s.isSummaryRow&&(s=$._getNextRecord(n+1,X)),J=Y.indexOf(s),s&&(F={rowIndex:J,cellIndex:ee},$._focusingRowIndex=J,$.selectCells([F]),$.updateScrollBar()))}}else h.length?$._moveToNextMenuItem("next"):c.length?p?(O=(N=u.find("div.e-columnmenuselection")).next("div.e-columnMenuListDiv")).length>0&&(N.removeClass("e-columnmenuselection"),O.addClass("e-columnmenuselection")):$._moveToNextMenuItem("next"):m.length&&(w?(O=(z=_.find("div.e-columnmenuselection")).next("div.e-columnMenuListDiv")).length>0&&(z.removeClass("e-columnmenuselection"),O.addClass("e-columnmenuselection")):(ae=m.find("div.e-columnmenuselection"),(O=$._findNextColumnMenuItem(ae,"next",!0)).length>0&&(ae.removeClass("e-columnmenuselection"),O.addClass("e-columnmenuselection"),$._focusTreeGridElement(),$._isCloseFilterMenu=!0,$._clearFilterMenu())));break;case"rightArrow":if(q.allowSelection)if(0==h.length&&0==m.length&&0==c.length){if($._isRowEdit||$.model.isEdit)return!0;var ie=Y[J=$.selectedRowIndex()];(ue={}).data=ie,ue.recordIndex=J,ue.expanded=!0,ie&&ie.hasChildRecords&&!ie.expanded&&$.selectedRowIndex()>=0&&($._trigger("expanding",ue)||q.isFromGantt||t.TreeGrid.sendExpandCollapseRequest($,ue),q.enableVirtualization&&$._focusTreeGridElement(),$.updateScrollBar()),$._cancelSaveTools(),q.allowSelection&&"cell"==q.selectionSettings.selectionMode&&($._focusingRowIndex!=$.getRows().length-1||$._cellIndex!=B-1)&&$._selectNextCell("right",i)}else if(h.length&&!f)$._moveToNextMenuItem("expand");else if(c.length&&!p)$._moveToNextMenuItem("expand"),$._showKeyboardColumnChooser(!1,c,u,e("#contextMenu_Columns"));else if(m.length&&!w){$._showKeyboardColumnChooser(!0,m,_,e("#"+$._id+"_ColumnsChooser"));var ae=m.find("div.e-columnmenuselection"),re=(_.find("div.e-columnMenuListDiv"),$._columnListPosX,$._columnFilterPosX),ne=($._columnChooserListIndex,e(document).width());if(ae.length>0&&ae[0].id==$._id+"_FilterChooser"&&!e("#"+$._id+"_ColumnMenu").find(".e-expander").hasClass("e-treegridadaptivesubicon"))if("menu"==q.filterSettings.filterType&&"excel"!=R.filterType){var oe,le=d[0].id.indexOf("_"),de="#"+d[0].id.slice(0,le),se=e(de).ejDialog("instance"),ce=($=this,{width:"auto",height:"auto",minWidth:"0px",minHeight:"0px",showHeader:!1,position:{X:1,Y:1},enableModal:!1,isResponsive:!1,enableResize:!1});e(de+"_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e(de).ejDialog(ce),ne<re+e("#"+d[0].id).width()&&(re=re-m.width()-e("#"+d[0].id).width()),m.find("div.e-columnmenuselection").closest("li").index(),oe={X:re,Y:$._columnMenuPopupY+e("#"+$._id+"_FilterChooser").position().top},se.option({position:oe}),se.open(),$._updatePreviousFilteredValue(R),d.css("z-index",$.getMaxZIndex()+1),$._focusTreeGridElement(),$._renderedSubMenuType=de+"Desktop"}else G=q.isFromGantt?e(this.element).closest(".e-gantt"):e(this.element),(L=this.getOffsetRect(G[0])).right=L.left+e(G).width(),$._openExcelFilter(R,re,$._columnMenuPopupY,L,m.width())}break;case"leftArrow":if(q.allowSelection)if(0==h.length&&0==m.length&&0==c.length){if($._isRowEdit||$.model.isEdit)return!0;var ue;ie=Y[J=$.selectedRowIndex()];(ue={}).data=ie,ue.recordIndex=J,ue.expanded=!1,ie&&ie.hasChildRecords&&ie.expanded&&$.selectedRowIndex()>=0&&($._trigger("collapsing",ue)||q.isFromGantt||t.TreeGrid.sendExpandCollapseRequest($,ue),q.enableVirtualization&&$._focusTreeGridElement(),$.updateScrollBar()),$._cancelSaveTools(),q.allowSelection&&"cell"==q.selectionSettings.selectionMode&&(0!=$._focusingRowIndex||0!=$._cellIndex)&&$._selectNextCell("left",i)}else h.length?$._moveToNextMenuItem("collapse"):c.length?($._moveToNextMenuItem("collapse"),e("#"+$._id+"ccDiv").ejDialog("close")):m.length&&(w||C)&&(e("#"+$._id+"ccDiv").ejDialog("close"),$._isCloseFilterMenu=!0,$._clearFilterMenu());break;case"upArrow":if(q.allowSelection)if(0==h.length&&0==m.length&&0==c.length){if($._isRowEdit||$.model.isEdit)return!0;if("row"==q.selectionSettings.selectionMode&&this.selectedRowIndex()>0&&Y.length>0&&q.selectedItem)ge=Y[$.selectedRowIndex()],(s=X[(n=X.indexOf(ge))-1]).isSummaryRow&&(s=$._getNextRecord(n-1,X,i)),-1==(n=Y.indexOf(s))||$._rowSelectingEventTrigger(this.selectedRowIndex(),n,!1,i)||($.selectRows(n),$.updateScrollBar(),$._focusTreeGridElement(),$._rowSelectedEventTrigger($.selectedRowIndex(),null,!1,i)),$._cancelSaveTools();else if("cell"==q.selectionSettings.selectionMode){J=$._focusingRowIndex-1,ee=$._cellIndex,te=q.flatRecords.length;$._isShiftKeyNavigation=!1,-1!=J&&(ge=Y[$._rowIndexOfLastSelectedCell],(s=X[(n=X.indexOf(ge))-1])&&s.isSummaryRow&&(s=$._getNextRecord(n-1,X,i)),J=Y.indexOf(s),s&&(F={rowIndex:J,cellIndex:ee},$._focusingRowIndex=J,$.selectCells([F]),$.updateScrollBar()))}}else h.length?$._moveToNextMenuItem("prev"):c.length?p?(W=(N=u.find("div.e-columnmenuselection")).prev("div.e-columnMenuListDiv")).length>0&&(N.removeClass("e-columnmenuselection"),W.addClass("e-columnmenuselection")):$._moveToNextMenuItem("prev"):m.length&&(w?(W=(z=_.find("div.e-columnmenuselection")).prev("div.e-columnMenuListDiv")).length>0&&(z.removeClass("e-columnmenuselection"),W.addClass("e-columnmenuselection")):(ae=m.find("div.e-columnmenuselection"),(W=$._findNextColumnMenuItem(ae,"prev",!0)).length>0&&(ae.removeClass("e-columnmenuselection"),W.addClass("e-columnmenuselection"),$._isCloseFilterMenu=!0,$._clearFilterMenu())));break;case"deleteRecord":if(q.isFromGantt&&1==q.readOnly)return;if(q.editSettings.allowDeleting&&0==h.length&&0==m.length){if($._isRowEdit||$.model.isEdit)return!0;$.selectedRowIndex()>=0&&($.deleteRow(),$._cancelSaveTools(),$._focusTreeGridElement())}break;case"totalRowCollapse":if(0==h.length&&0==m.length){$.model.isFromGantt?((ue={}).requestType="collapseAll",$._trigger("expandAllCollapseAllRequest",ue)):$.collapseAll();break}case"totalRowExpand":0==h.length&&0==m.length&&($.model.isFromGantt?((ue={}).requestType="expandAll",$._trigger("expandAllCollapseAllRequest",ue)):$.expandAll());break;case"spaceBar":A=null,m.length&&w&&(A=(z=_.find("div.e-columnmenuselection")).data("column"),t.isNullOrUndefined(A)||z.find("span").hasClass("e-disable")||("true"==z.find("span").attr("aria-checked")?$.hideColumn(A):$.showColumn(A))),$._checkboxSelection&&Q.hasClass("e-treegrid")&&0==e("#"+$._id+"EditForm").length&&($._rowSelectingEventTrigger(this.selectedRowIndex(),this.selectedRowIndex(),!0,i)||($.selectRows(this.selectedRowIndex(),null,!0),$._cancelSaveTools(),$._rowSelectedEventTrigger(this.selectedRowIndex(),null,!0,i)));break;case"shiftDownArrow":if(q.allowSelection&&"multiple"==q.selectionSettings.selectionType)if("cell"==q.selectionSettings.selectionMode){te=Y.length;var pe,he=$._selectedCellDetails.length,ge=Y[$._rowIndexOfLastSelectedCell];if((s=X[(n=X.indexOf(ge))+1])&&s.isSummaryRow&&(s=$._getNextRecord(n+1,X)),!s)return;if(pe=Y.indexOf(s),$._focusingRowIndex>$._rowIndexOfLastSelectedCell){for($._rowIndexOfLastSelectedCell=pe,$._selectedCellDetails.sort(function(e,t){return parseFloat(e.rowIndex)-parseFloat(t.rowIndex)}),$._getSelectedCellsinARow($._selectedCellDetails[0].data.index,$._selectedCellDetails),j=0;j<$._selectedCellsinARow.length;j++)U=$._selectedCellDetails.indexOf($._selectedCellsinARow[j]),e($._selectedCellsinARow[j].cellElement).removeClass("e-selectingcell"),$._selectedCellDetails.splice(U,1);$.updateScrollBar()}else pe<te&&(ue={rowIndex:pe,cellIndex:$._lastSelectedCellIndex},$.updateScrollBar(),$._shiftKeySelectCells(ue),$._rowIndexOfLastSelectedCell=pe)}else $._selectedItemDown(i);break;case"shiftUpArrow":if(q.allowSelection&&"multiple"==q.selectionSettings.selectionType)if("cell"==q.selectionSettings.selectionMode){if(he=$._selectedCellDetails.length,ge=Y[$._rowIndexOfLastSelectedCell],(s=X[(n=X.indexOf(ge))-1])&&s.isSummaryRow&&(s=$._getNextRecord(n-1,X,"upArrow")),!s)return;if(pe=Y.indexOf(s),he>0&&$._focusingRowIndex<$._rowIndexOfLastSelectedCell){for($._rowIndexOfLastSelectedCell=pe,$._getSelectedCellsinARow($._selectedCellDetails[he-1].data.index,$._selectedCellDetails),j=0;j<$._selectedCellsinARow.length;j++)U=$._selectedCellDetails.indexOf($._selectedCellsinARow[j]),e($._selectedCellsinARow[j].cellElement).removeClass("e-selectingcell"),$._selectedCellDetails.splice(U,1);$.updateScrollBar()}else pe>=0&&(ue={rowIndex:pe,cellIndex:$._lastSelectedCellIndex},$._rowIndexOfLastSelectedCell=pe,$.updateScrollBar(),$._shiftKeySelectCells(ue))}else $._selectedItemUp(i);break;case"shiftRightArrow":q.allowSelection&&"cell"==q.selectionSettings.selectionMode&&"multiple"==q.selectionSettings.selectionType&&(B=q.columns.length,(ee=$._lastSelectedCellIndex+1)<B-1&&(!q.columns[ee].visible||!q.columns[ee].allowCellSelection)&&(ee=$.getUpNextVisibleColumnIndex(ee)),ee<B&&(ue={rowIndex:$._rowIndexOfLastSelectedCell,cellIndex:ee},$._shiftKeyFirstElementDetails.firstElementRowIndex=$._focusingRowIndex,$._shiftKeySelectCells(ue),$._lastSelectedCellIndex=ee));break;case"shiftLeftArrow":q.allowSelection&&"cell"==q.selectionSettings.selectionMode&&"multiple"==q.selectionSettings.selectionType&&(-1==(ee=$._lastSelectedCellIndex-1)||q.columns[ee].visible&&q.columns[ee].allowCellSelection||(ee=$.getPreviousVisibleColumnIndex(ee)),ue={rowIndex:$._rowIndexOfLastSelectedCell,cellIndex:ee},-1!=ee&&($._shiftKeyFirstElementDetails.firstElementRowIndex=$._focusingRowIndex,$._shiftKeySelectCells(ue),$._lastSelectedCellIndex=ee));break;case"shiftHomeButton":"cell"==q.selectionSettings.selectionMode&&"multiple"==q.selectionSettings.selectionType&&(ue={rowIndex:J=$._rowIndexOfLastSelectedCell,cellIndex:0},$._cellIndex=0,$._lastSelectedCellIndex=0,$._shiftKeySelectCells(ue));break;case"shiftEndButton":"cell"==q.selectionSettings.selectionMode&&"multiple"==q.selectionSettings.selectionType&&(J=$._rowIndexOfLastSelectedCell,V=q.columns,$._cellIndex=V.length-1,ue={rowIndex:J,cellIndex:$._cellIndex},$._lastSelectedCellIndex=$._cellIndex,$._shiftKeySelectCells(ue));break;default:K=!0}return K},_showKeyboardColumnChooser:function(t,i,a,r){var n,o,l,d=this,s=d.model,c={};c.width="auto",c.height="auto",c.minWidth="0px",c.minHeight="0px",c.showHeader=!1,c.position={X:1,Y:1},c.enableModal=!1,c.isResponsive=!1,c.enableResize=!1,c.cssClass=s.cssClass,e("#"+d._id+"ccDiv_wrapper").addClass("e-treegridadaptivedialog"),e("#"+d._id+"ccDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e("#"+d._id+"ccDiv").ejDialog(c),e("#"+d._id+"ccDiv").css({height:"auto"});var u=i.find("div.e-columnmenuselection"),p=a.find("div.e-columnMenuListDiv"),h=d._columnListPosX,g=d._columnMenuPopupY,m=e(document).width(),_=t?i.width():d._headerContextMenuWidth;if(d._updateColumnMenuVisibility(),!(u.length>0&&u[0].id==r[0].id)||i.find(".e-expander").hasClass("e-treegridadaptivesubicon"))return!1;n=e("#"+d._id+"ccDiv").ejDialog("instance"),o=e("#"+d._id+"ccDiv_wrapper").width(),n.open(),m<h+i.width()&&(h=h-_-o),l={X:h,Y:g+r.position().top},n.option({position:l}),a.css("z-index",d.getMaxZIndex()+1),p.removeClass("e-columnmenuselection"),p.eq(0).addClass("e-columnmenuselection"),d._focusTreeGridElement(),d._renderedSubMenuType="ColumnDesktop"},_getNextElement:function(i,a){var r=this,n=r.model.columns;return i=i.closest("td").next("td"),this._frozenColumnsLength>0&&0==i.length&&(i=e("#"+r._id+"EditForm").find("td").eq(0),a=this._frozenColumnsLength),0!=i.length&&(!t.isNullOrUndefined(n[a])&&t.isNullOrUndefined(n[a].allowEditing)||n[a].allowEditing?i:a+1<n.length&&r._getNextElement(i,a+1))},_getPreviousElement:function(i,a){var r=this,n=r.model.columns;return i=i.closest("td").prev("td"),this._frozenColumnsLength>0&&0==i.length&&(i=e("#"+r._id+"EditFrozenForm").find("td").last()),0!=i.length&&a>-1&&(!t.isNullOrUndefined(n[a])&&t.isNullOrUndefined(n[a].allowEditing)||n[a].allowEditing?i:r._getPreviousElement(i,a-1))},_clearAllFilter:function(){var e=this,t=e.model.filterSettings.filteredColumns[0];e.model.allowFiltering=!0,e.model.filterSettings.filteredColumns=[],e.filterColumn(t.field,t.operator,"","and"),e._filteredColumnValue=[],e._filteredColumnValueID=[]},filterColumn:function(i,a,r,n,o,l){var d,s,c,u,p,h,g,m=this,_=m.model.filterSettings.filteredColumns;if(this.model.allowFiltering){if(m._batchEditStarts&&!m._confirmDialog.is(":visible"))return m._batchSaveLostWarning("Filtering"),(d=m._batchTempDetails).fieldName=i,d.filterOperator=a,d.filterValue=r,d.predicate=n,d.matchcase=o,d.actualFilterValue=l,!1;for((s={}).requestType=t.TreeGrid.Actions.Filter,s.currentFilterObject=[],Array.isArray(a)||(a=e.makeArray(a)),Array.isArray(r)||(r=e.makeArray(r)),c=!1,this._filterCollection,t.util.isNullOrUndefined(this._currentFilterColumn)&&(this._currentFilterColumn=this.getColumnByField(i)),u=0;u<a.length;u++){if(p={field:i,operator:a[u],value:r[u],matchcase:o,predicate:n,actualFilterValue:l},this._$colType="string",0==_.length&&""!==p.value)"date"!=this._$colType||"equal"!=a&&"notequal"!=a||"string"==typeof p.value?_.push(p):this._setDateFilters(p);else{if(m=this,!c){var f=t.DataManager(_),w=(new t.Query).where("field",t.FilterOperators.equal,p.field),C=f.executeLocal(w);for(h=0;h<C.length;h++)-1!=(g=e.inArray(C[h],_))&&_.splice(g,1)}""!==p.value&&("date"!=this._$colType||"equal"!=a&&"notequal"!=a||"string"==typeof p.value?_.push(p):this._setDateFilters(p))}c=!0,s.currentFilterObject.push(p)}s.filterCollection=_,s.currentFilteringColumn=i,s.fieldName=i,this.processBindings(s)&&(_.reverse().splice(0,a.length),_.reverse()),m._setFilterFieldValues(p)}},filterContent:function(e){var i,a,r,n,o=this,l=o.model.filterSettings.filteredColumns;if(!(e instanceof t.Predicate))return!1;-1!=(i=l.indexOf(e))?l.splice(i,1):(r=[],(a=[]).push(e.toJSON()),o._addPredicateObject(a,r),t.merge(l,r)),n={requestType:"filtering"},o.processBindings(n),o._setFilterFieldValues(r)},_addPredicateObject:function(e,i,a){for(var r,n,o=e.length,l=0;l<o;l++)(r=e[l]).isComplex?t.isNullOrUndefined(r.predicates)||this._addPredicateObject(r.predicates,i,r.condition):((n={}).field=r.field,n.operator=r.operator,n.value=r.value,n.matchcase=!r.ignoreCase,n.predicate=a,i.push(n))},_setFilterFieldValues:function(i){var a,r,n,o,l,d,s=this,c=s.model.filterSettings.filterType,u=[];for(t.isNullOrUndefined(i.length)?u.push(i):u=i,r=u.length,n=0;n<r;n++)o=u[n],(a=s.getColumnByField(o.field))&&("menu"==c||"excel"==c?(s.model.showColumnChooser||(l=s.getHeaderTable().find("div[data-ej-mappingname='"+o.field+"']").next(".e-filtericon"),""!=o.value.toString()||"false"==o.value.toString()?l.removeClass("e-column-filter-icon").addClass("e-column-filtered-icon"):l.removeClass("e-column-filtered-icon").addClass("e-column-filter-icon")),"menu"==c?(s._storePreviousFilteredValue(o.field,o.value,o.operator),s._filterString=o.value):s._filteredColumnValueID.push(o.field)):"filterbar"==c&&(d=s.getHeaderTable().find("#"+s._id+"_"+o.field.split(".").join("")+"_filterbarcell"),"numericedit"==a.filterEditType?e(d).ejNumericTextbox({value:o.value}):"datepicker"==a.filterEditType?e(d).ejDatePicker({value:o.value}):"datetimepicker"==a.filterEditType?e(d).ejDateTimePicker({value:o.value}):"dropdownedit"==a.filterEditType?e(d).ejDropDownList({value:o.value}):(""==d.val()||d.val()!=o.value)&&d.val(o.value)))},_cellSelectingEventTrigger:function(e){var t=this,i=(t.model,{}),a=e.rowIndex,r=e.cellIndex,n=t.getUpdatedRecords();return i.data=n[a],i.targetRow=e.rowElement,i.targetCell=e.cellElement,i.rowIndex=a,i.cellIndex=r,t._trigger("cellSelecting",i)},_cellSelectedEventTrigger:function(e,t){var i=this,a=(i.model,{}),r=e.rowIndex,n=e.cellIndex,o=t.rowIndex,l=t.cellIndex,d=i.getUpdatedRecords();return a.PreviousTargetRow=t.rowElement,a.previousTargetCell=t.cellElement,a.previousData=d[o],a.previousRowIndex=o,a.previousCellIndex=l,a.data=d[r],a.targetRow=e.rowElement,a.targetCell=e.cellElement,a.rowIndex=r,a.cellIndex=n,i._trigger("cellSelected",a)},_rowSelectingEventTrigger:function(e,i,a,r){var n,o=this,l=o.model,d={},s=o.getUpdatedRecords();return a||(a=!1),d.targetRow=t.TreeGrid.getRowByIndex(o,i),d.previousTreeGridRow=t.TreeGrid.getRowByIndex(o,e),d.data=s[i],d.previousData=s[e],d.recordIndex=i,d.previousIndex=e,d.actionType=t.isNullOrUndefined(r)?null:r,o.model.isFromGantt?d.target="ejTreeGrid":d.isCheckboxUpdate=a,(n=o._trigger("rowSelecting",d))&&(l.selectedItem=d.data),n},_rowSelectedEventTrigger:function(i,a,r,n){var o=this,l=o.model,d={},s=o.getUpdatedRecords(),c=e.extend({},s[i]);delete c.childRecords,delete c.parentItem,(d={targetRow:t.TreeGrid.getRowByIndex(o,i),recordIndex:i}).actionType=t.isNullOrUndefined(n)?null:n,r||(r=!1),t.isNullOrUndefined(a)||(d.toIndex=a),o.model.isFromGantt?(d.target="ejTreeGrid",d.data=l.updatedRecords[i],d.selectedItems=l.selectedItems):(d.data=c,d.isCheckboxUpdate=r),o._trigger("rowSelected",d)},_eventBindings:function(i){var a,r,n,o=this,l=o.model,d=0,s=o.getUpdatedRecords(),c=o.getRows();if(t.isNullOrUndefined(i)?(r=this._frozenColumnsLength>0?e(c[0]).length:e(c).length,i=l.currentViewData):r=i.length,o._commandColumnLength>0&&this._refreshUnboundTemplate(this.getContentTable()),null!=l.queryCellInfo||null!=l.rowDataBound||l.detailsDataBound)for(;d<r;d++)n=s.indexOf(i[d]),a=t.TreeGrid.getRowByIndex(this,n),o._rowEventTrigger(a,i[d])},_rowEventTrigger:function(t,i){var a,r=this,n=this.model;n.rowDataBound&&r._trigger("rowDataBound",{rowElement:t,data:i});t.cells;var o=e(t).find(".e-rowcell"),l=0,d=o.length,s=null,c=r.model.columns;if(n.queryCellInfo)for(;l<d;l++)e(o[l]).hasClass("e-rowcell")&&(s=c[l]),s&&r._cellEventTrigger(o[l],i,s);n.detailsDataBound&&e(t).next("tr").hasClass("e-detailsrow")&&(a=e(t).next("tr"),this._frozenColumnsLength>0&&(a=e(a[1])),this._trigger("detailsDataBound",{detailsElement:a,data:i}))},_cellEventTrigger:function(e,t,i){var a={cellElement:e,data:t,column:i};a.cellValue=a.column&&this._getCustomCellValue(t,a.column.field),this._trigger("queryCellInfo",a)},_completeAction:function(i){var a,r,n=this,o=n.model,l=o.sortSettings.sortedColumns,d=e("#"+n._id.replace("ejTreeGrid","")).data("ejGantt");if(o.isEdit=!1,o.allowPaging&&i.requestType!=t.TreeGrid.Actions.Scroll&&this._refreshGridPager(),t.TreeGrid.Actions.Sorting==i.requestType&&o.allowSorting||t.TreeGrid.Actions.Refresh==i.requestType){if(o.allowSorting)for(n._multiSortRequest||(n.getHeaderTable().find(".e-columnheader").find(".e-headercelldiv").find(".e-ascending,.e-descending").remove(),n.getHeaderTable().find("[aria-sort]").removeAttr("aria-sort")),a=0;a<l.length;a++)n._addSortElementToColumn(l[a].field,l[a].direction);n._multiSortRequest=!1}else t.TreeGrid.Actions.BeginEdit==i.requestType||t.TreeGrid.Actions.Add==i.requestType?(r=e("#"+n._id+"EditForm"),n.model.isEdit=!0,n.setWidthToColumns(),t.TreeGrid.Actions.Add==i.requestType&&r.find(".e-field:disabled").not(".e-identity").removeAttr("disabled").removeClass("e-disable"),e.isFunction(e.validator)&&this._initValidator()):o.isFromGantt&&i.requestType===t.TreeGrid.Actions.Scroll&&n._updateCurrentViewData();o.isFromGantt&&(d.model.sortSettings=o.sortSettings),(n._moveRow||"batchediting"==o.editSettings.editMode.toLowerCase())&&i.requestType!==t.TreeGrid.Actions.Refresh||n._trigger("actionComplete",i)},sendDataRenderingRequest:function(i){var a,r,n,o,l,d,s,c,u=this,p=this.model;if(u.model.currentViewData.length)switch(i.requestType){case t.TreeGrid.Actions.Delete:case t.TreeGrid.Actions.Refresh:case t.TreeGrid.Actions.Save:case t.TreeGrid.Actions.Filter:case t.TreeGrid.Actions.Sorting:case t.TreeGrid.Actions.Searching:case t.TreeGrid.Actions.ExpandCollapse:case t.TreeGrid.Actions.RefreshDataSource:case t.TreeGrid.Actions.DragAndDrop:case t.TreeGrid.Actions.Paging:case t.TreeGrid.Actions.Scroll:case t.TreeGrid.Actions.RowIndexUpdate:if(a=document.createElement("div"),i.requestType!=t.TreeGrid.Actions.Scroll)this._frozenColumnsLength>0?u._renderFrozenRecords():(u.getContentTable().find("colgroup").first().replaceWith(u._getMetaColGroup()),(h=u.getContentTable().children("tbody")).empty(),a.innerHTML=["<table>",e.render[u._id+"_Template"](u.model.currentViewData),"</table>"].join(""),u.getContentTable().get(0).replaceChild(a.firstChild.firstChild,u.getContentTable().get(0).lastChild),u.setGridRows(e(u.getContentTable().get(0).rows)));else{var h=u.getContentTable().children("tbody"),g=u.model.currentViewData,m=u._visibleRange,_=this._frozenColumnsLength>0?e(h[0]).children("tr:not(.e-detailsrow)").length:h.children("tr:not(.e-detailsrow)").length,f=!1;0!=g.length&&0!=h.find(".e-emptyText").length&&h.find(".e-emptyText").remove(),u._scrollTop>u._prevScrollTop?(r=m.top-u._prevRTop,(n=m.bottom-u._prevRBottom)>=0?o=n?g.slice(-n):[]:(this._frozenColumnsLength>0?(e(h.get(0)).children(":visible:gt("+(_+(n-1))+")").remove(),e(h.get(1)).children(":visible:gt("+(_+(n-1))+")").remove()):p.showDetailsRow&&!p.showDetailsRowInfoColumn?(l=2*(_+(n-1)),h.children(":visible:gt("+l+")").remove()):h.children(":visible:gt("+(_+(n-1))+")").remove(),o=[]),f=!0):(r=_-(u._prevRBottom-m.bottom+1),o=(n=u._prevRTop-m.top)>=0?g.slice(0,n):[],r=r>=0?r:-_-1,f=!1),this._frozenColumnsLength>0?u._renderFrozenRecords(o,n,r,f):(u.getContentTable().find("colgroup").first().replaceWith(u._getMetaColGroup()),f?(p.showDetailsRow&&!p.showDetailsRowInfoColumn?(l=2*r,h.children(":visible:lt("+l+")").remove()):h.children(":visible:lt("+r+")").remove(),d=e.render[u._id+"_Template"](o),h.append(d)):(p.showDetailsRow&&!p.showDetailsRowInfoColumn?(l=2*r+1,h.children(":visible:gt("+l+")").remove()):h.children(":visible:gt("+r+")").remove(),d=e.render[u._id+"_Template"](o),h.prepend(d)),u._gridRows=u.getContentTable().find("tr"),u.setGridRows(u._gridRows))}this._gridRows=this.getContentTable().get(0).rows,this._frozenColumnsLength>0&&(this._gridRows=[this._gridRows,this.getContentTable().get(1).rows]),u._$gridContent&&u._isRendered&&(u._trigger("refresh"),u._eventBindings(o),this._hideCollapsedDetailsRows())}else u._frozenColumnsLength>0?(s=t.buildTag("td",p.emptyRecordText,{},{colSpan:this._frozenColumns.length}),c=document,u.getContent().find("#e-frozencontentdiv"+u._id+" .e-table tbody").empty().append(e(c.createElement("tr")).addClass("e-emptyText").height(30).append(s)),s=t.buildTag("td",p.emptyRecordText,{visibility:"hidden"},{colSpan:this._unFrozenColumns.length}),u.getContent().find("#e-movablecontentdiv"+u._id+" .e-table tbody").empty().append(e(c.createElement("tr")).addClass("e-emptyText").height(30).append(s)),0==p.updatedRecords.length&&u._$gridContainer.find("#e-movablecontentdiv"+u._id+",#e-frozencontentdiv"+u._id).css("height","30px")):(u.getContentTable().find("tbody").empty().append(u._getEmptyTbody()),0==p.updatedRecords.length&&u._$gridContainer&&u._$gridContainer.css({height:"30px"})),u._gridRows=null,u.setGridRows(null);(u.model.showGridCellTooltip||u.model.showGridExpandCellTooltip)&&(u._cellMouseLeave(),u._headerMouseLeave()),i.requestType==t.TreeGrid.Actions.Scroll&&(i.requestType,t.TreeGrid.Actions.Refresh),u._completeAction(i)},_renderFrozenRecords:function(i,a,r,n){var o,l,d,s,c;this.getContent().find("#e-frozencontentdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[0]),this.getContent().find("#e-movablecontentdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[1]),o=this.getContentTable().children("tbody"),t.isNullOrUndefined(i)?(o.empty(),(l=document.createElement("div")).innerHTML=["<table>",e.render[this._id+"_JSONFrozenTemplate"](this.model.currentViewData),"</table>"].join(""),this.getContentTable().get(0).replaceChild(l.firstChild.firstChild,this.getContentTable().get(0).lastChild),(l=document.createElement("div")).innerHTML=["<table>",e.render[this._id+"_Template"](this.model.currentViewData),"</table>"].join(""),this.getContentTable().get(1).replaceChild(l.firstChild.firstChild,this.getContentTable().get(1).lastChild)):n?(this.model.showDetailsRow&&!this.model.showDetailsRowInfoColumn?(d=2*r,e(o.get(0)).children(":visible:lt("+d+")").remove(),e(o.get(1)).children(":visible:lt("+d+")").remove()):(e(o.get(0)).children(":visible:lt("+r+")").remove(),e(o.get(1)).children(":visible:lt("+r+")").remove()),s=e.render[this._id+"_JSONFrozenTemplate"](i),c=e.render[this._id+"_Template"](i),e(o.get(0)).append(s),e(o.get(1)).append(c)):(this.model.showDetailsRow&&!this.model.showDetailsRowInfoColumn?(d=2*r+1,e(o.get(0)).children(":visible:gt("+d+")").remove(),e(o.get(1)).children(":visible:gt("+d+")").remove()):(e(o.get(0)).children(":visible:gt("+r+")").remove(),e(o.get(1)).children(":visible:gt("+r+")").remove()),s=e.render[this._id+"_JSONFrozenTemplate"](i),c=e.render[this._id+"_Template"](i),e(o.get(0)).prepend(s),e(o.get(1)).prepend(c)),this.setGridContentTable(this.getContent().find(".e-table"))},_renderByFrozenDesign:function(){var i=e(document.createElement("div")),a=this._getMetaColGroup().find("col"),r={};return r.colgroup1=i.append(t.buildTag("colgroup").append(a.splice(0,this._frozenColumnsLength))).html(),r.colgroup2=i.html(t.buildTag("colgroup").append(a)).html(),e.render[this._id+"_FrozenTemplate"](r)},addFrozenTemplate:function(){var t="<div class='e-frozencontainer' id='e-frozencontainer"+this._id+"' style='overflow:hidden;float:left;'><div class='e-frozencontentdiv' id='e-frozencontentdiv"+this._id+"' style='width:100%;'><table class='e-table e-zerospace' style='width:100%' id='"+this._id+"frozene-table'>{{:colgroup1}}<tbody></tbody></table></div></div><div class='e-movablecontainer' id='e-movablecontainer"+this._id+"'><div class='e-movablecontent' id='e-movablecontent"+this._id+"'><div class='e-movablecontentdiv' id='e-movablecontentdiv"+this._id+"'><table class='e-table e-zerospace' id='"+this._id+"movablee-table'>{{:colgroup2}}<tbody></tbody></table></div></div></div>",i={};i[this._id+"_FrozenTemplate"]=t,e.templates(i)},sortSetting:function(t){var i,a=this,r=this.model,n=e("#"+a._id).find(".e-ascending.e-icon"),o=e("#"+a._id).find(".e-descending.e-icon");if(r.allowSorting=t,r.allowSorting||a.clearSorting(),n.length>0)for(i=0;i<n.length;i++)e(n[i]).css("visibility","hidden");if(o.length>0)for(i=0;i<o.length;i++)e(o[i]).css("visibility","hidden")},columnIndex:function(e){var t=this,i=t.model,a=(e=parseInt(e),i.columns);if(!isNaN(e)&&e>=0&&e<a.length&&a[e].visible&&!t._isCommandColumn(a[e])){if(a[e].nonColumn){if(!a[e+1]||!a[e+1].visible||t._isCommandColumn(a[e+1]))return;i.treeColumnIndex=e+1}else i.treeColumnIndex=e;t._addInitTemplate(),this.renderRecords(),i.showColumnChooser&&t._renderColumnChooserList(!0),t._updateWrapRowHeights("header","refreshAll")}},sortColumn:function(e,a){var r,n=this,o=n.model,l=o.sortSettings.sortedColumns,d={},s=0,c=l.length;if(n._cancelEditState(),n.clearSelection(),o.isFromGantt&&(r=t.TreeGrid.getColumnByMappingName(o.columns,e)),t.isNullOrUndefined(r)&&(r=this.getColumnByField(e)),o.allowSorting&&!t.isNullOrUndefined(r)&&0!=r.allowSorting){for(n._multiSortRequest||(o.sortSettings.sortedColumns=[]),d.requestType=t.TreeGrid.Actions.Sorting,d.columnName=e,n._cSortedColumn=e,n._cSortedDirection=d.columnSortDirection=a===i?t.sortOrder.Ascending:a;s<c;s++)if(l[s].field==n._cSortedColumn){l.splice(s,1);break}o.sortSettings.sortedColumns.push({field:n._cSortedColumn,direction:n._cSortedDirection}),n.processBindings(d)&&(n._cSortedDirection=n._cSortedColumn=null),n.selectedRowIndex()>=0&&n._isRendered&&n.selectedRowIndex(n._sortedRecords.indexOf(this.selectedItem())),n._clearColumnMenu(),n._clearContextMenu()}},clearSorting:function(){var e;this.model.sortSettings.sortedColumns=[],(e={}).requestType=t.TreeGrid.Actions.Sorting,this.processBindings(e)},deleteRow:function(i,a,r){var n,o,l=this,d=l.model,s=d.editSettings.editMode.toLowerCase(),c=l.getUpdatedRecords(),u=[];if(!d.editSettings.allowDeleting)return!1;if(d.editSettings.showDeleteConfirmDialog&&!l._confirmDialog.is(":visible")&&"batchediting"!=s&&!l._isEmptyRow)return l._isFromContextmenu=a,l._deleteRowIndex=r,void l._confirmDialog.ejDialog("open");if((n={}).requestType=t.TreeGrid.Actions.Delete,n.isFromContextmenu=a,a){if(n.data=d.isFromGantt?c[r]:!d.allowSelection&&!t.isNullOrUndefined(r)&&r>-1?c[r]:"row"==d.selectionSettings.selectionMode?d.selectedItem:l._rowIndexOfLastSelectedCell>-1?c[l._rowIndexOfLastSelectedCell]:c[l._emptyRowIndex],u.push(n.data),l._isEmptyRow)return n.deletedItems=u,l._updateDeleteAction(n),!0}else u=e.extend([],d.selectedItems),n.data=d.selectedItem;if(u.length||u.push(n.data),n.deletedItems=u,"batchediting"==s)if("save"==l._batchSaveCancel)n.data={},n.deletedItems=l.batchChanges.deleted;else{if("cancel"!=l._batchSaveCancel){for(o=0;o<u.length;o++)l._batchDeleteAction(u[o]),l._updateBatchDeletedRecords(u[o]);return l.clearSelection(),l._batchEditStarts=!0,l._cancelSaveTools(),!0}n.data={},n.deletedItems=l.batchChanges.added}if(l._trigger("actionBegin",n))return!0;l._updateAction(n)&&l._updateDeleteAction(n)},_batchDeleteAction:function(e){var t,i,a=this,r=a.model,n=(r.allowPaging?a._updatedPageData:r.updatedRecords).indexOf(e);if(e.isBatchDelete=!0,a.refreshRow(n),e.hasChildRecords)for(t=e.childRecords,i=0;i<t.length;i++)this._batchDeleteAction(t[i])},_updateBatchDeletedRecords:function(e){var t=this,i=t.batchChanges.changed,a=t.batchChanges.added;a.length>0&&-1!=a.indexOf(e)?a.splice(a.indexOf(e),1):i.length>0&&-1!=i.indexOf(e)&&i.splice(i.indexOf(e),1),-1==t.batchChanges.deleted.indexOf(e)&&t.batchChanges.deleted.push(e)},_updateDeleteAction:function(e){for(var i=this,a=i.model,r=a.editSettings.editMode.toLowerCase(),n=e.deletedItems.length,o=0;o<n;o++)e.data=e.deletedItems[o],i._selectedCellDetails=[],i._removeRecords(e);if("batchediting"==r&&("save"==i._batchSaveCancel||"cancel"==i._batchSaveCancel))return!0;i._ensureDataSource(e),i.updateHeight(),a.currentViewData.length>0&&a.enableAltRow&&t.TreeGrid.updateAltRow(i,a.currentViewData[0],0,0),i._checkboxSelection?(a.selectedCellIndexes=[],i._prevSelectedItem=null,e.isFromContextmenu||(a.selectedItems=[]),a.selectedItem=null,i.selectedRowIndex(-1),i.selectAllRows()):(a.selectedItems=[],a.selectedCellIndexes=[],a.selectedItem=null,i.selectedRowIndex(-1),i._prevSelectedItem=null,i._multiSelectPopup&&i._multiSelectPopup.is(":visible")&&!i.model.isFromGantt&&i._clearMultiSelectPopup()),i._isLoadonDemand&&a.allowPaging&&i._refreshDataSource()},_removeRecords:function(e){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C=this,T=C.model,x=T.editSettings.editMode.toLowerCase(),v=!1,b=this.dataSource();if(e&&(T.editSettings.allowDeleting||e.isDragAndDropDelete)&&e.requestType===t.TreeGrid.Actions.Delete){if(i=e.data,T.isFromGantt&&C.model.enableWBS&&(l=!1,i&&i.parentItem?o=(n=i.parentItem.childRecords).indexOf(i):T.flatRecords.length&&(o=(n=T.flatRecords.filter(function(e){return e&&0==e.level})).indexOf(i)),o!=n.length-1&&(l=!0)),a=T.flatRecords.indexOf(i),"resourceView"==T.viewType&&(d={data:e.data},C._trigger("updateResource",d),C.dataSource(d.returnObj.dataSource),C._jsonData=d.returnObj.jsondata,d.returnObj.tasks.length>0&&(v=!0)),i.parentItem&&((s=i.parentItem.childRecords)&&s.length>0)){for(c=s.indexOf(i),i.parentItem.childRecords.splice(c,1),e.updatedHierarchyRowIndexData=[],g=c;g<s.length;g++)s[g].hierarchyRowIndex=g,T.hierarchyRowIndexMapping&&(s[g].item[T.hierarchyRowIndexMapping]=g),i.isBatchAdd||("batchediting"!=x?e.updatedHierarchyRowIndexData.push(s[g]):-1==C.batchChanges.updatedHierarchyRowIndexData.indexOf(s[g])&&C.batchChanges.updatedHierarchyRowIndexData.push(s[g]));T.showSummaryRow&&((u=T.summaryRows.length)==s.length&&(i.parentItem.childRecords.splice(0,u),T.flatRecords.splice(a,u))),T.parentIdMapping||"resourceView"==T.viewType||i.parentItem.item[T.childMapping].splice(c,1)}if(C._checkboxSelection&&!e.isDragAndDropDelete)if(e.isFromContextmenu)C._removeChildRecords(T.selectedItems,e.data);else for(;T.selectedItems.length>0;)C._removeChildRecords(T.selectedItems,T.selectedItems[0]);if(-1!==(p=T.parentRecords.indexOf(i)))for(T.parentRecords.splice(p,1),h=T.parentRecords,e.updatedHierarchyRowIndexData=[],g=p;g<h.length;g++)h[g].hierarchyRowIndex=g,T.hierarchyRowIndexMapping&&(h[g].item[T.hierarchyRowIndexMapping]=g),i.isBatchAdd||("batchediting"!=x?e.updatedHierarchyRowIndexData.push(h[g]):-1==C.batchChanges.updatedHierarchyRowIndexData.indexOf(h[g])&&C.batchChanges.updatedHierarchyRowIndexData.push(h[g]));-1!==a&&(m=C.getChildCount(i,0),T.flatRecords.splice(a,m+1),T.ids&&T.ids.splice(a,m+1),v&&(T.flatRecords.push.apply(T.flatRecords,d.returnObj.tasks),T.ids&&T.ids.push.apply(T.ids,d.returnObj.ids),T.parentRecords.push.apply(T.parentRecords,d.returnObj.tasks)),"resourceView"==T.viewType&&"resourceTask"==i.eResourceTaskType&&i.parentItem&&0==i.parentItem.childRecords.length&&(_=T.flatRecords.indexOf(i.parentItem),T.flatRecords.splice(_,1),T.ids&&T.ids.splice(_,1),-1!=(_=T.parentRecords.indexOf(i.parentItem))&&T.parentRecords.splice(_,1))),T.updatedRecords=T.enableVirtualization?C.getExpandedRecords(T.flatRecords):T.flatRecords.slice(),C.updateCollapsedRecordCount(),T.parentIdMapping||"resourceView"==T.viewType?"resourceView"!=T.viewType&&(i.hasChildRecords&&i.childRecords.length>0&&C._removeChildItem(i),b instanceof t.DataManager?b.dataSource.offline&&b.dataSource.json?-1!==(f=b.dataSource.json.indexOf(i.item))&&b.dataSource.json.splice(f,1):C._isDataManagerUpdate&&(-1!==(f=C._jsonData.indexOf(i.item))&&C._jsonData.splice(f,1)):-1!==(f=b.indexOf(i.item))&&b.splice(f,1)):b instanceof t.DataManager?b.dataSource.offline&&b.dataSource.json?-1!==(r=b.dataSource.json.indexOf(i.item))&&b.dataSource.json.splice(r,1):C._isDataManagerUpdate&&(r=C._jsonData.indexOf(i.item),C._jsonData.splice(r,1)):-1!==(r=b.indexOf(i.item))&&b.splice(r,1),i.parentItem&&i.parentItem.childRecords&&0==i.parentItem.childRecords.length&&(i.parentItem.expanded=!1,i.parentItem.hasChildRecords=!1,i.parentItem.hasFilteredChildRecords=!0),T.showSummaryRow&&C._updateSummaryRow(e),T.showTotalSummary&&C._updateTotalSummaryRow(e),l&&(i.parentItem?w=n[o]:(n.splice(o,1),w=n[o]),C.updateWBSdetails(w)),T.isFromGantt&&(C.updateSerialNumber(a),T.enableSerialNumber&&C.updateSerialNumberPredecessors(a))}},updateSerialNumberPredecessors:function(e){var t,i,a,r,n,o,l,d;if(-1!=e){var s,c=this.model.flatRecords,u=c.length,p=[];for(t=e;t<u;t++)if(c[t].predecessor)for(i=c[t].predecessor,a=c[t].taskId,r=0;r<i.length;r++)i[r].to&&((n=+i[r].to!=a?+i[r].to:null)&&-1==p.indexOf(n)&&p.push(n));if(p.length)for(o=(s=c.filter(function(e){if(p.indexOf(e.taskId)>-1)return e})).length,l=0;l<o;l++)d=s[l],this.predecessorToSerialPredecessor(d)}},predecessorToSerialPredecessor:function(t){for(var i,a,r,n,o,l,d,s=this.model.flatRecords,c=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),u=t.predecessorsName?t.predecessorsName.split(","):[],p=null,h=0;h<u.length;h++)d=(l=u[h]).split("+"),l.indexOf("-")>=0&&(d=l.split("-")),(i=d[0].match(/(\d+|[A-z]+)/g))&&i.length&&(a=+i[0],r=i[1],(o=(n=s.filter(function(e){return e&&e.taskId==a}))[0]&&n[0].serialNumber+r+(d[1]?"+"+d[1]:""))&&(p=p?p+","+o:o));t.serialNumberPredecessor=p,t.item.serialNumberPredecessor=p,c.refreshGanttRecord(t)},updateWBSdetails:function(e){var t,i,a,r,n,o,l,d=this.model,s=e,c=s.WBS;s.parentItem?(i=(t=s.parentItem.childRecords).indexOf(s),n=(r=t).length):d.flatRecords.length&&(i=(r=d.flatRecords.filter(function(e){return e&&0==e.level})).indexOf(s),n=r.length),(a=r.slice(i,n)).length&&(o=-1!=c.lastIndexOf(".")?parseInt(c.substr(c.lastIndexOf(".")+1)):parseInt(c),l=s.parentItem?s.parentItem.WBS:null,o--,this.reCalculateWBS(a,o,l))},reCalculateWBS:function(t,i,a){var r,n,o=this,l=o.model,d=(l.currentViewData,e("#"+o._id.replace("ejTreeGrid","")).data("ejGantt")),s="";if(a)for(n=0;n<t.length;n++)r=i+n,s=t[n].WBS,t[n].WBS=a+"."+r,t[n].item.WBS=a+"."+r,l.enableWBSPredecessor&&o._getPredecessorIds(t[n]),s!=t[n].WBS&&d.refreshGanttRecord(t[n]),t[n].hasChildRecords&&o._updateChildWBS(t[n]);else for(n=0;n<t.length;n++)r=(i+n).toString(),s=t[n].WBS,t[n].WBS=r,t[n].item.WBS=r,l.enableWBSPredecessor&&o._getPredecessorIds(t[n]),s!=t[n].WBS&&d.refreshGanttRecord(t[n]),t[n].hasChildRecords&&o._updateChildWBS(t[n])},_updateChildWBS:function(t){for(var i=this,a=i.model,r=(a.currentViewData,t.childRecords),n=t.WBS,o=e("#"+i._id.replace("ejTreeGrid","")).data("ejGantt"),l="",d=0;d<r.length;d++)l=r[d].WBS,r[d].WBS=n+"."+(d+1),r[d].item.WBS=n+"."+(d+1),a.enableWBSPredecessor&&i._getPredecessorIds(r[d]),l!=r[d].WBS&&o.refreshGanttRecord(r[d]),r[d].hasChildRecords&&i._updateChildWBS(r[d])},_getPredecessorIds:function(e){for(var t=this,i=t.model,a=e.taskId,r=i.flatRecords,n=i.updatedRecords,o=r.filter(function(e){var t,i;if(e.predecessorsName)for(t=e.predecessorsName.split(","),i=0;i<t.length;i++)if(+t[i].match(/(\d+|[A-z]+)/g)[0]==a)return e}),l=0;l<o.length;l++)t.updateWBSPredecessor(o[l]),t.refreshRow(n.indexOf(o[l]))},updateSerialNumber:function(t){var i,a;if(-1!=t){var r=this.model.flatRecords,n=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt");for(i=t;i<r.length;i++)(a=r[i]).serialNumber=i+1,a.item.serialNumber=i+1,n.refreshGanttRecord(a,null,!0)}},search:function(e){var i=this,a={},r=i.model.searchSettings;i.model.allowSearching&&(a.requestType=t.TreeGrid.Actions.Searching,a.keyValue=e,i._searchString=e,""!=e?(r.key=e.toLowerCase()==this.localizedLabels.trueText.toLowerCase()?"true":e.toLowerCase()==this.localizedLabels.falseText.toLowerCase()?"false":e,r.fields=0!=this.model.searchSettings.fields.length?this.model.searchSettings.fields:this.getColumnFieldNames()):(r.key="",r.fields=[]),i.processBindings(a))},endEdit:function(){var e=this,t=e.model;return"cellediting"!=e.model.editSettings.editMode.toLowerCase()||e._isRowEdit?"dialogediting"!=e.model.editSettings.editMode.toLowerCase()&&("batchediting"!=t.editSettings.editMode.toLowerCase()||"dialog"!=t.editSettings.batchEditSettings.editMode)||e.saveRow():!this.editFormValidate()||e.saveCell()},updateReadOnly:function(e){this.model.readOnly=e},updateShowGridExpandCellTooltip:function(e){this.model.showGridExpandCellTooltip=e,this.refreshContent()},updateShowGridCellTooltip:function(e){this.model.showGridCellTooltip=e,this.refreshContent()},getVisibleRange:function(e){var t,i,a,r,n,o,l=this,d=this.model,s=d.rowHeight+l._detailsRowHeight,c=l._isHierarchyFiltering&&l.model.enableVirtualization?l._updateFilterParent:l.getUpdatedRecords();if("auto"!=d.sizeSettings.height||(l._viewPortHeight=l._getViewPortHeight(),0==l._viewPortHeight))return d.allowTextWrap?(a=(n=l._getVisibleTextWrapRows(l._scrollTop)).top,"scroll"==e&&l._scrollTop>l._prevScrollTop&&(n.bottom=n.bottom+4),i=n.bottom,l._offset=n.offSet):"resourceView"==d.viewType?(a=(o=this._getVisibleRangeForResourceGantt(l._scrollTop)).top,i=o.bottom,l._offset=o.topOffset):(a=l._scrollTop/s,i=l._getRowPosition(l._scrollTop+l._viewPortHeight),r=a-Math.floor(a),l._offset=r*s),t=Math.floor(a),t=Math.max(0,t),i=Math.min(c.length,i),l._visibleRange={top:t,bottom:i},l._visibleRange;l._visibleRange={top:0,bottom:l.getExpandedRecords(l.getUpdatedRecords()).length}},_getVisibleRangeForResourceGantt:function(e){for(var i,a,r,n={},o=this.model,l=e+this._viewPortHeight,d=0,s=e,c=o.updatedRecords,u=0;u<c.length&&(d=this._getTemplateRowHeight(c[u]),0==s&&t.isNullOrUndefined(i)?(i=0,a=0):e<0&&t.isNullOrUndefined(i)&&(i=u-1,a=this._getTemplateRowHeight(c[i])- -1*e),l<=0&&t.isNullOrUndefined(r)&&(r=u),e-=d,l-=d,t.isNullOrUndefined(i)||t.isNullOrUndefined(r));u++);return n.top=i,n.topOffset=a,n.bottom=t.isNullOrUndefined(r)?c.length:r,n},_getVisibleTextWrapRows:function(e){var t,i,a=this,r=this.model,n=0,o=0,l=0,d=!0,s=0,c=!0,u=0,p=0;for(r.allowPaging?(t=a._updatedPageData,n=a._updatedPageData.length):n=(t=r.updatedRecords).length,i=0;i<n;i++)if(s+=t[i].textWrapRowHeight,r.detailsTemplate&&!r.showDetailsRowInfoColumn&&(t[i].isSummaryRow||(s+=a._detailsRowHeight)),s>=e&&d&&(l=i,o=parseInt(e)-parseInt(s-t[i].textWrapRowHeight),d=!d),d||(p+=t[i].textWrapRowHeight),s>=e+a._viewPortHeight&&c||c&&i==t.length-1){u=i+1,c=!c;break}return p<a._viewPortHeight&&(l=parseInt((a._viewPortHeight-p)/r.rowHeight)>0?l-parseInt((a._viewPortHeight-p)/r.rowHeight):l-1),{top:l,offSet:o,bottom:u}},_getAvgTextWrapRowHeight:function(i,a){var r,n={};if(this.getRows().length>0){var o,l,d,s=this,c=this.model,u=0,p=!1,h=0,g=c.currentViewData;if(c.allowPaging?c.allowPaging&&(l=s._updatedPageData):l=c.updatedRecords,d=e("#"+s._id).find(".e-frozencontainer").length>0?c.showDetailsRow&&c.detailsTemplate&&!c.showDetailsRowInfoColumn?s.getTreeGridRows()[0]:s.getRows()[0]:c.showDetailsRow&&c.detailsTemplate&&!c.showDetailsRowInfoColumn?s.getTreeGridRows():s.getRows(),o="updateHeight"==i&&t.isNullOrUndefined(a)?l.length:"updateHeight"!=i||t.isNullOrUndefined(a)?d.length:a,d.length>0)for(r=0;r<o;r++)"getAvgHeight"==i?(g[u=s.getIndexByRow(d[r])]&&(g[u].textWrapRowHeight!=e(d[r]).height()&&e(d[r]).height()>=c.rowHeight&&(g[u].textWrapRowHeight=e(d[r]).height()),l.indexOf(g[u])>l.length-5&&!s._textWrapNoCalculate&&(p=!0)),h+=e(d[r]).height()):"updateHeight"==i&&(h+=l[r].textWrapRowHeight);"getAvgHeight"==i?n={avgHeight:h/=o,isEnd:p}:n={height:h}}else n={avgHeight:this.model.rowHeight,isEnd:!0,height:this.model.rowHeight};return n},_setWidthToHeaders:function(){var t,i,a,r,n=this._gridWidth;if(this._frozenColumnsLength>0){for(t=0,a=this.getHeaderContent().find(".e-headercell"),r=0;r<this.columnsWidthCollection.length;r++)t+=this.columnsWidthCollection[r],this._frozenColumnsLength-1==r&&(i=Math.ceil(t)),this.model.headerTextOverflow&&e(a[r]).css({width:this.columnsWidthCollection[r]+"px"});this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).width(n).next().css("margin-left",i+"px"),this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).outerWidth(i).end().find("#e-movableheaderdiv"+this._id).css("width","100%")}},setWidthToColumns:function(){for(var i,a,r,n=this,o=n.model,l=n.getContentTable().children("colgroup").find("col"),d=n.getHeaderTable().children("colgroup").find("col"),s=n._gridWidth,c=o.columns.length,u=0;u<d.length;u++)t.isNullOrUndefined(n.columnsWidthCollection[u])||(l.eq(u).width(n.columnsWidthCollection[u]),d.eq(u).width(n.columnsWidthCollection[u]));o.isFromGantt||(l.length>c&&l.eq(c).width(n._detailsColumnWidth),d.length>c&&d.eq(c).width(n._detailsColumnWidth)),o.showTotalSummary&&this._$totalSummaryRowContainer&&(i=e(this.getHeaderTable()).find("colgroup"),a=e(i).clone(),this._frozenColumnsLength>0?this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(a[0]).prependTo(this._$footertableContent[0]),e(a[1]).prependTo(this._$footertableContent[1])):this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(a).prependTo(this._$footertableContent))),this._frozenColumnsLength>0&&((r=this._getFrozenColumnWidth())<this._gridWidth&&(this.getContent().find("#e-movablecontainer"+this._id).css("margin-left",r+"px"),this.getContent().find("#e-frozencontainer"+this._id).outerWidth(r),this.getScrollElement().data("ejScroller")&&(this.getScrollElement().ejScroller("option","width",this._gridWidth-r-this._totalBorderWidth-1),this.getScrollElement().ejScroller("option","scrollTop",n._scrollTop),this.getScrollElement().ejScroller("option","scrollLeft",n._scrollLeft)),this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).next().css("margin-left",r+"px"),this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).outerWidth(r).end().find("#e-movableheaderdiv"+this._id).css("width","100%"),this._$totalSummaryRowContainer&&(this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).width(s).next().css("margin-left",r+"px"),this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).outerWidth(r).end().find("#e-movablefooterdiv"+this._id).css("width","100%"),this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this._$totalSummaryRowContainer.find("#e-movablefooter"+this._id).css("margin-left","auto")),this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this.getHeaderContent().find("#e-movableheader"+this._id).add(this.getContent().find("#e-movablecontainer"+this._id)).css("margin-left","auto"))),o.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||o.isFromGantt||this._updateTableWidth()},_updateTableWidth:function(t){for(var i,a,r,n=0,o=this.model,l=this._getFrozenColumnWidth(),d=o.columns.length,s=0;s<d;s++)(o.columns[s].isFrozen||0!=o.columns[s].visible)&&(n+=o.columns[s].width);this._frozenColumnsLength>0?(n-=l,i=e(this.getHeaderTable()[1]),a=e(this.getContentTable()[1]),r=o.showTotalSummary?e(this._$footertableContent[1]):null):(i=this.getHeaderTable(),a=this.getContentTable(),r=o.showTotalSummary?e(this._$footertableContent[0]):null),o.showDetailsRow&&o.showDetailsRowInfoColumn&&o.detailsTemplate&&(n+=this._detailsColumnWidth),t||(i.width(n),a.width(n),r&&r.width(n)),n<this._gridWidth-l&&o.columns[d-1].visible?(i.addClass("e-tableLastCell"),o.currentViewData.length>0?a.addClass("e-tableLastCell"):a.removeClass("e-tableLastCell"),a.addClass("e-fixed-border")):(i.removeClass("e-tableLastCell"),a.removeClass("e-tableLastCell"),a.removeClass("e-fixed-border"))},_convertHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},cellEdit:function(i,a){var r,n,o,l,d=this,s=d.model,c=i,u=d.getUpdatedRecords();if(n=1==s.allowSelection?"row"==s.selectionSettings.selectionMode?this.selectedItem():u[d._rowIndexOfLastSelectedCell]:this.selectedItem(),d.model.showGridCellTooltip&&d._cellMouseLeave(),d.model.isEdit&&d.saveCell(),e("#"+d._id+"EditForm").length>0)return!0;if(!n||s.isFromGantt&&n.hasChildRecords&&("status"===a||"startDate"===a&&n.isAutoSchedule||"endDate"===a&&n.isAutoSchedule||"duration"===a&&n.isAutoSchedule||"work"===a||"effortDriven"===a||"taskType"===a||"predecessor"===a||"taskId"===a)||s.isFromGantt&&(n.isAutoSchedule&&"fixedWork"==n.taskType&&"effortDriven"==a||!n.isAutoSchedule&&("taskType"==a||"effortDriven"==a)))return!1;if((s.enableVirtualization||"cell"===s.selectionSettings.selectionMode)&&(c=u.indexOf(n),i=s.currentViewData.indexOf(n)),(r=t.TreeGrid.getRowByIndex(this,c))&&e(r).find(".e-rowcell").length>0){var p=e(r),h=d.getColumnIndexByField(a),g=p.find(".e-rowcell").eq(h),m=d.model.columns[h],_=n,f=d._getCustomCellValue(_,m.field),w={},C={validationRules:t.isNullOrUndefined(m.validationRules)?{}:e.extend(!0,{},m.validationRules),columnName:m.field,value:t.isNullOrUndefined(f)?t.isNullOrUndefined(_.item[a])?null:_.item[a]:f,data:_,columnObject:m,cell:g},T=!0;return"notesText"==m.field?(C.value=t.isNullOrUndefined(_[a])?_.item&&_.item[a]:_[a],C.value=C.value?d._convertHtml(C.value):C.value):C.value=t.isNullOrUndefined(f)?t.isNullOrUndefined(_.item[a])?null:_.item[a]:f,s.isFromGantt&&"predecessor"===C.columnName&&(o=C.data.item[d.model.predecessorMapping],C.value=o||""),s.isFromGantt&&"taskMode"===C.columnName&&(l=!C.data.isAutoSchedule,C.value=l),w.data=_,w.columnIndex=h,w.rowElement=p,w.cellElement=g,d._cellEventTrigger(g,_,C.columnObject),!d._trigger("beginEdit",w)&&(p.hasClass("e-insertedrow")&&!C.columnObject.isTemplateColumn&&(T=!0),T&&e.extend(d._cellEditingDetails,{rowIndex:i,cellValue:C.value,columnIndex:h,fieldName:a,cellEditType:C.columnObject.editType,data:_}),C.columnIndex=h,d._renderCellEditObject(C,g),p.addClass("e-editedrow"),C.cell&&C.cell.addClass("e-editedcell"),d._updateHorizontalScrollBar(a),d._updateWrapRowHeights("total,header",null,d._cellEditingDetails.rowIndex,"cellEdit"),!0)}},_updateHorizontalScrollBar:function(t){var i,a,r=this,n=r.getScrollElement();if(n.ejScroller("isHScroll")){var o,l=r.model,d=l.columns,s=(d.length,r.getColumnIndexByField(t)),c=0,u=0,p=0,h=0,g=n.find(".e-content").width(),m=n.ejScroller("option","scrollLeft"),_=e("#"+r._id+"EditForm"),f=[];if("cell"==l.selectionSettings.selectionMode&&0==_.length?f=e("#"+r._id).find(".e-selectingcell"):(o=e(_).closest("tr.e-treegridrows"),f=e(o).find("td.e-rowcell")),r._frozenColumnsLength>0&&s<r._frozenColumnsLength)return!1;for(i=r._frozenColumnsLength;i<=s;i++)a="cell"==l.selectionSettings.selectionMode&&0==_.length?f[f.length-1]:e(f[i-r._frozenColumnsLength]),i==s&&(u=c,p=c+e(a).width()+parseFloat(e(a).css("padding-left"))+parseFloat(e(a).css("padding-right"))+1),d[i].visible&&(c=c+e(a).width()+parseFloat(e(a).css("padding-left"))+parseFloat(e(a).css("padding-right"))+1);(u<m||p>m+g)&&(h=u<m?m-(m-u)-3:m+(p-(m+g)+3),n.ejScroller("option",{scrollLeft:h}))}},updateAllowColumnResize:function(e){var i=this,a=i.model;a.allowColumnResize=e,a.allowColumnResize&&(i._resizer=new t.gridFeatures.gridResize(i)),i._enableColumnResizeEvents()},_predecessorFromSerialPredecessor:function(i){var a,r,n,o=this.model.flatRecords,l=[],d="";return!t.isNullOrUndefined(i)&&i.length>0&&(i.split(",").forEach(function(t){a=t.split("+"),t.indexOf("-")>=0&&(a=t.split("-")),(r=a[0].match(/(\d+|[A-z]+)/g))&&r[0]&&(e.map(o,function(e){if(e.serialNumber==r[0])return n=e.taskId,!1}),n&&l.push(n+(r[1]?r[1]:"")+(a[1]?"+"+a[1]:"")))}),d=l.length&&l.join(",")),d},_validatePredecessorString:function(e){var t,a,r,n=this.model,o=n.flatRecords.length,l=!1;return!(e.length>0)||(e.split(",").forEach(function(e){if(a=e.split("+"),"+",e.indexOf("-")>=0&&(a=e.split("-"),"-"),!(r=a[0].match(/(\d+|[A-z]+)/g)))return!1;n.enableSerialNumber?+r[0]<=o&&(l=!0):-1!=n.ids.indexOf(r[0])&&(l=!0),r&&l?r[1]&&("FS"==r[1].toUpperCase()||"FF"==r[1].toUpperCase()||"SF"==r[1].toUpperCase()||"SS"==r[1].toUpperCase()||(t=!1)):t=!1}),!(t!==i&&!t))},saveCell:function(){var i,a=this,r=a.model,n=e("#"+a._id+"EditForm");if(n.length>0){if(!a.editFormValidate())return!0;if(a._isRowEdit)return;if(a._cellEditingDetails.columnIndex>=0){a._focusTreeGridElement();var o,l=a.getUpdatedRecords().indexOf(a._cellEditingDetails.data),d=t.TreeGrid.getRowByIndex(this,l),s=n.closest("td"),c={},u=r.columns[a._cellEditingDetails.columnIndex],p=e("#"+a._id+a._cellEditingDetails.fieldName.split(".").join("")),h=!0;c={columnName:u.field,value:a.getCurrentEditCellData(),data:a._cellEditingDetails.data,previousValue:a._cellEditingDetails.cellValue,rowIndex:a._cellEditingDetails.rowIndex,columnObject:u,cellElement:s,rowElement:d},("datetimepicker"==a._cellEditingDetails.cellEditType||"dropdownedit"==a._cellEditingDetails.cellEditType||"datepicker"==a._cellEditingDetails.cellEditType)&&p.data("ejWidgets")&&p[p.data("ejWidgets")[0]]("destroy"),t.isNullOrUndefined(u.format)?"boolean"==c.columnObject.type?((i={})[c.columnObject.field]=c.value,c.cellElement.empty().html(e(e.templates.Grid_JSONTemplate.render(i))[0].cells[a._cellEditingDetails.columnIndex].innerHTML)):"notesText"==c.columnObject.field?c.cellElement.empty().html(a._convertHtml(c.value)):c.cellElement.empty().html(c.value):(o=a.formatting(u.format,c.value,r.locale),c.cellElement.empty().html(o));a._cellEditingDetails.cellEditType;var g=a._cellEditingDetails.fieldName,m=a._checkModfiedCellValue(c.previousValue,c.value,c.columnObject);!r.isFromGantt&&r.idMapping&&r.parentIdMapping&&g==r.idMapping&&a._validateIdValue(c.value)&&(c.value=c.previousValue,m=!1),r.isFromGantt?a._setGanttCellValue(c,g,m):(m||!a._isRemoteData)&&(m&&"batchediting"==a.model.editSettings.editMode.toLowerCase()&&(c.data.isBatchAdd||a._createBatchEditedFields(c.data,g,c.value,c.columnObject),a._batchEditStarts=!0),-1!=g.indexOf(".")?t.createObject(g,c.value,c.data[g]):c.data[g]=c.value,c.data.item[g]=c.data[g],c.requestType="saveCellValue",h=a._updateAction(c)),h&&a._refreshAfterSaveCell(c,!0)}}},_createBatchEditedFields:function(e,i,a,r){var n=this;n.model;e.batchEditedFields?e.batchEditedFields&&t.isNullOrUndefined(e.batchEditedFields[i])?e.batchEditedFields[i]=e[i]:e.batchEditedFields&&!t.isNullOrUndefined(e.batchEditedFields[i])&&(n._checkModfiedCellValue(e.batchEditedFields[i],a,r)||delete e.batchEditedFields[i]):(e.batchEditedFields={},e.batchEditedFields[i]=e[i]?e[i]:""),n._updateBatchChanges(e)},_updateBatchChanges:function(t){var i=this,a=(i.model,i.batchChanges.changed),r=i.batchChanges.added;e.isEmptyObject(t.batchEditedFields)?-1!=a.indexOf(t)&&a.splice(a.indexOf(t),1):-1==r.indexOf(t)&&-1==a.indexOf(t)&&a.push(t)},_refreshAfterSaveCell:function(i,a){var r,n,o,l,d=this,s=d.model;this._frozenColumnsLength>0?(s.allowSelection||(i.data.isSelected=!1),r=d._cellEditingDetails.columnIndex<this._frozenColumnsLength?e(e.render[d._id+"_JSONFrozenTemplate"](i.data))[0].cells[d._cellEditingDetails.columnIndex]:e(e.render[d._id+"_Template"](i.data))[0].cells[d._cellEditingDetails.columnIndex-this._frozenColumnsLength]):(s.allowSelection||(i.data.isSelected=!1),r=e(e.render[d._id+"_Template"](i.data))[0].cells[d._cellEditingDetails.columnIndex]),i.cellElement.removeClass("e-editedcell").replaceWith(r),i.cellElement=e(r),s.showDetailsRow&&!s.showDetailsRowInfoColumn&&s.detailsTemplate&&this._refreshDetailsRow(s.currentViewData.indexOf(i.data)),d._trigger("refresh"),i.data.treeMappingName||(i.data.treeMappingName=[]),0==i.data.treeMappingName.length&&i.data.treeMappingName.push(i.columnName),(a||i.isModified)&&"batchediting"!=s.editSettings.editMode.toLowerCase()&&d._trigger("endEdit",i)?(i.data[i.columnName]=i.previousValue,i.data.item[i.columnObject.field]=i.previousValue,d.selectRows(this.selectedRowIndex()),t.TreeGrid.refreshRow(d,s.currentViewData.indexOf(i.data))):s.idMapping&&s.parentIdMapping&&d._updateLastInsertedId(i.data[s.idMapping]),s.isEdit=!1,d._cellEventTrigger(i.cellElement[0],i.data,i.columnObject),e(i.rowElement).removeClass("e-editedrow"),s.showSummaryRow&&(i.editType="celledit",d._updateSummaryRow(i)),s.showTotalSummary&&(i.editType="celledit",d._updateTotalSummaryRow(i)),s.allowTextWrap&&(d._$frozenTableContent.length>0?(d._updateRowHeight(d._cellEditingDetails.rowIndex,"savecell"),d._updateGridContentHeight(),d.getScrollElement().ejScroller("refresh"),n=d.getScrollElement().ejScroller("model.scrollTop"),d._getFrozenScrollElement().scrollTop(n),s.enableVirtualization&&d.updateHeight()):d.getScrollElement().ejScroller("refresh"),s.allowPaging&&!s.sizeSettings.height&&d.updateHeight()),s.allowTextWrap&&0==d._$frozenTableContent.length&&(o=d._getViewPortHeight(),d._$gridContainer.css({height:o+"px"}),e("#"+d._id+"e-gridcontent").css("height",o),"auto"==s.sizeSettings.height&&d.getScrollElement().ejScroller("refresh")),d._cancelSaveTools(),l=i.columnObject,s.allowFiltering&&l&&"filterbar"==s.filterSettings.filterType&&"dropdownedit"==l.filterEditType&&"dropdownedit"!=l.editType&&d._resizeFilteringElements()},_setGanttCellValue:function(i,a,r){var n,o,l,d,s,c,u=this,p=u.model;if("taskMode"===a&&(r=i.value!==i.previousValue),"predecessor"===a){n={},i.value=e.trim(i.value),u._validatePredecessorString(i.value)?(n.predecessorString=i.value.split(","),n.currentRecord=i.data,n.requestType="validatePredecessor",u._trigger("actionComplete",n),n.result||(i.value=i.previousValue)):i.value=i.previousValue;var h,g=[],m=[],_=0;for(i.previousValue=i.data.predecessor,h=i.previousValue,i.value.length>0&&(l=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),m=i.data._calculatePredecessor(i.value,p.durationUnitEditText,p.durationUnit,l)),w=m.length,d=0,s=i.previousValue&&i.previousValue.length,d=0;d<s;d++)(C=h[d]).from===i.data.taskId.toString()&&g.push(C);for(_=0;_<w;_++)g.push(m[_]);i.data[u._cellEditingDetails.fieldName]=g,l&&!l._isValidPredecessorString&&(i.value=u._getPredecessorsValue(i.data),l._isValidPredecessorString=!0),i.data.item[p.predecessorMapping]=i.value,i.data.predecessorsName=i.value,p.enableWBS&&p.enableWBSPredecessor&&u.updateWBSPredecessor(i.data)}else if("serialNumberPredecessor"===a){n={},i.value=e.trim(i.value),i.value=u._checkSerialPredecessor(i.value),u._validatePredecessorString(i.value)?(n.predecessorString=i.value.split(","),n.currentRecord=i.data,n.requestType="validateSerialPredecessor",u._trigger("actionComplete",n),n.result||(i.value=i.previousValue)):i.value=i.previousValue,o=u._predecessorFromSerialPredecessor(i.value);var f,w,C;g=[],m=[],_=0;for(f=i.data.predecessor,i.prevDefaultPredecessors=f,i.previousValue=i.data.serialNumberPredecessor,o.length>0&&(l=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),m=i.data._calculatePredecessor(o,p.durationUnitEditText,p.durationUnit,l)),w=m.length,d=0,s=f&&f.length,d=0;d<s;d++)(C=f[d]).from===i.data.taskId.toString()&&g.push(C);for(_=0;_<w;_++)g.push(m[_]);i.data.predecessor=g,i.data.item[p.predecessorMapping]=o,i.data.predecessorsName=o,i.data.item.serialNumberPredecessor=i.value,i.data.serialNumberPredecessor=i.value,p.enableWBS&&p.enableWBSPredecessor&&u.updateWBSPredecessor(i.data)}else if("duration"===a){var T=i.value,x=i.data.duration,v=i.data.durationUnit;""==T?(x=T,p.allowUnscheduledTask?x=null:r=!1):(c=","!=t.globalize.findCulture(p.locale).numberFormat[","]?T.match(/(\d*\.*\,*\d+|[A-z]+)/g):T.match(/(\d*\.*\d+|[A-z]+)/g))&&c.length<=2&&(x=t.parseFloat(c[0],null,p.locale),v=c[1]?c[1].toLowerCase():"",v=-1!=p.durationUnitEditText.minute.indexOf(v)?t.Gantt.DurationUnit.Minute:-1!=p.durationUnitEditText.hour.indexOf(v)?t.Gantt.DurationUnit.Hour:-1!=p.durationUnitEditText.day.indexOf(v)?t.Gantt.DurationUnit.Day:p.durationUnit),isNaN(x)||!r&&i.data.durationUnit.toLowerCase()==v?(i.data.item[p.durationMapping]=i.previousValue,r=!1):(i.data.item[p.durationMapping]=i.data.duration=x,i.data.durationUnit=v,r=!0)}else if(r){switch(a){case"taskId":i.data.item[p.idMapping]=i.value;break;case"taskName":i.data.item[p.taskNameMapping]=i.value;break;case"startDate":case"endDate":p.allowUnscheduledTask||i.value&&""!=i.value?"startDate"==a?i.data.item[p.startDateMapping]=i.value:"endDate"==a&&(i.data.item[p.endDateMapping]=i.value):(r=!1,i.value=i.previousValue);break;case"resourceInfo":i.data.item[p.resourceInfoMapping]=u._getResourceId(i.value);break;case"status":i.data.item[p.progressMapping]=i.value;break;case"notesText":i.data.item[p.notesMapping]=i.value,i.data.notes=i.value,i.data.notesText=i.value;break;case"taskMode":i.data.item[p.taskSchedulingModeMapping]=i.value,i.data.isAutoSchedule=1!=i.value;break;case"work":p.workMapping?i.data.item[p.workMapping]=i.value:i.data.item[u._cellEditingDetails.fieldName]=i.value;break;case"baselineStartDate":i.data.item[p.baselineStartDateMapping]=i.value;break;case"baselineEndDate":i.data.item[p.baselineEndDateMapping]=i.value;break;case"eResourceName":"groupTask"==i.data.eResourceTaskType?i.data.item[p.groupNameMapping]=i.value:"resourceTask"==i.data.eResourceTaskType&&(i.data.item[p.resourceNameMapping]=i.value),i.data.eResourceName=i.value;break;default:i.data.item[u._cellEditingDetails.fieldName]=i.value}i.data[a]=i.value}("startDate"===i.columnName||"endDate"===i.columnName||"duration"===i.columnName||"taskMode"===i.columnName||"predecessor"===i.columnName||"serialNumberPredecessor"===i.columnName||"status"==i.columnName||"baselineStartDate"==i.columnName||"baselineEndDate"==i.columnName)&&(i.isModified=r)},_checkSerialPredecessor:function(e){var t,i,a="",r=[];return e.length>0&&(e.split(",").forEach(function(e){i=e.split("+"),e.indexOf("-")>=0&&(i=e.split("-")),t=i[0].match(/(\d+|[A-z]+)/g),r.push(t[0]+(t[1]?t[1].toUpperCase():"FS")+(i[1]?"+"+i[1]:""))}),a=r.join(",")),a},updateWBSPredecessor:function(e){var t,i,a,r=this.model,n=e.predecessorsName,o=null;if(n&&n.length>0){for(t=n.split(","),i=0;i<t.length;i++){var l,d=t[i].match(/(\d+|[A-z]+)/g),s=+d[0],c=d[1];l=r.flatRecords.filter(function(e){return e&&e.taskId==s}),(a=c?l[0]&&l[0].WBS+c:l[0]&&l[0].WBS)&&(o=o?o+","+a:a)}e.WBSPredecessor=o,e.item.WBSPredecessor=o}else e.WBSPredecessor="",e.item.WBSPredecessor=""},getCurrentEditCellData:function(){var i,a,r,n,o=this,l=o.model,d=l.columns;if(e("#"+o._id+"EditForm").length){switch(a=e("#"+o._id+o._cellEditingDetails.fieldName.split(".").join("")),i=d[o._cellEditingDetails.columnIndex],o._cellEditingDetails.cellEditType){case t.TreeGrid.EditingType.String:r=a.val();break;case t.TreeGrid.EditingType.Numeric:r=parseFloat(a.val()),r=l.isFromGantt&&("work"==i.field||"status"==i.field||"duration"==i.field)||"unit"==i.field?isNaN(r)?o._cellEditingDetails.cellValue:r:a.ejNumericTextbox("model.value");break;case t.TreeGrid.EditingType.Maskedit:r=a.ejMaskEdit("model.value");break;case t.TreeGrid.EditingType.Dropdown:r=l.isFromGantt&&"resourceInfo"===o._cellEditingDetails.fieldName?o._getSelectedItem(a.ejDropDownList("model.selectedItems")):l.isFromGantt&&"taskMode"===o._cellEditingDetails.fieldName?"true"==a.ejDropDownList("model.value"):0==a.ejDropDownList("model.showCheckbox")&&a.ejDropDownList("model.multiSelectMode")==t.MultiSelectMode.None?a.ejDropDownList("model.itemValue"):a.ejDropDownList("getSelectedValue");break;case t.TreeGrid.EditingType.Boolean:r=a.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:""==(r=i&&!i.format?t.format(a.ejDatePicker("model.value"),this.model.dateFormat,this.model.locale):a.ejDatePicker("model.value"))&&l.isFromGantt&&(r=o._cellEditingDetails.cellValue);break;case t.TreeGrid.EditingType.DateTimePicker:var s=a.ejDateTimePicker("model.value"),c=a.ejDateTimePicker("model.dateTimeFormat"),u=a.ejDateTimePicker("model.locale");r=i&&!i.format?t.format(a.ejDateTimePicker("model.value"),this.model.dateFormat,this.model.locale):a.ejDateTimePicker("model.value"),t.format(a.val(),c,u)!==t.format(s,c,u)&&l.isFromGantt&&!l.allowUnscheduledTask&&(r=o._cellEditingDetails.cellValue);break;case"edittemplate":"string"==typeof(n=i.editTemplate.read)&&(n=t.util.getObject(n,window)),r=n(a)}return"string"==typeof r&&r.length&&"number"==l.columns[o._cellEditingDetails.columnIndex].type&&(r=parseFloat(r)),r}return null},getCurrentEditCellDataForRowEdit:function(i,a,r){var n,o,l,d,s,c,u,p=this,h=p.model,g=h.columns;i=i.split(".").join("");if(p.model.editSettings.allowEditing&&("dialogEditing"==p.model.editSettings.editMode||"batchediting"==h.editSettings.editMode.toLowerCase()&&"dialog"==h.editSettings.batchEditSettings.editMode)?(o=e("#"+p._id+"EditFormDialog").length,l=e("#"+p._id+i),d=!0):(o=e("#"+p._id+"EditForm").length,l=e("#"+p._id+i)),o){switch(n=g[r],a){case t.TreeGrid.EditingType.String:s=l.val();break;case t.TreeGrid.EditingType.Numeric:s=parseFloat(l.val()),s=l.data("ejNumericTextbox")?l.ejNumericTextbox("model.value"):s;break;case t.TreeGrid.EditingType.Dropdown:s=l.data("ejDropDownList")?0==l.ejDropDownList("model.showCheckbox")&&l.ejDropDownList("model.multiSelectMode")==t.MultiSelectMode.None?l.ejDropDownList("model.itemValue"):l.ejDropDownList("getSelectedValue"):l.val(),d||l.data("ejWidgets")&&l[l.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.Boolean:s=l.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:c=l.hasClass("e-datepicker")?-1==h.dateFormat.toLowerCase().indexOf("hh")?l.ejDatePicker("model.value"):l.ejDateTimePicker("model.value"):l.val(),s=n&&!n.format?p.getFormatedDate(c):c,d||l.data("ejWidgets")&&l[l.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.DateTimePicker:s=l.hasClass("e-datetimepicker")?n&&!n.format?t.format(l.ejDateTimePicker("model.value"),this.model.dateFormat,this.model.locale):l.ejDateTimePicker("model.value"):l.val(),d||l.data("ejWidgets")&&l[l.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.Maskedit:s=l.ejMaskEdit("model.value");break;case"edittemplate":"string"==typeof(u=n.editTemplate.read)&&(u=t.util.getObject(u,window)),s=u(l)}return"string"==typeof s&&s.length&&"number"==h.columns[r].type&&(s=parseFloat(s)),s}return null},_getResourceId:function(e){var t=[],i=0,a=e.length;for(i=0;i<a;i++)t.push(e[i][this.model.resourceIdMapping]);return t},_getSelectedItem:function(i){var a,r,n=this.model,o=0,l=i.length,d=n.resourceUnitMapping,s=n.resourceIdMapping,c=n.columns[this._cellEditingDetails.columnIndex].dropdownData,u=n.selectedItem.resourceInfo,p=[];if(c)for(o=0;o<l;o++){if(u)for(r=0;r<u.length;r++){if(u[r][s]===i[o]+1){a=r;break}a=-1}t.isNullOrUndefined(a)||-1==a?e.each(c,function(t,a){if(i[o]===t){var r=e.extend({},a);r[d]=100,p.push(r)}}):p.push(u[a])}return p},getFormatedDate:function(e){return t.format(e,this.model.dateFormat,this.model.locale)},getDateFromFormat:function(e){return"object"==typeof e?new Date(e):e?null==t.parseDate(e,this.model.dateFormat,this.model.locale)?new Date(e):t.parseDate(e,this.model.dateFormat,this.model.locale):void 0},formatting:function(i,a,r){var n,o,l,d,s,c;return i=i.replace(/%280/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">"),r=t.preferredCulture[r]?r:"en-US",n=i,o=i.split("{0:"),s=i.split("}"),l=o[0],d=s[1],"string"==typeof a&&e.isNumeric(a)&&(a=Number(a)),-1!=i.indexOf("{0:")?null!=(c=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(i))&&null!=a?null!=l&&null!=d?l+t.format(a,c[2],r)+d:t.format(a,c[2],r):null!=a?a:"":null!=this.data&&null==this.data.Value?(e.each(this.data,function(e,t){n=n.replace(new RegExp("\\{"+e+"\\}","gm"),t)}),n):this.data.Value},getColumnIndexByField:function(e){for(var t=this.model.columns,i=t.length,a=0;a<i&&t[a].field!=e;a++);return a==t.length?-1:a},getUpNextVisibleColumnIndex:function(e,t){var i=this.model.columns;for(e||(e=0);e<=i.length;e++)if(e==i.length&&("rightArrow"==t||"moveCellRight"==t)&&(e=0,this._focusingRowIndex+=1),i[e].visible&&i[e].allowCellSelection)return i.indexOf(i[e])},getPreviousVisibleColumnIndex:function(e,t){var i=this.model.columns;for(e||(e=i.length-1);e<i.length;e--)if(e<0&&("leftArrow"==t||"moveCellLeft"==t)&&(e=i.length-1,this._focusingRowIndex-=1),i[e].visible&&i[e].allowCellSelection)return i.indexOf(i[e])},getBrowserDetails:function(){var e=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return navigator.userAgent.match(/Trident\/7\./)?{browser:"msie",version:jQuery.uaMatch(navigator.userAgent).version}:{browser:e[1].toLowerCase(),version:e[2]}},mobileDevice:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},getFieldNameByHeaderText:function(e){return t.isNullOrUndefined(this._fieldColumnNames[e])?null:this._fieldColumnNames[e]},clearSelection:function(i){var a,r,n,o,l,d,s,c,u=this,p=u.model,h=u.getUpdatedRecords();if(-1!=this.selectedRowIndex()||-1==this.selectedRowIndex()&&-1!=u._previousIndex||-1==i){if(a=this._frozenColumnsLength?e(u.getRows()[0]).add(u.getRows()[1]):u.getRows(),t.isNullOrUndefined(i)||-1==i){if(a&&a.find(".e-rowcell,.e-detailsrowcell").removeClass("e-selectionbackground").removeClass("e-active"),n=new t.DataManager(p.flatRecords),(o=new t.Query).search(!0,["isSelected"],t.FilterOperators.Equals,!0),(d=(l=n.executeLocal(o))&&l.length)>0)for(s=0,s=0;s<d;s++)l[s].isSelected=!1}else t.TreeGrid.getRowByIndex(u,i).find(".e-selectionbackground").removeClass("e-selectionbackground").removeClass("e-active"),(r=h[i])&&(r.isSelected=!1);u._checkboxSelection?(u.selectedRowIndex(-1),p.selectedItem=null,u._cancelSaveTools()):p.selectedItems.length>0&&-1!=i&&!t.isNullOrUndefined(i)?-1!=(c=e.inArray(h[i],p.selectedItems))&&(p.selectedItems.splice(c,1),h[i].isSelected=!1,p.selectedItem=p.selectedItems.length>0?p.selectedItems[p.selectedItems.length-1]:null,u.selectedRowIndex(h.indexOf(p.selectedItem))):(!p.selectedItems.length||p.selectedItems.length&&!u._multiSelectCtrlRequest||-1==i||t.isNullOrUndefined(i))&&(u.selectedRowIndex(-1),p.selectedItem=null,p.selectedItems=[],u._cancelSaveTools()),u.model.allowSelection&&"multiple"==u.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&!a.find(".e-rowcell,.e-detailsrowcell").hasClass("e-selectionbackground")&&!e("#"+u._id+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")&&u._clearMultiSelectPopup()}"cell"==p.selectionSettings.selectionMode&&(u._selectedCellDetails=[],p.selectedCellIndexes=[],e("#"+u._id).find(".e-selectingcell").removeClass("e-selectingcell"),u._rowIndexOfLastSelectedCell=-1,u._lastSelectedCellIndex=-1,u._focusingRowIndex=-1),u.model.allowSelection&&"multiple"==u.model.selectionSettings.selectionType&&t.isNullOrUndefined(i)&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&u._clearMultiSelectPopup()},_clearMultiSelectPopup:function(){var t=this;e("#"+t._id+"_selectionpopup").find(".e-rowselect").removeClass("e-spanclicked"),t._multiSelectPopup.hide(),t._multiSelectCtrlRequest=!1,t._isTouchTrigger=!1},getChildRecordsCount:function(e){for(var t=this,i=e.childRecords,a=0,r=i?i.length:0;a<r;a++)t._filteredRecords.length>0?-1!=t._filteredRecords.indexOf(i[a])&&(++t._removedCount,i[a].hasChildRecords&&i[a].expanded&&t.getChildRecordsCount(i[a])):(++t._removedCount,i[a].hasChildRecords&&i[a].expanded&&t.getChildRecordsCount(i[a]));return t._removedCount},getExpandStatus:function(e){var t=e.parentItem;return null==t||!1!==t.expanded&&(!t.parentItem||!1!==t.parentItem.expanded&&this.getExpandStatus(t.parentItem))},getColumnFieldNames:function(){var e=[],t=this.model,i=t.columns,a=0,r=t.searchSettings.fields,n=i.length;if(r.length>0)return r;for(;a<n;a++)i[a].field&&"resourceInfo"!=i[a].field&&"predecessor"!=i[a].field?e.push(i[a].field):"resourceInfo"==i[a].field?e.push("resourceNames"):"predecessor"==i[a].field&&e.push("predecessorsName");return e},_getColumnMappingNames:function(){for(var e=[],t=this.model.columns,i=0,a=t.length;i<a;i++)t[i].field&&"resourceInfo"!=t[i].field&&"predecessor"!=t[i].field&&"work"!=t[i].field&&"taskType"!=t[i].field&&"effortDriven"!=t[i].field?e.push(t[i].mappingName):"resourceInfo"==t[i].field?e.push("resourceNames"):"work"==t[i].field?e.push(t[i].field):"taskType"==t[i].field?e.push(t[i].field):"effortDriven"==t[i].field?e.push(t[i].field):"predecessor"==t[i].field&&e.push("predecessorsName");return e},renderRecords:function(e){var i=this,a=i.model;e||(e={},!a.isFromGantt&&a.enableCollapseAll?(e.requestType=t.TreeGrid.Actions.ExpandCollapse,i._isInExpandCollapseAll=!0):e.requestType=t.TreeGrid.Actions.Refresh),this.sendDataRenderingRequest(e),i._isInExpandCollapseAll=!1},_shiftKeySelectCells:function(i){var a,r,n,o=this,l=o.model,d=o.getUpdatedRecords(),s=o._shiftKeyFirstElementDetails.firstElementRowIndex,c=t.isNullOrUndefined(o._shiftKeyFirstElementDetails.firstElementCellIndex)?-1:o._shiftKeyFirstElementDetails.firstElementCellIndex,u=[s,i.rowIndex],p=[c,i.cellIndex];for(u.sort(function(e,t){return e-t}),p.sort(function(e,t){return e-t}),o._isShiftKeyNavigation=!0,o._selectedCellDetails=[],l.selectedCellIndexes=[],e("#"+o._id).find(".e-selectingcell").removeClass("e-selectingcell"),a=u[0];a<=u[1];a++)if(r=d&&d[a],l.currentViewData.indexOf(r),!t.isNullOrUndefined(r)&&!r.isSummaryRow)for(n=p[0];n<=p[1];n++)o.selectCells([{rowIndex:a,cellIndex:n}])},selectCells:function(i,a){var r,n,o,l,d,s,c,u,p=this,h=p.model,g=p.getUpdatedRecords(),m=p.getRows(),_=i.length,f=h.columns;if("single"==h.selectionSettings.selectionType&&(_=1),(!a||t.isNullOrUndefined(a))&&0==p._isShiftKeyNavigation&&(p._selectedCellDetails=[],h.selectedCellIndexes=[],e("#"+p._id).find(".e-selectingcell").removeClass("e-selectingcell")),"cell"==h.selectionSettings.selectionMode&&h.allowSelection&&m.length>0)for(o=0;o<_;o++)-1!=i[o].rowIndex&&(l=g&&g[i[o].rowIndex],d=h.currentViewData.indexOf(l),t.isNullOrUndefined(l)||l.isSummaryRow||(s=i[o].cellIndex>=p._frozenColumnsLength?1:0,c=i[o].cellIndex>=p._frozenColumnsLength?i[o].cellIndex-p._frozenColumnsLength:i[o].cellIndex,r=p._frozenColumnsLength>0?m[s][d]:m[d],!t.isNullOrUndefined(l)&&t.isNullOrUndefined(r)&&(r=e(e.render[p._id+"_Template"](l))[0]),n=r.childNodes[c],-1!=i[o].cellIndex&&f[i[o].cellIndex].allowCellSelection&&f[i[o].cellIndex].visible&&!p._cellSelectingEventTrigger({rowIndex:i[o].rowIndex,cellIndex:i[o].cellIndex,rowElement:r,cellElement:n})&&(e(n).addClass("e-selectingcell"),u={rowIndex:i[o].rowIndex,cellIndex:i[o].cellIndex,cellElement:n,data:l},-1==("msie"==t.browserInfo().name&&t.browserInfo().version<9?p._getCellIndex(p._selectedCellDetails,"cellElement").indexOf(n):p._selectedCellDetails.map(function(e){return e.cellElement}).indexOf(n))&&(p._selectedCellDetails.push(u),h.selectedCellIndexes.push({rowIndex:u.rowIndex,cellIndex:u.cellIndex})),p._cellSelectedEventTrigger({rowIndex:i[o].rowIndex,cellIndex:i[o].cellIndex,rowElement:r,cellElement:n},p._previousSelectedCellDetails),p._previousSelectedCellDetails={rowElement:r,cellElement:n,cellIndex:i[o].cellIndex,rowIndex:i[o].rowIndex},p._updateHorizontalScrollBar(f[i[o].cellIndex].field))));0==p._isShiftKeyNavigation&&(p._shiftKeyFirstElementDetails.firstElementRowIndex=p._focusingRowIndex,p._shiftKeyFirstElementDetails.firstElementCellIndex=p._cellIndex,p._rowIndexOfLastSelectedCell=u?u.rowIndex:p._rowIndexOfLastSelectedCell,p._lastSelectedCellIndex=p._cellIndex)},selectRows:function(i,a,r){var n,o,l,d,s,c,u,p,h,g=this,m=g.model;g.getRows();if(("cell"!=m.selectionSettings.selectionMode||-1==i)&&!t.TreeGrid.getRowByIndex(g,i).hasClass("e-summaryrow")){if((m.editSettings.allowEditing||m.editSettings.allowAdding)&&!g._isRowEdit&&"click"!=m.editSettings.beginEditAction&&e("#"+g._id+"EditForm").length>0&&g.endEdit())return void g.getRows();if(this._frozenColumnsLength>0&&e(g.getRows()[0]),n=g.getUpdatedRecords(),t.isNullOrUndefined(a)||t.isNullOrUndefined(i)){switch(i=t.isNullOrUndefined(i)?a:i,m.selectionSettings.selectionType){case t.TreeGrid.SelectionType.Checkbox:return l=n[i],g.clearSelection(-1),r&&(o="unchecked"==l.checkboxState?"checked":"unchecked",g._traverseSelection(l,o,!1),g.selectAllRows()),n[i]&&!n[i].isSelected&&(m.allowSelection&&t.TreeGrid.getRowByIndex(g,i).find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active"),n[i].isSelected=!0,m.selectedItem=n[i]),g._prevSelectedItem&&g._prevSelectedItem!=m.selectedItem&&(g._prevSelectedItem.isSelected=!1),g._prevSelectedItem=n[i],g.selectedRowIndex(i),m.selectedItems=g.getSelectedRecords(),!1;case t.TreeGrid.SelectionType.Multiple:if(g._multiSelectCtrlRequest&&-1!=i){l=n[i],d=e.inArray(l,m.selectedItems),g._prevSelectedItem=n[i],-1!=d&&g.clearSelection(i),-1==d&&(m.selectedItems.push(l),m.allowSelection&&t.TreeGrid.getRowByIndex(g,i).attr("aria-selected","true").find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active").attr("tabindex","0"),l.isSelected=!0,m.selectedItem=n[i]);break}case t.TreeGrid.SelectionType.Single:g.clearSelection(-1),m.selectedItem=null,i<=n.length-1&&(-1!=i&&m.selectedItems.push(n[i]),g._prevSelectedItem=n[i],g._shiftSelectedRecord=null,m.allowSelection&&t.TreeGrid.getRowByIndex(g,i).find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active"),n[i]&&(n[i].isSelected=!0,m.selectedItem=n[i]),g._prevSelectedItem&&g._prevSelectedItem!=m.selectedItem&&(g._prevSelectedItem.isSelected=!1))}m.selectedItems.length&&-1!=m.selectedItems.indexOf(n[i])?(g._prevSelectedItem=n[i],g._shiftSelectedRecord=null,this.selectedRowIndex()!=i&&this.selectedRowIndex(i)):0==m.selectedItems.length&&-1!=this.selectedRowIndex()?this.selectedRowIndex(-1):this.selectedRowIndex(m.updatedRecords.indexOf(m.selectedItems[m.selectedItems.length-1]))}else if(m.selectionSettings.selectionType==t.TreeGrid.SelectionType.Multiple)for(g.clearSelection(-1),s=i-a<0?n.slice(i,a+1):n.slice(a,i+1),h=0;h<s.length;h++)g.getExpandStatus(s[h])&&(s[h].isSelected=!0,u=n.indexOf(s[h]),c=t.TreeGrid.getRowByIndex(g,u),this._frozenColumnsLength?(p=e(c[0]).add(c[1]),c=c[0]):p=c,p&&e(p).find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active"),m.selectedItem=m.updatedRecords[u],this.selectedRowIndex(u));return m.selectedItems=g.getSelectedRecords(),m.isFromGantt||(g._multiSelectCtrlRequest=!1),m.isFromGantt&&g._cancelSaveTools(),!1}},getSelectedRecords:function(){var e,i=this.model,a=i.selectionSettings.selectionType;return i.allowFiltering&&i.filterSettings.filteredColumns.length>0||this._searchString.length>0?i.isFromGantt||a==t.TreeGrid.SelectionType.Single?e=i.updatedRecords:(a==t.TreeGrid.SelectionType.Multiple||a==t.TreeGrid.SelectionType.Checkbox)&&(e=this._flatFilteredRecords):e=i.flatRecords,("checkbox"==a?e.filter(function(e){return"checked"==e.checkboxState}):e.filter(function(e){return e.isSelected})).slice()},clearAllSelection:function(){var t=this,i=this.model;t.model.allowSelection&&"multiple"==t.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&t._clearMultiSelectPopup(),t.selectRows(-1),i.selectedItem=null,t._selectedCellDetails=[],i.selectedCellIndexes=[],t._rowIndexOfLastSelectedCell=-1,t._lastSelectedCellIndex=-1,t._focusingRowIndex=-1,e("#"+t._id).find(".e-selectingcell").removeClass("e-selectingcell"),t._cancelSaveTools()},getCellIndex:function(t,i){var a=e(t.target),r=-1;this.model;if(i&&(a=e(i)),a.hasClass("e-detailsrowcell")||a.closest("td").hasClass("e-detailsrowcell"))return-1;if("TD"==a.prop("tagName"))r=a.index();else if("DIV"==a.prop("tagName")&&a.hasClass("e-cell"))r=a.closest("td").index();else if("DIV"==a.prop("tagName")&&e(a.closest("td")[0]).hasClass("e-templatecell"))r=a.closest("td").index();else if(e(a.closest("td")[0]).hasClass("e-templatecell")&&e(a.closest("tr")[0]).hasClass("e-templaterow"))r=a.closest("td").index();else if("TD"==a.parent().prop("tagName"))a.closest("td"),r=a.parent().index();else if("TH"==a.prop("tagName")||"DIV"==a.prop("tagName")&&"col-resize"==e(a.closest("th")[0]).css("cursor")){var n="TH"==a.prop("tagName")?e(a):a.closest("th"),o=a[0].getBoundingClientRect(),l=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft;r=this._orgX<o.left+5+l&&n.prevAll(":visible:first")[0]?n.prevAll(":visible:first")[0].cellIndex:n.index()}else a.closest("td.e-rowcell").length>0&&(r=a.closest("td.e-rowcell").index());return-1!=r&&this._frozenColumnsLength>0&&(a.closest(".e-movablecontentdiv").length>0||a.closest(".e-movableheaderdiv").length>0||a.closest(".e-movablefooterdiv").length>0)&&(r+=this._frozenColumnsLength),r},getRowIndex:function(t){var i,a=e(t.target),r=this.getRows(),n=-1;this.model;if(a.closest(".e-gridcontainer").length>0){if(this._frozenColumnsLength>0)if(a.closest(".e-frozencontentdiv").length>0||a.closest(".e-frozencontainer").length>0)r=e(r[0]);else{if(!(a.closest(".e-movablecontentdiv").length>0||a.closest(".e-movablecontainer").length>0))return n;r=e(r[1])}return-1==(n=r.index(a))&&(i=a.closest("tr"),n=r.index(i)),n}},_cancelEditState:function(e){var i,a=this;t.isNullOrUndefined(e)||(i=0,a.getScrollElement().ejScroller("option","scrollLeft")!=(i=this._frozenColumnsLength>0?a._$gridHeaderContainer.find("#e-movableheader"+this._id).scrollLeft():a._$gridHeaderContainer.scrollLeft())&&(a.getScrollElement().ejScroller("option","scrollLeft",i),a.model.showTotalSummary&&a._$footerContainer&&(this._frozenColumnsLength>0?a._$footerContainer.find("#e-movablefooter"+this._id).scrollLeft(i):a._$footerContainer.scrollLeft(i)))),a.model.isEdit?a.cancelEditCell():a._isRowEdit&&a.cancelRowEditCell()},cancelEditCell:function(){var t,i,a,r=this,n=r.model,o=(r.model.selectedItem,r._cellEditingDetails.columnIndex),l=n.columns[o];if(n.isFromGantt&&!n.isEdit)return!0;a={columnName:l.field,value:r.getCurrentEditCellData(),data:r._cellEditingDetails.data,previousValue:r._cellEditingDetails.cellValue,columnObject:l},this._frozenColumnsLength>0?this._frozenColumnsLength<=r._cellEditingDetails.columnIndex?(o=r._cellEditingDetails.columnIndex-this._frozenColumnsLength,t=e(r.getRows()[1])[r._cellEditingDetails.rowIndex],e(t).hasClass("e-editedrow")&&e(t).removeClass("e-editedrow"),i=t.cells[o],e(i).removeClass("e-editedcell").empty().html(e(e.render[r._id+"_Template"](a.data))[0].cells[o].innerHTML)):(t=e(r.getRows()[0])[r._cellEditingDetails.rowIndex],e(t).hasClass("e-editedrow")&&e(t).removeClass("e-editedrow"),i=t.cells[o],e(i).removeClass("e-editedcell").empty().html(e(e.render[r._id+"_JSONFrozenTemplate"](a.data))[0].cells[o].innerHTML)):(t=e(r.getRows())[r._cellEditingDetails.rowIndex],e(t).hasClass("e-editedrow")&&e(t).removeClass("e-editedrow"),i=t.cells[o],e(i).removeClass("e-editedcell").empty().html(e(e.render[r._id+"_Template"](a.data))[0].cells[o].innerHTML)),r._cellEventTrigger(e(i)[0],a.data,a.columnObject),r.model.isEdit=!1,r._cancelSaveTools(),r._trigger("refresh")},_destroyWidgetElements:function(){for(var t,i,a=this.model.columns,r=a.length,n=0;n<r;n++)i=this._getFieldValue(a[n].field,n),(t=e("#"+this._id+i)).data("ejWidgets")&&t[t.data("ejWidgets")[0]]("destroy")},cancelRowEditCell:function(){var i,a,r,n,o,l=this,d=this.model,s=d.editSettings.allowDeleting,c=e(document.getElementById(l._id+"EditForm")),u=e("#"+l._id+"EditFrozenForm");c.length>0&&this._destroyWidgetElements(),i=e(c.closest("tr")),a=u.closest("tr"),r=l.getIndexByRow(i),n=d.currentViewData[r],(-1!=r||0!=c.length)&&(i.hasClass("e-addedrow")&&(l.model.editSettings.allowDeleting||(l.model.editSettings.allowDeleting=!0)),i.hasClass("e-editedrow")?(i.removeClass("e-editedrow").empty().html(e(e.render[l._id+"_Template"](n))[0].innerHTML),a.length>0&&a.removeClass("e-editedrow").empty().html(e(e.render[l._id+"_JSONFrozenTemplate"](n))[0].innerHTML),l._rowEventTrigger(i,n)):i.hasClass("e-rowedit")?(i.removeClass("e-rowedit").empty().html(e(e.render[l._id+"_Template"](n))[0].innerHTML),a.length>0&&a.removeClass("e-rowedit").empty().html(e(e.render[l._id+"_JSONFrozenTemplate"](n))[0].innerHTML),l._rowEventTrigger(i,n)):i.hasClass("e-addedrow")&&(l._isRefreshAddedRecord=!1,l._isEmptyRow=!0,l.deleteRow(null,!0,null),l._isEmptyRow=!1),d.isEdit=l._isRowEdit=!1,d.editSettings.allowDeleting=s,l._updateWrapRowHeights("total,header",null,r),l._cancelSaveTools(),l._trigger("refresh"),l._commandColumnLength>0&&(o=t.TreeGrid.getRowByIndex(l,l.getUpdatedRecords().indexOf(d.currentViewData[r])),l._refreshUnboundTemplate(o)))},refreshRow:function(i){var a=this,r=a.model,n=(r.allowPaging?a._updatedPageData:r.updatedRecords)[i],o=a.getIndexByRow(e("#"+a._id+"EditForm").closest("tr"));(r.enableVirtualization||r.allowPaging)&&(i=r.currentViewData.indexOf(n)),n&&i>-1&&(t.TreeGrid.refreshRow(this,i),o==i&&(a._isRowEdit=a.model.isEdit=!1,a._cancelSaveTools()))},_refreshDetailsRow:function(t){var i,a,r=this,n=this.model,o=r.model.currentViewData[t],l={};o&&(l=this._frozenColumnsLength>0?e(r.getRows()[1]):e(r.getRows()),(i=e(l[t]).next("tr")).hasClass("e-detailsrow")&&(i.remove(),a=e(e.render[r._id+"_detailRowTemplate"](o)),e(l[t]).after(a),r.setGridRows(e(r.getContentTable().get(0).rows)),this._gridRows=this.getContentTable().get(0).rows,this._frozenColumnsLength>0&&(this._gridRows=[this._gridRows,this.getContentTable().get(1).rows]),r._trigger("refresh"),n.detailsDataBound&&this._trigger("detailsDataBound",{detailsElement:a,data:o})))},_refreshedCellEventTrigger:function(t){var i,a=this,r=this.model;if(null!=r.queryCellInfo||null!=r.rowDataBound||null!=r.detailsDataBound){null!=r.rowDataBound&&a._trigger("rowDataBound",{rowElement:t.rowElement,data:t.data});var n=t.rowElement.cells,o=e(t.rowElement).find(".e-rowcell"),l=0,d=n.length,s=null,c=a.model.columns;if(null!=r.queryCellInfo)for(;l<d;l++)e(n[l]).hasClass("e-rowcell")&&(s=c[o.index(n[l])]),s&&a._cellEventTrigger(n[l],t.data,s);r.detailsDataBound&&e(t.rowElement).next("tr").hasClass("e-detailsrow")&&(i=e(t.rowElement).next("tr"),this._frozenColumnsLength>0&&(i=e(i[1])),this._trigger("detailsDataBound",{detailsElement:e(t.rowElement).next("tr"),data:t.data}))}},_refreshGridPager:function(){var e;if(null!=this.getPager()){var t=this,i=t.model,a=this.getPager().ejPager("model"),r={};if(r.currentPage=this._currentPage(),e=t._isHierarchyFiltering?t.getExpandedRecords(t._filterParentRecords).length:i.updatedRecords.length,0==i.currentViewData.length&&e>0&&1!=a.totalPages)return void t.gotoPage(r.currentPage-1);r.totalRecordsCount=t._isLoadonDemand?t._pageRecordCountOnDemand:t._isRemoteData?i.pageSettings.totalRecordsCount:t._gridRecordsCount,this.getPager().ejPager("option",r).ejPager("refreshPager"),i.pageSettings.totalPages=a.totalPages||null,t._isRemoteData||(i.pageSettings.totalRecordsCount=a.totalRecordsCount||null),t._updatePagerTextAlignment()}},_getVisibleChildRecordCount:function(e,t,i){var a,r,n;this.model;if(e.hasChildRecords)for(r=(a=e.childRecords).length,n=0;n<r;n++)-1!==i.indexOf(a[n])&&t++,a[n].hasChildRecords&&(t=this._getVisibleChildRecordCount(a[n],t,i));else-1!==i.indexOf(e)&&t++;return t},_renderAddedRow:function(e,i){var a,r=this,n=this.model;r._updateCurrentViewData(),n.enableVirtualization||n.allowPaging?(r.updateAltRow(),(a={}).requestType=t.TreeGrid.Actions.Refresh,r.sendDataRenderingRequest(a)):r.renderNewAddedRow(e,i),r.updateHeight(),r._updateFixedTableBorder()},renderNewAddedRow:function(i,a){var r,n,o,l,d,s=this,c=(this.model,s.getRows()),u=e.render[this._id+"_Template"](a),p=this._frozenColumnsLength>0;p&&(c=e(s.getRows()[1]),n=e(s.getRows()[0]),r=e.render[this._id+"_JSONFrozenTemplate"](a)),!t.isNullOrUndefined(c)&&c.length>0?c.length==i?(o=c.eq(i-1),p&&(l=n.eq(i-1)),e(o).next("tr").hasClass("e-detailsrow")?(e(o).next("tr").after(u),p&&e(l).next("tr").after(r)):(e(o).after(u),p&&e(l).after(r))):(c.eq(i).before(u),p&&n.eq(i).before(r)):this._frozenColumnsLength>0?s._renderFrozenRecords():(s.getContentTable().find("tbody").empty().append(s._getEmptyTbody()),d=document.createElement("div"),s.getContentTable().find("colgroup").first().replaceWith(s._getMetaColGroup()),s.getContentTable().children("tbody").empty(),d.innerHTML=["<table>",e.render[s._id+"_Template"](s.model.currentViewData),"</table>"].join(""),s.getContentTable().get(0).replaceChild(d.firstChild.firstChild,s.getContentTable().get(0).lastChild)),this._gridRows=this.getContentTable().get(0).rows,this._frozenColumnsLength>0&&(this._gridRows=[this._gridRows,this.getContentTable().get(1).rows]),s.setGridRows(e(s.getContentTable().get(0).rows))},onScrollHelper:function(e,t){var i=this;i._isFromChart=t,i.getScrollElement().ejScroller("scrollY",e,!0),!i.getScrollElement().ejScroller("isHScroll")&&this.model.isFromGantt&&i.getScrollElement().scrollTop(e)},isVScroll:function(){return!!this.getScrollElement().hasClass("e-scroller")&&this.getScrollElement().ejScroller("isVScroll")},refreshScroller:function(e){var t,i,a,r,n=this;n._$gridContent.removeClass("e-borderbox"),t=n.getScrollElement().ejScroller("option","scrollTop"),i=n.getScrollElement().ejScroller("option","scrollLeft"),n.getScrollElement().ejScroller("option",{persist:!0}),n.getScrollElement().ejScroller("option",{width:e}),i>(a=n.getMaxScrollWidth())&&(i=a>0?a:0),n._$gridContent.css("height",n._viewPortHeight),n.getScrollElement().ejScroller("refresh"),r=n.getScrollElement().ejScroller("isHScroll"),n.getScrollElement().ejScroller("option",{scrollTop:t}),r&&n.getScrollElement().ejScroller("option",{scrollLeft:i}),n._$gridHeaderContainer.scrollLeft(i),r?this.getScrollElement().scrollTop(0):this.getScrollElement().scrollTop(t)},getMaxScrollHeight:function(){return this.getScrollElement().children(".e-content").children().height()-this.getScrollElement().children(".e-content").height()},getMaxScrollWidth:function(){return this.getScrollElement().children(".e-content").find(".e-table").width()-this.getScrollElement().children(".e-content").width()},refreshHeight:function(){this.getScrollElement().ejScroller("refresh")},getColumnByHeaderText:function(e){for(var t=this.model.columns.length,i=this.model.columns,a=0;a<t&&i[a].headerText!=e;a++);return a==i.length?null:i[a]},hideColumn:function(i){var a,r,n,o,l,d,s=this,c=s.model,u=this.getColumnByHeaderText(i),p=e.inArray(u,c.columns),h=e.inArray(i,s._hiddenColumns);if(!u||s._isColumnHidable(u)){if(-1!=p&&p!=c.treeColumnIndex&&-1==h){s._cancelEditState(),s._hiddenColumns.push(i),s.model.columns[p].visible=!1,s.getHeaderTable().removeClass("e-table"),s.getContentTable().removeClass("e-table"),a=s.getHeaderTable().find("colgroup").find("col"),e(a).eq(p).hide(),r=s.getHeaderTable().find("tr").not(".e-stackedHeaderRow").find(".e-headercell"),e(r).eq(p).addClass("e-hide"),c.allowFiltering&&"filterbar"==c.filterSettings.filterType&&(n=s.getHeaderTable().find("thead").find("th.e-filterbarcell"),e(n).eq(p).addClass("e-hide")),1==s.model.columns[p].isFrozen&&s.setWidthToColumns();var g,m=s.getContentTable().find("colgroup").find("col"),_=!0,f=p;e(m).eq(p).hide(),m=s.getRows(),g=this._getFooterRows(),this._frozenColumnsLength>0?p<this._frozenColumnsLength?(m=e(s.getRows()[0]),g=e(g[0]),s._gridRows&&e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0?(o=parseInt(e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",o-1)):0==s.model.currentViewData.length&&(t.isNullOrUndefined(s._gridRows)||0==s._gridRows.length)&&(o=parseInt(e(s.getContentTable()[0]).find("tbody").find("td").attr("colspan")),e(s.getContentTable()[0]).find("tbody").find("td").attr("colspan",o-1))):(m=e(s.getRows()[1]),g=e(g[1]),_=!1,f=p-this._frozenColumnsLength,s._gridRows&&e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0?(o=parseInt(e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",o-1)):0==s.model.currentViewData.length&&(t.isNullOrUndefined(s._gridRows)||0==s._gridRows.length)&&(o=parseInt(e(s.getContentTable()[1]).find("tbody").find("td").attr("colspan")),e(s.getContentTable()[1]).find("tbody").find("td").attr("colspan",o-1))):0!=s.model.currentViewData.length||!t.isNullOrUndefined(s._gridRows)&&0!=s._gridRows.length?s._gridRows&&e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(o=parseInt(e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",o-1)):s.getContentTable().find("tbody").find("td").attr("colspan",s.model.columns.length-s._hiddenColumns.length),m.each(function(){var t=e(this).children("td").eq(f);e(t).addClass("e-hide"),c.showSummaryRow&&e(t).hasClass("e-summaryrowcell")&&_&&s._updateSummaryRowTitleCell(a,t[0].parentElement)}),c.showTotalSummary&&(l=s._$footertableContent.find("colgroup").find("col"),e(l).eq(p).hide(),g.each(function(){var t=e(this).children("td").eq(f);e(t).addClass("e-hide"),e(t).hasClass("e-footersummaryrowcell")&&s._updateSummaryRowTitleCell(l,t[0].parentElement)})),s.getHeaderTable().addClass("e-table"),s.getContentTable().addClass("e-table"),d=s.getScrollElement(),c.isFromGantt&&s._trigger("refreshScrollCss"),c.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||c.isFromGantt||this._updateTableWidth(),d.ejScroller("refresh"),s._updateScrollCss(),s._updateHeaderScrollLeft(),c.isFromGantt&&!d.ejScroller("isHScroll")&&d.scrollTop(d.data("ejScroller").scrollTop()),-1!=(p=e.inArray(i,s._visibleColumns))&&s._visibleColumns.splice(p,1),(c.showColumnChooser||c.contextMenuSettings.showContextMenu)&&(s._renderColumnChooserList(!0,i),s._updateColumnMenuVisibility()),s._addInitTemplate(),c.showTotalSummary&&c.collapsibleTotalSummary&&s._updateSummaryTitleColumn(),c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&(t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)||""==c.editSettings.dialogEditorTemplateID)?s._treeGridAddEditDialog():c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&!t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)&&""!=c.editSettings.dialogEditorTemplateID&&s._treeGridAddEditDialogTemplate()}this.model.showStackedHeader&&this._refreshStackedHeader(),c.isFromGantt&&s.updateToGanttColumns()}},clearFilter:function(i){var a,r,n,o,l=this,d=l.model;if(t.isNullOrUndefined(i)){for((a=d.filterSettings.filteredColumns)&&a.length;a&&a.length>0;)l.clearFilter(a[0].field);l._filteredColumnValue=[],l._filteredColumnValueID=[]}else r=l.getColumnByField(i),n=e.grep(d.filterSettings.filteredColumns,function(e){return e.field===i}),r&&n.length>0&&("immediate"==d.filterBarMode&&"numericedit"==r.filterEditType||(l._filterString="",l._fieldName="",l.filterColumn(i,"equal","","and"),l._storePreviousFilteredValue(l._fieldName,l._filterString,this._operator)),l._clearFilterElementValue(r),"menu"==d.filterSettings.filterType&&"excel"!=r.filterType||"excel"==d.filterSettings.filterType&&"menu"==r.filterType?(o=l._filteredColumnValueID.indexOf(r.field),l._filteredColumnValue.splice(o,1),l._filteredColumnValueID.splice(o,1)):("excel"==d.filterSettings.filterType&&"menu"!=r.filterType||"menu"==d.filterSettings.filterType&&"excel"==r.filterType)&&(o=l._filteredColumnValueID.indexOf(r.field),l._filteredColumnValueID.splice(o,1)),l._isExcelFilter&&l._excelFilter._predicates[0]&&delete l._excelFilter._predicates[0][r.field],d.showColumnChooser||l.getHeaderTable().find("div[data-ej-mappingname='"+r.field+"']").next(".e-filtericon").removeClass("e-column-filtered-icon").addClass("e-column-filter-icon"))},getColumnByField:function(e){for(var t=this.model.columns,i=0;i<t.length&&t[i].field!=e;i++);return i==t.length?null:t[i]},_clearFilterElementValue:function(t){var i=t.field.split(".").join(""),a=e("#"+this._id+"_"+i+"_filterbarcell");if(a&&a.length)switch(t.filterEditType){case"stringedit":e(a).val("");break;case"booleanedit":e(a).prop("checked",!1);break;case"numericedit":e(a).ejNumericTextbox("instance").option("value","");break;case"dropdownedit":e(a).ejDropDownList("instance").option("value","");break;case"datepicker":e(a).ejDatePicker("instance").option("value","");break;case"datetimepicker":e(a).ejDateTimePicker("instance").option("value","")}},_updateSummaryRowTitleCell:function(t,i){for(var a,r=t.length,n=0;n<r;n++)if("none"!=e(t[n]).css("display")){if(a=e(i).find(".e-summarytitle")[0],e(i.childNodes[n]).find(".e-summarytitle")[0])return;return void e(i.childNodes[n]).prepend(a)}},_updateFrozenColumnOnResize:function(e){var t,i,a,r,n=this,o=n.model,l=o.columns;if(this._getFrozenColumnWidth()+18>this._gridWidth){for(t=0,i=-1,r=0;r<n._frozenColumnsLength;r++)1==l[r].visible&&t<l[r].width&&(t=l[r].width,i=r);if(l[e].width<t-o.commonWidth)l[i].width==t&&(l[i].width=n.columnsWidthCollection[i]=l[i].width-l[e].width);else for(o.columns[e].width>o.commonWidth&&(o.columns[e].width=o.commonWidth),a=Math.round(l[e].width/n._frozenColumnsLength),r=0;r<n._frozenColumnsLength;r++)1==l[r].isFrozen&&1==l[r].visible&&(l[r].width=n.columnsWidthCollection[r]=l[r].width-a)}},showColumn:function(i){var a,r,n,o,l,d,s=this,c=s.model,u=this.getColumnByHeaderText(i),p=e.inArray(u,c.columns),h=e.inArray(i,s._visibleColumns);if(-1!=p&&-1==h){s._cancelEditState(),s._visibleColumns.push(i),s.model.columns[p].visible=!0,a=s.getHeaderTable().find("colgroup").find("col"),e(a).eq(p).show(),r=s.getHeaderTable().find("tr").not(".e-stackedHeaderRow").find(".e-headercell"),e(r).eq(p).removeClass("e-hide"),c.allowFiltering&&"filterbar"==c.filterSettings.filterType&&(n=s.getHeaderTable().find("thead").find("th.e-filterbarcell"),e(n).eq(p).removeClass("e-hide")),1==s.model.columns[p].isFrozen&&(s._updateFrozenColumnOnResize(p),s.setWidthToColumns());var g,m=s.getContentTable().find("colgroup").find("col"),_=!0,f=p;e(m).eq(p).show(),m=s.getRows(),g=this._getFooterRows(),this._frozenColumnsLength>0?p<this._frozenColumnsLength?(m=e(s.getRows()[0]),g=e(g[0]),s._gridRows&&e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(o=parseInt(e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",o+1))):(m=e(s.getRows()[1]),g=e(g[1]),_=!1,f=p-this._frozenColumnsLength,s._gridRows&&e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(o=parseInt(e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",o+1))):s._gridRows&&e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(o=parseInt(e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",o+1)),m.each(function(){var t=e(this).children("td").eq(f);e(t).removeClass("e-hide"),c.showSummaryRow&&e(t).hasClass("e-summaryrowcell")&&_&&s._updateSummaryRowTitleCell(a,t[0].parentElement)}),c.showTotalSummary&&(l=s._$footertableContent.find("colgroup").find("col"),e(l).eq(p).show(),g.each(function(){var t=e(this).children("td").eq(f);e(t).removeClass("e-hide"),e(t).hasClass("e-footersummaryrowcell")&&s._updateSummaryRowTitleCell(l,t[0].parentElement)})),s._addInitTemplate(),c.showTotalSummary&&c.collapsibleTotalSummary&&s._updateSummaryTitleColumn(),d=s.getScrollElement(),c.isFromGantt&&s._trigger("refreshScrollCss"),c.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||c.isFromGantt||this._updateTableWidth(),d.ejScroller("refresh"),s._updateScrollCss(),s._updateHeaderScrollLeft(),c.isFromGantt&&!d.ejScroller("isHScroll")&&d.scrollTop(d.data("ejScroller").scrollTop()),-1!=(p=e.inArray(i,s._hiddenColumns))&&s._hiddenColumns.splice(p,1),(c.showColumnChooser||c.contextMenuSettings.showContextMenu)&&(s._renderColumnChooserList(!0,i),s._updateColumnMenuVisibility()),c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&(t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)||""==c.editSettings.dialogEditorTemplateID)?s._treeGridAddEditDialog():c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&!t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)&&""!=c.editSettings.dialogEditorTemplateID&&s._treeGridAddEditDialogTemplate()}this.model.showStackedHeader&&this._refreshStackedHeader(),c.isFromGantt&&s.updateToGanttColumns()},getHiddenColumns:function(){for(var e=this,t=(e.model,e._hiddenColumns),i=t.length,a=[],r=0;r<i;r++)a.push(e.getColumnByHeaderText(t[r]));return a},getColumnByIndex:function(e){var t=this.model.columns;return t.length>e?t[e]:null},getVisibleColumns:function(){for(var e=this,t=(e.model,e._visibleColumns),i=t.length,a=[],r=0;r<i;r++)a.push(e.getColumnByHeaderText(t[r]));return a},_getLastVisibleColumnIndex:function(){for(var e=this.model.columns,t=-1,i=e.length-1;i>=0;i--)if(0!=e[i].visible){t=i;break}return t},cancelEdit:function(){this._isRowEdit?this.cancelRowEditCell():this.model.isEdit&&this.cancelEditCell()},redraw:function(){this.resetModelCollections(),this._clearColumnMenu(),this._clearContextMenu(),this._removeDetailsRow(),this.element.empty(),this.element.off();jQuery.uaMatch(navigator.userAgent);var i=this,a=this.model;i._off(i.element,"click",i._onClick),i._off(i.element,"keydown",i._keyDown),i._off(i.element,"click","#"+i._id+"e-gridheader",i._onHeaderClick),i._off(i.element,"mousedown touchstart","#"+i._id+"e-gridheader",i._headerMouseDown),i._off(e(document),"mousedown touchstart",i._mouseDownHandler),i._off(i.element,"mousedown touchstart",".e-gridcontent",i._contentMouseDown),i._off(i.element,"click",i._onRecordClick),i._off(i.element,"dblclick",".e-gridcontent > div",i._onRecordDoubleClick),"immediate"==a.filterSettings.filterBarMode&&(i._off(i.element,"keyup",".e-filterbarcell input",i._filterBarHandler),i._off(i.element,"click",".e-filterbarcell .e-checkbox")._off(i.element,"click",".e-filterbarcell .e-checkbox",i._filterBarHandler)),i._off(i.element,"focus click",".e-filterbarcell input",i._filterBarClose),i._off(i.element,"click",".e-filterbarcell .e-cancel",i._filterBarClose),i.model.showGridCellTooltip&&!i.model.showGridExpandCellTooltip?"msie"==t.browserInfo().name?i._off(i.element,"mouseenter",".e-rowcell",i._mouseHover):i._off(i.element,"mousemove",".e-rowcell",i._mouseHover):i._off(i.element,"mouseenter",".e-rowcell",i._mouseHover),i.model.showGridCellTooltip&&("msie"==t.browserInfo().name?i._off(i.element,"mouseenter",".e-headercelldiv",i._headermouseHover):i._off(i.element,"mousemove",".e-headercelldiv",i._headermouseHover)),i._off(i.element,"mouseleave",".e-rowcell",i._cellMouseLeave),i._off(i.element,"mouseleave",i._cellMouseLeave),i._off(i.element,"mouseleave",".e-headercelldiv",i._headerMouseLeave),i._off(i.element,"mouseleave",i._headerMouseLeave),(a.isFromGantt||this._frozenColumnsLength)&&i._off(i.element,"mousewheel DOMMouseScroll",i._mouseWheel),a.enableResize&&a.isResponsive&&!a.isFromGantt&&i._off(e(window),"resize",i._windowResize),t.isTouchDevice()?i._off(i.element,"doubletap ",".e-gridcontent",i._editdblClickHandler):i._off(i.element,"dblclick ",".e-gridcontent",i._editdblClickHandler),a.contextMenuSettings.showContextMenu&&i._off(i.element,"keyup contextmenu taphold",this._preventContextMenu),this._init()},clearColumnMenu:function(){this._clearColumnMenu()},export:function(i,a,r){var n,o,l,d,s,c,u,p,h=this,g=h.model;return h.contextMenuOperations("Cancel"),n=h._getExportModel(g),o={action:i,method:"post","data-ajax":"false"},e("form#"+h._id+"export").remove(),l=t.buildTag("form#"+h._id+"export","",null,o),t.raiseWebFormsServerEvents?(d={model:n,originalEventType:a},s={model:JSON.stringify(n)},t.raiseWebFormsServerEvents(a,d,s)):(c={},r?e("body").find(".e-treegrid").each(function(i,a){var r,n,o,d,s=e(a).data("ejTreeGrid");t.isNullOrUndefined(s)||(r=s.model,n=h._getExportModel(r),c[i]=JSON.stringify(n),o={name:"TreeGridModel",type:"hidden",value:JSON.stringify(n)},d=t.buildTag("input","",null,o),l.append(d))}):(u={name:"TreeGridModel",type:"hidden",value:JSON.stringify(n)},p=t.buildTag("input","",null,u),l.append(p),l.append(this)),e("body").append(l),l.submit()),!0},_getExportModel:function(t){var a,r,n,o,l,d,s,c,u,p,h=t,g=h.updatedRecords,m=h.currentViewData,_=h.flatRecords,f=h.parentRecords,w=h.summaryRowRecords,C=h.selectedItem,T=h.selectedItems;delete h.updatedRecords,delete h.currentViewData,delete h.flatRecords,delete h.parentRecords,delete h.summaryRowRecords,delete h.selectedItem,delete h.selectedItems,a=e.extend(!0,{},h),h.updatedRecords=g,h.currentViewData=m,h.flatRecords=_,h.parentRecords=f,h.selectedItem=C,h.selectedItems=T,h.summaryRowRecords=w;var x=a.columns,v=x.length,b=a.stackedHeaderRows,S=a.filterSettings.filteredColumns,D=S.length;for(p=0;p<v;p++){if(a.columns[p].editType!=i)switch(x[p].editType){case"stringedit":case"edittemplate":x[p].editType="string";break;case"numericedit":x[p].editType="numeric";break;case"dropdownedit":x[p].editType="dropdown";break;case"booleanedit":x[p].editType="boolean"}if(x[p].filterEditType!=i)switch(x[p].filterEditType){case"stringedit":x[p].filterEditType="string";break;case"numericedit":x[p].filterEditType="numeric";break;case"dropdownedit":x[p].filterEditType="dropdown";break;case"booleanedit":x[p].filterEditType="boolean"}}for(p=0;p<D;p++)"equal"==S[p].operator?S[p].operator="equals":"notequal"==a.filterSettings.filteredColumns[p].operator&&(S[p].operator="notequals");if(h.showStackedHeader&&b.length>0)for(r=0;r<b.length;r++)for(n=b[r].stackedHeaderColumns,o=0;o<n.length;o++)l=Array.isArray(n[o].column)?n[o].column:e.map(n[o].column.split(","),e.trim),n[o].column=l;if(a.showStackedHeader)for(a.stackedHeaderRow=a.stackedHeaderRows,p=0;p<a.stackedHeaderRow.length;p++)for(a.stackedHeaderRow[p].stackedHeaderColumn=a.stackedHeaderRow[p].stackedHeaderColumns,d=a.stackedHeaderRow[p].stackedHeaderColumn,s=0;s<d.length;s++)a.stackedHeaderRow[p].stackedHeaderColumn[s].column=e.isArray(d[s].column)?d[s].column:d[s].column.split(",");if(u=(c=this.ignoreOnExport).length,this.ignoreOnExport)for(p=0;p<u;p++)delete a[c[p]];return a},_getNonContentHeight:function(){var i,a=this,r=a.model,n=0;return i=a.model.isFromGantt?0:1,n=a._$gridHeaderContent.outerHeight()+parseFloat(i),a.model.toolbarSettings.showToolbar&&(n+=t.isNullOrUndefined(e("#"+a._id+"_toolbarItems").outerHeight())?0:e("#"+a._id+"_toolbarItems").outerHeight()),r.allowPaging&&(n+=a.element.find(".e-pager").outerHeight()),n},_getViewPortHeight:function(){var t=this;return"auto"==t.model.sizeSettings.height?t._frozenColumnsLength>0?1==e("#"+t._id+"e-gridcontent").find(".e-hscrollbar").length?e("#"+t._id+"movablee-table").height()+18:e("#"+t._id+"movablee-table").height():1==e("#"+t._id+"e-gridcontent").find(".e-hscrollbar").length?e("#"+t._id+"e-table").height()+18:e("#"+t._id+"e-table").height():this.element.height()-this._getNonContentHeight()},updateViewPortHeight:function(){this._viewPortHeight=this._getViewPortHeight()},_updateScrollCss:function(){var t,i=this,a=i.model;if(!a.isFromGantt){var r=i.isVScroll(),n=(i._$gridHeaderContent.hasClass("e-scrollcss"),/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor));n&&i._$gridHeaderContent.removeClass("e-gridheader"),r?(this.mobileDevice()||i._$gridHeaderContent.addClass("e-scrollcss"),a.showTotalSummary&&i._$totalSummaryRowContainer&&i._$totalSummaryRowContainer.height()<=a.totalSummaryHeight&&0==i._$totalSummaryRowContainer.find(".e-vscrollbar").length&&(this.mobileDevice()?i._$totalSummaryRowContainer.width(i._$gridContent.width()):(i._$totalSummaryRowContainer.addClass("e-scrollcss"),i._$totalSummaryRowContainer.width(i._$gridContent.width()-17)))):(i._$gridHeaderContent.removeClass("e-scrollcss"),a.showTotalSummary&&i._$totalSummaryRowContainer&&i._$totalSummaryRowContainer.height()<=a.totalSummaryHeight&&(i._$totalSummaryRowContainer.removeClass("e-scrollcss"),i._$totalSummaryRowContainer.width(i._$gridContent.width()))),i.getScrollElement().hasClass("e-scroller")&&this._updateHeaderScrollLeft(this.getScrollElement().ejScroller("model.scrollLeft")),this._frozenColumnsLength&&((t="auto"==a.sizeSettings.height?e("#"+i._id+"movablee-table").height():this.getContent().find("#e-movablecontent"+i._id).height())!=this.getContent().find("#e-frozencontainer"+i._id).height()&&this.getContent().find("#e-frozencontainer"+i._id).height(t)),n&&(i._$gridHeaderContent[0].style.width=i._gridWidth+"px",i._$gridHeaderContent.addClass("e-gridheader")),i._resizeFilteringElements()}},_updatePagerIndex:function(){var e,i,a,r=this,n=r.model,o=[],l=-1,d=-1,s=n.updatedRecords;if(n.allowPaging){if(e=n.pageSettings.pageSize,n.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root){var c,u=r._isHierarchyFiltering?r._filterParentRecords:n.parentRecords.slice(),p=-1;r._gridRecordsCount=u.length,i=0==r._isLoadonDemand?r._gridRecordsCount<1?0:0==e?0:Math.ceil(r._gridRecordsCount/e):Math.ceil(r._pageRecordCountOnDemand/e),r._currentPage()>i&&r._currentPage(i),c=r._currentPage()*e>r._gridRecordsCount?r._gridRecordsCount:r._currentPage()*e,p=r._gridRecordsCount<=e?0:r._currentPage()*e-e,l=s.indexOf(u[c]),p>c?p=c-e:r._gridRecordsCount==c&&(l=s.length),d=s.indexOf(u[p]),r._updatedPageData=r._isHierarchyFiltering&&r.model.enableVirtualization?r._updateFilterParent.slice(d,l):this.getExpandedRecords(s.slice(d,l))}else o=this.getExpandedRecords(s),r._gridRecordsCount=n.enableVirtualization?r._isHierarchyFiltering?r._updateFilterParent.length:s.length:o.length,a=r._gridRecordsCount<1?0:0==e?0:Math.ceil(r._gridRecordsCount/e),r._currentPage()>a&&r._currentPage(a),l=r._currentPage()*e>r._gridRecordsCount?r._gridRecordsCount:r._currentPage()*e,(d=r._gridRecordsCount<e?0:r._currentPage()*e-e)>l&&(d=l-e),r._updatedPageData=r._isHierarchyFiltering&&r.model.enableVirtualization?r._updateFilterParent.slice(d,l):o.slice(d,l);r.updateHeight()}},_updateCurrentViewData:function(i){var a,r,n,o,l,d=this,s=d.model,c={},u=!1;s.enableVirtualization?(s.allowPaging?(i!=t.TreeGrid.Actions.Scroll&&d._updatePagerIndex(),d.getVisibleRange(i),s.currentViewData=s.sizeSettings.height?d._updatedPageData.slice(d._visibleRange.top,d._visibleRange.bottom):d._isHierarchyFiltering&&d.model.enableVirtualization?d._updateFilterParent:d._updatedPageData):(d.getVisibleRange(i),r=d._isHierarchyFiltering&&d.model.enableVirtualization?d._updateFilterParent:d.model.updatedRecords,s.currentViewData=r.slice(d._visibleRange.top,d._visibleRange.bottom)),s.allowDragAndDrop&&d._dragMouseDown&&d._isTouchEvent&&(n=d.getUpdatedRecords().indexOf(d._draggedRecord),(d._visibleRange.top>n+1||d._visibleRange.bottom<n)&&(d._dummyElement||(o=d._draggedElement.clone(),d._draggedElement.before(o),d._draggedElement.hide(),e(d.element).append(d._draggedElement),d._dummyElement=!0))),0!==d._vScrollDist&&(a=d._scrollTop-d._offset,c.requestType=i&&i==t.TreeGrid.Actions.Scroll?t.TreeGrid.Actions.Scroll:i&&i==t.TreeGrid.Actions.ExpandCollapse?t.TreeGrid.Actions.ExpandCollapse:t.TreeGrid.Actions.Refresh,"expandcollapse"!=i&&d.sendDataRenderingRequest(c),s.allowTextWrap&&s.enableVirtualization&&"scroll"==i&&(d._updateWrapRowHeights("total,header"),d._textWrapRowsDatas=d._getAvgTextWrapRowHeight("getAvgHeight")),u=!0,this._frozenColumnsLength>0?(d._$frozenTableContent.css({top:a}),d._$movableTableContent.css({top:a})):d._$tableContent.css({top:a}),s.allowTextWrap&&s.enableVirtualization&&(d._textWrapRowsDatas.isEnd&&!d._textWrapNoCalculate?(d.updateHeight(),d._textWrapNoCalculate=!0):parseInt(d._scrollTop)>=parseInt(d.getMaxScrollHeight()-10)&&!d._textWrapRowsDatas.isEnd&&!d._textWrapNoCalculate&&(d.updateHeight("extendHeight"),d._textWrapNoCalculate=!1),d._scrollTop>=d.getMaxScrollHeight()-10&&"expandcollapse"!=i&&(a=(l=d.getMaxScrollHeight())-(this._frozenColumnsLength>0?l+e("#"+d._id+"frozene-table").height()-e("#"+d._id+"e-gridcontainer").height():l+e("#"+d._id+"e-table").height()-e("#"+d._id+"e-gridcontainer").height()),this._frozenColumnsLength>0?(d._$frozenTableContent.css({top:a}),d._$movableTableContent.css({top:a})):d._$tableContent.css({top:a})),d._scrollTop<30&&(d._textWrapNoCalculate=!1))),d._prevRTop=d._visibleRange.top,d._prevRBottom=d._visibleRange.bottom):s.allowPaging?(d._updatePagerIndex(),s.currentViewData=d._updatedPageData):s.currentViewData=d.model.updatedRecords.slice(),d._isEnterKeyPressed&&(d._isEnterKeyPressed=!1,s.allowSelection&&s.editSettings.allowEditing&&(u||(d._cellEditingDetails.rowIndex+=1),d._rowSelectingEventTrigger(this.selectedRowIndex(),d._cellEditingDetails.rowIndex)||(d.selectRows(d._cellEditingDetails.rowIndex),d._rowSelectedEventTrigger(d._cellEditingDetails.rowIndex)),d.cellEdit(d._cellEditingDetails.rowIndex,d.model.columns[d._cellEditingDetails.columnIndex].field)))},_findFilteredParentRecords:function(e){for(var t=e.length,i=[],a=0;a<t;a++)e[a].hasChildRecords&&i.push(e[a]);return i},_getRowPosition:function(e){return Math.ceil(e/(this.model.rowHeight+this._detailsRowHeight))},_getMetaColGroup:function(){return this.getHeaderTable().find("colgroup").clone()},_getEmptyTbody:function(){var i=t.buildTag("td",this.model.emptyRecordText,{},{colSpan:this.model.columns.length-this._hiddenColumns.length}),a=document.createElement("tr");return a.className="e-emptyText",e(a).height(30).append(i)},_addSortElementToColumn:function(i,a){var r,n,o,l=this;this.model.isFromGantt?(r=t.TreeGrid.getColumnByMappingName(l.model.columns,i),t.isNullOrUndefined(r)&&(r=l.getColumnByField(i))):r=t.TreeGrid.getColumnByField(l.model.columns,i),n=e.inArray(r,l.model.columns),(o=this.getHeaderTable().find("thead tr:not('.e-stackedHeaderRow')").find(".e-headercell").not(".e-detailheadercell").eq(n).find(".e-headercelldiv")).find(".e-ascending,.e-descending").remove(),o.append(l._createSortElement().addClass("e-"+a).addClass("e-icon")),o.parent().attr("aria-sort",a)},_createSortElement:function(){return t.buildTag("span","&nbsp;")},_renderCellEditObject:function(i,a){var r,n,o,l=this,d=t.buildTag("form.e-treegridform#"+l._id+"EditForm","",{},{}),s=l._cellEditTemplate,c={},u=i.columnObject,p=u.field.split(".").join(""),h=i.value;"dropdownedit"==u.editType&&0==h&&(h=h.toString()),c[p]=h,l.getColumnIndexByField(u.field),a.empty(),a.addClass("e-validError"),n=s.find("#"+p+"_CellEdit").html(),"SELECT"==(r="predecessor"===u.field||"duration"===u.field?e(e.templates(n).render(i.data)):e(e.templates(n).render(c))).get(0).tagName&&(r.val(c[p]),null==r.val()&&r.val(r.find("option").first().val())),"INPUT"==r.get(0).tagName&&l.model.isFromGantt?"predecessor"!=u.field&&"duration"!=u.field&&r.val(c[p]):"INPUT"==r.get(0).tagName&&r.val(c[p]),d.append(r),a.append(d),(o={}).columnIndex=i.columnIndex,o.data=i.data.item,o.requestType="beginEdit",l._refreshEditForm(o),e.isFunction(e.validator)&&!e.isEmptyObject(i.validationRules)&&(l._initValidator(),l.setValidation()),l.model.isEdit=!0},getIndexofresourceInfo:function(e){for(var t,i=this.model.resourceIdMapping,a=this._cellEditingDetails.data.resourceInfo,r=0,n=a&&a.length,o=[];r<n;r++)for(t=0;t<e.length;t++)e[t][i]==a[r][i]&&o.push(t);return o},_refreshEditForm:function(a){var r,n,o,l,d,s,c,u,p,h,g=this,m=g.model;g.model.editSettings.allowEditing&&("dialogEditing"==g.model.editSettings.editMode||"batchediting"==m.editSettings.editMode.toLowerCase()&&"dialog"==m.editSettings.batchEditSettings.editMode)?(r=e("#"+g._id+"EditFormDialog"),n="",o=!0):(r=e("#"+g._id+"EditForm"),n=g.model.rowHeight-5);for(var _,f,w,C,T,x,v,b,S=!1,D=e("#"+g._id+"EditFrozenForm").add(r).find("input,select,textarea"),R=0,y=D.length,I=(m=g.model,{});R<y;R++)if(b=(_=D.eq(R)).attr("data-edittype"),T=t.TreeGrid.getColumnByField(m.columns,_.prop("name")),t.isNullOrUndefined(T)&&("dialogEditing"==g.model.editSettings.editMode||"batchediting"==m.editSettings.editMode.toLowerCase()&&"dialog"==m.editSettings.batchEditSettings.editMode)){if(_.hasClass("e-btn")||"dialogEditing"==g.model.editSettings.editMode&&!t.isNullOrUndefined(m.editSettings.dialogEditorTemplateID)&&""!=m.editSettings.dialogEditorTemplateID)return;_.closest("tr").addClass("e-hide")}else{switch("dialogEditing"!=g.model.editSettings.editMode&&("batchediting"!=m.editSettings.editMode.toLowerCase()||"dialog"!=m.editSettings.batchEditSettings.editMode)||t.isNullOrUndefined(m.editSettings.dialogEditorTemplateID)||""==m.editSettings.dialogEditorTemplateID||(b=T.editType),f="100%",b){case t.TreeGrid.EditingType.Numeric:I={},w=f,C=_.val(),I.width=w,I.locale=m.locale,I.height=n,I.showSpinButton=!0,I.cssClass=m.cssClass,C.length&&(I.value=parseFloat(C)),m.isFromGantt&&"status"===T.field&&(I.minValue=0,I.maxValue=100,I.decimalPlaces=0),t.isNullOrUndefined(T.editParams)||e.extend(I,T.editParams),_.ejNumericTextbox(I),_.prop("name",_.prop("name").replace(g._id,""));break;case t.TreeGrid.EditingType.DatePicker:(I={}).width=f,I.height=n,I.locale=m.locale,I.cssClass=m.cssClass,I.dateFormat=m.dateFormat,I.enableStrictMode=!0,m.isFromGantt&&(I.startDay=m.weekStartDay),_.val().length&&(I.value=g.getDateFromFormat(_.val())),T.format!==i&&T.format.length>0&&(v=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(T.format),I.dateFormat=v[2],_.val().length&&(I.value=t.format(new Date(_.val()),I.dateFormat,I.locale),_.val(I.value))),t.isNullOrUndefined(T.editParams)||e.extend(I,T.editParams),-1==m.dateFormat.toLowerCase().indexOf("hh")?(_.ejDatePicker(I),x=_.ejDatePicker("instance")):(_.ejDateTimePicker(I),x=_.ejDateTimePicker("instance")),e(_).keydown(function(i){var a=e("#e-"+_[0].id);a.length>0&&"none"!==a.css("display")&&13==i.keyCode&&x.option("value",t.parseDate(i.currentTarget.value,x.model.dateFormat))});break;case t.TreeGrid.EditingType.DateTimePicker:(I={}).width=f,I.height=n,I.locale=m.locale,I.cssClass=m.cssClass,I.displayDefaultDate=!0,I.dateTimeFormat=m.dateFormat,I.enableStrictMode=!0,m.isFromGantt&&(I.startDay=m.weekStartDay),_.val().length&&(I.value=g.getDateFromFormat(_.val())),T.format!==i&&T.format.length>0&&(v=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(T.format),I.dateTimeFormat=v[2],_.val().length&&(I.value=t.format(new Date(_.val()),I.dateTimeFormat,I.locale),_.val(I.value))),t.isNullOrUndefined(T.editParams)||e.extend(I,T.editParams),_.ejDateTimePicker(I);break;case t.TreeGrid.EditingType.Dropdown:g._isRowEdit,l=T.dropdownData,d=T.field,m.isFromGantt&&"resourceInfo"===d?((I={}).width=f,I.height=n,I.showCheckbox=!0,I.dataSource=l,I.fields={id:m.resourceIdMapping,text:m.resourceNameMapping,value:m.resourceNameMapping},I.selectedItems=g.getIndexofresourceInfo(l),t.isNullOrUndefined(T.editParams)||e.extend(I,T.editParams),_.ejDropDownList(I)):((u={}).cssClass=m.cssClass,u.width=f,u.height=n,u.dataSource=l,t.isNullOrUndefined(T.editParams)||e.extend(u,T.editParams),_.ejDropDownList(u),_.ejDropDownList("instance")._setValue(_.attr("data-cellvalue")));break;case t.TreeGrid.EditingType.String:g.model.editSettings.allowEditing&&"dialogEditing"==g.model.editSettings.editMode?_.outerWidth("100%").height(27):_.outerWidth(f).height(m.rowHeight-9),_.css({margin:"0px",padding:"1px"});break;case t.TreeGrid.EditingType.Boolean:g._checkboxSelection&&T.nonColumn?_[0].style.display="none":((u={}).cssClass=m.cssClass,u.size="small",t.isNullOrUndefined(T.editParams)||e.extend(u,T.editParams),_.ejCheckBox(u),c=(s=_.parent(".e-chkbox-wrap")).parent("form"),o||(c.length>0?c.css("margin-left","45%"):s.css("margin-left","45%")));break;case t.TreeGrid.EditingType.Maskedit:(u={}).locale=m.locale,u.cssClass=m.cssClass,u.width=f,u.height=n,t.isNullOrUndefined(T.editParams)||e.extend(u,T.editParams),_.ejMaskEdit(u);break;case"edittemplate":p={rowdata:a.data,column:T,element:_,requestType:a.requestType},h=T.editTemplate.write,t.isNullOrUndefined(a)||"add"!=a.requestType||(p.rowdata={}),"string"==typeof h&&(h=t.util.getObject(h,window)),h(p)}_.is(":disabled")||S||_.is(":hidden")&&"object"!=typeof(_.data("ejDropDownList")||_.data("ejNumericTextbox")||_.data("ejDatePicker")||_.data("ejCheckBox"))||(g._isEnterKeyPressed||T!=m.columns[a.columnIndex])&&(a.columnIndex&&-1!=a.columnIndex||g._isEnterKeyPressed)||(g._focusElements(_.closest("td")),S=!0)}},_getRecordIndex:function(){var e=this,t=e.model,i=t.allowPaging?e._updatedPageData:e.getExpandedRecords(t.updatedRecords);return e.getVisibleRange(),i.slice(e._visibleRange.top,e._visibleRange.bottom).indexOf(t.selectedItem)},_initValidator:function(){for(var t=this,i=this._frozenColumnsLength>0?this.element.find(".e-treegridform"):e("#"+this._id+"EditForm").length>0?e("#"+this._id+"EditForm"):e("#"+this._id+"EditFormDialog"),a=0;a<i.length;a++)i.eq(a).validate({ignore:".e-hide",errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(e,i){t._renderValidator(e,i)}})},_renderValidator:function(i,a){var r,n,o,l;if(a.is(":hidden")&&(a=a.siblings("input:visible")),a.length){var d,s=this,c=s.model,u=a.closest(".e-rowcell"),p=e(i).addClass("e-error"),h=t.buildTag("div.e-errortail");(u=0==u.length?a.closest("td"):u).removeClass(".e-error"),"dialogEditing"!=c.editSettings.editMode?(r=((d=s._getRecordIndex())+1)*c.rowHeight,c.enableVirtualization||(n=s.getExpandedRecords(c.updatedRecords),d=c.allowPaging?s._updatedPageData.indexOf(c.selectedItem):n.indexOf(c.selectedItem)),-1==d&&("bottom"==c.editSettings.rowPosition?d=c.updatedRecords.length-1:"top"==c.editSettings.rowPosition&&(d=0),r=(d+1)*c.rowHeight),s._viewPortHeight<r+45?(h.addClass("e-bottomarrow"),o=d*c.rowHeight-45,l="append"):(h.addClass("e-toparrow"),o=(d+1)*c.rowHeight,l="prepend")):(o=u.offset().top-e("#"+this._id+"EditFormDialog").offset().top+u.parent()[0].offsetHeight,h.addClass("e-toparrow"),l="prepend"),e(p).css({top:o}),a.parent().hasClass("e-in-wrap")?p.insertAfter(a.closest(".e-widget")):p.insertAfter(a),p[l](h),p.show("slow")}},setValidation:function(){for(var e=this,i=e.model,a=0;a<this.model.columns.length;a++)if(!t.isNullOrUndefined(i.columns[a].validationRules)&&1==i.columns[a].visible)if(i.editSettings.editMode==t.TreeGrid.EditMode.RowEditing||i.editSettings.editMode==t.TreeGrid.EditMode.DialogEditing||e.element.find(".e-rowedit").length>0||e.element.find(".e-addedrow").length>0||i.editSettings.editMode==t.TreeGrid.EditMode.BatchEditing&&("dialog"==i.editSettings.batchEditSettings.editMode||"row"==i.editSettings.batchEditSettings.editMode))this.setValidationToField(i.columns[a].field,i.columns[a].validationRules);else if((i.editSettings.editMode==t.TreeGrid.EditMode.CellEditing||i.editSettings.editMode==t.TreeGrid.EditMode.BatchEditing&&"cell"==i.editSettings.batchEditSettings.editMode)&&e._cellEditingDetails.columnIndex==a)return void this.setValidationToField(i.columns[a].field,i.columns[a].validationRules)},setValidationToField:function(i,a){var r,n,o,l,d,s=i;t.isNullOrUndefined(i)||(s=s.replace(/[^a-z0-9\s_]/gi,"")),o=e("#"+this._id+"EditForm").length>0?e("#"+this._id+"EditForm"):e("#"+this._id+"EditFormDialog"),n=this.getColumnByField(i),!t.isNullOrUndefined(n)&&n.isFrozen&&(o=e("#"+this._id+"EditFrozenForm").length>0?e("#"+this._id+"EditFrozenForm"):e("#"+this._id+"EditFormDialog").length>0?e("#"+this._id+"EditFormDialog"):e("#"+this._id+"EditForm")),r=o.find("#"+this._id+s).length>0?o.find("#"+this._id+s):o.find("#"+s),a.regex&&(a[i+"regex"]=a.regex,delete a.regex,e.validator.addMethod(s+"regex",function(e,t,i){return(i instanceof RegExp?i:new RegExp(i)).test(e)},t.getObject("messages.regex",a)||this.getColumnByField(i).headerText+" should match the given pattern")),r.attr("name")||r.attr("name",i),r.rules("add",a),(l=e("#"+this._id+"EditForm").length>0?e("#"+this._id+"EditForm").validate():e("#"+this._id+"EditFormDialog").validate()).settings.messages[i]=l.settings.messages[i]||{},t.isNullOrUndefined(a.required)||(0==(d=t.isNullOrUndefined(a.messages&&a.messages.required)?e.validator.messages.required:a.messages.required).indexOf("This field")&&(d=d.replace("This field",this.getColumnByField(i).headerText)),l.settings.messages[i].required=d,r.hasClass("e-datepicker")&&r.ejDatePicker({watermarkText:""}))},_focusElements:function(e){var i,a,r,n=this;e.length&&(e.focus(),(i=e.children())[0]&&("select"==i[0].tagName.toLowerCase()||"input"==i[0].tagName.toLowerCase()?(i.focus().select(),i[0].focus()):i.find(".e-field.e-dropdownlist").length?i.find(".e-ddl").focus():i.find(".e-chkbox-wrap.e-widget").length?i.find(".e-chkbox-wrap.e-widget").focus():i.find(".e-datepicker").length<=0?i.find("input,select").select().focus():i.find("input,select").select())),a=n.getScrollElement().children(".e-content").scrollLeft(),r=n.getScrollElement().ejScroller("option","scrollLeft"),n.getScrollElement().hasClass("e-scroller")&&a!=r&&(t.isNullOrUndefined(a)||n.getScrollElement().ejScroller("option","scrollLeft",a)),n._updateHeaderScrollLeft(n.getScrollElement().children(".e-content").scrollLeft())},_focusElementsForRowEdit:function(e){if(e.length){var t=e.children();"select"==t[0].tagName.toLowerCase()||"input"==t[0].tagName.toLowerCase()?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t[0].focus():t.hasClass("e-chkbox-wrap")?t[0].focus():t.find(".e-datepicker").length<=0?t.find("input:visible,select").first().select().focus():t.find("input,select").select()}},_getHeightforResourceView:function(e){for(var t=0,i=0;i<e.length;i++)t+=this._getTemplateRowHeight(e[i]);return t},getRecordsHeight:function(){var e=this.model;return"resourceView"==e.viewType?e.enableVirtualization?this._getHeightforResourceView(e.updatedRecords):this._getHeightforResourceView(this.getExpandedRecords(e.updatedRecords)):e.enableVirtualization?this._isHierarchyFiltering&&this.model.enableVirtualization?this._updateFilterParent.length*e.rowHeight:this.getUpdatedRecords().length*e.rowHeight:e.rowHeight*(e.updatedRecords.length-this.getCollapsedRecordCount())},updateHeight:function(t){var i,a,r=this,n=this.model,o=0,l=0;if(r._isInExpandCollapseAll)return!0;r._$gridContainer&&r._$gridContent&&(!n.allowPaging||r.model.allowTextWrap&&n.enableVirtualization?n.enableVirtualization?"auto"==n.sizeSettings.height?o=r._getViewPortHeight():n.allowTextWrap?n.allowPaging&&!r._textWrapRowsDatas.isEnd?(r._textWrapRowsDatas=r._getAvgTextWrapRowHeight("getAvgHeight"),o=r._textWrapRowsDatas.avgHeight*r._updatedPageData.length):r._textWrapRowsDatas.isEnd?o=r._getAvgTextWrapRowHeight("updateHeight").height:"extendHeight"==t?o=e("#"+r._id+"e-gridcontainer").height()+(r.model.updatedRecords.length-r._visibleRange.bottom)*r.model.rowHeight:(r._textWrapRowsDatas=r._getAvgTextWrapRowHeight("getAvgHeight"),o="auto"==n.sizeSettings.height?r._getViewPortHeight():n.updatedRecords.length*r._textWrapRowsDatas.avgHeight):o=this.getRecordsHeight():o="auto"==n.sizeSettings.height?r._getViewPortHeight():this.getRecordsHeight():o="auto"==n.sizeSettings.height?r._getViewPortHeight():n.rowHeight*r._updatedPageData.length,n.showDetailsRow&&n.detailsTemplate&&!n.showDetailsRowInfoColumn&&"auto"!=n.sizeSettings.height&&(l=r._getExpandedDetailsRowHeight()),0==(o+=l)&&(0==n.currentViewData.length||0==n.flatRecords.length)&&(o=30),n.allowPaging&&!n.sizeSettings.height&&(n.allowTextWrap&&!n.enableVirtualization?r._$frozenTableContent.length>0?(a=i=r._$gridContainer.find("#e-frozencontentdiv"+r._id).outerHeight(),r._$gridContainer.find("#e-movablecontentdiv"+r._id).outerHeight()>a&&(i=r._$gridContainer.find("#e-movablecontentdiv"+r._id).outerHeight())):i=r._$gridContainer.find(".e-table").outerHeight():i=o,this._frozenColumnsLength>0?(r._$gridContent.css("height",i),n.allowPaging&&!n.sizeSettings.height&&r.getScrollElement().ejScroller("instance").option("height",i)):r.getScrollElement().hasClass("e-scroller")&&(r.getScrollElement().ejScroller("isHScroll")&&(i=o+r._scrollBarHeight),r.getScrollElement().ejScroller({height:i})),r._viewPortHeight=i,r._gridHeight=o+r._getNonContentHeight(),r._summaryRowsCount>0&&n.showTotalSummary&&(r._gridHeight+=r._$totalSummaryRowContainer.outerHeight()),r.element.height(r._gridHeight)),r.model.allowTextWrap&&!r.model.enableVirtualization?(r._$gridContainer.css({height:"auto",width:"auto"}),this._frozenColumnsLength&&r._$gridContainer.find("#e-movablecontentdiv"+r._id+",#e-frozencontentdiv"+r._id).css("height","auto")):(r._$gridContainer.css({height:o+"px",width:"auto"}),this._frozenColumnsLength&&r._$gridContainer.find("#e-movablecontentdiv"+r._id+",#e-frozencontentdiv"+r._id).css("height",o+"px")),"auto"==n.sizeSettings.height&&(r.getScrollElement().hasClass("e-scroller")&&r.getScrollElement().ejScroller("instance").option("height",0),r._updateContentHeight()),r.getScrollElement().hasClass("e-scroller")&&(r.getScrollElement().ejScroller("refresh"),r._textWrapRowsDatas.isEnd&&(r._textWrapRowsDatas.isEnd=!1),r._updateScrollCss()))},_updateFixedTableBorder:function(t){if("sorting"!=t&&"dragAndDrop"!=t){var i=this._frozenColumnsLength>0?e(this.getContentTable()[1]):e(this.getContentTable()),a=this.model;!a.isFromGantt&&i&&i.hasClass("e-fixed-border")&&(a.currentViewData.length>0&&!i.hasClass("e-tableLastCell")?i.addClass("e-tableLastCell"):0==a.currentViewData.length&&i.removeClass("e-tableLastCell"))}},_setScrollTop:function(t){var i=this,a=this.model,r=0,n=i._scrollTop,o=a.rowHeight,l=a.currentViewData.length,d=a.isFromGantt?i._id.replace("ejTreeGrid",""):i._id,s=e("#"+d).find(".e-ganttviewerbodyContianer");a.showDetailsRow&&a.detailsTemplate&&!a.showDetailsRowInfoColumn&&(o+=i._detailsRowHeight),a.allowPaging&&i._isNextPage&&(n=0,i._isNextPage=!1,i.getScrollElement().ejScroller("scrollY",n,!0)),0!==n&&(a.enableVirtualization?l*o<i._viewPortHeight&&("expandcollapse"==t&&a.allowTextWrap&&a.enableVirtualization?n=0:l>0&&((r=n-(i._viewPortHeight-(l-1)*o))<0&&(r=0)),a.isFromGantt?s.ejScroller("scrollY",r,!0):i.getScrollElement().ejScroller("scrollY",r,!0)):a.isFromGantt?s.ejScroller("scrollY",n,!0):("delete"==t&&((r=i.getUpdatedRecords().length*o-i._viewPortHeight)<0&&(n=0)),i.getScrollElement().ejScroller("scrollY",n,!0)))},rowHeightRefresh:function(){var e,t=this;this.model;t._updateWrapRowHeights(null,"virtualRefresh",null,"resize"),t._$frozenTableContent.length>0&&(t.getScrollElement().ejScroller("refresh"),e=t.getScrollElement().ejScroller("model.scrollTop"),t._getFrozenScrollElement().scrollTop(e))},_updateGridContentHeight:function(){var e,t,i=this,a=this.model;i._$totalSummaryRowContainer&&(i._$totalSummaryRowContainer.ejScroller({height:"auto"}),i._$footerContainer.css({overflow:"hidden"}),i._$totalSummaryRowContainer.find(".e-footercontainer").height()<a.totalSummaryHeight?i.isVScroll()&&i._$totalSummaryRowContainer.addClass("e-scrollcss"):(i._$totalSummaryRowContainer.removeClass("e-scrollcss"),i._$totalSummaryRowContainer.ejScroller({height:"auto"==a.sizeSettings.height?0:a.totalSummaryHeight}),i._$totalSummaryRowContainer.width(i._$gridContent.width()),"auto"!=a.sizeSettings.height&&i._$totalSummaryRowContainer.width("auto"))),a.allowPaging&&!a.sizeSettings.height?i._$frozenTableContent.length>0?(e=i._viewPortHeight=i._$gridContainer.find("#e-frozencontentdiv"+i._id).outerHeight(),i._$gridContainer.find("#e-movablecontentdiv"+i._id).outerHeight()>e&&(i._viewPortHeight=i._$gridContainer.find("#e-movablecontentdiv"+i._id).outerHeight())):i._viewPortHeight=i._$gridContainer.find(".e-table").outerHeight():(i._viewPortHeight=i._getViewPortHeight(),i._$totalSummaryRowContainer&&(i._viewPortHeight="auto"==a.sizeSettings.height?i._viewPortHeight:i._viewPortHeight-i._$totalSummaryRowContainer.outerHeight())),i._$gridContent.css({height:i._viewPortHeight+"px"}),i.getScrollElement().hasClass("e-scroller")&&i.getScrollElement().ejScroller("instance").option("height","auto"==a.sizeSettings.height?0:i._viewPortHeight),i._frozenColumnsLength&&("auto"==a.sizeSettings.height&&i._updateContentHeight(),(t=this.getContent().find("#e-movablecontent"+i._id).height())!=this.getContent().find("#e-frozencontainer"+i._id).height()&&(this.getContent().find("#e-frozencontainer"+i._id).height(t),i.getScrollElement().ejScroller("refresh"))),i._updateScrollCss()},_updateContentHeight:function(){var t,i=this;t=i._getViewPortHeight(),1==e("#"+i._id+"e-gridcontent").find(".e-hscrollbar").length?(e("#e-movablecontainer"+i._id).css("height",t),e("#e-movablecontent"+i._id).css("height",t-18),e("#e-movablecontentdiv"+i._id).css("height",t-18)):(e("#e-movablecontainer"+i._id).css("height",t),e("#e-movablecontent"+i._id).css("height",t)),e("#"+i._id+"e-gridcontent").css("height",t),e("#"+i._id+"e-gridcontainer").css("height",t),e("#"+i._id+"e-table").css("top",0),i.getScrollElement().ejScroller("refresh"),i._updateScrollCss()},getChildCount:function(e,t){var i,a;if(!e.hasChildRecords)return 0;for(a=0;a<e.childRecords.length;a++)t++,(i=e.childRecords[a]).hasChildRecords&&(t=this.getChildCount(i,t));return t},_updateFilteredRecords:function(e,t){var i,a=this,r=0,n=e.length,o=a.model.enableVirtualization;for(a._filteredData=e,a._flatFilteredRecords=[],a._filteredRecords=[],a._filteredGanttRecords=[],a._filterParentRecords=[],a._updateFilterParent=[];r<n;r++)i=e[r],(!t&&("child"==a.model.filterSettings.filterHierarchyMode||"none"==a.model.filterSettings.filterHierarchyMode)||t&&("child"==a.model.searchSettings.searchHierarchyMode||"none"==a.model.searchSettings.searchHierarchyMode))&&(a._isHierarchyFiltering=!0),a._addParentRecord(i,t),this.model.isFromGantt||(i.hasChildRecords&&i.childRecords.length>0&&(i.hasFilteredChildRecords=!!this._checkChildExsist(i,e,t)),i.parentItem&&(i.parentItem.hasFilteredChildRecords=!0));0!=e.length&&a._isHierarchyFiltering&&a._updateFilterLevel(),a._filteredRecords=o?a._isHierarchyFiltering?a._flatFilteredRecords:a.getExpandedRecords(a._flatFilteredRecords):a._flatFilteredRecords.slice(),0!=e.length&&a._isHierarchyFiltering&&a._updateFilterExpandState(a._filteredRecords)},_updateFilterExpandState:function(t){for(var i=this,a=t.length,r=0;r<a;r++)-1!=e.inArray(t[r].parentItem,i._flatFilteredRecords)?t[r].parentItem.expanded&&-1!=e.inArray(t[r].parentItem,i._updateFilterParent)?(i._updateFilterParent.push(t[r]),t[r].isDisplay=!0):t[r].isDisplay&&(t[r].isDisplay=!1):(i._updateFilterParent.push(t[r]),t[r].isDisplay=!0)},_updateFilterLevel:function(){for(var t=this,i=t._flatFilteredRecords,a=t._flatFilteredRecords.length,r=0;r<a;r++)-1!=e.inArray(i[r].parentItem,t._flatFilteredRecords)?i[r].filterLevel=i[r].parentItem.filterLevel+1:(i[r].filterLevel=0,t._filterParentRecords.push(i[r]))},_checkChildExsist:function(t,i,a){for(var r=t.childRecords,n=this,o=r.length,l=!1,d=0;d<o;d++)if(!a&&("child"==n.model.filterSettings.filterHierarchyMode||"both"==n.model.filterSettings.filterHierarchyMode)||a&&("child"==n.model.searchSettings.searchHierarchyMode||"both"==n.model.searchSettings.searchHierarchyMode)){if(-1!=e.inArray(r[d],n._flatFilteredRecords)){l=!0;break}r[d].isSummaryRow||n._flatFilteredRecords.push(r[d]),l=!0,r[d].hasChildRecords&&(l=this._checkChildExsist(r[d],i,a))}else{if(-1!=e.inArray(r[d],i)){l=!0;break}r[d].hasChildRecords&&(l=this._checkChildExsist(r[d],i,a))}return l},_clearFilterLevel:function(e){for(var t,i=0,a=e.length;i<a;i++)((t=e[i]).filterLevel||0==t.filterLevel)&&(t.hasChildRecords&&!t.hasFilteredChildRecords&&(t.hasFilteredChildRecords=!0),delete t.filterLevel),t.isDisplay&&delete t.isDisplay,this._isHierarchyFiltering=!1},_updateHasFilteredChildRecordsStatus:function(e){for(var t,i=0,a=e.length;i<a;i++)(t=e[i]).hasChildRecords&&!t.hasFilteredChildRecords&&(t.hasFilteredChildRecords=!0),t.filterLevel>0&&delete t.filterLevel},_addParentRecord:function(t,i){var a=this;if("none"==a.model.filterSettings.filterHierarchyMode&&!i||"none"==a.model.searchSettings.searchHierarchyMode&&i)if(null==t.parentItem){if(-1!=e.inArray(t,a._filteredData))return void(-1==e.inArray(t,a._flatFilteredRecords)&&(a._flatFilteredRecords.push(t),t.hasFilteredChildRecords=!0))}else a._addParentRecord(t.parentItem,i),-1!=e.inArray(t.parentItem,a._filteredData)||-1!=e.inArray(t.parentItem,a._flatFilteredRecords)?-1==e.inArray(t,a._flatFilteredRecords)&&a._flatFilteredRecords.push(t):-1!=e.inArray(t,a._filteredData)&&-1==e.inArray(t,a._flatFilteredRecords)&&a._flatFilteredRecords.push(t);else t.parentItem&&("child"==a.model.filterSettings.filterHierarchyMode&&!i||"child"==a.model.searchSettings.searchHierarchyMode&&i?-1!=e.inArray(t.parentItem,a._filteredData)&&a._addParentRecord(t.parentItem,i):a._addParentRecord(t.parentItem,i)),-1===e.inArray(t,a._flatFilteredRecords)&&a._flatFilteredRecords.push(t)},_updateExpandCollapseForSortedRecords:function(e,t){var i,a,r=this,n=0,o=r._sortedRecords.length,l=r._sortedRecords.indexOf(e);if(t)r._addNestedSortRecords(e,l);else{for(a=0,n=l+1;n<o&&(i=r._sortedRecords[n]).level!==e.level;n++)r.getExpandStatus(i)||a++;r._sortedRecords.splice(l+1,a)}},_addNestedSortRecords:function(i,a){var r,n,o,l,d,s=this,c=s.model.sortSettings.sortedColumns;if(c.length)for(n=c.length-1,s._queryManagar.queries=[],o=n;o>=0;o--)s._queryManagar.sortBy(c[o].field,c[o].direction);if(i.hasChildRecords)for(n=(r=t.DataManager(i.childRecords).executeLocal(s._queryManagar).result).length,l=0;l<n;l++)d=r[l],s._filteredRecords.length?-1!==e.inArray(d,s._filteredRecords)&&s._sortedRecords.splice(++a,0,d):s._sortedRecords.splice(++a,0,d),d.hasChildRecords&&d.expanded&&s._addNestedSortRecords(d,a)},updateEditSettings:function(e){var i=this;e&&(e.editMode&&("normal"===i.model.editSettings.editMode&&"cellEditing"===e.editMode?(i.model.editSettings.editMode=e.editMode,i._processEditing()):i.model.editSettings.editMode=e.editMode),t.isNullOrUndefined(e.allowAdding)||(i.model.editSettings.allowAdding=e.allowAdding),t.isNullOrUndefined(e.allowEditing)||(i.model.editSettings.allowEditing=e.allowEditing),t.isNullOrUndefined(e.allowDeleting)||(i.model.editSettings.allowDeleting=e.allowDeleting),t.isNullOrUndefined(e.beginEditAction)||(i.model.editSettings.beginEditAction=e.beginEditAction),i._enableEditingEvents())},updateAltRow:function(){var e,t=0,i=this.model.updatedRecords,a=i.length,r=!0;for(t=0;t<a;t++)!(e=i[t]).isSummaryRow&&this.getExpandStatus(e)&&(e.isAltRow=!r,r=e.isAltRow)},_getFilteredChildRecordsCount:function(e){var t,i=this,a=i.model,r=e&&e.childRecords&&e.childRecords.length,n=0;for(n=0;n<r;n++)t=e.childRecords[n],a.enableVirtualization?i.getExpandStatus(t)&&i._removedCount++:i._removedCount++,t.childRecords&&i._getFilteredChildRecordsCount(t);return i._removedCount},_sortingRecords:function(){var e,i,a,r,n=this,o=n.model,l=o.sortSettings.sortedColumns;if(n._queryManagar.queries=[],l.length)for(e=l.length-1;e>=0;e--)o.isFromGantt?(a=t.TreeGrid.getColumnByMappingName(n.model.columns,l[e].field),t.isNullOrUndefined(a)&&(a=this.getColumnByField(l[e].field)),i=a.field):i=l[e].field,o.isFromGantt&&("resourceInfo"===i?i="resourceNames":"predecessor"===i&&(i="predecessorsName")),n._queryManagar.sortBy(i,l[e].direction);return r=new t.DataManager(o.parentRecords).executeLocal(n._queryManagar).result,n._sortedRecords=[],n._storedIndex=-1,n._rowIndex=-1,n._createSortedRecords(r),n._tempsortedrecords=n._sortedRecords,n.model.updatedRecords=n._sortedRecords,n._isHierarchyFiltering&&(n._updateFilterParent=n._sortedRecords),o.allowPaging&&o.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(o.parentRecords=n._getParentRecords(n.model.updatedRecords,n,!0)),!0},_createSortedRecords:function(i){var a=this,r=a.model,n=a._sortedRecords,o=a.model.enableAltRow;r=this.model;i=a._spliceSummaryRows(i),e.each(i,function(e,i){var l,d;if(i.isSummaryRow)return l=i.parentItem.childRecords.indexOf(i),void i.parentItem.childRecords.splice(l,1);a._filterString.length>0||a._searchString.length>0||r.filterSettings.filteredColumns.length>0?a._filteredRecords.length>0&&-1!==a._filteredRecords.indexOf(i)&&(a._storedIndex++,a._rowIndex++,o&&(i.isAltRow=a._rowIndex%2!=0),n[a._storedIndex]=i):(a._storedIndex++,a._rowIndex++,o&&(i.isAltRow=a._rowIndex%2!=0),n[a._storedIndex]=i),i.hasChildRecords&&i.expanded?(i.childRecords=a._spliceSummaryRows(i.childRecords),d=t.DataManager(i.childRecords).executeLocal(a._queryManagar).result,a._createSortedRecords(d)):!i.hasChildRecords||i.expanded||r.enableVirtualization||(i.childRecords=a._spliceSummaryRows(i.childRecords),a._setChildRecords(i,n))})},_setChildRecords:function(e,i){var a,r,n=this,o=n.model,l=n.model.enableAltRow,d=e.childRecords.length;for(a=t.DataManager(e.childRecords).executeLocal(n._queryManagar).result,r=0;r<d;r++)n._filterString.length>0||n._searchString.length>0||o.filterSettings.filteredColumns.length>0?n._filteredRecords.length>0&&-1!==n._filteredRecords.indexOf(a[r])&&(n._storedIndex++,l&&(a[r].isAltRow=n._storedIndex%2!=0),i[n._storedIndex]=a[r],a[r].hasChildRecords&&this._setChildRecords(a[r],i)):(n._storedIndex++,l&&(a[r].isAltRow=n._storedIndex%2!=0),i[n._storedIndex]=a[r],a[r].hasChildRecords&&this._setChildRecords(a[r],i))},_updateSortedRecords:function(i){for(var a,r,n=this,o=0,l=i.length,d=this.model;o<l;o++)a=i[o],d.enableVirtualization||(n._filteredRecords.length>0?-1!==e.inArray(a,n._filteredRecords)&&-1===e.inArray(a,n._sortedRecords)&&n._sortedRecords.push(a):-1===e.inArray(a,n._sortedRecords)&&n._sortedRecords.push(a),a.hasChildRecords&&a.childRecords.length>0&&(r=t.DataManager(a.childRecords).executeLocal(n._queryManagar).result,n._updateSortedRecords(r)))},_removeSortElementFromColumn:function(i){var a=this,r=t.TreeGrid.getColumnByField(a.model.columns,i),n=e.inArray(r,a.model.columns),o=a.getHeaderTable().find("thead").find(".e-headercell").eq(n).find(".e-headercelldiv");o.find(".ascending,.descending").remove(),o.parent().removeAttr("aria-sort")},_addEmptyColumntoGrid:function(){var i=this;e(i.element).find(".e-gridheadercontainer table colgroup").append(t.buildTag("col","",{width:"auto"},{})),i._$gridContainer.find("table colgroup").append(t.buildTag("col","",{width:"auto"},{})),e(i.element).find(".e-gridheadercontainer table thead tr").append(t.buildTag("th.e-headercell"))},updateScrollTop:function(e,i){var a={},r=this;a.requestType=t.TreeGrid.Actions.Scroll,a.delta=e,!r.getScrollElement().ejScroller("isHScroll")&&this.model.isFromGantt?r._$gridContent.scrollTop(e):r._$gridContent.scrollTop(0),r.getScrollElement().ejScroller("scrollY",e,!0),r.model.isFromGantt&&!i?(r._completeAction(a),r._focusTreeGridElement()):r._isFromChart=!1},_selectNextCell:function(t,i){var a,r,n,o,l=this,d=l.model,s=d.columns,c=s.length,u=e("#"+l._id+"EditForm"),p=l.getUpdatedRecords(),h=d.allowPaging?p:l.getExpandedRecords(d.updatedRecords);switch(l._isShiftKeyNavigation=!1,t){case"right":if(l._focusingRowIndex>=p.length-1&&l._cellIndex>=c-1||-1==l._focusingRowIndex||-1==l._cellIndex)return void l.element[0].focus();if(l._cellIndex+=1,l._cellIndex==c){if(l._cellIndex=0,n=p[l._rowIndexOfLastSelectedCell],(r=h[(a=h.indexOf(n))+1])&&r.isSummaryRow&&(r=l._getNextRecord(a+1,h)),!r)return;l._focusingRowIndex=p.indexOf(r)}if(l._focusingRowIndex>=p.length)return;(!s[l._cellIndex].visible||!s[l._cellIndex].allowCellSelection)&&u.length<=0&&(l._cellIndex=l.getUpNextVisibleColumnIndex(l._cellIndex,i)),u.length>0&&s[l._cellEditingDetails.columnIndex].allowCellSelection&&(l._cellIndex=l._cellEditingDetails.columnIndex),o={rowIndex:l._focusingRowIndex,cellIndex:l._cellIndex},l.selectCells([o]),l.updateScrollBar();break;case"left":if(l._cellIndex-=1,c=s.length,l._cellIndex<0){if(l._cellIndex=c-1,n=p[l._rowIndexOfLastSelectedCell],(r=h[(a=h.indexOf(n))-1])&&r.isSummaryRow&&(r=l._getNextRecord(a-1,h,"upArrow")),!r)return;l._focusingRowIndex=p.indexOf(r)}if(l._focusingRowIndex<0)return;l._focusingRowIndex>=p.length&&(l._focusingRowIndex=p.length-1),(!s[l._cellIndex].visible||!s[l._cellIndex].allowCellSelection)&&u.length<=0&&(l._cellIndex=l.getPreviousVisibleColumnIndex(l._cellIndex,i)),u.length>0&&s[l._cellEditingDetails.columnIndex].allowCellSelection&&(l._cellIndex=l._cellEditingDetails.columnIndex),o={rowIndex:l._focusingRowIndex,cellIndex:l._cellIndex},l.selectCells([o]),l.updateScrollBar()}},_moveCurrentCell:function(i){var a,r,n,o=this,l=o._cellEditingDetails.rowIndex,d=o._cellEditingDetails.columnIndex,s=o.model,c=o.getUpdatedRecords();if(-1==l&&-1==d)return!1;switch(o.model.isEdit&&(o.saveCell(),o.model.isEdit=!1),s.enableVirtualization&&(a=s.currentViewData[l],o._cellEditingDetails.rowIndex=l=c.indexOf(a)),i){case"right":var u,p=(m=s.columns).length,h=o.getHiddenColumns(),g=e.extend([],m);if(h&&h.forEach(function(e){g.splice(g.indexOf(e),1)}),f=g.indexOf(m[d]),w=g.length,l==c.length-1&&f==w-1)return!0;if(f==w-1){for(u=0;!m[u].visible;)u++;if(o._cellEditingDetails.columnIndex=u,o._getNextRow(i,l,o))return!0}else{for(u=d+1;!m[u].visible;)u++;o._cellEditingDetails.columnIndex=u}for(;0==s.columns[u].allowEditing||!m[u].visible;)if(u+1!=s.columns.length)o._cellEditingDetails.columnIndex=++u;else if(o._cellEditingDetails.columnIndex=u=0,o._getNextRow(i,l,o))return!0;o.updateScrollBar(),o.cellEdit(o._cellEditingDetails.rowIndex,s.columns[o._cellEditingDetails.columnIndex].field),o._editAddTools();break;case"left":var m,_,f,w;p=(m=s.columns).length,h=o.getHiddenColumns(),g=e.extend([],m);if(h&&h.forEach(function(e){g.splice(g.indexOf(e),1)}),f=g.indexOf(m[d]),w=g.length,0==l&&0==f)return!0;if(0==f){for(_=s.columns.length-1;!m[_].visible;)_--;if(o._cellEditingDetails.columnIndex=_,o._getNextRow(i,l,o))return!0}else{for(_=d-1;!m[_].visible;)_--;o._cellEditingDetails.columnIndex=_}for(;0==s.columns[_].allowEditing||!m[_].visible;)if(_-1!=-1)o._cellEditingDetails.columnIndex=--_;else if(o._cellEditingDetails.columnIndex=_=p-1,o._getNextRow(i,l,o))return!0;o.updateScrollBar(),o.cellEdit(o._cellEditingDetails.rowIndex,s.columns[o._cellEditingDetails.columnIndex].field),o._editAddTools();break;case"up":if(0==l)return!0;o._cellEditingDetails.rowIndex=l-1,o.selectRows(o._cellEditingDetails.rowIndex),o._rowSelectedEventTrigger(o._cellEditingDetails.rowIndex),o.cellEdit(o._cellEditingDetails.rowIndex,s.columns[o._cellEditingDetails.columnIndex].field);break;case"down":if(l+1==c.length&&(o._focusTreeGridElement(),o._isEnterKeyPressed=!0),s.showSummaryRow&&l+1==c.length-s.summaryRows.length&&(o._isEnterKeyPressed=!0),o._isEnterKeyPressed)o._isEnterKeyPressed=!1;else{if(c.length>l+1)if(s.enableVirtualization){if((C=c[l+1])&&C.isSummaryRow&&(C=o._getNextRecord(l+1,c)),-1==(r=c.indexOf(C)))return!0;o._cellEditingDetails.rowIndex=r}else{var C,T=c[l],x=s.allowPaging?c:o.getExpandedRecords(s.updatedRecords);if((C=x[x.indexOf(T)+1])&&C.isSummaryRow&&(C=o._getNextRecord(l+1,x)),r=c.indexOf(C),l==x.length-1&&d==s.columns.length-1||-1==r)return!0;o._cellEditingDetails.rowIndex=r}o._rowSelectingEventTrigger(o.selectedRowIndex(),o._cellEditingDetails.rowIndex)||(o.selectRows(o._cellEditingDetails.rowIndex),o._rowSelectedEventTrigger(o._cellEditingDetails.rowIndex)),o.updateScrollBar(),(n={}).requestType=t.TreeGrid.Actions.Scroll,n.delta=o._$gridContent.children(".e-content").scrollTop(),o._trigger("actionComplete",n),o.cellEdit(o._cellEditingDetails.rowIndex,s.columns[o._cellEditingDetails.columnIndex].field),o._editAddTools()}}return!1},_getNextRecord:function(e,t,i){var a;do{a=t[e],"upArrow"==i||"lastRowSelection"==i||"bottomRowSelection"==i||"child"==i||"above"==i?e--:e++}while(a&&a.isSummaryRow);return a},_getNextRow:function(e,t,i){var a,r,n,o=i.model,l=i.getUpdatedRecords();if(a="right"==e?1:-1,o.enableVirtualization){if((d=l[t+a])&&d.isSummaryRow&&(n=a>0?"":"lastRowSelection",d=i._getNextRecord(t+a,l,n)),o.allowPaging&&d&&((r=l.indexOf(d))<0&&1==a?i.gotoPage(i._currentPage()+1):r<0&&-1==a&&i.gotoPage(i._currentPage()-1)),-1==(r=l.indexOf(d)))return!0;i._cellEditingDetails.rowIndex=r}else{var d,s=l[t],c=o.allowPaging?l:i.getExpandedRecords(o.updatedRecords);if((d=c[c.indexOf(s)+a])&&d.isSummaryRow&&(n=a>0?"":"lastRowSelection",d=i._getNextRecord(t+a,c,n)),o.allowPaging&&d&&((r=l.indexOf(d))<0&&1==a?i.gotoPage(i._currentPage()+1):r<0&&-1==a&&i.gotoPage(i._currentPage()-1)),-1==(r=l.indexOf(d)))return!0;i._cellEditingDetails.rowIndex=r}o.allowSelection&&"cell"==o.selectionSettings.selectionMode?(o.selectedItem=l[i._cellEditingDetails.rowIndex],i._rowIndexOfLastSelectedCell=i._cellEditingDetails.rowIndex):i._rowSelectingEventTrigger(i.selectedRowIndex(),i._cellEditingDetails.rowIndex)||(i.selectRows(i._cellEditingDetails.rowIndex),i._rowSelectedEventTrigger(i._cellEditingDetails.rowIndex))},_findColumnsWidth:function(){for(var e=this,t=e.model.columns.length,i=e.getHeaderTable().find("colgroup").find("col"),a=0;a<t;a++)e.columnsWidthCollection[a]=i.eq(a).width()},_calculateWidth:function(){for(var e=this.getHeaderTable().find("colgroup").find("col"),t=0,i=0;i<e.length;i++)t+=e.eq(i).width();return t},getScrollObject:function(){return this.getScrollElement().data("ejScroller")},_updateElementHeight:function(){this._calculateDimensions(),this.updateViewPortHeight()},getScrollElement:function(){return this._frozenColumnsLength>0?this.element.find("#e-movablecontainer"+this._id):this._$gridContent},_getFrozenScrollElement:function(){return this._frozenColumnsLength>0?this.element.find("#e-frozencontainer"+this._id):null},_getFrozenColumnWidth:function(e){var i,a=0,r=(e=t.isNullOrUndefined(e)?this._frozenColumnsLength:e,t.isNullOrUndefined(e)?this._frozenColumns:this.model.columns);if(e>0)for(i=0;i<e;i++)1==r[i].visible&&(a+=r[i]?this.columnsWidthCollection[i]:0);return a},_renderScroller:function(i){var a,r,n,o=this,l=o.model,d=(l.flatRecords.length,l.rowHeight,o._viewPortHeight),s=!1;if(l.allowPaging&&!l.sizeSettings.height&&l.allowTextWrap&&!l.enableVirtualization&&(o._$frozenTableContent.length>0?(a=d=o._$gridContainer.find("#e-frozencontentdiv"+o._id).outerHeight(),o._$gridContainer.find("#e-movablecontentdiv"+o._id).outerHeight()>a&&(d=o._$gridContainer.find("#e-movablecontentdiv"+o._id).outerHeight())):d=o._$gridContainer.find(".e-table").outerHeight()),!o._$gridContent.hasClass("e-scroller")||l.allowPaging&&!l.sizeSettings.height){var c=o._gridHeight?d:"auto",u=this._gridWidth;this._frozenColumnsLength>0&&(o._$gridContent.css("width",u-o._totalBorderWidth),u=u-this._getFrozenColumnWidth()-1),l.isFromGantt||!0,this.mobileDevice()&&!l.isFromGantt&&(s=!0,o._scrollBarHeight=10),o.getScrollElement().ejScroller({enableTouchScroll:!1,autoHide:s,scrollerSize:o._scrollBarHeight,height:o.model.isFromGantt?0:"auto"==l.sizeSettings.height?0:c,width:o.model.isFromGantt?u:u-o._totalBorderWidth,scroll:e.proxy(o._onScroll,o)})}else o.getScrollElement().ejScroller("refresh");o.getScrollElement().ejScroller("model.keyConfigs",{up:"",down:"",left:"",right:""}),t.isNullOrUndefined(i)&&o._updateScrollCss(),r=o.getScrollElement().ejScroller("isHScroll"),l.allowPaging&&!l.sizeSettings.height&&r&&(n=c+o._scrollBarHeight,o.getScrollElement().ejScroller({height:n}),o.getScrollElement().ejScroller("refresh")),!this.mobileDevice()&&"safari"==this.getBrowserDetails().browser&&this._frozenColumnsLength>0&&(this.getHeaderContent().find("#e-movableheader"+o._id).add(this.getContent().find("#e-movablecontainer"+o._id)).css("margin-left","auto"),this._$totalSummaryRowContainer&&this._$totalSummaryRowContainer.find("#e-movablefooter"+o._id).css("margin-left","auto")),this._frozenColumnsLength>0&&(o._$gridContent.height(c),o.getContent().find("#e-frozencontainer"+o._id).height(o.getContent().find("#e-movablecontent"+o._id).height()))},_destroy:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_=this,f=this.model,w=f.columns;if(_.element.off(),_._off(_.element,"click",_._onClick),_._off(_.element,"keydown",_._keyDown),_._off(_.element,"click","#"+_._id+"e-gridheader",_._onHeaderClick),_._off(_.element,"mousedown touchstart","#"+_._id+"e-gridheader",_._headerMouseDown),_._off(e(document),"mousedown touchstart",_._mouseDownHandler),_._off(_.element,"mousedown touchstart",".e-gridcontent",_._contentMouseDown),_._off(_.element,"click",_._onRecordClick),_._off(_.element,"dblclick",".e-gridcontent > div",_._onRecordDoubleClick),"immediate"==f.filterSettings.filterBarMode&&(_._off(_.element,"keyup",".e-filterbarcell input",_._filterBarHandler),_._off(_.element,"click",".e-filterbarcell .e-checkbox")._off(_.element,"click",".e-filterbarcell .e-checkbox",_._filterBarHandler)),f.isResponsive&&_._off(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),_._off(_.element,"mousemove",_._mouseMove),_._off(_.element,"touchmove",_._mouseMove),_._off(_.element,"focus click",".e-filterbarcell input",_._filterBarClose),_._off(_.element,"click",".e-filterbarcell .e-cancel",_._filterBarClose),_.model.showGridCellTooltip&&!_.model.showGridExpandCellTooltip?"msie"==t.browserInfo().name?_._off(_.element,"mouseenter",".e-rowcell",_._mouseHover):_._off(_.element,"mousemove",".e-rowcell",_._mouseHover):_._off(_.element,"mouseenter",".e-rowcell",_._mouseHover),_.model.showGridCellTooltip&&("msie"==t.browserInfo().name?_._off(_.element,"mouseenter",".e-headercelldiv",_._headermouseHover):_._off(_.element,"mousemove",".e-headercelldiv",_._headermouseHover)),_._off(_.element,"mouseleave",".e-rowcell",_._cellMouseLeave),_._off(_.element,"mouseleave",_._cellMouseLeave),_._off(_.element,"mouseleave",".e-headercelldiv",_._headerMouseLeave),_._off(_.element,"mouseleave",_._headerMouseLeave),(f.isFromGantt||this._frozenColumnsLength)&&_._off(_.element,"mousewheel DOMMouseScroll",_._mouseWheel),f.enableResize&&f.isResponsive&&!f.isFromGantt&&_._off(e(window),"resize",_._windowResize),t.isTouchDevice()?_._off(_.element,"doubletap ",".e-gridcontent",_._editdblClickHandler):_._off(_.element,"dblclick ",".e-gridcontent",_._editdblClickHandler),f.contextMenuSettings.showContextMenu&&_._off(_.element,"keyup contextmenu taphold",this._preventContextMenu),_.getScrollElement().ejScroller("content").stop(!0),this._clearColumnMenu(),this._clearContextMenu(),this._removeDetailsRow(),e("#"+this._id+"_toolbarItems_Main").remove(),_._columnRenameDialog&&(e("#"+_._columnRenameDialog.attr("id")+"_wrapper").clearQueue(),e("#"+_._columnRenameDialog.attr("id")+"_wrapper").stop(),_._columnRenameDialog.data("ejDialog")&&_._columnRenameDialog.data("ejDialog").destroy(),e("#"+_._columnRenameDialog.attr("id")+"_wrapper").remove(),e("#"+_._id+"ColumnRenameDialog").remove()),this.model.showColumnChooser&&(e("#"+_._id+"ccDiv_wrapper").clearQueue(),e("#"+_._id+"ccDiv_wrapper").stop(),e("#"+this._id+"ccDiv").data("ejDialog")&&e("#"+this._id+"ccDiv").data("ejDialog").destroy(),e("#"+_._id+"ccDiv_wrapper").remove(),e("#"+this._id+"ccDiv").remove()),_._updateConfirmDialog&&(e("#"+_._updateConfirmDialog.attr("id")+"_wrapper").clearQueue(),e("#"+_._updateConfirmDialog.attr("id")+"_wrapper").stop(),_._updateConfirmDialog.data("ejDialog")&&_._updateConfirmDialog.data("ejDialog").destroy(),e("#"+_._updateConfirmDialog.attr("id")+"_wrapper").remove(),e("#"+_._id+"ConfirmDialog").remove()),_._confirmDialog&&(e("#"+_._confirmDialog.attr("id")+"_wrapper").clearQueue(),e("#"+_._confirmDialog.attr("id")+"_wrapper").stop(),_._confirmDialog.data("ejDialog")&&_._confirmDialog.data("ejDialog").destroy(),e("#"+_._confirmDialog.attr("id")+"_wrapper").remove(),e("#"+_._id+"_ConfirmDialog").remove()),e("#"+_._id+"_dialogColumnAdd_wrapper").length>0&&(e("#"+_._id+"_dialogColumnAdd_wrapper").clearQueue(),e("#"+_._id+"_dialogColumnAdd_wrapper").stop(),e("#"+_._id+"_dialogColumnAdd").find(".e-datepicker").ejDatePicker("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-datetimepicker").ejDateTimePicker("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-numerictextbox").ejNumericTextbox("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-dropdownlist").ejDropDownList("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-treegrid").ejTreeGrid("destroy"),e("#"+_._id+"_dialogColumnAdd").data("ejDialog")&&e("#"+_._id+"_dialogColumnAdd").data("ejDialog").destroy(),e("#"+_._id+"_dialogColumnAdd_wrapper").remove(),e("#"+_._id+"_dialogColumnAdd").remove()),f.allowFiltering&&!f.isFromGantt)for(i=0;i<w.length;i++)(a=e("#"+this._id+"_"+w[i].field.split(".").join("")+"_filterbarcell")).data("ejWidgets")&&e(a).data(e(a).data("ejWidgets")[0]).destroy();if(_.model.allowFiltering&&"menu"==_.model.filterSettings.filterType)for(r=_._renderedFilterMenuDialog,u=0;u<r.length;u++)r[u]&&(l=r[u].indexOf("edit"),n=r[u],-1!=l?o=(d=n.slice(0,l)).charAt(0).toUpperCase()+d.slice(1):o=n.charAt(0).toUpperCase()+n.slice(1)),"String"==o?e("#"+this._id+"filter"+o+"MenuDiv").find(".e-autocomplete").ejAutocomplete("destroy"):"Datepicker"==o?e("#"+this._id+"filter"+o+"MenuDiv").find(".e-datepicker").ejDatePicker("destroy"):"Datetimepicker"==o?e("#"+this._id+"filter"+o+"MenuDiv").find(".e-datetimepicker").ejDateTimePicker("destroy"):"Numeric"==o&&e("#"+this._id+"filter"+o+"MenuDiv").find(".e-numerictextbox").ejNumericTextbox("destroy"),e("#"+this._id+"filter"+o+"MenuDiv_wrapper").clearQueue(),e("#"+this._id+"filter"+o+"MenuDiv_wrapper").stop(),e("#"+this._id+"filter"+o+"MenuDiv").find(".e-dropdownlist").ejDropDownList("destroy"),e("#"+this._id+"filter"+o+"MenuDiv").data("ejDialog")&&e("#"+this._id+"filter"+o+"MenuDiv").data("ejDialog").destroy(),e("#"+this._id+"filter"+o+"MenuDiv_wrapper").remove(),e("#"+this._id+"filter"+o+"MenuDiv").remove();if(_._commandColumnLength>0)for(u=0;u<w.length;u++)w[u].commands&&w[u].commands.length>0&&e("#"+this._id+u+"_UnboundTemplate").remove();for(c=(s=["number","string","date","datetime","boolean"]).length,u=0;u<c;u++)switch(e("#"+_._id+s[u]+"_CustomDrop1_popup_wrapper").clearQueue(),e("#"+_._id+s[u]+"_CustomDrop1_popup_wrapper").stop(),e("#"+_._id+s[u]+"_CustomDrop1").data("ejDropDownList")&&e("#"+_._id+s[u]+"_CustomDrop1").data("ejDropDownList").destroy(),e("#"+_._id+s[u]+"_CustomDrop2_popup_wrapper").clearQueue(),e("#"+_._id+s[u]+"_CustomDrop2_popup_wrapper").stop(),e("#"+_._id+s[u]+"_CustomDrop2").data("ejDropDownList")&&e("#"+_._id+s[u]+"_CustomDrop2").data("ejDropDownList").destroy(),e("#"+_._id+s[u]+"_CheckBoxList_WaitingPopup").remove(),s[u]){case"string":e("#"+_._id+s[u]+"_CustomValue1_suggestion").remove(),e("#"+_._id+s[u]+"_CustomValue2_suggestion").remove();break;case"date":e("#e-"+_._id+s[u]+"_CustomValue1").remove(),e("#e-"+_._id+s[u]+"_CustomValue2").remove();break;case"datetime":e("#"+_._id+s[u]+"_CustomValue1_popup").remove(),e("#"+_._id+s[u]+"_CustomValue2_popup").remove()}for(_.element.empty().removeClass("e-treegrid-core e-treegrid "+_.model.cssClass),_.element.data("ejWaitingPopup")&&_.element.ejWaitingPopup("destroy"),u=0;u<w.length;u++)w[u].isTemplateColumn&&(p=w[u].headerText,t.isNullOrUndefined(p)||t.isNullOrUndefined(p.match(/(\\|[^0-9A-z-_])/g))||(p=p.replace(/(\\|[^0-9A-z-_])/g,"")),e("#"+_._id+p+e.inArray(w[u],_.model.columns)+"_Template").length>0&&e("#"+_._id+p+e.inArray(w[u],_.model.columns)+"_Template").remove()),w[u].headerTemplateID&&(h=this._id+(w[u].field?w[u].field:"")+e.inArray(w[u],this.model.columns)+"_HeaderTemplate",e("#"+h).remove());for(m in g=e.views.helpers)-1!=m.indexOf(this._id)&&delete g[m];_._columnChooserList.remove()},collapseAll:function(){var e=this,i=e.model,a={};i.enableVirtualization,e.getRows();e.editFormValidate()&&(e._expandCollapseSettings.state="collapseAll",e._expandCollapseSettings.atLevel="",e._expandCollapseSettings.level=0,e._expandCollapsePages=[],(e._isRowEdit||e.model.isEdit)&&(e._isRowEdit?e.cancelRowEditCell():e.cancelEditCell(),e.selectRows(-1),e._cancelSaveTools()),a.requestType=t.TreeGrid.Actions.ExpandCollapse,e._isInExpandCollapseAll=!0,e._collapseAllData(),i.flatRecords.length>0&&e._refreshTreeGridOnExpandCollapseAll(a),e._isInExpandCollapseAll=!1,e.updateHeight())},_triggerExpandingCollapsingEvent:function(e){return e.expanded?this._trigger("expanding",e):this._trigger("collapsing",e)},_collapseAllData:function(){var e,i,a,r=this,n=r.model,o={};if(o.requestType=t.TreeGrid.Actions.ExpandCollapse,n.allowPaging&&n.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&n.enableVirtualization){var l=n.pageSettings.pageSize,d=r._currentPage(),s=l*d,c=l*(d-1);for(r._expandCollapsePages.push(d),e=c;e<s;e++)(a=r._isHierarchyFiltering?r._filterParentRecords[e]:r.model.parentRecords[e])&&(o.data=a,o.recordIndex=n.updatedRecords.indexOf(a),o.expanded=!1,a.hasChildRecords&&(r._triggerExpandingCollapsingEvent(o)||(r._expandCollapseInnerLevelRecord(a,o.expanded),t.TreeGrid.sendExpandCollapseRequest(r,o))))}else for(i=r._isHierarchyFiltering?r._filterParentRecords:r.model.parentRecords,e=0;e<i.length;e++)a=i[e],o.data=a,o.recordIndex=n.updatedRecords.indexOf(a),o.expanded=!1,a.hasChildRecords&&(r._triggerExpandingCollapsingEvent(o)||(r._expandCollapseInnerLevelRecord(a,o.expanded),t.TreeGrid.sendExpandCollapseRequest(r,o)))},_getContextMenuItems:function(){var e=this._contextMenuTexts;return[{headerText:e.addRowText,eventHandler:null,isDefault:!0,disable:!1,menuId:"Add",parentMenuId:null},{iconClass:"e-edit",headerText:e.editText,eventHandler:null,isDefault:!0,disable:!1,menuId:"Edit",parentMenuId:null},{headerText:e.deleteText,eventHandler:null,isDefault:!0,disable:!1,menuId:"Delete",parentMenuId:null},{iconClass:"e-save",headerText:e.saveText,eventHandler:null,isDefault:!0,isEdit:!0,disable:!1,menuId:"Save",parentMenuId:null},{iconClass:"e-cancel",headerText:e.cancelText,eventHandler:null,isDefault:!0,isEdit:!0,disable:!1,menuId:"Cancel",parentMenuId:null},{iconPath:null,headerText:e.aboveText,eventHandler:null,menuId:"Above",parentMenuId:"Add"},{iconPath:null,headerText:e.belowText,eventHandler:null,menuId:"Below",parentMenuId:"Add"}]},_getHeaderContextMenuItems:function(a){var r,n,o,l,d,s=[],c=this,u=c.model,p=e(a.target),h=c._columnMenuTexts,g=p.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),m=c.getColumnByField(g);return null!=m&&(o=m.allowSorting==i||m.allowSorting,u.allowSorting&&o&&(s.push({iconClass:"e-columnmenu-ascending",headerText:h.sortAscendingText,eventHandler:null,isDefault:!1,disable:!1,menuId:"contextMenu_SortAscending",parentMenuId:null}),s.push({iconClass:"e-columnmenu-descending",headerText:h.sortDescendingText,eventHandler:null,isDefault:!1,disable:!1,menuId:"contextMenu_SortDescending",parentMenuId:null})),(u.showColumnChooser||u.contextMenuSettings.showContextMenu)&&(s.length,s.push({iconClass:"e-columnchooser-icon",headerText:h.columnsText,eventHandler:null,isDefault:!1,disable:!1,menuId:"contextMenu_Columns",parentMenuId:null,isExpanderIcon:!0})),u.isFromGantt||(m.allowFreezing||c._allowFreezingDefault&&t.isNullOrUndefined(m.allowFreezing))&&(c._frozenColumnsLength!=u.columns.length-1||m.isFrozen||(r=!0),l=this._getFrozenColumnWidth(),d=u.columns.indexOf(m),(l=l+this.columnsWidthCollection[d]+18)>this._gridWidth&&(r=!0),s.push({iconClass:"e-freezecolumn-icon",headerText:h.freezeText,eventHandler:null,isDefault:!1,disable:!(!r&&!m.isFrozen),menuId:"contextMenu_Freeze",parentMenuId:null}),s.push({iconClass:"e-unfreezecolumn-icon",headerText:h.unfreezeText,eventHandler:null,isDefault:!1,disable:!(1==m.isFrozen),menuId:"contextMenu_Unfreeze",parentMenuId:null}),c._checkboxSelection&&u.columns[0].nonColumn?1!=u.columns.indexOf(m)&&u.columns.indexOf(m)>this._frozenColumnsLength&&(n=!0):0!=u.columns.indexOf(m)&&u.columns.indexOf(m)>this._frozenColumnsLength&&(n=!0),l=this._getFrozenColumnWidth(d),(l+=18)>this._gridWidth&&(n=!1),s.push({iconClass:"e-freezecolumnbefore-icon",headerText:h.freezePrecedingColumnsText,eventHandler:null,menuId:"contextMenu_FreezePreceding",isDefault:!1,disable:!n,parentMenuId:null})),s)},_getsubContextMenuItems:function(){var e=this._contextMenuTexts;return[{iconPath:null,headerText:e.aboveText,eventHandler:null,menuId:"Above",parentMenuId:"Add"},{iconPath:null,headerText:e.belowText,eventHandler:null,menuId:"Below",parentMenuId:"Add"}]},_clearContextMenu:function(){e(".e-tgcontextmenu").remove(),e(".e-tginnerContextmenu").remove(),e(".e-tgheaderContextmenu").remove(),e("#"+this._id+"ccDiv").ejDialog("close")},_renderContextMenu:function(a,r,n,o){var l,d,s,c,u,p,h,g=this,m=g.model,_={},f=g._getCoordinate(a);if(g._contextMenuSelectedIndex=r,g._contextMenuSelectedItem=n,g._contextMenuEvent=a,o||this.editFormValidate()){if(a||(a=window.event),l=f.pageX,d=f.pageY,(u=this.getOffsetRect(g.element[0])).bottom=u.top+this.element[0].offsetHeight,u.right=u.left+e(this.element).width(),_.targetElement=a,_.item=n,_.index=r,_.columnIndex=g.getCellIndex(a),_.requestType="ContextMenuOpen",_.contextMenuItems=g._contextMenuItems,g._trigger("contextMenuOpen",_))return!1;g._activeMenuItemId=null,g._contextMenuItems=_.contextMenuItems,s=t.buildTag("div.e-tgcontextmenu e-js","",{display:"table",position:"absolute","z-index":g.getMaxZIndex()+1},{id:g._id+"_ContextMenu"}),m.cssClass&&s.addClass(m.cssClass),p=_.contextMenuItems.filter(function(e){if(null==e.parentMenuId||e.parentMenuId==i)return!0}),this._isContextMenuItems=!0,c=t.buildTag("ul.e-treegrid-contextmenu",e.render[g._id+"contextMenuTemplate"](p),{margin:"0px","padding-left":"0px","list-style-type":"none"},{"data-icon":!1,"data-role":"list-divider"}),s.append(c),e(document.body).append(s),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&m.isResponsive&&g._off(e(window),"resize",g.windowResize);var w=e(s).outerHeight(),C=e(s).outerWidth(),T=s.find(".e-menuitem");T.eq(0);if(T.outerWidth(C+2),(u.left>l||u.right<l+C)&&(u.right<l+C&&(l-=C),l<0&&(l=u.left+10)),u.bottom<d+w){var x=d-w,v=(u.bottom,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);x>u.top?d=x:d+w>v+window.innerHeight&&((h=d-(d+w-(v+window.innerHeight)))>0&&(d=parseInt(h)))}s.css({left:l+"px",top:d+"px"}),g._focusTreeGridElement(),e(s).css({height:"auto"}),g._on(s,"contextmenu",function(e){e.preventDefault()}),e(T).click(function(){g._contextMenuClickHandler(this)}),e(T).mouseenter(function(){e(this).hasClass("e-disable")||(s.find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),e(this).addClass("e-tgcontextmenu-mouseover"),g._activeMenuItemId=e(this).attr("id"),g._showSubContextMenu(this,_.contextMenuItems))}),g.model.allowSelection&&"multiple"==g.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&g._clearMultiSelectPopup(),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&m.isResponsive&&g._on(e(window),"resize",g.windowResize),a.preventDefault()}},_renderHeaderContextMenu:function(a){var r,n,o,l,d,s,c,u,p,h,g,m=this,_=m.model,f={};if(d=e(a.target).closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),c=m.getColumnByField(d),m._contextMenuColumnDetails=c,_.isEdit||this._isRowEdit){if(!this.editFormValidate())return!0;m._saveEditedElements()}if(u=m._getCoordinate(a),a||(a=window.event),r=u.pageX,n=u.pageY,(p=m.getOffsetRect(m.element[0])).bottom=p.top+m.element[0].offsetHeight,p.right=p.left+e(this.element).width(),f.targetElement=a,f.headerContextMenuItems=m._headerContextMenuItems,f.columnIndex=m.getColumnIndexByField(d),f.requestType="ContextMenuOpen",m._trigger("contextMenuOpen",f))return!1;f.headerContextMenuItems=m._headerContextMenuItems,m._headerContextMenuItems=f.headerContextMenuItems,o=t.buildTag("div.e-tgheaderContextmenu e-js","",{display:"table",position:"absolute","z-index":m.getMaxZIndex()+1},{id:m._id+"_headerContextMenu"}),_.cssClass&&o.addClass(_.cssClass),h=f.headerContextMenuItems.filter(function(e){if(null==e.parentMenuId||e.parentMenuId==i)return!0}),this._isContextMenuItems=!1,l=t.buildTag("ul.e-treegrid-headercontextmenu",e.render[m._id+"contextMenuTemplate"](h),{margin:"0px","padding-left":"0px","list-style-type":"none"},{"data-icon":!1,"data-role":"list-divider"}),o.append(l),e(document.body).append(o),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&_.isResponsive&&m._off(e(window),"resize",m.windowResize);var w,C=e(o).outerHeight(),T=e(".e-tgheaderContextmenu").outerWidth()+.5,x=(w=o.find(".e-menuitem")).eq(0);m._activeMenuItemId=e(x).attr("id"),w.outerWidth(T),(p.left>r||p.right<r+T)&&(p.right<r+T&&(r-=T),r<0&&(r=p.left+10)),p.bottom<n+C&&((g=n-C)>0&&(n=g)),o.css({left:r+"px",top:n+"px"}),m._focusTreeGridElement(),e(o).css({height:"auto"}),m._on(o,"contextmenu",function(e){e.preventDefault()}),s=r+T,m._columnListPosX=s,m._headerContextMenuWidth=T,m._posx=r,m._posy=n,m._columnMenuPopupY=n,e("#contextMenu_SortAscending").on("click",function(){_.allowMultiSorting&&(m._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(_.isFromGantt?m.sortColumn(c.mappingName?c.mappingName:c.field,t.sortOrder.Ascending):m.sortColumn(c.field,t.sortOrder.Ascending),m._multiSortRequest=!1)}),e("#contextMenu_SortDescending").on("click",function(){_.allowMultiSorting&&(m._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(_.isFromGantt?m.sortColumn(c.mappingName?c.mappingName:c.field,t.sortOrder.Descending):m.sortColumn(c.field,t.sortOrder.Descending),m._multiSortRequest=!1)}),e("#contextMenu_Freeze").click(function(){0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(m._checkboxSelection&&_.columns[0].nonColumn&&!_.columns[0].isFrozen&&(_.columns[0].isFrozen=!0),m.freezeColumn(c.field,!0)))}),e("#contextMenu_Unfreeze").click(function(){0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(m._checkboxSelection&&2==m._frozenColumnsLength&&_.columns[0].nonColumn&&_.columns[0].isFrozen&&(_.columns[0].isFrozen=!1),m.freezeColumn(c.field,!1)))}),e("#contextMenu_FreezePreceding").click(function(){0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||m.freezePrecedingColumns(c.field))}),_.isFromGantt||m.model.isResponsive&&e(window).width()<=m._responsiveMinWidth&&e("#"+m._id+"_headerContextMenu").find(".e-expander").removeClass("e-treegridadaptivesubicon"),e("#contextMenu_Columns").mouseenter("click",function(t){m._showColumnChooser(t,p.right,s,T,n,r,e("#contextMenu_Columns"),!0)}),x.addClass("e-columnmenuselection"),e(w).mouseenter(function(){e(this).hasClass("e-disable")||(w.removeClass("e-columnmenuselection"),e(this).addClass("e-columnmenuselection"),m._activeMenuItemId=e(this).attr("id"),m._showSubContextMenu(this,f.headerContextMenuItems))}),e(".e-tgheaderContextmenu .e-menuitem").on("mouseenter click",function(t){var i=e(t.target).closest(".e-menuitem").attr("id");"contextMenu_Columns"==i?e(".e-tginnerContextmenu").remove():e("#"+m._id+"ccDiv").ejDialog("close")}),e(w).click(function(){m._contextMenuClickHandler(this)}),m.model.allowSelection&&"multiple"==m.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&m._clearMultiSelectPopup(),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&_.isResponsive&&m._on(e(window),"resize",m.windowResize)},_showSubContextMenu:function(i,a){var r,n,o,l,d,s,c=this.model,u=this,p=[],h=e(i).attr("id");o=a.filter(function(e){return e.menuId==h&&(p=e),e.parentMenuId==h||void 0}),p.parentMenuId||e(".e-tginnerContextmenu").remove(),p.parentMenuId&&this._removeContextMenu(p,a),o.length>0&&(r=t.buildTag("div.e-tginnerContextmenu e-js","",{display:"table",position:"absolute","z-index":u.getMaxZIndex()+1},{id:this._id+"_SubContextMenu"+h}),c.cssClass&&r.addClass(c.cssClass),n=t.buildTag("ul",e.render[u._id+"contextMenuTemplate"](o),{margin:"0px","padding-left":"0px"},{"data-icon":!1,type:"none","data-role":"list-divider"}),r.append(n),e(document.body).append(r),l=r.find(".e-menuitem"),d=e(r).outerWidth(),l.outerWidth(d>100?d:100),s=u._getSubContextMenuPosition(i,r),e(r).css({top:s.top,left:s.left}),e(l).mouseenter(function(){e(this).hasClass("e-disable")||(u._showSubContextMenu(this,a),e(this).closest(".e-tginnerContextmenu").find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),e(this).addClass("e-tgcontextmenu-mouseover"),u._activeMenuItemId=e(this).attr("id"))}),u._on(r,"contextmenu",function(e){e.preventDefault()}),e(l).click(function(){u._contextMenuClickHandler(this)}),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&c.isResponsive&&u._on(e(window),"resize",u.windowResize))},_removeContextMenu:function(t,i){var a,r,n=e("#"+this._id+"_SubContextMenu"+t.parentMenuId),o=e(n).find(".e-tgcontextmenu-mouseover");e(o).length>0&&((a=i.filter(function(t){if(t.menuId==e(o).attr("id"))return!0})).length>0&&((r=i.filter(function(e){if(e.parentMenuId==a[0].menuId)return!0})).length>0&&this._removeContextMenu(r[0],i)),e("#"+this._id+"_SubContextMenu"+e(o).attr("id")).remove())},_getSubContextMenuPosition:function(i,a){var r,n,o,l,d,s,c,u,p,h=this.model,g={top:"",left:""};if(0==(r=this._isContextMenuItems?e(i).closest(".e-tgcontextmenu"):e(i).closest(".e-tgheaderContextmenu")).length&&(r=e(i).closest(".e-tginnerContextmenu")),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&h.isResponsive&&this._off(e(window),"resize",this.windowResize),n=e(a).outerWidth(),o=e(a).height(),s=this.getOffsetRect(i),l=e(r).outerWidth(),g.top=s.top-1,g.bottom=s.top+e(i).outerHeight(),g.left=s.left+e(r).width()+1,d=g.left,(c=this.getOffsetRect(this.element[0])).bottom=c.top+this.element[0].offsetHeight,c.right=c.left+e(this.element).width(),(c.left>d||c.right<d+n)&&(c.right<d+n&&(d=d-l-n),d>0&&(g.left=d)),c.bottom<g.top+o){var m=g.bottom-o,_=(g.top,c.bottom,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);m>c.top?g.top=m:g.top+o>_+window.innerHeight&&(u=g.top+o-(_+window.innerHeight),(p=g.top-u)>0&&(g.top=parseInt(p)-2))}return g},_contextMenuClickHandler:function(t){var i=e(t).attr("id"),a=this;if(!e(t).hasClass("e-disable")&&0==e(t).find(".e-expander").length)switch(i){case"Delete":a.contextMenuOperations("Delete");break;case"Above":a.contextMenuOperations("Above");break;case"Below":a.contextMenuOperations("Below");break;case"Add":a.contextMenuOperations("Add");break;case"Edit":a.contextMenuOperations("Edit");break;case"Save":a.contextMenuOperations("Save");break;case"Cancel":a.contextMenuOperations("Cancel");break;default:a.contextMenuOperations(i)}},_triggerMenuEventHandler:function(i,a,r){var n,o,l,d=r?this._contextMenuItems:this._headerContextMenuItems;t.isNullOrUndefined(d)||(n=d.filter(function(e){if(e.menuId.toString()===i)return!0})).length>0&&((o=n[0].eventHandler)&&("string"==typeof o&&(o=t.util.getObject(o,window)),e.isFunction(o)&&(l=t.event("customContextMenuHandler",this.model,a),o.call(this,l))))},_createContextMenuTemplate:function(){var t,i,a=this,r={};r["_"+a._id+"getHeaderName"]=e.proxy(a._getHeaderName,a),e.views.helpers(r),t="<li style='list-style-type:none;margin:0px;'>",t+="<div class='e-menuitem {{if disable}}e-disable{{/if}}{{if ~_"+a._id+"getHeaderName(#data)}} e-parent-menuitem{{/if}}' id={{:menuId}}  style='display:table;cursor:{{if disable}}default{{else}}pointer{{/if}};min-width:100px;'>{{if iconPath}}<div class='e-icon e-tgcontextmenu-image' style='background-image:{{:iconPath}};background-repeat:no-repeat;'/> {{else}}<div class='e-icon {{:iconClass}} e-tgcontextmenu-icon'/>{{/if}}<div class='e-tgcontextmenu-label'><span>{{:headerText}}</span></div>{{if ~_"+a._id+"getHeaderName(#data)}}<div class='e-icon e-expander'/> {{/if}}",t+="</div></li>",(i={})[a._id+"contextMenuTemplate"]=t,e.templates(i)},_getHeaderName:function(e){return(this._isContextMenuItems?this._contextMenuItems:this._headerContextMenuItems).filter(function(t){if(null!=e.menuId&&e.menuId==t.parentMenuId||e.isExpanderIcon)return!0}).length>0},_getColumnId:function(e){return e.name.replace(/\s/g,"")},_updateContextmenuOption:function(t){var a,r;if(Array.prototype.clean=function(e){for(var t=0;t<this.length;t++)this[t]==e&&(this.splice(t,1),t--);return this},(a=this)._isRowEdit||a.model.isEdit)a._contextMenuItems.splice(0,3);else{a._contextMenuItems.splice(3,2);var n=a.model.editSettings,o=e.extend(!0,[],a._contextMenuItems),l=a.model.contextMenuSettings.contextMenuItems.clean("").clean(i),d=[];if(e.each(l,function(t,i){-1===e.inArray(i.toLowerCase(),d)&&d.push(i.toLowerCase())}),a._contextMenuItems=[],-1==t)(-1!=d.indexOf("add")||0==d.length)&&(a._contextMenuItems[0]=o[0]),n.allowAdding||(a._contextMenuItems[0].disable=!0),a._contextAddMenuIndex=0;else if(0==d.length)a._contextMenuItems[0]=o[0],n.allowAdding||(a._contextMenuItems[0].disable=!0),a._contextAddMenuIndex=0,a._contextMenuItems[1]=o[2],n.allowDeleting||(a._contextMenuItems[1].disable=!0),a._contextMenuItems.push.apply(a._contextMenuItems,a._subContextMenuItems);else{for(r=0;r<d.length;r++)switch(d[r].toLowerCase()){case"add":a._contextMenuItems[r]=o[0],a._contextAddMenuIndex=r,n.allowAdding||(a._contextMenuItems[r].disable=!0);break;case"delete":a._contextMenuItems[r]=o[2],n.allowDeleting||(a._contextMenuItems[r].disable=!0);break;case"edit":a._contextMenuItems[r]=o[1],n.allowEditing||(a._contextMenuItems[r].disable=!0)}a._contextMenuItems.push.apply(a._contextMenuItems,a._subContextMenuItems)}}},_setInitialData:function(){for(var e,i,a=this,r=a.model,n=[],o={},l=0;l<r.columns.length;l++)switch((e=r.columns[l]).editType){case"booleanedit":o[e.field]=!1;break;case"stringedit":o[e.field]=null;break;case"datepicker":o[e.field]=t.format(new Date,this.model.dateFormat,this.model.locale);break;case"datetimepicker":o[e.field]=t.format(new Date,"MM/dd/yyyy hh:mm tt",this.model.locale);break;case"numericedit":o[e.field]=0;break;default:o[e.field]=null}n.push(o),(null==a.dataSource()||0==a.dataSource().length||0==r.flatRecords.length)&&((i=a._createRecord(n[0],0,null)).index=0,a._addRecord(i,t.TreeGrid.RowPosition.Top),a._clearContextMenu(),this._removeDetailsRow())},_subContextMenuAction:function(e,i,a){var r,n=this,o=n.model;(r=jQuery.extend(!0,{},e.item))[n.model.childMapping]=null,o.idMapping&&o.parentIdMapping&&r[o.parentIdMapping]&&delete r[o.parentIdMapping],"Above"==a?n._addRecord(r,t.TreeGrid.RowPosition.Above,null,"contextMenu"):"Below"==a&&n._addRecord(r,t.TreeGrid.RowPosition.Below,null,"contextMenu"),n._clearContextMenu()},_appendEditTemplateRow:function(i,a,r,n,o){var l,d,s,c,u,p,h,g,m,_=this.model,f=this,w=f.model.rowHeight,C=f.getUpdatedRecords();this._editedRowIndex=r,s=t.buildTag("table.e-table e-zerospace","",{}),this._frozenColumnsLength>0?n?(d=t.buildTag("form.e-treegridform#"+f._id+"EditFrozenForm","",{margin:"-2px 0px"},{}),s.append(f._$gridHeaderContainer.find("#e-frozenheaderdiv"+f._id).find("colgroup").clone())):(d=t.buildTag("form.e-treegridform#"+f._id+"EditForm","",{margin:"-2px 0px"},{}),s.append(f._$gridHeaderContainer.find("#e-movableheaderdiv"+f._id).find("colgroup").clone())):(d=t.buildTag("form.e-treegridform#"+f._id+"EditForm","",{margin:"-2px 0px"},{}),s.append(f.getHeaderTable().find("colgroup").clone())),!n&&_.showDetailsRow&&_.showDetailsRowInfoColumn&&_.detailsTemplate&&(c=a.find("td.e-detailsrowcell")),a.empty(),o?(a.addClass("e-addedrow"),a.next("tr").hasClass("e-detailsrow")&&a.next("tr").remove()):a.addClass("e-rowedit"),u=i.filter(function(e){return!(!1===e.visible)}),l=t.buildTag("td","",{padding:"1px"},{colspan:c?u.length+1:u.length}),p=_.allowSelection?t.buildTag("tr.e-treegridrows e-selectionbackground e-active",{height:w},{}):t.buildTag("tr.e-treegridrows",{height:w},{});var T=t.buildTag("tbody"),x=f._cellEditTemplate,v=i.length;for(h=0;h<v;h++)if(!t.isNullOrUndefined(h)&&i[h].visible){var b={},S=f._getFieldValue(i[h].field,_.columns.indexOf(i[h])),D=x.find("#"+S+"_CellEdit").html(),R=f._getCustomCellValue(C[r],i[h].field);b[S]=R,"dropdownedit"==i[h].editType&&0==b[i[h].field]&&(b[S]=b[S].toString()),g=e(e.templates(D).render(b)),f._isCommandColumn(i[h])?m=t.buildTag("td.e-rowcell e-unboundcell e-unboundeditedcell","",{height:w,"vertical-align":"middle;",overflow:"hidden"},{}):(m=t.buildTag("td.e-rowcell e-editedcell","",{height:w,"vertical-align":"middle;",overflow:"hidden"},{})).addClass("e-validError"),f._isCommandColumn(i[h])||0!=i[h].allowEditing||g.attr("disabled",!0).addClass("e-disable"),"SELECT"==g.get(0).tagName&&(g.val(b[i[h].field]),null==g.val()&&g.val(g.find("option").first().val())),"INPUT"==g.get(0).tagName&&g.val(b[S]),p.append(m.append(g)),T.append(p)}c&&p.append(c),s.append(T),d.append(s),l.append(d),a.append(l)},_editRow:function(i,a,r){var n,o,l,d=this,s=d.model,c=(s.rowHeight,d.getUpdatedRecords()),u=!1;if(d._editedRowIndex=i,(n=t.TreeGrid.getRowByIndex(d,i)).hasClass("e-summaryrow"))d._editAddTools();else{if(t.isNullOrUndefined(a)){if((o={}).data=c[i],o.rowElement=n,o.rowIndex=i,o.columnIndex=r,u=!1,d._trigger("beginEdit",o))return!1}else u=!0;for(this._frozenColumnsLength>0?(d._appendEditTemplateRow(d._frozenColumns,e(n[0]),i,!0,a),d._appendEditTemplateRow(d._unFrozenColumns,e(n[1]),i,!1,a)):d._appendEditTemplateRow(s.columns,e(n),i,!1,a),d._isRowEdit=!0,d._editAddTools(),o={},u?(o.data={},o.requestType="add"):(o.columnIndex=r,o.data=c[i],o.requestType="beginEdit"),d._refreshEditForm(o),d._updateWrapRowHeights("total,header",null,i,"rowEdit"),e.isFunction(e.validator)&&(d._initValidator(),d.setValidation()),s.selectedItem=c[i],l=0;l<s.columns.length;l++)d._isCommandColumn(s.columns[l])&&1==s.columns[l].isFrozen?this._refreshUnboundTemplate(n.find("#"+this._id+"EditFrozenForm")):d._isCommandColumn(s.columns[l])&&this._refreshUnboundTemplate(n.find("#"+this._id+"EditForm"))}},_renderColumnChooser:function(){var i=this,a=t.buildTag("div.e-columnSelector","","",{id:this._id+"ccDiv"});e("#"+i._id+"ccDiv_wrapper").remove(),i._renderColumnChooserList(!1),a.append(i._columnChooserList),a.insertAfter(i.element),a.data("columnMenuDialog","TreeGrid"),a.ejDialog({showOnInit:!1,allowKeyboardNavigation:!1,enableResize:!1,enableRTL:!1,showHeader:!1,width:"auto",allowDraggable:!1,position:{X:1,Y:1},enableAnimation:!1,minWidth:"0px",minHeight:"0px"}),e("#"+i._id+"ccDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content").addClass("e-treegrid-columnchooser")},_renderFilterMenu:function(e){var t,i,a=this,r=0,n=0,o=0,l=0,d=0,s=0,c=this.model.columns;if(!e)for(i=0;i<c.length;i++)("numericedit"==c[i].filterEditType||"numericedit"==c[i].editType)&&r++,("stringedit"==c[i].filterEditType||"stringedit"==c[i].editType)&&n++,("datepicker"==c[i].filterEditType||"datepicker"==c[i].editType)&&o++,("datetimepicker"==c[i].filterEditType||"datetimepicker"==c[i].editType)&&d++,("booleanedit"==c[i].filterEditType||"booleanedit"==c[i].editType)&&s++,("dropdownedit"==c[i].filterEditType||"dropdownedit"==c[i].editType)&&(l++,t=c[i]);(n>0||"stringedit"==e)&&(a._renderEdittypeFilterMenu("String"),a._renderedFilterMenuDialog.push("stringedit")),(r>0||"numericedit"==e)&&(a._renderEdittypeFilterMenu("Numeric"),a._renderedFilterMenuDialog.push("numericedit")),(o>0||"datepicker"==e)&&(a._renderEdittypeFilterMenu("Datepicker"),a._renderedFilterMenuDialog.push("datepicker")),(d>0||"datetimepicker"==e)&&(a._renderEdittypeFilterMenu("Datetimepicker"),a._renderedFilterMenuDialog.push("datetimepicker")),(l>0||"dropdownedit"==e)&&(a._renderEdittypeFilterMenu("Dropdown",t),a._renderedFilterMenuDialog.push("dropdownedit")),(s>0||"booleanedit"==e)&&(a._renderEdittypeFilterMenu("Boolean"),a._renderedFilterMenuDialog.push("booleanedit"))},_renderEdittypeFilterMenu:function(i,a){var r,n=this,o=t.buildTag("div.e-"+n._id+"filter"+i+"Selector e-filterMenuDiv e-treegridmenufilterwraper","",{},{id:this._id+"filter"+i+"MenuDiv"}),l=n._filterMenuTexts;r="Dropdown"==i?"<div class='e-filter-container'><div class='e-dropdown-filter-container'><input id='"+this._id+"filter"+i+"DropDown'/></div><div class='e-filter-button-container'><div class='e-filter-btn-filter'><button id='"+this._id+"filter"+i+"MenuButton' class='e-filterMenuDiv'>"+l.filterButton+"</button></div><div class='e-filter-btn-clear'><button id='"+this._id+"filter"+i+"ClearButton' class='e-filterMenuDiv'>"+l.clearButton+"</button></div></div></div>":"Boolean"==i?"<div class='e-filter-container'><div class='e-checkbox-filter-container'><span class='e-checkbox-filter-text'>"+l.filterValue+"</span><div class='e-checkbox-filter-control' style='padding-bottom:14px;padding-left: 48%;'><input id='"+this._id+"filter"+i+"InputBox'/></div><div class='e-filter-button-container'><div class='e-filter-btn-filter'><button id='"+this._id+"filter"+i+"MenuButton' class='e-filterMenuDiv'>"+l.filterButton+"</button></div><div class='e-filter-btn-clear'><button id='"+this._id+"filter"+i+"ClearButton' class='e-filterMenuDiv'>"+l.clearButton+"</button></div></div></div>":"<div class='e-filter-container'><div class='e-filter-operator'><input id='"+this._id+"filter"+i+"DropDown'/></div><span class='e-filter-text'>"+l.filterValue+"</span><div class='e-filter-value'><input id='"+this._id+"filter"+i+"InputBox'/></div><div class='e-filter-button-container'><div class='e-filter-btn-filter'><button id='"+this._id+"filter"+i+"MenuButton' class='e-filterMenuDiv'>"+l.filterButton+"</button></div><div class='e-filter-btn-clear'><button id='"+this._id+"filter"+i+"ClearButton' class='e-filterMenuDiv'>"+l.clearButton+"</button></div></div></div>",o.append(r),o.insertAfter(n.element),n._renderFilterMenuDialog(i+"MenuDiv",i,a,l),o.data("filter"+i+"MenuDialog","TreeGrid"),o.ejDialog({showOnInit:!1,allowKeyboardNavigation:!1,enableResize:!1,enableRTL:!1,showHeader:!1,width:"auto",allowDraggable:!1,position:{X:1,Y:1},enableAnimation:!1,cssClass:n.model.cssClass}),e("#"+n._id+"filter"+i+"MenuDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css({height:"auto",width:"auto"}).removeClass("e-widget-content"),e("#"+n._id+"filter"+i+"MenuDiv_wrapper").css("outline","none").addClass("e-treegrid-columnchooser")},_renderFilterMenuDialog:function(t,i,a,r){var n,o,l,d=this;"String"==i&&(n=r.stringMenuOptions,o="endswith",l={value:"value",text:"text"}),("Numeric"==i||"Datepicker"==i||"Datetimepicker"==i)&&(n=r.numberMenuOptions,o="GreaterThan",l={value:"value",text:"text"}),"Dropdown"==i&&(n=a.dropdownData,l=a.editParams?{value:a.editParams.fields.value,text:a.editParams.fields.text}:{value:"value",text:"text"}),"String"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejAutocomplete({width:"100%",watermarkText:r.enterValueText,filterType:o,enableResize:!1,enableDistinct:!0,locale:d.model.locale,cssClass:d.model.cssClass}),"Numeric"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejNumericTextbox({decimalPlaces:2,width:"100%",locale:d.model.locale}),"Boolean"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejCheckBox({size:"small"}),"Datetimepicker"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejDateTimePicker({width:"100%",locale:d.model.locale,cssClass:d.model.cssClass}),"Datepicker"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejDatePicker({width:"100%",locale:d.model.locale,cssClass:d.model.cssClass}),"Boolean"!=i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"DropDown").ejDropDownList({dataSource:n,selectedIndex:1,fields:l,select:function(t){"String"==i&&e("#"+d._id+"filter"+i+"InputBox").data("ejAutocomplete").option("filterType",t.value)},cssClass:d.model.cssClass,width:"100%"}),e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"MenuButton").ejButton({size:"normal",width:"100%",cssClass:d.model.cssClass,click:function(t){var i,a,r=e.trim(d._columnMenuTarget.prev("div.e-headercelldiv").attr("data-ej-mappingname")),n=d.getColumnByField(r);t.e.target.id==d._id+"filterStringMenuButton"&&(i=e("#"+d._id+"filterStringInputBox").data("ejAutocomplete"),a=e("#"+d._id+"filterStringMenuDiv").find("#"+d._id+"filterStringDropDown").data("ejDropDownList"),d._performMenuFilter(n,i.value(),a.model.value)),t.e.target.id==d._id+"filterNumericMenuButton"&&(i=e("#"+d._id+"filterNumericInputBox").data("ejNumericTextbox"),a=e("#"+d._id+"filterNumericMenuDiv").find("#"+d._id+"filterNumericDropDown").data("ejDropDownList"),d._performMenuFilter(n,i.model.value,a.model.value)),t.e.target.id==d._id+"filterDropdownMenuButton"&&(a=e("#"+d._id+"filterDropdownMenuDiv").find("#"+d._id+"filterDropdownDropDown").data("ejDropDownList"),d._performMenuFilter(n,a.model.value,"equal")),t.e.target.id==d._id+"filterDatepickerMenuButton"&&(i=e("#"+d._id+"filterDatepickerInputBox").data("ejDatePicker"),a=e("#"+d._id+"filterDatepickerMenuDiv").find("#"+d._id+"filterDatepickerDropDown").data("ejDropDownList"),d._performMenuFilter(n,i.model.value,a.model.value)),t.e.target.id==d._id+"filterDatetimepickerMenuButton"&&(i=e("#"+d._id+"filterDatetimepickerInputBox").data("ejDateTimePicker"),a=e("#"+d._id+"filterDatetimepickerMenuDiv").find("#"+d._id+"filterDatetimepickerDropDown").data("ejDropDownList"),d._performMenuFilter(n,i.model.value,a.model.value)),t.e.target.id==d._id+"filterBooleanMenuButton"&&("uncheck"==(i=e("#"+d._id+"filterBooleanInputBox").data("ejCheckBox")).model.checkState?d._performMenuFilter(n,!1,"equal"):"check"==i.model.checkState&&d._performMenuFilter(n,!0,"equal"))}}),e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"ClearButton").ejButton({size:"normal",width:"100%",cssClass:d.model.cssClass,click:function(t){var i,a=e.trim(d._columnMenuTarget.prev("div.e-headercelldiv").attr("data-ej-mappingname")),r=d.getColumnByField(a);d._isExcelFilter&&delete d._excelFilter._predicates[0][r.field],t.e.target.id==d._id+"filterStringClearButton"&&(i=e("#"+d._id+"filterStringMenuDiv").find("#"+d._id+"filterStringDropDown").data("ejDropDownList"),d._performMenuFilter(r,"",i.model.value)),t.e.target.id==d._id+"filterNumericClearButton"&&(i=e("#"+d._id+"filterNumericMenuDiv").find("#"+d._id+"filterNumericDropDown").data("ejDropDownList"),d._performMenuFilter(r,"",i.model.value)),t.e.target.id==d._id+"filterDropdownClearButton"&&(i=e("#"+d._id+"filterDropdownMenuDiv").find("#"+d._id+"filterDropdownDropDown").data("ejDropDownList"),d._performMenuFilter(r,"","equal")),t.e.target.id==d._id+"filterDatepickerClearButton"&&(i=e("#"+d._id+"filterDatepickerMenuDiv").find("#"+d._id+"filterDatepickerDropDown").data("ejDropDownList"),d._performMenuFilter(r,"",i.model.value)),t.e.target.id==d._id+"filterDatetimepickerClearButton"&&(i=e("#"+d._id+"filterDatetimepickerMenuDiv").find("#"+d._id+"filterDatetimepickerDropDown").data("ejDropDownList"),d._performMenuFilter(r,"",i.model.value)),t.e.target.id==d._id+"filterBooleanClearButton"&&d._performMenuFilter(r,"","equal")}})},_renderExcelFilter:function(){var i=this,a=i.model,r=a.filterSettings,n=0!=r.filteredColumns.length?r.filteredColumns[0].field:null,o={instance:this,showSortOptions:!!a.allowSorting&&!a.showColumnChooser,allowCaseSensitive:r.enableCaseSensitivity,maxFilterLimit:r.maxFilterChoices,interDeterminateState:!0,enableComplexBlankFilter:r.enableComplexBlankFilter,blankValue:r.blankValue,allowAccent:!0,filteredColumns:r.filteredColumns,filterHandler:e.proxy(i._filterHandler,i),cancelHandler:e.proxy(i._cancelHandler,i),initFilterCol:n,actionBegin:"actionBegin",actionComplete:"actionComplete"};i._excelFilter=new t.excelFilter(o),i._isExcelFilter=!0},_cancelHandler:function(){var t=this;e("#"+t._id).find(".e-filtericon").data("isClicked",!1),t._mediaStatus=!1,t.model.showColumnChooser&&!t._isCloseFilterMenu&&t._clearColumnMenu("cancelHandler"),t._isCloseFilterMenu=!1},_filterHandler:function(i){var a,r,n,o,l,d,s,c,u=this,p=u.model,h={};switch(h.requestType="sorting"==i.action?i.action:"filtering",r=p.filterSettings.filteredColumns,i.action){case"sorting":0!=u.getColumnByField(i.sortDetails.field).allowSorting&&(p.allowMultiSorting&&(u._multiSortRequest=!0),u.sortColumn(i.sortDetails.field,i.sortDetails.direction),u._multiSortRequest=!1);break;case"filtering":for(u.clearAllSelection(),a=t.DataManager(p.filterSettings.filteredColumns),n=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),o=a.executeLocal(n),l=0;l<o.length;l++)-1!=(d=e.inArray(o[l],p.filterSettings.filteredColumns))&&p.filterSettings.filteredColumns.splice(d,1);t.merge(p.filterSettings.filteredColumns,i.filterCollection),i.currentFilterCollection=i.filterCollection,h.currentFilteringColumn=i.fieldName,h.predicated=i.ejpredicate,u.processBindings(h)&&(p.filterSettings.filteredColumns=r),u._filterIconTarget&&(u._filterIconTarget.target.className="e-column-filtered-icon e-icon e-filtericon"),u._filteredColumnValueID.push(i.fieldName);break;case"clearfiltering":u.clearAllSelection(),s=i.filterDetails,delete u._excelFilter._predicates[0][i.fieldName],u.filterColumn(s.field,s.operator,s.value,s.predicate),u._storePreviousFilteredValue(s.field,s.value,s.operator),u._filterIconTarget&&(u._filterIconTarget.target.className="e-column-filter-icon e-icon e-filtericon"),-1!=u._filteredColumnValueID.indexOf(i.fieldName)&&(c=u._filteredColumnValueID.indexOf(i.fieldName),u._filteredColumnValueID.splice(c,1))}e("#"+u._id).find(".e-filtericon").data("isClicked",!1),u._mediaStatus=!1,p.showColumnChooser&&u._clearColumnMenu()},_renderColumnChooserList:function(i,a){for(var r,n,o=this,l=o.model.columns.length,d=o.model.columns,s=t.buildTag("div","",{"margin-left":"0px",width:"auto"}),c=0;c<l;c++)if(o.model.treeColumnIndex!=c&&1==d[c].showInColumnChooser){if((r=d[c]).nonColumn)continue;if(!t.isNullOrUndefined(r)){var u=t.buildTag("div","","",{class:"e-columnMenuListDiv"}),p=t.isNullOrUndefined(r.headerText)?r.field:r.headerText,h=t.buildTag("input","",{},{id:o._id+"_columnMenu_"+r.field.split(".").join(""),value:p,type:"checkbox"}),g=t.buildTag("label",p,{width:"auto"},{for:o._id+"_columnMenu_"+r.field.split(".").join("")});u.append(h),u.append(g),u.data("column",r.headerText),s.append(u),r.headerText==a&&u.addClass("e-columnmenuselection"),h.ejCheckBox({checked:!!t.isNullOrUndefined(r.visible)||r.visible,cssClass:o.model.cssClass,change:function(e){var i;i="msie"==t.browserInfo().name&&t.browserInfo().version<9?this.element.closest(".e-columnMenuListDiv").data().column:e.model.value,e.isChecked?o.showColumn(i):o.hideColumn(i),o._updateWrapRowHeights(null,"virtualRefresh")}})}}i?(o._columnChooserList.empty().append(s.children()),o._focusTreeGridElement()):o._columnChooserList=s,n=o._columnChooserList.find("div.e-columnMenuListDiv"),e(n).mouseenter(function(){n.removeClass("e-columnmenuselection"),e(this).addClass("e-columnmenuselection")})},_createColumnMenuTemplate:function(){var t="<li style='list-style-type:none;'><div class='e-columnmenuitem{{if enabled==false}} e-disable{{/if}}{{if (menuId =='Columns' || menuId =='Filter')}} e-parent-menuitem{{/if}}' style='display:table;cursor:pointer' id='"+this._id+"_{{:menuId}}Chooser'><div class='e-icon {{:icon}} e-treegridicon' style='display:inline-block;'></div><div class='e-menuitem-label' style='display:inline-block;width:auto'><span>{{:name}}</span></div>{{if (menuId =='Columns' || menuId =='Filter')}}<div class='e-icon e-expander e-treegridicon' style='display:inline-block;float:right;'/> {{/if}}</div>{{if menuId == 'RenameColumn' || menuId == 'SortDescending'}}<hr class='e-menuitem-hr'>{{/if}}</li>",i={};i[this._id+"columnMenuTemplate"]=t,e.templates(i)},_updateFilterMenuList:function(t){var i,a,r,n,o,l,d,s,c,u=this,p=u.model,h=e(t.target),g=h[0].offsetWidth,m=h[0].offsetHeight,_=e.trim(h.prev("div.e-headercelldiv").attr("data-ej-mappingname")),f=u.getColumnByField(_);a=i=0,u._clearFilterMenu(),u._clearColumnMenu("columnmenu"),u._columnMenuTarget=h,u._filterIconTarget=t,u._saveEditedElements(),(n=u.getOffsetRect(h[0])).top=n.top+m,u.model.isFromGantt,i=n.top+m,o=p.isFromGantt?e(this.element).closest(".e-gantt"):e(this.element),(r=this.getOffsetRect(o[0])).bottom=r.top+o[0].offsetHeight,r.right=r.left+e(o).width(),f.filterEditType?(s=f.filterEditType.indexOf("edit"),c=f.filterEditType):(s=f.editType.indexOf("edit"),c=f.editType),-1!=s?(d=(l=c.slice(0,s)).charAt(0).toUpperCase()+l.slice(1),u._showFilterMenu("filtermenu","filter"+d,n,g,r.right,a,null,null,f,i)):(d=c.charAt(0).toUpperCase()+c.slice(1),u._showFilterMenu("filtermenu","filter"+d,n,g,r.right,a,null,null,f,i)),u._updatePreviousFilteredValue(f)},_showColumnChooser:function(t,i,a,r,n,o,l,d){var s,c,u=this,p=u.model,h=e(window).width();if("mouseenter"==t.type&&h>u._responsiveMinWidth||d||!u.model.isResponsive||"click"==t.type&&h<=u._responsiveMinWidth&&u.model.isResponsive||p.isFromGantt){if(h>u._responsiveMinWidth||d||!u.model.isResponsive||p.isFromGantt){(s={}).width="auto",s.height="auto",s.minWidth="0px",s.minHeight="0px",s.showHeader=!1,s.position={X:o,Y:n},s.enableModal=!1,s.isResponsive=!1,s.enableResize=!1,s.cssClass=u.model.cssClass,e("#"+u._id+"ccDiv_wrapper").addClass("e-treegridadaptivedialog"),e("#"+u._id+"ccDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e("#"+u._id+"ccDiv").ejDialog(s),e("#"+u._id+"ccDiv").css({height:"auto"}),u._updateColumnMenuVisibility();var g=e("#"+u._id+"ccDiv").ejDialog("instance"),m=e("#"+u._id+"ccDiv_wrapper"),_=m.find("div.e-columnMenuListDiv");g.open(),i<a+m.width()&&(a=a-m.width()-r),c={X:a,Y:n+l.position().top},g.option({position:c}),m.css("z-index",u.getMaxZIndex()+1),_.removeClass("e-columnmenuselection"),_.eq(0).addClass("e-columnmenuselection"),u._focusTreeGridElement(),u._renderedSubMenuType="ColumnDesktop"}else u._adaptiveColumnChooser();p.allowFiltering&&("menu"==p.filterSettings.filterType||"excel"==p.filterSettings.filterType)&&(u._isCloseFilterMenu=!0,u._clearFilterMenu())}},_renderColumnMenu:function(a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x=this,v=x.model,b=e(a.target),S=[],D=0,R=b[0].offsetWidth,y=b[0].offsetHeight,I=x._columnMenuTexts,k=e.trim(b.prev("div.e-headercelldiv").attr("data-ej-mappingname")),M=x.getColumnByField(k),E=M.allowSorting==i||M.allowSorting;if(x._batchEditStarts&&!x._confirmDialog.is(":visible"))return x._batchSaveLostWarning("ColumnMenu"),x._batchTempDetails.menuTarget=a,!0;if(r=l=0,x._clearColumnMenu("columnmenu"),x._columnMenuTarget=b,v.isEdit||this._isRowEdit){if(!this.editFormValidate())return!0;x._saveEditedElements()}v.showColumnChooser&&v.showColumnOptions&&(s=x._enableDisableInsertLabel(),S.push({name:I.insertColumnLeft,icon:"e-column-insertleft-icon",menuId:"ColumnLeft",enabled:s}),S.push({name:I.insertColumnRight,icon:"e-column-insertright-icon",menuId:"ColumnRight",enabled:s}),S.push({name:I.deleteColumn,icon:"e-column-delete-icon",menuId:"DeleteColumn",enabled:x._enableDisableDEL(M)}),S.push({name:I.renameColumn,icon:"e-column-rename-icon",menuId:"RenameColumn"})),v.allowFiltering&&(t.isNullOrUndefined(M.allowFiltering)||M.allowFiltering)&&("menu"==v.filterSettings.filterType||"excel"==v.filterSettings.filterType)&&(-1!=x._filteredColumnValueID.indexOf(M.field)?(S.push({name:I.menuFilter,icon:"e-column-filtered-icon",menuId:"Filter"}),d=S.length):(S.push({name:I.menuFilter,icon:"e-column-filter-icon",menuId:"Filter"}),d=S.length)),v.allowSorting&&E&&(S.push({name:I.sortAscendingText,icon:"e-columnmenu-ascending",menuId:"SortAscending"}),S.push({name:I.sortDescendingText,icon:"e-columnmenu-descending",menuId:"SortDescending"})),v.showColumnChooser&&(D=S.length,S.push({name:I.columnsText,icon:"e-columnchooser-icon",menuId:"Columns"})),v.isFromGantt||(M.allowFreezing||x._allowFreezingDefault&&t.isNullOrUndefined(M.allowFreezing))&&(u=!1,x._frozenColumnsLength!=v.columns.length-1||M.isFrozen||(c=!0),p=this._getFrozenColumnWidth(),h=v.columns.indexOf(M),(p=p+this.columnsWidthCollection[h]+18)>this._gridWidth&&(c=!0),S.push({name:I.freezeText,icon:"e-freezecolumn-icon",menuId:"FreezeColumns",enabled:!c&&!M.isFrozen}),S.push({name:I.unfreezeText,icon:"e-unfreezecolumn-icon",menuId:"UnfreezeColumns",enabled:1==M.isFrozen}),x._checkboxSelection&&v.columns[0].nonColumn?1!=v.columns.indexOf(M)&&v.columns.indexOf(M)>this._frozenColumnsLength&&(u=!0):0!=v.columns.indexOf(M)&&v.columns.indexOf(M)>this._frozenColumnsLength&&(u=!0),p=this._getFrozenColumnWidth(h),(p+=18)>this._gridWidth&&(u=!1),S.push({name:I.freezePrecedingColumnsText,icon:"e-freezecolumnbefore-icon",menuId:"FreezePrecedingColumns",enabled:u})),g=x.getOffsetRect(b[0]),m=x.getOffsetRect(x.element[0]),x.model.isFromGantt,l=g.top+y,x._columnChooserListIndex=D;var H=t.buildTag("div.e-columnmenu e-js","",{display:"table",position:"absolute",top:l,"z-index":1e4},{id:x._id+"_ColumnMenu"}),P=t.buildTag("ul.e-treegrid-columnmenu","",{},{}),F=e.render[x._id+"columnMenuTemplate"](S);v.cssClass&&H.addClass(v.cssClass),P.append(F),H.append(P),e(document.body).append(H),H.height(),_=H.outerWidth()+1,(r=g.left+R-_)<=m.left&&(r=m.left),n=r+_,o=r+_,x._columnListPosX=n,x._columnFilterPosX=o,x._columnMenuPopupY=l,H.css({left:r}),H.find(".e-columnmenuitem").outerWidth(_),f=v.isFromGantt?e(this.element).closest(".e-gantt"):e(this.element),(w=this.getOffsetRect(f[0])).bottom=w.top+f[0].offsetHeight,w.right=w.left+e(f).width(),v.isFromGantt||(x.model.isResponsive&&e(window).width()<=x._responsiveMinWidth?e("#"+x._id+"_ColumnMenu").find(".e-expander").addClass("e-treegridadaptivesubicon"):e("#"+x._id+"_ColumnMenu").find(".e-expander").removeClass("e-treegridadaptivesubicon")),e("#"+x._id+"_ColumnsChooser").on("mouseenter click",function(t){x._showColumnChooser(t,w.right,n,_,l,r,e("#"+x._id+"_ColumnsChooser"))}),e("#"+x._id+"_FilterChooser").on("mouseenter click",function(t){var i,a,n,s;("mouseenter"==t.type&&e(window).width()>x._responsiveMinWidth||!x.model.isResponsive||"click"==t.type&&e(window).width()<=x._responsiveMinWidth&&x.model.isResponsive)&&(x._updateColumnMenuVisibility(),x._checkFilterType(M),"menu"==v.filterSettings.filterType&&"excel"!=M.filterType||"excel"==v.filterSettings.filterType&&"menu"==M.filterType?(M.filterEditType?(i=M.filterEditType.indexOf("edit"),s=M.filterEditType):(M.editType="edittemplate"==M.editType?"stringedit":M.editType,i=M.editType.indexOf("edit"),s=M.editType),-1!=i?(n=(a=s.slice(0,i)).charAt(0).toUpperCase()+a.slice(1),x._showFilterMenu("columnchooser","filter"+n,o,_,w.right,r,D,d,M,l)):(n=s.charAt(0).toUpperCase()+s.slice(1),x._showFilterMenu("columnchooser","filter"+n,o,_,w.right,r,D,d,M,l)),x._updatePreviousFilteredValue(M),e("#"+x._id+"ccDiv").ejDialog("close")):x._openExcelFilter(M,o,l,w,_))}),e("#"+x._id+"_SortAscendingChooser,#"+x._id+"_SortDescendingChooser,#"+x._id+"_FreezeColumnsChooser,#"+x._id+"_UnfreezeColumnsChooser,#"+x._id+"_FreezePrecedingColumnsChooser,#"+x._id+"_ColumnLeftChooser,#"+x._id+"_ColumnRightChooser,#"+x._id+"_DeleteColumnChooser,#"+x._id+"_RenameColumnChooser").mouseenter(function(){e("#"+x._id+"ccDiv").ejDialog("close"),v.allowFiltering&&("menu"==v.filterSettings.filterType||"excel"==v.filterSettings.filterType)&&(x._isCloseFilterMenu=!0,x._clearFilterMenu())}),e("#"+x._id+"_SortAscendingChooser").click(function(){v.allowMultiSorting&&(x._multiSortRequest=!0),v.isFromGantt?x.sortColumn(M.mappingName?M.mappingName:M.field,t.sortOrder.Ascending):x.sortColumn(M.field,t.sortOrder.Ascending),x._multiSortRequest=!1}),e("#"+x._id+"_SortDescendingChooser").click(function(){v.allowMultiSorting&&(x._multiSortRequest=!0),v.isFromGantt?x.sortColumn(M.mappingName?M.mappingName:M.field,t.sortOrder.Descending):x.sortColumn(M.field,t.sortOrder.Descending),x._multiSortRequest=!1}),e("#"+x._id+"_FreezeColumnsChooser").click(function(){e(this).hasClass("e-disable")||(x._checkboxSelection&&v.columns[0].nonColumn&&!v.columns[0].isFrozen&&(v.columns[0].isFrozen=!0),x.freezeColumn(M.field,!0))}),e("#"+x._id+"_UnfreezeColumnsChooser").click(function(){e(this).hasClass("e-disable")||(x._checkboxSelection&&2==x._frozenColumnsLength&&v.columns[0].nonColumn&&v.columns[0].isFrozen&&(v.columns[0].isFrozen=!1),x.freezeColumn(M.field,!1))}),e("#"+x._id+"_FreezePrecedingColumnsChooser").click(function(){e(this).hasClass("e-disable")||x.freezePrecedingColumns(M.field)}),e("#"+x._id+"_ColumnLeftChooser").click(function(){if(e(this).hasClass("e-disable"))return!1;x.insertColumnChooser(M,"left")}),e("#"+x._id+"_ColumnRightChooser").click(function(){if(e(this).hasClass("e-disable"))return!1;x.insertColumnChooser(M,"right")}),e("#"+x._id+"_DeleteColumnChooser").click(function(){if(e(this).hasClass("e-disable"))return!1;x._targetColumnIndex=v.columns.indexOf(M),x._updateConfirmDialog.ejDialog("open"),x._clearColumnMenu()}),e("#"+x._id+"_RenameColumnChooser").click(function(){x._targetColumnIndex=v.columns.indexOf(M),x._renderColumnRenameDialog(M),x._columnRenameDialog.ejDialog("open"),x._clearColumnMenu()}),C=e("#"+x._id+"_ColumnMenu"),(T=C.find("div.e-columnmenuitem")).eq(0).addClass("e-columnmenuselection"),e(T).mouseenter(function(){e(this).hasClass("e-disable")||(T.removeClass("e-columnmenuselection"),e(this).addClass("e-columnmenuselection"))})},_openExcelFilter:function(t,i,a,r,n){var o,l,d,s=this,c=s.model,u=e(document).width(),p=t.filterEditType?t.filterEditType:t.editType,h=i;switch(p=p.toLowerCase(),r.right<h+266||u<h+266?h-n-266>0&&(h=h-n-268):h+=2,o={X:h,Y:a+e("#"+s._id+"_FilterChooser").position().top},p){case"numericedit":p="number";break;case"stringedit":case"maskedit":case"dropdownedit":p="string";break;case"booleanedit":p="boolean";break;case"datepicker":case"datetimepicker":p=p.replace("picker","")}u<=s._responsiveMinWidth&&c.isResponsive&&c.enableResize?(s._renderResponsiveExcelFilter(t,p),s._mediaStatus=!0,s._clearColumnMenu()):(-1==e.inArray(p,s._excelColTypes)&&(e("#"+s._id+p+"_excelDlg").remove(),e("#"+s._id+p+"_CustomFDlg_wrapper").remove(),e("#"+s._id+p+"_CustomFDlg").remove(),s._excelFilter._openedFltr=null,s._excelColTypes.push(p),s._excelFilter.renderDialog(p)),l={True:s.localizedLabels.trueText,False:s.localizedLabels.falseText},d=[],e.grep(s.model.flatRecords,function(e){e.isSummaryRow||d.push(e.item)}),s._isCloseFilterMenu=!0,s._excelFilter.openXFDialog({field:t.field,enableResponsiveRow:!0,displayName:t.headerText,dataSource:d,query:"",position:{X:o.X,Y:o.Y},dimension:{height:e(window).height(),width:e(window).width()},cssClass:"resFilter",type:p,format:t.format,localizedStrings:l}),s._isCloseFilterMenu=!1,e("#"+s._id+p+"_CheckBoxList").css("display","inline-block"),s._customFilter=null),e("#"+s._id+"ccDiv").ejDialog("close")},_adaptiveColumnChooser:function(){var t,i=this,a={},r=i.getOffsetRect(e("#"+i._id)[0]),n=i._columnMenuTexts;a.cssClass=i.model.cssClass,a.enableModal=!1,a.enableResize=!1,a.enableResize=!1,a.contentSelector="#"+i._id,a.rtl=i.model.rtl,a.allowDraggable=!1,a.showHeader=!0,a.minHeight="50px",a.minWidth="50px",a.width=e("#"+i._id).width()+"px",a.height=e("#"+i._id).height()+"px",a.position={X:r.left+"px",Y:r.top+"px"},a.isResponsive=!1,a.allowKeyboardNavigation=!1,a.title=n.columnsText,e("#"+i._id+"ccDiv_wrapper").removeClass("e-treegridadaptivedialog"),e("#"+i._id+"ccDiv_wrapper").addClass("e-dialog").addClass("e-shadow").find("div.e-dialog-scroller").css("height","100%"),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").addClass("e-treegridadaptivedialog"),e("#"+i._id+"ccDiv").ejDialog(a),e("#"+i._id+"ccDiv").ejDialog("open"),e("#"+i._id+"ccDiv").css({width:"100%",height:"100%"}),i.model.isResponsive&&(t=e("#"+i._id).height()-50+"px",e("#"+i._id+"ccDiv_wrapper").css({width:e("#"+i._id).width(),height:e("#"+i._id).height()}),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+i._id+"ccDiv").css({width:"100%",height:"auto"}),e("#"+i._id+"ccDiv").height()>e("#"+i._id+"ccDiv_wrapper").height()-48?(e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:e("#"+i._id).height()-48+"px",width:"auto",padding:"0px"}),e("#"+i._id+"ccDiv").removeClass("e-columnSelector"),e("#"+i._id+"ccDiv").ejDialog("refresh")):(e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:t,width:"auto"}),e("#"+i._id+"ccDiv").css({padding:"8px 16px"})),e("#"+i._id+"ccDiv_wrapper").removeClass("e-shadow"),e("#"+i._id+"ccDiv").removeClass("e-shadow")),i._renderedSubMenuType="AdaptiveColChooser",e("#"+i._id+"_ColumnMenu").remove()},_updatePreviousFilteredValue:function(i){var a,r,n,o,l,d,s,c,u=this,p=[];"stringedit"==(d=i.filterEditType?i.filterEditType:i.editType)&&(c=e("#"+u._id+"filterStringInputBox").data("ejAutocomplete"),a=e("#"+u._id+"filterStringMenuDiv").find("#"+u._id+"filterStringDropDown").data("ejDropDownList"),r=t.Query().select(i.field),n=new t.DataManager(u.model.flatRecords.slice()).executeLocal(r),c.option("dataSource",n),-1!=u._filteredColumnValueID.indexOf(i.field)?(o=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[o].value?a.option("value","startswith"):a.option("value",u._filteredColumnValue[o].dropdown),c.option("value",u._filteredColumnValue[o].value),e("#"+u._id+"filterStringInputBox").val(u._filteredColumnValue[o].value)):(a.option("value","startswith"),c.option("value",null))),"numericedit"==d&&(c=e("#"+u._id+"filterNumericInputBox").data("ejNumericTextbox"),a=e("#"+u._id+"filterNumericMenuDiv").find("#"+u._id+"filterNumericDropDown").data("ejDropDownList"),-1!=u._filteredColumnValueID.indexOf(i.field)?(o=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[o].value?a.option("value","lessthan"):a.option("value",u._filteredColumnValue[o].dropdown),c.option("value",u._filteredColumnValue[o].value),e("#"+u._id+"filterNumericInputBox").val(u._filteredColumnValue[o].value)):(c.option("value",null),a.option("value","lessthan"))),"datepicker"==d&&(c=e("#"+u._id+"filterDatepickerInputBox").data("ejDatePicker"),a=e("#"+u._id+"filterDatepickerMenuDiv").find("#"+u._id+"filterDatepickerDropDown").data("ejDropDownList"),-1!=u._filteredColumnValueID.indexOf(i.field)?(o=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[o].value?a.option("value","lessthan"):a.option("value",u._filteredColumnValue[o].dropdown),c.option("value",u._filteredColumnValue[o].value)):(c.option("value",null),a.option("value","lessthan")),i.format&&c.option("dateFormat",u._getDateFormat(i.format))),"datetimepicker"==d&&(c=e("#"+u._id+"filterDatetimepickerInputBox").data("ejDateTimePicker"),a=e("#"+u._id+"filterDatetimepickerMenuDiv").find("#"+u._id+"filterDatetimepickerDropDown").data("ejDropDownList"),-1!=u._filteredColumnValueID.indexOf(i.field)?(o=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[o].value?a.option("value","lessthan"):a.option("value",u._filteredColumnValue[o].dropdown),c.option("value",u._filteredColumnValue[o].value)):(c.option("value",null),a.option("value","lessthan")),i.format&&c.option("dateFormat",u._getDateFormat(i.format))),"dropdownedit"==d&&(e.extend(p,i.dropdownData),i.editParams?(l={value:i.editParams.fields.value,text:i.editParams.fields.text},(s={})[i.editParams.fields.text]=u._dropDownListBlanksText,s[i.editParams.fields.value]="(Blanks)"):(l={value:"value",text:"text"},s={text:u._dropDownListBlanksText,value:"(Blanks)"}),a=e("#"+u._id+"filterDropdownDropDown").data("ejDropDownList"),t.isNullOrUndefined(p)||0==p.length?(p=u._dropDownArrayCollection(i,i.field),(i.allowFilteringBlankContent||t.isNullOrUndefined(i.allowFilteringBlankContent))&&p.unshift(s),a.option("dataSource",p)):((i.allowFilteringBlankContent||t.isNullOrUndefined(i.allowFilteringBlankContent))&&p.unshift(s),a.option("dataSource",p)),a.option("fields",l),-1!=u._filteredColumnValueID.indexOf(i.field)?(o=u._filteredColumnValueID.indexOf(i.field),a.option("value",u._filteredColumnValue[o].value)):a.option("value",null)),"booleanedit"==d&&(c=e("#"+u._id+"filterBooleanInputBox").data("ejCheckBox"),-1!=u._filteredColumnValueID.indexOf(i.field)?(o=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[o].value?c.option("checkState","uncheck"):c.option("value",u._filteredColumnValue[o].value)):c.option("selectedIndex",""))},_performMenuFilter:function(e,i,a){var r,n=this;n.clearAllSelection(),r=e.filterEditType?e.filterEditType:e.editType,t.isNullOrUndefined(i)&&(i=""),n._filterString=i,-1==n._filteredColumnValueID.indexOf(e.field)&&""==i.toString()?(n.clearColumnMenu(),n._clearFilterMenu()):(("numericedit"==r||"datepicker"==r||"datetimepicker"==r)&&("datepicker"!=r&&"datetimepicker"!=r||"equal"!=a&&"notequal"!=a)?n.filterColumn(e.field,a,i,"and",!0):n.filterColumn(e.field,a,i,"and"),n.clearColumnMenu(),n._clearFilterMenu(),n._cancelSaveTools())},_storePreviousFilteredValue:function(e,t,i){var a,r=this;-1!=r._filteredColumnValueID.indexOf(e)||""==t.toString()&&"false"!=t.toString()?""!=t.toString()||"false"==t.toString()?(a=r._filteredColumnValueID.indexOf(e),r._filteredColumnValue[a].value=t,r._filteredColumnValue[a].dropdown=i):-1!=r._filteredColumnValueID.indexOf(e)&&(a=r._filteredColumnValueID.indexOf(e),r._filteredColumnValue.splice(a,1),r._filteredColumnValueID.splice(a,1)):(r._filteredColumnValue.push({column:e,value:t,dropdown:i}),r._filteredColumnValueID.push(e))},_showFilterMenu:function(t,i,a,r,n,o,l,d,s,c){var u,p,h,g,m,_,f;if(this.editFormValidate())if(e(window).width()<=this._responsiveMinWidth&&this.model.isResponsive&&!this.model.isFromGantt){var w,C={},T=(w=this).getOffsetRect(e("#"+w._id)[0]);C.cssClass=this.model.cssClass,C.enableModal=!1,C.isResponsive=!1,C.enableRTL=this.model.enableRTL,C.enableResize=!1,C.allowDraggable=!1,C.minWidth="50px",C.minHeight="50px",C.width=e("#"+w._id).width()+"px",C.height=e("#"+w._id).height()+"px",C.position={X:T.left+"px",Y:T.top+"px"},C.contentSelector="#"+w._id,C.rtl=w.model.rtl,C.allowKeyboardNavigation=!1,C.showHeader=!0,C.title=s.headerText,e("#"+w._id+i+"MenuDiv").removeClass("e-treegridadaptivedialog"),e("#"+w._id+i+"MenuDiv").ejDialog(C),e("#"+w._id+i+"MenuDiv_wrapper").addClass("e-dialog").addClass("e-shadow").find("div.e-dialog-scroller").addClass("e-treegridadaptivewidth"),e("#"+w._id+i+"MenuDiv").css({width:"100%",height:"auto"}),u=e("#"+w._id).height()-50+"px",e("#"+w._id+i+"MenuDiv").ejDialog("open"),e("#"+w._id+i+"MenuDiv_wrapper").find("div.e-dialog-scroller").css({height:u}),e("#"+w._id+i+"MenuDiv_wrapper").removeClass("e-shadow"),e("#"+w._id+i+"MenuDiv").removeClass("e-shadow"),e("#"+w._id+i+"MenuDiv").height()>e("#"+w._id+i+"MenuDiv_wrapper").height()-48&&e("#"+w._id+i+"MenuDiv").ejDialog("refresh"),w._renderedSubMenuType="#"+w._id+i+"MenuDiv",e("#"+w._id+"_ColumnMenu").remove()}else w=this,(C={}).width="auto",C.height="auto",C.minWidth="0px",C.minHeight="0px",C.showHeader=!1,C.position={X:1,Y:1},C.enableModal=!1,C.isResponsive=!1,C.enableResize=!1,C.cssClass=this.model.cssClass,e("#"+w._id+i+"MenuDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e("#"+w._id+i+"MenuDiv").ejDialog(C),p=e("#"+w._id+i+"MenuDiv").ejDialog("instance"),h=e("#"+w._id+i+"MenuDiv_wrapper"),"columnchooser"==t?(m=e(document).width(),(n<a+h.width()||m<a+h.width())&&a-r-h.width()>0&&(a=a-r-h.width()),g={X:a,Y:c+e("#"+w._id+"_FilterChooser").position().top},p.option({position:g}),p.open()):(t="filtermenu")&&(f=r,o=(_=a).left+f-h.width(),_.left=o+h.width()+4,n<_.left+h.width()&&(_.left=_.left-h.width()-f),g={X:_.left,Y:_.top},p.option({position:g}),p.open()),w._renderedSubMenuType="#"+w._id+i+"MenuDivDesktop"},_clearResponsiveColumnMenu:function(){var t=this;e("div[id$='ccDiv']").each(function(){"TreeGrid"==e(this).data("columnMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+t._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({padding:"0px"}),e("#"+t._id+"ccDiv").addClass("e-columnSelector"),e("div[id$='filterStringMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterStringMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterNumericMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterNumericMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterBooleanMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterBooleanMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterDatepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterDatetimepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatetimepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterDropdownMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDropdownMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='ColumnRenameDialog']").each(function(){e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='dialogColumnAdd']").each(function(){e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+t._id).find(".e-filtericon").data("isClicked",!1)},_clearColumnMenu:function(t){var i=this,a=i.model;"columnmenu"===t&&e(window).width()<i._responsiveMinWidth&&i._clearResponsiveColumnMenu(),a.isResponsive&&e(window).width()<i._responsiveMinWidth?(e("#"+i._id+"_ColumnMenu").remove(),i._renderedSubMenuType&&-1==i._renderedSubMenuType.indexOf("AdaptiveColChooser")&&(e("div[id$='"+i._id+"ccDiv']").each(function(){"TreeGrid"==e(this).data("columnMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({padding:"0px"}),e("#"+i._id+"ccDiv").addClass("e-columnSelector"))):(e("#"+i._id+"_ColumnMenu").remove(),"resize"!=t&&(e("div[id$='"+i._id+"ccDiv']").each(function(){"TreeGrid"==e(this).data("columnMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({padding:"0px"}),e("#"+i._id+"ccDiv").addClass("e-columnSelector"),"resize"!=t&&"cancelHandler"!=t&&a.allowFiltering&&("menu"==a.filterSettings.filterType||"excel"==a.filterSettings.filterType)&&i._clearFilterMenu())),e("#"+i._id).find(".e-columnicon").data("isClicked",!1),e("#"+i._id).find(".e-filtericon").data("isClicked",!1)},_clearFilterMenu:function(){var t,i,a=this;a.model.allowFiltering&&(e("div[id$='"+a._id+"filterStringMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterStringMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+a._id+"filterNumericMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterNumericMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+a._id+"filterBooleanMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterBooleanMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+a._id+"filterDatepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+a._id+"filterDatetimepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatetimepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+a._id+"filterDropdownMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDropdownMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+a._id+"filterStringDropDown_popup_list_wrapper").hide(),e("#"+a._id+"filterStringInputBox_suggestion").hide(),e("#"+a._id+"filterNumericDropDown_popup_list_wrapper").hide(),e("#"+a._id+"filterNumericInputBox_suggestion").hide(),e("#"+a._id+"filterDatepickerDropDown_popup_list_wrapper").hide(),e("#"+a._id+"filterDatepickerInputBox_suggestion").hide(),e("#"+a._id+"filterDatetimepickerDropDown_popup_list_wrapper").hide(),e("#"+a._id+"filterDatetimepickerInputBox_suggestion").hide(),e("#"+a._id+"filterDropdownDropDown_popup_list_wrapper").hide(),e("#"+a._id).find(".e-filtericon").data("isClicked",!1),(t=e("#"+a._id+"filterDatetimepickerInputBox").data("ejDateTimePicker"))&&t.hide(),(i=e("#"+a._id+"filterDatepickerInputBox").data("ejDatePicker"))&&i.hide(),a._isExcelFilter&&(a._excelFilter.closeXFDialog(),a._mediaStatus=!1))},_getDateFormat:function(e){return new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(e)[2]},_enableDisableDEL:function(e){var t=this.model,i=e.field,a=t.columns.indexOf(e);return t.isFromGantt?!("taskId"==i||"serialNumber"==i||"taskName"==i||"startDate"==i||"endDate"==i||"duration"==i&&!t.endDateMapping||a==t.treeColumnIndex):a!=t.treeColumnIndex},_enableDisableInsertLabel:function(){var e;return!(!this.model.isFromGantt&&this._frozenColumnsLength>0)||(e=this._getFrozenColumnWidth(),!((e+=250)>this._gridWidth))},insertColumnChooser:function(i,a){var r,n=this,o=n.model;0===e("#"+n._id+"_dialogColumnAdd").length&&(r=t.buildTag("div.e-dialog e-dialog-content e-widget-content","",{display:"none"},{id:n._id+"_dialogColumnAdd"}),n.element.append(r),n._on(e("#"+n._id+"_dialogColumnAdd"),"click keypress","#ColumnAddDialog_"+n._id+"_Ok ,#ColumnAddDialog_"+n._id+"_Cancel",n._buttonClick)),n.renderColumnAddDialog(),n._targetColumnIndex=o.columns.indexOf(i),n._insertPosition=a},renameColumn:function(e,t){var i=this,a=i.model,r=a.columns,n={requestType:"renameColumn"};n.columnObject=r[e],n.previousName=r[e].headerText,n.currentName=t,i._trigger("actionComplete",n)||(r[e].headerText=t,i._refreshFrozenColumns()),i._updateWrapRowHeights(),(a.allowTextWrap||"wrap"==a.headerTextOverflow)&&i._updateGridContentHeight()},_renderColumnRenameDialog:function(i){var a,r=this,n=r._columnMenuTexts,o=t.buildTag("div.e-treegridrenamedialog","",{},{"data-unselectable":"on"}),l=e("#"+r._id).width(),d=e("#"+r._id).height(),s=t.buildTag("form","",{height:"100%",width:"100%","font-size":"14px"},{id:r._id+"ColumnRenameForm",onsubmit:"return false"}),c=t.buildTag("span.e-buttons","<input class='e-treegrid-rename-dialog-btn-ok' type='button' id="+r._id+"RenameDialogOK value="+r._okButtonText+" /> <input class='e-treegrid-rename-dialog-btn-cancel' type='button' id="+r._id+"RenameDialogCancel value='"+r._cancelButtonText+"' />"),u=t.buildTag("div","",{},{class:"e-treegrid-rename-dialog-btn"}),p=t.buildTag("table","",{outline:"none",width:"100%","margin-top":"0px"},{"data-unselectable":"on"}),h=t.buildTag("tr"),g=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"});g.append("<label style='font-weight:normal;'>"+r._columnDialogTitle.renameColumn+"</label>"),h.append(g),p.append(h);var m=t.buildTag("tr"),_=t.buildTag("td.e-editValue"),f=t.buildTag("input.e-field e-ejinputtext","",{},{value:i.headerText,id:r._id+"RenameHeaderText",name:i.field,"data-dialog":"RenameHeaderText"});f.css({margin:"0px",padding:"1px 4px 1px 0px"}),_.html(f),m.append(_),p.append(m),s.append(p),o.append(s),r._columnRenameDialog=t.buildTag("div","","",{title:n.renameColumn,id:r._id+"ColumnRenameDialog"}),u.append(c),r._columnRenameDialog.append(o).append(u),r.element.append(r._columnRenameDialog),c.find("input").ejButton({cssClass:r.model.cssClass,showRoundedCorner:!0,size:"normal",click:e.proxy(r._triggerRenameColumn,r)}),e(window).width()<=r._responsiveMinWidth&&r.model.isResponsive&&!r.model.isFromGantt?r.model.isResponsive&&(a=r.getOffsetRect(e("#"+r._id)[0]),e("#"+r._id+"ColumnRenameDialog").removeClass("e-treegridadaptivedialog"),r._columnRenameDialog.ejDialog({width:l+"px",height:d+"px",position:{X:a.left+"px",Y:a.top+"px"},minHeight:"50px",minWidth:"50px",showOnInit:!1,allowDraggable:!1,enableResize:!1,enableModal:!1,isResponsive:!1,cssClass:this.model.cssClass}),e("#"+r._id+"ColumnRenameDialog_wrapper").removeClass("e-shadow").addClass("e-treegrid-dialog"),e("#"+r._id+"ColumnRenameDialog").removeClass("e-shadow")):(r._columnRenameDialog.ejDialog({width:"auto",height:"auto",minHeight:0,minWidth:240,showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0,cssClass:this.model.cssClass}),e("#"+r._id+"ColumnRenameDialog_wrapper").addClass("e-treegrid-dialog")),f.focus().select()},_triggerRenameColumn:function(e){var a,r=this;e!==i&&e.model.text==r._okButtonText&&(a=r._columnRenameDialog.find("#"+r._id+"RenameHeaderText").val(),r.renameColumn(r._targetColumnIndex,a),this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&(t.isNullOrUndefined(r.model.editSettings.dialogEditorTemplateID)||""==r.model.editSettings.dialogEditorTemplateID)?r._treeGridAddEditDialog():this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&!t.isNullOrUndefined(r.model.editSettings.dialogEditorTemplateID)&&""!=r.model.editSettings.dialogEditorTemplateID&&r._treeGridAddEditDialogTemplate()),r._columnRenameDialog.ejDialog("close")},renderColumnAddDialog:function(){var t,i,a,r,n,o=this,l=o.model.columnDialogFields,d={},s=o.getOffsetRect(e("#"+o._id)[0]);if(d.requestType="openColumnAddDialog",l.length)for(d.data={},t=0;t<l.length;t++)i=l[t],d.data[i]="";else d.data={field:"",headerText:"",editType:""};o._trigger("actionBegin",d)||(d.requestType="columnAdd",a=document.createElement("div"),e(a).addClass("e-addedColumn"),a.innerHTML=e.render[o._id+"_ColumnAddTemplate"](d.data),e("#"+o._id+"_dialogColumnAdd").html(e(a)),(r={}).cssClass=this.model.cssClass,r.enableResize=!1,r.width="auto",r.height="auto",r.contentSelector="#"+o._id,r.rtl=o.model.rtl,r.allowKeyboardNavigation=!1,n=o._columnDialogTitle.insertColumn,r.title=n,(e(window).width()>o._responsiveMinWidth||!o.model.isResponsive||o.model.isFromGantt)&&(r.enableModal=!0,r.allowDraggable=!0,r.isResponsive=!0,e("#"+o._id+"_dialogColumnAdd").ejDialog(r),e("#"+o._id+"_dialogColumnAdd").addClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").addClass("e-treegridadaptivedialog e-treegrid-dialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").addClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd").ejDialog("open"),e("#"+o._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css("width","438px")),e(window).width()<=o._responsiveMinWidth&&o.model.isResponsive&&!o.model.isFromGantt&&(r.isResponsive=!1,r.enableResize=!1,r.enableModal=!1,r.allowDraggable=!1,r.width=e("#"+o._id).width()+"px",r.height=e("#"+o._id).height()+"px",r.minHeight="150px",r.minWidth="150px",e("#"+o._id+"_dialogColumnAdd").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css({width:e("#"+o._id).width()-80+"px",height:"150px"}),e("#"+o._id+"_dialogColumnAdd").ejDialog(r),e("#"+o._id+"_dialogColumnAdd").ejDialog("open"),e("#"+o._id+"_dialogColumnAdd_wrapper").removeClass("e-treegridadaptivedialog").addClass("e-treegrid-dialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+o._id+"_dialogColumnAdd_wrapper").css({left:s.left+"px",top:s.top+"px"}),e("#"+o._id+"_dialogColumnAdd_wrapper").removeClass("e-shadow"),e("#"+o._id+"_dialogColumnAdd").removeClass("e-shadow"),e("#"+o._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").css({height:e("#"+o._id).height()-50+"px"})),o._clearColumnMenu(),o._refreshColumnAddForm(),e("#"+o._id+"_dialogColumnAdd").ejDialog("refresh"))},setAddColumnFields:function(){var t,i,a=this,r=a.model;if(r.columnDialogFields.length){for(a._addColumnFields=r.columnDialogFields,t=["field","headerText","editType"],i=0;i<t.length;i++)if(-1==e.inArray(t[i],a._addColumnFields))switch(t[i]){case"field":a._addColumnFields.splice(0,0,t[i]);break;case"headerText":a._addColumnFields.splice(1,0,t[i]);break;case"editType":a._addColumnFields.splice(2,0,t[i])}for(r.isFromGantt?(r.allowSorting||-1==a._addColumnFields.indexOf("allowSorting")||a._addColumnFields.splice(a._addColumnFields.indexOf("allowSorting"),1),"row"==r.selectionSettings.selectionMode&&-1!=a._addColumnFields.indexOf("allowCellSelection")&&a._addColumnFields.splice(a._addColumnFields.indexOf("allowCellSelection"),1)):(r.allowSorting||-1==a._addColumnFields.indexOf("allowSorting")||a._addColumnFields.splice(a._addColumnFields.indexOf("allowSorting"),1),r.allowFiltering||-1==a._addColumnFields.indexOf("allowFiltering")||a._addColumnFields.splice(a._addColumnFields.indexOf("allowFiltering"),1),"row"==r.selectionSettings.selectionMode&&-1!=a._addColumnFields.indexOf("allowCellSelection")&&a._addColumnFields.splice(a._addColumnFields.indexOf("allowCellSelection"),1)),-1!=a._addColumnFields.indexOf("displayAsCheckbox")&&a._addColumnFields.push(a._addColumnFields.splice(a._addColumnFields.indexOf("displayAsCheckbox"),1)[0]),a._addColumnFieldsTxt=[],i=0;i<a._addColumnFields.length;i++)switch(a._addColumnFields[i]){case"field":a._addColumnFieldsTxt.push(a._columnDialogTexts.field);break;case"headerText":a._addColumnFieldsTxt.push(a._columnDialogTexts.headerText);break;case"editType":a._addColumnFieldsTxt.push(a._columnDialogTexts.editType);break;case"filterEditType":a._addColumnFieldsTxt.push(a._columnDialogTexts.filterEditType);break;case"allowFiltering":a._addColumnFieldsTxt.push(a._columnDialogTexts.allowFiltering);break;case"allowFilteringBlankContent":a._addColumnFieldsTxt.push(a._columnDialogTexts.allowFilteringBlankContent);break;case"allowSorting":a._addColumnFieldsTxt.push(a._columnDialogTexts.allowSorting);break;case"visible":a._addColumnFieldsTxt.push(a._columnDialogTexts.visible);break;case"width":a._addColumnFieldsTxt.push(a._columnDialogTexts.width);break;case"textAlign":a._addColumnFieldsTxt.push(a._columnDialogTexts.textAlign);break;case"headerTextAlign":a._addColumnFieldsTxt.push(a._columnDialogTexts.headerTextAlign);break;case"isFrozen":a._addColumnFieldsTxt.push(a._columnDialogTexts.isFrozen);break;case"allowFreezing":a._addColumnFieldsTxt.push(a._columnDialogTexts.allowFreezing);break;case"allowCellSelection":a._addColumnFieldsTxt.push(a._columnDialogTexts.allowCellSelection);break;case"showInColumnChooser":a._addColumnFieldsTxt.push(a._columnDialogTexts.showInColumnChooser);break;case"clipMode":a._addColumnFieldsTxt.push(a._columnDialogTexts.clipMode);break;case"tooltip":a._addColumnFieldsTxt.push(a._columnDialogTexts.tooltip);break;case"headerTooltip":a._addColumnFieldsTxt.push(a._columnDialogTexts.headerTooltip);break;case"displayAsCheckbox":a._addColumnFieldsTxt.push(a._columnDialogTexts.displayAsCheckbox);break;case"priority":a._addColumnFieldsTxt.push(a._columnDialogTexts.priority)}}else a._addColumnFields=["field","headerText","editType"],a._addColumnFieldsTxt=[a._columnDialogTexts.field,a._columnDialogTexts.headerText,a._columnDialogTexts.editType]},setColumnCelEditType:function(e){var i,a=this;a.model.columns;return"field"==e||"filterEditType"==e||"editType"==e||"textAlign"==e||"headerTextAlign"==e||"clipMode"==e?i=t.buildTag("input.e-field e-dropdownlist","",{},{value:"{{:#data['"+e+"']}}",id:a._id+e+"ColumnAdd",name:e,"data-dialog":"ColumnAdd"}):"headerText"==e||"tooltip"==e||"headerTooltip"==e?(i=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+e+"']}}",id:a._id+e+"ColumnAdd",name:e,"data-dialog":"ColumnAdd"})).css({margin:"0px",padding:"1px 4px 1px 0px"}):"allowFiltering"==e||"allowSorting"==e||"isFrozen"==e||"allowFreezing"==e?i=' <input type ="checkbox" id="'+a._id+e+'ColumnAdd" data-dialog ="ColumnAdd" name="'+e+'" data-edittype="booleanedit">':"allowFilteringBlankContent"==e||"visible"==e?i=' <input type ="checkbox" id="'+a._id+e+'ColumnAdd" data-dialog = "ColumnAdd" checked = "checked" name="'+e+'" data-edittype="booleanedit">':"allowCellSelection"==e?i=' <input type ="checkbox" id="'+a._id+e+'ColumnAdd" data-dialog = "ColumnAdd" checked = "checked" name="'+e+'" data-edittype="booleanedit">':"showInColumnChooser"==e||"displayAsCheckbox"==e?i=' <input type ="checkbox" id="'+a._id+e+'ColumnAdd" data-dialog = "ColumnAdd" checked = "checked" name="'+e+'" data-edittype="booleanedit">':("width"==e||"priority"==e)&&((i=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+e+"']}}",id:a._id+e+"ColumnAdd",name:e,"data-dialog":"ColumnAdd"})).attr("data-edittype","numericedit"),i.css({margin:"0px",padding:"1px 4px 1px 0px"})),i},columnAddDialogTemplate:function(){var i,a,r,n,o,l,d,s=this,c=s.model;if(0!=c.columns.length){s.setAddColumnFields();var u,p,h,g,m,_,f=t.buildTag("div","",{},{"data-unselectable":"on"}),w=t.buildTag("form","",{height:"100%",width:"100%","font-size":"14px"},{id:s._id+"ColumnAddForm"}),C=t.buildTag("table","",{width:"100%","margin-top":"0px"},{"data-unselectable":"on"}),T=t.buildTag("tr","",{width:"100%"});for(a=0;a<s._addColumnFields.length;a++)T.children("td").length<2?(u=t.buildTag("td.e-add-property-container","",{},{"data-unselectable":"on"}),p=t.buildTag("table","",{width:"100%",outline:"none","margin-top":"0px"},{"data-unselectable":"on"}),h=t.buildTag("tr"),(g=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"})).append("<label style='font-weight:normal;'>"+s._addColumnFieldsTxt[a]+"</label>"),h.append(g),p.append(h),m=t.buildTag("tr"),_=t.buildTag("td.e-editValue"),i=s.setColumnCelEditType(s._addColumnFields[a]),_.html(i),m.append(_),p.append(m),"displayAsCheckbox"==s._addColumnFields[a]&&p.addClass("e-display-checkbox-conatiner").css("display","none"),u.append(p),T.append(u)):(C.append(T),T=t.buildTag("tr"),a--);C.append(T),r=t.buildTag("tr"),c.showColumnChooser&&(u=t.buildTag("td.e-add-property-container","",{},{colspan:2,"data-unselectable":"on"}),p=t.buildTag("table#"+s._id+"dropdownDataTable","",{width:"100%",outline:"none"},{"data-unselectable":"on"}),n=t.buildTag("tr"),(o=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"})).append("<label for='dropdownData' style='font-weight:normal;'>"+s._columnDialogTexts.columnsDropdownData+"</label>"),n.append(o),p.append(n),h=t.buildTag("tr"),(g=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"})).append("<span class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer; width: auto;'>"+s._columnDialogTexts.addData+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer; width: auto;'>&nbsp;&nbsp;"+s._columnDialogTexts.deleteData+"</span>"),h.append(g),p.append(h),m=t.buildTag("tr"),_=t.buildTag("td.e-editValue"),e("#"+s._id).width()<=s._responsiveMinWidth?(l=e("#"+s._id).width()-80+"px",o=t.buildTag("div.e-dropdowntreegrid","",{width:l,overflow:"hidden"})):o=t.buildTag("div.e-dropdowntreegrid","",{width:"438px",overflow:"hidden"}),d=t.buildTag("div#treegrid"+s._id+"dropdownData","",{width:"100%",height:"150px"},{}),o.append(d),_.append(o),m.append(_),p.append(m),u.append(p),r.append(u),C.append(r)),w.append(C),f=s.renderColumnAddDialogButton(w,f),e.templates(s._id+"_ColumnAddTemplate",f.html())}},renderColumnAddDialogButton:function(e,i){var a,r="ColumnAddDialog_",n=this,o=n.model,l=t.buildTag("div.e-add-dialog-btn-ok","",{},{}),d=t.buildTag("div","",{},{}),s=t.buildTag("input","",{"border-radius":"3px"},{type:"button",id:r+n._id+"_Ok"}),c=n._okButtonText;s.ejButton({cssClass:o.cssClass,text:c,width:"100%"});var u=t.buildTag("div.e-add-dialog-btn-cancel","",{},{}),p=t.buildTag("div","",{},{}),h=n._cancelButtonText,g=t.buildTag("input","",{"border-radius":"3px"},{type:"button",id:r+n._id+"_Cancel"});return g.ejButton({cssClass:o.cssClass,text:h,width:"100%"}),a=t.buildTag("div","",{},{class:"e-treegrid-add-btn"}),d.append(s),l.append(d),a.append(l),p.append(g),u.append(p),a.append(u),e.appendTo(i),a.appendTo(i),i},_buttonClick:function(a){var r,n,o,l,d,s;if(0!=a.keyCode&&a.keyCode!==i&&13!=a.keyCode)return!0;var c,u,p,h=this,g=h.model,m=g.treeColumnIndex,_=!1,f={},w=h._addColumnFields,C=g.columns,T={};if(a.target.id=="ColumnAddDialog_"+h._id+"_Ok"){for(r=document.getElementById(h._id+"ColumnAddForm"),o=0;o<w.length;o++)if(l=w[o],c=e(r).find("#"+h._id+l+"ColumnAdd"),"editType"==l||"filterEditType"==l||"textAlign"==l||"headerTextAlign"==l||"clipMode"==l){if(n=c.data("ejDropDownList"),f[l]=n._selectedValue,"editType"==l&&"dropdownedit"==f[l]){var x=e(r).find("#treegrid"+h._id+"dropdownData").data("ejTreeGrid").model.dataSource;x.length>0&&(f.dropdownData=x)}}else"showInColumnChooser"==l||"allowCellSelection"==l||"allowSorting"==l||"allowFiltering"==l||"allowFilteringBlankContent"==l||"visible"==l||"isFrozen"==l||"allowFreezing"==l||"displayAsCheckbox"==l?(d=c.data("ejCheckBox"),f[l]=d._isChecked):""!=c.val()||"headerText"!=l&&"field"!=l?f[l]="priority"==l?c.ejNumericTextbox("getValue"):c.val():"field"==l?f[l]="Column"+(g.columns.length+1):"headerText"==l&&(f[l]="Column "+(g.columns.length+1));"left"==h._insertPosition?u=h._targetColumnIndex:"right"==h._insertPosition&&(u=h._targetColumnIndex+1),u<=m&&(g.treeColumnIndex=m+1),g.isFromGantt||u<=h._frozenColumnsLength-1&&(_=!0),s={},s=g.isFromGantt?{field:f.field,headerText:f.headerText,editType:f.editType,allowSorting:t.isNullOrUndefined(f.allowSorting)?null:f.allowSorting,visible:0!=f.visible,width:f.width?f.width:150,textAlign:f.textAlign?f.textAlign:"left",headerTextAlign:f.headerTextAlign?f.headerTextAlign:"left",dropdownData:f.dropdownData?f.dropdownData:null,allowCellSelection:t.isNullOrUndefined(f.allowCellSelection)?null:f.allowCellSelection,mappingName:f.field,displayAsCheckbox:0!=f.displayAsCheckbox,clipMode:f.clipMode?f.clipMode:"clip",tooltip:f.tooltip,headerTooltip:f.headerTooltip}:{field:f.field,headerText:f.headerText,editType:f.editType,filterEditType:f.filterEditType?f.filterEditType:"stringedit",allowFiltering:t.isNullOrUndefined(f.allowFiltering)?null:f.allowFiltering,allowFilteringBlankContent:t.isNullOrUndefined(f.allowFilteringBlankContent)?null:f.allowFilteringBlankContent,allowSorting:t.isNullOrUndefined(f.allowSorting)?null:f.allowSorting,visible:0!=f.visible,width:f.width?f.width:150,textAlign:f.textAlign?f.textAlign:"left",headerTextAlign:f.headerTextAlign?f.headerTextAlign:"left",clipMode:f.clipMode?f.clipMode:"clip",tooltip:f.tooltip,headerTooltip:f.headerTooltip,isFrozen:1==f.isFrozen||1==_,allowFreezing:t.isNullOrUndefined(f.allowFreezing)?null:f.allowFreezing,dropdownData:f.dropdownData?f.dropdownData:null,allowCellSelection:t.isNullOrUndefined(f.allowCellSelection)?null:f.allowCellSelection,showInColumnChooser:0!=f.showInColumnChooser,displayAsCheckbox:0!=f.displayAsCheckbox,priority:f.priority?f.priority:""},T.requestType="insertColumn",T.columnObject=s,T.insertIndex=u,h._trigger("actionComplete",T)||(C.splice(T.insertIndex,0,T.columnObject),h._refreshFrozenColumns(),h._updateWrapRowHeights(null,"virtualRefresh"),g.isFromGantt&&h._updateAddEditDialogTemplate()),e("#"+h._id+"_dialogColumnAdd").ejDialog("close"),g.allowFiltering&&"menu"==g.filterSettings.filterType&&(p=T.columnObject.filterEditType?T.columnObject.filterEditType:T.columnObject.editType,-1==h._renderedFilterMenuDialog.indexOf(p)&&h._renderFilterMenu(p)),this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&(t.isNullOrUndefined(g.editSettings.dialogEditorTemplateID)||""==g.editSettings.dialogEditorTemplateID)?h._treeGridAddEditDialog():this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&!t.isNullOrUndefined(g.editSettings.dialogEditorTemplateID)&&""!=g.editSettings.dialogEditorTemplateID&&h._treeGridAddEditDialogTemplate()}else a.target.id=="ColumnAddDialog_"+h._id+"_Cancel"&&e("#"+h._id+"_dialogColumnAdd").ejDialog("close");if("dialogEditing"==this.model.editSettings.editMode||"batchediting"==g.editSettings.editMode.toLowerCase()&&"dialog"==g.editSettings.batchEditSettings.editMode)if(a.target.id=="EditFormDialog_"+this._id+"_Save"){if(!h.editFormValidate())return!0;this.element.find(".e-dialogaddrow .e-treegridform").length>0?(h.model.allowSelection&&"multiple"==h.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&h._clearMultiSelectPopup(),h._treegridDialogAddRow()&&(h._isTreeAddEditDialogSave=!0,e("#"+this._id+"_dialogEdit").ejDialog("close"))):this.element.find(".e-dialogeditedrow .e-treegridform").length>0&&(h.endEdit()||(h._isTreeAddEditDialogSave=!0,e("#"+this._id+"_dialogEdit").ejDialog("close")))}else a.target.id=="EditFormDialog_"+this._id+"_Cancel"&&e("#"+this._id+"_dialogEdit").ejDialog("close");return!1},_treegridDialogAddRow:function(){for(var e,i,a,r=this,n=r.model.columns,o={},l=0;l<n.length;l++)if(i=(e=n[l]).field,!t.isNullOrUndefined(e)&&""!=i&&!r._isCommandColumn(e)){if(r._checkboxSelection&&e.nonColumn)continue;a=r.getCurrentEditCellDataForRowEdit(i,e.editType,l),a=t.isNullOrUndefined(a)||e.editType==t.TreeGrid.EditingType.Numeric&&isNaN(a)?null:a,-1!=i.indexOf(".")?t.createObject(i,a,o):o[i]=a}return!!r._addRecord(o,r.model.editSettings.rowPosition,null,"dialog")},_refreshColumnAddForm:function(){for(var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_=this,f=e("#"+_._id+"ColumnAddForm"),w=f.find("input,select"),C=0,T=!1,x=w.length,v=_.model,b={},S=[],D=(_.model.rowHeight,_._editTypeText),R=_._textAlignTypeText,y=_._clipModeText;C<x;C++){if(a="100%",n=(i=w.eq(C)).prop("name"),i.hasClass("e-dropdownlist"))if("field"==n){for(u=[],d=[],v.columns.length&&(S=e.map(v.columns,function(e){return v.isFromGantt&&e.mappingName?e.mappingName:e.field})),_._dataSourcefields.length||(_._dataSourcefields=e.extend(!0,[],S),_.getAllDataSourceFields()),s=0;s<_._dataSourcefields.length;s++)-1==e.inArray(_._dataSourcefields[s],S)&&_._dataSourcefields[s]!=v.notesMapping&&(v.isFromGantt&&"serialNumber"!=_._dataSourcefields[s]||!v.isFromGantt)&&d.push(_._dataSourcefields[s]);for(c=0;c<d.length;c++)u.push({text:d[c]});i.ejDropDownList({width:a,cssClass:v.cssClass,dataSource:u,fields:{text:"text",value:"text"}})}else"editType"==n||"filterEditType"==n?(u=[{text:D.string,value:"stringedit"},{text:D.numeric,value:"numericedit"},{text:D.datePicker,value:"datepicker"},{text:D.dateTimePicker,value:"datetimepicker"},{text:D.dropdown,value:"dropdownedit"},{text:D.boolean,value:"booleanedit"}],i.ejDropDownList({width:a,dataSource:u,cssClass:v.cssClass,fields:{text:"text",value:"value"},selectedIndex:0,change:function(t){var i,a=!1;1==e(l).is(":hidden")&&"dropdownedit"==t.value?(e(l).attr("hidden",!1),a=!0):0==e(l).is(":hidden")&&"dropdownedit"!=t.value&&(e(l).attr("hidden",!0),a=!0),i=e("#"+_._id+"_dialogColumnAdd").find(".e-display-checkbox-conatiner"),"booleanedit"==t.value&&i.length>0&&"none"==i.css("display")?(i.css("display","block"),a=!0):"booleanedit"!=t.value&&i.length>0&&"block"==i.css("display")&&(i.css("display","none"),a=!0),a&&e("#"+_._id+"_dialogColumnAdd").ejDialog("refresh")}})):"textAlign"==n||"headerTextAlign"==n?(p=[{text:R.left,value:"left"},{text:R.right,value:"right"},{text:R.center,value:"center"}],i.ejDropDownList({width:a,dataSource:p,cssClass:v.cssClass,fields:{text:"text",value:"value"},selectedIndex:0})):"clipMode"==n&&(h=[{text:y.clip,value:"clip"},{text:y.ellipsis,value:"ellipsis"}],i.ejDropDownList({width:a,dataSource:h,cssClass:v.cssClass,fields:{text:"text",value:"value"},selectedIndex:0}));else i.hasClass("e-numerictextbox")?(r=i.val(),b.width=a,b.showSpinButton=!0,b.cssClass=v.cssClass,"width"==n?(b.maxValue=250,b.minValue=30,b.value=r.length?parseFloat(r):150):"priority"==n&&(b.maxValue=6,b.minValue=1,b.value=r.length?parseFloat(r):null),i.ejNumericTextbox(b)):("showInColumnChooser"==n||"allowCellSelection"==n||"allowFiltering"==n||"allowFilteringBlankContent"==n||"allowSorting"==n||"visible"==n||"isFrozen"==n||"allowFreezing"==n||"displayAsCheckbox"==n)&&((g={}).cssClass=v.cssClass,g.size="small",i.ejCheckBox(g));i.is(":disabled")||T||i.is(":hidden")&&"object"!=typeof i.data("ejDropDownList")||_._isEnterKeyPressed||(_._focusElements(i.closest("td")),T=!0)}o="#treegrid"+_._id+"dropdownData",e(o).length&&(m=[],e(o).ejTreeGrid({dataSource:m,allowSorting:!1,allowAdding:!0,columns:[{headerText:_._columnDialogTexts.dropdownTableText,field:"text",editType:t.TreeGrid.EditingType.String,width:"150px"},{headerText:_._columnDialogTexts.dropdownTableValue,field:"value",editType:t.TreeGrid.EditingType.String,width:"150px"}],enableAltRow:!0,allowColumnResize:!0,cssClass:v.cssClass,enableResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing"},locale:v.locale,treeColumnIndex:5,emptyRecordText:"Add values for dropdown",rowSelected:function(t){t.data&&(e(".e-deletepre").addClass("e-enable").removeClass("e-disable"),e(".e-deletepre").bind("click",e.proxy(_._deleteDropDownRow,_,e(o))))}}),l=f.find("#"+_._id+"dropdownDataTable").parent()[0],e(l).attr("hidden",!0),e(".e-addpre").bind("click",e.proxy(_._addDropDownRow,_,e(o))))},_addDropDownRow:function(e){var t=e.data("ejTreeGrid"),i=t.model.dataSource.length,a={text:"Text "+(i+1),value:"Value"+(i+1)};t.addRow(a,"bottom")},_deleteDropDownRow:function(t){var i=t.data("ejTreeGrid"),a=i.model.updatedRecords.length,r=i.model.selectedItem;0!=a&&r&&(i.deleteRow(),e(".e-deletepre").addClass("e-disable").removeClass("e-enable"),e(".e-deletepre").unbind("click",e.proxy(this._deleteDropDownRow,this,t)))},getAllDataSourceFields:function(){for(var t,i,a=this,r=a.model,n=r.dataSource,o=0;o<n.length;o++)for(i in t=n[o])i==r.childMapping?a.getChildKeys(t[i]):-1==e.inArray(i,a._dataSourcefields)&&(r.isFromGantt?"undefined"!=i&&i!=r.notesMapping&&a._dataSourcefields.push(i):"object"!=typeof t[i]&&"ejvalue"!=i&&a._dataSourcefields.push(i))},getChildKeys:function(t){var i,a,r,n=this,o=n.model;if(t)for(i=0;i<t.length;i++)for(r in a=t[i])r==o.childMapping?n.getChildKeys(a[r]):-1==e.inArray(r,n._dataSourcefields)&&"object"!=typeof a[r]&&"ejvalue"!=r&&n._dataSourcefields.push(r)},_renderUpdateConfirmDialog:function(){var i=this,a=i._confirmDeleteText,r=t.buildTag("div.e-content",i._deleteColumnText),n=t.buildTag("span.e-buttons","<input class='e-confirm-dialog-btn-ok' type='button' id="+i._id+"ConfirmDialogOK value="+i._okButtonText+" /> <input class='e-confirm-dialog-btn-cancel' type='button' id="+i._id+"ConfirmDialogCancel value='"+i._cancelButtonText+"' />"),o=t.buildTag("div","",{},{class:"e-confirm-dialog-btn"});o.append(n),i._updateConfirmDialog=t.buildTag("div","","",{title:a,id:i._id+"ConfirmDialog"}),i._updateConfirmDialog.append(r).append(o),i.element.append(i._updateConfirmDialog),n.find("input").ejButton({cssClass:i.model.cssClass,showRoundedCorner:!0,size:"normal",click:e.proxy(i._triggerUpdateConfirm,i)}),i._updateConfirmDialog.ejDialog({width:"auto",minHeight:0,minWidth:0,showOnInit:!1,isResponsive:!0,enableResize:!1,enableModal:!0,cssClass:i.model.cssClass}),e("#"+i._id+"ConfirmDialog_wrapper").addClass("e-treegrid-dialog")},_triggerUpdateConfirm:function(e){var t=this;e!==i&&e.model.text==t._okButtonText&&t._updateConfirmDialog.find(".e-content").text()==t._deleteColumnText&&t.deleteColumn(t._targetColumnIndex),t._updateConfirmDialog.ejDialog("close")},deleteColumn:function(t){var i,a,r=this,n=r.model,o=n.columns,l=n.sortSettings&&n.sortSettings.sortedColumns.length?n.sortSettings.sortedColumns:null,d=o[t],s={};t==n.treeColumnIndex||o[t].nonColumn||(s.requestType="deleteColumn",s.columnObject=d,s.deleteIndex=t,r._trigger("actionComplete",s)||(!n.isFromGantt&&n.allowSorting&&n.filterSettings.filteredColumns.length>0&&r.clearFilter(d.field),i=o.splice(t,1),l&&((a=e.grep(l,function(e){return n.isFromGantt?e.field==i[0].mappingName:e.field==i[0].field})).length&&(l.splice(l.indexOf(a[0]),1),r.processBindings(),n.isFromGantt&&(s.requestType="sorting",r._trigger("actionComplete",s)))),t<=n.treeColumnIndex&&(n.treeColumnIndex=n.treeColumnIndex-1),n.showTotalSummary&&n.collapsibleTotalSummary&&t==r._summaryColumnIndex&&(r._summaryColumnIndex=0),r._refreshFrozenColumns(),r._updateWrapRowHeights(null,"virtualRefresh"),n.isFromGantt&&r._updateAddEditDialogTemplate()))},getOffsetRect:function(e){var t=e.getBoundingClientRect(),i=document.body,a=document.documentElement,r=window.pageYOffset||a.scrollTop||i.scrollTop,n=window.pageXOffset||a.scrollLeft||i.scrollLeft,o=a.clientTop||i.clientTop||0,l=a.clientLeft||i.clientLeft||0,d=t.top+r-o,s=t.left+n-l;return{top:Math.round(d),left:Math.round(s)}},_moveToNextMenuItem:function(t){var i,a,r,n,o,l,d,s=this.model,c={};switch(this._isContextMenuItems||s.isFromGantt?(s.isFromGantt?(i=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),r=e("#"+this._id.replace("ejTreeGrid","")+"_ContextMenu")):(i=this,r=e("#"+this._id+"_ContextMenu")),n=i._contextMenuItems):(i=this,r=e("#"+this._id+"_headerContextMenu"),n=i._headerContextMenuItems),a=e("#"+i._activeMenuItemId),t){case"next":0==a.length?c=r.find("div.e-menuitem:not(.e-disable)").first():(c=a.closest("li").next("li").find("div.e-menuitem")).length>0&&c.hasClass("e-disable")&&(c=this._findContextMenuItem(c,"next")),e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId).remove();break;case"prev":c=this._findContextMenuItem(a,"prev"),e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId).remove();break;case"expand":a.length>0&&(i._showSubContextMenu(a[0],n),(l=e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId)).length>0&&(c=l.find("div.e-menuitem:not(.e-disable)").first()));break;case"collapse":(l=e(a).closest(".e-tginnerContextmenu")).length>0&&(o=l.attr("id").replace(i._id+"_SubContextMenu",""),c=e("#"+o),e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId).remove(),l.remove());break;case"save":a.length>0&&(0==e("#"+i._activeMenuItemId).find(".e-expander").length?(s.isFromGantt?i._contextMenuClickHandler(e("#"+i._activeMenuItemId)):i.contextMenuOperations(i._activeMenuItemId),i._clearContextMenu()):(i._showSubContextMenu(a[0],n),(l=e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId)).length>0&&(c=l.find("div.e-menuitem:not(.e-disable)").first())))}c.length>0&&(d=this._isContextMenuItems||s.isFromGantt?"e-tgcontextmenu-mouseover":"e-columnmenuselection",("next"==t||"prev"==t)&&a.removeClass(d),c.addClass(d),i._activeMenuItemId=e(c).attr("id"))},_findNextColumnMenuItem:function(e,t,i){var a,r,n=this;return a=i?e.closest("li").next("li").find("div.e-columnmenuitem"):e.closest("li").next("li").find("div.e-menuitem "),r=i?e.closest("li").prev("li").find("div.e-columnmenuitem"):e.closest("li").prev("li").find("div.e-menuitem"),"next"===t?a.length>0&&a.hasClass("e-disable")?i?n._findNextColumnMenuItem(a,"next",!0):n._findNextColumnMenuItem(a,"next",!1):a:r.length>0&&r.hasClass("e-disable")?i?n._findNextColumnMenuItem(r,"prev",!0):n._findNextColumnMenuItem(r,"prev",!1):r},_getFieldValue:function(e,t){return""!=e?e.split(".").join(""):"TGcolumn"+t},_findContextMenuItem:function(e,t){var i,a;return"next"===t?(i=e.closest("li").next("li").find("div.e-menuitem")).length>0&&i.hasClass("e-disable")?this._findContextMenuItem(i,"next"):i:(a=e.closest("li").prev("li").find("div.e-menuitem")).length>0&&a.hasClass("e-disable")?this._findContextMenuItem(a,"prev"):a},updateRecordByIndex:function(i,a){var r,n=this,o=n.model,l=o.updatedRecords,d={},s=i,c=s>-1&&l.length>0?l[s]:null;if(n._isRowEdit?n.cancelRowEditCell():n.model.isEdit&&n.cancelEditCell(),t.isNullOrUndefined(c)||c.isSummaryRow)return!1;var u=c.item,p=e.extend(!0,{},u),h=e.extend(!0,{},o.columns);e.each(a,function(i,a){var r,l=i,d=a;if(!t.isNullOrUndefined(l)&&(r=!1,e.each(h,function(e,t){if(t.field==l)return r=!0,delete h[parseInt(e)],!1}),r)){if("batchEditing"==o.editSettings.editMode){var s={},u=t.copyObject({},c.item);o.columns.filter(function(e){e.field==l&&(s=e)});(s.editType==t.TreeGrid.EditingType.DatePicker||s.editType==t.TreeGrid.EditingType.DateTimePicker)&&(d=t.parseDate(d,o.dateFormat,o.locale)),n._checkModfiedCellValue(t.getObject(l,u),d,s)&&(n._createBatchEditedFields(c,l,d,s),n._batchEditStarts=!0,n._updateBatchChanges(c.item))}(c=n._restoreCustomData(c,d,l)).item=n._restoreCustomData(c.item,d,l)}}),r=o.currentViewData.indexOf(c),o.enableVirtualization?r>-1&&t.TreeGrid.refreshRow(n,r):t.TreeGrid.refreshRow(n,r),o.idMapping&&o.parentIdMapping&&n._updateLastInsertedId(c[o.idMapping]),d.editType="rowedit",d.previousValue=p,d.currentValue=c.item,d.rowIndex=s,o.showSummaryRow&&n._updateSummaryRow(d),o.showTotalSummary&&n._updateTotalSummaryRow(d),"batchEditing"==o.editSettings.editMode&&n._cancelSaveTools()},_saveEditedElements:function(){var e=this;e.model.isEdit?e.saveCell():e._isRowEdit&&e.saveRow()}}),t.TreeGrid.Actions={Sorting:"sorting",BeginEdit:"beginedit",Save:"save",Add:"add",Delete:"delete",Cancel:"cancel",Refresh:"refresh",Searching:"searching",ExpandCollapse:"expandcollapse",Selection:"selection",rowHover:"rowHover",Scroll:"scroll",ContextMenuAdd:"contextMenuAdd",RefreshDataSource:"refreshDataSource",DragAndDrop:"dragAndDrop",Paging:"paging",Filter:"filtering",RowIndexUpdate:"rowIndexUpdate"},t.TreeGrid.SelectionType={Single:"single",Multiple:"multiple",Checkbox:"checkbox"},t.TreeGrid.FilterType={FilterBar:"filterbar",Menu:"menu",Excel:"excel"},t.TreeGrid.FilterHierarchyMode={Parent:"parent",Child:"child",Both:"both",None:"none"},t.TreeGrid.SearchHierarchyMode={Parent:"parent",Child:"child",Both:"both",None:"none"},t.TreeGrid.HeaderTextOverflow={None:"none",Wrap:"wrap"},t.TreeGrid.EditMode={CellEditing:"cellEditing",RowEditing:"rowEditing",DialogEditing:"dialogEditing",BatchEditing:"batchEditing"},t.TreeGrid.BatchEditMode={Cell:"cell",Row:"row",Dialog:"dialog"},t.TreeGrid.ClipMode={Clip:"clip",Ellipsis:"ellipsis"},t.TreeGrid.PageSizeMode={All:"all",Root:"root"},t.TreeGrid.PrintMode={AllPages:"allPages",CurrentPage:"currentPage"},t.TreeGrid.RowPosition={Top:"top",Bottom:"bottom",Above:"aboveSelectedRow",Below:"belowSelectedRow",Child:"child"},t.TreeGrid.BeginEditAction={DblClick:"dblClick",Click:"click"},t.TreeGrid.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker",Maskedit:"maskedit"},t.TreeGrid.ContextMenuItems={Add:"add",Edit:"edit",Delete:"delete"},t.TreeGrid.ColumnResizeMode={Normal:"normal",FixedColumns:"fixedcolumns",NextColumn:"nextcolumn"},t.TreeGrid.UnboundType={Edit:"edit",Save:"save",Delete:"delete",Cancel:"cancel"},t.TreeGrid=t.TreeGrid||{},t.TreeGrid._initCellEditType=function(i,a,r,n,o,l,d){var s,c,u,p,h,g,m,_,f,w=i,C=w.model,T=l?d:C.columns,x=T[n];o=o||"",(T[n].field||"").split(".");switch(T[n].editTemplate?T[n].editType="edittemplate":t.isNullOrUndefined(T[n].editType)&&(x.editType="stringedit"),s="dialogEditing"==w.model.editSettings.editMode?T[n].field:w._getFieldValue(T[n].field,n),x.editType){case"stringedit":C.isFromGantt?(c={},"predecessor"===x.field&&(c["_"+r+"predecessorCell"]=e.proxy(w._getPredecessorsValue,w)),e.views.helpers(c),"predecessor"===x.field?u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+r+"predecessorCell(#data)}}",id:r+x.field+o,name:x.field,"data-dialog":o}):"duration"===x.field?((c={})["_"+r+"getDurationStringValue"]=e.proxy(t.Gantt._getDurationStringValue,w),e.views.helpers(c),u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+r+"getDurationStringValue(#data)}}",id:r+x.field+o,name:x.field,"data-dialog":o})):u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:r+T[n].field+o,name:T[n].field,"data-dialog":o})):u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:r+w._getFieldValue(x.field,n)+o,name:x.field,autocomplete:"off","data-dialog":o}),u.attr("data-edittype",T[n].editType),a.html(u);break;case"maskedit":(u=t.buildTag("input.e-field e-maskedit","",{},{value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:r+w._getFieldValue(x.field,n)+o,name:x.field,"data-dialog":o})).attr("data-edittype",T[n].editType),a.html(u);break;case"booleanedit":a.html("{{if true===~_"+w._id+'cellValue(#data,"'+s+'")}}<input type ="checkbox" id="'+r+w._getFieldValue(T[n].field,n)+o+'" data-dialog ="'+o+'" name="'+T[n].field+'" checked="checked" data-edittype="'+T[n].editType+'"></input> {{else}}<input type ="checkbox" id="'+r+w._getFieldValue(T[n].field,n)+o+'" data-dialog ="'+o+'" name="'+T[n].field+'" data-edittype="'+T[n].editType+'">{{/if}}');break;case"numericedit":(p=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:r+w._getFieldValue(T[n].field,n)+o,name:T[n].field,"data-dialog":o})).attr("data-edittype",T[n].editType),a.append(p);break;case"datepicker":(h=t.buildTag("input.e-datepicker e-field","",{},{type:"text",value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:r+w._getFieldValue(T[n].field,n)+o,name:T[n].field,"data-dialog":o})).attr("data-edittype",T[n].editType),a.append(h);break;case"datetimepicker":(h=t.buildTag("input.e-datetimepicker e-field","",{},{type:"text",value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:r+w._getFieldValue(T[n].field,n)+o,name:T[n].field,"data-dialog":o})).attr("data-edittype",T[n].editType),a.append(h);break;case"dropdownedit":(g=t.buildTag("input.e-field e-dropdownlist","",{},{type:"text",id:r+w._getFieldValue(T[n].field,n)+o,name:T[n].field,"data-dialog":o})).attr("data-edittype",T[n].editType).attr("data-cellvalue","{{:~_"+w._id+"cellValue(#data,'"+s+"')}}"),a.append(g);break;case"edittemplate":"string"==typeof(m=T[n].editTemplate.create)?(_=t.util.getObject(m,window),f=e.isFunction(_)?e(_()).attr({id:r+w._getFieldValue(x.field,n),name:x.field}):1==e(m).length&&"SCRIPT"==e(m).get(0).tagName?e(e(m).html()).attr({id:r+w._getFieldValue(x.field,n),name:x.field}):e(m).attr({id:r+w._getFieldValue(x.field,n),name:x.field})):f=e(m()).attr({id:r+w._getFieldValue(x.field,n),name:x.field}),f.attr("data-edittype",T[n].editType),a.append(f)}},t.TreeGrid.ToolbarItems={Add:"add",Edit:"edit",Delete:"delete",Update:"update",Cancel:"cancel",ExpandAll:"expandAll",CollapseAll:"collapseAll",PdfExport:"pdfExport",ExcelExport:"excelExport",Print:"print",Search:"search"},t.TreeGrid.SummaryType={Sum:"sum",Average:"average",Maximum:"maximum",Minimum:"minimum",Count:"count",MinimumDate:"minimumDate",MaximumDate:"maximumDate",TrueCount:"trueCount",FalseCount:"falseCount",Custom:"custom"},t.TreeGrid.SelectionMode={Row:"row",Cell:"cell"},t.TreeGrid.Locale=t.TreeGrid.Locale||{},t.TreeGrid.Locale.default=t.TreeGrid.Locale["en-US"]={toolboxTooltipTexts:{addTool:"Add",editTool:"Edit",updateTool:"Update",deleteTool:"Delete",cancelTool:"Cancel",expandAllTool:"Expand All",collapseAllTool:"Collapse All",pdfExportTool:"PDF Export",excelExportTool:"Excel Export",printTool:"Print",searchTool:"Search"},contextMenuTexts:{addRowText:"Add Row",editText:"Edit",deleteText:"Delete",saveText:"Save",cancelText:"Cancel",aboveText:"Above",belowText:"Below"},filterMenuTexts:{stringMenuOptions:[{text:"Starts With",value:"startswith"},{text:"Ends With",value:"endswith"},{text:"Contains",value:"contains"},{text:"Equals",value:"equal"},{text:"Does Not Equal",value:"notequal"}],numberMenuOptions:[{text:"Less Than",value:"lessthan"},{text:"Greater Than",value:"greaterthan"},{text:"Less Than Or Equal To",value:"lessthanorequal"},{text:"Greater Than Or Equal To",value:"greaterthanorequal"},{text:"Equals",value:"equal"},{text:"Does Not Equal",value:"notequal"}],filterValue:"Filter Value",filterButton:"Filter",clearButton:"Clear",enterValueText:"enter value"},columnMenuTexts:{sortAscendingText:"Sort Ascending",sortDescendingText:"Sort Descending",columnsText:"Columns",freezeText:"Freeze",unfreezeText:"Unfreeze",freezePrecedingColumnsText:"Freeze Preceding Columns",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",renameColumn:"Rename Column",menuFilter:"Filter"},columnDialogTexts:{field:"Field",headerText:"Header Text",editType:"Edit Type",filterEditType:"Filter Edit Type",allowFiltering:"Allow Filtering",allowFilteringBlankContent:"Allow Filtering Blank Content",allowSorting:"Allow Sorting",visible:"Visible",width:"Width",textAlign:"Text Alignment",headerTextAlign:"Header Text Alignment",isFrozen:"Is Frozen",allowFreezing:"Allow Freezing",columnsDropdownData:"Column Dropdown Data",dropdownTableText:"Text",dropdownTableValue:"Value",addData:"Add",deleteData:"Remove",allowCellSelection:"Allow Cell Selection",showInColumnChooser:"Show In Column Chooser",clipMode:"Clip Mode",tooltip:"Tooltip",headerTooltip:"Header Tooltip",displayAsCheckbox:"Display As Checkbox",priority:"Priority"},columnDialogTitle:{insertColumn:"Insert Column",deleteColumn:"Delete Column",renameColumn:"Rename Column"},editTypeTexts:{string:"String",numeric:"Numeric",datePicker:"Date Picker",dateTimePicker:"Date Time Picker",dropdown:"Dropdown",boolean:"Boolean"},textAlignTypes:{right:"Right",left:"Left",center:"Center"},clipModeTexts:{clip:"Clip",ellipsis:"Ellipsis"},deleteColumnText:"Are you sure you want to delete this column?",deleteRecordText:"Are you sure you want to delete record?",okButtonText:"OK",cancelButtonText:"Cancel",confirmDeleteText:"Confirm Delete",batchSaveConfirmText:"Are you sure you want to save changes?",batchSaveLostChangesText:"Unsaved changes will be lost. Are you sure you want to continue?",cancelEditText:"Are you sure you want to cancel the changes?",dropDownListBlanksText:"(Blanks)",dropDownListClearText:"(Clear Filter)",trueText:"True",falseText:"False",emptyRecord:"No records to display"},t.TreeGrid._getrowClassName=function(){var e="gridrowIndex",t=this;return t.data.parentItem&&(e+=t.data.parentItem.index.toString()),e+="level",e+=t.data.level.toString(),t.data.isSummaryRow&&(e+=" ",e+="e-summaryrow"),t.data.footerSummaryRowRecord&&(e+=" ",e+="e-footersummaryrow"),t.data.isFirstFooterSummary&&(e+=" ",e+="e-firstfootersummaryrow"),e},t.TreeGrid._getSummaryRowtdClassName=function(){var e="";return this.data.isSummaryRow&&(e+=" ",e+="e-summaryrowcell"),this.data.footerSummaryRowRecord&&(e+=" ",e+="e-footersummaryrowcell"),e},t.TreeGrid.getColumnByField=function(e,t){for(var i=0;i<e.length&&e[i].field.split(".").join("")!=t.split(".").join("");i++);return i==e.length?null:e[i]},t.TreeGrid.getColumnByMappingName=function(e,t){for(var i=0;i<e.length&&e[i].mappingName!=t;i++);return i==e.length?null:e[i]},t.TreeGrid.sendExpandCollapseRequest=function(i,a){var r,n,o,l,d=i,s=d.model;s.toolbarSettings.toolbarItems;if(a.requestType=t.TreeGrid.Actions.ExpandCollapse,d._isRowEdit?d.cancelRowEditCell():d.model.isEdit&&d.cancelEditCell(),s.enableVirtualization){if(d._isFromGantt){if(d._isLoadonDemand&&!a.data.isChildRetrieved&&1==a.expanded)return void t.TreeGrid.expandRowsonDemand(d,a.data,a);d._$treegridHelper.ejTreeGrid("processBindings",a)}else{if(d._isLoadonDemand&&!a.data.isChildRetrieved&&1==a.expanded)return void t.TreeGrid.expandRowsonDemand(d,a.data,a);d.processBindings(a)}d._isFromGantt?!1===d._isInExpandCollapseAll&&(s.enableAltRow&&d._$treegridHelper.ejTreeGrid("updateAltRow"),d._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",a),d._$treegridHelper.ejTreeGrid("updateHeight"),d.model.updatedGanttRecords=d.getUpdatedRecords(),d.model.currentViewData=d.getCurrentViewData(),d._$ganttchartHelper.ejGanttChart("clearConnectorLines"),d._$ganttchartHelper.ejGanttChart("refreshHelper",d.model.currentViewData,d.model.updatedGanttRecords)):!1===d._isInExpandCollapseAll&&(s.enableAltRow&&d.updateAltRow(),d.sendDataRenderingRequest(a),d._updateWrapRowHeights("total,header"),d._setScrollTop(),d.updateHeight())}else{var c,u,p=a.data,h=0;p.expanded,a.expanded;if(c=d.model.currentViewData.indexOf(p),d._frozenColumnsLength&&d.getRows()?u=e(d.getRows()[0][c]).add(d.getRows()[1][c]):d.getRows()&&(u=d.getRows()&&e(d.getRows()[c])),a.expanded){if(p.expanded=a.expanded,d._isLoadonDemand&&!p.isChildRetrieved)return void t.TreeGrid.expandRowsonDemand(d,p,a);u&&t.TreeGrid.expandRecord(d,p,a.expanded,a),p.hasFilteredChildRecords&&(u&&u.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),u&&u.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),s.enableAltRow&&!1===d._isInExpandCollapseAll&&!s.allowPaging&&t.TreeGrid.updateAltRow(d,p,c,1)}else d._collapsedRecordCount=0,u&&t.TreeGrid.collapseRecord(d,p,a.expanded),p.expanded=a.expanded,p.hasFilteredChildRecords&&(u&&u.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),u&&u.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse")),s.enableAltRow&&!1===d._isInExpandCollapseAll&&0!=d._collapsedRecordCount&&!s.allowPaging&&t.TreeGrid.updateAltRow(d,p,c,d._collapsedRecordCount);n=0,d._isFromGantt?(d._$treegridHelper.ejTreeGrid("updateExpandStatus",p,a.expanded),d._$treegridHelper.ejTreeGrid("updateCollapsedRecordCount"),n=d._$treegridHelper.ejTreeGrid("getCollapsedRecordCount")):(d.updateExpandStatus(p,a.expanded),d.updateCollapsedRecordCount(),n=d.getCollapsedRecordCount()),s.allowPaging&&("ejTreeGridcollapsing"==a.type||"ejTreeGridexpanding"==a.type)&&(t.isNullOrUndefined(d.getPager())||d.gotoPage(),s.enableAltRow&&!1===d._isInExpandCollapseAll&&t.TreeGrid.updateAltRow(d,p,c,1)),d._isFromGantt?!1===d._isInExpandCollapseAll&&(d._totalCollapseRecordCount=n,d._$ganttchartHelper.ejGanttChart("clearConnectorLines"),d._$treegridHelper.ejTreeGrid("updateHeight"),h=d._$treegridHelper.ejTreeGrid("getRecordsHeight"),d._$ganttchartHelper.ejGanttChart("updateHeight",h),d._$ganttchartHelper.ejGanttChart("setCollapsedRecordCount",n),d._$ganttchartHelper.ejGanttChart("refreshGridLinesTable",d.model.updatedRecords.length-n)):!1===d._isInExpandCollapseAll&&(s.allowTextWrap&&d._$frozenTableContent.length>0?(d._updateWrapRowHeights("total,header"),d._updateScrollCss()):d.updateHeight())}if(d._isFromGantt&&d.model.predecessorMapping&&!1===d._isInExpandCollapseAll&&d._refreshConnectorLines(!1,!1,!0),d._isFromGantt){var g=d._$treegridHelper.ejTreeGrid("instance"),m=d._$ganttchartHelper.ejGanttChart("instance"),_=g._$gridContent.ejScroller("option","scrollTop");m._$bodyContainer.ejScroller("option","scrollTop",_),g.getScrollElement().ejScroller("isHScroll")||g.getScrollElement().scrollTop(_)}(o={}).recordIndex=a.recordIndex,o.data=a.data,o.requestType=a.requestType,o.expanded=a.expanded,t.isNullOrUndefined(o.data.item[s.expandStateMapping])||(o.data[s.expandStateMapping]=a.expanded,o.data.item[s.expandStateMapping]=a.expanded),a.expanded?d._trigger("expanded",o):d._trigger("collapsed",o),l=d.selectedItem(),!d._isFromGantt&&l&&(1==s.selectedItems.length||d._checkboxSelection)&&(d.getExpandStatus(l)||a.expanded||(d.selectRows(-1),d.selectedRowIndex(-1),l.isSelected=!1,s.selectedItem=null,l=null),r=s.allowPaging?d._updatedPageData:d.model.updatedRecords,s.enableVirtualization&&l&&r.indexOf(l)!==d.selectedRowIndex()&&d.selectRows(r.indexOf(l)),d._cancelSaveTools())},t.TreeGrid.expandRowsonDemand=function(e,i,a){var r=e,n=r.model,o=t.Query().select(r._fieldNamesToQuery),l=n.flatRecords;n.updatedRecords;if(r._isFromGantt){var d=t.Predicate(n.parentTaskIdMapping,t.FilterOperators.equal,i.item[n.taskIdMapping]),s=n.taskIdMapping;n.parentTaskIdMapping}else d=t.Predicate(n.parentIdMapping,t.FilterOperators.equal,i.item[n.idMapping]),s=n.idMapping,n.parentIdMapping;return i.isChildRetrieved?(i.expanded=!0,t.TreeGrid.sendExpandCollapseRequest(r,a),!0):!!r._trigger("actionBegin",a)||(o.where(d),r._waitingPopupObj.show(),o.requiresCount(),void r.dataSource().executeQuery(o).done(t.proxy(function(e){for(var o,d,c,u=e.result,p=u.length,h=[],g=[],m=[],_=l.indexOf(i),f=(i.childRecords&&i.childRecords.length,0);f<p;f++)r._isFromGantt?(d=r._createGanttRecord(u[f],i.level+1,i),n.enableWBS&&(o=i.WBS,d.WBS=o+"."+(f+1))):d=r._createRecord(u[f],i.level+1,i),d.index=l.length+h.length,i.childRecords.push(d),(d.item[n.hasChildMapping]||-1!=r._assignedParendIDs.indexOf(d.item[s]))&&(d.hasChildRecords=!0,d.childRecords=[],d.isChildRetrieved=!1,r._allParentItems.push(d),r._isFromGantt&&(d.manualStartDate=d.startDate,d.manualEndDate=d.endDate,d.manualDuration=d.duration,d.isAutoSchedule||r._updateManualParentItem(d,null,!0))),d.item[s]&&g.push(d.item[s]),h.push(d),m.push(u[f]);r._taskIds.splice.apply(r._taskIds,[_+1,0].concat(g)),r._isFromGantt&&n.ids.splice.apply(n.ids,[_+1,0].concat(g.toString().split(","))),l.splice.apply(l,[_+1,0].concat(h)),r._isDataManagerUpdate&&r._jsonData.splice.apply(r._jsonData,[_+1,0].concat(m)),i.isChildRetrieved=!0,i.expanded=!0,c={recordIndex:_,data:i,requestType:"expandcollapse",expanded:!0},a&&(a.isExpandingParticularLevelParent||r._isInExpandCollapseAll)?t.TreeGrid.expandMultipleRecordsonDemand(r,i,a,c):(r._renderExpandedChildRecords(a),r._trigger("expanded",c))})).fail(t.proxy(function(e){r._triggerFailureEvent(e,r)})))},t.TreeGrid.expandMultipleRecordsonDemand=function(e,i,a,r){var n,o,l,d,s,c=e;if(a.isExpandingParticularLevelParent)for(l=c._allParentItems.filter(function(e){if(e.level==a.recordLevel&&!e.expanded&&e.hasChildRecords)return e}),n=i.parentItem,o=0;o<a.recordLevel;o++)n&&n.isChildRetrieved&&(n.expanded=!0),n=n&&n.parentItem;for(c._isInExpandCollapseAll&&(l=c._allParentItems.filter(function(e){if(!e.expanded&&e.hasChildRecords)return e})),d=0;d<l.length&&((s={}).data=l[d],s.recordIndex=c.model.updatedRecords.indexOf(l[d]),s.expanded=!0,a.isExpandingParticularLevelParent&&(s.recordLevel=a.recordLevel,s.isExpandingParticularLevelParent=!0),s.requestType=t.TreeGrid.Actions.ExpandCollapse,t.TreeGrid.expandRowsonDemand(c,l[d],s));d++)c._allParentItems.splice(c._allParentItems.indexOf(l[d]),1),l.splice(l.indexOf(l[d]),1),l.length>0&&(d=-1);0==l.length&&(c._isInExpandCollapseAll=!1,c._renderExpandedChildRecords(a),c._trigger("expanded",r))},t.TreeGrid.expandRecord=function(i,a,r){var n,o,l,d=i,s=".gridrowIndex"+a.index.toString()+"level"+(a.level+1).toString(),c=".detailsrowgridrowIndex"+a.index.toString()+"level"+(a.level+1).toString(),u=e(d.element).find(s),p=0,h=u.length,g=d.model,m=e(d.element).find(c),_=e(d.element).find(s),f=d.getRows(),w=e(f[l]);for(l=g.currentViewData.indexOf(a),a.hasChildRecords&&a.childRecords.length>0&&(w.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),w.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),d._expandedRecordsCount+=d._isFromGantt||d._frozenColumnsLength>0?_.length/2:_.length,_.css({display:"table-row"}),m.filter("tr.e-detailsrowexpanded").css("display","table-row"),(d._isFromGantt||d._frozenColumnsLength>0)&&(h/=2);p<h;p++)n=u[p],l=-1,-1!==(l=d._frozenColumnsLength>0?e(d.getRows()[0]).index(n):d.getRows().index(n))&&(d._isFromGantt,(o=d.model.updatedRecords[l]).isExpanded=!0,o.expanded&&t.TreeGrid.expandRecord(d,o,r))},t.TreeGrid.collapseRecord=function(i,a,r){var n,o,l,d=i,s=(d.model,".gridrowIndex"+a.index.toString()+"level"+(a.level+1).toString()),c=".detailsrowgridrowIndex"+a.index.toString()+"level"+(a.level+1).toString(),u=e(d.element).find(s),p=0,h=u.length,g=e(d.element).find(c),m=e(d.element).find(s);d.getRows();for(d._collapsedRecordCount+=d._isFromGantt||d._frozenColumnsLength>0?m.length/2:m.length,m.css({display:"none"}),g.css({display:"none"}),(d._isFromGantt||d._frozenColumnsLength>0)&&(h/=2);p<h;p++)n=u[p],o=-1,-1!==(o=d._frozenColumnsLength>0?e(d.getRows()[0]).index(n):d.getRows().index(n))&&((l=d.getUpdatedRecords()[o]).expanded&&t.TreeGrid.collapseRecord(d,l,r))},t.TreeGrid.updateAltRow=function(t,i,a,r){var n,o,l,d=t,s=0,c=d.model,u=c.updatedRecords,p=u.length,h=i.isAltRow,g=d.getRows();if(o=d._frozenColumnsLength?d.getRows()[0]:d.getRows(),!c.rowTemplateID&&!c.altRowTemplateID)for(s=a+r;s<p;s++)e(o[s]).hasClass("e-summaryrow")||"none"!==e(o[s]).css("display")&&(n=u[s],0!=s&&(n.isAltRow=!h),h=n.isAltRow,l={},l=d._frozenColumnsLength?e(g[0][s]).add(g[1][s]):e(g[s]),h?e(l).addClass("e-alt-row"):e(l).removeClass("e-alt-row"))},t.TreeGrid.refreshRow=function(i,a){var r,n,o,l,d=i,s=d.model,c=d.model.currentViewData[a];c&&(d._frozenColumnsLength>0?(n=e(d.getRows()[0][a]),r=e(d.getRows()[1][a]),s.showDetailsRow&&s.detailsTemplate&&c.isDetailsExpanded&&((o=n.next("tr")).hasClass("e-detailsrow")&&(o.remove(),r.next("tr").remove())),n.replaceWith(e(e.render[d._id+"_JSONFrozenTemplate"](c))),r.replaceWith(e(e.render[d._id+"_Template"](c)))):(r=e(d.getRows()[a]),s.showDetailsRow&&s.detailsTemplate&&c.isDetailsExpanded&&((o=r.next("tr")).hasClass("e-detailsrow")&&o.remove()),s.allowSelection||(c.isSelected=!1),r.replaceWith(e(e.render[d._id+"_Template"](c)))),d.setGridRows(e(d.getContentTable().get(0).rows)),d._gridRows=d.getContentTable().get(0).rows,d._frozenColumnsLength>0&&(d._gridRows=[d._gridRows,d.getContentTable().get(1).rows]),l=t.TreeGrid.getRowByIndex(d,d.getUpdatedRecords().indexOf(s.currentViewData[a])),d._trigger("refresh"),d._rowEventTrigger(l,c))},t.TreeGrid.getRowByIndex=function(i,a,r){var n,o,l;try{var d=(n="ejTreeGrid"==i.pluginName?i:i._$treegridHelper.data("ejTreeGrid")).getRows(),s=(n.model,n.getUpdatedRecords()),c=e();return n.model.enableVirtualization&&(o=s[a],a=n.model.currentViewData.indexOf(o)),t.isNullOrUndefined(r)?n._frozenColumnsLength>0?(d[0][a]&&(c.push(d[0][a]),c.push(d[1][a])),c):e(d[a]):(n.model.enableVirtualization&&(l=s[r],r=n.model.currentViewData.indexOf(l)),n._frozenColumnsLength>0?(c.push(e(d[0]).slice(a,r)),c.push(e(d[1]).slice(a,r)),c):e(d.slice(a,r)))}catch(t){return e()}}})(jQuery,Syncfusion),function(e,t){t.gridFeatures=t.gridFeatures||{},t.gridFeatures.gridResize=function(t){this.$headerTable=t.getHeaderTable(),this.gridInstance=t,this._colMinWidth=15,this._$visualElement=e(),this._currentCell=-1,this._allowStart=!1,this._oldWidth=null,this._orgX=null,this._orgY=null,this._extra=null,this._expand=!1,this._target=null,this._cellIndex=-1},t.gridFeatures.gridResize.prototype={_mouseHover:function(t){var i,a,r,n,o;if(!this._$visualElement.is(":visible")&&(this._allowStart=!1,e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),i=e(t.target),e(t.target).hasClass("e-filtericon")&&("col-resize"==e(t.target).css("cursor")||"col-resize"==e(t.target).closest("tr").css("cursor"))&&(e(t.target).css("cursor","pointer"),e(t.target).closest("tr").css("cursor","pointer")),i.hasClass("e-headercell"))){var l=t.target,d=l.getBoundingClientRect(),s=0,c=0;(t.type="mousemove")?(s=t.clientX,c=t.clientY):(t.type="touchmove")?(s=evt.originalEvent.changedTouches[0].clientX,c=evt.originalEvent.changedTouches[0].clientY):(t.type="MSPointerMove")&&(s=t.originalEvent.clientX,c=t.originalEvent.clientY),a=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left,(s>=d.left+document.documentElement.scrollLeft+l.offsetWidth-5||s<=d.left+3)&&s<a&&s>=d.left&&c<=d.top+document.documentElement.scrollTop+t.target.offsetHeight?(r=s>d.left+3?e(t.target).find(".e-headercelldiv"):e(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),n=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,o=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-n,(this.gridInstance.model.enableRTL&&s<=o||!this.gridInstance.model.enableRTL&&s>=o)&&((this.gridInstance.model.showStackedHeader||r.length)&&-1==e.inArray(e(r).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)?(this.gridInstance.model.showStackedHeader&&e(i.parents("thead")).find("tr").addClass("e-resizedragicon"),this.gridInstance.model.showStackedHeader||i.parent().addClass("e-resizedragicon"),this._currentCell=e(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(l):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(l),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):(i.parent().css("cursor","pointer"),this._currentCell=-1))):(this.gridInstance.element.find(".e-columnheader").removeClass("e-resizedragicon"),this._currentCell=-1)}},_start:function(t,i){var a,r,n,o,l,d,s,c=this.gridInstance.getHeaderTable().find(".e-columnheader");if(r=e(this._target).hasClass("e-stackedHeaderCell")?c.find(".e-headercell").not(".e-hide"):c.find(".e-headercell").not(".e-stackedHeaderCell,.e-hide"),-1!=this._currentCell&&this._currentCell<r.length&&(n=r[this._currentCell]),void 0!==n)if(o=n.getBoundingClientRect(),a=this._tableY=o.top+parseInt(-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart){if(l=this._$visualElement=e(document.createElement("div")),d=this.gridInstance.element.find(".e-gridcontent").first().height()+this.gridInstance.element.find(".e-gridheader").height(),this.gridInstance.model.showStackedHeader&&this.gridInstance.model.stackedHeaderRows.length>0){var u=this.gridInstance.getHeaderTable().find("tr.e-columnheader"),p=(u.length,e(this._target).parent("tr")[0].rowIndex);for(s=0;s<p;s++)d-=e(u[s]).height()}l.addClass("e-reSizeColbg").appendTo(this.gridInstance.element).attr("unselectable","on").css("visibility","hidden"),this.gridInstance._resizeTimeOut=setTimeout(function(){l.css({visibility:"visible",height:d+"px",cursor:"col-resize",left:t,top:a,position:"fixed"})},100),this._oldWidth=n.offsetWidth,this._orgX=t,this._orgY=i,this._extra=t-this._orgX,this._expand=!0}else this._currentCell=-1},_mouseMove:function(e){if(this._expand){var t=0,i=0;"mousemove"==e.type?(t=e.clientX,i=e.clientY):"MSPointerMove"==e.type?(t=e.originalEvent.clientX,i=e.originalEvent.clientY):"touchmove"==e.type&&(t=e.originalEvent.changedTouches[0].clientX,i=e.originalEvent.changedTouches[0].clientY),0==t&&0==i&&-1!=navigator.userAgent.indexOf("WebKit")&&(t=e.pageX,i=e.pageY),t+=document.documentElement.scrollLeft,e.preventDefault(),this._moveVisual(t)}else this._mouseHover(e)},_touchStart:function(t){var i,a,r,n,o,l;if(!this._$visualElement.is(":visible")){if(this._allowStart=!1,e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),(i=e(t.target)).hasClass("e-headercell")){var d=t.target,s=d.getBoundingClientRect(),c=0,u=0;"touchstart"==t.type&&(c=t.originalEvent.changedTouches[0].clientX,u=t.originalEvent.changedTouches[0].clientY),a=this.gridInstance.element.children(".e-gridheader"),r=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+a.find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+a.find(".e-columnheader").offset().left,(c>=s.left+document.documentElement.scrollLeft+d.offsetWidth-10||c<=s.left+8)&&c<r&&c>=s.left&&u<=s.top+document.documentElement.scrollTop+t.target.offsetHeight?(n=c>s.left+8?e(t.target).find(".e-headercelldiv"):e(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),o=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,l=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-o,(this.gridInstance.model.enableRTL&&c<=l||!this.gridInstance.model.enableRTL&&c>=l)&&((this.gridInstance.model.showStackedHeader||n.length)&&-1==e.inArray(e(n).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)?(this._currentCell=e(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(d):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(d),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):this._currentCell=-1)):this._currentCell=-1}if(this._allowStart){if(this._target=i,"ejGrid"==this.gridInstance.pluginName&&this.gridInstance.model.allowResizing){if(this._triggerResizeEvents("resizeStart",c))return}else if("ejTreeGrid"==this.gridInstance.pluginName&&this.gridInstance.model.allowColumnResize&&this.gridInstance._triggerColumnResize("columnResizeStart",c,t))return;return this,c+=document.documentElement.scrollLeft,2!=t.button&&this._start(c,u),!1}return!0}},_getCellIndex:function(t){e(t._target);var i,a,r=t._target,n=r.getBoundingClientRect(),o=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft;return this._orgX<n.left+5+o&&(r=e(r).prevAll(":visible:first")[0]),a=i=r.cellIndex,t.gridInstance.model.groupSettings.groupedColumns.length&&(a=i-t.gridInstance.model.groupSettings.groupedColumns.length),a},_reSize:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C;if(this._initialTableWidth=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderTable().first().parent().width()+this.gridInstance.getHeaderTable().last().parent().width():this.gridInstance.getHeaderTable().parent().width(),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell=this._currentCell-1:this.gridInstance.model.enableRTL||this._getResizableCell(),r=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.getHeaderTable().find("thead"):e(this._target).parents("thead"),-1!=this._currentCell&&this._expand){this._expand=!1;var T=(e(this._target).hasClass("e-stackedHeaderCell")?r.find(".e-headercell:not(.e-detailheadercell)").filter(":visible"):r.find(".e-headercell:not(.e-detailheadercell,.e-stackedHeaderCell)").filter(":visible"))[this._currentCell],x=T.offsetWidth,v=i-this._orgX;if(this.gridInstance.model.enableRTL&&(v=-v),parseInt(v)+parseInt(x)>this._colMinWidth){if(0!=v&&r.css("cursor","default"),"nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&(n=this.gridInstance.getHeaderTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),n=this.gridInstance._$headerCols),o=n.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),l=parseInt(o[0].style.width)),this._resizeColumnUsingDiff(x,v),d=(a=this.gridInstance.element.find(".e-gridcontent").first()).find("div").hasClass("e-content"),(s=!t.isIOSWebView()&&this.gridInstance.getBrowserDetails())&&"msie"==s.browser&&this.gridInstance.model.allowScrolling&&(c=this.gridInstance.getContentTable().width(),u=this.gridInstance._calculateWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterTable().last().width(u-this.gridInstance.getFooterContent().find(".e-frozenfootertdiv").width()):u>c&&this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().width(u),parseInt(s.version,10)>8&&this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length&&(u>c?this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",2e3/a.find("table").first().width()+"%"):(this.gridInstance.getContentTable().css("width","100%"),this.gridInstance._groupingAction(!0),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",(this.gridInstance.getHeaderTable().find("colgroup").find("col").first().width()/a.find("table").first().width()*100).toFixed(2)+"%"))),this.gridInstance.getHeaderTable().parent().scrollLeft(a.find(".e-content").scrollLeft()-1)),this.gridInstance._colgroupRefresh(),this.gridInstance.model.allowTextWrap&&(this.gridInstance._isResized=!0,this.gridInstance.rowHeightRefresh()),this.gridInstance.model.groupSettings.groupedColumns.length&&!this.gridInstance.model.isEdit&&this.gridInstance._recalculateIndentWidth(),"normal"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model))if("nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)){p=this.gridInstance.getHeaderTable().find("colgroup").find("col"),h=this.gridInstance.getContentTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),p=this.gridInstance._$headerCols,h=this.gridInstance._$contentCols);var b,S=this._currentCell+1,D=p.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?S+this.gridInstance.model.groupSettings.groupedColumns.length:S);if((L=parseInt(D[0].style.width)+(l-parseInt(o[0].style.width)))<this._colMinWidth&&(L=this._colMinWidth),D.width(L),this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var R=this.gridInstance.getContentTable().find(".e-recordtable"),y=R.find("colgroup"),I=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(y=y.not(R.find(".e-detailrow").find("colgroup")).get()),w=0;w<y.length;w++)(g=e(y[w]).find("col").filter(this._diaplayFinder)).length>I&&g.splice(0,g.length-I),e(g[S]).width(L)}if(this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(S>=0&&S<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+v>this.gridInstance.element.find(".e-headercontent").first().width())return;b=h.filter(this._diaplayFinder).eq(S)}else b=h.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?S+this.gridInstance.model.groupSettings.groupedColumns.length:S);if(b.width(L),this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings.frozenColumns>0&&e(T).is(":last-child")&&"ejGrid"==this.gridInstance.pluginName){var k=o.width()-l,M=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+k,E=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-k,H=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+k;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(M),this.gridInstance.getContent().find(".e-frozencontentdiv").width(M),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(M),this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(E),this.gridInstance.getContent().find(".e-movablecontentdiv").width(E),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooterdiv").width(E),this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",H),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",H),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",H)}if(this.gridInstance.model.scrollSettings.frozenColumns>0&&e(T).is(":last-child")&&"ejTreeGrid"==this.gridInstance.pluginName){k=o.width()-l,M=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+k,E=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-k,H=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+k;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(M),this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",H),this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(E),this.gridInstance.getContent().find(".e-frozencontainer").width(M).next().css("margin-left",H+"px"),this.gridInstance.getContent().find(".e-movablecontent").width(E),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(M),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",H+"px")),this.gridInstance._renderScroller(!0)}this.gridInstance.model.scrollSettings.frozenColumns>0&&e(this._target).parent("tr").parents("div:first").hasClass("e-frozenheaderdiv")&&"ejGrid"==this.gridInstance.pluginName&&(this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(this._newWidth),this.gridInstance.getContent().find(".e-frozencontentdiv").width(this._newWidth),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(this._newWidth))}else this.gridInstance.model.scrollSettings.frozenColumns||(m=this.gridInstance.getHeaderTable().width(),"ejTreeGrid"==this.gridInstance.pluginName||this.gridInstance.model.allowScrolling||this.gridInstance.model.isResponsive?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().css("width",m+parseInt(v)):e("#"+this.gridInstance._id).css("width",m+parseInt(v)),this.gridInstance.model.scrollSettings.width+=parseInt(v),this.gridInstance.getContent().width()>this.gridInstance.getContentTable().width()?(this.gridInstance.getContentTable().addClass("e-tableLastCell"),this.gridInstance.getHeaderTable().addClass("e-tableLastCell")):(this.gridInstance.getContentTable().removeClass("e-tableLastCell"),this.gridInstance.getHeaderTable().removeClass("e-tableLastCell")));if("msie"==s.browser||!s||!this.gridInstance.model.allowScrolling||0!=this.gridInstance.model.scrollSettings.frozenColumns||("fixed"!=this.gridInstance.model.columnLayout&&(this.gridInstance.getHeaderTable().width("100%"),this.gridInstance.getContentTable().width("100%")),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width("100%"),((_=this.gridInstance._calculateWidth())<=this.gridInstance.getContentTable().width()||this.gridInstance.getHeaderTable().width()>this.gridInstance.getContentTable().width())&&this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width(_)),this.gridInstance.model.allowResizing&&"default"==this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")){var P=this._currentCell,F=e(this._target),O=[],G=[],L=x+v,N={};if(this.gridInstance.model.showStackedHeader&&F.hasClass("e-stackedHeaderCell")){var W,A=F.parent(".e-stackedHeaderRow").index(),z=F.text(),j=this.gridInstance.model.stackedHeaderRows[A].stackedHeaderColumns;for(w=0;w<j.length;w++)j[w].headerText==z&&(W=j[w].column);for(f=W|[],t.isNullOrUndefined(W)||W instanceof Array||(f=W.split(",")),w=0;w<f.length;w++)C=this.gridInstance.getColumnIndexByField(f[w]),O.push(C),G.push(this.gridInstance.model.columns[C]);N={columnIndex:O,column:G,oldWidth:x,newWidth:L}}else N={columnIndex:P,column:this.gridInstance.model.columns[P],oldWidth:x,newWidth:L};this.gridInstance._trigger("resized",N)}this.gridInstance.model.allowScrolling&&(this.gridInstance.getScrollObject().refresh(this.gridInstance.model.scrollSettings.frozenColumns>0),this.gridInstance.model.isResponsive&&this.gridInstance.model.minWidth&&this.gridInstance.windowonresize(),!d&&a.find("div").hasClass("e-content")&&this.gridInstance.refreshScrollerEvent(),this.gridInstance._isHscrollcss())}}this._target=null,this._$visualElement.remove(),this._expand=!1,this._currentCell=-1,this._allowStart=!1},_getFrozenResizeWidth:function(){for(var e=this.gridInstance.getHeaderTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),t=0,i=0;i<e.length;i++)"none"!=e.eq(i).css("display")&&(t+=parseInt(e[i].style.width.replace("px","")));return t},_diaplayFinder:function(){return"none"!=e(this).css("display")},_resizeColumnUsingDiff:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w;this._currntCe=this._currentCell,this._widthchanges(i,a);var C,T,x=this._newWidth,v=this._extra,b=this._$headerCols,S=this._$ContentCols,D=this._$headerCol;this._$frozenCols;if(("ejTreeGrid"!=this.gridInstance.pluginName||!(a>0)||t.isNullOrUndefined(this.gridInstance._currentCell)||1!=this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen||!((w=this.gridInstance._frozenWidth())>this.gridInstance._gridWidth-68))&&x>0&&0!=a){if(x<this._colMinWidth&&(x=this._colMinWidth),"nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&(r=D.next(),(n=!(!this.gridInstance.model.scrollSettings.frozenColumns||this._currentCell!=this.gridInstance.model.scrollSettings.frozenColumns-1))&&(r=b.eq(this.gridInstance.model.scrollSettings.frozenColumns)),(n||!D.is(":last-child"))&&r.width()+(D.width()-x)<=this._colMinWidth&&(x=D.width()+(r.width()-this._colMinWidth))),a=x-i,this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(this._currentCell>=0&&this._currentCell<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+a>this.gridInstance.element.find(".e-headercontent").first().width())return;C=S.filter(this._diaplayFinder).eq(this._currentCell)}else C=S.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell);if(e(this._target).parent("tr").hasClass("e-stackedHeaderRow")?this._resizeStackedHeaderColumn(e(this._target).parent("tr"),v,this._currntCe):D.outerWidth(x),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable()))if(this._$footerCols=this.gridInstance.getFooterTable().find("colgroup").find("col"),k=this.gridInstance.model.columns.length,this._$footerCols.length>k&&this._$footerCols.splice(0,this._$footerCols.length-k),T=(o=this._$footerCols).filter(this._diaplayFinder).eq(this._currentCell),e(this._target).parent("tr").hasClass("e-stackedHeaderRow"))for(u=0;u<this._changedcell.length;u++)T=o.filter(this._diaplayFinder).eq(u),(w=parseInt(v)+parseInt(o[u].style.width))<this._colMinWidth&&(w=this._colMinWidth),T.outerWidth(w);else T.outerWidth(x);if(e(this._target).parent("tr").hasClass("e-stackedHeaderRow")){if(this.gridInstance.model.groupSettings.groupedColumns.length)for(y=(R=this.gridInstance.getContentTable().find(".e-recordtable")).find("colgroup"),u=0;u<this._changedcell.length;u++)for(I=this._changedcell[u],l=0;l<y.length;l++)d=e(y[l]).children().filter(this._diaplayFinder),(w=parseInt(v)+parseInt(d[I].style.width))<this._colMinWidth&&(w=this._colMinWidth),e(d[I]).width(w);for(this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).length,u=0;u<this._changedcell.length;u++)s=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder)[this._changedcell[u]],(w=parseInt(v)+parseInt(s.style.width))<this._colMinWidth&&(w=this._colMinWidth),e(s).outerWidth(w),this.gridInstance.model.isEdit&&this.gridInstance.model.allowGrouping&&0==this.gridInstance.model.groupSettings.groupedColumns.length&&(c=this.gridInstance.getContentTable().find(".gridform").find("colgroup col").filter(this._diaplayFinder)[this._changedcell[u]],e(c).outerWidth(w))}else{if(this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var R,y=(R=this.gridInstance.getContentTable().find(".e-recordtable")).find("colgroup"),I=this._currentCell,k=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(y=y.not(R.find(".e-detailrow").find("colgroup")).get()),u=0;u<y.length;u++)(p=e(y[u]).find("col").filter(this._diaplayFinder)).length>k&&p.splice(0,p.length-k),e(p[I]).width(x)}C.outerWidth(x),this.gridInstance.model.isEdit&&(g=(h=this.gridInstance.getContentTable().find(".e-editedrow,.e-addedrow")).find("table").find("colgroup col"),m=h.hasClass("e-addedrow")&&this.gridInstance.model.groupSettings.groupedColumns.length?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length-1:this._currentCell,g.filter(this._diaplayFinder).eq(m).outerWidth(x))}if(this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns&&"nextcolumn"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&"ejGrid"==this.gridInstance.pluginName){for(_=this.gridInstance.getContentTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings.frozenColumns),w=0,u=0;u<_.length;u++)w+="none"==_[u].style.display?0:parseInt(_[u].style.width.replace("px",""));this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w),f=this.gridInstance.model.enableRTL?"margin-right":"margin-left",this.gridInstance.getContent().find(".e-frozencontentdiv").width(w).next().css(f,w+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w).next().css(f,w+"px"),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(w)}"ejTreeGrid"==this.gridInstance.pluginName&&(!t.isNullOrUndefined(this.gridInstance._currentCell)&&1==this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen&&"nextcolumn"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model)||!this.gridInstance._isFrozenStackedResize&&this.gridInstance._isStackedResize&&this.gridInstance._frozenColumnsLength>0)&&(w=this.gridInstance._frozenWidth(),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w),this.gridInstance.getContent().find(".e-frozencontainer").width(w).next().css("margin-left",w+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w).next().css("margin-left",w+"px"),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(w),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",w+"px")),this.gridInstance._findColumnsWidth(),this.gridInstance._renderScroller(!0)),this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor","default")}},_resizeStackedHeaderColumn:function(t,i,a){var r,n,o,l,d;this._changedcell=[];var s=0,c=0,u=this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell")[a],p=e(u).attr("colspan"),h=e(u).parent("tr"),g=(h.next(),u.cellIndex);for(this.gridInstance.model.groupSettings.showGroupedColumn&&(s+=c=this.gridInstance.model.groupSettings.groupedColumns.length);g>c;)g--,r=e(h).children("th").not(".e-detailheadercell")[g],s+=parseInt(e(r).attr("colspan"));for(this._currentCell=s,n=s+parseInt(p),o=s;o<n;o++)l=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder)[o],this._changedcell.push(o-c),(d=parseInt(i)+parseInt(l.style.width))<this._colMinWidth&&(d=this._colMinWidth),e(l).outerWidth(d)},_triggerResizeEvents:function(i,a){var r,n,o,l,d,s,c,u,p=this.gridInstance.getHeaderTable().find(".e-columnheader"),h=p.find(".e-headercell").filter(":visible"),g=this._cellIndex,m=e(this._target),_=[],f=[];if("resizeStart"==i&&(this._orgX=a,g=this._cellIndex=this._getCellIndex(this,a)),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?r=this._currentCell-1:(this.gridInstance.model.enableRTL||this._getResizableCell(),r=this._currentCell),o=(n=h[r]).offsetWidth,this.gridInstance.model.showStackedHeader&&m.hasClass("e-stackedHeaderCell")){var w,C=m.parent(".e-stackedHeaderRow").index(),T=m.text(),x=this.gridInstance.model.stackedHeaderRows[C].stackedHeaderColumns;for(d=0;d<x.length;d++)x[d].headerText==T&&(w=x[d].column);for(l=w|[],t.isNullOrUndefined(w)||w instanceof Array||(l=w.split(",")),d=0;d<l.length;d++)s=this.gridInstance.getColumnIndexByField(l[d]),_.push(s),f.push(this.gridInstance.model.columns[s])}return"resizeStart"==i?(u={},u=this.gridInstance.model.showStackedHeader&&m.hasClass("e-stackedHeaderCell")?{columnIndex:_,column:f,target:m,oldWidth:o}:{columnIndex:g,column:this.gridInstance.model.columns[g],target:e(n),oldWidth:o},this.gridInstance._trigger("resizeStart",u)):(p.find(".e-headercell").not(".e-detailheadercell").filter(":visible"),c=a-this._orgX,this._widthchanges(o,c),this.gridInstance._colgroupRefresh(),u={},u=this.gridInstance.model.showStackedHeader&&m.hasClass("e-stackedHeaderCell")?{columnIndex:_,column:f,target:e(n),oldWidth:o,newWidth:this._newWidth,extra:c}:{columnIndex:g,column:this.gridInstance.model.columns[g],target:e(n),oldWidth:o,newWidth:this._newWidth,extra:c},this.gridInstance._trigger("resizeEnd",u))},_widthchanges:function(i,a){var r=this._$headerCols=this.gridInstance.getHeaderTable().find("colgroup").find("col");this._$ContentCols=this.gridInstance.getContentTable().find("colgroup").find("col");t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),r=this._$headerCols=this.gridInstance._$headerCols,this._$ContentCols=this.gridInstance._$contentCols);var n=this._$headerCol=r.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),o=(this._$frozenCols=r.slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),n[0].style.width),l=-1!=o.indexOf("%"),d=!o||l?e(this._target).outerWidth():o,s=l?1:i/parseInt(d);this._extra=a/s,this._newWidth=parseInt(a)+parseInt(d)},_mouseUp:function(e){var i,a;if(this.gridInstance._resizeTimeOut&&(clearTimeout(this.gridInstance._resizeTimeOut),this.gridInstance._resizeTimeOut=0),this._expand){if(i=e.clientX,a=e.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(i=e.pageX,a=e.pageY),"touchend"==e.type&&(i=e.originalEvent.changedTouches[0].clientX,a=e.originalEvent.changedTouches[0].clientY),this.gridInstance.model.allowResizing&&(this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||"touchend"==e.type)&&this._triggerResizeEvents("resizeEnd",i))return void this.gridInstance.element.find(".e-reSizeColbg").remove();if(i+=document.documentElement.scrollLeft,this._reSize(i,a),!t.isNullOrUndefined(this._currntCe)&&this._currntCe>=0){var r=t.DataManager(this.gridInstance.model.columns).executeLocal((new t.Query).where("visible","equal",!0)),n=r[this._currntCe],o=this.gridInstance.model.columns.indexOf(n);r.length!=this.gridInstance.model.columns.length?this.gridInstance.model.columns[o].width=this.gridInstance.columnsWidthCollection[o]:this.gridInstance.model.columns[this._currntCe].width=this.gridInstance.columnsWidthCollection[this._currntCe]}}},_getResizableCell:function(){var t,i,a,r,n,o,l,d=this.gridInstance.model.scrollSettings.frozenColumns;if(n=(t=e(this._target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderTable().find(".e-columnheader"):this.gridInstance.getHeaderTable().find(".e-columnheader").not(".e-stackedHeaderRow")).find(".e-headercell").not(".e-hide,.e-detailheadercell"),i=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft,d&&-1!=this._currentCell&&this._currentCell==d-1&&(a=n[this._currentCell].getBoundingClientRect().left+i+5>this._orgX),!d||this._currentCell!=d-1||a)for(r=e(this._target).closest(".e-columnheader").index(),t=e(this._target).hasClass("e-stackedHeaderCell")?t[r]:t,n=e(t).find(".e-headercell").not(".e-hide,.e-detailheadercell"),o=0;o<n.length;o++){if((l=n[o].getBoundingClientRect()).left+i+5>this._orgX&&n[o].offsetHeight+l.top>=this._orgY)return void(this._currentCell=o-1);if(o==n.length-1||this.gridInstance.model.showStackedHeader&&e(this._target).get(0)===n[o])return void(this._currentCell=o)}},_moveVisual:function(e){var t=this.gridInstance.getHeaderContent().find("div").first()[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<e||e<t.left+document.documentElement.scrollLeft?this._$visualElement.remove():-1!=this._currentCell&&this._$visualElement.css({left:e,top:this._tableY})},_mouseDown:function(t){var i,a;return!this._allowStart||!e(t.target).closest("tr").hasClass("e-resizedragicon")||(this._target=t.target,i=t.clientX,a=t.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(i=t.pageX,a=t.pageY-(window.pageYOffset||document.body.scrollTop||0)),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")&&(e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),this._target=t.target,this._triggerResizeEvents("resizeStart",i))?void 0:(this,i+=document.documentElement.scrollLeft,2!=t.button&&this._start(i,a),!1))},_columnResizeToFit:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f=this.gridInstance.getHeaderTable().find(".e-columnheader").filter(function(){return"col-resize"==e(this).css("cursor")});if(this.gridInstance.model.allowResizeToFit&&f.length){e(i.target).is(".e-headercelldiv")&&(i.target=i.target.parentNode);var w,C=e(i.target),T=0,x=0;if(w=C.hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell"):this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-stackedHeaderCell,.e-detailheadercell"),this._target=C,C.hasClass("e-headercell")){var v=i.target,b=e.inArray(v,w),S=b;this._orgX=i.pageX,this.gridInstance.model.enableRTL?this._currentCell=b:this._getResizableCell(),b!=this._currentCell&&(b=S=this._currentCell,v=i.target.previousSibling);var D=w.filter(":visible")[S],R=[],y=[],I=[];if(x=this.gridInstance.model.groupSettings.groupedColumns.length,t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)&&t.isNullOrUndefined(this.gridInstance.model.childGrid)||(x+=1),e(v).parent("tr").hasClass("e-stackedHeaderRow")){var k=e(D).attr("colspan"),M=e(D).parent("tr"),E=D.cellIndex;for(M.next();E>x;)E--,a=e(M).children("th")[E],T+=parseInt(e(a).attr("colspan"));r=T+parseInt(k)}else T=S,r=S+1;var H=0,P=0,F=0,O=[],G=[];if(-1!=T)for(o={columnIndex:T+(n=w.slice(0,T+1).filter(".e-hide").length),column:this.gridInstance.model.columns[T+n],target:C,oldWidth:d},this.gridInstance._trigger("resizeStart",o),_=T;_<r;_++){if(n=w.slice(0,_+1).filter(".e-hide").length,F=this._getContentWidth(_+n),l=this.gridInstance.getHeaderTable().find(".e-headercell:not(.e-hide, .e-stackedHeaderCell)").children(".e-headercelldiv").eq(_),P=this._getHeaderContentWidth(l),H=P>F?P:F,H+=parseInt((l.css("padding-left"),10+(l.css("padding-right"),10))),d=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder).eq(_+x).width(),H=d>H?H:this._colMinWidth<H?H:this._colMinWidth,s=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&s.splice(0,1),s.eq(_+x).width(H),this.gridInstance.model.groupSettings.groupedColumns.length&&(c=this.gridInstance.getContentTable().find(".e-recordtable").find("colgroup"),u=this,e.each(c,function(t,i){e(i).find("col").filter(u._diaplayFinder).eq(_).width(H)})),p=this.gridInstance.getContentTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&p.splice(0,1),p.eq(_+x).width(H),this.gridInstance.model.isEdit)for(this.gridInstance.getContentTable().find(".e-editedrow").find("col"),h=this.gridInstance.element.find(".gridform"),g=0;g<h.length;g++)e(h[g]).find("col").eq(_+x).width(H);O.push(this.gridInstance.model.columns[_+n]),G.push(Math.abs(H-d)),R.push(_+n),y.push(H),I.push(d),(this.gridInstance.model.scrollSettings.frozenColumns>0||this.gridInstance.model.groupSettings.groupedColumns.length&&this.gridInstance.model.isEdit)&&(m=_+n,this.gridInstance.columnsWidthCollection[m]=H,this.gridInstance.setWidthToColumns(),this.gridInstance.model.scrollSettings.frozenColumns<=m+1&&(this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",H),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",H),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",H)))}for(this.gridInstance._colgroupRefresh(),this.gridInstance._recalculateIndentWidth(),o={columnIndex:R,column:O,target:D,oldWidth:I,newWidth:y,extra:G},this.gridInstance._trigger("resizeEnd",o),_=0;_<R.length;_++)this.gridInstance.columnsWidthCollection[R[_]]=y[_],this.gridInstance.model.columns[R[_]].width=y[_];o={columnIndex:R,column:O,target:D,oldWidth:I,newWidth:y,extra:G},this.gridInstance._trigger("resized",o),this.gridInstance.model.summaryRows.length>0&&this.gridInstance._summaryColRrefresh(),this.gridInstance._findColumnsWidth()}}},_getContentWidth:function(i){var a,r,n=0,o=t.buildTag("span",{},{}),l=this.gridInstance;return t.isNullOrUndefined(l._gridRows)||(r=l._gridRows,l.model.scrollSettings.frozenColumns&&l.model.currentViewData.length&&i>=l.model.scrollSettings.frozenColumns&&(r=r[1],i-=l.model.scrollSettings.frozenColumns),e.each(r,function(t,r){if(e(r).is(".e-row,.e-alt_row")&&!e(r).is(".e-editedrow")){var d=e(r).find("td.e-rowcell").eq(i),s=e(d).html();l.model.columns[i].commands?o.html(e(s).children()):d.hasClass("e-validError")?o.html(e(s).attr("value")):o.html(s),e(d).html(o),(a=d.find("span:first").width()>0?d.find("span:first").width()+parseFloat(d.css("padding-left"))+parseFloat(d.css("padding-right")):d.find("span:first").width())>n&&(n=a),e(d).html(s)}})),l._refreshUnboundTemplate(this.gridInstance.getContentTable()),n},_getHeaderContentWidth:function(e){var i,a,r=0,n=t.buildTag("span",{},{}),o="msie"==this.gridInstance.getBrowserDetails().browser;return o&&n.css("position","absolute"),i=e.html(),n.html(i),e.html(n),r=e.find("span:first").width()+parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right")),o&&(r+=2),this.gridInstance.model.allowFiltering&&("menu"==this.gridInstance.model.filterSettings.filterType||"excel"==this.gridInstance.model.filterSettings.filterType)&&(r=r+(a=e.parent().find(".e-filtericon")).width()+10,a.length&&(r+=parseFloat(a.css("margin-left")))),e.html(i),r}}}(jQuery,Syncfusion)})},1267:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(1012),l=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.ganttData=new ej.DataManager(e.getGanttData())}return e=a([n.Component({selector:"ej-app",template:i(1766),styles:[i(1018)],providers:[o.GanttDataService]}),r("design:paramtypes",[o.GanttDataService])],e)}();t.BaselineComponent=l},1268:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(1012),l=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.ganttData=new ej.DataManager(e.getGanttData())}return e=a([n.Component({selector:"ej-app",template:i(1767),styles:[i(1018)],providers:[o.GanttDataService]}),r("design:paramtypes",[o.GanttDataService])],e)}();t.DefaultComponent=l},1269:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(1012),l=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.ganttData=new ej.DataManager(e.getGanttData()),this.editsettings={allowAdding:!0,allowEditing:!0,allowIndent:!0,allowDeleting:!0,editMode:"cellEditing"},this.toolbar={showToolbar:!0,toolbarItems:["add","edit","delete","update","indent","outdent","cancel","expandAll","collapseAll"]}}return e=a([n.Component({selector:"ej-app",template:i(1768),styles:[i(1018)],providers:[o.GanttDataService]}),r("design:paramtypes",[o.GanttDataService])],e)}();t.EditingComponent=l},1270:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(1012),l=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.ganttData=new ej.DataManager(e.getGanttData()),this.holidays=[{day:"02/11/2017",background:"yellowgreen",label:"Holiday1"},{day:"02/19/2017",background:"yellowgreen",label:"Holiday2"}],this.striplines=[{day:"02/06/2017",label:"project Starts here",lineStyle:"dotted",lineWidth:"1",lineColor:"Darkblue"},{day:"03/06/2017",label:"project Ends here",lineStyle:"dotted",lineWidth:"1",lineColor:"Darkblue"}]}return e=a([n.Component({selector:"ej-app",template:i(1769),styles:[i(1018)],providers:[o.GanttDataService]}),r("design:paramtypes",[o.GanttDataService])],e)}();t.HolidaysComponent=l},1271:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(1012),l=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.ganttData=new ej.DataManager(e.getGanttData()),this.resourceData=e.getResourceData()}return e.prototype.load=function(){var e=$("#GanttControl").ejGantt("instance").getColumns();e[1].visible=e[2].visible=e[3].visible=e[6].visible=e[7].visible=!1,e[4].visible=e[5].visible=e[8].visible=e[9].visible=e[10].visible=!0},e=a([n.Component({selector:"ej-app",template:i(1770),styles:[i(1018)],providers:[o.GanttDataService]}),r("design:paramtypes",[o.GanttDataService])],e)}();t.ResourceComponent=l},1486:function(e,t,i){"use strict";var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0}),i(2037);var r=i(12),n=i(5),o=function(e){function t(t,i,a,r){var o=e.call(this,"Gantt",t,i,[],a,r)||this;return o.el=t,o.cdRef=i,o._ejIterableDiffers=a,o._ejkeyvaluediffers=r,o.dataSource_twoChange=new n.EventEmitter,o.selectedRowIndex_twoChange=new n.EventEmitter,o.splitterSettings_position_twoChange=new n.EventEmitter,o.actionBegin_output=new n.EventEmitter,o.actionComplete_output=new n.EventEmitter,o.beginEdit_output=new n.EventEmitter,o.cellSelected_output=new n.EventEmitter,o.cellSelecting_output=new n.EventEmitter,o.collapsed_output=new n.EventEmitter,o.collapsing_output=new n.EventEmitter,o.contextMenuOpen_output=new n.EventEmitter,o.create_output=new n.EventEmitter,o.endEdit_output=new n.EventEmitter,o.expanded_output=new n.EventEmitter,o.expanding_output=new n.EventEmitter,o.load_output=new n.EventEmitter,o.queryCellInfo_output=new n.EventEmitter,o.queryTaskbarInfo_output=new n.EventEmitter,o.rowDataBound_output=new n.EventEmitter,o.rowDrag_output=new n.EventEmitter,o.rowDragStart_output=new n.EventEmitter,o.rowDragStop_output=new n.EventEmitter,o.rowSelected_output=new n.EventEmitter,o.rowSelecting_output=new n.EventEmitter,o.splitterResized_output=new n.EventEmitter,o.taskbarClick_output=new n.EventEmitter,o.taskbarEdited_output=new n.EventEmitter,o.taskbarEditing_output=new n.EventEmitter,o.toolbarClick_output=new n.EventEmitter,o}return a(t,e),t.decorators=[{type:n.Component,args:[{selector:"ej-gantt",template:""}]}],t.ctorParameters=function(){return[{type:n.ElementRef},{type:n.ChangeDetectorRef},{type:n.IterableDiffers},{type:n.KeyValueDiffers}]},t.propDecorators={allowColumnResize_input:[{type:n.Input,args:["allowColumnResize"]}],allowDragAndDrop_input:[{type:n.Input,args:["allowDragAndDrop"]}],allowGanttChartEditing_input:[{type:n.Input,args:["allowGanttChartEditing"]}],allowKeyboardNavigation_input:[{type:n.Input,args:["allowKeyboardNavigation"]}],allowMultiSorting_input:[{type:n.Input,args:["allowMultiSorting"]}],allowMultipleExporting_input:[{type:n.Input,args:["allowMultipleExporting"]}],allowSelection_input:[{type:n.Input,args:["allowSelection"]}],allowSorting_input:[{type:n.Input,args:["allowSorting"]}],allowUnscheduledTask_input:[{type:n.Input,args:["allowUnscheduledTask"]}],baselineColor_input:[{type:n.Input,args:["baselineColor"]}],baselineEndDateMapping_input:[{type:n.Input,args:["baselineEndDateMapping"]}],baselineStartDateMapping_input:[{type:n.Input,args:["baselineStartDateMapping"]}],cellTooltipTemplate_input:[{type:n.Input,args:["cellTooltipTemplate"]}],childMapping_input:[{type:n.Input,args:["childMapping"]}],columnDialogFields_input:[{type:n.Input,args:["columnDialogFields"]}],connectorLineBackground_input:[{type:n.Input,args:["connectorLineBackground"]}],connectorlineWidth_input:[{type:n.Input,args:["connectorlineWidth"]}],cssClass_input:[{type:n.Input,args:["cssClass"]}],dateFormat_input:[{type:n.Input,args:["dateFormat"]}],dayWorkingTime_input:[{type:n.Input,args:["dayWorkingTime"]}],dragTooltip_input:[{type:n.Input,args:["dragTooltip"]}],durationMapping_input:[{type:n.Input,args:["durationMapping"]}],durationUnit_input:[{type:n.Input,args:["durationUnit"]}],durationUnitMapping_input:[{type:n.Input,args:["durationUnitMapping"]}],editSettings_input:[{type:n.Input,args:["editSettings"]}],enableAltRow_input:[{type:n.Input,args:["enableAltRow"]}],enableCollapseAll_input:[{type:n.Input,args:["enableCollapseAll"]}],enableContextMenu_input:[{type:n.Input,args:["enableContextMenu"]}],enablePredecessorValidation_input:[{type:n.Input,args:["enablePredecessorValidation"]}],enableProgressBarResizing_input:[{type:n.Input,args:["enableProgressBarResizing"]}],enableResize_input:[{type:n.Input,args:["enableResize"]}],enableSerialNumber_input:[{type:n.Input,args:["enableSerialNumber"]}],enableTaskbarDragTooltip_input:[{type:n.Input,args:["enableTaskbarDragTooltip"]}],enableTaskbarTooltip_input:[{type:n.Input,args:["enableTaskbarTooltip"]}],enableVirtualization_input:[{type:n.Input,args:["enableVirtualization"]}],enableWBS_input:[{type:n.Input,args:["enableWBS"]}],enableWBSPredecessor_input:[{type:n.Input,args:["enableWBSPredecessor"]}],endDateMapping_input:[{type:n.Input,args:["endDateMapping"]}],expandStateMapping_input:[{type:n.Input,args:["expandStateMapping"]}],filterSettings_input:[{type:n.Input,args:["filterSettings"]}],groupCollection_input:[{type:n.Input,args:["groupCollection"]}],groupIdMapping_input:[{type:n.Input,args:["groupIdMapping"]}],groupNameMapping_input:[{type:n.Input,args:["groupNameMapping"]}],highlightNonWorkingTime_input:[{type:n.Input,args:["highlightNonWorkingTime"]}],highlightWeekends_input:[{type:n.Input,args:["highlightWeekends"]}],includeWeekend_input:[{type:n.Input,args:["includeWeekend"]}],isResponsive_input:[{type:n.Input,args:["isResponsive"]}],leftTaskLabelMapping_input:[{type:n.Input,args:["leftTaskLabelMapping"]}],leftTaskLabelTemplate_input:[{type:n.Input,args:["leftTaskLabelTemplate"]}],locale_input:[{type:n.Input,args:["locale"]}],milestoneMapping_input:[{type:n.Input,args:["milestoneMapping"]}],milestoneTemplate_input:[{type:n.Input,args:["milestoneTemplate"]}],nonWorkingBackground_input:[{type:n.Input,args:["nonWorkingBackground"]}],notesMapping_input:[{type:n.Input,args:["notesMapping"]}],parentProgressbarBackground_input:[{type:n.Input,args:["parentProgressbarBackground"]}],parentTaskIdMapping_input:[{type:n.Input,args:["parentTaskIdMapping"]}],parentTaskbarBackground_input:[{type:n.Input,args:["parentTaskbarBackground"]}],parentTaskbarTemplate_input:[{type:n.Input,args:["parentTaskbarTemplate"]}],predecessorMapping_input:[{type:n.Input,args:["predecessorMapping"]}],predecessorTooltipTemplate_input:[{type:n.Input,args:["predecessorTooltipTemplate"]}],progressMapping_input:[{type:n.Input,args:["progressMapping"]}],progressbarBackground_input:[{type:n.Input,args:["progressbarBackground"]}],progressbarHeight_input:[{type:n.Input,args:["progressbarHeight"]}],progressbarTooltipTemplate_input:[{type:n.Input,args:["progressbarTooltipTemplate"]}],progressbarTooltipTemplateId_input:[{type:n.Input,args:["progressbarTooltipTemplateId"]}],query_input:[{type:n.Input,args:["query"]}],readOnly_input:[{type:n.Input,args:["readOnly"]}],renderBaseline_input:[{type:n.Input,args:["renderBaseline"]}],resourceCollectionMapping_input:[{type:n.Input,args:["resourceCollectionMapping"]}],resourceIdMapping_input:[{type:n.Input,args:["resourceIdMapping"]}],resourceInfoMapping_input:[{type:n.Input,args:["resourceInfoMapping"]}],resourceNameMapping_input:[{type:n.Input,args:["resourceNameMapping"]}],resourceUnitMapping_input:[{type:n.Input,args:["resourceUnitMapping"]}],resources_input:[{type:n.Input,args:["resources"]}],rightTaskLabelMapping_input:[{type:n.Input,args:["rightTaskLabelMapping"]}],rightTaskLabelTemplate_input:[{type:n.Input,args:["rightTaskLabelTemplate"]}],roundOffDayworkingTime_input:[{type:n.Input,args:["roundOffDayworkingTime"]}],rowHeight_input:[{type:n.Input,args:["rowHeight"]}],scheduleEndDate_input:[{type:n.Input,args:["scheduleEndDate"]}],scheduleHeaderSettings_input:[{type:n.Input,args:["scheduleHeaderSettings"]}],scheduleStartDate_input:[{type:n.Input,args:["scheduleStartDate"]}],selectionType_input:[{type:n.Input,args:["selectionType"]}],selectionMode_input:[{type:n.Input,args:["selectionMode"]}],showColumnChooser_input:[{type:n.Input,args:["showColumnChooser"]}],showColumnOptions_input:[{type:n.Input,args:["showColumnOptions"]}],showGridCellTooltip_input:[{type:n.Input,args:["showGridCellTooltip"]}],showGridExpandCellTooltip_input:[{type:n.Input,args:["showGridExpandCellTooltip"]}],showProgressStatus_input:[{type:n.Input,args:["showProgressStatus"]}],showResourceNames_input:[{type:n.Input,args:["showResourceNames"]}],showTaskNames_input:[{type:n.Input,args:["showTaskNames"]}],sizeSettings_input:[{type:n.Input,args:["sizeSettings"]}],sortSettings_input:[{type:n.Input,args:["sortSettings"]}],splitterPosition_input:[{type:n.Input,args:["splitterPosition"]}],splitterSettings_input:[{type:n.Input,args:["splitterSettings"]}],startDateMapping_input:[{type:n.Input,args:["startDateMapping"]}],taskCollectionMapping_input:[{type:n.Input,args:["taskCollectionMapping"]}],taskIdMapping_input:[{type:n.Input,args:["taskIdMapping"]}],taskNameMapping_input:[{type:n.Input,args:["taskNameMapping"]}],taskSchedulingMode_input:[{type:n.Input,args:["taskSchedulingMode"]}],taskSchedulingModeMapping_input:[{type:n.Input,args:["taskSchedulingModeMapping"]}],taskType_input:[{type:n.Input,args:["taskType"]}],taskbarBackground_input:[{type:n.Input,args:["taskbarBackground"]}],taskbarEditingTooltipTemplate_input:[{type:n.Input,args:["taskbarEditingTooltipTemplate"]}],taskbarEditingTooltipTemplateId_input:[{type:n.Input,args:["taskbarEditingTooltipTemplateId"]}],taskbarHeight_input:[{type:n.Input,args:["taskbarHeight"]}],taskbarTemplate_input:[{type:n.Input,args:["taskbarTemplate"]}],taskbarTooltipTemplate_input:[{type:n.Input,args:["taskbarTooltipTemplate"]}],taskbarTooltipTemplateId_input:[{type:n.Input,args:["taskbarTooltipTemplateId"]}],toolbarSettings_input:[{type:n.Input,args:["toolbarSettings"]}],treeColumnIndex_input:[{type:n.Input,args:["treeColumnIndex"]}],validateManualTasksOnLinking_input:[{type:n.Input,args:["validateManualTasksOnLinking"]}],viewType_input:[{type:n.Input,args:["viewType"]}],weekendBackground_input:[{type:n.Input,args:["weekendBackground"]}],workMapping_input:[{type:n.Input,args:["workMapping"]}],workUnit_input:[{type:n.Input,args:["workUnit"]}],workWeek_input:[{type:n.Input,args:["workWeek"]}],workingTimeScale_input:[{type:n.Input,args:["workingTimeScale"]}],dragTooltip_showTooltip_input:[{type:n.Input,args:["dragTooltip.showTooltip"]}],dragTooltip_tooltipItems_input:[{type:n.Input,args:["dragTooltip.tooltipItems"]}],dragTooltip_tooltipTemplate_input:[{type:n.Input,args:["dragTooltip.tooltipTemplate"]}],editSettings_allowAdding_input:[{type:n.Input,args:["editSettings.allowAdding"]}],editSettings_allowDeleting_input:[{type:n.Input,args:["editSettings.allowDeleting"]}],editSettings_allowEditing_input:[{type:n.Input,args:["editSettings.allowEditing"]}],editSettings_allowIndent_input:[{type:n.Input,args:["editSettings.allowIndent"]}],editSettings_beginEditAction_input:[{type:n.Input,args:["editSettings.beginEditAction"]}],editSettings_editMode_input:[{type:n.Input,args:["editSettings.editMode"]}],editSettings_rowPosition_input:[{type:n.Input,args:["editSettings.rowPosition"]}],editSettings_showDeleteConfirmDialog_input:[{type:n.Input,args:["editSettings.showDeleteConfirmDialog"]}],scheduleHeaderSettings_dayHeaderFormat_input:[{type:n.Input,args:["scheduleHeaderSettings.dayHeaderFormat"]}],scheduleHeaderSettings_hourHeaderFormat_input:[{type:n.Input,args:["scheduleHeaderSettings.hourHeaderFormat"]}],scheduleHeaderSettings_minutesPerInterval_input:[{type:n.Input,args:["scheduleHeaderSettings.minutesPerInterval"]}],scheduleHeaderSettings_monthHeaderFormat_input:[{type:n.Input,args:["scheduleHeaderSettings.monthHeaderFormat"]}],scheduleHeaderSettings_scheduleHeaderType_input:[{type:n.Input,args:["scheduleHeaderSettings.scheduleHeaderType"]}],scheduleHeaderSettings_timescaleStartDateMode_input:[{type:n.Input,args:["scheduleHeaderSettings.timescaleStartDateMode"]}],scheduleHeaderSettings_weekendBackground_input:[{type:n.Input,args:["scheduleHeaderSettings.weekendBackground"]}],scheduleHeaderSettings_weekHeaderFormat_input:[{type:n.Input,args:["scheduleHeaderSettings.weekHeaderFormat"]}],scheduleHeaderSettings_yearHeaderFormat_input:[{type:n.Input,args:["scheduleHeaderSettings.yearHeaderFormat"]}],scheduleHeaderSettings_timescaleUnitSize_input:[{type:n.Input,args:["scheduleHeaderSettings.timescaleUnitSize"]}],scheduleHeaderSettings_weekStartDay_input:[{type:n.Input,args:["scheduleHeaderSettings.weekStartDay"]}],scheduleHeaderSettings_updateTimescaleView_input:[{type:n.Input,args:["scheduleHeaderSettings.updateTimescaleView"]}],sizeSettings_height_input:[{type:n.Input,args:["sizeSettings.height"]}],sizeSettings_width_input:[{type:n.Input,args:["sizeSettings.width"]}],splitterSettings_index_input:[{type:n.Input,args:["splitterSettings.index"]}],toolbarSettings_showToolbar_input:[{type:n.Input,args:["toolbarSettings.showToolbar"]}],toolbarSettings_toolbarItems_input:[{type:n.Input,args:["toolbarSettings.toolbarItems"]}],addDialogFields_input:[{type:n.Input,args:["addDialogFields"]}],editDialogFields_input:[{type:n.Input,args:["editDialogFields"]}],holidays_input:[{type:n.Input,args:["holidays"]}],selectedCellIndexes_input:[{type:n.Input,args:["selectedCellIndexes"]}],stripLines_input:[{type:n.Input,args:["stripLines"]}],filterSettings_filteredColumns_input:[{type:n.Input,args:["filterSettings.filteredColumns"]}],sortSettings_sortedColumns_input:[{type:n.Input,args:["sortSettings.sortedColumns"]}],toolbarSettings_customToolbarItems_input:[{type:n.Input,args:["toolbarSettings.customToolbarItems"]}],options:[{type:n.Input,args:["options"]}],dataSource_two:[{type:n.Input,args:["dataSource"]}],dataSource_twoChange:[{type:n.Output,args:["dataSourceChange"]}],selectedRowIndex_two:[{type:n.Input,args:["selectedRowIndex"]}],selectedRowIndex_twoChange:[{type:n.Output,args:["selectedRowIndexChange"]}],splitterSettings_position_two:[{type:n.Input,args:["splitterSettings.position"]}],splitterSettings_position_twoChange:[{type:n.Output,args:["splitterSettings.positionChange"]}],actionBegin_output:[{type:n.Output,args:["actionBegin"]}],actionComplete_output:[{type:n.Output,args:["actionComplete"]}],beginEdit_output:[{type:n.Output,args:["beginEdit"]}],cellSelected_output:[{type:n.Output,args:["cellSelected"]}],cellSelecting_output:[{type:n.Output,args:["cellSelecting"]}],collapsed_output:[{type:n.Output,args:["collapsed"]}],collapsing_output:[{type:n.Output,args:["collapsing"]}],contextMenuOpen_output:[{type:n.Output,args:["contextMenuOpen"]}],create_output:[{type:n.Output,args:["create"]}],endEdit_output:[{type:n.Output,args:["endEdit"]}],expanded_output:[{type:n.Output,args:["expanded"]}],expanding_output:[{type:n.Output,args:["expanding"]}],load_output:[{type:n.Output,args:["load"]}],queryCellInfo_output:[{type:n.Output,args:["queryCellInfo"]}],queryTaskbarInfo_output:[{type:n.Output,args:["queryTaskbarInfo"]}],rowDataBound_output:[{type:n.Output,args:["rowDataBound"]}],rowDrag_output:[{type:n.Output,args:["rowDrag"]}],rowDragStart_output:[{type:n.Output,args:["rowDragStart"]}],rowDragStop_output:[{type:n.Output,args:["rowDragStop"]}],rowSelected_output:[{type:n.Output,args:["rowSelected"]}],rowSelecting_output:[{type:n.Output,args:["rowSelecting"]}],splitterResized_output:[{type:n.Output,args:["splitterResized"]}],taskbarClick_output:[{type:n.Output,args:["taskbarClick"]}],taskbarEdited_output:[{type:n.Output,args:["taskbarEdited"]}],taskbarEditing_output:[{type:n.Output,args:["taskbarEditing"]}],toolbarClick_output:[{type:n.Output,args:["toolbarClick"]}]},t}(r.EJComponents);t.GanttComponent=o,t.EJ_GANTT_COMPONENTS=[o]},1766:function(e,t){e.exports='<ej-gantt id="GanttControl" [dataSource]="ganttData" taskIdMapping="taskID" taskNameMapping="taskName"\r\n            startDateMapping="startDate" \r\n            endDateMapping="endDate" \r\n            progressMapping="progress"\r\n             durationMapping="duration"\r\n              predecessorMapping="predecessor"\r\n            childMapping="subtasks" \r\n            [renderBaseline]="true" \r\n            baselineStartDateMapping="baselinestartDate"\r\n             baselineEndDateMapping="baselineendDate" \r\n             [treeColumnIndex]=treeColumnIndex  \r\n             scheduleStartDate="02/01/2017" \r\n             scheduleEndDate="04/09/2017"\r\n            sizeSettings.height="450px" \r\n            sizeSettings.width="100%">\r\n</ej-gantt>'},1767:function(e,t){e.exports='<ej-gantt id="GanttControl" [dataSource]="ganttData" taskIdMapping="taskID" taskNameMapping="taskName"\r\n            startDateMapping="startDate" endDateMapping="endDate" progressMapping="progress" durationMapping="duration" predecessorMapping="predecessor"\r\n            childMapping="subtasks" [treeColumnIndex]=treeColumnIndex  scheduleStartDate="02/01/2017" scheduleEndDate="04/09/2017"\r\n            sizeSettings.height="450px" sizeSettings.width="100%">\r\n</ej-gantt>'},1768:function(e,t){e.exports='<ej-gantt id="GanttControl" [dataSource]="ganttData" taskIdMapping="taskID" taskNameMapping="taskName"\r\n            startDateMapping="startDate" endDateMapping="endDate" progressMapping="progress" durationMapping="duration" predecessorMapping="predecessor"\r\n            childMapping="subtasks" [editSettings]="editsettings" [toolbarSettings]="toolbar" [treeColumnIndex]=treeColumnIndex  scheduleStartDate="02/01/2017" scheduleEndDate="04/09/2017"\r\n            sizeSettings.height="450px" sizeSettings.width="100%">\r\n</ej-gantt>'},1769:function(e,t){e.exports='<ej-gantt id="GanttControl" [dataSource]="ganttData" taskIdMapping="taskID" taskNameMapping="taskName"\r\n            startDateMapping="startDate" endDateMapping="endDate" progressMapping="progress" durationMapping="duration" predecessorMapping="predecessor"\r\n            childMapping="subtasks" [treeColumnIndex]=treeColumnIndex  scheduleStartDate="02/01/2017" scheduleEndDate="04/09/2017"\r\n            sizeSettings.height="450px" sizeSettings.width="100%" [holidays]="holidays" [stripLines]="striplines">\r\n</ej-gantt>'},1770:function(e,t){e.exports='<ej-gantt id="GanttControl" [dataSource]="ganttData" taskIdMapping="taskID" taskNameMapping="taskName"\r\n            startDateMapping="startDate" endDateMapping="endDate" progressMapping="progress" durationMapping="duration" predecessorMapping="predecessor"\r\n            childMapping="subtasks" [treeColumnIndex]=treeColumnIndex  scheduleStartDate="02/01/2017" scheduleEndDate="04/09/2017"\r\n            sizeSettings.height="450px" sizeSettings.width="100%" resourceInfoMapping= "resourceId"\r\n                resourceNameMapping= "resourceName"\r\n                resourceIdMapping= "resourceId"\r\n                [resources]= "resourceData" (load)="load()">\r\n</ej-gantt>\r\n'},2037:function(e,t,i){var a,r,n;
/*!
*  filename: ej.gantt.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.gantt.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(o){r=[i(1042),i(15),i(94),i(4),i(65),i(21),i(38),i(16),i(47),i(123),i(55),i(95),i(223),i(31),i(92),i(93),i(224),i(79),i(80),i(155),i(417)],void 0===(n="function"==typeof(a=o)?a.apply(t,r):a)||(e.exports=n)}(function(){(function(e,t,i){"use strict";t.ganttFeatures=t.ganttFeatures||{},t.ganttFeatures.predecessor={UpdatePredecessor:function(){var e=this;e._updatedRecordsDateByPredecessor(),e._$ganttchartHelper.ejGanttChart("clearConnectorLines"),e._connectorLinesCollection=[],e._createConnectorLinesCollection(),e._$ganttchartHelper.ejGanttChart("renderConnectorLines",e._connectorLinesCollection)},_refreshConnectorLines:function(e,i,a){"resourceView"!=this.model.viewType&&(this._isValidationEnabled=!t.isNullOrUndefined(e)&&e,i&&this._$ganttchartHelper.ejGanttChart("clearConnectorLines"),this._connectorlineIds=[],this._connectorLinesCollection=[],this._createConnectorLinesCollection(),a&&1==this.isCriticalPathEnable&&this._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId))},_ensurePredecessorCollection:function(){for(var e,t,i,a,r=this,n=r.model,o=r._predecessorsCollection,l=o.length-1;l>=0;l--)(t=(e=o[l]).predecessorsName)&&t.length&&(e.predecessor=e._calculatePredecessor(t,r._durationUnitEditText,n.durationUnit,r),r._isValidPredecessorString||(i=r._getPredecessorStringValue(e),e.predecessorsName=i,e.item.predecessor=i,r._isValidPredecessorString=!0),"resourceView"==n.viewType&&((a={}).predecessor=e.predecessor,a.predecessorsName=e.predecessorsName,this._updateSharedResourceTask(e,a)))},_createConnectorLinesCollection:function(e){var t,i,a,r=this,n=this.model,o=n.currentViewData.length,l=(r._predecessorsCollection.length,n.enableVirtualization);if(n.enableVirtualization&&"Load"===e)for(o=n.updatedRecords.length,t=0;t<o;t++)(i=(a=n.updatedRecords[t]).predecessor)&&(a,r._addPredecessorsCollection(a,i));else for(t=0;t<o;t++)a=n.currentViewData[t],(!1!==l||!1!==a.isExpanded)&&-1!==n.currentViewData.indexOf(a)&&((i=a.predecessor)&&(a,r._addPredecessorsCollection(a,i)));r._$ganttchartHelper&&r._$ganttchartHelper.ejGanttChart("renderConnectorLines",r._connectorLinesCollection)},_addPredecessorsCollection:function(t,i){var a,r,n,o,l,d,s,c=this,u=c.model,p={},h=u.updatedRecords;if(i){for(a=i.length,r=0;r<a;r++)n=i[r],o=this._getRecordByTaskId(n.from),l=this._getRecordByTaskId(n.to),!u.enableVirtualization&&(o&&!1===o.isExpanded||l&&!1===l.isExpanded)||c._isValidationEnabled&&!c._isInExpandCollapse&&l&&c._validatePredecessorDates(l);if(!c._enableCreateCollection)return;for(d=0,e.each(i,function(e,i){return i.to===t.taskId.toString()&&d++,d}),r=0;r<a;r++)n=i[r],d>1&&(n.isdrawn=!1),o=this._getRecordByTaskId(n.from),l=this._getRecordByTaskId(n.to),-1!==h.indexOf(o)&&-1!=h.indexOf(l)&&(u.enableVirtualization||!1!==o.isExpanded&&!1!==l.isExpanded)&&o&&l&&((p=c._createConnectorLineObject(o,l,n))&&(c._connectorlineIds.length>0&&-1==c._connectorlineIds.indexOf(p.ConnectorLineId)?(c._connectorLinesCollection.push(p),c._connectorlineIds.push(p.ConnectorLineId)):0==c._connectorlineIds.length?(c._connectorLinesCollection.push(p),c._connectorlineIds.push(p.ConnectorLineId)):-1!=c._connectorlineIds.indexOf(p.ConnectorLineId)&&(s=c._connectorlineIds.indexOf(p.ConnectorLineId),c._connectorLinesCollection[s]=p),n.isdrawn=!0))}},_createConnectorLineObject:function(i,a,r){var n,o,l,d={},s=this,c=s.model,u=c.updatedRecords,p=u.indexOf(i),h=u.indexOf(a),g=0,m=0;if(-1!==p&&-1!==h){if(!c.enableVirtualization)if(n=0,h>p){for(g=0;g<p;g++)!1===u[g].isExpanded&&++n;for(m=p,p-=n;m<h;m++)!1===u[m].isExpanded&&++n;h-=n}else if(p>h){for(g=0;g<h;g++)!1===u[g].isExpanded&&++n;for(m=h,h-=n;m<p;m++)!1===u[m].isExpanded&&++n;p-=n}return o=e("#ejGanttChart"+s._id).ejGanttChart("instance"),l="msie"==t.browserInfo().name&&t.browserInfo().version<9?c.rowHeight:e("#"+o._$ganttViewTablebody[0].id).find("tr:first")[0].getBoundingClientRect().height,-1!=p&&-1!=h?(d.ParentLeft=i.isMilestone?i.left-s._milesStoneWidth/2:i.left,d.ChildLeft=a.isMilestone?a.left-s._milesStoneWidth/2:a.left,d.ParentWidth=0==i.width||i.isMilestone?Math.floor(1.2*s._milesStoneWidth):i.width,d.ChildWidth=0==a.width||a.isMilestone?Math.floor(1.2*s._milesStoneWidth):a.width,d.ParentIndex=p,d.ChildIndex=h,d.RowHeight=l,d.Type=r.predecessorsType,d.ConnectorLineId="parent"+i.taskId+"child"+a.taskId,d.milestoneParent=!!i.isMilestone,d.milestoneChild=!!a.isMilestone,t.isNullOrUndefined(i._isScheduledTask())||t.isNullOrUndefined(a._isScheduledTask())?null:d):void 0}},_updateDateByOffset:function(e,t,i,a){var r,n=t.offset,o=t.offsetDurationUnit;return n<0?r=this._getStartDate(this._checkEndDate(e,a),-1*n,o,a):(r=this._getEndDate(e,n,o,a,!1),i||(r=this._checkStartDate(r,a))),r},_validateChildGanttRecord:function(e,i,a,r){var n=this,o=n.model;if(!(n._editedTaskBarItem===i||t.isNullOrUndefined(e._isScheduledTask())||t.isNullOrUndefined(i._isScheduledTask())||"resourceView"==o.viewType&&n._editedTaskBarItem&&n._editedTaskBarItem.taskId==i.taskId)){if(r&&(i.isAutoSchedule||o.validateManualTasksOnLinking))switch(a.predecessorsType){case"SS":case"SF":c=i.taskId.toString(),u=(s=i.predecessor).filter(function(e){return e.to===c});var l=n._getPredecessorDate(i,u,a.predecessorsType);i.startDate=l,i._calculateEndDate(this),i.left=i._calculateLeft(this),i.width=i._calculateWidth(this),i.progressWidth=i._getProgressWidth(i.width,i.status);break;case"FS":s=i.predecessor,c=i.taskId.toString(),u=s&&s.filter(function(e){return e.to===c});var d=n._getPredecessorDate(i,u,a.predecessorsType);i.startDate=d,i._calculateEndDate(this),i.left=i._calculateLeft(this),i.width=i._calculateWidth(this),i.progressWidth=i._getProgressWidth(i.width,i.status);break;case"FF":var s,c=i.taskId.toString(),u=(s=i.predecessor)&&s.filter(function(e){return e.to===c});i.startDate=n._getPredecessorDate(i,u,a.predecessorsType),i._calculateEndDate(this),i.left=i._calculateLeft(this),i.width=i._calculateWidth(this),i.progressWidth=i._getProgressWidth(i.width,i.status)}this._updateItemValueInRecord(i),"resourceView"==o.viewType?(n._updateSharedResourceTask(i),i.parentItem&&n._updateOverlappingValues(i.parentItem,!0),n._updateResourceParentItem(i)):i.parentItem&&i.parentItem.isAutoSchedule&&r?n._updateParentItem(i):i.parentItem&&!i.parentItem.isAutoSchedule&&r&&n._updateManualParentItem(i),(n._isTreeGridRendered||n._isGanttChartRendered)&&("resourceView"==o.viewType&&"resourceChildTask"==i.eResourceTaskType?n.refreshGanttRecord(i.parentItem,i):n.refreshGanttRecord(i))}},_getValidatedStartDate:function(e,t,i){var a,r,n=i.predecessorsType,o=i.offset;switch(t=this._updateToScheduledValue(t,!0),e=this._updateToScheduledValue(e),n){case"FS":a=this._getValidEndDate(t),e.isMilestone&&0==o||(a=this._checkStartDate(a,e)),0!=o&&(a=this._updateDateByOffset(a,i,e.isMilestone,e)),r=e.isMilestone?new Date(a):this._checkStartDate(a,e);break;case"FF":a=this._getValidEndDate(t),0!=o&&(a=this._updateDateByOffset(a,i,e.isMilestone,e)),e.isMilestone||(a=this._checkEndDate(a,e)),r=this._getStartDate(a,e.duration,e.durationUnit,e);break;case"SF":a=this._getValidStartDate(t),0!=o&&(a=this._updateDateByOffset(a,i,e.isMilestone,e)),e.isMilestone||(a=this._checkEndDate(a,e)),r=this._getStartDate(a,e.duration,e.durationUnit,e);break;case"SS":a=this._getValidStartDate(t),0!=o&&(a=this._updateDateByOffset(a,i,e.isMilestone,e)),r=e.isMilestone?a:this._checkStartDate(a,e)}return r},_getPredecessorDate:function(e,t){this.model;var i,a,r,n,o,l,d=null,s=t.filter(function(t){if(t.to===e.taskId.toString())return!0});if(s)for(i=s.length,a=0;a<i;a++)l=s[a],n=this._getRecordByTaskId(l.from),o=this._getRecordByTaskId(l.to),r=this._getValidatedStartDate(o,n,l),null==d?d=r:1==this._compareDates(r,d)&&(d=r);return d},_removeConnectorLine:function(e,t){this.model;var i,a,r,n=0,o=e&&e.length,l=-1;for(n=0;n<o;n++)a=this._getRecordByTaskId(e[n].from),r=this._getRecordByTaskId(e[n].to),t.taskId.toString()===e[n].to.toString()&&((l=a.predecessor.indexOf(e[n]))>=0&&a.predecessor.splice(l,1),this._updateResourcePredecessor(a)),a&&r&&(i="parent"+a.taskId+"child"+r.taskId,this._$ganttchartHelper.ejGanttChart("removeConnectorline",i),this._updateConnectorLineCollection(i))},_addConnectorLine:function(e){var t,i,a,r=0,n=(this.model,e.predecessor);if(n)for(t=n.length,r=0;r<t;r++)(i=n[r]).to===e.taskId.toString()&&(a=this._getRecordByTaskId(i.from)),a&&(a.predecessor?a.predecessor.push(i):(a.predecessor=[],a.predecessor.push(i),this._predecessorsCollection.push(a)),this._updateResourcePredecessor(a))},_updatedRecordsDateByPredecessor:function(){var e,t,i,a=this.model;for(t=(e="resourceView"==a.viewType?this._resourceUniqTasks:a.flatRecords).length,i=0;i<t;i++)e[i].predecessor&&e[i].item[a.predecessorMapping]&&this._validatePredecessorDates(e[i])},_validatePredecessorDates:function(e){var t=this.model;if(e.predecessor){for(var i,a,r=e.predecessor,n=null,o=e.taskId.toString(),l=r.filter(function(e){return e.to===o}),d=r.filter(function(e){return e.from===o}),s=l.length,c=0;c<s;c++)a=l[c],i=this._getRecordByTaskId(a.from),((n=this._getRecordByTaskId(a.to)).isAutoSchedule||t.validateManualTasksOnLinking)&&this._validateChildGanttRecord(i,n,a,t.enablePredecessorValidation);d.length}},_validatePredecessor:function(e,t,a){var r,n,o=this,l=o.model,d="resourceView"==l.viewType;if(e.predecessor){for(var s,c,u,p,h=e.predecessor,g=null,m=!1,_=e.taskId.toString(),f=h.filter(function(e){return e.to===_}),w=h.filter(function(e){return e.from===_}),C=f.length,T=0;T<C;T++)u=f[T],m=o._isOffsetChange(u,t,T),s=o._getRecordByTaskId(u.from),g=o._getRecordByTaskId(u.to),d||(c="parent"+s.taskId+"child"+g.taskId,o._$ganttchartHelper&&(o._$ganttchartHelper.ejGanttChart("removeConnectorline",c),this._updateConnectorLineCollection(c))),o._isValidationEnabled=!(!l.enablePredecessorValidation||!g.isAutoSchedule&&!l.validateManualTasksOnLinking),e.taskId.toString()!==u.to&&e.taskId.toString()!==u.from||a&&"predecessor"!=a||o._validateChildGanttRecord(s,g,u,l.enablePredecessorValidation,m);if(!d)for(T=0;T<C;T++)u=f[T],s=o._getRecordByTaskId(u.from),g=o._getRecordByTaskId(u.to),(!1!==l.enableVirtualization||!1!==s.isExpanded&&0!=g.isExpanded)&&((p=o._createConnectorLineObject(s,g,u))&&(o._connectorlineIds.length>0&&-1==o._connectorlineIds.indexOf(p.ConnectorLineId)?(o._updatedConnectorLineCollection.push(p),o._connectorlineIds.push(p.ConnectorLineId)):0==o._connectorlineIds.length?(o._updatedConnectorLineCollection.push(p),o._connectorlineIds.push(p.ConnectorLineId)):-1!=o._connectorlineIds.indexOf(p.ConnectorLineId)&&(n=o._connectorlineIds.indexOf(p.ConnectorLineId),o._updatedConnectorLineCollection[n]=p)));for(r=w.length,T=0;T<r;T++)u=w[T],s=o._getRecordByTaskId(u.from),g=o._getRecordByTaskId(u.to),m=o._isOffsetChange(u,t,T),o._isValidationEnabled=!(!l.enablePredecessorValidation||!g.isAutoSchedule&&!l.validateManualTasksOnLinking),d||(c="parent"+s.taskId+"child"+g.taskId,o._$ganttchartHelper&&(o._$ganttchartHelper.ejGanttChart("removeConnectorline",c),this._updateConnectorLineCollection(c))),"predecessor"!=a&&o._isValidationEnabled&&o._validateChildGanttRecord(s,g,u,l.enablePredecessorValidation,m),!1!==l.enableVirtualization||!1!==s.isExpanded&&0!=g.isExpanded?(d||(p=o._createConnectorLineObject(s,g,u))&&(o._connectorlineIds.length>0&&-1==o._connectorlineIds.indexOf(p.ConnectorLineId)?(o._updatedConnectorLineCollection.push(p),o._connectorlineIds.push(p.ConnectorLineId)):0==o._connectorlineIds.length?(o._updatedConnectorLineCollection.push(p),o._connectorlineIds.push(p.ConnectorLineId)):-1!=o._connectorlineIds.indexOf(p.ConnectorLineId)&&(n=o._connectorlineIds.indexOf(p.ConnectorLineId),o._updatedConnectorLineCollection[n]=p)),g&&o._validatePredecessor(g,i,"successor")):g&&o._validatePredecessor(g,i,"successor")}},_updateConnectorLineCollection:function(e){var t,i,a,r;if("string"==typeof e){for(t=0;t<this._connectorLinesCollection.length;t++)if(this._connectorLinesCollection[t].ConnectorLineId==e){this._connectorLinesCollection.splice(t,1);break}}else for(t=0;t<e.length;t++){for(a=0,r=0;r<this._connectorLinesCollection.length;r++)if(this._connectorLinesCollection[r].ConnectorLineId==e[t].ConnectorLineId){i=e[t],a=t;break}i?this._connectorLinesCollection[a]=i:this._connectorLinesCollection.push(e[t])}},_isOffsetChange:function(e,i,a){var r=!1;if(!this.model.enablePredecessorValidation)if(i&&i.length){var n=e.offset?parseInt(e.offset):0,o=i[a];r=n!=(o.offset?parseInt(o.offset):0)}else r=!t.isNullOrUndefined(i);return r},createWBSPredecessor:function(){var e,t,i,a,r,n=this.model;if(n.enableWBS&&n.enableWBSPredecessor&&n.predecessorMapping)for(e=n.flatRecords.filter(function(e){return e&&e.predecessor}),t=0;t<e.length;t++){var o=e[t],l=o.predecessor,d=null;for(i=0;i<l.length;i++)a=+l[i].from,r=n.flatRecords.filter(function(e){return e&&e.taskId==a})[0].WBS+l[i].predecessorsType,d=d?d+","+r:r;o.WBSPredecessor=d,o.item.WBSPredecessor=d}},calculateSerialNumberPredecessor:function(){var e,t,i,a,r,n,o,l,d=this,s=d.model;if(s.enableSerialNumber&&s.predecessorMapping)for(t=(e=d._predecessorsCollection).length,i=0;i<t;i++){var c=e[i],u=c.predecessor,p=null;for(a=0;a<u.length;a++)r=+u[a].from,o=(n=s.flatRecords.filter(function(e){return e&&e.taskId==r})).length&&n[0].serialNumber+u[a].predecessorsType,0!=u[a].offset&&(o+=u[a].offset>0?"+"+u[a].offset+" ":u[a].offset+" ",l=1!=Math.abs(u[a].offset),o+="day"==u[a].offsetDurationUnit?l?d._durationUnitTexts.days:d._durationUnitTexts.day:"hour"==u[a].offsetDurationUnit?l?d._durationUnitTexts.hours:d._durationUnitTexts.hour:l?d._durationUnitTexts.minutes:d._durationUnitTexts.minute),p=p?p+","+o:o;c.serialNumberPredecessor=p,c.item.serialNumberPredecessor=p}},_getRecordByTaskId:function(e){return"resourceView"==this.model.viewType?this._resourceUniqTasks[this._resourceUniqTaskIds.indexOf(e)]:this.model.flatRecords[this.model.ids.indexOf(e)]},_updatePredecessors:function(){for(var e,t,i,a,r,n=0,o=this._predecessorsCollection,l=o.length,d=0;n<l;n++)for(a=(t=(e=o[n]).predecessor).length,d=0;d<a;d++)r=t[d],i=this._getRecordByTaskId(r.from),r.from!==e.taskId.toString()&&i&&(i.predecessor?i.predecessor.push(r):(i.predecessor=[],i.predecessor.push(r),o.push(i)),this._updateResourcePredecessor(i))},_updateConnectorlineWidth:function(e){var t=this;this.model.connectorlineWidth=e,t._$ganttchartHelper.ejGanttChart("updateConnectorlineWidth",e),t._$ganttchartHelper.ejGanttChart("clearConnectorLines"),t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_updateConnectorLineBackground:function(e){var t=this;this.model.connectorLineBackground=e,t._$ganttchartHelper.ejGanttChart("updateConnectorLineBackground",e),t._$ganttchartHelper.ejGanttChart("clearConnectorLines"),t._$ganttchartHelper.ejGanttChart("renderConnectorLines",t._connectorLinesCollection)},_validateAddRecordPrecessorValue:function(e){var t,i=e.data,a=this.model;return!(a.predecessorMapping&&i[a.predecessorMapping]&&i[a.predecessorMapping].length>0)||((t={}).currentRecord=e.currentRecord,t.predecessorString=i[a.predecessorMapping].split(","),!!this._editedPredecessorValidation(t)||(i[a.predecessorMapping]="",e.currentRecord.predecessor=null,e.currentRecord.predecessorsName="",!1))},_recordIdFromSerialnumber:function(e){return this.model.flatRecords.filter(function(t){return t&&t.serialNumber==e})[0].taskId},_editedPredecessorValidation:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m=this,_=this.model,f=i.currentRecord.taskId,w=i.predecessorString.join(",");if(w.length>0)for(n=m.model.enableSerialNumber&&a?m._idFromSerialPredecessor(w):m._idFromPredecessor(w),o=0;o<n.length;o++){if(l=i.currentRecord,"projectView"==_.viewType){if(l&&l.parentItem&&-1!==n.indexOf(l.parentItem.taskId.toString()))return!1;for(d=0;d<n.length;d++)if((s=m.model.flatRecords.filter(function(e){return e&&e.taskId==n[d]}))[0]&&s[0].hasChildRecords)return!1}var C=n.slice(0),T=[],x=!0;if(e.each(C,function(e,t){-1===T.indexOf(t)?T.push(t):x=!1}),!1===x)return!1;for(r=n[o],c=[],n.slice(0).splice(o,1);null!==r&&(u=[],-1===c.indexOf(r));){if(h=m._getRecordByTaskId(r.toString()),t.isNullOrUndefined(h)||(!t.isNullOrUndefined(h.predecessor)&&h.predecessor.length>0&&e.each(h.predecessor,function(e,t){h.taskId.toString()!==t.from&&(u.push(t.from.toString()),p=e)}),f.toString()===h.taskId.toString()||-1!==u.indexOf(f.toString())))return!1;if(c.push(r),t.isNullOrUndefined(h.predecessor)||!(h.predecessor.length>0))break;if(u.length>1?g=this._predecessorValidation(u,i):1==u.length&&(r=h.predecessor[p].from),!1===g)return!1}}return!0},_predecessorValidation:function(i,a){for(var r,n,o,l,d=a.currentRecord.taskId,s=0;s<i.length;s++)for(o=i[s],r=[],i.slice(0).splice(s,1);null!==o&&(n=[],-1===r.indexOf(o));){if(l=this._recordReturnerByID(o),t.isNullOrUndefined(l)||(!t.isNullOrUndefined(l.predecessor)&&l.predecessor.length>0&&e.each(l.predecessor,function(e,t){l.taskId.toString()!==t.from&&n.push(t.from.toString())}),d.toString()===l.taskId.toString()||-1!==n.indexOf(d.toString())))return!1;if(r.push(o),t.isNullOrUndefined(l.predecessor)||!(l.predecessor.length>0))break;o=l.predecessor[0].from}return!0},_validationDialogTemplate:function(){var i=this,a=(i.model,t.buildTag("div","",{},{"data-unselectable":"on"})),r=t.buildTag("form","",{height:"100%",width:"100%","font-size":"14px"},{id:i._id+"ValidationRuleForm"}),n=t.buildTag("div.e-validationHeader","",{padding:"10px"},{id:i._id+"_ValidationText"}),o=t.buildTag("div.e-ValidationContent","",{},{}),l="<table style='outline:none;border-spacing:2px;border-collapse:separate;padding:10px'><tr style='line-height:1.4'><td class='e-editLabel'><input type='radio' id='"+i._id+"_ValidationCancel' name='ValidationRule' checked='checked'/><label for='"+i._id+"_ValidationCancel' style='padding-left:10px;font-weight:normal;' id= '"+i._id+"_cancelLink'>"+i._validationRuleOptions.cancel+"</label></td></tr><tr style='line-height:1.4'><td class='e-editLabel'><input type='radio' id='"+i._id+"_ValidationRemoveline' name='ValidationRule'/><label for='"+i._id+"_ValidationRemoveline' style='padding-left:10px;font-weight:normal;' id='"+i._id+"_removeLink'>"+i._validationRuleOptions.removeLink+"</label></td></tr><tr style='line-height:1.4'><td class='e-editLabel'>{{if additionalButton}}<input type='radio' id='"+i._id+"_ValidationAddlineOffset' name='ValidationRule'/><label for='"+i._id+"_ValidationAddlineOffset' style='padding-left:10px;font-weight:normal;' id='"+i._id+"_preserveLink'>"+i._validationRuleOptions.preserveLink+"</label>{{/if}}</td></tr>  </table>";o.append(e(l)),r.append(n).append(o),a=i._renderValidationDialogButton(r,a),e.templates(i._id+"_ValidationRuleTemplate",a.html())},_renderValidationDialogButton:function(e,i){var a="ValidationRuleDialog_",r=this,n=r.model,o=t.buildTag("input","",{"border-radius":"3px","min-width":"100px","max-width":"300px",float:"right"},{type:"button",id:a+r._id+"_validationOk"}),l=r._okButtonText,d=r._cancelButtonText,s=t.buildTag("input","",{"border-radius":"3px","min-width":"100px","max-width":"300px",float:"right","margin-left":"10px"},{type:"button",id:a+r._id+"_validationCancel"}),c=t.buildTag("div","",{},{class:"e-gantt-validation-btn"});return o.ejButton({cssClass:n.cssClass,text:l,minwidth:"auto"}),s.ejButton({cssClass:n.cssClass,text:d,width:"auto"}),c.append(s).append(o),e.appendTo(i),c.appendTo(i),i},_validateTypes:function(i){var a,r,n,o,l,d,s,c,u=this,p=u.model,h=i.data,g=0,m=[],_={},f=[],w=u._$ganttchartHelper.ejGanttChart("taskbarEditedArguments");if("dialogEdit"==i.editMode){var C,T="#treegrid"+u._id+"predecessorEdit",x=[],v=[],b=u._predecessorCollectionText;if(e(T).length>0){for(e(T).ejTreeGrid("model.isEdit")&&e(T).ejTreeGrid("saveCell"),C=e(T).ejTreeGrid("option","dataSource"),d=0;d<C.length;d++){for((r={}).from=p.enableSerialNumber?u._recordIdFromSerialnumber(C[d].id):C[d].id,r.to=h.taskId.toString(),r.isdrawn=!1,r.offset=C[d].offset,o=0;o<b.length;o++)if(C[d].type==b[o].text){r.predecessorsType=b[o].id,n=b[o].id;break}l=r.from+n,C[d].offset=parseFloat(C[d].offset),0!==C[d].offset&&(l+=C[d].offset<0?r.offset.toString():"+"+r.offset.toString()),v.push(l)}v.length>0&&(x=h._calculatePredecessor(v.join(","),u._durationUnitEditText,u.model.durationUnit,u),t.isNullOrUndefined(h.predecessor)||h.predecessor.forEach(function(e){e.from==h.taskId.toString()&&x.push(e)}))}else x=h.predecessor}else x=h.predecessor;if(a=x&&x.length,u._editMode=i.editMode,i.cancel||t.isNullOrUndefined(x))return!0;for(d=0;d<a;d++)m=u._getRecordByTaskId(x[d].from),s=u._getPredecessorDate(h,x),"FS"==x[d].predecessorsType&&(x[d].to==h.taskId.toString()&&h.startDate<s&&h.startDate<m.endDate?(f[g]=x[d],g++,u._validationType=x[d].predecessorsType,_={parentTask:m,task:h,previousData:w.previousData,violationType:"taskBeforePredecessor",additionalButton:!1}):x[d].to==h.taskId.toString()&&h.startDate>s&&(f[g]=x[d],g++,u._validationType=x[d].predecessorsType,_={parentTask:m,task:h,previousData:w.previousData,violationType:"taskAfterPredecessor",additionalButton:!0}));return!!(t.isNullOrUndefined(_.violationType)||i.validateMode.removeLink&&i.validateMode.respectLink&&i.validateMode.preserveLinkWithEditing)||(u._validationPredecessor=f,0===e("#"+u._id+"_dialogValidationRule").length&&(c=t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none"},{id:u._id+"_dialogValidationRule"}),u.element.append(c),u._on(e("#"+u._id+"_dialogValidationRule"),"click keypress","#ValidationRuleDialog_"+u._id+"_validationOk ,#ValidationRuleDialog_"+u._id+"_validationCancel",{args:i},u._validationDialogButtonClick)),"dialogEdit"==i.editMode||"cellEdit"==i.editMode||"recordUpdate"==i.editMode?i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing?(i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing)&&u._validationDialogButtonClick(i):u._renderValidationDialog(_):"dragging"!=i.editMode||u.taskbarEdited(w)?u._$ganttchartHelper.ejGanttChart("taskbarEditedCancel",w):i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing?(i.validateMode.removeLink||i.validateMode.respectLink||i.validateMode.preserveLinkWithEditing)&&u._validationDialogButtonClick(i):u._renderValidationDialog(_),!1)},_validationDialogButtonClick:function(a){var r,n,o,l,d=this,s=d.model,c=null,u=d._$ganttchartHelper.ejGanttChart("taskbarEditedArguments");if(a.target.id=="ValidationRuleDialog_"+d._id+"_validationOk"||a.target.id=="ValidationRuleDialog_"+d._id+"_validationCancel"){if(r=a.data.args,c="dialog",0!=a.keyCode&&a.keyCode!==i&&13!=a.keyCode)return!0;"recordUpdate"==r.editMode&&(u.data=r.data)}else a.target.id==d._id+"_dialogValidationRule_closebutton"?c="dialog":(c="argument","recordUpdate"==(r=a).editMode&&(u.data=r.data));var p=t.isNullOrUndefined(u.data)?"projectView"==s.viewType?s.selectedItem:d._resourceEditedRecord:u.data,h=(p.predecessor,d._$treegridHelper.ejTreeGrid("instance")),g=u.previousData,m=d._endEditArgs;if("dialog"==c||r.validateMode&&(r.validateMode.removeLink||r.validateMode.respectLink||r.validateMode.preserveLinkWithEditing))if("dialog"==c&&a.target.id=="ValidationRuleDialog_"+d._id+"_validationOk"&&document.getElementById(d._id+"_ValidationCancel").checked||"dialog"==c&&(a.target.id=="ValidationRuleDialog_"+d._id+"_validationCancel"||a.target.id==d._id+"_dialogValidationRule_closebutton")||r.validateMode&&r.validateMode.respectLink){if("dragging"==d._editMode)p.startDate=g.startDate,s.startDateMapping&&(p.item[s.startDateMapping]=g.startDate),p.endDate=g.endDate,s.endDateMapping&&(p.item[s.endDateMapping]=g.endDate),p.left=p._calculateLeft(this),p.width=g.width,p.status=g.status,p.progressWidth=p._getProgressWidth(p.width,p.status),"resourceView"==s.viewType?(d._updateSharedResourceTask(p),p.parentItem&&d._updateOverlappingValues(p.parentItem,!0),d._updateResourceParentItem(p)):p.parentItem&&p.parentItem.isAutoSchedule?d._updateParentItem(p):p.parentItem&&!p.parentItem.isAutoSchedule&&d._updateManualParentItem(p),d._isLastRefresh=!1,d._connectorlineIds=[],d._updatedConnectorLineCollection=[],d._validatePredecessor(p),"resourceView"!=s.viewType&&d._updatedConnectorLineCollection.length>0&&(d._$ganttchartHelper.ejGanttChart("appendConnectorLine",d._updatedConnectorLineCollection),this._updateConnectorLineCollection(d._updatedConnectorLineCollection)),d._isLastRefresh=!0,"resourceView"==s.viewType&&"resourceChildTask"==p.eResourceTaskType?d.refreshGanttRecord(p.parentItem):d.refreshGanttRecord(p);else if("dialogEdit"==d._editMode)this._editedDialogRecord=p,d._sendSaveRequest("Edit")||(d._isAddEditDialogSave=!0);else if("cellEdit"==d._editMode)m.data[m.columnName]=m.previousValue,d._triggerEndEdit(m);else if("recordUpdate"==d._editMode){var _=r.actionCompleteArgs,f=_.modifiedRecord,w=_.previousItem[s.startDateMapping],C=_.previousItem[s.endDateMapping],T=_.previousItem[s.durationMapping];f.startDate=f.item[s.startDateMapping]=w,f.endDate=f.item[s.endDateMapping]=C,f.duration=f.item[s.durationMapping]=T,d.actionComplete(_)}"dialog"==c&&e("#"+d._id+"_dialogValidationRule").ejDialog("close")}else if("dialog"==c&&document.getElementById(d._id+"_ValidationRemoveline").checked||r.validateMode&&r.validateMode.removeLink){if(n={},"dragging"==d._editMode)n.ganttRecord=p,d._updatePredecessorValues(n),t.TreeGrid.refreshRow(h,s.updatedRecords.indexOf(p)),d._isLastRefresh=!0,"reourceView"==s.viewType&&"resourceChildTask"==p.eResourceTaskType?d.refreshGanttRecord(p.parentItem):d.refreshGanttRecord(p);else if("dialogEdit"==d._editMode){var x,v="#treegrid"+d._id+"predecessorEdit",b=e(v).ejTreeGrid("option","dataSource"),S=0;for(o=0;o<d._validationPredecessor.length;o++)d._validationPredecessor[o].predecessorsType==d._validationType&&(d._validationPredecessor[o].from==b[S].id?(x=b.indexOf(b[S]),b.splice(x,1)):(o--,S++));n.ganttRecord=this._editedDialogRecord,d._updatePredecessorValues(n),this._editedDialogRecord=n.ganttRecord,d._sendSaveRequest("Edit")||(d._isAddEditDialogSave=!0)}else"cellEdit"==d._editMode?(n.ganttRecord=p,d._updatePredecessorValues(n),m.data=n.ganttRecord,d._triggerEndEdit(m)):"recordUpdate"==d._editMode&&(l=r.actionCompleteArgs,n.ganttRecord=p,d._updatePredecessorValues(n),r.data=n.ganttRecord,d.actionComplete(l));"dialog"==c&&e("#"+d._id+"_dialogValidationRule").ejDialog("close")}else"dialog"==c&&document.getElementById(d._id+"_ValidationAddlineOffset").checked||r.validateMode&&r.validateMode.preserveLinkWithEditing?("dialogEdit"==d._editMode?d._sendSaveRequest("Edit")||(d._isAddEditDialogSave=!0):"cellEdit"==d._editMode?d._triggerEndEdit(m):"recordUpdate"==d._editMode&&(l=r.actionCompleteArgs,d.actionComplete(l)),"dialog"==c&&e("#"+d._id+"_dialogValidationRule").ejDialog("close")):"dialog"==c&&e("#"+d._id+"_dialogValidationRule").ejDialog("close");else"dialog"==c&&e("#"+d._id+"_dialogValidationRule").ejDialog("close")},_updatePredecessorValues:function(e){for(var t,i=this,a=(i.model,i._validationPredecessor),r=e.ganttRecord,n={},o=a.length,l=0;l<o;l++)if(a[l].predecessorsType==i._validationType){var d=i._getRecordByTaskId(a[l].from),s=i._getRecordByTaskId(a[l].to),c="parent"+d.taskId+"child"+s.taskId;i._$ganttchartHelper.ejGanttChart("removeConnectorline",c),0!=(t=i._predecessorsCollection.indexOf(r))&&i._predecessorsCollection.splice(t,1),n.parentGanttRecord=d,n.predecessor=a[l],n.data=r,n.validationType=i._validationType,i._updateRecordCollection(n)}},_updateRecordCollection:function(e){var t,i,a=e.data,r=e.parentGanttRecord,n=a.item[this.model.predecessorMapping].split(","),o=a.predecessor.indexOf(e.predecessor);a.predecessor.splice(o,1),this._updateResourcePredecessor(a),-1!=(t=n.indexOf(e.predecessor.from+"FS"))&&(n.splice(t,1),a.item[this.model.predecessorMapping]=n.join(","),a.predecessorsName=n.join(","),this._updateResourcePredecessor(a),i=r.predecessor.indexOf(e.predecessor),r.predecessor.splice(i,1),this._updateResourcePredecessor(r))},_renderValidationDialog:function(i){var a,r,n,o,l=this,d=l.model,s=document.createElement("div");e(s).addClass("e-ValidationRules"),s.innerHTML=e.render[l._id+"_ValidationRuleTemplate"](i),e("#"+l._id+"_dialogValidationRule").html(e(s)),(o={}).cssClass=d.cssClass,o.enableResize=!1,o.width="auto",o.height="auto",o.contentSelector="#"+l._id,o.allowKeyboardNavigation=!1,a=l._validationDialogTitle,o.title=a,o.enableModal=!0,o.allowDraggable=!0,o.isResponsive=!0,o.close=function(){e("#"+l._id+"EditAreaNotes").data("ejRTE")&&e("#"+l._id+"EditAreaNotes").ejRTE("destroy")},r=t.isNullOrUndefined(i.task.taskName)?"ID "+i.task.taskId:i.task.taskName,n=t.isNullOrUndefined(i.parentTask.taskName)?"ID "+i.parentTask.taskId:i.parentTask.taskName,document.getElementById(l._id+"_removeLink").innerHTML=String.format(l._validationRuleOptions.removeLink,r,t.format(i.task.startDate,d.dateFormat,d.locale)),document.getElementById(l._id+"_preserveLink")&&(document.getElementById(l._id+"_preserveLink").innerHTML=String.format(l._validationRuleOptions.preserveLink,r,t.format(i.task.startDate,d.dateFormat,d.locale))),document.getElementById(l._id+"_ValidationText").innerHTML=String.format(l._validationRuleText[i.violationType],r,n),e("#"+l._id+"_dialogValidationRule").ejDialog(o),e("#"+l._id+"_dialogValidationRule_wrapper").addClass("e-gantt-dialog"),e("#"+l._id+"_dialogValidationRule").ejDialog("open"),e("#"+l._id+"_dialogValidationRule_closebutton").click(function(e){l._validationDialogButtonClick(e)})},_removeChildRecordsPredecessor:function(e){var t,i;if(e.hasChildRecords)for(t=e.childRecords.length,i=0;i<t;i++)e.childRecords[i].predecessor&&this._removePredecessor(e.childRecords[i].predecessor,e.childRecords[i]),e.childRecords[i].hasChildRecords&&this._removeChildRecordsPredecessor(e.childRecords[i])},_validatePredecessorOnEditing:function(e,t){for(var i,a,r,n,o,l,d,s,c=this,u=c.model,p=e.taskId.toString(),h=(u=this.model,e.predecessor),g="resourceView"==u.viewType,m=h.filter(function(e){return e.to===p}),_=h.filter(function(e){return e.from===p}),f=m.length,w=0;w<f;w++)r=m[w],n=c._isOffsetChange(r,null,w),o=this._getRecordByTaskId(r.from),l=this._getRecordByTaskId(r.to),t&&(c._validateChildGanttRecord(o,l,r,u.enablePredecessorValidation,n),t=!1),g||(s="parent"+o.taskId+"child"+l.taskId,c._$ganttchartHelper&&(c._$ganttchartHelper.ejGanttChart("removeConnectorline",s),this._updateConnectorLineCollection(s)));if(!g)for(w=0;w<f;w++)r=m[w],o=this._getRecordByTaskId(r.from),l=this._getRecordByTaskId(r.to),(!1!==u.enableVirtualization||!1!==o.isExpanded&&0!=l.isExpanded)&&((d=c._createConnectorLineObject(o,l,r))&&(c._connectorlineIds.length>0&&-1==c._connectorlineIds.indexOf(d.ConnectorLineId)?(c._updatedConnectorLineCollection.push(d),c._connectorlineIds.push(d.ConnectorLineId)):0==c._connectorlineIds.length?(c._updatedConnectorLineCollection.push(d),c._connectorlineIds.push(d.ConnectorLineId)):-1!=c._connectorlineIds.indexOf(d.ConnectorLineId)&&(a=c._connectorlineIds.indexOf(d.ConnectorLineId),c._updatedConnectorLineCollection[a]=d)));for(i=_.length,w=0;w<i;w++)r=_[w],o=this._getRecordByTaskId(r.from),l=this._getRecordByTaskId(r.to),n=c._isOffsetChange(r,null,w),g||(s="parent"+o.taskId+"child"+l.taskId,c._$ganttchartHelper&&(c._$ganttchartHelper.ejGanttChart("removeConnectorline",s),this._updateConnectorLineCollection(s))),t&&(c._validateChildGanttRecord(o,l,r,u.enablePredecessorValidation,n),t=!1),(!1!==u.enableVirtualization||!1!==o.isExpanded&&0!=l.isExpanded)&&(g||(d=c._createConnectorLineObject(o,l,r))&&(c._connectorlineIds.length>0&&-1==c._connectorlineIds.indexOf(d.ConnectorLineId)?(c._updatedConnectorLineCollection.push(d),c._connectorlineIds.push(d.ConnectorLineId)):0==c._connectorlineIds.length?(c._updatedConnectorLineCollection.push(d),c._connectorlineIds.push(d.ConnectorLineId)):-1!=c._connectorlineIds.indexOf(d.ConnectorLineId)&&(a=c._connectorlineIds.indexOf(d.ConnectorLineId),c._updatedConnectorLineCollection[a]=d)))},_updatePredecessorValue:function(e,i){var a,r,n,o,l,d=this,s=this.model,c=0,u=[],p=0,h=t.isNullOrUndefined(e)?"row"==s.selectionMode?d.selectedItem():s.updatedRecords[d._rowIndexOfLastSelectedCell]:e;for(a=h.predecessor,i.length>0&&(r=h._calculatePredecessor(i,this._durationUnitEditText,this.model.durationUnit,d)),r&&(c=r.length),o=0,l=0,a&&(l=a.length),o=0;o<l;o++)(n=a[o]).from===h.taskId.toString()&&u.push(n);for(p=0;p<c;p++)u.push(r[p]);return h.predecessor=u,d.model.predecessorMapping&&(h.item[d.model.predecessorMapping]=i,h.predecessorsName=i),a},_updatePredecessorOnIndentOutdent:function(e){for(var t,i,a,r=this,n=e.predecessor.length,o=e.predecessor,l=r.model,d=0;d<n;d++){if(o[d].to===e.taskId.toString())t=(i=this._getRecordByTaskId(o[d].from)).predecessor.indexOf(o[d]),i.predecessor.splice(t,1),a="parent"+i.taskId+"child"+e.taskId;else if(o[d].from===e.taskId.toString()){i=this._getRecordByTaskId(o[d].to);r._predecessorToString(i.predecessor,i);var s=i.predecessorsName.split(","),c=o[d].from+o[d].predecessorsType,u=s.indexOf(c);s.splice(u,1),i.item[l.predecessorMapping]=s.join(","),i.predecessorsName=s.join(","),t=i.predecessor.indexOf(o[d]),i.predecessor.splice(t,1),l.enableWBS&&l.enableWBSPredecessor&&r._$treegridHelper.ejTreeGrid("updateWBSPredecessor",i),a="parent"+e.taskId+"child"+i.taskId,r._isLastRefresh=!1,r.refreshGanttRecord(i)}r._$ganttchartHelper.ejGanttChart("removeConnectorline",a),this._updateConnectorLineCollection(a)}e.predecessor=[],e.item[l.predecessorMapping]="",e.predecessorsName="",l.enableWBS&&l.enableWBSPredecessor&&(e.WBSPredecessor="",e.item.WBSPredecessor="")},_removePredecessor:function(t,i,a){for(var r,n,o,l,d,s=this,c=t.length,u=0,p=s.model,h=e.extend({},!0,t);u<c;u++){if(a){if(h[u].to!==i.taskId.toString())continue;r=s._getRecordByTaskId(h[u].from),n=s._getRecordByTaskId(h[u].to)}else t[u].from!==i.taskId.toString()?n=this._getRecordByTaskId(t[u].from):t[u].to!==i.taskId.toString()&&(n=this._getRecordByTaskId(t[u].to));n&&(-1!==(o=n.predecessor.indexOf(t[u]))&&n.predecessor.splice(o,1),n.item[p.predecessorMapping]&&(n.item[p.predecessorMapping]=s._predecessorToString(n.predecessor,n),n.predecessorsName=n.item[p.predecessorMapping],p.enableWBS&&p.enableWBSPredecessor&&s._$treegridHelper.ejTreeGrid("updateWBSPredecessor",n),p.enableSerialNumber&&s._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",n),this._updateResourcePredecessor(n),s.refreshGanttRecord(n))),a&&(l=r.predecessor.indexOf(t[u]),r.predecessor.splice(l,1),this._updateResourcePredecessor(r),d="parent"+r.taskId+"child"+n.taskId,s._$ganttchartHelper.ejGanttChart("removeConnectorline",d),s._updateConnectorLineCollection(d))}},_updateResourcePredecessor:function(e){if("resourceView"==this.model.viewType&&"resourceChildTask"==e.eResourceTaskType&&e.resourceInfo.length>0){var t={};t.predecessor=e.predecessor,t.predecessorsName=e.predecessorsName,this._updateSharedResourceTask(e,t)}},_predecessorToString:function(e,t){for(var i,a=[],r=0,n=e.length;r<n;r++)t.taskId.toString()!==e[r].from&&(i=e[r].from+e[r].predecessorsType,e[r].offset=isNaN(e[r].offset)?0:e[r].offset,0!==e[r].offset&&(e[r].offset<0?i+=e[r].offset.toString()+"d":e[r].offset>0&&(i+="+"+e[r].offset.toString()+"d")),a.push(i));return a.join(",")},showCriticalPath:function(e,t){var i,a,r,n,o,l,d,s,c,u,p,h,g,m=this,_=this.model.ids,f=this.model.flatRecords;if(m._$treegridHelper.ejTreeGrid("cancelEditCell"),1==e)if(this.isCriticalPathEnable=!0,0!=f.length){var w,C,T,x=[],v=[],b=[],S=[],D=[],R=[],y=[],I=this.model.flatRecords,k=this.model.parentRecords,M=[],E=0,H=0,P=[];for(T=this.model.parentRecords[0].endDate,this.model.parentRecords[0].manualEndDate>this.model.parentRecords[0].endDate&&!this.model.parentRecords[0].isAutoSchedule&&(T=this.model.parentRecords[0].manualEndDate),this.model.parentRecords[0].taskId,i=1;i<k.length;i++)k[i].endDate>=T&&(T=k[i].endDate,k[i].taskId),k[i].isAutoSchedule||k[i].manualEndDate>=T&&(T=k[i].manualEndDate,k[i].taskId);for(a=0;a<I.length;a++)I[a].isCritical=!1,E=m._getDuration(I[a].endDate,T,I[a].durationUnit,I[a].isAutoSchedule),I[a].slack=E+" "+I[a].durationUnit,I[a].endDate>=T&&D.push(I[a].taskId),I[a].predecessor&&0!=I[a].predecessor.length&&(x.push(I[a]),R.push(I[a].taskId));for(r=0;r<D.length;r++)-1==R.indexOf(D[r])?(f[H=_.indexOf(D[r].toString())].status<100&&(f[H].isCritical=!0),f[H].slack=0+f[H].durationUnit,y.push(D[r])):M.push(D[r]);for(n=x.length,o=[],l=0;l<n;l++){var F=-1,O=-1,G=-1,L=-1,N=l;for(w=x[l].predecessor.length,C=parseInt(x[l].taskId),d=0;d<w;d++)x[l].predecessor[d].from==C&&(-1==F?x[l].predecessor[d].offset?(F=x[l].predecessor[d].to+":"+x[l].predecessor[d].offset+x[l].predecessor[d].offsetDurationUnit,G=x[l].predecessor[d].predecessorsType):(F=x[l].predecessor[d].to,G=x[l].predecessor[d].predecessorsType):x[l].predecessor[d].offset?(F=F+","+x[l].predecessor[d].to+":"+x[l].predecessor[d].offset+x[l].predecessor[d].offsetDurationUnit,G=G+","+x[l].predecessor[d].predecessorsType):(F=F+","+x[l].predecessor[d].to,G=G+","+x[l].predecessor[d].predecessorsType)),x[l].predecessor[d].to==C&&(-1==O?x[l].predecessor[d].offset?(O=x[l].predecessor[d].from+":"+x[l].predecessor[d].offset+x[l].predecessor[d].offsetDurationUnit,L=x[l].predecessor[d].predecessorsType):(O=x[l].predecessor[d].from,L=x[l].predecessor[d].predecessorsType):x[l].predecessor[d].offset?(O=O+","+x[l].predecessor[d].from+":"+x[l].predecessor[d].offset+x[l].predecessor[d].offsetDurationUnit,L=L+","+x[l].predecessor[d].predecessorsType):(O=O+","+x[l].predecessor[d].from,L=L+","+x[l].predecessor[d].predecessorsType));-1==O&&(O=null,L=null),-1==F&&(F=null,G=null),v.push({from:O,fromPredecessor:L,taskid:C,to:F,toPredecessor:G,currentIndex:N,slack:null,ff:0,fs:0,enddate:null,fsslack:0}),b.push(parseInt(C))}for(s=v.length,c=0,p=0;p<s;p++)v[p].to||(u=v[p].taskid,c=_.indexOf(u.toString()),E=m._getDuration(f[c].endDate,T,"minute",f[c].isAutoSchedule),v[p].slack=E,v[p].fs=-1,v[p].enddate=f[c].endDate,o.push({fromdata:v[p].from,todateID:v[p].taskid,fromDataPredecessor:v[p].fromPredecessor}));for(h=0;h<o.length;h++)P.push(o[h]),m._slackCalculation(P,v,b,T,f,_);S=m._finalCriticalPath(v,y,f,_),this.criticalPathCollection=S,this.detailPredecessorCollection=v,this.collectionTaskId=b,t?t&&this._$ganttchartHelper.ejGanttChart("criticalDataMapping",S,e,v,b):(this._$ganttchartHelper.ejGanttChart("criticalDataMapping",S,e,v,b),this._$ganttchartHelper.ejGanttChart("criticalPathColor",S,e,v,b),m._$treegridHelper.ejTreeGrid("refresh")),m._enableDisableCriticalIcon=!0}else{S=[],v=[],b=[];t?t&&this._$ganttchartHelper.ejGanttChart("criticalDataMapping",S,e,v,b):(this._$ganttchartHelper.ejGanttChart("criticalDataMapping",S,e,v,b),this._$ganttchartHelper.ejGanttChart("criticalPathColor",S,e,v,b),this._$treegridHelper.ejTreeGrid("refresh")),m._enableDisableCriticalIcon=!0}if(0==e){S=[],v=[],b=[];for(this.isCriticalPathEnable=!1,g=0;g<m.criticalPathCollection.length;g++)f[_.indexOf(m.criticalPathCollection[g].toString())].isCritical=!1;t?t&&this._$ganttchartHelper.ejGanttChart("criticalDataMapping",S,e,v,b):(this._$ganttchartHelper.ejGanttChart("criticalDataMapping",S,e,v,b),this._$ganttchartHelper.ejGanttChart("criticalPathColor",S,e,v,b),this._$treegridHelper.ejTreeGrid("refresh")),m._enableDisableCriticalIcon=!1}},_finalCriticalPath:function(e,t,i,a){for(var r,n=[],o=0;o<e.length;o++)"day"==i[r=a.indexOf(e[o].taskid.toString())].durationUnit?(i[r].slack=e[o].slack/60/(this._secondsPerDay/3600),i[r].slack=i[r].slack%1!=0?i[r].slack.toFixed(2)+" day":i[r].slack+" day"):"hour"==i[r].durationUnit?(i[r].slack=e[o].slack/60,i[r].slack=i[r].slack%1!=0?i[r].slack.toFixed(2)+" hour":i[r].slack+" hour"):i[r].slack=e[o].slack+" minutes",e[o].slack<=0&&i[r].status<100&&(i[r].isCritical=!0,n.push(e[o].taskid));return n.concat(t)},_getSlackDuration:function(e,t,i,a){var r=this._checkStartDate(new Date(e)),n=this._checkEndDate(new Date(t));return this._getTimeDiff(r,n,!0)<=0?0:this._getDuration(r,n,i,a.isAutoSchedule,!0)},_slackCalculation:function(e,i,a,r,n,o){for(var l,d,s,c,u,p,h,g,m=this,_=e[0].fromdata.split(","),f=e[0].fromDataPredecessor.split(","),w=[],C=_.length,T=0;T<C;T++)w=_[T].split(":"),l=a.indexOf(parseInt(w[0])),c=a.indexOf(parseInt(e[0].todateID)),"FS"==f[T]&&(d=o.indexOf(w[0].toString()),s=o.indexOf(e[0].todateID.toString()),h=n[d].endDate>n[s].startDate?-m._getDuration(n[s].startDate,n[d].endDate,"minute",n[d].isAutoSchedule):m._getSlackDuration(n[d].endDate,n[s].startDate,"minute",n[d]),t.isNullOrUndefined(i[l].slack)?(w.length<=1?i[l].slack=i[c].slack+h<0?0:i[c].slack+h:w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack+h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].fs=1,i[l].fsslack=i[l].slack,i[l].enddate=n[d].startDate):i[l].slack>h&&0!=i[l].slack&&(w.length<=1?i[l].slack=i[c].slack+h<0?0:i[c].slack+h:w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack+h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].fs=1,i[l].fsslack=i[l].slack,i[l].enddate=n[d].startDate),n[d].endDate>=r&&n[d].endDate<=r&&(i[l].slack=0)),"SS"==f[T]&&(n[d=o.indexOf(w[0].toString())].isAutoSchedule?(s=o.indexOf(e[0].todateID.toString()),h=n[d].startDate>n[s].startDate?-m._getDuration(n[s].startDate,n[d].startDate,"minute",n[d].isAutoSchedule):m._getDuration(n[d].startDate,n[s].startDate,"minute",n[d].isAutoSchedule),t.isNullOrUndefined(i[l].slack)?(w.length<=1?i[l].slack=i[c].slack+h<0?0:i[c].slack+h:w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack+h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].fs=1,i[l].fsslack=i[l].slack,i[l].enddate=n[d].startDate):i[l].slack>h&&0!=i[l].slack&&(w.length<=1?i[l].slack=i[c].slack+h<0?0:i[c].slack+h:w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack+h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].fs=1,i[l].fsslack=i[l].slack,i[l].enddate=n[d].startDate)):n[d].isAutoSchedule||(h=m._getSlackDuration(n[d].endDate,r,"minute",n[d]),t.isNullOrUndefined(i[l].slack)?i[l].slack=h:i[l].slack>h&&0!=i[l].slack&&(i[l].slack=h)),n[d].endDate>=r&&n[d].endDate<=r&&(i[l].slack=0)),"FF"==f[T]&&(1==i[c].fs||1==i[c].ff||-1==i[c].fs?(d=o.indexOf(w[0].toString()),s=o.indexOf(e[0].todateID.toString()),1==i[c].fs?(u=n[s].endDate,p=i[c].slack):1==i[c].ff&&(u=n[s].endDate,p=i[c].slack),-1==i[c].fs&&(u=i[c].enddate,p=i[c].slack),h=u>n[d].endDate?-m._getSlackDuration(n[d].endDate,u,"minute",n[d]):m._getSlackDuration(u,n[d].endDate,"minute",n[d]),t.isNullOrUndefined(i[l].slack)?(w.length<=1?i[l].slack=p-h<0?0:p-h:w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack-h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].ff=1,i[l].enddate=u,i[l].fsslack=p):i[l].slack>h&&0!=i[l].slack&&(w.length<=1?i[l].slack=p-h<0?0:p-h:w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack-h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].ff=1,i[l].enddate=u,i[l].fsslack=p)):(d=o.indexOf(w[0].toString()),h=m._getSlackDuration(n[d].endDate,r,"minute",n[d]),t.isNullOrUndefined(i[l].slack)?w.length<=1?t.isNullOrUndefined(i[l].slack)?i[l].slack=h:i[l].slack>h&&(i[l].slack=h):w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)):i[l].slack>h&&0!=i[l].slack&&(w.length<=1?t.isNullOrUndefined(i[l].slack)?i[l].slack=h:i[l].slack>h&&(i[l].slack=h):w.length>1&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0))),i[l].ff=1),n[d].endDate>=r&&n[d].endDate<=r&&(i[l].slack=0)),"SF"==f[T]&&(n[d=o.indexOf(w[0].toString())].isAutoSchedule?t.isNullOrUndefined(i[l].slack)?(w.length<=1?t.isNullOrUndefined(i[c].to)?(d=o.indexOf(w[0].toString()),h=m._getSlackDuration(n[d].endDate,r,"minute",n[d]),i[l].slack=h):t.isNullOrUndefined(i[c].to)||(d=o.indexOf(w[0].toString()),h=n[s=o.indexOf(e[0].todateID.toString())].endDate>n[d].startDate?-m._getDuration(n[d].startDate,n[s].endDate,"minute",n[d].isAutoSchedule):m._getSlackDuration(n[s].endDate,n[d].startDate,"minute",n[d]),i[l].slack=i[c].slack+h<0?0:i[c].slack+h):w.length>1&&(d=o.indexOf(w[0].toString()),h=n[s=o.indexOf(e[0].todateID.toString())].endDate>n[d].endDate?n[d].startDate>n[s].endDate?-m._getSlackDuration(n[s].endDate,n[d].startDate,"minute",n[d]):m._getDuration(n[d].startDate,n[s].endDate,"minute",n[d].isAutoSchedule):m._getSlackDuration(n[d].endDate,r,"minute",n[d]),g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack+h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0)),i[l].fs=1,i[l].fsslack=i[l].slack,i[l].enddate=n[d].startDate):(w.length<=1?(t.isNullOrUndefined(i[c].to)?(d=o.indexOf(w[0].toString()),h=m._getSlackDuration(n[d].endDate,r,"minute",n[d])):t.isNullOrUndefined(i[c].to)||(d=o.indexOf(w[0].toString()),h=n[s=o.indexOf(e[0].todateID.toString())].endDate>n[d].startDate?-m._getDuration(n[d].startDate,n[s].endDate,"minute",n[d].isAutoSchedule):m._getSlackDuration(n[s].endDate,n[d].startDate,"minute",n[d])),i[l].slack>h&&0!=i[l].slack&&(t.isNullOrUndefined(i[c].to)?i[l].slack=h:t.isNullOrUndefined(i[c].to)||(i[l].slack=i[c].slack+h<0?0:i[c].slack+h))):w.length>1&&(d=o.indexOf(w[0].toString()),h=n[s=o.indexOf(e[0].todateID.toString())].endDate>n[d].endDate?n[d].startDate>n[s].endDate?-m._getSlackDuration(n[s].endDate,n[d].startDate,"minute",n[d]):m._getDuration(n[d].startDate,n[s].endDate,"minute",n[d].isAutoSchedule):m._getSlackDuration(n[d].endDate,r,"minute",n[d]),i[l].slack>h&&0!=i[l].slack&&(g=-1!=w[1].indexOf("hour")?60*parseInt(w[1]):-1!=w[1].indexOf("day")?parseInt(w[1])*(m._secondsPerDay/3600)*60:parseInt(w[1]),i[l].slack=i[c].slack+h,i[l].slack=i[l].slack-g,i[l].slack<0&&(i[l].slack=0))),i[l].fs=1,i[l].fsslack=i[l].slack,i[l].enddate=n[d].startDate):n[d].isAutoSchedule||(h=m._getSlackDuration(n[d].endDate,r,"minute",n[d]),t.isNullOrUndefined(i[l].slack)?i[l].slack=h:i[l].slack>h&&0!=i[l].slack&&(i[l].slack=h)),n[d].endDate>=r&&n[d].endDate<=r&&(i[l].slack=0)),i[l].from&&e.push({fromdata:i[l].from,todateID:i[l].taskid,fromDataPredecessor:i[l].fromPredecessor});e&&(e.splice(0,1),e.length>0&&m._slackCalculation(e,i,a,r,n,o))},deleteDependency:function(e,i){var a,r,n=this,o=n.model,l={fromId:e,toId:i,requestType:"deleteDependency"};if(!n._trigger("actionBegin",l)){if(a=!t.isNullOrUndefined(l.fromId)&&n._getRecordByTaskId(l.fromId.toString()),r=!t.isNullOrUndefined(l.toId)&&n._getRecordByTaskId(l.toId.toString()),!o.predecessorMapping||t.isNullOrUndefined(a)||t.isNullOrUndefined(r))return;a&&r&&a.predecessor&&(n._updatedConnectorLineCollection=[],n._connectorlineIds=[],n._isLastRefresh=!0,n._removePredecessor(a.predecessor,r,!0),1==this.isCriticalPathEnable&&(n._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0)))}},updateDependency:function(e,i,a,r){var n,o,l,d,s,c,u,p,h=this,g=h.model,m={fromId:e,toId:i,requestType:"updateDependency",predecessorType:a,offset:r};if(!h._trigger("actionBegin",m)){if(n=!t.isNullOrUndefined(m.fromId)&&h._getRecordByTaskId(m.fromId.toString()),o=!t.isNullOrUndefined(m.toId)&&h._getRecordByTaskId(m.toId.toString()),!g.predecessorMapping||t.isNullOrUndefined(n)||t.isNullOrUndefined(o)||!n||!o)return;if(l=m.fromId.toString(),m.toId.toString(),a=m.predecessorType,r=m.offset,o.predecessor.length>0){if(s=o.predecessor.filter(function(e){return e.from==l}),t.isNullOrUndefined(s[0]))return;c=JSON.parse(JSON.stringify(o.predecessor)),u=["FS","SS","SF","FF"],(t.isNullOrUndefined(a)||u.indexOf(a.toUpperCase())<0)&&(a=s[0].predecessorsType),t.isNullOrUndefined(r)||0==r.length?(r=s[0].offset,d=s[0].offsetDurationUnit):(r=(p=o._getOffsetDurationUnit(r,this._durationUnitEditText,g.durationUnit)).duration,d=p.durationUnit),(s[0].offset!=r||s[0].predecessorsType!=a)&&(s[0].predecessorsType=a,s[0].offset=r,s[0].offsetDurationUnit=d,h._updatedConnectorLineCollection=[],h._connectorlineIds=[],h._isLastRefresh=!1,h._validatePredecessor(o,c),h._$ganttchartHelper.ejGanttChart("appendConnectorLine",h._updatedConnectorLineCollection),h._updateConnectorLineCollection(h._updatedConnectorLineCollection),o.item[g.predecessorMapping]=h._predecessorToString(o.predecessor,o),o.predecessorsName=o.item[g.predecessorMapping],g.enableWBS&&g.enableWBSPredecessor&&h._$treegridHelper.ejTreeGrid("updateWBSPredecessor",o),g.enableSerialNumber&&h._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",o),h._isLastRefresh=!0,h.refreshGanttRecord(o),1==this.isCriticalPathEnable&&(h._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0)))}}},_getVaildSuccessorTasks:function(e,t,i){var a,r,n=this,o=n.model;e.predecessor&&e.predecessor.length>0&&(a=e.predecessor,r=e.taskId,a.forEach(function(e){var a,l,d;e.from.toString()==r.toString()&&(a=e.to,o.enableSerialNumber?(d=o.flatRecords[o.ids.indexOf(a)],l=t.indexOf(d.serialNumber.toString())):l=t.indexOf(a),l>-1&&(t.splice(l,1),i.splice(l,1)),d=n._getRecordByTaskId(a),n._getVaildSuccessorTasks(d,t,i))}))}}})(jQuery,Syncfusion),function(e,t){"use strict";t.ganttChartFeatures=t.ganttChartFeatures||{},t.ganttChartFeatures.timescale={_getScheduleLength:function(e){var t=this,i=t.model;switch(e){case"week":return i.scheduleWeeks.length*t._scheduleWeekWidth;case"year":case"quarterYear":case"halfYear":return t._scheduleYearWidth;case"month":return t._scheduleMonthWidth;case"day":return i.scheduleDays.length*t.model.perHourWidth*24;case"hour":return i.scheduleHours.length*i.perMinuteWidth*t._totalInterval;default:return i.scheduleWeeks.length*t._scheduleWeekWidth}},_updateScheduleWidth:function(){var e=this;e._scheduleWeekWidth=e._getWeekWidth(),e._numOfWeeks=e._getNumberOftWeeks(this.model.projectStartDate,this.model.projectEndDate),e._scheduleYearWidth=e._getYearWidth(),e._scheduleMonthWidth=e._getMonthWidth(),e._totalWeekWidth=e._scheduleWeekWidth*e._numOfWeeks.length,e._balanceWidth=e._totalWeekWidth-e._scheduleMonthWidth,e._scheduleMonthWidth+=e._balanceWidth},refreshChartHeader:function(i,a){var r,n,o,l,d,s,c,u,p,h=this,g=h.model,m=g.scheduleHeaderSettings.scheduleHeaderType;h._updateScheduleWidth(),"hour"==m?h._createScheduleTopHourTemplate():"day"==m?h._createScheduleTopDayTemplate():"week"==m?h._createScheduleWeekTemplate():"month"==m?h._createScheduleTopMonthTemplate():("year"==m||"quarterYear"==m||"halfYear"==m)&&h._createScheduleYearTemplate(),i=null==i?new Date:i,a=null==a?new Date(null):a,h._$scheduleDiv.empty(),c=t.buildTag("table.e-schedule-headerrow-week e-zerospacing","",{display:"block"}),r=t.buildTag("colgroup","",{},{}),(n=e(document.createElement("col"))).css("width",h._getScheduleLength(m)+"px"),r.append(n),o=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{}),"week"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleWeekTemplate"](g.scheduleWeeks),{},{}):"year"==m||"quarterYear"==m||"halfYear"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleYearTemplate"](g.scheduleYears),{},{}):"month"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleTopMonthTemplate"](g.scheduleMonths),{},{}):"day"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleTopDayTemplate"](g.scheduleDays),{},{}):"hour"==m&&(l=t.buildTag("tr",e.render[this._id+"ScheduleTopHourTemplate"](g.scheduleHours),{},{})),d=t.buildTag("th.e-ganttchart-schedule","",{},{}),s=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{}),d.append(s),l.append(d),o.append(l),c.append(r),c.append(o),h._$scheduleDiv.append(c),l=null,"hour"==m?h._createMinuteTemplate():"day"==m?h._createScheduleHourTemplate():"week"==m?h._createScheduleDayTemplate():"month"==m?h._createScheduleBottomWeekTemplate():"year"==m?h._createScheduleMonthTemplate():("quarterYear"==m||"halfYear"==m)&&h._createScheduleQuarterlyTemplate(),c=t.buildTag("table.e-schedule-headerrow-day e-zerospacing","",{display:"block","border-collapse":"collapse"}),o=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{}),u=h._getScheduleMonth(new Date(g.scheduleYears[0]),a),p="quarterYear"==m||"halfYear"==m?this._getQuarterHalfYearData(u,m):u,"week"==m&&(l=t.buildTag("tr",e.render[this._id+"_CustomTemplate1"](h.model.scheduleWeeks),{},{})),("year"==m||"quarterYear"==m||"halfYear"==m)&&(l=t.buildTag("tr",e.render[this._id+"ScheduleMonthTemplate"](p),{},{})),"month"==m&&(h._numOfWeeks=h._getNumberOftWeeks(this.model.projectStartDate,this.model.projectEndDate),l=t.buildTag("tr",e.render[this._id+"ScheduleBottomWeekTemplate"](h._numOfWeeks),{},{})),"day"==m&&(l=t.buildTag("tr",e.render[this._id+"scheduleHourTemplate"](h._getScheduleHours()),{},{})),"hour"==m&&(l=t.buildTag("tr",e.render[this._id+"scheduleMinuteTemplate"](h._getScheduleMinutes()),{},{})),d=t.buildTag("th.e-ganttchart-schedule","",{},{}),s=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{}),d.append(s),l.append(d),o.append(l),c.append(r),c.append(o),h._$scheduleDiv.append(c)},_createScheduleTopDayTemplate:function(){var t,i,a=this,r=a.model,n=""==r.scheduleHeaderSettings.dayHeaderFormat&&"day"==r.scheduleHeaderSettings.scheduleHeaderType?"ddd":r.scheduleHeaderSettings.dayHeaderFormat,o={};o["_"+a._id+"renderDayTop"]=e.proxy(a._getFormattedDay,a),o["_"+a._id+"getDayWidth"]=e.proxy(a._getDayWidth,a),e.views.helpers(o),t="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:{{:~_"+a._id+"getDayWidth(#data)}}px;'>",t+="<div class='e-schedule-week-headercell-content'  style='width:"+(24*a.model.perHourWidth-1)+"px;box-sizing:border-box;margin:auto;white-space:nowrap;'>{{:~_"+a._id+"renderDayTop('"+n+"',#data)}}</div></div>",t+="</th>",(i={})[a._id+"ScheduleTopDayTemplate"]=t,e.templates(i)},_getFormattedDay:function(e,i){var a=new Date(i),r=this.model;switch(e){case"D":case"d":return a.getDate();default:return t.format(a,e,r.locale)}},_createScheduleTopMonthTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.monthHeaderFormat,n={};n["_"+a._id+"renderMonthTop"]=e.proxy(a._getFormattedMonth,a),n["_"+a._id+"setMonthWidth"]=e.proxy(a._setMonthWidth,a),n["_"+a._id+"isLastMonth"]=e.proxy(a._checkLastMonthWidth,a),e.views.helpers(n),t="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:{{:~_"+a._id+"setMonthWidth(#data)}}px;'>",t+="<div class='e-schedule-week-headercell-content'  style='box-sizing:border-box;-moz-box-sizing:border-box;margin:auto;white-space:nowrap;width:{{:~_"+a._id+"setMonthWidth(#data)-1}}px;'>{{:~_"+a._id+"renderMonthTop('"+r+"',#data)}}</div>{{if ~_"+a._id+"isLastMonth(#data)}}<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;'><div class='e-schedule-week-headercell-content' style='box-sizing:border-box;-moz-box-sizing:border-box;margin:auto;white-space:nowrap;width:"+(a._balanceWidth-1)+"px;'></div></th>{{/if}}",t+="</th>",(i={})[a._id+"ScheduleTopMonthTemplate"]=t,e.templates(i)},_setMonthWidth:function(e){var i,a,r,n;return i="object"==typeof e?new Date(e):t.parseDate(e,this.model.dateFormat,this.model.locale),r=(a=new Date(i.getFullYear(),i.getMonth()+1,0)).getDate(),i.getTime()===this.model.scheduleMonths[0].getTime()?(n=a.getDate()-i.getDate(),this.model.perDayWidth*(n+1)):31==r?31*this.model.perDayWidth:30==r?30*this.model.perDayWidth:28==r?28*this.model.perDayWidth:29==r?29*this.model.perDayWidth:void 0},_checkLastMonthWidth:function(e){var t=this;return e==t.model.scheduleMonths[t.model.scheduleMonths.length-1]&&t._balanceWidth>0},_getFormattedMonth:function(e,i){var a=new Date(i),r=this.model;return t.format(a,e,r.locale)},_createScheduleYearTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.yearHeaderFormat,n={};n["_"+a._id+"renderYear"]=e.proxy(a._getFormattedYear,a),n["_"+a._id+"getYearWidth"]=e.proxy(a._getTemplateYearWidth,a),e.views.helpers(n),t="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:{{:~_"+a._id+"getYearWidth(#data)}}px;'>",t+="<div class='e-schedule-week-headercell-content' style='margin:auto;overflow:hidden;white-space:nowrap;width:{{:~_"+a._id+"getYearWidth(#data)-1}}px;box-sizing:border-box;-moz-box-sizing:border-box;'>{{:~_"+a._id+"renderYear('"+r+"',#data)}}</div>",t+="</th>",(i={})[a._id+"ScheduleYearTemplate"]=t,e.templates(i)},_getFormattedYear:function(e,i){var a=new Date(i),r=this.model;return t.format(a,e,r.locale)},_getMonthWidthForYearMode:function(e){for(var i,a=this.model,r=0,n=e.getMonth();n<12;n++){e="object"==typeof(i=e)?new Date(i):t.parseDate(i,a.dateFormat,a.locale);var o=new Date(e.getFullYear(),e.getMonth()+1,0),l=e.getDate(),d=o.getDate();1!=l?r+=d-e.getDate():31==d?r+=31:30==d?r+=30:28==d?r+=28:29==d&&(r+=29),e=new Date(e.getFullYear(),n+1,1)}return r},_getTemplateYearWidth:function(e){e.getFullYear();return this._getMonthWidthForYearMode(e)*this.model.perDayWidth},_createScheduleWeekTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.weekHeaderFormat,n={};n["_"+a._id+"renderWeek"]=e.proxy(a._getFormattedWeek,a),e.views.helpers(n),t="<th class='e-schedule-week-headercell' style='box-sizing:border-box;-moz-box-sizing:border-box;width:"+a._scheduleWeekWidth+"px;'>",t+="<div class='e-schedule-week-headercell-content'  style='width:"+(a._scheduleWeekWidth-1)+"px;box-sizing:border-box;margin:auto;white-space:nowrap;'>{{:~_"+a._id+"renderWeek('"+r+"',#data)}}</div>",t+="</th>",(i={})[a._id+"ScheduleWeekTemplate"]=t,e.templates(i)},_getFormattedWeek:function(e,i){var a=new Date(i),r=this.model;return t.format(a,e,r.locale).toLowerCase().replace(/(-(\w)|(^| )(\w)|:(\w)|,(\w)|\/(\w)|\.(\w))/g,function(e){return e.toUpperCase()})},_createScheduleHourTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.hourHeaderFormat,n={};n["_"+a._id+"renderHour"]=e.proxy(a._getHourTemplate,a),e.views.helpers(n),t="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perHourWidth+"px;'>",t+="<div class='e-schedule-day-headercell-content' style='width:"+(a.model.perHourWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~_"+a._id+"renderHour('"+r+"',#data)}}</div>",t+="</th>",(i={})[a._id+"scheduleHourTemplate"]=t,e.templates(i)},_createScheduleTopHourTemplate:function(){var t,i,a,r=this,n=r.model,o=n.minuteInterval,l=n.scheduleHeaderSettings.hourHeaderFormat,d={};d["_"+r._id+"renderHour"]=e.proxy(r._getHourTemplate,r),30==o&&(t=2),15==o&&(t=4),5==o&&(t=12),1==o&&(t=60),r._totalInterval=t,e.views.helpers(d),i="<th  class='e-schedule-hour-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+r.model.perMinuteWidth*t+"px;'>",i+="<div class='e-schedule-hour-headercell-content' style='width:"+(r.model.perMinuteWidth*t-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~_"+r._id+"renderHour('"+l+"',#data)}}</div>",i+="</th>",(a={})[r._id+"ScheduleTopHourTemplate"]=i,e.templates(a)},_createMinuteTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.minuteHeaderFormat,n={};n["_"+a._id+"renderHour"]=e.proxy(a._getHourTemplate,a),e.views.helpers(n),t="<th class='e-schedule-hour-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perMinuteWidth+"px;'>",t+="<div class='e-schedule-hour-headercell-content' style='width:"+(a.model.perMinuteWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip'>{{:~_"+a._id+"renderHour('"+r+"',#data)}}</div>",t+="</th>",(i={})[a._id+"scheduleMinuteTemplate"]=t,e.templates(i)},_getHourTemplate:function(e,i){var a=new Date(i),r=this.model;return t.format(a,e,r.locale)},_createScheduleBottomWeekTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.weekHeaderFormat,n={};n["_"+a._id+"renderWeek"]=e.proxy(a._getMonthWeekTemplate,a),e.views.helpers(n),t="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perWeekWidth+"px;'>",t+="<div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;padding-left:2px;width:"+(a.model.perWeekWidth-1)+"px;'>{{:~_"+a._id+"renderWeek('"+r+"',#data)}}</div>",t+="</th>",(i={})[a._id+"ScheduleBottomWeekTemplate"]=t,e.templates(i)},_getMonthWeekTemplate:function(e,i){var a=new Date(i),r=this.model;switch(e){case"d":return a.getDate();default:return t.format(a,e,r.locale)}},_createScheduleQuarterlyTemplate:function(){var t=this,i=(t.model,"<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:{{:width}}px;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~_"+t._id+"getMonthWidth(#data)-1}}px;'>{{:mode}}</div></th>"),a={};a[t._id+"ScheduleMonthTemplate"]=i,e.templates(a)},_createScheduleMonthTemplate:function(){var t,i,a=this,r=a.model.scheduleHeaderSettings.monthHeaderFormat,n={};n["_"+a._id+"renderMonth"]=e.proxy(a._getMonthTemplate,a),n["_"+a._id+"getMonthWidth"]=e.proxy(a._setMonthWidthYearMode,a),e.views.helpers(n),t="<th  class='e-schedule-day-headercell' style='-moz-box-sizing:border-box;box-sizing:border-box;width:{{:~_"+a._id+"getMonthWidth(#data)}}px;'><div class='e-schedule-day-headercell-content' style='position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;width:{{:~_"+a._id+"getMonthWidth(#data)-1}}px;'>{{:~_"+a._id+"renderMonth('"+r+"',#data)}}</div></th>",(i={})[a._id+"ScheduleMonthTemplate"]=t,e.templates(i)},_getMonthTemplate:function(e,i){var a=new Date(i),r=this.model;switch(e){case"M":case"m":return a.getMonth()+1;default:return t.format(a,e,r.locale)}},_getMonthWidthForQuarterYear:function(e){for(var t=0,i=e.length,a=0;a<i;a++){var r=new Date(e[a]),n=new Date(r.getFullYear(),r.getMonth()+1,0),o=r.getDate(),l=n.getDate();t+=this.model.perDayWidth*(1!=o?l-r.getDate():l)}return t},_setMonthWidthYearMode:function(e){var t=new Date(e),i=new Date(t.getFullYear(),t.getMonth()+1,0),a=t.getDate(),r=i.getDate();return 1!=a?this.model.perDayWidth*(r-t.getDate()):31==r?31*this.model.perDayWidth:30==r?30*this.model.perDayWidth:28==r?28*this.model.perDayWidth:29==r?29*this.model.perDayWidth:void 0},_getHeaderWeek:function(e,t){var i=new Date(t);return i.setDate(i.getDate()+e),-1!=this._nonWorkingDayIndex.indexOf(i.getDay())||void 0},_getDayWidth:function(e){var t,i=new Date(e);return i.setHours(0,0,0,0),(t=new Date(i)).setHours(24,0,0,0),(t.getTime()-i.getTime())/36e5*this.model.perHourWidth},_createScheduleDayTemplate:function(){var t,i,a=this,r=a.model,n=""==r.scheduleHeaderSettings.dayHeaderFormat&&"day"==r.scheduleHeaderSettings.scheduleHeaderType?"ddd":r.scheduleHeaderSettings.dayHeaderFormat,o={};o["_"+a._id+"renderDay"]=e.proxy(a._getDayTemplate,a),o["_"+a._id+"getHeader"]=e.proxy(a._getHeaderWeek,a),e.views.helpers(o),t="<th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(0,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(0,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>",t+="<div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(0,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',0,#data)}}</div><th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(1,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(1,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(1,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',1,#data)}}</div><th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(2,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(2,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(2,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',2,#data)}}</div><th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(3,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(3,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(3,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',3,#data)}}</div><th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(4,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(4,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(4,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',4,#data)}}</div><th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(5,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(5,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(5,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',5,#data)}}</div><th  class='e-schedule-day-headercell {{if ~_"+a._id+"getHeader(6,#data)}} e-headercell-weekend {{/if}}' style='-moz-box-sizing:border-box;box-sizing:border-box;width:"+a.model.perDayWidth+"px;{{if ~_"+a._id+"getHeader(6,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'><div class='e-schedule-day-headercell-content' style='width:"+(a.model.perDayWidth-1)+"px;position:static;box-sizing:border-box;overflow:hidden;text-overflow:clip;{{if ~_"+a._id+"getHeader(6,#data)}} background-color:"+this.model.scheduleHeaderSettings.weekendBackground+"{{/if}}'>{{:~_"+a._id+"renderDay('"+n+"',6,#data)}}</div>",t+="</th>",(i={})[a._id+"_CustomTemplate1"]=t,e.templates(i)},_getDayTemplate:function(e,i,a){var r=new Date(a),n=this.model;switch(r.setDate(r.getDate()+i),e){case"D":case"d":return r.getDate();case"DD":case"dd":case"DDD":case"ddd":case"DDDD":case"dddd":return t.format(r,e,n.locale);case"":return e="ddd",t.format(r,e,n.locale)[0].toUpperCase();default:return t.format(r,e,n.locale).toUpperCase()}},_getNumberOftWeeks:function(e,t){var i=new Date(e),a=new Date(t),r=[];do{r.push(new Date(i)),i.setDate(i.getDate()+7)}while(!(i>a));return r},_getScheduleMonth:function(e,t){var i,a=this.model,r=[];for(t=t.getMonth()<11?new Date(t.getFullYear(),11,31):t,new Date(e.getFullYear(),11,31)<new Date(a.scheduleEndDate)?12:new Date(a.scheduleEndDate).getMonth()+1,i=e.getMonth();e<t;i++)r.push(e),e=new Date(e.getFullYear(),e.getMonth()+1,1);return r},_getQuarterHalfYearData:function(e,t){for(var i,a,r,n=[],o=e.length,l=this.model.ganttInstance,d=0;d<o;d++){var s=[],c={},u=e[d].getMonth();switch(u/3<1?(i=1,a=1):u/3<2?(i=2,a=1):u/3<3?(i=3,a=2):u/3<4&&(i=4,a=2),u%3==0?(s.push(e[d]),s.push(e[d+1]),s.push(e[d+2]),d+=2):u%3==1?(s.push(e[d]),s.push(e[d+1]),d+=1):u%3==2&&s.push(e[d]),"halfYear"==t&&(0==u||1==u||2==u||6==u||7==u||8==u)&&(s.push(e[d+1]),s.push(e[d+2]),s.push(e[d+3]),d+=3),c.width=this._getMonthWidthForQuarterYear(s),"halfYear"==t?"H"+a:"Q"+i){case"Q1":r=l._quarterYearTexts.first;break;case"Q2":r=l._quarterYearTexts.second;break;case"Q3":r=l._quarterYearTexts.third;break;case"Q4":r=l._quarterYearTexts.fourth;break;case"H1":r=l._halfYearTexts.first;break;case"H2":r=l._halfYearTexts.second}c.mode=r,n.push(c)}return n},_createSchedule:function(i,a){var r,n,o,l,d,s,c,u,p,h=this,g=h.model,m=g.scheduleHeaderSettings.scheduleHeaderType;i=null==i?new Date:i,a=null==a?new Date(null):a,h._createScheduleWeekTemplate(),h._createScheduleYearTemplate(),h._createScheduleTopMonthTemplate(),h._createScheduleTopDayTemplate(),h._createScheduleTopHourTemplate(),c=t.buildTag("table.e-schedule-headerrow-week e-zerospacing","",{display:"block"}),r=t.buildTag("colgroup","",{},{}),(n=e(document.createElement("col"))).css("width",h._getScheduleLength(m)+"px"),r.append(n),o=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{}),"week"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleWeekTemplate"](h.model.scheduleWeeks),{},{}):"year"==m||"quarterYear"==m||"halfYear"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleYearTemplate"](h.model.scheduleYears),{},{}):"month"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleTopMonthTemplate"](h.model.scheduleMonths),{},{}):"day"==m?l=t.buildTag("tr",e.render[this._id+"ScheduleTopDayTemplate"](h.model.scheduleDays),{},{}):"hour"==m&&(l=t.buildTag("tr",e.render[this._id+"ScheduleTopHourTemplate"](h.model.scheduleHours),{},{})),d=t.buildTag("th.e-ganttchart-schedule","",{},{}),s=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{}),d.append(s),l.append(d),o.append(l),c.append(r),c.append(o),h._$scheduleDiv.append(c),l=null,h._createScheduleDayTemplate(),h._createScheduleMonthTemplate(),h._createScheduleBottomWeekTemplate(),h._createMinuteTemplate(),h._createScheduleHourTemplate(),("quarterYear"==m||"halfYear"==m)&&h._createScheduleQuarterlyTemplate(),c=t.buildTag("table.e-schedule-headerrow-day e-zerospacing","",{display:"block","border-collapse":"collapse"}),o=t.buildTag("thead.e-ejganttschedule","",{display:"block","border-collapse":"collapse"},{}),u=h._getScheduleMonth(new Date(g.scheduleYears[0]),a),p="quarterYear"==m||"halfYear"==m?this._getQuarterHalfYearData(u,m):u,"week"==m&&(l=t.buildTag("tr",e.render[this._id+"_CustomTemplate1"](g.scheduleWeeks),{},{})),("year"==m||"quarterYear"==m||"halfYear"==m)&&(l=t.buildTag("tr",e.render[this._id+"ScheduleMonthTemplate"](p),{},{})),"month"==m&&(l=t.buildTag("tr",e.render[this._id+"ScheduleBottomWeekTemplate"](h._numOfWeeks),{},{})),"day"==m&&(l=t.buildTag("tr",e.render[this._id+"scheduleHourTemplate"](h._getScheduleHours()),{},{})),"hour"==m&&(l=t.buildTag("tr",e.render[this._id+"scheduleMinuteTemplate"](h._getScheduleMinutes()),{},{})),d=t.buildTag("th.e-ganttchart-schedule","",{},{}),s=t.buildTag("div.e-ganttchart-schedule","",{width:"20px"},{}),d.append(s),l.append(d),o.append(l),c.append(r),c.append(o),h._$scheduleDiv.append(c),h._$headerContainer.append(h._$scheduleDiv),h._$ganttChartContainer.append(h._$headerContainer),e("#"+h._id).append(h._$ganttChartContainer)},_getScheduleHours:function(){var e=this,t=e.model,i=new Date(e.model.projectStartDate),a=new Date(t.projectEndDate);e._scheduleHours=[],a.setHours(24);do{e._scheduleHours.push(new Date(i)),i.setTime(i.getTime()+36e5)}while(!(i.getTime()>=a.getTime()));return e._scheduleHours},_getScheduleMinutes:function(){var e=this,t=e.model,i=new Date(e.model.projectStartDate),a=new Date(t.projectEndDate);a.setMinutes(60),i.setMinutes(0),e._scheduleMinutes=[];do{e._scheduleMinutes.push(new Date(i)),i.setMinutes(i.getMinutes()+t.minuteInterval)}while(!(i.getTime()>=a.getTime()));return e._scheduleMinutes}}}(jQuery,Syncfusion),function(e,t){t.ganttChartFeatures=t.ganttChartFeatures||{},t.ganttChartFeatures.resourceViewGantt={_unassignedTask:function(){return"unassignedTask"==this.data.eResourceTaskType},_getMarginTopValue:function(e){return(e.eOverlapIndex-1)*this.model.rowHeight+this._marginTop},_getRangeHeight:function(e){return this._getTemplateRowHeight(e)-2*this._marginTop},_getTemplateRowHeight:function(e){return"resourceView"==this.model.viewType?e.eOverlapIndex*this.model.rowHeight:this.model.rowHeight},_createResourceTaskbarTemplate:function(){var i,a,r,n,o,l,d,s=this,c=s.model,u=c.scheduleHeaderSettings.scheduleHeaderType,p=(c.baselineColor,c.taskbarTemplate),h=!1,g=c.parentTaskbarTemplate,m=!1,_=(c.milestoneTemplate,c.leftTaskLabelTemplate),f=!1,w=c.rightTaskLabelTemplate,C=!1,T={};T["_"+s._id+"SelectState"]=e.proxy(s._SelectState,s),T["_"+s._id+"getType"]=s._getTypedata,T["_"+s._id+"expander"]=s._addRecordExpandCollapse,T["_"+s._id+"milestoneMapping"]=s._isMilestone,T["_"+s._id+"unassignedTask"]=s._unassignedTask,T["_"+s._id+"resources"]=e.proxy(s._getResourceInfo,s),T["_"+s._id+"rowClassName"]=t.TreeGrid._getrowClassName,T["_"+s._id+"expandStatus"]=e.proxy(s._getExpandStatusRecord,s),T["_"+s._id+"borderRadius"]=s._getBorderRadius,T["_"+s._id+"getRowHeight"]=e.proxy(s._getTemplateRowHeight,s),T["_"+s._id+"getMarginTop"]=e.proxy(s._getMarginTopValue,s),T["_"+s._id+"getRangeHeight"]=e.proxy(s._getRangeHeight,s),s._marginTop=(c.rowHeight-c.taskbarHeight)/2,s._fontSize=s._getFontSize(),s._resizerRightAdjust=.8*s._fontSize,s._resizerMargin=s._getMargin(),s._resizerLeftAdjust=s._getResizerLeftAdjust(),"week"==u?i=c.scheduleWeeks.length*s._scheduleWeekWidth:"year"==u?i=s._scheduleYearWidth:"month"==u?i=s._scheduleMonthWidth:"day"==u?i=c.scheduleDays.length*c.perHourWidth*24:"hour"==u&&(i=c.scheduleHours.length*c.perMinuteWidth*s._totalInterval),c.renderBaseline?(c.taskbarHeight+4<=c.rowHeight?(o=c.taskbarHeight,0):(o=c.taskbarHeight-4,-4),a=o,c.rowHeight):(a=c.taskbarHeight,c.rowHeight),e.views.helpers(T),c.progressMapping||(this.model.showProgressStatus=!1),c.resourceInfoMapping||(c.showResourceNames=!1),p&&(h=!0,r=(l=this._processTaskbarTemplate(p,a,"resourceTemplate")).template,l.isProgressbarTemplate),g&&(m=!0,n=this._processParentTaskbarTemplate(g,a)),_&&(this._processTaskLabelTemplate(_),f=!0),w&&(this._processTaskLabelTemplate(w),C=!0),this.model.leftTaskLabelMapping&&0==f&&(!0,s._getLeftTaskLabel()),this.model.rightTaskLabelMapping&&0==C&&(!0,s._getRightTaskLabel());Math.round(-(this.model.rowHeight-1)/2);var x="<tr class='{{:~_"+s._id+"rowClassName()}}  {{if isSelected && ~_"+s._id+"SelectState()}}e-ganttrowcell {{:~_"+s._id+"expander()}} e-gantt-mouseclick{{else}}e-ganttrowcell {{:~_"+s._id+"expander()}}{{/if}}'style='display:{{:~_"+s._id+"expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};height:{{:~_"+s._id+"getRowHeight(#data)}}px;'>",v="{{:~_"+s._id+"borderRadius()}}";x+="{{if ~_"+s._id+"getType()}}<td  class='e-chartcell' style='width:"+i+"px; vertical-align:middle;'><div class='e-parentContainer' style='{{if !startDate}}display:none;{{/if}}height:"+(this.model.taskbarHeight-1)+"px;z-index:3;'>{{if "+m+"}}"+n+"{{else}}<div class='e-gantt-parenttaskbar-innerdiv {{:~_"+s._id+"expander()}} e-parentTask' style='background-color:{{if parentTaskbarBackground }}{{:parentTaskbarBackground}}{{else}} "+this.model.parentTaskbarBackground+"{{/if}}; left:{{:left}}px;width:{{:width}}px;height:"+a+"px;'><div  class='e-gantt-parenttaskbar-progress {{:~_"+s._id+"expander()}} e-parentTask progressbar' style='top:-1px;border-style:{{if progressWidth}}solid{{else}}none{{/if}}; left:-1px;width:{{:progressWidth}}px;position:absolute;background-color:{{if parentProgressbarBackground }}{{:parentProgressbarBackground}}{{else}} "+this.model.parentProgressbarBackground+"{{/if}};z-index:3;border-top-right-radius:"+v+"px;border-bottom-right-radius:"+v+"px;height:"+a+"px;'><span class='e-rg-tasklabel e-tasklabel' style='line-height:"+(a-1)+"px;width:{{:width-10}}px;'>{{:eResourceName}}</span></div></div>{{/if}}</div></td>{{else ~_"+s._id+"unassignedTask()}}<td class='e-chartcell' style='vertical-align:top;width:"+i+"px;'><div  class='e-childContainer' style='left:{{:left}}px;width:{{:width}}px;margin-top:{{:~_"+s._id+"getMarginTop(#data)}}px;height:"+this.model.taskbarHeight+"px;position:absolute;'><div class='e-taskbarresizer-left e-icon' style='width:10px;margin-top:"+s._resizerMargin+"px;height:"+a+"px;font-size:"+s._fontSize+"px;'></div>{{if "+h+"}}"+r+"{{else}}<div  class='e-gantt-childtaskbar' style='width:{{:width}}px;height:"+a+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};'><div  class='e-gantt-childtaskbar-progress progressbar' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;line-height:"+(a-1)+"px;height:"+this.model.progressbarHeight*(a/100)+"px; top:-1px;left:-1px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+v+"px;border-bottom-right-radius:"+v+"px;'><span class='e-rg-tasklabel e-tasklabel' style='line-height:"+(a-1)+"px;width:{{:width-10}}px;'>{{:taskName}}</span></div></div>{{/if}}<div class='e-taskbarresizer-right e-icon' style='left:{{:width-"+s._resizerRightAdjust+"}}px;width:10px;height:"+a+"px;font-size:"+s._fontSize+"px;position:absolute;z-index:2;margin-top:"+s._resizerMargin+"px;'></div></div></td>{{else}}<td class='e-chartcell' style='vertical-align:top;width:"+i+"px;'>{{for eResourceChildTasks}}<div  class='e-childContainer' style='margin-top:{{:~_"+s._id+"getMarginTop(#data)}}px;left:{{:left}}px;width:{{:width}}px;height:"+this.model.taskbarHeight+"px;position:absolute;'><div class='e-taskbarresizer-left e-icon' style='left:"+(2-s._resizerLeftAdjust)+"px;width:10px;margin-top:"+s._resizerMargin+"px;height:"+a+"px;font-size:"+s._fontSize+"px;'></div>{{if "+h+"}}"+r+"{{else}}<div  class='e-gantt-childtaskbar' style='width:{{:width}}px;height:"+a+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};'><div  class='e-gantt-childtaskbar-progress progressbar' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;line-height:"+(a-1)+"px;height:"+this.model.progressbarHeight*(a/100)+"px; top:-1px;left:-1px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+v+"px;border-bottom-right-radius:"+v+"px;'><span class='e-rg-tasklabel e-tasklabel' style='line-height:"+(a-1)+"px;width:{{:width-10}}px;'>{{:taskName}}</span></div></div>{{/if}}<div class='e-taskbarresizer-right e-icon' style='left:{{:width-"+s._resizerRightAdjust+"}}px;width:10px;height:"+a+"px;font-size:"+s._fontSize+"px;position:absolute;z-index:2;margin-top:"+s._resizerMargin+"px;'></div></div>{{/for}}<div class='e-rangecontainer'>{{for eRangeValues ~height=~_"+s._id+"getRangeHeight(#data)}}<div class='e-rg-rangdiv' style='position:absolute;left:{{:left}}px;margin-top:"+s._marginTop+"px;height:{{>~height}}px;width:2px;'></div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left}}px;margin-top:"+(s._marginTop-2)+"px;height:2px;width:12px'></div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left}}px;margin-top:{{>~height +"+s._marginTop+"}}px;height:2px;width:12px'></div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left + width}}px;margin-top:"+s._marginTop+"px;height:{{>~height}}px;width:2px;'></div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left + width -10}}px;margin-top:"+(s._marginTop-2)+"px;height:2px;width:12px'></div><div class='e-rg-rangdiv' style='position:absolute;left:{{:left + width -10}}px;margin-top:{{>~height +"+s._marginTop+"}}px;height:2px;width:12px'></div>{{/for}}</div></td>{{/if}}",x+="</tr>",(d={})[this._id+"_CustomTemplate2"]=x,e.templates(d)}}}(jQuery,Syncfusion),function(e,t,i){"use strict";t.ganttFeatures=t.ganttFeatures||{},t.widget("ejGantt","ej.Gantt",{_rootCSS:"e-gantt",element:null,validTags:["div"],_requiresID:!0,model:null,_tags:[{tag:"holidays",attr:["day","background","label"],content:"template"},{tag:"stripLines",attr:["day","label","lineStyle","lineColor","lineWidth"],content:"template"},{tag:"editDialogFields",attr:["field","editType","displayInGeneralTab"],content:"template"},{tag:"filterSettings.filteredColumns",attr:["field","value","operator","predicate"]},{tag:"addDialogFields",attr:["field","editType","displayInGeneralTab"],content:"template"},{tag:"sortSettings.sortedColumns",attr:["field","direction"]},{tag:"dayWorkingTime",attr:["from","to","background"],singular:"dayWorkingTime"}],_holidays:function(){this._$ganttchartHelper.ejGanttChart("refreshHolidays"),this._trigger("refresh")},_stripLines:function(){this._$ganttchartHelper.ejGanttChart("refreshStripLines"),this._trigger("refresh")},_editDialogFields:function(){this._trigger("refresh")},_addDialogFields:function(){this._trigger("refresh")},defaults:{viewType:"projectView",resourceCollectionMapping:"",taskCollectionMapping:"",groupIdMapping:"",groupCollection:[],groupNameMapping:"",expandStateMapping:"",allowSorting:!1,allowColumnResize:!1,allowSelection:!0,allowMultipleExporting:!1,allowDragAndDrop:!1,dragTooltip:{showTooltip:!1,tooltipItems:[],tooltipTemplate:""},dataSource:null,showColumnChooser:!1,showColumnOptions:!1,query:null,splitterSettings:{position:"",index:-1},splitterPosition:"",taskIdMapping:"",parentTaskIdMapping:"",taskNameMapping:"",startDateMapping:"",endDateMapping:"",baselineStartDateMapping:"",baselineEndDateMapping:"",childMapping:"",durationMapping:"",milestoneMapping:"",progressMapping:"",predecessorMapping:"",resourceInfoMapping:"",taskSchedulingModeMapping:"",workMapping:"",notesMapping:"",resources:[],holidays:[],searchSettings:{fields:[],key:"",operator:"contains",ignoreCase:!0},highlightWeekends:!0,scheduleStartDate:null,scheduleEndDate:null,enableProgressBarResizing:!0,rowHeight:30,includeWeekend:!0,taskSchedulingMode:"auto",validateManualTasksOnLinking:!1,toolbarSettings:{showToolbar:!1,toolbarItems:[],customToolbarItems:[]},filterSettings:{filteredColumns:[]},stripLines:[],workingTimeScale:"TimeScale8Hours",roundOffDayworkingTime:!0,durationUnit:"day",workUnit:"hour",taskType:"fixedUnit",perMinuteWidth:null,perHourWidth:null,perDayWidth:null,perWeekWidth:null,perMonthWidth:null,minuteInterval:null,nonWorkingBackground:"",highlightNonWorkingTime:!1,scheduleHeaderSettings:{weekHeaderFormat:"MMM dd , yyyy",dayHeaderFormat:"",yearHeaderFormat:"yyyy",monthHeaderFormat:"MMM",hourHeaderFormat:"HH",scheduleHeaderType:"week",minutesPerInterval:"auto",weekendBackground:"",timescaleStartDateMode:"auto",timescaleUnitSize:"100%",weekStartDay:0,updateTimescaleView:!0},taskbarBackground:"",progressbarBackground:"",connectorLineBackground:"",parentTaskbarBackground:"",parentProgressbarBackground:"",connectorlineWidth:1,readOnly:!1,showTaskNames:!0,leftTaskLabelMapping:"",rightTaskLabelMapping:"",leftTaskLabelTemplate:"",rightTaskLabelTemplate:"",showGridCellTooltip:!1,cellTooltipTemplate:null,showGridExpandCellTooltip:!1,showProgressStatus:!0,showResourceNames:!0,enableTaskbarDragTooltip:!0,enableTaskbarTooltip:!0,enableWBS:!1,enableWBSPredecessor:!1,editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,allowIndent:!1,editMode:"normal",beginEditAction:"dblclick",rowPosition:"belowselectedrow",showDeleteConfirmDialog:!1},flatRecords:[],parentRecords:[],currentViewData:[],updatedRecords:[],selectedItems:[],ids:[],allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",allowMultiSorting:!1,sortSettings:{sortedColumns:[]},enableAltRow:!0,enableVirtualization:!1,progressbarHeight:100,taskbarTooltipTemplate:"",progressbarTooltipTemplate:"",taskbarTooltipTemplateId:"",dateFormat:"",resourceIdMapping:"",resourceNameMapping:"",resourceUnitMapping:"",progressbarTooltipTemplateId:"",taskbarEditingTooltipTemplateId:"",taskbarEditingTooltipTemplate:"",selectedRowIndex:-1,allowGanttChartEditing:!0,sizeSettings:{height:"",width:""},selectedItem:null,selectionType:"single",selectionMode:"row",selectedCellIndexes:[],weekendBackground:"",baselineColor:"#fba41c",treeColumnIndex:0,editDialogFields:[],addDialogFields:[],columnDialogFields:[],renderBaseline:!1,enableContextMenu:!1,enableResize:!0,isResponsive:!0,enableCollapseAll:!1,enablePredecessorValidation:!0,taskbarTemplate:"",parentTaskbarTemplate:"",milestoneTemplate:"",durationUnitMapping:"",dayWorkingTime:[{from:"08:00 AM",to:"12:00 PM"},{from:"01:00 PM",to:"05:00 PM"}],exportToExcelAction:"",exportToPdfAction:"",workWeek:["Monday","Tuesday","Wednesday","Thursday","Friday"],rowSelecting:null,rowSelected:null,rowDragStart:null,rowDrag:null,rowDragStop:null,cellSelecting:null,cellSelected:null,queryCellInfo:null,queryTaskbarInfo:null,beginEdit:null,endEdit:null,rowDataBound:null,expanding:null,expanded:null,collapsing:null,collapsed:null,actionBegin:null,actionComplete:null,taskbarEditing:null,taskbarEdited:null,load:null,create:null,splitterResized:null,contextMenuOpen:null,enableSerialNumber:!1,taskbarClick:null,taskbarHeight:20,criticalTask:"",toolbarClick:null,predecessorTooltipTemplate:"",allowUnscheduledTask:!1},dataTypes:{viewType:"string",resourceCollectionMapping:"string",taskCollectionMapping:"string",groupIdMapping:"string",groupCollection:"array",groupNameMapping:"string",nonWorkingBackground:"string",highlightNonWorkingTime:"boolean",allowSorting:"boolean",allowColumnResize:"boolean",allowSelection:"boolean",searchSettings:{fields:"array"},dragTooltip:{tooltipItems:"array"},columnDialogFields:"array",dataSource:"data",query:"data",taskIdMapping:"string",parentTaskIdMapping:"string",taskNameMapping:"string",startDateMapping:"string",endDateMapping:"string",baselineStartDateMapping:"string",baselineEndDateMapping:"string",childMapping:"string",durationMapping:"string",milestoneMapping:"string",progressMapping:"string",predecessorMapping:"string",resourceInfoMapping:"string",taskSchedulingModeMapping:"string",notesMapping:"string",workMapping:"string",resources:"array",holidays:"array",dayWorkingTime:"array",highlightWeekends:"boolean",scheduleStartDate:"data",scheduleEndDate:"data",enableProgressBarResizing:"boolean",rowHeight:"number",includeWeekend:"boolean",taskSchedulingMode:"string",validateManualTasksOnLinking:"boolean",toolbarSettings:{showToolbar:"boolean",toolbarItems:"array",customToolbarItems:"array"},stripLines:"array",scheduleHeaderSettings:"data",roundOffDayworkingTime:"boolean",taskbarBackground:"string",progressbarBackground:"string",connectorLineBackground:"string",parentTaskbarBackground:"string",parentProgressbarBackground:"string",connectorlineWidth:"number",readOnly:"boolean",showTaskNames:"boolean",leftTaskLabelMapping:"string",rightTaskLabelMapping:"string",leftTaskLabelTemplate:"string",rightTaskLabelTemplate:"string",showProgressStatus:"boolean",showResourceNames:"boolean",enableTaskbarDragTooltip:"boolean",enableTaskbarTooltip:"boolean",editSettings:"data",flatRecords:"array",parentRecords:"array",currentViewData:"array",ids:"array",updatedRecords:"array",allowKeyboardNavigation:"boolean",cssClass:"string",locale:"string",allowMultiSorting:"boolean",showGridExpandCellTooltip:"boolean",sortSettings:{sortedColumns:"array"},filterSettings:{filteredColumns:"array",filterType:"string"},enableAltRow:"boolean",enableVirtualization:"boolean",progressbarHeight:"number",taskbarTooltipTemplate:"string",progressbarTooltipTemplate:"string",taskbarTooltipTemplateId:"string",dateFormat:"string",resourceIdMapping:"string",resourceNameMapping:"string",resourceUnitMapping:"string",progressbarTooltipTemplateId:"string",taskbarEditingTooltipTemplateId:"string",taskbarEditingTooltipTemplate:"string",allowGanttChartEditing:"boolean",size:{height:"string",width:"string"},weekendBackground:"string",baselineColor:"string",renderBaseline:"boolean",enableContextMenu:"boolean",showGridCellTooltip:"boolean",treeColumnIndex:"number",editDialogFields:"array",addDialogFields:"array",showColumnChooser:"boolean",enableResize:"boolean",isResponsive:"boolean",enableCollapseAll:"boolean",enablePredecessorValidation:"boolean",enableSerialNumber:"boolean",durationUnitMapping:"string",taskbarTemplate:"string",parentTaskbarTemplate:"string",milestoneTemplate:"string",taskbarHeight:"number",criticalTask:"string",workWeek:"array",predecessorTooltipTemplate:"string",allowUnscheduledTask:"boolean"},ignoreOnExport:["isEdit","toolbarClick","query","queryCellInfo","selectionType","currentViewData","enableRTL","rowDataBound","editSettings","localization","cssClass","dataSource","allowKeyboardNavigation"],observables:["selectedItem","selectedRowIndex","selectedCellIndexes","splitterPosition","dataSource","splitterSettings.position"],selectedItem:t.util.valueFunction("selectedItem"),selectedRowIndex:t.util.valueFunction("selectedRowIndex"),selectedCellIndexes:t.util.valueFunction("selectedCellIndexes"),splitterPosition:t.util.valueFunction("splitterSettings.position"),dataSource:t.util.valueFunction("dataSource"),_splitterPosition:t.util.valueFunction("splitterPosition"),getColumns:function(){return this._columns},setColumns:function(e){this._columns=e},getResourceViewEditColumns:function(){return this._resourceViewColumns},customColumnFields:function(){for(var e,t=this,i=t._columns,a=i.length,r=0;r<a;r++)t._columnHeaderTexts[i[r].field]||(t._columnHeaderTexts[i[r].field]=i[r].headerText);if("resourceView"==this.model.viewType)for(r=0;r<t._resourceViewColumns.length;r++)e=t._resourceViewColumns[r],t._columnHeaderTexts[e.field]||(t._columnHeaderTexts[e.field]=e.headerText),e.editType||(e.editType="stringedit")},_init:function(){var e=this,i=e.model,a=i.scheduleHeaderSettings.minutesPerInterval;i.durationUnit;i.isdesignMode&&(i.taskIdMapping="Id",i.taskNameMapping="Name",i.startDateMapping="StartDate",i.durationMapping="Duration",i.progressMapping="Progress",i.scheduleStartDate="02/23/2014",i.scheduleEndDate="03/10/2014",this.dataSource([{Id:1,Name:"Task 1",StartDate:"02/23/2014",Duration:5,Progress:40},{Id:2,Name:"Task 2",StartDate:"02/24/2014",Duration:5,Progress:40},{Id:3,Name:"Task 3",StartDate:"02/25/2014",Duration:5,Progress:40}]),i.sizeSettings.height="300px",i.sizeSettings.width="800px"),i.scheduleStartDate||i.scheduleEndDate||"auto"!=a||(i.scheduleHeaderSettings.minutesPerInterval=t.Gantt.minutesPerInterval.FiveMinutes),""!=i.workMapping&&(i.taskType=t.Gantt.TaskType.FixedWork),e._initPrivateProperties(),e._trigger("load"),e.element.addClass("e-gantt-core"),0==i.workWeek.length&&(i.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]),e._getNonWorkingDayIndex(),this._updateProperties(),this.isProjectViewData&&i.viewType==t.Gantt.ViewType.HistogramView?(i.viewType=t.Gantt.ViewType.ProjectView,i.readOnly=!0):!1===this.isProjectViewData&&i.viewType==t.Gantt.ViewType.HistogramView&&(i.viewType=t.Gantt.ViewType.ResourceView,i.readOnly=!0),null!==this.dataSource()&&i.viewType==t.Gantt.ViewType.ProjectView?this._checkDataBinding():null!==this.dataSource()&&i.viewType==t.Gantt.ViewType.ResourceView?this._checkResourceDataBinding():e._initialize()},_updateProperties:function(){var e=this.model;"resourceView"==e.viewType&&(e.enableWBS=!1,e.enableWBSPredecessor=!1)},_setTaskbarHeight:function(e){this.taskbarHeight=e<this.model.rowHeight?e:this.model.rowHeight,this._milesStoneWidth=2*Math.floor(this.taskbarHeight/2)},_deSelectRowItem:function(){var e=this,t=e.model;e._$ganttchartHelper.ejGanttChart("selectRows",-1),e._$treegridHelper.ejTreeGrid("selectRows",-1),this.selectedRowIndex(-1),t.selectedItem=null,t.selectedItems=[]},_initResourceDataSource:function(){var e=this,i=(e.model,this._columnToSelect());this.dataSource().executeQuery(i).done(t.proxy(function(t){e._retrivedData=t.result,e._isFlatResourceData?e._reConstructResourceData(e._retrivedData):e.secondaryDatasource=e._retrivedData,e._createResourceRecords(e.secondaryDatasource),e._initialize(),e._trigger("actionComplete",{requestType:"create"})}))},_reConstructResourceData:function(t){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_=this.model;if(_.groupIdMapping.length>0&&this._groupCollection&&this._groupCollection.length>0&&_.resources.length>0){for(i=e.extend(!0,[],this._groupCollection),r=0;r<i.length;r++)this._groupIds.push(i[r][_.groupIdMapping]);this.secondaryDatasource=i}if(_.resourceIdMapping.length>0&&_.resources&&_.resources.length>0){for(a=e.extend(!0,[],_.resources),o=-1,_.resourceCollectionMapping||(_.resourceCollectionMapping="eResourceCollection"),n=_.resourceCollectionMapping,l=0;l<a.length;l++)this._resourceIds.push(a[l][_.resourceIdMapping]),_.groupIdMapping&&this._groupIds.length>0&&(-1!=(o=this._groupIds.indexOf(a[l][_.groupIdMapping]))?i[o][n]?i[o][n].push(a[l]):(i[o][n]=[],i[o][n].push(a[l])):this.secondaryDatasource.push(a[l]));0==this.secondaryDatasource.length&&(this.secondaryDatasource=a)}for(d=0;d<t.length;d++)if(s=t[d],c=t[d][_.resourceInfoMapping],_.taskCollectionMapping||(_.taskCollectionMapping="eTaskCollections"),u=_.taskCollectionMapping,c&&c.length>0)for(p=0;p<c.length;p++)m=-1,g="object"==typeof(h=c[p])?h[_.resourceIdMapping]:h,_.resourceIdMapping.length>0&&_.resources&&_.resources.length>0&&(-1!=(m=this._resourceIds.indexOf(g))&&a.length>0?a[m][u]?a[m][u].push(s):(a[m][u]=[],a[m][u].push(s)):this.secondaryDatasource.push(t[d]));else this.secondaryDatasource.push(t[d]);return this.secondaryDatasource},_checkHistoGramDataBinding:function(){var i,a,r,n,o,l,d,s,c,u=this,p=u.model,h=p.flatRecords,g=e.extend(!0,[],p.resources);for(p.ids=[],g.forEach(function(e,t){e.eResourceChildTasks=[],e.level=0,e.taskId=e[p.resourceIdMapping],e.index=t,e.isAltRow=t%2!=0,e.eResourceName=p.resources[t][p.resourceNameMapping],e.expanded=!0,e.hasChildRecords=!1,e.item=p.resources[t],p.ids.push(e.taskId.toString())}),u._histoGramChildTasks=[],u._histoGramChildTaskIds=[],i=0;i<h.length;i++)if(a=h[i],this.isProjectViewData){if(l=a.resourceInfo,-1==u._histoGramChildTasks.indexOf(a)&&-1==u._histoGramChildTaskIds.indexOf(a.taskId.toString())&&(u._histoGramChildTasks.push(a),u._histoGramChildTaskIds.push(a.taskId.toString())),!l||l&&0==l.length)continue;for(d=0;d<l.length;d++)s=l[d],c=g[p.ids.indexOf(s[p.resourceIdMapping].toString())],s[p.resourceIdMapping]==c.item[p.resourceIdMapping]&&c.eResourceChildTasks.push(a)}else{if(t.isNullOrUndefined(a.item[p.resourceIdMapping])||0==a.item[p.resourceIdMapping].length)continue;for((c=g[p.ids.indexOf(a.item[p.resourceIdMapping].toString())]).eResourceChildTasks=[],r=0;r<a.eResourceChildTasks.length;r++)o=a.eResourceChildTasks[r],-1==u._histoGramChildTasks.indexOf(o)&&-1==u._histoGramChildTaskIds.indexOf(o.taskId.toString())?(u._histoGramChildTasks.push(o),u._histoGramChildTaskIds.push(o.taskId.toString())):(n=u._histoGramChildTaskIds.indexOf(o.taskId.toString()),o=u._histoGramChildTasks[n]),c.eResourceChildTasks.push(o)}p.flatRecords=g,p.allowSelection=!1,p.updatedRecords=p.flatRecords.slice(),p.currentViewData=p.flatRecords.slice(),p.parentRecords=p.flatRecords.slice(),this._updateHistoData()},_updateHistoData:function(){for(var e,t=this.model.flatRecords,i=t.length,a=0;a<i;a++)e=t[a],this._updateHistoWorkValues(e)},_validateRanges:function(e,t){var i=this._getItemByFieldValue(e,"rangeId",t.rangeId);i?this._pushUniqueValue(i.tasks,t.tasks):e.push(t)},_updateHistoWorkValues:function(e){var i,a,r,n=this._setSortedChildTasks(e),o=(n.length,[]),l={};o=[];if(n&&0==n.length)e.workTimelineRanges=o;else{for(i=n[0].startDate,a=t.max(n,"endDate").endDate;i.getTime()<a.getTime();)r=this._getMinDateForRange(n,i),(l={}).startDate=new Date(i),l.endDate=new Date(r),l.tasks=this._getTaskByRange(i,r,n),i=new Date(r),l.tasks.length>0&&o.push(l);o=this._splitRangeCollection(o,"startDate","endDate",!0),this._calculateWorkWithRanges(o,e),e.workTimelineRanges=o}},_calculateWorkWithRanges:function(e,t){for(var i,a=this.model,r=a.rowHeight-7,n=0;n<e.length;n++){var o=e[n],l=o.startDate,d=o.endDate,s=this._checkStartDate(l,t,!1),c=this._checkEndDate(d,t),u=s.getTime()<c.getTime()?this._getDuration(s,c,"day",!0):0,p=this._getTaskLeft(s,!1),h=o.tasks,g=this._getTaskWidth(s,c),m=this._secondsPerDay/3600,_=0;for(i=0;i<h.length;i++){_+=m*(h[i].resourceInfo.filter(function(e){return e[a.resourceIdMapping]==t[a.resourceIdMapping]})[0][a.resourceUnitMapping]/100)}o.left=p,o.width=g,o.duration=u,o.workPerDay=_,o.height=r*(_/m),o.totalWork=u*_,o.totalWork%1!=0&&(o.totalWork=parseFloat(o.totalWork.toFixed(2))),o.isOverAllocated=_>m}},updateHistogramTask:function(a,r){var n,o,l,d,s,c,u,p,h,g,m,_,f,w,C=this.model;switch(r){case"update":if(l=(o=a instanceof t.Gantt.GanttRecord)?a.taskId:a[C.taskIdMapping],t.isNullOrUndefined(l))break;for(d=this._histoGramChildTaskIds.indexOf(l.toString()),s=this._histoGramChildTasks[d],c=o?a:this._createGanttRecord(a,s.level,s.parentItem,i),u=["startDate","endDate","duration","resourceInfo","item","taskName","resourceNames"],p=this._getGanttColumnDetails(),h=0;h<p.customColDetails.length;h++)u.push(p.customColDetails[h].field);for(n=s.resourceInfo,g=0;g<u.length;g++)"item"==u[g]?(m=e.extend({},c.item),e.each(m,function(e,t){s.item[e]=t})):"resourceInfo"==u[g]&&c[u[g]]?s[u[g]]=e.extend(!0,[],c[u[g]]):t.isNullOrUndefined(c[u[g]])||(s[u[g]]=c[u[g]]);this._validateResourceInfoValues(s,n);break;case"add":if(l=(o=a instanceof t.Gantt.GanttRecord)?a.taskId:a.item[C.taskIdMapping],t.isNullOrUndefined(l))break;if(-1!=this._histoGramChildTaskIds.indexOf(l.toString()))break;_=new t.Gantt.GanttRecord,(c=o?e.extend(_,a):this._createGanttRecord(a,0,null,i)).resourceInfo&&(c.resourceInfo=e.extend(!0,[],a.resourceInfo)),this._histoGramChildTaskIds.push(l.toString()),this._histoGramChildTasks.push(c),this._validateResourceInfoValues(c);break;case"delete":if(l=(o=a instanceof t.Gantt.GanttRecord)?a.taskId:a[C.taskIdMapping],t.isNullOrUndefined(l))break;if(d=this._histoGramChildTaskIds.indexOf(l.toString()),s=this._histoGramChildTasks[d],n=e.extend([],s.resourceInfo),delete s.resourceInfo,this._histoGramChildTaskIds.splice(d,1),this._histoGramChildTasks.splice(d,1),this._validateResourceInfoValues(s,n),1==a.hasChildRecords)for(f=a.childRecords,w=0;w<f.length;w++)this.updateHistogramTask(f[w],r)}},_getUpdatingResourceDetails:function(t,i){for(var a=i?e.extend([],i):[],r=[],n=this.model,o={},l=0;l<t.length;l++){var d=t[l],s=d[n.resourceIdMapping],c=(d[n.resourceUnitMapping],i.filter(function(e){return e[n.resourceIdMapping]==s}));0==c.length?r.push(d):a.splice(a.indexOf(c[0]),1)}return(a.length>0||r.length>0)&&(o.added=a,o.removed=r,o.isUpdated=!0,o)},_validateResourceInfoValues:function(e,t){var i,a,r,n,o,l=this.model,d=(l.flatRecords,e.resourceInfo?e.resourceInfo:[]),s=[],c=(t=t||[],this._getUpdatingResourceDetails(t,d));if(c){if(r=c.added,n=c.removed,r.length>0)for(o=0;o<r.length;o++)i=r[o],(a=this._getRecordByTaskId(i[l.resourceIdMapping].toString())).eResourceChildTasks.push(e),-1==s.indexOf(a)&&s.push(a);if(n.length>0)for(o=0;o<n.length;o++)i=n[o],(a=this._getRecordByTaskId(i[l.resourceIdMapping].toString())).eResourceChildTasks.splice(a.eResourceChildTasks.indexOf(e),1),-1==s.indexOf(a)&&s.push(a)}for(o=0;o<d.length;o++)i=d[o],a=this._getRecordByTaskId(i[l.resourceIdMapping].toString()),-1==s.indexOf(a)&&s.push(a);this._updateRefreshHistogramTask(s)},_updateRefreshHistogramTask:function(e){for(var t=0;t<e.length;t++)this._updateHistoWorkValues(e[t]),this.refreshGanttRecord(e[t])},_getTaskByRange:function(e,t,i){for(var a=[],r=0;r<i.length;r++){var n=i[r],o=n.startDate,l=n.endDate;(o.getTime()==e.getTime()&&t.getTime()<=l.getTime()||o.getTime()<e.getTime()&&t.getTime()<=l.getTime())&&a.push(n)}return a},_getMinDateForRange:function(e,t){for(var i,a=0;a<e.length;a++){var r=e[a],n=r.startDate,o=r.endDate;(t.getTime()<n.getTime()||t.getTime()<o.getTime())&&(i||(i=t.getTime()<n.getTime()?new Date(n):new Date(o)),t.getTime()<n.getTime()&&i.getTime()>n.getTime()&&(i=new Date(n)),t.getTime()<o.getTime()&&i.getTime()>o.getTime()&&(i=new Date(o)))}return i},_pushUniqueValue:function(e,t){for(var i,a=0;a<t.length;a++)i=t[a],-1==e.indexOf(i)&&e.push(i)},_getItemByFieldValue:function(e,i,a){var r=t.Query().where(i,"equal",a),n=t.DataManager(e).executeLocal(r);return n.length>0?n[0]:null},_checkResourceDataBinding:function(){var e,i=this,a=i.model;null==this.dataSource()&&this.dataSource([]),this.dataSource()instanceof t.DataManager?this._initResourceDataSource():this.dataSource().length>0||a.resources&&a.resources.length>0?(this._isFlatResourceData?(e=this._reConstructResourceData(this.dataSource()),this._createResourceRecords(e)):this._createResourceRecords(this.dataSource()),this._initialize()):this._initialize(),i.model.allowSelection&&"multiple"==i.model.selectionType&&"row"==i.model.selectionMode&&i._renderMultiSelectionPopup()},_isInStartDateRange:function(e,t,i){var a=!1;return e.getTime()>=t.getTime()&&e.getTime()<i.getTime()&&(a=!0),a},_isInEndDateRange:function(e,t,i){var a=!1;return e.getTime()>t.getTime()&&e.getTime()<=i.getTime()&&(a=!0),a},_setSortedChildTasks:function(e){var i=[],a=t.Query().sortBy("startDate",t.sortOrder.Ascending);return i=t.DataManager(e.eResourceChildTasks).executeLocal(a),e.eResourceChildTasks=i.slice(),e.eResourceChildTasks},_mergeRangeCollections:function(e,i){for(var a,r,n,o,l=t.Query().sortBy("from",t.sortOrder.Ascending),d=[],s={},c={},u=t.DataManager(e).executeLocal(l),p=0;p<u.length;p++)0!=d.length||0!=p?(a=(s=d[d.length-1]).from,r=s.to,n=(c=u[p]).from,o=c.to,a.getTime()==n.getTime()&&r.getTime()>=o.getTime()||a.getTime()<n.getTime()&&r.getTime()>=o.getTime()||(a.getTime()<=n.getTime()&&r.getTime()>=n.getTime()&&r.getTime()<o.getTime()||r.getTime()<n.getTime()&&this._checkStartDate(r).getTime()==n.getTime()?s.to=o:r.getTime()<n.getTime()&&this._checkStartDate(r).getTime()!=n.getTime()&&d.push(u[p]))):d.push(u[p]);return i&&(d=this._splitRangeCollection(d)),d},_getRangeWithWeekSplit:function(e,t,i,a){for(var r=[],n=0;n<e.length;n++)r.push.apply(r,this._splitRangeForWeekMode(e[n],t,i,a));return r},_splitRangeCollection:function(e,i,a,r){var n,o=[];switch(this.model.scheduleHeaderSettings.scheduleHeaderType){case t.Gantt.ScheduleHeaderType.Month:if(!r)return e;o=this._getRangeWithWeekSplit(e,i,a);case t.Gantt.ScheduleHeaderType.Year:case t.Gantt.ScheduleHeaderType.QuarterYear:case t.Gantt.ScheduleHeaderType.HalfYear:if(!r)return e;o=this._getRangeWithWeekSplit(e,i,a,!0);break;case t.Gantt.ScheduleHeaderType.Week:o=this._getRangeWithWeekSplit(e,i,a);break;case t.Gantt.ScheduleHeaderType.Day:if(0==this._workingTimeRanges[0].from&&86400==this._workingTimeRanges[0].to)o=this._getRangeWithWeekSplit(e,i,a);else for(n=0;n<e.length;n++)o.push.apply(o,this._splitRangeForDayMode(e[n],i,a));break;case t.Gantt.ScheduleHeaderType.Hour:if(0==this._workingTimeRanges[0].from&&86400==this._workingTimeRanges[0].to)o=this._getRangeWithWeekSplit(e,i,a);else for(n=0;n<e.length;n++)o.push.apply(o,this._splitRangeForHourMode(e[n],i,a))}return o},_isOnHolidayOrWeekEnd:function(e,i){var a,r,n,o;if(!(i=t.isNullOrUndefined(i)?this.model.includeWeekend:i)&&-1!=this._nonWorkingDayIndex.indexOf(e.getDay()))return!0;for(a=this.model.holidays,r=0;r<a.length;r++)if(n=this._getDateFromFormat(a[r].day),o=new Date(n),n.setHours(0,0,0,0),o.setHours(23,59,59,59),e.getTime()>=n.getTime()&&e.getTime()<o.getTime())return!0},_splitRangeForWeekMode:function(t,i,a,r){var n,o=i||"from",l=a||"to",d=new Date(t[o]),s=new Date(t[o]),c=new Date(t[l]),u=!1,p=[],h={};if(s.setDate(s.getDate()+1),s.getTime()<c.getTime()){do{this._isOnHolidayOrWeekEnd(s,r)?((n=new Date(s)).setDate(s.getDate()-1),this._setTime(this._defaultEndTime,n),(h={})[o]=d,h.isSplit=!0,h[l]=n,t.tasks&&(h.tasks=e.extend([],t.tasks)),d.getTime()!=n.getTime()&&p.push(h),d=this._checkStartDate(n),s=new Date(d),u=!0):s.setDate(s.getDate()+1)}while(s.getTime()<c.getTime());u?d.getTime()!=c.getTime()&&(h={},t.tasks&&(h.tasks=e.extend([],t.tasks)),h[o]=d,h[l]=c,h.isSplit=!0,p.push(h)):p.push(t)}else p.push(t);return p},_splitRangeForDayMode:function(t,i,a){var r,n,o=i||"from",l=a||"to",d=(new Date(t[o]),new Date(t[o])),s=new Date(t[l]),c=[],u={};if(d.getTime()<s.getTime())do{r=new Date(d),n=new Date(d),this._setTime(this._defaultEndTime,n),n.getTime()<s.getTime()?(u={},t.tasks&&(u.tasks=e.extend([],t.tasks)),u[o]=r,u[l]=n,u.isSplit=!0,c.push(u)):(u={},t.tasks&&(u.tasks=e.extend([],t.tasks)),u[o]=r,u[l]=s,u.isSplit=!0,c.push(u)),d=this._checkStartDate(n)}while(d.getTime()<s.getTime());else c.push(t);return c},_splitRangeForHourMode:function(t,i,a){var r,n,o,l=i||"from",d=a||"to",s=(new Date(t[l]),new Date(t[l])),c=new Date(t[d]),u=[];if(s.getTime()<c.getTime())do{var p,h=new Date(s),g=new Date(s),m=-1,_=0;for(p=this._getSecondsInDecimal(s),n=0;n<this._workingTimeRanges.length;n++)if(p>=(o=this._workingTimeRanges[n]).from&&p<=o.to){m=n;break}-1!=m&&(_=Math.round(this._workingTimeRanges[m].to-p),g.setSeconds(g.getSeconds()+_)),g.getTime()<c.getTime()?(r={},t.tasks&&(r.tasks=e.extend([],t.tasks)),r[l]=h,r[d]=g,r.isSplit=!0,u.push(r)):(r={},t.tasks&&(r.tasks=e.extend([],t.tasks)),r[l]=h,r[d]=c,r.isSplit=!0,u.push(r)),s=this._checkStartDate(g)}while(s.getTime()<c.getTime());else u.push(t);return u},_calculateRangeLeftWidth:function(e){for(var t=0;t<e.length;t++)e[t].left=this._getTaskLeft(e[t].from),e[t].width=this._getTaskWidth(e[t].from,e[t].to)},_updateOverlappingIndex:function(e){for(var t,i,a,r,n,o,l=[],d=1,s=0;s<e.length;s++){var c=e[s],u=new Date(c.startDate),p=new Date(c.endDate);if(c.eOverlapIndex=1,0!=l.length)for(t=l.length,i=0;i<t;i++){if(a=l[i].from,r=l[i].to,!this._isInStartDateRange(u,a,r)&&!this._isInEndDateRange(p,a,r)){c.eOverlapIndex=i+1,o=[],(n=[]).push(l[i]),n.push({from:u,to:p}),(o=this._mergeRangeCollections(n)).length>1?l[i]=o[1]:1==o.length&&(l[i]=o[0]),d<c.eOverlapIndex&&(d=c.eOverlapIndex);break}c.eOverlapIndex=i+2,d<c.eOverlapIndex&&(d=c.eOverlapIndex,l.push({from:u,to:p}))}else l.push({from:u,to:p})}},_updateOverlappingValues:function(e,t){var i,a,r,n,o,l=e.eResourceChildTasks,d=1,s=[],c=e.eOverlapIndex;if(l.length<=1)return 1==l.length&&(l[0].eOverlapIndex=1,l[0].eOverlapped=!1),e.eRangeValues=[],e.eOverlapIndex=1,void(e.eOverlapped=!1);for(l=this._setSortedChildTasks(e),this._updateOverlappingIndex(l),a=1;a<l.length;a++){i=l[a];var u=new Date(i.startDate),p=new Date(i.endDate),h=[],g={};for(r=0;r<a;r++)n=l[r].startDate,o=l[r].endDate,g={},(this._isInStartDateRange(u,n,o)||this._isInEndDateRange(p,n,o))&&(n.getTime()>u.getTime()&&n.getTime()<p.getTime()&&o.getTime()>u.getTime()&&o.getTime()>p.getTime()||u.getTime()==n.getTime()&&p.getTime()<=o.getTime()?(g.from=n,g.to=p):u.getTime()==n.getTime()&&p.getTime()>o.getTime()?(g.from=n,g.to=o):u.getTime()>n.getTime()&&p.getTime()>=o.getTime()?(g.from=u,g.to=o):u.getTime()>n.getTime()&&p.getTime()<o.getTime()&&(g.from=u,g.to=p),g.task1=l[r],g.task2=i,h.push(g),!0,i.eOverlapWithIndex=r,i.eOverlapped=l[r].eOverlapped=!0,d<i.eOverlapIndex&&(d=i.eOverlapIndex));s.push.apply(s,this._mergeRangeCollections(h))}e.eRangeValues=this._mergeRangeCollections(s,!0),this._calculateRangeLeftWidth(e.eRangeValues),e.eOverlapIndex=d,e.eOverlapped=d>1,t&&!this._isOverlapIndexChanged&&d!=c&&(this._isOverlapIndexChanged=!0)},_removeResources:function(e){var t,i,a,r=[],n=e.data,o=[],l=[],d=[];if(this._resourceUpdatedTasksIds=[],"resourceTask"==n.eResourceTaskType&&n.parentItem&&1==n.parentItem.childRecords.length&&(n=n.parentItem),"groupTask"==n.eResourceTaskType?(r=n.childRecords,this._removeFromResourceCollection(n,"group")):"resourceTask"==n.eResourceTaskType?r.push(n):"unassignedTask"==n.eResourceTaskType&&(this._isFlatResourceData&&this._removeDataFromDataSource(n.item),-1!=(t=this._resourceUniqTaskIds.indexOf(n.taskId.toString()))&&(this._resourceUniqTaskIds.splice(t,1),this._resourceUniqTasks.splice(t,1))),r&&r.length>0)for(i=0;i<r.length;i++)this._deleteResources(r[i],o),this._removeFromResourceCollection(r[i],"resource");for(i=0;i<o.length;i++)(a=o[i]).parentItem=null,a.level=0,a.index=a.taskId,a.eOverlapIndex=1,a.eResourceTaskType="unassignedTask",a.eResourceName=this._unassignedText,l.push(a.taskId.toString()),d.push(a.item),this._removeResourceChildTask(a);e.returnObj={tasks:o,ids:l,unAssignedTasksItems:d},this._isFlatResourceData||this._updateResourceData(n,e),e.returnObj.dataSource=this.dataSource(),e.returnObj.jsondata=this._jsonData,this._triggerResourceUpdate(),this._resourceUpdatedTasksIds=[]},_triggerResourceUpdate:function(e){var t,i,a=e||this._resourceUpdatedTasksIds,r={};if(a&&a.length>0){for(r.requestType="recordUpdate",i=0;i<a.length;i++)t=this._getRecordByTaskId(a[i]),0==i?r.data=t:(r.updatedRecords||(r.updatedRecords=[]),r.updatedRecords.push(t));this._trigger("actionComplete",r)}},_removeFromResourceCollection:function(e,t){for(var i=this.model,a="resource"==t?this._resourceCollection:this._groupCollection,r="resource"==t?i.resourceIdMapping:i.groupIdMapping,n=0;n<a.length;n++)if(a[n][r]==e.taskId){a.splice(n,1);break}},_updateResourceData:function(e,i){var a=this,r=a.dataSource(),n=a.model,o=-1;"groupTask"==e.eResourceTaskType||"resourceTask"==e.eResourceTaskType&&t.isNullOrUndefined(e.parentItem)||"unassignedTask"==e.eResourceTaskType?r instanceof t.DataManager?r.dataSource.offline&&r.dataSource.json?-1!==(o=r.dataSource.json.indexOf(e.item))&&r.dataSource.json.splice(o,1):this._isDataManagerUpdate&&(a._jsonData.indexOf(e.item),a._jsonData.splice(a._jsonData.indexOf(e.item),1)):-1!=r.indexOf(e.item)&&r.splice(r.indexOf(e.item),1):"resourceTask"==e.eResourceTaskType&&e.parentItem&&e.parentItem.item[n.resourceCollectionMapping].splice(e.parentItem.childRecords.indexOf(e),1),i.returnObj.unAssignedTasksItems.length>0&&(r instanceof t.DataManager?r.dataSource.offline&&r.dataSource.json?r.dataSource.json.push.apply(r.dataSource.json,i.returnObj.unAssignedTasksItems):this._isDataManagerUpdate&&a._jsonData.push.apply(a._jsonData,i.returnObj.unAssignedTasksItems):r.push.apply(r,i.returnObj.unAssignedTasksItems))},_removeResourceChildTask:function(e){var t,i,a;if(-1!=this._resourceChildTasks.indexOf(e)&&(t=this._resourceChildTasks.splice(this._resourceChildTasks.indexOf(e),1),-1!=(i=this._resourceUniqTasks.indexOf(t[0]))))for(a=0;a<this._resourceChildTasks.length;a++)if(this._resourceChildTasks[a].taskId==t[0].taskId){this._resourceUniqTasks[i]=this._resourceChildTasks[a];break}},_deleteResources:function(e,i,a){for(var r,n,o,l=t.isNullOrUndefined(a)?e.taskId:a,d=e.eResourceChildTasks,s=this.model,c=0;c<d.length;c++){if(t.isNullOrUndefined(a)&&this._removeResourceChildTask(d[c]),(r=d[c].resourceInfo).length>0){for(n=0;n<r.length;n++)r[n][s.resourceIdMapping]==l?(r.splice(n,1),n--,-1==this._resourceUpdatedTasksIds.indexOf(d[c].taskId.toString())&&this._resourceUpdatedTasksIds.push(d[c].taskId.toString())):t.isNullOrUndefined(a)&&(o=s.flatRecords[s.ids.indexOf("R_"+r[n][s.resourceIdMapping])],this._deleteResources(o,i,l));0==r.length&&i.push(d[c])}this._updateResourceName(d[c]),this._updateResourceRelatedFields(d[c])}},deleteResourceChildTask:function(e){var t,i,a,r,n,o,l,d,s,c,u=this.model;if(e&&((n={}).data=e,n.modifiedRecord=e,n.isCompleteRemove=e.resourceInfo.length<=1,n.requestType=n.isCompleteRemove?"delete":"save",n.item=e.item,!this._trigger("actionBegin",n))){if(this._isOverlapIndexChanged=!1,r=(a=e.parentItem).eOverlapIndex,e.resourceInfo.length>0)for(t=this._getExistingTaskWithID(e,!0),o=0;o<t.length;o++){if(l=t[o].resourceInfo,d=a.taskId,l.length>0)for(s=0;s<l.length;s++)l[s][u.resourceIdMapping]==d&&(l.splice(s,1),s--);this._updateResourceName(t[o]),this._updateResourceRelatedFields(t[o])}0==e.resourceInfo.length&&(-1!=(c=this._resourceUniqTaskIds.indexOf(e.taskId.toString()))&&(this._resourceUniqTasks.splice(c,1),this._resourceUniqTaskIds.splice(c,1),u.predecessorMapping&&e.predecessor&&this._removePredecessor(e.predecessor,e))),a.eResourceChildTasks.splice(a.eResourceChildTasks.indexOf(e),1),this._removeResourceChildTask(e),this._isFlatResourceData&&e.resourceInfo.length<1?this._removeDataFromDataSource(e.item):this._isFlatResourceData||-1!=(i=a.item[u.taskCollectionMapping].indexOf(e.item))&&a.item[u.taskCollectionMapping].splice(i,1),this._updateOverlappingValues(a),this._updateResourceParentItem(a),this.refreshGanttRecord(a),r!=a.eOverlapIndex&&this._refreshGanttHeightWithRecords(),(n={}).data=e,n.item=e.item,n.modifiedRecord=e,n.isCompleteRemove=0==e.resourceInfo.length,n.requestType=n.isCompleteRemove?"delete":"save",this._trigger("actionComplete",n)}},_createResourceRecords:function(e){for(var t,a,r=this,n=r.model,o=n.flatRecords,l=e.length,d=0,s=n.parentRecords,c=r.model.ids;d<l;d++)a=e.length,null!=(t=r._createResourceRecord(e[d],0,null,i,"Load"))?(r._storedIndex++,c[r._storedIndex]=this._getFormattedTaskId(t),t.isAltRow=r._storedIndex%2!=0,t.index=r._storedIndex,o.push(t),s.push(t),t.childRecords&&r._addNestedGanttRecords(t.childRecords,!0)):a!=e.length&&(d--,l--);this._isFlatResourceData||this._updateResourceInfo(),n.predecessorMapping&&r._ensurePredecessorCollection(),n.enableWBS&&n.enableWBSPredecessor&&r.createWBSPredecessor()},_getItemValueByUsingId:function(e,t,i){return i[t.indexOf(e)]},_createResourceRecord:function(e,a,r){var n,o,l,d,s,c,u,p=this.model,h=e[p.groupNameMapping],g=e[p.resourceNameMapping],m=[],_=new t.Gantt.GanttRecord;if(h){if((m=e[p.resourceCollectionMapping])||(m=[]),0==m.length)return this._removeDataFromDataSource(e),null;if(_.taskName=_.eResourceName=h,_.level=a,_.taskId=p.groupIdMapping?e[p.groupIdMapping]:null,_.eResourceTaskType="groupTask",_.durationUnit=p.durationUnitMapping&&e[p.durationUnitMapping]?this._validateDurationUnitMapping(e[p.durationUnitMapping]):p.durationUnit,_.item=this._isFlatResourceData?this._getItemValueByUsingId(e[p.groupIdMapping],this._groupIds,this._groupCollection):e,this._updateCustomField(_.item,_),this._isFlatResourceData||((n={})[p.groupIdMapping]=t.isNullOrUndefined(_.taskId)?this._groupCollection.length+1:_.taskId,n[p.groupNameMapping]=_.taskName,this._groupCollection.push(n),_.taskId=n[p.groupIdMapping]),m.length>0)for(_.hasChildRecords=!0,_.expanded=!0,o=0;o<m.length;o++)d=this._createResourceRecord(m[o],a+1,_),_.childRecords||(_.childRecords=[]),d&&_.childRecords.push(d);this._updateExpandStateMappingValue(_.item,_)}else if(g)for((l=e[p.taskCollectionMapping])||(l=[]),_.eResourceName=_.taskName=g,_.item=this._isFlatResourceData?this._getItemValueByUsingId(e[p.resourceIdMapping],this._resourceIds,this._resourceCollection):e,_.level=a,_.parentItem=r,_.taskId=p.resourceIdMapping?e[p.resourceIdMapping]:null,_.eResourceTaskType="resourceTask",this._updateCustomField(_.item,_),this._isFlatResourceData||((s={})[p.resourceIdMapping]=t.isNullOrUndefined(_.taskId)?this._resourceCollection.length+1:_.taskId,s[p.resourceNameMapping]=_.eResourceName,s[p.groupIdMapping]=_.parentItem?_.parentItem.taskId:null,this._resourceCollection.push(s),_.taskId=s[p.resourceIdMapping]),c=0;c<l.length;c++){if([],u=this._getExistingTaskWithID(l[c]))d=this._createGanttRecord(u[0].item,a,_,i,"Load"),l[c]=u[0].item,-1!=this._predecessorsCollection.indexOf(d)&&this._predecessorsCollection.splice(this._predecessorsCollection.indexOf(d),1);else{if(0==(d=this._createGanttRecord(l[c],a,_,i,"Load")).duration)continue;this._resourceUniqTaskIds.push(d.taskId.toString()),this._resourceUniqTasks.push(d),this._updateLastInsertedId(d.taskId,!1)}this._resourceChildTasks.push(d),d.eResourceTaskType="resourceChildTask",_.eResourceChildTasks.push(d)}else g||h||((u=this._getExistingTaskWithID(e))?(_=null,this._removeDataFromDataSource(e)):0!=(_=this._createGanttRecord(e,0,null,i,"Load")).duration?(_.eResourceName=this._unassignedText,_.eResourceTaskType="unassignedTask",this._resourceUniqTaskIds.push(_.taskId.toString()),this._resourceUniqTasks.push(_),this._updateLastInsertedId(_.taskId,!1)):_=null);return _},_removeDataFromDataSource:function(e){var i=this.dataSource();i instanceof t.DataManager?i.dataSource.offline&&i.dataSource.json&&-1!=i.dataSource.json.indexOf(e)?i.dataSource.json.splice(i.dataSource.json.indexOf(e),1):this._isDataManagerUpdate&&-1!=this._jsonData.indexOf(e)&&this._jsonData.splice(this._jsonData.indexOf(e),1):-1!=i.indexOf(e)&&i.splice(i.indexOf(e),1)},_insertDataInDataSource:function(e){var i=this.dataSource();i instanceof t.DataManager?i.dataSource.offline&&i.dataSource.json?i.dataSource.json.push(e):this._isDataManagerUpdate&&this._jsonData.push(e):i&&i.push(e)},_getCombinedResource:function(e){for(var t,i=[],a=this.model,r=0;r<e.length;r++)(t={})[a.resourceIdMapping]=e[r].parentItem.taskId,t[a.resourceNameMapping]=e[r].parentItem.eResourceName,i.push(t);return i},_updateResourceInfo:function(){for(var i,a,r,n=this.model,o=t.DataManager(this._resourceChildTasks).executeLocal(t.Query().group("taskId")),l=0;l<o.length;l++)if(o[l].count>0)for(i=this._getCombinedResource(o[l].items),a=o[l].items,r=0;r<a.length;r++)a[r].resourceInfo=e.extend(!0,[],i),this._updateResourceName(a[r]),n.workMapping||a[r]._updateWorkWithDuration(this)},_getExistingTaskWithID:function(e,i){var a=this.model,r=[];return(a.taskIdMapping&&e[a.taskIdMapping]||!t.isNullOrUndefined(e))&&(r=this._resourceChildTasks.filter(function(t){return!!(!i&&e[a.taskIdMapping]==t.taskId||i&&e.taskId==t.taskId)})),r.length>0?r:null},_checkDataBinding:function(){var i,a,r,n,o=this,l=o.model;if(null==this.dataSource()&&this.dataSource([]),this.dataSource()instanceof t.DataManager)this._initDataSource();else if(this.dataSource().length>0){if(l.taskIdMapping.length>0&&l.parentTaskIdMapping.length>0){for(i=o._retrivedData=o.dataSource(),a=[],o._taskIds=[],r=0;r<i.length;r++)n=i[r],a.push(e.extend(!0,{},n)),t.isNullOrUndefined(n[l.taskIdMapping])||o._taskIds.push(n[l.taskIdMapping]);l.childMapping||(l.childMapping="Children"),o._reconstructDatasource(a),o._createGanttRecords(o.secondaryDatasource)}else o._createGanttRecords(this.dataSource());o._initialize()}else o._initialize();o.model.allowSelection&&"multiple"==o.model.selectionType&&"row"==o.model.selectionMode&&o._renderMultiSelectionPopup()},_initDataSource:function(){var i=this,a=i.model,r=this._columnToSelect();this.dataSource().executeQuery(r).done(t.proxy(function(t){var r,n,o,l,d;if(i._retrivedData=t.result,a.taskIdMapping.length>0&&a.parentTaskIdMapping.length>0){for(r=t.result,n=[],i._taskIds=[],o=0;o<r.length;o++)l=r[o],n.push(e.extend(!0,{},l)),l[a.taskIdMapping]&&i._taskIds.push(l[a.taskIdMapping]);a.childMapping||(a.childMapping="Children"),i._reconstructDatasource(n)}else i.secondaryDatasource=i._retrivedData;i._createGanttRecords(i.secondaryDatasource),i._initialize(),d={requestType:"create"},i._trigger("actionComplete",d)}))},_columnToSelect:function(){var e=this.model,i=t.Query();return e.query?e.query:i},_intersectionObjects:function(e,t){for(var i,a=[];e.length>0&&t.length>0;)-1==(i=t.indexOf(e[0]))?e.shift():(a.push(e.shift()),t.splice(i,1));return a},_reconstructDatasource:function(e){var i,a,r,n,o,l=this,d=l.model;for(a=t.Predicate(d.parentTaskIdMapping,t.FilterOperators.notEqual,"null"),i=t.DataManager(e).executeLocal(t.Query().where(a).group(d.parentTaskIdMapping)),r=[],n=0;n<i.length;n++)!t.isNullOrUndefined(i[n].key)&&(o=l._taskIds.indexOf(i[n].key))>-1?e[o][d.childMapping]=i[n].items:r.push.apply(r,i[n].items);l.secondaryDatasource=l._intersectionObjects(e,r)},updateScheduleDates:function(e,t){var i,a,r=this,n=this.model,o=n.scheduleHeaderSettings.scheduleHeaderType;n.scheduleStartDate=e,n.scheduleEndDate=t,r._scheduleDays=[],r._scheduleMonths=[],r._scheduleWeeks=[],r._scheduleYears=[],r._scheduleHours=[],r._scheduleMinutes=[],r._calculateHeaderDates(),a=(i=r._$ganttchartHelper.ejGanttChart("instance")).model,r._isTreeGridRendered=!1,r._isGanttChartRendered=!1,r._isChartRendering=!0,r._updateGanttRecords(),"histogramView"==n.viewType&&r._updateHistoData(),a.projectStartDate=r._getDateFromFormat(r._projectStartDate),a.projectEndDate=r._getDateFromFormat(r._projectEndDate),a.scheduleDays=r._scheduleDays,a.scheduleMonths=r._scheduleMonths,a.scheduleWeeks=r._scheduleWeeks,a.scheduleYears=r._scheduleYears,a.scheduleHours=r._scheduleHours,a.scheduleMinutes=r._scheduleMinutes,a.renderBaseline=n.renderBaseline,a.scheduleHeaderSettings.scheduleHeaderType=o,a.dateFormat=n.dateFormat,a.perDayWidth=r._perDayWidth,a.durationUnit=n.durationUnit,a.scheduleHeaderSettings.weekHeaderFormat=n.scheduleHeaderSettings.weekHeaderFormat,a.scheduleHeaderSettings.dayHeaderFormat=n.scheduleHeaderSettings.dayHeaderFormat,a.scheduleHeaderSettings.hourHeaderFormat=n.scheduleHeaderSettings.hourHeaderFormat,a.scheduleHeaderSettings.minutesPerInterval=n.scheduleHeaderSettings.minutesPerInterval,a.scheduleHeaderSettings.monthHeaderFormat=n.scheduleHeaderSettings.monthHeaderFormat,a.scheduleHeaderSettings.yearHeaderFormat=n.scheduleHeaderSettings.yearHeaderFormat,"day"==o?a.perHourWidth=r._perHourWidth:"hour"==o?(a.workingTimeScale=n.workingTimeScale,a.minuteInterval=r._minuteInterval,a.perMinuteWidth=r._perMinuteWidth):"month"==o?a.perWeekWidth=r._perWeekWidth:("year"==o||"quarterYear"==o||"halfYear"==o)&&(a._perMonthWidth=r._perMonthWidth),r._$ganttchartHelper.ejGanttChart("refreshChartHeader",r._getDateFromFormat(e),r._getDateFromFormat(t)),r._$ganttchartHelper.ejGanttChart("refreshContainersWidth"),r._$ganttchartHelper.ejGanttChart("refreshHelper",r.model.currentViewData,r.model.updatedRecords,r._totalCollapseRecordCount),n.predecessorMapping&&r._refreshConnectorLines(!1,!0,!0),i._$bodyContainer.ejScroller("refresh"),r._updateScrollerBorder(),r._isTreeGridRendered=!0,r._isGanttChartRendered=!0,r._isChartRendering=!1},reRenderChart:function(i){var a,r,n=this,o=n.model,l=n._getDateFromFormat(o.scheduleStartDate),d=n._getDateFromFormat(o.scheduleEndDate);switch(o.flatRecords=[],o.parentRecords=[],e("#ejGanttChart"+n._id).empty(),i){case t.Gantt.ScheduleHeaderType.Week:o.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Week,n._perDayWidth=o.perDayWidth,n._calculateWeekSplit(l,d);break;case t.Gantt.ScheduleHeaderType.Day:o.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Day,n._perHourWidth=o.perHourWidth,n._perDayWidth=24*n._perHourWidth,n._calculateDaySplit(l,d);break;case t.Gantt.ScheduleHeaderType.Month:o.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Month,n._perDayWidth=o.perDayWidth,n._perWeekWidth=o.perWeekWidth,n._calculateMonthSplit(l,d);break;case t.Gantt.ScheduleHeaderType.Year:case t.Gantt.ScheduleHeaderType.QuarterYear:case t.Gantt.ScheduleHeaderType.HalfYear:o.scheduleHeaderSettings.scheduleHeaderType=i,n._perDayWidth=o.perDayWidth,n._perMonthWidth=o.perMonthWidth,n._calculateYearSplit(l,d);break;case t.Gantt.ScheduleHeaderType.Hour:if(o.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Hour,a=o.scheduleHeaderSettings.minutesPerInterval,r=t.Gantt.minutesPerInterval,n._perMinuteWidth=o.perMinuteWidth,a)if(a==r.Auto){var s=d-l;s>864e6?(n._minuteInterval=30,n._perDayWidth=48*n._perMinuteWidth):s>6048e5?(n._minuteInterval=15,n._perDayWidth=96*n._perMinuteWidth):s>1728e5?(n._minuteInterval=5,n._perDayWidth=288*n._perMinuteWidth):(n._minuteInterval=1,n._perDayWidth=1440*n._perMinuteWidth)}else a==r.OneMinute?(n._minuteInterval=1,n._perDayWidth=1440*n._perMinuteWidth):a==r.FiveMinutes?(n._minuteInterval=5,n._perDayWidth=288*n._perMinuteWidth):a==r.FifteenMinutes?(n._minuteInterval=15,n._perDayWidth=96*n._perMinuteWidth):a==r.ThirtyMinutes&&(n._minuteInterval=30,n._perDayWidth=48*n._perMinuteWidth);n._calculateHourSplit(l,d)}n.element.ejGantt("destroy").ejGantt(o),n._isTreeGridRendered=!1,n._isGanttChartRendered=!1},changeTaskMode:function(e,i){var a=this,r=a.model,n={};n.data=e,a._isValidationEnabled=!0,i==t.Gantt.TaskSchedulingMode.Manual?(e.isAutoSchedule=!1,e.item[r.taskSchedulingModeMapping]=!0):i==t.Gantt.TaskSchedulingMode.Auto&&(e.isAutoSchedule=!0,e.item[r.taskSchedulingModeMapping]=!1),n.columnName="taskMode",a._updateEditedGanttRecords(n,!0),a._isValidationEnabled=!1},autoSchedule:function(e){var i;i=this.model.updatedRecords.filter(function(t){return t.taskId===e}),this.changeTaskMode(i[0],t.Gantt.TaskSchedulingMode.Auto)},manualSchedule:function(e){var i;i=this.model.updatedRecords.filter(function(t){return t.taskId===e}),this.changeTaskMode(i[0],t.Gantt.TaskSchedulingMode.Manual)},_updateGanttRecords:function(){for(var e,t,i,a,r,n,o=this,l=o.model,d=l.flatRecords,s=d.length,c=0;c<s;c++){for(n=[],(i=d[c]).eResourceChildTasks.length>0?(n=i.eResourceChildTasks,this._updateOverlappingValues(i)):n.push(i),e=0;e<n.length;e++)!1===(t=n[e]).hasChildRecords&&(t.left=t._calculateLeft(this),t.width=t._calculateWidth(this),t.width=1==t.isMilestone?o._milesStoneWidth:t.width,t.progressWidth=t._getProgressWidth(t.width,t.status)),t.baselineStartDate&&t.baselineEndDate?(t.baselineLeft=t._calculateBaselineLeft(this),t.baselineRight=t._calculateBaselineRight(this),t.baselineWidth=t._calculateBaseLineWidth(this)):(t.baselineLeft=0,t.baselineRight=0,t.baselineWidth=0);r=(a=i.parentItem)&&a.childRecords,a&&r.indexOf(i)==r.length-1&&!1===i.hasChildRecords&&("resourceView"==l.viewType?o._updateResourceParentItem(i):a.isAutoSchedule?o._updateParentItem(i):o._updateManualParentItem(i))}},_initPrivateProperties:function(){var e=this,i=e.model;i.scheduleHeaderSettings.scheduleHeaderType;e._unassingedTasksParent=null,e._isFromGantt=!0,e._disabledToolItems=[],e._id=e.element.attr("id"),e._scheduleWeeks=[],e._taskIds=[],e._currentFilterColumn=[],e._duplicate=!1,e._wrongenddate=!1,e._addPosition=null,e._datePickerChangeEvent=!1,e._scheduleYears=[],e._enableMonthStart=!0,e._scheduleMonths=[],e._splitterOnResize=!1,e._scheduleYears=[],e._scheduleDays=[],e._scheduleHours=[],e._projectStartDate,e._projectEndDate,e._groupIds=[],e._resourceIds=[],e._resourceCollection=[],e._groupCollection=[],"resourceView"==i.viewType&&i.resourceIdMapping.length>0&&i.resources&&i.resources.length>0||i.groupIdMapping&&i.groupIdMapping.length>0&&i.groupCollection&&i.groupCollection.length>0?(e._isFlatResourceData=!0,e._groupCollection=i.groupCollection,e._resourceCollection=i.resources):"resourceView"==i.viewType?e._isFlatResourceData=!1:e._resourceCollection=i.resources,"resourceView"==i.viewType&&(i.resourceIdMapping||(i.resourceIdMapping="eResourceId"),i.groupIdMapping||(i.groupIdMapping="eGroupId"),i.resourceInfoMapping||(i.resourceInfoMapping="eResourceInfo")),this._resourceChildTasks=[],this._resourceUniqTasks=[],this._resourceUniqTaskIds=[],e._columns=[],e._storedIndex=-1,e._perDayWidth,e._prevDayWidth=0,e._rowIndexOfLastSelectedCell=-1,e._perMonthWidth,e._perWeekWidth,e._$treegridPane=null,e._$ganttchartPane=null,e._$treegridHelper=null,e._$ganttchartHelper=null,e._$ejGantt=null,e._tdsOffsetWidth=[],e._subPosx=[],e._predecessorsCollection=[],e._connectorLinesCollection=[],e._updatedConnectorLineCollection=[],e._connectorlineIds=[],e._gridRows=null,e._collapsedRecordCount=0,e._expandedRecordsCount=0,e._totalCollapseRecordCount=0,e._isInExpandCollapse=!1,e._hiddenRecordCount=0,e._validationRuleOptions=null,e._validationDialogTitle=null,e._validationRuleText=null,e.prevPredecessorTO=null,e.prevPredecessorFrom=null,e.prevPredecessorcount=0,e._isValidationEnabled=!0,e._isTreeGridRendered=!1,e._isGanttChartRendered=!1,e._isChartRendering=!1,e._holidaysList=e._getHoliday(),e._stringHolidays=e._getStringHolidays(),e._isinBeginEdit=!1,e._isMileStoneEdited=!1,e._cellEditColumn=null,e._isinAddnewRecord=!1,e._contextMenuItems=null,e._totalBorderWidth=2,e._totalBorderHeight="msie"==t.browserInfo().name&&t.browserInfo().version<9?i.toolbarSettings.showToolbar?3:2:i.toolbarSettings.showToolbar?1:0,e._columnHeaderTexts=null,e._predecessorEditingTexts=null,e._editDialogTexts=null,e._toolboxTooltipTexts=null,e._durationUnitTexts=null,e._durationUnitEditText=null,e._workUnitTexts=null,e._taskTypeTexts=null,e._effortDrivenTexts=null,e._contextMenuTexts=null,e._columnMenuTexts=null,e._editTypeText=null,e._clipModeText=null,e._textAlignTypeText=null,e._columnDialogTitle=null,e._deleteColumnText=null,e._okButtonText=null,e._cancelButtonText=null,e._confirmDeleteText=null,e._columnDialogTexts=null,e._newTaskTexts=null,e._months=null,e._days=null,e._dialogTabTitleTexts=null,e._isLoad=!0,e._updatedColumn="",e._isExistingUnitIsUpdated=!1,e._isDurationUpdated=!1,e._isResourceAddedOrRemoved=!1,e._newRecordResourceCollection=[],e._ganttTouchTrigger=!1,e._alertTexts=null,e._commonColumnWidth=150,e._searchString="",e._emptyDataColumns=[],e.secondaryDatasource=[],e._datasourceChildItems=[],e._$predecessorTable=null,e._mappingItems=[],e._editedDialogRecord=null,e._calculateDimensions(),e._retrivedData=this.dataSource(),e._isInExpandCollapseAll=!1,e._preTableCollection=[],e._defaultStartTime=null,e._defaultEndTime=null,e._workingTimeRanges=[],e._nonWorkingTimeRanges=[],e._nonWorkingHours=[],e._quarterYearTexts=null,e._halfYearTexts=null,this._validateTimeRange(),'[{"from":"08:00 AM","to":"12:00 PM"},{"from":"01:00 PM","to":"05:00 PM"}]'==JSON.stringify(i.dayWorkingTime)&&(i.dayWorkingTime=i.workingTimeScale!=t.Gantt.workingTimeScale.TimeScale8Hours?[{from:"12:00 AM",to:"12:00 AM"}]:[{from:"08:00 AM",to:"12:00 PM"},{from:"01:00 PM",to:"05:00 PM"}]),e._secondsPerDay=e._getSecondsPerDay(),e._timelineWidthCalculation(),e._localizedLabels=e._getLocalizedLabels(),e._setCultureInfo(),e._resourceViewColumns=[],e.setColumns(i.columns&&i.columns.length?i.columns:e.createTreeGridColumns()),i.isRerender&&e._updateColumnDropDownData(),e._updateColumnLocaleText(),e._isRefreshAddedRecord=!1,e._isInAdd=!1,e._activeMenuItemId=null,e._isAddEditDialogSave=!1,e._setTaskbarHeight(i.taskbarHeight),e.isCriticalPathEnable=!1,e.criticalPathCollection=[],e.detailPredecessorCollection=[],e.collectionTaskId=[],e._isValidPredecessorString=!0,e._enableDisableCriticalIcon=!1,e._generalTabColumnFields=[],e._addDialogGeneralColumns=[],e._addDialogcustomColumns=[],e._editDialogGeneralColumns=[],e._editDialogCustomColumns=[],""==i.resourceUnitMapping&&(i.resourceUnitMapping="unit"),e._dialogTab=["General","Predecessors","Resources","Custom Fields","Notes"],e._cssClass=i.cssClass,e._actionCompleteData=[],e._isLastRefresh=!1,e._nonWorkingDayIndex=[],e._serialCount=0,e._lastInsertedId=-1,e._isTriggerActionComplete=!0,e._expandCollapseSettings={state:i.expandStateMapping?"":i.enableCollapseAll?"collapseAll":"expandAll",level:0},e._contextMenuHandler=!1,e._ganttTouchEvent=!1,e._histoGramChildTasks=[],e._histoGramChildTaskIds=[],i.allowSearching=!0,e._unscheduledTaskWidth=7,e._isPredecessorEdited=!1},_updateModelsWidth:function(){var e=this,t=e.model;t.perDayWidth=e._perDayWidth?e._perDayWidth:null,t.perMonthWidth=e._perMonthWidth?e._perMonthWidth:null,t.perWeekWidth=e._perWeekWidth?e._perWeekWidth:null,t.perHourWidth=e._perHourWidth?e._perHourWidth:null,t.perMinuteWidth=e._perMinuteWidth?e._perMinuteWidth:null,t.minuteInterval=e._minuteInterval?e._minuteInterval:null},_timelineWidthCalculation:function(e){var a,r,n,o=this,l=o.model,d=!0,s=l.scheduleHeaderSettings.scheduleHeaderType,c=l.scheduleHeaderSettings.timescaleUnitSize,u=c.toString();if(e==i&&"100%"!=c&&(d=!1,(a=-1!=u.indexOf("-")?100:+u.match(/\d+/)[0])<50?a=50:a>500&&(a=500),l.scheduleHeaderSettings.timescaleUnitSize=a+"%"),e!=i&&(d=!1,(a=-1!=u.indexOf("-")?c:+u.match(/\d+/)[0])<50?a=50:a>500&&(a=500),l.scheduleHeaderSettings.timescaleUnitSize=a+"%"),"week"==s)o._perDayWidth=d?30:Math.round(.3*a),o._perMinuteWidth=o._perDayWidth/1440;else if("year"==s)o._perDayWidth=d?3:Math.round(.03*a),o._perMonthWidth=30*o._perDayWidth,o._perMinuteWidth=o._perDayWidth/1440;else if("quarterYear"==s)o._perDayWidth=d?1:Math.round(.01*a),o._perMonthWidth=30*o._perDayWidth,o._perMinuteWidth=o._perDayWidth/1440;else if("halfYear"==s)o._perDayWidth=d?.5:Math.round(.005*a),o._perMonthWidth=30*o._perDayWidth,o._perMinuteWidth=o._perDayWidth/1440;else if("month"==s)o._perDayWidth=d?10:Math.round(.1*a),o._perWeekWidth=7*o._perDayWidth,o._perHourWidth=o._perDayWidth/24,o._perMinuteWidth=o._perDayWidth/1440;else if("day"==s)o._perHourWidth=d?20:Math.round(.2*a),o._perMinuteWidth=o._perHourWidth/60,o._perDayWidth=24*o._perHourWidth;else if("hour"==s&&(r=l.scheduleHeaderSettings.minutesPerInterval,n=t.Gantt.minutesPerInterval,o._perMinuteWidth=d?20:Math.round(.2*a),r))if(r==n.Auto){var p=o._getDateFromFormat(l.scheduleStartDate),h=o._getDateFromFormat(l.scheduleEndDate)-p;h>864e6?(o._minuteInterval=30,o._perDayWidth=48*o._perMinuteWidth):h>6048e5?(o._minuteInterval=15,o._perDayWidth=96*o._perMinuteWidth):h>1728e5?(o._minuteInterval=5,o._perDayWidth=288*o._perMinuteWidth):(o._minuteInterval=1,o._perDayWidth=1440*o._perMinuteWidth)}else r==n.OneMinute?(o._minuteInterval=1,o._perDayWidth=1440*o._perMinuteWidth):r==n.FiveMinutes?(o._minuteInterval=5,o._perDayWidth=288*o._perMinuteWidth):r==n.FifteenMinutes?(o._minuteInterval=15,o._perDayWidth=96*o._perMinuteWidth):r==n.ThirtyMinutes&&(o._minuteInterval=30,o._perDayWidth=48*o._perMinuteWidth);o._updateModelsWidth()},_updateTimescaleUnitSize:function(e){var t,i=this,a=i.model,r=a.scheduleHeaderSettings;r.timescaleUnitSize;r.timescaleUnitSize=e,i._timelineWidthCalculation(e),i.updateScheduleDates(a.scheduleStartDate,a.scheduleEndDate),(t=i.selectedRowIndex())>=0&&i.focusOnTask(t)},_validateTimeRange:function(){for(var e,i="01/01/2016",a=this.model,r=a.dayWorkingTime.length,n=!0,o=null,l=0;l<r;l++)if((e=a.dayWorkingTime[l]).from&&e.to){var d=t.parseDate(i+" "+e.from,"MM/dd/yyyy h:mm tt","en-US"),s="12:00 AM"!=e.to?t.parseDate(i+" "+e.to,"MM/dd/yyyy h:mm tt","en-US"):t.parseDate("01/02/2016 "+e.to,"MM/dd/yyyy h:mm tt","en-US"),c=(s.getTime(),d.getTime(),this._getSecondsInDecimal(d)),u=this._getSecondsInDecimal(s);0==u&&(u=86400),c>=u?n=!1:null==o?o=u:(o>c||o>=u)&&(n=!1)}else n=!1;n||(a.dayWorkingTime=[{from:"08:00 AM",to:"12:00 PM"},{from:"01:00 PM",to:"05:00 PM"}])},_getParsedDate:function(e,i,a){return t.parseDate(e,i,a)},_setTime:function(e,t){var i=parseInt(e/3600),a=parseInt((e-3600*i)/60),r=e-3600*i-60*a;t.setHours(i,a,r,0)},_checkStartDate:function(e,i,a){var r,n,o,l,d,s,c;if(t.isNullOrUndefined(e))return null;var u=new Date(e),p=this.model,h=this._getSecondsInDecimal(u),g=t.isNullOrUndefined(a)?!t.isNullOrUndefined(i)&&i.isMilestone:a;if(h<this._defaultStartTime)this._setTime(this._defaultStartTime,u);else if(h!=this._defaultEndTime||i&&g){if(h>this._defaultEndTime)u.setDate(u.getDate()+1),this._setTime(this._defaultStartTime,u);else if(h>this._defaultStartTime&&h<this._defaultEndTime)for(r=0;r<this._workingTimeRanges.length;r++)if(h>=(n=this._workingTimeRanges[r]).to&&this._workingTimeRanges[r+1]&&h<this._workingTimeRanges[r+1].from){h!=n.to||i&&g?h!=n.to&&this._setTime(this._workingTimeRanges[r+1].from,u):this._setTime(this._workingTimeRanges[r+1].from,u);break}}else u.setDate(u.getDate()+1),this._setTime(this._defaultStartTime,u);do{if(o=new Date(u),!t.isNullOrUndefined(i)&&i.isAutoSchedule&&(!p.includeWeekend||p.holidays.length>0)||t.isNullOrUndefined(i)&&(!p.includeWeekend||p.holidays.length>0))for(p.includeWeekend||(l=new Date(u),u=this._getNextWorkingDay(u),l.getTime()!=u.getTime()&&this._setTime(this._defaultStartTime,u)),d=0;d<p.holidays.length;d++)s=this._getDateFromFormat(p.holidays[d].day),c=new Date(s),s.setHours(0,0,0,0),c.setHours(23,59,59,59),u.getTime()>=s.getTime()&&u.getTime()<c.getTime()&&(u.setDate(u.getDate()+1),this._setTime(this._defaultStartTime,u))}while(o.getTime()!=u.getTime());return new Date(u)},_checkEndDate:function(e,i){var a,r,n,o;if(t.isNullOrUndefined(e))return null;var l=new Date(e),d=this.model,s=this._getSecondsInDecimal(l);if(s>this._defaultEndTime)this._setTime(this._defaultEndTime,l);else if(s<=this._defaultStartTime)l.setDate(l.getDate()-1),this._setTime(this._defaultEndTime,l);else if(s>this._defaultStartTime&&s<this._defaultEndTime)for(a=0;a<this._workingTimeRanges.length;a++)if(s>this._workingTimeRanges[a].to&&this._workingTimeRanges[a+1]&&s<=this._workingTimeRanges[a+1].from){this._setTime(this._workingTimeRanges[a].to,l);break}do{if(r=new Date(l),!t.isNullOrUndefined(i)&&i.isAutoSchedule&&(!d.includeWeekend||d.holidays.length>0)||t.isNullOrUndefined(i)&&(!d.includeWeekend||d.holidays.length>0))for(d.includeWeekend||(n=new Date(l),l=this._getPrevWorkingDay(l),n.getTime()!=l.getTime()&&this._setTime(this._defaultEndTime,l)),o=0;o<d.holidays.length;o++){var c=this._getDateFromFormat(d.holidays[o].day),u=new Date(c),p=new Date(l);p.setMinutes(l.getMinutes()-2),c.setHours(0,0,0,0),u.setHours(23,59,59,59),(l.getTime()>=c.getTime()&&l.getTime()<u.getTime()||p.getTime()>=c.getTime()&&p.getTime()<u.getTime())&&(l.setDate(l.getDate()-1),l.getTime()==c.getTime()&&86400==this._defaultEndTime&&0==this._getSecondsInDecimal(l)||this._setTime(this._defaultEndTime,l))}}while(r.getTime()!=l.getTime());return new Date(l)},_checkBaseLineStartDate:function(e){var i,a=new Date(e),r=(this.model,this._getSecondsInDecimal(a));if(t.isNullOrUndefined(e))return"";if(r<this._defaultStartTime)this._setTime(this._defaultStartTime,a);else if(r>=this._defaultEndTime)a.setDate(a.getDate()+1),this._setTime(this._defaultStartTime,a);else if(r>this._defaultStartTime&&r<this._defaultEndTime)for(i=0;i<this._workingTimeRanges.length;i++)if(r>=this._workingTimeRanges[i].to&&this._workingTimeRanges[i+1]&&r<this._workingTimeRanges[i+1].from){this._setTime(this._workingTimeRanges[i+1].from,a);break}return a},_checkBaseLineEndDate:function(e){var i,a=new Date(e),r=(this.model,this._getSecondsInDecimal(a));if(t.isNullOrUndefined(e))return"";if(r>this._defaultEndTime)this._setTime(this._defaultEndTime,a);else if(r<=this._defaultStartTime)a.setDate(a.getDate()-1),this._setTime(this._defaultEndTime,a);else if(r>this._defaultStartTime&&r<this._defaultEndTime)for(i=0;i<this._workingTimeRanges.length;i++)if(r>this._workingTimeRanges[i].to&&this._workingTimeRanges[i+1]&&r<=this._workingTimeRanges[i+1].from){this._setTime(this._workingTimeRanges[i].to,a);break}return a},_getTaskLeft:function(e,i){var a=new Date(e),r=this.model.scheduleHeaderSettings.scheduleHeaderType;return(r==t.Gantt.ScheduleHeaderType.Week||r==t.Gantt.ScheduleHeaderType.Month||r==t.Gantt.ScheduleHeaderType.Year||r==t.Gantt.ScheduleHeaderType.QuarterYear||r==t.Gantt.ScheduleHeaderType.HalfYear)&&(this._getSecondsInDecimal(a)==this._defaultStartTime?a.setHours(0,0,0,0):i&&this._getSecondsInDecimal(a)==this._defaultEndTime&&a.setHours(24)),this._projectStartDate?(a.getTime()-this._projectStartDate.getTime())/864e5*this._perDayWidth:0},_getTaskWidth:function(e,i){var a=new Date(e),r=new Date(i),n=this.model.scheduleHeaderSettings.scheduleHeaderType;return(n==t.Gantt.ScheduleHeaderType.Week||n==t.Gantt.ScheduleHeaderType.Month||n==t.Gantt.ScheduleHeaderType.Year||n==t.Gantt.ScheduleHeaderType.QuarterYear||n==t.Gantt.ScheduleHeaderType.HalfYear)&&(this._getSecondsInDecimal(a)==this._defaultStartTime&&a.setHours(0,0,0,0),this._getSecondsInDecimal(r)==this._defaultEndTime&&r.setHours(24)),(r.getTime()-a.getTime())/864e5*this._perDayWidth},_getHolidaysCount:function(e,t){var i,a,r=this.model,n=this.model.holidays,o=0,l=new Date(e),d=new Date(t);if(l.setDate(l.getDate()+1),l.setHours(0,0,0,0),d.setHours(0,0,0,0),l.getTime()<d.getTime())for(i=0;i<n.length;i++)a=this._getDateFromFormat(n[i].day),l.getTime()<=a.getTime()&&d.getTime()>a.getTime()&&(r.includeWeekend||-1!=this._nonWorkingDayIndex.indexOf(a.getDay())?r.includeWeekend&&(o+=1):o+=1);return o},_getWeekendCount:function(e,t){var i=new Date(e),a=new Date(t),r=0;for(i.setHours(0,0,0,0),i.setDate(i.getDate()+1),a.setHours(0,0,0,0);i.getTime()<a.getTime();)-1!=this._nonWorkingDayIndex.indexOf(i.getDay())&&(r+=1),i.setDate(i.getDate()+1);return r},_getDayDiff:function(e,t){return(t.getTime()-e.getTime())/864e5},_getNumberOfSeconds:function(e,t,i){var a=new Date(e),r=new Date(t),n=0;return a.setDate(a.getDate()+1),a.setHours(0,0,0,0),r.setHours(0,0,0,0),a.getTime()<r.getTime()&&(n=this._getTimeDiff(a,r,i)/1e3),n%86400!=0&&(n=n-n%86400+86400),n},_updateDateWithTimeZone:function(e,t){var i,a,r,n,o=e.getTimezoneOffset(),l=t.getTimezoneOffset();o!=l&&((r=new Date((new Date).getFullYear(),0,1).getTimezoneOffset())!=o?(i=e,a=o):r!=l&&(i=t,a=l),r<0?(n=r-a,i.setTime(i.getTime()+6e4*n)):r>0&&(n=a-r,i.setTime(i.getTime()-6e4*n)))},_getTimeDiff:function(e,t,i){e=new Date(e),t=new Date(t);return i&&this._updateDateWithTimeZone(e,t),t.getTime()-e.getTime()},_getNonworkingTime:function(e,i,a,r){r=!!t.isNullOrUndefined(r)||r;this._getTimeDiff(e,i,r);var n=!this.model.includeWeekend&&a?this._getWeekendCount(e,i):0,o=this._getNumberOfSeconds(e,i,r),l=a?this._getHolidaysCount(e,i):0,d=(o-86400*n-86400*l)/86400,s=this._getNonWorkingSecondsOnDate(e,i,a);return d*(86400-this._secondsPerDay)+86400*n+86400*l+s},_getEndDate:function(e,i,a,r,n){var o=0,l=new Date(e),d=new Date(e);for(o=a&&a!=t.Gantt.DurationUnit.Day?a==t.Gantt.DurationUnit.Hour?3600*i:60*i:this._secondsPerDay*i;o>0;)d.setSeconds(d.getSeconds()+o),(o=this._getNonworkingTime(l,d,r.isAutoSchedule,!0))>0&&(d=this._checkStartDate(d,r,n)),l=new Date(d);return d},_getStartDate:function(e,i,a,r){var n=0,o=new Date(e),l=new Date(e);for(n=a&&a!=t.Gantt.DurationUnit.Day?a==t.Gantt.DurationUnit.Hour?3600*i:60*i:this._secondsPerDay*i;n>0;)l.setSeconds(l.getSeconds()-n),(n=this._getNonworkingTime(l,o,r.isAutoSchedule,!0))>0&&(o=this._checkEndDate(l,r)),o=new Date(l);return l},_getDuration:function(e,i,a,r,n){if(t.isNullOrUndefined(e)||t.isNullOrUndefined(i))return null;n=!!t.isNullOrUndefined(n)||n;var o,l=this._getTimeDiff(e,i,n)/1e3-this._getNonworkingTime(e,i,r,n);return o=a&&a!=t.Gantt.DurationUnit.Day?a==t.Gantt.DurationUnit.Minute?l/60:l/3600:l/this._secondsPerDay,parseFloat(o)},_getSecondsInDecimal:function(e){return 3600*e.getHours()+60*e.getMinutes()+e.getSeconds()+e.getMilliseconds()/1e3},_getNonWorkingSecondsOnDate:function(e,t,i){for(var a,r=this._getSecondsInDecimal(e),n=this._getSecondsInDecimal(t),o=-1,l=-1,d=0,s=!!i&&this._isOnHolidayOrWeekEnd(e),c=!!i&&this._isOnHolidayOrWeekEnd(t),u=0;u<this._nonWorkingTimeRanges.length;u++)r>=(a=this._nonWorkingTimeRanges[u]).from&&r<=a.to&&(o=u),n>=a.from&&n<=a.to&&(l=u);if(e.getDate()!=t.getDate()||e.getMonth()!=t.getMonth()||e.getFullYear()!=t.getFullYear()){if(s)d+=86400-r;else for(u=o;u<this._nonWorkingTimeRanges.length;u++)this._nonWorkingTimeRanges[u].isWorking||(d+=u==o?this._nonWorkingTimeRanges[u].to-r:this._nonWorkingTimeRanges[u].interval);if(c)d+=n;else for(u=0;u<=l;u++)this._nonWorkingTimeRanges[u].isWorking||(d+=u==l?n-this._nonWorkingTimeRanges[u].from:this._nonWorkingTimeRanges[u].interval)}else if(o!=l)if(c)d+=n-r;else for(u=o;u<=l;u++)this._nonWorkingTimeRanges[u].isWorking||(d+=u==o?this._nonWorkingTimeRanges[u].to-r:u==l?n-this._nonWorkingTimeRanges[u].from:this._nonWorkingTimeRanges[u].interval);else c?d+=n-r:this._nonWorkingTimeRanges[o].isWorking||(d=n-r);return d},_getSecondsPerDay:function(){for(var e,i="01/01/2016",a=this,r=this.model,n=r.dayWorkingTime.length,o=0,l=0;l<n;l++)if((e=r.dayWorkingTime[l]).from&&e.to){var d=t.parseDate(i+" "+e.from,"MM/dd/yyyy h:mm tt","en-US"),s="12:00 AM"!=e.to?t.parseDate(i+" "+e.to,"MM/dd/yyyy h:mm tt","en-US"):t.parseDate("01/02/2016 "+e.to,"MM/dd/yyyy h:mm tt","en-US"),c=s.getTime()-d.getTime(),u=this._getSecondsInDecimal(d),p=this._getSecondsInDecimal(s);0==p&&(p=86400),o+=c/1e3,0==l&&(a._defaultStartTime=u),l==n-1&&(a._defaultEndTime=p),l>0?(a._nonWorkingHours.push(a._nonWorkingHours[a._nonWorkingHours.length-1]+u-a._workingTimeRanges[l-1].to),a._workingTimeRanges[l-1].to<u&&a._nonWorkingTimeRanges.push({from:a._workingTimeRanges[l-1].to,to:u,isWorking:!1,interval:u-a._workingTimeRanges[l-1].to})):(a._nonWorkingHours.push(0),a._nonWorkingTimeRanges.push({from:0,to:u,isWorking:!1,interval:u})),a._workingTimeRanges.push({from:u,to:p}),a._nonWorkingTimeRanges.push({from:u,to:p,isWorking:!0,color:e.background,interval:p-u})}return a._defaultEndTime/3600!=24&&a._nonWorkingTimeRanges.push({from:a._defaultEndTime,to:86400,isWorking:!1,interval:86400-a._defaultEndTime}),o},_updateColumnLocaleText:function(){var e,t=this.model.columns;if(t&&t.length>0)for(e=0;e<t.length;e++)t[e].field&&this._columnHeaderTexts[t[e].field]&&(t[e].headerText=this._columnHeaderTexts[t[e].field])},_calculateDimensions:function(){var e=this,t=this.model.sizeSettings,i=t.height,a=t.width,r=e.element,n=r[0].style.height,o=r[0].style.width;r.parent().height(),r.parent().width();a&&r.css("width",a),i&&r.css("height",i),i||n||(n="450px",r.css("height","450px")),a||o||(o="100%",e.element.css("width","100%")),e._ganttHeight=r.height(),e._ganttWidth=r.width(),0===e._ganttHeight&&(e._ganttHeight=450,r.css("450px"))},_setCultureInfo:function(){var i=this,a=i.model,r=a.locale,n=e.extend({},i._localizedLabels,t.isNullOrUndefined(t.cultures[r])?t.cultures.default:t.cultures[r]),o=e.extend({},t.cultures.default,t.Gantt.Locale.default);a.dateFormat=a.dateFormat?a.dateFormat:n&&n.calendars&&n.calendars.standard.patterns?n.calendars.standard.patterns.d:t.preferredCulture(r)?t.preferredCulture(r).calendars.standard.patterns.d:o.calendars.standard.patterns.d,i._emptyRecordText=n&&n.emptyRecord?n.emptyRecord:o.emptyRecord,i._unassignedText=n&&n.unassignedTask?n.unassignedTask:o.unassignedTask,i._columnHeaderTexts=n&&n.columnHeaderTexts?n.columnHeaderTexts:o.columnHeaderTexts,i._columnHeaderTexts=e.extend({},o.columnHeaderTexts,i._columnHeaderTexts),i._columnHeaderTexts.eResourceName=i._columnHeaderTexts.resourceName,i._taskModeTexts=n&&n.taskModeTexts?n.taskModeTexts:o.taskModeTexts,i._taskModeTexts=e.extend({},o.taskModeTexts,i._taskModeTexts),i._editDialogTexts=n&&n.editDialogTexts?n.editDialogTexts:o.editDialogTexts,i._editDialogTexts=e.extend({},o.editDialogTexts,i._editDialogTexts),i._columnDialogTexts=n&&n.columnDialogTexts?n.columnDialogTexts:o.columnDialogTexts,i._toolboxTooltipTexts=n&&n.toolboxTooltipTexts?n.toolboxTooltipTexts:o.toolboxTooltipTexts,i._toolboxTooltipTexts=e.extend({},o.toolboxTooltipTexts,i._toolboxTooltipTexts),i._durationUnitTexts=n&&n.durationUnitTexts?n.durationUnitTexts:o.durationUnitTexts,i._durationUnitTexts=e.extend({},o.durationUnitTexts,i._durationUnitTexts),i._durationUnitEditText=n&&n.durationUnitEditText?n.durationUnitEditText:o.durationUnitEditText,i._durationUnitEditText=e.extend({},o.durationUnitEditText,i._durationUnitEditText),i._workUnitTexts=n&&n.workUnitTexts?n.workUnitTexts:o.workUnitTexts,i._workUnitTexts=e.extend({},o.workUnitTexts,i._workUnitTexts),i._taskTypeTexts=n&&n.taskTypeTexts?n.taskTypeTexts:o.taskTypeTexts,i._taskTypeTexts=e.extend({},o.taskTypeTexts,i._taskTypeTexts),i._effortDrivenTexts=n&&n.effortDrivenTexts?n.effortDrivenTexts:o.effortDrivenTexts,i._effortDrivenTexts=e.extend({},o.effortDrivenTexts,i._effortDrivenTexts),i._contextMenuTexts=n&&n.contextMenuTexts?n.contextMenuTexts:o.contextMenuTexts,i._contextMenuTexts=e.extend({},o.contextMenuTexts,i._contextMenuTexts),i._newTaskTexts=n&&n.newTaskTexts?n.newTaskTexts:o.newTaskTexts,i._months=n&&n.calendars?n.calendars.standard.months.namesAbbr:t.preferredCulture(r)?t.preferredCulture(r).calendars.standard.months.namesAbbr:o.calendars.standard.months.namesAbbr,i._days=n&&n.calendars?n.calendars.standard.months.namesAbbr:t.preferredCulture(r)?t.preferredCulture(r).calendars.standard.days.namesAbbr:o.calendars.standard.days.namesAbbr,i._columnMenuTexts=n&&n.columnMenuTexts?n.columnMenuTexts:o.columnMenuTexts,i._columnMenuTexts=e.extend({},o.contextMenuTexts,i._columnMenuTexts),i._columnDialogTitle=n&&n.columnDialogTitle?n.columnDialogTitle:o.columnDialogTitle,i._deleteColumnText=n&&n.deleteColumnText?n.deleteColumnText:o.deleteColumnText,i._okButtonText=n&&n.okButtonText?n.okButtonText:o.okButtonText,i._cancelButtonText=n&&n.cancelButtonText?n.cancelButtonText:o.cancelButtonText,i._confirmDeleteText=n&&n.confirmDeleteText?n.confirmDeleteText:o.confirmDeleteText,i._predecessorEditingTexts=n&&n.predecessorEditingTexts?n.predecessorEditingTexts:o.predecessorEditingTexts,i._predecessorEditingTexts=e.extend({},o.contextMenuTexts,i._predecessorEditingTexts),i._alertTexts=n&&n.alertTexts?n.alertTexts:o.alertTexts,i._alertTexts=e.extend({},o.alertTexts,i._alertTexts),i._dialogTabTitleTexts=n&&n.dialogTabTitleTexts?n.dialogTabTitleTexts:o.dialogTabTitleTexts,i._dialogTabTitleTexts=e.extend({},o.dialogTabTitleTexts,i._dialogTabTitleTexts),i._predecessorCollectionText=n&&n.predecessorCollectionText?n.predecessorCollectionText:o.predecessorCollectionText,i._editTypeText=n&&n.editTypeTexts?n.editTypeTexts:o.editTypeTexts,i._textAlignTypeText=n&&n.textAlignTypes?n.textAlignTypes:o.textAlignTypes,i._clipModeText=n&&n.clipModeTexts?n.clipModeTexts:o.clipModeTexts,i._validationRuleText=n&&n.linkValidationRuleText?n.linkValidationRuleText:o.linkValidationRuleText,i._validationDialogTitle=n&&n.linkValidationDialogTitle?n.linkValidationDialogTitle:o.linkValidationDialogTitle,i._validationRuleOptions=n&&n.linkValidationRuleOptions?n.linkValidationRuleOptions:o.linkValidationRuleOptions,i._connectorLineDialogText=n&&n.connectorLineDialogText?n.connectorLineDialogText:o.connectorLineDialogText,i._nullText=n&&n.nullText?n.nullText:o.nullText,i._quarterYearTexts=n&&n.quarterYearTexts?n.quarterYearTexts:o.quarterYearTexts,i._halfYearTexts=n&&n.halfYearTexts?n.halfYearTexts:o.halfYearTexts},_getMappingItems:function(){for(var e=this,i=[],a=e.model.viewType==t.Gantt.ViewType.ProjectView?e._columns:e._resourceViewColumns,r=a.length,n=0;n<r;n++)i.push(a[n].mappingName);return i},_getContextMenuItems:function(){var e=this._contextMenuTexts;return[{headerText:e.taskDetailsText,eventHandler:null,isDefault:!0,menuId:"Task"},{headerText:e.addNewTaskText,eventHandler:null,isDefault:!0,menuId:"Add"},{headerText:e.indentText,eventHandler:null,isDefault:!0,menuId:"Indent"},{headerText:e.outdentText,eventHandler:null,isDefault:!0,menuId:"Outdent"},{headerText:e.deleteText,eventHandler:null,isDefault:!0,menuId:"Delete"},{iconPath:null,headerText:e.aboveText,eventHandler:null,menuId:"Above",parentMenuId:"Add"},{iconPath:null,headerText:e.belowText,eventHandler:null,menuId:"Below",parentMenuId:"Add"}]},_initialize:function(){var e,i,a,r,n,o;if(!this._isFromSetModel){if((i=(e=this).model).cssClass&&e.element.addClass(i.cssClass),e._$treegridPane=t.buildTag("div.e-treegridPane"),e._$ganttchartPane=t.buildTag("div.e-ganttchartPane"),e._$ejGantt=t.buildTag("div.e-gantt-Spliter#e-ejSpliter"+e._id,"",{},{"data-unselectable":"on"}),i.predecessorMapping&&e._updatePredecessors(),e._render(),i.updatedRecords=i.flatRecords.slice(),i.currentViewData=i.flatRecords.slice(),i.predecessorMapping&&i.enablePredecessorValidation&&e._updatedRecordsDateByPredecessor(),e._calculateScheduleDates(),e._calculateHeaderDates(),e._updateGanttRecords(),e._checkDataManagerUpdate(),i.filterSettings&&i.filterSettings.filteredColumns.length>0)for(a=i.filterSettings.filteredColumns,r=0;r<a.length;r++)n=a[r].field,null!=(o=t.TreeGrid.getColumnByMappingName(e._columns,n))&&(n=n==i.resourceInfoMapping?"resourceNames":n==i.predecessorMapping?"predecessorsName":o.field),a[r].field=n;t.isNullOrUndefined(this.isProjectViewData)||(i.viewType=t.Gantt.ViewType.HistogramView,this._checkHistoGramDataBinding()),e._renderTreeGrid(),i.updatedRecords=e.getUpdatedRecords(),i.currentViewData=e.getCurrentViewData(),e._renderGanttChart(),e._enableCreateCollection=!0,e._isValidationEnabled=!1,e._isLoad=!1,"projectView"==i.viewType&&i.predecessorMapping&&e._createConnectorLinesCollection(),e._isValidationEnabled=!0,e._$treegridPane.css({overflow:"hidden"}),e._initiateDialogTemplates(),i.predecessorMapping&&i.enablePredecessorValidation&&e._validationDialogTemplate(),e._isTreeGridRendered=!0,e._isGanttChartRendered=!0,e._gridRows=e.getRows(),e._ganttChartRows=e.getGanttChartRows(),e._createContextMenuTemplate(),e._wireEvents(),e._updateScrollerBorder(),e._initialEndRendering(),e._getLocalizedLabels(),i.viewType==t.Gantt.ViewType.HistogramView&&(e._$ganttchartHelper.ejGanttChart("instance")._isCalendarExist=null)}},_getLocalizedLabels:function(){return t.getLocalizedConstants(this.sfType,this.model.locale)},_initialEndRendering:function(){var e,t,i=this,a=this.model;a.enableCollapseAll?(-1!=this.selectedRowIndex()&&i._deSelectRowItem(),i._collapseAll()):a.expandStateMapping&&i._collapseRecordOnLoad(),i.selectedRowIndex()>=0&&i.selectedRowIndex()<i.model.updatedRecords.length&&"row"==a.selectionMode&&((e={}).recordIndex=i.selectedRowIndex(),e.previousIndex=a.selectedItem?a.updatedRecords.indexOf(a.selectedItem):-1,i.rowSelecting(e)&&(i.selectRows(i.selectedRowIndex()),i._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement"))),(t=i._$treegridHelper.ejTreeGrid("instance"))._jsonData=t.model.dataManagerUpdate.jsonData=i._jsonData},_checkDataManagerUpdate:function(){var e=this,i=this.dataSource();e._isDataManagerUpdate=!1,e._jsonData=null,i instanceof t.DataManager&&(i.dataSource.offline&&i.dataSource.json?(e._isDataManagerUpdate=!0,e._jsonData=i.dataSource.json):i.dataSource.offline||(e._isDataManagerUpdate=!0,e._jsonData=e._retrivedData))},_initiateDialogTemplates:function(){var i,a=this,r=this.model;a.customColumnFields(),(r.editSettings.allowEditing||"normal"==r.editSettings.editMode||"dialogTemplate"==r.editSettings.editMode)&&(a.editDialogTemplate(),0===e("#"+this._id+"_dialogEdit").length&&a.element.append(a._renderDialog())),r.editSettings.allowAdding&&(a.addDialogTemplate(),0===e("#"+this._id+"_dialogAdd").length&&(i=t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none","overflow-x":"hidden"},{id:this._id+"_dialogAdd"}),a.element.append(i)))},_render:function(){var e=this,i=e.element;e.model;e.model.toolbarSettings.showToolbar&&i.append(e._renderToolBar()),e._ganttHeight=parseInt(e._ganttHeight)-e._getToolBarHeight()-e._totalBorderHeight,e._$treegridHelper=t.buildTag("div.ejTreeGrid#ejTreeGrid"+e._id,"",{height:e._ganttHeight},{}),e._$ganttchartHelper=t.buildTag("div.ejGanttChart#ejGanttChart"+e._id,"",{height:e._ganttHeight},{}),e._$ganttchartPane.append(e._$ganttchartHelper),e._$treegridPane.append(e._$treegridHelper),e._$ejGantt.append(e._$treegridPane),e._$ejGantt.append(e._$ganttchartPane),i.append(e._$ejGantt),e._renderGantt()},_renderDialog:function(){return t.buildTag("div.e-dialog e-dialog-content e-shadow e-widget-content","",{display:"none","overflow-x":"hidden"},{id:this._id+"_dialogEdit"})},editDialogTemplate:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x=this,v=x.model,b=v.viewType==t.Gantt.ViewType.ProjectView?e.extend([],x._columns):e.extend([],x._resourceViewColumns),S=v.viewType==t.Gantt.ViewType.ProjectView?x._columns:x._resourceViewColumns,D=b.length,R=-1,y=-1,I=x._$treegridHelper.data("ejTreeGrid"),k=x._dialogTab,M=k.length;if(x._editDialogGeneralColumns=[],x._editDialogCustomColumns=[],x._generalTabColumnFields=["taskId","taskMode","taskName","startDate","endDate","duration","resourceInfo","status","work","taskType","effortDriven","baselineStartDate","baselineEndDate","predecessor","WBS","notesText","serialNumber","serialNumberPredecessor"],x._mappingItems=x._getMappingItems(),0!=D){if(v.editDialogFields.length>0){for(a=[],r=0;r<v.editDialogFields.length;r++)(n=e.grep(S,function(e){return e.mappingName===v.editDialogFields[r].field})).length>0&&(a.push(n[0]),-1==x._generalTabColumnFields.indexOf(n[0].mappingName)&&v.editDialogFields[r].displayInGeneralTab&&x._generalTabColumnFields.push(n[0].mappingName));b=a}else v.enableWBS&&(v.enableWBSPredecessor&&(o=b.filter(function(e){return"WBSPredecessor"!=e.mappingName})),o&&o.length&&(b=o));for(((V=e.map(b,function(e,t){if(e.mappingName==v.taskNameMapping)return t}))[0]+1)%3==0&&b.splice(V[0]-1,0,b.splice(V[0],1)[0]),D=b.length,c=0;c<D;c++)if(-1!=e.inArray(b[c].mappingName,x._mappingItems)){if(!v.resourceInfoMapping&&("work"==b[c].field||"taskType"==b[c].field||"effortDriven"==b[c].field))continue;if(b[c].mappingName!==v.predecessorMapping&&b[c].mappingName!=v.resourceInfoMapping&&b[c].mappingName!=v.notesMapping&&"serialNumberPredecessor"!=b[c].mappingName){if(v.enableSerialNumber&&"taskId"==b[c].field)continue;(V=e.map(x._generalTabColumnFields,function(e,t){if(e==b[c].field)return t})).length>0?x._editDialogGeneralColumns.push(b[c]):x._editDialogCustomColumns.push(b[c])}else b[c].mappingName!==v.baselineStartDateMapping&&b[c].mappingName!==v.baselineEndDateMapping&&(b[c].mappingName==v.resourceInfoMapping?y=c:(b[c].mappingName==v.predecessorMapping||"serialNumberPredecessor"==b[c].mappingName)&&(R=c))}var E,H,P,F,O,G=t.buildTag("div","",{},{}),L=t.buildTag("div","",{},{id:x._id+"EditTab"}),N=t.buildTag("ul","",{},{});for(L.append(N),G.append(L),l=0;l<M;l++)switch(k[l]){case"General":if(x._editDialogGeneralColumns.length>0){N.append("<li><a href='#"+x._id+"EditGeneral'>"+x._dialogTabTitleTexts.generalTabText+"</a></li>"),d=t.buildTag("div.e-gantt-editor-container","",{},{id:x._id+"EditGeneral"}),s=t.buildTag("form","",{height:"auto",width:"auto","font-size":"14px"},{id:x._id+"GeneralEditForm"}),d.append(s),L.append(d);var W,A=t.buildTag("table.e-general-edit-div","",{"border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),z=t.buildTag("tr"),j=0,U=x._editDialogGeneralColumns;D=U.length;for(c=0;c<D;c++)j<3?(U[c].mappingName!==v.taskNameMapping?(j++,W=t.buildTag("td.e-property-container","",{},{})):(j+=2,W=t.buildTag("td.e-property-container","",{},{colspan:"2"})),u=t.buildTag("table","",{outline:"none","border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),E=t.buildTag("tr","",{"line-height":"1.4"},{}),(H=t.buildTag("td.e-editLabel","",{},{})).append("<label>"+x._columnHeaderTexts[U[c].field]+"</label>"),E.append(H),u.append(E),P=t.buildTag("tr"),F=t.buildTag("td.e-editValue","",{},{}),i=S.indexOf(U[c]),t.TreeGrid._initCellEditType(I,F,x._id,i,"Edit",v.viewType!=t.Gantt.ViewType.ProjectView,S),P.append(F),u.append(P),W.append(u),z.append(W)):(A.append(z),z=t.buildTag("tr"),c--,j=0);A.append(z),s.append(A)}break;case"Predecessors":v.predecessorMapping&&-1!=R&&(N.append("<li><a href='#"+x._id+"EditPredecessors'>"+x._dialogTabTitleTexts.predecessorsTabText+"</a></li>"),p=t.buildTag("div.e-gantt-predecessor-container","",{},{id:x._id+"EditPredecessors"}),h=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:x._id+"PredecessorEditForm"}),p.append(h),L.append(p),g=t.buildTag("table#"+x._id+"predecessoreditTable","",{width:"100%",outline:"none","border-collapse":"collapse","margin-top":"0px",position:"relative",left:"-2px",top:"2px"},{}),E=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},""),(H=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{})).append("<span id='"+x._id+"EditDialog_PredecesorAdd' class='e-addpre e-icon e-enable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.addPredecessor+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+x._id+"EditDialog_PredecesorDelete' class='e-deletepre e-icon e-disable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.removePredecessor+"</span>"),E.append(H),g.append(E),P=t.buildTag("tr","",{"border-collapse":"collapse"},{}),F=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),O=t.buildTag("div#treegrid"+x._id+"predecessorEdit","",{width:"100%",height:"150px"},{}),F.append(O),P.append(F),g.append(P),h.append(g));break;case"Resources":v.resourceInfoMapping&&-1!=y&&(N.append("<li><a href='#"+x._id+"EditResources'>"+x._dialogTabTitleTexts.resourcesTabText+"</a></li>"),m=t.buildTag("div.e-gantt-resource-container","",{},{id:x._id+"EditResources"}),_=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:x._id+"ResourceEditForm"}),m.append(_),L.append(m),f=t.buildTag("table#"+x._id+"resourceeditTable","",{width:"100%",outline:"none","border-collapse":"collapse","margin-top":"0px",position:"relative",left:"-2px",top:"2px"},{}),E=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},{}),(H=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{})).append("<span id='"+x._id+"EditDialog_ResourceAdd' class='e-addpre e-icon e-enable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.addPredecessor+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+x._id+"EditDialog_ResourceDelete' class='e-deletepre e-icon e-disable e-edit-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.removePredecessor+"</span>"),E.append(H),f.append(E),P=t.buildTag("tr","",{"border-collapse":"collapse"},{}),F=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),O=t.buildTag("div#treegrid"+x._id+"resourceEdit","",{width:"100%",height:"150px"},{}),F.append(O),P.append(F),f.append(P),_.append(f));break;case"Custom Fields":x._editDialogCustomColumns.length>0&&(N.append("<li><a href='#"+x._id+"EditCustomFields'>"+x._dialogTabTitleTexts.customFieldsTabText+"</a></li>"),w=t.buildTag("div.e-gantt-csfield-container","",{},{id:x._id+"EditCustomFields"}),C=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:x._id+"CustomFieldsEditForm"}),w.append(C),L.append(w),T=t.buildTag("table#"+x._id+"customFieldeditTable","",{width:"100%",outline:"none",position:"relative",left:"-2px",top:"4px","border-collapse":"collapse","margin-top":"0px"},{}),E=t.buildTag("tr","",{"border-collapse":"collapse"},""),H=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),O=t.buildTag("div#treegrid"+x._id+"customFieldEdit","",{},{}),H.append(O),E.append(H),T.append(E),C.append(T));break;case"Notes":var B=v.editDialogFields,V=(D=B.length,e.map(B,function(e,t){if(e.field==v.notesMapping)return t}));if(v.notesMapping&&0==D||D>0&&V.length>0){N.append("<li><a href='#"+x._id+"EditNotes'>"+x._dialogTabTitleTexts.notesTabText+"</a></li>");var $=t.buildTag("div.e-gantt-notes-container","",{},{id:x._id+"EditNotes"}),q=t.buildTag("div","",{padding:"0px",position:"relative",top:"5px",left:"-1px"},{}),Y=t.buildTag("textarea","",{},{id:x._id+"EditAreaNotes"});q.append(Y),$.append(q),L.append($)}}G=x.renderDiaglogButton("edit",G),e.templates(x._id+"_JSONDialogEditingTemplate",G.html())}},addDialogTemplate:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x=this,v=x.model,b=v.viewType==t.Gantt.ViewType.ProjectView?e.extend([],x._columns):e.extend([],x._resourceViewColumns),S=v.viewType==t.Gantt.ViewType.ProjectView?x._columns:x._resourceViewColumns,D=b.length,R=-1,y=-1,I=x._$treegridHelper.data("ejTreeGrid"),k=x._dialogTab,M=k.length;if(x._addDialogGeneralColumns=[],x._addDialogCustomColumns=[],x._generalTabColumnFields=["taskId","taskMode","taskName","startDate","endDate","duration","resourceInfo","status","work","taskType","effortDriven","baselineStartDate","baselineEndDate","predecessor","WBS","notesText","serialNumber","serialNumberPredecessor"],x._mappingItems=x._getMappingItems(),0!=D){if(v.addDialogFields.length>0){for(a=[],r=0;r<v.addDialogFields.length;r++)(n=e.grep(S,function(e){return e.mappingName===v.addDialogFields[r].field})).length>0&&(a.push(n[0]),-1==x._generalTabColumnFields.indexOf(n[0].mappingName)&&v.addDialogFields[r].displayInGeneralTab&&x._generalTabColumnFields.push(n[0].mappingName));b=a}else v.enableWBS&&(v.enableWBSPredecessor&&(o=b.filter(function(e){return"WBSPredecessor"!=e.mappingName})),o&&o.length&&(b=o));((V=e.map(b,function(e,t){if(e.mappingName==v.taskNameMapping)return t}))[0]+1)%3==0&&b.splice(V[0]-1,0,b.splice(V[0],1)[0]);var E,H,P,F,O,G=t.buildTag("div","",{},{}),L=t.buildTag("div","",{},{id:x._id+"AddTab"}),N=t.buildTag("ul","",{},{});for(L.append(N),G.append(L),D=b.length,c=0;c<D;c++)if(-1!=e.inArray(b[c].mappingName,x._mappingItems)){if(!b[c].mappingName&&"work"==b[c].field||"taskType"==b[c].field||"effortDriven"==b[c].field)continue;b[c].mappingName!==v.predecessorMapping&&b[c].mappingName!=v.resourceInfoMapping&&b[c].mappingName!=v.notesMapping&&"serialNumberPredecessor"!=b[c].mappingName?(V=e.map(x._generalTabColumnFields,function(e,t){if(e==b[c].field)return t})).length>0?x._addDialogGeneralColumns.push(b[c]):x._addDialogCustomColumns.push(b[c]):b[c].mappingName===v.predecessorMapping||"serialNumberPredecessor"===b[c].mappingName?R=c:b[c].mappingName===v.resourceInfoMapping&&(y=c)}for(l=0;l<M;l++)switch(k[l]){case"General":if(x._addDialogGeneralColumns.length>0){N.append("<li><a href='#"+x._id+"AddGeneral'>"+x._dialogTabTitleTexts.generalTabText+"</a></li>"),d=t.buildTag("div.e-gantt-editor-container","",{},{id:x._id+"AddGeneral"}),s=t.buildTag("form","",{height:"auto",width:"auto","font-size":"14px"},{id:x._id+"GeneralAddForm"}),d.append(s),L.append(d);var W,A=t.buildTag("table.e-general-edit-div","",{"border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),z=t.buildTag("tr"),j=0,U=x._addDialogGeneralColumns;D=U.length;for(c=0;c<D;c++)j<3?(U[c].mappingName!==v.taskNameMapping?(j++,W=t.buildTag("td.e-property-container","",{},{})):(j+=2,W=t.buildTag("td.e-property-container","",{},{colspan:"2"})),u=t.buildTag("table","",{outline:"none","border-spacing":"2px","border-collapse":"separate","margin-top":"0px"},{}),E=t.buildTag("tr","",{"line-height":"1.4"},{}),(H=t.buildTag("td.e-editLabel","",{},{})).append("<label>"+x._columnHeaderTexts[U[c].field]+"</label>"),E.append(H),u.append(E),P=t.buildTag("tr"),F=t.buildTag("td.e-editValue","",{},{}),i=S.indexOf(U[c]),t.TreeGrid._initCellEditType(I,F,x._id,i,"Add",v.viewType!=t.Gantt.ViewType.ProjectView,S),P.append(F),u.append(P),W.append(u),z.append(W)):(A.append(z),z=t.buildTag("tr"),c--,j=0);A.append(z),s.append(A)}break;case"Predecessors":v.predecessorMapping&&-1!=R&&(N.append("<li><a href='#"+x._id+"AddPredecessors'>"+x._dialogTabTitleTexts.predecessorsTabText+"</a></li>"),p=t.buildTag("div.e-gantt-predecessor-container","",{},{id:x._id+"AddPredecessors"}),h=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:x._id+"PredecessorAddForm"}),p.append(h),L.append(p),g=t.buildTag("table#"+x._id+"predecessoraddTable","",{width:"100%",outline:"none","border-collapse":"collapse",position:"relative",left:"-2px",top:"2px","margin-top":"0px"},{}),E=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},{}),(H=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{})).append("<span id='"+x._id+"AddDialog_PredecesorAdd' class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.addPredecessor+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+x._id+"AddDialog_PredecesorDelete' class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.removePredecessor+"</span>"),E.append(H),g.append(E),P=t.buildTag("tr","",{"border-collapse":"collapse"},{}),F=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),O=t.buildTag("div#treegrid"+x._id+"predecessorAdd","",{width:"100%",height:"150px"},{}),F.append(O),P.append(F),g.append(P),h.append(g));break;case"Resources":v.resourceInfoMapping&&-1!=y&&(N.append("<li><a href='#"+x._id+"AddResources'>"+x._dialogTabTitleTexts.resourcesTabText+"</a></li>"),m=t.buildTag("div.e-gantt-resource-container","",{},{id:x._id+"AddResources"}),_=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:x._id+"ResourceAddForm"}),m.append(_),L.append(m),f=t.buildTag("table#"+x._id+"resourceaddTable","",{width:"100%",outline:"none","border-collapse":"collapse",position:"relative",left:"-2px",top:"2px","margin-top":"0px"},{}),E=t.buildTag("tr","",{"border-collapse":"collapse",height:"40px"},{}),(H=t.buildTag("td.e-editLabel","",{outline:"none","border-collapse":"collapse",padding:"1px"},{})).append("<span id='"+x._id+"AddDialog_ResourceAdd' class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.addPredecessor+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span id='"+x._id+"AddDialog_ResourceDelete' class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer; width: auto;position:relative;left:10px;'>&nbsp;&nbsp;"+x._editDialogTexts.removePredecessor+"</span>"),E.append(H),f.append(E),P=t.buildTag("tr","",{"border-collapse":"collapse"},{}),F=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),O=t.buildTag("div#treegrid"+x._id+"resourceAdd","",{width:"100%",height:"150px"},{}),F.append(O),P.append(F),f.append(P),_.append(f));break;case"Custom Fields":x._addDialogCustomColumns.length>0&&(N.append("<li><a href='#"+x._id+"AddCustomFields'>"+x._dialogTabTitleTexts.customFieldsTabText+"</a></li>"),w=t.buildTag("div.e-gantt-csfield-container","",{},{id:x._id+"AddCustomFields"}),C=t.buildTag("form","",{height:"auto",width:"592px","font-size":"14px"},{id:x._id+"CustomfFieldsAddForm"}),w.append(C),L.append(w),T=t.buildTag("table#"+x._id+"customfieldaddTable","",{width:"100%",outline:"none","border-collapse":"collapse",position:"relative",left:"-2px",top:"4px"},{}),E=t.buildTag("tr","",{"border-collapse":"collapse"},{}),H=t.buildTag("td.e-editValue","",{"border-collapse":"collapse",padding:"1px"},{}),O=t.buildTag("div#treegrid"+x._id+"customFieldAdd","",{},{}),H.append(O),E.append(H),T.append(E),C.append(T));break;case"Notes":var B=v.addDialogFields,V=(D=B.length,e.map(B,function(e,t){if(e.field==v.notesMapping)return t}));if(v.notesMapping&&0==D||D>0&&V.length>0){N.append("<li><a href='#"+x._id+"AddNotes'>"+x._dialogTabTitleTexts.notesTabText+"</a></li>");var $=t.buildTag("div.e-gantt-notes-container","",{},{id:x._id+"AddNotes"}),q=t.buildTag("div","",{padding:"0px",position:"relative",top:"5px",left:"-1px"},{}),Y=t.buildTag("textarea","",{},{id:x._id+"AddAreaNotes"});q.append(Y),$.append(q),L.append($)}}G=x.renderDiaglogButton("add",G),e.templates(x._id+"_JSONDialogAddingTemplate",G.html())}},_clearContextMenu:function(){e(".e-tgcontextmenu").remove(),e(".e-tginnerContextmenu").remove()},_createContextMenuTemplate:function(){var t,i,a=this,r={};r["_"+a._id+"getHeaderName"]=e.proxy(a._getHeaderName,a),e.views.helpers(r),t="<li style='list-style-type:none;margin:0px;'>",t+="<div class='e-menuitem{{if disable}} e-disable{{/if}}{{if ~_"+a._id+"getHeaderName(#data)}} e-parent-menuitem{{/if}}' id={{:menuId}}  style='display:table;cursor:pointer;min-width:100px;'>{{if iconPath}}<div class='e-icon e-tgcontextmenu-image' style='background-image:{{:iconPath}};background-repeat:no-repeat;'/>{{else}}<div class='e-icon {{:iconClass}} e-tgcontextmenu-icon'/>{{/if}}<div class='e-tgcontextmenu-label'><span>{{:headerText}}</span></div>{{if ~_"+a._id+"getHeaderName(#data)}}<div class='e-icon e-expander e-tgcontextmenu-icon'/> {{/if}}",t+="</div></li>",(i={})[a._id+"contextMenuTemplate"]=t,e.templates(i)},_getHeaderName:function(e){return this._contextMenuItems.filter(function(t){if(null!=e.menuId&&e.menuId==t.parentMenuId)return!0}).length>0},initCellEditType:function(i,a,r){var n,o,l,d,s,c=this,u=c.model,p={};switch(n=r||"",t.isNullOrUndefined(i.editType)&&(i.editType="stringedit"),i.editType){case"stringedit":i.mappingName===u.predecessorMapping?(p["_"+c._id+"predecessor"]=c._getPredecessorsValue,e.views.helpers(p),a.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+c._id+"predecessor('"+c._id+"Object','"+u.predecessorMapping+"','"+i.field+"')}}",id:c._id+i.field,name:i.field}))):a.html(t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+i.field+"']}}",id:c._id+i.field+n,name:i.field,"data-dialog":r}));break;case"booleanedit":a.html("{{if "+i.field+'}} <input class="e-field e-checkbox" type ="checkbox" id='+c._id+i.field+" name="+i.field+' checked="checked"></input>{{else}} <input class="e-field e-checkbox" type ="checkbox" id='+c._id+i.field+" name="+i.field+" > {{/if}}");break;case"numericedit":o=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:c._id+i.field+n,name:i.field,"data-dialog":r}),a.append(o);break;case"datepicker":case"datetimepicker":l=t.buildTag("input.e-"+i.editType+" e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:c._id+i.field+n,name:i.field,"data-dialog":r}),a.append(l);break;case"dropdownedit":d=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",value:"{{:#data['"+i.field+"']}}",id:c._id+i.field+n,name:i.field,"data-dialog":r}),a.append(d);break;case"maskedit":s=t.buildTag("input .e-field e-maskedit","",{},{value:"{{:#data['"+i.field+"']}}",id:c._id+i.field+n,name:i.field,"data-dialog":r}),a.append(s)}},_getPredecessorsValue:function(e,t){return this.data.item?this.data.item[t]:""},_getDurationValues:function(e,i){var a,r,n,o="",l=this.model,d=null;return"string"==typeof e?(a=","!=t.globalize.findCulture(l.locale).numberFormat[","]?e.match(/(\d*\.*\,*\d+|[A-z]+)/g):e.match(/(\d*\.*\d+|[A-z]+)/g))&&a.length<=2&&(o=t.parseFloat(a[0],null,l.locale),r=a[1]?a[1].toLowerCase():null,1!=o,-1!=this._durationUnitEditText.minute.indexOf(r)?d=t.Gantt.DurationUnit.Minute:-1!=this._durationUnitEditText.hour.indexOf(r)?d=t.Gantt.DurationUnit.Hour:-1!=this._durationUnitEditText.day.indexOf(r)&&(d=t.Gantt.DurationUnit.Day)):(o=e,d=null),isNaN(o)&&(o=i?this._editedDialogRecord.duration:null,d=i?this._editedDialogRecord.durationUnit:null),(n={}).duration=o,n.durationUnit=d,n},_editStartDateChange:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m=this,_=m._id,f=m.model,w=i.attr("id"),C=(this.model.holidays,i.attr("data-dialog")),T=("row"==f.selectionMode?this.selectedItem():f.updatedRecords[m._rowIndexOfLastSelectedCell],this._editedDialogRecord),x="true"==T.effortDriven;if(!this._editedDialogRecord.isUpdatedFromDialog){this._editedDialogRecord.isUpdatedFromDialog=!0,"Add"===C?(n="#"+_+"startDateAdd",o="#"+_+"endDateAdd",l="#"+_+"durationAdd","#"+_+"effortDrivenAdd","#"+_+"taskTypeAdd",r="#"+_+"workAdd",d="#"+_+"baselineStartDateAdd",s="#"+_+"baselineEndDateAdd"):(n="#"+_+"startDateEdit",o="#"+_+"endDateEdit",l="#"+_+"durationEdit","#"+_+"effortDrivenEdit","#"+_+"taskTypeEdit",r="#"+_+"workEdit");var v=e(n).val(),b=e(o).val(),S=e(l).val(),D=e(r).val();v&&""!=v||(v=f.allowUnscheduledTask?null:T.startDate),S&&""!=S||(S=f.allowUnscheduledTask?null:T.duration),b&&""!=b||(b=f.allowUnscheduledTask?null:T.endDate),w===_+"startDateEdit"||w===_+"startDateAdd"?(v=m._getDateFromFormat(v),v=m._checkStartDate(v,T),t.isNullOrUndefined(v)?(T.startDate=null,T.duration=null,T.isMilestone=!1,S=m._getDurationStringValue(T),e(l).val(S),t.isNullOrUndefined(T.endDate)||(0==T.endDate.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,T.endDate),T.endDate=this._checkEndDate(T.endDate,T))):t.isNullOrUndefined(S)?t.isNullOrUndefined(b)?t.isNullOrUndefined(v)||(T.startDate=v):m._getDateFromFormat(v)<T.endDate?(T.startDate=v,T.duration=this._getDuration(T.startDate,T.endDate,T.durationUnit,T.isAutoSchedule),T.isMilestone=0==T.duration,m._updateResourceRelatedFields(T),x||e(r).ejNumericTextbox("option","value",T.work),e(l).val(m._getDurationStringValue(T)),"fixedWork"==T.taskType&&m._updateResourceDataSource(T)):t.isNullOrUndefined(v)||(T.startDate=v):(T.endDate=m._getEndDate(v,T.duration,T.durationUnit,T),T.startDate=v,-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(o).ejDateTimePicker("option","value",T.endDate):e(o).ejDatePicker("option","value",T.endDate)),m.getFormatedDate(v)!=a.value&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(n).ejDateTimePicker("option","value",v):e(n).ejDatePicker("option","value",v))):w===_+"endDateEdit"||w===_+"endDateAdd"?(b=m._getDateFromFormat(b),t.isNullOrUndefined(b)||0!=b.getHours()||86400==this._defaultEndTime||this._setTime(this._defaultEndTime,b),b=this._checkEndDate(b,T),t.isNullOrUndefined(b)?(T.endDate=null,T.duration=null,T.isMilestone=!1,S=m._getDurationStringValue(T),e(l).val(S)):t.isNullOrUndefined(v)?t.isNullOrUndefined(S)?t.isNullOrUndefined(b)||(T.endDate=b):(T.endDate=b,T.startDate=m._getStartDate(T.endDate,T.duration,T.durationUnit,T),T.isMilestone&&(T.startDate=this._checkStartDate(T.startDate,T)),m.getFormatedDate(T.startDate)!=v&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(n).ejDateTimePicker("option","value",T.startDate):e(n).ejDatePicker("option","value",T.startDate))):T.startDate<b?(T.endDate=b,T.duration=this._getDuration(T.startDate,b,T.durationUnit,T.isAutoSchedule),T.isMilestone=0==T.duration,m._updateResourceRelatedFields(T),x||e(r).ejNumericTextbox("option","value",T.work),e(l).val(m._getDurationStringValue(T)),"fixedWork"==T.taskType&&m._updateResourceDataSource(T)):b=T.endDate,m.getFormatedDate(b)!=a.value&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(o).ejDateTimePicker("option","value",b):e(o).ejDatePicker("option","value",b))):w===_+"durationEdit"||w===_+"durationAdd"?(c=(p=m._getDurationValues(S,!0)).duration,u=t.isNullOrUndefined(p.durationUnit)?T.durationUnit:p.durationUnit,(T.duration!=c||T.durationUnit!=u)&&(""===c||null===c?(T.endDate=null,T.duration=null,T.isMilestone=!1,T.durationUnit=u,-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(o).ejDateTimePicker("option","value",T.endDate):e(o).ejDatePicker("option","value",T.endDate)):t.isNullOrUndefined(v)?t.isNullOrUndefined(b)?t.isNullOrUndefined(c)||(T.duration=c,T.durationUnit=u):(T.duration=c,T.durationUnit=u,T.startDate=m._getStartDate(T.endDate,T.duration,T.durationUnit,T),T.isMilestone&&(T.startDate=this._checkStartDate(T.startDate,T)),m.getFormatedDate(T.startDate)!=v&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(n).ejDateTimePicker("option","value",T.startDate):e(n).ejDatePicker("option","value",T.startDate))):(T.duration=c,T.durationUnit=u,T.isMilestone=0==T.duration,T.endDate=m._getEndDate(T.startDate,T.duration,T.durationUnit,T),-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(o).ejDateTimePicker("option","value",T.endDate):e(o).ejDatePicker("option","value",T.endDate))),m._updateResourceRelatedFields(T),x||e(r).ejNumericTextbox("option","value",T.work),e(l).val(m._getDurationStringValue(T)),"fixedWork"==T.taskType&&m._updateResourceDataSource(T)):w===_+"workEdit"||w===_+"workAdd"?(T.work=parseInt(D),m._updateResourceRelatedFields(T),"fixedDuration"!=T.taskType&&T.isAutoSchedule?(e(l).val(m._getDurationStringValue(T)),T.isMilestone&&(T.duration>0&&(T.isMilestone=!1),T.startDate=this._checkStartDate(T.startDate,T),m.getFormatedDate(T.startDate)!=v&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(n).ejDateTimePicker("option","value",T.startDate):e(n).ejDatePicker("option","value",T.startDate))),"resourceView"==f.viewType&&(T.duration=0==T.duration?1:T.duration),b=this._getEndDate(T.startDate,T.duration,u,T),T.endDate=b,-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(o).ejDateTimePicker("option","value",b):e(o).ejDatePicker("option","value",b)):m._updateResourceDataSource(T)):w===_+"baselineStartDateAdd"?e(s).length>0&&(h=m._getDateFromFormat(e(d).val()),g=m._getDateFromFormat(e(s).val()),h&&g&&h.getTime()>g.getTime()&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(d).ejDateTimePicker("option","value",a.prevDate):e(d).ejDatePicker("option","value",a.prevDate))):w===_+"baselineEndDateAdd"&&e(d).length>0&&(h=m._getDateFromFormat(e(d).val()),g=m._getDateFromFormat(e(s).val()),h&&g&&h.getTime()>g.getTime()&&(-1!=f.dateFormat.toLowerCase().indexOf("hh")?e(s).ejDateTimePicker("option","value",a.prevDate):e(s).ejDatePicker("option","value",a.prevDate))),this._editedDialogRecord.isUpdatedFromDialog=!1}},_taskNameCollection:function(){var e,t,i=this,a="resourceView"==this.model.viewType?this._resourceUniqTasks:i.model.flatRecords;for(i._preTableCollection=[],i._preTaskIds=[],e=0;e<a.length;e++)a[e].hasChildRecords||(t=i.model.enableSerialNumber?{id:a[e].taskId.toString(),text:a[e].serialNumber.toString()+"-"+a[e].taskName,value:a[e].serialNumber.toString()}:{id:a[e].taskId.toString(),text:a[e].taskId.toString()+"-"+a[e].taskName,value:a[e].taskId.toString()},i._preTaskIds.push(t.value),i._preTableCollection.push(t))},_getPredecessorDropdownData:function(e,t){var i,a=this,r=a.model,n=a._preTableCollection,o=a._preTaskIds,l=r.enableSerialNumber?t.serialNumber:t.taskId;i=o.indexOf(l.toString()),n.splice(i,1),o.splice(i,1),a._getVaildSuccessorTasks(t,o,n)},_idFromPredecessor:function(t){for(var i,a,r=e.map(t.split(","),e.trim),n=[],o=0;o<r.length;o++){for(i=[],a=0;a<r[o].length&&!isNaN(r[o].charAt(a));a++)i.push(r[o].charAt(a));n.push(i.join(""))}return n},_idFromSerialPredecessor:function(t){for(var i,a,r=e.map(t.split(","),e.trim),n=[],o=this.model.flatRecords,l=0;l<r.length;l++)(i=r[l].match(/(\d+|[A-z]+)/g))&&i[0]&&(e.map(o,function(e){if(e.serialNumber==i[0])return a=e.taskId,!1}),a&&n.push(a));return n},_preEditDialogChangeEvent:function(i,a,r,n){var o,l,d=e(i).data("ejTreeGrid"),s=t.TreeGrid.getRowByIndex(d,d.selectedRowIndex());"name"==r?(o=e(s).find("td:eq(0)"),e(o).html(n.value)):(o=e(s).find("td:eq(1)"),l=n.model.dataSource[n.itemId],e(o).html(l.text))},_preBeginEdit:function(t,i,a){for(var r,n,o=this,l=a.model,d=l.columns,s=e.extend(!0,[],o._preTableCollection),c=e.extend(!0,[],o._preTaskIds),u=l.dataSource,p=u.length,h=a.data.item.id,g=0;g<p;g++)(r=u[g]).id!=h&&(n=c.indexOf(r.id),c.splice(n,1),s.splice(n,1));d[0].dropdownData=d[1].dropdownData=s,s.length<=1&&o._enbleDisablePredecessorAddButton("disable",i.requestType)},_preEndEdit:function(i,a,r){var n,o=r.model.dataSource,l=r.model.selectedItem;r.model.preIds;null!==r.value&&("name"===r.columnName||"id"===r.columnName)&&(r.value.length>0&&(l.id=l.name=r.value,-1===(n=o.indexOf(l.item))&&(o.push(l.item),n=o.indexOf(l.item)),o[n].id=o[n].name=r.value),l.type||t.isNullOrUndefined(n)||(l.type="Finish-Start",o[n].type="Finish-Start"),e(i).ejTreeGrid("refreshRow",r.model.selectedRowIndex))},_enableDisablePredecessorDelete:function(t){var i,a=this;i=e("add"==t?"#"+a._id+"AddDialog_PredecesorDelete":"#"+a._id+"EditDialog_PredecesorDelete"),e(i).unbind("click",e.proxy(a._deletepredecessor,a)).bind("click",e.proxy(a._deletepredecessor,a)),e(i).removeClass("e-disable").addClass("e-enable")},_enableDisableResouceDelete:function(t){var i,a=this;i=e("add"==t?"#"+a._id+"AddDialog_ResourceDelete":"#"+a._id+"EditDialog_ResourceDelete"),e(i).unbind("click",e.proxy(a._deleteResource,a)).bind("click",e.proxy(a._deleteResource,a)),e(i).removeClass("e-disable").addClass("e-enable")},_predecessorEditCollection:function(e){var i,a,r,n,o,l,d,s,c,u,p,h,g=this,m=g.model,_=[];if("#"+g._id+"predecessor",a=g._predecessorCollectionText,_=[],r=e||m.selectedItem,i=g._preTableCollection,!t.isNullOrUndefined(r)&&!t.isNullOrUndefined(r.predecessor)&&!t.isNullOrUndefined(r.item[m.predecessorMapping])){var f=r.predecessor,w=f.length,C=a.length,T=i.length;for(n=0;n<w;n++)if(o=(o=m.enableSerialNumber?g._snoFromTaskId(f[n].from):f[n].from).toString(),r.taskId.toString()!==f[n].from.toString()){for(0,s=0;s<T;s++)if(i[s].value===o){l=i[s].value;break}for(c=0;c<C;c++)a[c].id==f[n].predecessorsType&&(d=a[c].text);u=1!=Math.abs(f[n].offset),p="",p+="day"==f[n].offsetDurationUnit?u?this._durationUnitTexts.days:this._durationUnitTexts.day:"hour"==f[n].offsetDurationUnit?u?this._durationUnitTexts.hours:this._durationUnitTexts.hour:u?this._durationUnitTexts.minutes:this._durationUnitTexts.minute,h={id:o,name:l,type:d,offset:f[n].offset+" "+p},_.push(h)}}return _},_getResourceInfoIndex:function(e,t){var i=0,a=[];if(e&&t)for(;i<e.length;i++)t[e[i]]&&a.push(e[i]);return a},_getNewSerialNumber:function(){var e,i,a=this,r=a.model,n=r.flatRecords,o=r.editSettings.rowPosition.toLowerCase();if(i=(e="row"==r.selectionMode?r.selectedItem:r.updatedRecords[a._rowIndexOfLastSelectedCell])?r.updatedRecords.indexOf(e)+1:"bottom"==o?n.length+1:1,e)switch(o){case t.Gantt.RowPosition.BelowSelectedRow:e.hasChildRecords?i=i+a._$treegridHelper.ejTreeGrid("getChildCount",e,0)+1:i+=1;break;case t.Gantt.RowPosition.Top:i=1;break;case t.Gantt.RowPosition.Bottom:i=n.length+1;break;case t.Gantt.RowPosition.Child:i+=1}return i},_snoFromTaskId:function(t){var i,a=this.model.flatRecords;return e.map(a,function(e){if(e.taskId==t)return i=e.serialNumber,!1}),i},_refreshEditForm:function(a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x,v,b,S,D,R,y,I,k,M=this,E=!1,H=0,P="165px",F=M.model,O={},G="resourceView"==F.viewType?a.data:"row"==F.selectionMode?F.selectedItem:F.updatedRecords[M._rowIndexOfLastSelectedCell],L="resourceView"==F.viewType?M._resourceViewColumns:M._columns;if("add"==a.requestType){document.getElementById(M._id+"AddTab");var N=e("#"+M._id+"_dialogAdd_wrapper"),W=document.getElementById(M._id+"GeneralAddForm"),A="#treegrid"+M._id+"predecessorAdd",z="#"+M._id+"AddAreaNotes",j="#treegrid"+M._id+"resourceAdd",U="#treegrid"+M._id+"customFieldAdd";!t.isNullOrUndefined(this.dataSource())&&0==this.dataSource().length&&F.predecessorMapping&&e(A).length>0?((u=[])[0]=M._dialogTab.indexOf("Predecessors"),e("#"+M._id+"AddTab").ejTab("option","disabledItemIndex",u)):((u=[])[0]=M._dialogTab.indexOf("Predecessors"),e("#"+M._id+"AddTab").ejTab("option","enabledItemIndex",u)),d=M._getNewTaskId(),M.model.enableWBS&&(p=F.editSettings.rowPosition.toLowerCase(),h=M._getNewWBSid(p)),s=F.enableSerialNumber&&M._getNewSerialNumber()}else{document.getElementById(M._id+"EditTab"),N=e("#"+M._id+"_dialogEdit_wrapper"),W=document.getElementById(M._id+"GeneralEditForm"),A="#treegrid"+M._id+"predecessorEdit",z="#"+M._id+"EditAreaNotes",j="#treegrid"+M._id+"resourceEdit",U="#treegrid"+M._id+"customFieldEdit";F.flatRecords.length<=2&&1==F.parentRecords.length&&F.predecessorMapping&&e(A).length>0&&e("#"+M._id+"EditTab").ejTab("removeItem",1)}for(X=(r=e(W).find("input,select")).length;H<X;H++)if(n=r.eq(H),O={},P=180,l=t.TreeGrid.getColumnByField(L,n.prop("name"))){if(k=a.data[l.field],n.hasClass("e-numerictextbox"))o=P,O.width=o,O.showSpinButton=!0,O.cssClass=F.cssClass,C=(C=n[0].id).replace(M._id,""),!t.isNullOrUndefined(G)&&G.hasChildRecords&&("statusEdit"==C||"workEdit"==C)&&(O.readOnly=!0,n.closest("td").css("opacity",.5)),("statusEdit"==C||"statusAdd"==C)&&(O.maxValue=100,O.minValue=0),"workEdit"==C&&(O.change=function(){M._updatedColumn="work",M._editStartDateChange(e(this.element[0]))}),O.value=k&&k.toString().length?parseFloat(k):0,t.isNullOrUndefined(l.editParams)||e.extend(O,l.editParams),n.ejNumericTextbox(O),n.prop("name",n.prop("name").replace(M._id,""));else if(n.hasClass("e-datepicker"))O.width=P,O.cssClass=F.cssClass,O.dateFormat=F.dateFormat,O.locale=F.locale,O.startDay=F.scheduleHeaderSettings.weekStartDay,O.change=function(e){this.option("value",e.value),M._updatedColumn=this.element[0].name,M._editStartDateChange(this.element,e);var t=this.element[0].id;("startDateEdit"==(t=t.replace(M._id,""))||"endDateEdit"==t)&&(M._datePickerChangeEvent=!0)},C=(C=n[0].id).replace(M._id,""),!t.isNullOrUndefined(G)&&G.hasChildRecords&&G.isAutoSchedule&&("startDateEdit"==C||"endDateEdit"==C)&&"add"!==a.requestType&&(O.readOnly=!0,n.closest("td").css("opacity",.5)),k&&k.toString().length||F.allowUnscheduledTask&&"beginedit"==a.requestType?O.value=M._getDateFromFormat(k):(g=M._getDateFromFormat(F.scheduleStartDate),"endDate"==l.field&&F.viewType==t.Gantt.ViewType.ResourceView&&g.setDate(g.getDate()+1),O.value=g),l.format!==i&&l.format.length>0&&(c=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(l.format),O.dateFormat=c[2],O.value=t.isNullOrUndefined(O.value)?null:t.format(new Date(O.value),O.dateFormat,O.locale),n.val(O.value)),t.isNullOrUndefined(l.editParams)||e.extend(O,l.editParams),n.ejDatePicker(O);else if(n.hasClass("e-datetimepicker"))(O={width:P,rtl:F.rtl,locale:F.locale,cssClass:F.css,dateTimeFormat:F.dateFormat,startDay:F.scheduleHeaderSettings.weekStartDay}).change=function(e){M._updatedColumn=this.element[0].name,this._prevDateTimeVal&&M._editStartDateChange(this.element,e);var t=this.element[0].id;("startDateEdit"==(t=t.replace(M._id,""))||"endDateEdit"==t)&&(M._datePickerChangeEvent=!0)},C=(C=n[0].id).replace(M._id,""),!t.isNullOrUndefined(G)&&G.hasChildRecords&&G.isAutoSchedule&&G.isAutoSchedule&&("startDate"==C||"endDate"==C)&&"add"!==a.requestType&&(O.readOnly=!0,n.closest("td").css("opacity",.5)),F.viewType==t.Gantt.ViewType.ResourceView&&0==k.toString().length?(g=M._getDateFromFormat(F.scheduleStartDate),"endDate"==l.field&&g.setDate(g.getDate()+1),O.value=g):O.value=M._getDateFromFormat(k),t.isNullOrUndefined(l.editParams)||e.extend(O,l.editParams),n.ejDateTimePicker(O);else if(n.hasClass("e-dropdownlist"))m=l.dropdownData,"resourceInfo"===l.field?n.ejDropDownList({cssClass:F.cssClass,width:P,showCheckbox:!0,dataSource:m,fields:{id:F.resourceIdMapping,text:F.resourceNameMapping,value:F.resourceNameMapping},selectedItems:"add"==a.requestType?M._getResourceInfoIndex(a.data.resourceInfo,this._resourceCollection):M.getIndexofresourceInfo(m,a.data)}):((T={}).cssClass=F.cssClass,T.width=P,T.dataSource=m,T.value=k,T.change=function(){M._updateEditDialogFields(this)},t.isNullOrUndefined(l.editParams)||e.extend(T,l.editParams),n.val.length&&("taskMode"==l.field?(k="beginedit"==a.requestType?!a.data.isAutoSchedule:"manual"==F.taskSchedulingMode,T.value=k.toString()):"taskType"==l.field?T.value="beginedit"==a.requestType?a.data.taskType:M.model.taskType:"effortDriven"==l.field&&(T.value="beginedit"==a.requestType?a.data.effortDriven:"fixedWork"==F.taskType)),"beginedit"!=a.requestType||a.data.isAutoSchedule||"taskType"!=l.field&&"effortDriven"!=l.field||(T.enabled=!1),"fixedWork"==a.data.taskType&&"effortDriven"==l.field&&(T.enabled=!1),"add"==a.requestType&&"effortDriven"==l.field&&"fixedWork"==F.taskType&&(T.enabled=!1),("taskType"==l.field||"effortDriven"==l.field)&&a.data.hasChildRecords&&(T.enabled=!1),"taskMode"==l.field&&F.taskSchedulingMode!=t.Gantt.TaskSchedulingMode.Custom&&(T.enabled=!1),n.val(T.value),n.ejDropDownList(T),n.ejDropDownList("instance")._setValue(n.val()));else if(n.hasClass("e-maskedit"))(T={}).locale=F.locale,T.cssClass=F.cssClass,T.width=P,t.isNullOrUndefined(l.editParams)||e.extend(T,l.editParams),n.ejMaskEdit(T);else switch(n.prop("tagName")){case"INPUT":"checkbox"!=n.attr("type")?("taskId"===n.attr("name")?"add"!==a.requestType?(n.attr("readonly","readonly"),n.css("opacity",.5),n.val(a.data.taskId)):"add"===a.requestType&&(""==a.data.taskId||t.isNullOrUndefined(a.data.taskId)?n.val(d):n.val(a.data.taskId)):"taskName"===n.attr("name")?"add"===a.requestType&&(""==a.data.taskName||t.isNullOrUndefined(a.data.taskName))?n.val(M._newTaskTexts.newTaskName+" "+d):n.val(a.data.taskName):"duration"===n.attr("name")?(a.data&&n.val(M._getDurationStringValue(a.data)),_=M._getDurationValues(a.data.duration),f=t.isNullOrUndefined(_.durationUnit)?t.isNullOrUndefined(a.data.durationUnit)?F.durationUnit:a.data.durationUnit:_.durationUnit,"add"!==a.requestType&&a.data.hasChildRecords&&a.data.isAutoSchedule?(n.attr("readonly","readonly"),n.css("opacity",.5)):"add"==a.requestType&&""==a.data.duration?n.val((F.viewType==t.Gantt.ViewType.ResourceView?"1 ":"0 ")+M._durationUnitTexts[f]):("string"==typeof(w=a.data.duration)&&(w=parseFloat(w)),w=isNaN(w)?null:w,t.isNullOrUndefined(w)?n.val(""):n.val(parseFloat(w.toFixed(2))+" "+M._durationUnitTexts[f])),n.change(function(){M._updatedColumn="duration",M._editStartDateChange(e(this))}),n.keyup(function(t){13==t.keyCode&&M._editStartDateChange(e(this))})):"WBS"===n.attr("name")?"add"!==a.requestType?(n.attr("readonly","readonly").css("opacity",.5),n.val(a.data.WBS)):"add"===a.requestType&&(n.val(h),n.attr("readonly","readonly").css("opacity",.5)):"WBSPredecessor"===n.attr("name")?n.attr("readonly","readonly").css("opacity",.5):"serialNumber"===n.attr("name")&&("add"!==a.requestType?(n.attr("readonly","readonly").css("opacity",.5),n.val(a.data.serialNumber)):"add"===a.requestType&&(n.val(s),n.attr("readonly","readonly").css("opacity",.5))),"taskName"===n.attr("name")&&(P=380),C=(C=n[0].id).replace(M._id,""),n.css("text-align",null!=n.attr("name")&&null!=t.TreeGrid.getColumnByField(L,n.prop("name"))?t.TreeGrid.getColumnByField(L,n.attr("name")).textAlign:"center"),n.outerWidth(P)):((T={}).cssClass=F.cssClass,T.size="medium",t.isNullOrUndefined(l.editParams)||e.extend(O,l.editParams),n.ejCheckBox(T));break;case"SELECT":n.width(P).height(23)}n.is(":disabled")||E||n.is(":hidden")&&"object"!=typeof n.data("ejDropDownList")||M._isEnterKeyPressed||(M._focusElements(n.closest("td")),E=!0)}if(F.predecessorMapping&&e(A).length&&(x=[],M._taskNameCollection(),"add"!==a.requestType&&(x=M._predecessorEditCollection(G),M._getPredecessorDropdownData(x,a.data)),v=M._predecessorCollectionText,b=F.enableSerialNumber?M._columnHeaderTexts.serialNumber:M._columnHeaderTexts.taskId,e(A).ejTreeGrid({dataSource:x,allowSorting:!1,columns:[{headerText:b,field:"id",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:M._preTableCollection,width:"89px",editParams:{fields:{text:"value",value:"value"},change:e.proxy(M._preEditDialogChangeEvent,M,A,a.requestType,"id")}},{headerText:M._columnHeaderTexts.taskName,field:"name",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:M._preTableCollection,width:"300px",editParams:{fields:{text:"text",value:"value"},change:e.proxy(M._preEditDialogChangeEvent,M,A,a.requestType,"name"),create:function(){var t,i;""==e(A).data("ejTreeGrid").model.selectedItem.id&&(t=this.model.fields,(i=this.model.dataSource[0])&&e(this.element).attr("data-cellvalue",i[t.value]))}}},{headerText:M._columnHeaderTexts.type,field:"type",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:v,width:"141px"},{headerText:M._columnHeaderTexts.offset,field:"offset",editType:t.TreeGrid.EditingType.String,width:"88px"}],enableAltRow:!1,allowColumnResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing",rowPosition:"bottom",beginEditAction:t.TreeGrid.BeginEditAction.Click},locale:F.locale,endEdit:e.proxy(M._preEndEdit,M,A,a.requestType),beginEdit:e.proxy(M._preBeginEdit,M,A,a),rowSelected:e.proxy(M._enableDisablePredecessorDelete,M,a.requestType),actionBegin:function(e){("delete"==e.requestType||"sorting"==e.requestType)&&(this.model.columns[0].dropdownData=M._preTableCollection,this.model.columns[1].dropdownData=M._preTableCollection)},actionComplete:function(e){"delete"==e.requestType&&(M._enbleDisablePredecessorAddButton("enable",a.requestType),e.model.updatedRecords.length>0?M._enbleDisablePredecessorDeleteButton("enable",a.requestType):M._enbleDisablePredecessorDeleteButton("disable",a.requestType))},treeColumnIndex:5,predecessorTable:M._isFromGantt,sizeSettings:{width:"620px",height:"198px"},isResponsive:!1,cssClass:F.cssClass}),F.selectedItem&&F.selectedItem.hasChildRecords&&"add"!==a.requestType?(M._enbleDisablePredecessorDeleteButton("disable",a.requestType),M._enbleDisablePredecessorAddButton("disable",a.requestType)):"add"!==a.requestType&&M._preTableCollection.length==x.length?M._enbleDisablePredecessorAddButton("disable",a.requestType):(M._enbleDisablePredecessorDeleteButton("disable",a.requestType),M._enbleDisablePredecessorAddButton("enable",a.requestType))),F.resourceInfoMapping&&e(j).length){var B=[],V=this._resourceCollection,$=e.extend(!0,[],V);if("add"!=a.requestType)for(X=(y=a.data.resourceInfo)?y.length:0,H=0;H<X;H++)B.push({name:y[H][F.resourceIdMapping],unit:y[H][F.resourceUnitMapping]});else if(0!=a.data.resourceInfo.length)for((S=new t.Gantt.GanttRecord).item=a.data,D=V,R=a.data.resourceInfo,S.resourceInfo=R&&S._setResourceInfo(R,F.resourceIdMapping,F.resourceNameMapping,F.resourceUnitMapping,D),X=(y=S.resourceInfo)?y.length:0,H=0;H<X;H++)B.push({name:y[H][F.resourceIdMapping],unit:y[H][F.resourceUnitMapping]});$=e.extend(!0,[],V),e(j).ejTreeGrid({dataSource:B,columns:[{headerText:M._columnHeaderTexts.resourceInfo,field:"name",width:"309px",editType:t.TreeGrid.EditingType.Dropdown,dropdownData:$,editParams:{fields:{text:F.resourceNameMapping,value:F.resourceIdMapping},create:function(){var t,i;""==e(j).data("ejTreeGrid").model.selectedItem.name&&(t=this.model.fields,(i=this.model.dataSource[0])&&e(this.element).attr("data-cellvalue",i[t.value]))}}},{headerText:M._columnHeaderTexts.unit,field:"unit",width:"309px",editType:t.TreeGrid.EditingType.Numeric,visible:F.viewType!=t.Gantt.ViewType.ResourceView,headerTextAlign:"center"}],enableAltRow:!1,allowColumnResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing",beginEditAction:t.TreeGrid.BeginEditAction.Click},locale:F.locale,beginEdit:e.proxy(M._resourceBeginEdit,M,j,a.requestType),rowSelected:e.proxy(M._enableDisableResouceDelete,M,a.requestType),actionBegin:function(t){("delete"==t.requestType||"sorting"==t.requestType)&&(this.model.columns[0].dropdownData=e.extend(!0,[],V))},actionComplete:function(e){"delete"==e.requestType&&(M.enbleDisableAddResourceButton("enable",a.requestType),e.model.updatedRecords.length>0?M.enbleDisableDeleteResourceButton("enable",a.requestType):M.enbleDisableDeleteResourceButton("disable",a.requestType))},treeColumnIndex:3,resourceTable:M._isFromGantt,sizeSettings:{width:"620px",height:"198px"},isResponsive:!1,cssClass:F.cssClass}),"add"!==a.requestType&&B.length==V.length?(M.enbleDisableDeleteResourceButton("enable",a.requestType),M.enbleDisableAddResourceButton("disable",a.requestType)):(M.enbleDisableDeleteResourceButton("disable",a.requestType),M.enbleDisableAddResourceButton("enable",a.requestType))}if(e(U).length){if("add"==a.requestType){var q=[],Y=0,X=(K=M._addDialogCustomColumns).length;for(H=0;H<X;H++)(I={}).id=++Y,I.field=K[H].field,I.headerText=K[H].headerText,I.value=a.data[K[H].field],I.text=a.data[K[H].field],I.editType=K[H].editType?K[H].editType.toLowerCase():"stringedit",q.push(I)}else{var K;q=[],Y=0,X=(K=M._editDialogCustomColumns).length;for(H=0;H<X;H++)(I={}).id=++Y,I.field=K[H].field,I.headerText=K[H].headerText,I.value=a.data[K[H].field],I.editType=K[H].editType?K[H].editType.toLowerCase():"stringedit",I.text="dropdownedit"==K[H].editType.toLowerCase()?t.isNullOrUndefined(a.data[K[H].field])?"":M._getDropDownText(K[H],a.data[K[H].field]):a.data[K[H].field],q.push(I)}e(U).ejTreeGrid({dataSource:q,allowSorting:!1,locale:F.locale,enableAltRow:!1,rowHeight:30,columns:[{headerText:M._columnHeaderTexts.dialogCustomFieldName,field:"headerText",allowEditing:!1},{headerText:"Original Value",field:"value",visible:!1},{headerText:"Field",field:"field",visible:!1},{headerText:M._columnHeaderTexts.dialogCustomFieldValue,field:"text",editTemplate:{create:function(){return"<input style='width:100%;'>"},read:e.proxy(M._customColumnRead,M,U),write:e.proxy(M._customColumnWrite,M,K,U)}}],allowColumnResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing",beginEditAction:t.TreeGrid.BeginEditAction.Click},sizeSettings:{width:"620px",height:"234px"},isResponsive:!1,cssClass:F.cssClass})}F.notesMapping&&e(z).length&&("add"==a.requestType?k=a.data.notes:k=a.data.item[F.notesMapping],e(z).ejRTE({width:"620px",isResponsive:!1,height:"281px",value:k,locale:F.locale,cssClass:F.cssClass,tools:{font:["fontName","fontSize","fontColor","backgroundColor"],style:["bold","italic","underline","strikethrough"],alignment:["justifyLeft","justifyCenter","justifyRight","justifyFull"],doAction:["undo","redo"],indenting:[],clear:[],links:["createLink","removeLink"],images:[],media:[],tables:[],lists:["unorderedList"],clipboard:[],edit:[],formatStyle:[],view:[]}}),e(z+"_wrapper").find(".e-toolbar.e-toolbarspan").css("border-bottom","none"),e(z+"_editor").height("208"),e(z+"_Iframe")[0].style.height="203px",e(N).removeClass("e-rte"))},_enbleDisablePredecessorDeleteButton:function(t,i){var a,r=this;a=e("add"==i?"#"+r._id+"AddDialog_PredecesorDelete":"#"+r._id+"EditDialog_PredecesorDelete"),"enable"===t?(e(a).unbind("click",e.proxy(r._deletepredecessor,r)).bind("click",e.proxy(r._deletepredecessor,r)),e(a).addClass("e-enable").removeClass("e-disable")):(e(a).unbind("click",e.proxy(r._deletepredecessor,r)),e(a).addClass("e-disable").removeClass("e-enable"))},_enbleDisablePredecessorAddButton:function(t,i){var a,r=this;a=e("add"==i?"#"+r._id+"AddDialog_PredecesorAdd":"#"+r._id+"EditDialog_PredecesorAdd"),"enable"===t?(e(a).unbind("click",e.proxy(r._addpredecessor,r)).bind("click",e.proxy(r._addpredecessor,r)),e(a).addClass("e-enable").removeClass("e-disable")):(e(a).unbind("click",e.proxy(r._addpredecessor,r)),e(a).addClass("e-disable").removeClass("e-enable"))},_disablePredecessorAddButton:function(t,i){var a,r,n=e(t+"e-table"),o=!1,l=n[0].rows.length;for(this._enbleDisablePredecessorAddButton("disable",i),a=0;a<l;a++)4===(r=n[0].rows[a]).cells.length&&""===r.cells[1].innerText&&(o=!0);o||this._enbleDisablePredecessorAddButton("enable",i)},_updateEditDialogFields:function(i){var a,r,n=this;"Add"==e(i.element).attr("data-dialog")?(r=e("#"+n._id+"effortDrivenAdd").data("ejDropDownList"),a=e("#"+n._id+"taskTypeAdd").data("ejDropDownList")):(r=e("#"+n._id+"effortDrivenEdit").data("ejDropDownList"),a=e("#"+n._id+"taskTypeEdit").data("ejDropDownList")),t.isNullOrUndefined(r)||"taskType"!=i._name||("fixedWork"==i.model.value?(r.selectItemByValue("true"),r.disable()):r.enable(),n._editedDialogRecord[i._name]=i.model.value),"taskMode"==i._name&&("Auto"==i.model.text&&(t.isNullOrUndefined(r)||t.isNullOrUndefined(a)||"fixedWork"==a.model.value||r.enable(),t.isNullOrUndefined(a)||a.enable(),n._editedDialogRecord.isAutoSchedule=!0),"Manual"==i.model.text&&(t.isNullOrUndefined(r)||r.disable(),t.isNullOrUndefined(a)||a.disable(),n._editedDialogRecord.isAutoSchedule=!1))},_customColumnWrite:function(t,a,r){var n,o,l=this,d=r.rowdata!==i?r.rowdata.text:"",s=e(a).ejTreeGrid("instance").model,c=t[s.selectedRowIndex],u={};switch(c.editParams&&(u=e.extend(!0,{},c.editParams)),u.value=d,u.locale=l.model.locale,r.rowdata.editType.toLowerCase()){case"numericedit":u.height="25px",r.element.ejNumericTextbox(u);break;case"stringedit":e(r.element).val(d).css({padding:"0px",border:"0px",height:"25px"}).addClass("e-ejinputtext");break;case"datepicker":u.width="100%",u.height="25px",u.startDay=l.model.scheduleHeaderSettings.weekStartDay,r.element.ejDatePicker(u);break;case"datetimepicker":u.width="100%",u.height="25px",u.startDay=l.model.scheduleHeaderSettings.weekStartDay,r.element.ejDateTimePicker(u);break;case"maskedit":u.width="100%",u.height="25px",r.element.ejMaskEdit(u);break;case"dropdownedit":u.width="100%",u.height="25px",u.dataSource=c.dropdownData,u.value=s.currentViewData[s.selectedRowIndex].value,r.element.ejDropDownList(u);break;case"booleanedit":u.cssClass=l.model.cssClass,u.size="small",u.checked=d,r.element.ejCheckBox(u),(o=(n=r.element.parent(".e-chkbox-wrap")).parent("form")).length>0?o.css("margin-left","45%"):n.css("margin-left","45%")}},_customColumnRead:function(i,a){var r,n,o=e(i).ejTreeGrid("instance"),l=o.model.selectedRowIndex,d=o.model.updatedRecords;return e(a).blur(),e(a).focusout(),e(a[0]).hasClass("e-numerictextbox")?r=n=e(a).ejNumericTextbox("getValue"):e(a[0]).hasClass("e-datepicker")?r=n=e(a).ejDatePicker("getValue"):e(a[0]).hasClass("e-datepicker")?r=n=e(a).ejDatePicker("getValue"):e(a[0]).hasClass("e-dattimeepicker")?r=n=e(a).ejDateTimePicker("getValue"):e(a[0]).hasClass("e-maskedit")?r=n=e(a[0]).ejMaskEdit("model.value"):e(a[0]).hasClass("e-dropdownlist")?(n=e(a[0]).ejDropDownList("model.text"),r=0==e(a[0]).ejDropDownList("model.showCheckbox")&&e(a[0]).ejDropDownList("model.multiSelectMode")==t.MultiSelectMode.None?e(a[0]).ejDropDownList("model.itemValue"):e(a[0]).ejDropDownList("getSelectedValue")):r=n=e(a[0]).hasClass("e-checkbox")?e(a[0]).ejCheckBox("isChecked"):e(a).val(),d[l].value=d[l].item.value=r,d[l].text=d[l].item.text=n,o.refreshRow(l),n},_enableDisableResourceAddButton:function(t,i,a){var r=t.model.dataSource,n=!1;this.enbleDisableAddResourceButton("disable",a),i&&(e.map(r,function(e,t){if(""==e.name||null==e.name)return t}).length>0&&r.length>0&&(n=!0),n||this.enbleDisableAddResourceButton("enable",a))},_addpredecessor:function(t){var i,a,r;i=e(t.target).hasClass("e-edit-dialog")?"#treegrid"+this._id+"predecessorEdit":"#treegrid"+this._id+"predecessorAdd",r=(a=e(i).ejTreeGrid("instance")).model,a.saveCell(),a.clearSelection(r.selectedRowIndex),a.addRow({id:"",name:"",type:"Finish-Start",offset:"0"},"bottom"),a.cellEdit(r.selectedRowIndex,r.columns[1].field)},_deletepredecessor:function(i){var a,r,n;a=e(i.target).hasClass("e-edit-dialog")?"#treegrid"+this._id+"predecessorEdit":"#treegrid"+this._id+"predecessorAdd";var o=e(a).data("ejTreeGrid"),l=o.model,d=o.selectedRowIndex();t.TreeGrid.Actions.Delete,-1!==d&&(o.deleteRow(),(n=(r=l.updatedRecords.length)>d?d:r-1)>-1&&o.selectRows(n))},enbleDisableDeleteResourceButton:function(t,i){var a,r=this;a=e("add"==i?"#"+r._id+"AddDialog_ResourceDelete":"#"+r._id+"EditDialog_ResourceDelete"),"enable"===t?(e(a).unbind("click",e.proxy(r._deleteResource,r)).bind("click",e.proxy(r._deleteResource,r)),e(a).addClass("e-enable").removeClass("e-disable")):(e(a).unbind("click",e.proxy(r._deleteResource,r)),e(a).addClass("e-disable").removeClass("e-enable"))},enbleDisableAddResourceButton:function(t,i){var a,r=this;a=e("add"==i?"#"+r._id+"AddDialog_ResourceAdd":"#"+r._id+"EditDialog_ResourceAdd"),"enable"===t?(e(a).unbind("click",e.proxy(r._addResource,r)).bind("click",e.proxy(r._addResource,r)),e(a).addClass("e-enable").removeClass("e-disable")):(e(a).unbind("click",e.proxy(r._addResource,r)),e(a).addClass("e-disable").removeClass("e-enable"))},_addResource:function(t){var i,a,r;i=e(t.target).hasClass("e-edit-dialog")?"#treegrid"+this._id+"resourceEdit":"#treegrid"+this._id+"resourceAdd",r=(a=e(i).ejTreeGrid("instance")).model,a.saveCell(),a.clearSelection(r.selectedRowIndex),a.addRow({name:"",unit:100},"bottom"),a.cellEdit(r.selectedRowIndex,r.columns[0].field)},_deleteResource:function(i){var a,r,n;a=e(i.target).hasClass("e-edit-dialog")?"#treegrid"+this._id+"resourceEdit":"#treegrid"+this._id+"resourceAdd";var o=e(a).data("ejTreeGrid"),l=o.model,d=o.selectedRowIndex();t.TreeGrid.Actions.Delete,-1!==d&&(o.deleteRow(),(n=(r=l.updatedRecords.length)>d?d:r-1)>-1&&o.selectRows(n))},_resourceBeginEdit:function(t,i,a){for(var r,n=this.model.resourceIdMapping,o=a.model,l=o.columns,d=this._resourceCollection,s=l[0].dropdownData=e.extend(!0,[],d),c=o.dataSource,u=c.length,p=a.data.item.name,h=0;h<u;h++)p!=c[h].name&&(r=e.map(s,function(e,t){if(e[n].toString()==c[h].name)return t}),s.splice(r[0],1));s.length<=1&&this.enbleDisableAddResourceButton("disable",i)},getColumnIndexByField:function(e){for(var t=this.model.columns,i=t.length,a=0;a<i&&t[a].field!=e;a++);return a},getIndexofresourceInfo:function(e,t){for(var i=t.resourceInfo,a=0,r=i?i.length:0,n=[];a<r;a++)-1!=e.indexOf(i[a])&&n.push(e.indexOf(i[a]));return n},_focusElements:function(e){if(e.length){e.focus();var t=e.children();"select"==t[0].tagName.toLowerCase()||"input"==t[0].tagName.toLowerCase()?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t.find(".e-ddl").focus():t.find("input,select").select().focus()}},renderDiaglogButton:function(e,i){var a,r,n,o,l,d,s,c,u,p=this,h=p.model;return a="edit"==e?"EditDialog_":"AddDialog_",r=t.buildTag("input","",{"border-radius":"3px","min-width":"70px"},{type:"button",id:a+p._id+"_Save"}),n="edit"==e?p._editDialogTexts.saveButton:p._editDialogTexts.addButton,r.ejButton({cssClass:h.cssClass,text:n,width:"auto"}),o=p._editDialogTexts.cancelButton,(l=t.buildTag("input","",{"margin-left":"18px","border-radius":"3px","min-width":"70px"},{type:"button",id:a+p._id+"_Cancel"})).ejButton({cssClass:h.cssClass,text:o,width:"auto"}),d=p._editDialogTexts.deleteButton,(s=t.buildTag("input","",{"border-radius":"3px","min-width":"90px"},{type:"button",id:"EditDialog_"+p._id+"_Delete"})).ejButton({cssClass:h.cssClass,text:d,width:"auto"}),c=t.buildTag("div","",{float:"right","z-index":"10"},{class:"e-editform-btn e-editfrom-btn-right"}),u=t.buildTag("div","",{float:"left","z-index":"10"},{class:"e-editform-btn e-editfrom-btn-left"}),c.append(r),"edit"==e&&h.editSettings.allowDeleting&&u.append(s),c.append(l),c.appendTo(i),u.appendTo(i),i},_renderToolBar:function(){var i,a,r,n,o,l=this,d=l.model,s=t.buildTag("div.e-gantttoolbar#e-gantttoolbar"+l._id,"",{height:"50px"},{id:l._id+"_toolbarItems"});return!t.isNullOrUndefined(d.toolbarSettings.toolbarItems)&&d.toolbarSettings.toolbarItems.length&&(i=t.buildTag("ul","",{},{}),l._renderLi(i),s.append(i)),!t.isNullOrUndefined(d.toolbarSettings.customToolbarItems)&&d.toolbarSettings.customToolbarItems.length&&(a=t.buildTag("ul","",{},{}),l._renderCustomLi(a),s.append(a)),-1!=d.toolbarSettings.toolbarItems.indexOf(t.Gantt.ToolbarItems.Search)&&(r=t.buildTag("ul.e-gantt-search-container","",{float:"right"},{}),n=t.buildTag("li","",{},{id:l._id+"_"+t.Gantt.ToolbarItems.Search,tabindex:"0"}),l._renderLiContent(n,t.Gantt.ToolbarItems.Search),r.append(n),s.append(r)),(o={}).click=l._toolBarClick,o.cssClass=d.cssClass,o.rtl=!1,o.itemSeparator=!1,o.width=l._ganttWidth,o.fields={id:"",tooltipText:"",imageUrl:"",text:"",imageAttributes:"",spriteCSS:"",htmlAttributes:""},s.ejToolbar(o),s.ejToolbar("disableItem",l._disabledToolItems),l._disabledToolItems=e(),s},_renderCustomLi:function(i){for(var a,r,n,o=this,l=o.model.toolbarSettings.customToolbarItems,d=0;d<l.length;d++)(l[d].text||l[d].templateID)&&(l[d].text?(a=l[d].tooltipText?l[d].tooltipText:l[d].text,r=t.buildTag("li","",{},{id:o._id+"_"+l[d].text,title:a}),n=t.buildTag("a.e-toolbaricons e-icon e-ganttcustomtoolbaritem","",{}).addClass(l[d].text),r.addClass("e-gantttoolbaritem")):(a=l[d].tooltipText?l[d].tooltipText:l[d].templateID.replace("#",""),r=t.buildTag("li","",{},{id:o._id+"_"+l[d].templateID.replace("#",""),title:a}),n=e(l[d].templateID).hide().html()),r.html(n),i.append(r))},_updateToolbarItems:function(){var e=this.model.toolbarSettings.toolbarItems;-1!=e.indexOf("edit")&&e.splice(e.indexOf("edit"),1),-1!=e.indexOf("indent")&&e.splice(e.indexOf("indent"),1),-1!=e.indexOf("outdent")&&e.splice(e.indexOf("outdent"),1),-1!=e.indexOf("excelExport")&&e.splice(e.indexOf("excelExport"),1),-1!=e.indexOf("pdfExport")&&e.splice(e.indexOf("pdfExport"),1),-1!=e.indexOf("criticalPath")&&e.splice(e.indexOf("criticalPath"),1)},_renderLi:function(e){var i,a,r=this,n=r.model.toolbarSettings.toolbarItems,o=0;for("resourceView"==this.model.viewType&&r._updateToolbarItems(),i=n.length;o<i;o++)a=t.buildTag("li","",{},{id:r._id+"_"+n[o],tabindex:"0"}),"search"!==n[o]&&(a.addClass("e-gantttoolbaritem"),r._renderLiContent(a,n[o]),e.append(a))},_renderLiContent:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x=this.model.selectionMode,v=this.selectedRowIndex();this.model.editSettings;switch(a){case"add":r=t.buildTag("a.e-addnewitem e-toolbaricons e-icon e-gantt-add","",{}),o=this._toolboxTooltipTexts.addTool,i.attr("title",o),1!=this.model.readOnly&&this.model.editSettings.allowAdding||this._disabledToolItems.push(i.get(0));break;case"edit":r=t.buildTag("a.e-edititem e-toolbaricons e-icon e-gantt-edit","",{}),l=this._toolboxTooltipTexts.editTool,i.attr("title",l),1!=this.model.readOnly&&this.model.allowSelection&&this.model.editSettings.allowEditing&&-1!=v&&(-1==v||"cell"!=x)&&"click"!=this.model.editSettings.beginEditAction||this._disabledToolItems.push(i.get(0));break;case"delete":d=this._toolboxTooltipTexts.deleteTool,i.attr("title",d),r=t.buildTag("a.e-deleteitem e-toolbaricons e-icon e-gantt-delete","",{}),1!=this.model.readOnly&&this.model.allowSelection&&this.model.editSettings.allowDeleting&&-1!=v&&(-1==v||"cell"!=x)||this._disabledToolItems.push(i.get(0));break;case"update":s=this._toolboxTooltipTexts.saveTool,i.attr("title",s),r=t.buildTag("a.e-saveitem e-toolbaricons e-icon e-gantt-save e-disabletool","",{}),this._disabledToolItems.push(i.get(0));break;case"cancel":c=this._toolboxTooltipTexts.cancelTool,i.attr("title",c),r=t.buildTag("a.e-cancel e-toolbaricons e-icon e-gantt-cancel e-disabletool","",{}),this._disabledToolItems.push(i.get(0));break;case"indent":u=this._toolboxTooltipTexts.indentTool,i.attr("title",u),n=t.buildTag("a.e-indent e-toolbaricons e-icon e-disabletool e-gantt-indent","",{},{}),i.append(n),1!=this.model.readOnly&&this.model.allowSelection&&this.model.editSettings.allowIndent&&-1!=v&&(-1==v||"cell"!=x)||this._disabledToolItems.push(i.get(0));break;case"outdent":p=this._toolboxTooltipTexts.outdentTool,i.attr("title",p),n=t.buildTag("a.e-outdent e-toolbaricons e-icon e-disabletool e-gantt-outdent","",{},{}),i.append(n),1!=this.model.readOnly&&this.model.allowSelection&&this.model.editSettings.allowIndent&&-1!=v&&(-1==v||"cell"!=x)||this._disabledToolItems.push(i.get(0));break;case"expandAll":h=this._toolboxTooltipTexts.expandAllTool,i.attr("title",h),n=t.buildTag("a.e-expandall e-toolbaricons e-icon e-gantt-expandall","",{},{}),i.append(n);break;case"collapseAll":g=this._toolboxTooltipTexts.collapseAllTool,i.attr("title",g),n=t.buildTag("a.e-collapseall e-toolbaricons e-icon e-gantt-collapseall","",{},{}),i.append(n);break;case"prevTimeSpan":m=this._toolboxTooltipTexts.prevTimeSpanTool,i.attr("title",m),n=t.buildTag("a.e-prevtimespan e-toolbaricons e-icon e-gantt-prevtimespan","",{},{}),i.append(n);break;case"nextTimeSpan":_=this._toolboxTooltipTexts.nextTimeSpanTool,i.attr("title",_),n=t.buildTag("a.e-nexttimespan e-toolbaricons e-icon e-gantt-nexttimespan","",{},{}),i.append(n);break;case"criticalPath":f=this._toolboxTooltipTexts.criticalPathTool,i.attr("title",f),n=t.buildTag("a.e-criticaltask e-toolbaricons e-icon e-gantt-criticaltask","",{},{}),i.append(n);break;case"search":w=this._toolboxTooltipTexts.searchTool,n=t.buildTag("input.e-ejinputtext","",{margin:"4px","text-indent":"4px",width:"auto",padding:"1px 4px 1px 0px"},{type:"text",placeholder:w},{color:"#E8E9E9"}),i.css({float:"right",padding:"2px"}),i.attr("title",w),i.addClass("e-search"),i.append(n),n.keydown(e.proxy(this._keyDown,this));break;case"excelExport":C=this._toolboxTooltipTexts.excelExportTool,i.attr("title",C),n=t.buildTag("a.e-excelIcon e-toolbaricons e-icon e-gantt-excelexport","",{},{}),i.append(n);break;case"pdfExport":T=this._toolboxTooltipTexts.pdfExportTool,i.attr("title",T),n=t.buildTag("a.e-pdfIcon e-toolbaricons e-icon","",{},{}),i.append(n)}i.append(r)},_keyDown:function(e){if(13===e.which)return this._toolbarOperation(this._id+"_search",e.currentTarget.value),e.preventDefault(),!1},_updateToolbarOptions:function(){var t=this,i=t.model,a=i.editSettings,r=e("#"+t._id+"_toolbarItems"),n=e(r).find(".e-addnewitem").parent()[0],o=e(r).find(".e-edititem").parent()[0],l=e(r).find(".e-deleteitem").parent()[0],d=e(r).find(".e-indent").parent()[0],s=e(r).find(".e-outdent").parent()[0],c=e(r).find(".e-saveitem").parent()[0],u=e(r).find(".e-cancel").parent()[0],p=[],h=[];1==i.readOnly?(n&&p.push(e(n)),o&&p.push(e(o)),l&&p.push(e(l)),d&&p.push(e(d)),s&&p.push(e(s)),c&&p.push(e(c)),u&&p.push(e(u)),e(r).ejToolbar("disableItem",p)):(a.allowAdding?n&&h.push(n):n&&p.push(e(n)),i.selectedItem?(a.allowEditing&&"click"!=i.editSettings.beginEditAction?o&&h.push(o):o&&p.push(e(o)),a.allowDeleting?l&&h.push(l):l&&p.push(e(l)),t.updateIndentOutdentOption(i.selectedItem)):(a.allowEditing&&o&&p.push(e(o)),a.allowDeleting&&l&&p.push(e(l)),c&&c&&p.push(e(c)),u&&u&&p.push(e(u)),d&&d&&p.push(e(d)),s&&s&&p.push(e(s))),e(r).ejToolbar("disableItem",p),e(r).ejToolbar("enableItem",h))},_renderGantt:function(){var i,a,r,n=this,o=n.model,l=parseInt(n._ganttWidth),d=n.splitterPosition(),s=!1,c=o.splitterSettings.index;if(d||(d=n._splitterPosition(),n.splitterPosition(d)),d||c>-1){if(d)"string"==typeof d&&-1!=d.indexOf("%")?(i=parseInt(d),s=!0):(i=parseInt(d)/l*100,s=!1);else{var u=0,p=c,h=n.getColumns().filter(function(e){return 0!=e.visible});for(p>=h.length&&(p=h.length-1),r=0;r<=p;r++)u+=h[r].width;if(u<=l)i=parseInt(u)/l*100,c=r-1;else for(u=0,r=0;r<=p;r++){if(!(u+h[r].width<=l)){i=parseInt(u)/l*100;break}u+=h[r].width,c=r}o.splitterSettings.index=c}(isNaN(i)||i<0)&&(i=0),i>100&&(i=(i=(2*n._commonColumnWidth+3)/l*100)<30?i:30,s=!0)}else i=(i=(2*n._commonColumnWidth+3)/l*100)<30?i:30,s=!0;(a=100-i-900/l)<=0?(s?n.splitterPosition("100%"):n.splitterPosition(l.toString()),i=100-900/l,a=0):a>0&&(s?n.splitterPosition(Math.round(i)+"%"):n.splitterPosition(Math.round(i*l/100).toString())),n._splitterPosition(n.splitterPosition()),e("#e-ejSpliter"+n._id).ejSplitter({height:n._ganttHeight,width:l,orientation:t.Orientation.Horizontal,properties:[{paneSize:i+"%",collapsible:!1},{paneSize:a+"%",collapsible:!1}],enableAutoResize:!1,resize:e.proxy(n._onResize,n),cssClass:o.cssClass})},_renderTreeGrid:function(){var e=this,t=e.model;e._$treegridHelper.ejTreeGrid({enableAltRow:t.enableAltRow,allowColumnResize:t.allowColumnResize,enableVirtualization:t.enableVirtualization,allowSorting:t.allowSorting,showColumnChooser:t.showColumnChooser,showColumnOptions:t.showColumnOptions,allowMultiSorting:t.allowMultiSorting,sortSettings:t.sortSettings,filterSettings:t.filterSettings,allowSelection:t.allowSelection,selectionType:t.selectionType,selectionMode:t.selectionMode,selectedRowIndex:this.selectedRowIndex(),allowDragAndDrop:"projectView"==t.viewType&&t.allowDragAndDrop,dragTooltip:t.dragTooltip,allowSearching:t.allowSearching,parentIdMapping:t.parentTaskIdMapping,baselineStartDateMapping:t.baselineStartDateMapping,baselineEndDateMapping:t.baselineEndDateMapping,allowKeyboardNavigation:t.allowKeyboardNavigation,cssClass:t.cssClass,locale:t.locale,columns:e.getColumns(),editSettings:t.editSettings,toolbarSettings:t.toolbarSettings,rowTemplate:t.rowTemplate,rowDataBound:t.rowDataBound,queryCellInfo:t.queryCellInfo,cellSelecting:t.cellSelecting,cellSelected:t.cellSelected,selectedCellIndexes:this.selectedCellIndexes(),dataSource:this.dataSource(),flatRecords:t.flatRecords,parentRecords:t.parentRecords,ids:e.model.ids,dateFormat:t.dateFormat,resourceInfoMapping:t.resourceInfoMapping,resourceNameMapping:t.resourceNameMapping,resourceIdMapping:t.resourceIdMapping,resourceUnitMapping:t.resourceUnitMapping,idMapping:t.taskIdMapping,readOnly:t.readOnly,notesMapping:t.notesMapping,showGridCellTooltip:t.showGridCellTooltip,cellTooltipTemplate:t.cellTooltipTemplate,showGridExpandCellTooltip:t.showGridExpandCellTooltip,taskNameMapping:t.taskNameMapping,taskSchedulingModeMapping:t.taskSchedulingModeMapping,startDateMapping:t.startDateMapping,endDateMapping:t.endDateMapping,childMapping:t.childMapping,durationMapping:t.durationMapping,durationUnitMapping:t.durationUnitMapping,durationUnit:t.durationUnit,progressMapping:t.progressMapping,predecessorMapping:t.predecessorMapping,rowHeight:t.rowHeight,emptyRecordText:e._emptyRecordText,isFromGantt:e._isFromGantt,treeColumnIndex:t.treeColumnIndex,workingTimeScale:t.workingTimeScale,enableWBS:t.enableWBS,enableWBSPredecessor:t.enableWBSPredecessor,columnMenuTexts:e._columnMenuTexts,editTypeText:e._editTypeText,clipModeText:e._clipModeText,textAlignTypeText:e._textAlignTypeText,columnDialogTitle:e._columnDialogTitle,deleteColumnText:e._deleteColumnText,okButtonText:e._okButtonText,cancelButtonText:e._cancelButtonText,confirmDeleteText:e._confirmDeleteText,columnDialogFields:t.columnDialogFields,columnDialogTexts:e._columnDialogTexts,enableSerialNumber:t.enableSerialNumber,workMapping:t.workMapping,workUnit:e._workUnitTexts[t.workUnit],taskTypeTexts:e._taskTypeTexts,effortDrivenTexts:e._effortDrivenTexts,dataManagerUpdate:{isDataManagerUpdate:e._isDataManagerUpdate,jsonData:[]},durationUnitEditText:this._durationUnitEditText,durationUnitTexts:e._durationUnitTexts,enableCollapseAll:t.enableCollapseAll,weekStartDay:t.scheduleHeaderSettings.weekStartDay,indentLevelWidth:this.indentLevelWidth,ganttElement:this.element,groupNameMapping:t.groupNameMapping,viewType:t.viewType,nullText:e._nullText,allowUnscheduledTask:t.allowUnscheduledTask})},_renderGanttChart:function(){var e=this,t=this.model;e._$ganttchartHelper.ejGanttChart({dataSource:this.dataSource(),scheduleStartDate:t.scheduleStartDate,scheduleEndDate:t.scheduleEndDate,startDateMapping:t.startDateMapping,endDateMapping:t.endDateMapping,taskNameMapping:t.taskNameMapping,taskIdMapping:t.taskIdMapping,progressMapping:t.progressMapping,durationMapping:t.durationMapping,childPropertyName:t.childMapping,predecessorMapping:t.predecessorMapping,enableVirtualization:t.enableVirtualization,highlightWeekends:t.highlightWeekends,allowDragAndDrop:t.allowDragAndDrop,milestoneMapping:t.milestoneMapping,perDayWidth:e._perDayWidth,workingTimeScale:t.workingTimeScale,roundOffDayworkingTime:t.roundOffDayworkingTime,durationUnit:t.durationUnit,isCriticalPathEnable:this.isCriticalPathEnable,criticalPathCollection:this.criticalPathCollection,perMonthWidth:e._perMonthWidth,perWeekWidth:e._perWeekWidth,perHourWidth:e._perHourWidth,perMinuteWidth:e._perMinuteWidth,perTopHourWidth:e._perTopHourWidth,minuteInterval:e._minuteInterval,includeWeekend:t.includeWeekend,connectorlineWidth:t.connectorlineWidth,workingTimeRanges:e._workingTimeRanges,secondsPerDay:e._secondsPerDay,scheduleHeaderSettings:t.scheduleHeaderSettings,taskbarBackground:t.taskbarBackground,progressbarBackground:t.progressbarBackground,connectorLineBackground:t.connectorLineBackground,parentTaskbarBackground:t.parentTaskbarBackground,parentProgressbarBackground:t.parentProgressbarBackground,holidays:t.holidays,dateFormat:t.dateFormat,locale:t.locale,_durationUnitEditText:this._durationUnitEditText,enableTaskbarTooltip:t.enableTaskbarTooltip,enableTaskbarDragTooltip:t.enableTaskbarDragTooltip,flatRecords:t.flatRecords,parentRecords:t.parentRecords,scheduleWeeks:e._scheduleWeeks,projectStartDate:e._projectStartDate,projectEndDate:e._projectEndDate,scheduleYears:e._scheduleYears,scheduleMonths:e._scheduleMonths,scheduleDays:e._scheduleDays,scheduleHours:e._scheduleHours,progressbarHeight:t.progressbarHeight,tooltipTemplate:t.taskbarTooltipTemplate,tooltipTemplateId:t.taskbarTooltipTemplateId,progressbarTooltipTemplate:t.progressbarTooltipTemplate,progressbarTooltipTemplateId:t.progressbarTooltipTemplateId,queryTaskbarInfo:t.queryTaskbarInfo,readOnly:t.readOnly,showTaskNames:t.showTaskNames,leftTaskLabelMapping:t.leftTaskLabelMapping,rightTaskLabelMapping:t.rightTaskLabelMapping,leftTaskLabelTemplate:t.leftTaskLabelTemplate,rightTaskLabelTemplate:t.rightTaskLabelTemplate,showProgressStatus:t.showProgressStatus,showResourceNames:t.showResourceNames,resourceInfoMapping:t.resourceInfoMapping,resourceNameMapping:t.resourceNameMapping,resourceUnitMapping:t.resourceUnitMapping,enableProgressBarResizing:t.enableProgressBarResizing,allowGanttChartEditing:t.allowGanttChartEditing,taskbarEditingTooltipTemplateId:t.taskbarEditingTooltipTemplateId,taskbarEditingTooltipTemplate:t.taskbarEditingTooltipTemplate,ids:e.model.ids,stripLines:t.stripLines,_predecessorCollection:e._predecessorsCollection,_columns:e._columns,_nonWorkingTimeRange:e._nonWorkingTimeRanges,nonWorkingBackground:t.nonWorkingBackground,highlightNonWorkingTime:t.highlightNonWorkingTime,weekendBackground:t.weekendBackground,allowKeyboardNavigation:t.allowKeyboardNavigation,updatedRecords:e.model.updatedRecords,renderBaseline:t.renderBaseline,baselineColor:t.baselineColor,editSettings:t.editSettings,columnHeaderTexts:e._columnHeaderTexts,durationUnitTexts:e._durationUnitTexts,predecessorEditingTexts:e._predecessorEditingTexts,localizedDays:e._days,localizedMonths:e._months,rowHeight:t.rowHeight,allowSelection:t.allowSelection,selectionMode:t.selectionMode,selectionType:t.selectionType,taskbarTemplate:t.taskbarTemplate,parentTaskbarTemplate:t.parentTaskbarTemplate,milestoneTemplate:t.milestoneTemplate,durationUnitEditText:this._durationUnitEditText,taskbarClick:t.taskbarClick,predecessorText:e._getPredecessorText(),taskbarHeight:e.taskbarHeight,cssClass:t.cssClass,workWeek:t.workWeek,viewType:t.viewType,resourceIdMapping:t.resourceIdMapping,ganttInstance:e,enableSerialNumber:t.enableSerialNumber,predecessorCollectionText:e._predecessorCollectionText,predecessorTooltipTemplate:t.predecessorTooltipTemplate,connectorLineDialogText:e._connectorLineDialogText,allowUnscheduledTask:t.allowUnscheduledTask})},_getPredecessorText:function(){var e=this._predecessorCollectionText[1],t={};return e=e.value.split("-"),t.Start=e[0],t.Finish=e[1],t},_updateColumnDropDownData:function(){for(var e=this,t=e.model.columns,i=t.length,a=0;a<i;a++)"taskMode"==t[a].field&&(t[a].dropdownData=[{id:1,text:e._taskModeTexts.manual,value:"true"},{id:2,text:e._taskModeTexts.auto,value:"false"}]),"taskType"==t[a].field&&(t[a].dropdownData=[{id:1,text:e._taskTypeTexts.fixedWork,value:"fixedWork"},{id:2,text:e._taskTypeTexts.fixedUnit,value:"fixedUnit"},{id:3,text:e._taskTypeTexts.fixedDuration,value:"fixedDuration"}]),"effortDriven"==t[a].field&&(t[a].dropdownData=[{id:1,text:e._effortDrivenTexts.yes,value:"true"},{id:2,text:e._effortDrivenTexts.no,value:"false"}])},createTreeGridColumns:function(){var e,i,a,r,n,o=this,l=o.model,d=[],s=!1;return(l.viewType==t.Gantt.ViewType.ResourceView||l.viewType==t.Gantt.ViewType.HistogramView)&&(s=!0,(a=l.groupNameMapping||l.resourceNameMapping).length>0&&(e={field:"eResourceName",headerText:o._columnHeaderTexts.eResourceName,editType:t.Gantt.EditingType.String,mappingName:a,allowEditing:l.viewType!=t.Gantt.ViewType.HistogramView,allowCellSelection:!0},d.push(e))),(r=l.taskIdMapping).length&&(l.enableSerialNumber&&(i={field:"serialNumber",headerText:o._columnHeaderTexts.serialNumber,width:40,allowEditing:!1,allowSorting:!1,mappingName:"serialNumber",showInColumnChooser:!1},d.push(i)),e=l.showColumnChooser?{field:"taskId",headerText:o._columnHeaderTexts.taskId,width:40,editType:t.Gantt.EditingType.String,mappingName:r,allowEditing:!1,allowCellSelection:!0}:{field:"taskId",headerText:o._columnHeaderTexts.taskId,width:30,editType:t.Gantt.EditingType.String,mappingName:r,allowEditing:!1,allowCellSelection:!0},l.enableSerialNumber&&(e.visible=!1),s?o._resourceViewColumns.push(e):d.push(e)),(r=l.taskNameMapping).length&&(e={field:"taskName",headerText:o._columnHeaderTexts.taskName,width:150,editType:t.Gantt.EditingType.String,mappingName:r,allowCellSelection:!0},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.startDateMapping).length&&(e={field:"startDate",headerText:o._columnHeaderTexts.startDate,width:150,editType:-1==l.dateFormat.toLowerCase().indexOf("hh")?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:r,allowCellSelection:!0,format:"{0:"+l.dateFormat+"}",showNullText:!0},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.endDateMapping).length&&(e={field:"endDate",headerText:o._columnHeaderTexts.endDate,width:150,editType:-1==l.dateFormat.toLowerCase().indexOf("hh")?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:r,allowCellSelection:!0,format:"{0:"+l.dateFormat+"}",showNullText:!0},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.resourceInfoMapping).length&&(e={field:"resourceInfo",headerText:o._columnHeaderTexts.resourceInfo,width:150,editType:t.Gantt.EditingType.Dropdown,mappingName:r,allowCellSelection:!0,dropdownData:this._resourceCollection},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.durationMapping).length&&(e={field:"duration",headerText:o._columnHeaderTexts.duration,width:150,editType:t.Gantt.EditingType.String,allowCellSelection:!0,mappingName:r,showNullText:!0},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.progressMapping).length&&(e={field:"status",headerText:o._columnHeaderTexts.status,width:150,editType:t.Gantt.EditingType.Numeric,mappingName:r,allowCellSelection:!0},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.predecessorMapping).length&&(e=l.enableSerialNumber?{field:"serialNumberPredecessor",headerText:o._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:"serialNumberPredecessor",allowCellSelection:!0}:{field:"predecessor",headerText:o._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:r,allowCellSelection:!0},s?o._resourceViewColumns.push(e):d.push(e)),l.renderBaseline&&l.baselineStartDateMapping&&l.baselineEndDateMapping&&((r=l.baselineStartDateMapping).length&&(e={field:"baselineStartDate",headerText:o._columnHeaderTexts.baselineStartDate,width:150,editType:-1==l.dateFormat.toLowerCase().indexOf("hh")?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:r,format:"{0:"+l.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},s||d.push(e)),(r=l.baselineEndDateMapping).length&&(e={field:"baselineEndDate",headerText:o._columnHeaderTexts.baselineEndDate,width:150,editType:-1==l.dateFormat.toLowerCase().indexOf("hh")?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:r,format:"{0:"+l.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},s||d.push(e))),l.enableWBS&&((r="WBS").length&&(e={field:"WBS",headerText:o._columnHeaderTexts.WBS,width:150,editType:t.Gantt.EditingType.String,allowEditing:!1,mappingName:r},s||d.push(e))),l.enableWBS&&l.enableWBSPredecessor&&((r="WBSPredecessor").length&&(e={field:"WBSPredecessor",headerText:o._columnHeaderTexts.WBSPredecessor,width:150,editType:t.Gantt.EditingType.String,allowEditing:!1,mappingName:r},s||d.push(e))),(r=l.notesMapping).length&&(e={field:"notesText",headerText:o._columnHeaderTexts.notes,width:150,editType:"stringedit",mappingName:r,allowEditing:!0,allowCellSelection:!0},s?o._resourceViewColumns.push(e):d.push(e)),(r=l.taskSchedulingModeMapping).length&&(n=!1,l.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Custom&&(n=!0),e={field:"taskMode",headerText:o._columnHeaderTexts.taskMode,width:100,editType:t.Gantt.EditingType.Dropdown,allowCellSelection:n,allowEditing:n,mappingName:r,dropdownData:[{id:1,text:o._taskModeTexts.manual,value:"true"},{id:2,text:o._taskModeTexts.auto,value:"false"}],editParams:{field:{text:"text",value:"value"}}},s?o._resourceViewColumns.push(e):d.push(e)),r=l.workMapping,e={field:"work",headerText:o._columnHeaderTexts.work,width:150,editType:t.Gantt.EditingType.Numeric,allowEditing:!0,allowCellSelection:!0,visible:!!r},r.length&&(e.mappingName=r),s||d.push(e),e={field:"taskType",headerText:o._columnHeaderTexts.taskType,width:150,editType:t.Gantt.EditingType.Dropdown,dropdownData:[{id:1,text:o._taskTypeTexts.fixedWork,value:"fixedWork"},{id:2,text:o._taskTypeTexts.fixedUnit,value:"fixedUnit"},{id:3,text:o._taskTypeTexts.fixedDuration,value:"fixedDuration"}],editParams:{field:{text:"text",value:"value"}},allowEditing:!0,allowCellSelection:!0,visible:!1},s||d.push(e),e={field:"effortDriven",headerText:o._columnHeaderTexts.effortDriven,width:150,editType:t.Gantt.EditingType.Dropdown,dropdownData:[{id:1,text:o._effortDrivenTexts.yes,value:"true"},{id:2,text:o._effortDrivenTexts.no,value:"false"}],editParams:{field:{text:"text",value:"value"}},allowEditing:!0,allowCellSelection:!0,visible:!1},s||d.push(e),d},_createGanttRecords:function(e){for(var t,a=this,r=a.model,n=r.flatRecords,o=e.length,l=0,d=r.parentRecords,s=(r.allowSorting,r.enableAltRow,a.model.ids);l<o;l++)r.enableWBS&&(e[l].WBS=(l+1).toString()),t=a._createGanttRecord(e[l],0,null,i,"Load"),a._storedIndex++,t.isAltRow=a._storedIndex%2!=0,t.index=a._storedIndex,s[a._storedIndex]=t.taskId.toString(),a._updateLastInsertedId(t.taskId,!0),n.push(t),d.push(t),t.childRecords&&a._addNestedGanttRecords(t.childRecords);r.predecessorMapping&&a._ensurePredecessorCollection(),r.enableWBS&&r.enableWBSPredecessor&&a.createWBSPredecessor(),r.enableSerialNumber&&a.calculateSerialNumberPredecessor()},_calculateScheduleDates:function(t){var i,a,r,n,o,l,d,s=this,c=this.model,u=c.flatRecords;(!c.scheduleEndDate||!c.scheduleStartDate)&&u.length>0||t?(e.each(u,function(e,t){var d,u,p=[];for(t.eResourceChildTasks.length>0?p=t.eResourceChildTasks:"groupTask"!=t.eResourceTaskType&&"resourceTask"!=t.eResourceTaskType&&p.push(t),d=0;d<p.length;d++)u=p[d],r=s._getValidStartDate(u),n=s._getValidEndDate(u),o=u.baselineStartDate?new Date(u.baselineStartDate):null,l=u.baselineEndDate?new Date(u.baselineEndDate):null,i?(r&&1==s._compareDates(i,r)&&(i=r),o&&c.renderBaseline&&1==s._compareDates(i,o)?i=o:l&&c.renderBaseline&&1==s._compareDates(i,l)&&(i=l)):i=o&&c.renderBaseline&&1==s._compareDates(r,o)?o:l&&c.renderBaseline&&1==s._compareDates(r,l)?l:r,a?(n&&-1==s._compareDates(a,n)&&(a=n),l&&c.renderBaseline&&-1==s._compareDates(a,l)?a=l:o&&c.renderBaseline&&-1==s._compareDates(a,o)&&(a=o)):(l&&c.renderBaseline&&-1==s._compareDates(n,l)&&(a=l),a=o&&c.renderBaseline&&-1==s._compareDates(n,o)?o:n)}),i&&a||(i=s._getDateFromFormat(new Date),(a=s._getDateFromFormat(new Date(i))).setDate(a.getDate()+20)),d=s._updateScheduleDatesByTaskLables(i,a),i=d.minStartDate,a=d.maxEndDate):c.scheduleEndDate&&c.scheduleStartDate||0!==u.length||(i=s._getDateFromFormat(new Date),(a=s._getDateFromFormat(new Date(i))).setDate(a.getDate()+20)),t?(t.minStartDate=i,t.maxEndDate=a):(c.scheduleStartDate=i?s.getFormatedDate(i):c.scheduleStartDate,c.scheduleEndDate=a?s.getFormatedDate(a):c.scheduleEndDate)},_updateScheduleDatesByTaskLables:function(e,i){var a,r,n=this,o=this.model,l=o.scheduleHeaderSettings.scheduleHeaderType,d=t.Gantt.ScheduleHeaderType,s=n._getResourceStringWidth(),c={},u=o.scheduleEndDate&&this._getDateFromFormat(o.scheduleEndDate);return l==d.Week&&(o.scheduleEndDate&&u.getTime()===i.getTime()||(a=s>0?s/n._perDayWidth+7:7,i.setDate(i.getDate()+a))),(l==d.Year||l==d.QuarterYear||l==d.HalfYear)&&(o.scheduleEndDate&&u.getTime()===i.getTime()||(a=s>0?s/n._perMonthWidth+1:1,i.setMonth(i.getMonth()+a))),l==d.Month&&(o.scheduleEndDate&&u.getTime()===i.getTime()||(a=s>0?s/n._perDayWidth+7:7,i.setDate(i.getDate()+a))),l==d.Day&&(o.scheduleEndDate&&u.getTime()===i.getTime()||(a=s>0?s/n._perHourWidth+7:7,i.setHours(i.getHours()+a))),l==d.Hour&&(o.scheduleEndDate&&u.getTime()===i.getTime()||(r=s>0?s/n._perMinuteWidth+5:5,i.setHours(i.getHours()+r),e.setHours(e.getHours()-1))),e=(c=n._updateScheduleDatesByStripLines(e,i)).startDate,i=c.endDate,e=(c=n._updateScheduleDatesByHolidays(e,i)).startDate,i=c.endDate,c.minStartDate=e,c.maxEndDate=i,c},_updateScheduleDatesByHolidays:function(t,i){this.model;var a={};return this._holidaysList.length>0&&e.each(this._holidaysList,function(e,a){a.getTime()>t.getTime()&&a.getTime()<i.getTime()||(a.getTime()<t.getTime()?t=new Date(a):i=new Date(a))}),a.startDate=t,a.endDate=i,a},_updateScheduleDatesByStripLines:function(t,i){var a=this,r=this.model,n={};return r.stripLines.length>0&&e.each(r.stripLines,function(e,r){var n=a._getDateFromFormat(r.day);n.getTime()>t.getTime()&&n.getTime()<i.getTime()||(n.getTime()<=t.getTime()?t=new Date(n):i=new Date(n))}),n.startDate=t,n.endDate=i,n},_getResourceStringWidth:function(){var i,a,r,n=this.model,o=this._resourceCollection,l="";if(o.length>0&&n.showResourceNames){for(a=0;a<o.length;a++)l+=o[a][n.resourceNameMapping]+" ,";return(r=t.buildTag("span","",{"font-family":"Segoe UI","font-size":"12px"},{})).text(l),e(document.body).append(r),i=r.width(),r.remove(),i}return 0},_calculateHeaderDates:function(){var e=this,i=this.model,a=e._getDateFromFormat(i.scheduleStartDate),r=e._getDateFromFormat(i.scheduleEndDate),n=i.scheduleHeaderSettings.scheduleHeaderType,o=t.Gantt.ScheduleHeaderType;n==o.Week&&e._calculateWeekSplit(a,r),(n==o.Year||n==o.QuarterYear||n==o.HalfYear)&&e._calculateYearSplit(a,r),n==o.Month&&e._calculateMonthSplit(a,r),n==o.Day&&e._calculateDaySplit(a,r),n==o.Hour&&e._calculateHourSplit(a,r)},_getFormattedTaskId:function(e){var i="";return"groupTask"==e.eResourceTaskType?i="G_":"resourceTask"==e.eResourceTaskType&&(i="R_"),i+(t.isNullOrUndefined(e.taskId)?e.taskId:e.taskId.toString())},_addNestedGanttRecords:function(e,t){var i,a=this,r=a.model.ids,n=a.model,o=n.flatRecords,l=0,d=e.length,s=[];for(n.viewType,n.enableAltRow;l<d;l++)if(i=e[l],a._storedIndex++,i.isAltRow=a._storedIndex%2!=0,i.index=a._storedIndex,r[a._storedIndex]=this._getFormattedTaskId(i),t||a._updateLastInsertedId(i.taskId,!0),o.push(i),s=i.childRecords)for(var c=0,u=s.length,p=null;c<u;c++)p=s[c],a._storedIndex++,p.isAltRow=a._storedIndex%2!=0,p.index=a._storedIndex,r[a._storedIndex]=this._getFormattedTaskId(p),a._updateLastInsertedId(p.taskId,!0),o.push(p),p.childRecords&&a._addNestedGanttRecords(p.childRecords)},_createGanttRecord:function(e,a,r,n,o){var l,d,s,c=this,u=c.model,p=(c._columns.length,e[u.childMapping]),h=e[u.progressMapping]?isNaN(parseFloat(e[u.progressMapping]))?0:parseFloat(e[u.progressMapping]):0,g=e[u.resourceInfoMapping],m=e[u.predecessorMapping],_=e[u.notesMapping],f=c._getDateFromFormat(e[u.baselineStartDateMapping]),w=c._getDateFromFormat(e[u.baselineEndDateMapping]),C=e.WBS?e.WBS:null,T=u.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Auto||u.taskSchedulingMode!=t.Gantt.TaskSchedulingMode.Manual&&(u.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Custom?1!=e[u.taskSchedulingModeMapping]:u.taskSchedulingMode);return(l=new t.Gantt.GanttRecord).taskId=e[u.taskIdMapping],l.taskName=e[u.taskNameMapping],c._addItemValue(l,e,o),l.isAutoSchedule=T,d=c._isinAddnewRecord?c._newRecordResourceCollection:this._resourceCollection,l.resourceInfo=g&&l._setResourceInfo(e[u.resourceInfoMapping],u.resourceIdMapping,u.resourceNameMapping,u.resourceUnitMapping,d),c._updateResourceName(l),c._calculateScheduledValues(l,e),o||"resourceView"!=u.viewType||0==l.duration&&(l.duration=1,l._calculateEndDate(this)),l.baselineStartDate=this._checkBaseLineStartDate(f),w&&0==w.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,w),l.baselineEndDate=this._checkBaseLineEndDate(w),l.WBS=C,l.notes=_,l.notesText=_?c._getPlainText(_):"",c._updateCustomField(e,l),l.status=h,l.predecessorsName=m,o||(l.predecessor=m&&l._calculatePredecessor(m,this._durationUnitEditText,u.durationUnit,c),c._isValidPredecessorString||(s=c._getPredecessorStringValue(l),l.predecessorsName=s,l.item.predecessor=s,c._isValidPredecessorString=!0),u.enableSerialNumber&&e.serialNumberPredecessor&&(l.serialNumberPredecessor=e.serialNumberPredecessor)),o&&(c._serialCount++,l.serialNumber=c._serialCount),l.parentItem=r,l.level=a,o||(l.width=l._calculateWidth(this),l.left=l._calculateLeft(this),l.progressWidth=l._getProgressWidth(l.width,h),l.baselineStartDate&&l.baselineEndDate&&(l.baselineLeft=l._calculateBaselineLeft(this),l.baselineRight=l._calculateBaselineRight(this),l.baselineWidth=l._calculateBaseLineWidth(this))),c._updateItemValueInRecord(l),l.childRecords=p&&p.length>0&&c._createChildRecords(p,a+1,l),l.hasChildRecords=!!(p&&p.length>0),l.isMilestone=!l.hasChildRecords&&l.isMilestone,c._updateExpandStateMappingValue(e,l),l.expanded=n!==i?n:!!p&&p.length>0,!1===u.enableVirtualization&&(l.isExpanded=!0),l.hasChildRecords&&(l.manualStartDate=l.startDate,l.manualEndDate=l.endDate,l.manualDuration=l.duration),l.taskType=e.taskType?e.taskType:u.taskType,l.effortDriven=e.effortDriven?e.effortDriven:"fixedWork"!=l.taskType?"false":"true",u.workMapping||l._updateWorkWithDuration(c),m&&c._predecessorsCollection.push(l),l},_calculateScheduledValues:function(e,i){var a,r=this,n=r.model,o=t.isNullOrUndefined(i[n.durationMapping])?null:i[n.durationMapping],l=r._getDateFromFormat(i[n.startDateMapping]),d=r._getDateFromFormat(i[n.endDateMapping]),s=t.isNullOrUndefined(i[n.workMapping])?0:i[n.workMapping],c=n.milestoneMapping&&i[n.milestoneMapping];if(e.durationUnit=r._validateDurationUnitMapping(i[n.durationUnitMapping]),d||l||!t.isNullOrUndefined(o))l?(e.startDate=this._checkStartDate(l,e),!d&&t.isNullOrUndefined(o)?n.allowUnscheduledTask?(e.endDate=null,e.duration=null):(e.duration=1,e._calculateEndDate(this)):(t.isNullOrUndefined(o)||d)&&d&&t.isNullOrUndefined(o)?(0==d.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,d),e.endDate=this._checkEndDate(d,e),1==r._compareDatesFromRecord(e)?(e.endDate=new Date(e.startDate),e.isMilestone=!0,e.duration=0):e._calculateDuration(this)):(a=r._getDurationValues(o),e.duration=a.duration,e.durationUnit=t.isNullOrUndefined(a.durationUnit)?e.durationUnit:a.durationUnit,e._calculateEndDate(this))):d?(0==d.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,d),e.endDate=this._checkEndDate(d,e),t.isNullOrUndefined(o)?n.allowUnscheduledTask?(e.startDate=null,e.duration=null):(e.duration=1,e.startDate=r._getStartDate(e.endDate,e.duration,e.durationUnit,e)):t.isNullOrUndefined(o)||(a=r._getDurationValues(o),e.duration=a.duration,e.durationUnit=t.isNullOrUndefined(a.durationUnit)?e.durationUnit:a.durationUnit,e.startDate=this._getStartDate(e.endDate,o,e.durationUnit,e))):t.isNullOrUndefined(o)||(a=r._getDurationValues(o),e.duration=a.duration,e.durationUnit=t.isNullOrUndefined(a.durationUnit)?e.durationUnit:a.durationUnit,n.allowUnscheduledTask?(e.startDate=null,e.endDate=null):t.isNullOrUndefined(n.scheduleStartDate)||(e.startDate=r._getScheduledStartDate(e),e._calculateEndDate(this)));else{if(n.allowUnscheduledTask)return;e.duration=1,t.isNullOrUndefined(n.scheduleStartDate)||(e.startDate=r._getScheduledStartDate(e),e._calculateEndDate(this))}0==e.duration&&(e.isMilestone=!0,e.endDate=r._getDateFromFormat(e.startDate)),!t.isNullOrUndefined(c)&&c?(e.duration=0,e.isMilestone=!0,e.endDate=r._getDateFromFormat(e.startDate)):n.workMapping&&(e.durationUnit=n.durationUnit,isNaN(s)||t.isNullOrUndefined(s)?(e.work=0,e.duration=0,e.isMilestone=!0,e.endDate=r._getDateFromFormat(e.startDate)):(e.work=s,e._updateDurationWithWork(r),0==e.duration?(e.isMilestone=!0,e.endDate=r._getDateFromFormat(e.startDate)):t.isNullOrUndefined(e.startDate)||t.isNullOrUndefined(e.duration)||(e.endDate=this._getEndDate(e.startDate,e.duration,e.durationUnit,e))),t.isNullOrUndefined(i[n.durationMapping])||(i[n.durationMapping]=e.duration),t.isNullOrUndefined(i[n.durationMapping])||(i[n.endDateMapping]=e.endDate))},_getScheduledStartDate:function(e){var i,a,r,n,o,l,d=this,s=d.model;if(t.isNullOrUndefined(s.scheduleStartDate)){if(!d._isLoad)return null;if(t.isNullOrUndefined(d._minStartDate)){for(r=s.flatRecords.length,n=s.flatRecords[0].startDate,o=0;o<r;o++)l=s.flatRecords[o].startDate,t.isNullOrUndefined(l)||-1!=d._compareDates(l,n)||(n=l);d._minStartDate=n,i=d._checkStartDate(d._minStartDate,e)}else i=d._checkStartDate(d._minStartDate,e);s.allowUnscheduledTask||(e.startDate=i,e.item[s.startDateMapping]=e.startDate,e._calculateEndDate(this))}else a=d._getDateFromFormat(s.scheduleStartDate),i=d._checkStartDate(a,e);return new Date(i)},_updateCustomField:function(e,t){var a,r="resourceView"==this.model.viewType&&"groupTask"!=t.eResourceTaskType&&"resourceTask"!=t.eResourceTaskType?this.getResourceViewEditColumns():this.getColumns(),n=r.length;if(n)for(a=0;a<n;a++)t[r[a].field]==i&&(t[r[a].field]=e[r[a].mappingName])},_updateExpandStateMappingValue:function(e,i){var a=this.model;a.expandStateMapping&&i.hasChildRecords&&(t.isNullOrUndefined(e[a.expandStateMapping])?t.isNullOrUndefined(e[a.expandStateMapping])&&!a.enableCollapseAll?i[a.expandStateMapping]=i.item[a.expandStateMapping]=e[a.expandStateMapping]=!0:t.isNullOrUndefined(e[a.expandStateMapping])&&a.enableCollapseAll&&(i[a.expandStateMapping]=i.item[a.expandStateMapping]=e[a.expandStateMapping]=!1):i[a.expandStateMapping]=i.item[a.expandStateMapping]=e[a.expandStateMapping])},_validateDurationUnitMapping:function(e){var i=e;return-1!=this._durationUnitEditText.minute.indexOf(i)?i=t.Gantt.DurationUnit.Minute:-1!=this._durationUnitEditText.hour.indexOf(i)?i=t.Gantt.DurationUnit.Hour:-1!=this._durationUnitEditText.day.indexOf(i)&&(i=t.Gantt.DurationUnit.Day),i==t.Gantt.DurationUnit.Day||i==t.Gantt.DurationUnit.Hour||i==t.Gantt.DurationUnit.Minute?i:this.model.durationUnit},_updateItemValueInRecord:function(e){var t,i=this.model;e.item&&(t=e.item,i.startDateMapping&&(t[i.startDateMapping]=e.startDate),i.endDateMapping&&(t[i.endDateMapping]=e.endDate),i.durationMapping&&(t[i.durationMapping]=e.duration),i.durationUnitMapping&&(t[i.durationUnitMapping]=e.durationUnit),i.workMapping&&(t[i.workMapping]=e.work),i.taskSchedulingModeMapping&&(t[i.taskSchedulingModeMapping]=!e.isAutoSchedule),i.baselineStartDateMapping&&(t[i.baselineStartDateMapping]=e.baselineStartDate),i.baselineEndDateMapping&&(t[i.baselineEndDateMapping]=e.baselineEndDate),t.serialNumber=e.serialNumber)},_addItemValue:function(e,i,a){var r,n,o=this,l=this.model;l.parentTaskIdMapping&&a?(r=i[l.taskIdMapping],n=o._taskIds.indexOf(r),e.item=n>-1?o._retrivedData[n]:[]):this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.json&&this.dataSource().dataSource.offline&&a&&l.parentTaskIdMapping?(r=i[l.taskIdMapping],n=o._taskIds.indexOf(r),e.item=n>-1?o._retrivedData[n]:[]):e.item=i},_getPlainText:function(e){var t=document.createElement("DIV");return t.innerHTML=e,t.textContent||t.innerText||""},_updateResourceName:function(e){var i,a,r,n=e.resourceInfo,o=this.model,l=[];if(n){for(i=n.length,e.item&&(e.item[o.resourceInfoMapping]=[]),a=0;a<i;a++)l.push(n[a][o.resourceNameMapping]),e.item&&(o.resourceUnitMapping&&!t.isNullOrUndefined(n[a][o.resourceUnitMapping])&&100!=n[a][o.resourceUnitMapping]?((r={})[o.resourceIdMapping]=n[a][this.model.resourceIdMapping],r[o.resourceUnitMapping]=n[a][this.model.resourceUnitMapping],e.item[this.model.resourceInfoMapping].push(r)):e.item[this.model.resourceInfoMapping].push(n[a][this.model.resourceIdMapping]));e.resourceNames=l.join(",")}},_updateResourceRelatedFields:function(e){var i=this,a=i.model,r=e.taskType,n=e.isAutoSchedule,o="true"===e.effortDriven;if(!t.isNullOrUndefined(e.resourceInfo))if(e.work>0||"work"==i._updatedColumn)switch(r){case"fixedUnit":n&&e.resourceInfo.length&&("work"==i._updatedColumn||o&&"resourceInfo"==i._updatedColumn)?e._updateDurationWithWork(i):n||"work"!=i._updatedColumn?e._updateWorkWithDuration(i):e._updateUnitWithWork(i);break;case"fixedWork":if(0==e.resourceInfo.length)return;n?"duration"==i._updatedColumn||"endDate"==i._updatedColumn?(e._updateUnitWithWork(i),0==e.duration&&(e.work=0,a.workMapping&&(e.item[a.workMapping]=0))):e._updateDurationWithWork(i):"work"==i._updatedColumn?e._updateUnitWithWork(i):e._updateWorkWithDuration(i);break;case"fixedDuration":e.resourceInfo.length&&("work"==i._updatedColumn||n&&o&&"resourceInfo"==i._updatedColumn)?e._updateUnitWithWork(i):e._updateWorkWithDuration(i)}else e._updateWorkWithDuration(i)},_updateResourceDataSource:function(t){for(var i,a,r,n,o=this,l=[],d=t.resourceInfo?t.resourceInfo.length:0,s=0;s<d;s++)l.push({name:t.resourceInfo[s][o.model.resourceIdMapping],unit:t.resourceInfo[s][o.model.resourceUnitMapping]});for(i="#treegrid"+o._id+"resourceEdit",a=e(i).data("ejTreeGrid").model.dataSource,r=0;r<a.length;r++)(n=l.filter(function(e){return e.name===parseInt(a[r].name)}))&&0==n.length&&l.push(a[r]);e(i).ejTreeGrid("option","dataSource",l)},_getHolidayByDay:function(e){var t,i,a=this._holidaysList,r=!1;if(a)for(t=0;t<a.length;t++)if(i=a[t],this._isInThisDay(e,i)){r=!0;break}return r},_isInThisDay:function(e,t){var i=new Date(t),a=new Date(t);return i.setHours(0,0,0,0),a.setHours(23,59,59,59),e.getTime()>=i.getTime()&&e.getTime()<a.getTime()},_getHoliday:function(){var e;if(null!=this.model.holidays){var t=this.model.holidays,i=[],a=t.length;if(a>0){for(e=0;e<a;e++)i[e]=this._getDateFromFormat(t[e].day);return i}}return!1},_getStringHolidays:function(){var e;if(null!=this._holidaysList&&this._holidaysList.length>0){var i=this._holidaysList,a=[],r=i.length;if(r>0){for(e=0;e<r;e++)a[e]=t.format(i[e],this.model.dateFormat,this.model.locale);return a}}return[]},_createChildRecords:function(e,t,a){var r,n,o=[],l=this.model,d=0,s=e.length;for(d=0;d<s;d++)l.enableWBS&&(r=a.WBS,e[d].WBS=r+"."+(d+1)),e[d]&&(n=this._createGanttRecord(e[d],t,a,i,"Load"),o.push(n));return o},_createResourceInfoCollection:function(e){for(var t=0,i=e.length;t<i;t++)this._resourceInfoCollection.push(this._createResourceInfo(e[t]))},_createResourceInfo:function(e){var t=this.model,i={};return i.resourceId=e[t.resourceIdMapping],i.resourceName=e[t.resourceNameMapping],i},_calculateWeekSplit:function(e,t){var i,a,r=this,n=r.model,o=n.scheduleHeaderSettings.weekStartDay;e="month"==n.scheduleHeaderSettings.timescaleStartDateMode?new Date(e.getFullYear(),e.getMonth(),1):"year"==n.scheduleHeaderSettings.timescaleStartDateMode?new Date(e.getFullYear(),0,1):e,i=o>=0&&o<7?o:0,a=e.getDay()<=i?e.getDate()-(7-i+e.getDay()):e.getDate()-e.getDay()+i,e.setDate(a),e.setHours(0,0,0,0);do{r._scheduleWeeks.push(new Date(e)),e.setDate(e.getDate()+7)}while(!(e>t));r._projectStartDate=new Date(r._scheduleWeeks[0]),r._projectEndDate=new Date(r._scheduleWeeks[r._scheduleWeeks.length-1])},_calculateYearSplit:function(e,t){var i,a=this,r=a.model;if("month"==r.scheduleHeaderSettings.timescaleStartDateMode){e=new Date(e.getFullYear(),e.getMonth(),1);do{a._scheduleYears.push(new Date(e)),e=new Date(e.getFullYear()+1,0,1)}while(!(e>=t));a._projectStartDate=new Date(a._scheduleYears[0].getFullYear(),a._scheduleYears[0].getMonth(),1),a._projectEndDate=new Date(a._scheduleYears[a._scheduleYears.length-1].getFullYear(),11,31)}else if("week"==r.scheduleHeaderSettings.timescaleStartDateMode){i=0==e.getDay()?e.getDate()-7:e.getDate()-e.getDay(),e.setDate(i);do{a._scheduleYears.push(new Date(e)),e=new Date(e.getFullYear()+1,0,1)}while(!(e>=t));a._projectStartDate=new Date(a._scheduleYears[0]),a._projectEndDate=new Date(a._scheduleYears[a._scheduleYears.length-1].getFullYear(),11,31)}else{e.setMonth(0),e.setDate(1),e.setHours(0,0,0,0);do{a._scheduleYears.push(new Date(e)),e.setMonth(e.getMonth()+12)}while(!(e>=t));a._projectStartDate=new Date(a._scheduleYears[0].getFullYear(),a._scheduleYears[0].getMonth(),1),a._projectEndDate=new Date(a._scheduleYears[a._scheduleYears.length-1].getFullYear(),11,31)}},_calculateDaySplit:function(e,t){var i,a=this,r=a.model;"week"==r.scheduleHeaderSettings.timescaleStartDateMode?(i=0==e.getDay()?e.getDate()-7:e.getDate()-e.getDay(),e.setDate(i)):"month"==r.scheduleHeaderSettings.timescaleStartDateMode?e=new Date(e.getFullYear(),e.getMonth(),1):"year"==r.scheduleHeaderSettings.timescaleStartDateMode?e=new Date(e.getFullYear(),0,1):e.setHours(0,0,0,0);do{a._scheduleDays.push(new Date(e)),e.setDate(e.getDate()+1),e.setHours(0,0,0,0)}while(e<=t);a._projectStartDate=new Date(a._scheduleDays[0]),a._projectEndDate=new Date(a._scheduleDays[a._scheduleDays.length-1])},_calculateHourSplit:function(e,t){var i,a=this,r=a.model;"week"==r.scheduleHeaderSettings.timescaleStartDateMode?(i=0==e.getDay()?e.getDate()-7:e.getDate()-e.getDay(),e.setDate(i)):"month"==r.scheduleHeaderSettings.timescaleStartDateMode?e=new Date(e.getFullYear(),e.getMonth(),1):"year"==r.scheduleHeaderSettings.timescaleStartDateMode?e=new Date(e.getFullYear(),0,1):e.setMinutes(0);do{a._scheduleHours.push(new Date(e)),e.setTime(e.getTime()+36e5)}while(e<=t);a._projectStartDate=new Date(a._scheduleHours[0]),a._projectEndDate=new Date(a._scheduleHours[a._scheduleHours.length-1])},_calculateMonthSplit:function(e,t){var i,a,r,n,o=this,l=o.model,d=l.scheduleHeaderSettings.weekStartDay,s=d>=0&&d<7?d:0;if("week"==l.scheduleHeaderSettings.timescaleStartDateMode){i=e.getDay()<=s?e.getDate()-(7-s+e.getDay()):e.getDate()-e.getDay()+s,e.setDate(i),e.setHours(0,0,0,0);do{o._scheduleMonths.push(new Date(e)),e=29==e.getDate()&&0==e.getMonth()&&e.getFullYear()%4!=0?new Date(e.getFullYear(),e.getMonth()+1,e.getDate()-1):new Date(e.getFullYear(),e.getMonth()+1,e.getDate())}while(!(e>=t))}else if("year"==l.scheduleHeaderSettings.timescaleStartDateMode){e=new Date(e.getFullYear(),0,1),this._enableMonthStart||(i=e.getDay()<=s?e.getDate()-(7-s+e.getDay()):e.getDate()-e.getDay()+s,e.setDate(i),e.setHours(0,0,0,0));do{o._scheduleMonths.push(new Date(e)),0==e.getMonth()||2==e.getMonth()||4==e.getMonth()||6==e.getMonth()||7==e.getMonth()||9==e.getMonth()||11==e.getMonth()?1==e.getDate()?e.setDate(e.getDate()+31):(a=32-e.getDate(),e.setDate(e.getDate()+a)):3==e.getMonth()||5==e.getMonth()||8==e.getMonth()||10==e.getMonth()?e.setDate(e.getDate()+30):1==e.getMonth()&&(e.getFullYear()%4==0?e.setDate(e.getDate()+29):e.setDate(e.getDate()+28))}while(!(e>=t))}else{e=new Date(e.getFullYear(),e.getMonth(),1),this._enableMonthStart||(i=e.getDay()<=s?e.getDate()-(7-s+e.getDay()):e.getDate()-e.getDay()+s,e.setDate(i),e.setHours(0,0,0,0));do{o._scheduleMonths.push(new Date(e)),0==e.getMonth()||2==e.getMonth()||4==e.getMonth()||6==e.getMonth()||7==e.getMonth()||9==e.getMonth()||11==e.getMonth()?1==e.getDate()?e.setDate(e.getDate()+31):(a=32-e.getDate(),e.setDate(e.getDate()+a)):3==e.getMonth()||5==e.getMonth()||8==e.getMonth()||10==e.getMonth()?1==e.getDate()?e.setDate(e.getDate()+30):(a=31-e.getDate(),e.setDate(e.getDate()+a)):1==e.getMonth()&&(e.getFullYear()%4==0?1==e.getDate()?e.setDate(e.getDate()+29):(a=30-e.getDate(),e.setDate(e.getDate()+a)):1==e.getDate()?e.setDate(e.getDate()+28):(a=29-e.getDate(),e.setDate(e.getDate()+a)))}while(!(e>=t))}r=new Date(o._scheduleMonths[0]),n=new Date(o._scheduleMonths[o._scheduleMonths.length-1]),n=new Date(n.getFullYear(),n.getMonth()+1,0),o._projectStartDate=r,o._projectEndDate=n},getDateType:function(e){if(null!=e){if("object"==typeof e)return e;var t=new RegExp("\\-","g"),i=new RegExp("\\.","g");return e=(e=e.replace(t,"/")).replace(i,"/"),new Date(e)}return null},getFormatedDate:function(e){return t.format(e,this.model.dateFormat,this.model.locale)},_getProgressWidth:function(e,t){return e*t/100},_wireEvents:function(){var t=this,i=t.model,a=e("#ejTreeGrid"+t._id),r=e("#ejGanttChart"+t._id),n=t._$ejGantt;t._on(t.element,"click",t.clickHandler),t._on(t.element,"touchstart",".e-gridcontent,.e-ganttviewerbodyContianerparent",t._updateTouchCtrlFlag),t._on(t.element,"click",".e-ejinputtext",t._searchTextFocusIn),t._on(t.element,"focusout",".e-ejinputtext",t._searchTextFocusOut),i.enableContextMenu&&(t._on(t.element,"contextmenu taphold",t._contextMenuEventBinding),t._on(t.element,"touchend",t._mouseupHandler),t._on(t.element,"keyup",this._preventContextMenu)),i.enableResize&&i.isResponsive&&t._on(e(window),"resize",t.windowResize),a.ejTreeGrid({rowSelecting:e.proxy(t.rowSelecting,t)}),a.ejTreeGrid({rowSelected:e.proxy(t.rowSelected,t)}),a.ejTreeGrid({cellSelecting:e.proxy(t.cellSelecting,t)}),a.ejTreeGrid({cellSelected:e.proxy(t.cellSelected,t)}),a.ejTreeGrid({rowDrag:e.proxy(t.rowDrag,t)}),a.ejTreeGrid({rowDragStart:e.proxy(t.rowDragStart,t)}),a.ejTreeGrid({rowDragStop:e.proxy(t.rowDragStop,t)}),a.ejTreeGrid({actionBegin:e.proxy(t.actionBegin,t)}),a.ejTreeGrid({actionComplete:e.proxy(t.actionComplete,t)}),a.ejTreeGrid({expandAllCollapseAllRequest:e.proxy(t.expandAllCollapseAllRequest,t)}),a.ejTreeGrid({contextMenuAction:e.proxy(t.contextMenuAction,t)}),a.ejTreeGrid({subContextMenuAction:e.proxy(t.subContextMenuAction,t)}),a.ejTreeGrid({setInitialData:e.proxy(t.setInitialData,t)}),a.ejTreeGrid({refreshScrollCss:e.proxy(t._updateScrollerBorder,t)}),a.ejTreeGrid({getCtrlRequestValue:e.proxy(t._getCtrlRequestValue,t)}),i.queryCellInfo&&a.ejTreeGrid({queryCellInfo:e.proxy(t._queryCellInfo,t)}),i.rowDataBound&&a.ejTreeGrid({rowDataBound:e.proxy(t._rowDataBound,t)}),a.ejTreeGrid({beginEdit:e.proxy(t._beginEdit,t)}),a.ejTreeGrid({endEdit:e.proxy(t._endEdit,t)}),a.ejTreeGrid({expanding:e.proxy(t.expanding,t)}),a.ejTreeGrid({collapsing:e.proxy(t.collapsing,t)}),a.ejTreeGrid({expanded:e.proxy(t.expanded,t)}),a.ejTreeGrid({collapsed:e.proxy(t.collapsed,t)}),a.ejTreeGrid({refreshRow:e.proxy(t.refreshRow,t)}),a.ejTreeGrid({cancelEditCell:e.proxy(t.cancelEditCell,t)}),"resourceView"==i.viewType&&a.ejTreeGrid({updateResource:e.proxy(t._removeResources,t)}),r.ejGanttChart({rowSelecting:e.proxy(t.rowSelecting,t)}),r.ejGanttChart({rowSelected:e.proxy(t.rowSelected,t)}),r.ejGanttChart({rowHover:e.proxy(t._ganttChartRowHover,t)}),r.ejGanttChart({actionBegin:e.proxy(t.actionBegin,t)}),r.ejGanttChart({actionComplete:e.proxy(t.chartactionComplete,t)}),r.ejGanttChart({refreshRow:e.proxy(t.refreshRowData,t)}),r.ejGanttChart({zooming:e.proxy(t.zoomingChart,t)}),r.ejGanttChart({queryTaskbarInfo:e.proxy(t.queryTaskbarInfo,t)}),r.ejGanttChart({expanding:e.proxy(t.expanding,t)}),r.ejGanttChart({collapsing:e.proxy(t.collapsing,t)}),r.ejGanttChart({expanded:e.proxy(t.expanded,t)}),r.ejGanttChart({collapsed:e.proxy(t.collapsed,t)}),r.ejGanttChart({expandAllCollapseAllRequest:e.proxy(t.expandAllCollapseAllRequest,t)}),r.ejGanttChart({taskbarEditing:e.proxy(t.taskbarEditing,t)}),r.ejGanttChart({taskbarEdited:e.proxy(t.taskbarEdited,t)}),r.ejGanttChart({calculateEndDate:e.proxy(t.calculateEndDate,t)}),r.ejGanttChart({calculateDuration:e.proxy(t.calculateDuration,t)}),r.ejGanttChart({clearColumnMenu:e.proxy(t.clearColumnMenu,t)}),r.ejGanttChart({deleteRow:e.proxy(t.deleteRow,t)}),r.ejGanttChart({cancelEditCell:e.proxy(t.cancelEditCell,t)}),r.ejGanttChart({getCtrlRequestValue:e.proxy(t._getCtrlRequestValue,t)}),r.ejGanttChart({taskbarEditedCancel:e.proxy(t._taskbarEditedCancel,t)}),n.ejSplitter({allowResizing:e.proxy(t._onResize,t)}),t._on(t.element,"mousedown",t._mousedownhandler),t._enableEditingEvents()},_preventContextMenu:function(e){if(93==e.keyCode)return e.preventDefault(),e.stopPropagation(),!1},_onResize:function(i){var a,r=this,n=r.splitterPosition();r._splitterOnResize=!0,r._isinBeginEdit&&e("#ejTreeGrid"+r._id+"EditForm").length>0&&(r._$treegridHelper.ejTreeGrid("cancelEditCell"),r._isinBeginEdit=!1),-1!=n.indexOf("%")?r.splitterPosition(Math.round(i.prevPane.size/r._ganttWidth*100)+"%"):r.splitterPosition(Math.round(i.prevPane.size).toString()),r._splitterPosition(r.splitterPosition()),r._$treegridHelper.ejTreeGrid("refreshScroller",i.prevPane.size),r._$ganttchartHelper.ejGanttChart("refreshScroller",i.nextPane.size-1),r._updateScrollerBorder(),a={prevSplitterPosition:n,customSplitterPosition:null,isSplitterIndex:!1,isOnResize:!0,currentSplitterPosition:r.splitterPosition()},r._trigger("splitterResized",a)?r.setSplitterPosition(a.prevSplitterPosition):t.isNullOrUndefined(a.customSplitterPosition)||(a.isSplitterIndex?r.setSplitterIndex(a.customSplitterPosition):r.setSplitterPosition(a.customSplitterPosition)),r._splitterOnResize=!1},_searchTextFocusOut:function(t){var i=this._toolboxTooltipTexts.searchTool,a=e(t.target);e(a).closest("li")&&e(a).closest("li").attr("id")==this._id+"_search"&&e(a).attr("placeholder",i)},_searchTextFocusIn:function(t){var i=e(t.target),a=e(i).attr("placeholder");i.hasClass("e-ejinputtext")&&a&&i.removeAttr("placeholder")},clickHandler:function(t){var i,a=this,r=a.model,n=e(t.target);r.allowSelection&&"multiple"==r.selectionType&&"row"==r.selectionMode&&(n.hasClass("e-rowselect")?n.hasClass("e-spanclicked")?a._clearMultiSelectPopup():n.addClass("e-spanclicked"):e("#"+a._id+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")||this._multiSelectPopup.hide(),(n.hasClass("e-rowcell")||n.parent().hasClass("e-rowcell")||n.closest("td").hasClass("e-rowcell")||n.closest("td").hasClass("e-rowcell")&&n.hasClass("e-cell")||n.hasClass("e-rowcell")||n.parent().hasClass("e-chartcell")||n.closest("td").hasClass("e-chartcell")||n.closest("td").hasClass("e-chartcell"))&&(1!=a._ganttTouchTrigger||null==this._multiSelectPopup||this._multiSelectPopup.find(".e-rowselect").hasClass("e-spanclicked")||(this._multiSelectPopup.removeAttr("style"),0!=n.closest(".e-rowcell").length?(i=n.closest(".e-rowcell").offset(),this._multiSelectPopup.offset({top:0,left:0}).offset({left:i.left+(n.closest(".e-rowcell").outerWidth()/2-this._multiSelectPopup.width()/2),top:i.top-this._multiSelectPopup.outerHeight()-10}).show()):(i=n.closest(".e-chartcell").offset(),this._multiSelectPopup.offset({top:0,left:0}).offset({left:t.pageX+this._multiSelectPopup.width()/2,top:i.top-this._multiSelectPopup.outerHeight()-10}).show())),a._ganttTouchTrigger=!1)),a._clearContextMenu(),n.hasClass("e-vhandle")||n.hasClass("e-vscrollbar")||n.hasClass("e-vup")||n.hasClass("e-vhandlespace")||n.hasClass("e-vdown")||n.hasClass("e-hhandle")||n.hasClass("e-hscrollbar")||n.hasClass("e-hup")||n.hasClass("e-hdown")||n.hasClass("e-hhandlespace")||(a._isinBeginEdit&&document.getElementById(a._id).contains(n[0])&&(n.closest("td").hasClass("e-editedcell")||n.hasClass("e-date")||n.hasClass("e-arrow")||n.hasClass("e-down-arrow")||0!=n.closest("form#ejTreeGrid"+a._id+"EditForm").length||!(e("#ejTreeGrid"+a._id+"EditForm").length>0)||(a._$treegridHelper.ejTreeGrid("saveCell"),a._isinBeginEdit=!1)),a.clearColumnMenu())},windowResize:function(){var i,a,r,n,o,l,d,s,c,u,p;if(this.element.is(":visible")){var h,g,m,_=this,f="#e-ejSpliter"+this._id,w="#"+this._id+"_toolbarItems",C="#ejGanttChart"+this._id,T="#ejTreeGrid"+this._id,x=e("#"+this._id).find(".e-ganttviewerbodyContianer"),v=e("#"+this._id).find(".e-ganttviewerheaderContainer"),b="#ejTreeGrid"+this._id,S="#ejTreeGrid"+this._id+"e-gridcontent",D=_.model.sizeSettings.width,R=_.model.sizeSettings.height,y=_.element[0].style.height,I=_.element[0].style.width;D&&"number"!=typeof D&&-1!=D.indexOf("%")||-1!=I.indexOf("%")?(n=D||I,h=(e(_.element).parent().width()?e(_.element).parent().width():e(_.element).width())/100*parseInt(n)):h=e(_.element).width(),-1==_.splitterPosition().indexOf("%")?(i=parseInt(_.splitterPosition())+7+2,_._ganttWidth=h=Math.max(h,i)):_._ganttWidth=h,R&&"number"!=typeof D&&-1!=R.indexOf("%")||-1!=y.indexOf("%")?(a=R||y,r=e(_.element).parent().height()?e(_.element).parent().height():e(_.element).height(),g=e(_.element).parent().height()?r/100*parseInt(a):e(_.element).height()):g=e(_.element).height(),g-=_._totalBorderHeight,h=Math.round(h),s=e(w).length?e(w).height():0,e(f).css("width",h),e(f).css("height",g-s),e(f).ejSplitter("refresh"),e(w).length&&e(w).css("width",h),n=e(C).width(),o=e(T).width(),e(C).height(g-s),l=x.ejScroller("option","scrollTop"),d=x.ejScroller("option","scrollLeft"),x.ejScroller({width:n,height:g-s-v.height()-parseInt(v.css("border-bottom-width"))}),x.ejScroller("refresh"),d>(m=_._$ganttchartHelper.ejGanttChart("getMaxScrollWidth"))&&(d=m>0?m:0),x.ejScroller("option","scrollTop",l),x.ejScroller("option","scrollLeft",d),e(b).height(g-s),e(S).height(g-s-v.height()-_._totalBorderHeight),d=e(S).ejScroller("option","scrollLeft"),e(S).width(o),e(S).ejScroller("refresh"),d>(m=_._$treegridHelper.ejTreeGrid("getMaxScrollWidth"))&&(d=m>0?m:0),e(S).ejScroller("option","scrollLeft",d),_._$treegridHelper.ejTreeGrid("updateViewPortHeight"),_._$ganttchartHelper.ejGanttChart("updateViewPortHeight"),_.model.enableVirtualization&&(_._$treegridHelper.ejTreeGrid("instance")._searchString.length>0&&"multiple"==_.model.selectionType&&"row"==_.model.selectionMode&&(c=[],_.model.selectedItems.filter(function(e){c.push(_.model.updatedRecords.indexOf(e))})),_._$treegridHelper.ejTreeGrid("cancelRowEditCell"),(u={}).requestType=t.TreeGrid.Actions.Refresh,_._$treegridHelper.ejTreeGrid("processBindings",u),_._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",u),_._$ganttchartHelper.ejGanttChart("refreshHelper",_.model.currentViewData,_.model.updatedRecords),_._$ganttchartHelper.ejGanttChart("onScrollHelper",l),"row"==_.model.selectionMode?"multiple"==_.model.selectionType?_.selectMultipleRows(c):_.selectRows(this.selectedRowIndex()):(p="multiple"==_.model.selectionType,_.selectCells(_.model.selectedCellIndexes,p))),"resourceView"!=_.model.viewType&&(_._$ganttchartHelper.ejGanttChart("clearConnectorLines"),_._updateRowHeightInConnectorLine(_._connectorLinesCollection),_._$ganttchartHelper.ejGanttChart("renderConnectorLines",_._connectorLinesCollection)),_.setSplitterPosition(_.splitterPosition()),_.model.allowSelection&&"multiple"==_.model.selectionType&&_._multiSelectPopup&&_._multiSelectPopup.is(":visible")&&_._alignMultiSelectPopup(),1==_.isCriticalPathEnable&&_.model.predecessorMapping&&_._$ganttchartHelper.ejGanttChart("criticalConnectorLine",_.criticalPathCollection,_.detailPredecessorCollection,!0,_.collectionTaskId)}},_updateRowHeightInConnectorLine:function(t){var i,a,r;if(t&&t.length&&(i=e("#ejGanttChart"+this._id).ejGanttChart("instance"),(a=e("#"+i._$ganttViewTablebody[0].id).find("tr:first")[0].getBoundingClientRect().height)&&!isNaN(a)))for(r=0;r<t.length;r++)t[r].RowHeight=a},setScrollTop:function(e){var t=this,i=t._$treegridHelper.ejTreeGrid("getMaxScrollHeight");t._isinBeginEdit&&t._$treegridHelper.ejTreeGrid("saveCell"),("number"==typeof e||"number"==typeof parseInt(e))&&((e=parseInt(e))>=0&&(i>=e?t._$ganttchartHelper.ejGanttChart("onScrollHelper",e):t._$ganttchartHelper.ejGanttChart("onScrollHelper",i)))},_getCoordinate:function(e){var i=e;return t.isNullOrUndefined(e.originalEvent.changedTouches)||"touchmove"!=e.type&&"touchstart"!=e.type&&"touchend"!=e.type&&"taphold"!=e.type&&"tap"!=e.type||(i=e.originalEvent.changedTouches[0]),i},_mouseupHandler:function(e){var t,i,a=this,r=a.model,n=a._getCoordinate(e);r.enableContextMenu&&a._contextMenuHandler&&(t=Math.abs(a._posX1-n.pageX),i=Math.abs(a._posY1-n.pageY),(t<=10||i<=10)&&a._rightClick(e)),a._contextMenuHandler=!1,a._ganttTouchEvent=!1},_contextMenuEventBinding:function(e){var t=this,i=t._getCoordinate(e);if(t._posX1=i.pageX,t._posY1=i.pageY,3!=e.which||t._ganttTouchEvent){if(t._ganttTouchEvent)return t._contextMenuHandler=!0,!0}else t._rightClick(e)},_rightClick:function(i){var a;i.preventDefault();var r,n,o,l,d,s,c=this,u=c.model,p=e(i.target),h=p.closest("tr"),g={};c._$treegridHelper.ejTreeGrid("disableTooltip"),c.clearColumnMenu(),e(h).hasClass("e-chartcell")||e(h).hasClass("e-ganttrowcell")?(r=c._$ganttchartHelper.ejGanttChart("getGanttChartRows"),s="resourceView"==u.viewType?c._$ganttchartHelper.ejGanttChart("getRecordByTarget",i):null,g.target="ejTreeGrid"):(r=e(c._$treegridHelper.ejTreeGrid("getRows")),g.target="ejGanttChart"),n=p.closest("tr"),o=r.index(n),c.model.currentViewData=c.getCurrentViewData(),l=c.model.currentViewData[o],o=c.model.updatedRecords.indexOf(l),g.data=s||l,g.recordIndex=o,g.data&&c.model.enableContextMenu?(c._contextMenuItems=[],c._contextMenuItems=c._getContextMenuItems(),c._updateIndentOutdentContextmenuOption(g.data),c._clearContextMenu(),"cell"==u.selectionMode&&(c._rowIndexOfLastSelectedCell=o,d=c._$treegridHelper.ejTreeGrid("getCellIndex",i),e(p.closest("td")).hasClass("e-chartcell")||c.selectCells([{rowIndex:o,cellIndex:d}],null,!1)),c._contextMenuItems.length>0&&(1!=c.model.readOnly&&c.model.editSettings.allowAdding||(c._removeContextMenuItem("Below"),c._removeContextMenuItem("Above")),c._renderContextMenu(i,o,g.data)),"resourceView"==u.viewType&&("resourceChildTask"==g.data.eResourceTaskType||"unassignedTask"==g.data.eResourceTaskType)&&c._$ganttchartHelper.ejGanttChart("selectTaskbar",g.data),"row"==u.selectionMode&&(o!=c.model.selectedRowIndex&&c.rowSelected(g),u.selectionType==t.Gantt.SelectionType.Multiple&&(c._$treegridHelper.ejTreeGrid("instance")._multiSelectCtrlRequest=c._$ganttchartHelper.ejGanttChart("instance")._multiSelectCtrlRequest=!1,c._clearMultiSelectPopup()),c._$treegridHelper.ejTreeGrid("selectRows",o),c._$ganttchartHelper.ejGanttChart("selectRows",o),a=c._$treegridHelper.ejTreeGrid("instance"),u.selectedItems=a.model.selectedItems,u.selectedItem=a.model.selectedItem,c.selectedRowIndex(u.updatedRecords.indexOf(u.selectedItem)),c.updateIndentOutdentOption(u.selectedItem)),"click"==u.editSettings.beginEditAction&&e("#ejTreeGrid"+c._id+"EditForm").length>0&&(c._$treegridHelper.ejTreeGrid("saveCell"),c._isinBeginEdit=!1)):0===c.model.flatRecords.length&&c.model.enableContextMenu&&(c._contextMenuItems=[],c._contextMenuItems=c._getContextMenuItems(),c._contextMenuItems.splice(5,2),c._updateIndentOutdentContextmenuOption(g.data),c._clearContextMenu(),c._contextMenuItems.length>0&&c._renderContextMenu(i,o,g.data))},_mousedownhandler:function(t){var i=e(t.target),a=this;a._clearContextMenu(),a.model.predecessorMapping&&a._$ganttchartHelper.ejGanttChart("closePredecessorDialog"),(i.hasClass("e-vhandle")||i.hasClass("e-vscrollbar")||i.hasClass("e-vup")||i.hasClass("e-vdown")||i.hasClass("e-vhandlespace")||i.hasClass("e-hhandle")||i.hasClass("e-hscrollbar")||i.hasClass("e-hdown")||i.hasClass("e-hhandlespace")||i.hasClass("e-splitbar"))&&(a._clearMultiSelectPopup(),a.clearColumnMenu())},_removeContextMenuItem:function(e){var t,i,a=this._contextMenuItems;(i=a.filter(function(t){if(t.menuId===e)return!0})).length>0&&(t=a.indexOf(i[0]),a.splice(t,1))},_updateIndentOutdentContextmenuOption:function(e){var t,i=this,a=i.model,r=this.model.flatRecords,n=r.indexOf(e);1==i.model.readOnly?(i._removeContextMenuItem("Add"),i._removeContextMenuItem("Task"),i._removeContextMenuItem("Delete"),i._removeContextMenuItem("Indent"),i._removeContextMenuItem("Outdent")):(0===n?(i._removeContextMenuItem("Indent"),i._removeContextMenuItem("Outdent")):n>0?0===e.level?i._removeContextMenuItem("Outdent"):(t=r[n-1],e.level-t.level==1&&i._removeContextMenuItem("Indent")):n<0&&!e&&(i._removeContextMenuItem("Task"),i._removeContextMenuItem("Delete"),i._removeContextMenuItem("Indent"),i._removeContextMenuItem("Outdent")),a.editSettings.allowAdding||i._removeContextMenuItem("Add"),a.editSettings.allowDeleting||i._removeContextMenuItem("Delete"),a.editSettings.allowEditing||i._removeContextMenuItem("Task"),a.editSettings.allowIndent||(i._removeContextMenuItem("Indent"),i._removeContextMenuItem("Outdent")),"resourceView"==a.viewType&&(i._removeContextMenuItem("Indent"),i._removeContextMenuItem("Outdent"),i._removeContextMenuItem("Above"),i._removeContextMenuItem("Below"),e&&("groupTask"==e.eResourceTaskType||"resourceTask"==e.eResourceTaskType)&&i._removeContextMenuItem("Task")))},queryTaskbarInfo:function(e){this._trigger("queryTaskbarInfo",e)},zoomingChart:function(e){this.reRenderChart(e.delta)},refreshRowData:function(e){var i=this._$treegridHelper.ejTreeGrid("instance");t.TreeGrid.refreshRow(i,e.index)},expanding:function(e){var i=this;if(!i._trigger("expanding",e)){if(i._expandCollapseSettings.state="",i.model.enableVirtualization)t.TreeGrid.sendExpandCollapseRequest(i,e);else{if(i._isInExpandCollapse=!0,i._isRefreshAddedRecord)return e.data.expanded=!0,i._$treegridHelper.ejTreeGrid("updateExpandStatus",e.data,!0),i._refreshChartAndGridRows(),void(i._isRefreshAddedRecord=!1);t.TreeGrid.sendExpandCollapseRequest(i,e),i._isInExpandCollapse=!1}i.updateSelectedItemIndex()}},collapsing:function(i){var a,r=this,n=this.model,o=e("#"+r._id+"_toolbarItems");if(!r._trigger("collapsing",i)){if(r._expandCollapseSettings.state="",r.model.enableVirtualization)t.TreeGrid.sendExpandCollapseRequest(r,i);else{if(r._isInExpandCollapse=!0,r._isRefreshAddedRecord)return i.data.expanded=!1,r._$treegridHelper.ejTreeGrid("updateExpandStatus",i.data,!1),r._refreshChartAndGridRows(),void(r._isRefreshAddedRecord=!1);r._gridRows=r.getRows(),t.TreeGrid.sendExpandCollapseRequest(r,i),r._isInExpandCollapse=!1}(a=r.selectedItem())&&(r.getExpandStatus(a)||i.expanded||1!=i.model.selectedItems.length?r.updateSelectedItemIndex():(r._deSelectRowItem(),n.toolbarSettings.showToolbar&&-1!==r.model.toolbarSettings.toolbarItems.indexOf("delete")&&(e(o).ejToolbar("disableItem",e(o).find(".e-deleteitem").parent()[0]),-1!==r.model.toolbarSettings.toolbarItems.indexOf("indent")&&e(o).ejToolbar("disableItem",e(o).find(".e-indent").parent()[0]),-1!==r.model.toolbarSettings.toolbarItems.indexOf("outdent")&&e(o).ejToolbar("disableItem",e(o).find(".e-outdent").parent()[0]),-1!==r.model.toolbarSettings.toolbarItems.indexOf("edit")&&e(o).ejToolbar("disableItem",e(o).find(".e-edititem").parent()[0]))))}},refreshRow:function(e){this._$ganttchartHelper.ejGanttChart("refreshRow",e.recordIndex)},_enableEditingEvents:function(){var t=this,i=t.model;t._off(e("#"+t._id+"_dialogEdit"),"click keypress","#EditDialog_"+t._id+"_Save ,#EditDialog_"+t._id+"_Cancel,#EditDialog_"+t._id+"_Delete",t._buttonClick),t._off(e("#"+t._id+"_dialogAdd"),"click keypress","#AddDialog_"+t._id+"_Save ,#AddDialog_"+t._id+"_Cancel",t._buttonClick),(i.editSettings.allowEditing||"dialogTemplate"==i.editSettings.editMode||i.toolbarSettings.showToolbar&&(i.editSettings.allowAdding&&-1!==i.toolbarSettings.toolbarItems.indexOf("add")||i.editSettings.allowEditing&&-1!==i.toolbarSettings.toolbarItems.indexOf("index")))&&(t._on(e("#"+t._id+"_dialogEdit"),"click keypress","#EditDialog_"+t._id+"_Save ,#EditDialog_"+t._id+"_Cancel,#EditDialog_"+t._id+"_Delete",t._buttonClick),t._on(e("#"+t._id+"_dialogAdd"),"click keypress","#AddDialog_"+t._id+"_Save ,#AddDialog_"+t._id+"_Cancel",t._buttonClick))},cancelEditCell:function(){e("#ejTreeGrid"+this._id+"EditForm").length>0&&this._$treegridHelper.ejTreeGrid("cancelEditCell")},_taskbarEditedCancel:function(e){this._updateOverlappingValues(e.parentItem),this._updateResourceParentItem(e),this.refreshGanttRecord(e.parentItem),this._updateSharedResourceTask(e),(!e.predecessor||e.predecessor&&0==e.predecessor.length)&&this._refreshGanttHeightWithRecords()},_keyPressed:function(){},_buttonClick:function(a){var r,n,o,l=this,d=l.model;return"click"!=a.type&&a.keyCode!==i&&13!=a.keyCode||(e(a.target).css("pointer-events","none"),d.editSettings.allowEditing||"dialogTemplate"==d.editSettings.editMode||d.toolbarSettings.showToolbar&&(d.editSettings.allowAdding&&-1!==d.toolbarSettings.toolbarItems.indexOf("add")||d.editSettings.allowEditing&&-1!==d.toolbarSettings.toolbarItems.indexOf("edit"))?a.target.id=="EditDialog_"+l._id+"_Save"?l.model.predecessorMapping?(n={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},(r={}).editMode="dialogEdit",r.data=this._editedDialogRecord,r.requestType="validateLinkedTask",r.validateMode=n,l._trigger("actionBegin",r)||(l._datePickerChangeEvent&&(this._editedDialogRecord.isAutoSchedule||d.validateManualTasksOnLinking)?(l._datePickerChangeEvent=!1,!d.enablePredecessorValidation||d.enablePredecessorValidation&&l._validateTypes(r)?l._sendSaveRequest("Edit")?e(a.target).css("pointer-events","auto"):(l._isAddEditDialogSave=!0,e("#"+l._id+"_dialogEdit").ejDialog("close")):e("#"+l._id+"_dialogEdit").ejDialog("close")):l._sendSaveRequest("Edit")?e(a.target).css("pointer-events","auto"):(l._isAddEditDialogSave=!0,e("#"+l._id+"_dialogEdit").ejDialog("close")))):l._sendSaveRequest("Edit")?e(a.target).css("pointer-events","auto"):(l._isAddEditDialogSave=!0,e("#"+l._id+"_dialogEdit").ejDialog("close")):a.target.id=="EditDialog_"+l._id+"_Cancel"?e("#"+l._id+"_dialogEdit").ejDialog("close"):a.target.id=="EditDialog_"+l._id+"_Delete"?("resourceView"==this.model.viewType&&l._resourceEditedRecord&&"resourceChildTask"==l._resourceEditedRecord.eResourceTaskType?(o=this.deleteResourceChildTask(l._resourceEditedRecord),l._resourceEditedRecord=null):o=0!=d.allowSelection||t.isNullOrUndefined(l._contextMenuSelectedIndex)?l._$treegridHelper.ejTreeGrid("deleteRow"):l._$treegridHelper.ejTreeGrid("deleteRow",null,!0,l._contextMenuSelectedIndex),1==o?e(a.target).css("pointer-events","auto"):(l._isAddEditDialogSave=!0,e("#"+l._id+"_dialogEdit").ejDialog("close"))):a.target.id=="AddDialog_"+l._id+"_Save"?l._sendSaveRequest("Add")?e(a.target).css("pointer-events","auto"):this._duplicate||this._wrongenddate?e(a.target).css("pointer-events","auto"):(l._isAddEditDialogSave=!0,e("#"+l._id+"_dialogAdd").ejDialog("close")):a.target.id=="AddDialog_"+l._id+"_Cancel"&&e("#"+l._id+"_dialogAdd").ejDialog("close"):l._sendCancelRequest(),!1)},rowDrag:function(e){this.model.selectedCellIndexes=[],this._trigger("rowDrag",e)},rowDragStart:function(e){this._trigger("rowDragStart",e)},rowDragStop:function(e){this._trigger("rowDragStop",e)},cellSelecting:function(e){this.model;this._trigger("cellSelecting",e)},cellSelected:function(e){var t=this,i=t.model;t._trigger("cellSelected",e),i.selectedCellIndexes=t._$treegridHelper.ejTreeGrid("instance").model.selectedCellIndexes,t._rowIndexOfLastSelectedCell=i.selectedCellIndexes[0].rowIndex},rowSelecting:function(e){var i=this,a={},r=this.model;return!i.model.rowSelecting||"row"!=r.selectionMode||(a.recordIndex=e.recordIndex,a.previousIndex=e.previousIndex,a.previousData=r.updatedRecords[e.previousIndex],a.data=r.updatedRecords[e.recordIndex],a.previousChartRow=i._$ganttchartHelper.ejGanttChart("getRowByIndex",e.previousIndex),a.previousGridRow=t.TreeGrid.getRowByIndex(this,e.previousIndex),a.targetChartRow=i._$ganttchartHelper.ejGanttChart("getRowByIndex",e.recordIndex),a.targetGridRow=t.TreeGrid.getRowByIndex(this,e.recordIndex),r.selectedItems.length>1&&(a.selectedItems=r.selectedItems),!i._trigger("rowSelecting",a))},_getCtrlRequestValue:function(t){var i=this,a=i.model,r=i._id,n=i._$treegridHelper.ejTreeGrid("instance"),o=i._$ganttchartHelper.ejGanttChart("instance");e("#"+r+"_selectionpopup").is(":visible")&&e("#"+r+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")&&"row"==a.selectionMode&&(t.ctrlKey=n._multiSelectCtrlRequest=o._multiSelectCtrlRequest=!0),"expandCollapse"==t.requestType&&(i._ganttTouchTrigger=!1)},_updateTouchCtrlFlag:function(e){var t=this;t.model;"touchstart"==e.type&&(t._ganttTouchTrigger=!0,t._ganttTouchEvent=!0)},_renderMultiSelectionPopup:function(){this._multiSelectPopup=t.buildTag("div.e-ganttpopup#"+this._id+"_selectionpopup","",{display:"none"});var e=t.buildTag("div.e-popupcontent"),i=t.buildTag("div.e-downtail e-tail"),a=t.buildTag("span.e-rowselect e-icon");e.append(a),this._multiSelectPopup.append(e),this._multiSelectPopup.append(i),this.element.append(this._multiSelectPopup)},_clearMultiSelectPopup:function(){var t=this,i=t.model,a=t._$treegridHelper.ejTreeGrid("instance"),r=t._$ganttchartHelper.ejGanttChart("instance");i.allowSelection&&t._multiSelectPopup&&t._multiSelectPopup.is(":visible")&&(e("#"+t._id+"_selectionpopup").find(".e-rowselect").removeClass("e-spanclicked"),t._multiSelectPopup.hide(),a._multiSelectCtrlRequest=r._multiSelectCtrlRequest=!1,t._ganttTouchTrigger=a._ganttTouchTrigger=r._ganttTouchTrigger=!1)},_alignMultiSelectPopup:function(){var t,i,a=this,r=e(a.element).offset().top+e(a.element).outerHeight(),n=e(a.element).offset().left+e(a.element).outerWidth();(a._multiSelectPopup.offset().top+a._multiSelectPopup.outerHeight()+10>r||a._multiSelectPopup.offset().left+a._multiSelectPopup.outerWidth()>n)&&(t=e(a.element).offset().top+e(a.element).outerHeight()/2,i=e(a.element).offset().left+e(a.element).outerWidth()/2,e(a.element).find(".e-hscrollbar").length>0&&(t-=e(a.element).find(".e-hscrollbar").outerHeight()),e(a.element).find(".e-vscrollbar").length>0&&(i-=e(a.element).find(".e-vscrollbar").outerWidth()),a._multiSelectPopup.offset({top:t-this._multiSelectPopup.height()/2-5,left:i-this._multiSelectPopup.width()/2}))},rowSelected:function(i){var a,r,n,o,l=this,d=this.model,s=e("#"+l._id+"_toolbarItems"),c=l._$treegridHelper.ejTreeGrid("instance"),u=l._$ganttchartHelper.ejGanttChart("instance");d.allowSelection&&("ejTreeGrid"==i.target&&(u._multiSelectCtrlRequest=c._multiSelectCtrlRequest,l._$ganttchartHelper.ejGanttChart("selectRows",i.recordIndex,i.toIndex)),"ejGanttChart"==i.target&&(c._multiSelectCtrlRequest=u._multiSelectCtrlRequest,l._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex,i.toIndex)),u._multiSelectCtrlRequest=c._multiSelectCtrlRequest=!1),i.recordIndex,d.selectedItems=c.model.selectedItems,d.selectedItem=c.model.selectedItem,this.selectedRowIndex(d.updatedRecords.indexOf(d.selectedItem)),l.model.toolbarSettings.showToolbar&&"rowDragAndDrop"!=i.requestType&&(1==l.model.readOnly?(a=[],e(s).find(".e-deleteitem").parent()[0]&&a.push(e(s).find(".e-deleteitem").parent()[0]),e(s).find(".e-addnewitem").parent()[0]&&a.push(e(s).find(".e-addnewitem").parent()[0]),e(s).find(".e-edititem").parent()[0]&&a.push(e(s).find(".e-edititem").parent()[0]),e(s).ejToolbar("disableItem",a)):((-1!==l.model.toolbarSettings.toolbarItems.indexOf("indent")||-1!==l.model.toolbarSettings.toolbarItems.indexOf("outdent"))&&l.model.allowSelection&&(d.selectedItems.length>1?l._multipleIndentOutdentOption(d.selectedItems):l.updateIndentOutdentOption(d.selectedItem)),r=[],l.model.editSettings.allowDeleting&&l.model.allowSelection&&-1!==l.model.toolbarSettings.toolbarItems.indexOf("delete")&&d.selectedItems.length>0&&r.push(e(s).find(".e-deleteitem").parent()[0]),l.model.editSettings.allowAdding&&-1!==l.model.toolbarSettings.toolbarItems.indexOf("add")&&r.push(e(s).find(".e-addnewitem").parent()[0]),l.model.editSettings.allowEditing&&l.model.allowSelection&&"click"!=d.editSettings.beginEditAction&&-1!==l.model.toolbarSettings.toolbarItems.indexOf("edit")&&1==d.selectedItems.length&&r.push(e(s).find(".e-edititem").parent()[0]),e(s).ejToolbar("enableItem",r))),(n={}).recordIndex=i.recordIndex,delete(o=e.extend({},d.updatedRecords[i.recordIndex])).childRecords,delete o.parentItem,n.data=o,n.targetChartRow=l._$ganttchartHelper.ejGanttChart("getRowByIndex",i.recordIndex),n.targetGridRow=t.TreeGrid.getRowByIndex(this,i.recordIndex),d.selectedItems.length>1&&(n.selectedItems=d.selectedItems),d.allowSelection&&"row"==d.selectionMode&&l._trigger("rowSelected",n)},_multipleIndentOutdentOption:function(t){for(var i=!1,a=!1,r=e("#"+this._id+"_toolbarItems"),n=e(r).find(".e-indent").parent()[0],o=e(r).find(".e-outdent").parent()[0],l=0;l<t.length&&(this.updateIndentOutdentOption(t[l]),e(e(r).find(".e-indent").parent()[0]).hasClass("e-disable")||(i=!0),e(e(r).find(".e-outdent").parent()[0]).hasClass("e-disable")||(a=!0),i&&e(r).ejToolbar("enableItem",n),a&&e(r).ejToolbar("enableItem",o),!a||!i);l++);},updateIndentOutdentOption:function(i){var a,r=this,n=r.model.flatRecords,o=n.indexOf(i),l=e("#"+r._id+"_toolbarItems"),d=e(l).find(".e-indent").parent()[0],s=e(l).find(".e-outdent").parent()[0];0===o||0==r.model.editSettings.allowIndent||1==r.model.readOnly||!r.model.allowSelection||t.isNullOrUndefined(i)||-1==o?(d&&e(l).ejToolbar("disableItem",d),s&&e(l).ejToolbar("disableItem",s)):0===i.level&&1==r.model.editSettings.allowIndent?(d&&e(l).ejToolbar("enableItem",d),s&&e(l).ejToolbar("disableItem",s)):(a=n[o-1],i.level-a.level==1&&1==r.model.editSettings.allowIndent&&-1!=r.selectedRowIndex()?(s&&e(l).ejToolbar("enableItem",s),d&&e(l).ejToolbar("disableItem",d)):1==r.model.editSettings.allowIndent&&-1!=r.selectedRowIndex()&&(d&&e(l).ejToolbar("enableItem",d),s&&e(l).ejToolbar("enableItem",s)))},_ganttChartRowHover:function(e){"mouseenter"==e.reason?this._$treegridHelper.ejTreeGrid("addRowHover",e.index):"mouseleave"==e.reason&&this._$treegridHelper.ejTreeGrid("removeRowHover")},getExpandedRecordCount:function(e,t){var i,a;if(!e.hasChildRecords)return 0;for(a=0;a<e.childRecords.length;a++)i=e.childRecords[a],this.getExpandStatus(i)&&t++,i.hasChildRecords&&(t=this.getExpandedRecordCount(i,t));return t},_updateExpandStatus:function(){for(var e=this,t=this.model.flatRecords,i=t.length,a=0;a<i;a++)t[a].isExpanded,e.getExpandStatus(t[a])!==t[a].isExpanded&&(t[a].isExpanded=e.getExpandStatus(t[a]),t[a].isExpanded?e._totalCollapseRecordCount--:e._totalCollapseRecordCount++)},actionComplete:function(a){var r,n,o,l,d,s,c,u,p,h=this,g=h.model,m=null;if(h.model.updatedRecords=h.getUpdatedRecords(),h.model.currentViewData=h.getCurrentViewData(),h._gridRows=h.getRows(),h._ganttChartRows=h.getGanttChartRows(),h._totalCollapseRecordCount=h._$treegridHelper.ejTreeGrid("getCollapsedRecordCount"),("searching"===a.requestType||"sorting"===a.requestType||"filtering"==a.requestType)&&(h._isRefreshAddedRecord=!1,h._$ganttchartHelper.ejGanttChart("clearConnectorLines"),h._$ganttchartHelper.ejGanttChart("refreshHelper",h.model.currentViewData,h.model.updatedRecords,h._totalCollapseRecordCount),this._refreshConnectorLines(!1,!0,!0)),"sorting"==a.requestType&&h._deSelectRowItem(),"delete"===a.requestType){for(h._isRefreshAddedRecord=!1,this.dataSource(h._$treegridHelper.ejTreeGrid("getDataSource")),h._isDataManagerUpdate&&(this._jsonData=h._$treegridHelper.ejTreeGrid("getUpdatedDataManagerData")),h.model.flatRecords=h._$treegridHelper.ejTreeGrid("getFlatRecords"),h.model.ids=h._$treegridHelper.ejTreeGrid("getUpdatedIds"),h.model.updatedRecords=h.getUpdatedRecords(),g.selectedItem=null,this.selectedRowIndex(-1),h.model.selectedItems=[],h._$ganttchartHelper.ejGanttChart("instance")._prevSelectedItem=null,h._clearMultiSelectPopup(),0,0,r=0;r<a.deletedItems.length;r++)a.data=a.deletedItems[r],(t.isNullOrUndefined(a.data.parentItem)||a.data.parentItem&&-1!=g.flatRecords.indexOf(a.data.parentItem))&&(-1!==g.parentRecords.indexOf(a.data)&&g.parentRecords.splice(g.parentRecords.indexOf(a.data),1),a.data.hasChildRecords&&h._removeChildRecordsPredecessor(a.data),!a.isDragAndDropDelete&&h._isTriggerActionComplete&&a.data.predecessor&&h._removePredecessor(a.data.predecessor,a.data),a.data.parentItem&&(n=a.data.parentItem,a.data.parentItem.childRecords&&a.data.parentItem.childRecords.length>0?"resourceTask"==a.data.eResourceTaskType?h._updateResourceParentItem(a.data):a.data.parentItem.isAutoSchedule?h._updateParentItem(a.data):a.data.parentItem.isAutoSchedule||h._updateManualParentItem(a.data):(n.expanded=!1,n.hasChildRecords=!1,h.refreshGanttRecord(n))));if("resourceView"==g.viewType&&(g.parentRecords=a.model.parentRecords.slice()),a.isDragAndDropDelete)return;h.model.predecessorMapping&&h._refreshConnectorLines(!1,!0,!1),1==this.isCriticalPathEnable&&this.showCriticalPath(!0,!0),h._$ganttchartHelper.ejGanttChart("refreshHelper",h.getCurrentViewData(),h.getUpdatedRecords(),h._totalCollapseRecordCount),h._updateToolbarOptions(),h.updateAltRow(h.getUpdatedRecords(),0,1),1==this.isCriticalPathEnable&&h._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId)}if("selection"===a.requestType&&h._$ganttchartHelper.ejGanttChart("selectRows",a.recordIndex),"rowHover"===a.requestType&&h._$ganttchartHelper.ejGanttChart("addRowHover",a.index),"scroll"===a.requestType&&h._$ganttchartHelper.ejGanttChart("onScrollHelper",a.delta),"dragAndDrop"==a.requestType&&(g.parentRecords=h._$treegridHelper.ejTreeGrid("instance").model.parentRecords,h._isRefreshAddedRecord=!1,this.dataSource(h._$treegridHelper.ejTreeGrid("getDataSource")),h._isDataManagerUpdate&&(this._jsonData=h._$treegridHelper.ejTreeGrid("getUpdatedDataManagerData")),g.flatRecords=h._$treegridHelper.ejTreeGrid("getFlatRecords"),g.ids=h._$treegridHelper.ejTreeGrid("getUpdatedIds"),g.updatedRecords=h.getUpdatedRecords(),o=a.draggedRow.parentItem,"insertAsChild"==a.droppedPosition&&o&&(o.taskType=t.Gantt.TaskType.FixedDuration,o.effortDriven="false"),g.predecessorMapping&&(a.isFromRevertDragging&&h._addRemovedPredecessor(a.clonedTarget),"insertAsChild"==a.droppedPosition&&(o.predecessor&&h._removePredecessor(o.predecessor,o),o.item[g.predecessorMapping]=i,o.predecessorsName=i,o.predecessor=i,g.enableSerialNumber&&h._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",o)),h._refreshConnectorLines(!1,!0,!1)),a.draggedRow.parentItem&&a.draggedRow.parentItem.isAutoSchedule?h._updateParentItem(a.draggedRow):a.draggedRow.parentItem&&!a.draggedRow.parentItem.isAutoSchedule&&h._updateManualParentItem(a.draggedRow),(l=a.previousParentItem?this._getRecordByTaskId(a.previousParentItem.taskId.toString()):null)&&l.childRecords&&l.childRecords.length>0&&(l.isAutoSchedule?h._updateParentItem(l.childRecords[0]):l.isAutoSchedule||h._updateManualParentItem(l.childRecords[0])),1==this.isCriticalPathEnable&&this.showCriticalPath(!0,!0),a.draggedRow&&h._$ganttchartHelper.ejGanttChart("refreshHelper",h.getCurrentViewData(),h.getUpdatedRecords(),h._totalCollapseRecordCount),1==this.isCriticalPathEnable&&h._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId)),"save"===a.requestType&&(a._cAddedRecord?(d=-1,d="resourceView"==g.viewType&&"resourceChildTask"==a._cAddedRecord.eResourceTaskType?g.updatedRecords.indexOf(a._cAddedRecord.parentItem):g.updatedRecords.indexOf(a._cAddedRecord),g.enableWBS&&g.enableWBSPredecessor&&g.predecessorMapping&&"projectView"==g.viewType&&h._$treegridHelper.ejTreeGrid("updateWBSPredecessor",a._cAddedRecord),h._renderAddedRow(a.index,a._cAddedRecord),a._cAddedRecord.parentItem&&a._cAddedRecord.parentItem.isAutoSchedule&&"resourceTask"!=a._cAddedRecord.parentItem.eResourceTaskType?h._updateParentItem(a._cAddedRecord):a._cAddedRecord.parentItem&&!a._cAddedRecord.parentItem.isAutoSchedule&&"resourceTask"!=a._cAddedRecord.parentItem.eResourceTaskType&&h._updateManualParentItem(a._cAddedRecord),g.enableAltRow&&t.TreeGrid.updateAltRow(h,g.currentViewData[0],0,0),g.selectionType==t.Gantt.SelectionType.Multiple&&(h._$treegridHelper.ejTreeGrid("instance")._multiSelectCtrlRequest=h._$ganttchartHelper.ejGanttChart("instance")._multiSelectCtrlRequest=!1),h.selectRows(d),m=a._cAddedRecord,g.enableVirtualization||((s={}).index=s.recordIndex=g.currentViewData.indexOf(a._cAddedRecord),h.refreshRowData(s),h.refreshRow(s))):a._cModifiedData&&(a._cModifiedData.hasChildRecords&&a._cModifiedData.isAutoSchedule?(a._cModifiedData.startDate=h._checkStartDate(a._cModifiedData.manualStartDate,a._cModifiedData),a._cModifiedData.left=a._cModifiedData._calculateManualLeft(this),a._cModifiedData.width=a._cModifiedData._calculateManualWidth(this),a._cModifiedData.progressWidth=a._cModifiedData._getProgressWidth(a._cModifiedData.width,a._cModifiedData.status),a._cModifiedData.endDate=a._cModifiedData.manualEndDate,a._cModifiedData._calculateDuration(this)):a._cModifiedData.hasChildRecords&&!a._cModifiedData.isAutoSchedule?(a._cModifiedData.left=a._cModifiedData._calculateLeft(this),a._cModifiedData.width=a._cModifiedData._calculateWidth(this),a._cModifiedData._calculateDuration(this),a._cModifiedData.manualStartDate=a._cModifiedData.startDate,a._cModifiedData.manualEndDate=a._cModifiedData.endDate,h._updateManualParentItem(a._cModifiedData,null,!0)):(a._cModifiedData.startDate=h._checkStartDate(a._cModifiedData.startDate,a._cModifiedData),t.isNullOrUndefined(a._cModifiedData.startDate)||t.isNullOrUndefined(a._cModifiedData.duration)||(a._cModifiedData.endDate=h._getEndDate(a._cModifiedData.startDate,a._cModifiedData.duration,a._cModifiedData.durationUnit,a._cModifiedData)),a._cModifiedData.left=a._cModifiedData._calculateLeft(this),a._cModifiedData.width=a._cModifiedData._calculateWidth(this),a._cModifiedData.progressWidth=a._cModifiedData._getProgressWidth(a._cModifiedData.width,a._cModifiedData.status)),g.enableWBS&&g.enableWBSPredecessor&&g.predecessorMapping&&h._$treegridHelper.ejTreeGrid("updateWBSPredecessor",a._cModifiedData),g.viewType==t.Gantt.ViewType.ProjectView&&h.refreshGanttRecord(a._cModifiedData),a._cModifiedData.parentItem&&a._cModifiedData.parentItem.isAutoSchedule&&"resourceTask"!=a._cModifiedData.parentItem.eResourceTaskType?h._updateParentItem(a._cModifiedData):a._cModifiedData.parentItem&&!a._cModifiedData.parentItem.isAutoSchedule&&"resourceTask"!=a._cModifiedData.parentItem.eResourceTaskType?h._updateManualParentItem(a._cModifiedData):a._cModifiedData.parentItem&&"resourceTask"==a._cModifiedData.parentItem.eResourceTaskType&&(c=a._cModifiedData.parentItem.eOverlapIndex,this._updateOverlappingValues(a._cModifiedData.parentItem),this._updateResourceParentItem(a._cModifiedData)),g.viewType==t.Gantt.ViewType.ResourceView&&("resourceChildTask"==a._cModifiedData.eResourceTaskType?h.refreshGanttRecord(a._cModifiedData.parentItem):"unassignedTask"==a._cModifiedData.eResourceTaskType&&(t.isNullOrUndefined(a._cModifiedData.resourceInfo)||a._cModifiedData.resourceInfo&&0==a._cModifiedData.resourceInfo.length)&&h.refreshGanttRecord(a._cModifiedData)),"resourceChildTask"==a._cModifiedData.eResourceTaskType&&(this._updateSharedResourceTask(a._cModifiedData),h._previousResource&&h._previousResource.length>0&&this._updateSharedResourceTask(a._cModifiedData,null,h._previousResource)),g.viewType==t.Gantt.ViewType.ResourceView&&h._updateResource(h._previousResource,a._cModifiedData.resourceInfo,a._cModifiedData),"resourceChildTask"==a._cModifiedData.eResourceTaskType&&(c!=a._cModifiedData.parentItem.eOverlapIndex||this._isOverlapIndexChanged)&&(this._refreshGanttHeightWithRecords(),this._isOverlapIndexChanged=!1),a._cModifiedData.predecessor&&a.previousValue&&h._removeConnectorLine(a.previousValue,a._cModifiedData)),h.model.predecessorMapping&&(h._isValidationEnabled=!(!a._cModifiedData||!a._cModifiedData.predecessor),a._cAddedRecord?(a._cAddedRecord.predecessor&&(h._isPredecessorEdited=!0,h._validatePredecessorDates(a._cAddedRecord),h._addConnectorLine(a._cAddedRecord),h._isPredecessorEdited=!1),h._refreshConnectorLines(!1,!0,!1)):a._cModifiedData&&(a.previousValue&&h._removeConnectorLine(a.previousValue,a._cModifiedData),h._addConnectorLine(a._cModifiedData),a._cModifiedData.predecessor&&(h._isUpdateOffset&&(h._editedTaskBarItem=a._cModifiedData),h._isMileStoneEdited=a._cModifiedData.isMilestone,h._updatedConnectorLineCollection=[],h._connectorlineIds=[],h._validatePredecessor(a._cModifiedData,a.previousValue),h._isUpdateOffset&&(h._editedTaskBarItem=null),h._updatedConnectorLineCollection.length>0&&"projectView"==g.viewType&&(h._$ganttchartHelper.ejGanttChart("appendConnectorLine",h._updatedConnectorLineCollection),this._updateConnectorLineCollection(h._updatedConnectorLineCollection))),a._cModifiedData.parentItem&&a._cModifiedData.parentItem.isAutoSchedule&&"resourceTask"!=a._cModifiedData.parentItem.eResourceTaskType?h._updateParentItem(a._cModifiedData):a._cModifiedData.parentItem&&!a._cModifiedData.parentItem.isAutoSchedule&&"resourceTask"!=a._cModifiedData.parentItem.eResourceTaskType&&h._updateManualParentItem(a._cModifiedData))),a._cModifiedData&&a._cModifiedData.hasChildRecords&&!a._cModifiedData.isAutoSchedule&&a.previousStartDate&&0!=h._compareDates(a.previousStartDate,a._cModifiedData.startDate)&&((u={}).previousData=e.extend({},a._cModifiedData),u.previousData.startDate=a.previousStartDate,u.data=a._cModifiedData,h._validateAutoChildRecords(u)),1==this.isCriticalPathEnable&&(h._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))),"validatePredecessor"===a.requestType||"validateSerialPredecessor"===a.requestType)return p="validateSerialPredecessor"===a.requestType?h._editedPredecessorValidation(a,!0):h._editedPredecessorValidation(a),void(a.result=p);h._isTriggerActionComplete&&("resourceView"==g.viewType&&"delete"==a.requestType&&(a.data&&"groupTask"==a.data.eResourceTaskType?a.requestType="groupDelete":a.data&&"resourceTask"==a.data.eResourceTaskType&&(a.requestType="resourceDelete")),h._ganttActionCompleteTrigger(a)),m&&h.focusOnTask(m)},_addRemovedPredecessor:function(e){for(var t,i=this,a=e.predecessor,r=a.length,n=-1,o=i.model;n<r;n++)-1==n?t=this._getRecordByTaskId(e.taskId.toString()):a[n].from!==e.taskId.toString()?t=this._getRecordByTaskId(a[n].from):a[n].to!==e.taskId.toString()&&(t=this._getRecordByTaskId(a[n].to)),t&&(-1==n?t.predecessor=a:t.predecessor.push(a[n]),t&&(t.item[o.predecessorMapping]=i._predecessorToString(t.predecessor,t),t.predecessorsName=t.item[o.predecessorMapping],this._updateResourcePredecessor(t),o.enableWBS&&o.enableWBSPredecessor&&i._$treegridHelper.ejTreeGrid("updateWBSPredecessor",t),o.enableSerialNumber&&i._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",t),i.refreshGanttRecord(t)))},_updateResource:function(i,a,r,n){var o,l,d,s,c,u,p=this,h=p.model,g=h.ids,m=h.flatRecords,_=a?a.length:0,f=i?i.length:0,w=(p.dataSource(),r.predecessor),C=r.predecessorsName,T=null;if(0!=_||0!=f){for(s=0;s<_;s++)b=a[s][h.resourceIdMapping],0==(x=e.map(i,function(e,t){if(e[h.resourceIdMapping]==b)return t})).length?(S=m[g.indexOf("R_"+b)],T||(T=p._createGanttRecord(r.item,S.level+1)),S&&(o=new t.Gantt.GanttRecord,(o=e.extend(!0,o,T)).eResourceTaskType="resourceChildTask",o.parentItem=S,o.predecessor=e.extend([],w),o.predecessorsName=C,S.eResourceChildTasks.push(o),this._updateResourceUniqIndex(o),p._isFlatResourceData||(S.item[h.taskCollectionMapping]||(S.item[h.taskCollectionMapping]=[]),S.item[h.taskCollectionMapping].push(o.item)),this._resourceChildTasks.push(o),this._updateOverlappingValues(o.parentItem),this._updateResourceParentItem(o),p.refreshGanttRecord(o.parentItem),this._updateSharedResourceTask(o),this._refreshGanttHeightWithRecords(),n&&(n.data=o))):(i.splice(x[0],1),(l={}).resourceInfo=r.resourceInfo,l.resourceNames=r.resourceNames,this._updateSharedResourceTask(r,l));for(d=i?i.length:0,s=0;s<d;s++){var x,v=r.taskId,b=i[s][h.resourceIdMapping],S=m[g.indexOf("R_"+b)];(x=e.map(S.eResourceChildTasks,function(e,t){if(e.taskId==v)return t})).length&&(c=S.eResourceChildTasks[x[0]],this._removeResourceChildTask(c),S.eResourceChildTasks.splice(x[0],1),this._updateOverlappingValues(S),this._updateResourceParentItem(c),p.refreshGanttRecord(S),this._updateSharedResourceTask(c),this._refreshGanttHeightWithRecords())}"unassignedTask"==r.eResourceTaskType&&_>0&&(p._isTriggerActionComplete=!1,p._$treegridHelper.ejTreeGrid("deleteRow",null,!0,h.updatedRecords.indexOf(r)),o&&(this._resourceUniqTaskIds.push(o.taskId.toString()),this._resourceUniqTasks.push(o),this._insertDataInDataSource(o.item)),p._isTriggerActionComplete=!0),"resourceChildTask"==r.eResourceTaskType&&0==_&&(p._isTriggerActionComplete=!1,p._isOnResourceUpdate=!0,p.addRecord(r.item,"bottom"),p._isOnResourceUpdate=!1,u=h.updatedRecords[h.updatedRecords.length-1],n&&(n.data=u),u&&(u.predecessor=e.extend([],w),u.predecessorsName=C,this._updateResourceUniqIndex(u)),p._isTriggerActionComplete=!0)}},_removeResourceInfo:function(e,t){var i,a,r,n,o;this.model;if(e.resourceInfo&&e.resourceInfo.length>1){if(null==(i=this._getExistingTaskWithID(e,!0)))return;for(r=0;r<i.length;r++)for(n=(a=i[r]).resourceInfo,o=0;o<n.length;o++)if(n[o][this.model.resourceIdMapping]==t){n.splice(o,1),this._updateResourceName(a),this._updateResourceRelatedFields(a);break}}},_updateResourceUniqIndex:function(e){var t=this._resourceUniqTaskIds.indexOf(e.taskId.toString());-1!=t?this._resourceUniqTasks[t]=e:(this._resourceUniqTaskIds.push(e.taskId.toString()),this._resourceUniqTasks.push(e))},focusOnTask:function(e){var t,i=this,a=i.model,r=i.element.find(".e-ganttviewerbodyContianer"),n=r.ejScroller("instance"),o=e&&e.left?e.left:a.updatedRecords[e]?a.updatedRecords[e].left:0,l=n.model.width,d=n.model.scrollLeft,s=n._hScrollbar;s&&(s.model.maximum<d&&(d=s.model.maximum),(d>o||d+l<o)&&(t=(t=o-l/2)<0?0:t,r.ejScroller("scrollX",t,!0))),i._$ganttchartHelper.ejGanttChart("updateScrollBar")},calculateEndDate:function(e){var t=this,i=this._getEndDate(t._checkStartDate(e.startDate,e.record),e.duration,e.durationUnit,e.record);t._$ganttchartHelper.ejGanttChart("updateEditedRecordEndDate",t._checkEndDate(i,e.record))},calculateDuration:function(e){var t=this,i=this._getDuration(t._checkStartDate(e.startDate,e.record),t._checkEndDate(e.endDate,e.record),e.durationUnit,e.record.isAutoSchedule);t._$ganttchartHelper.ejGanttChart("updateEditedRecordDuration",i)},expandAllCollapseAllRequest:function(t){var i=e(this.element),a=i.ejGantt("instance"),r=i.attr("id");a._toolbarOperation(r+"_"+t.requestType)},setChartScrollLeft:function(e){t.isNullOrUndefined(e)||this._$ganttchartHelper.ejGanttChart("setScrollLeft",e)},chartactionComplete:function(e){var a,r,n,o,l,d=this,s=this.model;d.model.updatedRecords=d.getUpdatedRecords(),d.model.currentViewData=d.getCurrentViewData(),"updateConnectors"===e.requestType&&(d.model.predecessorMapping&&(a=e.ganttRecord,d._isMileStoneEdited=a.isMilestone,d._updatedConnectorLineCollection=[],d._connectorlineIds=[],d._editedTaskBarItem=a,d._validatePredecessor(a),d._updatedConnectorLineCollection.length>0&&(d._$ganttchartHelper.ejGanttChart("appendConnectorLine",d._updatedConnectorLineCollection),this._updateConnectorLineCollection(d._updatedConnectorLineCollection)),d._editedTaskBarItem=null),"resourceView"==s.viewType&&"resourceChildTask"==e.ganttRecord.eResourceTaskType&&this._refreshGanttHeightWithRecords()),"rowHover"===e.requestType&&d._$treegridHelper.ejTreeGrid("addRowHover",e.index),"scroll"===e.requestType&&"vertical"==e.scrollDirection&&(d._isTreeGridRendered=!1,d._isGanttChartRendered=!1,e.vscrollExsist&&e.delta!==i&&d._$treegridHelper.ejTreeGrid("onScrollHelper",e.delta),d.model.updatedRecords=d.getUpdatedRecords(),d.model.currentViewData=d.getCurrentViewData(),d.model.enableVirtualization&&d.model.predecessorMapping&&d._refreshConnectorLines(!1,!0,!1),d._isTreeGridRendered=!0,d._isGanttChartRendered=!0),"selection"===e.requestType&&d._$treegridHelper.ejTreeGrid("selectRows",e.recordIndex),"validatePredecessor"===e.requestType&&(r=d._editedPredecessorValidation(e),e.predecessorValidation=r),"drawConnectorLine"===e.requestType&&(n=e.toItem._calculatePredecessor(e.predecessor,this._durationUnitEditText,this.model.durationUnit,d),e.toItem.item[d.model.predecessorMapping]=e.predecessorString[0],e.toItem.predecessorsName=e.toItem.item[d.model.predecessorMapping],s.enableWBS&&s.enableWBSPredecessor&&d._$treegridHelper.ejTreeGrid("updateWBSPredecessor",e.toItem),s.enableSerialNumber&&d._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",e.toItem),e.fromItem.predecessor?e.fromItem.predecessor.push(n[0]):e.fromItem.predecessor=n,e.toItem.predecessor?e.toItem.predecessor.push(n[0]):(e.toItem.predecessor=[],e.toItem.predecessor.push(n[0])),d._isMileStoneEdited=e.toItem.isMilestone,d._updatedConnectorLineCollection=[],d._connectorlineIds=[],d._isValidationEnabled=!(!d.model.enablePredecessorValidation||!e.toItem.isAutoSchedule&&!d.model.validateManualTasksOnLinking),d._isPredecessorEdited=!0,d._validatePredecessor(e.toItem),d._isPredecessorEdited=!1,d._updatedConnectorLineCollection.length>0&&(d._$ganttchartHelper.ejGanttChart("appendConnectorLine",d._updatedConnectorLineCollection),this._updateConnectorLineCollection(d._updatedConnectorLineCollection)),e.toItem.isAutoSchedule||d.model.validateManualTasksOnLinking||(o=d._$treegridHelper.ejTreeGrid("instance"),t.TreeGrid.refreshRow(o,d.model.currentViewData.indexOf(e.toItem))),(l={}).data=e.toItem,d._updateScheduleDatesOnEditing(l),1==this.isCriticalPathEnable&&(d._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))),d._ganttActionCompleteTrigger(e)},hideColumn:function(e){this._$treegridHelper.ejTreeGrid("hideColumn",e)},showColumn:function(e){this._$treegridHelper.ejTreeGrid("showColumn",e)},clearColumnMenu:function(){this._$treegridHelper.ejTreeGrid("clearColumnMenu")},deleteRow:function(){this._$treegridHelper.ejTreeGrid("deleteRow")},taskbarEditing:function(e){this._trigger("taskbarEditing",e)},setInitialData:function(){this._setInitialData()},sortColumn:function(e,t){this._$treegridHelper.ejTreeGrid("sortColumn",e,t)},clearSorting:function(){this.model;this._$treegridHelper.ejTreeGrid("clearSorting")},export:function(i,a,r){var n,o,l,d=this,s=d.model;if(d._$treegridHelper.ejTreeGrid("contextMenuOperations","Cancel"),n={action:i,method:"post","data-ajax":"false"},e("form#"+d._id+"export").remove(),o=t.buildTag("form#"+d._id+"export","",null,n),t.raiseWebFormsServerEvents){var c=d._getExportModel(s),u={durationText:d._durationUnitTexts,quarterYearTexts:d._quarterYearTexts,halfYearTexts:d._halfYearTexts,durationEditText:d._durationUnitEditText,taskTypeTexts:d._taskTypeTexts,effortDrivenTexts:d._effortDrivenTexts,taskModeTexts:d._taskModeTexts,nullText:d._nullText},p={model:c,originalEventType:a},h={model:JSON.stringify(c),locale:JSON.stringify(u)};t.raiseWebFormsServerEvents(a,p,h)}else{if(l={},r)e("body").find(".e-gantt").each(function(i,a){var r,n,s,c,u=e(a).data("ejGantt");t.isNullOrUndefined(u)||(r=u.model,n=d._getExportModel(r),l[i]=JSON.stringify(n),s={name:"GanttModel",type:"hidden",value:JSON.stringify(n)},c=t.buildTag("input","",null,s),o.append(c))});else{c=d._getExportModel(s);var g={name:"GanttModel",type:"hidden",value:JSON.stringify(c)},m=t.buildTag("input","",null,g);o.append(m),o.append(this)}u={durationText:d._durationUnitTexts,quarterYearTexts:d._quarterYearTexts,halfYearTexts:d._halfYearTexts,durationEditText:d._durationUnitEditText,taskTypeTexts:d._taskTypeTexts,effortDrivenTexts:d._effortDrivenTexts,taskModeTexts:d._taskModeTexts,nullText:d._nullText};var _={name:"locale",type:"hidden",value:JSON.stringify(u)},f=t.buildTag("input","",null,_);o.append(f),e("body").append(o),o.submit()}return!0},_getExportModel:function(e){var a,r,n,o,l,d,s,c,u,p,h=this,g=e,m=g.updatedRecords,_=g.currentViewData,f=g.flatRecords,w=g.parentRecords,C=g.selectedItem,T=g.selectedItems,x=g.workUnit,v=g.updatedGanttRecords;for(g.criticalTask=h.criticalPathCollection.join(),delete g.updatedRecords,delete g.currentViewData,delete g.flatRecords,delete g.parentRecords,delete g.selectedItem,delete g.selectedItems,delete g.workUnit,delete g.updatedGanttRecords,a=JSON.parse(JSON.stringify(g)),g.updatedRecords=m,g.currentViewData=_,g.flatRecords=f,g.parentRecords=w,g.selectedItem=C,g.selectedItems=T,g.workUnit=x,g.updatedGanttRecords=v,n=(r=a.columns).length,p=0;p<n;p++)if(a.columns[p].editType!=i)switch(r[p].editType){case"stringedit":r[p].editType="string";break;case"numericedit":r[p].editType="numeric";break;case"dropdownedit":r[p].editType="dropdown";break;case"booleanedit":r[p].editType="boolean"}if((l=(o=a.filterSettings.filteredColumns).length)>0)for(p=0;p<l;p++)d=o[p].field,null!=(s=t.TreeGrid.getColumnByField(h._columns,d))&&(d="resourceNames"!=d&&"predecessorsName"!=d?s.mappingName:d),g.filterSettings.filteredColumns[p].field=d,"equal"==o[p].operator?o[p].operator="equals":"notequal"==a.filterSettings.filteredColumns[p].operator&&(o[p].operator="notequals");if(u=(c=h.ignoreOnExport).length,this.ignoreOnExport)for(p=0;p<u;p++)delete a[c[p]];return a},_refreshParent:function(e){this.refreshGanttRecord(e),e.parentItem&&this._refreshParent(e.parentItem)},_getDefaultTZOffset:function(){var e=new Date((new Date).getFullYear(),0,1),t=new Date((new Date).getFullYear(),6,1);return Math.max(e.getTimezoneOffset(),t.getTimezoneOffset())},_isInDst:function(e){return e.getTimezoneOffset()<this._getDefaultTZOffset()},_getDateByLeft:function(e){var i=new Date(this._projectStartDate),a=864e5/this._perDayWidth;return i.setTime(i.getTime()+e*a),(this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Month||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Year||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.QuarterYear||this.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.HalfYear)&&(this._isInDst(this._projectStartDate)&&!this._isInDst(i)?i.setTime(i.getTime()+36e5):!this._isInDst(this._projectStartDate)&&this._isInDst(i)&&i.setTime(i.getTime()-36e5)),i},_getRoundOffStartLeft:function(e,a){var r=this,n=r.model,o=e.left,l=n.scheduleHeaderSettings.scheduleHeaderType,d=t.Gantt.ScheduleHeaderType,s=e.left%r._perDayWidth,c=s/r._perDayWidth;return a==i&&(a=!1),a?a&&(l==d.Week||l==d.Month||l==d.Year||l==d.QuarterYear||l==d.HalfYear?o=e.left-s:l==d.Day?(c=(s=e.left%r._perHourWidth)/r._perHourWidth,o=e.left-s):l==d.Hour&&(c=(s=e.left%r._perMinuteWidth)/r._perMinuteWidth,o=e.left-s)):(l==d.Week||l==d.Month||l==d.Year||l==d.QuarterYear||l==d.HalfYear)&&(c<=.5?o=e.left-s:c>.5&&(o=e.left-s+r._perDayWidth/2)),o},_getRoundOffEndLeft:function(e,a){var r=this.model,n=r.scheduleHeaderSettings.scheduleHeaderType,o=t.Gantt.ScheduleHeaderType,l=e.width+e.left,d=l%r.perDayWidth,s=d/r.perDayWidth;return a==i&&(a=!1),a?a&&((n==o.Week||n==o.Month||n==o.Year||n==o.QuarterYear||n==o.HalfYear)&&0!=d&&(l=l-d+r.perDayWidth),n==o.Day&&(s=(d=l%r.perHourWidth)/r.perHourWidth,0!=d&&(l=l-d+r.perHourWidth)),n==o.Hour&&(s=(d=l%r.perMinuteWidth)/r.perMinuteWidth,0!=d&&(l=l-d+r.perMinuteWidth))):(n==o.Week||n==o.Month||n==o.Year||n==o.QuarterYear||n==o.HalfYear)&&(0==s?l=l:s>.5?l=l-d+r.perDayWidth:s<.5&&(l=l-d+r.perDayWidth/2)),l},taskbarEdited:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x=this,v=i.data,b=x.model,S=new Date(x._projectStartDate),D=b.scheduleHeaderSettings.scheduleHeaderType,R=t.Gantt.ScheduleHeaderType,y=(t.Gantt.DurationUnit,!1),I=!1;x.dataSource();if(x._isValidationEnabled=!1,i.dragging){if(w="dragging",i.previousData.left!==v.left&&(a=x._getRoundOffStartLeft(v,i.roundOffDuration),S=x._getDateByLeft(a),!t.isNullOrUndefined(v.endDate)&&t.isNullOrUndefined(v.startDate)?(n=x._checkStartDate(S,v,null),v.endDate=x._checkEndDate(n,v),b.endDateMapping&&(v.item[b.endDateMapping]=v.endDate)):(v.startDate=x._checkStartDate(S,v),t.isNullOrUndefined(v.duration)||v._calculateEndDate(x),b.startDateMapping&&(v.item[b.startDateMapping]=v.startDate)),v.left=v._calculateLeft(this),v.width=v._calculateWidth(this),v.hasChildRecords||(v.progressWidth=v._getProgressWidth(v.width,v.status)),x._isValidationEnabled=!0),"resourceView"==x.model.viewType&&this.model.allowDragAndDrop)for(u=-1,e.extend(!0,[],v.resourceInfo),o=v.top,(l=this.model.currentViewData).indexOf(v),v.eResourceTaskType,u=this.model.updatedRecords.indexOf(v),p=0;p<l.length;p++)if(d=l[p].eOverlapIndex*this.model.rowHeight,x.getExpandStatus(l[p])){if(!(o>d)){y=x._checkSharedTasks(v,l[p]),"groupTask"!=l[p].eResourceTaskType&&"unassignedTask"!=l[p].eResourceTaskType&&"unassignedTask"==v.eResourceTaskType&&p!=l.indexOf(v)&&-1!=u&&(x._isTriggerActionComplete=!1,x._$treegridHelper.ejTreeGrid("deleteRow",null,!0,u)),"resourceTask"==l[p].eResourceTaskType&&(i.assignedResource=l[p].item,("unassignedTask"==v.eResourceTaskType||v.parentItem&&v.parentItem.taskId!=l[p].taskId)&&(v.parentItem&&(s=v.parentItem,g=(c=l[h=l.indexOf(s)].eResourceChildTasks).indexOf(v),c.splice(g,1),m=s.taskId,x._isFlatResourceData||l[h].item[b.taskCollectionMapping]&&l[h].item[b.taskCollectionMapping].splice(l[h].item[b.taskCollectionMapping].indexOf(v.item),1)),y?this._removeResourceInfo(y,m):(l[p].eResourceChildTasks.push(v),v.parentItem=l[p],"unassignedTask"==v.eResourceTaskType&&(this._resourceChildTasks.push(v),this._resourceUniqTaskIds.push(v.taskId.toString()),this._resourceUniqTasks.push(v),this._insertDataInDataSource(v.item)),v.eResourceTaskType="resourceChildTask",x._updateResourceParentItem(v),x._updateResourceResourceDetails(v,m),x._isFlatResourceData||(l[p].item[b.taskCollectionMapping]||(l[p].item[b.taskCollectionMapping]=[]),l[p].item[b.taskCollectionMapping].push(v.item))))),t.isNullOrUndefined(s)||(s.isAutoSchedule&&"resourceTask"!=s.eResourceTaskType?x._updateParentItem(v):s.isAutoSchedule||"resourceTask"==s.eResourceTaskType?"resourceTask"==s.eResourceTaskType&&(_=s.eOverlapIndex,this._updateOverlappingValues(s),this.refreshGanttRecord(s),t.isNullOrUndefined(s.parentItem)||x._updateResourceParentItem(s.parentItem),I=_!=s.eOverlapIndex):x._updateManualParentItem(v)),this._updateResourceName(v),this._updateResourceRelatedFields(v);break}o-=d}i.previousData.left!==v.left&&"resourceView"==b.viewType&&"resourceChildTask"==v.eResourceTaskType&&this._updateSharedResourceTask(v)}else i.rightResizing?(w="Resizing",i.previousData.width!==v.width&&(a=x._getRoundOffEndLeft(v,i.roundOffDuration),f=x._getDateByLeft(a),v.endDate=x._checkEndDate(f,v),b.endDateMapping&&(v.item[b.endDateMapping]=v.endDate),v._calculateDuration(this),v.width=v._calculateWidth(this),v.hasChildRecords||(v.progressWidth=v._getProgressWidth(v.width,v.status)),x._updatedColumn="duration",x._updateResourceRelatedFields(v),"resourceView"==b.viewType&&"resourceChildTask"==v.eResourceTaskType&&this._updateSharedResourceTask(v))):i.leftResizing&&(w="Resizing",i.previousData.left!==v.left&&(a=x._getRoundOffStartLeft(v,i.roundOffDuration),S=x._getDateByLeft(a),v.startDate=x._checkStartDate(S,v),b.startDateMapping&&(v.item[b.startDateMapping]=v.startDate),v.endDate=x._checkEndDate(v.endDate,v),v.isAutoSchedule&&0==b.includeWeekend&&(D==R.Hour||D==R.Day)&&v._calculateEndDate(this),v._calculateDuration(this),v.left=v._calculateLeft(this),v.width=v._calculateWidth(this),v.hasChildRecords||(v.progressWidth=v._getProgressWidth(v.width,v.status)),x._updatedColumn="duration",x._updateResourceRelatedFields(v),"resourceView"==b.viewType&&"resourceChildTask"==v.eResourceTaskType&&this._updateSharedResourceTask(v)));i.progressResizing?i.previousData.status!=i.data.status&&(v.status=v._getProgressPercent(v.width,v.progressWidth),v.parentItem&&v._updateParentProgress(v.parentItem,b.progressMapping,this),x._refreshParent(v)):(x._isValidationEnabled=!0,x._isOverlapIndexChanged=!1,x._updateEditedGanttRecord(v),v.predecessor&&(x._isMileStoneEdited=v.isMilestone,x._updatedConnectorLineCollection=[],x._connectorlineIds=[],x._editedTaskBarItem=v,b.enablePredecessorValidation?x._validatePredecessor(v):x._validatePredecessorOnEditing(v),"resourceView"!=b.viewType&&x._updatedConnectorLineCollection.length>0&&(x._$ganttchartHelper.ejGanttChart("appendConnectorLine",x._updatedConnectorLineCollection),this._updateConnectorLineCollection(x._updatedConnectorLineCollection))),x._editedTaskBarItem=null,v.isAutoSchedule||!v.hasChildRecords||i.isChildren||i.rightResizing||x._validateAutoChildRecords(i),v.parentItem&&v.parentItem.isAutoSchedule&&"resourceTask"!=v.parentItem.eResourceTaskType?x._updateParentItem(v,w):v.parentItem&&!v.parentItem.isAutoSchedule&&"resourceTask"!=v.parentItem.eResourceTaskType?x._updateManualParentItem(v,w):v.parentItem&&"resourceTask"==v.parentItem.eResourceTaskType&&(r=v.parentItem.eOverlapIndex,this._updateOverlappingValues(v.parentItem),this._updateResourceParentItem(v))),x._isLastRefresh=!i.isFromAutoChildUpdate,"resourceChildTask"==v.eResourceTaskType?x.refreshGanttRecord(v.parentItem,v):x.refreshGanttRecord(v),i.isFromAutoChildUpdate||x._trigger("taskbarEdited",i),"resourceView"==b.viewType&&i.dragging&&i.cancel&&(!i.previousResource||i.assignedResource&&i.assignedResource[b.resourceIdMapping]!=i.previousResource[b.resourceIdMapping])&&(C=[],T=[],i.previousResource&&C.push(i.previousResource),y||T.push(i.assignedResource),x._updateResource(T,C,v,i)),i.cancel||"resourceChildTask"!=v.eResourceTaskType||this._updateSharedResourceTask(v),!i.cancel&&(i.leftResizing||i.rightResizing||i.dragging)&&x._isValidationEnabled&&x._updateScheduleDatesOnEditing(i),1==this.isCriticalPathEnable&&(x._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0)),!i.cancel&&(this._isOverlapIndexChanged||I||"resourceChildTask"==v.eResourceTaskType&&r!=v.parentItem.eOverlapIndex)&&this._refreshGanttHeightWithRecords(),this._isOverlapIndexChanged=!1},_updateSharedResourceTask:function(i,a,r){this.model;var n,o,l,d,s=r||i.resourceInfo;if(s&&s.length>0){var c,u,p=this._getExistingTaskWithID(i,!0),h=this._getGanttColumnDetails().customColDetails,g=h.length;if(null==p)return;for(n=0;n<p.length;n++)if((c=p[n]).parentItem.taskId!=i.parentItem.taskId&&t.isNullOrUndefined(a)){if(c.startDate=new Date(i.startDate),c.endDate=new Date(i.endDate),c.duration=i.duration,c.left=i.left,c.width=i.width,c.status=i.status,c.work=i.work,c.effortDriven=i.effortDriven,c.taskType=i.taskType,c.progressWidth=i.progressWidth,c.taskName=i.taskName,c.eResourceName=i.eResourceName,c.baselineLeft=i.baselineLeft,c.baselineRight=i.baselineRight,c.baselineWidth=i.baselineWidth,c.predecessor=i.predecessor,g)for(o=0;o<g;o++)c[h[o].field]=i[h[o].field];u=c.parentItem.eOverlapIndex,this._updateOverlappingValues(c.parentItem),u==c.parentItem.eOverlapIndex||this._isOverlapIndexChanged||(this._isOverlapIndexChanged=!0),this._updateResourceParentItem(c),this.refreshGanttRecord(c.parentItem)}else if(c.parentItem.taskId!=i.parentItem.taskId&&!t.isNullOrUndefined(a))for(d in l={},e.extend(!0,l,a),l)c[d]=a[d]}},_refreshGanttHeightWithRecords:function(){var e=this._$treegridHelper.ejTreeGrid("getRecordsHeight");this._$treegridHelper.ejTreeGrid("updateHeight"),this._$ganttchartHelper.ejGanttChart("updateHeight",e)},_getUpdatableChildRecords:function(e,t){for(var i=e.childRecords,a=0;a<i.length;a++)i[a].isAutoSchedule&&!i[a].predecessorsName&&(i[a].hasChildRecords?this._getUpdatableChildRecords(i[a],t):t.push(i[a]))},_validateAutoChildRecords:function(t){var i,a,r,n,o=t.data,l=[],d=new Date(t.previousData.startDate),s=new Date(o.startDate),c={},u=!0,p=0;if(this._getUpdatableChildRecords(o,l),0!=l.length)for(d.getTime()>s.getTime()?(i=this._checkStartDate(s),a=this._checkEndDate(d),u=!1):(i=this._checkStartDate(d),a=this._checkEndDate(s),u=!0),p=i.getTime()>=a.getTime()?0:this._getDuration(i,a,"minute",!0),n=0;n<l.length;n++)l[n].isAutoSchedule&&!l[n].hasChildRecords&&p>0&&(c.previousData=e.extend({},l[n]),u?(r=this._getEndDate(new Date(l[n].startDate),p,"minute",l[n]),l[n].left=this._getTaskLeft(this._checkStartDate(new Date(r)))):(r=this._getStartDate(this._checkEndDate(new Date(l[n].startDate)),p,"minute",l[n]),l[n].left=this._getTaskLeft(r)),c.data=l[n],c.dragging=!0,c.isChildren=!0,c.isFromAutoChildUpdate=!0,this.taskbarEdited(c))},actionBegin:function(t){var i,a=this;return"resourceView"==this.model.viewType&&"delete"==t.requestType?(i=e.extend({},t),t.data&&"groupTask"==t.data.eResourceTaskType?i.requestType="groupDelete":t.data&&"resourceTask"==t.data.eResourceTaskType&&(i.requestType="resourceDelete"),a._trigger("actionBegin",i),t.cancel=i.cancel):a._trigger("actionBegin",t),t.cancel||("beginedit"===t.requestType&&a._sendEditRequest(null,t),"validateLinkedTask"!=t.requestType)?void 0:t.cancel=!a.model.enablePredecessorValidation||!t.data.isAutoSchedule&&!a.model.validateManualTasksOnLinking||!a.model.predecessorMapping||a._validateTypes(t)},_ganttActionCompleteTrigger:function(t){var i,a,r=this,n=r.model;("save"===t.requestType||"drawConnectorLine"===t.requestType||"delete"===t.requestType||"dragAndDrop"===t.requestType)&&("dragAndDrop"===t.requestType?((a=e.map(r._actionCompleteData,function(e,i){if(e.taskId==t.draggedRow.taskId)return i})).length&&r._actionCompleteData.splice(a[0],1),a=null,(a=e.map(r._actionCompleteData,function(e,i){if(e.taskId==t.targetRow.taskId)return i})).length&&r._actionCompleteData.splice(a[0],1)):"save"==t.requestType?(i=t.addedRecord?t.addedRecord:t.modifiedRecord,(a=e.map(r._actionCompleteData,function(e,t){if(e.taskId==i.item[n.taskIdMapping])return t})).length&&r._actionCompleteData.splice(a[0],1)):"drawConnectorLine"===t.requestType&&((a=e.map(r._actionCompleteData,function(e,i){if(e.taskId==t.fromItem.taskId)return i})).length&&r._actionCompleteData.splice(a[0],1),(a=e.map(r._actionCompleteData,function(e,i){if(e.taskId==t.toItem.taskId)return i})).length&&r._actionCompleteData.splice(a[0],1)),r._actionCompleteData.length&&(t.updatedRecords=r._actionCompleteData,r._actionCompleteData=[])),r._trigger("actionComplete",t),t.cancel||"save"!==t.requestType||(t._cModifiedData&&(t.data=t._cModifiedData,r._updateLastInsertedId(t.data.taskId)),t._cAddedRecord&&(t.data=t._cAddedRecord,r._updateLastInsertedId(t.data.taskId,!0)),r._updateScheduleDatesOnEditing(t))},_queryCellInfo:function(e){this._trigger("queryCellInfo",e)},_beginEdit:function(t){var i,a=this,r=e("#"+a._id+"_toolbarItems");if(!a._trigger("beginEdit",t)&&(a._isinBeginEdit=!0,a.model.toolbarSettings.showToolbar)){var n=[],o=e(r).find(".e-cancel").parent()[0],l=e(r).find(".e-saveitem").parent()[0];o&&n.push(o),l&&n.push(l),e(r).ejToolbar("enableItem",n),i=[],a.model.editSettings.allowAdding&&-1!==a.model.toolbarSettings.toolbarItems.indexOf("add")&&i.push(e(r).find(".e-addnewitem").parent()[0]),a.model.editSettings.allowEditing&&-1!==a.model.toolbarSettings.toolbarItems.indexOf("edit")&&i.push(e(r).find(".e-edititem").parent()[0]),a.model.editSettings.allowDeleting&&-1!==a.model.toolbarSettings.toolbarItems.indexOf("delete")&&i.push(e(r).find(".e-deleteitem").parent()[0]),e(r).ejToolbar("disableItem",i)}},_triggerEndEdit:function(i){var a,r,n,o,l,d,s,c,u,p,h=this,g=this.model,m=e("#"+h._id+"_toolbarItems");if(h._trigger("endEdit",i))a="",i.data[i.columnName]=i.previousValue,"predecessor"===i.columnName?(a=h._predecessorToString(i.data.predecessor,i.data),i.data.item[i.columnObject.mappingName]=a,i.data.predecessorsName=a):(i.data.item[i.columnObject.mappingName]=i.previousValue,"resourceInfo"===i.columnName&&(h._updateResourceName(i.data),h._updateResourceRelatedFields(i.data)));else{if(h._updatedColumn=i.columnName,"taskType"==i.columnName&&"fixedWork"==i.value&&(i.data.effortDriven="true"),("duration"===i.columnName||"work"==i.columnName)&&h._updateResourceRelatedFields(i.data),"resourceInfo"===i.columnName&&(h._updateResourceName(i.data),h._updateResourceRelatedFields(i.data),0==h._isDurationUpdated&&(r=i.data,(n=!!i.data.hasChildRecords)&&r.isAutoSchedule?h._updateParentItem(r,null,!0):n&&!r.isAutoSchedule&&h._updateManualParentItem(r,null,!0),r.parentItem&&r.parentItem.isAutoSchedule?h._updateParentItem(r,null,!1):r.parentItem&&!r.parentItem.isAutoSchedule&&h._updateManualParentItem(r,null,!1))),"predecessor"==i.columnName&&g.predecessorMapping)for(o=i.value.replace(/[a-z]/gi,"").split(","),l=0;l<o.length;l++)(d=g.flatRecords.filter(function(e){return e&&e.taskId==o[l]}))[0]&&d[0].hasChildRecords&&(s=i.data.predecessor.filter(function(e){if(e&&(e.from==o[l]||e.to==o[l]))return e}),c=i.data.predecessor.indexOf(s[0]),i.data.predecessor.splice(c,1),u=h._$treegridHelper.ejTreeGrid("instance"),t.TreeGrid.refreshRow(u,g.flatRecords.indexOf(i.data)));(i.isModified||h._isDurationUpdated)&&(h.model.currentViewData=h._$treegridHelper.ejTreeGrid("getCurrentViewData"),h._isValidationEnabled=!(!i.data.isAutoSchedule&&!g.validateManualTasksOnLinking),h._updateEditedGanttRecords(i,!1))}h._isDurationUpdated=!1,h._isinBeginEdit=!1,h._isLastRefresh=!0,h.refreshGanttRecord(i.data),delete i.isModified,h.model.toolbarSettings.showToolbar&&(p=[],-1!==h.model.toolbarSettings.toolbarItems.indexOf("cancel")&&p.push(e(m).find(".e-cancel").parent()[0]),-1!==h.model.toolbarSettings.toolbarItems.indexOf("update")&&p.push(e(m).find(".e-saveitem").parent()[0]),e(m).ejToolbar("disableItem",p)),i.cancel||"startDate"!==i.columnName&&"endDate"!==i.columnName&&"duration"!==i.columnName&&"baselineStartDate"!==i.columnName&&"baselineEndDate"!==i.columnName||h._updateScheduleDatesOnEditing(i),i.cancel||"taskMode"!==i.columnName&&"startDate"!==i.columnName&&"endDate"!==i.columnName&&"duration"!==i.columnName&&"status"!==i.columnName&&"predecessor"!==i.columnName||1==this.isCriticalPathEnable&&(h._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))},filterColumn:function(i,a,r,n,o){var l,d,s=this,c=s.model,u=s.model.filterSettings.filteredColumns,p={};for(p.requestType="filtering",p.currentFilterObject=[],Array.isArray(a)||(a=e.makeArray(a)),Array.isArray(r)||(r=e.makeArray(r)),!1,this._filterCollection,(this._currentFilterColumn.length<=0||t.util.isNullOrUndefined(this._currentFilterColumn))&&(this._currentFilterColumn=t.TreeGrid.getColumnByMappingName(s._columns,i)),i=i==c.resourceInfoMapping?"resourceNames":i==c.predecessorMapping?"predecessorsName":this._currentFilterColumn.field,l=0;l<a.length;l++)d={field:i,operator:a[l],value:r[l],matchcase:o,predicate:n},this._$colType="string",0==u.length&&""!==d.value&&("date"!=this._$colType||"equal"!=a&&"notequal"!=a||"string"==typeof d.value?u.push(d):this._setDateFilters(d)),!0,p.currentFilterObject.push(d);p.filterCollection=u,p.currentFilteringColumn=i,p.fieldName=i,s._refreshFilteredRecords(p)},clearFilter:function(){var e=this,t={requestType:"filtering"};e.model.filterSettings.filteredColumns=[],e._refreshFilteredRecords(t),e._currentFilterColumn=[]},_refreshFilteredRecords:function(t){var i=this,a=i.model;e("#ejTreeGrid"+i._id).data("ejTreeGrid").model.filterSettings.filteredColumns=a.filterSettings.filteredColumns,i._$treegridHelper.ejTreeGrid("processBindings",t)},filterContent:function(e){var i,a,r=this,n=r.model.filterSettings.filteredColumns;if(!(e instanceof t.Predicate))return!1;(i=[]).push(e.toJSON()),r._addPredicateObject(i,n),a={requestType:"filtering"},r._refreshFilteredRecords(a)},_addPredicateObject:function(e,i,a){for(var r,n,o=this.model,l=e.length,d=0;d<l;d++)(r=e[d]).isComplex?t.isNullOrUndefined(r.predicates)||this._addPredicateObject(r.predicates,i,r.condition):((n={}).field=r.field==o.resourceInfoMapping?"resourceNames":r.field==o.predecessorMapping?"predecessorsName":r.field,n.operator=r.operator,n.value=r.value,n.matchcase=!r.ignoreCase,n.predicate=a,i.push(n))},_endEdit:function(e){var t,i,a=this,r=this.model;if(a.model.predecessorMapping){if(i={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},(t={}).editMode="cellEdit",t.data=e.data,t.requestType="validateLinkedTask",t.validateMode=i,a._endEditArgs=e,!a._trigger("actionBegin",t)){if(r.enablePredecessorValidation&&("startDate"==e.columnName||"endDate"==e.columnName)&&a.getFormatedDate(e.value)!=a.getFormatedDate(e.previousValue)&&a.model.predecessorMapping&&(e.data.isAutoSchedule||r.validateManualTasksOnLinking)&&!a._validateTypes(t))return;a._triggerEndEdit(e)}}else a._endEditArgs=e,a._triggerEndEdit(e)},_updateScheduleDatesOnEditing:function(e){var i,a,r,n,o,l,d=this,s=this.model,c=d._getValidStartDate(e.data),u=d._getValidEndDate(e.data),p=d._projectStartDate,h=d._getDateFromFormat(s.scheduleEndDate),g=!1,m=s.scheduleStartDate,_=s.scheduleEndDate;if(!t.isNullOrUndefined(e.data._isScheduledTask(e.data))&&s.scheduleHeaderSettings.updateTimescaleView)if(e.data.hasChildRecords&&!e.data.isAutoSchedule&&(c=d._getDateFromFormat(e.data.manualStartDate),u=d._getDateFromFormat(e.data.manualEndDate)),d._calculateDatesForScheduleCheck(c),s.predecessorMapping)(l={}).onEditing=!0,d._calculateScheduleDates(l),d._calculateDatesForScheduleCheck(l.minStartDate),-1==d._compareDates(l.minStartDate,p)&&(m=e.data._getFormatedDate(l.minStartDate,s.dateFormat,s.locale),g=!0),1==d._compareDates(l.maxEndDate,h)&&(_=e.data._getFormatedDate(l.maxEndDate,s.dateFormat,s.locale),g=!0),g&&d.updateScheduleDates(m,_);else{if(-1==d._compareDates(c,p)?(i=c,p=c):1==d._compareDates(c,h)&&(a=c,h=c),-1==d._compareDates(u,p)?i=u:1==d._compareDates(u,h)&&(a=u),a&&(g=!0,_=e.data._getFormatedDate(a,s.dateFormat,s.locale)),i&&(g=!0,m=e.data._getFormatedDate(i,s.dateFormat,s.locale)),s.renderBaseline&&e.data.baselineStartDate&&e.data.baselineEndDate){var f=d._getDateFromFormat(e.data.baselineStartDate),w=d._getDateFromFormat(e.data.baselineEndDate);m=d._getDateFromFormat(m),_=d._getDateFromFormat(_);f.getTime()>=m.getTime()&&f.getTime()<=_.getTime()||(f.getTime()<m.getTime()?(r=f,p=f):(n=f,h=f)),w.getTime()>=m.getTime()&&w.getTime()<=_.getTime()||(w.getTime()<m.getTime()?r=w:n=w)}n&&(g=!0,_=e.data._getFormatedDate(n,s.dateFormat,s.locale)),r&&(g=!0,m=e.data._getFormatedDate(r,s.dateFormat,s.locale)),g&&(o=d._updateScheduleDatesByTaskLables(d._getDateFromFormat(m),d._getDateFromFormat(_)),d.updateScheduleDates(e.data._getFormatedDate(o.minStartDate,s.dateFormat,s.locale),e.data._getFormatedDate(o.maxEndDate,s.dateFormat,s.locale)))}},_calculateDatesForScheduleCheck:function(e){var i=this.model.scheduleHeaderSettings.scheduleHeaderType,a=t.Gantt.ScheduleHeaderType;t.isNullOrUndefined(e)||(i==a.Week&&e.setDate(e.getDate()-3),(i==a.Year||i==a.QuarterYear||i==a.HalfYear)&&e.setDate(e.getDate()-5),i==a.Month&&e.setDate(e.getDate()-3),i==a.Day&&e.setHours(e.getHours()-2),i==a.Hour&&e.setMinutes(e.getMinutes()-5))},_updateScheduleDatesByToolBar:function(i){var a=this,r=this.model,n="prevTimeSpan"===i?a._projectStartDate:a._getDateFromFormat(a.model.scheduleStartDate),o=a._getDateFromFormat(a.model.scheduleEndDate),l=e("#ejGanttChart"+a._id).ejGanttChart("instance"),d=r.scheduleHeaderSettings.scheduleHeaderType,s=t.Gantt.ScheduleHeaderType,c=0;l._isCalendarExist=null,d==s.Week&&("prevTimeSpan"===i?n.setDate(n.getDate()-6):o.setDate(o.getDate()+7)),(d==s.Year||d==s.QuarterYear||d==s.HalfYear)&&("prevTimeSpan"===i?n.setDate(n.getDate()-360):o.setDate(o.getDate()+365)),d==s.Month&&("prevTimeSpan"===i?n.setMonth(n.getMonth()-1):o.setDate(o.getDate()+30)),d==s.Day&&("prevTimeSpan"===i?n.setDate(n.getDate()-1):o.setDate(o.getDate()+1)),d==s.Hour&&("prevTimeSpan"===i?n.setHours(n.getHours()-1):o.setHours(o.getHours()+1)),"prevTimeSpan"===i?(a.updateScheduleDates(a._getFormatedDate(n,r.dateFormat,r.locale),a._getFormatedDate(o,r.dateFormat,r.locale)),l._$bodyContainer.ejScroller("scrollX",0,!0),1==a.isCriticalPathEnable&&r.predecessorMapping&&a._$ganttchartHelper.ejGanttChart("criticalConnectorLine",a.criticalPathCollection,a.detailPredecessorCollection,!0,a.collectionTaskId)):"nextTimeSpan"===i&&(a.updateScheduleDates(a._getFormatedDate(n,r.dateFormat,r.locale),a._getFormatedDate(o,r.dateFormat,r.locale)),c=l.getMaxScrollWidth(),l._$bodyContainer.ejScroller("scrollX",c,!0),1==a.isCriticalPathEnable&&r.predecessorMapping&&a._$ganttchartHelper.ejGanttChart("criticalConnectorLine",a.criticalPathCollection,a.detailPredecessorCollection,!0,a.collectionTaskId))},_rowDataBound:function(e){this._trigger("rowDataBound",e)},_refreshToolBar:function(){e("#"+this._id+"_toolbarItems").find("li").removeClass("e-hover")},_toolBarClick:function(t){this.model;var a=e(this.itemsContainer).closest(".e-gantt"),r=a.ejGantt("instance"),n=a.attr("id"),o=e("#"+r._id+"_toolbarItems");if(r._clearContextMenu(),t.event==i&&"INPUT"==t.target.tagName&&t.currentTarget.id==n+"_search")return!1;-1!=r.model.dateFormat.toLowerCase().indexOf("hh")?e.isFunction(e.fn.ejDateTimePicker)&&e("#"+n+"EditForm").find(".e-datetimepicker").ejDateTimePicker("hide"):e.isFunction(e.fn.ejDatePicker)&&e("#"+n+"EditForm").find(".e-datepicker").ejDatePicker("hide");var l=t.currentTarget,d=(t.target,{itemName:t.text,currentTarget:l,model:r.model});if(a.ejGantt("instance")._trigger("toolbarClick",d))return!1;switch(e(o).ejToolbar("deselectItem",t.currentTarget),t.currentTarget.id){case n+"_excelExport":r._toolbarOperation(n+"_excelExport");break;case n+"_pdfExport":r._toolbarOperation(n+"_pdfExport");break;case n+"_add":r._toolbarOperation(n+"_add");break;case n+"_edit":r._toolbarOperation(n+"_edit");break;case n+"_delete":r._toolbarOperation(n+"_delete");break;case n+"_update":r._toolbarOperation(n+"_update");break;case n+"_cancel":r._toolbarOperation(n+"_cancel");break;case n+"_search":r._toolbarOperation(n+"_search",e(t.currentTarget).find("input").val());break;case n+"_indent":r._toolbarOperation(n+"_indent");break;case n+"_outdent":r._toolbarOperation(n+"_outdent");break;case n+"_expandAll":r._toolbarOperation(n+"_expandAll");break;case n+"_criticalPath":r._enableDisableCriticalIcon?r._enableDisableCriticalIcon&&r._toolbarOperation(n+"_criticalDisable"):r._toolbarOperation(n+"_criticalEnable");break;case n+"_collapseAll":r._toolbarOperation(n+"_collapseAll");break;case n+"_prevTimeSpan":r._toolbarOperation(n+"_prevTimeSpan");break;case n+"_nextTimeSpan":r._toolbarOperation(n+"_nextTimeSpan")}return!1},_toolbarOperation:function(t,i){var a,r=this.element,n=r.ejGantt("instance"),o=r.attr("id"),l=this;l.selectedRowIndex();switch(n._exportTo=n.export,a=e("#"+l._id+"_toolbarItems"),t){case o+"_add":l._sendAddRequest();break;case o+"_edit":l._sendEditRequest();break;case o+"_delete":l._$treegridHelper.ejTreeGrid("deleteRow"),l._isRefreshAddedRecord=!1;break;case o+"_update":l._$treegridHelper.ejTreeGrid("endEdit"),-1!==l.model.toolbarSettings.toolbarItems.indexOf("cancel")&&l._disabledToolItems.push(e(a).find(".e-cancel").parent()[0]),-1!==l.model.toolbarSettings.toolbarItems.indexOf("update")&&l._disabledToolItems.push(e(a).find(".e-saveitem").parent()[0]),e(a).ejToolbar("disableItem",l._disabledToolItems),l._disabledToolItems=[];break;case o+"_cancel":l._$treegridHelper.ejTreeGrid("cancelEditCell"),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_criticalEnable":l.showCriticalPath(!0),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_criticalDisable":l.showCriticalPath(!1),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_search":l.cancelEditCell(),l._searchString!=i&&(l._$treegridHelper.ejTreeGrid("search",i),l.clearSelection(),l._clearMultiSelectPopup(),l._searchString=i,l.updateSelectedItemIndex(),l._updateToolbarOptions(),l._isRefreshAddedRecord=!1);break;case o+"_indent":l._sendIndentRequest(),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement"),l._isRefreshAddedRecord=!1;break;case o+"_outdent":l._sendOutdentRequest(),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement"),l._isRefreshAddedRecord=!1;break;case o+"_expandAll":l._expandAll(),l.updateSelectedItemIndex(),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_collapseAll":l._collapseAll(),l.updateSelectedItemIndex(),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_prevTimeSpan":l._updateScheduleDatesByToolBar("prevTimeSpan"),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_nextTimeSpan":l._updateScheduleDatesByToolBar("nextTimeSpan"),l._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case o+"_excelExport":l._exportTo(n.model.exportToExcelAction,"excelExporting",n.model.allowMultipleExporting);break;case o+"_pdfExport":l._exportTo(n.model.exportToPdfAction,"pdfExporting",n.model.allowMultipleExporting)}return l._refreshToolBar(),!1},updateSelectedItemIndex:function(){var e,i=this,a=this.model,r=a.updatedRecords;a.selectedItems.length>1||(a.allowSelection&&!t.isNullOrUndefined(this.selectedItem())?i.getExpandStatus(this.selectedItem())?(e=r.indexOf(this.selectedItem()),i.selectRows(e)):i.selectRows(-1):a.allowSelection||t.isNullOrUndefined(this.selectedItem())||i.selectRows(-1))},clearSelection:function(e){var t,i=this,a=i.model;a.selectedCellIndexes=[],i._$treegridHelper.ejTreeGrid("clearSelection",e),i._$ganttchartHelper.ejGanttChart("clearSelection",e),t=i._$treegridHelper.ejTreeGrid("instance"),a.selectedItems=t.model.selectedItems,i.selectedItem(t.model.selectedItem),i.selectedRowIndex(t.model.selectedRowIndex),i._clearMultiSelectPopup()},selectCells:function(e,t){var i=this.model;"cell"==i.selectionMode&&i.allowSelection&&this._$treegridHelper.ejTreeGrid("selectCells",e,t)},selectRows:function(e){var i,a=this,r=this.model;"cell"!=r.selectionMode&&(-1!==e&&!t.isNullOrUndefined(e)&&e<r.updatedRecords.length?((i={}).recordIndex=e,i.data=r.updatedRecords[i.recordIndex],i.target="ejTreeGrid",a.rowSelecting(i)&&(a._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex),a.rowSelected(i))):-1===e&&(a._deSelectRowItem(),a._updateToolbarOptions()))},_setModel:function(i){var a,r,n,o,l,d=this,s=d.model;for(a in i)switch(a){case"sortSettings":d._sendSortingRequest(i[a]);break;case"allowSorting":d._sortingRequest(i[a]),s.showColumnChooser&&s.showColumnOptions&&d._$treegridHelper.ejTreeGrid("columnAddDialogTemplate");break;case"allowMultiSorting":s.allowMultiSorting=i[a],d._$treegridHelper.ejTreeGrid("model.allowMultiSorting",s.allowMultiSorting);break;case"destroy":d.destroy();break;case"treeColumnIndex":d._columnIndex(i[a]);break;case"allowGanttChartEditing":d._ganttChartEditing(i[a]);break;case"enableProgressBarResizing":d._resizeProgressbar(i[a]);break;case"enableTaskbarTooltip":d._showTooltip(i[a]);break;case"enableTaskbarDragTooltip":d._showEditingTooltip(i[a]);break;case"validateManualTasksOnLinking":s.validateManualTasksOnLinking=i[a];break;case"enableAltRow":d._updateAltRow(i[a]);break;case"locale":s.flatRecords=[],s.parentRecords=[],d._clearContextMenu(),s.locale=i[a],s.isRerender=!0,d.element.ejGantt("destroy").ejGantt(s);break;case"allowSelection":s.allowSelection=i[a],s.allowSelection?(d._$treegridHelper.ejTreeGrid("instance").model.allowSelection=!0,d._$ganttchartHelper.ejGanttChart("instance").model.allowSelection=!0):(d._deSelectRowItem(),d._$treegridHelper.ejTreeGrid("instance").model.allowSelection=!1,d._$ganttchartHelper.ejGanttChart("instance").model.allowSelection=!1),d._updateToolbarOptions();break;case"editSettings":e.extend(s.editSettings,i[a]),d._updateEditSettings(i[a]),d._initiateDialogTemplates(),d._enableEditingEvents(),this.cancelEditCell(),d._$treegridHelper.ejTreeGrid("setModel",{editSettings:{showDeleteConfirmDialog:s.editSettings.showDeleteConfirmDialog}});break;case"taskbarBackground":d._updateTaskbarBackground(i[a]);break;case"progressbarBackground":d._updateProgressbarBackground(i[a]);break;case"parentTaskbarBackground":d._updateParentTaskbarBackground(i[a]);break;case"parentProgressbarBackground":d._updateParentProgressbarBackground(i[a]);break;case"showTaskNames":d._updateRenderTaskNames(i[a]);break;case"leftTaskLabelMapping":d._refreshLeftTaskLabelMapping(i[a]);break;case"rightTaskLabelMapping":d._refreshRightTaskLabelMapping(i[a]);break;case"leftTaskLabelTemplate":d._refreshLeftTaskLabelTemplate(i[a]);break;case"rightTaskLabelTemplate":d._refreshRightTaskLabelTemplate(i[a]);break;case"showProgressStatus":d._updateRendeProgressStatus(i[a]);break;case"showResourceNames":d._updateRenderResourceNames(i[a]);break;case"progressbarHeight":d._updateProgressbarHeight(i[a]);break;case"baselineColor":d._updateBaselineColor(i[a]);break;case"renderBaseline":d._updateRenderBaseline(i[a]);break;case"allowColumnResize":d._updateAllowColumnResize(i[a]);break;case"allowKeyboardNavigation":d._updateAllowKeyboardNavigation(i[a]);break;case"selectedItem":d._updateSelectedItem(i[a]);break;case"dataSource":s.viewType!=t.Gantt.ViewType.HistogramView&&(d._deSelectRowItem(),d._updateToolbarOptions()),this.isProjectViewData&&s.viewType==t.Gantt.ViewType.HistogramView?s.viewType=t.Gantt.ViewType.ProjectView:!1===this.isProjectViewData&&s.viewType==t.Gantt.ViewType.HistogramView&&(s.viewType=t.Gantt.ViewType.ResourceView),this._refreshDataSource(i[a]),d._enableDisableCriticalIcon&&d.showCriticalPath(!0),d._updateScrollerBorder();break;case"readOnly":d._updateReadOnly(i[a]);break;case"showGridCellTooltip":d._updateShowGridCellTooltip(i[a]);break;case"showGridExpandCellTooltip":d._updateShowGridExpandCellTooltip(i[a]);break;case"highlightWeekends":d._updateHighlightWeekends(i[a]);break;case"highlightNonWorkingTime":d._updateHighlightNonWorkingTime(i[a]);break;case"nonWorkingBackground":d._updateNonWorkingBackground(i[a]);break;case"connectorLineBackground":d._updateConnectorLineBackground(i[a]),d._enableDisableCriticalIcon&&d._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId);break;case"connectorlineWidth":d._updateConnectorlineWidth(i[a]),d._enableDisableCriticalIcon&&d._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId);break;case"weekendBackground":d._updateWeekendBackground(i[a]);break;case"scheduleHeaderSettings":for(n in r=i[a])switch(n){case"timescaleUnitSize":d._updateTimescaleUnitSize(r[n]),d._updateScrollerBorder();break;case"scheduleHeaderType":d._changeChartSchedule(r[n]),d._updateScrollerBorder()}break;case"enableContextMenu":s.enableContextMenu=i[a],d._clearContextMenu(),d._off(d.element,"contextmenu",d._rightClick),s.enableContextMenu&&d._on(d.element,"contextmenu",d._rightClick);break;case"enableResize":s.enableResize?(d.model.enableResize=i[a],d._on(e(window),"resize",d.windowResize)):d._off(e(window),"resize",d.windowResize);break;case"isResponsive":s.isResponsive?(d.model.isResponsive=i[a],d._on(e(window),"resize",d.windowResize)):d._off(e(window),"resize",d.windowResize);break;case"selectedRowIndex":-1===this.selectedRowIndex()||""===this.selectedRowIndex()?(d._deSelectRowItem(),d._updateToolbarOptions()):-1!==this.selectedRowIndex()&&!t.isNullOrUndefined(this.selectedRowIndex())&&this.selectedRowIndex()<d.model.updatedRecords.length&&((o={}).recordIndex=d.selectedRowIndex(),o.previousIndex=s.selectedItem?s.updatedRecords.indexOf(s.selectedItem):-1,d.rowSelecting(o)&&((l={}).recordIndex=this.selectedRowIndex(),l.data=d.model.updatedRecords[l.recordIndex],l.target="ejTreeGrid",d._$treegridHelper.ejTreeGrid("selectRows",l.recordIndex),d.rowSelected(l)));break;case"selectedCellIndexes":s.allowSelection&&"cell"==s.selectionMode&&d.selectCells(i[a]);break;case"selectionMode":s.allowSelection&&(d.clearSelection(),d._$treegridHelper.ejTreeGrid("selectRows",-1),d._$ganttchartHelper.ejGanttChart("selectRows",-1),s.selectedItem=null,s.selectionMode=i[a],d._$treegridHelper.ejTreeGrid("option","selectionMode",i[a]),d._$ganttchartHelper.ejGanttChart("option","selectionMode",i[a]),d._updateToolbarOptions(),"multiple"==d.model.selectionType&&"row"==d.model.selectionMode&&(e("#"+this._id+"_selectionpopup").remove(),d._renderMultiSelectionPopup()));break;case"selectionType":s.allowSelection&&(d.clearSelection(),s.selectionType=i[a],d._$treegridHelper.ejTreeGrid("option","selectionType",i[a]),d._$ganttchartHelper.ejGanttChart("option","selectionType",i[a]),"multiple"==d.model.selectionType&&"row"==d.model.selectionMode&&(e("#"+this._id+"_selectionpopup").remove(),d._renderMultiSelectionPopup()));break;case"showColumnChooser":s.showColumnChooser=i[a],d._$treegridHelper.ejTreeGrid("setModel",{showColumnChooser:s.showColumnChooser});break;case"showColumnOptions":s.showColumnOptions=i[a],d._$treegridHelper.ejTreeGrid("setModel",{showColumnOptions:s.showColumnOptions});break;case"splitterPosition":d.setSplitterPosition(d._splitterPosition());break;case"addDialogFields":s.editSettings.allowAdding&&(s.addDialogFields=i[a],d.addDialogTemplate());break;case"dragTooltip":d._$treegridHelper.ejTreeGrid("setModel",{dragTooltip:i[a]});break;case"allowDragAndDrop":s.allowDragAndDrop=i[a],d._$ganttchartHelper.ejGanttChart("updateDragAndDrop",s.allowDragAndDrop),d._$treegridHelper.ejTreeGrid("setModel",{allowDragAndDrop:s.allowDragAndDrop});break;case"editDialogFields":s.editSettings.allowEditing&&(s.editDialogFields=i[a],d.editDialogTemplate());break;case"toolbarSettings":e.extend(d.model.toolbarSettings,i[a]),d._updateToolbar();break;case"holidays":s.holidays=i[a],d._refreshHolidays(),d._updateScrollerBorder();break;case"stripLines":s.stripLines=i[a],d._updateStripLines(),d._updateScrollerBorder();break;case"splitterSettings":e.extend(s.splitterSettings,i[a]),!t.isNullOrUndefined(i[a].index)&&t.isNullOrUndefined(i[a].position)?d.setSplitterIndex(s.splitterSettings.index):d.setSplitterPosition(d.splitterPosition());break;case"enablePredecessorValidation":s.enablePredecessorValidation=i[a];break;case"enableSerialNumber":s.enableSerialNumber=i[a],d._updateSerialColumns(),d._$treegridHelper.ejTreeGrid("model.enableSerialNumber",i[a]),d._$treegridHelper.ejTreeGrid("updateColumns",d._columns);break;case"sizeSettings":this._calculateDimensions(),this.windowResize();break;case"milestoneTemplate":d._milestoneTemplate(i[a]);break;case"taskbarTemplate":d._taskbarTemplate(i[a]);break;case"parentTaskbarTemplate":d._parentTaskbarTemplate(i[a]);break;case"dayWorkingTime":s.dayWorkingTime=i[a].slice(),s.flatRecords=[],s.parentRecords=[],s.updatedRecords=[],s.ids=[],s.scheduleStartDate=s.scheduleStartDate,s.scheduleEndDate=s.scheduleEndDate,d._storedIndex=-1,d._lastInsertedId=-1,d.selectedRowIndex(-1),d._predecessorsCollection=[],d.element.ejGantt("destroy").ejGantt(s);break;case"workUnit":s.workUnit=i[a],this._updateWorkUnit();break;case"resources":d._updateResourcesData(i[a]);break;case"cssClass":this.element.removeClass(d._cssClass).addClass(i[a]),s.toolbarSettings.showToolbar&&e("#"+d._id+"_toolbarItems").ejToolbar("model.cssClass",i[a]),e("#e-ejSpliter"+d._id).data("ejSplitter")&&e("#e-ejSpliter"+d._id).ejSplitter("model.cssClass",i[a]),d._$treegridHelper.ejTreeGrid("model.cssClass",i[a]),d._$ganttchartHelper.removeClass(d._cssClass).addClass(i[a]),d._$ganttchartHelper.ejGanttChart("model.cssClass",i[a]),d.addDialogTemplate(),d.editDialogTemplate(),this._cssClass=i[a];break;case"workWeek":s.workWeek=i[a].slice(),0==s.workWeek.length&&(s.workWeek=["Monday","Tuesday","Wednesday","Thursday","Friday"]),d._getNonWorkingDayIndex(),d._$ganttchartHelper.ejGanttChart("updateWorkWeek",s.workWeek),d._refreshDataSource(s.dataSource);break;case"enableVirtualization":s.enableVirtualization=i[a],d._$treegridHelper.ejTreeGrid("setModel",{enableVirtualization:s.enableVirtualization}),d._updateExpandStatus(),d._totalCollapseRecordCount=d._$treegridHelper.ejTreeGrid("getCollapsedRecordCount"),s.selectedItem&&this.selectedRowIndex(s.updatedRecords.indexOf(s.selectedItem)),d._$ganttchartHelper.ejGanttChart("updateVirtualization",s.enableVirtualization,this._totalCollapseRecordCount),d._refreshConnectorLines(!1,!0,!0)}},_updateResourcesData:function(i){var a,r,n=this,o=n.model,l=-1,d=n.getColumns();o.resources=e.extend(!0,[],i),this._resourceCollection=o.resources,e.each(d,function(e,t){t.mappingName!=o.resourceInfoMapping||(l=e)}),l>-1&&(d[l].dropdownData=o.resources),(r=o.flatRecords.slice()).reverse(),a=t.Gantt.GanttRecord.prototype,e.each(r,function(e,t){t.resourceInfo&&t.resourceInfo.length>0&&(t.resourceInfo=a._setResourceInfo(t.item[o.resourceInfoMapping],o.resourceIdMapping,o.resourceNameMapping,o.resourceUnitMapping,o.resources),n._updateResourceName(t),n._updateResourceRelatedFields(t),t.hasChildRecords?t.isAutoSchedule?n._updateParentItem(t,null,!0):t.isAutoSchedule||n._updateManualParentItem(t,null,!0):n.refreshGanttRecord(t))})},_updateSerialColumns:function(){var i,a,r,n,o,l,d,s,c=this,u=c.model,p=u.columns,h=u.flatRecords;if(u.enableSerialNumber){for(r=h.length,n=0;n<r;n++)(o=h[n]).predecessorsName&&c._$treegridHelper.ejTreeGrid("predecessorToSerialPredecessor",o);e.map(p,function(e){if("taskId"==e.field)return e.visible=!1,!1}),i={field:"serialNumber",headerText:c._columnHeaderTexts.serialNumber,width:40,allowEditing:!1,allowSorting:!1,mappingName:"serialNumber",showInColumnChooser:!1},p.splice(0,0,i),a=p.filter(function(e){return e&&"predecessor"==e.field}),s={field:"serialNumberPredecessor",headerText:c._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:"serialNumberPredecessor",allowCellSelection:!0},p.splice(p.indexOf(a[0]),1,s)}else e.map(p,function(e){if("taskId"==e.field)return e.visible=!0,!1}),l=p.filter(function(e){return e&&"serialNumber"==e.field}),p.splice(p.indexOf(l[0]),1),s=p.filter(function(e){return e&&"serialNumberPredecessor"==e.field}),d={field:"predecessor",headerText:c._columnHeaderTexts.predecessor,width:150,editType:t.Gantt.EditingType.String,mappingName:u.predecessorMapping,allowCellSelection:!0},p.splice(p.indexOf(s[0]),1,d)},_changeChartSchedule:function(e){var i,a,r=this,n=r.model,o=r._getDateFromFormat(n.scheduleStartDate),l=r._getDateFromFormat(n.scheduleEndDate);switch(e){case t.Gantt.ScheduleHeaderType.Week:n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Week,r._perDayWidth=30;break;case t.Gantt.ScheduleHeaderType.Day:n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Day,r._perHourWidth=20,n.workingTimeScale==t.Gantt.workingTimeScale.TimeScale24Hours?r._perDayWidth=24*r._perHourWidth:n.workingTimeScale==t.Gantt.workingTimeScale.TimeScale8Hours&&(r._perDayWidth=24*r._perHourWidth);break;case t.Gantt.ScheduleHeaderType.Month:n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Month,r._perDayWidth=10,r._perWeekWidth=70;break;case t.Gantt.ScheduleHeaderType.Year:n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Year,r._perDayWidth=3,r._perMonthWidth=90;break;case t.Gantt.ScheduleHeaderType.QuarterYear:n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.QuarterYear,r._perDayWidth=1,r._perMonthWidth=30;break;case t.Gantt.ScheduleHeaderType.HalfYear:n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.HalfYear,r._perDayWidth=.5,r._perMonthWidth=15;break;case t.Gantt.ScheduleHeaderType.Hour:if(n.scheduleHeaderSettings.scheduleHeaderType=t.Gantt.ScheduleHeaderType.Hour,i=n.scheduleHeaderSettings.minutesPerInterval,a=t.Gantt.minutesPerInterval,r._perMinuteWidth=20,i)if(i==a.Auto){var d=l-o;d>864e6?(r._minuteInterval=30,r._perDayWidth=48*r._perMinuteWidth):d>6048e5?(r._minuteInterval=15,r._perDayWidth=96*r._perMinuteWidth):d>1728e5?(r._minuteInterval=5,r._perDayWidth=288*r._perMinuteWidth):(r._minuteInterval=1,r._perDayWidth=1440*r._perMinuteWidth)}else i==a.OneMinute?(r._minuteInterval=1,r._perDayWidth=1440*r._perMinuteWidth):i==a.FiveMinutes?(r._minuteInterval=5,r._perDayWidth=288*r._perMinuteWidth):i==a.FifteenMinutes?(r._minuteInterval=15,r._perDayWidth=96*r._perMinuteWidth):i==a.ThirtyMinutes&&(r._minuteInterval=30,r._perDayWidth=48*r._perMinuteWidth)}r._updateModelsWidth(),r.updateScheduleDates(n.scheduleStartDate,n.scheduleEndDate)},_updateWorkUnit:function(){var e,i,a,r=this,n=r.model,o=n.flatRecords,l=r.getCurrentViewData(),d=r._$treegridHelper.ejTreeGrid("instance");for(d.model.workUnit=r._workUnitTexts[n.workUnit],e=0;e<o.length;e++)i=o[e],a=l.indexOf(i),i._updateWorkWithDuration(r),i.parentItem&&r._updateParentItem(i),-1!=a&&t.TreeGrid.refreshRow(d,a)},_resourceDataBindingForSetModel:function(){var e,i,a=this,r=a.model;r.resourceIdMapping.length>0&&r.resources&&r.resources.length>0||r.groupIdMapping&&r.groupIdMapping.length>0&&r.groupCollection&&r.groupCollection.length>0?(a._isFlatResourceData=!0,a._groupCollection=r.groupCollection,a._resourceCollection=r.resources):a._isFlatResourceData=!1,r.resourceIdMapping||(r.resourceIdMapping="eResourceId"),r.groupIdMapping||(r.groupIdMapping="eGroupId"),r.resourceInfoMapping||(r.resourceInfoMapping="eResourceInfo"),null==a.dataSource()&&a.dataSource([]),a.dataSource()instanceof t.DataManager?(e=a._columnToSelect(),a.dataSource().executeQuery(e).done(t.proxy(function(e){a._retrivedData=e.result,a._isFlatResourceData?a._reConstructResourceData(a._retrivedData):a.secondaryDatasource=a._retrivedData,a._createResourceRecords(a.secondaryDatasource),a._refreshGanttWithNewRecords()}))):a.dataSource().length>0||r.resources&&r.resources.length>0?(a._isFlatResourceData?(i=a._reConstructResourceData(a.dataSource()),a._createResourceRecords(i)):a._createResourceRecords(a.dataSource()),a._refreshGanttWithNewRecords()):a._refreshGanttWithNewRecords()},_dataBindingForSetModel:function(){var i,a,r,n,o,l=this,d=l.model;if(null==this.dataSource()&&this.dataSource([]),this.dataSource()instanceof t.DataManager)i=this._columnToSelect(),this.dataSource().executeQuery(i).done(t.proxy(function(t){var i,a,r,n;if(l._retrivedData=t.result,d.taskIdMapping.length>0&&d.parentTaskIdMapping.length>0){for(i=l._retrivedData,a=[],l._taskIds=[],r=0;r<i.length;r++)n=i[r],a.push(e.extend(!0,{},n)),n[d.taskIdMapping]&&l._taskIds.push(n[d.taskIdMapping]);d.childMapping||(d.childMapping="Children"),l._reconstructDatasource(a)}else l.secondaryDatasource=l._retrivedData;l._createGanttRecords(l.secondaryDatasource),l._refreshGanttWithNewRecords()}));else if(this.dataSource().length>0){if(d.taskIdMapping.length>0&&d.parentTaskIdMapping.length>0){for(a=l.dataSource(),r=[],l._taskIds=[],n=0;n<a.length;n++)o=a[n],r.push(e.extend(!0,{},o)),o[d.taskIdMapping]&&l._taskIds.push(o[d.taskIdMapping]);d.childMapping||(d.childMapping="Children"),l._reconstructDatasource(r),l._createGanttRecords(l.secondaryDatasource)}else l._createGanttRecords(this.dataSource());this._refreshGanttWithNewRecords()}else this._refreshGanttWithNewRecords();d.expandStateMapping&&l._collapseRecordOnLoad()},_refreshGanttWithNewRecords:function(){var e,i=this,a=this.model,r={};this._updatePredecessors(),a.predecessorMapping&&a.enablePredecessorValidation&&i._updatedRecordsDateByPredecessor(),t.isNullOrUndefined(this.isProjectViewData)||(this._calculateScheduleDates(),this.updateScheduleDates(a.scheduleStartDate,this.model.scheduleEndDate),this._checkDataManagerUpdate(),(e=i._$treegridHelper.ejTreeGrid("instance"))._isDataManagerUpdate=e.model.dataManagerUpdate.isDataManagerUpdate=i._isDataManagerUpdate,e._jsonData=e.model.dataManagerUpdate.jsonData=i._jsonData,a.viewType=t.Gantt.ViewType.HistogramView,this._checkHistoGramDataBinding()),this._$treegridHelper.ejTreeGrid("setUpdatedRecords",a.flatRecords,a.updatedRecords,a.ids,a.parentRecords,this.dataSource()),this._$treegridHelper.ejTreeGrid("processBindings"),i.model.updatedRecords=i.getUpdatedRecords(),i.model.currentViewData=i.getCurrentViewData(),i._gridRows=i.getRows(),i._totalCollapseRecordCount=i._$treegridHelper.ejTreeGrid("getCollapsedRecordCount"),this._$ganttchartHelper.ejGanttChart("setUpdatedRecords",a.currentViewData,a.updatedRecords,a.flatRecords,a.ids),a.viewType!=t.Gantt.ViewType.HistogramView?(this._calculateScheduleDates(),this.updateScheduleDates(a.scheduleStartDate,this.model.scheduleEndDate)):(i._$ganttchartHelper.ejGanttChart("refreshContainersWidth"),i._$ganttchartHelper.ejGanttChart("refreshHelper",i.model.currentViewData,i.model.updatedRecords,i._totalCollapseRecordCount),i._$ganttchartHelper.ejGanttChart("instance")._$bodyContainer.ejScroller("refresh")),r.requestType=t.TreeGrid.Actions.Refresh,i._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",r),i.model.viewType==t.Gantt.ViewType.ResourceView&&(i._$treegridHelper.ejTreeGrid("updateHeight"),this._updateResourceColumn()),a.viewType!=t.Gantt.ViewType.HistogramView&&(this._checkDataManagerUpdate(),(e=i._$treegridHelper.ejTreeGrid("instance"))._isDataManagerUpdate=e.model.dataManagerUpdate.isDataManagerUpdate=i._isDataManagerUpdate,e._jsonData=e.model.dataManagerUpdate.jsonData=i._jsonData),this._isFromSetModel=!1},_refreshDataSource:function(e){var i=this;this.resetModelCollections(),this.dataSource(e),this._isFromSetModel=!0,i.secondaryDatasource=[],i._retrivedData=this.dataSource(),i.model.viewType==t.Gantt.ViewType.ResourceView?(i._resourceChildTasks=[],i._groupIds=[],i._resourceIds=[],i._resourceCollection=[],i._groupCollection=[],this._resourceUniqTasks=[],this._resourceUniqTaskIds=[],this._resourceDataBindingForSetModel()):this._dataBindingForSetModel()},_updateResourceColumn:function(){for(var e=0;e<this._resourceViewColumns.length;e++)if("resourceInfo"==this._resourceViewColumns[e].field){this._resourceViewColumns[e].mappingName=this.model.resourceInfoMapping,this._resourceViewColumns[e].dropdownData=this._resourceCollection;break}},resetModelCollections:function(){var e=this,t=e.model;t.dataSource=[],t.flatRecords=[],t.parentRecords=[],t.updatedRecords=[],t.ids=[],t.scheduleStartDate=t.scheduleStartDate,t.scheduleEndDate=t.scheduleEndDate,e._storedIndex=-1,e._lastInsertedId=-1,e.selectedRowIndex(-1),e._predecessorsCollection=[],e._serialCount=0},_refreshHolidays:function(){var e,t=this,i=this.model;t._holidaysList=t._getHoliday(),t._stringHolidays=t._getStringHolidays(),(e=t._updateScheduleDatesByHolidays(new Date(t._projectStartDate),new Date(t._projectEndDate))).startDate.getTime()!==t._projectStartDate.getTime()||e.endDate.getTime()!==t._projectEndDate.getTime()?(t._$ganttchartHelper.data("ejGanttChart").model.holidays=i.holidays,t.updateScheduleDates(e.startDate,e.endDate)):(t._isTreeGridRendered=!1,t._isGanttChartRendered=!1,t._updateGanttRecords(),t._$ganttchartHelper.ejGanttChart("refreshHelper",t.model.currentViewData,t.model.updatedRecords,t._totalCollapseRecordCount),i.predecessorMapping&&t._refreshConnectorLines(!1,!0,!0),this._$ganttchartHelper.ejGanttChart("refreshHolidays",i.holidays),t._isTreeGridRendered=!0,t._isGanttChartRendered=!0),t._$treegridHelper.ejTreeGrid("renderRecords")},_updateStripLines:function(){var e,t=this,i=this.model;(e=t._updateScheduleDatesByStripLines(new Date(t._projectStartDate),new Date(t._projectEndDate))).startDate.getTime()!==t._projectStartDate.getTime()||e.endDate.getTime()!==t._projectEndDate.getTime()?(t._$ganttchartHelper.data("ejGanttChart").model.stripLines=i.stripLines,t.updateScheduleDates(e.startDate,e.endDate)):this._$ganttchartHelper.ejGanttChart("refreshStripLines",this.model.stripLines)},_updateWeekendBackground:function(e){this.model.weekendBackground=e,this._$ganttchartHelper.ejGanttChart("updateWeekendBackground",e)},_updateNonWorkingBackground:function(e){this.model.nonWorkingBackground=e,this._$ganttchartHelper.ejGanttChart("updateNonWorkingBackground",e)},_updateHighlightNonWorkingTime:function(e){this.model.highlightNonWorkingTime=e,this._$ganttchartHelper.ejGanttChart("updateHighlightNonWorkingTime",e)},_updateHighlightWeekends:function(e){this.model.highlightWeekends=e,this._$ganttchartHelper.ejGanttChart("updateHighlightWeekends",e)},_updateReadOnly:function(e){var t=this;t._$treegridHelper.ejTreeGrid("updateReadOnly",e),t._$ganttchartHelper.ejGanttChart("updateReadOnly",e),t._updateToolbarOptions()},_updateShowGridCellTooltip:function(e){this._$treegridHelper.ejTreeGrid("updateShowGridCellTooltip",e)},_updateShowGridExpandCellTooltip:function(e){this._$treegridHelper.ejTreeGrid("updateShowGridExpandCellTooltip",e)},_updateSelectedItem:function(e){var t=this,i={};null!=e[t.model.taskIdMapping]&&(i.recordIndex=t.model.ids.indexOf(e[t.model.taskIdMapping].toString()),i.item=t.model.flatRecords[i.recordIndex],i.target="ejTreeGrid",t.rowSelected(i),t._$treegridHelper.ejTreeGrid("selectRows",i.recordIndex),t._$ganttchartHelper.ejGanttChart("selectRows",i.recordIndex),t._$ganttchartHelper.ejGanttChart("updateSelectedItem",i.recordIndex))},_updateAllowKeyboardNavigation:function(e){this._$treegridHelper.ejTreeGrid("updateAllowKeyboardNavigation",e),this._$ganttchartHelper.ejGanttChart("updateAllowKeyboardNavigation",e)},_updateAllowColumnResize:function(e){this._$treegridHelper.ejTreeGrid("updateAllowColumnResize",e)},_updateProgressbarHeight:function(e){this.model.progressbarHeight=e,this._$ganttchartHelper.ejGanttChart("updateProgressbarHeight",e)},_updateBaselineColor:function(e){this.model.baselineColor=e,this._$ganttchartHelper.ejGanttChart("updateBaselineColor",e)},_showBaselineColumns:function(){var e,i,a=this,r=a.model;r.renderBaseline&&r.baselineStartDateMapping&&r.baselineEndDateMapping&&((i=r.baselineStartDateMapping).length&&(e={field:"baselineStartDate",headerText:a._columnHeaderTexts.baselineStartDate,width:150,editType:-1==r.dateFormat.toLowerCase().indexOf("hh")?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,format:"{0:"+r.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},a._columns.push(e)),(i=r.baselineEndDateMapping).length&&(e={field:"baselineEndDate",headerText:a._columnHeaderTexts.baselineEndDate,width:150,editType:-1==r.dateFormat.toLowerCase().indexOf("hh")?t.Gantt.EditingType.DatePicker:t.Gantt.EditingType.DateTimePicker,mappingName:i,format:"{0:"+r.dateFormat+"}",allowEditing:!0,allowCellSelection:!0},a._columns.push(e)))},_updateRenderBaseline:function(e){var t,i,a=this,r=a.model;this.model.renderBaseline=e,a._$ganttchartHelper.ejGanttChart("updateRenderBaseline",e),r.renderBaseline&&(a._showBaselineColumns(),a._trigger("load")),r.renderBaseline||(t=a._getbaselineColumnIndex(a._columns).indexOf("baselineStartDate"),a._columns.splice(t,1),i=a._getbaselineColumnIndex(a._columns).indexOf("baselineEndDate"),a._columns.splice(i,1)),a._$treegridHelper.ejTreeGrid("updateColumns",a._columns)},_getbaselineColumnIndex:function(e){for(var t=[],i=0;i<e.length;i++)t[i]=e[i].field;return t},_updateRenderTaskNames:function(e){this.model.showTaskNames=e,this._$ganttchartHelper.ejGanttChart("updateRenderTaskNames",e)},_refreshLeftTaskLabelMapping:function(e){this.model.leftTaskLabelMapping=e,this._$ganttchartHelper.ejGanttChart("refreshLeftTaskLabelMapping",e)},_refreshRightTaskLabelMapping:function(e){this.model.rightTaskLabelMapping=e,this._$ganttchartHelper.ejGanttChart("refreshRightTaskLabelMapping",e)},_refreshLeftTaskLabelTemplate:function(e){this.model.leftTaskLabelTemplate=e,this._$ganttchartHelper.ejGanttChart("refreshLeftTaskLabelTemplate",e)},_refreshRightTaskLabelTemplate:function(e){this.model.rightTaskLabelTemplate=e,this._$ganttchartHelper.ejGanttChart("refreshRightTaskLabelTemplate",e)},_updateRendeProgressStatus:function(e){this.model.showProgressStatus=e,this._$ganttchartHelper.ejGanttChart("updateRendeProgressStatus",e)},_updateRenderResourceNames:function(e){this.model.showResourceNames=e,this._$ganttchartHelper.ejGanttChart("updateRenderResourceNames",e)},_updateTaskbarBackground:function(e){this.model.taskbarBackground=e,this._$ganttchartHelper.ejGanttChart("updateTaskbarBackground",e)},_updateProgressbarBackground:function(e){this.model.progressbarBackground=e,this._$ganttchartHelper.ejGanttChart("updateProgressbarBackground",e)},_updateParentTaskbarBackground:function(e){this.model.parentTaskbarBackground=e,this._$ganttchartHelper.ejGanttChart("updateParentTaskbarBackground",e)},_updateParentProgressbarBackground:function(e){this.model.parentProgressbarBackground=e,this._$ganttchartHelper.ejGanttChart("updateParentProgressbarBackground",e)},_updateEditSettings:function(e){var t=this;t._$ganttchartHelper.ejGanttChart("updateEditSettings",e),t._$treegridHelper.ejTreeGrid("updateEditSettings",e),t._updateToolbarOptions()},_updateRowSelection:function(e){this._$treegridHelper.ejTreeGrid("updateRowSelection",e)},_updateAltRow:function(e){this._$treegridHelper.ejTreeGrid("option","enableAltRow",e)},_renderAddedRow:function(e,i){var a,r=this,n=this.model;n.currentViewData=r._$treegridHelper.ejTreeGrid("getUpdatedCurrentViewData"),r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",n.currentViewData,n.updatedRecords,n.flatRecords,n.ids),"resourceChildTask"!=i.eResourceTaskType&&(n.enableVirtualization?((a={}).requestType=t.TreeGrid.Actions.Refresh,r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",a),r._$ganttchartHelper.ejGanttChart("refreshHelper",n.currentViewData,n.updatedRecords,r._totalCollapseRecordCount)):(r._$treegridHelper.ejTreeGrid("renderNewAddedRow",e,i),r._$ganttchartHelper.ejGanttChart("renderNewAddedRow",e,i))),r._$treegridHelper.ejTreeGrid("updateHeight"),r._gridRows=r.getRows(),r._ganttChartRows=r.getGanttChartRows()},_getVisibleChildRecordCount:function(e,t,i){var a,r,n;this.model;if(e.hasChildRecords)for(r=(a=e.childRecords).length,n=0;n<r;n++)-1!==i.indexOf(a[n])&&t++,a[n].hasChildRecords&&(t=this._getVisibleChildRecordCount(a[n],t,i));else-1!==i.indexOf(e)&&t++;return t},openAddDialog:function(){this.cancelEditCell(),this._sendAddRequest()},openEditDialog:function(){this.cancelEditCell(),this._sendEditRequest()},searchItem:function(t){var i=this;i.cancelEditCell(),i._searchString!=t&&(i._$treegridHelper.ejTreeGrid("search",t),i._searchString=t,e("#gantt_search input").val(t))},selectMultipleRows:function(e){var i,a,r=this,n=r.model,o=r._$treegridHelper.ejTreeGrid("instance"),l=r._$ganttchartHelper.ejGanttChart("instance");if("cell"!=n.selectionMode&&n.selectionType!=t.Gantt.SelectionType.Single&&!t.isNullOrUndefined(e)){for(0!=e.length&&r.clearSelection(),i=r.getUpdatedRecords(),a=0;a<e.length;a++)!t.isNullOrUndefined(i[e[a]])&&(!n.enableVirtualization&&r.getExpandStatus(i[e[a]])||n.enableVirtualization)&&(o._rowSelectingEventTrigger(this.selectedRowIndex(),e[a])||(l._multiSelectCtrlRequest=o._multiSelectCtrlRequest=!0,r._$treegridHelper.ejTreeGrid("selectRows",e[a]),o._rowSelectedEventTrigger(e[a])));l._multiSelectCtrlRequest=o._multiSelectCtrlRequest=!1}},addRecord:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T=this,x=this.model,v="row"==x.selectionMode?this.selectedRowIndex():T._rowIndexOfLastSelectedCell,b=x.updatedRecords[v],S=x.taskIdMapping,D=x.updatedRecords,R=x.flatRecords,y=x.parentRecords,I=x.ids,k=this.dataSource(),M=0,E={};if(T.clearSelection(),T.cancelEditCell(),"array"===e.type(k)||k instanceof t.DataManager||(this.dataSource([]),k=this.dataSource()),"[object Object]"!==Object.prototype.toString.call(i)&&(i={}),(-1!==v||a!==t.Gantt.RowPosition.AboveSelectedRow&&a!==t.Gantt.RowPosition.BelowSelectedRow&&a!==t.Gantt.RowPosition.Child)&&a||(a=t.Gantt.RowPosition.Top),x.viewType==t.Gantt.ViewType.ResourceView&&a!==t.Gantt.RowPosition.Top&&a!==t.Gantt.RowPosition.Bottom&&(a=t.Gantt.RowPosition.Top),i[S]&&(l="projectView"==x.viewType?x.ids:this._resourceUniqTaskIds,i[S]=-1==l.indexOf(i[S].toString())||this._isOnResourceUpdate?isNaN(parseInt(i[S]))?null:parseInt(i[S]):null),T._updateAddData(i,a),T._isDataManagerUpdate&&(T._jsonData=T._$treegridHelper.ejTreeGrid("getUpdatedDataManagerData")),x.viewType==t.Gantt.ViewType.ResourceView&&i[x.resourceInfoMapping]&&i[x.resourceInfoMapping].length>0){for(r=T._createGanttRecord(i,1),s=(d=i[x.resourceInfoMapping]).length,c=0;c<s;c++)(u=R[I.indexOf("R_"+d[c])])&&(p=new t.Gantt.GanttRecord,(p=e.extend(!0,p,r)).item=r.item,0==c&&this._updateResourceUniqIndex(p),p.eResourceTaskType="resourceChildTask",p.level=u.level,p.parentItem=u,u.eResourceChildTasks.push(p),this._resourceChildTasks.push(p),this._updateOverlappingValues(p.parentItem),this._updateResourceParentItem(p),T.refreshGanttRecord(p.parentItem),this._updateSharedResourceTask(p),c==s-1&&(T._isDataManagerUpdate&&this._isFlatResourceData?this._jsonData.push(p.item):T._isFlatResourceData?k.push(p.item):u.item[x.taskCollectionMapping].push(p.item),this._refreshGanttHeightWithRecords()));r=p||r}else switch(a){case t.Gantt.RowPosition.Top:if(M=0,o=null,r=T._createGanttRecord(i,M),x.viewType==t.Gantt.ViewType.ResourceView&&(r.eResourceName=this._unassignedText,r.eResourceTaskType="unassignedTask",this._updateResourceUniqIndex(r)),r.index=r.taskId,E.data=i,E.currentRecord=r,!T._validateAddRecordPrecessorValue(E)&&T._isinAddnewRecord)return!1;R.splice(0,0,r),D.splice(0,0,r),I.splice(0,0,r.taskId.toString()),y.splice(0,0,r),T._isDataManagerUpdate?T._jsonData.splice(0,0,r.item):k.splice(0,0,r.item),n=0;break;case t.Gantt.RowPosition.Bottom:if(M=0,o=null,r=T._createGanttRecord(i,M),x.viewType==t.Gantt.ViewType.ResourceView&&(r.eResourceName=this._unassignedText,r.eResourceTaskType="unassignedTask",this._updateResourceUniqIndex(r)),r.index=r.taskId,E.data=i,E.currentRecord=r,!T._validateAddRecordPrecessorValue(E)&&T._isinAddnewRecord)return!1;R.push(r),D.push(r),I.push(r.taskId.toString()),y.push(r),T._isDataManagerUpdate?T._jsonData.push(r.item):k.push(r.item),n=D.indexOf(r);break;case t.Gantt.RowPosition.AboveSelectedRow:if(M=b.level,o=b.parentItem,(r=T._createGanttRecord(i,M,o)).index=r.taskId,E.data=i,E.currentRecord=r,!T._validateAddRecordPrecessorValue(E)&&T._isinAddnewRecord)return!1;g=R.indexOf(b),m=D.indexOf(b),R.splice(g,0,r),D.splice(m,0,r),I.splice(g,0,r.taskId.toString()),t.isNullOrUndefined(o)?(y.splice(y.indexOf(b),0,r),T._isDataManagerUpdate?T._jsonData.splice(T._jsonData.indexOf(b.item),0,r.item):k.splice(k.indexOf(b.item),0,r.item)):(h=o.childRecords.indexOf(b),o.childRecords.splice(h,0,r),x.parentTaskIdMapping?(r.item[x.parentTaskIdMapping]=r.parentItem.taskId,T._isDataManagerUpdate?T._jsonData.push(r.item):k.push(r.item)):o.item[x.childMapping].splice(h,0,r.item)),n=m;break;case t.Gantt.RowPosition.BelowSelectedRow:if(M=b.level,o=b.parentItem,(r=T._createGanttRecord(i,M,o)).index=r.taskId,E.data=i,E.currentRecord=r,!T._validateAddRecordPrecessorValue(E)&&T._isinAddnewRecord)return!1;_=R.indexOf(b),b.hasChildRecords?(g=_+T._$treegridHelper.ejTreeGrid("getChildCount",b,0)+1,m=D.indexOf(b)+T._getVisibleChildRecordCount(b,0,D)+1):(g=_+1,m=D.indexOf(b)+1),R.splice(g,0,r),D.splice(m,0,r),I.splice(g,0,r.taskId.toString()),t.isNullOrUndefined(o)?(y.splice(y.indexOf(b)+1,0,r),T._isDataManagerUpdate?T._jsonData.splice(T._jsonData.indexOf(b.item)+1,0,r.item):k.splice(k.indexOf(b.item)+1,0,r.item)):(h=o.childRecords.indexOf(b),o.childRecords.splice(h+1,0,r),x.parentTaskIdMapping?(r.item[x.parentTaskIdMapping]=r.parentItem.taskId,T._isDataManagerUpdate?T._jsonData.push(r.item):k.push(r.item)):o.item[x.childMapping].splice(h+1,0,r.item)),n=m;break;case t.Gantt.RowPosition.Child:if(M=b.level+1,o=b,(r=T._createGanttRecord(i,M,o)).index=r.taskId,E.data=i,E.currentRecord=r,!T._validateAddRecordPrecessorValue(E)&&T._isinAddnewRecord)return!1;_=R.indexOf(b),b.hasChildRecords?(g=_+T._$treegridHelper.ejTreeGrid("getChildCount",b,0)+1,b.expanded||((f={}).expanded=!0,f.data=b,T._isInAdd=!0,T.expanding(f),T._isInAdd=!1,D=T.getUpdatedRecords()),m=D.indexOf(b)+T._getVisibleChildRecordCount(b,0,D)+1):(b.hasChildRecords=!0,b.childRecords=[],b.expanded=!0,x.parentTaskIdMapping||(b.item[x.childMapping]=[]),b.isMilestone=!1,g=_+1,m=D.indexOf(b)+1,b.predecessor&&T._updatePredecessorOnIndentOutdent(b)),R.splice(g,0,r),D.splice(m,0,r),I.splice(g,0,r.taskId.toString()),t.isNullOrUndefined(o)||(h=o.childRecords.indexOf(b),o.childRecords.splice(h+1,0,r),x.parentTaskIdMapping?(r.item[x.parentTaskIdMapping]=r.parentItem.taskId,T._isDataManagerUpdate?T._jsonData.push(r.item):k.push(r.item)):o.item[x.childMapping].splice(h+1,0,r.item)),n=m}return T._deSelectRowItem(),T._$treegridHelper.ejTreeGrid("setUpdatedRecords",x.flatRecords,x.updatedRecords,x.ids,x.parentRecords,this.dataSource()),x.enableWBS&&"projectView"==x.viewType&&T.updateWBSdetails(r),"projectView"==x.viewType&&(T._$treegridHelper.ejTreeGrid("updateSerialNumber",n),x.enableSerialNumber&&T._$treegridHelper.ejTreeGrid("updateSerialNumberPredecessors",n)),(w={}).requestType="save",w._cAddedRecord=w.addedRecord=r,w.index=n,T.actionComplete(w),C=T._$treegridHelper.ejTreeGrid("instance"),!1===x.enableVirtualization&&(C.model.sortSettings.sortedColumns.length>0||C._searchString.length>0)&&(T._isRefreshAddedRecord=!0),"cell"==x.selectionMode?(v=x.updatedRecords.indexOf(r),T._$treegridHelper.ejTreeGrid("updateScrollBar",v)):T._$treegridHelper.ejTreeGrid("updateScrollBar"),!0},updateWBSdetails:function(e,t,i){var a,r,n,o,l,d,s,c=this,u=c.model,p=e||("row"==u.selectionMode?u.selectedItem:u.updatedRecords[c._rowIndexOfLastSelectedCell]),h=p.WBS;p.parentItem?(r=(a=p.parentItem.childRecords).indexOf(p),l=(o=a).length):u.flatRecords.length&&(r=(o=u.flatRecords.filter(function(e){return e&&0==e.level})).indexOf(p),l=o.length),(n=t?o.slice(r,l):o.slice(r+1,l)).length&&(d=-1!=h.lastIndexOf(".")?parseInt(h.substr(h.lastIndexOf(".")+1)):parseInt(h),s=p.parentItem?p.parentItem.WBS:null,t&&!i?d--:t&&i?d=d:d++,c.reCalculateWBS(n,d,s))},deleteItem:function(){this.cancelEditCell(),this._$treegridHelper.ejTreeGrid("deleteRow")},expandAllItems:function(){this.cancelEditCell(),this._expandAll(),this.updateSelectedItemIndex(),this._$treegridHelper.focus()},collapseAllItems:function(){this._collapseAll(),this.updateSelectedItemIndex(),this._$treegridHelper.focus()},indentItem:function(){var e,t,i=this.model,a=this.model.flatRecords,r=i.selectedItem,n=!0;return 0==i.editSettings.allowIndent||"cell"==i.selectionMode&&"single"!=i.selectionType||(r&&1==i.selectedItems&&(0===(e=a.indexOf(r))?n=!1:0===r.level?n=!0:(t=a[e-1],n=r.level-t.level!=1)),!!n&&void this._sendIndentRequest())},outdentItem:function(){if("cell"==this.model.selectionMode&&"single"!=this.model.selectionType)return!0;this._sendOutdentRequest()},updateGanttColumns:function(e){this.model.columns=e,this._columns=e},cancelEdit:function(){this.sendCancelRequest()},expandCollapseRecord:function(i){var a,r,n,o=this,l={},d=this.model;a=d.flatRecords[d.ids.indexOf(i.toString())],!t.isNullOrUndefined(a)&&a.hasChildRecords&&((l={}).expanded=1!=a.expanded,o.getExpandStatus(a)?(l.data=a,l.expanded?o.expanding(l):o.collapsing(l)):(a.expanded=l.expanded,-1==(r=d.currentViewData.indexOf(a))||d.enableVirtualization||(n=e(o.getRows()[r]),a.expanded?(n.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),n.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")):(n.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),n.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse")))))},saveEdit:function(){this._$treegridHelper.ejTreeGrid("endEdit")},setSplitterIndex:function(t){var i,a=this,r=a.model,n=a.getColumns(),o=0,l=e("#ejTreeGrid"+a._id+"e-gridcontent"),d=parseInt(t),s=n.filter(function(e){return 0!=e.visible});if(d>-1&&d<s.length){for(i=0;i<=d;i++)o+=s[i].width;if(o>a._ganttWidth)for(o=0,i=0;i<=d;i++){if(!(o+s[i].width<=a._ganttWidth)){r.splitterSettings.index=t;break}o+=s[i].width,t=i}else r.splitterSettings.index=d;l.ejScroller("isHScroll")&&l.ejScroller("scrollLeft",0),a.setSplitterPosition(o.toString())}},setSplitterPosition:function(i){var a,r,n,o=this,l=(o.model,0),d=0,s=parseInt(o._ganttWidth)-o._totalBorderWidth,c=!1,u=o.splitterPosition();t.isNullOrUndefined(i)||(-1!=i.indexOf("%")?(l=parseInt(i),c=!0):(l=parseInt(i)/o._ganttWidth*100,c=!1),(l=isNaN(l)?0:l)<=100?((d=100-(l=l<0?0:l)-900/s)<=0?(c?o.splitterPosition("100%"):o.splitterPosition(s.toString()),l=100-900/s,d=0):d>0&&(c?o.splitterPosition(Math.round(l)+"%"):o.splitterPosition(Math.round(l*o._ganttWidth/100).toString())),(a=e("#e-ejSpliter"+o._id).ejSplitter("instance")).model.properties[0].paneSize=l+"%",a.model.properties[1].paneSize=d+"%",a.refresh(),o._$treegridHelper.ejTreeGrid("refreshScroller",Math.round(l*s/100)),r=parseFloat(a.model.properties[1].paneSize)>0?a.model.properties[1].paneSize-1:0,o._$ganttchartHelper.ejGanttChart("refreshScroller",r),o._clearContextMenu(),o._updateScrollerBorder()):(l=(a=e("#e-ejSpliter"+o._id).ejSplitter("instance")).model.properties[0].paneSize,d=a.model.properties[1].paneSize,0==parseInt(d)?c?o.splitterPosition("100%"):o.splitterPosition(s.toString()):c?o.splitterPosition(Math.round(parseInt(l)/s*100)+"%"):o.splitterPosition(l.toString())),o._splitterPosition(o.splitterPosition()),0==o._splitterOnResize&&(n={prevSplitterPosition:u,isOnResize:!1,currentSplitterPosition:o.splitterPosition()},o._trigger("splitterResized",n)))},_updateScrollerBorder:function(){var t,i=this,a=e("#ejTreeGrid"+this._id+"e-gridcontent").data("ejScroller"),r=e("#ganttviewerbodyContianerejGanttChart"+this._id),n=e("#ganttviewerbodyContianerejGanttChart"+this._id).data("ejScroller"),o=!1,l=!1,d=e("#ejTreeGrid"+this._id+"e-gridcontent");e("#ganttviewerbodyContianerejGanttChart"+this._id).find("div.e-content");a&&a.isHScroll()&&(o=!0),n&&n.isHScroll()&&(l=!0),d.removeClass("e-borderbox"),r.removeClass("e-borderbox"),t=i._$ganttchartHelper.ejGanttChart("getViewportHeight"),o&&!l?(d.removeClass("e-borderbox"),r.addClass("e-borderbox"),n.option("height",t-18),r.height(t-16),i._$ganttchartHelper.ejGanttChart("setViewPortHeight")):!o&&l?(d.addClass("e-borderbox"),r.removeClass("e-borderbox"),n.option("height",t),r.height(t),i._$ganttchartHelper.ejGanttChart("updateViewPortHeight")):o&&l?(n.option("height",t),r.height(t),i._$ganttchartHelper.ejGanttChart("updateViewPortHeight")):o||l||(n.option("height",t),r.height(t))},_showTooltip:function(e){this.model.enableTaskbarTooltip=e,this._$ganttchartHelper.ejGanttChart("showTooltip",e)},_showEditingTooltip:function(e){this.model.enableTaskbarDragTooltip=e,this._$ganttchartHelper.ejGanttChart("showEditingTooltip",e)},_ganttChartEditing:function(t){this.model.allowGanttChartEditing=t,this._$ganttchartHelper.ejGanttChart("ganttChartEditing",t),t?(e(".e-gantt-childtaskbar, .e-tasklabel, .progressbar").css({cursor:"move"}),e(".taskbarresizer-right").css({cursor:"w-resize"}),e(".taskbarresizer-left").css({cursor:"e-resize"})):e(".e-gantt-childtaskbar, .e-tasklabel, .progressbar, .taskbarresizer-right, .taskbarresizer-left").css({cursor:"auto"})},_resizeProgressbar:function(e){this.model.enableProgressBarResizing=e,this._$ganttchartHelper.ejGanttChart("resizeProgressbar",e)},_milestoneTemplate:function(e){var t=this;t.model.milestoneTemplate=e,t._$ganttchartHelper.ejGanttChart("changeMilestoneTemplate",t.model.milestoneTemplate)},_taskbarTemplate:function(e){var t=this;t.model.taskbarTemplate=e,t._$ganttchartHelper.ejGanttChart("changeTaskbarTemplate",t.model.taskbarTemplate)},_parentTaskbarTemplate:function(e){var t=this;t.model.parentTaskbarTemplate=e,t._$ganttchartHelper.ejGanttChart("changeParentTaskbarTemplate",t.model.parentTaskbarTemplate)},_sendSortingRequest:function(e){this.model.sortSettings=e,this._$treegridHelper.ejTreeGrid("option","sortSettings",e)},_sortingRequest:function(e){var t=this.model;t.allowSorting=e,t.allowSorting||(t.sortSettings.sortedColumns=[]),this._$treegridHelper.ejTreeGrid("sortSetting",e)},_columnIndex:function(e){this._$treegridHelper.ejTreeGrid("columnIndex",e)},sendCancelRequest:function(){var t=this,i=e("#"+t._id+"_toolbarItems");t._$treegridHelper.ejTreeGrid("cancelEditCell"),-1!==t.model.toolbarSettings.toolbarItems.indexOf("cancel")&&t._disabledToolItems.push(e(i).find(".e-cancel").parent()[0]),-1!==t.model.toolbarSettings.toolbarItems.indexOf("save")&&t._disabledToolItems.push(e(i).find(".e-saveitem").parent()[0]),e(i).ejToolbar("disableItem",t._disabledToolItems),t._disabledToolItems=[]},_sendAddRequest:function(){var e=this,i=e.model.viewType==t.Gantt.ViewType.ProjectView?e._columns:e._resourceViewColumns,a=i.length,r=0,n={},o={};for(e._clearMultiSelectPopup();r<a;r++)i[r].mappingName&&(n[i[r].mappingName]="");o.data=n,o.requestType="add",e.renderedEditDialog(o)},_sendEditRequest:function(i,a){var r,n=this,o=n.model,l={};n._clearMultiSelectPopup(),a&&a.isResourceView?l.data=a.data:(t.isNullOrUndefined(i)?(n._currentTrIndex="row"==o.selectionMode?this.selectedRowIndex():n._rowIndexOfLastSelectedCell,n._$currentTr=e(n._$treegridHelper.ejTreeGrid("getRows")).eq(this.selectedRowIndex())):(n._currentTrIndex=i.index(),n._$currentTr=i),r=n.getUpdatedRecords()[n._currentTrIndex],l.data=r),!("row"==o.selectionMode&&1!=o.selectedItems.length||"cell"==o.selectionMode&&1!=o.selectedCellIndexes.length)&&(l.requestType="beginedit",l.data&&n.renderedEditDialog(l))},_updateAddData:function(e,i){var a,r,n=this,o=this.model;e[o.taskIdMapping]||(a=n._getNewTaskId(),e[o.taskIdMapping]=a),o.taskNameMapping&&!e[o.taskNameMapping]&&(e[o.taskNameMapping]=n._newTaskTexts.newTaskName+" "+e[o.taskIdMapping]),o.allowUnscheduledTask||e[o.startDateMapping]||(e[o.startDateMapping]=o.scheduleStartDate),!o.allowUnscheduledTask&&o.durationMapping&&t.isNullOrUndefined(e[o.durationMapping])&&(e[o.endDateMapping]||(e[o.durationMapping]="5")),o.progressMapping&&(e[o.progressMapping]=e[o.progressMapping]?e[o.progressMapping]>100?100:e[o.progressMapping]:0),o.allowUnscheduledTask||e[o.endDateMapping]||!o.endDateMapping||e[o.durationMapping]||((r=n._getDateFromFormat(o.scheduleStartDate)).setDate(r.getDate()+4),e[o.endDateMapping]=t.format(r,this.model.dateFormat,this.model.locale)),o.enableWBS&&!e.WBS&&(e.WBS=n._getNewWBSid(i)),o.enableWBS&&!e.WBS&&(e.WBS=n._getNewWBSid(i)),t.isNullOrUndefined(o.selectedItem)||(e.taskType=o.workMapping?t.Gantt.TaskType.FixedWork:o.selectedItem.taskType,e.effortDriven=o.workMapping?"true":o.selectedItem.effortDriven)},_sendSaveRequest:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T,x,v,b,S,D,R,y,I,k,M,E,H,P,F={},O=document,G=this,L=G.model,N={},W=this._resourceCollection;if(this._duplicate=!1,this._wrongenddate=!1,"Add"===i){if((a=O.querySelectorAll("#"+G._id+"GeneralAddForm","#"+G._id+"PredecessorAddForm","#"+G._id+"ReosurceAddForm","#"+G._id+"CustomFieldsAddForm"))&&a.length,d="Add",s="#treegrid"+G._id+"predecessorAdd",c="#treegrid"+G._id+"resourceAdd",u="#treegrid"+G._id+"customFieldAdd",p="#"+G._id+"AddAreaNotes",r=e("#"+G._id+"taskId"+d),o=t.TreeGrid.getColumnByField(G._columns,"taskId"),G._cellEditColumn=o,g=(h=G._addDialogGeneralColumns).length,_=(m=G._addDialogCustomColumns).length,o&&r.length>0&&(l=G.getCurrentEditCellData(r,o.dropdownData)),-1!=G.model.ids.indexOf(l)&&l?this._duplicate=!0:l&&(this._duplicate=!1),!this.addFormValidate())return!0}else if((a=O.getElementById(G._id+"GeneralEditForm"))&&a.length,s="#treegrid"+G._id+"predecessorEdit",c="#treegrid"+G._id+"resourceEdit",u="#treegrid"+G._id+"customFieldEdit",p="#"+G._id+"EditAreaNotes",d="Edit",g=(h=G._editDialogGeneralColumns).length,_=(m=G._editDialogCustomColumns).length,!this.editFormValidate())return!0;if(e(a).closest("div"),this._duplicate)return alert(G._alertTexts.idValidationAlert),!0;for(f=0;f<g;f++)if((r=e(a).find("#"+G._id+h[f].field+d)).length>0){if(G._cellEditColumn=h[f],"duration"==G._cellEditColumn.field||"startDate"==G._cellEditColumn.field||"endDate"==G._cellEditColumn.field){F[h[f].mappingName]=this._editedDialogRecord[G._cellEditColumn.field],"duration"==G._cellEditColumn.field&&L.durationUnitMapping&&(F[L.durationUnitMapping]=this._editedDialogRecord.durationUnit);continue}l=G.getCurrentEditCellData(r,h[f].dropdownData),!1===G._isinAddnewRecord&&h[f].mappingName===G.model.predecessorMapping&&(N.previousValue=G._updatePredecessorValue(null,l)),h[f].mappingName===G.model.progressMapping&&t.isNullOrUndefined(l)&&(l=0),!L.workMapping&&"work"==G._cellEditColumn.field||"taskType"==G._cellEditColumn.field||"effortDriven"==G._cellEditColumn.field?F[h[f].field]=l:F[h[f].mappingName]=l}if(e(u).length)for(e(u).ejTreeGrid("model.isEdit")&&e(u).ejTreeGrid("saveCell"),V=e(u).ejTreeGrid("model.updatedRecords"),f=0;f<_;f++)F[m[f].mappingName]="dropdownedit"==m[f].editType?V[f].value:V[f].text;(w=e(p)).length&&(C=e(p).data("ejRTE"),t.isNullOrUndefined(C)&&e(p).ejRTE({}),F[L.notesMapping]=w.ejRTE("getHtml"));var A=G._getDateFromFormat(F[L.startDateMapping]),z=G._getDateFromFormat(F[L.endDateMapping]),j=0;if(A&&z&&(j=z.getTime()-A.getTime()),this._wrongenddate=j<0,this._wrongenddate)return alert(G._alertTexts.dateValidationAlert),!0;if(T=e(c),x=!0,T.length>0){e(T).ejTreeGrid("model.isEdit")&&e(T).ejTreeGrid("saveCell");var U,B=[],V=e(c).ejTreeGrid("option","dataSource"),$=(e(c).ejTreeGrid("option","selectedRowIndex"),G._editedDialogRecord),q=[],Y=L.resourceIdMapping;if("Add"!=i&&(t.isNullOrUndefined(G._editedDialogRecord.resourceInfo)&&(G._editedDialogRecord.resourceInfo=[]),e.extend(!0,q,G._editedDialogRecord.resourceInfo)),e.each(V,function(a,r){var n,o,l,d,s;if(null===r.name||""===r.name)return x=!1,!1;for(n=0;n<W.length;n++)if(W[n][L.resourceIdMapping].toString()==r.name){U=e.extend({},W[n]);break}if("Add"===i)B.push(U[L.resourceIdMapping]),U[L.resourceUnitMapping]=r.unit,G._newRecordResourceCollection.push(U);else{if((t.isNullOrUndefined(q)||q.length!=V.length)&&(G._isResourceAddedOrRemoved=!0),q.length>0)for(o=0;o<q.length;o++){if(q[o][Y]===U[Y]){l=o;break}l=-1}(t.isNullOrUndefined(l)||-1==l)&&q.length!=V.length&&(d=e.extend({},U),$._updateResourceUnit(U,d,L.resourceUnitMapping),d[L.resourceUnitMapping]=100,q.push(d)),q[a]&&q[a][L.resourceUnitMapping]!=V[a].unit&&"projectView"==L.viewType&&(G._isExistingUnitIsUpdated=!0),s=W.filter(function(e){return"number"==typeof e[L.resourceIdMapping]?e&&e[L.resourceIdMapping]==parseInt(V[a].name):e&&e[L.resourceIdMapping]==V[a].name}),q[a]=e.extend({},s[0]),q[a][L.resourceUnitMapping]=V[a].unit,B.push(q[a]),G._isExistingUnitIsUpdated&&($.isAutoSchedule&&"fixedDuration"!=$.taskType?$._updateDurationWithWork(G,q):$._updateWorkWithDuration(G,q),F.Duration=$.duration,L.workMapping?F[L.workMapping]=$.work:F.work=$.work,G._editedDialogRecord.duration=$.duration,G._editedDialogRecord.work=$.work,G._isExistingUnitIsUpdated=!1)}}),!x)return alert(G._alertTexts.dialogResourceAlert),!0;F[L.resourceInfoMapping]=B}F[L.taskIdMapping]||"Edit"!==i||(F[L.taskIdMapping]=G._editedDialogRecord.taskId),N.data=F,N.currentRecord="resourceView"==L.viewType?G._resourceEditedRecord:"row"==L.selectionMode?this.selectedItem():L.updatedRecords[G._rowIndexOfLastSelectedCell];var X=[],K=!1;if(L.predecessorMapping&&("Edit"===i?(K=0===L.editDialogFields.length,X=e.grep(L.editDialogFields,function(e){return e.field===L.predecessorMapping})):"Add"===i&&(K=0===L.addDialogFields.length,X=e.grep(L.addDialogFields,function(e){return e.field===L.predecessorMapping}))),X.length>0||K){if(v=[],b=!0,e(s).ejTreeGrid("model.isEdit")&&e(s).ejTreeGrid("saveCell"),v=e(s).ejTreeGrid("option","dataSource"),e.each(v,function(e,i){(t.isNullOrUndefined(i.id)||t.isNullOrUndefined(i.name)||t.isNullOrUndefined(i.type)||!(i.id.length>0&&i.name.length&&i.type.length))&&(b=!1)}),!b)return alert(G._alertTexts.predecessorAddingValidationAlert),!0;var Q,Z=[],J=[],ee=G._predecessorCollectionText,te=[];for(S=0;S<v.length;S++){for((D={}).from=F.taskID,D.to=L.enableSerialNumber?G._recordIdFromSerialnumber(v[S].id):v[S].id,D.isdrawn=!1,D.offset=v[S].offset,R=0;R<ee.length;R++)if(v[S].type==ee[R].text){D.predecessorType=ee[R].id,Q=ee[R].id;break}y=D.to+Q,v[S].offset=parseFloat(v[S].offset),0!==v[S].offset&&(y+=v[S].offset<0?D.offset.toString():"+"+D.offset.toString()),J.push(y),Z.push(D),L.enableSerialNumber&&(I="",k=+v[S].id,-1!=y.indexOf("+")?I="+"+y.split("+")[1]:-1!=y.indexOf("-")&&(I="-"+y.split("-")[1]),+N.data.serialNumber<=k&&"Add"===i&&(k+=1),te.push(k+Q+I))}if(N.predecessorString=J,!1===G._isinAddnewRecord){if(!G._editedPredecessorValidation(N))return alert(G._alertTexts.predecessorEditingValidationAlert),!0;(t.isNullOrUndefined(N.currentRecord.predecessorsName)?"":N.currentRecord.predecessorsName)!=(M=J.join(","))&&(G._isPredecessorEdited=!0),N.previousValue=G._updatePredecessorValue(N.currentRecord,M)}F[L.predecessorMapping]=J.join(","),L.enableSerialNumber&&(F.serialNumberPredecessor=te.join(","))}if(N.requestType=t.TreeGrid.Actions.Save,N.recordIndex=-1!==this.selectedRowIndex()?this.selectedRowIndex():-1,G._trigger("actionBegin",N))return!0;if("Edit"===i)"resourceView"==L.viewType?G._previousResource=e.extend(!0,[],G._resourceEditedRecord.resourceInfo):n=N.currentRecord?new Date(N.currentRecord.startDate):null,N._cModifiedData=G._updateRecord(F,G._resourceEditedRecord),G._editedDialogRecord&&(N._cModifiedData.startDate=G._getDateFromFormat(G._editedDialogRecord.startDate),N._cModifiedData.endDate=G._getDateFromFormat(G._editedDialogRecord.endDate),N._cModifiedData.duration=G._editedDialogRecord.duration,N._cModifiedData.durationUnit=G._editedDialogRecord.durationUnit,N._cModifiedData.work=G._editedDialogRecord.work,L.workMapping&&(N._cModifiedData.item[L.workMapping]=G._editedDialogRecord.work),G._isResourceAddedOrRemoved&&G._updateResourceRelatedFields(N._cModifiedData),L.durationUnitMapping&&(N._cModifiedData.item[L.durationUnitMapping]=G._editedDialogRecord.durationUnit),G._editedDialogRecord=null),N.data[L.endDateMapping]&&(t.isNullOrUndefined(N.data[L.durationMapping])||""===N.data[L.durationMapping])&&0==G._isDurationUpdated&&(N._cModifiedData.startDate=G._checkStartDate(N._cModifiedData.startDate,N._cModifiedData),N._cModifiedData.endDate=G._checkEndDate(N._cModifiedData.endDate,N._cModifiedData),N._cModifiedData._calculateDuration(this)),N._cModifiedData.isMilestone=0==N._cModifiedData.duration&&0==G._compareDatesFromRecord(N._cModifiedData),N.data[L.baselineStartDateMapping]&&N.data[L.baselineEndDateMapping]&&(E=G._getDateFromFormat(N.data[L.baselineStartDateMapping]),(H=G._getDateFromFormat(N.data[L.baselineEndDateMapping]))&&0==H.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,H),N._cModifiedData.baselineStartDate=this._checkBaseLineStartDate(E),N._cModifiedData.baselineEndDate=this._checkBaseLineEndDate(H),N._cModifiedData.baselineLeft=N._cModifiedData._calculateBaselineLeft(this),N._cModifiedData.baselineRight=N._cModifiedData._calculateBaselineRight(this),N._cModifiedData.baselineWidth=N._cModifiedData._calculateBaseLineWidth(this)),N.modifiedRecord=N._cModifiedData,N.previousStartDate=n,G.actionComplete(N),G._isPredecessorEdited=!1;else if("Add"===i&&(P=null!=G._addPosition?G._addPosition:L.editSettings.rowPosition,!G.addRecord(F,P)))return alert(G._alertTexts.predecessorEditingValidationAlert),!0;return G._cModifiedData=null,G._cAddedRecord=null,G._primaryKeyValues=[],G._isinAddnewRecord=!1,G._isResourceAddedOrRemoved=!1,!1},_recordReturnerByID:function(e){for(var t=this.model.flatRecords,i=0;i<t.length;i++)if(t[i].taskId.toString()===e.toString())return t[i];return null},_sendCancelRequest:function(){var i=this,a={};-1!=i.model.dateFormat.toLowerCase().indexOf("hh")?e("#"+i._id+"EditForm").find(".e-datepicker").ejDateTimePicker("destroy"):e("#"+i._id+"EditForm").find(".e-datepicker").ejDatePicker("destroy"),a.requestType=t.TreeGrid.Actions.Cancel,i._$treegridHelper.ejTreeGrid("processBindings",a),i._primaryKeyValues=[],i.model.currentData=null},getCurrentEditCellData:function(i,a){var r,n,o=this;o.model;if(e("#"+o._id+"EditForm").length||e("#"+o._id+"GeneralAddForm").length||e("#"+o._id+"GeneralEditForm").length){switch(n="",o._cellEditColumn.editType){case t.TreeGrid.EditingType.String:n=i.val();break;case t.TreeGrid.EditingType.Numeric:n=i.ejNumericTextbox("getValue");break;case t.TreeGrid.EditingType.Dropdown:n=i.attr("id").indexOf("resourceInfo")>0?o._getSelectedItem(i.ejDropDownList("model.selectedItems"),a):i.attr("id").indexOf("taskMode")>0?"true"==i.ejDropDownList("model.value"):i.ejDropDownList("model.value");break;case t.TreeGrid.EditingType.Boolean:n=i.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:r=i.ejDatePicker("model.value"),n=o._cellEditColumn&&!o._cellEditColumn.format?o.getFormatedDate(r):r;break;case t.TreeGrid.EditingType.DateTimePicker:r=i.ejDateTimePicker("model.value"),n=o._cellEditColumn&&!o._cellEditColumn.format?n=o.getFormatedDate(r):r;break;case t.TreeGrid.EditingType.Maskedit:n=i.ejMaskEdit("model.value")}return n}return null},_getSelectedItem:function(t,i){var a=0,r=t.length,n=[];if(i)for(a=0;a<r;a++)e.each(i,function(e,i){t[a]===e&&n.push(i)});return n},_getDropDownText:function(i,a){var r,n,o,l,d,s=i.editParams,c=i.dropdownData,u=s&&!t.isNullOrUndefined(s.delimiterChar)?s.delimiterChar:",",p=[];if("string"==typeof a&&a.indexOf(u)>-1&&(r=(a=a.split(u)).length),s&&s.fields?(o=s.fields.text?s.fields.text:"text",n=s.fields.value?s.fields.value:"value"):(n="value",o="text"),r){for(d=0;d<r;d++)e.each(c,function(e,i){if(t.isNullOrUndefined(i[n])){if(a[d]===i[o].toString())return p.push(i[o].toString()),!1}else if(a[d]===i[n].toString())return p.push(i[o]),!1});return p.join(u)}return e.each(c,function(e,i){if(!t.isNullOrUndefined(i[n])&&a.toString()===i[n].toString()||a===i[o])return l=i[o],!1}),l},_updateRecord:function(i,a){var r,n,o,l,d=this,s=this.model,c=s.viewType==t.Gantt.ViewType.ProjectView?d._columns:d._resourceViewColumns,u=0,p="row"==s.selectionMode?this.selectedRowIndex():d._rowIndexOfLastSelectedCell,h=a||d.getUpdatedRecords()[p];if(d._isUpdateOffset=!1,s.editDialogFields.length>0){for(n=[],o=0;o<s.editDialogFields.length;o++)(l=e.grep(c,function(e){return e.mappingName===s.editDialogFields[o].field})).length&&n.push(l[0]);c=n}for(r=c.length,u=0;u<r;u++)"predecessor"!==c[u].field.toString()&&(t.isNullOrUndefined(i[c[u].mappingName])||("startDate"==c[u].field&&0!=d._compareDates(h[c[u].field],i[c[u].mappingName])&&(d._isUpdateOffset=!0),"endDate"==c[u].field&&0!=d._compareDates(h[c[u].field],i[c[u].mappingName])&&(d._isUpdateOffset=!0),"duration"==c[u].field&&h[c[u].field]!=i[c[u].mappingName]&&(d._isUpdateOffset=!0),"work"!=c[u].field&&"taskType"!=c[u].field&&(h[c[u].field]=i[c[u].mappingName],h.item[c[u].mappingName]=i[c[u].mappingName]),"work"==c[u].field&&(s.workMapping?(h[c[u].field]=i[c[u].mappingName],h.item[c[u].mappingName]=i[c[u].mappingName]):h[c[u].field]=i[c[u].field]),s.enableSerialNumber&&"serialNumberPredecessor"==c[u].field&&(h[c[u].field]=i[c[u].field])),"taskMode"==c[u].field&&(h.isAutoSchedule=!i[s.taskSchedulingModeMapping]),("taskType"==c[u].field||"effortDriven"==c[u].field)&&(h[c[u].field]=i[c[u].field]),"resourceInfo"===c[u].field.toString()&&d._updateResourceName(h),"notesText"===c[u].field.toString()&&(h.notes=i[s.notesMapping],h.notesText=d._getPlainText(i[s.notesMapping]),h.item[s.notesMapping]=i[s.notesMapping]));return h},updateRecordByTaskId:function(e){var i,a,r,n=this,o=n.model,l=e[o.taskIdMapping],d="number"==typeof l?l.toString():"string"==typeof l?l:null;"resourceView"==o.viewType?n._updateResourceTask(e):t.isNullOrUndefined(d)||(i=o.ids.indexOf(d))>-1&&(a=o.flatRecords[i],r=o.updatedRecords.indexOf(a),n.updateRecordByIndex(r,e))},updateRecordByIndex:function(a,r){var n,o,l,d,s,c,u,p=this,h=p.model,g=h.updatedRecords,m={},_=a,f=!1,w=_>-1&&g.length>0?g[_]:null;if(p.cancelEditCell(),!t.isNullOrUndefined(w)){for(c=e.extend({},w.item),m.previousItem=e.extend(!0,{},w.item),e.each(r,function(e,t){(h.startDateMapping==e||h.endDateMapping==e||h.durationMapping==e)&&c[e]!=t&&(f=!0),c[e]=t}),r=c,p.getColumns(),r[h.taskIdMapping]=w.item[h.taskIdMapping],n=p._createGanttRecord(r,w.level,w.parentItem,i),w.isAutoSchedule=n.isAutoSchedule,w.isMilestone=n.isMilestone,o=["WBS","baselineEndDate","effortDriven","endDate","baselineStartDate","baselineStartDate","duration","manualEndDate","durationUnit","manualStartDate","notes","notesText","predecessorsName","resourceInfo","resourceNames","startDate","isAutoSchedule","manualDuration","taskType","taskName","work","status","item","predecessor"],l=p._getGanttColumnDetails(),d=0;d<l.customColDetails.length;d++)o.push(l.customColDetails[d].field);for(a=0;a<o.length;a++)"taskId"!=o[a]&&(w.hasChildRecords&&w.isAutoSchedule&&("startDate"==o[a]||"endDate"==o[a]||"duration"==o[a]||"status"==o[a]||"predecessor"==o[a])||("predecessor"==o[a]?(s=t.isNullOrUndefined(n.item[h.predecessorMapping])?"":n.item[h.predecessorMapping],m.previousValue=p._updatePredecessorValue(w,s)):"item"==o[a]?(c=e.extend({},n.item),e.each(c,function(e,t){w.item[e]=t})):(!t.isNullOrUndefined(n[o[a]])||h.allowUnscheduledTask&&("startDate"==o[a]||"endDate"==o[a]||"duration"==o[a]))&&(w[o[a]]=n[o[a]])));m.requestType=t.TreeGrid.Actions.Save,m.recordIndex=_,m.modifiedRecord=w,m._cModifiedData=m.modifiedRecord,p._isUpdateOffset=!0,f&&(w.isAutoSchedule||h.validateManualTasksOnLinking)?(u=p._getLinkedTaskArgs(w,"recordUpdate"),p._trigger("actionBegin",u)||(u.actionCompleteArgs=m,(!h.enablePredecessorValidation||h.enablePredecessorValidation&&p._validateTypes(u))&&p.actionComplete(m))):p.actionComplete(m)}},_updateResourceTask:function(a){var r,n,o,l,d,s,c,u,p,h,g,m=this,_=m.model,f={},w=a[_.taskIdMapping];if(w="number"==typeof w?w.toString():"string"==typeof w?w:null,t.isNullOrUndefined(w)||(r=this._getRecordByTaskId(w),t.isNullOrUndefined(r))||"unassignedTask"==r.eResourceTaskType&&-1==_.updatedRecords.indexOf(r))return!1;for(this.cancelEditCell(),n=e.extend({},r.item),l=!1,f.previousItem=e.extend(!0,{},r.item),e.each(a,function(e,t){(_.startDateMapping==e||_.endDateMapping==e||_.durationMapping==e)&&n[e]!=t&&(l=!0),n[e]=t}),this.getResourceViewEditColumns(),n[_.taskIdMapping]=r.item[_.taskIdMapping],o=this._createGanttRecord(n,r.level,r.parentItem,i),"resourceView"==this.model.viewType&&0==o.duration&&(o.duration=1,o._calculateEndDate(this)),r.isAutoSchedule=o.isAutoSchedule,r.isMilestone=o.isMilestone,d=["WBS","baselineEndDate","effortDriven","endDate","baselineStartDate","baselineStartDate","duration","manualEndDate","durationUnit","manualStartDate","notes","notesText","predecessorsName","resourceInfo","resourceNames","startDate","isAutoSchedule","manualDuration","taskType","taskName","work","status","item","predecessor"],s=this._getGanttColumnDetails(),c=0;c<s.customColDetails.length;c++)d.push(s.customColDetails[c].field);for(u=0;u<d.length;u++)"taskId"!=d[u]&&(r.hasChildRecords&&r.isAutoSchedule&&("startDate"==d[u]||"endDate"==d[u]||"duration"==d[u]||"status"==d[u]||"predecessor"==d[u])||("predecessor"==d[u]?(p=t.isNullOrUndefined(o.item[_.predecessorMapping])?"":o.item[_.predecessorMapping],f.previousValue=this._updatePredecessorValue(r,p)):"item"==d[u]?(h=e.extend({},o.item),e.each(h,function(e,t){r.item[e]=t})):"resourceInfo"==d[u]?(this._previousResource=e.extend(!0,[],r[d[u]]),r[d[u]]=o[d[u]]):t.isNullOrUndefined(o[d[u]])||(r[d[u]]=o[d[u]])));f.requestType=t.TreeGrid.Actions.Save,f.modifiedRecord=r,f._cModifiedData=f.modifiedRecord,this._isUpdateOffset=!0,l&&(r.isAutoSchedule||_.validateManualTasksOnLinking)?(g=m._getLinkedTaskArgs(r,"recordUpdate"),m._trigger("actionBegin",g)||(g.actionCompleteArgs=f,(!_.enablePredecessorValidation||_.enablePredecessorValidation&&m._validateTypes(g))&&m.actionComplete(f))):this.actionComplete(f)},_getLinkedTaskArgs:function(e,t){var i={};return i.editMode=t,i.data=e,i.requestType="validateLinkedTask",i.validateMode={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},i},_getGanttColumnDetails:function(){var e,t,i,a={},r=["taskId","taskMode","taskName","startDate","endDate","duration","resourceInfo","status","work","taskType","effortDriven","baselineStartDate","baselineEndDate","predecessor","WBS","notesText"];for(t="projectView"==this.model.viewType?this.getColumns():this.getResourceViewEditColumns(),a.customColDetails=[],a.generalColDetails=[],e=t.length,i=0;i<e;i++)-1!=r.indexOf(t[i].field)?a.generalColDetails.push(t[i]):a.customColDetails.push(t[i]);return a},_splitAndReplace:function(e,i,a,r){var n,o,l;if(!t.isNullOrUndefined(r)&&r.length>0){for(n=r.shift(),o=e.split(n),l=0;l<o.length;l++)r.length>0?o[l]=this._splitAndReplace(o[l],i,a,r):o[l]==i&&(o[l]=a);return o.join(n)}},_updateDetailPredecessorCollection:function(e,i){for(var a,r,n=this.detailPredecessorCollection,o=0;o<n.length;o++)(a=this.detailPredecessorCollection[o]).taskid==parseInt(e)&&(a.taskid=parseInt(i)),r=[",",":"],t.isNullOrUndefined(a.from)?t.isNullOrUndefined(a.to)||(a.to=this._splitAndReplace(a.to,e,i,r)):a.from=this._splitAndReplace(a.from,e,i,r)},_updateConnectorLineId:function(e,t,i){var a=this,r=a._createConnectorLineObject(e,t,i);r&&(a._connectorlineIds.length>0&&-1==a._connectorlineIds.indexOf(r.ConnectorLineId)?(a._updatedConnectorLineCollection.push(r),a._connectorlineIds.push(r.ConnectorLineId)):0==a._connectorlineIds.length&&(a._updatedConnectorLineCollection.push(r),a._connectorlineIds.push(r.ConnectorLineId)),a._$ganttchartHelper.ejGanttChart("appendConnectorLine",a._updatedConnectorLineCollection),this._updateConnectorLineCollection(a._updatedConnectorLineCollection))},updateTaskId:function(e,i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T=this,x=this.model,v=x.ids,b=x.flatRecords,S=x.currentViewData,D="number"==typeof e?e.toString():e,R="number"==typeof i?i.toString():i;if(!t.isNullOrUndefined(D)&&!t.isNullOrUndefined(R)){if(a=v.indexOf(D),r=v.indexOf(R),-1==a||r>-1)return!1;if((n=b[a]).taskId=n.item[x.taskIdMapping]=i,v[a]=R,(this.criticalPathCollection.length>0||this.collectionTaskId.length>0)&&(o=this.criticalPathCollection.indexOf(parseInt(D)),l=this.collectionTaskId.indexOf(parseInt(D)),this.criticalPathCollection[o]=parseInt(R),this.collectionTaskId[l]=parseInt(R)),this.detailPredecessorCollection.length>0&&T._updateDetailPredecessorCollection(D,R),n.hasChildRecords&&x.parentTaskIdMapping)for(s=(d=n.childRecords).length,c=0;c<s;c++)(u=d[c]).item[x.parentTaskIdMapping]=i,T.refreshGanttRecord(u);if(x.predecessorMapping&&!t.isNullOrUndefined(n.predecessor))for(h=(p=n.predecessor).length,g=0;g<h;g++)(m=p[g]).to==D?(f=b[v.indexOf(m.from)],_=b[a],T._connectorlineIds=[],T._updatedConnectorLineCollection=[],S.indexOf(f)>-1&&S.indexOf(_)>-1?(w="parent"+m.from+"child"+m.to,T._$ganttchartHelper.ejGanttChart("removeConnectorline",w),T._updateConnectorLineCollection(w),m.to=R,T._updateConnectorLineId(f,_,m)):m.to=R):m.from==D&&(f=b[a],_=b[v.indexOf(m.to)],T._connectorlineIds=[],T._updatedConnectorLineCollection=[],S.indexOf(f)>-1&&S.indexOf(_)>-1?(w="parent"+m.from+"child"+m.to,T._$ganttchartHelper.ejGanttChart("removeConnectorline",w),T._updateConnectorLineCollection(w),m.from=R,T._updateConnectorLineId(f,_,m)):m.from=R,t.isNullOrUndefined(_)||(C=T._predecessorToString(_.predecessor,_),_.predecessorsName=C,_.item[x.predecessorMapping]=C,T.refreshGanttRecord(_)));return T._isLastRefresh=!0,T._$treegridHelper.ejTreeGrid("setUpdatedRecords",x.flatRecords,x.updatedRecords,x.ids,x.parentRecords,this.dataSource()),T._$ganttchartHelper.ejGanttChart("setUpdatedRecords",x.currentViewData,x.updatedRecords,x.flatRecords,x.ids),T.refreshGanttRecord(n),T._updateLastInsertedId(n.taskId),1==T.isCriticalPathEnable&&(T._$ganttchartHelper.ejGanttChart("criticalDataMapping",T.criticalPathCollection,!0,T.detailPredecessorCollection,T.collectionTaskId),T._$ganttchartHelper.ejGanttChart("criticalConnectorLine",T.criticalPathCollection,T.detailPredecessorCollection,!0,T.collectionTaskId)),!0}},_selectedChildRecord:function(e,t){for(var i=0;i<e.length;i++)e[i].isSelected&&t.push(e[i]),e[i].hasChildRecords&&this._selectedChildRecord(e[i].childRecords,t)},_checkIndentOutdent:function(e,t){var i;return e.hasChildRecords&&(i=[],this._selectedChildRecord(e.childRecords,i),t+=i.length),t},_sendIndentRequest:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m=this,_=m.model,f=m.getCurrentData(),w={},C={},T=!1,x=m._$treegridHelper.ejTreeGrid("instance");if(m.cancelEditCell(),t.isNullOrUndefined(f)||0==f.length)alert(m._alertTexts.indentAlert);else{if(w.data=f,w.requestType="indent",m._trigger("actionBegin",w))return;for(a=0;a<f.length;a++)if(c=f[a],w.data=c,i=_.flatRecords[_.flatRecords.indexOf(c)-1],t.isNullOrUndefined(i))a=m._checkIndentOutdent(c,a);else if(-1==e.inArray(c,i.childRecords)){if(c.parentItem?(r=c.parentItem.childRecords.indexOf(c),c.parentItem.childRecords.splice(r,1),_.parentTaskIdMapping||c.parentItem.item[_.childMapping].splice(r,1)):this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json?(n=this.dataSource().dataSource.json.indexOf(c.item),_.parentTaskIdMapping||this.dataSource().dataSource.json.splice(n,1)):m._isDataManagerUpdate&&(n=m._jsonData.indexOf(c.item),_.parentTaskIdMapping||(m._jsonData=m._$treegridHelper.ejTreeGrid("getUpdatedDatamanagerData"),m._jsonData.splice(n,1))):(n=this.dataSource().indexOf(c.item),_.parentTaskIdMapping||this.dataSource().splice(n,1)),c.level===i.level?i.childRecords?i.expanded||(i.childRecords.splice(i.childRecords.length,0,c),c.parentItem=i,_.parentTaskIdMapping?c.item[_.parentTaskIdMapping]=i.taskId:i.item[_.childMapping].splice(i.childRecords.length,0,c.item)):(i.childRecords=[],i.childRecords.push(c),i.expanded=!0,i.taskType=t.Gantt.TaskType.FixedDuration,i.effortDriven="false",c.parentItem=i,i.item[_.childMapping]=[],_.parentTaskIdMapping?c.item[_.parentTaskIdMapping]=i.taskId:i.item[_.childMapping].push(c.item)):i.level-c.level==1?(i.parentItem.childRecords.splice(i.parentItem.childRecords.length,0,c),_.parentTaskIdMapping?c.item[_.parentTaskIdMapping]=i.parentItem.taskId:i.parentItem.item[_.childMapping].splice(i.parentItem.childRecords.length,0,c.item),c.parentItem=i.parentItem):i.level-c.level>1&&((o=m.getParentItem(i,c.level)).childRecords.splice(o.childRecords.length,0,c),_.parentTaskIdMapping?c.item[_.parentTaskIdMapping]=o.taskId:o.item[_.childMapping].splice(o.childRecords.length,0,c.item),c.parentItem=o),c.parentItem.isMilestone&&(c.parentItem.isMilestone=!1),i.hasChildRecords=!!i.childRecords&&i.childRecords.length>0,c.level+=1,(x._searchString.length>0||x.model.sortSettings.sortedColumns.length>0)&&(T=!0),m.updateLevel(c,1,T),T||m.refreshGanttRecord(c),0===i.level&&-1===_.parentRecords.indexOf(i)&&_.parentRecords.push(i),c.level>0&&-1!==_.parentRecords.indexOf(c)&&(l=_.parentRecords.indexOf(c),_.parentRecords.splice(l,1)),c.parentItem&&c.parentItem.isAutoSchedule?m._updateParentItem(c):c.parentItem&&!c.parentItem.isAutoSchedule&&m._updateManualParentItem(c),c.parentItem&&c.parentItem.predecessor&&_.predecessorMapping&&m._updatePredecessorOnIndentOutdent(c.parentItem),T||m.refreshGanttRecord(i),m.getExpandStatus(c)||((d={}).expanded=!0,d.data=c.parentItem,m.expanding(d)),_.enableWBS){var v=c.parentItem.WBS,b=c.parentItem.childRecords.length,S=[c];m.reCalculateWBS(S,b,v),m.updateWBSdetails(c.parentItem)}a=m._checkIndentOutdent(c,a)}else a=m._checkIndentOutdent(c,a);m._$treegridHelper.ejTreeGrid("setUpdatedRecords",_.flatRecords,_.updatedRecords,_.ids,_.parentRecords,this.dataSource()),T&&(w.requestType="indent",m._$treegridHelper.ejTreeGrid("processBindings",w),(s={}).requestType=t.TreeGrid.Actions.Refresh,m._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",s),m.model.updatedRecords=m.getUpdatedRecords(),m.model.currentViewData=m.getCurrentViewData(),m._$ganttchartHelper.ejGanttChart("setUpdatedRecords",_.currentViewData,_.updatedRecords,_.flatRecords,_.ids),m._$ganttchartHelper.ejGanttChart("refreshHelper",_.currentViewData,_.updatedRecords,m._totalCollapseRecordCount),m.updateAltRow(_.updatedRecords,0,1)),_.predecessorMapping&&m._refreshConnectorLines(!1,!0,!1),c=f[f.length-1],1!=f.length||m._$treegridHelper.ejTreeGrid("instance")._multiSelectCtrlRequest||"cell"==_.selectionMode||(u=_.updatedRecords.indexOf(c),p=m.getGanttChartRows(),w={rowElement:p.eq(u),data:m.model.selectedItem,recordIndex:u},m._$ganttchartHelper.ejGanttChart("selectRows",w.recordIndex),m._$treegridHelper.ejTreeGrid("selectRows",w.recordIndex),this.selectedItem(w.data),this.selectedRowIndex(w.recordIndex),_.allowSelection&&m.updateIndentOutdentOption(c)),f.length>1&&(x._searchString.length>0&&(h=[],f.filter(function(e){h.push(_.updatedRecords.indexOf(e))}),m.selectMultipleRows(h)),m._multipleIndentOutdentOption(_.selectedItems)),C.data=c,C.requestType="indent",(g=e.map(m._actionCompleteData,function(e,t){if(e.taskId==w.data.taskId)return t})).length&&m._actionCompleteData.splice(g[0],1),m._actionCompleteData.length&&(C.updatedRecords=m._actionCompleteData,m._actionCompleteData=[]),this._trigger("actionComplete",C),1==this.isCriticalPathEnable&&(m._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!1,this.collectionTaskId),this.showCriticalPath(!0))}},getParentItem:function(e,t){return e.parentItem.level===t?e.parentItem:this.getParentItem(e.parentItem,t)},getSubChangeIndex:function(e,t,i){for(var a,r=this,n=0;n<r.model.updatedRecords.length;n++)if(r.model.updatedRecords[n].level==e&&r.model.updatedRecords[n].index>t){i.parentItem&&r.model.updatedRecords[n].parentItem.taskId==i.parentItem.taskId&&(a=r.model.updatedRecords[n].index);break}return a},_nextSameLevelItem:function(e,t){for(var i,a=e.parentItem.level,r=t.indexOf(e);r<t.length;r++)if(a===t[r].level||a>t[r].level){i=t[r];break}return i},_getOutdentItem:function(){var e,t,i=this,a=i.model,r=[],n=[],o=i.getUpdatedRecords();if("row"==i.model.selectionMode){for(t=(r=a.flatRecords.filter(function(e){return e.isSelected})).length-1;t>=0;t--)n.push(r[t]);return n}if(-1!=(e=i._rowIndexOfLastSelectedCell))return o&&[o[e]]},_getParentSelectionStatus:function(e){var i=t.isNullOrUndefined(e)?null:e.parentItem;if(null!=i)return!0===i.isSelected||this._getParentSelectionStatus(i.parentItem)},_sendOutdentRequest:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C,T=this,x=T.model,v=T._getOutdentItem(),b={},S={};if(T.cancelEditCell(),t.isNullOrUndefined(v)||0==v.length)alert(T._alertTexts.outdentAlert);else{if(b.data=v,b.requestType="outdent",T._trigger("actionBegin",b)||0==x.editSettings.allowIndent)return;for(p=0;p<v.length;p++){if(_=v[p],b.data=_,T._getParentSelectionStatus(_)||0==_.level)continue;if(i=T._nextSameLevelItem(_,x.flatRecords),r=x.flatRecords.indexOf(_),n=_.parentItem,o=_.parentItem.childRecords.indexOf(_),d=(l=_.parentItem.parentItem)&&_.parentItem.parentItem.childRecords.indexOf(i),_.parentItem.childRecords.splice(o,1),x.parentTaskIdMapping||_.parentItem.item[x.childMapping].splice(o,1),0==_.parentItem.childRecords.length?(_.parentItem.childRecords=null,_.parentItem.expanded=!1,_.parentItem.hasChildRecords=!1):_.parentItem&&_.parentItem.isAutoSchedule?T._updateParentItem(_.parentItem.childRecords[0]):_.parentItem&&!_.parentItem.isAutoSchedule&&T._updateManualParentItem(_.parentItem.childRecords[0]),l?(-1!=d?l.childRecords.splice(d,0,_):l.childRecords.push(_),x.parentTaskIdMapping?_.item[x.parentTaskIdMapping]=l.taskId:-1!=d?l.item[x.childMapping].splice(d,0,_.item):l.item[x.childMapping].push(_.item),_.parentItem=l):(this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json?x.parentTaskIdMapping||this.dataSource().dataSource.json.push(_.item):T._isDataManagerUpdate&&(x.parentTaskIdMapping||(T._jsonData=T._$treegridHelper.ejTreeGrid("getUpdatedDatamanagerData"),T._jsonData.push(_.item))):x.parentTaskIdMapping||(i?(C=this.dataSource().indexOf(i.item),this.dataSource().splice(C,0,_.item)):this.dataSource().push(_.item)),_.parentItem=null,x.parentTaskIdMapping&&(_.item[x.parentTaskIdMapping]=null)),s=T._$treegridHelper.ejTreeGrid("getChildCount",_,0),c=x.flatRecords.splice(r,s+1),u=x.ids.splice(r,s+1),a=i?x.flatRecords.indexOf(i):x.flatRecords.length,_.hasChildRecords&&_.childRecords.length>0)for(h=0;h<c.length;h++)x.flatRecords.splice(a,0,c[h]),x.ids.splice(a,0,u[h]),c[h].level-=1,a++,(C=e.map(T._actionCompleteData,function(e,t){if(e.taskId==c[h].taskId)return t})).length?T._actionCompleteData[C[0]]=c[h]:T._actionCompleteData.push(c[h]);else x.flatRecords.splice(a,0,c[0]),x.ids.splice(a,0,u[0]),c[0].level-=1;_.parentItem&&(_.parentItem.isMilestone&&(_.parentItem.isMilestone=!1),_.parentItem&&_.parentItem.isAutoSchedule?T._updateParentItem(_):_.parentItem&&!_.parentItem.isAutoSchedule&&T._updateManualParentItem(_)),_.hasChildRecords&&(_.isAutoSchedule?T._updateParentItem(_,null,!0):T._updateManualParentItem(_,null,!0)),0===_.level&&-1===x.parentRecords.indexOf(_)&&x.parentRecords.push(_),_.predecessor&&_.predecessor.length>0&&x.predecessorMapping&&_.hasChildRecords&&T._updatePredecessorOnIndentOutdent(_),x.updatedRecords=x.enableVirtualization?T._$treegridHelper.ejTreeGrid("getExpandedRecords",x.flatRecords):x.flatRecords.slice(),g=n.childRecords&&n.childRecords[o],x.enableWBS&&(g&&T.updateWBSdetails(g,!0),T.updateWBSdetails(n),g&&T.updateWBSdetails(g,!0,!0)),T._$treegridHelper.ejTreeGrid("setUpdatedRecords",x.flatRecords,x.updatedRecords,x.ids,x.parentRecords,this.dataSource()),g&&(T._$treegridHelper.ejTreeGrid("updateSerialNumber",r),x.enableSerialNumber&&T._$treegridHelper.ejTreeGrid("updateSerialNumberPredecessors",r))}b.requestType="outdent",T._$treegridHelper.ejTreeGrid("processBindings",b),(m={}).requestType=t.TreeGrid.Actions.Refresh,T._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",m),T.model.updatedRecords=T.getUpdatedRecords(),T.model.currentViewData=T.getCurrentViewData(),T._$ganttchartHelper.ejGanttChart("setUpdatedRecords",x.currentViewData,x.updatedRecords,x.flatRecords,x.ids),T.model.predecessorMapping&&T._refreshConnectorLines(!1,!0,!1),T._$ganttchartHelper.ejGanttChart("refreshHelper",x.currentViewData,x.updatedRecords,T._totalCollapseRecordCount),T.updateAltRow(x.updatedRecords,0,1),_=v[v.length-1],1==v.length&&"cell"!=x.selectionMode&&(f=x.updatedRecords.indexOf(_),T.getGanttChartRows(),b={data:T.model.selectedItem,recordIndex:f},T._$ganttchartHelper.ejGanttChart("selectRows",b.recordIndex),T._$treegridHelper.ejTreeGrid("selectRows",b.recordIndex),this.selectedItem(b.data),this.selectedRowIndex(b.recordIndex),x.allowSelection&&T.updateIndentOutdentOption(_)),"cell"==x.selectionMode&&"single"==x.selectionType&&(T._rowIndexOfLastSelectedCell=x.updatedRecords.indexOf(_),T.selectCells([{rowIndex:x.updatedRecords.indexOf(_),cellIndex:x.selectedCellIndexes[0].cellIndex}])),v.length>1&&(T._$treegridHelper.ejTreeGrid("instance")._searchString.length>0&&(w=[],v.filter(function(e){w.push(x.updatedRecords.indexOf(e))}),T.selectMultipleRows(w)),T._multipleIndentOutdentOption(x.selectedItems)),S.data=_,S.requestType="outdent",(C=e.map(T._actionCompleteData,function(e,t){if(e.taskId==_.taskId)return t})).length&&T._actionCompleteData.splice(C[0],1),T._actionCompleteData.length&&(S.updatedRecords=T._actionCompleteData,T._actionCompleteData=[]),this._trigger("actionComplete",S),1==this.isCriticalPathEnable&&(this.showCriticalPath(!0,!0),T._$ganttchartHelper.ejGanttChart("criticalConnectorLine",this.criticalPathCollection,this.detailPredecessorCollection,!0,this.collectionTaskId))}},_refreshChildLevel:function(e){var t,i=0,a=e.childRecords,r=a.length;for(i=0;i<r;i++)t=a[i],this.refreshGanttRecord(t),t.hasChildRecords&&this._refreshChildLevel(t)},_updateChildLevel:function(e){var t,i=0,a=e.childRecords,r=a.length;for(i=0;i<r;i++)(t=a[i]).level=t.level-1,t.hasChildRecords&&this._updateChildLevel(t)},_removeChildRecords:function(e,t){if(e.parentItem){var i,a=this.model,r=0,n=0,o=0,l=e.parentItem.childRecords,d=l&&l.length;for(r=t;r<d;r++)(i=l[r])&&(e.childRecords?(o=e.childRecords.length,e.childRecords.splice(o,0,i),a.parentTaskIdMapping?i.item[a.parentTaskIdMapping]=e.taskId:e.item[a.childMapping].splice(o,0,i.item)):(e.childRecords=[],e.item[a.childMapping]=[],e.childRecords.push(i),a.parentTaskIdMapping?i.item[a.parentTaskIdMapping]=e.taskId:e.item[a.childMapping].push(i.item)),i.parentItem=e,n++);e.parentItem.childRecords&&(e.parentItem.childRecords.splice(t,n),a.parentTaskIdMapping||e.parentItem.item[a.childMapping].splice(t,n),0==e.parentItem.childRecords.length&&(e.parentItem.childRecords=null,e.parentItem.expanded=!1,e.parentItem.hasChildRecords=!1,this.refreshGanttRecord(e.parentItem)))}},updateChildGanttRecordLevel:function(e,t){var i,a=0,r=this,n=r.model,o=e.parentItem&&e.parentItem.parentItem&&e.parentItem.parentItem.childRecords,l=o&&o.length,d=0;for(a=t;a<l;a++)(i=o[a]).childRecords?(i.childRecords.splice(i.childRecords.length,0,i),i.item[n.childMapping].splice(i.childRecords.length,0,i.item)):(i.childRecords=[],i.item[n.childMapping]=[],i&&(i.childRecords.push(i),i.item[n.childMapping].push(i.item))),r.refreshGanttRecord(e.parentItem),e.parentItem=i,++d;e.parentItem.childRecords.splice(t,d),0==e.parentItem.childRecords.length&&(e.parentItem.childRecords=null,e.parentItem.expanded=!1,e.parentItem.hasChildRecords=!1),r.refreshGanttRecord(e.parentItem)},updateLevel:function(e,t,i){for(var a,r=0,n=e.childRecords,o=n&&n.length;r<o;r++)(a=n[r]).level+=t,i||this.refreshGanttRecord(a),a.childRecords&&this.updateLevel(a,t,i)},getExpandStatus:function(e){var t=e.parentItem;return null==t||!1!==t.expanded&&(!t.parentItem||!1!==t.parentItem.expanded&&this.getExpandStatus(t.parentItem))},subContextMenuAction:function(i){var a,r=this,n=r.model,o=e.extend(!0,{},r._contextMenuSelectedItem.item);!n.durationUnitMapping&&n.durationMapping&&(o[n.durationMapping]=this._getDurationStringValue(this._contextMenuSelectedItem)),delete o[n.childMapping],delete o[n.predecessorMapping],delete o.WBSPredecessor,delete o[n.taskNameMapping],a="Below"===i.position?t.Gantt.RowPosition.BelowSelectedRow:t.Gantt.RowPosition.AboveSelectedRow,n.enableWBS&&(o.WBS=r._getNewWBSid(a)),r.addRecord(o,a)},reCalculateWBS:function(e,t,i){var a,r,n=this,o=n.model;if(i)for(r=0;r<e.length;r++)a=t+r,e[r].WBS=i+"."+a,e[r].item.WBS=i+"."+a,o.enableWBSPredecessor&&o.predecessorMapping&&n._getPredecessorIds(e[r]),n.refreshGanttRecord(e[r]),e[r].hasChildRecords&&n._updateChildWBS(e[r]);else for(r=0;r<e.length;r++)a=(t+r).toString(),e[r].WBS=a,e[r].item.WBS=a,o.enableWBSPredecessor&&o.predecessorMapping&&n._getPredecessorIds(e[r]),n.refreshGanttRecord(e[r]),e[r].hasChildRecords&&n._updateChildWBS(e[r])},_updateChildWBS:function(e){for(var t=this,i=t.model,a=e.childRecords,r=e.WBS,n=0;n<a.length;n++)a[n].WBS=r+"."+(n+1),a[n].item.WBS=r+"."+(n+1),i.enableWBSPredecessor&&i.predecessorMapping&&t._getPredecessorIds(a[n]),t.refreshGanttRecord(a[n]),a[n].hasChildRecords&&t._updateChildWBS(a[n])},_getPredecessorIds:function(e){var t,i=this,a=i.model,r=e.taskId,n=a.flatRecords.filter(function(e){var t,i;if(e.predecessorsName)for(t=e.predecessorsName.split(","),i=0;i<t.length;i++)if(+t[i].match(/(\d+|[A-z]+)/g)[0]==r)return e});if(n.length)for(t=0;t<n.length;t++)i._$treegridHelper.ejTreeGrid("updateWBSPredecessor",n[t]),i.refreshGanttRecord(n[t])},_getNewWBSid:function(e){var i,a,r=this.model,n="row"==r.selectionMode?r.selectedItem:r.updatedRecords[this._rowIndexOfLastSelectedCell];if(i=n?n.WBS:1,n)switch(e){case t.Gantt.RowPosition.BelowSelectedRow:a=(-1!=i.lastIndexOf(".")?parseInt(i.substr(i.lastIndexOf(".")+1)):parseInt(i))+1,n.parentItem?i=(n.parentItem?n.parentItem.WBS:null)+"."+a:i=a;break;case t.Gantt.RowPosition.Top:i=1;break;case t.Gantt.RowPosition.Bottom:i=(r.parentRecords?r.parentRecords.length:0)+1;break;case t.Gantt.RowPosition.Child:i=i+"."+((n.childRecords?n.childRecords.length:0)+1)}return i.toString()},_getNewTaskId:function(e){var i=this,a=i.model.viewType==t.Gantt.ViewType.ResourceView?i._resourceUniqTaskIds:i.model.ids,r=t.isNullOrUndefined(e)?i._lastInsertedId>0?i._lastInsertedId+1:1:e;return a.indexOf(r.toString())>-1?i._getNewTaskId(r+1):r},_updateLastInsertedId:function(e,t){var i=this,a=isNaN(parseInt(e))?i._lastInsertedId<1?1:i._lastInsertedId:parseInt(e);i._lastInsertedId=t?i._lastInsertedId<a?a:i._lastInsertedId+1:i._lastInsertedId<a?a:i._lastInsertedId},contextMenuAction:function(e){var t,i=this;"contextMenuAdd"==e.requestType&&i._sendAddRequest(),"contextMenuIndent"==e.requestType&&i._sendIndentRequest(),"contextMenuOutdent"==e.requestType&&i._sendOutdentRequest(),"contextMenuDelete"==e.requestType&&("resourceView"==this.model.viewType&&"resourceChildTask"==e.data.eResourceTaskType?this.deleteResourceChildTask(e.data):i._$treegridHelper.ejTreeGrid("deleteRow",null,!0,i._contextMenuSelectedIndex)),"contextMenuTaskDetails"==e.requestType&&((t={}).isResourceView="resourceView"==this.model.viewType,t.data=e.data,i._sendEditRequest(null,t))},_renderContextMenu:function(a,r,n){var o,l,d,s,c,u,p,h,g=this,m={},_=g._getCoordinate(a);if(g._contextMenuSelectedIndex=r,g._contextMenuSelectedItem=n,g._contextMenuEvent=a,c=g._$treegridHelper.ejTreeGrid("getCellIndex",a),a||(a=window.event),_.pageX||_.pageY?(o=_.pageX,l=_.pageY):(a.clientX||a.clientY)&&(o=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,l=a.clientY+document.body.scrollTop+document.documentElement.scrollTop),(u=this._$treegridHelper.ejTreeGrid("getOffsetRect",g.element[0])).bottom=u.top+this.element[0].offsetHeight,u.right=u.left+e(this.element).width(),m.requestType="ContextMenuOpen",m.contextMenuItems=g._contextMenuItems,m.columnIndex=c,m.item=g._contextMenuSelectedItem,m.targetElement=a,m.index=r,!g._trigger("contextMenuOpen",m)&&(g._activeMenuItemId=null,g._contextMenuItems=m.contextMenuItems,0!=g._contextMenuItems.length)){d=t.buildTag("div.e-tgcontextmenu e-js","",{position:"absolute","z-index":g._$treegridHelper.ejTreeGrid("getMaxZIndex")+1},{id:g._id+"_ContextMenu"}),g.model.cssClass&&d.addClass(g.model.cssClass),p=m.contextMenuItems.filter(function(e){if(null==e.parentMenuId||e.parentMenuId==i)return!0}),s=t.buildTag("ul.e-gantt-contextmenu",e.render[g._id+"contextMenuTemplate"](p),{margin:"0px","padding-left":"0px","list-style-type":"none"},{"data-icon":!1,"data-role":"list-divider"}),d.append(s),e(document.body).append(d);var f=e(d).outerHeight(),w=e(d).outerWidth(),C=d.find(".e-menuitem");if(C.width(w+2),w=e(d).outerWidth(),(u.left>o||u.right<o+w)&&(u.right<o+w&&(o-=w),o<0&&(o=u.left+10)),u.bottom<l+f){var T=l-f,x=(u.bottom,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);T>u.top?l=T:l+f>x+window.innerHeight&&((h=l-(l+f-(x+window.innerHeight)))>0&&(l=parseInt(h)))}else e(window).height()+e(window).scrollTop()<l+f&&(l-=f);d.css({left:o+"px",top:l+"px"}),g._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement"),e(d).css({height:"auto"}),g._on(d,"contextmenu",function(e){e.preventDefault()}),e(C).click(function(){g._contextMenuClickHandler(this)}),e(C).mouseenter(function(){e(this).hasClass("e-disable")||(d.find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),e(this).addClass("e-tgcontextmenu-mouseover"),g._activeMenuItemId=e(this).attr("id"),g._showSubContextMenu(this,m.contextMenuItems))}),a.preventDefault()}},_showSubContextMenu:function(i,a){var r,n,o,l,d,s,c=this.model,u=this,p=[],h=e(i).attr("id");o=a.filter(function(e){return e.menuId==h&&(p=e),e.parentMenuId==h||void 0}),p.parentMenuId||e(".e-tginnerContextmenu").remove(),p.parentMenuId&&this._removeContextMenu(p,a),o.length>0&&(r=t.buildTag("div.e-tginnerContextmenu e-js","",{position:"absolute","z-index":u._$treegridHelper.ejTreeGrid("getMaxZIndex")+1},{id:this._id+"_SubContextMenu"+h}),c.cssClass&&r.addClass(c.cssClass),n=t.buildTag("ul.e-gantt-innercontextmenu",e.render[u._id+"contextMenuTemplate"](o),{margin:"0px","padding-left":"0px"},{"data-icon":!1,type:"none","data-role":"list-divider"}),r.append(n),e(document.body).append(r),l=r.find(".e-menuitem"),d=e(r).outerWidth(),l.width(d>100?d:100),s=u._getSubContextMenuPosition(i,r),e(r).css({top:s.top,left:s.left}),e(l).mouseenter(function(){e(this).hasClass("e-disable")||(u._showSubContextMenu(this,a),e(this).closest(".e-tginnerContextmenu").find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),e(this).addClass("e-tgcontextmenu-mouseover"),u._activeMenuItemId=e(this).attr("id"))}),u._on(r,"contextmenu",function(e){e.preventDefault()}),e(l).click(function(){u._contextMenuClickHandler(this)}))},_removeContextMenu:function(t,i){var a,r,n=e("#"+this._id+"_SubContextMenu"+t.parentMenuId),o=e(n).find(".e-tgcontextmenu-mouseover");e(o).length>0&&((a=i.filter(function(t){if(t.menuId==e(o).attr("id"))return!0})).length>0&&((r=i.filter(function(e){if(e.parentMenuId==a[0].menuId)return!0})).length>0&&this._removeContextMenu(r[0],i)),e("#"+this._id+"_SubContextMenu"+e(o).attr("id")).remove())},_getSubContextMenuPosition:function(t,i){this.model;var a,r,n,o,l,d=e(i).outerWidth(),s=e(i).outerHeight(),c=this._$treegridHelper.ejTreeGrid("getOffsetRect",t),u={top:"",left:""},p=e(t).closest(".e-tgcontextmenu");if(0==p.length&&(p=e(t).closest(".e-tginnerContextmenu")),r=e(p).outerWidth(),u.top=c.top-1,u.left=c.left+e(p).width()+1,u.bottom=u.top+e(t).outerHeight(),a=u.left,(n=this._$treegridHelper.ejTreeGrid("getOffsetRect",this.element[0])).bottom=n.top+this.element[0].offsetHeight,n.right=n.left+e(this.element).width(),(n.left>a||n.right<a+d)&&(n.right<a+d&&(a=a-r-d),a>0&&(u.left=a)),n.bottom<u.top+s){var h=u.bottom-s,g=(u.top,n.bottom,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);h>n.top?u.top=h+2:u.top+s>g+window.innerHeight&&(o=u.top+s-(g+window.innerHeight),(l=u.top-o)>0&&(u.top=parseInt(l)))}return u},_contextMenuClickHandler:function(t){var i=e(t).attr("id"),a=this,r=this.model,n={};if(!e(t).hasClass("e-disable")&&0==e(t).find(".e-expander").length)switch(i){case"Task":n.requestType="contextMenuTaskDetails",n.data=a._contextMenuSelectedItem,a.contextMenuAction(n),a._clearContextMenu();break;case"Indent":n.requestType="contextMenuIndent",a.contextMenuAction(n),a._clearContextMenu(),a._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Outdent":n.requestType="contextMenuOutdent",a.contextMenuAction(n),a._clearContextMenu(),a._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Delete":n.requestType="contextMenuDelete",n.data=a._contextMenuSelectedItem,a.contextMenuAction(n),a._clearContextMenu(),a._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Above":n.requestType="save",n.position="Above",a.subContextMenuAction(n),a._clearContextMenu(),a._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Below":n.requestType="save",n.position="Below",a.subContextMenuAction(n),a._clearContextMenu(),a._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Open":n.requestType="contextMenuAdd",a.contextMenuAction(n),a._clearContextMenu(),a._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement");break;case"Add":"resourceView"==r.viewType?this.openAddDialog():a._setInitialData();break;default:n.data=a._contextMenuSelectedItem,a._triggerMenuEventHandler(i,n),a._clearContextMenu()}},_triggerMenuEventHandler:function(i,a){var r,n,o,l,d=this._contextMenuItems;t.isNullOrUndefined(d)||(r=d.filter(function(e){if(e.menuId.toString()===i)return!0})).length>0&&(n=r[0],a.menuId=i,(o=n.eventHandler)&&("string"==typeof o&&(o=t.util.getObject(o,window)),e.isFunction(o)&&(l=t.event("customContextMenuHandler",this.model,a),o.call(this,l))))},_setInitialData:function(){var e=this;0==e.model.flatRecords.length&&(e.addRecord(),e._clearContextMenu())},updateAltRow:function(t,i,a){var r=this;if(r.model.enableAltRow){var n,o=0,l=r.model.currentViewData,d=l.length,s=t.isAltRow,c=e(r._gridRows);for(o=i+a;o<d;o++)"none"!==e(c[o]).css("display")&&((n=l[o]).isAltRow=!s,(s=n.isAltRow)?e(c[o]).addClass("e-alt-row"):e(c[o]).removeClass("e-alt-row"))}},renderedEditDialog:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_=this,f=this.model,w=f.viewType==t.Gantt.ViewType.ProjectView?f.columns:_._resourceViewColumns,C=w.length,T={};switch(i.requestType){case t.TreeGrid.Actions.Add:if(o=document.createElement("div"),l=e("#"+_._id+"_dialogAdd"),e(o).addClass("e-addedrow"),o.innerHTML=e.render[_._id+"_JSONDialogAddingTemplate"](i.data),e(l).html(e(o)),(d={}).cssClass=f.cssClass,d.enableModal=!0,d.width="650px",d.height="auto",d.enableResize=!1,d.isResponsive=!1,d.contentSelector="#"+_._id,d.rtl=f.rtl,d.showOnInit=!1,d.allowKeyboardNavigation=!1,d.close=function(){e("#"+_._id+"AddAreaNotes").data("ejRTE")&&e("#"+_._id+"AddAreaNotes").ejRTE("destroy")},d.beforeClose=function(t){_._closeAddEditDialog(t,"Add")?(t.cancel=!0,e("#AddDialog_"+_._id+"_Cancel").css("pointer-events","auto")):_._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement")},c=_._editDialogTexts.addFormTitle,d.title=c,_._editedDialogRecord={},u=e("#"+_._id+"AddTab"),e(u).ejTab({headerSize:"25px",height:"310px",heightAdjustMode:t.Tab.HeightAdjustMode.None,locale:f.locale,cssClass:f.cssClass,allowKeyboardNavigation:f.allowKeyboardNavigation,enableAnimation:!1,itemActive:function(t){var i=e(t.activeHeader).find("a").attr("href");i=="#"+_._id+"AddNotes"?e("#"+_._id+"AddAreaNotes_Iframe").height("202"):i=="#"+_._id+"AddCustomFields"?e("#treegrid"+_._id+"customFieldAdd").ejTreeGrid("instance").setModel({sizeSettings:{width:"620",height:"280px"}}):i=="#"+_._id+"AddPredecessors"?e("#treegrid"+_._id+"predecessorAdd").ejTreeGrid("instance").setModel({sizeSettings:{width:"620",height:"240px"}}):i=="#"+_._id+"AddResources"&&e("#treegrid"+_._id+"resourceAdd").ejTreeGrid("instance").setModel({sizeSettings:{width:"620",height:"240px"}})}}),e(u).find("div.e-hidebottom.e-addborderbottom.e-content").css("min-height","283px"),e(u).find("div.e-content").css("overflow","visible"),p=e(u).find(".e-addborderbottom .e-bottom-line .e-link"),h=e(u).find(".e-addborderbottom.e-header").outerHeight()/2-(parseFloat(p.css("padding-top"))+parseFloat(p.css("padding-bottom"))),p.css("margin-top",h+"px"),e(l).ejDialog(d),e(l).ejDialog("instance").contentDiv.ejScroller("setModel",{scrollerSize:0}),(g={}).data=i.data,g.rowPosition=f.editSettings.rowPosition,g.requestType="beforeOpenAddDialog",g.element=e("#"+_._id+"_dialogAdd"),!_._trigger("actionBegin",g)){for(_._isinAddnewRecord=!0,a=0;a<C;a++)T[w[a].field]=g.data[w[a].mappingName];i.data=T,_._refreshEditForm(i),g.data=i.data,g.requestType="OpenAddDialog",g.element=e("#"+_._id+"_dialogAdd"),_._trigger("actionBegin",g)||(m=e("#"+_._id+"_dialogAdd_wrapper"),e(l).find(".e-addedrow").css("overflow","visible"),m.addClass("e-ganttdialog"),e(l).ejDialog("refresh"),e(l).addClass("e-content"),e(l).ejDialog("open"))}e(u).find("div#"+_._id+"AddGeneral.e-content").css({"overflow-y":"auto","overflow-x":"hidden"}),_._addPosition=g.rowPosition,r=this._getDateFromFormat(f.scheduleStartDate),this._getSecondsInDecimal(r)!=this._defaultStartTime&&this._setTime(this._defaultStartTime,r),this._editedDialogRecord.isUpdatedFromDialog=!1,n=f.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Auto||f.taskSchedulingMode!=t.Gantt.TaskSchedulingMode.Manual&&(f.taskSchedulingMode==t.Gantt.TaskSchedulingMode.Custom?1!=i.data.taskMode:f.taskSchedulingMode),_._editedDialogRecord.isAutoSchedule=n,_._editedDialogRecord.startDate=i.data.startDate?this._checkStartDate(new Date(i.data.startDate)):this._checkStartDate(new Date(r)),_._editedDialogRecord.endDate=i.data.endDate?_._editedDialogRecord.startDate.getTime()>new Date(i.data.endDate).getTime()?new Date(_._editedDialogRecord.startDate):new Date(i.data.endDate):new Date(_._editedDialogRecord.startDate),_._editedDialogRecord.duration=""!=i.data.duration?i.data.duration:f.viewType==t.Gantt.ViewType.ResourceView?1:0,_._editedDialogRecord.durationUnit=f.durationUnit;break;case t.TreeGrid.Actions.BeginEdit:o=document.createElement("div"),l=e("#"+_._id+"_dialogEdit"),e(o).addClass("e-editedrow"),o.innerHTML=e.render[_._id+"_JSONDialogEditingTemplate"](i.data),e(l).html(e(o)),(d={}).cssClass=_.model.cssClass,d.rtl=f.rtl,d.width="650px",d.height="auto",d.enableResize=!1,d.isResponsive=!1,d.contentSelector="#"+_._id,d.enableModal=!0,d.showOnInit=!1,d.allowKeyboardNavigation=!1,d.close=function(){e("#"+_._id+"EditAreaNotes").data("ejRTE")&&e("#"+_._id+"EditAreaNotes").ejRTE("destroy")},d.beforeClose=function(t){_._closeAddEditDialog(t,"Edit")?(t.cancel=!0,e("#EditDialog_"+_._id+"_Cancel").css("pointer-events","auto")):_._$treegridHelper.ejTreeGrid("setFocusOnTreeGridElement")},f.viewType==t.Gantt.ViewType.ResourceView?(s=i.data,_._resourceEditedRecord=i.data):s="row"==f.selectionMode?_.selectedItem():_.model.updatedRecords[_._rowIndexOfLastSelectedCell],c=_._editDialogTexts.editFormTitle,d.open=function(){var t=this._id,i=e("#"+t+"_title").children(".e-title");i.width("450px"),i.css({"word-wrap":"normal","text-overflow":"ellipsis","white-space":"nowrap",display:"inline-block","overflow-x":"hidden",float:"left"}),i.attr("title",c)},d.title=c,u=e("#"+_._id+"EditTab"),e(u).ejTab({headerSize:"25px",height:"310px",heightAdjustMode:t.Tab.HeightAdjustMode.None,locale:f.locale,allowKeyboardNavigation:f.allowKeyboardNavigation,cssClass:f.cssClass,enableAnimation:!1,itemActive:function(t){var i=e(t.activeHeader).find("a").attr("href");i=="#"+_._id+"EditNotes"?e("#"+_._id+"EditAreaNotes_Iframe").height("202"):i=="#"+_._id+"EditCustomFields"?e("#treegrid"+_._id+"customFieldEdit").ejTreeGrid("instance").setModel({sizeSettings:{width:"620",height:"279px"}}):i=="#"+_._id+"EditPredecessors"?e("#treegrid"+_._id+"predecessorEdit").ejTreeGrid("instance").setModel({sizeSettings:{width:"620",height:"240px"}}):i=="#"+_._id+"EditResources"&&e("#treegrid"+_._id+"resourceEdit").ejTreeGrid("instance").setModel({sizeSettings:{width:"620",height:"240px"}})}}),e(u).find("div.e-content").css("overflow","visible"),e(u).find("div#"+_._id+"EditGeneral.e-content").css({"overflow-y":"auto","overflow-x":"hidden"}),e(u).find("div.e-hidebottom.e-addborderbottom.e-content").css("min-height","283px"),p=e(u).find(".e-addborderbottom .e-bottom-line .e-link"),h=e(u).find(".e-addborderbottom.e-header").outerHeight()/2-(parseFloat(p.css("padding-top"))+parseFloat(p.css("padding-bottom"))),p.css("margin-top",h+"px"),e(l).ejDialog(d),e(l).ejDialog("instance").contentDiv.ejScroller("setModel",{scrollerSize:0}),(g={}).data=i.data,g.requestType="beforeOpenEditDialog",g.element=e("#"+_._id+"_dialogEdit"),_._trigger("actionBegin",g)||(_._editedDialogRecord=jQuery.extend({},s),_._editedDialogRecord.resourceInfo&&(_._editedDialogRecord.resourceInfo=jQuery.extend(!0,[],s.resourceInfo)),this._editedDialogRecord.isUpdatedFromDialog=!1,_._refreshEditForm(i),g.data=i.data,g.requestType="openEditDialog",g.element=e("#"+_._id+"_dialogEdit"),_._trigger("actionBegin",g)||(m=e("#"+_._id+"_dialogEdit_wrapper"),e(l).find(".e-editedrow").css("overflow","visible"),m.addClass("e-ganttdialog"),e(l).ejDialog("refresh"),e(l).addClass("e-content"),e(l).ejDialog("open"))),this._editedDialogRecord&&(this._editedDialogRecord.isUpdatedFromDialog=!1)}},_closeAddEditDialog:function(e,t){var i,a=this;if(!a._isAddEditDialogSave)return(i={}).requestType="Add"===t?"closeAddDialog":"closeEditDialog",a._trigger("actionBegin",i);a._isAddEditDialogSave=!1},editFormValidate:function(){return!(e.isFunction(e.validator)&&e("#"+this._id+"GeneralEditForm").length>0)||e("#"+this._id+"GeneralEditForm").validate().form()},addFormValidate:function(){return!(e.isFunction(e.validator)&&e("#"+this._id+"GeneralAddForm").length>0)||e("#"+this._id+"GeneralAddForm").validate().form()},getCurrentData:function(){var e,t=this,i=t.getUpdatedRecords();return"row"==t.model.selectionMode?t.model.selectedItems:-1!=(e=t._rowIndexOfLastSelectedCell)?i&&[i[e]]:void 0},getCurrentViewData:function(){return this._$treegridHelper.ejTreeGrid("getCurrentViewData")},getUpdatedCurrentViewData:function(){return this._$treegridHelper.ejTreeGrid("getUpdatedCurrentViewData")},getRows:function(){return this._$treegridHelper.ejTreeGrid("getRows")},getSelectedCells:function(){return this._$treegridHelper.ejTreeGrid("getSelectedCells")},getGanttChartRows:function(){return this._$ganttchartHelper.ejGanttChart("getGanttChartRows")},getUpdatedRecords:function(){return this._$treegridHelper.ejTreeGrid("getUpdatedRecords")},_getToolBarHeight:function(){var e=0;return this.model.toolbarSettings.showToolbar&&(e=this.element.find(".e-gantttoolbar").height()),e},_initValidator:function(){var i=this;e("#"+this._id+"EditForm").validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(a,r){var n=r.closest("td"),o=e(a).addClass("e-error"),l=t.buildTag("div.e-errortail e-toparrow");n.find(".e-error").remove(),r.hasClass("e-numerictextbox")?o.insertAfter(r.closest(".e-numeric")):o.insertAfter(r),o.prepend(l),"normal"!=i.model.editSettings.editMode&&o.offset({left:r.offset().left}),o.fadeIn("slow")}})},setValidation:function(){this._initValidator();for(var e=0;e<this._columns.length;e++)t.isNullOrUndefined(this._columns[e].validationRules)||this.setValidationToField(this._columns[e].field,this._columns[e].validationRules)},setValidationToField:function(i,a){var r;(e("#"+this._id+i).length>0?e("#"+this._id+i):e("#"+i)).rules("add",a),r=e("#"+this._id+"EditForm").validate(),t.isNullOrUndefined(a.required)||(r.settings.messages.Name={},r.settings.messages.Name.required=t.TreeGrid.getColumnByField(this._columns,i).headerText+" is required")},_updateEditedGanttRecords:function(a,r){var n,o,l,d,s,c,u,p,h,g=this,m=g.model,_=a.data,f=g._getDateFromFormat(_.startDate);_.isAutoSchedule;"startDate"===a.columnName?(o=e.extend({},a.data),f=g._checkStartDate(f,_),_.startDate=g._getDateFromFormat(f),t.isNullOrUndefined(_.startDate)?(_.duration=null,_.item[m.durationMapping]=null,_.isMilestone=!1):(_.endDate||!t.isNullOrUndefined(_.duration))&&_._calculateEndDate(this),m.startDateMapping&&(_.item[m.startDateMapping]=_.startDate),_.isMilestone=0==_.duration,_.left=_._calculateLeft(this),_.width=_._calculateWidth(this),_.hasChildRecords?!_.isAutoSchedule&&_.hasChildRecords&&a.previousValue.getTime()!=_.startDate.getTime()&&((l={}).previousData=o,l.previousData.startDate=a.previousValue,l.data=_,g._validateAutoChildRecords(l)):_.progressWidth=_._getProgressWidth(_.width,_.status),_.parentItem&&_.parentItem.isAutoSchedule?g._updateParentItem(_):_.parentItem&&!_.parentItem.isAutoSchedule&&g._updateManualParentItem(_)):"endDate"===a.columnName?(c=g._getDateFromFormat(_.endDate),d=_.duration,t.isNullOrUndefined(c)?(_.endDate=c,_.duration=null,_.item[m.durationMapping]=null,_.isMilestone=!1):(0==c.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,c),_.endDate=this._checkEndDate(c,_),!t.isNullOrUndefined(f)&&t.isNullOrUndefined(d)?-1==g._compareDates(_.endDate,f)&&(_.endDate=new Date(f),this._setTime(this._defaultEndTime,_.endDate)):!t.isNullOrUndefined(d)&&t.isNullOrUndefined(f)&&(_.startDate=this._getStartDate(_.endDate,d,_.durationUnit,_))),-1==g._compareDatesFromRecord(_)?_._calculateDuration(this):t.isNullOrUndefined(_.endDate)||(_.endDate=a.previousValue,_.item[m.endDateMapping]=a.previousValue),_.isMilestone=0==_.duration,_.width=_._calculateWidth(this),_.left=_._calculateLeft(this),_.hasChildRecords||(_.progressWidth=_._getProgressWidth(_.width,_.status)),g._updateResourceRelatedFields(_),m.endDateMapping&&(_.item[m.endDateMapping]=_.endDate),_.isMilestone&&(_.startDate=this._checkStartDate(_.startDate,_),m.startDateMapping&&(_.item[m.startDateMapping]=_.startDate)),_.parentItem&&_.parentItem.isAutoSchedule?g._updateParentItem(_):_.parentItem&&!_.parentItem.isAutoSchedule&&g._updateManualParentItem(_)):"duration"==a.columnName||g._isDurationUpdated?(s=_.duration,c=_.endDate,t.isNullOrUndefined(s)?(_.isMilestone=!1,_.endDate=null,m.endDateMapping&&(_.item[m.endDateMapping]=null)):(t.isNullOrUndefined(f)&&!t.isNullOrUndefined(c)&&(_.startDate=g._getStartDate(c,s,_.durationUnit,_),m.startDateMapping&&(_.item[m.startDateMapping]=_.startDate)),0!=s&&_.isMilestone&&(_.isMilestone=!1,_.startDate=this._checkStartDate(_.startDate,_),m.startDateMapping&&(_.item[m.startDateMapping]=_.startDate)),_.isMilestone=0==_.duration,_._calculateEndDate(this)),_.width=_._calculateWidth(this),_.left=_._calculateLeft(this),_.hasChildRecords||(_.progressWidth=_._getProgressWidth(_.width,_.status)),_.parentItem&&_.parentItem.isAutoSchedule?g._updateParentItem(_):_.parentItem&&!_.parentItem.isAutoSchedule&&g._updateManualParentItem(_)):"predecessor"==a.columnName||"serialNumberPredecessor"==a.columnName?((n="serialNumberPredecessor"==a.columnName?a.prevDefaultPredecessors:a.previousValue)&&g._removeConnectorLine(n,_),g._addConnectorLine(_)):"status"==a.columnName?(_.status=_.status>100?100:_.status,_.hasChildRecords||(_.progressWidth=g._getProgressWidth(_.width,_.status)),_.parentItem&&_.parentItem.isAutoSchedule?g._updateParentItem(_):_.parentItem&&!_.parentItem.isAutoSchedule&&g._updateManualParentItem(_)):"taskMode"==a.columnName?g._updateGanttRecord(_):("baselineStartDate"==a.columnName||"baselineEndDate"==a.columnName)&&(u=g._getDateFromFormat(_.baselineStartDate),(p=g._getDateFromFormat(_.baselineEndDate))&&0==p.getHours()&&86400!=this._defaultEndTime&&this._setTime(this._defaultEndTime,p),_.baselineStartDate=this._checkBaseLineStartDate(u),_.baselineEndDate=this._checkBaseLineEndDate(p),_.baselineStartDate&&_.baselineEndDate&&(_.baselineLeft=_._calculateBaselineLeft(this),_.baselineRight=_._calculateBaselineRight(this),_.baselineWidth=_._calculateBaseLineWidth(this))),_.predecessor&&(g._isMileStoneEdited=_.isMilestone,g._updatedConnectorLineCollection=[],g._connectorlineIds=[],"predecessor"===a.columnName||"serialNumberPredecessor"===a.columnName?(g._isPredecessorEdited=!0,m.enablePredecessorValidation?g._validatePredecessor(_,n):(h=!0,g._validatePredecessorOnEditing(_,h)),g._isPredecessorEdited=!1):g._validatePredecessor(_,i,"successor"),g._updatedConnectorLineCollection.length>0&&"projectView"==m.viewType&&(g._$ganttchartHelper.ejGanttChart("appendConnectorLine",g._updatedConnectorLineCollection),this._updateConnectorLineCollection(g._updatedConnectorLineCollection))),g._isValidationEnabled=!1,r&&g.refreshGanttRecord(_)},_updateEditedGanttRecord:function(e){var t=this;if(e.predecessor&&"projectView"==this.model.viewType){var i,a,r,n,o=e.predecessor,l=0,d=o.length,s=t.model,c=s.flatRecords,u=s.ids;for(l=0;l<d;l++)t._updatedConnectorLineCollection=[],t._connectorlineIds=[],(i=o[l]).to===e.taskId.toString()&&(a=c[u.indexOf(i.from)],r=c[u.indexOf(i.to)],a&&r&&(n="parent"+a.taskId+"child"+r.taskId,t._$ganttchartHelper.ejGanttChart("removeConnectorline",n),this._updateConnectorLineCollection(n),t._updateConnectorLineId(a,r,i)))}},_updateTargetGanttRecord:function(e){var t=this;t.model;e.startDate=t._checkStartDate(e.startDate,e),e.endDate=this._getEndDate(e.startDate,e.duration,e.durationUnit,e),e.left=e._calculateLeft(this),e.width=e._calculateWidth(this),e.progressWidth=e._getProgressWidth(e.width,e.status),e.parentItem&&(1==e.parentItem.isAutoSchedule?t._updateParentItem(e):t._updateManualParentItem(e)),t.refreshGanttRecord(e)},_updateGanttRecord:function(e){var t=this;t.model;e.hasChildRecords&&e.isAutoSchedule?(e.startDate=t._checkStartDate(e.manualStartDate,e),e.left=e._calculateManualLeft(this),e.width=e._calculateManualWidth(this),e.progressWidth=e._getProgressWidth(e.width,e.status),e.endDate=e.manualEndDate,e._calculateDuration(this)):e.hasChildRecords&&!e.isAutoSchedule?(e.left=e._calculateLeft(this),e.width=e._calculateWidth(this),e._calculateDuration(this),e.manualStartDate=e.startDate,e.manualEndDate=e.endDate,t._updateManualParentItem(e,null,!0)):(e.startDate=t._checkStartDate(e.startDate,e),e._calculateEndDate(this),e.left=e._calculateLeft(this),e.width=e._calculateWidth(this),e.progressWidth=e._getProgressWidth(e.width,e.status)),e.parentItem&&e.parentItem.isAutoSchedule&&t._updateParentItem(e),e.parentItem&&!e.parentItem.isAutoSchedule&&t._updateManualParentItem(e),t.refreshGanttRecord(e)},refreshGanttRecord:function(i,a,r){var n,o,l,d=this;d._isTreeGridRendered&&(d.model.currentViewData=d.getCurrentViewData(),l=d.model.currentViewData.indexOf(i),(n=d._$treegridHelper.ejTreeGrid("instance")).model.allowSelection=d.model.allowSelection,t.TreeGrid.refreshRow(n,l),d._isGanttChartRendered&&d._$ganttchartHelper.ejGanttChart("refreshRow",l),a=a||i,d._isLastRefresh||"groupTask"==a.eResourceTaskType||"resourceTask"==a.eResourceTaskType?"groupTask"!=a.eResourceTaskType&&"resourceTask"!=a.eResourceTaskType&&((o={}).data=a,o.item=a.item,o.requestType="recordUpdate",(l=e.map(d._actionCompleteData,function(e,t){if(e==a)return t})).length&&d._actionCompleteData.splice(l[0],1),d._actionCompleteData.length&&(o.updatedRecords=d._actionCompleteData,d._actionCompleteData=[]),d._isLastRefresh=!1,d._trigger("actionComplete",o)):(l=e.map(d._actionCompleteData,function(e,t){if(e==a)return t})).length?d._actionCompleteData[l[0]]=a:(t.isNullOrUndefined(r)||r&&d.model.enableSerialNumber)&&d._actionCompleteData.push(a))},_updateManualParentItem:function(e,i,a){for(var r,n,o=this,l=a?e:e.parentItem,d=o.model,s=l.manualStartDate,c=l.manualEndDate,u=0,p=l.childRecords,h=p&&p.length,g=null,m=null,_=0,f=0,w=0,C=0;C<h;C++){var T=p[C],x=o._getValidStartDate(T),v=o._getValidEndDate(T);if(!T.isAutoSchedule&&T.hasChildRecords){var b=T.manualStartDate,S=T.manualEndDate,D=x,R=v;x=-1==o._compareDates(b,D)?T.manualStartDate:T.startDate,v=1==o._compareDates(S,R)?T.manualEndDate:T.endDate}null===g&&(g=o._getDateFromFormat(x)),null===m&&(m=o._getDateFromFormat(v)),t.isNullOrUndefined(v)||1!=o._compareDates(v,m)||(m=o._getDateFromFormat(v)),t.isNullOrUndefined(x)||-1!=o._compareDates(x,g)||(g=o._getDateFromFormat(x)),w+=parseInt(T.work),T.isMilestone&&!T.hasChildRecords||!T._isScheduledTask()?_++:(f+=(n=o._getParentProgress(T)).totalProgress,u+=n.totalDuration)}0!=o._compareDates(s,g)&&(l.manualStartDate=o._getDateFromFormat(g)),0!=o._compareDates(c,m)&&(l.manualEndDate=o._getDateFromFormat(m)),(o._isLoad||o._isChartRendering)&&(l._calculateDuration(this),l.width=l._calculateWidth(this)),l.left=l._calculateLeft(this),l.manualLeft=l._calculateManualLeft(this),l._calculateManualDuration(this),l.manualWidth=l._calculateManualWidth(this),l._updateWorkWithDuration(o),l.work+=w,d.workMapping&&(l.item[d.workMapping]=l.work),r=h-_>0?Math.round(f/u):0,l.progressWidth=o._getProgressWidth(l.manualWidth,r),l.status=Math.floor(r),l.totalProgress=f,l.totalDuration=u,d.progressMapping&&(l.item[d.progressMapping]=l.status),(o._isTreeGridRendered||o._isGanttChartRendered)&&o.refreshGanttRecord(l),l.parentItem&&l.parentItem.isAutoSchedule&&!a?o._updateParentItem(l):!l.parentItem||l.parentItem.isAutoSchedule||a||o._updateManualParentItem(l,i)},_getMaxValues:function(e){var t,i,a,r,n,o=0,l=e,d=l&&l.length,s=null,c=null,u=0,p=0,h=0,g={};for(o=0;o<d;o++)a=(t=l[o]).startDate,r=t.endDate,t.hasChildRecords&&!t.isAutoSchedule&&(a=t.startDate.getTime()>t.manualStartDate.getTime()?t.manualStartDate:t.startDate),t.hasChildRecords&&!t.isAutoSchedule&&(r=t.endDate.getTime()<t.manualEndDate.getTime()?t.manualEndDate:t.endDate),null===s&&(s=new Date(a)),null===c&&(c=new Date(r)),r.getTime()>c.getTime()&&(c=new Date(r)),a.getTime()<s.getTime()&&(s=new Date(a)),h+=parseInt(t.work),t.isMilestone?u++:p+=parseInt(t.status);return i=(n=d-u)>0?p/n:0,g.startDate=s,g.endDate=c,g.status=i,g.work=h,g.milestoneCount=u,g},_checkSharedTasks:function(e,t){var i,a,r;this.model;if(a=(i=t.eResourceChildTasks).length,"resourceChildTask"==t.eResourceTaskType||"resourceTask"==t.eResourceTaskType)for(r=0;r<a;r++)if(e.taskId==i[r].taskId)return i[r]},_updateResourceResourceDetails:function(e,i){var a,r,n,o=this.model,l=e,d={};if(e.resourceInfo=t.isNullOrUndefined(e.resourceInfo)?[]:e.resourceInfo,a=e.resourceInfo,"resourceChildTask"==e.eResourceTaskType){if(l=e.parentItem,d[o.resourceIdMapping]=l.taskId,d[o.resourceNameMapping]=l.eResourceName,d[o.resourceUnitMapping]=100,a.length>0&&!t.isNullOrUndefined(i))for(r=a.length,n=0;n<r;n++)if(a[n][o.resourceIdMapping]==i){a.splice(n,1);break}e.resourceInfo.push(d)}else"resourceTask"==e.eResourceTaskType?l=e.parentItem:"groupTask"==e.eResourceTaskType&&(l=e)},_updateResourceParentItem:function(e){var t,i,a=this.model,r=e,n=[];if("resourceChildTask"==e.eResourceTaskType?r=e.parentItem.parentItem:"resourceTask"==e.eResourceTaskType?r=e.parentItem:"groupTask"==e.eResourceTaskType&&(r=e),r&&r.hasChildRecords&&r.childRecords.length>0){for(t=0;t<r.childRecords.length;t++)n.push.apply(n,r.childRecords[t].eResourceChildTasks);i=this._getMaxValues(n),r.startDate=new Date(i.startDate),r.endDate=new Date(i.endDate),r._calculateDuration(this),r.left=r._calculateLeft(this),r.width=r._calculateWidth(this),i.milestoneCount==r.childRecords.length&&(r.startDate.getTime()==r.endDate.getTime()?r.width=2*Math.floor((a.rowHeight-6)/2):r.width+=2*Math.floor((a.rowHeight-6)/2)),r.progressWidth=this._getProgressWidth(r.width,i.status),r.status=Math.floor(i.status),r.work+=i.work,(this._isTreeGridRendered||this._isGanttChartRendered)&&this.refreshGanttRecord(r)}},_getParentProgress:function(e){var t=0,i={};switch(e.durationUnit){case"hour":t=e.duration/(this._secondsPerDay/3600);break;case"minute":t=e.duration/(this._secondsPerDay/60);break;default:t=e.duration}return e.hasChildRecords?(i.totalProgress=e.totalProgress,i.totalDuration=e.totalDuration):(i.totalProgress=e.status*t,i.totalDuration=t),i},_updateParentItem:function(e,i,a){for(var r,n,o=this,l=a?e:e.parentItem,d=o.model,s=l.startDate,c=l.endDate,u=l.childRecords,p=u&&u.length,h=0,g=null,m=null,_=0,f=0,w=0,C=0;C<p;C++){var T=u[C],x=o._getValidStartDate(T),v=o._getValidEndDate(T);T.hasChildRecords&&!T.isAutoSchedule&&(x=1==o._compareDates(T.startDate,T.manualStartDate)?T.manualStartDate:T.startDate),T.hasChildRecords&&!T.isAutoSchedule&&(v=-1==o._compareDates(T.endDate,T.manualEndDate)?T.manualEndDate:T.endDate),null===g&&(g=o._getDateFromFormat(x)),null===m&&(m=o._getDateFromFormat(v)),t.isNullOrUndefined(v)||1!=o._compareDates(v,m)||(m=o._getDateFromFormat(v)),t.isNullOrUndefined(x)||-1!=o._compareDates(x,g)||(g=o._getDateFromFormat(x)),w+=parseInt(T.work),!T.isMilestone&&T._isScheduledTask()?(f+=(n=o._getParentProgress(T)).totalProgress,h+=n.totalDuration):_++}0!=o._compareDates(s,g)&&(l.startDate=o._getDateFromFormat(g),d.startDateMapping&&(l.item[d.startDateMapping]=l.startDate)),0!=o._compareDates(c,m)&&(l.endDate=o._getDateFromFormat(m),d.endDateMapping&&(l.item[d.endDateMapping]=l.endDate)),l._calculateDuration(this),l.left=l._calculateLeft(this),l.width=l._calculateWidth(this),(_==l.childRecords.length||0==l.duration)&&0==o._compareDatesFromRecord(l)&&(l.width=2*Math.floor((d.rowHeight-6)/2)),r=p-_>0?Math.round(f/h):0,l.progressWidth=o._getProgressWidth(l.width,r),l.status=Math.floor(r),l.totalProgress=f,l.totalDuration=h,l._updateWorkWithDuration(o),l.work+=w,d.workMapping&&(l.item[d.workMapping]=l.work),l.taskType=t.Gantt.TaskType.FixedDuration,l.effortDriven="false",l.manualStartDate=l.startDate,l.manualEndDate=l.endDate,d.progressMapping&&(l.item[d.progressMapping]=l.status),(o._isTreeGridRendered||o._isGanttChartRendered)&&o.refreshGanttRecord(l),l.parentItem&&l.parentItem.isAutoSchedule&&!a?o._updateParentItem(l):!l.parentItem||l.parentItem.isAutoSchedule||a||o._updateManualParentItem(l)},_daydiff:function(e,t){return(new Date(t)-new Date(e))/864e5},_refreshChartAndGridRows:function(){var e,i,a,r=this,n=this.model;r._$treegridHelper.ejTreeGrid("processBindings"),(a={}).requestType=t.TreeGrid.Actions.Refresh,r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",a),r.model.updatedRecords=r.getUpdatedRecords(),r.model.currentViewData=r.getCurrentViewData(),e=r._$treegridHelper.ejTreeGrid("getCollapsedRecordCount"),r._totalCollapseRecordCount=e,i=r._$treegridHelper.ejTreeGrid("getRecordsHeight"),r._$ganttchartHelper.ejGanttChart("setUpdatedRecords",n.currentViewData,n.updatedRecords,n.flatRecords,n.ids),r._$ganttchartHelper.ejGanttChart("refreshHelper",n.currentViewData,n.updatedRecords,r._totalCollapseRecordCount),r._isInAdd||(r._$treegridHelper.ejTreeGrid("updateHeight"),r._$ganttchartHelper.ejGanttChart("updateHeight",i),r._$ganttchartHelper.ejGanttChart("setCollapsedRecordCount",e),r._$ganttchartHelper.ejGanttChart("refreshGridLinesTable",r.model.updatedRecords.length-e),n.enableAltRow&&n.currentViewData.length>0&&t.TreeGrid.updateAltRow(r,n.currentViewData[0],0,0),n.predecessorMapping&&r._refreshConnectorLines(!1,!0,!1))},_refreshGanttOnExpandCollapseAll:function(){var e=this,i={},a=this.model,r=0,n=0;if(a.enableVirtualization)i.requestType=t.TreeGrid.Actions.ExpandCollapse,e._$treegridHelper.ejTreeGrid("updateAltRowOnCollapseAll"),e._$treegridHelper.ejTreeGrid("updateAltRowOnRendering"),e._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",i),a.updatedRecords=e.getUpdatedRecords(),a.currentViewData=e.getCurrentViewData(),e._$ganttchartHelper.ejGanttChart("clearConnectorLines"),e._$ganttchartHelper.ejGanttChart("refreshHelper",e.model.currentViewData,e.model.updatedRecords),e._$treegridHelper.ejTreeGrid("updateHeight");else{if(e._isRefreshAddedRecord)return e._refreshChartAndGridRows(),void(e._isRefreshAddedRecord=!1);r=e._$treegridHelper.ejTreeGrid("getCollapsedRecordCount"),e._totalCollapseRecordCount=r,n=e._$treegridHelper.ejTreeGrid("getRecordsHeight"),e._$ganttchartHelper.ejGanttChart("clearConnectorLines"),e._$treegridHelper.ejTreeGrid("updateHeight"),e._$ganttchartHelper.ejGanttChart("setCollapsedRecordCount",r),e._$ganttchartHelper.ejGanttChart("updateHeight",n),e._$ganttchartHelper.ejGanttChart("refreshGridLinesTable",e.model.updatedRecords.length-r),a.enableAltRow&&a.currentViewData.length>0&&t.TreeGrid.updateAltRow(e,a.currentViewData[0],0,0)}a.predecessorMapping&&e._refreshConnectorLines(!1,!1,!0)},_collapsedRecords:function(){var e=this.model;return e.updatedRecords.filter(function(i){return null==i.parentItem?i:i.parentItem[e.expandStateMapping]||t.isNullOrUndefined(i.parentItem[e.expandStateMapping])?i:void 0})},_collapseRecordOnLoad:function(){var e,i,a=this,r=a.model,n=0,o={},l=(r.enableVirtualization,a.getRows());for(a._gridRows=l,a._isInExpandCollapseAll=!0,i=a._collapsedRecords(),n=0;n<i.length;n++)if(!(e=i[n])[r.expandStateMapping]){if(e[r.expandStateMapping]||t.isNullOrUndefined(e[r.expandStateMapping]))continue;o.data=e,o.recordIndex=n,o.expanded=!1,e.hasChildRecords&&(e[r.expandStateMapping]||t.TreeGrid.sendExpandCollapseRequest(a,o))}r.flatRecords.length>0&&a._refreshGanttOnExpandCollapseAll(),a._isInExpandCollapseAll=!1},_collapseAll:function(){var e,i,a,r=this,n=r.model,o=0,l={},d=r.getRows();for(i=(e=r._getAllParentRecord(n.parentRecords)).length,r._expandCollapseSettings.state="collapseAll",r._expandCollapseSettings.level=0,r._$treegridHelper.ejTreeGrid("cancelEditCell"),r._gridRows=d,r._isInExpandCollapse=!0,r._isInExpandCollapseAll=!0,l.isFromExpandCollapse=!0,r._clearMultiSelectPopup(),o=0;o<i;o++)o+1==i&&(l.isLastRefresh=!0),a=e[o],l.data=a,l.recordIndex=o,l.expanded=!1,a.hasChildRecords&&(r._expandCollapseInnerLevelRecord(a,l.expanded,l.isLastRefresh),(a.expanded||l.isLastRefresh)&&t.TreeGrid.sendExpandCollapseRequest(r,l));n.flatRecords.length>0&&r._refreshGanttOnExpandCollapseAll(),r._isInExpandCollapse=!1,r._isInExpandCollapseAll=!1},_expandCollapseInnerLevelRecord:function(e,i,a){var r,n=e.childRecords.length,o={};for(a&&(o.isLastRefresh=a),o.isFromExpandCollapse=!0,r=0;r<n;r++)e.childRecords[r].hasChildRecords&&(this._expandCollapseInnerLevelRecord(e.childRecords[r],i,o.isLastRefresh),o.data=e.childRecords[r],o.expanded=i,e.childRecords[r].expanded!==i&&t.TreeGrid.sendExpandCollapseRequest(this,o))},_expandAll:function(){var e,i=this,a=i.model,r=0,n={},o=i._getAllParentRecord(a.parentRecords),l=o.length;for(i._expandCollapseSettings.state="expandAll",i._expandCollapseSettings.level=0,i._isInExpandCollapse=!0,i._isInExpandCollapseAll=!0,n.isFromExpandCollapse=!0,i._clearMultiSelectPopup(),r=0;r<l;r++)r+1==l&&(n.isLastRefresh=!0),e=o[r],n.data=e,n.recordIndex=r,n.expanded=!0,e.hasChildRecords&&(i._expandCollapseInnerLevelRecord(e,n.expanded,n.isLastRefresh),(!e.expanded||n.isLastRefresh)&&t.TreeGrid.sendExpandCollapseRequest(i,n));a.flatRecords.length>0&&i._refreshGanttOnExpandCollapseAll(),i._isInExpandCollapse=!1,i._isInExpandCollapseAll=!1},_getAllParentRecord:function(e){return e.filter(function(e){if(e.hasChildRecords)return e})},_expandLevelData:function(){var e,i,a,r,n=this,o={},l=n.model,d=n._expandCollapseSettings.level;for(i=(e=l.enableVirtualization?n._getAllParentRecord(l.flatRecords):n._getAllParentRecord(l.updatedRecords)).length,o.isFromExpandCollapse=!0,r=0;r<i;r++)r+1==i&&l.enableVirtualization&&(o.isLastRefresh=!0),((a=e[r]).level==d||o.isLastRefresh)&&(o.data=a,o.expanded=a.level==d||a.expanded,t.TreeGrid.sendExpandCollapseRequest(n,o),a.level==d&&(a.parentItem&&n._expandParentLevelRecord(a.parentItem,o.expanded,o.isLastRefresh),a.hasChildRecords&&n._expandCollapseInnerLevelRecord(a,!1)))},expandAtLevel:function(e){var i=this,a=i.model;if("expandAll"==i._expandCollapseSettings.state)return!0;i._expandCollapseSettings.state="expandAtLevel",i._expandCollapseSettings.level=e,i._isInExpandCollapseAll=!0,i._expandLevelData(),t.TreeGrid.Actions.ExpandCollapse,a.flatRecords.length>0&&i._refreshGanttOnExpandCollapseAll(),i._isInExpandCollapseAll=!1},_expandParentLevelRecord:function(e,i,a){var r=this,n={},o=r.getExpandStatus(e);n.isLastRefresh=a,e.expanded&&o||(n.data=e,n.expanded=i,n.isFromExpandCollapse=!0,t.TreeGrid.sendExpandCollapseRequest(r,n),n.data.parentItem&&r._expandParentLevelRecord(n.data.parentItem,i,n.isLastRefresh))},_collapseLevelData:function(){var e,i,a,r,n,o=this,l={},d=o.model,s=o._expandCollapseSettings.level;for(i=(e=d.enableVirtualization?o._getAllParentRecord(d.flatRecords):o._getAllParentRecord(d.updatedRecords)).length,l.isFromExpandCollapse=!0,n=0;n<i;n++)n+1==i&&d.enableVirtualization&&(l.isLastRefresh=!0),r=e[n],a=o.getExpandStatus(r),(r&&r.level==s||l.isLastRefresh)&&(l.data=r,l.expanded=r.level!=s&&r.expanded,t.TreeGrid.sendExpandCollapseRequest(o,l),a||r.level!=s||o._expandParentLevelRecord(r.parentItem,!0,l.isLastRefresh))},collapseAtLevel:function(e){var i=this,a=i.model;if("collapseAll"==i._expandCollapseSettings.state)return!0;i._expandCollapseSettings.state="collapseAtLevel",i._expandCollapseSettings.level=e,i._isInExpandCollapseAll=!0,i._collapseLevelData(),t.TreeGrid.Actions.ExpandCollapse,a.flatRecords.length>0&&i._refreshGanttOnExpandCollapseAll(),i._isInExpandCollapseAll=!1},_getDateFromFormat:function(e){return null==e||""==e?null:"object"==typeof e?new Date(e):e?null==t.parseDate(e,this.model.dateFormat,this.model.locale)?new Date(e):t.parseDate(e,this.model.dateFormat,this.model.locale):void 0},_getFormatedDate:function(e,i,a){return t.format(e,i,a)},_getNonWorkingDayIndex:function(){for(var e=this,t=e.model,i=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],a=i.length,r=t.workWeek.slice(),n=r.length,o=0;o<n;o++)r[o]=r[o].toLowerCase();for(e._nonWorkingDayIndex=[],o=0;o<a;o++)-1==r.indexOf(i[o])&&e._nonWorkingDayIndex.push(o)},_getNextWorkingDay:function(e){var t=this,i=(t.model,e.getDay());return-1!=t._nonWorkingDayIndex.indexOf(i)?(e.setDate(e.getDate()+1),t._getNextWorkingDay(e)):e},_getPrevWorkingDay:function(e){var t=this,i=(t.model,e.getDay()),a=0==i?6:i-1;return-1!=t._nonWorkingDayIndex.indexOf(i)||-1!=t._nonWorkingDayIndex.indexOf(a)&&86400==this._defaultEndTime&&0==this._getSecondsInDecimal(e)?(e.setDate(e.getDate()-1),-1!=t._nonWorkingDayIndex.indexOf(e.getDay())&&(e=t._getPrevWorkingDay(e)),e):e},_destroy:function(){var t=this;this.element.off(),t._off(e(window),"resize",t.windowResize),e("#"+this._id+"_dialogEdit_wrapper").clearQueue(),e("#"+this._id+"_dialogEdit_wrapper").stop(),e("#"+this._id+"_dialogAdd_wrapper").clearQueue(),e("#"+this._id+"_dialogAdd_wrapper").stop(),e("#"+t._id+"_dialogAdd").find(".e-treegrid").ejTreeGrid("destroy"),e("#"+t._id+"_dialogEdit").find(".e-treegrid").ejTreeGrid("destroy"),e("#"+t._id+"_dialogEdit").data("ejDialog")&&e("#"+t._id+"_dialogEdit").data("ejDialog").destroy(),e("#"+t._id+"_dialogAdd").data("ejDialog")&&e("#"+t._id+"_dialogAdd").data("ejDialog").destroy(),e("#"+t._id+"_dialogAdd").remove(),e("#"+t._id+"_dialogEdit").remove(),e("#"+this._id+"_toolbarItems_Main").remove(),e("#"+this._id+"_dialogEdit_wrapper").remove(),e("#"+this._id+"startDateEdit_popup").remove(),e("#"+this._id+"endDateEdit_popup").remove(),e("#"+this._id+"startDateAdd_popup").remove(),e("#"+this._id+"endDateAdd_popup").remove(),e("#"+this._id+"taskTypeEdit_popup_wrapper").remove(),e("#"+this._id+"_dialogAdd_wrapper").remove(),e("#"+this._id+"effortDrivenEdit_popup_wrapper").remove(),e("#"+this._id+"_dialogValidationRule_wrapper").remove(),t._$ganttchartHelper.ejGanttChart("instance").destroy(),t._$treegridHelper.ejTreeGrid("instance").destroy(),t.element.empty().removeClass("e-gantt-core e-gantt "+t.model.cssClass)},_updateToolbar:function(){var i,a,r=this,n=r.model;e("#"+r._id+"_toolbarItems").remove(),e("#"+r._id+"_toolbarItems_Main").remove(),n.toolbarSettings.showToolbar&&(r._renderToolBar().insertBefore(e("#e-ejSpliter"+r._id)),r._updateToolbarOptions("")),r._totalBorderHeight="msie"==t.browserInfo().name&&t.browserInfo().version<9?n.toolbarSettings.showToolbar?3:2:n.toolbarSettings.showToolbar?1:0,r._$treegridHelper.ejTreeGrid("cancelEditCell");var o=e("#"+r._id+"_toolbarItems"),l=r.element.find(".e-ganttviewerbodyContianer"),d=r.element.find(".e-ganttviewerheaderContainer"),s="#ejTreeGrid"+r._id+"e-gridcontent",c=e("#e-ejSpliter"+r._id),u=e(r.element).height()-r._totalBorderHeight,p=u-d.height()-2-o.height(),h=l.ejScroller("option","scrollTop"),g=l.ejScroller("option","scrollLeft");l.ejScroller({height:p}),i=u-o.height(),c.height(i),e("#ejTreeGrid"+r._id).height(i),e("#ejGanttChart"+r._id).height(i),e(s).height(p),l.height(p),e(s).ejScroller("refresh"),l.ejScroller("option","scrollTop",h),l.ejScroller("option","scrollLeft",g),r._$treegridHelper.ejTreeGrid("updateViewPortHeight"),r._$ganttchartHelper.ejGanttChart("updateViewPortHeight"),r.model.enableVirtualization&&(r._$treegridHelper.ejTreeGrid("processBindings"),(a={}).requestType=t.TreeGrid.Actions.Refresh,r._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",a),r._$ganttchartHelper.ejGanttChart("refreshHelper",r.model.currentViewData,r.model.updatedRecords),r._$ganttchartHelper.ejGanttChart("onScrollHelper",h)),r._clearContextMenu()},_removeSeparator:function(e){var i=e.toString(),a=t.preferredCulture(this.model.locale).numberFormat;return i.replace(".",a["."])},_getDurationStringValue:function(e){var t,a,r="";return null!=e.duration&&e.duration!=i&&""!==e.duration&&("string"==typeof e.duration?(t=parseFloat(e.duration),r+=isNaN(t)?"":this._removeSeparator(parseFloat(t.toFixed(2)))+" "):r+=this._removeSeparator(parseFloat(e.duration.toFixed(2)))+" ",null!=e.durationUnit&&e.durationUnit!=i&&(a=1!=e.duration,r+="day"==e.durationUnit||"days"==e.durationUnit?a?this._durationUnitTexts.days:this._durationUnitTexts.day:"hour"==e.durationUnit||"hours"==e.durationUnit?a?this._durationUnitTexts.hours:this._durationUnitTexts.hour:"minute"==e.durationUnit||"minutes"==e.durationUnit?a?this._durationUnitTexts.minutes:this._durationUnitTexts.minute:this.model.selectedItem.durationUnit)),r},_getPredecessorStringValue:function(e){var t,i,a,r,n,o,l=this,d=e.predecessor;if(d)for(t=d.length,i="",a=0;a<t;a++)n="",(r=d[a]).from!=e.taskId&&(n=r.from+r.predecessorsType,0!=r.offset&&(n+=r.offset>0?"+"+r.offset+" ":r.offset+" ",o=1!=Math.abs(r.offset),n+="day"==r.offsetDurationUnit?o?l._durationUnitTexts.days:l._durationUnitTexts.day:"hour"==r.offsetDurationUnit?o?l._durationUnitTexts.hours:l._durationUnitTexts.hour:o?l._durationUnitTexts.minutes:l._durationUnitTexts.minute),i=i.length>0?i+","+n:n);return i},_getValidStartDate:function(e){var i,a=this;return t.isNullOrUndefined(e.startDate)?t.isNullOrUndefined(e.endDate)?t.isNullOrUndefined(e.duration)?null:(i=a._getScheduledStartDate(e))||null:(i=new Date(e.endDate),a._setTime(a._defaultStartTime,i),i):new Date(e.startDate)},_getValidEndDate:function(e){var i,a,r=this;return t.isNullOrUndefined(e.endDate)?t.isNullOrUndefined(e.startDate)?t.isNullOrUndefined(e.duration)?null:(a=r._getValidStartDate(e))?(i=r._getEndDate(a,e.duration,e.durationUnit,e),new Date(i)):null:(e.isMilesStone?i=r._checkStartDate(e.startDate,e):(i=new Date(e.startDate),r._setTime(r._defaultEndTime,i)),new Date(i)):new Date(e.endDate)},_compareDates:function(e,i){return t.isNullOrUndefined(e)||t.isNullOrUndefined(i)?!t.isNullOrUndefined(e)&&t.isNullOrUndefined(i)?1:!(!t.isNullOrUndefined(e)||t.isNullOrUndefined(i))&&-1:e.getTime()>i.getTime()?1:e.getTime()<i.getTime()?-1:0},_compareDatesFromRecord:function(e){var t=this._getValidStartDate(e),i=this._getValidEndDate(e);return this._compareDates(t,i)},_updateToScheduledValue:function(e,i){var a=this;return e._isScheduledTask()||!a._isPredecessorEdited||!e.isAutoSchedule&&!this.model.validateManualTasksOnLinking?e:(e.startDate?(e.duration=1,e._calculateEndDate(this)):e.endDate?(e.duration=1,e.startDate=a._getStartDate(e.endDate,e.duration,e.durationUnit,e)):(e.duration=t.isNullOrUndefined(e.duration)?1:e.duration,e.startDate=a._getValidStartDate(e),e._calculateEndDate(this)),e.left=e._calculateLeft(this),e.width=e._calculateWidth(this),e.progressWidth=a._getProgressWidth(e.width,e.status),a._updateItemValueInRecord(e),a._validatePredecessorOnEditing(e),a.refreshGanttRecord(e),i&&(e.parentItem&&e.isAutoSchedule?a._updateParentItem(e):a._updateManualParentItem(e)),e)}}),t.ganttFeatures.predecessor&&e.extend(t.Gantt.prototype,t.ganttFeatures.predecessor),t.Gantt.ViewType={ProjectView:"projectView",ResourceView:"resourceView",HistogramView:"histogramView"},t.Gantt.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker",Maskedit:"maskedEdit"},t.Gantt.ToolbarItems={Add:"add",Edit:"edit",Delete:"delete",Update:"update",Cancel:"cancel",Search:"search",Indent:"indent",Outdent:"outdent",ExpandAll:"expandAll",CollapseAll:"collapseAll",PrevTimeSpan:"prevTimeSpan",NextTimeSpan:"nextTimeSpan",CriticalPath:"criticalPath",ExcelExport:"excelExport",PdfExport:"pdfExport"},t.Gantt.ScheduleHeaderType={Year:"year",Month:"month",Week:"week",Day:"day",Hour:"hour",QuarterYear:"quarterYear",HalfYear:"halfYear"},t.Gantt.minutesPerInterval={Auto:"auto",OneMinute:"oneMinute",FiveMinutes:"fiveMinutes",FifteenMinutes:"fifteenMinutes",ThirtyMinutes:"thirtyMinutes"},t.Gantt.DurationUnit={Day:"day",Hour:"hour",Minute:"minute"},t.Gantt.WorkUnit={Day:"day",Hour:"hour",Minute:"minute"},t.Gantt.TaskType={FixedUnit:"fixedUnit",FixedWork:"fixedWork",FixedDuration:"fixedDuration"},t.Gantt.workingTimeScale={TimeScale8Hours:"TimeScale8Hours",TimeScale24Hours:"TimeScale24Hours"},t.Gantt.RowPosition={Top:"top",Bottom:"bottom",AboveSelectedRow:"aboveselectedrow",BelowSelectedRow:"belowselectedrow",Child:"child"},t.Gantt.BeginEditAction={DblClick:"dblClick",Click:"click"},t.Gantt.SelectionType={Single:"single",Multiple:"multiple"},t.Gantt.TimescaleRoundMode={Auto:"auto",Year:"year",Month:"month",Week:"week"},t.Gantt.SelectionMode={Row:"row",Cell:"cell"},t.Gantt.TaskSchedulingMode={Auto:"auto",Manual:"manual",Custom:"custom"},t.Gantt.Locale=t.Gantt.Locale||{},t.Gantt.Locale.default=t.Gantt.Locale["en-US"]={emptyRecord:"No records to display",unassignedTask:"Unassigned Task",alertTexts:{indentAlert:"There is no Gantt record is selected to perform the indent",outdentAlert:"There is no Gantt record is selected to perform the outdent",predecessorEditingValidationAlert:"Cyclic dependency occurred, please check the predecessor",predecessorAddingValidationAlert:"Fill all the columns in predecessor table",idValidationAlert:"Duplicate ID",dateValidationAlert:"Invalid end date",dialogResourceAlert:"Fill all the columns in resource table"},quarterYearTexts:{first:"Q1",second:"Q2",third:"Q3",fourth:"Q4"},halfYearTexts:{first:"H1",second:"H2"},columnHeaderTexts:{serialNumber:"S.No",taskId:"ID",taskName:"Task Name",startDate:"Start Date",endDate:"End Date",resourceInfo:"Resources",duration:"Duration",status:"Progress",taskMode:"Task Mode",subTasksStartDate:"SubTasks Start Date",subTasksEndDate:"SubTasks End Date",scheduleStartDate:"Schedule Start Date",scheduleEndDate:"Schedule End Date",predecessor:"Predecessors",type:"Type",offset:"Offset",baselineStartDate:"Baseline Start Date",baselineEndDate:"Baseline End Date",WBS:"WBS",WBSPredecessor:"WBS Predecessor",dialogCustomFieldName:"Column Name",dialogCustomFieldValue:"Value",notes:"Notes",taskType:"Task Type",work:"Work",unit:"Unit",effortDriven:"Effort Driven",resourceName:"Resource Name"},editDialogTexts:{addFormTitle:"New Task",editFormTitle:"Task Information",saveButton:"Save",deleteButton:"Delete Task",cancelButton:"Cancel",addPredecessor:"Add New",removePredecessor:"Remove",addButton:"Add"},columnDialogTexts:{field:"Field",headerText:"Header Text",editType:"Edit Type",filterEditType:"Filter Edit Type",allowFiltering:"Allow Filtering",allowFilteringBlankContent:"Allow Filtering Blank Content",allowSorting:"Allow Sorting",visible:"Visible",width:"Width",textAlign:"Text Alignment",headerTextAlign:"Header Text Alignment",columnsDropdownData:"Column Dropdown Data",dropdownTableText:"Text",dropdownTableValue:"Value",addData:"Add",deleteData:"Remove",allowCellSelection:"Allow Cell Selection",displayAsCheckbox:"Display As Checkbox",clipMode:"Clip Mode",tooltip:"Tooltip",showInColumnChooser:"Show In Column Chooser",headerTooltip:"Header Tooltip"},toolboxTooltipTexts:{addTool:"Add",editTool:"Edit",saveTool:"Update",deleteTool:"Delete",cancelTool:"Cancel",searchTool:"Search",indentTool:"Indent",outdentTool:"Outdent",expandAllTool:"Expand All",collapseAllTool:"Collapse All",nextTimeSpanTool:"Next Timespan",prevTimeSpanTool:"Previous Timespan",criticalPathTool:"Critical Path",excelExportTool:"Excel Export",pdfExportTool:"PDF Export"},durationUnitTexts:{days:"days",hours:"hours",minutes:"minutes",day:"day",hour:"hour",minute:"minute"},durationUnitEditText:{minute:["m","min","minute","minutes"],hour:["h","hr","hour","hours"],day:["d","dy","day","days"]},workUnitTexts:{day:"days",hour:"hours",minute:"minutes"},taskTypeTexts:{fixedWork:"Fixed Work",fixedUnit:"Fixed Units",fixedDuration:"Fixed Duration"},effortDrivenTexts:{yes:"Yes",no:"No"},contextMenuTexts:{taskDetailsText:"Task Details...",addNewTaskText:"Add New Task",indentText:"Indent",outdentText:"Outdent",deleteText:"Delete",aboveText:"Above",belowText:"Below"},newTaskTexts:{newTaskName:"New Task"},columnMenuTexts:{sortAscendingText:"Sort Ascending",sortDescendingText:"Sort Descending",columnsText:"Columns",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",renameColumn:"Rename Column"},taskModeTexts:{manual:"Manual",auto:"Auto"},editTypeTexts:{string:"String",numeric:"Numeric",datePicker:"Date Picker",dateTimePicker:"Date Time Picker",dropdown:"Dropdown",boolean:"Boolean"},textAlignTypes:{right:"Right",left:"Left",center:"Center"},clipModeTexts:{clip:"Clip",ellipsis:"Ellipsis"},columnDialogTitle:{insertColumn:"Insert Column",deleteColumn:"Delete Column",renameColumn:"Rename Column"},deleteColumnText:"Are you sure you want to delete this column?",okButtonText:"OK",cancelButtonText:"Cancel",confirmDeleteText:"Confirm Delete",predecessorEditingTexts:{fromText:"From",toText:"To"},dialogTabTitleTexts:{generalTabText:"General",predecessorsTabText:"Predecessors",resourcesTabText:"Resources",customFieldsTabText:"Custom Fields",notesTabText:"Notes"},predecessorCollectionText:[{id:"SS",text:"Start-Start",value:"Start-Start"},{id:"SF",text:"Start-Finish",value:"Start-Finish"},{id:"FS",text:"Finish-Start",value:"Finish-Start"},{id:"FF",text:"Finish-Finish",value:"Finish-Finish"}],linkValidationRuleText:{taskBeforePredecessor:"You moved '{0}' to start before '{1}' finishes and the two tasks are linked. As the result, the links cannot be honored. Select one action below to perform",taskAfterPredecessor:"You moved '{0}' away from '{1}' and the two tasks are linked. As the result, the links cannot be honored. Select one action below to perform"},linkValidationDialogTitle:"Validate Editing",linkValidationRuleOptions:{cancel:"Cancel, keep the existing link",removeLink:"Remove the link and move '{0}' to start on '{1}'.",preserveLink:"Move the '{0}' to start on '{1}' and keep the link."},connectorLineDialogText:{from:"From",to:"To",taskLink:"Task Link",type:"Type",lag:"Lag",okButtonText:"Ok",cancelButtonText:"Cancel",deleteButtonText:"Delete",title:"Task Dependency"},nullText:"Null"},t.Gantt.GanttRecord=function(){var e=this;e.eResourceName="",e.eResourceChildTasks=[],e.eResourceTaskType="",e.eOverlapIndex=1,e.eOverlapWithIndex=-1,e.eOverlapped=!1,e.taskId=null,e.taskName=null,e.startDate=null,e.endDate=null,e.duration=null,e.isMilestone=!1,e.status=null,e.predecessor=null,e.resourceInfo=null,e.parentItem=null,e.isSelected=!1,e.childRecords=null,e.hasChildRecords=!1,e.expanded=!1,e.level=0,e.left=0,e.width=0,e.progressWidth=0,e.item=null,e.baselineLeft=0,e.baselineWidth=0,e.baselineStartDate=null,e.baselineEndDate=null,e.isCritical=!1,e.slack=null,e.isReadOnly=!1,e.hasFilteredChildRecords=!0,e.taskbarBackground=null,e.progressbarBackground=null,e.parentProgressbarBackground=null,e.cellBackgroundColor=null,e.rowBackgroundColor=null,e.treeMappingName=[],e.dragState=!0,e.isSelected=!1,e.durationUnit="",e.isAutoSchedule=!0,e.manualStartDate=null,e.manualEndDate=null,e.manualLeft=0,e.manualDuration=0,e.manualWidth=0,e.serialNumber=null,e.serialNumberPredecessor=null,e.totalProgress=0,e.totalDuration=0},t.Gantt.GanttRecord.prototype={_calculateLeft:function(e){var i,a=0,r=-300,n=this.isMilestone;return this.startDate?i=new Date(this.startDate):this.endDate?(i=new Date(this.endDate),a=e._unscheduledTaskWidth,n=!0):i=e._getValidStartDate(this),t.isNullOrUndefined(i)||(r=e._getTaskLeft(i,n)-a),r},_calculateManualLeft:function(e){return e._getTaskLeft(this.manualStartDate)},_calculateBaselineLeft:function(e){var t=new Date(this.baselineStartDate),i=new Date(this.baselineEndDate);return t&&i?e._getTaskLeft(t,this.isMilestone):0},_calculateBaselineRight:function(e){var t=new Date(this.baselineStartDate),i=new Date(this.baselineEndDate);return t&&i?e._getTaskLeft(i):0},_calculateWidth:function(e){var i,a;return t.isNullOrUndefined(this.startDate)&&t.isNullOrUndefined(this.endDate)?(i=e._getValidStartDate(this),a=e._getValidEndDate(this)):(i=this.startDate,a=this.endDate),t.isNullOrUndefined(i)||t.isNullOrUndefined(a)?e._unscheduledTaskWidth:e._getTaskWidth(i,a)},_calculateManualWidth:function(e){var t=new Date(this.manualStartDate),i=new Date(this.manualEndDate);return e._getTaskWidth(t,i)},_calculateBaseLineWidth:function(e){var t=new Date(this.baselineStartDate),i=new Date(this.baselineEndDate);return e._getTaskWidth(t,i)},_getFormatedDate:function(e,i,a){return t.format(e,i,a)},_getDateFromFormat:function(e,i,a){if(e)return null==t.parseDate(e,i,a)?new Date(e):t.parseDate(e,i,a)},_setResourceInfo:function(i,a,r,n,o){for(var l,d,s=0,c=[];s<i.length;s++)l=o.filter(function(e){return"object"==typeof i[s]&&i[s][a]===e[a]||i[s]===e[a]}),d=e.extend({},l[0]),l.length?(c.push(d),""==n||t.isNullOrUndefined(i[s][n])?this._updateResourceUnit(l[0],d,n):d[n]=i[s][n]):(i.splice(s,1),s--);return c},_updateResourceUnit:function(e,i,a){""!=a?t.isNullOrUndefined(e[a])&&(i[a]=100):i.unit=100},_updateParentProgress:function(e,t,i){var a,r,n,o=0,l=i,d=e.childRecords,s=0,c=d?d.length:0,u=0,p=0;if(d){for(r=0;r<c;r++)!d[r].isMilestone||d[r].hasChildRecords?(u+=(a=l._getParentProgress(d[r])).totalProgress,s+=a.totalDuration):p+=1;o=c-p>0?Math.round(u/s):0,e.totalProgress=u,e.totalDuration=s,isNaN(o)&&(o=0),n=e.isAutoSchedule?e.width:e.manualWidth,e.progressWidth=this._getProgressWidth(n,o),e.status=Math.floor(o),t&&(e.item[t]=e.status)}e.parentItem&&this._updateParentProgress(e.parentItem,t,l)},_getProgressWidth:function(e,t){return e*t/100},_calculatePredecessor:function(e,t,i,a){var r,n,o,l,d,s,c,u=[],p={},h=this.taskId.toString(),g=this,m=a;return l="resourceView"==m.model.viewType?m._resourceUniqTaskIds:m.model.ids,"string"==typeof e&&e.split(",").forEach(function(e){var a,_;n=e.split("+"),o="+",e.indexOf("-")>=0&&(n=e.split("-"),o="-"),(r=n[0].match(/(\d+|[A-z]+)/g))[0]&&-1!=l.indexOf(r[0])?(r.length>1?"FS"==(a=r[1].toUpperCase())||"FF"==a||"SF"==a||"SS"==a?d=a:(m._isValidPredecessorString&&(m._isValidPredecessorString=!1),d="FS"):(m._isValidPredecessorString&&(m._isValidPredecessorString=!1),d="FS"),p={from:r[0],predecessorsType:d,offset:n.length>1?o+""+n[1]:"0",isdrawn:!1,to:h},s=m._getRecordByTaskId(p.from),c=m._getRecordByTaskId(p.to),s&&(s.hasChildRecords||(c?c.hasChildRecords:g.hasChildRecords)||(_=g._getOffsetDurationUnit(p.offset,t,i),p.offset=_.duration,p.offsetDurationUnit=_.durationUnit,u.push(p)))):m._isValidPredecessorString&&(m._isValidPredecessorString=!1)}),u},_getOffsetDurationUnit:function(i,a,r){var n,o,l,d=0,s=r;if("string"==typeof i){for(n=i.match(/[^0-9]+|[0-9]+/g),o=0;o<n.length;o++)n[o]=e.trim(n[o]);"-"==n[0]&&n[1]?(n[1]=n[0]+n[1],n.shift()):"+"==n[0]&&n.shift(),"."!=n[1]||isNaN(parseInt(n[2]))||(n[0]+=n[1]+n[2],n.splice(1,2)),n&&n.length<=2&&(d=parseFloat(n[0]),s=n[1]?e.trim(n[1].toLowerCase()):"",s=-1!=a.minute.indexOf(s)?t.Gantt.DurationUnit.Minute:-1!=a.hour.indexOf(s)?t.Gantt.DurationUnit.Hour:-1!=a.day.indexOf(s)?t.Gantt.DurationUnit.Day:r)}else d=i,s=r;return isNaN(d)&&(d=0,s=t.Gantt.DurationUnit.Day),(l={}).duration=d,l.durationUnit=s,l},_calculateEndDate:function(e){var i=e.model,a=null;t.isNullOrUndefined(this.startDate)||(!t.isNullOrUndefined(this.endDate)&&t.isNullOrUndefined(this.duration)&&(1==e._compareDates(this.startDate,this.endDate)&&(this.startDate=new Date(this.endDate),e._setTime(e._defaultStartTime,this.startDate)),this._calculateDuration(e)),t.isNullOrUndefined(this.duration)||(a=e._getEndDate(this.startDate,this.duration,this.durationUnit,this)),this.endDate=a),i.endDateMapping&&(this.item[i.endDateMapping]=this.endDate)},_calculateDuration:function(e){var t=e.model,i=e._getDuration(this.startDate,this.endDate,this.durationUnit,this.isAutoSchedule);this.duration=i,t.durationMapping&&this.item&&(this.item[t.durationMapping]=i,t.durationUnitMapping&&(this.item[t.durationUnitMapping]=this.durationUnit))},_calculateManualDuration:function(e){var t=e._getDuration(this.manualStartDate,this.manualEndDate,this.durationUnit,this.isAutoSchedule);this.manualDuration=t},_updateDurationWithWork:function(e,i){for(var a,r,n=e.model,o=i||this.resourceInfo,l=o?o.length:0,d=0,s=0,c=e._secondsPerDay/3600,u=0;u<l;u++)d+=(a=o[u][n.resourceUnitMapping])>0?c*a/100:c;r=this._getTotalWorksInHours(n,c),0!=l&&(s+=r/d),"minute"==this.durationUnit&&(s=s*c*60),"hour"==this.durationUnit&&(s*=c),s%1!=0&&(s=parseFloat(s.toFixed(2))),t.isNullOrUndefined(this.duration)||(e._isDurationUpdated=!0,this.duration=s,n.durationMapping&&(this.item[n.durationMapping]=this.duration))},_updateWorkWithDuration:function(e,t){for(var i,a=e.model,r=t||this.resourceInfo,n=r?r.length:0,o=0,l=e._secondsPerDay/3600,d=this._getDurationInDays(l),s=0;s<n;s++)o+=((i=r[s][a.resourceUnitMapping])>0?l*i/100:l)*d;"minute"==a.workUnit&&(o*=60),"day"==a.workUnit&&(o/=l),o%1!=0&&(o=o.toFixed(2)),this.work=parseFloat(o),a.workMapping&&(this.item[a.workMapping]=this.work)},_updateUnitWithWork:function(e){var t,i=e.model,a=this.resourceInfo,r=a?a.length:0,n=e._secondsPerDay/3600;if(0!=r){var o=this._getDurationInDays(n),l=this._getTotalWorksInHours(i,n),d=o>0?l/(o*n)*100:0,s=d>0?d/r:100;for(s%1!=0&&(s=parseFloat(s.toFixed(2))),t=0;t<r;t++)a[t][i.resourceUnitMapping]=s;e._updateResourceName(this)}},_getTotalWorksInHours:function(e,t){var i=this;return"day"==e.workUnit?i.work*t:"minute"==e.workUnit?i.work/60:i.work},_getDurationInDays:function(e){var i=t.isNullOrUndefined(this.duration)?0:this.duration;return"hour"==this.durationUnit?i/e:"minute"==this.durationUnit?i/(60*e):i},_getProgressPercent:function(e,t){return Math.ceil((t/e*100).toFixed(2))},_setTime:function(e,t){var i=parseInt(e/3600),a=parseInt((e-3600*i)/60),r=e-3600*i-60*a;t.setHours(i,a,r,0)},_endDateUpdate:function(e,t,i,a,r){i||(i=0);var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return"day"==r||"hour"==r?(n.setHours(24),n.setMinutes(i)):a.length&&(i>0?(n.setHours(24),this._setTime(a[0].from,n),n.setMinutes(i)):this._setTime(a[a.length-1].to,n)),n},_startDateUpdate:function(e,t,i,a,r){i||(i=0);var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds());return"day"==r||"hour"==r?n.setMinutes(i):a.length&&(i>0?(this._setTime(a[0].from,n),n.setMinutes(i)):this._setTime(a[0].from,n)),n},_isScheduledTask:function(){return t.isNullOrUndefined(this.startDate)&&t.isNullOrUndefined(this.endDate)&&t.isNullOrUndefined(this.duration)?null:!(t.isNullOrUndefined(this.startDate)||t.isNullOrUndefined(this.endDate)||t.isNullOrUndefined(this.duration))}},t.Gantt._getDurationStringValue=function(e){var t,a,r="";return null!=e.duration&&e.duration!=i&&""!==e.duration&&("string"==typeof e.duration?(t=parseFloat(e.duration),r+=isNaN(t)?"":parseFloat(t.toFixed(2))+" "):r+=parseFloat(e.duration.toFixed(2))+" ",null!=e.durationUnit&&e.durationUnit!=i&&(a=1!=e.duration,r+="day"==e.durationUnit?a?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:"hour"==e.durationUnit?a?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:a?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute)),r},t.Gantt._getCellValue=function(e){var t=this.data[e];return t||this.data.item&&this.data.item[e]}}(jQuery,Syncfusion),function(e,t,i){"use strict";t.ganttChartFeatures=t.ganttChartFeatures||{},t.widget("ejGanttChart","ej.GanttChart",{element:null,model:null,_rootCSS:"e-ganttchart",keyConfigs:{focus:"e",insertRecord:"45",deleteRecord:"46",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"36",lastRowSelection:"35",leftArrow:"37",rightArrow:"39",upArrow:"38",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38",shiftDownArrow:"shift+40",shiftUpArrow:"shift+38"},defaults:{childPropertyName:"",taskIdMapping:"",taskNameMapping:"",startDateMapping:"",endDateMapping:"",childMapping:"",finishDateMapping:"",durationMapping:"",milestoneMapping:"",progressMapping:"",predecessorMapping:"",resourceInfoMapping:"",resourceNameMapping:"",resourceCollection:[],holidays:[{day:null,label:null,background:null}],stripLines:[{day:null,label:null,lineStyle:"dotted",lineColor:"#169dd7",lineWidth:2}],enableTaskbarTooltip:!0,enableTaskbarDragTooltip:!0,highlightWeekends:!0,scheduleStartDate:null,scheduleEndDate:null,enableProgressBarResizing:!0,rowHeight:30,progressbarHeight:100,connectorlineWidth:1,dateFormat:"MM/dd/yyyy",locale:"en-US",taskbarBackground:"#DE8080",progressbarBackground:"#C44647",weekendBackground:"#F2F2F2",connectorLineBackground:"#383838",parentTaskbarBackground:"#383838",parentProgressbarBackground:"#1C1C1C",selectedItem:null,selectedRowIndex:-1,perDayWidth:null,perMonthWidth:null,perWeekWidth:null,perHourWidth:null,queryTaskbarInfo:null,taskbarTemplate:"",progressbarTemplate:null,parenttaskbarTemplate:"",parentprogressbarTemplate:null,milestoneTemplate:"",flatRecords:[],updatedRecords:[],selectedItems:[],ids:[],currentViewData:[],scheduleWeeks:[],scheduleYears:[],scheduleMonths:[],scheduleDays:[],scheduleHours:[],projectStartDate:null,projectEndDate:null,tooltipTemplate:"",tooltipTemplateId:"",progressbarTooltipTemplateId:"",taskbarEditingTooltipTemplateId:"",taskbarEditingTooltipTemplate:"",progressbarTooltipTemplate:"",showTaskNames:!0,leftTaskLabelMapping:"",rightTaskLabelMapping:"",LeftTaskLabelTemplate:"",rightTaskLabelTemplate:"",showProgressStatus:!0,showResourceNames:!0,includeWeekend:!1,allowZooming:!1,readOnly:!1,allowGanttChartEditing:!0,allowKeyboardNavigation:!0,allowDragAndDrop:!1,renderBaseline:!1,baselineColor:"#fba41c ",editSettings:{allowEditing:!1,allowAdding:!1,allowDeleting:!1,editMode:"normal",dialogEditorTemplateId:null},scheduleHeaderSettings:{weekHeaderFormat:"MMM dd , yyyy",dayHeaderFormat:"",weekendBackground:"#F2F2F2",yearHeaderFormat:"yyyy",monthHeaderFormat:"MMM",hourHeaderFormat:"HH",minuteHeaderFormat:"mm",scheduleHeaderType:"week",weekStartDay:0},workingTimeScale:"TimeScale8Hours",roundOffDayworkingTime:!0,durationUnit:"day",localizedDays:null,localizedMonths:null,columnHeaderTexts:null,predecessorEditingTexts:null,enablePredecessorEditing:!0,taskbarClick:null,predecessorTooltipTemplate:""},updateHighlightNonWorkingTime:function(e){var i=this;i.model.highlightNonWorkingTime=e,i.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&i._renderDayWorkColor()},updateNonWorkingBackground:function(e){var t=this;t.model.nonWorkingBackground=e,t.model.nonWorkingBackground&&t._renderDayWorkColor()},updateHighlightWeekends:function(e){var i=this;i.model.highlightWeekends=e,i.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?i._renderDayWorkColor():1==i.model.highlightWeekends?i._renderWeekends():i._$weekendsContainer.remove()},updateWeekendBackground:function(e){var i=this;i.model.weekendBackground=e,i.model.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?i._renderDayWorkColor():(i._$weekendsContainer.remove(),i._renderWeekends())},showTooltip:function(e){var t=this;t.model.enableTaskbarTooltip=e,t._createChartTaskbarTemplate(),t._refresh()},showEditingTooltip:function(e){var t=this;t.model.enableTaskbarDragTooltip=e,t._createChartTaskbarTemplate(),t._refresh()},updateConnectorLineBackground:function(e){this.model.connectorLineBackground=e,this._createConnectorLineTemplate()},updateConnectorlineWidth:function(e){this.model.connectorlineWidth=parseInt(e),this._createConnectorLineTemplate()},updateTaskbarBackground:function(e){this.model.taskbarBackground=e,this._createChartTaskbarTemplate(),this._refresh()},updateProgressbarBackground:function(e){this.model.progressbarBackground=e,this._createChartTaskbarTemplate(),this._refresh()},updateParentTaskbarBackground:function(e){this.model.parentTaskbarBackground=e,this._createChartTaskbarTemplate(),this._refresh()},updateParentProgressbarBackground:function(e){this.model.parentProgressbarBackground=e,this._createChartTaskbarTemplate(),this._refresh()},updateRenderTaskNames:function(e){var t=this;t.model.showTaskNames=e,t._createChartTaskbarTemplate(),t._refresh()},refreshLeftTaskLabelMapping:function(e){var t=this;t.model.leftTaskLabelMapping=e,t._createChartTaskbarTemplate(),t._refresh()},refreshRightTaskLabelMapping:function(e){var t=this;t.model.rightTaskLabelMapping=e,t._createChartTaskbarTemplate(),t._refresh()},refreshLeftTaskLabelTemplate:function(e){var t=this;t.model.leftTaskLabelTemplate=e,t._createChartTaskbarTemplate(),t._refresh()},refreshRightTaskLabelTemplate:function(e){var t=this;t.model.rightTaskLabelTemplate=e,t._createChartTaskbarTemplate(),t._refresh()},updateRendeProgressStatus:function(e){var t=this;t.model.showProgressStatus=e,t._createChartTaskbarTemplate(),t._refresh()},updateRenderResourceNames:function(e){var t=this;t.model.showResourceNames=e,t._createChartTaskbarTemplate(),t._refresh()},changeMilestoneTemplate:function(e){var t=this;t.model.milestoneTemplate=e,t._createChartTaskbarTemplate(),t._refresh()},changeTaskbarTemplate:function(e){var t=this;t.model.taskbarTemplate=e,t._createChartTaskbarTemplate(),t._refresh()},changeParentTaskbarTemplate:function(e){var t=this;t.model.parentTaskbarTemplate=e,t._createChartTaskbarTemplate(),t._refresh()},ganttChartEditing:function(e){this.model.allowGanttChartEditing=e},updateReadOnly:function(e){this.model.readOnly=e},resizeProgressbar:function(e){this.model.enableProgressBarResizing=e},updateAllowKeyboardNavigation:function(e){this.model.allowKeyboardNavigation=e},updateProgressbarHeight:function(e){this.model.progressbarHeight=e,this._createChartTaskbarTemplate(),this._refresh()},updateBaselineColor:function(e){this.model.baselineColor=e,this._createChartTaskbarTemplate(),this._refresh()},updateRenderBaseline:function(e){var t=this;this.model.renderBaseline=e,t._createChartTaskbarTemplate(),t._refresh(),t._createConnectorLineTemplate()},focusGanttElement:function(){if("msie"==t.browserInfo().name)try{this.element[0].setActive()}catch(e){}else{var i=e(window).scrollTop();this.element[0].focus(),e(window).scrollTop(i)}},_getYearWidth:function(){var e=0,t=0;for(e=0;e<this.model.scheduleYears.length;e++)t+=this._getTemplateYearWidth(this.model.scheduleYears[e]);return t},_getMonthWidth:function(){for(var e,i,a,r,n,o=this.model.scheduleMonths,l=0,d=0;d<o.length;d++)n="object"==typeof(e=o[d])?new Date(e):t.parseDate(e,this.model.dateFormat,this.model.locale),a=(i=new Date(n.getFullYear(),n.getMonth()+1,0)).getDate(),n.getTime()===this.model.scheduleMonths[0].getTime()?(r=i.getDate()-n.getDate(),l+=this.model.perDayWidth*(r+1)):31==a?l+=31*this.model.perDayWidth:30==a?l+=30*this.model.perDayWidth:28==a&&(l+=28*this.model.perDayWidth);return l},_getWeekWidth:function(){return 7*this.model.perDayWidth},_getHeight:function(){return this._containerHeight},_setHeight:function(e){this._containerHeight=e},getGanttChartRows:function(){return this._ganttChartRows},getUpdatedRecords:function(){return this.model.flatRecords},setUpdatedRecords:function(e,t,i,a){var r=this;r.model.currentViewData=e,r.model.updatedRecords=t,r.model.flatRecords=i,r.model.ids=a},_getFormatedDate:function(e,i,a){return t.format(e,i,a)},_getViewportHeight:function(){var e=this._$headerContainer;return this.element.height()-e.height()-parseFloat(e.css("border-bottom-width"))},getViewportHeight:function(){return this._getViewportHeight()},setViewPortHeight:function(){this._viewportHeight=this._getViewportHeight()-18},updateViewPortHeight:function(){this._viewportHeight=this._getViewportHeight()},_init:function(){var a,r=this,n=r.model,o=!1,l=n.scheduleHeaderSettings.scheduleHeaderType;r.element.addClass("e-ganttchart-core"),r.element.attr("tabindex","0"),n.cssClass&&r.element.addClass(n.cssClass),r._initPrivateProperties(),r._initialize(),r._getNonWorkingDayIndex(),r._renderGanttChart(),r._$bodyContainerParent.append(r._$bodyContainer),r._$bodyContainer.append(r._$bodyContent),r._$ganttChartContainer.append(r._$bodyContainerParent),r._setHeight(this.getRecordsHeight()),e(r._$bodyContainer).css({height:r._viewportHeight+"px"}),this._containerHeight>0?e(r._$bodyContent).css({height:this._containerHeight+"px"}):e(r._$bodyContent).css({height:"1px"}),"week"==l?e(r._$bodyContent).css({width:n.scheduleWeeks.length*r._scheduleWeekWidth+"px"}):"year"==l||"quarterYear"==l||"halfYear"==l?e(r._$bodyContent).css({width:r._scheduleYearWidth+"px"}):"month"==l?e(r._$bodyContent).css({width:r._scheduleMonthWidth+"px"}):"day"==l?e(r._$bodyContent).css({width:n.scheduleDays.length*n.perHourWidth*24+"px"}):"hour"==l&&e(r._$bodyContent).css({width:n.scheduleHours.length*n.perMinuteWidth*r._totalInterval+"px"}),r.createGridLinesTable(),r.renderGanttRecords(),(a=t.buildTag("div")).append(r._$bodyContent),r._$bodyContainer.append(a),r._$bodyContent.width()<r._$bodyContainerParent.width()?(o=!0,r._viewportHeight=r._getViewportHeight()-18):(o=!1,r._viewportHeight=r._getViewportHeight()),r._$bodyContainer.ejScroller({width:r.element.width()-1,enableTouchScroll:!1,height:o?r._getViewportHeight()-18:r._getViewportHeight(),scroll:function(e){var t=e.scrollTop;e.requestType="scroll",e.delta=t,t!=i?!1===r.onScrollHelper(t,!0)&&(e.cancel=!0):r._handleScroll(e)}}),o=!1,r._$bodyContainer.ejScroller("model.keyConfigs",{up:"",down:"",left:"",right:""}),r._$bodyContainer.ejScroller("refresh"),r._wireEvents()},reRenderGanttChart:function(t,i){var a=this,r=a.model,n=r.scheduleHeaderSettings.scheduleHeaderType;a._wireEvents(),r.perDayWidth=t,r.flatRecords=i,a._scheduleWeekWidth=a._getWeekWidth(),a._scheduleYearWidth=a._getYearWidth(),a._scheduleMonthWidth=a._getMonthWidth(),e(a._$headerContainer).empty(),e(a._$scheduleDiv).empty(),a._renderGanttChart(),a._$bodyContainerParent.append(a._$bodyContainer),a._$bodyContainer.append(a._$bodyContent),a._$ganttChartContainer.append(a._$bodyContainerParent),"week"==n?e(a._$bodyContent).css({width:r.scheduleWeeks.length*a._scheduleWeekWidth+"px"}):"year"==n||"quarterYear"==n||"halfYear"==n?e(a._$bodyContent).css({width:a._scheduleYearWidth+"px"}):"month"==n?e(a._$bodyContent).css({width:a._scheduleMonthWidth+"px"}):"day"==n?e(a._$bodyContent).css({width:r.scheduleDays.length*r.perHourWidth*24+"px"}):"hour"==n&&e(a._$bodyContent).css({width:r.scheduleHours.length*r.perMinuteWidth*a._totalInterval+"px"})},_initPrivateProperties:function(){var t=this;t._viewportHeight=0,t._prevScrollTop=0,t._scrollTop=0,t._vScrollDir=1,t._scrollLeft=0,t._maxZIndex=0,t._taskbarEditedArgs={},t._$ganttChartContainer=null,t._$headerContainer=null,t._$bodyContainer=null,t._$bodyContent=null,t._$dependencyViewContainer=null,t._$secondaryCanvas=null,t._$ganttViewTable=null,t._nonWorkingTimeRanges=[],t._$ganttViewTablebody=null,t._weekdays=[],t._rowMargin=0,t._renderedRange=null,t._visibleRange=null,t._vTop=null,t._vBottom=null,t._rTop=null,t._rBottom=null,t._vscrollDist=0,t._containerHeight=0,t._id=this.element.attr("id"),t._ganttChartRows=null,t._filteredRecords=[],t._sortedRecords=[],t._tempSortedRecords=[],t._scheduleHours=[],t._scheduleMinutes=[],t._updateScheduleWidth(),t._totalMonthWidth=0,t._tempFilteredRecords=[],t._prevLeft=0,t._allowDragging=!1,t._leftResizing=!1,t._rightResizing=!1,t._progressResizing=!1,t._editingContainer=null,t._allowExpandCollapse=!0,t._leftResizer=null,t._taskbarItem=null,t._progressbarItem=null,t._progressResizer=null,t._rightResizer=null,t._manualRightResizer=null,t._tasknameContainer=null,t._prevSelectedItem=null,t._multiSelectCtrlRequest=!1,t._ganttTouchTrigger=!1,t._mousePosX=0,t._currMousePosX=0,t._currMousePosY=0,t._resMousePosX=0,t._resMousePosY=0,t._currentItemTop=0,t._currentItemPrevTop=0,t._prevItem={},t._parentCollectionPreviousValues=[],t._mouseTarget=null,t._mouseDown=!1,t._$scheduleDiv=null,t._leftResizerGripper=null,t._rightResizerGripper=null,t._progressHandle=null,t._progressHandleChild=null,t._mouseHoverTooltip=document.getElementById(this.model.tooltipTemplate),t._progressBarTooltipID=document.getElementById(this.model.progressbarTooltipTemplateId),t._taskbarEditingTooltipID=document.getElementById(this.model.taskbarEditingTooltipTemplateId),t._scrollBarHeight=18,t._windowWidth=e(window).width(),t._windowHeight=e(window).height(),t._editingItem=null,t._editingTarget=null,t.tooltipState=null,t._visibleRecordsCount=0,t._tooltipTimer,t._isCalendarExist=null,t._$gridLinesTablebody=null,t._leftConnectorPoint=null,t._rightConnectorPoint=null,t._childLeftConnectorPoint=null,t._childRightConnectorPoint=null,t._editPredecessor=!1,t._connectorPointX=null,t._connectorPointY=null,t._predecessorTooltip=null,t._totalCollapsedRecordCount=0,t._milesStoneWidth=0,t._connectorPointWidth=0,t._newXYPos=!0,t._posX1=null,t._posY1=null,t._posY=null,t._posX=null,t._nonWorkingDayIndex=[],t._mousePosY=0,t.dragPosX=0,t._timerDragVertical=null,t._timerDragHorizontal=null,this._shiftSelectedRecord=null,t._roundOffDuration=!1,t._connectorDrawElement=null,t._isPredecessorEditOpen=!1,t._hoverConnectorLineElement=null,t._predecessorInfo=null},_initialize:function(){var e=this;e._$ganttChartContainer=t.buildTag("div.e-ganttviewercontainer#ganttviewercontainer"+e._id,"",{width:"100%"},{}),e._$headerContainer=t.buildTag("div.e-ganttviewerheaderContainer#ganttviewerheaderContainer"+e._id,"",{"border-right-style":"solid","border-right-width":"1px"},{}),e._$bodyContainer=t.buildTag("div.e-ganttviewerbodyContianer#ganttviewerbodyContianer"+e._id,"",{"-ms-touch-action":"none"},{}),e._$bodyContainerParent=t.buildTag("div.e-ganttviewerbodyContianerparent#ganttviewerbodyContianerParent"+e._id,"",{"-ms-touch-action":"none","border-right-style":"solid","border-right-width":"1px","box-sizing":"border-box",width:"auto",height:"auto"},{}),e._$bodyContent=t.buildTag("div.e-ganttviewerbodyContent#ganttviewerbodyContent"+e._id,"",{},{}),e._$dependencyViewContainer=t.buildTag("div.e-ganttviewerbodyContianer-dependencyViewContainer#dependencyViewContainer"+e._id,"",{"z-index":"5",position:"absolute"},{}),e._$secondaryCanvas=t.buildTag("div.e-ganttviewerbodyContianer-secondaryCanvas","",{"z-index":"3",position:"absolute"},{}),e._$stripLineContainer=t.buildTag("div.e-ganttviewerbodyContianer-stripLines","",{"z-index":"6",position:"absolute"},{}),e._$weekendsContainer=t.buildTag("div.e-ganttviewerbodyContianer-weekendsContainer","",{"z-index":"1",position:"absolute"},{}),e._$ganttViewTable=t.buildTag("table.e-ganttviewerbodyContianer-ganttViewTable e-zerospacing#ganttViewTable"+e._id,"",{"z-index":"5",position:"absolute"}),e._$scheduleDiv=t.buildTag("div.e-gantt-schedule-container#gantt-schedule"+e._id,"",{},{})},_createChartTaskbarTemplate:function(){"resourceView"==this.model.viewType?this._createResourceTaskbarTemplate():"histogramView"==this.model.viewType?this._createHistogramTaskbarTemplate():this._createTaskbarTemplate()},_renderDayWorkColor:function(){for(var e=this,t=e.model,i=!1,a=0;a<t._nonWorkingTimeRange.length;a++)if(t._nonWorkingTimeRange[a].color){i=!0;break}t.highlightNonWorkingTime||i||t.highlightWeekends?e._renderCustomDaySchedule():e._$weekendsContainer.children(".e-secondary_canvas").remove()},_renderGanttChart:function(){var i,a,r,n,o=this,l=o.model,d=l.scheduleHeaderSettings.scheduleHeaderType;if(o._createSchedule(o._getDateType(l.scheduleStartDate),o._getDateType(l.scheduleEndDate)),o._viewportHeight=o._getViewportHeight(),o._$ganttViewTable.css("width",o._getScheduleLength(d)+"px"),i=t.buildTag("colgroup","",{},{}),(a=e(document.createElement("col"))).css("width",o._getScheduleLength(d)+"px"),i.append(a),o._$ganttViewTable.append(i),o._createTooltipTemplate(),o._createEditingTooltipTemplate(),o._createProgressbarTooltipTemplate(),this._createChartTaskbarTemplate(),o._createConnectorLineTemplate(),o._createPredecessorTooltipTemplate(),o._updateCurrentViewData(),1==o.model.highlightWeekends&&l.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Week&&o._renderWeekends(),l.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day&&o._renderDayWorkColor(),o._$stripLineContainer.empty(),null!=o.model.stripLines&&this._renderStripLines(o.model.stripLines),o._$secondaryCanvas.empty(),null!=o.model.holidays)for(r=o.model.holidays.length,n=0;n<r;n++)o._renderHoliday(o.model.holidays[n])},renderConnectorLines:function(t){var i=this,a=e.render[i._id+"ConnectorLineTemplate"](t);e(i._$dependencyViewContainer).empty(),i._$dependencyViewContainer.append(a),i._$bodyContent.append(i._$dependencyViewContainer)},clearConnectorLines:function(){e(this._$dependencyViewContainer).empty()},clearSelection:function(i){var a=this,r=a.model;if(-1==r.selectedRowIndex||-1!=i&&!t.isNullOrUndefined(i)){if(-1!=r.selectedRowIndex&&-1!=i){var n=a.getRowByIndex(i),o=r.updatedRecords[i],l=e.inArray(o,r.selectedItems);-1!=l&&(n.removeClass("e-gantt-mouseclick"),r.selectedItems.splice(l,1),o.isSelected=!1,r.selectedItem=r.selectedItems.length>0?r.selectedItems[r.selectedItems.length-1]:null,r.selectedRowIndex=r.updatedRecords.indexOf(r.selectedItem))}}else a.getGanttChartRows().removeClass("e-gantt-mouseclick"),r.selectedRowIndex=-1,r.selectedItem=null,r.selectedItems=[]},appendConnectorLine:function(t){var i=e.render[this._id+"ConnectorLineTemplate"](t);this._$dependencyViewContainer.append(i)},setCollapsedRecordCount:function(e){this._totalCollapsedRecordCount=e},getCollapsedRecordCount:function(){return this._totalCollapsedRecordCount},removeConnectorline:function(e){this.element.find("#ConnectorLine"+e).remove()},_wireEvents:function(){var i=this,a=jQuery.uaMatch(navigator.userAgent);t.isTouchDevice()?(i._on(i.element,"touchstart",".e-gantt-milestone-container,.e-childContainer",this._mouseHover),i._on(i.element,"touchstart",".e-childContainer,.e-gantt-milestone-container,.e-parentContainer",i._mousedown),e(document.body).bind("touchmove",e.proxy(i.handleMouseMove,i)),i._on(i.element,"touchleave",".e-gantt-milestone-container,.e-childContainer, .e-parentContainer",this._mouseLeave),e(i._$bodyContainer).bind("touchend",e.proxy(i._handleMouseUp,i)),i._on(i.element,"tap",i._cellClickHandler)):(i._on(i.element,"mouseenter",".e-gantt-milestone-container,.e-childContainer,.e-parentContainer,.e-connectorlineContainer",this._mouseHover),i._on(i.element,"mouseleave",".e-gantt-milestone-container,.e-childContainer,.e-parentContainer,.e-connectorlineContainer",this._mouseLeave),i._on(i.element,"click",i._cellClickHandler),i._on(i.element,"mouseenter",".e-taskbarresizer-left",i._resizerleftOver),i._on(i.element,"mouseenter",".e-taskbarresizer-right",i._resizerrightOver),i._on(i.element,"mouseenter",".e-progressbarresizer-right",i._progressresizerOver),i._on(i.element,"mouseenter",".e-connectorpoint-left",i._dragLeftOver),i._on(i.element,"mouseenter",".e-connectorpoint-right",i._dragRightOver),t.browserInfo().name,i._on(i.element,"mousedown",".e-parentContainer,.e-childContainer,.e-gantt-milestone-container",i._mousedown),e(i._$bodyContainer).bind("mouseup",e.proxy(i._handleMouseUp,i)),e(document).bind("mouseup",e.proxy(i._tooltipMouseup,i)),i._on(i.element,"mouseenter",".e-stripline",i._stripLineMouseOver),i._on(i.element,"mouseleave",".e-stripline",i._stripLineMouseLeave),"chrome"==a.browser.toLowerCase()&&(i._on(i.element,"touchstart",".e-gantt-milestone-container,.e-childContainer, .e-parentContainer",this._mouseHover),i._on(i.element,"touchstart",".e-childContainer,.e-gantt-milestone-container",i._mousedown),i._on(i.element,"touchleave",".e-gantt-milestone-container,.e-childContainer, .e-parentContainer",this._mouseLeave),e(document.body).bind("touchmove",e.proxy(i.handleMouseMove,i)),i._on(i.element,"touchleave",".e-parentContainer,.e-childContainer,.e-gantt-milestone-container",i._handleMouseUp),e(i._$bodyContainer).bind("touchend",e.proxy(i._handleMouseUp,i)),e(i._$bodyContainer).bind("touchleave",e.proxy(i._handleMouseUp,i)),e(i._$bodyContainer).bind("touchstart",e.proxy(i._updateTouchCtrlFlag,i)))),i._enableEditingEvents()},_enableEditingEvents:function(){var e=this,i=e.model;!i.readOnly&&i.editSettings.allowEditing?t.isTouchDevice()?e._on(this.element,"doubletap",".e-ganttviewerbodyContent",e._editdblClickHandler):e._on(this.element,"dblclick",".e-ganttviewerbodyContent",e._editdblClickHandler):t.isTouchDevice()?e._off(this.element,"doubletap",".e-ganttviewerbodyContent",e._editdblClickHandler):e._off(this.element,"dblclick",".e-ganttviewerbodyContent",e._editdblClickHandler)},updateEditSettings:function(e){var i=this;e&&(e.editMode&&(i.model.editSettings.editMode=e.editMode),t.isNullOrUndefined(e.allowAdding)||(i.model.editSettings.allowAdding=e.allowAdding),t.isNullOrUndefined(e.allowEditing)||(i.model.editSettings.allowEditing=e.allowEditing),t.isNullOrUndefined(e.allowDeleting)||(i.model.editSettings.allowDeleting=e.allowDeleting),t.isNullOrUndefined(e.beginEditAction)||(i.model.editSettings.beginEditAction=e.beginEditAction),i._enableEditingEvents())},_editdblClickHandler:function(i){var a,r,n=this,o=this.model,l={},d=e(i.target);if(o.allowGanttChartEditing&&e(d).is(".e-line, .e-connectorline-rightarrow, .e-connectorline-leftarrow"))return a=d.parent(),e(a).find(".e-line").addClass("e-connectorline-hover"),e(a).find(".e-connectorline-rightarrow").length>0?e(a).find(".e-connectorline-rightarrow").addClass("e-connectorline-rightarrow-hover"):e(a).find(".e-connectorline-leftarrow").addClass("e-connectorline-leftarrow-hover"),n._hoverConnectorLineElement=a,n._predecessorInfo=n._getPredecessorTooltipData(a),void n._renderConnectorDialog(i);if("normal"===n.model.editSettings.editMode&&!o.readOnly&&n.model.editSettings.allowEditing&&!i.ctrlKey){if(l.requestType=t.TreeGrid.Actions.BeginEdit,"resourceView"==o.viewType){if("resourceChildTask"!=(r=n.getRecordByTarget(i)).eResourceTaskType&&"unassignedTask"!=r.eResourceTaskType)return!0;l.data=r,l.isResourceView=!0}n._trigger("actionBegin",l)}},_stripLineMouseLeave:function(){window.clearTimeout(this._tooltipTimer),this._clearTooltip()},_stripLineMouseOver:function(i){i.target.style.cursor="pointer";var a,r,n,o=this,l=o.model,d=e(i.target),s=0,c=0;o._clearTooltip(),a=(d.hasClass("e-striplinespan")?d[0].parentNode:d[0]).id.match(/(\d+|[A-z]+)/g),("mouseenter"==i.type||"mousemove"==i.type)&&(i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(s=i.originalEvent.pageX,c=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(s=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,c=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),r=t.buildTag("table.e-tooltiptable","",{width:"auto","margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),n=t.buildTag("tbody","<tr><td>"+l.stripLines[a[1]].day+"</td></tr><tr><td>"+l.stripLines[a[1]].label+"</td></tr>",{},{}),r.append(n),o._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+o._id,r,{position:"absolute","z-index":o._getMaxZIndex()+1},{}),l.cssClass&&o._mouseHoverTooltip.addClass(l.cssClass),setTimeout(function(){e(document.body).append(o._mouseHoverTooltip),o._updateTooltipPosition(o._mouseHoverTooltip,s,c)},700))},_tooltipMouseup:function(){var i=this,a=i.getGanttChartRows();if(null!=i._mouseTarget&&!t.isTouchDevice()){if(i.model.allowGanttChartEditing&&0==i.model.readOnly&&i._editingTarget&&i._editingItem){var r=i._editingTarget.closest("tr.e-ganttrowcell"),n=a.index(r),o=i._editingItem;e(r).hasClass("e-editmode")&&(e(r).removeClass("e-editmode"),i._mouseTarget=null),i._getPrevItem(o,n)}i._timerDragHorizontal&&(i._timerDragHorizontal=window.clearInterval(i._timerDragHorizontal)),i._timerDragVertical&&(i._timerDragVertical=window.clearInterval(i._timerDragVertical)),i._dummyElementRemoved&&(i._connectorDrawElement.remove(),i._dummyElementRemoved=!1,i._connectorDrawElement=null),"4"==e(i._$dependencyViewContainer).css("z-index")&&e(i._$dependencyViewContainer).css("z-index","5"),e("#ganttviewerbodyContianer"+i._id).unbind("mousemove"),i._trigger("cancelEditCell"),i._mouseDown=!1,i._clearTooltip(),i._newXYPos=!1,i._$ganttChartContainer[0].style.cursor="auto",i._allowDragging=!1,i._falseLine&&i._falseLine.remove(),i._falseLine=null,i._trigger("clearColumnMenu"),o&&i.model.enableTaskbarTooltip&&(i._predecessorTooltip&&i._predecessorTooltip.remove(),i._predecessorTooltip=null)}},_clearTooltip:function(){var t=this;t._mouseHoverTooltip&&e(t._mouseHoverTooltip).remove(),e(".e-editingtooltip").remove(),e("#tooltipgantt").remove(),e(".e-progressbartooltip").remove(),t._mouseHoverTooltip=null,t._connectorLineTooltip&&e(t._connectorLineTooltip).remove(),t._connectorLineTooltip=null},_resizerrightOver:function(e){var t=this,i=e.target.parentNode;1==t.model.allowGanttChartEditing&&0==t.model.readOnly&&(0==this._mouseDown&&(e.target.style.cursor="w-resize"),t._setEditingElements(i))},_resizerrightLeave:function(){var e=this;1==e.model.allowGanttChartEditing&&0==e.model.readOnly&&e._removeEditingElements()},_resizerleftOver:function(e){var t=this,i=e.target.parentNode;1==t.model.allowGanttChartEditing&&0==t.model.readOnly&&(0==this._mouseDown&&(e.target.style.cursor="e-resize"),t._setEditingElements(i))},_resizerleftLeave:function(){var e=this;1==e.model.allowGanttChartEditing&&0==e.model.readOnly&&e._removeEditingElements()},_progressresizerOver:function(t){var i=this,a=t.target,r=a.parentNode;1==i.model.allowGanttChartEditing&&0==i.model.readOnly&&(i.model.enableProgressBarResizing?(0==i._mouseDown&&e(a).prev(".e-gantt-childtaskbar").has(".e-gantt-childtaskbar-progress").length>0&&(a.style.cursor="col-resize"),i._setEditingElements(r)):a.style.cursor="move")},_progressresizerLeave:function(){var e=this;1==e.model.allowGanttChartEditing&&0==e.model.readOnly&&e._removeEditingElements()},_secondMouseOverConnectorPoint:function(i,a){var r,n,o,l,d=this;if(d._mouseDown&&d._falseLine||a&&d._falseLine){var s,c,u,p=e(i.target),h=d.getGanttChartRows(),g=p.closest("tr.e-ganttrowcell"),m=h.index(g),_=d.model.currentViewData[m],f=d._editingItem,w=_,C=d.model.predecessorText;if("Start"===d._prevItem.predecessorTarget?s=f.taskId+"S":"Finish"===d._prevItem.predecessorTarget&&(s=f.taskId+"F"),p.hasClass("e-connectortouchpoint")?p.parent().hasClass("e-connectorpoint-left")?(s+="S",u=C.Start):p.parent().hasClass("e-connectorpoint-right")&&(s+="F",u=C.Finish):p.hasClass("e-connectorpoint-left")?(s+="S",u=C.Start):p.hasClass("e-connectorpoint-right")&&(s+="F",u=C.Finish),t.isNullOrUndefined(_))return;if(d._predecessorTooltip&&(n=(r=d._predecessorTooltip.find("table")).find("tbody").find("tr:eq(1)").find("td:eq(2)").text(w.taskName),n=r.find("tbody").find("tr:eq(1)").find("td:eq(3)").text(u)),(o={}).requestType="validatePredecessor",o.fromItem=f,o.toItem=w,c=o.toItem.item[d.model.predecessorMapping]?o.toItem.item[d.model.predecessorMapping]+","+s:s,o.predecessor=s,o.currentRecord=w,o.predecessorString=[],o.predecessorString.push(c),l=d._completeAction(o),d._predecessorTooltip&&(n=r.find("tbody").find("tr:eq(0)").find("td:eq(0)"),l?(n.removeClass(),n.addClass("e-predecessor-true")):(n.removeClass(),n.addClass("e-predecessor-false"))),a)return o}},_dragLeftOver:function(t){var i=this,a=t.target,r=a.parentNode;"touchmove"==t.type&&e(t.target).hasClass("e-connectortouchpoint")&&(r=a.parentNode.parentNode),i.model.predecessorMapping&&i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&0==i.model.readOnly&&(0==this._mouseDown&&(a.style.cursor="pointer"),i._setEditingElements(r)),e(r).hasClass("e-parentContainer")||i._secondMouseOverConnectorPoint(t)},_dragLeftLeave:function(){var e=this;1==e.model.allowGanttChartEditing&&e.model.enablePredecessorEditing&&0==e.model.readOnly&&e._removeEditingElements()},_dragRightOver:function(t){var i=this,a=t.target,r=a.parentNode;"touchmove"==t.type&&e(t.target).hasClass("e-connectortouchpoint")&&(r=a.parentNode.parentNode),i.model.predecessorMapping&&i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&0==i.model.readOnly&&(0==this._mouseDown&&(a.style.cursor="pointer"),i._setEditingElements(r)),e(r).hasClass("e-parentContainer")||i._secondMouseOverConnectorPoint(t)},_dragRightLeave:function(){var e=this;1==e.model.allowGanttChartEditing&&e.model.enablePredecessorEditing&&0==e.model.readOnly&&e._removeEditingElements()},_setEditingElements:function(t){var i,a=this;if(a._editingTarget&&!a._editPredecessor&&0==e(t).find(a._editingTarget).length)return!0;e(t).hasClass("e-childContainer")&&(a._leftResizerGripper=t.querySelector(".e-taskbarresizer-left"),a._rightResizerGripper=t.querySelector(".e-taskbarresizer-right"),i=t.querySelector(".e-progressbarresizer-right"),a._progressHandle=i&&i.firstChild,a._progressHandleChild=i&&i.childNodes[1],e(a._leftResizerGripper).addClass("e-gripper"),e(a._rightResizerGripper).addClass("e-gripper"),a.model.progressMapping&&a.model.enableProgressBarResizing&&(e(a._progressHandle).addClass("e-progresshandle"),e(a._progressHandleChild).addClass("e-progresshandleafter"))),a.model.enablePredecessorEditing&&(e(t).hasClass("e-childContainer")&&a.model.predecessorMapping&&!a._falseLine?(a._leftConnectorPoint=t.querySelector(".e-connectorpoint-left"),a._rightConnectorPoint=t.querySelector(".e-connectorpoint-right"),e(a._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(a._rightConnectorPoint).addClass("e-connectorpoint-hover")):e(t).hasClass("e-gantt-milestone-container")&&a.model.predecessorMapping&&!a._falseLine?(a._leftConnectorPoint=t.querySelector(".e-connectorpoint-left"),a._rightConnectorPoint=t.querySelector(".e-connectorpoint-right"),e(a._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(a._rightConnectorPoint).addClass("e-connectorpoint-hover")):e(t).hasClass("e-childContainer")&&a.model.predecessorMapping&&a._falseLine?(a._childLeftConnectorPoint=t.querySelector(".e-connectorpoint-left"),a._childRightConnectorPoint=t.querySelector(".e-connectorpoint-right"),e(a._childLeftConnectorPoint).addClass("e-connectorpoint-hover"),e(a._childRightConnectorPoint).addClass("e-connectorpoint-hover")):e(t).hasClass("e-gantt-milestone-container")&&a.model.predecessorMapping&&a._falseLine?(a._childLeftConnectorPoint=t.querySelector(".e-connectorpoint-left"),a._childRightConnectorPoint=t.querySelector(".e-connectorpoint-right"),e(a._childLeftConnectorPoint).addClass("e-connectorpoint-hover"),e(a._childRightConnectorPoint).addClass("e-connectorpoint-hover")):e(t).hasClass("e-parentContainer")&&a.model.predecessorMapping&&!a._falseLine&&(a._leftConnectorPoint=t.querySelector(".e-connectorpoint-left"),a._rightConnectorPoint=t.querySelector(".e-connectorpoint-right"),e(a._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(a._rightConnectorPoint).addClass("e-connectorpoint-hover"),e(t).hasClass("e-manualparenttaskbar")&&(e(a._leftConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),e(a._rightConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"))))},_removeEditingElements:function(){var t,i=this;e(i._leftResizerGripper).removeClass("e-gripper"),e(i._rightResizerGripper).removeClass("e-gripper"),i.model.progressMapping&&(e(i._progressHandle).removeClass("e-progresshandle"),e(i._progressHandleChild).removeClass("e-progresshandleafter")),i.model.enablePredecessorEditing&&(i.model.predecessorMapping&&0==i._mouseDown&&(e(i._leftConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),e(i._rightConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),i._leftConnectorPoint=null,i._rightConnectorPoint=null),(i.model.predecessorMapping&&null!==i._leftConnectorPoint&&1==i._mouseDown||i._childLeftConnectorPoint)&&(e(i._childLeftConnectorPoint).removeClass("e-connectorpoint-hover"),e(i._childRightConnectorPoint).removeClass("e-connectorpoint-hover"),i._predecessorTooltip&&((t=i._predecessorTooltip.find("table")).find("tbody").find("tr:eq(1)").find("td:eq(2)").text(""),t.find("tbody").find("tr:eq(1)").find("td:eq(3)").text(""),t.find("tbody").find("tr:eq(0)").find("td:eq(0)").removeClass().addClass("e-predecessor-false"))))},refreshHeight:function(){this._$bodyContainer.ejScroller("refresh")},_mousedown:function(i){var a,r,n,o,l,d,s,c;if(2==i.which||3==i.which)return!1;(a=this)._clearTooltip(),a._mouseDown=!0,a._currentItemTop=0;var u=e(i.target),p=u.closest("tr.e-ganttrowcell"),h=this.getRecordByTarget(i),g=u[0].parentNode,m=this.model;t.isNullOrUndefined(h)||("touchstart"==i.type&&(i.preventDefault(),e(".e-connectortouchpoint").addClass("e-enableconnectortouchpoint")),a._editingItem=h,a._editingTarget=u,a._allowExpandCollapse=!0,g=e(g).hasClass("e-progressbarresizer-right")?g.parentNode:e(g).hasClass("e-gantt-childtaskbar-progress")?e(g).closest("div.e-childContainer"):e(g).hasClass("e-progressbarhandler")?u.closest(".e-childContainer")[0]:e(g).closest("div.e-childContainer,div.e-parentContainer,.e-gantt-milestone,div.e-gantt-milestone-container"),(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone")||e(g).hasClass("e-parentContainer")||e(g).hasClass("e-gantt-milestone-container"))&&(e(p).addClass("e-editmode"),a._mouseTarget=i),a.model.allowGanttChartEditing&&0==a.model.readOnly&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone")||e(g).hasClass("e-gantt-milestone-container")||e(g).hasClass("e-parentContainer"))&&(e(g).is(".e-childContainer,.e-parentContainer,.e-gantt-milestone,.e-gantt-milestone-container")&&e(a._$dependencyViewContainer).css("z-index","4"),("e-resize"==i.target.style.cursor&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone"))||"touchstart"==i.type&&"e-taskbarresizer-left"==i.target.className)&&(a._updateEditingType(),a._leftResizing=!0),("w-resize"==i.target.style.cursor&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone")||e(g).hasClass("e-parentContainer"))||"touchstart"==i.type&&"e-taskbarresizer-right"==i.target.className)&&(a._updateEditingType(),a._rightResizing=!0),l=e(i.target).closest(".e-progressbarresizer-right"),(("col-resize"==i.target.style.cursor||l.length&&"col-resize"==l[0].style.cursor)&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone"))||"touchstart"==i.type&&"e-progressbarresizer-right"==i.target.className)&&(a._updateEditingType(),a._progressResizing=!0),d=e(i.target).closest("[style*='cursor: move']"),(("move"==i.target.style.cursor||d.length&&"move"==d[0].style.cursor)&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone")||e(g).hasClass("e-gantt-milestone-container"))||e(u[0]).hasClass("e-gantt-manualparenttaskbar"))&&(a._updateEditingType(),a._allowDragging=!0),(""==i.target.style.cursor&&(d.length&&""==d[0].style.cursor||0==d.length)&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone")||e(g).hasClass("e-gantt-milestone-container"))||h.isAutoSchedule&&e(u).hasClass("e-gantt-manualparenttaskbar"))&&(a._updateEditingType(),"e-taskbarresizer-left e-icon"==i.target.className||"e-taskbarresizer-left e-icon e-gripper"==i.target.className?a._leftResizing=!0:"e-taskbarresizer-right e-icon"==i.target.className||"e-taskbarresizer-right e-icon e-gripper"==i.target.className?a._rightResizing=!0:"e-progressbarhandler e-progresshandle"==i.target.className||"e-progresshandler-element"==i.target.className||"e-progresshandlerafter-element"==i.target.className||"e-progressbarresizer-right"==i.target.className?a._progressResizing=!0:("e-gantt-childtaskbar-progress  progressbar"==i.target.className||"e-tasklabel"==i.target.className||"e-gantt-childtaskbar"==i.target.className||"e-gantt-milestone e-milestone-top"==i.target.className||"e-gantt-milestone e-milestone-bottom"==i.target.className||e(i.target).hasClass("e-gantt-milestone")||e(i.target).closest(".e-gantt-milestone").length>0||e(i.target).closest(".e-gantt-childtaskbar").length>0)&&(a._allowDragging=!0)),a.model.enablePredecessorEditing&&("pointer"==i.target.style.cursor&&(e(g).hasClass("e-childContainer")||e(g).hasClass("e-gantt-milestone")||e(g).hasClass("e-gantt-milestone-container")||e(g).hasClass("e-parentContainer"))||"touchstart"==i.type&&("e-connectorpoint-right"==i.target.className||"e-connectorpoint-left"==i.target.className||"e-connectorpoint-right e-connectorpoint-hover"==i.target.className||"e-connectorpoint-left e-connectorpoint-hover"==i.target.className))&&(a._updateEditingType(),(s={}).currentRecord=h,s.requestType="drawConnectorLine",a._trigger("actionBegin",s)?a._removeEditingElements():(a._editPredecessor=!0,a._connectorDrawElement=u.closest("tr")),u.hasClass("e-connectorpoint-left")||u.hasClass("e-connectorpoint-left e-connectorpoint-hover")?a._prevItem.predecessorTarget="Start":(u.hasClass("e-connectorpoint-right")||u.hasClass("e-connectorpoint-right e-connectorpoint-hover"))&&(a._prevItem.predecessorTarget="Finish")),i||(i=window.event),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&(i.originalEvent.pageX=i.originalEvent.clientX,i.originalEvent.pageY=i.originalEvent.clientY),i.originalEvent.pageX||i.originalEvent.pageY?(a._posX1=a._resMousePosX=a._currMousePosX=i.originalEvent.pageX,a.dragPosX=i.originalEvent.pageX,a._currMousePosY=a._resMousePosY=i.originalEvent.pageY,a._posY1=a.dragPosY=i.originalEvent.pageY-a._$bodyContainer.offset().top):i.originalEvent.clientX||i.originalEvent.clientY?(a._posX1=a._resMousePosX=a.dragPosX=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a._currMousePosY=a._resMousePosY=i.originalEvent.clientY,a._posY1=a.dragPosY=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop-a._$bodyContainer.offset().top):i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches.length>0&&(a._posX1=a._resMousePosX=a._currMousePosX=i.originalEvent.changedTouches[0].pageX,a.dragPosX=i.originalEvent.changedTouches[0].pageX,a._currMousePosY=a._resMousePosY=i.originalEvent.changedTouches[0].pageY,a._posY1=a.dragPosY=i.originalEvent.changedTouches[0].pageY-a._$bodyContainer.offset().top),a._prevItem.left=h.left,a._prevItem.status=h.status,a._prevItem.duration=h.duration,a._prevItem.startDate=h.startDate,a._prevItem.endDate=h.endDate,a._prevItem.width=h.width,"resourceView"==this.model.viewType&&this.model.allowDragAndDrop&&(r=a._posY1%this.model.rowHeight,o=((n=m.rowHeight)-m.taskbarHeight)/2,c=a._$bodyContainer.offset().top-e("#ganttViewTablebody"+a._id).offset().top,h.top=r>0?a._posY1+c-(a._posY1+c)%n+o:a._posY1,a._prevItem.top=a._currentItemTop=h.top,a._currentItemPrevTop=h.top),"resourceChildTask"==h.eResourceTaskType&&(a._prevItem.eOverlapIndex=h.eOverlapIndex,a._prevItem.eOverlapped=h.eOverlapped,a._prevOverlapOrders=a._getPrevOverlapValues(h)),a._parentCollectionPreviousValues=a._getParentCollectionPreviousValues(h),a.model.enablePredecessorEditing&&(a._connectorPointX=a._currMousePosX-a._$bodyContent.offset().left,a._connectorPointY=a._currMousePosY-a._$bodyContent.offset().top),e(a._$bodyContainer).bind("mousemove",e.proxy(a.handleMouseMove,a))),a._appendTooltip(u,h),a._trigger("clearColumnMenu"))},_getPrevOverlapValues:function(e){var t,i,a=[],r=e.parentItem,n=[];if(r&&r.eResourceChildTasks.length>0)for(n=r.eResourceChildTasks,t=0;t<n.length;t++)(i={}).data=n[t],i.overlapIndex=n[t].eOverlapIndex,a.push(i);return a},_getParentCollectionPreviousValues:function(e){var i,a=e,r={},n=[];do{i=a.parentItem,t.isNullOrUndefined(i)||(r.left=i.left,r.status=i.status,r.duration=i.duration,r.startDate=i.startDate,r.endDate=i.endDate,r.width=i.width,r.index=i.index,i.eRangeValues&&(r.eRangeValues=i.eRangeValues.slice()),r.eOverlapIndex=i.eOverlapIndex,r.isAutoSchedule||(r.manualLeft=i.manualLeft,r.manualStartDate=i.manualStartDate,r.manualEndDate=i.manualEndDate,r.manualDuration=i.manualDuration),n.push(r),a=i,r={})}while(a.parentItem);return n},handleMouseMove:function(e){this._updateOnmouseMove(e)},taskbarEditedArguments:function(){return this._taskbarEditedArgs},taskbarEditedCancel:function(e){var t=e.data,i=e.recordIndex,a=this,r=a.model,n=a._taskbarEditedArgs;"resourceChildTask"==t.eResourceTaskType&&n.previousResource&&n.assignedResource&&n.assignedResource[r.resourceIdMapping]==n.previousResource[r.resourceIdMapping]&&this._updateResourceChildTasks(t),a._getPrevItem(t,i),"resourceChildTask"==t.eResourceTaskType&&a._trigger("taskbarEditedCancel",t),t.parentItem&&a._getParentPreviousValue(),a.model.predecessorMapping&&(n.dragging||n.rightResizing||n.leftResizing)&&(n.requestType="updateConnectors",n.ganttRecord=t,a._trigger("actionComplete",n))},_updateTouchCtrlFlag:function(e){"touchstart"==e.type&&(this._ganttTouchTrigger=!0)},_getElementByPosition:function(e,t){return document.elementFromPoint(e-window.pageXOffset,t-window.pageYOffset)},_handleMouseUp:function(i){var a,r,n,o,l,d,s,c,u,p,h,g=this,m={},_=g.getGanttChartRows(),f=0,w=g._posX1,C=g._posY1;g._timerDragHorizontal&&(g._timerDragHorizontal=window.clearInterval(g._timerDragHorizontal)),g._timerDragVertical&&(g._timerDragVertical=window.clearInterval(g._timerDragVertical)),g._dummyElementRemoved&&(g._connectorDrawElement.remove(),g._dummyElementRemoved=!1,g._connectorDrawElement=null),t.isNullOrUndefined(i.pageX)?(n=i.originalEvent.changedTouches[0].pageX,o=i.originalEvent.changedTouches[0].pageY,l=i.originalEvent.changedTouches[0].pageY-g._$bodyContainer.offset().top,t.isNullOrUndefined(g._predecessorTooltip)||(i.target=this._getElementByPosition(n,o))):(n=i.pageX,o=i.pageY,l=i.pageY-g._$bodyContainer.offset().top),"4"==e(g._$dependencyViewContainer).css("z-index")&&e(g._$dependencyViewContainer).css("z-index","5"),(e(i.target).hasClass("e-connectorpoint-left")||e(i.target).hasClass("e-connectorpoint-right")||e(i.target).hasClass("e-connectortouchpoint"))&&g._falseLine&&!e(i.target).parent().hasClass("e-parentContainer")&&(g._trigger("cancelEditCell"),e(i.target).hasClass("e-connectortouchpoint")&&(i.target=e(i.target).parent()),u=g._secondMouseOverConnectorPoint(i,!0),t.isNullOrUndefined(u)||(m.data=u.currentRecord,m.currentRecord=u.currentRecord,m.fromItem=u.fromItem,m.toItem=u.toItem,m.predecessor=u.predecessor,m.predecessorString=u.predecessorString,m.requestType="validatePredecessor",g._trigger("actionBegin",m)||u.predecessorValidation&&(u.requestType="drawConnectorLine",g._completeAction(u)))),m.data&&(c=m.data,g._prevItem.left=c.left,g._prevItem.status=c.status,g._prevItem.duration=c.duration,g._prevItem.startDate=c.startDate,g._prevItem.endDate=c.endDate,g._prevItem.width=c.width),null!=g._editingTarget&&null!=g._editingItem&&(a=g._editingTarget.closest("tr.e-ganttrowcell"),f=_.index(a),r=g._editingItem,e(a).hasClass("e-editmode")&&(e(a).removeClass("e-editmode"),g._mouseTarget=null)),e("#ganttviewerbodyContianer"+g._id).unbind("mousemove"),g._mouseDown=!1,g._clearTooltip(),w!=n||Math.abs(C-l)>=(this.model.rowHeight-this.model.taskbarHeight)/2?(g._editingTarget=null,g._editingItem=null,g._$ganttChartContainer[0].style.cursor="auto",null!=r&&(g._allowDragging||g._leftResizing||g._rightResizing||g._progressResizing)&&(m.editingFields={startdate:r.startDate,enddate:r.endDate,progress:r.status,duration:r.duration,durationunit:r.durationUnit},m.data=r,m.recordIndex=f,m.previousData=g._prevItem,m.dragging=g._allowDragging,m.leftResizing=g._leftResizing,m.rightResizing=g._rightResizing,m.progressResizing=g._progressResizing,m.roundOffDuration=g._roundOffDuration,"resourceView"==this.model.viewType&&(m.isVerticalDragging=Math.abs(C-l)>=g.model.rowHeight,m.previousResource=r.parentItem?r.parentItem.item:null),g.model.predecessorMapping?(p={respectLink:!1,removeLink:!1,preserveLinkWithEditing:!0},(u={}).editMode="dragging",u.data=r,u.recordIndex=f,u.requestType="validateLinkedTask",u.validateMode=p,g._taskbarEditedArgs=m,g._trigger("actionBegin",u),u.cancel&&g._taskbarEdited(m)):(g._taskbarEditedArgs=m,g._taskbarEdited(m))),m.cancel&&g.taskbarEditedCancel(m),g._updateEditingType(),g._falseLine&&g._falseLine.remove(),g._falseLine=null,g._predecessorTooltip&&g._predecessorTooltip.remove(),g._predecessorTooltip=null,e(g._leftConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),e(g._rightConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),e(g._childRightConnectorPoint).removeClass("e-connectorpoint-hover"),e(g._childLeftConnectorPoint).removeClass("e-connectorpoint-hover"),g._leftConnectorPoint=null,g._rightConnectorPoint=null,g._childRightConnectorPoint=null,g._childLeftConnectorPoint=null,g._trigger("clearColumnMenu")):(g._newXYPos=!1,g._$ganttChartContainer[0].style.cursor="auto",g._allowDragging=!1,g._falseLine&&g._falseLine.remove(),g._falseLine=null,r&&g.model.enableTaskbarTooltip&&(g._predecessorTooltip&&g._predecessorTooltip.remove(),g._predecessorTooltip=null,d={ttipstartDate:this._getFormatedDate(r.startDate,this.model.dateFormat,this.model.locale),ttipendDate:this._getFormatedDate(r.endDate,this.model.dateFormat,this.model.locale),ttipduration:r.duration,ttipprogress:r.status.toString(),ttiptaskname:r.taskName,ttipdurationunit:r.durationUnit},s=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"5"}),g.model.tooltipTemplate||g.model.tooltipTemplateId?g.model.tooltipTemplate?(g._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+g._id,"",{position:"absolute","z-index":g._getMaxZIndex()+1,"border-radius":"5px"},{}),g.model.cssClass&&g._mouseHoverTooltip.addClass(g.model.cssClass),g.tooltipState="Template",h=t.buildTag("tbody",e.render[g._id+"tooltipTemplate"](r),{},{}),g._mouseHoverTooltip[0].innerHTML="<table>"+h[0].innerHTML+"</table>",g._tooltipTimer=setTimeout(function(){e(document.body).append(g._mouseHoverTooltip),g._updateTooltipPosition(g._mouseHoverTooltip,n,o+20)},300)):g.model.tooltipTemplateId&&(g._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+g._id,"",{position:"absolute","z-index":g._getMaxZIndex()+1,"border-radius":"5px"},{}),g.model.cssClass&&g._mouseHoverTooltip.addClass(g.model.cssClass),g.tooltipState="TemplateID",h=t.buildTag("tbody",e.render[g._id+"tooltipTemplate"](r),{},{}),g._mouseHoverTooltip[0].innerHTML="<table>"+h[0].innerHTML+"</table>",g._tooltipTimer=setTimeout(function(){e(document.body).append(g._mouseHoverTooltip),g._updateTooltipPosition(g._mouseHoverTooltip,n,o+20)},300)):(g.tooltipState="",h=t.buildTag("tbody",e.render[g._id+"tooltipTemplate"](d),{},{}),s.append(h),g._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+g._id,s,{position:"absolute","z-index":g._getMaxZIndex()+1,"border-radius":"5px"},{}),g.model.cssClass&&g._mouseHoverTooltip.addClass(g.model.cssClass),g._mouseHoverTooltip.innerHTML="<table>"+s[0].innerHTML+"</table>",g._tooltipTimer=setTimeout(function(){e(document.body).append(g._mouseHoverTooltip),g._updateTooltipPosition(g._mouseHoverTooltip,n,o+20)},300)),e(g._mouseHoverTooltip).addClass("e-customTooltip"),g._trigger("clearColumnMenu"))),"touchend"==i.type&&e(".e-connectortouchpoint").removeClass("e-enableconnectortouchpoint")},getChildCount:function(e,t){var i,a;if(!e.hasChildRecords)return 0;for(a=0;a<e.childRecords.length;a++)t++,(i=e.childRecords[a]).hasChildRecords&&(t=this.getChildCount(i,t));return t},criticalDataMapping:function(e,i,a,r){1==i&&(this.model.isCriticalPathEnable=!0,t.isNullOrUndefined(e)||(this.model.criticalPathCollection=e,this.model.detailPredecessorCollection=a,this.collectionTaskId=r)),0==i&&(this.model.isCriticalPathEnable=!1)},criticalPathColor:function(e,i,a,r){1==i&&(t.isNullOrUndefined(e)||(this._refresh(),t.isNullOrUndefined(a)||this.criticalConnectorLine(e,a,!0,r))),0==i&&(this.criticalConnectorLine(e,a,!1,r),this._refresh())},criticalConnectorLine:function(e,t,i,a){var r,n,o,l,d,s;if(0==i)this.element.find(".e-line").removeClass("e-criticalconnectorline"),this.element.find(".e-connectorline-rightarrow").removeClass("e-criticalconnectorlinerightarrow"),this.element.find(".e-connectorline-leftarrow").removeClass("e-criticalconnectorlineleftarrow");else if(0!=t.length)for(r=0,o=[],d=0;d<this.model.criticalPathCollection.length;d++)if(n=t[r=a.indexOf(this.model.criticalPathCollection[d])],-1!=r&&n.to)for(o=n.to.split(","),s=0;s<o.length;s++)l=parseInt(o[s]),-1!=e.indexOf(l)&&(this.element.find("#ConnectorLineparent"+n.taskid+"child"+l).find(".e-line").addClass("e-criticalconnectorline"),this.element.find("#ConnectorLineparent"+n.taskid+"child"+l).find(".e-connectorline-rightarrow").addClass("e-criticalconnectorlinerightarrow"),this.element.find("#ConnectorLineparent"+n.taskid+"child"+l).find(".e-connectorline-leftarrow").addClass("e-criticalconnectorlineleftarrow"))},_getCollapsedParentItem:function(e){var t=e.parentItem;return t?!0===this._getExpandStatus(t)?t:this._getCollapsedParentItem(t):null},updateScrollBar:function(){var e,t,i,a,r,n=this,o=n.model;if(i=(t=n.getExpandedRecords(o.updatedRecords)).indexOf(o.selectedItem),o.selectedItem&&-1!=i){var l,d=this._getRecordTopPosition(t,i),s=d.top,c=d.bottom;l=n._$bodyContainer.children(".e-content").length?n._$bodyContainer.children(".e-content").scrollTop():n._$bodyContainer.scrollTop(),(n._$bodyContainer.ejScroller("isHScroll")||n.element.find(".e-borderbox").length>0)&&(e=18),a=s<l,r=l+n._viewportHeight-e<c,(a||r)&&(s+n._viewportHeight>n._containerHeight&&(s=n._containerHeight-n._viewportHeight,r&&(s+=e)),n._$bodyContainer.ejScroller("scrollY",s,!0),o.enableVirtualization&&n.focusGanttElement())}},getExpandedRecords:function(e){var t=this;return e.filter(function(e){return 1==t._getExpandStatus(e)})},_selectedItemDown:function(){var e,t,i,a=this,r=this.model,n=r.updatedRecords,o=a.getExpandedRecords(n);e=a._prevSelectedItem&&this._getExpandStatusRecord(a._prevSelectedItem)?r.updatedRecords.indexOf(a._prevSelectedItem):0,a._shiftSelectedRecord&&this._getExpandStatusRecord(a._shiftSelectedRecord)?(i=o.indexOf(a._shiftSelectedRecord),t=r.updatedRecords.indexOf(o[i+1])):(i=o.indexOf(r.updatedRecords[e]),t=r.updatedRecords.indexOf(o[i+1])),(t>=r.updatedRecords.length||-1==t)&&(t=r.updatedRecords.length-1),a.updateScrollBar(t),a._multiSelectShiftRequest=!0,a.selectRows(e,t),a._rowSelectedEventTrigger(e,t),a._multiSelectShiftRequest=!1,a._shiftSelectedRecord=r.updatedRecords[t]},_selectedItemUp:function(){var e,t,i,a=this,r=this.model,n=r.updatedRecords,o=a.getExpandedRecords(n);e=a._prevSelectedItem&&this._getExpandStatusRecord(a._prevSelectedItem)?r.updatedRecords.indexOf(a._prevSelectedItem):0,a._shiftSelectedRecord&&this._getExpandStatusRecord(a._shiftSelectedRecord)?(i=o.indexOf(a._shiftSelectedRecord),t=r.updatedRecords.indexOf(o[i-1])):(i=o.indexOf(r.updatedRecords[e]),t=r.updatedRecords.indexOf(o[i-1])),t<0&&(t=0),a.updateScrollBar(t),a._multiSelectShiftRequest=!0,a.selectRows(e,t),a._rowSelectedEventTrigger(e,t),a._multiSelectShiftRequest=!1,a._shiftSelectedRecord=r.updatedRecords[t]},_keyPressed:function(e,t,i,a){var r,n,o,l=this,d=this.model,s=d.updatedRecords,c=l.getExpandedRecords(s);if(a.stopImmediatePropagation(),a.preventDefault(),!d.allowKeyboardNavigation)return!0;switch(e){case"downArrow":s.length>0&&d.selectedItem&&(n=s.length-1,d.selectedRowIndex!=n&&(o=c[(r=c.indexOf(d.selectedItem))+1],r=s.indexOf(o),o&&r<=n&&!l._rowSelectingEventTrigger(d.selectedRowIndex,r)&&(l.selectRows(r),l.focusGanttElement(),l.updateScrollBar(),l._rowSelectedEventTrigger(d.selectedRowIndex))));break;case"upArrow":0!==d.selectedRowIndex&&s.length>0&&d.selectedItem&&(o=c[(r=c.indexOf(d.selectedItem))-1],r=s.indexOf(o),l._rowSelectingEventTrigger(d.selectedRowIndex,r)||(l.selectRows(r),l.focusGanttElement(),l.updateScrollBar(),l._rowSelectedEventTrigger(d.selectedRowIndex)));break;case"firstRowSelection":s.length>0&&(l._rowSelectingEventTrigger(d.selectedRowIndex,0)||(l.selectRows(0),l.focusGanttElement(),l.updateScrollBar(),l._rowSelectedEventTrigger(0)));break;case"lastRowSelection":s.length>0&&(o=c[n=c.length-1],r=s.indexOf(o),l._rowSelectingEventTrigger(d.selectedRowIndex,r)||(l.selectRows(r),l.focusGanttElement(),l.updateScrollBar(),l._rowSelectedEventTrigger(r)));break;case"rightArrow":var u=l.model.selectedRowIndex,p=l.model.updatedRecords[u];(h={}).data=p,h.recordIndex=u,h.expanded=!0,p&&(l._rowSelectingEventTrigger()||!p.hasChildRecords||p.expanded||(u>=0&&l._trigger("expanding",h),d.enableVirtualization&&l.focusGanttElement()));break;case"leftArrow":var h;u=l.model.selectedRowIndex,p=l.model.updatedRecords[u];(h={}).data=p,h.recordIndex=u,h.expanded=!1,p&&!l._rowSelectingEventTrigger()&&p.hasChildRecords&&p.expanded&&(u>=0&&l._trigger("collapsing",h),d.enableVirtualization&&l.focusGanttElement());break;case"deleteRecord":d.editSettings.allowDeleting&&d.selectedRowIndex>=0&&(l._trigger("deleteRow"),l.focusGanttElement());break;case"totalRowCollapse":(h={}).requestType="collapseAll",l._trigger("expandAllCollapseAllRequest",h);break;case"totalRowExpand":(h={}).requestType="expandAll",l._trigger("expandAllCollapseAllRequest",h);break;case"shiftDownArrow":d.allowSelection&&"row"==d.selectionMode&&"multiple"==d.selectionType&&l._selectedItemDown();break;case"shiftUpArrow":d.allowSelection&&"row"==d.selectionMode&&"multiple"==d.selectionType&&l._selectedItemUp()}return!0},_rowSelectingEventTrigger:function(e,t){var i={};if("row"==this.model.selectionMode)return i.previousIndex=e,i.recordIndex=t,this._trigger("rowSelecting",i)},_rowSelectedEventTrigger:function(e,i){var a,r=this;"row"==r.model.selectionMode&&(a={data:r.model.updatedRecords[e],target:"ejGanttChart",recordIndex:e},t.isNullOrUndefined(i)||(a.toIndex=i),a.selectedItems=r.model.selectedItems,r._trigger("rowSelected",a))},_updateEditingType:function(){var e=this;e._leftResizing=!1,e._allowDragging=!1,e._rightResizing=!1,e._progressResizing=!1,e._editPredecessor=!1},_updateResourceChildTasks:function(e){if(e.parentItem&&this._prevOverlapOrders&&this._prevOverlapOrders.length>0){e.parentItem.eResourceChildTasks=[];for(var t=0;t<this._prevOverlapOrders.length;t++)this._prevOverlapOrders[t].data.eOverlapIndex=this._prevOverlapOrders[t].overlapIndex,e.parentItem.eResourceChildTasks.push(this._prevOverlapOrders[t].data)}},_getPrevItem:function(e,t){var i,a=this;e.left=a._prevItem.left,e.width=a._prevItem.width,e.startDate=a._prevItem.startDate,e.endDate=a._prevItem.endDate,e.duration=a._prevItem.duration,e.status=a._prevItem.status,e.eOverlapIndex=a._prevItem.eOverlapIndex,e.eOverlapped=a._prevItem.eOverlapped,e.progressWidth=this._getProgressWidth(e.width,e.status),this.refreshRow(t),(i={}).index=t,this._refreshRow(i)},_getParentPreviousValue:function(){for(var e,t,i,a,r=this,n=r.model,o=r._parentCollectionPreviousValues.length,l=0;l<o;l++)i=(t=r._parentCollectionPreviousValues[l]).index,(a=n.updatedRecords[i]).left=t.left,a.width=t.width,a.startDate=t.startDate,a.endDate=t.endDate,a.duration=t.duration,a.status=t.status,a.progressWidth=this._getProgressWidth(a.width,a.status),t.eRangeValues&&(a.eRangeValues=t.eRangeValues.slice()),a.eOverlapIndex=t.eOverlapIndex,this.refreshRow(i),(e={}).index=i,this._refreshRow(e)},_enableLeftResizing:function(i,a){var r=this,n=this.model.scheduleHeaderSettings.scheduleHeaderType,o=t.Gantt.ScheduleHeaderType;i.target.style.cursor="e-resize",e(r._leftResizer).addClass("e-gripper"),e(r._rightResizer).addClass("e-gripper"),r.dragPosX>r._mousePosX?(r._mousePosX=r.dragPosX-r._mousePosX,a.left>0&&(a.left-=r._mousePosX,a.width+=r._mousePosX)):(r._mousePosX-=r.dragPosX,a.left+30<a.left+a.width&&a.left+r._mousePosX<=this._prevItem.left+this._prevItem.width&&(a.left+=r._mousePosX,a.width-=r._mousePosX)),this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX,a.width=n==o.Day?a.width<r.model.perHourWidth?r.model.perHourWidth:a.width:n==o.Hour?a.width<r.model.perMinuteWidth?r.model.perMinuteWidth:a.width:a.width<r.model.perDayWidth?r.model.perDayWidth:a.width,a.progressWidth=r._getProgressWidth(a.width,a.status),a.left=this._prevItem.left+this._prevItem.width-a.width,r._setItemPosition(a)},_enableProgressResizing:function(i,a){var r,n,o=this;i.target.style.cursor="col-resize",e(o._leftResizer).addClass("e-gripper"),e(o._rightResizer).addClass("e-gripper"),o._progressResizer&&(o._progressHandle=o._progressResizer&&o._progressResizer.firstChild,o._progressHandleChild=o._progressResizer&&o._progressResizer.childNodes[1]),o.dragPosX>o._mousePosX?(o._mousePosX=o.dragPosX-o._mousePosX,a.left>0&&(a.progressWidth-=o._mousePosX)):(o._mousePosX-=o.dragPosX,a.progressWidth+=o._mousePosX),this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX,a.progressWidth=a.progressWidth>a.width?a.width:a.progressWidth,a.progressWidth=a.progressWidth<0?0:a.progressWidth,n=(r=a.width-a.progressWidth)<=4?4-r:0,e(o._progressbarItem).css({width:a.progressWidth+"px","border-top-right-radius":n+"px","border-bottom-right-radius":n+"px"}),e(o._progressResizer).css({left:a.left+a.progressWidth-10+"px"}),e(o._progressHandle).addClass("e-progresshandle"),e(o._progressHandleChild).addClass("e-progresshandleafter")},_enableRightResizing:function(i,a){var r=this,n=this.model;i.target.style.cursor="w-resize",e(r._leftResizer).addClass("e-gripper"),e(r._rightResizer).addClass("e-gripper"),r.dragPosX>r._mousePosX?(r._mousePosX=r.dragPosX-r._mousePosX,a.width>0&&(a.width-=r._mousePosX)):(r._mousePosX-=r.dragPosX,a.width+=r._mousePosX),this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX,a.width=n.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Day?a.width<r.model.perHourWidth?r.model.perHourWidth:a.width:n.scheduleHeaderSettings.scheduleHeaderType==t.Gantt.ScheduleHeaderType.Hour?a.width<r.model.perMinuteWidth?r.model.perMinuteWidth:a.width:a.width<r.model.perDayWidth?r.model.perDayWidth:a.width,"resourceChildTask"!=a.eResourceTaskType?(a.hasChildRecords?e(r._manualRightResizer).css({left:a.width-parseInt(r._manualRightResizer.style.borderRightWidth.replace("px",""))+"px"}):(a.progressWidth=r._getProgressWidth(a.width,a.status),e(r._tasknameContainer).css({left:a.left+"px",width:a.width+"px"})),e(r._taskbarItem).css({width:a.width+"px"}),e(r._progressbarItem).css({width:a.progressWidth+"px"}),e(r._rightResizer).css({left:a.left+a.width-r._resizerRightAdjust+"px"}),e(r._progressResizer).css({left:a.left+a.progressWidth-10+"px"}),e(r._leftConnectorPoint).css({left:a.left-r._connectorPointWidth+"px"}),e(r._rightConnectorPoint).css({left:a.left+a.width+"px"})):"resourceChildTask"==a.eResourceTaskType&&(a.progressWidth=r._getProgressWidth(a.width,a.status),e(r._currentEditTaskBar).css({left:a.left+"px",width:a.width+"px"}),e(r._taskbarItem).css({width:a.width+"px"}),e(r._progressbarItem).css({width:a.progressWidth+"px"}),e(r._rightResizer).css({left:a.width-r._resizerRightAdjust+"px"}))},_enableDragging:function(i,a){var r,n,o=this,l=this.model;i.target.style.cursor="move",e(i.target.parentNode).hasClass("e-parentContainer")&&(o._allowExpandCollapse=!1),this.dragPosX>o._mousePosX?(o._mousePosX=o.dragPosX-o._mousePosX,a.left>0&&(a.left-=o._mousePosX)):(o._mousePosX-=o.dragPosX,a.left+=o._mousePosX),this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX,"resourceView"==this.model.viewType&&this.model.allowDragAndDrop&&(r=(l.rowHeight-l.taskbarHeight)/2,n=o._$bodyContainer.offset().top,e(o._currentEditTaskBar).css("margin-top",0),this.dragPosY>o._mousePosY?(o._mousePosY=o.dragPosY-o._mousePosY,o._currentItemTop=o._currentItemTop-o._mousePosY):(o._mousePosY-=o.dragPosY,o._currentItemTop=o._currentItemTop+o._mousePosY),this.dragPosY=t.isNullOrUndefined(i.originalEvent.pageY)?i.originalEvent.targetTouches[0].pageY-n:i.originalEvent.pageY-n,a.top=o._currentItemTop%l.rowHeight<=l.taskbarHeight/2&&o._currentItemTop%l.rowHeight>=r?o._currentItemTop:o._currentItemPrevTop,o._currentItemPrevTop=0==o._currentItemPrevTop||a.top==o._currentItemTop?a.top:o._currentItemPrevTop,a.top=a.top<0?0:a.top),a.left=a.left<0?0:a.left,this._setItemPosition(a)},_appendTooltip:function(i,a){var r,n,o,l,d,s,c,u,p=this,h=e(i),g=this.model,m=a,_=p.model.columnHeaderTexts,f=p.model.predecessorEditingTexts;null!=m&&(o=h[0],e(h[0]).hasClass("e-progressbarresizer-right")&&(o=h.closest(".e-childContainer")[0]),(e(o).hasClass("e-parentContainer")||e(o).hasClass("e-childContainer"))&&(p._editingContainer=o,p._leftResizer=p._editingContainer.querySelector(".e-connectorpoint-left"),p._taskbarItem=p._editingContainer.querySelector(".e-taskbarresizer-left"),p._progressbarItem=p._editingContainer.querySelector(".e-gantt-childtaskbar"),p._progressResizer=p._editingContainer.querySelector(".e-gantt-childtaskbar-progress"),p._rightResizer=p._editingContainer.querySelector(".e-progressbarresizer-right")),this.model.enableTaskbarDragTooltip&&!h.hasClass("e-parentContainer")&&(1==this._progressResizing?(p._$ganttChartContainer[0].style.cursor="col-resize",n=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),(u=t.buildTag("tbody","",{},{}))[0].innerHTML="<tr><td>"+_.status+" : "+m.status+"%</td></tr>",n.append(u),p.model.progressbarTooltipTemplate?(p._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+p._id,"",{position:"absolute","z-index":p._getMaxZIndex()+1},{}),p.model.cssClass&&p._progressBarTooltipID.addClass(p.model.cssClass),u=t.buildTag("tbody",e.render[p._id+"progressbarTooltipTemplate"](m),{},{}),p._progressBarTooltipID[0].innerHTML="<table>"+u[0].innerHTML+"</table>"):p.model.progressbarTooltipTemplateId?(p._progressBarTooltipID=t.buildTag("div.e-progressbartooltip#progressbartooltip"+p._id,"",{position:"absolute","z-index":p._getMaxZIndex()+1},{}),p.model.cssClass&&p._progressBarTooltipID.addClass(p.model.cssClass),u=t.buildTag("tbody",e.render[p._id+"progressbarTooltipTemplate"](m),{},{}),p._progressBarTooltipID[0].innerHTML="<table>"+u[0].innerHTML+"</table>"):(p._progressBarTooltipID=t.buildTag("div.e-progressbartooltip e-js#progressbartooltip"+p._id,n,{position:"absolute","z-index":p._getMaxZIndex()+1},{onselectstart:"return false"}),p.model.cssClass&&p._progressBarTooltipID.addClass(p.model.cssClass)),p._progressBarTooltipID&&(e(document.body).append(p._progressBarTooltipID),p._updateTooltipPosition(p._progressBarTooltipID,p._currMousePosX,p._currMousePosY,!0))):!0===this._editPredecessor&&p.model.enablePredecessorEditing?(l=g.predecessorText,null===p._predecessorTooltip&&(p._predecessorTooltip=t.buildTag("div.e-tooltipganttpredecessor e-js#predecessortooltip"+p._id,"",{top:p._currMousePosY+10+"px",left:p._currMousePosX+10+"px",position:"absolute","z-index":p._getMaxZIndex()+1},{onselectstart:"return false"}),p.model.cssClass&&p._predecessorTooltip.addClass(p.model.cssClass),n=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),u=t.buildTag("tbody","",{},{}),d="<tr><td class='e-predecessor-false'></td><td >"+f.fromText+":</td><td class='e-tooltiptaskname'>"+m.taskName+"</td><td>"+l[p._prevItem.predecessorTarget]+"</td> </tr><tr><td></td><td>"+f.toText+":</td><td class='e-tooltiptaskname'></td><td></td></tr>",e(u).html(d),n.append(u),p._predecessorTooltip.append(n),e(document.body).append(p._predecessorTooltip),p._updateTooltipPosition(p._predecessorTooltip,p._currMousePosX,p._currMousePosY))):(1==p._leftResizing||1==p._rightResizing||1==p._allowDragging)&&(1==p._leftResizing?(p._$ganttChartContainer[0].style.cursor="e-resize",r={ttipstartDate:this._getFormatedDate(m.startDate,g.dateFormat,g.locale),ttipduration:m.duration,ttipdurationunit:m.durationUnit}):1==p._rightResizing?(p._$ganttChartContainer[0].style.cursor="w-resize",r={ttipendDate:this._getFormatedDate(m.endDate,g.dateFormat,g.locale),ttipduration:m.duration,ttipdurationunit:m.durationUnit}):1==p._allowDragging&&(p._$ganttChartContainer[0].style.cursor="move",s=g.ganttInstance._getValidStartDate(m),c=g.ganttInstance._getValidEndDate(m),r={ttipstartDate:this._getFormatedDate(s,g.dateFormat,g.locale),ttipendDate:this._getFormatedDate(c,g.dateFormat,g.locale)}),n=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"2px",cellpadding:"2px"}),p.model.taskbarEditingTooltipTemplate?(p._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip e-js#editingtooltip"+p._id,"",{position:"absolute","z-index":p._getMaxZIndex()+1},{}),p.model.cssClass&&p._taskbarEditingTooltipID.addClass(p.model.cssClass),p.tooltipState="editingTemplateID",u=t.buildTag("tbody",e.render[p._id+"editingTooltipTemplate"](m),{},{}),p._taskbarEditingTooltipID[0].innerHTML="<table>"+u[0].innerHTML+"</table>"):p.model.taskbarEditingTooltipTemplateId?(p._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip e-js#editingtooltip"+p._id,"",{position:"absolute","z-index":p._getMaxZIndex()+1},{}),p.model.cssClass&&p._taskbarEditingTooltipID.addClass(p.model.cssClass),p.tooltipState="editingTemplate",u=t.buildTag("tbody",e.render[p._id+"editingTooltipTemplate"](m),{},{}),p._taskbarEditingTooltipID[0].innerHTML="<table>"+u[0].innerHTML+"</table>"):(p.tooltipState="",r&&(u=t.buildTag("tbody",e.render[p._id+"editingTooltipTemplate"](r),{},{}),n.append(u)),p._taskbarEditingTooltipID=t.buildTag("div.e-editingtooltip e-js#editingtooltip"+p._id,n,{position:"absolute","z-index":p._getMaxZIndex()+1},{}),p.model.cssClass&&p._taskbarEditingTooltipID.addClass(p.model.cssClass)),p._taskbarEditingTooltipID&&(e(document.body).append(p._taskbarEditingTooltipID),"resourceView"==this.model.viewType&this.model.allowDragAndDrop?p._updateTooltipPosition(p._taskbarEditingTooltipID,p._resMousePosX,p._resMousePosY,!0):p._updateTooltipPosition(p._taskbarEditingTooltipID,p._currMousePosX,p._currMousePosY,!0)))))},_setItemPosition:function(t){var i=this;"resourceChildTask"!=t.eResourceTaskType&&"unassignedTask"!=t.eResourceTaskType?(e(i._leftResizer).css({left:t.left+2+"px"}),e(i._rightResizer).css({left:t.left+t.width-i._resizerRightAdjust+"px"}),e(i._taskbarItem).css({left:t.left+"px",width:t.width+"px"}),e(i._progressbarItem).css({width:t.progressWidth+"px"}),e(i._progressResizer).css({left:t.left+t.progressWidth-10+"px"}),e(i._tasknameContainer).css({left:t.left+"px",width:t.width+"px"}),e(i._leftConnectorPoint).css({left:t.left-i._connectorPointWidth+"px"}),e(i._rightConnectorPoint).css({left:t.left+t.width+"px"})):("resourceChildTask"==t.eResourceTaskType||"unassignedTask"==t.eResourceTaskType)&&(i._allowDragging&&this.model.allowDragAndDrop?(e(i._leftResizer).css({left:"2px"}),e(i._rightResizer).css({left:t.width-i._resizerRightAdjust+"px"}),e(i._currentEditTaskBar).css({left:t.left+"px",width:t.width+"px",top:t.top+"px"})):(e(i._leftResizer).css({left:"2px"}),e(i._rightResizer).css({left:t.width-i._resizerRightAdjust+"px"}),e(i._progressbarItem).css({width:t.progressWidth+"px"}),e(i._currentEditTaskBar).css({left:t.left+"px",width:t.width+"px"}),e(i._taskbarItem).css({width:t.width+"px"})))},_updateOnmouseMove:function(a){var r,n,o,l,d=this,s={},c=d._editingTarget?d._editingTarget:null,u=c?c.closest("tr.e-ganttrowcell"):null,p=d._editingItem,h=c?c[0].parentNode:null;if(d._newXYPos=!0,h=e(h).hasClass("e-progressbarresizer-right")?h.parentNode:e(h).hasClass("e-gantt-childtaskbar-progress")?e(h).closest("div.e-childContainer")[0]:e(h).hasClass("e-progressbarhandler")?c.closest(".e-childContainer")[0]:e(h).closest("div.e-childContainer,div.e-parentContainer,.e-gantt-milestone,div.e-gantt-milestone-container")[0],d._currentEditTaskBar=h,null!=p&&(d._trigger("cancelEditCell"),e(d._currentEditTaskBar).css("z-index",1),s.editingFields={startdate:p.startDate,enddate:p.endDate,progress:p.status,duration:p.duration,durationunit:p.durationUnit},s.rowData=p,s.roundOffDuration=!1,s.dragging=d._allowDragging,s.leftResizing=d._leftResizing,s.rightResizing=d._rightResizing,s.progressResizing=d._progressResizing,"resourceView"==this.model.viewType&&(r=t.isNullOrUndefined(a.pageY)?a.originalEvent.changedTouches[0].pageY-e("#ganttViewTablebody"+d._id).offset().top:a.pageY-e("#ganttViewTablebody"+d._id).offset().top,s.isVerticalDragging=Math.abs(d._posY1-r)>=d.model.rowHeight),d._taskbarEditing(s),d._roundOffDuration=s.roundOffDuration,!s.cancel)){if(a||(a=window.event),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&(a.originalEvent.pageX=a.originalEvent.clientX,a.originalEvent.pageY=a.originalEvent.clientY),a.originalEvent.pageX||a.originalEvent.pageY?(d._resMousePosX=d._mousePosX=a.originalEvent.pageX,d._resMousePosY=a.originalEvent.pageY,d._posX=a.originalEvent.pageX,d._posY=a.originalEvent.pageY,d._mousePosY=a.originalEvent.pageY-d._$bodyContainer.offset().top):a.originalEvent.clientX||a.originalEvent.clientY?(d._resMousePosX=d._mousePosX=a.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,d._resMousePosY=a.originalEvent.clientY,d._posX=a.originalEvent.clientX,d._posY=a.originalEvent.clientY,d._mousePosY=a.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop-d._$bodyContainer.offset().top):(a.originalEvent.touches[0].pageX||a.originalEvent.touches[0].pageY)&&(d._resMousePosX=d._mousePosX=a.originalEvent.targetTouches[0].pageX,d._posX=a.originalEvent.targetTouches[0].pageX,d._posY=a.originalEvent.targetTouches[0].pageY,d._resMousePosY=a.originalEvent.targetTouches[0].pageY,d._mousePosY=a.originalEvent.targetTouches[0].pageY-d._$bodyContainer.offset().top),c.hasClass("e-gantt-milestone")||e(h).hasClass("e-gantt-milestone"))e(u).hasClass("e-editmode")&&this._editMilestone(a);else if(e(h).hasClass("e-childContainer")?(d._editingContainer=h,d._leftResizer=d._editingContainer.querySelector(".e-taskbarresizer-left"),d._taskbarItem=d._editingContainer.querySelector(".e-gantt-childtaskbar"),d._progressbarItem=d._editingContainer.querySelector(".e-gantt-childtaskbar-progress"),d._progressResizer=d._editingContainer.querySelector(".e-progressbarresizer-right"),d._rightResizer=d._editingContainer.querySelector(".e-taskbarresizer-right"),d.model.predecessorMapping&&d.model.enablePredecessorEditing&&(d._leftConnectorPoint=h.querySelector(".e-connectorpoint-left"),d._rightConnectorPoint=h.querySelector(".e-connectorpoint-right"),d.model.allowGanttChartEditing&&(e(d._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(d._rightConnectorPoint).addClass("e-connectorpoint-hover")))):e(h).hasClass("e-parentContainer")&&!p.isAutoSchedule&&(d._editingContainer=h,d._taskbarItem=d._editingContainer.querySelector(".e-gantt-manualparenttaskbar"),d._rightResizer=d._editingContainer.querySelector(".e-taskbarresizer-right"),d._manualRightResizer=d._editingContainer.querySelector(".e-gantt-manualparenttaskbar-right")),e(u).hasClass("e-editmode")&&(e(c[0]).closest("e-gantt-manualparenttaskbar")||e(h).hasClass("e-gantt-milestone-container")||e(h).hasClass("e-childContainer")))if(1==d._leftResizing)d._enableLeftResizing(a,p),d._updateEditedItem(p,"leftResizing");else if(1==d._progressResizing&&d.model.enableProgressBarResizing&&d.model.progressMapping)(d._editingTarget.hasClass("e-progresshandlerafter-element")||d._editingTarget.hasClass("e-progressbarhandler e-progresshandle")||d._editingTarget.hasClass("e-progresshandler-element")||d._editingTarget.hasClass("e-progressbarresizer-right"))&&d._editingTarget.prev(".e-gantt-childtaskbar").find(".e-tasklabel").text(""),d._enableProgressResizing(a,p),d._updateEditedItem(p,"progressResizing");else if(1==d._rightResizing)d._enableRightResizing(a,p),d._updateEditedItem(p,"rightResizing");else if(1==d._allowDragging)d._enableDragging(a,p),d._updateEditedItem(p,"dragging");else if(1==d._editPredecessor){d._drawFalseLine(a,p);var g,m,_=d._getOffsetRect(e("#"+d._id)[0]),f=Math.round(d.element.height()),w=Math.round(d.element.width()),C=_.top,T=_.left,x=d._$headerContainer.height()+C,v=d._posY,b=d._posX,S=(d._id.replace("ejGanttChart",""),d.element.find(".e-ganttviewerbodyContianer")),D=S.ejScroller("instance")._vScrollbar,R=S.ejScroller("isVScroll")?S.find(".e-content").get(0).scrollHeight-1:0,y=S.ejScroller("isHScroll")?f+C-d.model.rowHeight/2-18:f+C-d.model.rowHeight/2,I=x+d.model.rowHeight/2,k=S.ejScroller("isHScroll")?S.find(".e-content").get(0).scrollWidth:0,M=S.ejScroller("isVScroll")?w+T-38:w+T-20,E=T+20;v>y||v<I&&0!=d._scrollTop?d._timerDragVertical||(d.model.enableVirtualization&&d._connectorDrawElement&&(d._dummyElementRemoved=!0,n=d._connectorDrawElement.clone(),d._connectorDrawElement.before(n),d._connectorDrawElement.hide(),e(d._$bodyContainer).append(d._connectorDrawElement)),d._timerDragVertical=window.setInterval(function(){v>y&&R>d._scrollTop?(g=(g=d._scrollTop+20)>R?R:g,D.model.maximum>d._scrollTop&&S.ejScroller("scrollY",g,!0),d._drawFalseLine(a)):v<I&&d._scrollTop>0&&(g=(g=d._scrollTop-20)<0?0:g,S.ejScroller("scrollY",g,!0),d._drawFalseLine(a))},100)):d._timerDragVertical&&(d._timerDragVertical=window.clearInterval(d._timerDragVertical)),b>M||b<E&&0!=d._scrollLeft?d._timerDragHorizontal||(d._timerDragHorizontal=window.setInterval(function(){d._timerDragVertical||(b>M&&k>d._scrollLeft?d._timerDragHorizontal!=i&&(m=(m=d._scrollLeft+20)>k?k:m,S.ejScroller("scrollX",m,!0),d._drawFalseLine(a)):b<E&&d._scrollLeft>0&&d._timerDragHorizontal!=i&&(m=(m=d._scrollLeft-20)<0?0:m,S.ejScroller("scrollX",m,!0),d._drawFalseLine(a)))},100)):d._timerDragHorizontal&&(d._timerDragHorizontal=window.clearInterval(d._timerDragHorizontal))}d._clearTooltip(),d._appendTooltip(c,p)}t.isNullOrUndefined(a.pageX)&&"touchmove"==a.type&&d._predecessorTooltip&&(t.isNullOrUndefined(a.pageX)?(o=a.originalEvent.changedTouches[0].pageX,l=a.originalEvent.changedTouches[0].pageY,a.target=this._getElementByPosition(o,l)):(o=a.pageX,l=a.pageY),e(a.target).hasClass("e-connectorpoint-left")||e(a.target).hasClass("e-connectortouchpoint")?d._dragLeftOver(a):e(a.target).hasClass("e-connectorpoint-right")?d._dragRightOver(a):(d._mouseLeave(),e(d._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(d._rightConnectorPoint).addClass("e-connectorpoint-hover")))},_editMilestone:function(i){var a,r=this,n=r._editingTarget,o=n.hasClass("e-milestone-top")||n.hasClass("e-milestone-bottom")?n[0].parentNode:n.closest(".e-gantt-milestone"),l=(r.getGanttChartRows(),n.closest("tr.e-ganttrowcell"),r._editingItem);null!=l&&(i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?r._mousePosX=i.originalEvent.pageX:i.originalEvent.clientX||i.originalEvent.clientY?r._mousePosX=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft:(i.originalEvent.touches[0].pageX||i.originalEvent.touches[0].pageY)&&(r._mousePosX=i.originalEvent.targetTouches[0].pageX),i.target.style.cursor="move",r.dragPosX>r._mousePosX?(r._mousePosX=r.dragPosX-r._mousePosX,l.left>0&&(l.left-=r._mousePosX)):(r._mousePosX-=r.dragPosX,l.left+=r._mousePosX),this.dragPosX=t.isNullOrUndefined(i.originalEvent.pageX)?i.originalEvent.targetTouches[0].pageX:i.originalEvent.pageX,l.left=l.left<0?0:l.left,a=Math.floor(this.model.taskbarHeight/2),e(o).css({left:l.left-a+"px"}),e(r._leftConnectorPoint).css({left:l.left-r._connectorPointWidth-a+"px"}),e(r._rightConnectorPoint).css({left:l.left+r._milesStoneWidth-a+"px"}),r._updateEditedItem(l,"dragging"),r._appendTooltip(n,l))},_updateEditedItem:function(e,i){var a,r,n,o,l=this,d=l.model,s=e._getFormatedDate(d.projectStartDate,d.dateFormat,d.locale),c=(s=e._getDateFromFormat(s,d.dateFormat,d.locale),this.model.ganttInstance);switch(i){case"dragging":n=c._getRoundOffStartLeft(e,l._roundOffDuration),s=this.model.ganttInstance._getDateByLeft(n),!t.isNullOrUndefined(e.endDate)&&t.isNullOrUndefined(e.startDate)?(r=c._checkStartDate(s,e,null),e.endDate=c._checkEndDate(r,e)):(e.startDate=c._checkStartDate(s,e,null),t.isNullOrUndefined(e.duration)||e._calculateEndDate(c)),d.startDateMapping&&(e.item[d.startDateMapping]=e.startDate),d.endDateMapping&&(e.item[d.endDateMapping]=e.endDate);break;case"leftResizing":"Resizing",n=c._getRoundOffStartLeft(e,l._roundOffDuration),s=c._getDateByLeft(n),t.isNullOrUndefined(e.endDate)&&(r=c._getValidEndDate(e),e.endDate=r,d.endDateMapping&&(e.item[d.endDateMapping]=e.endDateMapping)),a=c._checkStartDate(s,e,null),e.startDate=new Date(a),0==c._compareDates(e.startDate,e.endDate)&&t.isNullOrUndefined(e.isMilestone)&&0==e.isMilestone&&0==e.duration&&(e.duration=1),e._calculateDuration(c),d.startDateMapping&&(e.item[d.startDateMapping]=e.startDate);break;case"rightResizing":"Resizing",n=this.model.ganttInstance._getRoundOffEndLeft(e,l._roundOffDuration),o=this.model.ganttInstance._getDateByLeft(n),t.isNullOrUndefined(e.startDate)&&(a=c._getValidStartDate(e),e.startDate=a,d.startDateMapping&&(e.item[d.startDateMapping]=e.startDateMapping)),r=this.model.ganttInstance._checkEndDate(o,e),e.endDate=new Date(r),e._calculateDuration(c),d.endDateMapping&&(e.item[d.endDateMapping]=e.endDate);break;case"progressResizing":e.status=l._getProgressPercent(e.width,e.progressWidth),d.progressMapping&&(e.item[d.progressMapping]=e.status)}},_drawFalseLine:function(e){var i,a,r=this,n=e.pageX,o=e.pageY,l=r._posX,d=r._posY,s=r._connectorPointX,c=r._connectorPointY;t.isNullOrUndefined(e.pageX)?(i=e.originalEvent.changedTouches[0].pageX-r._$bodyContent.offset().left,a=e.originalEvent.changedTouches[0].pageY-r._$bodyContent.offset().top,n=Math.round(e.originalEvent.changedTouches[0].pageX),o=Math.round(e.originalEvent.changedTouches[0].pageY)):(i=e.pageX-r._$bodyContent.offset().left,a=e.pageY-r._$bodyContent.offset().top),t.isNullOrUndefined(r._timerDragHorizontal||r._timerDragVertical)||(i=l-r._$bodyContent.offset().left,a=d-r._$bodyContent.offset().top);var u=Math.sqrt((s-i)*(s-i)+(c-a)*(c-a)),p="rotate("+180*Math.atan2(a-c,i-s)/Math.PI+"deg)";r._falseLine&&r._falseLine.remove(),r._falseLine=t.buildTag("div.e-gantt-falseLine#ganttfalseline"+r._id,"",{},{}),r._falseLine.css({"transform-origin":"0% 100%",right:"auto",position:"absolute",transform:p,"-ms-transform":p,"-moz-transform":p,"-webkit-transform":p,"-o-transform":p,"border-top-width":"2px","border-top-style":"dashed","z-index":"5"}).width(u-3).offset({left:s,top:c}),"msie"==t.browserInfo().name&&t.browserInfo().version<9||r._$bodyContent.append(r._falseLine),t.isNullOrUndefined(r._timerDragHorizontal||r._timerDragVertical)?r._updateTooltipPosition(r._predecessorTooltip,n,o):r._updateTooltipPosition(r._predecessorTooltip,l,d)},_mouseLeave:function(){var i=this;e(".e-progressbarresizer-right").css({"background-image":"none"}),window.clearTimeout(i._tooltipTimer),i._clearTooltip(),0==this._mouseDown&&i._newXYPos?(e(i._leftResizerGripper).removeClass("e-gripper"),e(i._rightResizerGripper).removeClass("e-gripper"),i.model.progressMapping&&(e(i._progressHandle).removeClass("e-progresshandle"),e(i._progressHandleChild).removeClass("e-progresshandleafter")),i.model.predecessorMapping&&i.model.enablePredecessorEditing&&(e(i._leftConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),e(i._rightConnectorPoint).removeClass("e-connectorpoint-hover").removeClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),i._leftConnectorPoint=null,i._rightConnectorPoint=null)):i._mouseDown&&i._falseLine&&1==i.model.allowGanttChartEditing&&i.model.enablePredecessorEditing&&0==i.model.readOnly&&i._removeEditingElements(),0==i._mouseDown&&"4"==e(i._$dependencyViewContainer).css("z-index")&&e(i._$dependencyViewContainer).css("z-index","5"),t.isNullOrUndefined(i._hoverConnectorLineElement)||i._isPredecessorEditOpen||i._clearConnectorLineSelection()},_getMaxZIndex:function(){var e,t,i,a=document.getElementsByTagName("div"),r=0,n=a.length;if(0==this._maxZIndex){for(e=0;e<n;e++)t=a[e].style.zIndex,(i=parseInt(t))>r&&"auto"!=t&&!isNaN(i)&&(r=i);this._maxZIndex=r}return this._maxZIndex},_getOffsetRect:function(e){var t=e.getBoundingClientRect(),i=document.body,a=document.documentElement,r=window.pageYOffset||a.scrollTop||i.scrollTop,n=window.pageXOffset||a.scrollLeft||i.scrollLeft,o=a.clientTop||i.clientTop||0,l=a.clientLeft||i.clientLeft||0,d=t.top+r-o,s=t.left+n-l;return{top:Math.round(d),left:Math.round(s)}},_updateTooltipPosition:function(t,i,a,r){var n;if(t&&t.length>0){var o=this,l=o._getOffsetRect(o._$bodyContainer[0]),d=l.top+o._$bodyContainer.height(),s=l.left+o._$bodyContainer.width(),c=o.model.rowHeight,u=0;i+t.width()+30>s?(u=i-t.width()-30,t.css("left",u+"px")):r?t.css("left",i+"px"):t.css("left",i+15+"px"),r||a+t.height()+30>d?((u=r?a-t.height()-c:a-t.height()-30)<(n=e(window).scrollTop())&&(u=n),t.css("top",u+"px")):t.css("top",a+10+"px")}},getRecordByTarget:function(t,i){var a,r=e(t.target),n=this.getGanttChartRows(),o=r.closest("tr.e-ganttrowcell"),l=n.index(o),d=this.model.currentViewData[l];return"histogramView"==this.model.viewType&&0!=o.length&&0!=d.workTimelineRanges.length?(a=o.find(".e-gantthistobar").index(r.closest(".e-gantthistobar")),d=d.workTimelineRanges[a]):d&&"resourceTask"==d.eResourceTaskType&&"resourceView"==this.model.viewType&&1==r.closest(".e-childContainer").length&&(a=o.find(".e-childContainer").index(r.closest(".e-childContainer")),d=d.eResourceChildTasks[a],i&&(this.element.find(".e-gantt-taskbarSelection").removeClass("e-gantt-taskbarSelection"),r.closest(".e-childContainer").addClass("e-gantt-taskbarSelection"))),d},_getPredecessorTooltipData:function(t){var i,a,r,n=this.model,o=e(t).parent()[0].id.match(/\d+/g),l=n.flatRecords[n.ids.indexOf(o[0])],d=n.flatRecords[n.ids.indexOf(o[1])],s=l.predecessor;return a=s.filter(function(e){return e.to==o[1]}),i=n.predecessorCollectionText.filter(function(e){return e.id==a[0].predecessorsType}),r={linkType:a[0].predecessorsType,linkText:i[0].text,offset:a[0].offset,offsetUnit:a[0].offsetDurationUnit,fromId:a[0].from,toId:a[0].to,fromName:l.taskName,toName:d.taskName},n.enableSerialNumber&&(r.fromSno=l.serialNumber,r.toSno=d.serialNumber),r},_mouseHover:function(i){var a,r,n,o,l,d,s,c=e(i.target),u=this,p=u.model,h=0,g=0,m=c[0].parentNode,_=this.getRecordByTarget(i);if("e-parentContainer"==i.target.className||"e-gantt-milestone-container"==i.target.className||"e-childContainer"==i.target.className)return!0;m=e(m).hasClass("e-gantt-childtaskbar-progress")?e(m).closest("div.e-childContainer")[0]:c.hasClass("e-tasklabel")?c.closest(".e-childContainer")[0]:"e-connectorlineContainer"==m.className?m:e(m).closest("div.e-childContainer,div.e-parentContainer,.e-gantt-milestone,div.e-gantt-milestone-container")[0],e(m).is(".e-childContainer,.e-parentContainer,.e-gantt-milestone,.e-gantt-milestone-container")&&e(u._$dependencyViewContainer).css("z-index","4"),u._clearTooltip(),u._newXYPos||(u._newXYPos=!0,u._mouseLeave()),0==u._rightResizing&&0==u._leftResizing&&0==u._progressResizing&&0==u._mouseDown&&(u.model.allowGanttChartEditing&&0==u.model.readOnly&&(c.is(".e-gantt-childtaskbar,.e-tasklabel, .e-gantt-manualparenttaskbar")||c.closest(".e-gantt-childtaskbar").length)&&(i.target.style.cursor="move"),("mouseenter"==i.type||"mousemove"==i.type||"touchstart"==i.type)&&(i||(i=window.event),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&(i.originalEvent.pageX=i.originalEvent.clientX,i.originalEvent.pageY=i.originalEvent.clientY),i.originalEvent.pageX||i.originalEvent.pageY?(h=i.originalEvent.pageX,g=i.originalEvent.pageY):i.originalEvent.clientX||i.originalEvent.clientY?(h=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,g=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop):i.originalEvent&&i.originalEvent.changedTouches&&i.originalEvent.changedTouches.length>0&&(h=i.originalEvent.changedTouches[0].pageX,g=i.originalEvent.changedTouches[0].pageY),u._posX1=h,u._posY1=g,e(m).hasClass("e-childContainer")&&u.model.allowGanttChartEditing&&0==u.model.readOnly&&(u._leftResizerGripper=m.querySelector(".e-taskbarresizer-left"),u._rightResizerGripper=m.querySelector(".e-taskbarresizer-right"),a=m.querySelector(".e-progressbarresizer-right"),u._progressHandle=a&&a.firstChild,u._progressHandleChild=a&&a.childNodes[1],e(u._leftResizerGripper).addClass("e-gripper"),e(u._rightResizerGripper).addClass("e-gripper"),u.model.progressMapping&&u.model.enableProgressBarResizing&&(e(u._progressHandle).addClass("e-progresshandle"),e(u._progressHandleChild).addClass("e-progresshandleafter"))),(e(m).hasClass("e-childContainer")||e(m).hasClass("e-parentContainer"))&&u.model.predecessorMapping&&u.model.allowGanttChartEditing&&u.model.enablePredecessorEditing&&0==u.model.readOnly?(u._leftConnectorPoint=m.querySelector(".e-connectorpoint-left"),u._rightConnectorPoint=m.querySelector(".e-connectorpoint-right"),e(u._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(u._rightConnectorPoint).addClass("e-connectorpoint-hover"),e(m).hasClass("e-parentContainer")&&!_.isAutoSchedule&&(e(u._leftConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"),e(u._rightConnectorPoint).addClass("e-gantt-manualparenttaskbar-connectorpoint-hover"))):(e(m).hasClass("e-gantt-milestone")||e(m).hasClass("e-gantt-milestone-container"))&&u.model.predecessorMapping&&u.model.allowGanttChartEditing&&u.model.enablePredecessorEditing&&0==u.model.readOnly&&(l=m.parentNode,u._leftConnectorPoint=l.querySelector(".e-connectorpoint-left"),u._rightConnectorPoint=l.querySelector(".e-connectorpoint-right"),e(u._leftConnectorPoint).addClass("e-connectorpoint-hover"),e(u._rightConnectorPoint).addClass("e-connectorpoint-hover")),_&&u.model.enableTaskbarTooltip&&!t.isTouchDevice()&&!e(c).hasClass("e-connectorpoint-hover")?(u._predecessorTooltip&&u._predecessorTooltip.remove(),u._predecessorTooltip=null,r=!e(c).hasClass("e-gantt-parenttaskbar-innerdiv")&&!e(c[0].parentNode).hasClass("e-gantt-parenttaskbar-innerdiv")||_.isAutoSchedule?e(c).hasClass("e-gantt-manualparenttaskbar")||e(c).hasClass("e-gantt-manualparenttaskbar-left")||e(c).hasClass("e-gantt-manualparenttaskbar-right")&&!_.isAutoSchedule?{ttipstartDate:this._getFormatedDate(_.startDate,this.model.dateFormat,this.model.locale),ttipsubtaskStartDate:this._getFormatedDate(_.manualStartDate,this.model.dateFormat,this.model.locale),ttipendDate:this._getFormatedDate(_.endDate,this.model.dateFormat,this.model.locale),ttipsubtaskEndDate:this._getFormatedDate(_.manualEndDate,this.model.dateFormat,this.model.locale),ttipduration:_.duration,ttiptaskname:_.taskName,ttipdurationunit:_.durationUnit}:{ttipstartDate:this._getFormatedDate(_.startDate,this.model.dateFormat,this.model.locale),ttipendDate:this._getFormatedDate(_.endDate,this.model.dateFormat,this.model.locale),ttipduration:_.duration,ttipprogress:_.status.toString(),ttiptaskname:_.taskName,ttipdurationunit:_.durationUnit}:{ttipscheduleStartDate:this._getFormatedDate(_.manualStartDate,this.model.dateFormat,this.model.locale),ttipscheduleEndDate:this._getFormatedDate(_.manualEndDate,this.model.dateFormat,this.model.locale),ttipduration:_.manualDuration,ttipprogress:_.status.toString(),ttiptaskname:_.taskName,ttipdurationunit:_.durationUnit}):!p.allowGanttChartEditing||t.isNullOrUndefined(m)||"e-connectorlineContainer"!=m.className||u._isPredecessorEditOpen||(e(d=m).find(".e-line").addClass("e-connectorline-hover"),e(d).find(".e-connectorline-rightarrow").length>0?e(d).find(".e-connectorline-rightarrow").addClass("e-connectorline-rightarrow-hover"):e(d).find(".e-connectorline-leftarrow").addClass("e-connectorline-leftarrow-hover"),u._hoverConnectorLineElement=d,o=u._getPredecessorTooltipData(d)),r&&(n=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"5"}),u.model.tooltipTemplate||u.model.tooltipTemplateId?u.model.tooltipTemplate?(u._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+u._id,"",{position:"absolute","z-index":u._getMaxZIndex()+1,"border-radius":"5px"},{}),u.model.cssClass&&u._mouseHoverTooltip.addClass(u.model.cssClass),u.tooltipState="Template",s=t.buildTag("tbody",e.render[u._id+"tooltipTemplate"](_),{},{}),u._mouseHoverTooltip[0].innerHTML="<table>"+s[0].innerHTML+"</table>",u._tooltipTimer=setTimeout(function(){e(document.body).append(u._mouseHoverTooltip),u._updateTooltipPosition(u._mouseHoverTooltip,h,g)},700)):u.model.tooltipTemplateId&&(u._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+u._id,"",{position:"absolute","z-index":u._getMaxZIndex()+1,"border-radius":"5px"},{}),u.model.cssClass&&u._mouseHoverTooltip.addClass(u.model.cssClass),u.tooltipState="TemplateID",s=t.buildTag("tbody",e.render[u._id+"tooltipTemplate"](_),{},{}),u._mouseHoverTooltip[0].innerHTML="<table>"+s[0].innerHTML+"</table>",u._tooltipTimer=setTimeout(function(){e(document.body).append(u._mouseHoverTooltip),u._updateTooltipPosition(u._mouseHoverTooltip,h,g)},700)):(u.tooltipState="",s=t.buildTag("tbody",e.render[u._id+"tooltipTemplate"](r),{},{}),n.append(s),u._mouseHoverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+u._id,n,{position:"absolute","z-index":u._getMaxZIndex()+1,"border-radius":"5px"},{}),u.model.cssClass&&u._mouseHoverTooltip.addClass(u.model.cssClass),u._mouseHoverTooltip.innerHTML="<table>"+n[0].innerHTML+"</table>",u._tooltipTimer=setTimeout(function(){e(document.body).append(u._mouseHoverTooltip),u._updateTooltipPosition(u._mouseHoverTooltip,h,g)},700)),e(u._mouseHoverTooltip).addClass("e-customTooltip")),u.model.enableTaskbarTooltip&&o&&(n=t.buildTag("table.e-tooltiptable","",{"margin-top":"0px"},{cellspacing:"5"}),u.model.predecessorTooltipTemplate?(u._connectorLineTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+u._id,"",{position:"absolute","z-index":u._getMaxZIndex()+1,"border-radius":"5px"},{}),u.model.cssClass&&u._connectorLineTooltip.addClass(u.model.cssClass),s=t.buildTag("tbody",e.render[u._id+"predecessorTooltipTemplate"](o),{},{}),u._connectorLineTooltip[0].innerHTML="<table>"+s[0].innerHTML+"</table>",u._tooltipTimer=setTimeout(function(){e(document.body).append(u._connectorLineTooltip),u._updateTooltipPosition(u._connectorLineTooltip,h,g)},700)):(s=t.buildTag("tbody",e.render[u._id+"predecessorTooltipTemplate"](o),{},{}),n.append(s),u._connectorLineTooltip=t.buildTag("div.e-tooltipgantt e-js#"+u._id+"_predecessortooltip",n,{position:"absolute","z-index":u._getMaxZIndex()+1,"border-radius":"5px"},{}),u.model.cssClass&&u._connectorLineTooltip.addClass(u.model.cssClass),u._connectorLineTooltip.innerHTML="<table>"+n[0].innerHTML+"</table>",u._tooltipTimer=setTimeout(function(){e(document.body).append(u._connectorLineTooltip),u._updateTooltipPosition(u._connectorLineTooltip,h,g)},700)),e(u._connectorLineTooltip).addClass("e-customTooltip"))))},_createEditingTooltipTemplate:function(){var t,i,a=this,r=a.model.columnHeaderTexts,n=(a.model.durationUnitTexts,a.model.taskbarEditingTooltipTemplateId),o=a.model.taskbarEditingTooltipTemplate,l={};l["_"+a._id+"getStartDate"]=a._tooltipStartDate,l["_"+a._id+"getEndDate"]=a._tooltipEndDate,l["_"+a._id+"getTaskName"]=a._tooltipTaskName,l["_"+a._id+"getProgress"]=a._tooltipProgress,l["_"+a._id+"checkDuration"]=a._checkDuration,l["_"+a._id+"getDuration"]=e.proxy(a._tooltipDuration,a),e.views.helpers(l),t=n?e("#"+n)[0].innerHTML:o||"{{if ~_"+a._id+"getTaskName()}}<tr><td class='e-tooltiptaskname' style='width:40px;text-align:left;' colspan='3';>{{:ttiptaskname}}</td></tr>{{/if}}{{if ~_"+a._id+"getStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.startDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipstartDate}}</td></tr>{{/if}}{{if ~_"+a._id+"getEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.endDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipendDate}}</td></tr>{{/if}}{{if ~_"+a._id+"checkDuration()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.duration+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+a._id+"getDuration(#data)}}</td></tr>{{/if}}{{if ~_"+a._id+"getProgress()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.status+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipprogress}}%</td></tr>{{/if}}",(i={})[a._id+"editingTooltipTemplate"]=t,e.templates(i)},_createProgressbarTooltipTemplate:function(){var t,i,a=this,r=a.model.progressbarTooltipTemplateId;a.model.progressbarTooltipTemplate;r?t=e("#"+a.model.progressbarTooltipTemplateId)[0].innerHTML:a.model.progressbarTooltipTemplate&&(t=a.model.progressbarTooltipTemplate),(i={})[a._id+"progressbarTooltipTemplate"]=t,e.templates(i)},_createTooltipTemplate:function(){var t,i,a=this,r=a.model.columnHeaderTexts,n=(a.model.durationUnitTexts,{}),o=a.model.tooltipTemplateId;a.model.tooltipTemplate;n["_"+a._id+"getStartDate"]=a._tooltipStartDate,n["_"+a._id+"getSubtaskStartDate"]=a._tooltipSubtaskStartDate,n["_"+a._id+"getScheduleStartDate"]=a._tooltipScheduleStartDate,n["_"+a._id+"getEndDate"]=a._tooltipEndDate,n["_"+a._id+"getSubtaskEndDate"]=a._tooltipSubtaskEndDate,n["_"+a._id+"getScheduleEndDate"]=a._tooltipScheduleEndDate,n["_"+a._id+"getTaskName"]=a._tooltipTaskName,n["_"+a._id+"getProgress"]=a._tooltipProgress,n["_"+a._id+"checkDuration"]=a._checkDuration,n["_"+a._id+"getDuration"]=e.proxy(a._tooltipDuration,a),e.views.helpers(n),o?t=e("#"+a.model.tooltipTemplateId)[0].innerHTML:a.model.tooltipTemplate?t=a.model.tooltipTemplate:(t="<tr class='e-tooltip_rowcell'>",t+="{{if ~_"+a._id+"getTaskName()}}<td class='e-tooltiptaskname' style='width:40px;text-align:left;' colspan='3';>{{:ttiptaskname}}</td>{{/if}}</tr>{{if ~_"+a._id+"getStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.startDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipstartDate}}</td> {{/if}}</tr>{{if ~_"+a._id+"getSubtaskStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.subTasksStartDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipsubtaskStartDate}}</td></tr>{{/if}}{{if ~_"+a._id+"getScheduleStartDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.scheduleStartDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipscheduleStartDate}}</td></tr>{{/if}}{{if ~_"+a._id+"getEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.endDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipendDate}}</td>{{/if}}</tr>{{if ~_"+a._id+"getSubtaskEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.subTasksEndDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipsubtaskEndDate}}</td></tr>{{/if}}{{if ~_"+a._id+"getScheduleEndDate()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.scheduleEndDate+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipscheduleEndDate}}</td></tr>{{/if}}{{if ~_"+a._id+"checkDuration()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.duration+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+a._id+"getDuration(#data)}}</td>{{/if}}</tr>{{if ~_"+a._id+"getProgress()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+r.status+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:ttipprogress}}%</td>{{/if}}",t+="</tr>"),(i={})[a._id+"tooltipTemplate"]=t,e.templates(i)},_createPredecessorTooltipTemplate:function(){var t,i=this,a=i.model,r={},n=a.connectorLineDialogText,o=a.predecessorTooltipTemplate;r["_"+i._id+"getFromTask"]=i._tooltipFromTask,r["_"+i._id+"getToTask"]=i._tooltipToTask,r["_"+i._id+"getOffsetValue"]=e.proxy(i._getOffsetValue,i),e.views.helpers(r),o?"#"==o.charAt(0)&&(o=e(o)[0].innerHTML):o+="{{if ~_"+i._id+"getFromTask()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+n.from+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+i._id+"getFromTask()}}</td></tr>{{/if}}{{if ~_"+i._id+"getToTask()}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+n.to+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+i._id+"getToTask()}}</td></tr>{{/if}}<tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+n.taskLink+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:linkText}}</td></tr><tr><td class='e-tooltiptd-alignleft' style='width:30px;white-space:nowrap;'>"+n.lag+"</td><td class='e-tooltiptd-aligncenter' style='width:10px;font-weight:bold;'>:</td><td class='e-tooltiptd-alignright' style='width:30px;white-space:nowrap;'>{{:~_"+i._id+"getOffsetValue(#data)}}</td></tr>",(t={})[i._id+"predecessorTooltipTemplate"]=o,e.templates(t)},_checkDuration:function(){return this.data.ttipduration},_tooltipTaskName:function(){return this.data.ttiptaskname},_tooltipProgress:function(){return this.data.ttipprogress},_tooltipStartDate:function(){return this.data.ttipstartDate},_tooltipSubtaskStartDate:function(){return this.data.ttipsubtaskStartDate},_tooltipScheduleStartDate:function(){return this.data.ttipscheduleStartDate},_tooltipEndDate:function(){return this.data.ttipendDate},_tooltipSubtaskEndDate:function(){return this.data.ttipsubtaskEndDate},_tooltipScheduleEndDate:function(){return this.data.ttipscheduleEndDate},_tooltipFromTask:function(){var e=this.data,i=t.isNullOrUndefined(e.fromSno)?e.fromId:e.fromSno;return e.fromName+" ("+i+")"},_tooltipToTask:function(){var e=this.data,i=t.isNullOrUndefined(e.toSno)?e.toId:e.toSno;return e.toName+" ("+i+")"},_getOffsetValue:function(e){var t={};return t.ttipduration=e.offset,t.ttipdurationunit=e.offsetUnit,this._tooltipDuration(t)},_removeSeparator:function(e){var i=e.toString(),a=t.preferredCulture(this.model.locale).numberFormat;return i.replace(".",a["."])},_tooltipDuration:function(e){var t,a="";return null!=e.ttipduration&&e.ttipduration!=i&&(a+=this._removeSeparator(parseFloat(e.ttipduration.toFixed(2)))+" "),null!=e.ttipdurationunit&&e.ttipdurationunit!=i&&(t=1!=e.ttipduration,a+="day"==e.ttipdurationunit?t?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:"hour"==e.ttipdurationunit?t?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:t?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute),a},_getDurationUnits:function(){return this.model.durationUnit==t.Gantt.DurationUnit.Hour?"hours":this.model.durationUnit==t.Gantt.DurationUnit.Minute?"minutes":"days"},_cellClickHandler:function(i){var a,r,n,o,l,d=e(i.target),s=d.closest("tr.e-ganttrowcell"),c=this,u=this.model,p={},h=d[0],g=c.getGanttChartRows();if(r=a=g.index(d.parent()),c._multiSelectCtrlRequest=i.ctrlKey,c._multiSelectShiftRequest=i.shiftKey,-1==a&&(r=a=g.index(s)),u.allowSelection&&c._ganttTouchTrigger&&"row"==u.selectionMode&&"multiple"==u.selectionType&&(p={target:d,ctrlKey:i.ctrlKey},c._trigger("getCtrlRequestValue",p),i.ctrlKey=p.ctrlKey),("resourceView"==u.viewType||"histogramView"==u.viewType)&&(n=this.getRecordByTarget(i)),!(e(h).hasClass("e-parentTask")||e(h).closest(".e-parentTask").length>0)||d.hasClass("e-connectorpoint-left")||d.hasClass("e-connectorpoint-right")||i.ctrlKey||i.shiftKey){if(-1!=a&&u.allowSelection){if(_=u.currentViewData[a],a=u.updatedRecords.indexOf(_),"row"==u.selectionMode){if(c._rowSelectingEventTrigger(u.selectedRowIndex,a))return;u.selectionType==t.Gantt.SelectionType.Multiple&&i.shiftKey&&1==u.allowSelection&&(null!=c._prevSelectedItem&&c._getExpandStatus(c._prevSelectedItem)?c.selectRows(u.updatedRecords.indexOf(c._prevSelectedItem),a):null==c._prevSelectedItem&&c.selectRows(0,a),c._rowSelectedEventTrigger(a,t.isNullOrUndefined(c._prevSelectedItem)?0:u.updatedRecords.indexOf(c._prevSelectedItem))),i.shiftKey||(c.selectRows(a),c._rowSelectedEventTrigger(a)),c.focusGanttElement()}"cell"==u.selectionMode&&(c.model.selectedItem=_),u.viewType==t.Gantt.ViewType.ResourceView&&n&&("unassignedTask"==n.eResourceTaskType||"resourceChildTask"==n.eResourceTaskType)&&this.selectTaskbar(n)}}else{var m=g.index(s),_=u.currentViewData[m],f=u.updatedRecords.indexOf(_);c._allowExpandCollapse&&_&&_.hasChildRecords&&(c._trigger("cancelEditCell"),(u.selectedRowIndex!==f&&u.allowSelection&&-1!==f||!c._multiSelectCtrlRequest&&u.selectedRowIndex==f&&"multiple"==u.selectionType)&&(c._rowSelectingEventTrigger(u.selectedRowIndex,f)||(c.selectRows(f),c._rowSelectedEventTrigger(f))),c._expandCollapse(m),p={requestType:"expandCollapse"},c._trigger("getCtrlRequestValue",p))}u.taskbarClick&&(d.is(".e-childContainer,.e-gantt-milestone-container,.e-parentContainer")||(o=d.closest(".e-childContainer,.e-gantt-milestone-container,.e-parentContainer,.e-gantthistobar")).length&&(p={},l="projectView"==u.viewType?u.currentViewData[r]:n,r="histogramView"==u.viewType?u.updatedRecords.indexOf(u.currentViewData[r]):u.updatedRecords.indexOf(l),p.data=l,p.index=r,p.taskbarElement=o[0],p.target=d[0],this._trigger("taskbarClick",p)))},getRowByIndex:function(i,a){var r,n;try{var o=this,l=o.getGanttChartRows(),d=e(l);e();return o.model.enableVirtualization&&(r=o.model.updatedRecords[i],i=o.model.currentViewData.indexOf(r)),t.isNullOrUndefined(a)?(o.model.enableVirtualization&&(n=o.model.updatedRecords[a],a=o.model.currentViewData.indexOf(n)),e(l[i])):e(d.slice(i,a))}catch(t){return e()}},selectTaskbar:function(t){var i,a,r=this.model,n=-1,o=0;"resourceView"==r.viewType&&("resourceChildTask"==t.eResourceTaskType||"unassignedTask"==t.eResourceTaskType)&&("resourceChildTask"==t.eResourceTaskType&&t.parentItem?(i=t.parentItem,n=r.updatedRecords.indexOf(i),o=i.eResourceChildTasks.indexOf(t)):n=r.updatedRecords.indexOf(t),-1!=n&&(a=this.getRowByIndex(n),this.element.find(".e-gantt-taskbarSelection").removeClass("e-gantt-taskbarSelection"),e(a.find(".e-childContainer")[o]).addClass("e-gantt-taskbarSelection")))},_applySelection:function(e){if(-1!=e){var t=this.model,i=this.getRowByIndex(e),a=t.updatedRecords[e];a.isSelected=!0,t.selectedItems.push(a),i.addClass("e-gantt-mouseclick"),t.selectedItem=t.updatedRecords[e],t.selectedRowIndex=e}},selectRows:function(i,a){var r,n,o,l,d=this,s=this.model;d.getGanttChartRows();if(s.allowSelection&&"cell"!=s.selectionMode){if(s.selectionType!=t.Gantt.SelectionType.Multiple||t.isNullOrUndefined(i)||t.isNullOrUndefined(a))switch(s.selectionType){case t.Gantt.SelectionType.Multiple:if(d._multiSelectCtrlRequest&&-1!=i){d._prevSelectedItem=s.updatedRecords[i],d._shiftSelectedRecord=null,-1!=(l=e.inArray(s.updatedRecords[i],s.selectedItems))&&d.clearSelection(i),-1==l&&d._applySelection(i);break}case t.Gantt.SelectionType.Single:d._prevSelectedItem&&(d._prevSelectedItem.isSelected=!1),d.clearSelection(-1),d._applySelection(i),d._prevSelectedItem=s.selectedItem,d._shiftSelectedRecord=null}else for(d.clearSelection(-1),r=i-a<0?s.updatedRecords.slice(i,a+1):s.updatedRecords.slice(a,i+1),n=0;n<r.length;n++)d._getExpandStatus(r[n])&&(o=s.updatedRecords.indexOf(r[n]),d._applySelection(o));0==s.selectedItems.length&&-1!=s.selectedRowIndex&&(s.selectedRowIndex=-1)}},updateSelectedItem:function(t){var i=this;e(i.getGanttChartRows()).removeClass("e-gantt-mouseclick"),i.model.updatedRecords[t].isSelected=!0,i.model.selectedItem=i.model.updatedRecords[t],this._refresh(),i._rowSelectedEventTrigger(t)},_getRecordTopPosition:function(e,t){var i,a={},r=0,n=this.model;if("resourceView"==this.model.viewType){for(i=0;i<=t;i++)i==t?a.bottom=r+this._getTemplateRowHeight(e[i]):r+=this._getTemplateRowHeight(e[i]);a.top=r}else a.top=t*n.rowHeight,a.bottom=a.top+n.rowHeight;return a},_getHeightforResourceView:function(e){for(var t=0,i=0;i<e.length;i++)t+=this._getTemplateRowHeight(e[i]);return t},getRecordsHeight:function(){var e=this.model;return"resourceView"==e.viewType?e.enableVirtualization?this._getHeightforResourceView(e.updatedRecords):this._getHeightforResourceView(this.getExpandedRecords(e.updatedRecords)):e.enableVirtualization?e.updatedRecords.length*e.rowHeight:e.rowHeight*(e.updatedRecords.length-this.getCollapsedRecordCount())},updateHeight:function(i){var a,r=this,n=r.model;r._setScrollTop(),r._containerHeight=i,e("#ganttviewerbodyContent"+r._id).css({height:r._containerHeight+"px"}),n.stripLines&&e(r.element).find(".e-stripline,.e-stripLines").css({height:i+"px"}),n.holidays&&e(r.element).find(".e-holidays,.e-holiday").css({height:i+"px"}),e(".e-secondary_canvas").css({height:i+"px"}),e(r.element).find(".e-weekends").css({height:i+"px"}),e(r.element).find(".e-ganttworkingtime").css({height:i+"px"}),a=".e-holiday-label","msie"==t.browserInfo().name&&t.browserInfo().version<9&&(a=".e-holiday-label-ie8"),i<r._viewportHeight?i<=n.rowHeight?e(r.element).find(a).css({top:-i-30}):e(r.element).find(a).css({top:i/2}):e(r.element).find(a).css({top:r._viewportHeight/2}),0==i&&r._$bodyContent.css({height:"1px"}),r._$bodyContainer.ejScroller("refresh"),parseInt(r._$bodyContainer.css("height"))!=r._viewportHeight&&(i=r._$bodyContent.width()<r._$bodyContainerParent.width()?r._viewportHeight+18:r._viewportHeight,r._$bodyContainer.css("height",i))},_completeAction:function(e){return e.vscrollExsist=this._$bodyContainer.ejScroller("isVScroll"),this._trigger("actionComplete",e),"validatePredecessor"===e.requestType?e.predecessorValidation:void 0},_taskbarEditing:function(e){this._trigger("taskbarEditing",e)},_taskbarEdited:function(e){this._trigger("taskbarEdited",e)},_queryTaskbarinfo:function(e,t){this._trigger("queryTaskbarInfo",e),this._updateTaskbarItems(e,t)},_refreshRow:function(e){this._trigger("refreshRow",e)},_updateManualTaskbarItem:function(e,i){var a,r=i.querySelector(".e-gantt-parenttaskbar-innerdiv"),n=i.querySelector(".e-gantt-parenttaskbar-progress"),o=i.querySelector(".e-gantt-manualparenttaskbar"),l=i.querySelector(".e-gantt-manualparenttaskbar-left"),d=i.querySelector(".e-gantt-manualparenttaskbar-right"),s=i.querySelector(".e-taskbarresizer-right"),c=r.style,u=n&&n.style,p=o&&o.style,h=l&&l.style,g=d&&d.style,m=s&&s.style,_=this.model;a=(_.renderBaseline?_.taskbarHeight-9:_.taskbarHeight-10)/5,t.isNullOrUndefined(e.manualParentTaskbarBackground)||p.backgroundColor==e.manualParentTaskbarBackground||(p.backgroundColor=e.manualParentTaskbarBackground,h.borderColor=e.manualParentTaskbarBackground,g.borderColor=e.manualParentTaskbarBackground),p.width=e.data.width+"px",p.left=e.data.left+"px",g.left=e.data.width-parseInt(a)+"px",m.left=e.data.width-parseInt(a)+"px",e.data.width==e.data.manualWidth&&e.data.left==e.data.manualLeft?(u.width=e.data.progressWidth-2*a+"px",c.width=e.data.manualWidth-2*a+"px",c.left=e.data.manualLeft+a+"px"):e.data.left==e.data.manualLeft?(c.left=e.data.manualLeft+a+"px",u.width=e.data.progressWidth-a+"px",c.width=e.data.manualWidth-a+"px"):(u.width=e.data.progressWidth+"px",c.width=e.data.manualWidth+"px",c.left=e.data.manualLeft+"px")},_updateTaskbarItems:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_;if(a){if(e(a).hasClass("e-gantt-milestone-container")&&(r=e(a).closest("div")[0]),e(a).next().hasClass("e-baseline-gantt-milestone-container")&&(o=e(a).next().find(".e-baseline-gantt-milestone").closest("div")[0]),e(a).next().hasClass("e-baselinebar")&&(n=e(a).next().closest("div")[0]),e(a).hasClass("e-parentContainer")){var f=(x=e(a).closest("div")[0]).querySelector(".e-gantt-parenttaskbar-innerdiv"),w=x.querySelector(".e-gantt-parenttaskbar-progress"),C=f.style,T=w&&w.style;C.backgroundColor!=i.parentTaskbarBackground&&(C.backgroundColor=i.parentTaskbarBackground),T&&T.backgroundColor!=i.parentProgressbarBackground&&(T.backgroundColor=i.parentProgressbarBackground),C.borderColor!=i.parentTaskbarBorder&&(C.borderColor=i.parentTaskbarBorder),T&&T.borderColor!=i.parentProgressbarBorder&&(T.borderColor=i.parentProgressbarBorder),!i.data.isAutoSchedule&&i.data.hasChildRecords&&this._updateManualTaskbarItem(i,x),T&&T.borderColor!=i.parentProgressbarBorder&&(T.borderColor=i.parentProgressbarBorder)}else if(e(a).hasClass("e-childContainer")){var x,v=(x=e(a).closest("div")[0]).querySelector(".e-gantt-childtaskbar"),b=x.querySelector(".e-gantt-childtaskbar-progress"),S=v.style,D=b&&b.style,R=b&&b.querySelector(".e-tasklabel"),y=R&&R.style;S.backgroundColor==i.taskbarBackground||t.isNullOrUndefined(i.data.duration)||(S.backgroundColor=i.taskbarBackground),b&&D.backgroundColor!=i.progressbarBackground&&(D.backgroundColor=i.progressbarBackground),S.borderColor!=i.taskbarBorder&&(S.borderColor=i.taskbarBorder),b&&D.borderColor!=i.progressbarBorder&&(D.borderColor=i.progressbarBorder),y&&y.color!=i.taskbarTextColor&&(y.color=i.taskbarTextColor)}e(r).length>0&&(l=r.querySelector(".e-gantt-milestone.e-milestone-top"),d=r.querySelector(".e-gantt-milestone.e-milestone-bottom"),l&&d?(s=l.style,(c=d.style).borderBottomColor!=i.milestoneBackground&&s.borderTopColor!=i.milestoneBackground&&(c.borderTopColor=i.milestoneBackground,s.borderBottomColor=i.milestoneBackground)):this.model.milestoneTemplate&&((u=r.querySelector(".e-gantt-milestone")).style.backgroundColor!=i.milestoneBackground&&(u.style.backgroundColor=i.milestoneBackground))),e(n).hasClass("e-baselinebar")&&((p=n.style).backgroundColor!=i.baselineBackground&&(p.backgroundColor=i.baselineBackground)),e(o).hasClass("e-baseline-gantt-milestone")&&(h=o.querySelector(".e-baseline-milestone-top"),g=o.querySelector(".e-baseline-milestone-bottom"),h&&g&&(m=h.style,(_=g.style).borderTopColor!=i.baselineBackground&&m.borderBottomColor!=i.baselineBackground&&(_.borderTopColor=i.baselineBackground,m.borderBottomColor=i.baselineBackground)))}},_expandCollapse:function(e){var t=this,i={},a=t.model.currentViewData[e];i.data=a,i.recordIndex=t.model.updatedRecords&&t.model.updatedRecords.indexOf(a),i.source="ganttChart",i.expanded=!a.expanded,a&&(i.expanded?t._trigger("expanding",i):t._trigger("collapsing",i))},_getExpandStatus:function(e){var t=e.parentItem;return null==t||!1!==t.expanded&&(!t.parentItem||!1!==t.parentItem.expanded&&this._getExpandStatus(t.parentItem))},onScrollHelper:function(t,i){var a,r,n=this;if(!n._$bodyContainer.ejScroller("isVScroll"))return!1;n._mouseLeave(),n.closePredecessorDialog(),i||n._$bodyContainer.ejScroller("option","scrollTop",t),n.model.rowHeight,e("#"+this._$ganttViewTablebody[0].id).find("tr:first")[0]&&e("#"+this._$ganttViewTablebody[0].id).find("tr:first")[0].getBoundingClientRect().height,t>(a=parseInt(this.getRecordsHeight())-(n._viewportHeight-18))&&(t=a),t<0&&(t=0),r={scrollTop:t},n._handleScroll(r),1==this.model.isCriticalPathEnable&&1==this.model.enableVirtualization&&this.criticalConnectorLine(this.model.criticalPathCollection,this.model.detailPredecessorCollection,!0,this.collectionTaskId)},_handleScroll:function(e){var t,a,r=this,n=(e=e||{},r._$headerContainer),o=r._prevScrollTop,l=r._prevLeft;e.scrollTop!==i&&(r._scrollTop=e.scrollTop),e.scrollLeft!==i&&(r._scrollLeft=e.scrollLeft),t=r._scrollLeft-r._prevLeft,a=r._scrollTop-r._prevScrollTop,t?n.scrollLeft(r._scrollLeft):n.scrollLeft(r._prevLeft),r.model.enableVirtualization&&(r._vscrollDist=Math.abs(r._scrollTop-r._prevScrollTop),r._vscrollDist&&(r._vScrollDir=r._prevScrollTop<=r._scrollTop?1:-1,r._updateCurrentViewData(),r.renderGanttRecords(),r._prevScrollTop=r._scrollTop)),r._prevLeft=r._scrollLeft,r._prevScrollTop=r._scrollTop,e.requestType="scroll",0===t&&0!==a?(e.prevScrollTop=o,e.scrollDirection="vertical",e.delta=r._scrollTop,r._completeAction(e)):0!==t&&0===a&&(e.prevScrollLeft=l,e.isScrollByMethod=this._isScrollByMethod,e.scrollDirection="horizontal",r._completeAction(e))},_getMaxScrollWidth:function(){return this._$bodyContainer.children(".e-content").find(".e-ganttviewerbodyContent").width()-this._$bodyContainer.children(".e-content").width()},setScrollLeft:function(e){var t=this._getMaxScrollWidth();e>t&&(e=t),e!=this._prevLeft&&(this._isScrollByMethod=!0,this._$bodyContainer.ejScroller("scrollX",e,!0)),this._isScrollByMethod=!1},refreshHelper:function(e,t,a){var r=this;r.model.currentViewData=e,r.model.updatedRecords=t,r._totalCollapsedRecordCount=a!=i?a:0,t&&(r._refresh(),r._setHeight(this.getRecordsHeight()),r.updateHeight(r._containerHeight))},_setScrollTop:function(){var e,t,i=this,a=this.model,r=i._scrollTop;e="resourceView"==a.viewType?this._getHeightforResourceView(a.currentViewData):a.currentViewData.length*a.rowHeight,a.enableVirtualization&&0!==r&&e<i._viewportHeight&&((t=r-(i._viewportHeight-e))<0&&(t=0),i._$bodyContainer.ejScroller("scrollY",t,!0))},refreshGridLinesTable:function(e){var t,i=this;i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(e)),i._$bodyContainer.ejScroller("refresh"),parseInt(i._$bodyContainer.css("height"))!=i._viewportHeight&&(t=i._$bodyContent.width()<i._$bodyContainerParent.width()?i._viewportHeight+18:i._viewportHeight,i._$bodyContainer.css("height",t))},_refresh:function(){var i=this,a=i.model,r=e.render[i._id+"_CustomTemplate2"](i.model.currentViewData);i._$ganttViewTablebody=e("#ganttViewTablebody"+i._id),i._$ganttViewTablebody.empty().append(r),a.enableVirtualization?i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(i.model.currentViewData.length)):i._$gridLinesTablebody.empty().append(i._createGridLinesTableRow(i.model.currentViewData.length-i._totalCollapsedRecordCount)),null!=i._$ganttViewTablebody[0]?this._ganttChartRows=e(i._$ganttViewTablebody[0].childNodes):(i._$ganttViewTablebody=t.buildTag("tbody.e-gantt-viewer-ganttViewTablebody#ganttViewTablebody"+i._id,r,{},{}),i._ganttChartRows=e(i._$ganttViewTablebody[0].childNodes)),a.queryTaskbarInfo&&i._eventBindings()},refreshRow:function(t){var i,a,r=this,n=this.model,o=e(r.getGanttChartRows()[t]),l=r.model.currentViewData[t],d="resourceView"==n.viewType;d&&l&&(a=n.enableVirtualization?t:this.getExpandedRecords(this.model.updatedRecords).indexOf(l),i=e(this._$gridLinesTablebody[0].childNodes[a])),!n.allowSelection&&l&&(l.isSelected=!1),-1!=t&&l&&(o.replaceWith(e.render[r._id+"_CustomTemplate2"](l)),r._setGanttChartRows(e(r._$ganttViewTablebody[0].childNodes)),d&&i.height(this._getTemplateRowHeight(l))),n.queryTaskbarInfo&&r._refreshedRowEventBinding(t)},_refreshedRowEventBinding:function(t){var i,a,r,n,o,l=e(this.getGanttChartRows())[t],d=this.model.currentViewData[t],s={};if(s.taskbar=l,e(l).hasClass("e-ganttrowcell"))if("histogramView"==this.model.viewType)for(i=e(l).find("div.e-gantthistobar"),o=0;o<e(i).length;o++)r={},n=(a=e(i)[o]).querySelector(".e-gantthistoworklabel"),r.taskbar=a,r.data=d.workTimelineRanges[o],r.taskbarBackground=a.style.backgroundColor,r.labelColor=n.style.color,this._trigger("queryTaskbarInfo",r),a.style.backgroundColor!=r.taskbarBackground&&(a.style.backgroundColor=r.taskbarBackground),n.style.color!=r.labelColor&&(n.style.color=r.labelColor);else if(i=e(l).find("div.e-childContainer,div.e-parentContainer,div.e-gantt-milestone-container"),e(i).length>0&&"resourceTask"==d.eResourceTaskType)for(o=0;o<e(i).length;o++)a=e(i)[o],s.taskbar=a,s.data=d.eResourceChildTasks[o],this._prepareQueryTaskbar(a,s);else s.data=d,this._prepareQueryTaskbar(i,s)},refreshScroller:function(e){var t,i,a,r=this;r._$bodyContainer.find("div.e-content").removeClass("e-borderbox"),i=r._$bodyContainer.ejScroller("option","scrollTop"),a=r._$bodyContainer.ejScroller("option","scrollLeft"),r._$bodyContainer.ejScroller("option",{width:e}),r._$bodyContainer.ejScroller("refresh"),a>(t=r.getMaxScrollWidth())&&(a=t>0?t:0),r._$bodyContainer.ejScroller("isVScroll")&&r._$bodyContainer.ejScroller("scrollY",i,!0),r._$bodyContainer.ejScroller("option","scrollLeft",a),r._$headerContainer.scrollLeft(a)},getMaxScrollWidth:function(){return this._$bodyContainer.children(".e-content").children().width()-this._$bodyContainer.children(".e-content").width()},refreshStripLines:function(e){e&&(this.model.stripLines=e),this._$stripLineContainer.empty(),this._renderStripLines(this.model.stripLines)},refreshHolidays:function(e){var t,i,a=this;if(e&&(a.model.holidays=e),a._$secondaryCanvas.empty(),null!=a.model.holidays)for(t=a.model.holidays.length,i=0;i<t;i++)a._renderHoliday(a.model.holidays[i])},renderNewAddedRow:function(t,i){var a=this,r=(a.model,e.render[this._id+"_CustomTemplate2"](i));0!=a._ganttChartRows.length?a._ganttChartRows.length==t?a.getGanttChartRows().eq(t-1).after(r):a.getGanttChartRows().eq(t).before(r):a._refresh(),a._setGanttChartRows(e(a._$ganttViewTablebody[0].childNodes)),a._$gridLinesTablebody.empty().append(a._createGridLinesTableRow(a.model.updatedRecords.length-a._totalCollapsedRecordCount)),a._setHeight(this.getRecordsHeight()),a.updateHeight(a._containerHeight)},_setGanttChartRows:function(e){this._ganttChartRows=e},refreshContainersWidth:function(){var i,a,r,n,o=this,l=this.model.scheduleHeaderSettings.scheduleHeaderType;if(i=o._getScheduleLength(l),a=e("#ganttgridLinesTable"+o._id),o._$bodyContent.width(i),l==t.Gantt.ScheduleHeaderType.Day?o._renderDayWorkColor():o.refreshWeekEndContainer(),a.width(i),a.children("col").width(i),o._$ganttViewTable.width(i),o._$ganttViewTable.children("col").width(i),o._createChartTaskbarTemplate(),o._updateCurrentViewData(),o._$secondaryCanvas.empty(),o._$stripLineContainer.empty(),null!=o.model.stripLines&&this._renderStripLines(o.model.stripLines),null!=o.model.holidays)for(r=o.model.holidays.length,n=0;n<r;n++)o._renderHoliday(o.model.holidays[n])},refreshWeekEndContainer:function(){var e,i,a,r,n,o=this,l=o.model,d=0,s=o.model.perDayWidth+1,c=o.model.updatedRecords.length*this.model.rowHeight,u=o.model.scheduleWeeks.length,p=l.scheduleHeaderSettings.weekStartDay,h=p>=0&&p<7?p:0,g=6-h,m=o._$weekendsContainer.children(".e-secondary_canvas"),_=o._nonWorkingDayIndex.length;for(m.empty(),i=0;i<u;i++){for(r=0;r<_;r++)6!=o._nonWorkingDayIndex[r]?a=(n=g+o._nonWorkingDayIndex[r]+1)>=7?o._nonWorkingDayIndex[r]-h:n:a=g,e=t.buildTag("div.e-weekends","",{left:d+o.model.perDayWidth*a+"px",width:s+"px",height:c+"px","background-color":this.model.weekendBackground},{}),m.append(e);d+=this._scheduleWeekWidth}o._$weekendsContainer.append(m)},deleteChartRows:function(e,t){for(var i=this.getGanttChartRows(),a=e;a<e+t;a++)i.splice(a,1)},_prepareQueryTaskbar:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m=e(i)[0];e(m).hasClass("e-gantt-milestone-container")&&(r=e(m).find(".e-gantt-milestone.e-milestone-top")[0]),e(m).next().hasClass("e-baselinebar")&&(n=e(m).next().closest("div")[0]),e(m).next().hasClass("e-baseline-gantt-milestone-container")&&(o=e(m).next().find(".e-baseline-gantt-milestone").closest("div")[0]),e(m).hasClass("e-parentContainer")?(l=m.querySelector(".e-gantt-parenttaskbar-innerdiv"),d=m.querySelector(".e-gantt-parenttaskbar-progress"),s=m.querySelector(".e-gantt-manualparenttaskbar")):e(m).hasClass("e-childContainer")&&(p=m.querySelector(".e-gantt-childtaskbar"),u=(c=m.querySelector(".e-gantt-childtaskbar-progress"))&&c.querySelector(".e-tasklabel")),a.taskbarBackground=null!=p?p.style.backgroundColor:null,a.progressbarBackground=null!=c?c.style.backgroundColor:null,a.parentTaskbarBackground=null!=l?l.style.backgroundColor:null,a.parentProgressbarBackground=null!=d?d.style.backgroundColor:null,a.parentProgressbarBorder=null!=d?d.style.border:null,a.progressbarBorder=null!=c?c.style.border:null,a.taskbarBorder=null!=p?p.style.border:null,a.parentTaskbarBorder=null!=l?l.style.border:null,a.taskbarTextColor=null!=u?u.style.color:null,a.data.isMilestone&&!t.isNullOrUndefined(o)?(h=o.querySelector(".e-baseline-milestone-top"),g=o.querySelector(".e-baseline-milestone-bottom"),h&&g&&(a.baselineBackground=h.style.borderBottomColor)):a.baselineBackground=null!=n?n.style.backgroundColor:null,a.milestoneBackground=null!=r?r.style.borderBottomColor:null,a.data.hasChildRecords&&!a.data.isAutoSchedule&&(a.manualParentTaskbarBackground=null!=s?s.style.backgroundColor:null),this._queryTaskbarinfo(a,m)},_eventBindings:function(){var t,i,a,r,n,o,l,d,s=e(this.getGanttChartRows()),c=s.length,u={};if(0!=c)for(n=0;n<c;n++)if(t=s[n],i=this.model.currentViewData[n],u.taskbar=t,e(t).hasClass("e-ganttrowcell"))if("histogramView"==this.model.viewType)for(a=e(t).find("div.e-gantthistobar"),d=0;d<e(a).length;d++)o={},l=(r=e(a)[d]).querySelector(".e-gantthistoworklabel"),o.taskbar=r,o.data=i.workTimelineRanges[d],o.taskbarBackground=r.style.backgroundColor,o.labelColor=l.style.color,this._trigger("queryTaskbarInfo",o),r.style.backgroundColor!=o.taskbarBackground&&(r.style.backgroundColor=o.taskbarBackground),l.style.color!=o.labelColor&&(l.style.color=o.labelColor);else if(a=e(t).find("div.e-childContainer,div.e-parentContainer,div.e-gantt-milestone-container"),e(a).length>0&&"resourceTask"==i.eResourceTaskType)for(d=0;d<e(a).length;d++)r=e(a)[d],u.taskbar=r,u.data=i.eResourceChildTasks[d],this._prepareQueryTaskbar(r,u);else u.data=i,this._prepareQueryTaskbar(a,u)},_updateCurrentViewData:function(){var t=this,i=0;this.model.enableVirtualization?(this._getRenderedRowRange(),this.model.currentViewData=this.model.updatedRecords.slice(t._renderedRange.top,t._renderedRange.bottom),0!==t._vscrollDist&&(i=t._scrollTop,i-=t._rowMargin,e("#ganttViewTable"+t._id).css({top:i+"px"}),e("#ganttgridLinesTable"+t._id).css({top:i+"px"})),t._vTop=t._visibleRange.top,t._vBottom=t._visibleRange.bottom,t._rTop=t._renderedRange.top,t._rBottom=t._renderedRange.bottom):this.model.currentViewData=this.model.updatedRecords},renderGanttRecords:function(){var e=this;e._refresh(),e._$ganttViewTable.append(e._$ganttViewTablebody),e._$bodyContent.append(e._$ganttViewTable)},_getRenderedRowRange:function(){var e,t,i=this;return i._getVisibleRowRange(),e=i._visibleRange.top,t=i._visibleRange.bottom,i._renderedRange={top:e,bottom:t},i._renderedRange},_getVisibleRangeForResourceGantt:function(e){for(var i,a,r,n={},o=this.model,l=e+this._viewportHeight,d=0,s=e,c=o.updatedRecords,u=0;u<c.length&&(d=this._getTemplateRowHeight(c[u]),0==s&&t.isNullOrUndefined(i)?(i=0,a=0):e<0&&t.isNullOrUndefined(i)&&(i=u-1,a=this._getTemplateRowHeight(c[i])- -1*e),l<=0&&t.isNullOrUndefined(r)&&(r=u),e-=d,l-=d,t.isNullOrUndefined(i)||t.isNullOrUndefined(r));u++);return n.top=i,n.topOffset=a,n.bottom=t.isNullOrUndefined(r)?c.length:r,n},_getVisibleRowRange:function(){var e,t,i,a,r,n,o=this;"resourceView"==this.model.viewType?(e=(n=this._getVisibleRangeForResourceGantt(o._scrollTop)).top,o._rowMargin=n.topOffset,a=n.bottom):(t=(e=o._scrollTop/o.model.rowHeight)-Math.floor(e),a=o._getrowposition(o._scrollTop+o._viewportHeight),o._rowMargin=t*o.model.rowHeight),i=Math.floor(e),r=o.model.updatedRecords.length,i=Math.max(0,i),a=Math.min(r,a),o._visibleRange={top:i,bottom:a}},_getrowposition:function(e){return Math.ceil(e/this.model.rowHeight)},_getDateType:function(e){return e instanceof Date?e:null!=e?t.parseDate(e,this.model.dateFormat,this.model.locale):null},_getDateFromFormat:function(e){return"object"==typeof e?new Date(e):e?null==t.parseDate(e,this.model.dateFormat,this.model.locale)?new Date(e):t.parseDate(e,this.model.dateFormat,this.model.locale):void 0},createGridLinesTable:function(){var i,a,r,n,o,l,d=this,s=d.model,c=s.scheduleHeaderSettings.scheduleHeaderType;switch(i=t.buildTag("table.e-ganttgridLinesTable e-zerospacing#ganttgridLinesTable"+d._id,"",{"z-index":"2",position:"absolute"}),n=t.buildTag("colgroup","",{},{}),o=e(document.createElement("col")),c){case"week":a=s.scheduleWeeks.length,i.css("width",a*d._scheduleWeekWidth+"px"),o.css("width",a*this._scheduleWeekWidth+"px");break;case"year":case"quarterYear":case"halfYear":a=s.scheduleYears.length,i.css("width",d._scheduleYearWidth+"px"),o.css("width",this._scheduleYearWidth+"px");break;case"month":a=s.scheduleMonths.length,i.css("width",d._scheduleMonthWidth+"px"),o.css("width",this._scheduleMonthWidth+"px");break;case"day":a=s.scheduleDays.length,i.css("width",a*d.model.perHourWidth*24+"px"),o.css("width",a*d.model.perHourWidth*24+"px");break;case"hour":a=s.scheduleHours.length,i.css("width",a*d.model.perMinuteWidth*d._totalInterval+"px"),o.css("width",a*d.model.perMinuteWidth*d._totalInterval+"px")}n.append(o),i.append(n),r=d._createGridLinesTableRow(s.enableVirtualization?s.currentViewData.length:s.updatedRecords.length),l=t.buildTag("tbody.e-gantt-viewer-gridLinesTablebody#gridLinesTablebody"+d._id,r,{},{}),d._$gridLinesTablebody=l,i.append(d._$gridLinesTablebody),d._$bodyContent.append(i)},_createGridLinesTableRow:function(e){var t,i=this.model,a="",r=[];for("resourceView"==i.viewType&&i.enableVirtualization?r=i.currentViewData:"resourceView"!=i.viewType||i.enableVirtualization||(r=this.getExpandedRecords(this.model.updatedRecords)),t=0;t<e;t++)a+="resourceView"==i.viewType?"<tr style='display:table-row;height:"+this._getTemplateRowHeight(r[t])+"px'><td class='e-ganttgridlines'></td></tr>":"<tr style='display:table-row;height:"+i.rowHeight+"px'><td class='e-ganttgridlines'></td></tr>";return a},_SelectState:function(){return!!this.model.allowSelection},_getFontSize:function(){var e,t;return.5==(t=(e=70*this.model.taskbarHeight/100)%1)?e:t<.5?Math.floor(e):Math.ceil(e)},_getLeftTaskLabel:function(){var e,t=this.model,i="",a=t._columns.length;if(this.model.leftTaskLabelMapping==this.model.resourceNameMapping)i="{{:~_"+this._id+"resources(#data)}}";else if(this.model.leftTaskLabelMapping==this.model.predecessorMapping)i="{{:predecessorsName}}";else for(e=0;e<a;e++)if(this.model.leftTaskLabelMapping==t._columns[e].mappingName){i="{{:"+t._columns[e].field+"}}";break}return""==i&&(i="{{:"+this.model.leftTaskLabelMapping+"}}"),i},_getRightTaskLabel:function(){var e,t=this.model,i="",a=t._columns.length;if(this.model.rightTaskLabelMapping==this.model.resourceNameMapping)i="{{:~_"+this._id+"resources(#data)}}";else if(this.model.rightTaskLabelMapping==this.model.predecessorMapping)i="{{:predecessorsName}}";else for(e=0;e<a;e++)if(this.model.rightTaskLabelMapping==t._columns[e].mappingName){i="{{:"+t._columns[e].field+"}}";break}return""==i&&(i="{{:"+this.model.rightTaskLabelMapping+"}}"),i},_getMargin:function(){var e;return e=(this.model.taskbarHeight-this._fontSize-3)/2,Math.floor(e)},_getResizerLeftAdjust:function(){var e,t=this.model.taskbarHeight;this._fontSize,this._resizerMargin;return(e=(e=t/50)%1<.5?Math.floor(e):Math.ceil(e))<0?0:e},_processTaskbarTemplate:function(i,a,r){var n,o=this.model,l=t.buildTag("div","",{},{}),d="",s=!1,c="";return"resourceTemplate"!==r&&(c="left:{{:left}}px;"),n=(n="#"==i.charAt(0)?e(i)[0].innerHTML:i).replace(/src/gi,this._id+"src"),e(l[0]).html(n),e(l[0].childNodes).each(function(){var i,r,n,l,u;e(this).hasClass("e-gantt-template-taskbar")?(i="e-gantt-childtaskbar "+e(this).attr("class"),e(this).css({height:a+"px"}).attr("class",i),r="",e(this.childNodes).each(function(){var t,i,n;e(this).hasClass("e-gantt-template-progressbar")?(s=!0,t="e-gantt-childtaskbar-progress  "+e(this).attr("class"),e(this).css({height:o.progressbarHeight*(a/100)+"px",position:"absolute",top:"-1px",left:"-1px"}).attr("class",t),n=(i=this.outerHTML).indexOf("style"),i=i.substr(0,n+7)+"border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;"+i.substr(n+7),r+=i):r+="#comment"==this.nodeName?"":"#text"==this.nodeName?this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,""):this.outerHTML}),l=(n=e(this).clone().empty()[0].outerHTML).indexOf("style"),n=n.substr(0,l+7)+c+"width:{{:width}}px;"+n.substr(l+7),u="msie"==t.browserInfo().name&&t.browserInfo().version<9?n.indexOf("</"+this.tagName+">"):n.indexOf("</"+this.tagName.toLowerCase()+">"),n=n.substr(0,u)+r+n.substr(u),d+=n):d+="#comment"==this.nodeName?"":this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,"")}),{template:d=d.replace(RegExp((this._id+"src").toLowerCase(),"g"),"src"),isProgressbarTemplate:s}},_processParentTaskbarTemplate:function(i,a){var r,n=this.model,o=t.buildTag("div","",{},{}),l="";return r=(r="#"==i.charAt(0)?e(i)[0].innerHTML:i).replace(/src/gi,this._id+"src"),e(o[0]).html(r),e(o[0].childNodes).each(function(){var i,r,o,d,s;e(this).hasClass("e-gantt-template-taskbar")?(e(this).addClass("e-parentTask"),i="e-gantt-parenttaskbar-innerdiv e-parentTask"+e(this).attr("class"),e(this).css({height:a+"px"}).attr("class",i),r="",e(this.childNodes).each(function(){var t,i,o;e(this).hasClass("e-gantt-template-progressbar")?(t="e-gantt-parenttaskbar-progress e-parentTask "+e(this).attr("class"),e(this).css({height:n.progressbarHeight*(a/100)+"px",top:"-1px",left:"-1px",position:"absolute","z-index":"3"}).attr("class",t),o=(i=this.outerHTML).indexOf("style"),i=i.substr(0,o+7)+"border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;"+i.substr(o+7),r+=i):r+="#comment"==this.nodeName?"":"#text"==this.nodeName?this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,""):this.outerHTML}),d=(o=e(this).clone().empty()[0].outerHTML).indexOf("style"),o=o.substr(0,d+7)+"left:{{:left}}px;width:{{:width}}px;"+o.substr(d+7),s="msie"==t.browserInfo().name&&t.browserInfo().version<9?o.indexOf("</"+this.tagName+">"):o.indexOf("</"+this.tagName.toLowerCase()+">"),o=o.substr(0,s)+r+o.substr(s),l+=o):l+="#comment"==this.nodeName?"":this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,"")}),l=l.replace(RegExp((this._id+"src").toLowerCase(),"g"),"src")},_processMilestoneTemplate:function(i,a){var r,n=this.model,o=t.buildTag("div","",{},{}),l="";return r=(r="#"==i.charAt(0)?e(i)[0].innerHTML:i).replace(/src/gi,this._id+"src"),e(o[0]).html(r),e(o[0].childNodes).each(function(){var t,i,r;e(this).hasClass("e-gantt-template-milestone")?(t="e-gantt-milestone "+e(this).attr("class"),e(this).css({width:n.taskbarHeight-3+"px",position:"absolute","z-index":"3"}).attr("class",t),r=(i=this.outerHTML).indexOf("style"),i=i.substr(0,r+7)+"left:{{:left -"+a+"}}px;"+i.substr(r+7),l+=i):l+="#comment"==this.nodeName?"":this.textContent?this.textContent.replace(/(\r\n|\n|\r)/gm,""):this.nodeValue.replace(/(\r\n|\n|\r)/gm,"")}),l=l.replace(RegExp((this._id+"src").toLowerCase(),"g"),"src")},_processTaskLabelTemplate:function(t){var i="";return"#"==t.charAt(0)?e(t)[0]&&(i=e(t)[0].innerHTML):i=document.getElementById(t)?e("#"+t)[0].innerHTML:t,i},_sortHolidays:function(e){var i=t.Query().sortBy("day",t.sortOrder.Ascending);return t.DataManager(e).executeLocal(i)},_rendercalendar:function(e,i,a,r,n,o){var l=this.model.rowHeight-6,d={};return r=t.buildTag("div.e-gantthistocalender.e-rverticalline"),n=t.buildTag("div.e-gantthistocalender.e-lverticalline"),o=t.buildTag("div.e-gantthistocalender.e-horizontalline"),n.css({left:e+"px",width:"1px",height:l+"px","border-left-width":"1px","border-left-style":"solid",position:"absolute","margin-top":"6px"}),d.leftVerticalDiv=n,r.css({left:i+"px",width:"1px",height:l+"px","border-left-width":"1px","border-left-style":"solid",position:"absolute","margin-top":"6px"}),d.rightVerticalDiv=r,o.css({left:e+"px",width:a+"px",top:"6px","border-top-style":"solid","border-top-width":"1px",position:"absolute"}),d.horiDiv=o,d},_processWeekHistoMode:function(i){var a,r,n,o,l=this,d=l.model,s=0,c=this.model.ganttInstance,u=d.perDayWidth,p=(d.rowHeight,[]),h=(l.model.scheduleWeeks.length,e.extend(!0,[],l._nonWorkingDayIndex)),g=new Date(d.projectStartDate),m=e("<div></div>"),_=new Date(d.projectEndDate);if("week"==d.scheduleHeaderSettings.scheduleHeaderType&&_.setDate(_.getDate()+6),t.isNullOrUndefined(l._isCalendarExist)){do{1==d.includeWeekend&&(h=[]),-1!=h.indexOf(g.getDay())||c._getHolidayByDay(g)?(null!=r&&null!=n&&null!=o&&(m.append(n),m.append(o),m.append(r),r=n=o=null,s+=u,u=d.perDayWidth),s+=d.perDayWidth):u==d.perDayWidth&&null==o&&null==r&&null==n?(a=s+u,r=(p=l._rendercalendar(s,a,u,r,n,o)).rightVerticalDiv,n=p.leftVerticalDiv,o=p.horiDiv,m.append(n),m.append(o),m.append(r)):(a=s+(u+=d.perDayWidth),r.css("left",a),o.css("width",u)),g.setDate(g.getDate()+1)}while(g.getTime()<=_.getTime());m.append(n),m.append(o),m.append(r),l._isCalendarExist=m.html(),i+=m.html()}else i+=l._isCalendarExist;return i},_processYearHistoMode:function(i){var a,r,n,o,l,d,s,c=this,u=c.model,p=c.model.ganttInstance,h=u.holidays,g=[],m=[],_=e("<div></div>");if(h=c._sortHolidays(h),t.isNullOrUndefined(c._isCalendarExist)){for(s=0;s<h.length;s++)g.push(p._getTaskLeft(h[s].day,!1));for(g.push(c._scheduleYearWidth),s=0;s<g.length;s++)a=0==s?0:g[s-1]+u.perDayWidth,n=(r=g[s]-1)-a,o=(m=c._rendercalendar(a,r,n,o,l,d)).rightVerticalDiv,l=m.leftVerticalDiv,d=m.horiDiv,_.append(l),_.append(d),_.append(o);c._isCalendarExist=_.html(),i+=_.html()}else i+=c._isCalendarExist;return i},_processHourHistoMode:function(t){var i,a,r,n,o,l=this.model,d=0,s=(l.rowHeight,e("<div></div>")),c=[],u=0,p=l.ganttInstance,h=l.scheduleHours,g="",m=l.perMinuteWidth*this._totalInterval,_=e.extend(!0,[],this._nonWorkingDayIndex);if(this._isCalendarExist)return t+this._isCalendarExist;for(1==l.includeWeekend&&(_=[]),o=0;o<h.length;o++){if(-1!=_.indexOf(h[o].getDay())||p._getHolidayByDay(h[o])||!this._checkIsWorkingHour(h[o])){a&&r&&n&&(s.append(r),s.append(n),s.append(a),g+=s.html(),a=r=n=null,u=i=0),d+=m;continue}a&&r&&n?(i+=m,u+=m,a.css("left",i),n.css("width",u)):(i=d+m,u+=m,a=(c=this._rendercalendar(d,i,u,a,r,n)).rightVerticalDiv,r=c.leftVerticalDiv,n=c.horiDiv),d+=m}return this._isCalendarExist=g,t+g},_processDayHistoMode:function(t){var i,a,r,n,o,l,d,s=this,c=s.model,u=0,p=c.ganttInstance,h=(c.rowHeight,e("<div></div>")),g=s.model.scheduleDays,m=c._nonWorkingTimeRange,_="",f=[],w=e.extend(!0,[],s._nonWorkingDayIndex);if(this._isCalendarExist)return t+this._isCalendarExist;for(1==c.includeWeekend&&(w=[]),l=0;l<g.length;l++)if(-1!=w.indexOf(g[l].getDay())||p._getHolidayByDay(g[l]))u+=o=c.perDayWidth;else for(d=0;d<m.length;d++)o=(m[d].to-m[d].from)*c.perHourWidth,0!=m[d].isWorking?(i=u+o,a=(f=s._rendercalendar(u,i,o,a,r,n)).rightVerticalDiv,r=f.leftVerticalDiv,n=f.horiDiv,h.append(r),h.append(n),h.append(a),_+=h.html(),u+=o):u+=o;return this._isCalendarExist=_,t+_},_checkIsWorkingHour:function(e){for(var t,i=this.model.ganttInstance,a=i._workingTimeRanges,r=i._getSecondsInDecimal(e),n=!1,o=0;o<a.length;o++)if(r>=(t=a[o]).from&&r<t.to){n=!0;break}return n},_processHistoTemplate:function(e){for(var t,i,a=this,r=a.model,n=e.workTimelineRanges,o=r.scheduleHeaderSettings.scheduleHeaderType,l="",d=0;d<n.length;d++)i=r.rowHeight<=n[d].height?r.rowHeight-1:n[d].height,t=r.rowHeight-i-1,l+="<div  class='e-gantthistobar "+(n[d].isOverAllocated?"e-ganttoverallocate":"e-ganttnonoverallocate")+"' style='left:"+n[d].left+"px;width: "+n[d].width+"px;height: "+i+"px;top:"+t+"px'><span class='e-gantthistoworklabel'>"+n[d].workPerDay+r._durationUnitEditText.hour[0]+"</span></div>";return"week"==o||"month"==o?l=a._processWeekHistoMode(l):"year"==o||"quarterYear"==o||"halfYear"==o?l=a._processYearHistoMode(l):"day"==o?l=a._processDayHistoMode(l):"hour"==o&&(l=a._processHourHistoMode(l)),l},_createHistogramTaskbarTemplate:function(){var i,a,r=this,n=r.model,o={};o["_"+r._id+"SelectState"]=e.proxy(r._SelectState,r),o["_"+r._id+"histoTemplate"]=e.proxy(r._processHistoTemplate,r),o["_"+r._id+"rowClassName"]=t.TreeGrid._getrowClassName,o["_"+r._id+"expandStatus"]=e.proxy(r._getExpandStatusRecord,r),e.views.helpers(o),i="<tr class='{{:~_"+r._id+"rowClassName()}} e-ganttrowcell'style='display:{{:~_"+r._id+"expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};height:"+n.rowHeight+"px;'>",i+="<td class='e-gantthistocell'>{{:~_"+r._id+"histoTemplate(#data)}}</td>",i+="</tr>",(a={})[this._id+"_CustomTemplate2"]=i,e.templates(a)},_createTaskbarTemplate:function(){var i,a,r,n,o,l,d,s,c,u,p,h,g,m,_=this,f=_.model,w=f.scheduleHeaderSettings.scheduleHeaderType,C=!1,T=!1,x="",v="",b="",S="",D=f.baselineColor,R=f.taskbarTemplate,y=!1,I=!1,k=f.parentTaskbarTemplate,M=!1,E=f.milestoneTemplate,H=!1,P="",F=f.leftTaskLabelTemplate,O=!1,G="",L=f.rightTaskLabelTemplate,N=!1,W="",A={};A["_"+_._id+"SelectState"]=e.proxy(_._SelectState,_),A["_"+_._id+"getType"]=_._getTypedata,A["_"+_._id+"expander"]=_._addRecordExpandCollapse,A["_"+_._id+"milestoneMapping"]=_._isMilestone,A["_"+_._id+"taskNameWidth"]=_._taskNameContainerWidth,A["_"+_._id+"resources"]=e.proxy(_._getResourceInfo,_),A["_"+_._id+"rowClassName"]=t.TreeGrid._getrowClassName,A["_"+_._id+"expandStatus"]=e.proxy(_._getExpandStatusRecord,_),A["_"+_._id+"borderRadius"]=_._getBorderRadius,_._fontSize=_._getFontSize(),_._resizerRightAdjust=.8*_._fontSize,_._resizerMargin=_._getMargin(),_._resizerLeftAdjust=_._getResizerLeftAdjust(),"week"==w?i=f.scheduleWeeks.length*_._scheduleWeekWidth:"year"==w||"quarterYear"==w||"halfYear"==w?i=_._scheduleYearWidth:"month"==w?i=_._scheduleMonthWidth:"day"==w?i=f.scheduleDays.length*f.perHourWidth*24:"hour"==w&&(i=f.scheduleHours.length*f.perMinuteWidth*_._totalInterval),f.renderBaseline?(f.taskbarHeight+4<=f.rowHeight?(h=f.taskbarHeight,r=0):(h=f.taskbarHeight-4,r=-4),a=h,0,n=f.rowHeight-4-5):(a=f.taskbarHeight,n=f.rowHeight-10),c=a/5,o=Math.floor(f.taskbarHeight/2),_._milesStoneWidth=2*o,_._connectorPointWidth=l=a/2,d=l/2,s=l-l/2,e.views.helpers(A),f.progressMapping||(this.model.showProgressStatus=!1),f.resourceInfoMapping||(f.showResourceNames=!1),R&&(y=!0,u=(g=this._processTaskbarTemplate(R,a)).template,I=g.isProgressbarTemplate),k&&(M=!0,p=this._processParentTaskbarTemplate(k,a)),E&&(H=!0,P=this._processMilestoneTemplate(E,o)),F&&(G=this._processTaskLabelTemplate(F),O=!0),L&&(W=this._processTaskLabelTemplate(L),N=!0),this.model.leftTaskLabelMapping&&0==O&&(C=!0,x=_._getLeftTaskLabel()),this.model.rightTaskLabelMapping&&0==N&&(T=!0,S=_._getRightTaskLabel()),this.model.taskbarHeight<45&&(v="<div class='e-connectortouchpoint' style='right:0px;width:20px;margin-top:"+(l-20)/2+"px;height:20px;border-radius:10px'></div>",b="<div class='e-connectortouchpoint' style='left:0px;width:20px;margin-top:"+(l-20)/2+"px;height:20px;border-radius:10px'></div>");var z=Math.round(-(this.model.rowHeight-1)/2),j="<tr class='{{:~_"+_._id+"rowClassName()}}  {{if isSelected && ~_"+_._id+"SelectState()}}e-ganttrowcell {{:~_"+_._id+"expander()}} e-gantt-mouseclick{{else}}e-ganttrowcell {{:~_"+_._id+"expander()}}{{/if}}'style='display:{{:~_"+_._id+"expandStatus(#data)}};background-color:{{if rowBGColor }}{{:rowBGColor}}{{else}} none{{/if}};height:"+f.rowHeight+"px;'>",U="{{:~_"+_._id+"borderRadius()}}";j+="{{if ~_"+_._id+"getType()}}<td class='e-chartcell'><div class='e-tasknameContainer' style='height:"+(this.model.rowHeight-1)+"px;width:{{:~_"+_._id+"taskNameWidth()}};overflow:hidden;text-overflow: ellipsis;'><div class='e-taskbarname'  style='overflow: hidden;text-overflow: ellipsis;margin-top:5px;margin-right:30px;height:"+n+"px;font-weight:bold'>{{if "+O+"}}"+G+"{{else "+this.model.showTaskNames+" && left > 0 && !"+C+" }}<span style='line-height:"+n+"px;'>{{:taskName}}</span>{{else "+C+"}}<span style='line-height:"+n+"px;'>"+x+"</span>{{/if}}</div></div></td><td  class='e-chartcell' style='width:"+i+"px; vertical-align:middle;'><div class='e-parentContainer{{if !isAutoSchedule}} e-manualParenttaskbar{{/if}}' style='height:"+(this.model.taskbarHeight-1)+"px;z-index:3;'>{{if !isAutoSchedule}}<div class='e-gantt-manualparenttaskbar {{:~_"+_._id+"expander()}}' style='left: {{:left}}px;height:"+c+"px; width: {{:width}}px;'><div class='e-gantt-manualparenttaskbar-left' style='height:"+a+"px;border-left-width:"+c+"px;border-bottom:"+c+"px solid transparent;'></div><div class='e-gantt-manualparenttaskbar-right' style='left:{{:width - "+parseInt(c)+"}}px;height:"+a+"px;border-right-width:"+c+"px;border-bottom:"+c+"px solid transparent;'></div><div class='e-taskbarresizer-right' style='left:{{:width -"+c+"}}px;width:"+c+"px;height:"+a+"px;font-size:"+_._fontSize+"px;position:absolute;z-index:10;'></div></div>{{/if}}{{if "+M+"}}"+p+"{{else}}<div class='e-gantt-parenttaskbar-innerdiv {{:~_"+_._id+"expander()}} e-parentTask' style='margin-top:{{if !isAutoSchedule}}"+2*c+"{{/if}}px;background-color:{{if parentTaskbarBackground }}{{:parentTaskbarBackground}}{{else}} "+this.model.parentTaskbarBackground+"{{/if}}; left:{{if isAutoSchedule}}{{:left}}{{else}}{{:manualLeft}}{{/if}}px;width:{{if isAutoSchedule}}{{:width}}{{else}}{{:manualWidth}}{{/if}}px;height:{{if isAutoSchedule}}"+a+"{{else}}"+3*c+"{{/if}}px;'><div  class='e-gantt-parenttaskbar-progress {{:~_"+_._id+"expander()}} e-parentTask progressbar' style='top:-1px;border-style:{{if progressWidth}}solid{{else}}none{{/if}}; left:-1px;width:{{:progressWidth}}px;position:absolute;background-color:{{if parentProgressbarBackground }}{{:parentProgressbarBackground}}{{else}} "+this.model.parentProgressbarBackground+"{{/if}};z-index:3;border-top-right-radius:{{if isAutoSchedule}}"+U+"{{else}}"+c+"{{/if}}px;border-bottom-right-radius:{{if isAutoSchedule}}"+U+"{{else}}"+c+"{{/if}}px;height:{{if isAutoSchedule}}"+a+"{{else}}"+3*c+"{{/if}}px;'></div></div>{{/if}}</div>{{if "+this.model.renderBaseline+" && baselineStartDate && baselineEndDate }}<div  class='e-baselinebar' style='margin-top:"+r+"px;left:{{:baselineLeft}}px;width:{{:baselineWidth}}px;height:4px;background-color: "+D+";position:absolute;z-index:3;box-sizing:border-box;-moz-box-sizing:border-box;'></div>{{/if}}</td><td class='e-chartcell' ><div class='e-resourceinfo' style='left:{{if isAutoSchedule}}{{:left+width+30}}{{else}}{{if (left+width)>(manualLeft+manualWidth)}}{{:left+width+30}}{{else}}{{:manualLeft+manualWidth+30}}{{/if}}{{/if}}px;margin:0;margin-left:5px;margin-top:"+z+"px;position:absolute;background-color:transparent;font-weight:bold;height:"+(this.model.rowHeight-1)+"px;'><div class='e-resourcename'  style='overflow-y:hidden;margin-top:5px;height:"+n+"px;margin-right:30px;outline:none;'>{{if "+N+"}}"+W+"{{else "+this.model.showResourceNames+" && left > 0 && !"+T+" }}<span style='line-height:"+n+"px;'>{{:~_"+_._id+"resources(#data)}}</span>{{else "+T+"}}<span style='line-height:"+n+"px;'>"+S+"</span>{{/if}}</div></div></td>{{else ~_"+_._id+"milestoneMapping()}}<td class='e-chartcell'><div class='e-tasknameContainer' style='height:"+(this.model.rowHeight-1)+"px;width:{{:~_"+_._id+"taskNameWidth()}};overflow:hidden;text-overflow:ellipsis;'><div class='e-taskbarname'  style='overflow: hidden;text-overflow: ellipsis;margin-top:5px;height:"+n+"px;margin-right:30px;'>{{if "+O+"}}"+G+"{{else "+this.model.showTaskNames+" && left > 0 && !"+C+" }}<span style='line-height:"+n+"px;'>{{:taskName}}</span>{{else "+C+"}}<span style='line-height:"+n+"px;'>"+x+"</span>{{/if}}</div></div></td><td class='e-chartcell' style='width:"+i+"px;'><div class='e-gantt-milestone-container' style=height:"+(this.model.taskbarHeight-1)+"px;><div class='e-connectorpoint-left' style='left:{{:left-"+(l+o)+"}}px;width:"+l+"px;margin-top:"+s+"px;height:"+a/2+"px;border-radius:"+d+"px;'>"+v+"</div>{{if "+H+"}}"+P+"{{else}}<div class='e-gantt-milestone' style='position:absolute;left:{{:left-"+o+"}}px;'><div class='e-gantt-milestone e-milestone-top{{if startDate == null && endDate == null}} e-unscheduletaskbar{{/if}}'  style='border-right-width:"+o+"px;border-left-width:"+o+"px;border-bottom-width:"+o+"px; border-right-color:transparent;border-left-color:transparent;border-style:none solid solid;border-top: none;'></div><div class='e-gantt-milestone e-milestone-bottom{{if startDate == null && endDate == null}} e-unscheduletaskbar{{/if}}'  style='top:"+o+"px;border-right-width:"+o+"px; border-left-width:"+o+"px; border-top-width:"+o+"px; border-right-color:transparent;border-left-color:transparent;border-style:solid solid none; border-bottom: none;'></div></div>{{/if}}<div class='e-connectorpoint-right' style='left:{{:(left+"+o+")}}px;width:"+l+"px;margin-top:"+s+"px;height:"+a/2+"px;border-radius:"+d+"px;'>"+b+"</div></div>{{if "+this.model.renderBaseline+" && baselineStartDate && baselineEndDate}}<div class='e-baseline-gantt-milestone-container' ><div class='e-baseline-gantt-milestone' style='position:absolute;left:{{:baselineLeft -"+o+"}}px;z-index:2;'><div class='e-baseline-gantt-milestone e-baseline-milestone-top'  style='z-index:2;top:"+-this.model.taskbarHeight+"px;border:"+o+"px solid transparent;border-top: none;border-bottom-color: "+D+";'></div><div class='e-baseline-gantt-milestone e-baseline-milestone-bottom'  style='z-index:2;top:"+(o-this.model.taskbarHeight)+"px;border:"+o+"px solid transparent;border-bottom: none;border-top-color: "+D+";'></div></div></div>{{/if}}</td><td class='e-chartcell' ><div class='e-resourceinfo' style='margin-top:5px;left:{{:left+56}}px;margin:0;margin-left:5px;margin-top:"+z+"px;height:"+(this.model.rowHeight-1)+"px;position:absolute;background-color:transparent;'><div class='e-resourcename'  style='overflow-y:hidden;margin-top:5px;height:"+n+"px;margin-right:30px;'>{{if "+N+"}}"+W+"{{else "+this.model.showResourceNames+" && left > 0 && !"+T+" }}<span style='line-height:"+n+"px;'>{{:~_"+_._id+"resources(#data)}}</span>{{else "+T+"}}<span style='line-height:"+n+"px;'>"+S+"</span>{{/if}}</div></div></td>{{else}}<td class='e-chartcell'><div class='e-tasknameContainer' style='height:"+(this.model.rowHeight-1)+"px;width:{{:~_"+_._id+"taskNameWidth()}};overflow:hidden;text-overflow: ellipsis;'><div class='e-taskbarname'  style='overflow: hidden;text-overflow: ellipsis;margin-top:5px;height:"+n+"px;margin-right:30px;'>{{if "+O+"}}"+G+"{{else "+this.model.showTaskNames+" && left > 0 && !"+C+" }}<span style='line-height:"+n+"px;'>{{:taskName}}</span>{{else "+C+"}}<span style='line-height:"+n+"px;'>"+x+"</span>{{/if}}</div></div></td><td class='e-chartcell' style='width:"+i+"px;'>{{if (startDate != null || endDate != null || duration != null)}}<div  class='e-childContainer' style='height:"+(this.model.taskbarHeight-1)+"px;'><div class='e-connectorpoint-left' style='left:{{:left-"+l+"}}px;width:"+l+"px;margin-top:"+s+"px;height:"+a/2+"px;border-radius:"+d+"px'>"+v+"</div>{{if (endDate == null && duration == null)}}<div  class='e-gantt-childtaskbar {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}} e-gantt-unscheduletaskbar-left' style='left:{{:left}}px;height:"+a+"px;'></div>{{/if}}{{if (startDate == null && duration == null)}}<div  class='e-gantt-childtaskbar {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}} e-gantt-unscheduletaskbar-right' style='left:{{:left}}px;height:"+a+"px;'></div>{{/if}}{{if (startDate == null && endDate == null)}}<div class='e-taskbarresizer-left e-icon' style='left:{{:left+2-"+_._resizerLeftAdjust+"}}px;width:10px;margin-top:"+_._resizerMargin+"px;height:"+a+"px;font-size:"+_._fontSize+"px;'></div><div  class='e-gantt-childtaskbar {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}} e-gantt-unscheduletaskbar' style='left:{{:left}}px;height:"+a+"px;width:{{:width}}px;'></div><div class='e-taskbarresizer-right e-icon' style='left:{{:left+width-"+_._resizerRightAdjust+"}}px;width:10px;height:"+a+"px;font-size:"+_._fontSize+"px;position:absolute;z-index:2;margin-top:"+_._resizerMargin+"px;'></div>{{/if}}{{if (startDate != null && endDate != null && duration != null)}}<div class='e-taskbarresizer-left e-icon' style='left:{{:left+2-"+_._resizerLeftAdjust+"}}px;width:10px;margin-top:"+_._resizerMargin+"px;height:"+a+"px;font-size:"+_._fontSize+"px;'></div>{{if "+y+"}}"+u+"{{else}}<div  class='e-gantt-childtaskbar {{if isCritical}} e-criticaltaskbar{{/if}} {{if !isAutoSchedule}} e-manualchildtaskbar{{/if}}' style='left:{{:left}}px;width:{{:width}}px;height:"+a+"px;background-color:{{if taskbarBackground }}{{:taskbarBackground}}{{else}} "+this.model.taskbarBackground+"{{/if}};'><div  class='e-gantt-childtaskbar-progress  {{if isAutoSchedule}} progressbar{{else}} e-manualprogressbar{{/if}} {{if isCritical}} e-criticalprogressbar{{/if}}' style='border-style:{{if progressWidth}}solid{{else}}none{{/if}};width:{{:progressWidth}}px;text-align:right;line-height:"+(a-1)+"px;height:"+this.model.progressbarHeight*(a/100)+"px; top:-1px;left:-1px;position:absolute;background-color:{{if progressbarBackground }}{{:progressbarBackground}}{{else}} "+this.model.progressbarBackground+"{{/if}};border-top-right-radius:"+U+"px;border-bottom-right-radius:"+U+"px;'>{{if "+this.model.showProgressStatus+"}}<span class='e-tasklabel' style='line-height:"+(a-1)+"px'>{{:status}}%</span>{{/if}}</div></div>{{/if}}{{if "+(!y||I)+"}}<div class='e-progressbarresizer-right' style='left:{{:left+progressWidth-10}}px;width:20px;margin-top:"+(a-5)+"px;height:15px;position:absolute;z-index:5;'><div class='e-progressbarhandler' style='top:10px;position:absolute;z-index:-1;'><div class='e-progresshandler-element'></div></div><div class='e-progressbarhandler' style='top:5px;position:absolute;z-index:-1;'><div class='e-progresshandlerafter-element'></div></div></div>{{/if}}<div class='e-taskbarresizer-right e-icon' style='left:{{:left+width-"+_._resizerRightAdjust+"}}px;width:10px;height:"+a+"px;font-size:"+_._fontSize+"px;position:absolute;z-index:2;margin-top:"+_._resizerMargin+"px;'></div>{{/if}}<div class='e-connectorpoint-right' style='left:{{:left+width}}px;width:"+l+"px;margin-top:"+s+"px;height:"+a/2+"px;border-radius:"+d+"px'>"+b+"</div>{{/if}}</div>{{if "+this.model.renderBaseline+" && baselineStartDate && baselineEndDate }}<div  class='e-baselinebar' style='margin-top:"+r+"px;left:{{:baselineLeft}}px;width:{{:baselineWidth}}px;height:4px;background-color: "+D+";position:absolute;z-index:3;box-sizing:border-box;-moz-box-sizing:border-box;'></div>{{/if}}</td><td class='e-chartcell' ><div class='e-resourceinfo' style='left:{{:left+width+30}}px;margin:0;margin-left:5px;margin-top:"+z+"px;height:"+(this.model.rowHeight-1)+"px;position:absolute;text-align:left;background-color:transparent;'><div class='e-resourcename'  style='overflow-y:hidden;margin-top:5px;height:"+n+"px;margin-right:30px;'>{{if "+N+"}}"+W+"{{else "+this.model.showResourceNames+" && left > 0 && !"+T+" }}<span style='line-height:"+n+"px;'>{{:~_"+_._id+"resources(#data)}}</span>{{else "+T+"}}<span style='line-height:"+n+"px;'>"+S+"</span>{{/if}}</div></div></td>{{/if}}",j+="</tr>",(m={})[this._id+"_CustomTemplate2"]=j,e.templates(m)},_getResourceInfo:function(e){var t,i,a,r=null;if(null!=e.resourceInfo){if((t=e.resourceInfo.length)>0){for(i=0;i<t;i++)a=e.resourceInfo[i][this.model.resourceUnitMapping],null==r?(r=e.resourceInfo[i][this.model.resourceNameMapping],100!=a&&(r+="["+a+"%]")):(r+=" , "+e.resourceInfo[i][this.model.resourceNameMapping],100!=a&&(r+="["+a+"%]"));return r}return String.empty}return String.empty},_getrowClassName:function(){var e="gridrowtaskId",t=this;return t.data.parentItem&&(e+=t.data.parentItem.taskId.toString()),(e+="level")+t.data.level.toString()},_getExpandStatusRecord:function(e){return this._getExpandStatus(e)?"table-row":"none"},_isMilestone:function(){return!!this.data.isMilestone},_taskNameContainerWidth:function(){var e;return(e=this.data.hasChildRecords&&!this.data.isAutoSchedule?this.data.left<this.data.manualLeft?this.data.left-10:this.data.manualLeft-10:this.data.left-10)<0&&(e=0),e+"px"},_addRecordExpandCollapse:function(){return this.data.expanded?"e-chartexpand":!(this.data.expanded||!this.data.hasChildRecords)&&"e-chartcollapse"},_getTypedata:function(){return this.data.hasChildRecords||"groupTask"==this.data.eResourceTaskType},_getBorderRadius:function(){var e=this.data.width-this.data.progressWidth;return e<=4?4-e:0},_getHeightValue:function(){return this.data.ParentIndex*this.data.RowHeight>this.data.ChildIndex*this.data.RowHeight?this.data.ParentIndex*this.data.RowHeight-this.data.ChildIndex*this.data.RowHeight:this.data.ChildIndex*this.data.RowHeight-this.data.ParentIndex*this.data.RowHeight},_createConnectorLineTemplate:function(){var t,i,a,r,n=this,o=n.model.connectorlineWidth>4?4:n.model.connectorlineWidth,l=n.model.connectorLineBackground,d={};d["_"+n._id+"getWidthVal"]=n._getWidth,d["_"+n._id+"getTop"]=n._getPredecessorTop,d["_"+n._id+"getPosition"]=n._getParentPosition,d["_"+n._id+"setContainerWidthSSType2"]=n._getContainerWidthSSType2,d["_"+n._id+"setInnerChildWidthSSType2"]=n._getInnerChildWidthSSType2,d["_"+n._id+"setInnerElementLeftSSType2"]=n._getInnerElementLeftSSType2,d["_"+n._id+"setInnerElementWidthSSType2"]=n._getInnerElementWidthSSType2,d["_"+n._id+"isMilestone"]=n._isTaskMilestone,d["_"+n._id+"isMilestoneParent"]=n._isMilestoneParent,d["_"+n._id+"getHeightValue"]=n._getHeightValue,n.model.renderBaseline?(t=0,i=n.model.rowHeight/2-t):i=n.model.rowHeight/2,e.views.helpers(d),a="<div  id='ConnectorLine{{:ConnectorLineId}}' style='background-color=black'>",a+="{{if ~_"+n._id+"getPosition()=='FSType1'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType1'><div class='e-line' style='left:{{if milestoneParent}}-7px{{else}}0px{{/if}};width:{{if milestoneParent}}{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+o+"-2}}px{{else}}{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+o+"-10}}px{{/if}};border-top:"+o+"px solid "+l+";position:relative'></div><div class='e-line' style='left:{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+o+"-10}}px;width:0px;border-right:"+o+"px solid "+l+";border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid "+l+";position:relative'></div><div class='e-line' style='left:{{:(ChildLeft-(ParentLeft + ParentWidth + 10))+"+o+"-10}}px;width:10px;border-top:"+o+"px solid "+l+";position:relative'></div><div class='e-connectorline-rightarrow' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth + 10))}}px;border-left: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else  ~_"+n._id+"getPosition()=='FSType2'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType2'><div class='e-line' style='left:{{if milestoneParent}}{{:ParentWidth-7}}px{{else}}{{:ParentWidth}}px{{/if}};width:{{if milestoneParent}}17px{{else}}10px{{/if}};border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:ParentWidth+10-"+o+"}}px;border-left:"+o+"px solid;width:0px;border-top:{{:~_"+n._id+"getHeightValue()-14-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30 )}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:0px;border-top:{{:14-"+o+"}}px solid;border-left:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 20))}}px;width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-rightarrow' style='left:{{:(ParentWidth - (((ParentLeft + ParentWidth) - ChildLeft) + 10))}}px;border-left: 10px solid "+l+";border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;top:{{:-6-"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='FSType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft-20}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType3'><div class='e-connectorline-rightarrow' style='left:10px;border-left: 10px solid "+l+";border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;top:{{:-5-"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative;top:-"+(13+2*(o-1))+"px;'></div><div class='e-line' style='width:"+o+"px;border-top:{{:~_"+n._id+"getHeightValue()-14-"+o+"}}px solid;border-color:"+l+";position:relative;top:-"+(13+2*(o-1))+"px'></div><div class='e-line' style='width:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30)}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative;top:-"+(13+2*(o-1))+"px;'></div><div class='e-line' style='left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 30)}}px;width:0px;border-left:"+o+"px solid;height:{{:14-"+o+"}}px;border-color:"+l+";position:relative;top:-"+(13+2*(o-1))+"px;'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestoneParent()}}left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 14)}}px;width:16px;{{else}}left:{{:(((ParentLeft + ParentWidth) - ChildLeft) + 20)}}px;width:10px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative;top:-"+(13+2*(o-1))+"px;'></div></div>{{else ~_"+n._id+"getPosition()=='FSType4'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FSType4'><div class='e-connectorline-rightarrow' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth + 10))}}px;border-left: 10px solid "+l+";top:{{:-5-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='left:{{:(ChildLeft - (ParentLeft + ParentWidth) - 20)}}px;top:-"+(13+2*(o-1))+"px;width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;left:{{:(ChildLeft - (ParentLeft + ParentWidth) - 20)}}px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestoneParent()}}left:-6px;{{/if}}top:-"+(13+2*(o-1))+"px;width:{{if ~_"+n._id+"isMilestoneParent()}}{{:(ChildLeft-(ParentLeft + ParentWidth+20 )+ 6)+"+o+"}}px;{{else}}{{:(ChildLeft-(ParentLeft + ParentWidth + 20))+"+o+"}}px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='SSType4'}}<div class='e-connectorlineContainer'  style='left:{{:ParentLeft-10}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType4'><div class='e-connectorline-rightarrow' style='left:{{:ChildLeft-ParentLeft}}px;border-left: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:{{:ChildLeft-ParentLeft}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='SSType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft-20}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType3'><div class='e-connectorline-rightarrow' style='left:10px;border-left: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:{{:ParentLeft-ChildLeft+20}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='SSType2'}}<div class='e-connectorlineContainer' style='left:{{:~_"+n._id+"setInnerElementLeftSSType2()}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType2'><div class='e-line' style='width:{{:~_"+n._id+"setInnerChildWidthSSType2()}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='width:{{:~_"+n._id+"setInnerElementWidthSSType2()}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-rightarrow' style='left:{{:~_"+n._id+"setInnerElementWidthSSType2()}}px;border-left: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='SSType1'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft-20}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SSType1'><div class='e-line' style='width:{{:ParentLeft-ChildLeft+20}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-rightarrow' style='left:10px;border-left: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='FFType1'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType1'><div class='e-line' style='left:{{if ~_"+n._id+"isMilestoneParent()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))-10}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))}}px;{{/if}}width:{{if ~_"+n._id+"isMilestoneParent()}}30px;{{else}}20px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{if ~_"+n._id+"isMilestoneParent()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;{{/if}}width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{if ~_"+n._id+"isMilestone()}}4px;{{else}}10px;{{/if}}width:{{if ~_"+n._id+"isMilestone()}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+16}}px;{{else}}{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+10}}px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-leftarrow' style='{{if ~_"+n._id+"isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='FFType2'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType2'><div class='e-line' style='{{if ~_"+n._id+"isMilestoneParent()}}left:-6px;{{/if}}width:{{if ~_"+n._id+"isMilestoneParent()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+26}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{if ~_"+n._id+"isMilestone()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+4}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+10}}px;{{/if}}width:{{if ~_"+n._id+"isMilestone()}}16px;{{else}}10px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-leftarrow' style='left:{{if ~_"+n._id+"isMilestone()}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))-6}}px;{{else}}{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))}}px;{{/if}}border-right: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='FFType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType3'><div class='e-connectorline-leftarrow' style='{{if ~_"+n._id+"isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+l+";top:{{:-5-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestone()}}left:4px;width:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+16}}px;{{else}}left:10px;width:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+10}}px;{{/if}}top:-"+(13+2*(o-1))+"px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))+20}}px;top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestoneParent()}}left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))-6}}px;width:26px;{{else}}left:{{:((ParentLeft + ParentWidth) - (ChildLeft + ChildWidth))}}px;width:20px;{{/if}}top:-"+(13+2*(o-1))+"px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='FFType4'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft+ParentWidth}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='FFType4'><div  class='e-connectorline-leftarrow' style='{{if ~_"+n._id+"isMilestone()}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))-6}}px;{{else}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))}}px;{{/if}}border-right: 10px solid "+l+";top:{{:-5-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestone()}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+4}}px;width:16px;{{else}}left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+10}}px;width:10px;{{/if}}top:-"+(13+2*(o-1))+"px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestoneParent()}}left:-6px;width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+26}}px;{{else}}width:{{:((ChildLeft +ChildWidth)-(ParentLeft + ParentWidth))+20}}px;{{/if}}top:-"+(13+2*(o-1))+"px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else  ~_"+n._id+"getPosition()=='SFType4'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft-10}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType4'><div class='e-connectorline-leftarrow' style='left:{{if ~_"+n._id+"isMilestone()}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+4}}px;{{else}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+10}}px;{{/if}}border-right: 10px solid "+l+";top:{{:-5-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='left:{{if ~_"+n._id+"isMilestone()}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+14}}px;width:16px;{{else}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;width:10px;{{/if}}top:-"+(13+2*(o-1))+"px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-15-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:15-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='top:-"+(13+2*(o-1))+"px;width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='SFType3'}}<div class='e-connectorlineContainer' style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ChildIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType3'><div class='e-connectorline-leftarrow' style='{{if ~_"+n._id+"isMilestone()}}left:-6px;{{/if}}border-right: 10px solid "+l+";top:{{:-5-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestone()}}left:4px;width:16px;{{else}}left:10px;width:10px;{{/if}}top:-"+(13+2*(o-1))+"px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:20px;top:-"+(13+2*(o-1))+"px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:20px;top:-"+(13+2*(o-1))+"px;width:{{:(ParentLeft-(ChildLeft + ChildWidth + 20))+"+o+"}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div></div>{{else  ~_"+n._id+"getPosition()=='SFType1'}}<div class='e-connectorlineContainer' style='left:{{:ParentLeft-10}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType1'><div class='e-line' style='width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-15-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='width:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+30}}px;width:0px;border-left:"+o+"px solid;border-top:{{:15-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestone()}}left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+(15-"+o+")}}px;width:16px;{{else}}left:{{:((ChildLeft + ChildWidth) - (ParentLeft ))+20}}px;width:10px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-leftarrow' style='left:{{if ~_"+n._id+"isMilestone()}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+4}}px;{{else}}{{:((ChildLeft + ChildWidth) - (ParentLeft ))+10}}px;{{/if}}border-right: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{else ~_"+n._id+"getPosition()=='SFType2'}}<div class='e-connectorlineContainer'  style='left:{{:ChildLeft+ChildWidth}}px;top:{{:(ParentIndex * RowHeight) +"+i+"}}px;width:1px;height:{{:~_"+n._id+"getHeightValue()}}px;position:absolute' data-connectortype='SFType2'><div class='e-line' style='left:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;width:10px;border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='left:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;width:0px;border-left:"+o+"px solid;border-top:{{:~_"+n._id+"getHeightValue()-"+o+"}}px solid;border-color:"+l+";position:relative'></div><div class='e-line' style='{{if ~_"+n._id+"isMilestone()}}left:0px;width:{{:((ParentLeft) - (ChildLeft + ChildWidth))-10}}px;{{else}}left:10px;width:{{:((ParentLeft) - (ChildLeft + ChildWidth))-20}}px;{{/if}}border-top:"+o+"px solid;border-color:"+l+";position:relative'></div><div class='e-connectorline-leftarrow' style='left:{{if ~_"+n._id+"isMilestone()}}-6px;{{else}}0px;{{/if}}border-right: 10px solid "+l+";top:{{:-6-"+o+"}}px;border-bottom-width:{{:5+"+o+"}}px;border-top-width:{{:5+"+o+"}}px;width:0;height:0;position:relative'></div></div>{{/if}}",a+="</div>",(r={})[this._id+"ConnectorLineTemplate"]=a,e.templates(r)},_isTaskMilestone:function(){return!!this.data.milestoneChild},_isMilestoneParent:function(){return!!this.data.milestoneParent},_getInnerChildWidthSSType2:function(){return this.data.ParentLeft+this.data.ParentWidth<this.data.ChildLeft?10:this.data.ParentLeft==this.data.ChildLeft?20:this.data.ParentLeft+this.data.ParentWidth>=this.data.ChildLeft?10:this.data.ChildLeft-this.data.ParentLeft},_getInnerElementLeftSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?this.data.ParentLeft-20:this.data.ParentLeft-10},_getInnerElementWidthSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?10:this.data.ChildLeft-this.data.ParentLeft},_getContainerWidthSSType2:function(){return this.data.ParentLeft==this.data.ChildLeft?20:this.data.ChildLeft-this.data.ParentLeft},_getPredecessorTop:function(){return this.data.ParentIndex>this.data.ChildIndex},_getParentPosition:function(){if(this.data.ParentIndex<this.data.ChildIndex){if("FF"==this.data.Type)return this.data.ChildLeft+this.data.ChildWidth>=this.data.ParentLeft+this.data.ParentWidth?"FFType2":"FFType1";if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft>this.data.ParentLeft+this.data.ParentWidth+25){if("FS"==this.data.Type)return"FSType1";if("SF"==this.data.Type)return"SFType1";if("SS"==this.data.Type)return"SSType2";if("FF"==this.data.Type)return"FFType2"}else if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft<this.data.ParentLeft+this.data.ParentWidth||this.data.ParentLeft==this.data.ChildLeft||this.data.ParentLeft>this.data.ChildLeft){if(this.data.ParentLeft>this.data.ChildLeft+this.data.ChildWidth+25&&"SF"==this.data.Type)return"SFType2";if(this.data.ParentLeft>this.data.ChildLeft){if("SS"==this.data.Type)return"SSType1";if("SF"==this.data.Type)return"SFType1";if("FF"==this.data.Type)return"FFType1"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth&&"FF"==this.data.Type)return"FFType2";if("FS"==this.data.Type)return"FSType2";if("SS"==this.data.Type)return"SSType2";if("FF"==this.data.Type)return"FFType1";if("SF"==this.data.Type)return"SFType1"}else if(this.data.ParentLeft<this.data.ChildLeft){if("FS"==this.data.Type)return"FSType2";if("FF"==this.data.Type)return"FFType2";if("SS"==this.data.Type)return"SSType2";if("SF"==this.data.Type)return"SFType1"}}else if(this.data.ParentIndex>this.data.ChildIndex)if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft>this.data.ParentLeft+this.data.ParentWidth){if("FS"==this.data.Type)return 30>=this.data.ChildLeft-(this.data.milestoneParent?this.data.ParentLeft+this.data.ParentWidth+4:this.data.ParentLeft+this.data.ParentWidth)?"FSType3":"FSType4";if(this.data.ParentLeft<this.data.ChildLeft||this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth){if("SS"==this.data.Type)return"SSType4";if("FF"==this.data.Type)return"FFType4";if("SF"==this.data.Type)return"SFType4"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth&&"FF"==this.data.Type)return"FFType4"}else if(this.data.ParentLeft<this.data.ChildLeft&&this.data.ChildLeft<this.data.ParentLeft+this.data.ParentWidth||this.data.ParentLeft==this.data.ChildLeft||this.data.ParentLeft>this.data.ChildLeft){if(this.data.ChildLeft+this.data.ChildWidth<=this.data.ParentLeft+this.data.ParentWidth){if("FF"==this.data.Type)return"FFType3";if("SF"==this.data.Type)return this.data.ChildLeft+this.data.ChildWidth+25<this.data.ParentLeft?"SFType3":"SFType4";if("SS"==this.data.Type)return this.data.ChildLeft<=this.data.ParentLeft?"SSType3":"SSType4"}else if(this.data.ChildLeft+this.data.ChildWidth>this.data.ParentLeft+this.data.ParentWidth){if("FF"==this.data.Type)return"FFType4";if("SF"==this.data.Type)return"SFType4";if("SS"==this.data.Type)return this.data.ChildLeft<=this.data.ParentLeft?"SSType3":"SSType4"}if("FS"==this.data.Type)return"FSType3"}else if(this.data.ParentLeft<this.data.ChildLeft){if("FS"==this.data.Type)return"FSType3";if("SS"==this.data.Type)return"SSType4";if("FF"==this.data.Type)return"FFType4";if("SF"==this.data.Type)return"SFType4"}return!1},_getWidth:function(){return this.data.ChildLeft+this.data.ChildWidth<this.data.ParentLeft+this.data.ParentWidth?this.data.ParentWidth:this.data.ChildWidth+this.data.ParentWidth},_renderCustomDaySchedule:function(){var e,i,a,r,n,o=this,l=o.model,d=0,s=this.getRecordsHeight(),c=o.model.scheduleDays.length,u=0!=o._$weekendsContainer.children(".e-secondary_canvas").length,p=u?o._$weekendsContainer.children(".e-secondary_canvas"):t.buildTag("div.e-secondary_canvas","",{height:s+"px"},{}),h=l._nonWorkingTimeRange,g=o._nonWorkingDayIndex;for(u&&p.empty(),a=0;a<c;a++){if(l.highlightWeekends){for(i=!1,r=0;r<=g.length;r++)o.model.scheduleDays[a].getDay()==g[r]&&(f=o.model.perDayWidth,e=t.buildTag("div.e-ganttworkingtime e-ganttdayweekend","",{left:d+"px",width:f+"px",background:this.model.weekendBackground,height:s+"px"},{}),p.append(e),d+=f,i=!0);if(i)continue}for(n=0;n<h.length;n++){var m=h[n].isWorking?h[n].color:l.highlightNonWorkingTime?l.nonWorkingBackground:null,_=h[n].isWorking?"e-ganttworkingrange":l.highlightNonWorkingTime?"e-ganttnonworkingrange":"",f=(h[n].to/3600-h[n].from/3600)*l.perHourWidth;e=t.buildTag("div.e-ganttworkingtime "+_,"",{left:d+"px",width:f+"px",background:m,height:s+"px"},{}),t.isNullOrUndefined(m)||p.append(e),d+=f}}u?o._$weekendsContainer.append(p):(o._$weekendsContainer.html(p),o._$bodyContent.append(o._$weekendsContainer))},_renderWeekends:function(){for(var e,i,a,r,n=this,o=n.model,l=0,d=n.model.perDayWidth+1,s=this.getRecordsHeight(),c=n.model.scheduleWeeks.length,u=t.buildTag("div.e-secondary_canvas","",{height:s+"px"},{}),p=o.scheduleHeaderSettings.weekStartDay,h=p>=0&&p<7?p:0,g=6-h,m=n._nonWorkingDayIndex.length,_=0;_<c;_++){for(i=0;i<m;i++)6!=n._nonWorkingDayIndex[i]?e=(a=g+n._nonWorkingDayIndex[i]+1)>=7?n._nonWorkingDayIndex[i]-h:a:e=g,r=t.buildTag("div.e-weekends","",{left:l+n.model.perDayWidth*e+"px",width:d+"px",height:s+"px","background-color":this.model.weekendBackground},{}),u.append(r);l+=this._scheduleWeekWidth}n._$weekendsContainer.html(u),n._$bodyContent.append(n._$weekendsContainer)},_renderStripLines:function(e){for(var i,a,r,n=this,o=this.getRecordsHeight(),l=e.length,d=n.model.projectStartDate,s=this.model.perDayWidth,c=t.buildTag("div.e-stripLines","",{height:o+"px"},{}),u=0;u<l;u++)r=(this._getDateFromFormat(e[u].day)-this._getDateFromFormat(d))/864e5*s,e[u].lineWidth=e[u].lineWidth>30?30:e[u].lineWidth,i=t.buildTag("div.e-stripline#stripline"+[u],"",{left:r+"px",width:"1px",height:o+"px","border-left-width":e[u].lineWidth+"px","border-left-color":e[u].lineColor,"border-left-style":e[u].lineStyle},{}),a=t.buildTag("span.e-striplinespan",e[u].label,{"background-color":e[u].lineColor},{}),e[u].day&&e[u].day.length>0&&(e[u].label&&e[u].label.length>0&&i.append(a),c.append(i));n._$stripLineContainer.append(c),n._$bodyContent.append(n._$stripLineContainer)},_getProgressWidth:function(e,t){return e*t/100},_getProgressPercent:function(e,t){return Math.ceil((t/e*100).toFixed(2))},_renderHoliday:function(e){var i,a,r,n,o,l,d,s=this,c=(s.model.scheduleHeaderSettings.scheduleHeaderType,this._getDateFromFormat(e.day));s.model.scheduleWeeks.length,s.model.scheduleMonths.length,s.model.scheduleYears.length,s.model.scheduleDays.length,s.model.updatedRecords.length;i=(c-this._getDateFromFormat(s.model.projectStartDate))/864e5*this.model.perDayWidth,l=this.getRecordsHeight(),a=null!=e.label?e.label.length:0,null==e.background&&(e.background="white"),d=".e-holiday-label","msie"==t.browserInfo().name&&t.browserInfo().version<9&&(d=".e-holiday-label-ie8"),r="day"!=s.model.scheduleHeaderSettings.scheduleHeaderType?t.buildTag("div"+d,e.label,{top:s._getHolidayLabelHeight(a)+"px"},{}):t.buildTag("div"+d,e.label,{bottom:s._getHolidayLabelHeight(a)+"px"},{}),n=t.buildTag("div.e-secondary-canvas-holiday"),o=t.buildTag("div.e-holidays","",{left:i+"px",width:s.model.perDayWidth+"px",height:l+"px",background:e.background},{}),null!=e.label&&o.append(r),n.append(o),s._$secondaryCanvas.append(n),s._$bodyContent.append(s._$secondaryCanvas)},_getHolidayLabelHeight:function(){var e=this,t=e.model,i=e._getHeight(),a=t.updatedRecords.length*e.model.rowHeight;return i>0?i/2:e._viewportHeight<a?e._viewportHeight/2:a/2},updateWorkWeek:function(e){this.model.workWeek=e,this._getNonWorkingDayIndex()},updateDragAndDrop:function(e){this.model.allowDragAndDrop=e},updateVirtualization:function(t,i){var a,r=this,n=this.model,o=this.model.ganttInstance;n.enableVirtualization=t,r.setUpdatedRecords(o.model.currentViewData,o.model.updatedRecords,o.model.flatRecords,o.model.ids),r._totalCollapsedRecordCount=i,n.enableVirtualization?n.enableVirtualization&&0!=r._scrollTop&&(r._getVisibleRowRange(),a=r._scrollTop,a-=r._rowMargin,e("#ganttViewTable"+r._id).css({top:a+"px"}),e("#ganttgridLinesTable"+r._id).css({top:a+"px"})):(r._$ganttViewTable.css({top:0}),e("#ganttgridLinesTable"+r._id).css({top:0})),n.selectedRowIndex=o.selectedRowIndex(),r.refreshHelper(n.currentViewData,n.updatedRecords,r._totalCollapsedRecordCount)},_getNonWorkingDayIndex:function(){for(var e=this,t=e.model,i=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],a=i.length,r=t.workWeek.slice(),n=r.length,o=0;o<n;o++)r[o]=r[o].toLowerCase();for(e._nonWorkingDayIndex=[],o=0;o<a;o++)-1==r.indexOf(i[o])&&e._nonWorkingDayIndex.push(o)},_destroy:function(){var t=this;t.element.off(),e(document.body).unbind("touchmove",e.proxy(t.handleMouseMove,t)),e(document).unbind("mouseup",e.proxy(t._tooltipMouseup,t)),t.element.empty().removeClass("e-ganttchart-core e-ganttchart"+t.model.cssClass),e("#"+this._id+"_connectorLineEdit_wrapper").clearQueue(),e("#"+this._id+"_connectorLineEdit_wrapper").stop(),e("#"+t._id+"_connectorLineEdit").data("ejDialog")&&e("#"+t._id+"_connectorLineEdit").data("ejDialog").destroy(),e("#"+t._id+"_connectorLineEdit").remove(),e("#"+this._id+"_connectorLineEdit_wrapper").remove(),e("#"+this._id+"_connectorLineEdit_type_popup_wrapper").remove()},_renderConnectorDialog:function(i){var a,r,n,o,l,d,s,c,u,p,h=this,g={},m=h.model.connectorLineDialogText,_=t.buildTag("div.e-connectordialog","",{width:"300px"},{id:this._id+"_connectorLineEdit"}),f=t.buildTag("div","",{},{id:this._id+"_connectorLineEditForm"}),w=t.buildTag("table.e-zerospace","",{}),C=t.buildTag("tbody","",{});w.append(C),n=t.buildTag("tr","",{}),C.append(n),n.append("<td class='e-editlabel'><div>"+m.from+"</div></td>"),n.append("<td class='e-editlabel'>:</td>"),n.append("<td class='e-editvalue' ><div id='"+this._id+"_connectorLineEdit_from'></div></td>"),o=t.buildTag("tr","",{}),C.append(o),o.append("<td class='e-editlabel'><div>"+m.to+"</div></td>"),o.append("<td class='e-editlabel'>:</td>"),o.append("<td class='e-editvalue'><div id='"+this._id+"_connectorLineEdit_to'></div></td>"),l=t.buildTag("tr","",{}),C.append(l),l.append("<td class='e-editlabel'><div>"+m.type+"</div></td>"),l.append("<td class='e-editlabel'>:</td>"),l.append("<td class='e-editvalue'><input id='"+this._id+"_connectorLineEdit_type'/></td>"),d=t.buildTag("tr","",{}),C.append(d),d.append("<td class='e-editlabel'><div>"+m.lag+"</div></td>"),d.append("<td class='e-editlabel'>:</td>"),d.append("<td class='e-editvalue'><input class='e-field e-ejinputtext' id='"+this._id+"_connectorLineEdit_lag'/></td>"),f.append(w);var T=t.buildTag("input.e-editform-btn","",{},{type:"button",value:m.okButtonText,id:this._id+"_connectorLineEdit_ok"}),x=t.buildTag("input.e-editform-btn","",{"margin-left":"15px"},{type:"button",value:m.cancelButtonText,id:this._id+"_connectorLineEdit_cancel"}),v=t.buildTag("button","",{"border-radius":"3px"},{title:m.deleteButtonText,id:this._id+"_connectorLineEdit_delete"}),b=t.buildTag("table","",{width:"100%"}),S=t.buildTag("tbody");b.append(S),s=t.buildTag("div","",{float:"right","z-index":"10","margin-top":"10px"}),c=t.buildTag("div","",{float:"left","z-index":"10","margin-top":"10px"}),s.append(T),c.append(v),s.append(x),s.appendTo(S),c.appendTo(S),f.append(b),_.append(f),g.requestType="beforeDependencyEditDialogOpen",g.data=h._predecessorInfo,h._trigger("actionBegin",g)?h._clearConnectorLineSelection():(_.insertAfter(h.element),h._renderConnectorDialogElements(_,g.data),i.pageX&&i.pageY&&(a=i.pageX,r=i.pageY),u=m.title,(p={}).enableResize=!1,p.enableRTL=!1,p.maxWidth=300,p.width=300,p.title=u,p.position={X:a,Y:r},p.enableAnimation=!1,p.cssClass=h.model.cssClass,p.beforeOpen=function(){var t=e("#"+h._id+"_connectorLineEdit_wrapper"),i={};t.addClass("e-ganttdialog"),i.x=a,i.y=r,h._calculateConnectorDialogPosition(this,t,i)},p.beforeClose=function(){h._clearConnectorLineSelection()},_.ejDialog(p),h._isPredecessorEditOpen=!0,g.requestType="afterDependencyEditDialogOpen",g.element=_,h._trigger("actionBegin",g)||(e(_).ejDialog("refresh"),_=g.element))},_calculateConnectorDialogPosition:function(t,i,a){var r,n,o=this,l=o.model.ganttInstance,d={};(d=o._getOffsetRect(l.element[0])).bottom=d.top+l.element[0].offsetHeight,d.right=d.left+e(l.element).width(),r=e(i).outerHeight(),n=e(i).outerWidth(),o._getOffsetRect(i[0]);var s=a.x,c=a.y,u=c+r,p=s+n;d.right<p?s-n>d.left?s-=n:s-=Math.abs(p-d.right):e(window).width()+e(window).scrollLeft()<p&&(s-=Math.abs(p-(e(window).width()+e(window).scrollLeft()))),d.bottom<u?c-r>d.top?c-=r:c-=Math.abs(u-d.bottom):e(window).height()+e(window).scrollTop()<u&&(c-=Math.abs(u-(e(window).height()+e(window).scrollTop()))),t.setModel({position:{X:s,Y:c}})},_renderConnectorDialogElements:function(i,a){var r=this,n=r.model.predecessorCollectionText;e(i).find("#"+this._id+"_connectorLineEdit_delete").ejButton({size:"normal",contentType:"imageonly",prefixIcon:"e-icon e-deleteline",cssClass:r.model.cssClass,click:function(){a.requestType="delete",r._predecessorEdited(a),r.closePredecessorDialog()}}),e(i).find("#"+this._id+"_connectorLineEdit_ok").ejButton({size:"normal",cssClass:r.model.cssClass,click:function(){var t=e("#"+r._id+"_connectorLineEdit_lag").val();a.offset=t,a.requestType="updateDependencyValue",r._predecessorEdited(a),r.closePredecessorDialog()}}),e(i).find("#"+this._id+"_connectorLineEdit_cancel").ejButton({size:"normal",cssClass:r.model.cssClass,click:function(){r.closePredecessorDialog()}}),e(i).find("#"+this._id+"_connectorLineEdit_type").ejDropDownList({dataSource:n,fields:{text:"text",value:"id"},value:a.linkType,cssClass:r.model.cssClass,change:function(e){a.linkType=e.value,a.linkText=e.text},width:"100%"});var o=r._getOffsetValue(a),l=t.isNullOrUndefined(a.fromSno)?a.fromId:a.fromSno,d=t.isNullOrUndefined(a.toSno)?a.toId:a.toSno,s=a.fromName,c=(c=s.length>25?s.substring(0,20)+"...":s)+" ("+l+")",u=a.toName,p=(p=u.length>25?u.substring(0,20)+"...":u)+" ("+d+")";e(i).find("#"+this._id+"_connectorLineEdit_lag").css("width","50%").val(o),e(i).find("#"+this._id+"_connectorLineEdit_from").text(c),e(i).find("#"+this._id+"_connectorLineEdit_from").attr({title:s}),e(i).find("#"+this._id+"_connectorLineEdit_to").text(p),e(i).find("#"+this._id+"_connectorLineEdit_to").attr({title:u})},closePredecessorDialog:function(){var t=this;e("#"+t._id+"_connectorLineEdit").ejDialog("close"),t._isPredecessorEditOpen=!1,t._clearConnectorLineSelection()},_predecessorEdited:function(e){"delete"==e.requestType?this.model.ganttInstance.deleteDependency(e.fromId,e.toId):"updateDependencyValue"==e.requestType&&this.model.ganttInstance.updateDependency(e.fromId,e.toId,e.linkType,e.offset)},_clearConnectorLineSelection:function(){var t=this;e(t._hoverConnectorLineElement).find(".e-line").removeClass("e-connectorline-hover"),e(t._hoverConnectorLineElement).find(".e-connectorline-rightarrow").length>0?e(t._hoverConnectorLineElement).find(".e-connectorline-rightarrow").removeClass("e-connectorline-rightarrow-hover"):e(t._hoverConnectorLineElement).find(".e-connectorline-leftarrow").removeClass("e-connectorline-leftarrow-hover")}}),t.ganttChartFeatures.timescale&&e.extend(t.GanttChart.prototype,t.ganttChartFeatures.timescale),t.ganttChartFeatures.resourceViewGantt&&e.extend(t.GanttChart.prototype,t.ganttChartFeatures.resourceViewGantt),jQuery.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}}}(jQuery,Syncfusion),function(e,t){t.gridFeatures=t.gridFeatures||{},t.gridFeatures.gridResize=function(t){this.$headerTable=t.getHeaderTable(),this.gridInstance=t,this._colMinWidth=15,this._$visualElement=e(),this._currentCell=-1,this._allowStart=!1,this._oldWidth=null,this._orgX=null,this._orgY=null,this._extra=null,this._expand=!1,this._target=null,this._cellIndex=-1},t.gridFeatures.gridResize.prototype={_mouseHover:function(t){var i,a,r,n,o;if(!this._$visualElement.is(":visible")&&(this._allowStart=!1,e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),i=e(t.target),e(t.target).hasClass("e-filtericon")&&("col-resize"==e(t.target).css("cursor")||"col-resize"==e(t.target).closest("tr").css("cursor"))&&(e(t.target).css("cursor","pointer"),e(t.target).closest("tr").css("cursor","pointer")),i.hasClass("e-headercell"))){var l=t.target,d=l.getBoundingClientRect(),s=0,c=0;(t.type="mousemove")?(s=t.clientX,c=t.clientY):(t.type="touchmove")?(s=evt.originalEvent.changedTouches[0].clientX,c=evt.originalEvent.changedTouches[0].clientY):(t.type="MSPointerMove")&&(s=t.originalEvent.clientX,c=t.originalEvent.clientY),a=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left,(s>=d.left+document.documentElement.scrollLeft+l.offsetWidth-5||s<=d.left+3)&&s<a&&s>=d.left&&c<=d.top+document.documentElement.scrollTop+t.target.offsetHeight?(r=s>d.left+3?e(t.target).find(".e-headercelldiv"):e(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),n=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,o=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-n,(this.gridInstance.model.enableRTL&&s<=o||!this.gridInstance.model.enableRTL&&s>=o)&&((this.gridInstance.model.showStackedHeader||r.length)&&-1==e.inArray(e(r).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)?(this.gridInstance.model.showStackedHeader&&e(i.parents("thead")).find("tr").addClass("e-resizedragicon"),this.gridInstance.model.showStackedHeader||i.parent().addClass("e-resizedragicon"),this._currentCell=e(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(l):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(l),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):(i.parent().css("cursor","pointer"),this._currentCell=-1))):(this.gridInstance.element.find(".e-columnheader").removeClass("e-resizedragicon"),this._currentCell=-1)}},_start:function(t,i){var a,r,n,o,l,d,s,c=this.gridInstance.getHeaderTable().find(".e-columnheader");if(r=e(this._target).hasClass("e-stackedHeaderCell")?c.find(".e-headercell").not(".e-hide"):c.find(".e-headercell").not(".e-stackedHeaderCell,.e-hide"),-1!=this._currentCell&&this._currentCell<r.length&&(n=r[this._currentCell]),void 0!==n)if(o=n.getBoundingClientRect(),a=this._tableY=o.top+parseInt(-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart){if(l=this._$visualElement=e(document.createElement("div")),d=this.gridInstance.element.find(".e-gridcontent").first().height()+this.gridInstance.element.find(".e-gridheader").height(),this.gridInstance.model.showStackedHeader&&this.gridInstance.model.stackedHeaderRows.length>0){var u=this.gridInstance.getHeaderTable().find("tr.e-columnheader"),p=(u.length,e(this._target).parent("tr")[0].rowIndex);for(s=0;s<p;s++)d-=e(u[s]).height()}l.addClass("e-reSizeColbg").appendTo(this.gridInstance.element).attr("unselectable","on").css("visibility","hidden"),this.gridInstance._resizeTimeOut=setTimeout(function(){l.css({visibility:"visible",height:d+"px",cursor:"col-resize",left:t,top:a,position:"fixed"})},100),this._oldWidth=n.offsetWidth,this._orgX=t,this._orgY=i,this._extra=t-this._orgX,this._expand=!0}else this._currentCell=-1},_mouseMove:function(e){if(this._expand){var t=0,i=0;"mousemove"==e.type?(t=e.clientX,i=e.clientY):"MSPointerMove"==e.type?(t=e.originalEvent.clientX,i=e.originalEvent.clientY):"touchmove"==e.type&&(t=e.originalEvent.changedTouches[0].clientX,i=e.originalEvent.changedTouches[0].clientY),0==t&&0==i&&-1!=navigator.userAgent.indexOf("WebKit")&&(t=e.pageX,i=e.pageY),t+=document.documentElement.scrollLeft,e.preventDefault(),this._moveVisual(t)}else this._mouseHover(e)},_touchStart:function(t){var i,a,r,n,o,l;if(!this._$visualElement.is(":visible")){if(this._allowStart=!1,e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),(i=e(t.target)).hasClass("e-headercell")){var d=t.target,s=d.getBoundingClientRect(),c=0,u=0;"touchstart"==t.type&&(c=t.originalEvent.changedTouches[0].clientX,u=t.originalEvent.changedTouches[0].clientY),a=this.gridInstance.element.children(".e-gridheader"),r=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+a.find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+a.find(".e-columnheader").offset().left,(c>=s.left+document.documentElement.scrollLeft+d.offsetWidth-10||c<=s.left+8)&&c<r&&c>=s.left&&u<=s.top+document.documentElement.scrollTop+t.target.offsetHeight?(n=c>s.left+8?e(t.target).find(".e-headercelldiv"):e(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),o=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,l=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-o,(this.gridInstance.model.enableRTL&&c<=l||!this.gridInstance.model.enableRTL&&c>=l)&&((this.gridInstance.model.showStackedHeader||n.length)&&-1==e.inArray(e(n).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)?(this._currentCell=e(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(d):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(d),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):this._currentCell=-1)):this._currentCell=-1}if(this._allowStart){if(this._target=i,"ejGrid"==this.gridInstance.pluginName&&this.gridInstance.model.allowResizing){if(this._triggerResizeEvents("resizeStart",c))return}else if("ejTreeGrid"==this.gridInstance.pluginName&&this.gridInstance.model.allowColumnResize&&this.gridInstance._triggerColumnResize("columnResizeStart",c,t))return;return this,c+=document.documentElement.scrollLeft,2!=t.button&&this._start(c,u),!1}return!0}},_getCellIndex:function(t){e(t._target);var i,a,r=t._target,n=r.getBoundingClientRect(),o=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft;return this._orgX<n.left+5+o&&(r=e(r).prevAll(":visible:first")[0]),a=i=r.cellIndex,t.gridInstance.model.groupSettings.groupedColumns.length&&(a=i-t.gridInstance.model.groupSettings.groupedColumns.length),a},_reSize:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f,w,C;if(this._initialTableWidth=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderTable().first().parent().width()+this.gridInstance.getHeaderTable().last().parent().width():this.gridInstance.getHeaderTable().parent().width(),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell=this._currentCell-1:this.gridInstance.model.enableRTL||this._getResizableCell(),r=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.getHeaderTable().find("thead"):e(this._target).parents("thead"),-1!=this._currentCell&&this._expand){this._expand=!1;var T=(e(this._target).hasClass("e-stackedHeaderCell")?r.find(".e-headercell:not(.e-detailheadercell)").filter(":visible"):r.find(".e-headercell:not(.e-detailheadercell,.e-stackedHeaderCell)").filter(":visible"))[this._currentCell],x=T.offsetWidth,v=i-this._orgX;if(this.gridInstance.model.enableRTL&&(v=-v),parseInt(v)+parseInt(x)>this._colMinWidth){if(0!=v&&r.css("cursor","default"),"nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&(n=this.gridInstance.getHeaderTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),n=this.gridInstance._$headerCols),o=n.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),l=parseInt(o[0].style.width)),this._resizeColumnUsingDiff(x,v),d=(a=this.gridInstance.element.find(".e-gridcontent").first()).find("div").hasClass("e-content"),(s=!t.isIOSWebView()&&this.gridInstance.getBrowserDetails())&&"msie"==s.browser&&this.gridInstance.model.allowScrolling&&(c=this.gridInstance.getContentTable().width(),u=this.gridInstance._calculateWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterTable().last().width(u-this.gridInstance.getFooterContent().find(".e-frozenfootertdiv").width()):u>c&&this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().width(u),parseInt(s.version,10)>8&&this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length&&(u>c?this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",2e3/a.find("table").first().width()+"%"):(this.gridInstance.getContentTable().css("width","100%"),this.gridInstance._groupingAction(!0),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",(this.gridInstance.getHeaderTable().find("colgroup").find("col").first().width()/a.find("table").first().width()*100).toFixed(2)+"%"))),this.gridInstance.getHeaderTable().parent().scrollLeft(a.find(".e-content").scrollLeft()-1)),this.gridInstance._colgroupRefresh(),this.gridInstance.model.allowTextWrap&&(this.gridInstance._isResized=!0,this.gridInstance.rowHeightRefresh()),this.gridInstance.model.groupSettings.groupedColumns.length&&!this.gridInstance.model.isEdit&&this.gridInstance._recalculateIndentWidth(),"normal"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model))if("nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)){p=this.gridInstance.getHeaderTable().find("colgroup").find("col"),h=this.gridInstance.getContentTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),p=this.gridInstance._$headerCols,h=this.gridInstance._$contentCols);var b,S=this._currentCell+1,D=p.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?S+this.gridInstance.model.groupSettings.groupedColumns.length:S);if((L=parseInt(D[0].style.width)+(l-parseInt(o[0].style.width)))<this._colMinWidth&&(L=this._colMinWidth),D.width(L),this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var R=this.gridInstance.getContentTable().find(".e-recordtable"),y=R.find("colgroup"),I=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(y=y.not(R.find(".e-detailrow").find("colgroup")).get()),w=0;w<y.length;w++)(g=e(y[w]).find("col").filter(this._diaplayFinder)).length>I&&g.splice(0,g.length-I),e(g[S]).width(L)}if(this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(S>=0&&S<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+v>this.gridInstance.element.find(".e-headercontent").first().width())return;b=h.filter(this._diaplayFinder).eq(S)}else b=h.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?S+this.gridInstance.model.groupSettings.groupedColumns.length:S);if(b.width(L),this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings.frozenColumns>0&&e(T).is(":last-child")&&"ejGrid"==this.gridInstance.pluginName){var k=o.width()-l,M=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+k,E=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-k,H=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+k;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(M),this.gridInstance.getContent().find(".e-frozencontentdiv").width(M),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(M),this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(E),this.gridInstance.getContent().find(".e-movablecontentdiv").width(E),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooterdiv").width(E),this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",H),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",H),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",H)}if(this.gridInstance.model.scrollSettings.frozenColumns>0&&e(T).is(":last-child")&&"ejTreeGrid"==this.gridInstance.pluginName){k=o.width()-l,M=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+k,E=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-k,H=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+k;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(M),this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",H),this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(E),this.gridInstance.getContent().find(".e-frozencontainer").width(M).next().css("margin-left",H+"px"),this.gridInstance.getContent().find(".e-movablecontent").width(E),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(M),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",H+"px")),this.gridInstance._renderScroller(!0)}this.gridInstance.model.scrollSettings.frozenColumns>0&&e(this._target).parent("tr").parents("div:first").hasClass("e-frozenheaderdiv")&&"ejGrid"==this.gridInstance.pluginName&&(this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(this._newWidth),this.gridInstance.getContent().find(".e-frozencontentdiv").width(this._newWidth),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(this._newWidth))}else this.gridInstance.model.scrollSettings.frozenColumns||(m=this.gridInstance.getHeaderTable().width(),"ejTreeGrid"==this.gridInstance.pluginName||this.gridInstance.model.allowScrolling||this.gridInstance.model.isResponsive?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().css("width",m+parseInt(v)):e("#"+this.gridInstance._id).css("width",m+parseInt(v)),this.gridInstance.model.scrollSettings.width+=parseInt(v),this.gridInstance.getContent().width()>this.gridInstance.getContentTable().width()?(this.gridInstance.getContentTable().addClass("e-tableLastCell"),this.gridInstance.getHeaderTable().addClass("e-tableLastCell")):(this.gridInstance.getContentTable().removeClass("e-tableLastCell"),this.gridInstance.getHeaderTable().removeClass("e-tableLastCell")));if("msie"==s.browser||!s||!this.gridInstance.model.allowScrolling||0!=this.gridInstance.model.scrollSettings.frozenColumns||("fixed"!=this.gridInstance.model.columnLayout&&(this.gridInstance.getHeaderTable().width("100%"),this.gridInstance.getContentTable().width("100%")),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width("100%"),((_=this.gridInstance._calculateWidth())<=this.gridInstance.getContentTable().width()||this.gridInstance.getHeaderTable().width()>this.gridInstance.getContentTable().width())&&this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width(_)),this.gridInstance.model.allowResizing&&"default"==this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")){var P=this._currentCell,F=e(this._target),O=[],G=[],L=x+v,N={};if(this.gridInstance.model.showStackedHeader&&F.hasClass("e-stackedHeaderCell")){var W,A=F.parent(".e-stackedHeaderRow").index(),z=F.text(),j=this.gridInstance.model.stackedHeaderRows[A].stackedHeaderColumns;for(w=0;w<j.length;w++)j[w].headerText==z&&(W=j[w].column);for(f=W|[],t.isNullOrUndefined(W)||W instanceof Array||(f=W.split(",")),w=0;w<f.length;w++)C=this.gridInstance.getColumnIndexByField(f[w]),O.push(C),G.push(this.gridInstance.model.columns[C]);N={columnIndex:O,column:G,oldWidth:x,newWidth:L}}else N={columnIndex:P,column:this.gridInstance.model.columns[P],oldWidth:x,newWidth:L};this.gridInstance._trigger("resized",N)}this.gridInstance.model.allowScrolling&&(this.gridInstance.getScrollObject().refresh(this.gridInstance.model.scrollSettings.frozenColumns>0),this.gridInstance.model.isResponsive&&this.gridInstance.model.minWidth&&this.gridInstance.windowonresize(),!d&&a.find("div").hasClass("e-content")&&this.gridInstance.refreshScrollerEvent(),this.gridInstance._isHscrollcss())}}this._target=null,this._$visualElement.remove(),this._expand=!1,this._currentCell=-1,this._allowStart=!1},_getFrozenResizeWidth:function(){for(var e=this.gridInstance.getHeaderTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),t=0,i=0;i<e.length;i++)"none"!=e.eq(i).css("display")&&(t+=parseInt(e[i].style.width.replace("px","")));return t},_diaplayFinder:function(){return"none"!=e(this).css("display")},_resizeColumnUsingDiff:function(i,a){var r,n,o,l,d,s,c,u,p,h,g,m,_,f,w;this._currntCe=this._currentCell,this._widthchanges(i,a);var C,T,x=this._newWidth,v=this._extra,b=this._$headerCols,S=this._$ContentCols,D=this._$headerCol;this._$frozenCols;if(("ejTreeGrid"!=this.gridInstance.pluginName||!(a>0)||t.isNullOrUndefined(this.gridInstance._currentCell)||1!=this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen||!((w=this.gridInstance._frozenWidth())>this.gridInstance._gridWidth-68))&&x>0&&0!=a){if(x<this._colMinWidth&&(x=this._colMinWidth),"nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&(r=D.next(),(n=!(!this.gridInstance.model.scrollSettings.frozenColumns||this._currentCell!=this.gridInstance.model.scrollSettings.frozenColumns-1))&&(r=b.eq(this.gridInstance.model.scrollSettings.frozenColumns)),(n||!D.is(":last-child"))&&r.width()+(D.width()-x)<=this._colMinWidth&&(x=D.width()+(r.width()-this._colMinWidth))),a=x-i,this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(this._currentCell>=0&&this._currentCell<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+a>this.gridInstance.element.find(".e-headercontent").first().width())return;C=S.filter(this._diaplayFinder).eq(this._currentCell)}else C=S.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell);if(e(this._target).parent("tr").hasClass("e-stackedHeaderRow")?this._resizeStackedHeaderColumn(e(this._target).parent("tr"),v,this._currntCe):D.outerWidth(x),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable()))if(this._$footerCols=this.gridInstance.getFooterTable().find("colgroup").find("col"),k=this.gridInstance.model.columns.length,this._$footerCols.length>k&&this._$footerCols.splice(0,this._$footerCols.length-k),T=(o=this._$footerCols).filter(this._diaplayFinder).eq(this._currentCell),e(this._target).parent("tr").hasClass("e-stackedHeaderRow"))for(u=0;u<this._changedcell.length;u++)T=o.filter(this._diaplayFinder).eq(u),(w=parseInt(v)+parseInt(o[u].style.width))<this._colMinWidth&&(w=this._colMinWidth),T.outerWidth(w);else T.outerWidth(x);if(e(this._target).parent("tr").hasClass("e-stackedHeaderRow")){if(this.gridInstance.model.groupSettings.groupedColumns.length)for(y=(R=this.gridInstance.getContentTable().find(".e-recordtable")).find("colgroup"),u=0;u<this._changedcell.length;u++)for(I=this._changedcell[u],l=0;l<y.length;l++)d=e(y[l]).children().filter(this._diaplayFinder),(w=parseInt(v)+parseInt(d[I].style.width))<this._colMinWidth&&(w=this._colMinWidth),e(d[I]).width(w);for(this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).length,u=0;u<this._changedcell.length;u++)s=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder)[this._changedcell[u]],(w=parseInt(v)+parseInt(s.style.width))<this._colMinWidth&&(w=this._colMinWidth),e(s).outerWidth(w),this.gridInstance.model.isEdit&&this.gridInstance.model.allowGrouping&&0==this.gridInstance.model.groupSettings.groupedColumns.length&&(c=this.gridInstance.getContentTable().find(".gridform").find("colgroup col").filter(this._diaplayFinder)[this._changedcell[u]],e(c).outerWidth(w))}else{if(this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var R,y=(R=this.gridInstance.getContentTable().find(".e-recordtable")).find("colgroup"),I=this._currentCell,k=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(y=y.not(R.find(".e-detailrow").find("colgroup")).get()),u=0;u<y.length;u++)(p=e(y[u]).find("col").filter(this._diaplayFinder)).length>k&&p.splice(0,p.length-k),e(p[I]).width(x)}C.outerWidth(x),this.gridInstance.model.isEdit&&(g=(h=this.gridInstance.getContentTable().find(".e-editedrow,.e-addedrow")).find("table").find("colgroup col"),m=h.hasClass("e-addedrow")&&this.gridInstance.model.groupSettings.groupedColumns.length?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length-1:this._currentCell,g.filter(this._diaplayFinder).eq(m).outerWidth(x))}if(this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns&&"nextcolumn"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&"ejGrid"==this.gridInstance.pluginName){for(_=this.gridInstance.getContentTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings.frozenColumns),w=0,u=0;u<_.length;u++)w+="none"==_[u].style.display?0:parseInt(_[u].style.width.replace("px",""));this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w),f=this.gridInstance.model.enableRTL?"margin-right":"margin-left",this.gridInstance.getContent().find(".e-frozencontentdiv").width(w).next().css(f,w+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w).next().css(f,w+"px"),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(w)}"ejTreeGrid"==this.gridInstance.pluginName&&(!t.isNullOrUndefined(this.gridInstance._currentCell)&&1==this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen&&"nextcolumn"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model)||!this.gridInstance._isFrozenStackedResize&&this.gridInstance._isStackedResize&&this.gridInstance._frozenColumnsLength>0)&&(w=this.gridInstance._frozenWidth(),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w),this.gridInstance.getContent().find(".e-frozencontainer").width(w).next().css("margin-left",w+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w).next().css("margin-left",w+"px"),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(w),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",w+"px")),this.gridInstance._findColumnsWidth(),this.gridInstance._renderScroller(!0)),this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor","default")}},_resizeStackedHeaderColumn:function(t,i,a){var r,n,o,l,d;this._changedcell=[];var s=0,c=0,u=this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell")[a],p=e(u).attr("colspan"),h=e(u).parent("tr"),g=(h.next(),u.cellIndex);for(this.gridInstance.model.groupSettings.showGroupedColumn&&(s+=c=this.gridInstance.model.groupSettings.groupedColumns.length);g>c;)g--,r=e(h).children("th").not(".e-detailheadercell")[g],s+=parseInt(e(r).attr("colspan"));for(this._currentCell=s,n=s+parseInt(p),o=s;o<n;o++)l=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder)[o],this._changedcell.push(o-c),(d=parseInt(i)+parseInt(l.style.width))<this._colMinWidth&&(d=this._colMinWidth),e(l).outerWidth(d)},_triggerResizeEvents:function(i,a){var r,n,o,l,d,s,c,u,p=this.gridInstance.getHeaderTable().find(".e-columnheader"),h=p.find(".e-headercell").filter(":visible"),g=this._cellIndex,m=e(this._target),_=[],f=[];if("resizeStart"==i&&(this._orgX=a,g=this._cellIndex=this._getCellIndex(this,a)),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?r=this._currentCell-1:(this.gridInstance.model.enableRTL||this._getResizableCell(),r=this._currentCell),o=(n=h[r]).offsetWidth,this.gridInstance.model.showStackedHeader&&m.hasClass("e-stackedHeaderCell")){var w,C=m.parent(".e-stackedHeaderRow").index(),T=m.text(),x=this.gridInstance.model.stackedHeaderRows[C].stackedHeaderColumns;for(d=0;d<x.length;d++)x[d].headerText==T&&(w=x[d].column);for(l=w|[],t.isNullOrUndefined(w)||w instanceof Array||(l=w.split(",")),d=0;d<l.length;d++)s=this.gridInstance.getColumnIndexByField(l[d]),_.push(s),f.push(this.gridInstance.model.columns[s])}return"resizeStart"==i?(u={},u=this.gridInstance.model.showStackedHeader&&m.hasClass("e-stackedHeaderCell")?{columnIndex:_,column:f,target:m,oldWidth:o}:{columnIndex:g,column:this.gridInstance.model.columns[g],target:e(n),oldWidth:o},this.gridInstance._trigger("resizeStart",u)):(p.find(".e-headercell").not(".e-detailheadercell").filter(":visible"),c=a-this._orgX,this._widthchanges(o,c),this.gridInstance._colgroupRefresh(),u={},u=this.gridInstance.model.showStackedHeader&&m.hasClass("e-stackedHeaderCell")?{columnIndex:_,column:f,target:e(n),oldWidth:o,newWidth:this._newWidth,extra:c}:{columnIndex:g,column:this.gridInstance.model.columns[g],target:e(n),oldWidth:o,newWidth:this._newWidth,extra:c},this.gridInstance._trigger("resizeEnd",u))},_widthchanges:function(i,a){var r=this._$headerCols=this.gridInstance.getHeaderTable().find("colgroup").find("col");this._$ContentCols=this.gridInstance.getContentTable().find("colgroup").find("col");t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),r=this._$headerCols=this.gridInstance._$headerCols,this._$ContentCols=this.gridInstance._$contentCols);var n=this._$headerCol=r.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),o=(this._$frozenCols=r.slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),n[0].style.width),l=-1!=o.indexOf("%"),d=!o||l?e(this._target).outerWidth():o,s=l?1:i/parseInt(d);this._extra=a/s,this._newWidth=parseInt(a)+parseInt(d)},_mouseUp:function(e){var i,a;if(this.gridInstance._resizeTimeOut&&(clearTimeout(this.gridInstance._resizeTimeOut),this.gridInstance._resizeTimeOut=0),this._expand){if(i=e.clientX,a=e.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(i=e.pageX,a=e.pageY),"touchend"==e.type&&(i=e.originalEvent.changedTouches[0].clientX,a=e.originalEvent.changedTouches[0].clientY),this.gridInstance.model.allowResizing&&(this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||"touchend"==e.type)&&this._triggerResizeEvents("resizeEnd",i))return void this.gridInstance.element.find(".e-reSizeColbg").remove();if(i+=document.documentElement.scrollLeft,this._reSize(i,a),!t.isNullOrUndefined(this._currntCe)&&this._currntCe>=0){var r=t.DataManager(this.gridInstance.model.columns).executeLocal((new t.Query).where("visible","equal",!0)),n=r[this._currntCe],o=this.gridInstance.model.columns.indexOf(n);r.length!=this.gridInstance.model.columns.length?this.gridInstance.model.columns[o].width=this.gridInstance.columnsWidthCollection[o]:this.gridInstance.model.columns[this._currntCe].width=this.gridInstance.columnsWidthCollection[this._currntCe]}}},_getResizableCell:function(){var t,i,a,r,n,o,l,d=this.gridInstance.model.scrollSettings.frozenColumns;if(n=(t=e(this._target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderTable().find(".e-columnheader"):this.gridInstance.getHeaderTable().find(".e-columnheader").not(".e-stackedHeaderRow")).find(".e-headercell").not(".e-hide,.e-detailheadercell"),i=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft,d&&-1!=this._currentCell&&this._currentCell==d-1&&(a=n[this._currentCell].getBoundingClientRect().left+i+5>this._orgX),!d||this._currentCell!=d-1||a)for(r=e(this._target).closest(".e-columnheader").index(),t=e(this._target).hasClass("e-stackedHeaderCell")?t[r]:t,n=e(t).find(".e-headercell").not(".e-hide,.e-detailheadercell"),o=0;o<n.length;o++){if((l=n[o].getBoundingClientRect()).left+i+5>this._orgX&&n[o].offsetHeight+l.top>=this._orgY)return void(this._currentCell=o-1);if(o==n.length-1||this.gridInstance.model.showStackedHeader&&e(this._target).get(0)===n[o])return void(this._currentCell=o)}},_moveVisual:function(e){var t=this.gridInstance.getHeaderContent().find("div").first()[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<e||e<t.left+document.documentElement.scrollLeft?this._$visualElement.remove():-1!=this._currentCell&&this._$visualElement.css({left:e,top:this._tableY})},_mouseDown:function(t){var i,a;return!this._allowStart||!e(t.target).closest("tr").hasClass("e-resizedragicon")||(this._target=t.target,i=t.clientX,a=t.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(i=t.pageX,a=t.pageY-(window.pageYOffset||document.body.scrollTop||0)),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")&&(e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),this._target=t.target,this._triggerResizeEvents("resizeStart",i))?void 0:(this,i+=document.documentElement.scrollLeft,2!=t.button&&this._start(i,a),!1))},_columnResizeToFit:function(i){var a,r,n,o,l,d,s,c,u,p,h,g,m,_,f=this.gridInstance.getHeaderTable().find(".e-columnheader").filter(function(){return"col-resize"==e(this).css("cursor")});if(this.gridInstance.model.allowResizeToFit&&f.length){e(i.target).is(".e-headercelldiv")&&(i.target=i.target.parentNode);var w,C=e(i.target),T=0,x=0;if(w=C.hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell"):this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-stackedHeaderCell,.e-detailheadercell"),this._target=C,C.hasClass("e-headercell")){var v=i.target,b=e.inArray(v,w),S=b;this._orgX=i.pageX,this.gridInstance.model.enableRTL?this._currentCell=b:this._getResizableCell(),b!=this._currentCell&&(b=S=this._currentCell,v=i.target.previousSibling);var D=w.filter(":visible")[S],R=[],y=[],I=[];if(x=this.gridInstance.model.groupSettings.groupedColumns.length,t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)&&t.isNullOrUndefined(this.gridInstance.model.childGrid)||(x+=1),e(v).parent("tr").hasClass("e-stackedHeaderRow")){var k=e(D).attr("colspan"),M=e(D).parent("tr"),E=D.cellIndex;for(M.next();E>x;)E--,a=e(M).children("th")[E],T+=parseInt(e(a).attr("colspan"));r=T+parseInt(k)}else T=S,r=S+1;var H=0,P=0,F=0,O=[],G=[];if(-1!=T)for(o={columnIndex:T+(n=w.slice(0,T+1).filter(".e-hide").length),column:this.gridInstance.model.columns[T+n],target:C,oldWidth:d},this.gridInstance._trigger("resizeStart",o),_=T;_<r;_++){if(n=w.slice(0,_+1).filter(".e-hide").length,F=this._getContentWidth(_+n),l=this.gridInstance.getHeaderTable().find(".e-headercell:not(.e-hide, .e-stackedHeaderCell)").children(".e-headercelldiv").eq(_),P=this._getHeaderContentWidth(l),H=P>F?P:F,H+=parseInt((l.css("padding-left"),10+(l.css("padding-right"),10))),d=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder).eq(_+x).width(),H=d>H?H:this._colMinWidth<H?H:this._colMinWidth,s=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&s.splice(0,1),s.eq(_+x).width(H),this.gridInstance.model.groupSettings.groupedColumns.length&&(c=this.gridInstance.getContentTable().find(".e-recordtable").find("colgroup"),u=this,e.each(c,function(t,i){e(i).find("col").filter(u._diaplayFinder).eq(_).width(H)})),p=this.gridInstance.getContentTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&p.splice(0,1),p.eq(_+x).width(H),this.gridInstance.model.isEdit)for(this.gridInstance.getContentTable().find(".e-editedrow").find("col"),h=this.gridInstance.element.find(".gridform"),g=0;g<h.length;g++)e(h[g]).find("col").eq(_+x).width(H);O.push(this.gridInstance.model.columns[_+n]),G.push(Math.abs(H-d)),R.push(_+n),y.push(H),I.push(d),(this.gridInstance.model.scrollSettings.frozenColumns>0||this.gridInstance.model.groupSettings.groupedColumns.length&&this.gridInstance.model.isEdit)&&(m=_+n,this.gridInstance.columnsWidthCollection[m]=H,this.gridInstance.setWidthToColumns(),this.gridInstance.model.scrollSettings.frozenColumns<=m+1&&(this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",H),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",H),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",H)))}for(this.gridInstance._colgroupRefresh(),this.gridInstance._recalculateIndentWidth(),o={columnIndex:R,column:O,target:D,oldWidth:I,newWidth:y,extra:G},this.gridInstance._trigger("resizeEnd",o),_=0;_<R.length;_++)this.gridInstance.columnsWidthCollection[R[_]]=y[_],this.gridInstance.model.columns[R[_]].width=y[_];o={columnIndex:R,column:O,target:D,oldWidth:I,newWidth:y,extra:G},this.gridInstance._trigger("resized",o),this.gridInstance.model.summaryRows.length>0&&this.gridInstance._summaryColRrefresh(),this.gridInstance._findColumnsWidth()}}},_getContentWidth:function(i){var a,r,n=0,o=t.buildTag("span",{},{}),l=this.gridInstance;return t.isNullOrUndefined(l._gridRows)||(r=l._gridRows,l.model.scrollSettings.frozenColumns&&l.model.currentViewData.length&&i>=l.model.scrollSettings.frozenColumns&&(r=r[1],i-=l.model.scrollSettings.frozenColumns),e.each(r,function(t,r){if(e(r).is(".e-row,.e-alt_row")&&!e(r).is(".e-editedrow")){var d=e(r).find("td.e-rowcell").eq(i),s=e(d).html();l.model.columns[i].commands?o.html(e(s).children()):d.hasClass("e-validError")?o.html(e(s).attr("value")):o.html(s),e(d).html(o),(a=d.find("span:first").width()>0?d.find("span:first").width()+parseFloat(d.css("padding-left"))+parseFloat(d.css("padding-right")):d.find("span:first").width())>n&&(n=a),e(d).html(s)}})),l._refreshUnboundTemplate(this.gridInstance.getContentTable()),n},_getHeaderContentWidth:function(e){var i,a,r=0,n=t.buildTag("span",{},{}),o="msie"==this.gridInstance.getBrowserDetails().browser;return o&&n.css("position","absolute"),i=e.html(),n.html(i),e.html(n),r=e.find("span:first").width()+parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right")),o&&(r+=2),this.gridInstance.model.allowFiltering&&("menu"==this.gridInstance.model.filterSettings.filterType||"excel"==this.gridInstance.model.filterSettings.filterType)&&(r=r+(a=e.parent().find(".e-filtericon")).width()+10,a.length&&(r+=parseFloat(a.css("margin-left")))),e.html(i),r}}}(jQuery,Syncfusion)})},435:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var r,n=arguments.length,o=n<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(o=(n<3?r(o):n>3?r(t,i,o):r(t,i))||o);return n>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(78),o=i(1486),l=i(1268),d=i(1269),s=i(1271),c=i(1267),u=i(1270);t.ganttAppRoutes=[{path:"default",component:l.DefaultComponent,data:{name:"Default",location:"app/components/gantt/default.component"}},{path:"editing",component:d.EditingComponent,data:{name:"Editing",location:"app/components/gantt/editing.component"}},{path:"resource",component:s.ResourceComponent,data:{name:"Resources Allocation",location:"app/components/gantt/resource.component"}},{path:"baseline",component:c.BaselineComponent,data:{name:"Baseline",location:"app/components/gantt/baseline.component"}},{path:"holidays",component:u.HolidaysComponent,data:{name:"Holidays",location:"app/components/gantt/holidays.component"}},{path:"",redirectTo:"default"}],t.GanttRouting=n.RouterModule.forChild(t.ganttAppRoutes);var p=function(){function e(){}return e=a([r.NgModule({imports:[t.GanttRouting],declarations:[l.DefaultComponent,o.EJ_GANTT_COMPONENTS,d.EditingComponent,s.ResourceComponent,c.BaselineComponent,u.HolidaysComponent]})],e)}();t.GanttModule=p}});