webpackJsonp([27],{1012:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype.getGanttData=function(){return[{taskID:1,taskName:"Project Schedule",startDate:"02/06/2017",endDate:"03/10/2017",subtasks:[{taskID:2,taskName:"Planning",startDate:"02/06/2017",endDate:"02/10/2017",subtasks:[{taskID:3,taskName:"Plan timeline",startDate:"02/06/2017",endDate:"02/10/2017",baselinestartDate:"02/06/2017",baselineendDate:"02/10/2017",duration:5,progress:"100",resourceId:[1]},{taskID:4,taskName:"Plan budget",startDate:"02/06/2017",endDate:"02/10/2017",baselinestartDate:"02/06/2017",baselineendDate:"02/10/2017",duration:5,progress:"100",resourceId:[1]},{taskID:5,taskName:"Allocate resources",startDate:"02/06/2017",endDate:"02/10/2017",baselinestartDate:"02/06/2017",baselineendDate:"02/10/2017",duration:5,progress:"100",resourceId:[1]},{taskID:6,taskName:"Planning complete",startDate:"02/10/2017",endDate:"02/10/2017",baselinestartDate:"02/10/2017",baselineendDate:"02/10/2017",duration:0,predecessor:"3FS,4FS,5FS"}]},{taskID:7,taskName:"Design",startDate:"02/13/2017",endDate:"02/17/2017",subtasks:[{taskID:8,taskName:"Software Specification",startDate:"02/13/2017",endDate:"02/15/2017",baselinestartDate:"02/13/2017",baselineendDate:"02/15/2017",duration:3,progress:"60",predecessor:"6FS",resourceId:[2]},{taskID:9,taskName:"Develop prototype",startDate:"02/13/2017",endDate:"02/15/2017",baselinestartDate:"02/13/2017",baselineendDate:"02/15/2017",duration:3,progress:"100",predecessor:"6FS",resourceId:[3]},{taskID:10,taskName:"Get approval from customer",startDate:"02/13/2017",endDate:"02/17/2017",baselinestartDate:"02/13/2017",baselineendDate:"02/17/2017",duration:2,progress:"100",predecessor:"9FS",resourceId:[1]},{taskID:11,taskName:"Design complete",startDate:"02/17/2017",endDate:"02/17/2017",baselinestartDate:"02/17/2017",baselineendDate:"02/17/2017",duration:0,predecessor:"10FS"}]},{taskID:12,taskName:"Implementation Phase",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:13,taskName:"Phase 1",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:14,taskName:"Implementation Module 1",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:15,taskName:"Development Task 1",startDate:"02/20/2017",endDate:"02/25/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",predecessor:"11FS",resourceId:[3]},{taskID:16,taskName:"Development Task 2",startDate:"02/20/2017",endDate:"02/25/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",predecessor:"11FS",resourceId:[3]},{taskID:17,taskName:"Testing",startDate:"02/23/2017",endDate:"02/24/2017",baselinestartDate:"02/23/2017",baselineendDate:"02/24/2017",duration:2,progress:"0",predecessor:"15FS,16FS",resourceId:[4]},{taskID:18,taskName:"Bug fix",startDate:"02/27/2017",endDate:"03/03/2017",baselinestartDate:"02/27/2017",baselineendDate:"03/03/2017",duration:2,progress:"0",predecessor:"17FS",resourceId:[3]},{taskID:19,taskName:"Customer review meeting",startDate:"03/01/2017",endDate:"03/02/2017",baselinestartDate:"03/01/2017",baselineendDate:"03/02/2017",duration:2,progress:"0",predecessor:"18FS",resourceId:[1]},{taskID:20,taskName:"Phase 1 complete",startDate:"03/02/2017",endDate:"03/02/2017",baselinestartDate:"03/02/2017",baselineendDate:"03/02/2017",duration:0,predecessor:"19FS"}]}]},{taskID:21,taskName:"Phase 2",startDate:"02/20/2017",endDate:"03/03/2017",subtasks:[{taskID:22,taskName:"Implementation Module 2",startDate:"02/20/2017",endDate:"03/03/2017",subtasks:[{taskID:23,taskName:"Development Task 1",baselinestartDate:"02/20/2017",endDate:"02/23/2017",startDate:"02/20/2017",baselineendDate:"02/23/2017",duration:4,progress:"50",resourceId:[3]},{taskID:24,taskName:"Development Task 2",startDate:"02/20/2017",endDate:"02/23/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/23/2017",duration:4,progress:"50",resourceId:[3]},{taskID:25,taskName:"Testing",startDate:"02/24/2017",endDate:"02/27/2017",baselinestartDate:"02/24/2017",baselineendDate:"02/27/2017",duration:2,progress:"0",predecessor:"23FS,24FS",resourceId:[4]},{taskID:26,taskName:"Bug fix",startDate:"03/03/2017",endDate:"03/01/2017",baselinestartDate:"03/03/2017",baselineendDate:"03/01/2017",duration:2,progress:"0",predecessor:"25FS",resourceId:[3]},{taskID:27,taskName:"Customer review meeting",startDate:"03/02/2017",endDate:"03/03/2017",baselinestartDate:"03/02/2017",baselineendDate:"03/03/2017",duration:2,progress:"0",predecessor:"26FS",resourceId:[1]},{taskID:28,taskName:"Phase 2 complete",startDate:"03/03/2017",endDate:"03/03/2017",baselinestartDate:"03/03/2017",baselineendDate:"03/03/2017",duration:0,predecessor:"27FS"}]}]},{taskID:29,taskName:"Phase 3",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:30,taskName:"Implementation Module 3",startDate:"02/20/2017",endDate:"03/02/2017",subtasks:[{taskID:31,taskName:"Development Task 1",baselinestartDate:"02/20/2017",endDate:"02/25/2017",startDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",resourceId:[3]},{taskID:32,taskName:"Development Task 2",startDate:"02/20/2017",endDate:"02/25/2017",baselinestartDate:"02/20/2017",baselineendDate:"02/25/2017",duration:3,progress:"50",resourceId:[3]},{taskID:33,taskName:"Testing",startDate:"02/23/2017",endDate:"02/24/2017",baselinestartDate:"02/23/2017",baselineendDate:"02/24/2017",duration:2,progress:"0",predecessor:"31FS,32FS",resourceId:[4]},{taskID:34,taskName:"Bug fix",startDate:"02/27/2017",endDate:"03/03/2017",baselinestartDate:"02/27/2017",baselineendDate:"03/03/2017",duration:2,progress:"0",predecessor:"33FS",resourceId:[3]},{taskID:35,taskName:"Customer review meeting",startDate:"03/01/2017",endDate:"03/02/2017",baselinestartDate:"03/01/2017",baselineendDate:"03/02/2017",duration:2,progress:"0",predecessor:"34FS",resourceId:[1]},{taskID:36,taskName:"Phase 3 complete",startDate:"03/02/2017",endDate:"03/02/2017",baselinestartDate:"03/02/2017",baselineendDate:"03/02/2017",duration:0,predecessor:"35FS"}]}]}]},{taskID:37,taskName:"Integration",startDate:"03/06/2017",endDate:"03/08/2017",baselinestartDate:"03/03/2017",baselineendDate:"03/05/2017",duration:2,progress:"0",predecessor:"20FS,28FS,36FS",resourceId:[3]},{taskID:38,taskName:"Final Testing",startDate:"03/09/2017",endDate:"03/10/2017",baselinestartDate:"03/06/2017",baselineendDate:"03/10/2017",duration:2,progress:"0",predecessor:"37FS",resourceId:[4]},{taskID:39,taskName:"Final Delivery",startDate:"03/10/2017",endDate:"03/10/2017",baselinestartDate:"03/10/2017",baselineendDate:"03/10/2017",duration:0,predecessor:"38FS"}]}]},e.prototype.getResourceData=function(){return[{resourceId:1,resourceName:"Robert King"},{resourceId:2,resourceName:"Anne Dodsworth"},{resourceId:3,resourceName:"David William"},{resourceId:4,resourceName:"Nancy Davolio"},{resourceId:5,resourceName:"Janet Leverling"},{resourceId:6,resourceName:"Romey Wilson"}]},e}();t.GanttDataService=l},1021:function(e,t){e.exports="ej-treegrid {\r\n    display: block;\r\n}\r\n"},1042:function(e,t,i){var l,n,o;
/*!
*  filename: ej.treegrid.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.treegrid.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(r){n=[i(15),i(94),i(4),i(21),i(65),i(47),i(16),i(55),i(95),i(223),i(31),i(92),i(93),i(224),i(79),i(226),i(80),i(66),i(222),i(225)],void 0===(o="function"==typeof(l=r)?l.apply(t,n):l)||(e.exports=o)}(function(){(function(e,t,i){"use strict";t.widget("ejTreeGrid","ej.TreeGrid",{_rootCSS:"e-treegrid",element:null,validTags:["div"],model:null,_requiresID:!0,_tags:[{tag:"columns",attr:["field","headerText","allowSorting","editType","allowFiltering","filterEditType","width","visible","editParams","format","isFrozen","allowFreezing","headerTemplateID","allowCellSelection","showCheckbox","showInColumnChooser","validationRules.minlength","isTemplateColumn","validationRules.maxlength","validationRules.range","validationRules.number","validationRules.required","displayAsCheckbox","editTemplate","priority","filterType",[{tag:"commands",attr:["type","buttonOptions"]}]],content:"template"},{tag:"summaryRows",attr:["title","summaryColumns"],content:"template"},{tag:"stackedHeaderRows",attr:["stackedHeaderColumns"],content:"template"},{tag:"summaryRows.summaryColumns",attr:["summaryType","dataMember","displayColumn","prefix","suffix","format","customSummaryValue"],content:"template"},{tag:"sortSettings.sortedColumns",attr:["field","direction"]},{tag:"sizeSettings",attr:["height","width"]},{tag:"columnResizeSettings",attr:["columnResizeMode"]}],_columns:function(e,i,l){var n,o,r,a,d,s=this.model.columns,c=!1,u=s.length,g=["allowCellSelection","allowEditing","allowFilteringBlankContent","allowFreezing","allowSorting","editParams","headerTooltip","tooltip","validationRules"];if(!t.isNullOrUndefined(e)){if("object"==typeof e){for(n=0;n<e.length;n++)if(o=e[n],!t.isNullOrUndefined(o.index)&&!t.isNullOrUndefined(o.change))for(r=0;r<u;r++)if((a=s[r]).index&&a.index==o.index){for(d in o.change)-1==g.indexOf(d)&&(c=!0);break}}else i&&l?-1==g.indexOf(d)&&(c=!0):c=!0;c&&this.updateColumns()}},keyConfigs:{focus:"e",editRecord:"113",saveRequest:"13",cancelRequest:"27",firstRowSelection:"36",lastRowSelection:"35",leftArrow:"37",upArrow:"38",rightArrow:"39",downArrow:"40",moveCellRight:"9",moveCellLeft:"shift+9",shiftDownArrow:"shift+40",shiftUpArrow:"shift+38",shiftRightArrow:"shift+39",shiftLeftArrow:"shift+37",shiftHomeButton:"shift+36",shiftEndButton:"shift+35",selectedRowExpand:"alt+40",totalRowExpand:"ctrl+40",selectedRowCollapse:"alt+38",totalRowCollapse:"ctrl+38",deleteRecord:"46",spaceBar:"32",topRowSelection:"ctrl+36",bottomRowSelection:"ctrl+35",nextPage:"33",prevPage:"34"},defaults:{expandStateMapping:"",allowFiltering:!1,allowDragAndDrop:!1,dragTooltip:{showTooltip:!1,tooltipItems:[],tooltipTemplate:""},allowSorting:!1,allowColumnResize:!1,allowSelection:!0,allowPaging:!1,allowSearching:!1,dataSource:null,query:t.Query(),idMapping:"",parentIdMapping:"",hierarchyRowIndexMapping:"",readOnly:!1,showGridCellTooltip:!1,cellTooltipTemplate:null,showGridExpandCellTooltip:!1,showColumnChooser:!1,showColumnOptions:!1,enableAltRow:!0,enableLoadOnDemand:!1,totalSummaryHeight:90,collapsibleTotalSummary:!1,hasChildMapping:"",selectedItem:null,showStackedHeader:!1,stackedHeaderRows:[],toolbarSettings:{showToolbar:!1,toolbarItems:[],customToolbarItems:[]},editSettings:{allowEditing:!1,allowAdding:!0,allowDeleting:!0,editMode:"cellEditing",rowPosition:"top",beginEditAction:"dblclick",dialogEditorTemplateID:"",showDeleteConfirmDialog:!1,showConfirmDialog:!0,batchEditSettings:{editMode:"cell"}},enableVirtualization:!1,allowMultiSorting:!1,sortSettings:{sortedColumns:[]},filterSettings:{filterBarMode:"immediate",filteredColumns:[],filterType:"filterbar",maxFilterChoices:1e3,enableCaseSensitivity:!1,enableComplexBlankFilter:!0,blankValue:"",filterHierarchyMode:"parent"},printingEnabled:!1,selectionType:"single",selectionMode:"row",selectionSettings:{selectionType:"single",selectionMode:"row",enableHierarchySelection:!0,enableSelectAll:!0},searchSettings:{fields:[],key:"",operator:"contains",ignoreCase:!0,searchHierarchyMode:"parent"},selectedCellIndexes:[],selectedRowIndex:-1,showSummaryRow:!1,summaryRows:[],showTotalSummary:!1,allowKeyboardNavigation:!0,cssClass:"",locale:"en-US",isEdit:!1,allowScrolling:!1,scrollSettings:{frozenColumns:0},groupSettings:{groupedColumns:[]},sizeSettings:{height:"",width:""},enableResize:!0,allowTextWrap:!1,isResponsive:!0,showDetailsRow:!1,showDetailsRowInfoColumn:!1,detailsTemplate:"",detailsRowHeight:100,rowDataBound:null,load:null,create:null,queryCellInfo:null,rowSelecting:null,rowSelected:null,cellSelecting:null,cellSelected:null,beginEdit:null,endEdit:null,expanding:null,expanded:null,collapsing:null,collapsed:null,dataBound:null,beforePrint:null,actionComplete:null,actionBegin:null,actionFailure:null,currentViewData:[],flatRecords:[],parentRecords:[],updatedRecords:[],summaryRowRecords:[],selectedItems:[],ids:[],columns:[{field:"",headerText:"",editType:"",filterEditType:"",allowFiltering:!1,allowFilteringBlankContent:!0,allowSorting:!1,visible:"",textAlign:t.TextAlign.Left,headerTextAlign:t.TextAlign.Left,allowCellSelection:!0,clipMode:"",headerTooltip:"",tooltip:"",showInColumnChooser:!0,commands:[{type:"",buttonOptions:{}}],filterType:null}],columnDialogFields:[],commonWidth:150,dateFormat:"MM/dd/yyyy",rowHeight:30,emptyRecordText:"No Records To Display",treeColumnIndex:0,workingTimeScale:"TimeScale8Hours",childMapping:"",enableCollapseAll:!1,rowTemplateID:"",altRowTemplateID:"",parseRowTemplate:!0,contextMenuSettings:{showContextMenu:!1,contextMenuItems:[]},contextMenuOpen:null,rowDragStart:null,rowDrag:null,rowDragStop:null,rowDropActionBegin:null,detailsDataBound:null,detailsShown:null,detailsHidden:null,toolbarClick:null,columnResizeStart:null,columnResizeEnd:null,columnResized:null,recordClick:null,recordDoubleClick:null,exportToPdfAction:"",exportToExcelAction:"",allowMultipleExporting:!1,headerTextOverflow:"none",pageSettings:{pageSize:12,pageCount:8,currentPage:1,totalPages:0,totalRecordsCount:null,pageSizeMode:"all",template:null,printMode:"allPages"},allowColumnReordering:!1,columnResizeSettings:{columnResizeMode:"normal"}},dataTypes:{columns:"array",totalSummaryHeight:"number",collapsibleTotalSummary:"boolean",summaryRows:"array",sortSettings:{sortedColumns:"array"},searchSettings:{fields:"array"},dragTooltip:{tooltipItems:"array"},columnDialogFields:"array",filterSettings:{filteredColumns:"array",filterType:"string"},dataSource:"data",query:"data",currentViewData:"array",flatRecords:"array",parentRecords:"array",updatedRecords:"array",summaryRowRecords:"array",ids:"array",contextMenuSettings:{contextMenuItems:"array"},toolbarSettings:{toolbarItems:"array",customToolbarItems:"array"},stackedHeaderRows:"array",selectedItem:"data"},ignoreOnExport:["isEdit","toolbarClick","query","queryCellInfo","selectionType","currentViewData","enableRTL","rowDataBound","rowTemplate","parseRowTemplate","detailsTemplate","editSettings","localization","cssClass","dataSource","allowKeyboardNavigation","pageSettings","columnResizeSettings"],observables:["selectedRowIndex","dataSource","selectedCellIndexes","pageSettings.currentPage"],selectedItem:t.util.valueFunction("selectedItem"),selectedRowIndex:t.util.valueFunction("selectedRowIndex"),selectedCellIndexes:t.util.valueFunction("selectedCellIndexes"),dataSource:t.util.valueFunction("dataSource"),_currentPage:t.util.valueFunction("pageSettings.currentPage"),_dataSource:t.util.valueFunction("dataSource"),_getLocalizedLabels:function(){return t.getLocalizedConstants(this.sfType,this.model.locale)},getHeaderTable:function(){return this._$gridHeaderTable},setGridHeaderTable:function(e){this._$gridHeaderTable=e},getHeaderContent:function(){return this._$gridHeaderContent},setGridHeaderContent:function(e){this._$gridHeaderContent=e},getContentTable:function(){return this._$gridContentTable},getContent:function(){return this._$gridContent},setGridContentTable:function(e){this._$gridContentTable=e},getRows:function(){return this._excludeDetailRows()},getSelectedCells:function(){var t=this,i=t.model,l=[];return this._selectedCellDetails.forEach(function(n){var o=n.data,r=i.currentViewData.indexOf(o),a=e(n.cellElement);-1!=r&&(t._frozenColumnsLength>0?a.closest(".e-frozencontentdiv").length>0?n.cellElement=t.getRows()[0][r].childNodes[n.cellIndex]:a.closest(".e-movablecontentdiv").length>0&&(n.cellElement=t.getRows()[1][r].childNodes[n.cellIndex-t._frozenColumnsLength]):n.cellElement=t.getRows()[r].childNodes[n.cellIndex]),l.push(n.cellElement)}),l},setGridRows:function(e){this._$gridRows=e},getCurrentViewData:function(){return this.model.currentViewData},getUpdatedCurrentViewData:function(){return this._updateCurrentViewData(),this.model.currentViewData},getFlatRecords:function(){return this.model.flatRecords},setHeight:function(e){this._totalHeight=e},getUpdatedRecords:function(){var e=this.model;return!this._isFromGantt&&e.allowPaging?this._updatedPageData:this._isHierarchyFiltering&&e.enableVirtualization?this._updateFilterParent:e.updatedRecords},getsummaryRowRecords:function(){return this.model.summaryRowRecords},getDataSource:function(){return this.dataSource()},getUpdatedIds:function(){return this.model.ids},getRecordsCount:function(){return this._recordsCount},setRecordsCount:function(e){this._recordsCount=e},setFocusOnTreeGridElement:function(){this._focusTreeGridElement()},updateCollapsedRecordCount:function(){var e,t=this;e=this.model.updatedRecords.filter(function(e){return 0==t.getExpandStatus(e)}),t._totalCollapsedRecordCount=e.length},_getDetailsExpandedRecords:function(e){return e.filter(function(e){return 1==e.isDetailsExpanded})},_getExpandedDetailsRowHeight:function(){var e,t,i=this,l=i.getUpdatedRecords();return e=this.getExpandedRecords(l),t=this._getDetailsExpandedRecords(e),t=i._spliceSummaryRows(t),i._detailsRowHeight*t.length},getCollapsedRecordCount:function(){return this._totalCollapsedRecordCount},_colgroupRefresh:function(){var t,i;this._frozenColumnsLength>0?(t=e(this.getHeaderTable()).find("colgroup"),i=e(this.getContentTable()).find("colgroup")):(t=e(this.getHeaderTable()).find("colgroup")[0],i=e(this.getContentTable()).find("colgroup")[0]);var l=e(t).clone(),n=e(i).clone(),o=e(i).clone();e(i).remove(),e(t).remove(),this._frozenColumnsLength>0?(e(l[0]).prependTo(this.getHeaderTable()[0]),e(l[1]).prependTo(this.getHeaderTable()[1]),e(n[0]).prependTo(this.getContentTable()[0]),e(n[1]).prependTo(this.getContentTable()[1]),this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(o[0]).prependTo(this._$footertableContent[0]),e(o[1]).prependTo(this._$footertableContent[1])),this._$totalSummaryRowContainer&&(this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this._$totalSummaryRowContainer.find("#e-movablefooter"+this._id).css("margin-left","auto")),this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this.getHeaderContent().find("#e-movableheader"+this._id).add(this.getContent().find("#e-movablecontainer"+this._id)).css("margin-left","auto"),e("#e-frozencontentdiv"+this._id).length&&e("#e-frozencontentdiv"+this._id).css("width","100%")):(e(l).prependTo(this.getHeaderTable()),e(n).prependTo(this.getContentTable()),this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(o).prependTo(this._$footertableContent)))},_detailColsRefresh:function(){if(this._$headerCols=this.getHeaderTable().children("colgroup").find("col"),this._$contentCols=this.getContentTable().children("colgroup").find("col"),this.model.detailsTemplate&&this.model.showDetailsRow&&this.model.showDetailsRowInfoColumn||this.model.isFromGantt){var e=this.model.columns.length;this._$headerCols.length>e&&this._$headerCols.splice(e,1),this._$contentCols.length>e&&this._$contentCols.splice(e,1)}},_swipeAction:function(e){var t=this._currentPage(),i=!0,l=(this.getScrollObject()||{})._scrollXdata;switch(l&&(i="swipeleft"==e.type?l.scrollable-l.sTop==0:0==l.sTop),e.type){case"swipeleft":!this.model.allowPaging||t==this.model.pageSettings.totalPages||this.model.isEdit||this._isRowEdit||(i||!this.getScrollElement().ejScroller("isHScroll"))&&this.element.ejTreeGrid("gotoPage",t+1);break;case"swiperight":this.model.allowPaging&&t>1&&!this.model.isEdit&&!this._isRowEdit&&(i||!this.getScrollElement().ejScroller("isHScroll"))&&this.element.ejTreeGrid("gotoPage",t-1)}},gotoPage:function(i){var l=this,n=l.model,o={};if(this.model.allowPaging){if(this._isLoadonDemand&&i&&i!=this._currentPage())return this._currentPage(i),l._refreshDataSource(),void(this._prevPageNo!=i&&(this._prevPageNo=i));t.isNullOrUndefined(i)?i=l._currentPage():i<=0?i=1:i>n.pageSettings.totalPages&&(i=n.pageSettings.totalPages),i=t.isNullOrUndefined(i)?l._currentPage():i,this._currentPage(i),o.previousPage=this._prevPageNo,o.currentPage=i,n.allowPaging&&(o.requestType=t.TreeGrid.Actions.Paging),l._setScrollTop(),l._updateCurrentViewData(),n.enableVirtualization&&n.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&-1==e.inArray(i,l._expandCollapsePages)&&(l._isInExpandCollapseAll=!0,"collapseAll"==l._expandCollapseSettings.state?l._collapseAllData():"expandAll"==l._expandCollapseSettings.state&&l._expandAllData(),"collapseAtLevel"==l._expandCollapseSettings.atLevel?l._collapsePageLevelData():"expandAtLevel"==l._expandCollapseSettings.atLevel&&l._expandPageLevelData(),n.enableAltRow&&l.updateAltRow()),l.renderRecords(o),l._isInExpandCollapseAll=!1,l._updateWrapRowHeights("total,header"),l.updateHeight(),l._updateScrollCss(),n.allowTextWrap&&n.enableVirtualization&&l._updateWrapRowHeights("header","refreshAll"),o.previousPage!=o.currentPage&&(l.clearSelection(-1),l.selectedRowIndex(-1),l.model.selectedItem=null,l._cancelSaveTools(),l._clearContextMenu(),l.model.allowSelection&&"multiple"==l.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&l._clearMultiSelectPopup(),this._prevPageNo=o.currentPage)}},_pagerClickHandler:function(e){var i=this;return i.model.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&i._batchEditStarts&&!i._confirmDialog.is(":visible")?(i._batchSaveLostWarning("Paging"),i._batchTempDetails.currentPage=e.currentPage,!0):this._prevPageNo==e.currentPage?void 0:(i._isNextPage=!0,i._isRowEdit?i.cancelRowEditCell():i.model.isEdit&&i.cancelEditCell(),this.gotoPage(e.currentPage),!1)},_init:function(){var e,l,n,o=this;if(o.model.isdesignMode){for(o.model.columns=[{field:"Column1",HeaderText:"Column1"},{field:"Column2",HeaderText:"Column2"},{field:"Column3",HeaderText:"Column3"},{field:"Column4",HeaderText:"Column4"}],o.model.childMapping="Children",e=[{Column1:"Value 1",Column2:"Value 2",Column3:"Value 3",Column4:"Value 4",Children:[]}],l=1;l<4;l++)n={Column1:"Value 1",Column2:"Value 2",Column3:"Value 3",Column4:"Value 4"},e[0].Children.push(n);this.dataSource(e),this.model.sizeSettings.height="250px",this.model.sizeSettings.width="600px"}o._detailsColumnWidth=35,o._summaryColumnIndex=0,o.model.summaryRows.length<=1&&(o.model.collapsibleTotalSummary=!1),o._trigger("load"),o._validateColumnFields(),o.model.isFromGantt||o._validateColumnVisible(!0),o._initPrivateProperties(),o._setCultureInfo(),this.dataSource()instanceof t.DataManager&&this.dataSource().ready!=i?((o=this)._renderWaitingPopup(),this.dataSource().ready.done(function(e){o.model.dataSource=t.DataManager(e.result),o._initDatasource()})):o._initDatasource(),o._processEditing(),o.model.showColumnChooser&&o.model.showColumnOptions&&(o.columnAddDialogTemplate(),o._renderUpdateConfirmDialog()),o._createDragTooltipTemplate(),o._createTooltipTemplate()},_renderEditDialog:function(){return t.buildTag("div.e-editdialog-padding","",{display:"none"},{id:this._id+"_dialogEdit"})},_validateColumnFields:function(){var e,i=this.model.columns;if(!t.isNullOrUndefined(i))for(e=0;e<i.length;e++)t.isNullOrUndefined(i[e].field)&&(i[e].field="",i[e].allowEditing=!1,i[e].allowSorting=!1,i[e].allowFiltering=!1),this._isCommandColumn(i[e])&&(i[e].allowEditing=!1,i[e].allowSorting=!1,i[e].allowFiltering=!1,i[e].showCheckbox=!1),t.isNullOrUndefined(i[e].editType)&&(i[e].editType="stringedit"),"maskedit"==i[e].editType&&t.isNullOrUndefined(i[e].filterEditType)&&(i[e].filterEditType="stringedit")},_validateColumnVisible:function(e){var i,l,n,o,r,a=this,d=a.model;if(a._autoHideColumns=[],a._autoShowColumns=[],d.isResponsive&&d.enableResize)if(l=null,(i=document.body.clientWidth)>=960&&i<=1120?l=6:i>=800&&i<=959?l=5:i>=640&&i<=799?l=4:i>=480&&i<=639?l=3:i>=0&&i<=479&&(l=2),o=(n=d.columns).length,e)for(r=0;r<o;r++)null!=l?n[r].priority&&(n[r].visible=!(n[r].priority>=l)):t.isNullOrUndefined(n[r].priority)||(n[r].visible=!0);else for(r=0;r<o;r++)null!=l?n[r].priority&&(n[r].priority>=l?0!=n[r].visible&&a._autoHideColumns.push(n[r]):0==n[r].visible&&a._autoShowColumns.push(n[r])):t.isNullOrUndefined(n[r].priority)||0==n[r].visible&&a._autoShowColumns.push(n[r])},_hideColumns:function(t){var i,l,n=this,o=n.model;if(t.reverse(),t.sort(function(e,t){return t.priority-e.priority}),t&&t.length>0){for(i=t.length,n.getHeaderTable().removeClass("e-table"),n.getContentTable().removeClass("e-table"),l=0;l<i;l++){var r=t[l],a=e.inArray(r,o.columns),d=r.headerText,s=e.inArray(d,n._hiddenColumns);(!r||n._isColumnHidable(r))&&(-1!=a&&a!=o.treeColumnIndex&&-1==s&&n._autoHideShowColumn(d,a,!0),-1!=(a=e.inArray(d,n._visibleColumns))&&n._visibleColumns.splice(a,1))}n.getHeaderTable().addClass("e-table"),n.getContentTable().addClass("e-table"),n._updateHideShowColumnAlignment()}},_showColumns:function(t){var i,l,n=this,o=n.model;if(t&&t.length>0){for(i=t.length,l=0;l<i;l++){var r=t[l],a=e.inArray(r,o.columns),d=r.headerText,s=e.inArray(d,n._visibleColumns);-1!=a&&-1==s&&n._autoHideShowColumn(d,a,!1),-1!=(a=e.inArray(d,n._hiddenColumns))&&n._hiddenColumns.splice(a,1)}n._updateHideShowColumnAlignment()}},_autoHideShowColumn:function(t,i,l){var n,o,r,a,d,s=this,c=s.model;s._cancelEditState(),l?(s._hiddenColumns.push(t),c.columns[i].visible=!1):(s._visibleColumns.push(t),c.columns[i].visible=!0),o=s.getHeaderTable().find("colgroup").find("col"),r=s.getHeaderTable().find("thead").find("th.e-headercell"),c.allowFiltering&&"filterbar"==c.filterSettings.filterType&&(n=s.getHeaderTable().find("thead").find("th.e-filterbarcell")),1==s.model.columns[i].isFrozen&&(s._updateFrozenColumnOnResize(i),s.setWidthToColumns());var u,g,m=s.getContentTable().find("colgroup").find("col"),p=!0,h=i;g=s.getRows(),u=s._getFooterRows(),l?(e(o).eq(i).hide(),e(r).eq(i).addClass("e-hide"),n&&e(n).eq(i).addClass("e-hide"),e(m).eq(i).hide()):(e(o).eq(i).show(),e(r).eq(i).removeClass("e-hide"),n&&e(n).eq(i).removeClass("e-hide"),e(m).eq(i).show()),s._frozenColumnsLength>0?i<s._frozenColumnsLength?(g=e(s.getRows()[0]),u=e(u[0]),s._gridRows&&e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(a=parseInt(e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),a=l?a-1:a+1,e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",a))):(g=e(s.getRows()[1]),u=e(u[1]),p=!1,h=i-this._frozenColumnsLength,s._gridRows&&e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(a=parseInt(e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),a=l?a-1:a+1,e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",a))):s._gridRows&&e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(a=parseInt(e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),a=l?a-1:a+1,e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",a)),g.each(function(){var t=e(this).children("td").eq(h);l?e(t).addClass("e-hide"):e(t).removeClass("e-hide"),c.showSummaryRow&&e(t).hasClass("e-summaryrowcell")&&p&&s._updateSummaryRowTitleCell(o,t[0].parentElement)}),c.showTotalSummary&&(d=s._$footertableContent.find("colgroup").find("col"),l?e(d).eq(i).hide():e(d).eq(i).show(),u.each(function(){var t=e(this).children("td").eq(h);l?e(t).addClass("e-hide"):e(t).removeClass("e-hide"),e(t).hasClass("e-footersummaryrowcell")&&s._updateSummaryRowTitleCell(d,t[0].parentElement)}))},_updateHideShowColumnAlignment:function(){var e,i=this,l=i.model;i._addInitTemplate(),e=i.getScrollElement(),l.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||l.isFromGantt||i._updateTableWidth(),e.ejScroller("refresh"),i._updateScrollCss(),i._updateHeaderScrollLeft(),l.showColumnChooser&&(i._renderColumnChooserList(!0),i._updateColumnMenuVisibility())},_treeGridAddEditDialog:function(){var l;if(0!=this.model.columns.length){var n,o,r,a,d,s=t.buildTag("div"),c=t.buildTag("form.e-treegridform","",{},{id:this._id+"EditFormDialog"}),u=t.buildTag("table","",{margin:"0 auto"},{});for(l=0;l<this.model.columns.length;l++)(this.model.columns[l].visible||t.isNullOrUndefined(this.model.columns[l].visible))&&"checkboxState"!=this.model.columns[l].field&&!this._isCommandColumn(this.model.columns[l])&&(a="tr",d="td",n=t.buildTag(a),o=t.buildTag(d+".e-editdialoglabel","",{"text-align":"right"}),r=t.buildTag(d+".e-editdialogrowcell","",{"text-align":"left"}),0!=this.model.columns[l].allowEditing&&n.append(o.get(0)).append(r.get(0)),this.model.columns[l].headerText==i&&(this.model.columns[l].headerText=this.model.columns[l].field),o.append("<label>"+this.model.columns[l].headerText+"</label>"),0!=this.model.columns[l].allowEditing&&this.model.columns[l].field&&t.TreeGrid._initCellEditType(this,r,this._id,l),0==this.model.columns[l].allowEditing&&r.find(".e-field").attr("disabled",!0).addClass("e-disable"),!1===this.model.columns[l].visible&&n.addClass("e-hide"),u.append(n));c.append(u),c.appendTo(s),s=this._renderDiaglogButton(c,s,u),e.templates(this._id+"_JSONDialogEditingTemplate",s.html())}},_treeGridAddEditDialogTemplate:function(){if(0!=this.model.columns.length){var i=t.buildTag("div","",{display:"none"}),l=t.buildTag("form.e-treegridform","",{},{id:this._id+"EditFormDialog"}),n=this.model.editSettings.dialogEditorTemplateID;l.html(e(n).html()),i=this._renderDiaglogButton(l,i),e.templates(this._id+"_JSONdialogTemplateMode",i.html())}},_renderDiaglogButton:function(e,i,l){var n,o,r,a,d,s,c,u=this._contextMenuTexts;return n="EditFormDialog_",t.isNullOrUndefined(l)?((o=t.buildTag("input.e-save e-button e-btnsub e-flat","",{"margin-left":"33%"},{type:"button",id:n+this._id+"_Save"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.saveText,width:"30%"}),(r=t.buildTag("input.e-cancel e-button e-btncan e-flat","",{"margin-left":"7%"},{type:"button",id:n+this._id+"_Cancel"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.cancelText,width:"30%"})):((o=t.buildTag("input.e-save e-button e-btnsub e-flat","",{"margin-left":"0px"},{type:"button",id:n+this._id+"_Save"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.saveText,width:"45%"}),(r=t.buildTag("input.e-cancel e-button e-btncan e-flat","",{"margin-left":"10%"},{type:"button",id:n+this._id+"_Cancel"})).ejButton({cssClass:this.model.cssClass,enableRTL:this.model.enableRTL,text:u.cancelText,width:"45%"})),a=t.buildTag("div","",{},{class:"e-editform-btn e-editdialogbutton"}),t.isNullOrUndefined(l)||(d=t.buildTag("tr"),s=t.buildTag("td.e-editdialoglabel"),c=t.buildTag("td.e-editdialogrowcell")),a.append(o),a.append(r),t.isNullOrUndefined(l)||(c.append(a),d.append(s),d.append(c),l.append(d)),e.appendTo(i),t.isNullOrUndefined(l)?e.append(a):e.append(l),i},updateAllowKeyboardNavigation:function(e){this.model.allowKeyboardNavigation=e},_updateSummaryTitleColumn:function(){var t=this,i=this.model;i.collapsibleTotalSummary&&0==this._summaryColumnIndex&&(i.columns[this._summaryColumnIndex].visible&&!e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").hasClass("e-summarycell")?(e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").addClass("e-summarycell"),e("#"+t._id+"-footersummaryrow").find(".e-summarycell").css({overflow:"hidden","padding-left":"25px",float:"none"}),e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").parent().addClass("e-summaryindend").css({"padding-left":"0px"})):!i.columns[this._summaryColumnIndex].visible&&e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").hasClass("e-summarycell")&&(e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").removeClass("e-summarycell"),e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").css({"padding-left":"0px",float:"left"}),e("#"+t._id+"-footersummaryrow").find(".e-summarytitle").parent().removeClass("e-summaryindend").css({"padding-left":"10px"})))},_refreshFooterSummaryRecords:function(){var i,l,n=this;this.model.showTotalSummary&&n._$footerContainer.length>0&&(this._frozenColumnsLength>0?(n._$footerContainer.html(this._renderSummaryByFrozenDesign()),this._renderFrozenSummary()):(i=t.buildTag("table.e-table e-zerospace#"+n._id+"summarye-table","",{top:"0px"}),l=t.buildTag("tbody"),i.append(n.getContentTable().find("colgroup").clone()).append(l),l.html(e.render[this._id+"_Template"](n._footerSummaryRecord)),n._$footerContainer.empty().append(i)),n._$footertableContent=n._$footerContainer.find(".e-table"),n._updateSummaryTitleColumn())},_updateHeaderScrollLeft:function(e){var i=this;t.isNullOrUndefined(e)&&(e=i.getScrollElement().ejScroller("option","scrollLeft")),this._frozenColumnsLength>0?(i._$gridHeaderContainer.find("#e-movableheader"+this._id).scrollLeft(e),i.model.showTotalSummary&&i._$footerContainer&&i._$footerContainer.find("#e-movablefooter"+this._id).scrollLeft(e)):(i._$gridHeaderContainer.scrollLeft(e),i.model.showTotalSummary&&i._$footerContainer&&i._$footerContainer.scrollLeft(e))},updateColumns:function(e){var i=this,l=this.model;t.isNullOrUndefined(e)||(l.columns=e),l.isFromGantt&&l.enableSerialNumber&&i._updateTreeColumnIndex(),i._refreshFrozenColumns(),i._updateWrapRowHeights(null,"refreshAll"),l.isFromGantt&&i._updateAddEditDialogTemplate()},updateToGanttColumns:function(){var t=this.model.columns;e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt").updateGanttColumns(t)},_updateAddEditDialogTemplate:function(){var t;(t=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt")).addDialogTemplate(),t.editDialogTemplate()},_refreshFrozenColumns:function(i){var l,n,o,r,a,d=this,s=this.model,c=!1;d._initFrozenColumns(),d._processEditing(),d._$gridHeaderContent.replaceWith(d._renderGridHeader()),d._addInitTemplate(),s.isFromGantt&&d._$gridContent.removeClass("e-borderbox"),this._frozenColumnsLength>0&&0==d._$frozenTableContent.length?(c=!0,l=d._$gridContent.css("width"),n=d._$gridContent.css("height"),d._$gridContent.ejScroller("destroy"),d._$gridContent.css("width",l),d._$gridContent.css("height",n),d._$gridContainer.html(d._renderByFrozenDesign()),d.setGridContentTable(d._$gridContainer.find(".e-table")),s.allowTextWrap&&!s.enableVirtualization?d._$gridContainer.find("#e-movablecontent"+d._id+",#e-movablecontentdiv"+d._id+",#e-frozencontentdiv"+d._id).css("height","auto"):d._$gridContainer.find("#e-movablecontent"+d._id+",#e-movablecontentdiv"+d._id+",#e-frozencontentdiv"+d._id).css("height",d._$gridContainer.css("height")),d._renderScroller(!0)):d._$frozenTableContent.length>0&&0==this._frozenColumnsLength&&(c=!0,d._$gridContent.find("#e-movablecontainer"+d._id).ejScroller("destroy"),o=t.buildTag("table.e-table e-zerospace#"+d._id+"e-table","",{top:"0px",position:"relative"}),r=t.buildTag("tbody"),o.append(d.getHeaderTable().find("colgroup").clone()).append(r),d._$gridContainer.html(o),d.setGridContentTable(o),d._renderScroller(!0)),d._$frozenTableContent=e("#"+d._id+"frozene-table"),d._$movableTableContent=e("#"+d._id+"movablee-table"),d._$tableContent=e("#"+d._id+"e-table"),s.showTotalSummary&&d._$footerContainer.length>0&&!i&&d._refreshFooterSummaryRecords(),c&&d.onScrollHelper(0),i||((a={}).requestType=t.TreeGrid.Actions.Refresh,d._isRendered=!1,d.sendDataRenderingRequest(a),d._isRendered=!0),d.setWidthToColumns(),d._trigger("headerRefresh"),d._isRendered=!0,i||(d._trigger("refresh"),this._eventBindings()),this._hideCollapsedDetailsRows(),i||(d.getScrollElement().ejScroller("refresh"),d._updateScrollCss(),s.isFromGantt&&d._trigger("refreshScrollCss")),(s.showColumnChooser||s.contextMenuSettings.showContextMenu)&&d._renderColumnChooserList(!0),d._updateHeaderScrollLeft(),s.isFromGantt&&(d._addEmptyColumntoGrid(),d.updateToGanttColumns())},freezePrecedingColumns:function(e){var i,l,n=this,o=this.model.columns,r=this.getColumnByField(e),a=o.indexOf(r);if(n._saveEditedElements(),this._clearContextMenu(),this._removeDetailsRow(),this._clearColumnMenu(),t.isNullOrUndefined(r)||-1==a||0==a&&a<=this._frozenColumnsLength||(i=this._getFrozenColumnWidth(a),(i+=18)>this._gridWidth))return!1;for(l=0;l<a;l++)o[l].isFrozen=!0;n._refreshFrozenColumns(),n._updateWrapRowHeights(null,"virtualRefresh")},freezeColumn:function(e,i){var l,n,o=this,r=this.model,a=r.columns,d=this.getColumnByField(e);if(o._saveEditedElements(),this._clearContextMenu(),this._removeDetailsRow(),this._clearColumnMenu(),"cell"==r.selectionSettings.selectionMode&&o.clearSelection(),t.isNullOrUndefined(d)||o._frozenColumnsLength==r.columns.length-1&&i||d.isFrozen==i||(l=this._getFrozenColumnWidth(),n=a.indexOf(d),(l+=i?this.columnsWidthCollection[n]+18:-this.columnsWidthCollection[n])>this._gridWidth))return!1;d.isFrozen=i,o._refreshFrozenColumns(),i&&(o._allowFreezingDefault=this._frozenColumnsLength>0),o._off(o.element,"mousewheel DOMMouseScroll",o._mouseWheel),this._frozenColumnsLength&&o._on(o.element,"mousewheel DOMMouseScroll",o._mouseWheel),o._updateWrapRowHeights(null,"virtualRefresh")},updateCheckboxColumn:function(i){var l,n,o,r=this,a=r.model.columns,d=r.getColumnByField(i);r._checkboxSelection&&(e.each(a,function(e,t){t.showCheckbox=!1}),t.isNullOrUndefined(d)||(l=a.indexOf(d))>-1&&(a[l].showCheckbox=!0),o={},(n={}).selectionType=t.TreeGrid.SelectionType.Checkbox,o.selectionSettings=n,r._refreshSelectionSettings(o,"selectionSettings"))},_refreshSelectionSettings:function(i,l){var n,o,r,a=this,d=a.model,s=!1;s=!t.isNullOrUndefined(i[l].selectionType)||!t.isNullOrUndefined(i[l].selectionMode),"selectionType"==l?(d.selectionSettings.selectionType=i[l],s=!0):"selectionMode"==l?(d.selectionSettings.selectionMode=i[l],s=!0,d.showColumnChooser&&d.showColumnOptions&&a.columnAddDialogTemplate()):e.extend(d.selectionSettings,i[l]),n=d.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox&&d.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row,(!t.isNullOrUndefined(i[l].enableHierarchySelection)&&d.selectedItems.length>0||!n&&a._checkboxSelection)&&(a._isFromSetmodel=!0,a.selectAllRows(!1),a._isFromSetmodel=!1),(a._checkboxSelection||n)&&(a._checkboxSelection=n,a._processEditing(),(!n&&"checkboxState"==a._checkboxColumnName||d.columns[0].nonColumn&&"checkboxState"!=a._checkboxColumnName)&&(o=d.columns[d.treeColumnIndex],d.columns[0].isFrozen&&(d.columns[0].isFrozen=!1,a._frozenColumnsLength-=1,r=a._frozenColumns.indexOf(d.columns[0]),a._frozenColumns.splice(r,1),d.scrollSettings.frozenColumns=this._frozenColumnsLength),d.columns.splice(0,1),o&&(d.treeColumnIndex=d.columns.indexOf(o))),a._checkboxSelection||(a._checkboxColumnName=null),a._$gridHeaderContent.replaceWith(a._renderGridHeader()),a._setWidthToHeaders(),a._trigger("headerRefresh"),d.allowFiltering&&a._resizeFilteringElements(),s&&(a._addInitTemplate(),this.renderRecords()),a.setWidthToColumns(),a.getScrollElement().ejScroller("refresh"),a._updateScrollCss(),a._updateHeaderScrollLeft(),d.selectedItems.length>0&&a.selectAllRows()),d.isFromGantt&&a._processEditing()},_setModel:function(i){var l,n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C,x,v,S,R,T,b,y,I=this,D=I.model,E=I.getUpdatedRecords();for(l in i)switch(l){case"enableAltRow":D.enableAltRow=i[l],I._addInitTemplate(),I.renderRecords(h),I._updateWrapRowHeights("header","refreshAll");break;case"allowFiltering":!D.allowFiltering&&I._filteredColumnValueID.length>0&&I._clearAllFilter(I._filteredColumnValue),D.allowFiltering=i[l],I._initiateSetModel(),D.allowFiltering=i[l];var M=(O=I.getScrollElement().ejScroller("instance")).scrollLeft(),k=0,F=O.scrollTop();I._$gridHeaderContent.replaceWith(I._renderGridHeader()),I._setWidthToHeaders(),I._trigger("headerRefresh"),D.showTotalSummary&&(k=I.element.find(".e-footersummaryrowdiv").outerHeight()),e("#"+I._id).addClass("e-treegrid-overflow"),I._viewPortHeight=I.element.height()-(I._getNonContentHeight()+k),e("#"+I._id).removeClass("e-treegrid-overflow"),I._frozenColumnsLength>0&&I._$gridContent.css("height",I._viewPortHeight),O.option("height","auto"==D.sizeSettings.height?0:I._viewPortHeight),D.enableVirtualization&&(C=D.currentViewData.length,x=D.rowHeight,C*(x+=D.showDetailsRow&&!D.showDetailsRowInfoColumn?D.detailsRowHeight:0)<I._viewPortHeight&&(C>0?(F-=I._viewPortHeight-(C-1)*x)<0&&(F=0):(I.processBindings(),I.renderRecords()))),D.showColumnChooser&&D.showColumnOptions&&I.columnAddDialogTemplate(),D.allowFiltering&&"menu"==D.filterSettings.filterType&&0==I._renderedFilterMenuDialog.length&&I._renderFilterMenu(),this.setWidthToColumns(),O.scrollY(F,!0),O.scrollX(M,!0),I._updateHeaderScrollLeft(M),I._updateScrollCss(),I._updateWrapRowHeights("row,total","refreshAll");break;case"enableResize":I.model.enableResize=i[l],D.enableResize?I._on(e(window),"resize",I._windowResize):I._off(e(window),"resize",I._windowResize);break;case"isResponsive":I.model.isResponsive=i[l],D.isResponsive?(I._on(e(window),"resize",I._windowResize),e("#"+I._id+"_toolbarItems").addClass("e-treegridadaptivetoolbar"),I._mediaQueryUpdate(),I._off(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),I._on(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this))):(I._off(e(window),"resize",I._windowResize),I._off(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),e("#"+I._id+"_toolbarItems").removeClass("e-treegridadaptivetoolbar"),I._mediaQueryUpdate());break;case"enableVirtualization":D.enableVirtualization=i[l],I._prevSelectedItem,n=I.selectedRowIndex()&&E[I.selectedRowIndex()],I._vScrollDist=1,I.processBindings(),D.enableVirtualization||(this._frozenColumnsLength>0?(I._$frozenTableContent.css({top:0}),I._$movableTableContent.css({top:0})):I._$tableContent.css({top:0})),n&&I.selectedRowIndex(E.indexOf(n)),(h={}).requestType=t.TreeGrid.Actions.Refresh,I.sendDataRenderingRequest(h),I._updateWrapRowHeights(null,"refreshAll"),I._isRowEdit=D.isEdit=!1,I._cancelSaveTools(),I._clearColumnMenu(),I._clearContextMenu(),this._removeDetailsRow(),I._vScrollDist=0;break;case"allowColumnResize":D.allowColumnResize=i[l],D.allowColumnResize&&(I._resizer=new t.gridFeatures.gridResize(I)),I._enableColumnResizeEvents();break;case"allowSorting":D.allowSorting=i[l],I.sortSetting(i[l]),D.showColumnChooser&&D.showColumnOptions&&I.columnAddDialogTemplate();break;case"allowPaging":if(o=I.element.find("#"+I._id+"Pager"),D.allowPaging){I._updateTotalRecordsCount(),I.element.append(I._renderGridPager()),I.element.append(o),I.element.find(".e-pager").css({width:I._gridWidth-2});M=(O=I.getScrollElement().ejScroller("instance")).scrollLeft(),F=O.scrollTop();I._viewPortHeight=I._getViewPortHeight(),D.showTotalSummary&&(I._viewPortHeight-=I._$totalSummaryRowContainer.outerHeight()),I._frozenColumnsLength>0&&I._$gridContent.css("height",I._viewPortHeight),O.option("height","auto"==D.sizeSettings.height?0:I._viewPortHeight),O.scrollY(F,!0),O.scrollX(M,!0),I._pagerHeight=e(o).outerHeight(),I.gotoPage()}else r=e(o).outerHeight(),e(o).remove(),I._viewPortHeight=I._viewPortHeight+r,this._frozenColumnsLength>0&&I._$gridContent.css("height",I._viewPortHeight),I.getScrollElement().ejScroller({height:I._viewPortHeight}),D.pageSettings.totalRecordsCount>0?(D.pageSettings.totalRecordsCount=null,I._refreshDataSource()):I.refreshContent(),I.renderRecords(),I._isRefreshAddedRecord=!1;I._updateWrapRowHeights("header","refreshAll");break;case"dragTooltip":(a=i[l].tooltipItems)&&!Array.isArray(a)&&(a=a.length>0?a.split(","):[],i[l].tooltipItems=a),e.extend(D.dragTooltip,i[l]),I._createDragTooltipTemplate(),I.refreshContent();break;case"allowDragAndDrop":D.allowDragAndDrop=i[l],jQuery.uaMatch(navigator.userAgent),I.refreshContent();break;case"sortSettings":e.extend(D.sortSettings,i[l]),I.refreshContent(),(d={}).requestType=t.TreeGrid.Actions.Sorting,I.sendDataRenderingRequest(d);break;case"allowSelection":D.allowSelection=i[l],D.allowSelection||(I._checkboxSelection&&D.selectedItems.length>0&&(I._isFromSetmodel=!0,I.selectAllRows(!1),I._isFromSetmodel=!1),I.clearSelection(-1),I.selectedRowIndex(-1),I.model.selectedItem=null,I._cancelSaveTools());break;case"allowTextWrap":case"headerTextOverflow":"allowTextWrap"==l&&(D.allowTextWrap=i[l]),"headerTextOverflow"==l&&(D.headerTextOverflow=i[l],I._$gridHeaderContent.replaceWith(I._renderGridHeader()),I.setWidthToColumns(),I._trigger("headerRefresh"),I.getScrollElement().ejScroller("refresh"),I._updateScrollCss()),"allowTextWrap"==l&&(I._addInitTemplate(),I.renderRecords(h),I.model.showTotalSummary&&I._createTotalSummaryRow()),I._updateWrapRowHeights(null,"refreshAll");break;case"selectionType":case"selectionMode":case"selectionSettings":this._initiateSetModel(),I.clearAllSelection(),I._refreshSelectionSettings(i,l),I.model.allowSelection&&"multiple"==I.model.selectionSettings.selectionType&&0==e("#"+I._id+"_selectionpopup").length&&!I.model.isFromGantt&&I._renderMultiSelectionIndicator();break;case"showSummaryRow":D.showSummaryRow=i[l],D.showSummaryRow?(I._createSummaryRow(),(d={}).requestType=t.TreeGrid.Actions.Refresh,I.sendDataRenderingRequest(d)):(e(I.element).find(".e-summaryrow").hide(),D.updatedRecords=I._spliceSummaryRows(D.updatedRecords),D.allowPaging&&(I._updateCurrentViewData(),(d={}).requestType=t.TreeGrid.Actions.Refresh,I.sendDataRenderingRequest(d))),I.updateCollapsedRecordCount(),I._updateWrapRowHeights("header"),I.updateHeight(),(D.allowTextWrap||"wrap"==D.headerTextOverflow)&&I._updateGridContentHeight();break;case"totalSummaryHeight":if(!D.showTotalSummary)return;I._createTotalSummaryRow(),I._viewPortHeight=I._getViewPortHeight(),I._viewPortHeight-=I._$totalSummaryRowContainer.outerHeight(),I._updateSummaryHeight();break;case"collapsibleTotalSummary":if(!D.showTotalSummary)return;if(1==D.summaryRows.length)return void(D.collapsibleTotalSummary=!1);I._addInitTemplate(),I._createTotalSummaryRow(),D.collapsibleTotalSummary||(I._viewPortHeight=I._getViewPortHeight(),I._viewPortHeight-=e(I._$totalSummaryRowContainer).outerHeight(),I._updateSummaryHeight());break;case"showTotalSummary":D.showTotalSummary=i[l],D.showTotalSummary?(I._createTotalSummaryRow(),I._viewPortHeight=I._getViewPortHeight(),I._viewPortHeight-=e(I._$totalSummaryRowContainer).outerHeight()):(e(I.element).find(".e-footersummaryrowdiv").remove(),I._$totalSummaryRowContainer=null,I._$footertableContent=null,I._$footerContainer=null,I._footerSummaryRecord=[],I._footerSummaryRows=[],I._viewPortHeight=I._getViewPortHeight()),I._updateSummaryHeight();break;case"selectedRowIndex":this.isEdit||this._isRowEdit?this.selectedRowIndex(E.indexOf(I._prevSelectedItem)):(this.selectedRowIndex()>=0&&!t.isNullOrUndefined(this.selectedRowIndex())&&D.allowSelection&&E.length>this.selectedRowIndex()&&this.getExpandStatus(E[this.selectedRowIndex()])?(s=this.selectedRowIndex(),I._rowSelectingEventTrigger(this._previousIndex,s)||(D.showSummaryRow&&(c=I._spliceSummaryRows(D.updatedRecords)[s],s=E.indexOf(c)),I.selectRows(s),I._rowSelectedEventTrigger(s))):(I.clearSelection(-1),I.selectedRowIndex(-1),I.model.selectedItem=null,I._previousIndex=-1),I._cancelSaveTools());break;case"selectedCellIndexes":D.allowSelection&&"cell"==D.selectionSettings.selectionMode&&I.selectCells(i[l]);break;case"showStackedHeader":case"stackedHeaderRows":D.showStackedHeader&&(D.stackedHeaderRows&&D.stackedHeaderRows.length>0||i.stackedHeaderRows&&i.stackedHeaderRows.length>0)?(t.getObject("stackedHeaderRows.length",i)&&(D.stackedHeaderRows=i.stackedHeaderRows),I.getHeaderTable().find(".e-stackedHeaderRow").length>0&&I.getHeaderTable().find(".e-stackedHeaderRow").remove(),I._refreshStackedHeader()):I.getHeaderTable().find(".e-stackedHeaderRow").length>0&&I.getHeaderTable().find(".e-stackedHeaderRow").remove();break;case"editSettings":e.extend(D.editSettings,i[l]),I._processEditing(),I._enableEditingEvents(),I._updateToolbarItems(),D.editSettings.allowDeleting&&D.editSettings.showDeleteConfirmDialog&&t.isNullOrUndefined(I._confirmDialog)&&I._renderConfirmDialog();break;case"allowKeyboardNavigation":D.allowKeyboardNavigation=i[l];break;case"dataSource":(u={}).requestType=t.TreeGrid.Actions.RefreshDataSource,u.isUpdateColumns=!1,I._isRowEdit||I.model.isEdit||I._trigger("actionBegin",u)||(I._fieldNamesToQuery=[],I._assignedIdCollections=[],I._assignedParendIDs=[],I._refreshDataSource(u));break;case"columns":D.columns=i[l].slice(0),I._validateColumnFields(),I._validateColumnVisible(!0),I._refreshFrozenColumns(),I._updateWrapRowHeights(null,"refreshAll");break;case"rowHeight":D.rowHeight=i[l],I._addInitTemplate(),I.renderRecords(h),I.model.showTotalSummary&&(I._createTotalSummaryRow(),I._viewPortHeight=I._getViewPortHeight(),I._viewPortHeight-=I._$totalSummaryRowContainer.outerHeight(),I._updateSummaryHeight()),I.updateHeight();break;case"treeColumnIndex":I.columnIndex(i[l]);break;case"showColumnChooser":D.showColumnChooser=i[l],I._$gridHeaderContent.replaceWith(I._renderGridHeader()),I.setWidthToColumns(),I._trigger("headerRefresh"),I.getScrollElement().ejScroller("refresh"),I._updateScrollCss(),D.showColumnChooser?(I._renderColumnChooser(),D.allowFiltering&&"menu"==D.filterSettings.filterType&&0==I._renderedFilterMenuDialog.length&&I._renderFilterMenu()):(I._clearColumnMenu(),e("#"+I._id+"ccDiv_wrapper").remove(),e("#"+I._id+"filterMenu_wrapper").remove()),I._updateWrapRowHeights("row,total","refreshAll"),D.isFromGantt&&(I._addEmptyColumntoGrid(),this._updateHeaderScrollLeft(this.getScrollElement().ejScroller("model.scrollLeft")));break;case"showColumnOptions":D.showColumnOptions=i[l],I._$gridHeaderContent.replaceWith(I._renderGridHeader()),I.setWidthToColumns(),I._trigger("headerRefresh"),I.getScrollElement().ejScroller("refresh"),I._updateScrollCss(),D.showColumnChooser&&D.showColumnOptions?(I.columnAddDialogTemplate(),I._renderUpdateConfirmDialog()):(I._clearColumnMenu(),e("#"+I._id+"ccDiv_wrapper").remove(),e("#"+I._id+"filterMenu_wrapper").remove()),I._updateWrapRowHeights("row,total","refreshAll"),D.isFromGantt&&I._addEmptyColumntoGrid();break;case"locale":I._clearContextMenu(),I._clearColumnMenu(),I._removeDetailsRow(),D.locale=i[l],I._setCultureInfo(),I._processEditing(),I._addInitTemplate(),I.refreshContent(),I._$gridHeaderContent.replaceWith(I._renderGridHeader()),I.renderRecords(h),I.setWidthToColumns(),I._trigger("headerRefresh"),I.getScrollElement().ejScroller("refresh"),I._updateScrollCss(),D.showColumnChooser&&I._renderColumnChooserList(!0),D.toolbarSettings.showToolbar&&I._updateToolbar(),D.allowPaging&&I.getPager().ejPager("option",i[l]).ejPager("refreshPager"),I.model.showColumnChooser&&I.model.showColumnOptions&&(I.columnAddDialogTemplate(),I._renderUpdateConfirmDialog()),D.allowFiltering&&"menu"==D.filterSettings.filterType&&I._renderFilterMenu(),I._updateWrapRowHeights(null,"refreshAll");break;case"toolbarSettings":e.extend(I.model.toolbarSettings,i[l]),I._updateToolbar(),I._updateWrapRowHeights("header","refreshAll");break;case"contextMenuSettings":e.extend(I.model.contextMenuSettings,i[l]),D.contextMenuSettings.showContextMenu||I._clearContextMenu(),this._removeDetailsRow();break;case"enableCollapseAll":D.enableCollapseAll=i[l],D.enableCollapseAll?I.collapseAll():I.expandAll();break;case"showDetailsRow":D.showDetailsRow=i[l],this._updateDetailsRowProperties("showDetailsRow");break;case"detailsRowHeight":D.detailsRowHeight=i[l],this._updateDetailsRowProperties("detailsRowHeight");break;case"detailsTemplate":D.detailsTemplate=i[l],this._updateDetailsRowProperties("detailsTemplate");break;case"showDetailsRowInfoColumn":D.showDetailsRowInfoColumn=i[l],this._updateDetailsRowProperties("showDetailsRowInfoColumn");break;case"altRowTemplateID":this._initiateSetModel(),D.altRowTemplateID=i[l],I._addInitTemplate(),I.renderRecords(h),I._updateWrapRowHeights("header"),this.updateHeight(),(D.allowTextWrap||"wrap"==D.headerTextOverflow)&&I._updateGridContentHeight();break;case"rowTemplateID":this._initiateSetModel(),D.rowTemplateID=i[l],I._addInitTemplate(),I.renderRecords(h),I._updateWrapRowHeights("header"),this.updateHeight(),(D.allowTextWrap||"wrap"==D.headerTextOverflow)&&I._updateGridContentHeight();break;case"pageSettings":this._initiateSetModel(),D.allowPaging&&(g={},e.extend(D.pageSettings,i[l]),e.extend(g,D.pageSettings),delete g.template,this.getPager().ejPager("option",g).ejPager("refreshPager"),i[l].totalRecordsCount>0?I._refreshDataSource():I.gotoPage());break;case"sizeSettings":this._initiateSetModel(),e.extend(D.sizeSettings,i[l]),this._calculateDimensions(),this._getViewPortHeight()<=0&&(D.sizeSettings.height="450px",this._updateElementHeight()),this._windowResize();break;case"readOnly":D.readOnly=i[l];break;case"showGridCellTooltip":D.showGridCellTooltip=i[l];break;case"showGridExpandCellTooltip":D.showGridExpandCellTooltip=i[l];break;case"allowMultiSorting":D.allowMultiSorting=i[l];break;case"query":D.query=t.isNullOrUndefined(i[l])?t.Query():i[l],I._refreshDataSource();break;case"filterSettings":if(D.allowFiltering){if(i.filterSettings.filterType||"filterbar"!=D.filterSettings.filterType)if(i.filterSettings.filterType){I.clearFilter(),D.allowFiltering=!0,e.extend(I.model.filterSettings,i[l]),I._initiateSetModel(),I._isExcelFilter&&(I._isExcelFilter=!1,I._excelFilter.resetExcelFilter(),I._excelFilter=null,I._excelColTypes=[]);var O;M=(O=I.getScrollElement().ejScroller("instance")).scrollLeft(),F=O.scrollTop();I._$gridHeaderContent.replaceWith(I._renderGridHeader()),I._setWidthToHeaders(),I._trigger("headerRefresh"),e("#"+I._id).addClass("e-treegrid-overflow"),I._viewPortHeight=I._getViewPortHeight(),e("#"+I._id).removeClass("e-treegrid-overflow"),"menu"==D.filterSettings.filterType&&0==I._renderedFilterMenuDialog.length?I._renderFilterMenu():"excel"==D.filterSettings.filterType&&I._renderExcelFilter(),I._frozenColumnsLength>0&&I._$gridContent.css("height",I._viewPortHeight),O.option("height","auto"==D.sizeSettings.height?0:I._viewPortHeight),D.enableVirtualization&&(C=D.currentViewData.length,x=D.rowHeight,C*(x+=D.showDetailsRow&&!D.showDetailsRowInfoColumn?D.detailsRowHeight:0)<I._viewPortHeight&&(C>0?(F-=I._viewPortHeight-(C-1)*x)<0&&(F=0):(I.processBindings(),I.renderRecords()))),D.showColumnChooser&&D.showColumnOptions&&I.columnAddDialogTemplate(),this.setWidthToColumns(),O.scrollY(F,!0),O.scrollX(M,!0),I._updateHeaderScrollLeft(M),I._updateScrollCss()}else"excel"==D.filterSettings.filterType&&(I._excelColTypes=[],I._excelFilter.resetExcelFilter(),I._excelFilter=null,I._renderExcelFilter());else{for(h={},e.extend(I.model.filterSettings,i[l]),m=I.model.filterSettings,p=t.isNullOrUndefined(m.filterBarMode)?"immediate":m.filterBarMode,_=e.extend([],m.filteredColumns),f=0;f<D.columns.length;f++)D.columns[f].allowFiltering&&I._clearFilterElementValue(D.columns[f]);for(m.filteredColumns=_,m.filterBarMode=p,h.requestType="filtering",w=0;w<_.length;w++)e("#"+I._id+"_"+_[w].field.split(".").join("")+"_filterbarcell").val(_[w].value);I._ensureDataSource(h),I._off(I.element,"keyup",".e-filterbarcell input",I._filterBarHandler),I._off(I.element,"click",".e-filterbarcell .e-checkbox",I._filterBarHandler),"immediate"==p&&(I._on(I.element,"keyup",".e-filterbarcell input",I._filterBarHandler),I._off(I.element,"click",".e-filterbarcell .e-checkbox")._on(I.element,"click",".e-filterbarcell .e-checkbox",I._filterBarHandler))}i.filterSettings.filterHierarchyMode&&I.clearFilter()}break;case"searchSettings":for(S in v=i[l])switch(S){case"searchHierarchyMode":I.model.searchSettings.searchHierarchyMode=v[S],I.element.find("input.e-searchinput").val(""),e("span.e-searchcancel").addClass("e-hide"),I.search("")}case"columnResizeSettings":this._initiateSetModel(),e.extend(D.columnResizeSettings,i[l]),this._updateGridResizeSettings(),D.columnResizeSettings.columnResizeMode==t.TreeGrid.ColumnResizeMode.FixedColumns?this._updateTableWidth():(this._frozenColumnsLength>0?(R=e(this.getHeaderTable()[1]),T=e(this.getContentTable()[1]),b=D.showTotalSummary?e(this._$footertableContent[1]):null):(R=this.getHeaderTable(),T=this.getContentTable(),b=D.showTotalSummary?e(this._$footertableContent[0]):null),R.css("width","").removeClass("e-tableLastCell"),T.css("width","").removeClass("e-tableLastCell"),b&&b.css("width","").removeClass("e-tableLastCell")),this._updateScrollCss();break;case"cssClass":for(this.element.removeClass(I._cssClass).addClass(i[l]),this.model.allowPaging&&e("#"+this._id+"Pager").ejPager("model.cssClass",i[l]),D.toolbarSettings.showToolbar&&e("#"+I._id+"_toolbarItems").ejToolbar("model.cssClass",i[l]),I._updateConfirmDialog&&I._updateConfirmDialog.data("ejDialog")&&I._updateConfirmDialog.ejDialog("model.cssClass",i[l]),y=0;y<I._renderedFilterMenuDialog.length;y++)"stringedit"==I._renderedFilterMenuDialog[y]?(e("#"+this._id+"filterStringMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[l]),e("#"+this._id+"filterStringMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[l]),e("#"+this._id+"filterStringMenuDiv_wrapper").find(".e-autocomplete").ejAutocomplete("model.cssClass",i[l])):"numericedit"==I._renderedFilterMenuDialog[y]?(e("#"+this._id+"filterNumericMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[l]),e("#"+this._id+"filterNumericMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[l]),e("#"+this._id+"filterNumericMenuDiv_wrapper").find(".e-numerictextbox").ejNumericTextbox("model.cssClass",i[l])):"datepicker"==I._renderedFilterMenuDialog[y]?(e("#"+this._id+"filterDatepickerMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[l]),e("#"+this._id+"filterDatepickerMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[l]),e("#"+this._id+"filterDatepickerMenuDiv_wrapper").find(".e-datepicker").ejDatePicker("model.cssClass",i[l])):"datetimepicker"==I._renderedFilterMenuDialog[y]?(e("#"+this._id+"filterDatetimePickerMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[l]),e("#"+this._id+"filterDatetimePickerMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[l]),e("#"+this._id+"filterDatetimePickerMenuDiv_wrapper").find(".e-datetimepicker").ejDateTimePicker("model.cssClass",i[l])):"#"+I._renderedFilterMenuDialog[y]=="dropdownedit"?(e("#"+this._id+"filterDropdownMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[l]),e("#"+this._id+"filterDropdownMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[l])):"#"+I._renderedFilterMenuDialog[y]=="booleanedit"&&(e("#"+this._id+"filterBooleanMenuDiv_wrapper").find(".e-dropdownlist").ejDropDownList("model.cssClass",i[l]),e("#"+this._id+"filterBooleanMenuDiv_wrapper").find(".e-button").ejButton("model.cssClass",i[l]));this.columnAddDialogTemplate(),e("#"+I._id+"ConfirmDialog_wrapper").find(".e-button").ejButton("model.cssClass",i[l]),this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&(t.isNullOrUndefined(I.model.editSettings.dialogEditorTemplateID)||""==I.model.editSettings.dialogEditorTemplateID)?I._treeGridAddEditDialog():this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&!t.isNullOrUndefined(I.model.editSettings.dialogEditorTemplateID)&&""!=I.model.editSettings.dialogEditorTemplateID&&I._treeGridAddEditDialogTemplate(),D.showColumnChooser&&this._renderColumnChooserList(!0),I._cssClass=i[l];break;case"enableLoadOnDemand":D.enableLoadOnDemand=i[l],I._refreshDataSource()}},_updateSummaryHeight:function(){var e,i,l,n,o=this,r=this.model,a=o.getScrollElement().ejScroller("instance"),d=a.scrollLeft(),s=a.scrollTop();e=s,o._frozenColumnsLength>0&&o._$gridContent.css("height",o._viewPortHeight),a.option("height","auto"==r.sizeSettings.height?0:o._viewPortHeight),r.enableVirtualization&&(i=r.currentViewData.length,l=r.rowHeight,i*(l+=r.showDetailsRow&&!r.showDetailsRowInfoColumn?r.detailsRowHeight:0)<o._viewPortHeight&&(i>0?(s-=o._viewPortHeight-(i-1)*l)<0&&(s=0):(o.processBindings(),o.renderRecords()))),a.scrollY(s,!0),a.scrollX(d,!0),o._updateHeaderScrollLeft(d),o._updateScrollCss(),o._updateWrapRowHeights("header","refreshAll"),e==s&&(o._updateCurrentViewData(),(n={}).requestType=t.TreeGrid.Actions.Refresh,o.sendDataRenderingRequest(n))},_initiateSetModel:function(){var e=this;e._saveEditedElements(),e._clearContextMenu(),e._clearColumnMenu(),e._removeDetailsRow()},_updateDetailsRowProperties:function(e){var i,l=this,n=this.model;(n.isEdit||this._isRowEdit)&&(this.cancelRowEditCell(),this._cancelSaveTools()),this.clearColumnMenu(),this._clearContextMenu(),this._removeDetailsRow(),l._detailsRowHeight=n.showDetailsRow&&n.detailsTemplate&&!n.showDetailsRowInfoColumn?n.detailsRowHeight:0,n.flatRecords.forEach(function(e){e.isDetailsExpanded=!(!n.showDetailsRow||!n.detailsTemplate)&&!n.showDetailsRowInfoColumn}),"detailsTemplate"!=e&&"detailsRowHeight"!=e||!n.showDetailsRowInfoColumn?(l._$gridHeaderContent.replaceWith(l._renderGridHeader()),l._addInitTemplate(),this.onScrollHelper(0),l.refreshContent(),l._isRendered=!1,(i={}).requestType=t.TreeGrid.Actions.Refresh,l.sendDataRenderingRequest(i),l.setWidthToColumns(),l._isRendered=!0,l._trigger("headerRefresh"),l._trigger("refresh"),this._eventBindings(),this._hideCollapsedDetailsRows(),l.getScrollElement().ejScroller("refresh"),l._updateScrollCss()):l._addInitTemplate(),l._updateWrapRowHeights(null,"refreshAll")},_hideCollapsedDetailsRows:function(){var t=this,i=this.model;i.showDetailsRow&&i.detailsTemplate&&!i.showDetailsRowInfoColumn&&(this._frozenColumnsLength>0?e(t.getTreeGridRows()[0]).add(t.getTreeGridRows()[1]).filter("tr.e-collapsedrowexpandeddetailsrow").css("display","none"):e(t.getTreeGridRows()).filter("tr.e-collapsedrowexpandeddetailsrow").css("display","none"))},_updateToolbar:function(){var t=this,i=t.model,l=t.getScrollElement().ejScroller("instance"),n=l.scrollLeft(),o=l.scrollTop();e("#"+t._id+"_toolbarItems").remove(),e("#"+t._id+"_toolbarItems_Main").remove(),i.toolbarSettings.showToolbar&&t._renderToolbarTemplate().insertBefore(e("#"+t._id+"e-gridheader")),i.isEdit&&t.cancelEditCell(),t._isRowEdit&&(t.cancelRowEditCell(),t._cancelSaveTools()),t._viewPortHeight=t._getViewPortHeight(),t._frozenColumnsLength>0&&t._$gridContent.css("height",t._viewPortHeight),l.option("height","auto"==i.sizeSettings.height?0:t._viewPortHeight),i.enableVirtualization&&(t.processBindings(),t.renderRecords()),l.option("scrollTop",o),l.option("scrollLeft",n),t._clearContextMenu(),this._removeDetailsRow()},_refreshDataSource:function(i){var l,n=this,o=this.model;(n._isRowEdit||n.model.isEdit)&&n.cancelRowEditCell(),n.resetModelCollections(),n._createdAt="load",i&&i.isUpdateColumns&&(n._validateColumnFields(),n._validateColumnVisible(!0),n._refreshFrozenColumns(!0)),n._dataManager=n.dataSource()instanceof t.DataManager?n.dataSource():null!=n.dataSource()?t.DataManager(n.dataSource()):null,this.dataSource()instanceof t.DataManager||this.dataSource()?(n._isForDataSourceRefresh=!0,n._initDatasource()):null==this.dataSource()&&((l={}).requestType=t.TreeGrid.Actions.RefreshDataSource,n._ensureDataSource(l),n._createdAt=null,(o.showSummaryRow||o.showTotalSummary)&&n._summaryRow()),e(".e-tooltiptable").remove()},refreshContent:function(){var e={};e.requestType=t.TreeGrid.Actions.Refresh,this.processBindings(e)},resetModelCollections:function(){var e=this,t=e.model;t.currentViewData=[],t.flatRecords=[],t.parentRecords=[],t.updatedRecords=[],t.summaryRowRecords=[],t.ids=[],e.secondaryDatasource=[],e._parentRecords=[],e._storedIndex=-1,e._idGenerator=-1,e._taskIds=[],e._jsonData=null,e._lastInsertedId=-1},_initPrivateProperties:function(){var i=this,l=this.model;i._isInManualExpandCollapse=!1,i._id=i.element.attr("id"),i.columnsWidthCollection=[],i._cSortedColumn=null,i._taskIds=[],i._maxZIndex=0,i._cSortedDirection=null,i._dataManager=null,i._persistCollapseState=!1,i._filteredRecords=[],i._disabledToolItems=[],i._currentFilterColumn=[],i._fieldColumnNames=[],i._multiSortRequest=null,i._$gridContainer=null,i._$gridContent=null,i._$gridContentTable=null,i._$gridHeaderTable=null,i._$gridHeaderContainer=null,i._$totalSummaryRowContainer=null,i._recordsCount=null,i._$gridRows=null,i._gridRows=null,i._commandColumnLength=0,this._frozenColumnsLength=0,i._initFrozenColumns(),i._allowFreezingDefault=this._frozenColumnsLength>0,i._calculateDimensions(),i._headerColumnNames=[],i._hiddenColumns=[],i._multiSelectCtrlRequest=!1,i._multiSelectShiftRequest=!1,i._ganttTouchTrigger=!1,i._moveRow=!1,i._draggedRecords=[],i._offset=0,i._previousIndex=-1,i._prevRBottom=0,i._prevRTop=0,i._prevScrollTop=0,i._prevScrollLeft=0,i._prevVBottom=0,i._resizer=null,i._scrollTop=0,i._scrollLeft=0,i._searchString="",i._fieldName="",i._selectedCellsinARow=[],i._currentRecordIndex=-1,i._sortedRecords=[],i._storedIndex=-1,i._rowIndex=-1,i._$tableContent=null,i._$footertableContent=null,i._$footerContainer=null,i._summaryExpanded=!0,i._tempsortedrecords=[],i._totalHeight=0,i._viewPortHeight=0,i._recordIndexCount=0,i._totalCollapsedRecordCount=0,i._visibleColumns=[],i._visibleRange=null,i._vScrollDir=1,i._vScrollDist=0,i._cellEditTemplate=e(),i._tooltipTimer,i._totalBorderWidth=2,i._totalBorderHeight=1,i._toolboxTooltipTexts=null,i._contextMenuTexts=null,i._columnMenuTexts=null,i._deleteColumnText=null,i._okButtonText=null,i._cancelButtonText=null,i._confirmDeleteText=null,i._dropDownListBlanksText=null,i._editTypeText=null,i._textAlignType=null,i._clipMode=null,i._dropDownListClearText=null,i._trueText=null,i._falseText=null,i._rowDragIndexes=[],i._dropCancel=!1,i._cellEditingDetails={cellValue:null,rowIndex:-1,columnIndex:-1,fieldName:null,_data:null,cellEditType:"",cancelSave:!1,defaultData:null,insertedTrCollection:[],data:null},i._previousSelectedCellDetails={rowElement:null,cellElement:null,cellIndex:-1,rowIndex:-1},i._shiftKeyFirstElementDetails={firstElementRowIndex:-1,firstElementCellIndex:-1},i._selectedCellDetails=[],i._focusingRowIndex=-1,i._rowIndexOfLastSelectedCell=-1,i._lastSelectedCellIndex=-1,i._isEnterKeyPressed=!1,i._isShiftKeyNavigation=!1,i._scrollBarHeight=18,i._removedCount=0,i._$gridHeaderContent=null,i.secondaryDatasource=[],i._contextMenuItems=null,i._subContextMenuItems=null,i._createContextMenuTemplate(),i._createColumnMenuTemplate(),i._retrivedData=this.dataSource(),i._createdAt="load",i._isInExpandCollapseAll=!1,i._isLoadonDemand=!1,i._assignedIdCollections=[],i._totalItemCounts=null,i._assignedParendIDs=[],i._fieldNamesToQuery=[],i._isForDataSourceRefresh=!1,i._allParentItems=[],i._queryForLoadonDemand=[],i._pageRecordCountOnDemand=null,i._isFromDemandMethod=!1,i._dataManager=i.dataSource()instanceof t.DataManager?i.dataSource():null!=i.dataSource()?t.DataManager(i.dataSource()):null,i._dragMouseDown=!1,i._dragTooltip=!1,i._dragMouseLeave=!1,i._timerDragDown=null,i._timerDragUp=null,i._isDataManagerUpdate=!1,i._jsonData=null,i._isRefreshAddedRecord=!1,i._isInAdd=!1,i._maxRowIndex=0,i._isRendered=!1,this._updateGridResizeSettings(),i.batchChanges={added:[],deleted:[],changed:[],updatedHierarchyRowIndexData:[]},i._batchEditCancel=!1,i._isSummaryRow=!1,i._flatChildRecords=[],i._footerSummaryRecord=[],i._filteredChildRecords=[],i._parentRecords=[],i._zerothLevelParentRecords=[],i._detailsRowHeight=0,l.showDetailsRow&&l.detailsTemplate&&!l.showDetailsRowInfoColumn&&(i._detailsRowHeight=l.detailsRowHeight),i._isEmptyRow=!1,i._prevSelectedItem=null,i._dataSourcefields=[],i._columnDialogTexts=null,i._columnDialogTitle=null,i._addColumnFields=[],i._addColumnFieldsTxt=[],i._targetColumnIndex=0,i._insertPosition=null,i._updateconfirmDialog=null,i._columnRenameDialog=null,i._renderedSubMenuType=null,i.localizedLabels=i._getLocalizedLabels(),i._gridRecordsCount=l.pageSettings.totalRecordsCount,i._gridPager=null,i._summaryRowsCount=0,i._updatedPageData=[],i._isNextPage=!1,l.selectionSettings.selectionType="single"!=l.selectionSettings.selectionType?l.selectionSettings.selectionType:"single"!=l.selectionType?l.selectionType:l.selectionSettings.selectionType,l.selectionSettings.selectionMode="row"!=l.selectionSettings.selectionMode?l.selectionSettings.selectionMode:"row"!=l.selectionMode?l.selectionMode:l.selectionSettings.selectionMode,i._idGenerator=-1,i._checkboxColumnName=null,i._isFromSetmodel=!1,i._flatFilteredRecords=[],i._checkboxSelection=l.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox&&l.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row,i._addCheckboxColumn=this._getDefaultCheckboxColumn(),i._filteredColumnValue=[],i._filteredColumnValueID=[],i._filterIconTarget=null,i._renderedFilterMenuDialog=[],i._filtermenutext=null,i._headerDragStatus="",i._draggedColumn=null,i._mouseDragged=!1,i.treeIndentLevelWidth=!t.isNullOrUndefined(l.indentLevelWidth)&&l.isFromGantt?l.indentLevelWidth:i.treeIndentLevelWidth?i.treeIndentLevelWidth:10,i._draggedColumnTemplate=null,i._viewPortWidth=i._gridLeft=0,i._responsiveMinWidth=768,i._dy=i._dx=0,i._isTouchEvent=!1,i._isTouchTrigger=!1,i._currentEditRecordDialogIndex=-1,i._isTreeAddEditDialogSave=!1,i._displayContextMenu=!!l.contextMenuSettings.showContextMenu,i._isEmptyRowDeleted=!1,i._cssClass=this.model.cssClass,i._batchEditStarts=!1,i._batchSaveCancel="",i._batchSaveConfirmText=null,i._batchSaveLostChangesText=null,i._cancelEditText=null,i._batchTempDetails={},i._autoHideColumns=[],i._autoShowColumns=[],i._textWrapRowsDatas=[],i._textWrapNoCalculate=!1,i._expandCollapsePages=[],i._expandCollapseSettings={state:"",atLevel:"",level:0},i._excelFilter=null,i._menuColTypes=[],i._excelColTypes=[],i._isExcelFilter=!1,i._customFilter=null,i._mediaStatus=!1,i._filterString="",i._isCloseFilterMenu=!1,i._isRemoteData=!1,i._lastInsertedId=-1,i._confirmDialog=null,i._shiftSelectedRecord=null,i._deleteRowIndex=-1,i._isFromContextmenu=!1,i._emptyRowIndex=-1},_getDefaultCheckboxColumn:function(){return{field:"checkboxState",headerText:"",allowEditing:!1,allowDelete:!1,allowSorting:!1,allowFiltering:!1,allowCellSelection:!1,isFrozen:!1,nonColumn:!0,editType:"booleanedit",width:50,textAlign:"center"}},_updateGridResizeSettings:function(){var e={resizeMode:"fixedcolumns"==this.model.columnResizeSettings.columnResizeMode?"control":this.model.columnResizeSettings.columnResizeMode};this.model.resizeSettings=e},_calculateDimensions:function(){var e,i,l=this,n=this.model;if(n.isFromGantt||(n.sizeSettings.width&&l.element.css("width",n.sizeSettings.width),n.sizeSettings.height?l.element.css("height",n.sizeSettings.height):l.element[0].style.height?n.sizeSettings.height=l.element[0].style.height:l.element.height(450)),l._gridHeight=Math.round(l.element.height()),l._gridWidth=Math.round(l.element.width()),this._frozenColumnsLength>0){for(e=0,i=0;i<=this._frozenColumnsLength;i++)n.columns[i]&&(e+=t.isNullOrUndefined(n.columns[i].width)?150:parseInt(n.columns[i].width));l._gridWidth<e&&(l.element.css("width",e),n.sizeSettings.width=l._gridWidth=e)}},_initFrozenColumns:function(){var i,l,n,o=[],r=[],a=0,d=0,s=this.model,c=s.columns;for(i=c[s.treeColumnIndex],s.showTotalSummary&&s.collapsibleTotalSummary&&(l=c[this._summaryColumnIndex]),n=0;n<c.length;n++)!0===c[n].isFrozen?(o.push(c[n]),(t.isNullOrUndefined(c[n].visible)||c[n].visible||c[n]==i)&&(a+=1)):(r.push(c[n]),(t.isNullOrUndefined(c[n].visible)||c[n].visible||c[n]==i)&&(d+=1));o.length>0&&(s.columns.length&&s.columns.length==o.length&&((r=o.splice(o.length-1,1))[0].isFrozen=!1),s.columns=e.merge(e.merge([],o),r)),this._frozenColumns=o,this._unFrozenColumns=r,0==a&&this._frozenColumns[0]&&(this._frozenColumns[0].visible=!0),0==d&&this._unFrozenColumns[0]&&(this._unFrozenColumns[0].visible=!0),i&&(s.treeColumnIndex=s.columns.indexOf(i)),s.showTotalSummary&&s.collapsibleTotalSummary&&(this._summaryColumnIndex=s.columns.indexOf(l)),this._frozenColumnsLength=o.length,s.scrollSettings.frozenColumns=this._frozenColumnsLength},updateAltRowOnCollapseAll:function(){var e,t,i,l=this.model;if(l.enableAltRow&&l.enableCollapseAll)for(e=l.parentRecords,i=0;i<e.length;i++)(t=e[i]).isSummaryRow||(t.isAltRow=i%2!=0)},updateAltRowOnRendering:function(){for(var e,t=this.model.updatedRecords.filter(function(e){return null==e.parentItem?e:e.parentItem.expanded?e:void 0}),i=0;i<t.length;i++)(e=t[i]).isSummaryRow||(e.isAltRow=i%2!=0)},_checkDataBinding:function(){var t=this,i=t.model;e("#"+t._id).addClass("e-treegrid-overflow"),t._createdAt=null,t.element.addClass("e-treegrid-core"),t.element.attr("tabindex","0"),i.cssClass&&this.element.addClass(i.cssClass),t._renderToolbar(),t._checkboxSelection&&t._updateCheckboxColumnName(),i.isFromGantt&&i.enableSerialNumber&&t._updateTreeColumnIndex(),t._renderAfterColumnInitialize(),(t.model.showColumnChooser||i.contextMenuSettings.showContextMenu)&&t._renderColumnChooser(),t.model.allowFiltering&&"menu"==i.filterSettings.filterType?t._renderFilterMenu():i.allowFiltering&&"excel"==i.filterSettings.filterType&&t._renderExcelFilter(),t._setWidthToHeaders(),t.model.allowPaging&&t.element.append(t._renderGridPager()),t._viewPortHeight=t._getViewPortHeight(),(t.model.editSettings.showConfirmDialog||t.model.editSettings.showDeleteConfirmDialog)&&t._renderConfirmDialog(),!i.isFromGantt&&t._viewPortHeight<0&&t._updateElementHeight(),t._searchString=i.searchSettings.key,t._ensureDataSource(),i.showSummaryRow&&t._createSummaryRow(),i.isFromGantt||t.updateAltRowOnCollapseAll(),i.expandStateMapping&&i.enableAltRow&&t.updateAltRowOnRendering(),t._initGridRender(),t._$gridContent=e("#"+t._id+"e-gridcontent"),t._$gridContainer=e("#"+t._id+"e-gridcontainer"),t._$tableContent=e("#"+t._id+"e-table"),t._$frozenTableContent=e("#"+t._id+"frozene-table"),t._$movableTableContent=e("#"+t._id+"movablee-table"),t._viewPortHeight=t._getViewPortHeight(),t._$gridContent.css({height:t._viewPortHeight+"px"}),t.element.find(".e-pager").css({width:t._gridWidth-2}),t._pagerHeight=t.element.find(".e-pager").outerHeight(),i.showTotalSummary&&(t._createTotalSummaryRow(),t._viewPortHeight=t._getViewPortHeight(),(!i.allowPaging||i.sizeSettings.height)&&(t._viewPortHeight-=t._$totalSummaryRowContainer.height()<i.totalSummaryHeight?t._$totalSummaryRowContainer.height():i.totalSummaryHeight,t._viewPortHeight=t._viewPortHeight-1)),t._updatePagerTextAlignment(),t._wireEvents(),t.setWidthToColumns(),t._trigger("headerRefresh"),t._renderScroller(),t._updateWrapRowHeights(),i.allowTextWrap&&i.enableVirtualization&&(t._textWrapRowsDatas=t._getAvgTextWrapRowHeight("getAvgHeight")),t.updateHeight(),t._updateScrollCss(),t._resizeFilteringElements(),t._updateFixedTableBorder(),t._initialEndRendering(),(i.allowTextWrap||"wrap"==i.headerTextOverflow)&&t._updateGridContentHeight(),i.isFromGantt&&t._addEmptyColumntoGrid(),i.isFromGantt?(t._isDataManagerUpdate=i.dataManagerUpdate.isDataManagerUpdate,t._jsonData=i.dataManagerUpdate.jsonData):t._checkDataManagerUpdate(),t.model.allowSelection&&"multiple"==t.model.selectionSettings.selectionType&&!t.model.isFromGantt&&t._renderMultiSelectionIndicator(),e("#"+t._id).removeClass("e-treegrid-overflow")},_renderMultiSelectionIndicator:function(){this._multiSelectPopup=t.buildTag("div.e-treegridpopup#"+this._id+"_selectionpopup","",{display:"none"});var e=t.buildTag("div.e-popupcontent"),i=t.buildTag("div.e-downtail e-tail"),l=t.buildTag("span.e-rowselect e-icon");e.append(l),this._multiSelectPopup.append(e),this._multiSelectPopup.append(i),this.element.append(this._multiSelectPopup)},getUpdatedDataManagerData:function(){return this._jsonData},_updateTreeColumnIndex:function(){var t,i,l=this.model,n=l.columns,o=+l.treeColumnIndex;e.map(n,function(e){if("taskId"==e.field)return t=e,!1}),(i=n.indexOf(t))==o&&(l.treeColumnIndex=i!=n.length-1?o+1:o-1)},_updateWrapRowHeights:function(e,i,l,n){var o,r=this,a=this.model;(a.allowTextWrap||"wrap"==a.headerTextOverflow)&&r._$frozenTableContent.length>0&&(r.getScrollElement().ejScroller("refresh"),"wrap"==a.headerTextOverflow&&(t.isNullOrUndefined(e)||-1==e.indexOf("header"))&&r._updateHeaderHeight(),a.allowTextWrap&&(t.isNullOrUndefined(e)||-1==e.indexOf("row"))&&(t.isNullOrUndefined(l)&&t.isNullOrUndefined(n)?r._updateRowHeight():r._updateRowHeight(l,n),a.showTotalSummary&&(t.isNullOrUndefined(e)||-1==e.indexOf("total"))&&r._updateTotalSummaryHeight(),r.getScrollElement().ejScroller("refresh"),o=r.getScrollElement().ejScroller("model.scrollTop"),r._getFrozenScrollElement().scrollTop(o))),"virtualRefresh"!=i||!a.allowTextWrap&&"wrap"!=a.headerTextOverflow?"refreshAll"==i&&(a.allowTextWrap||"wrap"==a.headerTextOverflow)&&(r.updateHeight(),r._updateGridContentHeight()):(a.allowTextWrap&&a.enableVirtualization&&r.updateHeight(),r._updateGridContentHeight()),"auto"==a.sizeSettings.height&&r._updateContentHeight()},_updateHeaderHeight:function(){var t=this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).find("tr")[0],i=this.getHeaderContent().find("#e-movableheaderdiv"+this._id).find("tr")[0];e(i).css("height","auto"),e(t).css("height","auto"),t.offsetHeight>i.offsetHeight?e(i).css("height",t.offsetHeight):i.offsetHeight>t.offsetHeight&&e(t).css("height",i.offsetHeight)},_updateTotalSummaryHeight:function(){for(var t,i,l=this,n=this.model,o=e(l._$footertableContent[0]).find("tr"),r=e(l._$footertableContent[1]).find("tr"),a=e(o).length,d=0;d<a;d++)e(r[d]).css("height",n.rowHeight),e(o[d]).css("height",n.rowHeight),(t=e(o[d]).height())>=(i=e(r[d]).height())?(e(r[d]).css("height",t),e(o[d]).css("height",t)):i>t&&(e(o[d]).css("height",i),e(r[d]).css("height",i));l._$totalSummaryRowContainer.hasClass("e-scroller")&&l._$totalSummaryRowContainer.ejScroller("refresh")},_updateRowHeight:function(i,l){var n;if(this.getRows().length>0){var o,r=this,a=this.model,d=0,s=0,c=0,u=0,g=[],m=[];for(t.isNullOrUndefined(i)?(s=0,u=r.getRows()[0]?r.getRows()[0].length:0,g=r.getRows()[0],m=r.getRows()[1]):(a.enableVirtualization&&"rowEdit"!=l&&(o=a.currentViewData[i],i=r.getUpdatedRecords().indexOf(o)),u=i+1,g[s=i]=e(t.TreeGrid.getRowByIndex(r,i)[0]),m[s]=e(t.TreeGrid.getRowByIndex(r,i)[1])),n=s;n<u;n++)(t.isNullOrUndefined(i)||"rowEdit"!=l&&"savecell"!=l)&&"resize"!=l||(e(g[n]).css("height",a.rowHeight),e(m[n]).css("height",a.rowHeight)),"rowEdit"!=l&&((d=e(g[n]).height())>=(c=e(m[n]).height())?(e(m[n]).css("height",d),e(g[n]).css("height",d)):c>d&&(e(g[n]).css("height",c),e(m[n]).css("height",c)))}},_checkDataManagerUpdate:function(){var e=this,i=this.dataSource();e._isDataManagerUpdate=!1,e._jsonData=null,i instanceof t.DataManager&&(i.dataSource.offline&&i.dataSource.json?(e._isDataManagerUpdate=!0,e._jsonData=i.dataSource.json):i.dataSource.offline||(e._isDataManagerUpdate=!0,e._jsonData=e._retrivedData))},_initDatasource:function(){var e,i,l=this,n=l.model;n.isFromGantt?(l._isLoadonDemand=n.isLoadonDemand,l._checkDataBinding()):this.dataSource()instanceof t.DataManager?(t.isNullOrUndefined(l._waitingPopupObj)?l._renderWaitingPopup():l._waitingPopupObj.show(),e=this.dataSource().adaptor instanceof t.UrlAdaptor||this.dataSource().adaptor instanceof t.WebMethodAdaptor||this.dataSource().adaptor instanceof t.WebApiAdaptor||this.dataSource().adaptor instanceof t.ODataAdaptor,i=0!=t.pvt.filterQueries(n.query.queries,"onTake").length||0!=t.pvt.filterQueries(n.query.queries,"onPage").length||0!=t.pvt.filterQueries(n.query.queries,"onWhere").length,l._isRemoteData=e,e&&!this.dataSource().dataSource.offline&&!i&&n.enableLoadOnDemand?(l._isLoadonDemand=!0,l._getAndRenderRecordsonDemand()):(l._isLoadonDemand=!1,n.query.requiresCount(),this.dataSource().executeQuery(n.query).done(t.proxy(function(e){l._renderQueriedRecords(e,l)})).fail(t.proxy(function(e){l._triggerFailureEvent(e,l)})))):this.dataSource()?(l._retrivedData=l.dataSource(),l._renderQueriedRecords(null,l,l._retrivedData)):l._checkDataBinding()},_intersectionObjects:function(e,t){for(var i,l=[];e.length>0&&t.length>0;)-1==(i=t.indexOf(e[0]))?e.shift():(l.push(e.shift()),t.splice(i,1));return l},_getAndRenderRecordsonDemand:function(){var i,l=this,n=l.model;n.query.requiresCount(),n.pageSettings.pageSizeMode=t.TreeGrid.PageSizeMode.Root,n.parentIdMapping?l._queryAndRenderParentRecords():(i=l._updateQueryForLoadonDemand(),l.dataSource().executeQuery(i).done(t.proxy(function(e){l._pageRecordCountOnDemand=e.count,l._renderQueriedRecords(e,l),l._setScrollTop(),l.updateHeight()})).fail(t.proxy(function(e){l._triggerFailureEvent(e,l)}))),l._allParentItems=e.extend([],n.parentRecords)},_renderWaitingPopup:function(){e(this.element).ejWaitingPopup({showOnInit:!0}),this._waitingPopupObj=e(this.element).data("ejWaitingPopup")},_renderQueriedRecords:function(e,i,l){var n,o,r=i.model;if(l)i._retrivedData=l;else if(i._retrivedData=e.result,0==i._fieldNamesToQuery.length&&i._retrivedData.length>0)for(n in e.result[0])i._fieldNamesToQuery.push(n);0==r.flatRecords.length&&(r.allowPaging&&r.parentIdMapping&&(i._isRemoteData?r.pageSettings.totalRecordsCount=e.count:t.isNullOrUndefined(r.pageSettings.totalRecordsCount)?r.pageSettings.totalRecordsCount=e&&!t.isNullOrUndefined(e.count)?e.count:null:i._retrivedData=i._retrivedData.splice(r.pageSettings.totalRecordsCount)),i._createQueriedRecords(i._retrivedData)),i._isForDataSourceRefresh?((o={}).requestType=t.TreeGrid.Actions.RefreshDataSource,i._ensureDataSource(o),r.isFromGantt||i._checkDataManagerUpdate(),-1!==i.selectedRowIndex()&&i.selectedRowIndex()<i.model.currentViewData.length&&i.selectRows(i.selectedRowIndex()),i.getScrollElement().hasClass("e-scroller")&&i.getScrollElement().ejScroller("refresh"),(r.showSummaryRow||r.showTotalSummary)&&i._summaryRow(),i._createdAt=null,i._isForDataSourceRefresh=!1):(r.showSummaryRow&&r.printingEnabled&&(i._parentRecords=i._getParentRecords(r.updatedRecords,i)),i._checkDataBinding()),e&&i._waitingPopupObj.hide()},_createQueriedRecords:function(i){var l,n,o,r=this,a=r.model;if(a.idMapping&&a.parentIdMapping&&i.length>0){for(l=[],r._taskIds=[],r._lastInsertedId=-1,n=0;n<i.length;n++)o=i[n],l.push(e.extend(!0,{},o)),t.isNullOrUndefined(o[a.idMapping])||(r._updateLastInsertedId(o[a.idMapping]),r._taskIds.push(o[a.idMapping]));r._reconstructDatasource(l),r._createRecords(r.secondaryDatasource)}else i&&r._createRecords(i)},_queryAndRenderParentRecords:function(){var i,l,n=this,o=n.model;o.hasChildMapping?n._renderRootRecords(n):0==n._assignedIdCollections.length&&0==n._assignedParendIDs.length?(i=t.Query(),l=t.pvt.filterQueries(o.query.queries,"onSelect"),i.queries=e.extend([],o.query.queries),i.requiresCount(),l.length>0&&i.queries.splice(e.inArray(l[0],i.queries),1),i.select(o.parentIdMapping,o.idMapping),this.dataSource().executeQuery(i).done(t.proxy(function(e){e.result.map(function(e){n._assignedIdCollections.push(e[o.idMapping]),e[o.parentIdMapping]&&-1==n._assignedParendIDs.indexOf(e[o.parentIdMapping])&&n._assignedParendIDs.push(e[o.parentIdMapping])}),n._totalItemCounts=e.result.length,n._renderRootRecords(n)})).fail(t.proxy(function(e){n._triggerFailureEvent(e,n)}))):n._renderRootRecords(n)},_renderRootRecords:function(e){var i=e._updateQueryForLoadonDemand();e.dataSource().executeQuery(i).done(t.proxy(function(t){e._renderZerothLevelParentItems(t)})).fail(t.proxy(function(t){e._triggerFailureEvent(t,e)}))},_renderExpandedChildRecords:function(e){var t=this,i=t.model;t._ensureDataSource(e),i.showSummaryRow&&(t._parentRecords=t._allParentItems,t._createSummaryRow()),i.enableAltRow&&t.updateAltRow(),t.sendDataRenderingRequest(e),t._setScrollTop(),t.updateHeight(),t._waitingPopupObj.hide()},_triggerFailureEvent:function(e,t){t._waitingPopupObj.hide();var i={error:e.error};t._trigger("actionFailure",i)},_renderZerothLevelParentItems:function(t){var i=this,l=i.model;i._pageRecordCountOnDemand=t.count,i._renderQueriedRecords(t,i),i._allParentItems=e.extend([],l.parentRecords),i._isForDataSourceRefresh=!1,i._maxRowIndex=i._totalItemCounts},_updateQueryForLoadonDemand:function(){var i=this,l=i.model,n=new t.Query,o=t.Predicate(l.parentIdMapping,t.FilterOperators.equal,null);return n.queries=e.extend([],l.query.queries),l.parentIdMapping&&n.where(o),l.allowPaging&&n.page(i._currentPage(),i.model.pageSettings.pageSize),n.requiresCount(),i._queryForLoadonDemand=n,n},_reconstructDatasource:function(e){var i,l,n,o,r,a=this,d=a.model;for(l=t.Predicate(d.parentIdMapping,t.FilterOperators.notEqual,"null"),i=t.DataManager(e).executeLocal(t.Query().where(l).group(d.parentIdMapping)),n=[],d.childMapping||(d.childMapping="Children"),o=0;o<i.length;o++)!t.isNullOrUndefined(i[o].key)&&(r=a._taskIds.indexOf(i[o].key))>-1?e[r][d.childMapping]=d.hierarchyRowIndexMapping&&i[o].items.length>1?t.DataManager(i[o].items).executeLocal(t.Query().sortBy(d.hierarchyRowIndexMapping,t.sortOrder.Ascending,!1)):i[o].items:n.push.apply(n,i[o].items);a.secondaryDatasource=a._intersectionObjects(e,n),d.hierarchyRowIndexMapping&&a.secondaryDatasource.length>1&&(a.secondaryDatasource=t.DataManager(a.secondaryDatasource).executeLocal(t.Query().sortBy(d.hierarchyRowIndexMapping,t.sortOrder.Ascending,!1)))},_windowResize:function(){var i,l,n,o,r,a,d,s,c,u,g,m,p,h,_,f;if(this.element.is(":visible")){i=this,l=this.model,e("#"+i._id).addClass("e-treegrid-overflow");var w,C,x,v=i._$gridHeaderContent,S=i._$totalSummaryRowContainer,R=e("#"+i._id+"_toolbarItems"),T=l.sizeSettings.height,b=l.sizeSettings.width,y=i.element[0].style.width,I=i.element[0].style.height;if(i._clearContextMenu(),i.model.isResponsive||t.isTouchDevice()?t.isTouchDevice()||i._clearColumnMenu("resize"):(i._clearColumnMenu(),i._clearFilterMenu()),l.isResponsive&&i._isExcelFilter&&(i._checkBoxDiv&&i._checkBoxDiv.ejScroller({width:"100%"}).ejScroller("refresh"),i._customFilter&&i._customFilter.ejDialog("width","99.9%")),w=this._frozenColumnsLength>0?this.element.find("#e-movablecontainer"+this._id):e("#"+i._id+"e-gridcontent"),e("#"+this._id+"detailscellwrapper").length>0&&this._removeDetailsRow(),b&&"number"!=typeof b&&-1!=b.indexOf("%")||-1!=y.indexOf("%")){var D=b||y;C=(e(i.element).parent().width()?e(i.element).parent().width():e(i.element).width())/100*parseInt(D)}else C=e(i.element).width();if(i._gridWidth=Math.round(C),i._frozenColumnsLength>0){for(m=0,p=0;p<i._frozenColumnsLength;p++)1==l.columns[p].visible&&(m+=i.columnsWidthCollection[p]);C<m&&(i._gridWidth=C=m)}if(T&&"number"!=typeof T&&-1!=T.indexOf("%")||-1!=I.indexOf("%")?(n=T||I,o=e(i.element).parent().height()?e(i.element).parent().height():e(i.element).height(),x=e(i.element).parent().height()?o/100*parseInt(n):e(i.element).height()):x=e(i.element).height(),x-=i._totalBorderHeight,i._$totalSummaryRowContainer&&(x-=i._$totalSummaryRowContainer.outerHeight()),C=Math.round(C-i._totalBorderWidth),d=R.length>0?R.outerHeight():0,r=w.ejScroller("option","scrollTop"),a=w.ejScroller("option","scrollLeft"),s=C,c=0,l.allowPaging&&(u=i.element.find(".e-pager").outerHeight(),g=!t.isNullOrUndefined(l.pageSettings.template),x-=u,!l.sizeSettings.height)){for(m=0,u>i._pagerHeight&&!g&&(c=u-i._pagerHeight),p=0;p<i.columnsWidthCollection.length;p++)m+=i.columnsWidthCollection[p];m>i._gridWidth&&(x+=i._scrollBarHeight)}this._frozenColumnsLength>0&&(i._$gridContent.css("width",C),i._$gridContent.css("height",x-e(v).outerHeight()-d),s=C-this._getFrozenColumnWidth()-1),i.getScrollElement().ejScroller({width:s,height:x-e(v).outerHeight()-d+c}),i._updateScrollCss(),l.showTotalSummary&&i._$totalSummaryRowContainer&&(i._$totalSummaryRowContainer.height()>=l.totalSummaryHeight&&i._$totalSummaryRowContainer.hasClass("e-scroller")?i._$totalSummaryRowContainer.ejScroller("refresh"):e(S).hasClass("e-scrollcss")&&i.getScrollElement().children(".e-vscrollbar").length>0?e(S).width(C-17):e(S).width(C)),l.toolbarSettings.showToolbar&&R.length>0&&R.width(C),i.getScrollElement().ejScroller("refresh"),e(v).hasClass("e-scrollcss")&&i.getScrollElement().children(".e-vscrollbar").length>0?e(v).width(C-17):e(v).width(C),i.updateViewPortHeight(),l.showTotalSummary&&(i._viewPortHeight=i._viewPortHeight-i._$totalSummaryRowContainer.outerHeight()),i.getScrollElement().ejScroller("option","scrollTop",r),i.getScrollElement().ejScroller("option","scrollLeft",a),i._updateHeaderScrollLeft(),l.enableVirtualization&&(i.cancelRowEditCell(),h={},_=l.rowHeight,h.requestType=t.TreeGrid.Actions.Refresh,i.processBindings(h),i.sendDataRenderingRequest(h),l.showDetailsRow&&l.detailsTemplate&&!l.showDetailsRowInfoColumn&&(_+=l.detailsRowHeight),l.currentViewData.length*_<i._viewPortHeight&&((f=r-(i._viewPortHeight-l.currentViewData.length*_))<0&&(f=0),i.getScrollElement().ejScroller("scrollY",f,!0))),l.allowPaging&&i.element.find(".e-pager").css({width:i._gridWidth-2}),i._resizeFilteringElements(),l.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||l.isFromGantt||this._updateTableWidth(!0),i.model.isResponsive&&!i.model.isFromGantt&&i._mediaQueryUpdate(),i._updatePagerTextAlignment(),i._updateWrapRowHeights(null,"virtualRefresh",null,"resize"),l.allowPaging&&!l.sizeSettings.height&&i.updateHeight(),(l.allowTextWrap||"wrap"==l.headerTextOverflow)&&i.model.allowTextWrap&&i.model.enableVirtualization&&i.updateHeight(),i._updateGridContentHeight(),i.model.allowSelection&&"multiple"==i.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&i._alignMultiSelectPopup(),e("#"+i._id).removeClass("e-treegrid-overflow"),l.isResponsive&&l.enableResize&&(i._validateColumnVisible(),i._hideColumns(i._autoHideColumns),i._showColumns(i._autoShowColumns))}},_updatePagerTextAlignment:function(){var t,i,l=this;l.model.allowPaging&&(e("#"+l._id+"Pager").find(".e-pagercontainer").outerWidth()+e("#"+l._id+"Pager").find(".e-parentmsgbar").outerWidth()+10>e("#"+l._id).width()?(t=(e("#"+l._id).width()-e("#"+l._id+"Pager").find(".e-pagercontainer").outerWidth())/2,i=(e("#"+l._id).width()-e("#"+l._id+"Pager").find(".e-parentmsgbar").width())/2,t>0&&e("#"+l._id+"Pager").find(".e-pagercontainer").css("margin-left",t+"px"),i>0&&e("#"+l._id+"Pager").find(".e-parentmsgbar").css("margin-right",i-6+"px")):(e("#"+l._id+"Pager").find(".e-pagercontainer").css("margin-left",""),e("#"+l._id+"Pager").find(".e-parentmsgbar").css("margin-right","")))},_alignMultiSelectPopup:function(){var e,t,i=this,l=i._$gridContent.offset().top+i._$gridContent.outerHeight(),n=i._$gridContent.offset().left+i._$gridContent.outerWidth();(i._multiSelectPopup.offset().top+i._multiSelectPopup.outerHeight()+10>l||i._multiSelectPopup.offset().top<i._$gridContent.offset().top||i._multiSelectPopup.offset().left+i._multiSelectPopup.outerWidth()>n||i._multiSelectPopup.offset().left<i._$gridContent.offset().left)&&(e=i._$gridContent.offset().top+i._$gridContent.outerHeight()/2,t=i._$gridContent.offset().left+i._$gridContent.outerWidth()/2,i._$gridContent.find(".e-hscrollbar").length>0&&(e-=i._$gridContent.find(".e-hscrollbar").outerHeight()),i._$gridContent.find(".e-vscrollbar").length>0&&(t-=i._$gridContent.find(".e-vscrollbar").outerWidth()),i._multiSelectPopup.offset({top:e-this._multiSelectPopup.height()/2-5,left:t-this._multiSelectPopup.width()/2}))},_mediaQueryUpdate:function(){var i,l,n,o,r=this,a="",d=r.getOffsetRect(e("#"+r._id)[0]);e("#"+r._id+"_dialogColumnAdd_wrapper").length>0&&"none"!=e("#"+r._id+"_dialogColumnAdd_wrapper").css("display")&&(e(window).width()<=r._responsiveMinWidth&&r.model.isResponsive?(e("#"+r._id+"_dialogColumnAdd").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css("width",e("#"+r._id).width()-80+"px"),e("#"+r._id+"_dialogColumnAdd").ejDialog({width:e("#"+r._id).width()+"px",height:e("#"+r._id).height()+"px",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,allowDraggable:!1,enableModal:!1,isResponsive:!1}),e("#"+r._id+"_dialogColumnAdd_wrapper").css({left:d.left+"px",top:d.top+"px"}),e("#"+r._id+"_dialogColumnAdd_wrapper").removeClass("e-shadow"),e("#"+r._id+"_dialogColumnAdd").removeClass("e-shadow")):(e("#"+r._id+"_dialogColumnAdd").ejDialog({width:"auto",height:"auto",minHeight:0,minWidth:0,showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0}),e("#"+r._id+"_dialogColumnAdd").addClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").addClass("e-treegridadaptivedialog e-treegrid-dialog"),e("#"+r._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css("width","438px"),e("#"+r._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").addClass("e-shadow"))),e("#"+r._id+"ColumnRenameDialog_wrapper").length>0&&"none"!=e("#"+r._id+"ColumnRenameDialog_wrapper").css("display")&&(e(window).width()<=r._responsiveMinWidth&&r.model.isResponsive?(e("#"+r._id+"ColumnRenameDialog").removeClass("e-treegridadaptivedialog"),r._columnRenameDialog.ejDialog({width:e("#"+r._id).width()+"px",height:e("#"+r._id).height()+"px",position:{X:d.left,Y:d.top},minHeight:"50px",minWidth:"50px",showOnInit:!1,allowDraggable:!1,enableResize:!1,enableModal:!1,isResponsive:!1}),e("#"+r._id+"ColumnRenameDialog_wrapper").css({left:d.left+"px",top:d.top+"px"}),e("#"+r._id+"ColumnRenameDialog_wrapper").removeClass("e-shadow"),e("#"+r._id+"ColumnRenameDialog").removeClass("e-shadow"),e("#"+r._id+"ColumnRenameDialog_wrapper").removeClass("e-treegridadaptivedialog")):(r._columnRenameDialog.ejDialog({width:"auto",height:"auto",minHeight:0,minWidth:0,showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0}),e("#"+r._id+"ColumnRenameDialog").addClass("e-treegridadaptivedialog"),e("#"+r._id+"ColumnRenameDialog_wrapper").addClass("e-treegridadaptivedialog e-treegrid-dialog"))),r._renderedSubMenuType?(a="",-1==r._renderedSubMenuType.indexOf("Desktop")?a=r._renderedSubMenuType:(i=r._renderedSubMenuType.indexOf("Desktop"),a=r._renderedSubMenuType.slice(0,i)),e(a+"_wrapper").length>0&&"none"!=e(a+"_wrapper").css("display")?e(window).width()<=r._responsiveMinWidth&&-1==r._renderedSubMenuType.indexOf("Desktop")&&r.model.isResponsive?(o=e("#"+r._id).height()-50+"px",e(r._renderedSubMenuType+"_wrapper").find("div.e-dialog-scroller").addClass("e-treegridadaptivewidth"),e(r._renderedSubMenuType).ejDialog({width:e("#"+r._id).width()+"px",height:e("#"+r._id).height()+"px",position:{X:d.left+"px",Y:d.top+"px"},minHeight:"50px",minWidth:"50px",showOnInit:!1,enableResize:!1,enableModal:!1,isResponsive:!1}),e(r._renderedSubMenuType).height()>e(r._renderedSubMenuType+"_wrapper").height()-48?(e(r._renderedSubMenuType+"_wrapper").find("div.e-dialog-scroller").css({height:e("#"+r._id).height()-48+"px",width:"auto",padding:"0px"}),e(r._renderedSubMenuType).ejDialog("refresh")):e(r._renderedSubMenuType+"_wrapper").find("div.e-dialog-scroller").css({height:o,width:"auto"})):t.isTouchDevice()?(-1==r._renderedSubMenuType.indexOf("Desktop")&&e(window).width()>r._responsiveMinWidth||-1!=r._renderedSubMenuType.indexOf("Desktop")&&e(window).width()<=r._responsiveMinWidth)&&(r._clearColumnMenu(),r._clearFilterMenu()):r._clearFilterMenu():(t.isTouchDevice()&&!r._renderedSubMenuType||t.isTouchDevice()&&e(a+"_wrapper").length>0&&"none"==e(a+"_wrapper").css("display"))&&r._clearColumnMenu()):(t.isTouchDevice()&&!r._renderedSubMenuType||t.isTouchDevice()&&e(a+"_wrapper").length>0&&"none"==e(a+"_wrapper").css("display"))&&r._clearColumnMenu(),r._isExcelFilter&&(l=e(window).width()>r._responsiveMinWidth,(!r._mediaStatus||r._mediaStatus&&l)&&(r._excelFilter.closeXFDialog(),r._mediaStatus=!1,r._customFilter&&(n=e(r._customFilter).attr("id"),e("#"+n).css("display","none"),e("#"+n+"_CustomFDlg_wrapper").css("display","none")))),e("#"+r._id+"ccDiv_wrapper").length>0&&"none"!=e("#"+r._id+"ccDiv_wrapper").css("display")&&(e(window).width()<r._responsiveMinWidth&&0==r._renderedSubMenuType.indexOf("AdaptiveColChooser")&&r.model.isResponsive?(o=e("#"+r._id).height()-66+"px",e("#"+r._id+"ccDiv").ejDialog({width:e("#"+r._id).width()+"px",height:e("#"+r._id).height()+"px",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,enableModal:!1,isResponsive:!1}),e("#"+r._id+"ccDiv_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"ccDiv").css({width:"100%",height:"auto"}),e("#"+r._id+"ccDiv").height()>e("#"+r._id+"ccDiv_wrapper").height()-48?(e("#"+r._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:e("#"+r._id).height()-48+"px",width:"auto",padding:"0px"}),e("#"+r._id+"ccDiv").removeClass("e-columnSelector"),e("#"+r._id+"ccDiv").ejDialog("refresh")):(e("#"+r._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:o,width:"auto",padding:"8px 16px"}),e("#"+r._id+"ccDiv").css({padding:"0px"})),e("#"+r._id+"ccDiv_wrapper").removeClass("e-shadow"),e("#"+r._id+"ccDiv").removeClass("e-shadow")):r._clearColumnMenu()),e("#"+r._id+"_dialogEdit").length>0&&"none"!=e("#"+r._id+"_dialogEdit").css("display")&&(e(window).width()<=r._responsiveMinWidth&&r.model.isResponsive?(e("#"+r._id+"_dialogEdit").ejDialog({width:e("#"+r._id).width()+"px",height:e("#"+r._id).height()+"px",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,allowDraggable:!1,enableModal:!1,isResponsive:!1}),e("#"+r._id+"_dialogEdit_wrapper").css({left:d.left+"px",top:d.top+"px"}),e("#"+r._id+"_dialogEdit_wrapper").removeClass("e-shadow").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogEdit").removeClass("e-shadow")):(e("#"+r._id+"_dialogEdit").ejDialog({width:"auto",height:"auto",minHeight:"150px",minWidth:"150px",showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0}),e("#"+r._id+"_dialogEdit_wrapper").addClass("e-shadow").addClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogEdit").addClass("e-shadow"))),r._renderedSubMenuType&&(0==r._renderedSubMenuType.indexOf("AdaptiveColChooser")||0==r._renderedSubMenuType.indexOf("ColumnDesktop"))&&r._clearColumnMenu()},updateResponsiveMinWidth:function(e){parseInt(e)<150&&(e=150),this._responsiveMinWidth=parseInt(e),this._mediaQueryUpdate()},processBindings:function(i){var l=this;if(l.model.query=new t.Query,!l._isEmptyRow&&!l._moveRow&&l._trigger("actionBegin",i))return"filtering"==i.requestType&&e("#"+l._id+"_"+i.currentFilteringColumn+"_filterbarcell").val(""),!0;l._ensureDataSource(i)},setUpdatedRecords:function(e,t,i,l,n){var o=this.model;o.flatRecords=e,o.updatedRecords=t,o.ids=i,o.parentRecords=l,this.dataSource(n)},getExpandedRecords:function(e){var t=this;return e.filter(function(e){return 1==t.getExpandStatus(e)})},updateExpandStatus:function(e,t){for(var i=e.childRecords,l=0;l<i.length;l++)i[l].isExpanded=t,i[l].hasChildRecords&&i[l].expanded&&this.updateExpandStatus(i[l],t)},_ensureDataSource:function(i){var l,n,o,r,a,d,s,c=this,u=c.model,g=u.sortSettings.sortedColumns,m=u.filterSettings.filteredColumns,p=!1,h=this.dataSource(),_=e("#"+c._id.replace("ejTreeGrid","")).data("ejGantt");if(c._filteredRecords=[],c._flatFilteredRecords=[],u.query.requiresCount(),c._queryManagar=new t.Query,c._queryManagar.requiresCount(),"array"===e.type(h)||h instanceof t.DataManager||(this.dataSource([]),h=this.dataSource()),!i||i.requestType!==t.TreeGrid.Actions.ExpandCollapse||(p=!0,c._filteredRecords=[],i.data.expanded=i.expanded,t.isNullOrUndefined(i.data.item[u.expandStateMapping])||(i.data[u.expandStateMapping]=i.expanded,i.data.item[u.expandStateMapping]=i.expanded),u.updatedRecords=[],c._flatFilteredRecords=u.flatRecords,c._filteredRecords=c._flatFilteredRecords.filter(function(e){return 1==c.getExpandStatus(e)}),u.updatedRecords=c._filteredRecords,!i.isFromExpandCollapse||i.isLastRefresh)){if(i&&"filtering"==i.requestType||(u.allowFiltering||u.isFromGantt)&&m.length){if(u.showSummaryRow&&(u.updatedRecords=c._spliceSummaryRows(u.updatedRecords),u.flatRecords=c._spliceSummaryRows(u.flatRecords)),(u.allowFiltering||u.isFromGantt)&&m.length){if(n=m[0],!c._isExcelFilter||n instanceof t.Predicate)for(n.value==c._dropDownListBlanksText?l=(l=t.Predicate(n.field,"equal",null,!0)).or(n.field,"equal","",!0):l=n.value==c._dropDownListClearText?t.Predicate(n.field,"equal","",!0):n.isComplex?n:t.Predicate(n.field,n.operator,n.value,!n.matchcase),t.isNullOrUndefined(i)&&c._storePreviousFilteredValue(n.field,n.value,n.operator),o=1;o<m.length;o++)l=m[o].isComplex?l.and(m[o]):l[m[o].predicate](m[o].field,m[o].operator,m[o].value,!m[o].matchcase),t.isNullOrUndefined(i)&&c._storePreviousFilteredValue(m[o].field,m[o].value,m[o].operator);else l=c._getExcelPredicate(i);c._queryManagar.where(l),c._filteredRecords=u.flatRecords.slice(),f=new t.DataManager(c._filteredRecords),c._tempfilteredrecords=f.executeLocal(c._queryManagar).result,c._updateFilteredRecords(c._tempfilteredrecords,!1),u.updatedRecords=c._isHierarchyFiltering&&u.enableVirtualization?c._updateFilterParent:c._filteredRecords,u.allowPaging&&u.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(u.parentRecords=c._getParentRecords(u.updatedRecords,c,!0)),u.allowSorting&&u.sortSettings.sortedColumns.length>0&&c._sortingRecords()}else u.updatedRecords=u.enableVirtualization?c.getExpandedRecords(u.flatRecords):u.flatRecords.slice(),c._updateHasFilteredChildRecordsStatus(u.updatedRecords),c._isHierarchyFiltering&&c._clearFilterLevel(c.model.flatRecords),u.allowPaging&&u.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(u.parentRecords=c._getParentRecords(u.updatedRecords,c,!0)),c._isExcelFilter&&c._getExcelPredicate(i);u.allowSearching&&0!=c._searchString.length||c._updatedFilteredRecords(i),p=!0}if(u.allowSearching&&c._searchString.length||i&&"searching"===i.requestType?(u.showSummaryRow&&(u.updatedRecords=c._spliceSummaryRows(u.updatedRecords),u.flatRecords=c._spliceSummaryRows(u.flatRecords)),r=c._searchString.length>0?u.searchSettings.operator:"contains",c._queryManagar.search(c._searchString,c.getColumnFieldNames(),r,!0),"parent"==u.filterSettings.filterHierarchyMode||c._searchString.length>0||0==u.filterSettings.filteredColumns.length?(a=!0,c._filteredRecords=u.isFromGantt?u.flatRecords.filter(function(e){return!1===e.hasChildRecords}):u.flatRecords.slice()):a=!1,u.isFromGantt&&(_.model.searchSettings={fields:c._getColumnMappingNames(),key:c._queryManagar.queries[0].e.searchKey,operator:"contains",ignoreCase:!0}),f=new t.DataManager(c._filteredRecords),c._tempfilteredrecords=f.executeLocal(c._queryManagar).result,c._updateFilteredRecords(c._tempfilteredrecords,a),u.updatedRecords=c._filteredRecords,u.allowPaging&&u.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(u.parentRecords=c._getParentRecords(u.updatedRecords,c,!0)),c._isLoadonDemand&&0==c._searchString.length&&0==c._filteredRecords&&(u.updatedRecords=u.flatRecords),u.allowSorting&&u.sortSettings.sortedColumns.length>0&&c._sortingRecords(),c._updatedFilteredRecords(i),p=!0,c.clearSelection()):(u.allowSorting&&g.length>0||i&&"sorting"==i.requestType)&&(c._sortingRecords(),u.showSummaryRow&&c._createSummaryRow(i),p||(c.updateCollapsedRecordCount(),c.updateHeight(),p=!0)),i&&("outdent"===i.requestType||"indent"===i.requestType)&&((i={}).requestType=t.TreeGrid.Actions.Refresh,p=!0),i&&u.allowPaging&&"delete"==i.requestType&&(d={},c._isLoadonDemand||(d.totalRecordsCount=c.getExpandedRecords(u.flatRecords).length,c.getPager().ejPager("option",d).ejPager("refreshPager"),s=this.getPager().ejPager("model"),c._currentPage()>s.totalPages&&c._currentPage(s.totalPages),p=!0)),p||(c._zerothLevelParentRecords=u.parentRecords.slice(),u.updatedRecords=u.enableVirtualization?u.enableCollapseAll&&!i?c._zerothLevelParentRecords:c.getExpandedRecords(u.flatRecords):u.flatRecords.slice(),c.updateCollapsedRecordCount(),c.updateHeight()),i||((i={}).requestType=u.allowPaging?t.TreeGrid.Actions.Paging:t.TreeGrid.Actions.Refresh,i.inital=!0),c._updateCurrentViewData(i.requestType),!t.isNullOrUndefined(u.printingEnabled)&&u.printingEnabled&&"currentPage"==u.pageSettings.printMode){var f,w=this.getExpandedRecords(u.updatedRecords),C=(f=new t.DataManager(w)).executeLocal(u.query);u.currentViewData=C.result}(u.isFromGantt||"save"!==i.requestType)&&"sorting"!==i.requestType&&"searching"!==i.requestType&&"delete"!==i.requestType&&"refreshDataSource"!==i.requestType&&"filtering"!==i.requestType&&"dragAndDrop"!==i.requestType&&"rowIndexUpdate"!==i.requestType&&(i.inital||"paging"!==i.requestType)||(c._isRefreshAddedRecord=!1,c.renderRecords(i),c._updateWrapRowHeights(null,"refreshAll"),c._setScrollTop(i.requestType),c._updateFixedTableBorder(i.requestType),c.getScrollElement().ejScroller("refresh"),c._updateScrollCss())}},_updatedFilteredRecords:function(t){var i=this,l=i.model;t&&("filtering"==t.requestType||"searching"==t.requestType)&&i._checkboxSelection&&l.selectionSettings.enableHierarchySelection&&("filtering"==t.requestType||"searching"==t.requestType)&&(e.each(l.updatedRecords,function(e,t){t.hasChildRecords&&i._updateParentSelection(t)}),i.selectAllRows()),l.showSummaryRow&&i._createSummaryRow(t),t&&l.showTotalSummary&&i._updateTotalSummaryRow(t),i.updateCollapsedRecordCount(),i.updateHeight(),l.enableAltRow&&i.updateAltRow()},_removeChildRecords:function(e,i){var l,n=this,o=n.model,r=t.isNullOrUndefined(i.childRecords)?[]:i.childRecords,a=e.indexOf(i);for(a>-1&&(i.checkboxState="unchecked",e.splice(a,1)),l=0;l<r.length;l++)r[l].hasChildRecords?n._removeChildRecords(e,r[l]):(a=e.indexOf(r[l]))>-1&&(r[l].checkboxState="unchecked",e.splice(a,1));i.parentItem&&o.selectionSettings.enableHierarchySelection&&n._updateParentSelection(i.parentItem)},_removeChildItem:function(e){for(var i,l,n=this,o=0;o<e.childRecords.length;o++)i=e.childRecords[o],this.dataSource()instanceof t.DataManager?this.dataSource().dataSource.offline&&this.dataSource().dataSource.json?(-1!==(l=this.dataSource().dataSource.json.indexOf(i.item))&&this.dataSource().dataSource.json.splice(l,1),i.hasChildRecords&&n._removeChildItem(i)):n._isDataManagerUpdate&&(-1!==(l=n._jsonData.indexOf(i.item))&&n._jsonData.splice(l,1),i.hasChildRecords&&n._removeChildItem(i)):(-1!==(l=this.dataSource().indexOf(i.item))&&this.dataSource().splice(l,1),i.hasChildRecords&&n._removeChildItem(i))},_updateCheckboxColumnName:function(){var e,i,l,n=this,o=n.model;if(n._checkboxSelection&&!o.rowTemplateID&&!o.altRowTemplateID){if(e=o.columns.filter(function(e){return 1==e.showCheckbox}),n._addCheckboxColumn=this._getDefaultCheckboxColumn(),n._checkboxColumnName=e.length>0?e[0].isTemplateColumn?null:e[0].field:null,t.isNullOrUndefined(n._checkboxColumnName)){if(i=o.columns[o.treeColumnIndex],o.columns[0].nonColumn)n._checkboxColumnName=o.columns[0].field;else{for(l=0;l<o.columns.length;l++)1==o.columns[l].nonColumn&&o.columns.splice(l,1);o.columns.splice(0,0,n._addCheckboxColumn),n._checkboxColumnName=n._addCheckboxColumn.field}i&&(o.treeColumnIndex=o.columns.indexOf(i))}n._frozenColumnsLength>0&&!o.columns[0].isFrozen&&n._checkboxColumnName==n._addCheckboxColumn.field&&(o.columns[0].isFrozen=!0,n._frozenColumnsLength+=1,n._frozenColumns.splice(0,0,o.columns[0]),o.scrollSettings.frozenColumns=this._frozenColumnsLength)}},batchSave:function(){var e,t,i,l=this,n=l.model,o={},r=l.batchChanges,a=r.changed,d=r.deleted,s=r.added;if(o.type="beforeBatchSave",o.batchChanges=r,l._trigger("beforeBatchSave",o))return!0;for((e=n.filterSettings.filteredColumns)&&e.length>0&&l.clearFilter(),t=0;t<a.length;t++)delete a[t].batchEditedFields;for(i=0;i<s.length;i++)delete s[i].isBatchAdd,s[i].batchEditedFields&&delete s[i].batchEditedFields;d.length&&l.deleteRow(),l._batchEditStarts&&(l._batchEditStarts=!1),l._cancelSaveTools(),l._checkboxSelection&&l._resetCheckboxState(),l.processBindings(),l.renderRecords(),o.requestType="batchSave",o.batchChanges=r,l._trigger("actionComplete",o),l.batchChanges.changed=[],l.batchChanges.added=[],l.batchChanges.deleted=[],l.batchChanges.updatedHierarchyRowIndexData=[],l._batchSaveCancel=""},batchCancel:function(){var e,t,i,l,n,o=this,r=o.model,a=o.batchChanges,d=a.changed,s=a.deleted,c=a.added,u={},g=o._mergeRecords(),m=r.filterSettings.filteredColumns;for(m&&m.length>0&&o.clearFilter(),c.length&&o.deleteRow(),e=0;e<d.length;e++){for(i in t=d[e].batchEditedFields)d[e][i]=t[i],d[e].item[i]=t[i];delete d[e].batchEditedFields}for(l=0;l<s.length;l++)o._updateBatchDeletedRecord(s[l]);if(o.batchChanges.changed=[],o.batchChanges.added=[],o.batchChanges.deleted=[],o.batchChanges.updatedHierarchyRowIndexData=[],o._batchSaveCancel="",o._batchEditStarts&&(o._batchEditStarts=!1),o._cancelSaveTools(),o._checkboxSelection&&o._resetCheckboxState(),r.showSummaryRow)for(o._batchEditCancel=!0,n=0;n<g.length;n++)u.record=g[n],o._updateSummaryRow(u);r.showTotalSummary&&(u.editType="celledit",o._updateTotalSummaryRow(u)),o.processBindings(),o.renderRecords(),o._batchEditCancel=!1},_resetCheckboxState:function(){var t,i=this,l=i.model;i._checkboxSelection&&(t=l.flatRecords,e.map(t,function(e){("checked"==e.checkboxState||"indeterminate"==e.checkboxState)&&(e.checkboxState="unchecked")}),i.selectAllRows())},_updateBatchDeletedRecord:function(e){var t,i,l,n,o=this;o.model;if(delete e.isBatchDelete,e.isBatchAdd)return o.batchChanges.added=[],o.batchChanges.added.push(e),o.deleteRow(),!0;if(e.batchEditedFields){for(i in t=e.batchEditedFields)e[i]=t[i];delete e.batchEditedFields}if(e.hasChildRecords)for(l=e.childRecords,n=0;n<l.length;n++)o._updateBatchDeletedRecord(l[n])},_processEditing:function(){var i=this,l=i.model;i._checkboxSelection&&i._updateCheckboxColumnName(),(l.editSettings.allowEditing||l.editSettings.allowAdding)&&("cellediting"===l.editSettings.editMode.toLowerCase()||"rowediting"===l.editSettings.editMode.toLowerCase()||"batchediting"==l.editSettings.editMode.toLowerCase()&&("cell"==l.editSettings.batchEditSettings.editMode||"row"==l.editSettings.batchEditSettings.editMode)||"normal"===l.editSettings.editMode.toLowerCase()&&"cell"===l.selectionSettings.selectionMode.toLowerCase()?i._addCellEditTemplate():"dialogediting"!==l.editSettings.editMode.toLowerCase()&&("batchediting"!=l.editSettings.editMode.toLowerCase()||"dialog"!=l.editSettings.batchEditSettings.editMode)||!t.isNullOrUndefined(l.editSettings.dialogEditorTemplateID)&&""!=l.editSettings.dialogEditorTemplateID?"dialogediting"!==l.editSettings.editMode.toLowerCase()&&("batchediting"!=l.editSettings.editMode.toLowerCase()||"dialog"!=l.editSettings.batchEditSettings.editMode)||t.isNullOrUndefined(l.editSettings.dialogEditorTemplateID)||""==l.editSettings.dialogEditorTemplateID||(i._treeGridAddEditDialogTemplate(),0==e("#"+this._id+"_dialogEdit").length&&this.element.append(this._renderEditDialog())):(i._treeGridAddEditDialog(),0==e("#"+this._id+"_dialogEdit").length&&this.element.append(this._renderEditDialog())))},_toolBarClick:function(t){if(t.event.which&&(3==t.event.which||2==t.event.which)||t.event.button&&2==t.event.button)return!1;this.model;var l=e(this.itemsContainer).closest(".e-treegrid"),n=l.ejTreeGrid("instance"),o=l.attr("id"),r=e("#"+n._id+"_toolbarItems");if(t.event==i&&"INPUT"==t.target.tagName&&t.currentTarget.id==o+"_search")return!1;-1!=n.model.dateFormat.toLowerCase().indexOf("hh")?e.isFunction(e.fn.ejDateTimePicker)&&e("#"+o+"EditForm").find(".e-datepicker").ejDateTimePicker("hide"):e.isFunction(e.fn.ejDatePicker)&&e("#"+o+"EditForm").find(".e-datepicker").ejDatePicker("hide");var a=t.currentTarget,d=(t.target,{itemName:t.text,currentTarget:a,model:n.model,sender:t});if(l.ejTreeGrid("instance")._trigger("toolbarClick",d))return!1;switch(e(r).ejToolbar("deselectItem",t.currentTarget),t.currentTarget.id){case o+"_add":n._toolbarOperation(o+"_add",t);break;case o+"_edit":n._toolbarOperation(o+"_edit",t);break;case o+"_delete":n._toolbarOperation(o+"_delete",t);break;case o+"_update":n._toolbarOperation(o+"_update",t);break;case o+"_cancel":n._toolbarOperation(o+"_cancel",t);break;case o+"_expandAll":n._toolbarOperation(o+"_expandAll",t);break;case o+"_collapseAll":n._toolbarOperation(o+"_collapseAll",t);break;case o+"_pdfExport":n._toolbarOperation(o+"_pdfExport",t);break;case o+"_excelExport":n._toolbarOperation(o+"_excelExport",t);break;case o+"_print":n._toolbarOperation(o+"_print",t);break;case o+"_search":n._isRowEdit?n.cancelRowEditCell():n.model.isEdit&&n.cancelEditCell()}return!1},_toolbarOperation:function(e,t){var i,l=this.element,n=l.ejTreeGrid("instance"),o=l.attr("id"),r=this,a=this.selectedItem(),d=t.target,s=r.model.allowPaging?this._updatedPageData.indexOf(a):this.selectedRowIndex();switch(n._exportTo=n.export,e){case o+"_add":"cell"==r.model.selectionSettings.selectionMode&&(r.model.editSettings.rowPosition="top"),r.model.editSettings.allowEditing&&("dialogEditing"==r.model.editSettings.editMode||"batchediting"==r.model.editSettings.editMode.toLowerCase()&&"dialog"==r.model.editSettings.batchEditSettings.editMode)?r._showTreeGridAddEditDialog(-1,"add"):r._startAdd(d,null);break;case o+"_edit":r.updateScrollBar(),r.model.editSettings.allowEditing&&("dialogEditing"==r.model.editSettings.editMode||"batchediting"==r.model.editSettings.editMode.toLowerCase()&&"dialog"==r.model.editSettings.batchEditSettings.editMode)?r._showTreeGridAddEditDialog(s):r._editRow(s);break;case o+"_delete":r.deleteRow(),r.model.editSettings.showDeleteConfirmDialog||r._cancelSaveTools(),r._isRefreshAddedRecord=!1;break;case o+"_update":"cellediting"==(i=r.model.editSettings.editMode).toLowerCase()?r._saveEditedElements():"rowediting"==i.toLowerCase()?r.saveRow():"batchediting"==i.toLowerCase()&&(r.cancelEdit(),r._batchSaveCancel="save",r.model.editSettings.showConfirmDialog?r._confirmDialog.find(".e-content").html(r._batchSaveConfirmText).end().ejDialog("open"):r.batchSave()),r._clearContextMenu(),this._removeDetailsRow(),r._focusTreeGridElement();break;case o+"_cancel":"cellediting"==(i=r.model.editSettings.editMode).toLowerCase()?r._isRowEdit?r.cancelRowEditCell():r.cancelEditCell():"rowediting"==i.toLowerCase()?r.cancelRowEditCell():"batchediting"===i.toLowerCase()&&(r._isRowEdit?r.cancelRowEditCell():r.model.isEdit&&r.cancelEditCell(),r._batchSaveCancel="cancel",r.model.editSettings.showConfirmDialog?r._confirmDialog.find(".e-content").html(r._cancelEditText).end().ejDialog("open"):r.batchCancel()),"auto"==r.model.sizeSettings.height&&r._updateContentHeight(),r._cancelSaveTools(),r._clearContextMenu(),this._removeDetailsRow();break;case o+"_expandAll":r.expandAll();break;case o+"_collapseAll":r.collapseAll();break;case o+"_pdfExport":n._exportTo(n.model.exportToPdfAction,"pdfExporting",n.model.allowMultipleExporting);break;case o+"_excelExport":n._exportTo(n.model.exportToExcelAction,"excelExporting",n.model.allowMultipleExporting);break;case o+"_print":n.print();break;case o+"_search":if(r._batchEditStarts&&!r._confirmDialog.is(":visible"))return r._batchSaveLostWarning("Searching"),r._batchTempDetails.searchTarget=t,r._batchTempDetails.searchString=t.value,!0;r._searchString!=t.value&&(r.search(t.value),r._updateToolbarItems(),r._isRefreshAddedRecord=!1)}return r._refreshToolBar(),!1},_batchSaveLostWarning:function(e){var t=this,i=t.model;"batchediting"==i.editSettings.editMode.toLowerCase()&&(i.isEdit?t.saveCell():t._isRowEdit&&t.saveRow(),t._batchSaveCancel="saveLost"+e,i.editSettings.showConfirmDialog?t._confirmDialog.find(".e-content").html(t._batchSaveLostChangesText).end().ejDialog("open"):t.batchCancel())},_renderConfirmDialog:function(){var i=this,l=t.buildTag("div.e-content",i.localizedLabels.deleteRecordText),n=t.buildTag("span.e-buttons",'<input type="button" class="e-flat e-btnsub" id='+i._id+'_ConfirmDialogOK value="'+this.localizedLabels.okButtonText+"\" /> <input type='button' class='e-flat e-btncan' id="+i._id+"_ConfirmDialogCancel value='"+i.localizedLabels.cancelButtonText+"' />",{float:"right",padding:".5em 0em"});i._confirmDialog=t.buildTag("div#"+i._id+"_ConfirmDialog",{height:"auto",width:"auto",float:"left"}),i._confirmDialog.append(l).append(n),i.element.append(i._confirmDialog),n.find("input").ejButton({cssClass:i.model.cssClass,showRoundedCorner:!0,size:"mini",click:e.proxy(i._triggerConfirm,i)}),i._confirmDialog.ejDialog({showOnInit:!1,enableAnimation:!1,showHeader:!1,width:"auto",minWidth:0,minHeight:0,enableModal:!0,enableResize:!1})},_triggerConfirm:function(t){var l,n,o=this,r=o.model;if(t!==i&&t.model.text==o.localizedLabels.okButtonText){if("save"==o._batchSaveCancel)o.batchSave();else if("cancel"==o._batchSaveCancel)o.batchCancel();else if("saveLostDrag"==o._batchSaveCancel)o._batchSaveCancel="cancel",o.batchCancel();else if("saveLostColumnMenu"==o._batchSaveCancel)o._batchSaveCancel="cancel",o.batchCancel(),o._renderColumnMenu(o._batchTempDetails.menuTarget);else if("saveLostSearching"==o._batchSaveCancel)o._batchSaveCancel="cancel",o.batchCancel(),o.search(o._batchTempDetails.searchString),o._updateToolbarItems(),o._isRefreshAddedRecord=!1;else if("saveLostPaging"==o._batchSaveCancel){if(o._batchSaveCancel="cancel",o.batchCancel(),o._prevPageNo==o._batchTempDetails.currentPage)return;o._isNextPage=!0,o._isRowEdit?o.cancelRowEditCell():o.model.isEdit&&o.cancelEditCell(),o.gotoPage(o._batchTempDetails.currentPage)}else"saveLostFiltering"==o._batchSaveCancel?(o._batchSaveCancel="cancel",o.batchCancel(),l=o._batchTempDetails,"filterbar"==r.filterSettings.filterType?o.filterColumn(l.fieldName,l.filterOperator,l.filterValue,l.predicate,l.matchcase,l.actualFilterValue):("excel"==r.filterSettings.filterType||"menu"==r.filterSettings.filterType)&&o._onHeaderClick(l.filterTarget)):o.deleteRow(null,o._isFromContextmenu,o._deleteRowIndex);o._confirmDialog.ejDialog("close"),o._cancelSaveTools()}else o._confirmDialog.ejDialog("close"),"saveLostFiltering"==o._batchSaveCancel&&"filterbar"==r.filterSettings.filterType&&((n=e(o._batchTempDetails.filterTarget)).hasClass("e-numerictextbox")?n.ejNumericTextbox({value:null}):n.hasClass("e-dropdownlist")?n.ejDropDownList({value:null}):n.closest("input").val("")),"saveLostSearching"==o._batchSaveCancel&&(o._searchString||(n=e(o._batchTempDetails.searchTarget)).hasClass("e-ejinputtext")&&n.closest("input").val("")),"saveLostPaging"==o._batchSaveCancel&&(this.getPager().ejPager("model").currentPage=o._prevPageNo,o.getPager().ejPager("refreshPager"));o._focusTreeGridElement(),o._deleteRowIndex=-1,o._isFromContextmenu=!1,o._batchSaveCancel=""},print:function(){var i,l={},n=this,o=n.model;l.requestType="print",n._trigger("actionBegin",l);var r=window.open("","print","height=452,width=1024,tabbar=no"),a=t.buildTag("div#"+n._id+"Print"),d=e.extend({},n.model),s=e.extend(!0,[],o.columns),c=s.length;if(d.toolbarSettings=e.extend({},o.toolbarSettings),d.toolbarSettings.showToolbar=d.allowPaging=!1,d.selectedItem=null,d.enableVirtualization=!1,d.query.queries=[],d.printingEnabled=!0,this._frozenColumnsLength>0){for(i=0;i<c;i++)s[i].isFrozen&&(s[i].isFrozen=!1);d.columns=s}if(this._commandColumnLength>0){for(i=0;i<c;i++)s[i].commands&&(s.splice(i,1),c--,i--);d.columns=s}o.allowPaging&&o.pageSettings.printMode==t.TreeGrid.PrintMode.CurrentPage?(d.query.queries=[{fn:"onPage",e:{pageIndex:n._currentPage(),pageSize:o.pageSettings.pageSize}}],d.dataBound=function(){this._printProcess(r)}):d.dataBound=function(){this._printProcess(r)},a.ejTreeGrid(d)},_printProcess:function(i){var l=this.element,n={requestType:"print",element:l};this.model.allowFiltering&&"filterbar"==this.model.filterSettings.filterType&&l.find(".e-filterbar").remove(),e(l).find(".e-gridheader").css({width:"auto"}),this.clearSelection(),l.show(),this._trigger("beforePrint",n),t.print(l,i),this._trigger("actionComplete",n)},contextMenuOperations:function(i){var l,n,o,r=this,a=r.model,d=r._contextMenuSelectedIndex,s=r._contextMenuEvent,c=r._contextMenuSelectedItem,u=a.editSettings,g=u.editMode.toLowerCase();switch(this._isContextMenuItems||(n=r._contextMenuColumnDetails),i){case"contextMenu_Unfreeze":0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(r._checkboxSelection&&2==r._frozenColumnsLength&&a.columns[0].nonColumn&&a.columns[0].isFrozen&&(a.columns[0].isFrozen=!1),r.freezeColumn(n.field,!1)));break;case"contextMenu_Freeze":0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(r._checkboxSelection&&a.columns[0].nonColumn&&!a.columns[0].isFrozen&&(a.columns[0].isFrozen=!0),r.freezeColumn(n.field,!0)));break;case"contextMenu_FreezePreceding":0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||r.freezePrecedingColumns(n.field));break;case"contextMenu_SortDescending":a.allowMultiSorting&&(r._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(a.isFromGantt||r.sortColumn(n.field,t.sortOrder.Descending),r._multiSortRequest=!1);break;case"contextMenu_SortAscending":a.allowMultiSorting&&(r._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(a.isFromGantt||r.sortColumn(n.field,t.sortOrder.Ascending),r._multiSortRequest=!1);break;case"Delete":r.deleteRow(null,!0,r._contextMenuSelectedIndex),r._cancelSaveTools(),r._clearContextMenu();break;case"Above":r._subContextMenuAction(c,d,"Above"),r._focusTreeGridElement();break;case"Below":r._subContextMenuAction(c,d,"Below"),r._focusTreeGridElement();break;case"Add":r._setInitialData(),r._clearContextMenu();break;case"Edit":"cellediting"==g||"batchediting"==g&&"cell"==u.batchEditSettings.editMode?(n=a.columns[r.getCellIndex(s)],t.isNullOrUndefined(n)||0==n.allowEditing||(r._focusTreeGridElement(),r._cellEditingDetails.columnIndex=r.getCellIndex(s),r._editedRowIndex=r._cellEditingDetails.rowIndex=r.getRowIndex(s),(l=r._cellEditingDetails.columnIndex>=0&&n.field)&&(r.updateScrollBar(),a.editSettings.allowEditing&&r.cellEdit(r._cellEditingDetails.rowIndex,l)&&r._editAddTools()))):"rowediting"==g||"batchediting"==g&&"row"==u.batchEditSettings.editMode?(r.updateScrollBar(),r._editRow(d)):("dialogediting"==g||"batchediting"==g&&"dialog"==u.batchEditSettings.editMode)&&r._showTreeGridAddEditDialog(d),r._clearContextMenu();break;case"Save":if("cellediting"==g||"batchediting"==g&&"cell"==u.batchEditSettings.editMode){if(!this.editFormValidate())return!0;r._isRowEdit?r._endEdit():r.saveCell()}else("rowediting"==g||"batchediting"==g&&"row"==u.batchEditSettings.editMode)&&r.saveRow();r._clearContextMenu(),r._focusTreeGridElement();break;case"Cancel":"cellediting"==g||"batchediting"==g&&"cell"==u.batchEditSettings.editMode?r._isRowEdit?r.cancelRowEditCell():a.isEdit&&r.cancelEditCell():("rowediting"==g||"batchediting"==g&&"row"==u.batchEditSettings.editMode)&&r.cancelRowEditCell(),r._clearContextMenu(),r._focusTreeGridElement();break;default:o={},this._isContextMenuItems?(o.data=c,o.menuId=i,r._triggerMenuEventHandler(i,o,!0),r._clearContextMenu()):(o.column=r._contextMenuColumnDetails,o.menuId=i,r._triggerMenuEventHandler(i,o,!1),r._clearContextMenu())}a.enableAltRow&&a.currentViewData[0]&&t.TreeGrid.updateAltRow(r,a.currentViewData[0],0,0)},_setCultureInfo:function(){var e=this,i=e.model,l=i.locale,n=e.localizedLabel,o=t.TreeGrid.Locale.default;n=i.predecessorTable||i.resourceTable?t.Gantt.Locale[l]:t.TreeGrid.Locale[l],e._toolboxTooltipTexts=n&&n.toolboxTooltipTexts?n.toolboxTooltipTexts:o.toolboxTooltipTexts,e._contextMenuTexts=n&&n.contextMenuTexts?n.contextMenuTexts:o.contextMenuTexts,e.model.isFromGantt?(e._columnMenuTexts=e.model.columnMenuTexts,e._deleteColumnText=e.model.deleteColumnText,e._okButtonText=e.model.okButtonText,e._cancelButtonText=e.model.cancelButtonText,e._columnDialogTexts=e.model.columnDialogTexts,e._columnDialogTitle=e.model.columnDialogTitle,e._confirmDeleteText=e.model.confirmDeleteText,e._editTypeText=e.model.editTypeText,e._textAlignTypeText=e.model.textAlignTypeText,e._clipModeText=e.model.clipModeText):(e._columnMenuTexts=n&&n.columnMenuTexts?n.columnMenuTexts:o.columnMenuTexts,e._columnDialogTexts=n&&n.columnDialogTexts?n.columnDialogTexts:o.columnDialogTexts,e._columnDialogTitle=n&&n.columnDialogTitle?n.columnDialogTitle:o.columnDialogTitle,e._deleteColumnText=n&&n.deleteColumnText?n.deleteColumnText:o.deleteColumnText,e._okButtonText=n&&n.okButtonText?n.okButtonText:o.okButtonText,e._cancelButtonText=n&&n.cancelButtonText?n.cancelButtonText:o.cancelButtonText,e._confirmDeleteText=n&&n.confirmDeleteText?n.confirmDeleteText:o.confirmDeleteText,e._editTypeText=n&&n.editTypeTexts?n.editTypeTexts:o.editTypeTexts,e._textAlignTypeText=n&&n.textAlignTypes?n.textAlignTypes:o.textAlignTypes,e._clipModeText=n&&n.clipModeTexts?n.clipModeTexts:o.clipModeTexts,e._dropDownListBlanksText=n&&n.dropDownListBlanksText?n.dropDownListBlanksText:o.dropDownListBlanksText,e._dropDownListClearText=n&&n.dropDownListClearText?n.dropDownListClearText:o.dropDownListClearText,e._trueText=n&&n.trueText?n.trueText:o.trueText,e._falseText=n&&n.falseText?n.falseText:o.falseText,e._batchSaveConfirmText=n&&n.batchSaveConfirmText?n.batchSaveConfirmText:o.batchSaveConfirmText,e._batchSaveLostChangesText=n&&n.batchSaveLostChangesText?n.batchSaveLostChangesText:o.batchSaveLostChangesText,e._cancelEditText=n&&n.cancelEditText?n.cancelEditText:o.cancelEditText,e.model.emptyRecordText=n&&n.emptyRecord?n.emptyRecord:o.emptyRecord,e._filterMenuTexts=n&&n.filterMenuTexts?n.filterMenuTexts:o.filterMenuTexts)},refresh:function(e,i){var l,n=this,o=n.model;t.isNullOrUndefined(e)?((l={}).requestType=t.TreeGrid.Actions.Refresh,this.sendDataRenderingRequest(l)):(n.resetModelCollections(),n._fieldNamesToQuery=[],n._assignedIdCollections=[],n._assignedParendIDs=[],o.dataSource=e,o.query=i,n.element.ejTreeGrid("destroy").ejTreeGrid(o))},_getNewIndex:function(){return this._maxRowIndex+=1,this._maxRowIndex},_getNewId:function(){return this._lastInsertedId+1},_updateLastInsertedId:function(e){var t=this,i=isNaN(parseInt(e))?t._lastInsertedId<1?1:t._lastInsertedId:parseInt(e);t._lastInsertedId=t._lastInsertedId<i?i:t._lastInsertedId},_updateHierarchyRowIndexData:function(e,t,i){var l,n=this,o=n.model,r=o.editSettings.editMode.toLowerCase();for(e.updatedHierarchyRowIndexData=[],l=i;l<t.length;l++)t[l].hierarchyRowIndex=l,o.hierarchyRowIndexMapping&&(t[l].item[o.hierarchyRowIndexMapping]=l),"batchediting"!=r?e.updatedHierarchyRowIndexData.push(t[l]):-1==n.batchChanges.updatedHierarchyRowIndexData.indexOf(t[l])&&n.batchChanges.updatedHierarchyRowIndexData.push(t[l])},_addRecord:function(i,l,n,o){var r,a,d,s,c,u,g,m,p,h,_,f,w,C,x,v=this;(v.model.isEdit||v._isRowEdit)&&v.cancelRowEditCell();var S,R,T,b,y,I,D=this.model,E=this.selectedRowIndex(),M=D.updatedRecords,k=D.flatRecords,F=D.parentRecords,O="row"==D.selectionSettings.selectionMode?this.selectedItem():M[v._rowIndexOfLastSelectedCell],H=D.columns,z=this.dataSource(),P=0,A=!1,N=!1,G=D.editSettings.editMode.toLowerCase(),L=!1,j={};if("array"===e.type(z)||z instanceof t.DataManager||(this.dataSource([]),z=this.dataSource()),t.isNullOrUndefined(i)){for(i=null,r=0;r<H.length;r++)t.isNullOrUndefined(H[r].nonColumn)&&(i=v._restoreCustomData(i,"",H[r].field));N=!0}if("batchediting"==G&&(i.isBatchAdd=!0),D.idMapping&&D.parentIdMapping&&!t.isNullOrUndefined(i[v.model.parentIdMapping])&&"child"!=l&&((a=D.flatRecords.filter(function(e){return e[D.idMapping]==i[D.parentIdMapping]})).length>0&&(O=a[0],l=t.TreeGrid.RowPosition.Child,L=!0)),(-1===E&&-1==v._rowIndexOfLastSelectedCell&&(l===t.TreeGrid.RowPosition.Above||l===t.TreeGrid.RowPosition.Below||l===t.TreeGrid.RowPosition.Child)||!l||D.selectedItems.length>1&&!v._checkboxSelection)&&(L||(l=t.TreeGrid.RowPosition.Top)),l==t.TreeGrid.RowPosition.Top||l==t.TreeGrid.RowPosition.Bottom?(y=0,I=null):l==t.TreeGrid.RowPosition.Above||l==t.TreeGrid.RowPosition.Below?(y=O.level,I=O.parentItem):l==t.TreeGrid.RowPosition.Child&&(y=O.level+1,I=O),D.idMapping&&D.parentIdMapping)if(d=i[D.idMapping],t.isNullOrUndefined(d)||""==d||"contextMenu"==o)i[D.idMapping]=v._getNewId();else if(v._validateIdValue(d))return!1;if(j.requestType="add",j.data=i,j.level=y,j.rowPosition=l,j.parentItem=I,v._trigger("actionBegin",j)){if("dialog"==o)return!1}else{switch(i=j.data,l!=j.rowPosition&&(l=j.rowPosition),i[D.childMapping]&&i[D.childMapping].length&&delete i[D.childMapping],v.selectRows(-1),T=this._getNewIndex(),l){case t.TreeGrid.RowPosition.Top:P=0,b=null,(S=v._createRecord(i,P)).index=T,k.splice(0,0,S),M.splice(0,0,S),v._isHierarchyFiltering&&v._updateFilterParent.splice(0,0,S),F.splice(0,0,S),v._updateHierarchyRowIndexData(j,F,0),v._isDataManagerUpdate?v._jsonData.splice(0,0,S.item):z.splice(0,0,S.item),R=0;break;case t.TreeGrid.RowPosition.Bottom:P=0,b=null,(S=v._createRecord(i,P)).index=T,k.push(S),M.push(S),v._isHierarchyFiltering&&v._updateFilterParent.push(S),F.push(S),v._isDataManagerUpdate?v._jsonData.push(S.item):z.push(S.item),R=M.indexOf(S);break;case t.TreeGrid.RowPosition.Above:P=O.level,b=O.parentItem,(S=v._createRecord(i,P,b)).index=T,v._isHierarchyFiltering&&O.filterLevel>-1&&(S.filterLevel=O.filterLevel),c=k.indexOf(O),u=M.indexOf(O),k.splice(c,0,S),M.splice(u,0,S),v._isHierarchyFiltering&&v._updateFilterParent.splice(u,0,S),t.isNullOrUndefined(b)?(F.splice(F.indexOf(O),0,S),v._isDataManagerUpdate?v._jsonData.splice(v._jsonData.indexOf(O.item),0,S.item):z.splice(z.indexOf(O.item),0,S.item),g=F.indexOf(O),v._updateHierarchyRowIndexData(j,F,g)):(s=b.childRecords.indexOf(O),b.childRecords.splice(s,0,S),D.parentIdMapping?(S.item[D.parentIdMapping]=S.parentItem.item[D.idMapping],S[D.parentIdMapping]=S.parentItem.item[D.idMapping],v._isDataManagerUpdate?v._jsonData.push(S.item):z.push(S.item)):b.item[D.childMapping].splice(s,0,S.item),h=b.childRecords,v._updateHierarchyRowIndexData(j,h,s)),R=u;break;case t.TreeGrid.RowPosition.Below:P=O.level,b=O.parentItem,(S=v._createRecord(i,P,b)).index=T,v._isHierarchyFiltering&&O.filterLevel>-1&&(S.filterLevel=O.filterLevel),m=k.indexOf(O),O.hasChildRecords?(c=m+v.getChildCount(O,0)+1,u=M.indexOf(O)+v._getVisibleChildRecordCount(O,0,M)+1):(c=m+1,u=M.indexOf(O)+1),k.splice(c,0,S),M.splice(u,0,S),v._isHierarchyFiltering&&v._updateFilterParent.splice(u,0,S),t.isNullOrUndefined(b)?(F.splice(F.indexOf(O)+1,0,S),v._isDataManagerUpdate?v._jsonData.splice(v._jsonData.indexOf(O.item)+1,0,S.item):z.splice(z.indexOf(O.item)+1,0,S.item),g=F.indexOf(O),v._updateHierarchyRowIndexData(j,F,g+1)):(s=b.childRecords.indexOf(O),b.childRecords.splice(s+1,0,S),D.parentIdMapping?(S.item[D.parentIdMapping]=S.parentItem.item[D.idMapping],S[D.parentIdMapping]=S.parentItem.item[D.idMapping],v._isDataManagerUpdate?v._jsonData.push(S.item):z.push(S.item)):b.item[D.childMapping].splice(s+1,0,S.item),h=b.childRecords,v._updateHierarchyRowIndexData(j,h,s+1)),R=u;break;case t.TreeGrid.RowPosition.Child:P=O.level+1,b=O,(S=v._createRecord(i,P,b)).index=T,v._isHierarchyFiltering&&O.filterLevel>-1&&(S.filterLevel=O.filterLevel+1),m=k.indexOf(O),O.hasChildRecords?(c=m+v.getChildCount(O,0)+1,O.expanded&&v.getExpandStatus(O)||((p={}).expanded=!0,p.data=O,v._isInAdd=!0,v._isRefreshAddedRecord?(p.data.expanded=!0,v.updateExpandStatus(j.data,j.expanded),v.refreshContent(),v._isRefreshAddedRecord=!1):v._expandRecord(O),M=D.updatedRecords,v._isInAdd=!1),u=M.indexOf(O)+v._getVisibleChildRecordCount(O,0,M)+1-(D.showSummaryRow?D.summaryRows.length:0)):(v._isLoadonDemand&&(O.isChildRetrieved=!0),v.getExpandStatus(O)||v._expandRecord(O.parentItem),O.hasChildRecords=!0,O.childRecords=[],O.expanded=!0,D.parentIdMapping||(O.item[D.childMapping]=[]),O.isMilestone=!1,c=m+1,u=M.indexOf(O)+1),k.splice(c,0,S),v._isHierarchyFiltering&&v._updateFilterParent.splice(u,0,S),v._isLoadonDemand?O.isChildRetrieved&&M.splice(u,0,S):M.splice(u,0,S),t.isNullOrUndefined(b)||(s=b.childRecords.indexOf(O),b.childRecords.splice(s+1,0,S),D.parentIdMapping?(S.item[D.parentIdMapping]=S.parentItem.item[D.idMapping],S[D.parentIdMapping]=S.parentItem.item[D.idMapping],v._isDataManagerUpdate?v._jsonData.push(S.item):z.push(S.item)):b.item[D.childMapping].splice(s+1,0,S.item),h=b.childRecords,v._updateHierarchyRowIndexData(j,h,0)),R=u}if(D.allowPaging&&(l==t.TreeGrid.RowPosition.Below||l==t.TreeGrid.RowPosition.Child?("root"!==D.pageSettings.pageSizeMode||t.isNullOrUndefined(O.parentItem))&&(_=v._updatedPageData[v._updatedPageData.length-1],R>(v._updatedPageData.length==D.pageSettings.pageSize?D.updatedRecords.indexOf(_):R)&&(v._currentPage(this._currentPage()+1),0)):l==t.TreeGrid.RowPosition.Top&&(v._currentPage()>1||v._currentPage()<1)?(v._currentPage(1),0):l==t.TreeGrid.RowPosition.Bottom&&v._currentPage()<D.pageSettings.totalPages&&(v._currentPage(D.pageSettings.totalPages),R)),(D.allowFiltering&&D.filterSettings.filteredColumns.length>0||v._searchString.length>0)&&v._flatFilteredRecords.push(S),N||!t.TreeGrid.RowPosition.Above&&!t.TreeGrid.RowPosition.Below)v._renderAddedRow(R,S),A=!0,v._emptyRowIndex="cell"==D.selectionSettings.selectionMode?R:null;else{j={},(H=D.columns).length;D.allowPaging||R,j.rowIndex=R,j.requestType="addNewRow",j.addedRow=i,"batchediting"!=G&&v._trigger("actionComplete",j)?M.splice(R,1):(v._updateAction(j),v._renderAddedRow(R,S),D.showSummaryRow&&("addNewRow"==j.requestType&&"child"==l&&v._createAndRenderSummaryRecords(j),v._updateSummaryRow(j)),D.showTotalSummary&&v._updateTotalSummaryRow(j),A=!0,D.idMapping&&D.parentIdMapping&&v._updateLastInsertedId(S[D.idMapping]))}"batchediting"==G&&A&&!N&&(v.batchChanges.added.push(S),v._batchEditStarts=!0),!1===D.enableVirtualization&&(D.sortSettings.sortedColumns.length>0||D.filterSettings.filteredColumns.length>0)&&(v._isRefreshAddedRecord=!0),D.allowPaging&&(M=v._updatedPageData),-1==(f=A?M.indexOf(S):E)&&(f=E),D.allowSelection&&"row"==D.selectionSettings.selectionMode&&(v._rowSelectingEventTrigger(this._previousIndex,f)||(v.selectRows(f),D.selectionSettings.enableSelectAll&&v.selectAllRows(),v._checkboxSelection&&D.selectionSettings.enableHierarchySelection&&S.parentItem&&v._updateParentSelection(S.parentItem),v._rowSelectedEventTrigger(f))),D.allowSelection||"row"!=D.selectionSettings.selectionMode||v.selectRows(f),"cell"==D.selectionSettings.selectionMode&&(v._rowIndexOfLastSelectedCell=M.indexOf(S)),v.updateScrollBar(),"isEditRow"==n?v._editRow(M.indexOf(S),S):(t.TreeGrid.refreshRow(v,D.currentViewData.indexOf(S)),v._cancelSaveTools(),D.enableAltRow&&t.TreeGrid.updateAltRow(v,v.model.currentViewData[0],0,0)),S.parentItem&&l==t.TreeGrid.RowPosition.Child&&(1==S.parentItem.childRecords.length||!S.parentItem.hasFilteredChildRecords)&&(S.parentItem.hasFilteredChildRecords=!0,t.TreeGrid.refreshRow(v,D.currentViewData.indexOf(S.parentItem))),D.allowTextWrap&&v._$frozenTableContent.length>0?(v._updateWrapRowHeights("total,header"),v.updateHeight()):D.allowTextWrap&&D.enableVirtualization&&v.updateHeight()}return v._commandColumnLength>0&&(t.isNullOrUndefined(n)&&(w=t.TreeGrid.getRowByIndex(v,f),v._refreshUnboundTemplate(w)),l==t.TreeGrid.RowPosition.Child&&(C=M.indexOf(S.parentItem),x=t.TreeGrid.getRowByIndex(v,C),v._refreshUnboundTemplate(x))),!0},_validateIdValue:function(t){var i=this,l=i.model,n=l.flatRecords;return!!(i._isLoadonDemand?e.map(i._assignedIdCollections,function(e){if(e==t)return e}):e.map(n,function(e){if(e[l.idMapping]==t)return e})).length},_closeTreegridAddEditDialog:function(t,i){var l=this,n={};if(this._off(e("#"+this._id+"_dialogEdit"),"click keypress","#EditFormDialog_"+this._id+"_Save ,#EditFormDialog_"+this._id+"_Cancel",l._buttonClick),!l._isTreeAddEditDialogSave)return n.requestType="Add"===i?"closeAddDialog":"closeEditDialog",l._trigger("actionBegin",n);l._isTreeAddEditDialogSave=!1},showAddDialog:function(){var e=this;e.model.editSettings.allowAdding&&"dialogEditing"==e.model.editSettings.editMode&&e._showTreeGridAddEditDialog(null,"add")},showEditDialog:function(e){var t=this;t.model.editSettings.allowEditing&&"dialogEditing"==t.model.editSettings.editMode&&t._showTreeGridAddEditDialog(e)},_showTreeGridAddEditDialog:function(i,l){var n,o,r,a,d=document.createElement("div"),s=this,c=e(d),u=s.getOffsetRect(e("#"+s._id)[0]),g=[],m=s.model.columns,p=s._contextMenuTexts;if((t.isNullOrUndefined(i)||-1==i)&&!l&&(i="cell"==s.model.selectionSettings.selectionMode?s.selectedCellIndexes()[0].rowIndex:s.selectedRowIndex()),g[0]=s.model.allowPaging?this._updatedPageData[i]:s.model.updatedRecords[i],l&&"add"===l.toLowerCase()){if(t.isNullOrUndefined(g[0])){for(g[0]=null,n=0;n<m.length;n++)g[0]=s._restoreCustomData(g[0],"",m[n].field);s.model.parentIdMapping&&(g[0][s.model.idMapping]=s._getNewId())}c.addClass("e-dialogaddrow")}else c.addClass("e-dialogeditedrow");t.isNullOrUndefined(s.model.editSettings.dialogEditorTemplateID)||""==s.model.editSettings.dialogEditorTemplateID?d.innerHTML=e.render[this._id+"_JSONDialogEditingTemplate"](g):t.isNullOrUndefined(s.model.editSettings.dialogEditorTemplateID)||""==s.model.editSettings.dialogEditorTemplateID||(d.innerHTML=e.render[this._id+"_JSONdialogTemplateMode"](g)),("dialogEditing"==this.model.editSettings.editMode||"batchediting"==s.model.editSettings.editMode.toLowerCase()&&"dialog"==s.model.editSettings.batchEditSettings.editMode)&&(e("#"+this._id+"_dialogEdit").html(e(d)),(o={}).cssClass=this.model.cssClass,o.enableRTL=!1,o.enableResize=!1,o.showOnInit=!1,o.content="#"+this._id,e(window).width()<=s._responsiveMinWidth&&s.model.isResponsive?(o.width=e("#"+s._id).width()+"px",o.height=e("#"+s._id).height()+"px",o.enableModal=!1,o.isResponsive=!1,o.allowDraggable=!1):(o.width="auto",o.height="auto",o.enableModal=!0,o.isResponsive=!1,o.allowDraggable=!0),o.allowKeyboardNavigation=!1,l&&"add"===l.toLowerCase()?(o.title=p.addRowText,o.beforeClose=function(e){s._closeTreegridAddEditDialog(e,"Add")&&(e.cancel=!0),s._focusTreeGridElement()}):(o.title=p.editText,o.beforeClose=function(e){s._closeTreegridAddEditDialog(e,"Edit")&&(e.cancel=!0),s._focusTreeGridElement()}),e("#"+this._id+"_dialogEdit").ejDialog(o),(r={}).data=g[0],l&&"add"===l.toLowerCase()?(r.requestType="beforeOpenAddDialog",r.rowPosition=s.model.editSettings.rowPosition):r.requestType="beforeOpenEditDialog",r.element=e("#"+s._id+"_dialogEdit"),s._trigger("actionBegin",r)||((a={}).columnIndex=i,a.data=r.data,a.requestType="beginEdit",s._refreshEditForm(a),r.data=a.data,r.requestType=l&&"add"===l.toLowerCase()?"openAddDialog":"openEditDialog",r.element=e("#"+s._id+"_dialogEdit"),s._trigger("actionBegin",r)||(e("#"+this._id+"_dialogEdit").ejDialog("open"),s._currentEditRecordDialogIndex=this.model.currentViewData.indexOf(a.data),e(window).width()<=s._responsiveMinWidth&&s.model.isResponsive?(e("#"+s._id+"_dialogEdit_wrapper").css({left:u.left+"px",top:u.top+"px"}),e("#"+s._id+"_dialogEdit_wrapper").removeClass("e-shadow").removeClass("e-treegridadaptivedialog"),e("#"+s._id+"_dialogEdit").removeClass("e-shadow")):(e("#"+s._id+"_dialogEdit_wrapper").addClass("e-shadow").addClass("e-treegridadaptivedialog"),e("#"+s._id+"_dialogEdit").addClass("e-shadow")),this._on(e("#"+this._id+"_dialogEdit"),"click keypress","#EditFormDialog_"+this._id+"_Save ,#EditFormDialog_"+this._id+"_Cancel",s._buttonClick),e("#"+s._id+"_dialogEdit").ejDialog("refresh")))),e.isFunction(e.validator)&&(s._initValidator(),s.setValidation())},addRow:function(e,t){var i=this;i.model;if(i._cancelEditState(),e)return!!i._addRecord(e,t);i._addRecord(null,t,"isEditRow")},_startAdd:function(){var e=this,t=this.model;e.model.allowSelection&&"multiple"==e.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&e._clearMultiSelectPopup(),e._addRecord(null,t.editSettings.rowPosition,"isEditRow")},_getRecordIndexByItem:function(e,i){var l=t.DataManager(i).executeLocal(t.Query().where("item",t.FilterOperators.equal,e));return l.length>0?i.indexOf(l[0]):-1},_expandRecord:function(e){if(!this._isLoadonDemand||e.isChildRetrieved)for(var i=e,l={};null!=i;)0==i.expanded&&(l.expanded=!0,l.data=i,this._isInExpandCollapseAll=!!i.parentItem,t.TreeGrid.sendExpandCollapseRequest(this,l)),i=i.parentItem},scrollOffset:function(e,t){var i=this.getScrollElement().data("ejScroller");this._saveEditedElements(),("number"==typeof t||"number"==typeof parseInt(t))&&((t=parseInt(t))>=0&&this.getMaxScrollHeight()>=t&&i.scrollY(t,!0)),("number"==typeof e||"number"==typeof parseInt(e))&&((e=parseInt(e))>=0&&this.getMaxScrollWidth()>=e&&i.scrollX(e,!0))},getScrollTopOffset:function(){return this.getScrollElement().ejScroller("model.scrollTop")},getScrollLeftOffset:function(){return this.getScrollElement().ejScroller("model.scrollLeft")},scrollToTop:function(){var e,t=this.model,i=this.getUpdatedRecords(),l=-1;this.isVScroll()&&(this._saveEditedElements(),(i=t.allowPaging?i:this.getExpandedRecords(t.updatedRecords)).length>0&&(l=0,e=i[0],l=i.indexOf(e),this.updateScrollBar(l),t.allowSelection&&!this._rowSelectingEventTrigger(this.selectedRowIndex(),l)&&(this.selectRows(l),this._rowSelectedEventTrigger(l))))},scrollToBottom:function(){var e,t,i=this.model,l=-1;this.isVScroll()&&(this._saveEditedElements(),(e=i.allowPaging?this.getUpdatedRecords():this.getExpandedRecords(i.updatedRecords)).length>0&&(t=e[l=e.length-1],l=i.allowPaging?e.indexOf(t):i.updatedRecords.indexOf(t),this.updateScrollBar(l),i.allowSelection&&!this._rowSelectingEventTrigger(this.selectedRowIndex(),l)&&(this.selectRows(l),this._rowSelectedEventTrigger(l))))},_editAddTools:function(){var t,i=this,l=i.model,n=e("#"+i._id+"_toolbarItems"),o=i.model.editSettings,r=l.toolbarSettings.toolbarItems,a=[];o.allowAdding&&-1!==r.indexOf("add")&&!e(n).find(".e-addnew").parent("li").hasClass("e-disable")&&"click"!=o.beginEditAction&&a.push(e(n).find(".e-addnew").parent()[0]),o.allowEditing&&-1!==r.indexOf("edit")&&!e(n).find(".e-edit").parent("li").hasClass("e-disable")&&a.push(e(n).find(".e-edit").parent()[0]),o.allowDeleting&&-1!==r.indexOf("delete")&&!e(n).find(".e-delete").parent("li").hasClass("e-disable")&&"click"!=l.editSettings.beginEditAction&&a.push(e(n).find(".e-delete").parent()[0]),a.forEach(function(t){e(n).ejToolbar("disableItem",t)}),t=[],("batchediting"!=o.editMode.toLowerCase()||"batchediting"==o.editMode.toLowerCase()&&i._batchEditStarts)&&(-1!==r.indexOf("cancel")&&t.push(e(n).find(".e-cancel").parent()[0]),-1!==r.indexOf("update")&&t.push(e(n).find(".e-save").parent()[0])),t.forEach(function(t){e(n).ejToolbar("enableItem",t)})},_cancelSaveTools:function(){var t=this,i=t.model,l=t.model.editSettings,n=e("#"+t._id+"_toolbarItems"),o=i.toolbarSettings.toolbarItems;if(i.isFromGantt){n=e("#"+t._id.replace("ejTreeGrid","")+"_toolbarItems");var r=[],a=[];1==i.readOnly?((a=[]).push(e(n).find(".e-addnewitem").parent()[0]),a.push(e(n).find(".e-edititem").parent()[0]),a.push(e(n).find(".e-edititem").parent()[0])):(l.allowAdding&&-1!==o.indexOf("add")&&r.push(e(n).find(".e-addnewitem").parent()[0]),l.allowEditing&&-1!==o.indexOf("edit")&&i.allowSelection&&"click"!=l.beginEditAction&&(-1!=t.selectedRowIndex()&&1==i.selectedItems.length?r.push(e(n).find(".e-edititem").parent()[0]):a.push(e(n).find(".e-edititem").parent()[0])),l.allowDeleting&&-1!==o.indexOf("delete")&&i.allowSelection&&(-1!=t.selectedRowIndex()?r.push(e(n).find(".e-deleteitem").parent()[0]):a.push(e(n).find(".e-deleteitem").parent()[0])),l.allowIndent&&(-1!==o.indexOf("indent")||-1!==o.indexOf("outdent"))&&i.allowSelection&&-1==t.selectedRowIndex()&&(a.push(e(n).find(".e-indent").parent()[0]),a.push(e(n).find(".e-outdent").parent()[0])),e(n).ejToolbar("enableItem",r),-1!==o.indexOf("cancel")&&a.push(e(n).find(".e-cancel").parent()[0]),-1!==o.indexOf("update")&&a.push(e(n).find(".e-saveitem").parent()[0])),a.forEach(function(t){e(n).ejToolbar("disableItem",t)})}else r=[],a=[],l.allowAdding?-1!==o.indexOf("add")&&r.push(e(n).find(".e-addnew").parent()[0]):a.push(e(n).find(".e-addnew").parent()[0]),l.allowEditing&&-1!==o.indexOf("edit")?-1!=t.selectedRowIndex()&&i.allowSelection&&(1==i.selectedItems.length||t._checkboxSelection)&&"click"!=l.beginEditAction?r.push(e(n).find(".e-edit").parent()[0]):e(n).find(".e-edit").parent("li").hasClass("e-disable")||a.push(e(n).find(".e-edit").parent()[0]):a.push(e(n).find(".e-edit").parent()[0]),l.allowDeleting&&-1!==o.indexOf("delete")?(t._checkboxSelection||-1!=t.selectedRowIndex()&&i.allowSelection)&&i.selectedItems.length>0?r.push(e(n).find(".e-delete").parent()[0]):e(n).find(".e-delete").parent("li").hasClass("e-disable")||a.push(e(n).find(".e-delete").parent()[0]):a.push(e(n).find(".e-delete").parent()[0]),t._getParentRecords(i.updatedRecords,t).length<=0?(-1===o.indexOf("expandAll")||e(n).find(".e-expandall").parent("li").hasClass("e-disable")||a.push(e(n).find(".e-expandall").parent()[0]),-1===o.indexOf("collapseAll")||e(n).find(".e-collapseall").parent("li").hasClass("e-disable")||a.push(e(n).find(".e-collapseall").parent()[0])):(-1!==o.indexOf("expandAll")&&r.push(e(n).find(".e-expandall").parent()[0]),-1!==o.indexOf("collapseAll")&&r.push(e(n).find(".e-collapseall").parent()[0])),"click"==l.beginEditAction&&("click"!=l.beginEditAction||i.isEdit)||("batchediting"!=l.editMode.toLowerCase()||"batchediting"==l.editMode.toLowerCase()&&!t._batchEditStarts?(-1===o.indexOf("cancel")||e(n).find(".e-cancel").parent("li").hasClass("e-disable")||a.push(e(n).find(".e-cancel").parent()[0]),-1===o.indexOf("update")||e(n).find(".e-save").parent("li").hasClass("e-disable")||a.push(e(n).find(".e-save").parent()[0])):"batchediting"==l.editMode.toLowerCase()&&t._batchEditStarts&&(-1!==o.indexOf("cancel")&&e(n).find(".e-cancel").parent("li").hasClass("e-disable")&&r.push(e(n).find(".e-cancel").parent()[0]),-1!==o.indexOf("update")&&e(n).find(".e-save").parent("li").hasClass("e-disable")&&r.push(e(n).find(".e-save").parent()[0]))),a.forEach(function(t){e(n).ejToolbar("disableItem",t)}),r.forEach(function(t){e(n).ejToolbar("enableItem",t)})},_checkIsEmptyRow:function(e){for(var i,l=this.model.columns,n=0;n<l.length;n++)if(" "!==(i=this._getCustomCellValue(e,l[n].field))&&!t.isNullOrUndefined(i)&&""!==i&&!1!==i)return!1;return!0},_beginEdit:function(){this._trigger("beginEdit",{}),this._isinBeginEdit=!0},_endEdit:function(){var i,l=this;if(l._isinBeginEdit=!1,i=this.selectedRowIndex(),t.TreeGrid.getRowByIndex(l,i),!this.editFormValidate())return!0;e("tr").hasClass("e-addedrow")||e("tr").hasClass("e-rowedit")?l.saveRow():l.saveCell()},_refreshTreeGridOnExpandCollapseAll:function(e){var i,l,n,o=this,r=this.model;if(r.enableVirtualization)r.enableAltRow&&o.updateAltRow(),o.sendDataRenderingRequest(e),r.allowTextWrap?(o._$frozenTableContent.length>0&&o._updateRowHeight(),o._setScrollTop(e.requestType),o.updateHeight(),o.getScrollElement().hasClass("e-scroller")&&o.getScrollElement().ejScroller("refresh")):(o._setScrollTop(),o.updateHeight());else{if(r.allowPaging&&((i={}).totalRecordsCount=this.getExpandedRecords(r.updatedRecords).length,o.getPager().ejPager("option",i).ejPager("refreshPager"),l=this.getPager().ejPager("model"),o._currentPage(l.currentPage),i.requestType="paging",o.processBindings(i)),o._isRefreshAddedRecord)return o.processBindings(),this.renderRecords(),void(o._isRefreshAddedRecord=!1);r.allowTextWrap&&o._$frozenTableContent.length>0?(o._updateRowHeight(),o.getScrollElement().ejScroller("refresh"),n=o.getScrollElement().ejScroller("model.scrollTop"),o._getFrozenScrollElement().scrollTop(n)):o.updateHeight(),r.enableAltRow&&r.currentViewData.length>0&&t.TreeGrid.updateAltRow(o,o.model.currentViewData[0],0,0)}},_expandCollapseInnerLevelRecord:function(e,i){for(var l=this,n=e.childRecords.length,o={},r=0;r<n;r++)if(e.childRecords[r].hasChildRecords&&(o.data=e.childRecords[r],o.expanded=i,o.recordIndex=l.model.updatedRecords.indexOf(o.data),o.requestType=t.TreeGrid.Actions.ExpandCollapse,!l._triggerExpandingCollapsingEvent(o)&&(l._expandCollapseInnerLevelRecord(e.childRecords[r],i),e.childRecords[r].expanded!=i))){if(l._isLoadonDemand&&!e.childRecords[r].isChildRetrieved){if(l._isInExpandCollapseAll=!0,o.requestType=t.TreeGrid.Actions.ExpandCollapse,t.TreeGrid.expandRowsonDemand(l,e.childRecords[r],o)){l._allParentItems.splice(l._allParentItems.indexOf(e.childRecords[r]),1),e.childRecords[r].expanded=!1;continue}return!0}t.TreeGrid.sendExpandCollapseRequest(l,o)}},_expandParentLevelRecord:function(e,i){var l=this,n={},o=l.getExpandStatus(e);e.expanded&&o||(n.data=e,n.expanded=i,n.recordIndex=l.model.updatedRecords.indexOf(e),l._triggerExpandingCollapsingEvent(n)||t.TreeGrid.sendExpandCollapseRequest(l,n),n.data.parentItem&&l._expandParentLevelRecord(n.data.parentItem,i))},expandAtLevel:function(e){var i,l,n,o=this,r=o.model,a={};if(!o._isHierarchyFiltering)if(r.allowPaging&&r.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&r.enableVirtualization)o._expandCollapseSettings.atLevel="expandAtLevel",o._expandCollapseSettings.level=e,o._expandCollapsePages=[],o._isInExpandCollapseAll=!0,o._expandPageLevelData(),a.requestType=t.TreeGrid.Actions.ExpandCollapse,r.flatRecords.length>0&&o._refreshTreeGridOnExpandCollapseAll(a),o._isInExpandCollapseAll=!1,o.updateHeight();else{for(l=o._getParentRecords(o.model.updatedRecords,o),n=0;n<l.length;n++)if((i=l[n]).level==e){if(a.data=i,a.expanded=!0,a.recordIndex=r.updatedRecords.indexOf(i),o._isLoadonDemand&&!i.isChildRetrieved){if(a.recordLevel=e,a.isExpandingParticularLevelParent=!0,a.requestType=t.TreeGrid.Actions.ExpandCollapse,t.TreeGrid.expandRowsonDemand(o,i,a)){o._allParentItems.splice(o._allParentItems.indexOf(i),1),i.expanded=!1;continue}return}o._triggerExpandingCollapsingEvent(a)||t.TreeGrid.sendExpandCollapseRequest(o,a),i.parentItem&&o._expandParentLevelRecord(i.parentItem,a.expanded),i.hasChildRecords&&o._expandCollapseInnerLevelRecord(i,!1)}r.allowPaging&&!r.enableVirtualization&&(t.isNullOrUndefined(o.getPager())||o.gotoPage())}},collapseAtLevel:function(e){var i,l,n,o=this,r={},a=o.model;if(!o._isHierarchyFiltering)if(a.allowPaging&&a.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&a.enableVirtualization)o._expandCollapseSettings.atLevel="collapseAtLevel",o._expandCollapseSettings.level=e,o._expandCollapsePages=[],o._isInExpandCollapseAll=!0,o._collapsePageLevelData(),r.requestType=t.TreeGrid.Actions.ExpandCollapse,a.flatRecords.length>0&&o._refreshTreeGridOnExpandCollapseAll(r),o._isInExpandCollapseAll=!1,o.updateHeight();else{for(l=o._getParentRecords(a.updatedRecords,o),n=0;n<l.length;n++)(i=l[n]).level==e&&i.expanded&&(o.getExpandStatus(i)&&(r.data=i,r.expanded=!1,r.recordIndex=a.updatedRecords.indexOf(i),o._triggerExpandingCollapsingEvent(r)||t.TreeGrid.sendExpandCollapseRequest(o,r)));a.allowPaging&&!a.enableVirtualization&&(t.isNullOrUndefined(o.getPager())||o.gotoPage())}},_collapsePageLevelData:function(){var i,l,n,o=this,r={},a=o.model,d=o._expandCollapseSettings.level,s=o._getParentRecords(o._updatedPageData,o),c=s.length,u=o._currentPage();for(-1==e.inArray(u,o._expandCollapsePages)&&o._expandCollapsePages.push(u),n=0;n<c;n++)l=s[n],i=o.getExpandStatus(l),l&&l.level==d&&(r.data=l,r.recordIndex=a.updatedRecords.indexOf(l),r.expanded=!1,o._triggerExpandingCollapsingEvent(r)||(t.TreeGrid.sendExpandCollapseRequest(o,r),i||o._expandParentLevelRecord(l.parentItem,!0)))},_expandPageLevelData:function(){var i,l,n=this,o={},r=n.model,a=n._expandCollapseSettings.level,d=n._getParentRecords(n._updatedPageData,n),s=d.length,c=n._currentPage();for(-1==e.inArray(c,n._expandCollapsePages)&&n._expandCollapsePages.push(c),l=0;l<s;l++)(i=d[l]).level==a&&(o.data=i,o.expanded=!0,o.recordIndex=r.updatedRecords.indexOf(i),n._triggerExpandingCollapsingEvent(o)||(t.TreeGrid.sendExpandCollapseRequest(n,o),i.parentItem&&n._expandParentLevelRecord(i.parentItem,o.expanded),i.hasChildRecords&&n._expandCollapseInnerLevelRecord(i,!1)))},expandCollapseRow:function(e){var i,l,n=this,o={};e=parseInt(e),(l=n.model.allowPaging?n.getUpdatedRecords():n.model.updatedRecords).length>e&&e>=0&&((i=l[e]).hasChildRecords&&(o.data=i,o.expanded=!i.expanded,t.TreeGrid.sendExpandCollapseRequest(n,o)))},expandAll:function(){var e=this,i=e.model,l={};if(!e.editFormValidate())return!0;e._expandCollapseSettings.state="expandAll",e._expandCollapseSettings.atLevel="",e._expandCollapseSettings.level=0,e._expandCollapsePages=[],e._isRowEdit?e.cancelRowEditCell():e.model.isEdit&&e.cancelEditCell(),l.requestType=t.TreeGrid.Actions.ExpandCollapse,e._isInExpandCollapseAll=!0,e._expandAllData(),i.flatRecords.length>0&&e._refreshTreeGridOnExpandCollapseAll(l),e._isInExpandCollapseAll=!1,e.updateHeight()},_expandAllData:function(){var e,i,l=this,n=l.model,o=0,r={};if(r.requestType=t.TreeGrid.Actions.ExpandCollapse,n.allowPaging&&n.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&n.enableVirtualization){var a=n.pageSettings.pageSize,d=l._currentPage(),s=a*d,c=a*(d-1);for(l._expandCollapsePages.push(d),o=c;o<s;o++)if((e=l._isHierarchyFiltering?l._filterParentRecords[o]:l.model.parentRecords[o])&&(r.data=e,r.recordIndex=n.updatedRecords.indexOf(e),r.expanded=!0,e.hasChildRecords&&!l._triggerExpandingCollapsingEvent(r))){if(l._expandCollapseInnerLevelRecord(e,r.expanded))return;e.expanded!=r.expanded&&t.TreeGrid.sendExpandCollapseRequest(l,r)}}else for(i=l._isHierarchyFiltering?l._filterParentRecords:l.model.parentRecords,o=0;o<i.length;o++)if(e=i[o],r.data=e,r.recordIndex=n.updatedRecords.indexOf(e),r.expanded=!0,e.hasChildRecords&&!l._triggerExpandingCollapsingEvent(r)){if(l._isLoadonDemand&&!e.isChildRetrieved){if(l._isInExpandCollapseAll=!0,t.TreeGrid.expandRowsonDemand(l,e,r)){l._allParentItems.splice(l._allParentItems.indexOf(e),1),e.expanded=!1;continue}return}if(l._expandCollapseInnerLevelRecord(e,r.expanded))return;e.expanded!=r.expanded&&t.TreeGrid.sendExpandCollapseRequest(l,r)}},_refreshToolBar:function(){e("#"+this._id+"_toolbarItems").find("li").removeClass("e-hover")},_renderToolbar:function(){var t=this,i=t.model,l=t.element;i.isFromGantt||(t.model.toolbarSettings.showToolbar&&l.append(t._renderToolbarTemplate()),t.model.isResponsive&&e("#"+t._id+"_toolbarItems").addClass("e-treegridadaptivetoolbar"))},_renderToolbarTemplate:function(){var i,l,n,o=this,r=o.model,a=t.buildTag("div.e-treegridtoolbar#"+o._id+"_toolbarItems","",{height:"36px",border:"1px solid"},{"data-unselectable":"on"});return!t.isNullOrUndefined(r.toolbarSettings.toolbarItems)&&r.toolbarSettings.toolbarItems.length&&(i=t.buildTag("ul","",{},{}),o._renderLi(i),a.append(i)),!t.isNullOrUndefined(r.toolbarSettings.customToolbarItems)&&r.toolbarSettings.customToolbarItems.length&&(l=t.buildTag("ul","",{},{}),o._renderCustomLi(l),a.append(l)),(n={}).click=o._toolBarClick,n.cssClass=o.model.cssClass,n.rtl=!1,n.itemSeparator=!1,n.itemLeave=o._toolbarItemLeave,n.width=o._gridWidth,n.fields={id:"",tooltipText:"",imageUrl:"",text:"",imageAttributes:"",spriteCSS:"",htmlAttributes:""},a.ejToolbar(n),a.ejToolbar("disableItem",o._disabledToolItems),o._disabledToolItems=e(),a},_renderCustomLi:function(i){for(var l,n,o,r=this,a=r.model.toolbarSettings.customToolbarItems,d=0;d<a.length;d++)(a[d].text||a[d].templateID)&&(a[d].text?(l=a[d].tooltipText?a[d].tooltipText:a[d].text,n=t.buildTag("li","",{},{id:r._id+"_"+a[d].text,title:l}),o=t.buildTag("a.e-toolbaricons e-icon e-treegridcustomtoolbaritem","",{}).addClass(a[d].text),n.addClass("e-treegridtoolbaritem")):(l=a[d].tooltipText?a[d].tooltipText:a[d].templateID.replace("#",""),n=t.buildTag("li","",{},{id:r._id+"_"+a[d].templateID.replace("#",""),title:l}),o=e(a[d].templateID).hide().html()),n.html(o),i.append(n))},_renderLi:function(e){for(var i,l=this,n=l.model.toolbarSettings.toolbarItems,o=n.length,r=0;r<o;r++)i=t.buildTag("li.e-treegridtoolbaritem","",{},{id:l._id+"_"+n[r]}),l._renderLiContent(i,n[r]),e.append(i)},_renderLiContent:function(i,l){var n,o,r,a,d,s,c,u,g,m,p,h,_,f,w=this.model.selectionSettings.selectionMode,C=this.selectedRowIndex();this.model.editSettings;switch(l){case"add":n=t.buildTag("a.e-addnew e-toolbaricons e-icon e-treegrid-add","",{}),r=this._toolboxTooltipTexts.addTool,i.attr("title",r),this.model.editSettings.allowAdding||this._disabledToolItems.push(i.get(0));break;case"edit":n=t.buildTag("a.e-edit e-toolbaricons e-icon e-treegrid-edit","",{}),a=this._toolboxTooltipTexts.editTool,i.attr("title",a),this.model.editSettings.allowEditing&&-1!=C&&(-1==C||"cell"!=w)&&this.model.allowSelection&&"click"!=this.model.editSettings.beginEditAction||this._disabledToolItems.push(i.get(0));break;case"delete":d=this._toolboxTooltipTexts.deleteTool,i.attr("title",d),n=t.buildTag("a.e-delete e-toolbaricons e-icon e-treegrid-delete","",{}),this.model.editSettings.allowDeleting&&-1!=C&&(-1==C||"cell"!=w)&&this.model.allowSelection||this._disabledToolItems.push(i.get(0));break;case"update":s=this._toolboxTooltipTexts.updateTool,i.attr("title",s),n=t.buildTag("a.e-save e-toolbaricons e-icon e-treegrid-save e-disabletool","",{}),this._disabledToolItems.push(i.get(0));break;case"cancel":c=this._toolboxTooltipTexts.cancelTool,i.attr("title",c),n=t.buildTag("a.e-cancel e-toolbaricons e-icon e-treegrid-cancel e-disabletool","",{}),this._disabledToolItems.push(i.get(0));break;case"expandAll":u=this._toolboxTooltipTexts.expandAllTool,i.attr("title",u),o=t.buildTag("a.e-expandall e-toolbaricons e-icon e-treegrid-expandall","",{},{}),i.append(o);break;case"collapseAll":g=this._toolboxTooltipTexts.collapseAllTool,i.attr("title",g),o=t.buildTag("a.e-collapseall e-toolbaricons e-icon e-treegrid-collapseall","",{},{}),i.append(o);break;case"pdfExport":m=this._toolboxTooltipTexts.pdfExportTool,i.attr("title",m),o=t.buildTag("a.e-pdfIcon e-toolbaricons e-icon","",{},{}),i.append(o);break;case"excelExport":p=this._toolboxTooltipTexts.excelExportTool,i.attr("title",p),o=t.buildTag("a.e-excelIcon e-toolbaricons e-icon","",{},{}),i.append(o);break;case"print":h=this._toolboxTooltipTexts.printTool,i.attr("title",h),o=t.buildTag("a.e-printIcon e-toolbaricons e-icon","",{},{}),i.append(o);break;case"search":var x=this._toolboxTooltipTexts.searchTool,v=this,S=v.model.searchSettings.key;n=t.buildTag("a.e-searchitem e-toolbaricons e-disabletool e-icon e-searchfind","",{position:"absolute",padding:"4px","padding-left":"7px"}),_=t.buildTag("div.e-filterdiv e-searchinputdiv","",{display:"inline-table",width:"83%"}),o=t.buildTag("input.e-ejinputtext e-searchinput","",{width:"100%"},{type:"text",placeholder:x,value:S}),f=t.buildTag("span.e-searchcancel e-cancel e-icon e-hide e-spanstyle","",{right:"1%","padding-top":"0px",top:"0px"}),i.attr("title",x),i.addClass("e-search"),_.append(o).append(f),i.append(_),i.css({width:"172px"}),this.model.allowSearching=!0,o.keydown(e.proxy(this._keyDown,this)).focus(function(){v.element.find("span.e-searchcancel").removeClass("e-hide")}),n.click(e.proxy(this._keyDown,this)),_.focusout(function(){""==v.element.find("input.e-searchinput").val()&&e("span.e-searchcancel").addClass("e-hide")}),f.click(function(){v.element.find("input.e-searchinput").val(""),e(this).addClass("e-hide"),v.search("")}).mouseover(function(){this.style.cursor="pointer"})}i.append(n)},_updateToolbarItems:function(){var t=this,i=t.model,l=(i.toolbarSettings.toolbarItems,i.editSettings),n=(e("#"+t._id+"_toolbarItems"),t.selectedRowIndex(),l.editMode);"cellediting"==n.toLowerCase()||"dialogediting"==n.toLowerCase()?t._isRowEdit?t.cancelRowEditCell():i.isEdit&&t.cancelEditCell():"rowediting"==n.toLowerCase()&&t.cancelRowEditCell(),t._cancelSaveTools()},_renderAfterColumnInitialize:function(){this.element.append(this._renderGridHeader())},filterEditType:function(e,i,l){var n,o,r,a=this,d=(a.model,e.field.split(".").join(""));switch(t.isNullOrUndefined(e.filterEditType)&&(e.filterEditType=e.editType),e.filterEditType){case"stringedit":i.html(t.buildTag("input.e-ejinputtext e-filtertext e-field e-filterwidth","",{},{id:a._id+"_"+d+"_filterbarcell",name:e.field,value:l}));break;case"numericedit":n=t.buildTag("input.e-numerictextbox e-field","",{width:e.width-15},{type:"text",id:a._id+"_"+d+"_filterbarcell",name:e.field,value:l}),i.append(n);break;case"datepicker":case"datetimepicker":o=t.buildTag("input.e-"+e.filterEditType+" e-field","",{},{type:"text",id:a._id+"_"+d+"_filterbarcell",name:e.field,value:l}),i.append(o);break;case"booleanedit":case"dropdownedit":r=t.buildTag("input.e-field e-dropdownlist e-field","",{},{type:"text",id:a._id+"_"+d+"_filterbarcell",name:e.field,value:l}),i.append(r)}},_filteringElements:function(l){var n,o,r,a,d,s,c,u,g,m,p,h=this,_=h.model,f=!1,w={};_.selectedItem;for("filtering"==l.requestType&&(o=document.getElementById(h._id+"_filterBar"+l.fieldname.split(".").join(""))),s=c=t.TreeGrid.getColumnByField(_.columns,l.fieldname),r=(n=e(o).find("input,select")).length,g=0;g<r;g++){if(w={},m=(a=n.eq(g)).closest("div").width()-2,a.hasClass("e-numerictextbox"))d=m,b=a.val(),w.width=d,w.showSpinButton=!0,w.cssClass=_.cssClass,w.locale=_.locale,w.height=28,w.focusIn=e.proxy(h._cancelEditState,h,a),a[0].id.replace(h._id,""),w.change="immediate"==_.filterSettings.filterBarMode?e.proxy(h._filterBarHandler,h,a):null,p=a.data("ejNumericTextbox"),t.isNullOrUndefined(p)&&(w.value=b.length?parseFloat(b):null),c=t.TreeGrid.getColumnByField(h.model.columns,a.prop("name")),t.isNullOrUndefined(c)||t.isNullOrUndefined(c.editParams)||e.extend(w,c.editParams),a.ejNumericTextbox(w),a.prop("name",a.prop("name").replace(h._id,""));else if(a.hasClass("e-datepicker"))d=m,w.width=d,w.cssClass=_.cssClass,w.dateFormat=_.dateFormat,w.locale=_.locale,w.height=28,w.focusIn=e.proxy(h._cancelEditState,h,a),a[0].id.replace(h._id,""),w.select="immediate"==_.filterSettings.filterBarMode?e.proxy(h._filterBarHandler,h,a):null,(s=t.TreeGrid.getColumnByField(h.model.columns,a.prop("name"))).format!==i&&s.format.length>0&&(u=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(s.format),w.dateFormat=u[2]),t.isNullOrUndefined(s.editParams)||e.extend(w,s.editParams),-1!=_.dateFormat.toLowerCase().indexOf("hh")?a.ejDateTimePicker(w):a.ejDatePicker(w),h._preventDoubleClick(s);else if(a.hasClass("e-datetimepicker"))(w={width:d=m,rtl:_.rtl,locale:_.locale,cssClass:_.cssClass,showButton:!1,focusIn:e.proxy(h._cancelEditState,h,a)}).height=28,w.close="immediate"==_.filterSettings.filterBarMode?e.proxy(h._filterBarHandler,h,a):null,(s=t.TreeGrid.getColumnByField(h.model.columns,a.prop("name"))).format!==i&&s.format.length>0&&(u=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(s.format),w.dateTimeFormat=u[2]),t.isNullOrUndefined(s.editParams)||e.extend(w,s.editParams),a.ejDateTimePicker(w),h._preventDoubleClick(s);else if(a.hasClass("e-dropdownlist")){var C,x,v,S,R,T=(s=t.TreeGrid.getColumnByField(_.columns,l.fieldname)).editParams&&s.editParams.fields&&s.editParams.fields.text?s.editParams.fields.text:"text",b=s.editParams&&s.editParams.fields&&s.editParams.fields.value?s.editParams.fields.value:"value",y=[];s.dropdownData&&s.dropdownData.length>0?y=e.extend(!0,[],s.dropdownData):"booleanedit"==s.editType?(y=[],(S={})[T]=h._trueText,S[b]="true",y.push(S),(R={})[T]=h._falseText,R[b]="false",y.push(R)):y=h._dropDownArrayCollection(s,l.fieldname),(C={})[T]=h._dropDownListClearText,C[b]=h._dropDownListClearText,y.splice(0,0,C),(v=s.allowFilteringBlankContent==i||s.allowFilteringBlankContent)&&((x={})[T]=h._dropDownListBlanksText,x[b]=h._dropDownListBlanksText,y.push(x));var I,D={},E=a.val(),M=e("#"+a[0].id).data("ejDropDownList");M&&(I=e(M.popupList)),D.width=m,D.showCheckbox=!1,D.dataSource=y,D.height=28,D.popupShown=e.proxy(h._cancelEditState,h,a),D.fields={text:T,value:b},D.popupHide="immediate"==_.filterSettings.filterBarMode?e.proxy(h._filterBarHandler,h,a):null,a.ejDropDownList(D),I&&(I.find(".e-ul :first-child").find(".e-ddltxt").css("font-style","italic"),v&&I.find(".e-ul :last-child").find(".e-ddltxt").css("font-style","italic")),E==h._dropDownListClearText&&(E=""),a.ejDropDownList("selectItemByValue",E),h._preventDoubleClick(s)}else switch(a.prop("tagName")){case"INPUT":a.width(m-4),"stringedit"==s.filterEditType&&h._on(e("#"+h._id+"_"+s.field.split(".").join("")+"_filterbarcell"),"focus",h._cancelEditState);break;case"SELECT":a.width(m).height(15)}a.is(":disabled")||f||a.is(":hidden")&&"object"!=typeof a.data("ejDropDownList")||h._isEnterKeyPressed||(f=!0)}},_dropDownArrayCollection:function(i,l){var n,o=this.model,r=l,a=[],d=[],s=i.editType;return n=e.map(o.flatRecords,function(e){if(!t.isNullOrUndefined(e.item[r]))return e.item[r]}),e.each(n,function(t,i){i=e.trim(i),-1===e.inArray(i,a)&&a.push(i)}),"numericedit"!=s?a.sort(this.stringCompare):a=a.sort(function(e,t){return e-t}),e.each(a,function(e,t){d.push({text:t,value:t})}),d},stringCompare:function(e,t){var i=[],l=[];for(e.replace(/(\d+)|(\D+)/g,function(e,t,l){i.push([t||1/0,l||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,i){l.push([t||1/0,i||""])});i.length&&l.length;){var n=i.shift(),o=l.shift(),r=n[0]-o[0]||n[1].localeCompare(o[1]);if(r)return r}return i.length-l.length},_preventDoubleClick:function(i){var l=this,n=e("#"+l._id+"_"+i.field.split(".").join("")+"_filterbarcell_popup");0!=n.length&&e(n).on("click",function(){t.isTouchDevice()?l._off(l.element,"doubletap ",".e-gridcontent",l._editdblClickHandler):l._off(l.element,"dblclick ",".e-gridcontent",l._editdblClickHandler),setTimeout(function(){t.isTouchDevice()?l._on(l.element,"doubletap ",".e-gridcontent",l._editdblClickHandler):l._on(l.element,"dblclick ",".e-gridcontent",l._editdblClickHandler)},300)})},_renderFiltering:function(i,l){var n,o,r,a,d,s,c,u=this,g=this.model,m=g.columns,p=g.filterSettings.filteredColumns,h=t.buildTag("tr.e-filterbar","",{},{});if(u.model.allowFiltering&&(e.each(m,function(e,i){t.isNullOrUndefined(i.allowFiltering)&&(i.allowFiltering=!0)}),n=!1,e.each(m,function(e,t){if(1==t.allowFiltering)return n=!0,!1}),n))for(o=0;o<i.length;o++){if(r=t.buildTag("th.e-filterbarcell .e-editValue","",{},{}),!1===i[o].visible&&r.addClass("e-hide"),a=t.buildTag("div.e-filterdiv","",{},{id:u._id+"_filterBar"+i[o].field.split(".").join("")}),h.append(r.append(a)),0==i[o].allowFiltering)continue;if(d="",p.length>0)for(s=0;s<p.length;s++)i[o].field==p[s].field&&(d=p[s].value);this.filterEditType(i[o],a,d),c=t.buildTag("span.e-cancel e-icon e-hide e-spanstyle"),a.append(c)}return g.showDetailsRow&&g.detailsTemplate&&g.showDetailsRowInfoColumn&&l&&h.append(t.buildTag("th.e-filterbarcell e-detailheadercell",'<div style="width:'+u._detailsColumnWidth+'px;"></div>')),h},_getIndentCol:function(){return t.buildTag("col","",{width:this._detailsColumnWidth+"px"})},_renderGridHeader:function(){var e,i,l=this,n=l.model,o=(document,t.buildTag("div.e-gridheadercontainer","",{overflow:"hidden"},{"data-unselectable":"on"})),r=n.isFromGantt?t.buildTag("div.e-gridheader#"+l._id+"e-gridheader","",{"border-left-style":"solid","border-left-width":"1px"},""):t.buildTag("div.e-gridheader#"+l._id+"e-gridheader","",{"border-top-style":"solid","border-left-style":"solid","border-right-style":"solid","border-top-width":"1px","border-left-width":"1px","border-right-width":"1px",width:l._gridWidth},"");return 1==n.allowFiltering&&n.filterSettings.filterType==t.TreeGrid.FilterType.FilterBar&&o.addClass("e-headercontent-material-filterbar"),o.addClass("e-headercontent"),l.setGridHeaderContent(r),l._$gridHeaderContainer=o,l._hiddenColumns=[],l._visibleColumns=[],l.columnsWidthCollection=[],l._removePrevHeaderTemplates(),this._frozenColumnsLength>0?(o.addClass("e-frozen-header-container"),e=t.buildTag("div.e-frozenheaderdiv#e-frozenheaderdiv"+l._id,this._renderGridHeaderInternalDesign(n.columns.slice(0,this._frozenColumnsLength),!1,!0)),1==n.allowFiltering&&n.filterSettings.filterType==t.TreeGrid.FilterType.FilterBar&&e.addClass("e-filterbar-header-material"),n.showStackedHeader&&n.stackedHeaderRows.length>0&&e.addClass("e-stacked-header-material"),i=t.buildTag("div.e-movableheader#e-movableheader"+l._id,t.buildTag("div.e-movableheaderdiv#e-movableheaderdiv"+l._id,this._renderGridHeaderInternalDesign(this.model.columns.slice(this._frozenColumnsLength),!0))),o.append(e).append(i)):(o.append(this._renderGridHeaderInternalDesign(this.model.columns,!0)),o.removeClass("e-frozen-header-container")),r.html(o),this.setGridHeaderTable(this.getHeaderContent().find(".e-table")),r},_removePrevHeaderTemplates:function(){e("[id^='"+this._id+"'][type='text/x-treegridheadertemplate']").remove(),this.headerAngularTemplate&&(this.headerAngularTemplate=null)},getPager:function(){return this._gridPager},setTreeGridPager:function(e){this._gridPager=e},_renderGridPager:function(){var i,l,n=this,o=e(document.createElement("div")),r={},a=n.model.pageSettings;return o.attr({id:this._id+"Pager"}),a.change=e.proxy(n._pagerClickHandler,n),t.isNullOrUndefined(a.totalRecordsCount)&&(a.totalRecordsCount=n._isLoadonDemand?n._pageRecordCountOnDemand:a.totalRecordsCount),e.extend(r,a),r.locale=n.model.locale,delete r.template,n._currentPage()<0&&n._currentPage(1),r.currentPage=this._prevPageNo=n._currentPage(),r.masterObject=n,r.cssClass=n.model.cssClass,n.setTreeGridPager(o),o.ejPager(r),o.ejPager("refreshPager"),r=o.ejPager("model"),a.totalPages=r.totalPages,n._currentPage()!==r.currentPage&&n._currentPage(r.currentPage),!t.isNullOrUndefined(a.template)&&a.template.length>0&&(o.children().remove(),i=t.buildTag("div.e-pagercontainer"),l=this._createTemplateElement(a,!0),i.append(l.innerHTML),o.append(i)),o},_addHeaderCheckboxTemplate:function(){var e=this.model,t=e.flatRecords.length,i=e.selectedItems.length;return t>0&&t==i?'<div><span class="e-chkbox-wrap e-widget" style="margin-left:5px;padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-act"><span class="e-checkbox e-checkmark e-chk-image e-icon e-headerCheckbox"id ='+this._id+"_headerCheckbox></span></span></div></span></div>":t>i&&i>0?'<div><span class="e-chkbox-wrap e-widget" style="margin-left:5px;padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-indeter"><span class="e-checkbox e-stop e-chk-image e-icon e-headerCheckbox"id ='+this._id+"_headerCheckbox></span></span></div></span></div>":'<div><span class="e-chkbox-wrap e-widget" style="margin-left:5px;padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-inact"><span class="e-checkbox e-chk-image e-icon e-headerCheckbox"id ='+this._id+"_headerCheckbox></span></span></div></span></div>"},_createStackedRow:function(l,n){for(var o,r,a,d,s,c,u,g,m,p,h=t.buildTag("tr.e-columnheader e-stackedHeaderRow"),_=[],f=[],w=[],C=[],x=this.model,v=x.columns.length,S=l.stackedHeaderColumns,R=[],T=x.scrollSettings.frozenColumns,b=[],y=0,I=0,D=0,E=0;E<v;E++)if(0!=(a=x.columns[E]).visible||a==x.columns[x.treeColumnIndex]&&0==a.visible){var M="",k="",F="",O="";for(o=0;o<S.length;o++)d=Array.isArray(S[o].column)?S[o].column:e.map(S[o].column.split(","),e.trim),s="e-row"+e.inArray(l,x.stackedHeaderRows)+"-column"+o,-1!=e.inArray(a.field,d)&&(M=S[o].headerText,k=S[o].cssClass,F=S[o].textAlign,O=S[o].tooltip?" e-stackedtooltip "+s:"");_.push(M),f.push(k),w.push(F),C.push(O)}for(r=0;r<_.length;r++){for(u=1,g=r+1;g<_.length&&_[r]==_[g];g++)u++;R.push({spanCount:u,headerText:_[r],cssClass:f[r],txtAlign:w[r],tooltip:C[r]}),r+=u-1}if(T>0){for(r=0;r<v;r++)o=x.columns[r],r<T&&0==o.visible&&D++;for(y=T-D;y>0;)c=R[I].spanCount,R[I].spanCount<y?(b.push(R[I]),n?I++:R.splice(I,1)):R[I].spanCount>y?(R[I].spanCount=R[I].spanCount-y,n&&b.push({spanCount:y,headerText:R[I].headerText})):(b.push(R[I]),n||R.splice(I,1)),y-=c;n&&(R=b)}for(E=0;E<R.length;E++)m=t.buildTag("th.e-headercell e-stackedHeaderCell","",{},{colspan:R[E].spanCount}),p=t.buildTag("div.e-headercelldiv  e-default"+R[E].tooltip,R[E].headerText,{textAlign:R[E].txtAlign},{}),m.append(p),h.append(m),R[E].cssClass!=i&&m.addClass(R[E].cssClass),(x.allowColumnResize||x.allowColumnReordering)&&m.addClass("e-resizer");return x.detailsTemplate&&x.showDetailsRow&&x.showDetailsRowInfoColumn&&1!=n&&h.append(t.buildTag("th.e-headercell e-detailheadercell","<div></div>")),h},getHeaderCell:function(e){var i=this.model.columns.indexOf(this.getColumnByField(e)),l=null;return t.isNullOrUndefined(i)||-1==i||(l=this.getHeaderTable().find("thead tr:not('.e-stackedHeaderRow')").find(".e-headercell").not(".e-detailheadercell").eq(i)),l},_createHeaderTemplateElement:function(i){var l,n=(i.field?i.field:"")+e.inArray(i,this.model.columns)+"_HeaderTemplate",o=i.headerTemplateID,r=/^#([\w-]*)/.exec(o),a={name:"SCRIPT",type:"text/x-treegridheadertemplate",text:o,id:(this._id+n).replace(/(\\|[^0-9A-z-_])/g,"")};return(l=r&&r[1]?document.getElementById(r[1]):/^<script/i.test(o)?e(o).get(0):t.buildTag(a.name,a.text).get(0)).id=l.id||a.id,l.type=l.type||a.type,e("#"+l.id).remove(),e("body").append(l),l},_renderGridHeaderInternalDesign:function(l,n,o){var r,a,d,s,c,u,g,m,p,h,_,f,w=this,C=w.model,x=document,v=t.buildTag("table.e-table e-zerospace"),S=t.buildTag("thead"),R=(t.buildTag("tbody.e-hide"),t.buildTag("tr.e-columnheader")),T=e(x.createElement("colgroup")),b=e(x.createElement("tr")),y=0,I=l.length,D=C.stackedHeaderRows.length;if((C.allowSorting||C.showColumnChooser||C.allowColumnReordering)&&R.css({cursor:"pointer"}),"wrap"===C.headerTextOverflow?w.element.addClass("e-wrap"):w.element.removeClass("e-wrap"),C.showStackedHeader)for(g=0;g<D;g++)m=w._createStackedRow(C.stackedHeaderRows[g],o),S.append(m);for(;y<I;y++)if(l[y]){if(p=l[y].headerTextAlign?l[y].headerTextAlign:l[y].textAlign?l[y].textAlign:t.TextAlign.Left,!C.showColumnChooser&&(C.showColumnChooser||!C.allowFiltering||"menu"!=C.filterSettings.filterType&&"excel"!=C.filterSettings.filterType)||"checkboxState"==l[y].field?r=t.buildTag("th.e-headercell","",{},{}):t.isNullOrUndefined(l[y].allowFiltering)||l[y].allowFiltering||w.model.showColumnChooser?(r=t.buildTag("th.e-headercell","",{},{})).addClass("e-column-menu-padding"):r=t.buildTag("th.e-headercell","",{},{}),C.allowFiltering&&C.filterSettings.filterType==t.TreeGrid.FilterType.FilterBar&&r.addClass("e-filterbar-material"),a=x.createElement("td"),d=t.buildTag("div.e-headercelldiv","",{"text-align":p},{"data-ej-mappingname":l[y].field,"data-unselectable":"on"}),l[y].clipMode&&l[y].clipMode==t.TreeGrid.ClipMode.Ellipsis&&d.addClass("e-treegridtrimcell"),w._checkboxSelection&&C.selectionSettings.enableSelectAll&&w._checkboxColumnName==l[y].field&&d.append(w._addHeaderCheckboxTemplate()),"checkboxState"==l[y].field&&r.css({cursor:"default"}),h=t.buildTag("span",l[y].headerText==i?l[y].headerText=l[y].field:l[y].headerText),"wrap"==C.headerTextOverflow&&d.addClass("e-textwrapheaderdiv"),d.append(h),r.append(d),w.model.showColumnChooser&&!l[y].nonColumn)_=t.buildTag("div.e-columnmenu-icon e-icon e-columnicon","",{cursor:"pointer"}),"wrap"==C.headerTextOverflow&&_.addClass("e-textwrapcolumnicon"),_.data("isClicked",!1),r.append(_);else if(!C.showColumnChooser&&C.allowFiltering&&("menu"==C.filterSettings.filterType||"excel"==C.filterSettings.filterType)&&(t.isNullOrUndefined(l[y].allowFiltering)||l[y].allowFiltering)&&"checkboxState"!=l[y].field){if(u=-1!=w._filteredColumnValueID.indexOf(l[y].field)?t.buildTag("div.e-column-filtered-icon e-icon e-filtericon","",{cursor:"pointer"}):t.buildTag("div.e-column-filter-icon e-icon e-filtericon","",{cursor:"pointer"}),w.model.filterSettings.filteredColumns)for(f=0;f<w.model.filterSettings.filteredColumns.length;f++)w.model.filterSettings.filteredColumns[f].field==l[y].field&&""!=w.model.filterSettings.filteredColumns[f].value.toString()&&(u=t.buildTag("div.e-column-filtered-icon e-icon e-filtericon","",{cursor:"pointer"}));u.data("isClicked",!1),r.append(u)}s=x.createElement("col"),b.append(a),R.append(r),T.append(s),!1===l[y].visible&&l[y]!=C.columns[C.treeColumnIndex]?r.addClass("e-hide")&&e(s).css("display","none")&&w._hiddenColumns.push(l[y].headerText):(w._visibleColumns.push(l[y].headerText),l[y].visible=!0),!1===l[y].allowSorting&&r.css({cursor:"normal"}),t.isNullOrUndefined(l[y].headerTemplateID)||d.html(w._renderEjTemplate("#"+this._createHeaderTemplateElement(l[y]).id,l[y],0,l[y],"treegridheadertemplate")).parent().addClass("e-headertemplate"),l[y].allowCellSelection==i&&(l[y].allowCellSelection=!0),l[y].showInColumnChooser==i&&(l[y].showInColumnChooser=!0),l[y].width==i&&C.commonWidth!==i?(w.columnsWidthCollection.push(C.commonWidth),l[y].width=C.commonWidth):(w.columnsWidthCollection.push(parseFloat(l[y].width)),l[y].width=parseFloat(l[y].width)),w._fieldColumnNames[l[y].headerText]=l[y].field,w._headerColumnNames[l[y].field]=l[y].headerText}return C.isFromGantt&&w.updateToGanttColumns(),C.showDetailsRow&&C.detailsTemplate&&C.showDetailsRowInfoColumn&&n&&(R.append(t.buildTag("th.e-headercell e-detailheadercell",'<div style="width:'+w._detailsColumnWidth+'px;"></div>',{},{})),T.append(this._getIndentCol())),C.allowFiltering&&!C.isFromGantt&&"filterbar"==C.filterSettings.filterType&&(c=this._renderFiltering(l,n)),S.append(R),c&&S.append(c),v.append(T).append(S),v},_initGridRender:function(){var e=this;e._addInitTemplate(),e._renderGrid(),e.model.allowColumnResize&&(e._resizer=new t.gridFeatures.gridResize(e))},_summaryRow:function(){var i,l,n=this,o=n.model;o.showSummaryRow&&(n._createSummaryRow(),(i={}).requestType=t.TreeGrid.Actions.Refresh,n.sendDataRenderingRequest(i),n.updateCollapsedRecordCount(),n._updateWrapRowHeights("header"),n.updateHeight(),(o.allowTextWrap||"wrap"==o.headerTextOverflow)&&n._updateGridContentHeight()),o.showTotalSummary&&(l=e("#"+n._id+"-footersummaryrow").length,n._createTotalSummaryRow(),0==l&&(n._viewPortHeight=n._viewPortHeight-n._$totalSummaryRowContainer.outerHeight()),o.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||o.isFromGantt||this._updateTableWidth(),this._updateHeaderScrollLeft())},_renderGrid:function(){this._renderGridContent().insertAfter(this.element.children(".e-gridheader"))},_renderFrozenSummary:function(){this._$footerContainer.find("#e-frozenfooterdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[0]),this._$footerContainer.find("#e-movablefooterdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[1]),this._$footerContainer.find("#e-frozenfooterdiv"+this._id+" .e-table tbody").html(e.render[this._id+"_JSONFrozenTemplate"](this._footerSummaryRecord)),this._$footerContainer.find("#e-movablefooterdiv"+this._id+" .e-table tbody").html(e.render[this._id+"_Template"](this._footerSummaryRecord))},_renderSummaryByFrozenDesign:function(){var i=e(document.createElement("div")),l=this._getMetaColGroup().find("col"),n={};return n.colgroup1=i.append(t.buildTag("colgroup").append(l.splice(0,this._frozenColumnsLength))).html(),n.colgroup2=i.html(t.buildTag("colgroup").append(l)).html(),e.templates[this._id+"_FrozenSummaryTemplate"]||this.addFrozenSummaryTemplate(),e.render[this._id+"_FrozenSummaryTemplate"](n)},_spliceSummaryRows:function(e){this.model;var t=[];e.filter(function(e){e.isSummaryRow||t.push(e)});return t},addFrozenSummaryTemplate:function(){var t="<div class='e-frozenfooterdiv' id='e-frozenfooterdiv"+this._id+"'><table class='e-table e-zerospace' style='width:100%' id='"+this._id+"frozensummarye-table'>{{:colgroup1}}<tbody></tbody></table></div><div class='e-movablefooter' id='e-movablefooter"+this._id+"'><div class='e-movablefooterdiv' id='e-movablefooterdiv"+this._id+"'><table class='e-table e-zerospace' id='"+this._id+"movablesummarye-table'>{{:colgroup2}}<tbody></tbody></table></div></div>",i={};i[this._id+"_FrozenSummaryTemplate"]=t,e.templates(i)},expandCollapseTotalSummary:function(i){var l,n,o,r,a=this,d=a.model;if(d.showTotalSummary&&d.collapsibleTotalSummary){if(a._footerSummaryRecord[0].summaryExpanded==i)return;if((l={}).expanded=i,l.requestType=i?"summaryExpanding":"summaryCollapsing",l.data=a._footerSummaryRecord[0],l.columnName=d.columns[this._summaryColumnIndex].headerText,l.cellValue=t.isNullOrUndefined(l.data)?"":l.data[d.columns[this._summaryColumnIndex].field],l.isFromUserAction=a._isInManualExpandCollapse,n=e(a.element).find(".e-firstfootersummaryrow"),o=e(a.element).find(".e-footersummaryrow"),i){if(a._trigger("expanding",l),l.cancel)return;o.css({display:"table-row"}),n.find(".e-summarytreegridcollapse").removeClass("e-summarytreegridcollapse").addClass("e-summarytreegridexpand"),a._footerSummaryRecord[0].summaryExpanded=!0,(r={}).expanded=i,r.data=a._footerSummaryRecord[0],r.columnName=d.columns[this._summaryColumnIndex].headerText,r.cellValue=t.isNullOrUndefined(l.data)?"":l.data[d.columns[this._summaryColumnIndex].field],r.requestType="summaryExpanded",r.isFromUserAction=a._isInManualExpandCollapse,a._trigger("expanded",r)}else{if(a._trigger("collapsing",l),l.cancel)return;o.css({display:"none"}),n.css({display:"table-row"}),n.find(".e-summarytreegridexpand").removeClass("e-summarytreegridexpand").addClass("e-summarytreegridcollapse"),a._footerSummaryRecord[0].summaryExpanded=!1,(r={}).expanded=i,r.data=a._footerSummaryRecord[0],r.columnName=d.columns[this._summaryColumnIndex].headerText,r.cellValue=t.isNullOrUndefined(l.data)?"":l.data[d.columns[this._summaryColumnIndex].field],r.requestType="summaryCollapsed",r.isFromUserAction=a._isInManualExpandCollapse,a._trigger("collapsed",r)}a._$totalSummaryRowContainer.ejScroller({height:i?d.rowHeight:d.totalSummaryHeight}),a._updateGridContentHeight(),a._updateSummaryHeight()}},_createTotalSummaryRow:function(){var i,l,n,o,r,a,d,s=this,c=s.model,u=(c.flatRecords,c.summaryRows),g=u.length,m=(c.updatedRecords,c.parentRecords,c.columns),p=t.buildTag("tbody");for(c.totalSummaryHeight=c.totalSummaryHeight<c.rowHeight?c.rowHeight:c.totalSummaryHeight,s._footerSummaryRecord=[],s._footerSummaryRows=[],c.collapsibleTotalSummary&&0!=e("#"+s._id+"-footersummaryrow").length&&0!=e("#"+s._id+"-footersummaryrow").find(".e-summarytreegridcollapse").length&&(s._persistCollapseState=!0),e("#"+s._id+"-footersummaryrow").remove(),i=t.buildTag("div.e-footersummaryrowdiv#"+s._id+"-footersummaryrow","",{overflow:"hidden",cursor:"default"}),l=t.buildTag("div.e-footercontainer#e-footercontainer"+s._id,"",{overflow:"hidden"}),s._flatChildRecords=s._spliceSummaryRows(c.updatedRecords),n=1;n<=g;n++){for(o={},r=0;r<m.length;r++)o[m[r].field]="";o=s._createSummaryItem(o,u[n-1]),a=s._createRecord(o,0),1==n&&(a.isFirstFooterSummary=!0,c.collapsibleTotalSummary&&(a.summaryExpanded=!0)),a.footerSummaryRowRecord=!0,a.index=n,s._footerSummaryRecord.push(a)}s._$footerContainer=l,this._frozenColumnsLength>0?(l.html(this._renderSummaryByFrozenDesign()),this._renderFrozenSummary()):((d=t.buildTag("table.e-table e-zerospace#"+s._id+"summarye-table","",{top:"0px"})).append(s.getContentTable().find("colgroup").clone()).append(p),p.html(e.render[this._id+"_Template"](s._footerSummaryRecord)),l.append(d)),s._$totalSummaryRowContainer=i,s._$footertableContent=l.find(".e-table"),i.append(l),c.allowPaging?s.element.append(e("#"+this._id+"Pager").before(i)):s.element.append(i),s._flatChildRecords=[],this._setWidthToFooters(),this._$totalSummaryRowContainer.height()<=c.totalSummaryHeight?(s.isVScroll()&&s._$totalSummaryRowContainer.addClass("e-scrollcss"),c.totalSummaryHeight=this._$totalSummaryRowContainer.height()):s._$totalSummaryRowContainer.ejScroller({height:"auto"==c.sizeSettings.height?0:c.totalSummaryHeight}),"auto"==c.sizeSettings.height&&e("#"+s._id+"-footersummaryrow").width(s._gridWidth-2),s._updateSummaryTitleColumn(),1==s._persistCollapseState&&(s.expandCollapseTotalSummary(!1),s._persistCollapseState=!1),c.columnResizeSettings.columnResizeMode==t.TreeGrid.ColumnResizeMode.FixedColumns&&this._updateTableWidth()},_getFooterRows:function(){var t=e();return this.model.showTotalSummary&&this._$footertableContent&&(t=this._$footertableContent.get(0).rows,this._frozenColumnsLength>0&&(t=[t,this._$footertableContent.get(1).rows])),e(t)},_setWidthToFooters:function(){var e,t=this._gridWidth;this._frozenColumnsLength>0&&(e=this._getFrozenColumnWidth(),this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).width(t).next().css("margin-left",e+"px"),this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).outerWidth(e).end().find("#e-movablefooterdiv"+this._id).css("width","100%"))},_excludeSummaryRows:function(){var t=e();this.model;return this.getTreeGridRows()&&this.getTreeGridRows().length>0&&(t=this._frozenColumnsLength>0?[e(this.getTreeGridRows()[0]).not(".e-summaryrow"),e(this.getTreeGridRows()[1]).not(".e-summaryrow")]:e(this.getTreeGridRows()).not(".e-summaryrow")),t},_createSummaryRow:function(e){var i,l,n,o,r,a,d,s,c,u,g,m=this,p=m.model,h={},_=p.summaryRows,f=_.length,w=p.columns;if(!e||"dragAndDrop"!=e.requestType&&"addNewRow"!=e.requestType&&"sorting"!=e.requestType)i=m._isHierarchyFiltering?m._findFilteredParentRecords(m._flatFilteredRecords):m._parentRecords;else if(i=m._getParentRecords(p.updatedRecords,m),"dragAndDrop"==e.requestType)for(n=0;n<i.length;n++)o=[],o=i[n].childRecords.filter(function(e){if(!e.isSummaryRow)return!0}),i[n].childRecords=o.slice();for(r=i.length,e&&t.isNullOrUndefined(e.filterCollection)&&(e.filterCollection=[]),p.enableCollapseAll&&p.enableVirtualization&&!e&&(p.updatedRecords=p.flatRecords.slice()),p.updatedRecords=m._spliceSummaryRows(p.updatedRecords),p.flatRecords=m._spliceSummaryRows(p.flatRecords),p.summaryRowRecords=[],m._flatChildRecords=[],a=0;a<r;a++)if(d=i[a],0!=(l=m._getChildRecordsLength(d,p.updatedRecords))){for(s=1;s<=f;s++){for(c=0;c<w.length;c++)h[w[c].field]="";h=m._createSummaryItem(h,_[s-1],d),u=p.updatedRecords.indexOf(d)+l+s,g=m._createRecord(h,u),m._isHierarchyFiltering&&p.enableVirtualization&&(g.isDisplay=!0),m._isSummaryRow=!0,g.level=d.level+1,g.parentItem=d,g.isSummaryRow=!0,g.index=p.flatRecords.length+1,p.enableVirtualization?(m._isHierarchyFiltering&&(p.updatedRecords=m._updateFilterParent),p.updatedRecords.splice(u,0,g),(!e||e&&e.filterCollection)&&p.summaryRowRecords.push(p.updatedRecords[u])):(p.updatedRecords.splice(u,0,g),p.summaryRowRecords.push(p.updatedRecords[u])),u=p.flatRecords.indexOf(d)+l+s,p.flatRecords.splice(u,0,g),d.childRecords.push(g),h={},s==f&&(g.isLastSummary=!0)}m._flatChildRecords=[]}m._isSummaryRow=!1,m._summaryRowsCount=i.length,p.enableVirtualization&&(p.updatedRecords=m.getExpandedRecords(p.updatedRecords),p.enableAltRow&&m.updateAltRow()),this._updateCurrentViewData()},_getInnerParentRecords:function(e,t,i){e.childRecords.length;for(var l=0;l<e.childRecords.length;l++)e.childRecords[l].hasChildRecords&&(-1==i.indexOf(e.childRecords[l])&&i.push(e.childRecords[l]),t._getInnerParentRecords(e.childRecords[l],t,i))},_getParentRecords:function(e,i,l){for(var n,o=e.length,r=[],a=0;a<o;a++)n=e[a],l?t.isNullOrUndefined(n.parentItem)&&r.push(n):n.childRecords&&n.childRecords.length>0?i.model.enableVirtualization||i.model.allowPaging&&i.model.showSummaryRow?(-1==r.indexOf(n)&&r.push(n),i._getInnerParentRecords(n,i,r)):r.push(n):i._isLoadonDemand&&n.hasChildRecords&&-1==r.indexOf(n)&&r.push(n);return r},_getChildRecordsLength:function(e,t){for(var i,l=this,n=t.length,o=0;o<n;o++)(i=t[o]).summaryRow||e==i.parentItem&&(l._flatChildRecords.push(i),i.hasChildRecords&&l._getChildRecordsLength(i,t));return l._flatChildRecords.length},_createSummaryItem:function(e,i){for(var l,n=this,o=i.summaryColumns,r=o.length,a=0;a<r;a++){var d=o[a],s=d.prefix,c=d.suffix,u=d.displayColumn;for(l in t.isNullOrUndefined(u)&&(u=d.dataMember),t.isNullOrUndefined(s)&&(s=""),t.isNullOrUndefined(c)&&(c=""),e.summaryColumn=d,e.summaryRow=i,e)l==u&&(e[l]=e[l]?e[l]+" "+s+n._getSummaryValues(d,n._flatChildRecords)+c:s+n._getSummaryValues(d,n._flatChildRecords)+c)}return e},_getSummaryValues:function(i,l){var n,o,r,a,d,s=i.dataMember,c=i.format,u=l,g="";switch(u instanceof t.DataManager?(n=u,u=u.dataSource.json):n=t.DataManager(u),i.summaryType){case t.TreeGrid.SummaryType.Sum:g=t.sum(u,s);break;case t.TreeGrid.SummaryType.Average:g=t.avg(u,s),g=isNaN(g)||t.isNullOrUndefined(g)?"":g;break;case t.TreeGrid.SummaryType.Maximum:r=t.max(u,s),g=parseInt(this._getCustomCellValue(r,i.dataMember)),g=isNaN(g)||t.isNullOrUndefined(g)?"":g;break;case t.TreeGrid.SummaryType.Minimum:o=u.filter(function(e){if(""!==e[s])return!0}),r=t.min(o,s),g=parseInt(this._getCustomCellValue(r,i.dataMember)),g=isNaN(g)||t.isNullOrUndefined(g)?"":g;break;case t.TreeGrid.SummaryType.MaximumDate:g=this._getMaxDate(u,s),g=t.isNullOrUndefined(g)?"":g;break;case t.TreeGrid.SummaryType.MinimumDate:g=this._getMinDate(u,s),g=t.isNullOrUndefined(g)?"":g;break;case t.TreeGrid.SummaryType.Count:g=u.length;break;case t.TreeGrid.SummaryType.TrueCount:a=t.Predicate(i.dataMember,"equal",!0),g=n.executeLocal(t.Query().where(a)).length;break;case t.TreeGrid.SummaryType.FalseCount:a=t.Predicate(i.dataMember,"equal",!1),g=n.executeLocal(t.Query().where(a)).length;break;case t.TreeGrid.SummaryType.Custom:(d=i.customSummaryValue)&&("string"==typeof d&&(d=t.util.getObject(d,window)),g=e.isFunction(d)?d.call(this,i,u):i.customSummaryValue)}return t.isNullOrUndefined(c)||(g=this.formatting(c,g,this.model.locale)),g},_getMaxDate:function(e,t){for(var i=0,l=null,n=0;n<e.length;n++){var o=e[n],r=new Date(o[t]).getTime();r>i&&(i=r,l=o[t])}return l},_getMinDate:function(e,t){var i;if(0==e.length)return null;var l=new Date(e[0][t]).getTime(),n=e[0][t];for(i=0;i<e.length;i++){var o=e[i],r=new Date(o[t]).getTime();r<l&&(l=r,n=o[t])}return n},_createAndRenderSummaryRecords:function(e){var i,l=this;l._createSummaryRow(e),(i={}).requestType=t.TreeGrid.Actions.Refresh,l.sendDataRenderingRequest(i),l.updateCollapsedRecordCount(),l.updateHeight()},_mergeRecords:function(){for(var e=this.batchChanges,t=e.changed,i=e.added,l=[],n=0;n<t.length;n++)l[t[n]]||l.push(t[n]);for(n=0;n<i.length;n++)l[i[n]]||l.push(i[n]);return l},_updateSummaryRow:function(i){var l,n,o,r,a,d,s,c,u,g,m=this,p=m.model,h=[],_=[],f=m.getUpdatedRecords();if(!i||"dragAndDrop"!=i.requestType||(i.rowIndex=f.indexOf(m._droppedRecord),-1!=i.rowIndex)){if(i&&"delete"==i.requestType)return void m._updateAfterDeleteRecord(i);if(i&&"celledit"==i.editType&&("numericedit"==i.columnObject.editType&&(o=parseInt(i.value),i.value=isNaN(o)?"":o,i.data[i.columnName]=i.value),i.currentValue=i.value,r=m.getIndexByRow(i.rowElement),a=p.enableVirtualization?p.currentViewData[r]:f[r],i.rowIndex=f.indexOf(a)),i.currentValue!=i.previousValue||"dragAndDrop"==i.requestType||"addNewRow"==i.requestType||m._batchEditCancel){if(n="addNewRow"==i.requestType?p.updatedRecords[i.rowIndex]:f[i.rowIndex],m._batchEditCancel&&(n=i.record),n.parentItem&&(_=m._getpRecords(n,m)),t.isNullOrUndefined(_))return;for(d=0;d<_.length;d++)s=p.summaryRowRecords,g=[],m._getChildRecordsLength(_[d],f),e.each(s,function(o,r){var a,s,f,w,C,x;if(l=r.summaryRow,r.parentItem===_[d])for(g=[],a=l.summaryColumns.length,s=0;s<a;s++){var v=l.summaryColumns[s],S=v.prefix,R=v.suffix;t.isNullOrUndefined(S)&&(S=""),t.isNullOrUndefined(R)&&(R=""),"rowedit"==i.editType&&(i.columnName=v.dataMember,p.columns,f=m.getColumnIndexByField(i.columnName),"numericedit"==p.columns[f].editType&&(n[i.columnName]=parseInt(n[i.columnName]))),(w=v.displayColumn)||(w=v.dataMember),c=p.currentViewData.indexOf(r),u=m.getColumnIndexByField(w),i.data=r,-1!=u&&(m._frozenColumnsLength>0?m._frozenColumnsLength>u?i.rowElement=e(m.getRows()[0][c]):(i.rowElement=e(m.getRows()[1][c]),u-=m._frozenColumnsLength):i.rowElement=e(m.getRows()[c]),i.cellElement=i.rowElement.find(".e-rowcell").eq(u),C=S+m._getSummaryValues(v,m._flatChildRecords)+R,-1==g.indexOf(w)?(0!=e(i.cellElement).find(".e-summarytitle").length?(x=e(i.cellElement).find(".e-summarytitle").clone(),e(i.cellElement).empty().html(C).prepend(x)):e(i.cellElement).empty().html(C),r[w]=C,g.push(w)):(e(i.cellElement).append(" "+C),r[w]=r[w]+" "+C),h.push(r),m._updateWrapRowHeights("total,header","virtualRefresh",c,"savecell"))}}),m._flatChildRecords=[],m._summaryRowCount=_.length}}},_updateTotalSummaryRow:function(i){var l,n,o,r;if("dragAndDrop"!=i.requestType&&!i.isDragAndDropDelete){var a,d,s,c,u,g,m=this,p=m.model,h=p.summaryRows,_=h.length;for(l=0;l<_;l++)for(d=(a=h[l].summaryColumns).length,s=m._footerSummaryRecord[l],n=[],o=0;o<d;o++){var f=a[o],w=f.prefix,C=f.suffix;if(t.isNullOrUndefined(w)&&(w=""),t.isNullOrUndefined(C)&&(C=""),("rowedit"==i.editType||"celledit"==i.editType)&&(i.columnName=f.dataMember),c||(c=f.dataMember),(f.dataMember==i.columnName||"delete"==i.requestType||"filtering"==i.requestType||"addNewRow"==i.requestType||"searching"==i.requestType)&&(c=f.displayColumn,u=m._footerSummaryRecord.indexOf(s),g=m.getColumnIndexByField(c),i.data=s,-1!=g)){this._frozenColumnsLength>0?this._frozenColumnsLength>g?i.rowElement=this._getFooterRows()[0][u]:(i.rowElement=this._getFooterRows()[1][u],g-=this._frozenColumnsLength):i.rowElement=this._getFooterRows()[u],i.cellElement=i.rowElement.childNodes[g];var x=m._spliceSummaryRows(p.updatedRecords),v=w+m._getSummaryValues(f,x)+C;-1==n.indexOf(c)?(0!=e(i.cellElement).find(".e-summarytitle").length||e(i.cellElement).find(".e-icon").length>0?(r=e(i.cellElement).find(".e-summarytitle, .e-icon").clone(),e(i.cellElement).empty().html(v).prepend(r)):e(i.cellElement).empty().html(v),n.push(c),s[c]=v):(e(i.cellElement).find(".e-summarytitle").length>0||e(i.cellElement).find(".e-icon").length>0?e(i.cellElement).find(".e-summarycell").append(" "+v):e(i.cellElement).append(" "+v),s[c]=s[c]+" "+v)}}p.allowTextWrap&&m._updateTotalSummaryHeight()}},_updateAfterDeleteRecord:function(i){var l,n,o,r,a,d=this,s=d.model,c=[],u=i.data;if(u.parentItem&&(n=d._getpRecords(u,d)),!t.isNullOrUndefined(n))for(r=0;r<n.length;r++)a=s.summaryRowRecords,0!=n[r].childRecords.length&&(d._getChildRecordsLength(n[r],s.updatedRecords),e.each(a,function(a,u){var g,m,p,h;if(l=u.summaryRow,u.parentItem===n[r]){for(o=[],g=l.summaryColumns.length,m=0;m<g;m++){var _=l.summaryColumns[m],f=_.displayColumn,w=s.currentViewData.indexOf(u),C=d.getColumnIndexByField(f),x=_.prefix,v=_.suffix;t.isNullOrUndefined(x)&&(x=""),t.isNullOrUndefined(v)&&(v=""),i.data=u,d._frozenColumnsLength>0?d._frozenColumnsLength>C?i.tr=e(d.getRows()[0][w]):(i.tr=e(d.getRows()[1][w]),C-=d._frozenColumnsLength):i.tr=e(d.getRows()[w]),i.tr=e(d.getRows()[w]),i.cellElement=i.tr.find(".e-rowcell").eq(C),p=x+d._getSummaryValues(_,d._flatChildRecords)+v,-1==o.indexOf(f)?(0!=e(i.cellElement).find(".e-summarytitle").length?(h=e(i.cellElement).find(".e-summarytitle").clone(),e(i.cellElement).empty().html(p).prepend(h)):i.cellElement.empty().html(p),u[f]=p,o.push(f)):(e(i.cellElement).append(" "+p),u[f]=u[f]+" "+p)}c.push(u)}}),d._flatChildRecords=[])},_getpRecords:function(e){var t=[];do{e=e.parentItem,t.push(e)}while(e.parentItem);return t},_renderGridContent:function(){var i,l,n,o=this,r=document,a=o.model,d=e(r.createElement("tbody")),s=t.buildTag("div.e-gridcontent#"+o._id+"e-gridcontent","",{height:o._viewPortHeight}),c=t.buildTag("div.e-gridcontainer#"+o._id+"e-gridcontainer","",{},{}),u=t.buildTag("div",{},{width:"auto",height:"auto"});return u.append(c),(a.enableVirtualization||a.allowPaging)&&c.css({height:o._totalHeight}),this._frozenColumnsLength>0?(c.html(o._renderByFrozenDesign()),o.setGridContentTable(c.find(".e-table"))):((i=t.buildTag("table.e-table e-zerospace#"+o._id+"e-table","",{top:"0px",position:"relative"})).append(o.getHeaderTable().find("colgroup").clone()).append(d),c.html(i),o.setGridContentTable(i)),s.html(u),o._$gridContent=s,null===this.dataSource()||0==this.model.currentViewData.length?this._frozenColumnsLength>0?(l=o._getFrozenHiddenCol(),n=t.buildTag("td",a.emptyRecordText,{},{colSpan:this._frozenColumns.length-l.frozen}),c.find("#e-frozencontentdiv"+o._id+" .e-table tbody").append(e(r.createElement("tr")).addClass("e-emptyText").height(30).append(n)),n=t.buildTag("td",a.emptyRecordText,{visibility:"hidden"},{colSpan:this._unFrozenColumns.length-l.moveable}),c.find("#e-movablecontentdiv"+o._id+" .e-table tbody").append(e(r.createElement("tr")).addClass("e-emptyText").height(30).append(n))):(n=t.buildTag("td",a.emptyRecordText,{},{colSpan:o.model.columns.length-o._hiddenColumns.length}),d.append(e(r.createElement("tr")).addClass("e-emptyText").height(30).append(n)),c.css("height",a.rowHeight)):o.renderRecords(),a.isFromGantt?s.css({"border-left-style":"solid","border-left-width":"1px"}):s.css({"border-bottom-style":"solid","border-bottom-width":"1px","border-left-style":"solid","border-left-width":"1px","border-right-style":"solid","border-right-width":"1px",width:"auto",height:"auto",cursor:"default"}),s},_getFrozenHiddenCol:function(){var e,t=this.model.columns,i={};if(i.frozen=0,i.moveable=0,this._hiddenColumns.length)for(e=0;e<t.length;e++)!t[e].visible&&t[e].isFrozen?i.frozen=i.frozen+1:t[e].visible||t[e].isFrozen||(i.moveable=i.moveable+1);return i},_initialEndRendering:function(){var e,t=this,i=t.model,l=(t.getExpandedRecords(i.updatedRecords),t.selectedRowIndex()),n=t.selectedCellIndexes();i.allowSelection&&("row"!=i.selectionSettings.selectionMode||-1==l||i.isFromGantt||(i.showSummaryRow&&(e=t._spliceSummaryRows(i.updatedRecords)[l],l=i.updatedRecords.indexOf(e)),t._rowSelectingEventTrigger(this._previousIndex,l)||(t.selectRows(l),t._cancelSaveTools(),t._rowSelectedEventTrigger(l))),"cell"==i.selectionSettings.selectionMode&&n.length>0&&(t.selectedRowIndex(-1),t.selectCells(n),t._cancelSaveTools())),t._isRendered=!0,this._trigger("dataBound",{}),t._trigger("refresh"),t._eventBindings(),t._hideCollapsedDetailsRows(),t.getScrollElement().ejScroller("refresh"),t._updateScrollCss()},_addCellEditTemplate:function(){var i,l,n,o,r=this,a=r.model.columns,d=0,s=t.buildTag("div","",{display:"none"},{id:r._id+"_CellEditTemplate"});for(d=0;d<a.length;d++)a[d]&&(l=r._getFieldValue(a[d].field,d),r._isCommandColumn(a[d])?(i=t.buildTag("td.e-rowcell e-unboundcell","",{},{id:l+"_CellEdit"}),n=a[d],e("#"+this._id+d+"_UnboundTemplate").remove(),o=this._createCommandElement(n,d),i.addClass("e-unboundcell").html("{{:~_"+this._id+"UnboundTemplate('"+o.id+"')}}")):(i=t.buildTag("div","",{},{id:l+"_CellEdit"}),t.TreeGrid._initCellEditType(r,i,r._id,d)),s.append(i));s.children().length&&(r._cellEditTemplate=s)},_getState:function(){return!this.data.parentItem},_getCellIndex:function(e,t){for(var i=[],l=0;l<e.length;l++)i[l]=e[l][t];return i},_getSelectedCellClass:function(e,i){var l,n=this,o=n.model,r=parseInt(i),a=n._selectedCellDetails;return"cell"==o.selectionSettings.selectionMode&&a.length>0&&(n._getSelectedCellsinARow(e.index,a),n._selectedCellsinARow.length>0&&(-1!=(l="msie"==t.browserInfo().name&&t.browserInfo().version<9?n._getCellIndex(n._selectedCellsinARow,"cellIndex").indexOf(r):n._selectedCellsinARow.map(function(e){return e.cellIndex}).indexOf(r))&&n._selectedCellsinARow[l].cellIndex==r))?"e-selectingcell":""},_getBatchEditState:function(e,t){this.model;return(!this._checkboxSelection||"checkboxState"!=t)&&(!!(e.isBatchAdd||e.batchEditedFields&&null!=e.batchEditedFields[t])||void 0)},_getSelectedCellsinARow:function(e,t){var i=this;i._selectedCellsinARow=[],t.forEach(function(t){t.data.index==e&&i._selectedCellsinARow.push(t)}),i._currentRecordIndex=e},_getrowName:function(){return"gridrowIndex"+this.data.index.toString()+"level"+this.data.level.toString()},_getDetailsColSpan:function(e){var t=this.model;return this._frozenColumnsLength>0?e?this._frozenColumns.filter(function(e){return!1!==e.visible}).length:this._unFrozenColumns.filter(function(e){return!1!==e.visible}).length:t.showDetailsRowInfoColumn?this._visibleColumns.length+1:this._visibleColumns.length},_getDetailsExpandStatus:function(e){return!(!this.getExpandStatus(e)||!e.isDetailsExpanded)},_createDetailsRowTemplate:function(t){var i,l,n,o,r=this,a=this.model,d={};return d["_"+r._id+"getDetailsColSpan"]=e.proxy(r._getDetailsColSpan,r),d["_"+r._id+"getDetailsExpandStatus"]=e.proxy(r._getDetailsExpandStatus,r),d["_"+r._id+"getExpandStatus"]=e.proxy(r.getExpandStatus,r),e.views.helpers(d),i="{{if !isSummaryRow && !footerSummaryRowRecord}}<tr class='e-detailsrow e-treegridrows detailsrow{{:~_"+r._id+"rowClassName()}} {{if isDetailsExpanded}}e-detailsrowexpanded{{else}}e-detailsrowcollapsed{{/if}}{{if !~_"+r._id+"getExpandStatus(#data) && isDetailsExpanded}} e-collapsedrowexpandeddetailsrow{{/if}}' style='{{if ~_"+r._id+"getDetailsExpandStatus(#data)}}display:table-row;{{else}}visibility:none;{{/if}}height:"+a.detailsRowHeight+"px;'><td class='e-detailsrowcell' colspan='{{:~_"+r._id+"getDetailsColSpan("+t+")}}'><div class='e-detailscellwrapper' style='height:"+(a.detailsRowHeight-1)+"px;'>",l="",a.detailsTemplate&&a.detailsTemplate.length>0&&(l=document.getElementById(a.detailsTemplate)?"#"+a.detailsTemplate:a.detailsTemplate),t||(e("#treeGridDetailsRowTemplateElement"+r._id).remove(),n=this._createDetailRowTemplateElement(l),i+="{{:~_"+r._id+"treeGridTemplating('"+n.id+"')}}"),i+="</div></td></tr>",i+="{{/if}}",t||((o={})[r._id+"_detailRowTemplate"]=i,e.templates(o)),i},_SelectState:function(){return!!this.model.allowSelection},_unboundClickHandler:function(t){var i,l,n,o=this,r=this.model,a=e(t.target).closest("button");(a.hasClass("e-deletebutton")||a.hasClass("e-editbutton")||a.hasClass("e-savebutton")||a.hasClass("e-cancelbutton"))&&(a.hasClass("e-button")&&(a.hasClass("e-disable")||a.prop("disabled"))||e(t.target).hasClass("e-unboundcelldiv")||(i="dialogEditing"==o.model.editSettings.editMode?e("#"+o._id+"EditFormDialog"):e("#"+o._id+"EditForm"),l=a.hasClass("e-savebutton")||a.hasClass("e-cancelbutton")?o.getIndexByRow(i.closest("tr")):o.getIndexByRow(a.closest("tr")),o.selectRows(o.getUpdatedRecords().indexOf(r.currentViewData[l])),a.hasClass("e-editbutton")&&r.editSettings.allowEditing?(o._isRowEdit&&o.cancelEdit(),"dialogEditing"!=r.editSettings.editMode?(n=o.getCellIndex(t),o._editRow(o.getUpdatedRecords().indexOf(r.currentViewData[l]),null,n)):o.showEditDialog(o.getUpdatedRecords().indexOf(r.currentViewData[l]))):a.hasClass("e-deletebutton")?o.deleteRow(null,!0):a.hasClass("e-savebutton")?o.saveRow():a.hasClass("e-cancelbutton")&&o.cancelEdit()))},_createCommandElement:function(i,l){var n,o,r,a,d=document.createElement("div");for(d.id=this._id+l+"_UnboundTemplate",n=t.buildTag("div.e-unboundcelldiv"),o=i.commands,r=0;r<o.length;r++)t.isNullOrUndefined(o[r].type)||((a=t.buildTag("button.e-"+o[r].type.replace(/\s+/g,"")+"button","",{},{type:"button"})).val(o[r].type),n.append(a));return e("body").append(e(d).html(n).hide()),d},_refreshUnboundTemplate:function(i){var l,n,o,r,a,d=this,s=d.model;if(d._commandColumnLength>0)for(l=0;l<s.columns.length;l++){if(!d._isCommandColumn(s.columns[l]))continue;for(n=i.find(".e-unboundcell").find(".e-unboundcelldiv"),o=e.extend(!0,[],s.columns[l].commands),r=0;r<o.length;r++)t.isNullOrUndefined(o[r].buttonOptions)&&(o[r].buttonOptions={}),o[r].buttonOptions.width=t.isNullOrUndefined(o[r].buttonOptions.width)?"52":o[r].buttonOptions.width,o[r].buttonOptions.height=t.isNullOrUndefined(o[r].buttonOptions.height)?"22":o[r].buttonOptions.height,o[r].buttonOptions.showRoundedCorner=!!t.isNullOrUndefined(o[r].buttonOptions.showRoundedCorner)||o[r].buttonOptions.showRoundedCorner,o[r].buttonOptions.size=t.isNullOrUndefined(o[r].buttonOptions.size)?"small":o[r].buttonOptions.size,t.isNullOrUndefined(o[r].type)||(a=n.find(".e-"+o[r].type.replace(/\s+/g,"")+"button"),i.find(".e-unboundeditedcell").length>0?"save"==o[r].type||"cancel"==o[r].type?a.show():(a.hasClass("e-deletebutton")&&a.hide(),a.hasClass("e-editbutton")&&a.hide()):"save"==o[r].type||"cancel"==o[r].type?a.hide():(a.hasClass("e-deletebutton")&&a.show(),a.hasClass("e-editbutton")&&a.show()),a.ejButton(o[r].buttonOptions))}},_unboundTemplateRendering:function(t){return e("#"+t).html()},_collapsibleSummary:function(e,t){var i=this.model;i.columns;if(i.showTotalSummary&&i.collapsibleTotalSummary&&this._summaryColumnIndex==parseInt(e)&&t.isFirstFooterSummary)return!0},_summaryIndendCell:function(e){var t=this.model;t.columns;if(t.showTotalSummary&&t.collapsibleTotalSummary&&this._summaryColumnIndex==parseInt(e)){if(0!=this._summaryColumnIndex)return!0;if(0==this._summaryColumnIndex)return!1}},_getsummaryExpandStatus:function(e){return t.isNullOrUndefined(e.summaryExpanded)||e.summaryExpanded||(this._summaryExpanded=!1),this.model.collapsibleTotalSummary&&!this._summaryExpanded?e.isFirstFooterSummary?"table-row":"none":"table-row"},_addInitTemplate:function(){var l,n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C,x,v,S,R,T,b=this,y=b.model,I=y.columns,D=0,E=I.length,M=!1,k={};if(b._commandColumnLength=0,0===I.length)return!1;if(this._frozenColumnsLength>0&&(this.addFrozenTemplate(),y.showTotalSummary&&this.addFrozenSummaryTemplate()),k["_"+b._id+"rowClassName"]=t.TreeGrid._getrowClassName,k["_"+b._id+"SummaryRowtdClassName"]=t.TreeGrid._getSummaryRowtdClassName,k["_"+b._id+"summaryIndendCell"]=e.proxy(b._summaryIndendCell,b),k["_"+b._id+"collapsibleSummary"]=e.proxy(b._collapsibleSummary,b),k["_"+b._id+"isSelectedCell"]=e.proxy(b._getSelectedCellClass,b),k["_"+b._id+"batchEditState"]=e.proxy(b._getBatchEditState,b),k["_"+b._id+"summaryTitle"]=b._getSummaryTitle,k["_"+b._id+"rowName"]=b._getrowName,k["_"+b._id+"getState"]=b._getState,k["_"+b._id+"SelectState"]=e.proxy(b._SelectState,b),k["_"+b._id+"summaryExpandStatus"]=e.proxy(b._getsummaryExpandStatus,b),k["_"+b._id+"expandStatus"]=e.proxy(b._getExpandStatusRecord,b),k["_"+b._id+"cellValue"]=e.proxy(b._getCellValue,b),k["_"+b._id+"TemplateCellValue"]=e.proxy(b._getTemplateCellValue,b),k["_"+b._id+"isTreeColumnIndex"]=e.proxy(b._isTreeColumnIndex,b),k["_"+b._id+"getIndentWidth"]=e.proxy(b._getIndentWidth,b),k["_"+b._id+"checkColumn"]=e.proxy(b._getCellColumn,b),k["_"+b._id+"formatting"]=e.proxy(b.formatting,b),k["_"+b._id+"treeGridTemplating"]=t.proxy(b._gridTemplate,null,b),k["_"+b._id+"getCheckboxState"]=e.proxy(b._getCheckboxState,b),k["_"+b._id+"UnboundTemplate"]=e.proxy(b._unboundTemplateRendering,b),k["_"+b._id+"isTrimCell"]=e.proxy(b._checkIsTrimCell,b),k["_"+b._id+"getRowHeight"]=e.proxy(b._getTemplateRowHeight,b),e.views.helpers(k),y.allowTextWrap&&(M=b.model.allowTextWrap),y.parseRowTemplate&&(y.rowTemplateID.length>0||y.altRowTemplateID.length>0)){var F=t.buildTag("tbody","",{},{}),O=t.buildTag("tbody","",{},{}),H="",z="",P=y.altRowTemplateID.length>0?e("#"+y.altRowTemplateID):e("#"+y.rowTemplateID),A=y.rowTemplateID.length>0?e("#"+y.rowTemplateID):e("#"+y.altRowTemplateID),N=P[0].innerHTML,G=A[0].innerHTML;if(e(F[0]).html(N),e(O[0]).html(G),O[0].childNodes.length>0)for(a=0;a<O[0].childNodes.length;a++)if("TR"==O[0].childNodes[a].nodeName&&(O[0].className=O[0].childNodes[a].className,O[0].style.cssText=O[0].childNodes[a].style.cssText,O[0].childNodes[a].childNodes.length>0))for(d=0,s=0;s<O[0].childNodes[a].childNodes.length;s++)"TD"==(c=O[0].childNodes[a].childNodes[s]).nodeName&&(u=c.innerHTML,g=b._id+"RowTemplateElement"+d,e("#"+g).remove(),v=this._createRowTemplateElement(u,g,A[0].type),c.innerHTML="{{:~_"+b._id+"treeGridTemplating('"+v.id+"')}}",c.className+=" e-rowcell e-templatecell",I[d]&&(l=(n=I[d]).field,w=n.visible==i||n.visible,m="",n.headerText==b._visibleColumns[0]&&(m="{{if isSummaryRow || footerSummaryRowRecord}}<div class='e-summarytitle{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='float:left;display:block;'>{{:~_"+b._id+"summaryTitle()}}</div>{{/if}}"),d==y.treeColumnIndex?(p="<div class='e-inner-treecolumn-container' style='min-height:20px;' data-unselectable='on'>{{if hasChildRecords && hasFilteredChildRecords}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:((filterLevel)*"+b.treeIndentLevelWidth+")}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:((level)*"+b.treeIndentLevelWidth+")}}px; display:inline-block;'>{{/if}}{{if !~_"+b._id+"getState() || !hasChildRecords }}<div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-childIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-cancelIcon e-icon' style='position:relative;float:right;display:none;'></span></div>{{/if}}</div>{{else !hasChildRecords || (!hasFilteredChildRecords && hasChildRecords)}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:(filterLevel*"+b.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:(level*"+b.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{/if}}{{if !~_"+b._id+"getState() || !hasChildRecords || !hasFilteredChildRecords }}<div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon iconMargin e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-childIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-cancelIcon iconMargin e-icon' style='float:right;display:none;'></span></div>{{/if}}</div>{{/if}}{{if ~_"+b._id+"getState() && hasChildRecords && hasFilteredChildRecords}}<div class='e-intendparent'><div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:left;display:none;'></span><span class='e-belowIcon e-icon' style='float:left;display:none;'></span><span class='e-childIcon e-icon' style='float:left;display:none;'></span><span class='e-cancelIcon e-icon' style='float:left;display:none;'></span></div></div>{{/if}}<div class='{{if expanded && hasFilteredChildRecords}}e-treegridexpand e-icon{{else hasChildRecords && hasFilteredChildRecords}}e-treegridcollapse e-icon{{/if}}' style='float:left;display:inline-block;font-size:10px;'></div><div class='e-cell{{if "+(n.showCheckbox&&this.model.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox)+"}} e-treecheckboxcolumn{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}' style='overflow: hidden;'>",c.style.cssText="padding-left:0px;",H+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+b._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"'>"+p+"{{else}}'>{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+d+"',#data)}}<div class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+m+"{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",H+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}",H+="{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}</div>{{/if}}</div></div></td>"):(H+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+b._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"{{/if}}'>{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+d+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+m+"{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",H+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}",H+="{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}</div>{{/if}}</td>"),this._frozenColumnsLength>0&&this._frozenColumnsLength==d+1&&(r="",r+=H,r+="</tr>",H=""),d++));if(F[0].childNodes.length>0)for(a=0;a<F[0].childNodes.length;a++)if("TR"==F[0].childNodes[a].nodeName)for(F[0].className=F[0].childNodes[a].className,F[0].style.cssText=F[0].childNodes[a].style.cssText,d=0,s=0;s<F[0].childNodes[a].childNodes.length;s++)"TD"==(c=F[0].childNodes[a].childNodes[s]).nodeName&&(u=c.innerHTML,g=b._id+"AltRowTemplateElement"+d,e("#"+g).remove(),v=this._createRowTemplateElement(u,g,P[0].type),c.innerHTML="{{:~_"+b._id+"treeGridTemplating('"+v.id+"')}}",c.className+=" e-rowcell e-templatecell",I[d]&&(l=(n=I[d]).field,w=n.visible==i||n.visible,m="",n.headerText==b._visibleColumns[0]&&(m="{{if isSummaryRow || footerSummaryRowRecord}}<div class='e-summarytitle{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='float:left;display:block;'>{{:~_"+b._id+"summaryTitle()}}</div>{{/if}}"),d==y.treeColumnIndex?(p="<div class='e-inner-treecolumn-container' style='min-height:20px;'>{{if hasChildRecords && hasFilteredChildRecords}}{{if filterLevel > -1}}<div class='e-dragintend' style='height:1px; float:left;width:{{:((filterLevel)*"+b.treeIndentLevelWidth+")}}px; display:inline-block;'>{{else}}<div class='e-dragintend' style='height:1px; float:left;width:{{:((level)*"+b.treeIndentLevelWidth+")}}px; display:inline-block;'>{{/if}}{{if !~_"+b._id+"getState() || !hasChildRecords }}<div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-childIcon e-icon' style='position:relative;float:right;display:none;'></span><span class='e-cancelIcon e-icon' style='position:relative;float:right;display:none;'></span></div>{{/if}}</div>{{else !hasChildRecords || (!hasFilteredChildRecords && hasChildRecords)}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:(filterLevel*"+b.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:(level*"+b.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{/if}}{{if !~_"+b._id+"getState() || !hasChildRecords || !hasFilteredChildRecords}}<div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon iconMargin e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-childIcon iconMargin e-icon' style='float:right;display:none;'></span><span class='e-cancelIcon iconMargin e-icon' style='float:right;display:none;'></span></div>{{/if}}</div>{{/if}}{{if ~_"+b._id+"getState() && hasChildRecords && hasFilteredChildRecords}}<div class='e-intendparent'><div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:left;display:none;'></span><span class='e-belowIcon e-icon' style='float:left;display:none;'></span><span class='e-childIcon e-icon' style='float:left;display:none;'></span><span class='e-cancelIcon e-icon' style='float:left;display:none;'></span></div></div>{{/if}}<div class='{{if expanded&& hasFilteredChildRecords}}e-treegridexpand e-icon{{else hasChildRecords && hasFilteredChildRecords}}e-treegridcollapse e-icon{{/if}}' style='float:left;display:inline-block;font-size:10px;'></div><div class='e-cell{{if "+n.showCheckbox+"}} e-treecheckboxcolumn{{/if}}{{if  ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}' style='overflow:hidden'>",c.style.cssText="padding-left:0px;",z+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+b._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"'>"+p+"{{else}}'>{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+d+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+m+"{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",z+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}",z+="{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}</div>{{/if}}</div></div></td>"):(z+="<td class='"+c.className+"{{if isSummaryRow || footerSummaryRowRecord}} e-summaryrowcell{{/if}}{{if isSelected && ~_"+b._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}} e-hide{{/if}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}} e-summaryintend{{/if}}' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.style.cssText+"{{/if}}'>{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+d+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}"+c.innerHTML+"{{else}}"+m+"{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",z+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}",z+="{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+d+")}}</div>{{/if}}</td>"),this._frozenColumnsLength>0&&this._frozenColumnsLength==d+1&&(h="",h+=z,h+="</tr>",z=""),d++));y.showDetailsRow&&y.detailsTemplate&&y.showDetailsRowInfoColumn&&(z+="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-selectionbackground{{/if}} {{if isDetailsExpanded}}e-detailsrowexpand{{else}}e-detailsrowcollapse{{/if}}  e-detailsrowcell{{if isLastSummary}} e-lastsummaryrow{{/if}}'>{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-detailsiconcell e-icon {{if isDetailsExpanded}}e-detailsinfoiconhide{{else}}e-detailsinfoiconshow{{/if}}'></div>{{/if}}",H+="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-selectionbackground{{/if}} {{if isDetailsExpanded}}e-detailsrowexpand{{else}}e-detailsrowcollapse{{/if}}  e-detailsrowcell{{if isLastSummary}} e-lastsummaryrow{{/if}}'>{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-detailsiconcell e-icon {{if isDetailsExpanded}}e-detailsinfoiconhide{{else}}e-detailsinfoiconshow{{/if}}'></div>{{/if}}"),_="{{if isAltRow}}<tr class='{{:~_"+b._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+F[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+F[0].style.cssText+"{{else}}height:"+y.rowHeight+"px;{{/if}}display:{{if footerSummaryRowRecord}}{{:~_"+b._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+b._id+"expandStatus(#data)}}{{/if}}''>"+z+"</tr>{{else}}<tr class='{{:~_"+b._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+O[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+O[0].style.cssText+"{{else}}height:"+y.rowHeight+"px;{{/if}}display:{{if footerSummaryRowRecord}}{{:~_"+b._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+b._id+"expandStatus(#data)}}{{/if}}''>"+H+"</tr>{{/if}}",R="{{if isAltRow}}<tr class='{{:~_"+b._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+F[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+F[0].style.cssText+"{{else}}height:"+y.rowHeight+"px;{{/if}} display:{{if footerSummaryRowRecord}}{{:~_"+b._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+b._id+"expandStatus(#data)}}{{/if}}''>"+r+"</tr>{{else}}<tr class='{{:~_"+b._id+"rowClassName()}} {{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}} e-templaterow "+O[0].className+"' style='{{if !isSummaryRow && !footerSummaryRowRecord}}"+O[0].style.cssText+"{{else}}height:"+y.rowHeight+"px;{{/if}} display:{{if footerSummaryRowRecord}}{{:~_"+b._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+b._id+"expandStatus(#data)}}{{/if}}''>"+h+"</tr>{{/if}}"}else if(!y.parseRowTemplate&&(y.rowTemplateID.length>0||y.altRowTemplateID.length>0))y.rowTemplateID&&y.altRowTemplateID?_="{{if isAltRow}}"+e.trim(e("#"+y.rowTemplateID).html())+"{{else}}"+e.trim(e("#"+y.altRowTemplateID).html())+"{{/if}}":y.rowTemplateID.length>0?_=e.trim(e("#"+y.rowTemplateID).html()):y.altRowTemplateID.length>0&&(_=e.trim(e("#"+y.altRowTemplateID).html()));else{for(_="<tr class='e-treegridrows {{:~_"+b._id+"rowClassName()}} ",y.enableAltRow&&(_+="{{if isAltRow}}e-alt-row{{/if}} "),f="",D=0;D<E;D++)I[D]&&(l=I[D].field,n=I[D],w=I[D].visible==i||I[D].visible,C=I[D].textAlign,m="",n.headerText==b._visibleColumns[0]&&(m="{{if isSummaryRow || footerSummaryRowRecord}}<div class='e-summarytitle{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='float:left;display:block;'>{{:~_"+b._id+"summaryTitle()}}</div>{{/if}}"),n.isTemplateColumn&&(n.angularTemplate||n.templateID||n.template)?(_+="e-templaterow ",x=n.headerText,t.isNullOrUndefined(x)||t.isNullOrUndefined(x.match(/(\\|[^0-9A-z-_])/g))||(x=x.replace(/(\\|[^0-9A-z-_])/g,"")),e("#"+b._id+x+e.inArray(n,this.model.columns)+"_Template").remove(),v=this._createTemplateElement(n),o="<td class='{{if !isSummaryRow && !footerSummaryRowRecord}} e-intend{{/if}} e-rowcell e-templatecell{{if isSelected && ~_"+b._id+"SelectState()}} e-selectionbackground{{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}} e-hide{{/if}}{{:~_"+b._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}} e-summaryintend{{/if}}{{if ~_"+b._id+"batchEditState(#data,'"+l+"')}}e-updatedtd e-tgupdatenotify{{/if}}'style='text-Align:"+C+";'role='row'>{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+D+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+b._id+"treeGridTemplating('"+v.id+"','"+D+"')}}{{else}}"+m+"{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",o+="{{if isSummaryRow || footerSummaryRowRecord}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}",o+="{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}</div>{{/if}}</td>"):D===y.treeColumnIndex?(o="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-selectionbackground e-intend {{else}}e-rowcell {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if !isSummaryRow && !footerSummaryRowRecord}} e-intend{{/if}} {{/if}} {{:~_"+b._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}} e-summaryintend{{/if}}{{if ~_"+b._id+"batchEditState(#data,'"+l+"')}}e-updatedtd e-tgupdatenotify{{/if}} {{if hasChildRecords && hasFilteredChildRecords}} e-parentcell{{/if}}'style='padding-left:{{if ~_"+b._id+"isTreeColumnIndex('"+l+"') && isSummaryRow }}{{:((level)*"+b.treeIndentLevelWidth+")}}px{{/if}};background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+D+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-inner-treecolumn-container' style='min-height:20px;'>{{if hasChildRecords && hasFilteredChildRecords}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:((filterLevel)*"+b.treeIndentLevelWidth+")}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:((level)*"+b.treeIndentLevelWidth+")}}px; display:inline-block;'>{{/if}}{{if !~_"+b._id+"getState() || !hasChildRecords}}<div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}}  e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}}  e-icon' style='position:relative;float:right;display:none;'></span><span class='e-childIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}}  e-icon' style='position:relative;float:right;display:none;'></span><span class='e-cancelIcon {{if level == 1 && hasChildRecords}} e-firstLevIconMargin {{/if}} e-icon' style='position:relative;float:right;display:none;'></span></div>{{/if}}</div>{{else !hasChildRecords || (!hasFilteredChildRecords && hasChildRecords)}}<div class='e-dragintend'{{if filterLevel > -1}}style='height:1px; float:left; width:{{:(filterLevel*"+b.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{else}}style='height:1px; float:left; width:{{:(level*"+b.treeIndentLevelWidth+")+24}}px; display:inline-block;'>{{/if}}{{if !~_"+b._id+"getState() || !hasChildRecords || !hasFilteredChildRecords}}<div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon e-iconMargin e-icon'  style='position:relative;float:right;display:none;'></span><span class='e-belowIcon e-iconMargin e-icon' style='float:right;display:none;'></span><span class='e-childIcon e-iconMargin e-icon' style='float:right;display:none;'></span><span class='e-cancelIcon e-iconMargin e-icon' style='float:right;display:none;'></span></div>{{/if}}</div>{{/if}}{{if ~_"+b._id+"getState() && hasChildRecords && hasFilteredChildRecords}}<div class='e-intendparent'><div class={{:~_"+b._id+"rowName()}} ><span class='e-aboveIcon e-icon'  style='position:relative;float:left;display:none;'></span><span class='e-belowIcon e-icon' style='float:left;display:none;'></span><span class='e-childIcon e-icon' style='float:left;display:none;'></span><span class='e-cancelIcon e-icon' style='float:left;display:none;'></span></div></div>{{/if}}<div class='{{if expanded && hasFilteredChildRecords}}e-treegridexpand e-icon{{else hasChildRecords && hasFilteredChildRecords}}e-treegridcollapse e-icon{{/if}}'style='float:left;display:inline-block; font-size:10px;'></div><div class='e-cell{{if "+(n.showCheckbox&&this.model.selectionSettings.selectionType==t.TreeGrid.SelectionType.Checkbox)+"}} e-treecheckboxcolumn{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}} {{if "+M+"}} e-textwrapcell{{/if}}'style='overflow: hidden;padding-left:{{if ~_"+b._id+"isTreeColumnIndex('"+l+"') && isSummaryRow}}{{:(level*"+b.treeIndentLevelWidth+")+24}}px{{/if}};'>{{/if}}{{:~_"+b._id+"getCheckboxState(#data, '"+l+"', '"+b._checkboxColumnName+"')}}",t.isNullOrUndefined(n.format)?y.isFromGantt&&n.mappingName===y.resourceInfoMapping?((k={})["_"+b._id+"resourceName"]=b._getResourceName,e.views.helpers(k),o+="{{:~_"+b._id+"resourceName('"+b._id+"Object','"+y.resourceNameMapping+"','"+y.resourceUnitMapping+"','"+l+"')}}</div></div></td>"):y.isFromGantt&&n.mappingName===y.predecessorMapping?((k={})["_"+b._id+"predecessor"]=e.proxy(b._getPredecessorsValue,b),e.views.helpers(k),o+="{{:~_"+b._id+"predecessor(#data)}}</div></div></td>"):(o+=m+"{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}</div>{{/if}}{{if !isSummaryRow && !footerSummaryRowRecord}}</div></div></td>{{/if}}",m=""):o+="{{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+b._id+"formatting('"+n.format+"',~_"+b._id+"TemplateCellValue(#data,'"+l+"'),'"+this.model.locale+"')}}{{else}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}"):y.isFromGantt&&n.mappingName===y.resourceInfoMapping?((k={})["_"+b._id+"resourceName"]=b._getResourceName,e.views.helpers(k),o="<td  class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}}e-hide{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{:~_"+b._id+"resourceName('"+b._id+"Object','"+y.resourceNameMapping+"','"+y.resourceUnitMapping+"','"+l+"')}}</td>"):y.isFromGantt&&n.mappingName===y.predecessorMapping?((k={})["_"+b._id+"predecessor"]=e.proxy(b._getPredecessorsValue,b),e.views.helpers(k),o="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}}e-hide{{/if}}' style='background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{:~_"+b._id+"predecessor(#data)}}</td>"):y.isFromGantt&&n.mappingName===y.durationMapping?((k={})["_"+b._id+"getDurationString"]=e.proxy(b._getDurationString,b),e.views.helpers(k),o="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}}e-hide{{/if}}' style='background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};'role='row'>{{:~_"+b._id+"getDurationString(#data)}}</td>"):"booleanedit"==n.editType&&b._checkboxSelection&&"checkboxState"==l?o="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell{{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}}e-hide{{/if}}{{:~_"+b._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}} e-summaryintend {{/if}}{{if ~_"+b._id+"batchEditState(#data,'"+l+"')}}e-updatedtd e-tgupdatenotify{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};text-Align: center;'role='row'> {{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+D+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}"+m+"{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"', '"+b._checkboxColumnName+"')}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}</div>{{/if}}":b._isCommandColumn(n)?(e("#"+this._id+D+"_UnboundTemplate").remove(),S=b._createCommandElement(n,D),o="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-unboundcell e-selectionbackground {{else}}e-rowcell e-unboundcell {{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}}e-hide{{/if}}{{:~_"+b._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}} e-summaryintend{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};text-Align:"+C+"'role='row'> {{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+b._id+"UnboundTemplate('"+S.id+"')}}{{else}}{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+D+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}"+m+"{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"', '"+b._checkboxColumnName+"')}}{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}</div>{{/if}}",b._commandColumnLength=b._commandColumnLength+1,o+="</td>"):(o="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-rowcell e-selectionbackground{{else}}e-rowcell {{/if}} {{:~_"+b._id+"isSelectedCell(#data,'"+D+"')}} {{if "+!w+"}}e-hide{{/if}} {{:~_"+b._id+"SummaryRowtdClassName()}}{{if isLastSummary}} e-lastsummaryrow{{/if}}{{if ~_"+b._id+"isTrimCell('"+n.clipMode+"')}} e-treegridtrimcell{{/if}}{{if "+M+"}} e-textwrapcell{{/if}}{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}} e-summaryintend{{/if}}{{if ~_"+b._id+"batchEditState(#data,'"+l+"')}}e-updatedtd e-tgupdatenotify{{/if}}'style='background-color:{{if cellBackgroundColor && ~_"+b._id+"checkColumn('"+l+"',#data)=='"+l+"'}}{{:cellBackgroundColor}}{{else}}none{{/if}};text-Align:"+C+"'role='row'>{{:~_"+b._id+"getCheckboxState(#data, '"+l+"', '"+b._checkboxColumnName+"')}}{{if footerSummaryRowRecord && ~_"+b._id+"collapsibleSummary('"+D+"',#data)}}<div  class= '{{if summaryExpanded}} e-summarytreegridexpand e-icon{{else}} e-summarytreegridcollapse e-icon {{/if}}'style='float:left;display:inline-block; font-size:10px;'></div>{{/if}}"+m+"{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}<div class='e-summarycell'style='overflow: hidden;padding-left:25px;'>{{/if}}",o+=t.isNullOrUndefined(n.format)?"{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}":"{{if !isSummaryRow && !footerSummaryRowRecord}}{{:~_"+b._id+"formatting('"+n.format+"',~_"+b._id+"TemplateCellValue(#data,'"+l+"'),'"+this.model.locale+"')}}{{else}}{{:~_"+b._id+"TemplateCellValue(#data,'"+l+"')}}{{/if}}",o+="{{if footerSummaryRowRecord && ~_"+b._id+"summaryIndendCell("+D+")}}</div>{{/if}}</td>",m=""),f+=o),this._frozenColumnsLength>0&&this._frozenColumnsLength==D+1&&(R="",R+=f,R+="</tr>",f="");y.showDetailsRow&&y.detailsTemplate&&y.showDetailsRowInfoColumn&&(f+="<td class='{{if isSelected && ~_"+b._id+"SelectState()}}e-selectionbackground{{/if}} {{if isDetailsExpanded}}e-detailsrowexpand{{else}}e-detailsrowcollapse{{/if}}  e-detailsrowcell{{if isLastSummary}} e-lastsummaryrow{{/if}}'>{{if !isSummaryRow && !footerSummaryRowRecord}}<div class='e-detailsiconcell e-icon {{if isDetailsExpanded}}e-detailsinfoiconhide{{else}}e-detailsinfoiconshow{{/if}}'></div>{{/if}}"),R=(_+="{{if expanded && hasFilteredChildRecords}}e-treegridrowexpand {{else hasChildRecords && hasFilteredChildRecords}} e-treegridrowcollapse {{/if}}{{if isBatchDelete}}e-batchdisable {{/if}}'style='background-color:{{if rowBackgroundColor }}{{:rowBackgroundColor}}{{else}}none{{/if}}; height:{{:~_"+b._id+"getRowHeight(#data)}}px;display:{{if footerSummaryRowRecord}}{{:~_"+b._id+"summaryExpandStatus(#data)}}{{else}}{{:~_"+b._id+"expandStatus(#data)}}{{/if}}'role='treegrid'>")+R,_+=f,_+=y.isFromGantt?"<td class='e-extendcolumn'></td></tr>":"</tr>"}y.showDetailsRow&&y.detailsTemplate&&(_+="{{if isDetailsExpanded}}"+b._createDetailsRowTemplate()+"{{/if}}",R+="{{if isDetailsExpanded}}"+b._createDetailsRowTemplate(!0)+"{{/if}}"),b._summaryExpanded=!0,(T={})[b._id+"_Template"]=_,T[b._id+"_JSONFrozenTemplate"]=R,e.templates(T)},_gridTemplate:function(e,i,l){var n;return t.isNullOrUndefined(l)||(n=e.model.columns[l]),e._renderEjTemplate("#"+i,this.data,this.data.index,n)},_getIndentWidth:function(e){return e.level*this.treeIndentLevelWidth+"px"},_createDetailRowTemplateElement:function(i){var l,n=/^#([\w-]*)/.exec(i),o={name:"SCRIPT",type:"text/x-template",text:i,id:"treeGridDetailsRowTemplateElement"+this._id};return(l=n&&n[1]?document.getElementById(n[1]):/^<script/i.test(i)?e(i).get(0):t.buildTag(o.name,o.text).get(0)).id=l.id||o.id,l.type=l.type||o.type,e("body").append(l),l},_createRowTemplateElement:function(t,i,l){var n=document.createElement("script");return n.id=i,n.type=l||"text/x-template",n.text=t,e("body").append(n),n},_createTemplateElement:function(i,l){var n,o,r,a=l?"Pager":i.headerText+e.inArray(i,this.model.columns)+"_Template",d="template"in i?"template":"templateID"in i?"templateID":"angularTemplate",s=i[d];return"templateID"==d&&-1==s.indexOf("#")&&(s="#"+s),o=/^#([\w-]*)/.exec(s),r={name:"SCRIPT",type:"text/x-template",text:s,id:(this._id+a).replace(/(\\|[^0-9A-z-_])/g,"")},(n=o&&o[1]?document.getElementById(o[1]):/^<script/i.test(s)?e(s).get(0):t.buildTag(r.name,r.text).get(0)).id=n.id||r.id,n.type=n.type||r.type,e("#"+n.id).remove(),e("body").append(n),n},_getCheckboxState:function(e,t,i){if(t==i)return 1==e.isSummaryRow||e.summaryColumn||e.summaryRow?void 0:"indeterminate"==e.checkboxState?'<span class="e-chkbox-wrap e-widget" style="padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-indeter"><span class="e-checkbox e-chk-image e-icon e-stop" id ='+this._id+"_checkbox"+e.ejRowId+"></span></span></div></span>":"unchecked"==e.checkboxState?'<span class="e-chkbox-wrap e-widget" style="padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-inact"><span class="e-checkbox e-chk-image e-icon" id ='+this._id+"_checkbox"+e.ejRowId+"></span></span></div></span>":'<span class="e-chkbox-wrap e-widget" style="padding-right:10px;color:#c8c8c8;"><div class="e-chkbox-small"><span class="e-chk-act"><span class=" e-checkbox e-chk-image e-icon e-checkmark" id ='+this._id+"_checkbox"+e.ejRowId+"></span></span></div></span>"},_checkIsTrimCell:function(e){return!(!e||"ellipsis"!=e)},_getTemplateRowHeight:function(e){return this.model.isFromGantt&&"resourceView"==this.model.viewType?e.eOverlapIndex*this.model.rowHeight:this.model.rowHeight},_getCustomCellValue:function(e,i){var l,n,o;if(!t.isNullOrUndefined(e)){if((l=(i||"").split(".")).length<=1)n=e[i];else{if(n=e[l[0]],t.isNullOrUndefined(n))return null;for(o=1;o<l.length;o++)if(n=n[l[o]],t.isNullOrUndefined(n))return null}return n}},_restoreCustomData:function(e,i,l){var n,o,r=0,a=0;if(t.isNullOrUndefined(l)&&(l=this._cellEditingDetails.fieldName),o={},(n=(l||"").split(".")).length<=1)t.isNullOrUndefined(e)?(e={})[l]=i:e[l]=i;else{for(t.isNullOrUndefined(e)?(o=e={},a=0):(o=e[n[0]],t.isNullOrUndefined(o)&&(o={},e[n[0]]=o),a=1),r=a;r<n.length-1;r++)t.isNullOrUndefined(o[n[r]])&&(o[n[r]]={}),o=o[n[r]];o[n[r]]=i}return e},_getTemplateCellValue:function(l,n,o){var r,a,d,s,c,u,g,m,p,h=this,_=h.getColumnByField(n),f=_.editType,w=h._getCustomCellValue(l,n);if(w=t.isNullOrUndefined(w)?l.item&&l.item[n]:w,f==t.TreeGrid.EditingType.Boolean&&n==o?w=h._getCheckboxState(l,n,o):l.isSummaryRow||l.footerSummaryRowRecord||f!=t.TreeGrid.EditingType.Boolean||n==o||!(t.isNullOrUndefined(_.displayAsCheckbox)||_.displayAsCheckbox)||(w="true"==w||1==w?"<input class='e-treegrid-chekboxcell' type='checkbox' disabled='disabled' checked/>":"<input class='e-treegrid-chekboxcell' type='checkbox' disabled='disabled'/>"),h.model.isFromGantt&&("work"==n&&(w+=" "+h.model.workUnit),"taskMode"==n&&(w=!l.isAutoSchedule),"unit"==n&&(w+="%"),"duration"==n&&(w=h._getDurationString(l)),("startDate"==n||"endDate"==n||"duration"==n)&&(t.isNullOrUndefined(w)||""==w)&&(w=_.showNullText?h.model.nullText:"")),f==t.TreeGrid.EditingType.Dropdown&&!l.isSummaryRow&&!l.footerSummaryRowRecord)if(d=_.editParams,w=null!=w||w!=i?w:"",d&&d.fields?(a=d.fields.text?d.fields.text:"text",r=d.fields.value?d.fields.value:"value"):(r="value",a="text"),d&&(d.showCheckbox||d.multiSelectMode)){if(p=_.dropdownData,g=d&&!t.isNullOrUndefined(d.delimiterChar)?d.delimiterChar:",","string"==typeof w&&w.indexOf(g)>-1?c=(s=w.split(g)).length:s=w,w="",_.dropdownData)if(c)for(m=0;m<c;m++)(u=e.map(p,function(e){if(t.isNullOrUndefined(e[r])){if(e[a]==s[m])return e[a]}else if(e[r].toString()==s[m].toString())return e[a]}))[0]=u[0]?u[0]:"",w+=0==m?u[0]:g+u[0];else e.map(p,function(e){(t.isNullOrUndefined(e[r])||s.toString()!==e[r].toString())&&s!==e[a]||(w=e[a])})}else _.dropdownData&&(p=_.dropdownData,(u=e.map(p,function(e){if(t.isNullOrUndefined(e[r])){if(e[a].toString()==w)return e[a]}else if(e[r].toString()==w.toString())return e[a]}))[0]=t.isNullOrUndefined(u[0])?"":u[0],w=u[0]);return w},_getCellValue:function(e,t){var i=this._getCustomCellValue(e,t);return i||0===i?i:e.item&&e.item[t]},_isCommandColumn:function(e){this.model;var i=e.commands;return!(!t.isNullOrUndefined(i)&&0==i.length||t.isNullOrUndefined(i))},_isTreeColumnIndex:function(e){var t=this.model,i=t.columns[t.treeColumnIndex];return!(!i||i.field!=e)},_getSummaryTitle:function(){var e=this,t=e.data.summaryRow.title;return t||e.data.item&&e.data.item.summaryRow.title},_getCellColumn:function(e,t){return-1!==t.treeMappingName.indexOf(e)?e:"none"},_getResourceName:function(e,t,i,l){var n,o,r=this.data[l],a=0,d=r&&r.length,s=[];if(r&&r.length>0)for(;a<d;a++)n=r[a][t],100!=(o=r[a][i])&&(n+="["+o+"%]"),s.push(n);return s},_getDurationString:function(e){var i,l,n="";return t.isNullOrUndefined(e.duration)||""===e.duration?n=this.getColumnByField("duration").showNullText?this.model.nullText:n:("string"==typeof e.duration?(i=parseFloat(e.duration),n+=isNaN(i)?"":parseFloat(i.toFixed(2))+" "):n+=parseFloat(e.duration.toFixed(2))+" ",null!=e.durationUnit&&(l=1!=e.duration,n+="day"==e.durationUnit?l?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:"hour"==e.durationUnit?l?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:l?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute)),n},_getPredecessorsValue:function(e){var t,i,l,n,o,r=e.predecessor,a="";if(r)for(t=r.length,i=0;i<t;i++)n="",(l=r[i]).from!=e.taskId&&(n=l.from+l.predecessorsType,0!=l.offset&&(n+=l.offset>0?"+"+l.offset+" ":l.offset+" ",o=1!=Math.abs(l.offset),n+="day"==l.offsetDurationUnit?o?this.model.durationUnitTexts.days:this.model.durationUnitTexts.day:"hour"==l.offsetDurationUnit?o?this.model.durationUnitTexts.hours:this.model.durationUnitTexts.hour:o?this.model.durationUnitTexts.minutes:this.model.durationUnitTexts.minute),a=a.length>0?a+","+n:n);return a},_getExpandStatusRecord:function(e){return this.getExpandStatus(e)||this._isHierarchyFiltering&&e.isDisplay?"table-row":"none"},_createRecords:function(e){var i,l=this,n=l.model,o=l.model.ids,r=n.flatRecords,a=e.length,d=0,s=!0,c=n.parentRecords;for(!n.isFromGantt&&n.enableCollapseAll&&(s=!1);d<a;d++)(i=l._createRecord(e[d],0,null,s)).hierarchyRowIndex=d,l._storedIndex++,i.isAltRow=l._storedIndex%2!=0,c.push(i),i.index=l._storedIndex,o[l._storedIndex]=i.index,r.push(i),i.hasChildRecords&&l._parentRecords.push(i),i.childRecords&&l._addNestedRecords(i.childRecords),this.dataSource()instanceof t.DataManager&&l._isLoadonDemand&&(i.item[n.hasChildMapping]||-1!=l._assignedParendIDs.indexOf(i.item[n.idMapping]))&&(i.hasChildRecords=!0,i.childRecords=[],i.isChildRetrieved=!1);n.allowPaging&&!l._isRemoteData&&l._updateTotalRecordsCount(),l._maxRowIndex=this.model.flatRecords.length},_updateTotalRecordsCount:function(){var e,i=this.model,l=i.flatRecords;!t.isNullOrUndefined(i.pageSettings.totalRecordsCount)&&i.pageSettings.totalRecordsCount<=l.length?(e=i.pageSettings.totalRecordsCount,i.flatRecords=l.slice(0,e),i.flatRecords[e-1].hasChildRecords&&(i.flatRecords[e-1].hasChildRecords=!1,i.flatRecords[e-1].expanded=!1,i.flatRecords[e-1].childRecords=null,i.flatRecords[e-1].hasFilteredChildRecords=!1)):t.isNullOrUndefined(i.pageSettings.totalRecordsCount)&&(i.pageSettings.totalRecordsCount=l.length)},_createRecord:function(l,n,o,r){var a,d,s,c,u=this,g=l[u.model.childMapping],m=this.model;return a=e.extend({},l),m.parentIdMapping&&"load"===u._createdAt?(d=l[m.idMapping],s=u._taskIds.indexOf(d),a.item=s>-1?u._retrivedData[s]:[]):this.dataSource()instanceof t.DataManager&&this.dataSource().dataSource.json&&this.dataSource().dataSource.offline&&"load"===u._createdAt&&m.parentIdMapping?(d=l[m.idMapping],s=u._taskIds.indexOf(d),a.item=s>-1?u._retrivedData[s]:[]):a.item=l,a.parentItem=o,a.childRecords=g&&g.length>0&&u._createChildRecords(g,n+1,a),a.hasChildRecords=!!(g&&g.length>0),m.expandStateMapping&&a.hasChildRecords?(t.isNullOrUndefined(l[m.expandStateMapping])?t.isNullOrUndefined(l[m.expandStateMapping])&&!m.enableCollapseAll?a[m.expandStateMapping]=a.item[m.expandStateMapping]=l[m.expandStateMapping]=!0:t.isNullOrUndefined(l[m.expandStateMapping])&&m.enableCollapseAll&&(a[m.expandStateMapping]=a.item[m.expandStateMapping]=l[m.expandStateMapping]=!1):a[m.expandStateMapping]=a.item[m.expandStateMapping]=l[m.expandStateMapping],c=l[m.expandStateMapping]):c=!0,a.expanded=r!==i&&g!==i&&1==a.hasChildRecords&&c?r:!(!c||!g)&&g.length>0,a.dragState=!0,a.isSelected=!1,a.hasFilteredChildRecords=!0,a.level=n,a.canDrag=!0,a.canDrop=!0,a.cellBackgroundColor=null,a.rowBackgroundColor=null,a.textWrapRowHeight=m.rowHeight,a.treeMappingName=[],a.isDetailsExpanded=!(!m.showDetailsRow||!m.detailsTemplate)&&!m.showDetailsRowInfoColumn,m.isFromGantt||(a.ejRowId=++u._idGenerator),a.checkboxState="unchecked",delete a[m.childMapping],a},_createChildRecords:function(e,t,i){var l,n,o=this.model,r=[],a=0,d=e.length,s=null;for(!o.isFromGantt&&o.enableCollapseAll&&(l=!1),a=0;a<d;a++)(s=e[a])&&((n=this._createRecord(s,t,i,l)).hierarchyRowIndex=a,r.push(n));return r},_addNestedRecords:function(e){var t,i=this,l=i.model,n=i.model.ids,o=l.flatRecords,r=l.updatedRecords,a=0,d=e.length,s=[];for(a=0;a<d;a++)if(t=e[a],i._storedIndex++,t.isAltRow=i._storedIndex%2!=0,t.index=i._storedIndex,n[i._storedIndex]=t.index,o.push(t),r.push(t),t.hasChildRecords&&i._parentRecords.push(t),s=t.childRecords){var c=0,u=s.length,g=null;for(c=0;c<u;c++)g=s[c],i._storedIndex++,g.index=i._storedIndex,n[i._storedIndex]=g.index,g.isAltRow=i._storedIndex%2!=0,o.push(g),r.push(t),g.hasChildRecords&&i._parentRecords.push(g),g.childRecords&&i._addNestedRecords(g.childRecords)}},_enableColumnResizeEvents:function(){var e=this;e.model.allowColumnResize?e._on(e.element,"mousemove",e._mouseMove):e._off(e.element,"mousemove",e._mouseMove)},_wireEvents:function(){var i=this,l=i.model;jQuery.uaMatch(navigator.userAgent);t.isTouchDevice()?(i._on(i.element,"tap",i._onRecordClick),i._on(i.element,"doubletap",".e-gridcontent > div",i._onRecordDoubleClick),i._on(i.element,"tap",i._onClick)):(i._on(i.element,"click",i._onRecordClick),i._on(i.element,"dblclick",".e-gridcontent > div",i._onRecordDoubleClick),i._on(i.element,"click",i._onClick)),i._on(i.element,"keydown",i._keyDown),i._on(i.element,"click","#"+i._id+"e-gridheader",i._onHeaderClick),i._on(i.element,"mousedown touchstart","#"+i._id+"e-gridheader",i._headerMouseDown),i._on(e(document),"mousedown touchstart",i._mouseDownHandler),i._on(i.element,"mousedown touchstart",".e-gridcontent",i._contentMouseDown),this.model.isResponsive&&this._on(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),i.model.allowColumnResize&&i._on(i.element,"mousemove",i._mouseMove),"immediate"==l.filterSettings.filterBarMode&&(i._on(i.element,"keyup",".e-filterbarcell input",i._filterBarHandler),i._off(i.element,"click",".e-filterbarcell .e-checkbox")._on(i.element,"click",".e-filterbarcell .e-checkbox",i._filterBarHandler)),i._on(i.element,"focus click",".e-filterbarcell input",i._filterBarClose),i._on(i.element,"click",".e-filterbarcell .e-cancel",i._filterBarClose),(i.model.showGridCellTooltip||i.model.showGridExpandCellTooltip)&&i._on(i.element,"mousemove",".e-rowcell",i._mouseHover),i.model.showGridCellTooltip&&i._on(i.element,"mousemove",".e-headercelldiv",i._headermouseHover),i._on(i.element,"mouseleave",".e-rowcell",i._cellMouseLeave),i._on(i.element,"mouseleave",i._cellMouseLeave),i._on(i.element,"mouseleave",".e-headercelldiv",i._headerMouseLeave),i._on(i.element,"mouseleave",i._headerMouseLeave),(l.isFromGantt||this._frozenColumnsLength)&&i._on(i.element,"mousewheel DOMMouseScroll",i._mouseWheel),l.enableResize&&l.isResponsive&&!l.isFromGantt&&i._on(e(window),"resize",i._windowResize),i._enableEditingEvents(),this._on(this.element,"click",".e-unboundcelldiv button",this._unboundClickHandler),l.contextMenuSettings.showContextMenu&&i._on(i.element,"keyup contextmenu taphold",this._preventContextMenu)},_preventContextMenu:function(e){if(93==e.keyCode||"contextmenu"==e.type||"taphold"==e.type)return e.preventDefault(),e.stopPropagation(),!1},_mouseDownHandler:function(t){var i=this,l=e(t.target);0!=l.closest("div.e-tgheaderContextmenu").length||0!=l.closest("div.e-columnmenuitem").length||0!=l.closest("div.e-columnMenuListDiv").length||(l.hasClass("e-columnmenu-icon")||l.hasClass("e-column-filter-icon")||l.hasClass("e-column-filtered-icon"))&&0!=e(t.target).closest("#"+i._id).length||0!=l.closest("div.e-"+i._id+"filterStringSelector").length||0!=l.closest("div#"+i._id+"filterStringDropDown_popup_list_wrapper").length||0!=l.closest("div#"+i._id+"filterStringInputBox_suggestion").length||0!=l.closest("div.e-"+i._id+"filterNumericSelector").length||0!=l.closest("div#"+i._id+"filterNumericDropDown_popup_list_wrapper").length||0!=l.closest("div.e-"+i._id+"filterDatepickerSelector").length||0!=l.closest("div#"+i._id+"filterDatepickerDropDown_popup_list_wrapper").length||0!=l.closest("div#e-"+i._id+"filterDatepickerInputBox").length||0!=l.closest("div.e-"+i._id+"filterDatetimepickerSelector").length||0!=l.closest("div#"+i._id+"filterDatetimepickerDropDown_popup_list_wrapper").length||0!=l.closest("div#"+i._id+"filterDatetimepickerInputBox_popup").length||0!=l.closest("div.e-"+i._id+"filterDropdownSelector").length||0!=l.closest("div#"+i._id+"filterDropdownDropDown_popup_list_wrapper").length||0!=l.closest("div.e-"+i._id+"filterBooleanSelector").length||0!=l.closest("div.e-excelfilter").length||i._isExcelFilterClick(l)||i._clearColumnMenu(),l.hasClass("e-tgheaderContextmenu")||0==l.closest("div.e-menuitem").length&&0==l.closest("div.e-columnmenuselection").length&&0==l.closest("div.e-columnMenuListDiv").length&&i._clearContextMenu(),0==l.closest("div.e-detailscellwrapperfly").length&&i._removeDetailsRow(t)},_isExcelFilterClick:function(e){var t=this._id;return 0!=e.closest("#"+t+"number_CustomDrop1_popup").length||0!=e.closest("#"+t+"number_CustomDrop2_popup").length||0!=e.closest("#"+t+"datetime_CustomDrop1_popup").length||0!=e.closest("#"+t+"datetime_CustomDrop2_popup").length||0!=e.closest("#"+t+"date_CustomDrop1_popup").length||0!=e.closest("#"+t+"date_CustomDrop2_popup").length||0!=e.closest("#"+t+"string_CustomDrop1_popup").length||0!=e.closest("#"+t+"string_CustomDrop2_popup").length||0!=e.closest("#"+t+"datetime_CustomValue2_popup").length||0!=e.closest("#"+t+"datetime_CustomValue1_popup").length||0!=e.closest("#e-"+t+"date_CustomValue2").length||0!=e.closest("#e-"+t+"date_CustomValue1").length||0!=e.closest("#"+t+"string_CustomValue1_suggestion").length||0!=e.closest("#"+t+"string_CustomValue1_suggestion").length},_mouseout:function(t){var i,l,n,o,r=this,a=r.model,d=r._gridPosition,s=d.top,c=r._gridHeight,u=r._$gridHeaderContent.outerHeight()+s;if(a.toolbarSettings.showToolbar&&(g=a.isFromGantt?r._id.replace("ejTreeGrid",""):r._id,u+=e("#"+g+"_toolbarItems").length>0?e("#"+g+"_toolbarItems").outerHeight():0),a.allowPaging&&(c-=r.element.find(".e-pager").first().outerHeight()),a.showTotalSummary&&(c-=r._$totalSummaryRowContainer.outerHeight()),r._dragMouseDown){if(d.left,o=t.pageY,r.model.isFromGantt){var g=r._id.replace("ejTreeGrid",""),m=e("#"+g).find(".e-ganttviewerbodyContianer"),p=m.ejScroller("isVScroll")?m.find(".e-content").get(0).scrollHeight-1:0;l=m.ejScroller("isHScroll")?c+s-a.rowHeight/2-18:c+s-a.rowHeight/2}else p=r.isVScroll()?r.getMaxScrollHeight()+1:0,l=r.getScrollElement().ejScroller("isHScroll")?c+s-a.rowHeight/2-18:c+s-a.rowHeight/2;n=u+a.rowHeight/2,o>l&&p>r._scrollTop?r._timerDragDown||(r._timerDragDown=window.setInterval(function(){p>r._scrollTop&&(i=(i=r._scrollTop+20)>p?p:i,r.model.isFromGantt?m.ejScroller("scrollY",i,!0):r.getScrollElement().ejScroller("scrollY",i,!0))},100)):r._timerDragDown&&(r._timerDragDown=window.clearInterval(r._timerDragDown)),o<n&&0!=r._scrollTop&&r._scrollTop>0?r._timerDragUp||(r._timerDragUp=window.setInterval(function(){r._scrollTop>0&&((i=r._scrollTop-20)<0&&(i=0),r.model.isFromGantt?m.ejScroller("scrollY",i,!0):r.getScrollElement().ejScroller("scrollY",i,!0))},100)):r._timerDragUp&&(r._timerDragUp=window.clearInterval(r._timerDragUp))}},getRange:function(t,i,l){var n,o,r=this,a=r.model,d=0,s=0;n=0==l.length?a.rowHeight:l[0].offsetHeight,c=r.getOffsetRect(e("#"+r._id)[0]),o=r._$gridHeaderContent.outerHeight()+c.top,n+=r._detailsRowHeight,a.enableVirtualization||(r._scrollTop=r.getScrollElement().ejScroller("scrollTop")),a.toolbarSettings.showToolbar&&(o+=e("#"+r._id+"_toolbarItems").length>0?e("#"+r._id+"_toolbarItems").outerHeight():0),a.allowTextWrap?(0==l.length&&(l=r._lastRow),s=l.offset().top):0!=r._scrollTop?s=i*n+o+(d=n-r._scrollTop%n):s=i*n+o+d;var c,u=((0==l.length?s+a.rowHeight:s+l[0].offsetHeight)-s)/3,g=s+u,m=g+u;return c={topRowSegment:g,middleRowSegment:m,bottomRowSegment:m+u}},_childValidation:function(e){var t,i=this._draggedRecord.parentItem;i&&(t=i.childRecords.indexOf(this._draggedRecord),e==i&&-1!=t&&(this._childItem=!0))},_isColumnHidable:function(e){this.model;var t,i,l=!0;return t=this._frozenColumns.filter(function(e){return 1==e.visible}),i=this._unFrozenColumns.filter(function(e){return 1==e.visible}),1==t.length&&t[0].field==e.field&&(l=!1),1==i.length&&i[0].field==e.field&&(l=!1),l},_updateColumnMenuVisibility:function(){var t,i=this.model,l=[],n=[];(i.showColumnChooser||i.contextMenuSettings.showContextMenu)&&(l=this._frozenColumns.filter(function(e){return 1==e.visible}),n=this._unFrozenColumns.filter(function(e){return 1==e.visible}),1==l.length&&((t=e("#"+this._id+"_columnMenu_"+l[0].field.split(".").join("")).data("ejCheckBox"))&&t.option("enabled",!1)),1==n.length&&((t=e("#"+this._id+"_columnMenu_"+n[0].field.split(".").join("")).data("ejCheckBox"))&&t.option("enabled",!1)))},_validDrop:function(t,i){var l=this;t.filter(function(t){if(t.hasChildRecords&&1==i.dragState){if(-1!=e.inArray(i,t.childRecords))return void(i.dragState=!1);l._validDrop(t.childRecords,i)}})},_renderToolTip:function(t,i,l,n){var o,r,a,d,s,c,u=this,g=this.model,m=[],p=(document,u.model.columns,g.dragTooltip.tooltipItems.length,n.closest("tr"));e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"}),e(".e-error").css({display:"none"}),e(".e-treegridexpand").css({display:"inline-block"}),e(".e-treegridcollapse").css({display:"inline-block"}),u._isHierarchyFiltering&&e("#"+u._id+"e-gridcontent").css({cursor:"no-drop"}),u._isHierarchyFiltering?(o=u.getIndexByRow(p),u._currentRecord=g.currentViewData[o]):0==p.length&&(n.hasClass("e-movablecontainer")||n.hasClass("e-gridcontent")||n.hasClass("e-content"))&&(o=u._recordIndex,u._currentRecord.parentItem||u._currentRecord.hasChildRecords&&(u._currentRecord.expanded?u._lastRow.find(".e-treegridexpand").css({display:"none"}):u._lastRow.find(".e-treegridcollapse").css({display:"none"}))),m={},r=u.getUpdatedRecords(),u._insertAbove=!1,u._insertAsChild=!1,u._insertBelow=!1,u._childItem=!1,u._draggedRecord,o!=u._draggedIndex&&(u._displayContextMenu=!1),a=u.getExpandedRecords(r),u.getVisibleRange(),d=a.slice(u._visibleRange.top,u._visibleRange.bottom),0!=u._scrollTop?(r.indexOf(u._draggedRecord)-1,s=d.indexOf(u._currentRecord)-1):(r.indexOf(u._draggedRecord),s=d.indexOf(u._currentRecord));var h=r.indexOf(u._currentRecord),_=u._currentRecord&&u._checkPrevNextRecord(u._draggedRecord,h,u._currentRecord.level,"next"),f=u._currentRecord&&u._checkPrevNextRecord(u._draggedRecord,h,u._currentRecord.level,"prev"),w=u._gridPosition.left,C=t.pageY;u._currentRecord&&(m=u.getRange(u._currentRecord,s,p));var x=C<=m.topRowSegment,v=C>m.topRowSegment&&C<=m.middleRowSegment,S=C>m.middleRowSegment&&C<=m.bottomRowSegment;u._currentRecord&&(u.data=u._currentRecord,c=this._getrowName(),u._childValidation(u._currentRecord),u._isHierarchyFiltering||(u._currentRecord.parentItem?u._currentRecord.hasChildRecords&&(u._currentRecord.expanded?p.find(".e-treegridexpand").css({display:"inline-block"}):p.find(".e-treegridcollapse").css({display:"inline-block"})):u._currentRecord.hasChildRecords&&(u._currentRecord.expanded?p.find(".e-treegridexpand").css({display:"none"}):p.find(".e-treegridcollapse").css({display:"none"})),u._validDrop(u._draggedRecords,u._currentRecord),l.dropPosition=1==u._currentRecord.dragState&&0!=l.canDrop?x&&!f?"insertAbove":v&&0==u._childItem?"insertAsChild":v&&1==u._childItem?"invalidPosition":S&&!_||0==p.length?"insertBelow":"invalidPosition":"invalidPosition",u._trigger("rowDrag",l),1==u._currentRecord.dragState&&0!=l.canDrop?x&&!f?(e(u.element).find("."+c).find(".e-aboveIcon").css({display:"block"}),u._insertAbove=!0):v&&0==u._childItem?(e(u.element).find("."+c).find(".e-childIcon").css({display:"block"}),u._insertAsChild=!0):v&&1==u._childItem?(e(u.element).find("."+c).find(".e-cancelIcon").css({display:"block"}),u.cancelDrop=!0):(S&&!_||0==p.length)&&(e(u.element).find("."+c).find(".e-belowIcon").css({display:"block"}),u._insertBelow=!0):(e(u.element).find("."+c).find(".e-cancelIcon").css({display:"block"}),u.cancelDrop=!0))),e(u._dragmouseOverTooltip).css({top:C+20+"px",left:w+15+"px",position:"absolute","z-index":u.getMaxZIndex()+1,padding:"0","border-right":"0","border-bottom":"0","border-radius":"3px",height:"auto"})},_checkPrevNextRecord:function(e,t,i,l){this.model;var n=this.getUpdatedRecords(),o=t;for("next"==l?t++:t--;n[t];){if(n[t].level==i)return n[t]==e&&e.parentItem==n[o].parentItem;"next"==l?t++:t--}return!1},_createDragTooltipTemplate:function(){var t,i,l=this,n=l.model.dragTooltip.tooltipTemplate;n&&(t="#"==n.charAt(0)?e(l.model.dragTooltip.tooltipTemplate)[0].innerHTML:l.model.dragTooltip.tooltipTemplate),(i={})[l._id+"dragtooltipTemplate"]=t,e.templates(i)},_updateDragStateFalse:function(e,t){var i,l,n;if(e.dragState=!1,e.hasChildRecords)for(l=e.childRecords.length,n=0;n<l;n++)(i=e.childRecords[n]).dragState=!1,i.hasChildRecords&&(t=this._updateDragStateFalse(i,t))},_updateDragStateTrue:function(e,i){var l,n,o;if(!t.isNullOrUndefined(e)&&(e.dragState=!0,e.hasChildRecords))for(n=e.childRecords.length,o=0;o<n;o++)(l=e.childRecords[o]).dragState=!0,l.hasChildRecords&&(i=this._updateDragStateTrue(l,i))},_getCoordinate:function(e){var t=e;return("touchmove"==e.type||"touchstart"==e.type||"touchend"==e.type||"taphold"==e.type||"tap"==e.type)&&(t=e.originalEvent.changedTouches[0]),t},_getElementByPosition:function(t,i){return e(document.elementFromPoint(t-window.pageXOffset,i-window.pageYOffset))},dragRecord:function(i){var l,n,o,r,a,d,s,c,u,g;if(i.ctrlKey||i.shiftKey||2==i.which||3==i.which)return!0;var m,p,h,_=this,f=_.model,w={},C=_._getCoordinate(i),x=e(i.target),v=x.closest("tr"),S=_.getUpdatedRecords(),R=!0;if(window.clearTimeout(this._dragTooltipTimer),this._dragTooltipTimer=null,!_._mouseDown)return!0;if(!v.hasClass("e-editedrow")&&_.editFormValidate()){if("cell"==f.selectionSettings.selectionMode&&_.clearSelection(),_._clearColumnMenu(),_._removeDetailsRow(),_._saveCellHandler(i),_._posx=C.pageX,_._posy=C.pageY,x.hasClass("e-summaryrowcell")||x.hasClass("e-footersummaryrowcell")||x.hasClass("e-summarytitle")||x.closest("tr").hasClass("e-detailsrowexpanded"))return;if(f.enableVirtualization?(_._currentIndex=_.getIndexByRow(v),p=f.currentViewData[_._currentIndex],_._currentIndex=S.indexOf(p)):_._currentIndex=_.getIndexByRow(v),_._draggedIndex=m=_.getIndexByRow(v),_._draggedRecord=_.model.currentViewData[m],t.isNullOrUndefined(_._draggedRecord))return;w.draggedRowIndex=m,w.draggedRow=_._draggedRecord,!f.isFromGantt&&("checkbox"==f.selectionSettings.selectionType&&f.selectedItems.length>1&&"checked"==f.currentViewData[_.getIndexByRow(v)].checkboxState||"multiple"==f.selectionSettings.selectionType&&f.selectedItems.length>1)?_._draggedRecords=e.extend([],f.selectedItems).reverse():_._draggedRecords.push(_._draggedRecord),w.draggedRecords=_._draggedRecords,_._trigger("rowDragStart",w),w.draggedRow&&w.draggedRow.isSummaryRow&&(w.cancel=!0,w.draggedRow.canDrag=!1),0==w.draggedRow.canDrag&&(R=!1),e.extend([],_._draggedRecords).filter(function(e){0==e.canDrag&&(_._draggedRecords.splice(_._draggedRecords.indexOf(e),1),e.canDrag=!0)}),_._gridPosition=_.getOffsetRect(e("#"+_._id)[0]),_._frozenColumnsLength>0&&-1!=m&&(v.index(),l=v.closest(".e-movablecontentdiv").length>0?e(_._gridRows[0])[m]:e(_._gridRows[1])[m],v=v.add(l));var T=_._gridPosition.left,b=C.pageY,y=f.isFromGantt?f.ganttElement.width():_._gridWidth,I=v.clone();if(y-=50,I.find(".e-hide").remove(),n=f.dragTooltip.tooltipItems.length,o=t.buildTag("table.e-zerospace","",{padding:"1",width:y-1,"border-collapse":"collapse"}),_.model.dragTooltip.showTooltip&&0==_._dragTooltip)if(_.model.dragTooltip.tooltipTemplate||0!=_.model.dragTooltip.tooltipItems.length)if(0!=n){for(r=f.columns,h=t.buildTag("tbody","",{},{}),a=t.buildTag("tr.e-dragtooltipbackground","",{},{}),s=0;s<n;s++)for(c=0;c<r.length;c++)if(0!=r[c].visible&&(d=f.isFromGantt?r[c].mappingName:r[c].field,f.dragTooltip.tooltipItems[s]==d)){u=_._getCustomCellValue(_._draggedRecord,r[c].field),r[c].format&&(u=_.formatting(r[c].format,u,f.locale)),t.isNullOrUndefined(u)||(g=t.buildTag("td.e-dragrowcell",u.toString(),{padding:"5px",width:_.columnsWidthCollection[c],height:f.rowHeight},{}),a.append(g)),a.append(g);break}h.append(a),o.append(h),_._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltiptreegrid"+_._id,o,{top:b+20+"px",left:T+15+"px",position:"absolute","z-index":_.getMaxZIndex()+1,padding:"0","border-right":"0","border-bottom":"0","border-radius":"3px",height:"auto",width:y,overflow:"hidden"},{}),f.cssClass&&e(_._dragmouseOverTooltip).addClass(f.cssClass),e(_._dragmouseOverTooltip).addClass("e-dragtooltipbackground").addClass("e-dragrowcell"),_._dragTooltip=!0}else _.model.dragTooltip.tooltipTemplate&&(_._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltiptreegrid"+_._id,"",{top:b+20+"px",left:T+15+"px",position:"absolute","z-index":_.getMaxZIndex()+1,padding:"0","border-right":"0","border-bottom":"0","border-radius":"3px",height:"auto"},{}),f.cssClass&&e(_._dragmouseOverTooltip).addClass(f.cssClass),_.tooltipState="TemplateID",h=t.buildTag("tbody",e.render[_._id+"dragtooltipTemplate"](_._draggedRecord),{},{}),_._dragmouseOverTooltip[0].innerHTML="<table>"+h[0].innerHTML+"</table>",_._dragTooltip=!0);else h=t.buildTag("tbody","",{},{}),I.find(".e-treegridexpand").css({display:"none"}),I.find("td.e-unboundcell").css({display:"none"}),I.find("td.e-detailsrowcell").css({display:"none"}),I.find(".e-treegridcollapse").css({display:"none"}),e(I.find(".e-dragintend")).css({width:0}),I.find(".e-intend").removeClass("e-intend"),I.find(".e-rowcell ").removeClass("e-rowcell ").addClass("e-dragrowcell"),I.addClass("e-dragtooltipbackground"),f.isFromGantt&&I.find("td:last").remove(),2==I.length&&this._frozenColumnsLength>0&&(e(I[0]).append(e(I[1].childNodes)),I.splice(1,1)),h.append(I),o.append(h),_._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltiptreegrid"+_._id,o,{top:b+20+"px",left:T+15+"px",position:"absolute",overflow:"hidden","z-index":_.getMaxZIndex()+1,padding:"0","border-radius":"3px","border-right":"0","border-bottom":"0",width:y},{}),f.cssClass&&e(_._dragmouseOverTooltip).addClass(f.cssClass),e(_._dragmouseOverTooltip).addClass("e-dragtooltipbackground").addClass("e-dragrowcell"),_._dragTooltip=!0;_._draggedRecord&&(_._draggedElement=v,_._updateDragStateFalse(_._draggedRecord),_._dragMouseDown=!0,"touchstart"==i.type?(_._isHierarchyFiltering||e(document.body).append(_._dragmouseOverTooltip),_._off(_.element,"touchmove","#"+_._id+"e-gridcontent",_._touchScroll),_._on(_.element,"touchmove",".e-treegridrows, .e-templatecell",_.dragToolTip)):(_._off(_.element,"mousemove","#"+_._id+"e-gridcontent",_._touchScroll),_._on(_.element,"mousemove",".e-gridcontent, .e-templatecell",_.dragToolTip))),(w.cancel||!R)&&(_._dragMouseDown=!1,_._updateDragStateTrue(_._draggedRecord),_._dragTooltip=!1,_._dragmouseOverTooltip&&_._dragmouseOverTooltip.remove(),_._dragmouseOverTooltip=null,"touchstart"==i.type?_._off(_.element,"touchmove",".e-treegridrows, .e-templatecell",_.dragToolTip):_._off(_.element,"mousemove",".e-gridcontent, .e-templatecell",_.dragToolTip))}},dragToolTip:function(i){var l,n,o,r,a,d,s,c,u,g,m,p=this,h=p.model,_=h.currentViewData,f={},w=p._getCoordinate(i);if(i.preventDefault(),d=Math.abs(w.pageX-p._posx),s=Math.abs(w.pageY-p._posy),!(t.isNullOrUndefined(p._posx)||t.isNullOrUndefined(p._posy)||d<10&&s<10)&&1==p._dragMouseDown&&1==p.model.allowDragAndDrop){if(p._batchEditStarts)return p._batchSaveLostWarning("Drag"),!0;"touchmove"==i.type?o=p._getElementByPosition(w.pageX,w.pageY):(o=e(i.target),e(document.body).append(p._dragmouseOverTooltip)),r=o.closest("tr"),1!=h.allowSelection||t.isNullOrUndefined(p._draggedRecord)||0!=p._draggedRecord.isSelected||(p.clearSelection(-1),p._selectDraggedRow(r),p._cancelSaveTools()),0==r.length&&(o.hasClass("e-movablecontainer")||o.hasClass("e-gridcontent")||o.hasClass("e-content"))?(h.enableVirtualization?(p._currentRecord=_[_.length-1],p._insertBelow=!0,p._lastRow=t.TreeGrid.getRowByIndex(p,_.length-1),p._recordIndex=_.length-1):(c=p.getExpandedRecords(_),p._currentRecord=c[c.length-1],h.allowPaging?p._lastRow=t.TreeGrid.getRowByIndex(p,_.length-1):(u=h.updatedRecords.indexOf(p._currentRecord),p._lastRow=t.TreeGrid.getRowByIndex(p,u)),p._recordIndex=p._indexOfLastRow=p.getIndexByRow(p._lastRow)),g=p._recordIndex):(g=p.getIndexByRow(r),p._currentRecord=h.currentViewData[g]),m=p.getUpdatedRecords(),-1!=g?(l=p.model.currentViewData[g],(n=(r=t.TreeGrid.getRowByIndex(p,p._currentIndex)).clone()).find(".e-hide").remove(),p._dragTargetItem=l,f.targetRowIndex=g,f.targetRow=l,f.canDrop=!0,f.draggedRow=p._draggedRecord,f.draggedRowIndex=m.indexOf(p._draggedRecord),f.draggedRecords=p._draggedRecords,p._renderToolTip(w,n,f,o),f.targetRow&&f.targetRow.isSummaryRow?(p._draggedRecord.canDrop=!1,e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"})):p._draggedRecord.canDrop=0!=f.canDrop):p._draggedRecord&&p._dragMouseDown&&(l=null,n=(r=t.TreeGrid.getRowByIndex(p,p._currentIndex)).clone(),a=o.closest("tr"),f.targetRowIndex=null,f.targetRow=null,p._dragTargetItem=null,f.canDrop=!0,f.draggedRow=p._draggedRecord,f.draggedRowIndex=p._draggedRecord.index,f.dropPosition="invalidPosition",p._trigger("rowDrag",f),a.hasClass("e-footersummaryrow")||p._renderToolTip(w,n,f,o)),p._mouseout(w)}},_mouseupHandler:function(t){var i=this,l=i.model;"touchend"==t.type?i._off(i.element,"touchmove","#"+i._id+"e-gridcontent",i._touchScroll):i._off(i.element,"mousemove","#"+i._id+"e-gridcontent",i._touchScroll),i._off(e(document),"mouseup touchend",i._mouseupHandler),i._mouseDown=!1,i._isTouchEvent=!1,window.clearTimeout(i._dragTooltipTimer),l.allowDragAndDrop&&i._dragMouseDown&&i.dragMouseUp(t),l.contextMenuSettings.showContextMenu&&i._contextMenuHandler&&i._displayContextMenu?i._rightClick(t):i._contextMenuHandler=!1,i._displayContextMenu=!0,i._dy=i._dx=0},_performDragAndDrop:function(i,l,n,o,r){for(var a,d,s,c,u,g,m,p,h,_=this,f=_.model,w=(f.editSettings.editMode.toLowerCase(),0),C=f.selectedItems.length,x=_._draggedRecords.length,v=[],S={},R=0;R<x;R++){if(i=_._draggedRecord=_._draggedRecords[R],a=f.flatRecords,o.previousParentItem=i.parentItem?e.extend({},i.parentItem):i.parentItem,t.isNullOrUndefined(i.parentItem)||(o.previousParentItem.childRecords=e.extend([],i.parentItem.childRecords),o.parentChildState=i.parentItem.hasChildRecords,o.parentExpandedState=i.parentItem.expanded),"rowIndexUpdate"!=o.requestType&&(r.targetRow=e.extend({},_._droppedRecord),r.targetRow.item=e.extend({},_._droppedRecord.item),r.targetRowIndex=f.updatedRecords.indexOf(l),r.draggedRow=e.extend({},_._draggedRecord),r.draggedRow.item=e.extend({},_._draggedRecord.item),r.draggedRowIndex=f.updatedRecords.indexOf(i)),o.previousItem=t.isNullOrUndefined(r)?e.extend({},_._draggedRecord):r.draggedRow,o.previousItemIndex=a.indexOf(_._draggedRecord),o.previousTarget=_._droppedRecord,o.previousTargetItemIndex=a.indexOf(_._droppedRecord),o.clonedTarget=e.extend({},_._droppedRecord),o.hasChildRecords=l.hasChildRecords,o.expanded=l.expanded,o.childIndex=o.previousParentItem?o.previousParentItem.childRecords.indexOf(i):0,o.previousLevel=i.level,[],1==l.dragState){if(_._updateDragStateTrue(i),1==_._insertAbove||1==_._insertBelow||1==_._insertAsChild){for(_.model.isEdit||_._isRowEdit||_._cancelSaveTools(),d=0;d<C;d++)_.clearSelection(f.selectedItems[d]);_._deleteDragRow(),s=a.indexOf(l),_._checkboxSelection&&f.selectionSettings.enableHierarchySelection&&i.parentItem&&_._updateParentSelection(i.parentItem),1==_._insertAbove?(o.index=s,i.parentItem=a[s].parentItem,i.level=a[s].level,a.splice(s,0,i),f.updatedRecords.splice(s,0,i),f.isFromGantt&&f.ids.splice(s,0,i.taskId.toString()),i.hasChildRecords&&(c=1,_._updateChildRecord(i,s),_._updateChildRecordLevel(i,c)),l.parentItem&&(h=(p=l.parentItem.childRecords).indexOf(l),p.splice(h,0,i),_._updateHierarchyRowIndexData(o,p,h))):1==_._insertBelow?(o.index=s+1,l.hasChildRecords?(w=_.getChildCount(l,0),a.splice(s+w+1,0,i),f.updatedRecords.splice(s+w+1,0,i),f.isFromGantt&&f.ids.splice(s+w+1,0,i.taskId.toString())):(a.splice(s+1,0,i),f.updatedRecords.splice(s+1,0,i),f.isFromGantt&&f.ids.splice(s+1,0,i.taskId.toString())),i.parentItem=a[s].parentItem,i.level=a[s].level,i.hasChildRecords&&(c=1,_._updateChildRecordLevel(i,c),_._updateChildRecord(i,s+w+1)),l.parentItem&&(h=(p=l.parentItem.childRecords).indexOf(l)+1,p.splice(h,0,i),_._updateHierarchyRowIndexData(o,p,h))):1==_._insertAsChild&&(o.index=s+1,i.hasChildRecords?(a.splice(s+1,0,i),f.updatedRecords.splice(s+1,0,i),f.isFromGantt&&f.ids.splice(s+1,0,i.taskId.toString()),_._recordLevel(n,o),l.hasChildRecords&&(l.expanded=_._isLoadonDemand?l.isChildRetrieved:l.expanded),_._updateChildRecord(i,s+1,l.expanded)):(a.splice(s+1,0,i),f.updatedRecords.splice(s+1,0,i),f.isFromGantt&&f.ids.splice(s+1,0,i.taskId.toString()),_._recordLevel(n,o)))}_._checkboxSelection&&f.selectionSettings.enableHierarchySelection&&(i.parentItem&&_._updateParentSelection(i.parentItem),_.selectAllRows()),null==i.parentItem&&(g=(u=f.parentRecords).indexOf(_._droppedRecord),1==_._insertBelow?u.splice(g+1,0,i):1==_._insertAbove&&u.splice(g,0,i),m=1==_._insertBelow?g+1:g,_._updateHierarchyRowIndexData(o,u,m))}v.push(i)}return S.draggedRecords=v,S.draggedRecord=i,S.droppedRecord=l,S},_updatedMovedRow:function(e,i,l,n,o,r){var a,d,s,c,u=this,g=u.model;if(n.draggedRow=e,n.targetRow=i,n.droppedPosition=l,!g.isFromGantt&&r)for(a=0;a<r.length;a++)u._draggedRecord=r[a],u._updateDataSource();else u._updateDataSource();if(g.showSummaryRow&&1==u._insertAsChild&&u._createSummaryRow(n),g.enableWBS){e.parentItem?d=e.parentItem.childRecords:d=g.flatRecords.filter(function(e){return e&&0==e.level});var m=d.indexOf(e),p=d.slice(m,d.length),h=e.parentItem?e.parentItem.WBS:null,_=m+1;u.reCalculateWBS(p,_,h)}g.isFromGantt&&(c=(s=g.flatRecords.indexOf(e))<o?s:o,u.updateSerialNumber(c),g.enableSerialNumber&&("insertAsChild"==l&&(c-=1),u.updateSerialNumberPredecessors(c))),u.processBindings(n),g.enableAltRow&&g.currentViewData.length>0&&t.TreeGrid.updateAltRow(u,u.model.currentViewData[0],0,0)},_navigatePager:function(e){var i,l,n=this,o=n.model,r=o.pageSettings.pageSize;o.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&(l=n._getRootParent(o.updatedRecords[e]),e=o.parentRecords.indexOf(l)),i=Math.ceil((e+1)/r),n.gotoPage(i)},_getRootParent:function(e){return t.isNullOrUndefined(e.parentItem)?e:this._getRootParent(e.parentItem)},moveRow:function(i,l,n){var o,r,a,d=this,s=d.model,c={},u={};if(d._cancelEditState(),"batchediting"==s.editSettings.editMode.toLowerCase()&&d._batchEditStarts||(t.isNullOrUndefined(l)&&("above"==n||"child"==n?l=i-1:"below"==n&&(l=i+1)),o=s.updatedRecords[i],(r=s.updatedRecords[l])&&r.isSummaryRow&&(r=d._getNextRecord(l,s.updatedRecords,n)),t.isNullOrUndefined(o)||t.isNullOrUndefined(r)||1==o.isSummaryRow||1==r.isSummaryRow||!d.getExpandStatus(o)||!d.getExpandStatus(r)))return!1;if(d._draggedRecord=o,d._droppedRecord=r,d._draggedRecords.push(o),c.currentRecord=o,c.targetRecord=r,c.currentRowIndex=i,c.targetRowIndex=l,c.dropPosition=n,c.requestType="rowIndexUpdate",d._moveRow=!0,!d._trigger("actionBegin",c)){if(d._validDrop(d._draggedRecords,r),1==r.dragState){if("above"==n)d._insertAbove=!0;else if("below"==n)d._insertBelow=!0;else{if("child"!=n||-1!=e.inArray(o,r.childRecords))return d._resetPrivateProperties(),!1;d._insertAsChild=!0}return d._performDragAndDrop(o,r,i,c),d._updatedMovedRow(o,r,n,c),s.allowPaging&&d._navigatePager(s.updatedRecords.indexOf(o)),d.updateScrollBar(d.getUpdatedRecords().indexOf(o)),1==s.allowSelection&&(d.clearSelection(-1),d._selectDraggedRow(),d._cancelSaveTools()),u.currentRecord=o,u.targetRecord=r,u.currentRowIndex=s.updatedRecords.indexOf(o),u.targetRowIndex=s.updatedRecords.indexOf(r),u.dropPosition=c.dropPosition,u.requestType=c.requestType,d._trigger("actionComplete",u),(a={}).draggedRowIndex=u.currentRowIndex,a.targetRowIndex=u.targetRowIndex,a.requestType="dragAndDrop",d._updateAction(a),d._resetPrivateProperties(),!0}return r.dragState=!0,d._resetPrivateProperties(),!1}},dragMouseUp:function(i){var l,n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C={},x={},v={},S=this,R=S.model,T=S._draggedRecord,b=(S._currentRecord,S._getCoordinate(i)),y=R.flatRecords.indexOf(T);if(T.isDragged=!0,S._timerDragDown&&(S._timerDragDown=window.clearInterval(S._timerDragDown)),S._timerDragUp&&(S._timerDragUp=window.clearInterval(S._timerDragUp)),R.allowDragAndDrop&&("touchstart"==i.type?S._off(S.element,"touchmove",".e-treegridrows, .e-templatecell",S.dragToolTip):S._off(S.element,"mousemove",".e-gridcontent, .e-templatecell",S.dragToolTip),a=!!(t.isNullOrUndefined(T)||S._draggedRecords.length>1)||T.canDrop),window.clearTimeout(S._dragTooltipTimer),S._dragMouseDown=!1,e(S._dragmouseOverTooltip).remove(),S._dragTooltip=!1,n=(l="touchend"==i.type?S._getElementByPosition(b.pageX,b.pageY):e(i.target)).closest("tr"),S._isHierarchyFiltering&&e("#"+S._id+"e-gridcontent").css({cursor:"default"}),e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"}),s=R.currentViewData[S.getIndexByRow(n)],1!=this.cancelDrop||t.isNullOrUndefined(s)||null!=s.parentItem||(c=t.TreeGrid.getRowByIndex(this,R.updatedRecords.indexOf(s)),s.expanded?c.find(".e-treegridexpand").css({display:"inline-block"}):c.find(".e-treegridcollapse").css({display:"inline-block"})),S._dragMouseLeave=!0,1!=l.closest("#"+S._id).length||1!=l.closest(".e-gridcontent").length||t.isNullOrUndefined(T)||0!=S._dropCancel)S._updateDragStateTrue(T);else{if(!R.allowDragAndDrop||!a)return S._updateDragStateTrue(T),S._resetPrivateProperties(),0;S._dragMouseLeave=!1,0==n.length?(u=m=S._indexOfLastRow,R.enableVirtualization?S._droppedRecord=R.currentViewData[R.currentViewData.length-1]:R.currentViewData[R.currentViewData.length-1].expanded?(S._insertBelow=!0,S._droppedRecord=R.currentViewData[R.currentViewData.length-1]):(g=S.getExpandedRecords(R.currentViewData),S._droppedRecord=g[g.length-1])):(m=S.getIndexByRow(n),S._droppedRecord=R.currentViewData[m],u=R.updatedRecords.indexOf(S._droppedRecord)),u!=S._currentIndex&&-1!=m&&0!=S._draggedRecords.length?(1==S._droppedRecord.dragState&&(-1!=e.inArray(S._droppedRecord,S._draggedRecords)&&(p=S._draggedRecords.indexOf(S._droppedRecord),S._draggedRecords.splice(p,1)),"checkbox"==R.selectionSettings.selectionType&&1==R.selectionSettings.enableHierarchySelection&&e.extend([],S._draggedRecords).filter(function(e){e.parentItem&&"checked"==e.parentItem.checkboxState&&S._draggedRecords.splice(S._draggedRecords.indexOf(e),1)})),1==S._insertAbove&&S._draggedRecords.length>1&&S._draggedRecords.reverse(),S._insertAbove?d="insertAbove":S._insertBelow?d="insertBelow":S._insertAsChild&&(d="insertAsChild"),v.draggedRecords=S._draggedRecords,v.draggedRow=T,v.draggedRow.item=T.item,v.targetRow=S._droppedRecord,v.draggedRowIndex=R.updatedRecords.indexOf(T),v.targetRowIndex=R.updatedRecords.indexOf(S._droppedRecord),v.dropPosition=d,r=S._droppedRecord,S._trigger("rowDropActionBegin",v)||(e.extend([],S._draggedRecords).filter(function(e){0==e.canDrop&&(S._draggedRecords.splice(S._draggedRecords.indexOf(e),1),e.canDrop=!0),0==S._draggedRecords.length&&(r.dragState=!1)}),T=(h=this._performDragAndDrop(T,r,m,C,x)).draggedRecord,o=h.draggedRecords,r=h.droppedRecord,C.requestType="dragAndDrop",1!=r.dragState||S._isHierarchyFiltering?S._updateDragStateTrue(T):(S._updatedMovedRow(T,r,d,C,y,o),R.isFromGantt||(x.draggedRecords=o),x.draggedRow=C.draggedRow,x.draggedRow.item=C.draggedRow.item,x.draggedRowIndex=R.updatedRecords.indexOf(T),x.targetRowIndex=R.updatedRecords.indexOf(r),x.requestType=d,C.isFromRevertDragging=!1,S._trigger("rowDragStop",x),x.cancel?(C.isFromRevertDragging=!0,S._revertDragging(C)):((_={}).draggedRecords=o,_.draggedRowIndex=x.draggedRowIndex,_.targetRowIndex=x.targetRowIndex,_.requestType="dragAndDrop",S._updateAction(_)),R.allowSelection&&("row"==R.selectionSettings.selectionMode&&(!R.isFromGantt&&("checkbox"==R.selectionSettings.selectionType&&-1!=e.inArray(T,R.selectedItems)||"multiple"==R.selectionSettings.selectionType)&&R.selectedItems.length>1?(f=R.selectedItems.filter(function(e){if(1==e.isDragged)return e.isDragged=!1,e}),w=S.getUpdatedRecords().indexOf(f[0]),S.clearSelection(w),S._multiSelectCtrlRequest=!0,-1!=w&&R.allowSelection&&!S._rowSelectingEventTrigger(this.selectedRowIndex(),w)&&(S.selectRows(w),S._rowSelectedEventTrigger(w))):S._selectDraggedRow(n)),"cell"==R.selectionSettings.selectionMode&&S.updateScrollBar(R.updatedRecords.indexOf(S._draggedRecord)))))):(S._updateDragStateTrue(T),S.model.isEdit||S._isRowEdit||S._cancelSaveTools())}t.isNullOrUndefined(S._currentRecord)||null==S._currentRecord.parentItem&&(n=R.allowPaging?t.TreeGrid.getRowByIndex(S,S.getUpdatedRecords().indexOf(S._currentRecord)):t.TreeGrid.getRowByIndex(S,R.updatedRecords.indexOf(S._currentRecord)),S._currentRecord.expanded?n.find(".e-treegridexpand").css({display:"inline-block"}):n.find(".e-treegridcollapse").css({display:"inline-block"})),R.showSummaryRow&&"dragAndDrop"==C.requestType&&1!=S._insertAsChild&&!S._isHierarchyFiltering&&S._updateSummaryRow(C),S._dropCancel=!1,t.isNullOrUndefined(r)||(r.dragState=!0),S._resetPrivateProperties(),t.isNullOrUndefined(T)||S.model.isEdit||S._isRowEdit||S._cancelSaveTools(),t.isNullOrUndefined(T)||1!=T.isDragged||(T.isDragged=!1)},dragColumn:function(i){var l,n,o=e(i.target),r=this,a=r._getCoordinate(i);if(r._posx=a.pageX,r._posy=a.pageY,i.ctrlKey||i.shiftKey||2==i.which||3==i.which)return!0;var d,s=r.model,c=s.columns,u={};if("col-resize"!=o.css("cursor")&&o.closest(".e-headercelldiv")&&!o.hasClass("e-columnmenu-icon")){if(l=o.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),t.isNullOrUndefined(l)&&t.isNullOrUndefined(this.getColumnByField(l)))return;if(r._saveEditedElements(),o.hasClass("e-checkbox"))return!1;if(r._draggedColumn=this.getColumnByField(l),d=c.indexOf(r._draggedColumn),u.draggedColumnIndex=d,u.draggedColumn=r._draggedColumn,u.requestType="columnDragStart",r._draggedColumnTemplate=t.isNullOrUndefined(r._draggedColumn.headerTemplateID)?null:o.closest(".e-headertemplate"),!t.isNullOrUndefined(r._draggedColumn.nonColumn))return;if(r._trigger("columnDragStart",u),u.cancel)return;"cell"==s.selectionSettings.selectionMode&&r.clearSelection(),r._headerDragStatus="mousedown",r._dragMouseDown=!0,r._mouseDragged=!1,n=r.getOffsetRect(r.element[0]),r._gridLeft=n.left,r._gridTop=n.top,r._touchstart=!0,"touchstart"!=i.type&&r._on(r.element,"mousemove",r.dragColumnToolTip)}},dragColumnToolTip:function(i){var l,n,o,r,a,d,s=this,c=s.model,u={},g=c.columns,m={},p=s._getCoordinate(i),h=p.pageX,_=p.pageY;if(s._touchstart)s._touchstart=!1;else if("touchmove"==i.type?(i.preventDefault(),l=s._getElementByPosition(p.pageX,p.pageY)):l=e(i.target),s._headerDragStatus.length>0&&1==c.allowColumnReordering){"cell"==c.selectionSettings.selectionMode&&"mousemove"!=s._headerDragStatus&&s.clearSelection();var f=l.closest(".e-headercell"),w=f.find(".e-headercelldiv").attr("data-ej-mappingname"),C=s._gridLeft+s._gridWidth-10,x=s._gridHeight+s._gridTop,v=h,S=_;if(t.isNullOrUndefined(s._dragmouseOverTooltip)||(n=s._dragmouseOverTooltip.width/2,o=s._dragmouseOverTooltip.height+5,v=v-n<s._gridLeft?s._gridLeft:v+n>C?C-2*n-4:v-n,S+o>x&&(S=x-o)),t.isNullOrUndefined(w)||t.isNullOrUndefined(this.getColumnByField(w)))t.isNullOrUndefined(s._dragmouseOverTooltip)||e(s._dragmouseOverTooltip).css({top:S+"px",left:v+"px"});else{if(r=this.getColumnByField(w),s._currentIndex=g.indexOf(r),u.targetColumnIndex=s._currentIndex,u.draggedColumnIndex=g.indexOf(s._draggedColumn),u.draggedColumn=s._draggedColumn,u.targetColumn=r,u.requestType="columnDrag",u.canDrop=!0,s._trigger("columnDrag",u),u.cancel)return;u.direction=u.draggedColumnIndex>=u.targetColumnIndex?"left":"right",m.pos=s.getOffsetRect(f[0]),m.height=e(f).height(),m.width=e(f).outerWidth(),m.pos.top=s.getOffsetRect(f.closest(".e-gridheader")[0]).top,m.display="block",m.pos.left="left"==u.direction&&s._gridLeft>m.pos.left?s._gridLeft:"right"==u.direction&&C<m.pos.left+m.width?C-10:u.draggedColumnIndex>u.targetColumnIndex?m.pos.left-2:m.pos.left+m.width-2,u.column=m,s._autoHscroll(h,_,u),u.draggedColumnIndex!=u.targetColumnIndex&&(s._displayContextMenu=!1),(u.draggedColumnIndex==u.targetColumnIndex||!t.isNullOrUndefined(u.targetColumn.nonColumn)||m.pos.left-8>s._gridWidth+s._gridLeft)&&(m.display="none"),"mousemove"==s._headerDragStatus||s._dragTooltip?(e(s._reordervline).css({height:s._reordervline.height,width:0,"border-width":0,position:"absolute",top:m.pos.top+"px",left:m.pos.left+"px","border-left-width":"3px","border-style":"solid",display:m.display}),e(s._dragmouseOverTooltip).css({top:S+"px",left:v+"px"})):(a=s._gridHeight-1,s.model.toolbarSettings.showToolbar&&(a-=t.isNullOrUndefined(e("#"+s._id+"_toolbarItems").outerHeight())?0:e("#"+s._id+"_toolbarItems").outerHeight()),a-=s.getScrollElement().ejScroller("isHScroll")?18:0,d=t.buildTag("div",s._draggedColumn.headerText,{"margin-top":"5px"}),t.isNullOrUndefined(s._draggedColumnTemplate)||t.isNullOrUndefined(s._draggedColumn)||t.isNullOrUndefined(s._draggedColumn.headerTemplateID)||(d[0].innerHTML=s._draggedColumnTemplate[0].innerHTML),s._dragmouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#columnreordertooltip"+s._id,d,{top:_+10+"px",left:h-57+"px",position:"absolute","z-index":s.getMaxZIndex()+1},{}),c.cssClass&&s._dragmouseOverTooltip.addClass(c.cssClass),s._reordervline=t.buildTag("div.e-vline e-js#reorderline"+s._id,{height:a,width:0,"border-width":0,position:"absolute",top:m.pos.top+"px",left:m.pos.left+"px","border-left-width":"3px","border-style":"solid",display:m.display}),c.cssClass&&s._reordervline.addClass(c.cssClass),e(document.body).append(s._dragmouseOverTooltip),e(document.body).append(s._reordervline),e(s._dragmouseOverTooltip).addClass("e-headertooltip"),e(s._reordervline).addClass("e-headervline"),s._dragmouseOverTooltip.width=e(s._dragmouseOverTooltip).outerWidth(),s._dragmouseOverTooltip.height=e(s._dragmouseOverTooltip).outerHeight(),s._reordervline.height="auto"==c.sizeSettings.height?e("#"+s._id+"e-gridcontent").height()+e("#"+s._id+"e-gridheader").height():a,s._dragTooltip=!0),s._headerDragStatus="mousemove"}}},reorderColumn:function(e,i){var l,n,o,r,a,d,s,c=this,u=c.model,g=u.columns;if(u.showTotalSummary&&u.collapsibleTotalSummary&&(d=g[c._summaryColumnIndex]),a=g[u.treeColumnIndex],l=c.getColumnByField(e),n=g.indexOf(l),r=c.columnsWidthCollection[n],o=g[i],!(t.isNullOrUndefined(l)||t.isNullOrUndefined(o)||o&&o.nonColumn)){if(c._frozenColumnsLength>0)if(s=this._getFrozenColumnWidth(),c._frozenColumnsLength<=n&&c._frozenColumnsLength>i&&-1==c._frozenColumns.indexOf(l)){if((s+=this.columnsWidthCollection[n]+18)>this._gridWidth)return!1;l.isFrozen=!0,c._frozenColumns.splice(i,0,l)}else c._frozenColumnsLength>n&&c._frozenColumnsLength<=i&&-1!=c._frozenColumns.indexOf(l)&&(l.isFrozen=!1,c._frozenColumns.splice(n,1),c._checkboxSelection&&1==c._frozenColumns.length&&c._frozenColumns[0].nonColumn&&(c._frozenColumns[0].isFrozen=!1,c._frozenColumns.splice(0,1)));g.splice(n,1),c.columnsWidthCollection.splice(n,1),g.splice(i,0,l),c.columnsWidthCollection.splice(i,0,r),u.treeColumnIndex=g.indexOf(a),u.showTotalSummary&&u.collapsibleTotalSummary&&(c._summaryColumnIndex=g.indexOf(d)),c._refreshFrozenColumns(),c._updateWrapRowHeights(null,"virtualRefresh")}},_refreshStackedHeader:function(){var t,i,l,n=this,o=n.model;if(o.showStackedHeader){for(t=o.stackedHeaderRows,i=0;i<t.length;i++)if(0!=n._frozenColumnsLength){var r=e(n.getHeaderContent().find(".e-frozenheaderdiv")),a=e(n.getHeaderContent().find(".e-movableheader")),d=n._createStackedRow(t[i],!0),s=n._createStackedRow(t[i],!1);e(r.find("tr.e-stackedHeaderRow")[i]).replaceWith(d),e(a.find("tr.e-stackedHeaderRow")[i]).replaceWith(s)}else l=n._createStackedRow(t[i],!1),n.getHeaderTable().find("tr.e-stackedHeaderRow")[i]?e(n.getHeaderTable().find("tr.e-stackedHeaderRow")[i]).replaceWith(l):l.insertBefore(n.getHeaderTable().find("tr.e-columnheader:last"));({}).requestType="refresh",n._updateScrollCss()}},_autoHscroll:function(e){var t,i,l=this,n=(l.model.columns,0),o=(l.columnsWidthCollection,l.getScrollElement());i=o.ejScroller("isHScroll"),t=i?o.find(".e-content").get(0).scrollWidth:0,l._viewPortWidth=o.find(".e-content").width(),l._frozenColumnsLength>0&&(n=this._getFrozenColumnWidth());var r=Math.round((l._gridLeft+l._gridWidth)/10)+18,a=Math.round(l._gridLeft/10)+18,d=0;l._gridLeft+l._gridWidth-r<e?l._timerDragDown||(l._timerDragDown=window.setInterval(function(){t>l._scrollLeft+l._viewPortWidth&&(d=l._scrollLeft,d+=50,l.getScrollElement().ejScroller("scrollX",d,!0))},300)):l._timerDragDown&&(l._timerDragDown=window.clearInterval(l._timerDragDown)),e<l._gridLeft+n+a&&e>l._gridLeft+n&&0!=l._scrollLeft&&l._scrollLeft>0?l._timerDragUp||(l._timerDragUp=window.setInterval(function(){l._scrollLeft>0&&(d=l._scrollLeft,(d-=50)<0&&(d=0),l.getScrollElement().ejScroller("scrollX",d,!0))},300)):l._timerDragUp&&(l._timerDragUp=window.clearInterval(l._timerDragUp))},_resetPrivateProperties:function(){this._timerDragDown&&(this._timerDragDown=window.clearInterval(this._timerDragDown)),this._timerDragUp&&(this._timerDragUp=window.clearInterval(this._timerDragUp));var i=this,l=i.model;i.cancelDrop=!1,i._draggedRecord=null,i._draggedRecords=[],i._dragMouseDown=!1,i._timerDragDown=null,i._timerDragUp=null,i._childItem=!1,i._dragMouseLeave=!1,i._moveRow=!1,i._currentRecord=null,i._currentIndex=null,i._droppedRecord=null,i._insertAsChild=!1,i._insertAbove=!1,i._insertBelow=!1,l.allowDragAndDrop&&l.enableVirtualization&&("chrome"==t.browserInfo().name||t.isTouchDevice())&&(i._dummyElement&&e(i._draggedElement).remove(),i._dummyElement=!1,i._draggedElement=null),i._dragTooltipTimer=null,i._dragColumnTooltipTimer=null,i._dragmouseOverTooltip=null},_selectDraggedRow:function(){var e=this,t=e.model,i=e.getUpdatedRecords().indexOf(e._draggedRecord);-1!=i&&(e._focusTreeGridElement(),t.allowSelection&&"row"==t.selectionSettings.selectionMode&&!e._rowSelectingEventTrigger(this.selectedRowIndex(),i)&&(e.selectRows(i),e._rowSelectedEventTrigger(i)))},_addChildItem:function(e){for(var i,l=this,n=e.childRecords.length,o=0;o<n;o++)i=e.childRecords[o],l.dataSource()instanceof t.DataManager?l.dataSource().dataSource.offline&&l.dataSource().dataSource.json&&(l.dataSource().dataSource.json.push(i.item),i.hasChildRecords&&l._addChildItem(i)):(l.dataSource().push(i.item),i.hasChildRecords&&l._addChildItem(i))},_updateDataSource:function(){var e,i,l,n,o=this,r=o.model,a=o._draggedRecord,d=o._droppedRecord;if(o.dataSource()instanceof t.DataManager?o.dataSource().dataSource.offline&&o.dataSource().dataSource.json&&(e=o.dataSource().dataSource.json):e=o.dataSource(),e&&!d.parentItem)i=e.indexOf(d.item),o._insertAbove?r.parentIdMapping||e.splice(i,0,a.item):o._insertBelow&&(r.parentIdMapping||e.splice(i+1,0,a.item));else if(!r.parentIdMapping&&d.parentItem&&(o._insertAbove||o._insertBelow))for(d.parentItem.item[o.model.childMapping]=[],l=d.parentItem.childRecords,n=0;n<l.length;n++)d.parentItem.item[o.model.childMapping].splice(n,0,l[n].item);r.parentIdMapping&&(a.parentItem?o._insertAbove||o._insertBelow?1==r.isFromGantt?a.item[r.parentIdMapping]=d.item[o.model.parentIdMapping]:(a[r.parentIdMapping]=d[o.model.parentIdMapping],a.item[r.parentIdMapping]=d[o.model.parentIdMapping]):1==r.isFromGantt?a.item[r.parentIdMapping]=d.item[o.model.idMapping]:(a[r.parentIdMapping]=d[o.model.idMapping],a.item[r.parentIdMapping]=d[o.model.idMapping]):(a.item[r.parentIdMapping]=null,a[r.parentIdMapping]=null),o.dataSource()instanceof t.DataManager?o.dataSource().dataSource.offline&&o.dataSource().dataSource.json&&o.dataSource().dataSource.json.push(a.item):((o._insertAbove||o._insertBelow||o._insertAsChild)&&o.dataSource().push(a.item),a.hasChildRecords&&o._addChildItem(a)))},_deleteDragRow:function(e){var i,l=this,n=l.model,o={},r=l.getUpdatedRecords(),a=n.flatRecords;-1!=r.indexOf(l._draggedRecord)?i=r[r.indexOf(l._draggedRecord)]:i=a[a.indexOf(l._draggedRecord)],o.tr=e,o.data=i,o.requestType=t.TreeGrid.Actions.Delete,o.isDragAndDropDelete=!0,l._removeRecords(o),l._previousIndex=-1},_revertDragging:function(i){var l,n,o,r=this,a=r.model,d=a.flatRecords;if(r._draggedRecord=i.draggedRow,r._deleteDragRow(),r._draggedRecord.hasChildRecords?(d.splice(i.previousItemIndex,0,r._draggedRecord),a.isFromGantt&&a.ids.splice(i.previousItemIndex,0,r._draggedRecord.taskId.toString()),t.isNullOrUndefined(d[i.previousItemIndex].parentItem)||(d[i.previousItemIndex].parentItem=i.previousParentItem,t.isNullOrUndefined(i.previousParentItem)||d[i.previousItemIndex].parentItem.childRecords.splice(i.childIndex,0,r._draggedRecord)),l=a.flatRecords.indexOf(r._draggedRecord),r._updateChildRecord(r._draggedRecord,l,i.previousItem.index),r._draggedRecord.level=i.previousLevel,r._updateChildRecordLevel(r._draggedRecord,i.previousLevel)):(d.splice(i.previousItemIndex,0,r._draggedRecord),a.isFromGantt&&a.ids.splice(i.previousItemIndex,0,r._draggedRecord.taskId.toString()),d[i.previousItemIndex].parentItem=i.previousItem.parentItem,t.isNullOrUndefined(i.previousParentItem)||(d[i.previousItemIndex].parentItem.childRecords.splice(i.childIndex,0,r._draggedRecord),d[i.previousItemIndex].parentItem.hasChildRecords=!0,d[i.previousItemIndex].parentItem.hasFilteredChildRecords=!0,d[i.previousItemIndex].parentItem.expanded=!0),d[i.previousItemIndex].level=i.previousLevel),a.parentIdMapping&&(d[i.previousItemIndex][a.parentIdMapping]=i.previousItem[a.parentIdMapping],d[i.previousItemIndex].item[a.parentIdMapping]=i.previousItem[a.parentIdMapping]),t.isNullOrUndefined(i.previousItem.parentItem)||(i.previousItem.parentItem.hasChildRecords=i.parentChildState,i.previousItem.parentItem.expanded=i.parentExpandedState,a.childMapping&&i.previousItem.parentItem.item[r.model.childMapping]&&i.previousItem.parentItem.item[r.model.childMapping].splice(i.childIndex,0,i.previousItem.item)),a.isFromGantt&&(d[i.previousTargetItemIndex]=i.previousTarget,1==i.previousTarget.isAutoSchedule?(i.previousTarget.startDate=i.previousTarget.item[i.model.startDateMapping]=new Date(i.clonedTarget.startDate),i.previousTarget.endDate=new Date(i.clonedTarget.endDate),i.previousTarget.duration=i.clonedTarget.duration,i.previousTarget.status=i.clonedTarget.status,i.model.endDateMapping&&(i.previousTarget.item[i.model.endDateMapping]=new Date(i.clonedTarget.endDate)),i.model.progressMapping&&(i.previousTarget.item[i.model.progressMapping]=i.clonedTarget.status),i.model.durationMapping&&(i.previousTarget.item[i.model.durationMapping]=i.clonedTarget.duration),i.previousTarget.expanded=i.clonedTarget.expanded,e("#"+r._id.replace("ejTreeGrid","")).data("ejGantt")._updateTargetGanttRecord(i.previousTarget)):(i.previousTarget.manualStartDate=new Date(i.clonedTarget.manualStartDate),i.previousTarget.manualEndDate=new Date(i.clonedTarget.manualEndDate),i.previousTarget.manualDuration=i.clonedTarget.manualDuration,i.previousTarget.status=i.clonedTarget.status,i.model.progressMapping&&(i.previousTarget.item[i.model.progressMapping]=i.clonedTarget.status),i.previousTarget.expanded=i.clonedTarget.expanded,e("#"+r._id.replace("ejTreeGrid","")).data("ejGantt")._updateGanttRecord(i.previousTarget))),a.enableWBS){(o=r._draggedRecord).parentItem?n=o.parentItem.childRecords:n=a.flatRecords.filter(function(e){return e&&0==e.level});var s=n.indexOf(o),c=n.slice(s,n.length),u=o.parentItem?o.parentItem.WBS:null,g=s+1;r.reCalculateWBS(c,g,u)}r.processBindings(i),a.currentViewData.length>0&&t.TreeGrid.updateAltRow(r,a.currentViewData[0],0,0)},_updateChildRecord:function(e,t){var i,l,n,o=this.model;if(!e.hasChildRecords)return 0;for(l=e.childRecords.length,n=0;n<l;n++)i=e.childRecords[n],t++,o.flatRecords.splice(t,0,i),o.updatedRecords.splice(t,0,i),o.isFromGantt&&o.ids.splice(t,0,i.taskId.toString()),i.hasChildRecords&&(t=this._updateChildRecord(i,t));return t},_recordLevel:function(i,l){var n,o,r=this,a=r.model,d=r._draggedRecord,s=r._droppedRecord,c=r.model.childMapping;s.hasChildRecords||(s.hasChildRecords=!0,s.hasFilteredChildRecords=!0,r._isLoadonDemand&&(s.isChildRetrieved=!0),(t.util.isNullOrUndefined(s.childRecords)||e.isEmptyObject(s.childRecords))&&(s.childRecords=[],a.parentIdMapping||(s.item[c]=[]))),r._insertAsChild&&(d.parentItem=s,s.childRecords.splice(0,0,d),n=s.childRecords,r._updateHierarchyRowIndexData(l,n,0),t.isNullOrUndefined(d)||t.isNullOrUndefined(s.item[c])||a.parentIdMapping||s.item[c].splice(0,0,d.item),d.hasChildRecords?(o=1,d.level=s.level+1,r._updateChildRecordLevel(d,o)):d.level=s.level+1,!s.expanded&&s.hasChildRecords&&a.isFromGantt&&!a.enableVirtualization&&r.updateExpandStatus(s,!0),s.expanded=!0,r._isLoadonDemand&&!s.isChildRetrieved&&(s.expanded=!1),r._parentRecords.push(s))},_updateChildRecordLevel:function(e,t){var i,l,n;if(t++,!e.hasChildRecords)return 0;for(i=e.childRecords.length,n=0;n<i;n++)(l=e.childRecords[n]).level=e.parentItem?e.parentItem.level+t:e.level+1,l.hasChildRecords&&(t--,t=this._updateChildRecordLevel(l,t));return t},_filterBarClose:function(t){var i,l=e(t.target);"click"==t.type&&l.hasClass("e-cancel")&&((i=l.prev()).focus().val(""),i.prop("checked",!1),i.trigger("keyup"),t.stopPropagation()),"focusin"==t.type&&(l=e(t.target).next(),this.getHeaderTable().find(".e-cancel").addClass("e-hide"),l.removeClass("e-hide"))},_checkIdenticalValue:function(e,t){for(var i,l=this.model.filterSettings.filteredColumns,n=l.length,o=0;o<n;o++)if(l[o].value===e&&l[o].field==t.field){i=!0;break}return i},_filterBarHandler:function(l){var n,o,r,a,d,s,c,u,g,m=this,p=m.model;if(m.model.isEdit?m.cancelEditCell():m._isRowEdit&&m.cancelRowEditCell(),m._isRefreshAddedRecord=!1,m.clearAllSelection(),n=l.target==i?e(l):e(l.target),this.model.allowFiltering){if(m.model.columns,m._cellEditingDetails,m._queryManagar.queries[0],o=n.hasClass("e-ddl")?n.find("input.e-field"):n,m._fieldName=o[0].id.replace(m._id+"_","").replace("_filterbarcell",""),this._currentFilterColumn=t.TreeGrid.getColumnByField(p.columns,m._fieldName),m._fieldName=this._currentFilterColumn.field,r=this._currentFilterColumn,n.hasClass("e-checkbox"))m._filterString=n[0].checked;else if(n.hasClass("e-ddl")){if(n=n.find("input.e-dropdownlist"),-1==(d=e("#"+n[0].id).data("ejDropDownList")).selectedIndexValue||m._checkIdenticalValue(d._selectedValue,this._currentFilterColumn))return!0;m._filterString=d._selectedValue}else if(n.hasClass("e-dropdownlist")){if(-1==(s=e("#"+n[0].id).data("ejDropDownList")).selectedIndexValue||m._checkIdenticalValue(s._selectedValue,this._currentFilterColumn))return!0;m._filterString=s._selectedValue==m._dropDownListClearText?"":s._selectedValue}else if(n.hasClass("e-numerictextbox")){if(u=null==(c=e("#"+n[0].id).data("ejNumericTextbox")).model.value?"":c.model.value.toString(),t.isNullOrUndefined(l.type)){var h=p.filterSettings.filteredColumns,_=h.length,f=!1;for(""==u&&0==_&&(f=!0),g=0;g<_;g++)if((t.isNullOrUndefined(h[g].value)?"":h[g].value.toString())==u&&h[g].field==this._currentFilterColumn.field){f=!0;break}if(f)return!0}m._filterString=n.closest("input").val()}else m._filterString=n.closest("input").val();if(("datepicker"==this._currentFilterColumn.filterEditType||"datetimepicker"==this._currentFilterColumn.filterEditType)&&""!=m._filterString&&m._filterString&&(a=r.format?m._getDateFormat(this._currentFilterColumn.format):m.model.dateFormat,m._filterString=t.isNullOrUndefined(t.parseDate(m._filterString,a,p.locale))?"":t.parseDate(m._filterString,a,p.locale)),""==m._filterString&&!p.filterSettings.filteredColumns.filter(function(e){if(e.field===m._fieldName)return!0}).length)return m._resizeFilteringElements(),!0;m._validateFilterValue(m._filterString),m._batchEditStarts&&(m._batchTempDetails.filterTarget=n),m.filterColumn(m._fieldName,this._operator,m._filterString,this._predicate),m._storePreviousFilteredValue(m._fieldName,m._filterString,this._operator),m.model.currentViewData.length>0&&m.model.enableAltRow&&t.TreeGrid.updateAltRow(m,m.model.currentViewData[0],0,0),m._cancelSaveTools()}},_validateFilterValue:function(e){var l,n,o=this;switch(this._predicate="and",this._currentFilterColumn.filterEditType){case"numericedit":this._operator=t.FilterOperators.equal;break;case"datepicker":this._operator=t.FilterOperators.equal,l=""==this._currentFilterColumn.format||this._currentFilterColumn.format==i?t.preferredCulture().calendar.patterns.d:this._currentFilterColumn.format.split(":")[1].replace("}",""),""!=this._currentFilterbarValue&&(this._currentFilterbarValue=t.format(e,l,this.model.locale));break;case"datetimepicker":this._operator=t.FilterOperators.equal,l=""==this._currentFilterColumn.format||this._currentFilterColumn.format==i?t.preferredCulture().calendar.patterns.f:this._currentFilterColumn.format.split(":")[1].replace("}",""),""!=this._currentFilterbarValue&&(this._currentFilterbarValue=t.format(e,l,this.model.locale));break;case"stringedit":this._operator=t.FilterOperators.startsWith;break;case"dropdownedit":n=this._currentFilterColumn,this._operator="dropdownedit"==n.editType&&n.editParams&&n.editParams.showCheckbox?t.FilterOperators.contains:t.FilterOperators.equal;break;case"booleanedit":1==o._filterString||"1"==o._filterString?o._filterString=!0:("false"==o._filterString||"0"==o._filterString)&&(o._filterString=!1),this._operator=t.FilterOperators.equal;break;default:this._operator=t.FilterOperators.equal}},_getStackedColumnByTarget:function(e){var i=(e.get(0)||{}).className,l=/e-row([0-9])-column([0-9])/.exec(i),n=[l[1],"stackedHeaderColumns",l[2]].join(".");return t.getObject(n,this.model.stackedHeaderRows)},_headermouseHover:function(i){var l,n,o,r;if(i.preventDefault(),(n=(l=this).model).showGridCellTooltip&&!l._dragTooltip){var a,d,s,c,u,g,m,p,h,_,f=e(i.target),w=0,C=0,x=f.closest("div.e-headercelldiv");l._headerMouseLeave(),i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(w=i.originalEvent.pageX,C=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(w=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,C=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),(s=x.clone()).find(".e-ascending").length>0?s.find(".e-ascending").remove():s.find(".e-descending").length>0&&s.find(".e-descending").remove(),s.find(".e-chkbox-wrap").remove(),s=f.closest(".e-headercell").hasClass("e-headertemplate")?s.clone():s.find("span").clone(),f.hasClass("e-stackedtooltip")&&(_=l._getStackedColumnByTarget(f),t.isNullOrUndefined(_.tooltip)||"#"===_.tooltip.slice(0,1)?s=e(_.tooltip).clone().html():s=_.tooltip),a=t.buildTag("table.e-tooltiptable e-zerospace","",{padding:"0"}),d=t.buildTag("tbody",s,{},{}),a.append(d),r=e(s).text().replace(/[ \t\r]+/g,"").length>0,d&&(h=f.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),(p=this.getColumnByField(h))&&(t.isNullOrUndefined(p.headerTooltip)||""==p.headerTooltip)&&n.showGridCellTooltip&&r||f.hasClass("e-stackedtooltip")?(l._headerMouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#headertooltip"+l._id,a,{top:C+10+"px",left:w+15+"px",position:"absolute","z-index":l.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),n.cssClass&&l._headerMouseOverTooltip.addClass(n.cssClass),l._headerTooltipTimer=setTimeout(function(){e(document.body).append(l._headerMouseOverTooltip);var t=e("#"+l._id.replace("ejTreeGrid","")),i=l.getOffsetRect(t[0]);g=e(t).width()+i.left,m=e(t).height()+i.top,c=e(l._headerMouseOverTooltip).width(),u=e(l._headerMouseOverTooltip).height(),w+c+15>=g&&(w=w-c-15),C+u+10>=m&&(C=C-u-10),e(l._headerMouseOverTooltip).css({top:C,left:w})},700)):p&&!t.isNullOrUndefined(p.headerTooltip)&&""!=p.headerTooltip&&((o={}).column=p,l._createColumnTooltipTemplate(p.headerTooltip),l._headerMouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#headertooltip"+l._id,"",{top:C+10+"px",left:w+15+"px",position:"absolute","z-index":l.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),n.cssClass&&l._headerMouseOverTooltip.addClass(n.cssClass),d=t.buildTag("tbody",e.render[l._id+"columnTooltipTemplate"](o),{},{}),l._headerMouseOverTooltip[0].innerHTML="<table>"+d[0].innerHTML+"</table>",(r=e(d).text().replace(/[ \t\r]+/g,"").length>0)&&(l._headerTooltipTimer=setTimeout(function(){var t,i;e(document.body).append(l._headerMouseOverTooltip),n.isFromGantt?(t=e("#"+l._id.replace("ejTreeGrid","")),i=l.getOffsetRect(t[0]),g=e(t).width()+i.left,m=e(t).height()+i.top):(i=l.getOffsetRect(l.element[0]),g=e(l.element).width()+i.left,m=e(l.element).height()+i.top),c=e(l._headerMouseOverTooltip).width(),u=e(l._headerMouseOverTooltip).height(),w+c+15>=g&&(w=w-c-15),C+u+10>=m&&(C=C-u-10),e(l._headerMouseOverTooltip).css({top:C,left:w})},700))))}},_mouseHover:function(i){var l,n,o,r,a=this,d=a.model;if(d.showGridCellTooltip&&1!=this._dragMouseDown){var s,c,u,g,m,p,h,_,f=e(i.target),w=0,C=0,x=(a.getRows(),f.closest("tr")),v=f.closest("td.e-rowcell"),S=this.getIndexByRow(x),R=d.currentViewData[S],T=d.columns;x.hasClass("e-footersummaryrow")&&(S=a._getFooterRows().index(x),R=a._footerSummaryRecord[S]),(S>=0||x.hasClass("e-footersummaryrow"))&&(l=a.getCellIndex(i),a._cellMouseLeave(),_=T[l],i||(i=window.event),i.originalEvent.pageX||i.originalEvent.pageY?(w=i.originalEvent.pageX,C=i.originalEvent.pageY):(i.originalEvent.clientX||i.originalEvent.clientY)&&(w=i.originalEvent.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,C=i.originalEvent.clientY+document.body.scrollTop+document.documentElement.scrollTop),(R||x.hasClass("e-footersummaryrow"))&&(l!=d.treeColumnIndex?((n=v.clone()).find(".e-chkbox-wrap").remove(),u=n.children().length?n.children().clone():n.clone()):v.find(".e-cell").length>0?(u=v.find(".e-cell").clone()).find(".e-chkbox-wrap").remove():v.hasClass("e-summaryrowcell")&&(v.find(".e-summarytitle").length>0?u=v.find(".e-summarytitle").clone():(u=v.clone(),e(u).css({cssText:"padding-left: 0px;"}))),u&&u.addClass("e-treegrid-textWrap"),s=t.buildTag("table.e-tooltiptable e-zerospace","",{padding:"0"}),(!d.showGridExpandCellTooltip||d.showGridExpandCellTooltip&&l==a.model.treeColumnIndex)&&(c=t.buildTag("tbody",u,{},{})),s.append(c),r=e(u).text().replace(/[ \t\r]+/g,"").length>0,c&&0==e(v).find("#"+a._id+"EditForm").length&&!a._isCommandColumn(_)&&(!d.cellTooltipTemplate&&(t.isNullOrUndefined(_.tooltip)||""==_.tooltip)||d.cellTooltipTemplate&&!t.isNullOrUndefined(_.tooltip)&&""==_.tooltip?(!d.showGridExpandCellTooltip&&r||d.showGridExpandCellTooltip&&r)&&(e("#"+this._id+"detailscellwrapper").length>0?110:5,a._mouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+a._id,s,{top:C+10+"px",left:"auto",position:"absolute","z-index":a.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),d.cssClass&&a._mouseOverTooltip.addClass(d.cssClass),a._tooltipTimer=setTimeout(function(){var t,i;e(document.body).append(a._mouseOverTooltip),d.isFromGantt?(t=e("#"+a._id.replace("ejTreeGrid","")),i=a.getOffsetRect(t[0]),p=e(t).width()+i.left,h=e(t).height()+i.top):(i=a.getOffsetRect(a.element[0]),p=e(a.element).width()+i.left,h=e(a.element).height()+i.top),g=e(a._mouseOverTooltip).width(),m=e(a._mouseOverTooltip).height();var l=e(window).width(),n=i.left+w,o=l-(i.left+w);w+g+15>=p&&n>o&&((w=p-g-15)<0&&(w=i.left)),C+m+10>=h&&(C=C-m-10),e(a._mouseOverTooltip).css({top:C,left:w})},700)):(d.cellTooltipTemplate||!t.isNullOrUndefined(_.tooltip)&&""!=_.tooltip)&&(e("#"+this._id+"detailscellwrapper").length>0?110:5,(o={}).record=R,o.column=T[l],t.isNullOrUndefined(_.tooltip)||a._createColumnTooltipTemplate(_.tooltip),a._mouseOverTooltip=t.buildTag("div.e-tooltipgantt e-js#tooltipgantt"+a._id,"",{top:C+10+"px",left:w+15+"px",position:"absolute","z-index":a.getMaxZIndex()+1,padding:"0","border-radius":"3px"},{}),d.cssClass&&a._mouseOverTooltip.addClass(d.cssClass),a.tooltipState="Template",c=t.isNullOrUndefined(_.tooltip)?t.buildTag("tbody",e.render[a._id+"tooltipTemplate"](o),{},{}):t.buildTag("tbody",e.render[a._id+"columnTooltipTemplate"](o),{},{}),a._mouseOverTooltip[0].innerHTML="<table>"+c[0].innerHTML+"</table>",(r=e(c).text().replace(/[ \t\r]+/g,"").length>0)&&(a._tooltipTimer=setTimeout(function(){var t,i;e(document.body).append(a._mouseOverTooltip),d.isFromGantt?(t=e("#"+a._id.replace("ejTreeGrid","")),i=a.getOffsetRect(t[0]),p=e(t).width()+i.left,h=e(t).height()+i.top):(i=a.getOffsetRect(a.element[0]),p=e(a.element).width()+i.left,h=e(a.element).height()+i.top),g=e(a._mouseOverTooltip).width(),m=e(a._mouseOverTooltip).height(),w+g+15>=p&&(w=w-g-15),C+m+10>=h&&(C=C-m-10),e(a._mouseOverTooltip).css({top:C,left:w})},700))))))}},_cellMouseLeave:function(){var t=this;null!=t._mouseOverTooltip&&(e("#tooltipgantt").remove(),window.clearTimeout(t._tooltipTimer),e(t._mouseOverTooltip).remove())},_headerMouseLeave:function(){var t=this;null!=t._headerMouseOverTooltip&&(e("#headertooltip").remove(),window.clearTimeout(t._headerTooltipTimer),e(t._headerMouseOverTooltip).remove())},disableTooltip:function(){this._cellMouseLeave(),this._headerMouseLeave()},_createTooltipTemplate:function(){var t,i=this,l=(i.model.columnHeaderTexts,{}),n=i.model.cellTooltipTemplate,o=null;l["_"+i._id+"getTaskName"]=i._tooltipTaskName,e.views.helpers(l),n?o=document.getElementById(n)?e("#"+n)[0].innerHTML:n:(o="<tr class='e-tooltip_rowcell'>",o+="{{if ~_"+i._id+"getTaskName()}}<td class='e-tooltiptaskname' style='height:auto;width:auto;font-weight:normal;'>{{:ttiptaskname}}</td>{{/if}}",o+="</tr>"),(t={})[i._id+"tooltipTemplate"]=o,e.templates(t)},_tooltipTaskName:function(){return this.data.ttiptaskname},_createColumnTooltipTemplate:function(t){var i,l=null;t&&(l=document.getElementById(t)?e("#"+t)[0].innerHTML:"#"===t.slice(0,1)&&document.getElementById(t.slice(1,t.length))?e(t)[0].innerHTML:t),(i={})[this._id+"columnTooltipTemplate"]=l,e.templates(i)},getMaxZIndex:function(){var e,t,i,l=document.getElementsByTagName("div"),n=0,o=l.length;if(0==this._maxZIndex){for(e=0;e<o;e++)t=l[e].style.zIndex,(i=parseInt(t))>n&&"auto"!=t&&!isNaN(i)&&(n=i);this._maxZIndex=n}return this._maxZIndex},_onScroll:function(l){var n,o=this,r=this.model;if(o._popupHide(),o._clearContextMenu(),e("#"+this._id+"detailscellwrapper").length>0&&this._removeDetailsRow(),o.model.showGridCellTooltip&&(o._cellMouseLeave(),o._headerMouseLeave()),r.isFromGantt||!o._dragTooltip||o._timerDragDown||o._timerDragUp)if(o.isVScroll()||o.model.isFromGantt||"wheel"!==l.source){if(l.scrollLeft!=i&&(o._scrollLeft=l.scrollLeft,n=Math.abs(o._scrollLeft-o._prevScrollLeft)),l.scrollTop!=i&&(o._scrollTop=l.scrollTop,Math.abs(o._scrollTop-o._preVScrollTop)),n&&(o._updateHeaderScrollLeft(o._scrollLeft),o._prevScrollLeft=o._scrollLeft),l.scrollTop!=i){if(o.model.isEdit?(o.cancelEditCell(),o._focusTreeGridElement()):o._isRowEdit&&(o.cancelRowEditCell(),o._focusTreeGridElement()),o._vScrollDist=Math.abs(o._scrollTop-o._prevScrollTop),o._preVScrollTop=o._scrollTop,o.model.enableVirtualization){if(o._vScrollDir=o._prevScrollTop<=o._scrollTop?1:-1,r.allowPaging&&!o.model.sizeSettings.height)return;o._vScrollDist&&o._scrollTop!=o._prevScrollTop&&(o._updateCurrentViewData(t.TreeGrid.Actions.Scroll),o._prevScrollTop=o._scrollTop)}o._scrollTop=l.scrollTop,this._frozenColumnsLength&&o.getContent().find("#e-frozencontainer"+o._id).scrollTop(o._scrollTop),o._vScrollDist=0}}else l.cancel=!0;else l.cancel=!0},editFormValidate:function(){var t,i,l;return!e.isFunction(e.validator)||(this._frozenColumnsLength>0?(t=this.element.find(".e-treegridform"),this.setValidation(),t.length>1?(i=t.eq(0).validate().form(),l=t.eq(1).validate().form(),!(!i||!l)):!(t.length>0)||t.validate().form()):e("#"+this._id+"EditFormDialog").length>0?(this.setValidation(),e("#"+this._id+"EditFormDialog").validate().form()):!(e("#"+this._id+"EditForm").length>0)||(this.setValidation(),e("#"+this._id+"EditForm").validate().form()))},_checkModfiedCellValue:function(i,l,n){var o,r,a,d=this.model,s=!1;return"datepicker"==n.editType||"datetimepicker"==n.editType?i instanceof Date&&l instanceof Date?"datepicker"==n.editType?(o=new Date(i),r=new Date(l),o.setHours(0,0,0,0)!=r.setHours(0,0,0,0)&&(s=!0)):i.getTime()!=l.getTime()&&(s=!0):i!==l&&(s=!0):"dropdownedit"==n.editType?i!==l&&(s=!0):(i=t.isNullOrUndefined(i)?"":i,l=t.isNullOrUndefined(l)?"":l,d.isFromGantt&&"duration"==n.field&&((a=l.match(/(\d*\.*\d+|[A-z]+)/g))&&a.length<=2&&(l=parseFloat(a[0]))),i instanceof Array&&l instanceof Array?e.each(i,function(t,i){-1==e.inArray(i,l)&&(s=!0)}):i.toString()!==l.toString()&&(s=!0)),s},saveRow:function(){var i,l,n,o,r,a,d,s,c,u=this,g=u.model,m=g.editSettings.editMode.toLowerCase();if(u.model.editSettings.allowEditing&&("dialogediting"==m||"batchediting"==m&&"dialog"==g.editSettings.batchEditSettings.editMode)?(i=e("#"+u._id+"EditFormDialog"),l=u._currentEditRecordDialogIndex,n=!0):(i=e("#"+u._id+"EditForm"),l=this.getIndexByRow(i.closest("tr"))),i&&!u.editFormValidate())return!0;var p,h=e("#"+u._id+"EditFrozenForm"),_=(h.add(i).find("td"),i.closest("tr").hasClass("e-addedrow")),f=g.columns,w=f.length,C=g.currentViewData[l],x={},v=t.copyObject({},C.item),S=!0,R=!1;if(u._focusTreeGridElement(),!(i.length<=0)||-1!=l){for(r=0;r<w;r++)if(!(""==(d=(a=f[r]).field)||u._checkboxSelection&&a.nonColumn)&&(a.visible||("dialogEditing"==g.editSettings.editMode||"batchediting"==u.model.editSettings.editMode.toLowerCase()&&"dialog"==g.editSettings.batchEditSettings.editMode.toLowerCase())&&!t.isNullOrUndefined(g.editSettings.dialogEditorTemplateID)&&""!=g.editSettings.dialogEditorTemplateID)){if(o=t.isNullOrUndefined(a.editType)?"stringedit":a.editType,p=u.getCurrentEditCellDataForRowEdit(d,o,r),p=t.isNullOrUndefined(p)||a.editType==t.TreeGrid.EditingType.Numeric&&isNaN(p)?null:p,g.idMapping&&g.parentIdMapping&&d==g.idMapping&&u._validateIdValue(p)&&(p=C[d]),!u._checkModfiedCellValue(t.getObject(d,v),p,a))continue;-1!=d.indexOf(".")?t.createObject(d,p,v):v[d]=p,R=!0,"batchediting"!=m||_||(u._createBatchEditedFields(C,d,p,a),u._batchEditStarts=!0,u._updateBatchChanges(C))}if(_){if(u._isEmptyRow=u._checkIsEmptyRow(v),x.rowIndex=u.selectedRowIndex(),x.previousValue=C.item,x.requestType="addNewRow",x.addedRow=u._isEmptyRow?null:v,x.rowElement=i.closest("tr"),!u._isEmptyRow){if("batchediting"==m)u.batchChanges.added.push(C),u._batchEditStarts=!0;else if(u._trigger("actionComplete",x))return!0;t.copyObject(C,v),t.copyObject(C.item,v),S=u._updateAction(x),g.idMapping&&g.parentIdMapping&&u._updateLastInsertedId(C[g.idMapping])}}else if(x.requestType="update",x.rowIndex=u.getUpdatedRecords().indexOf(C),x.currentValue=v,x.previousValue=C.item,n){if(x.element=e("#"+u._id+"_dialogEdit"),u._isRemoteData||(R=!0),R&&u._trigger("actionBegin",x))return!0;for(S=u._updateAction(x),g.idMapping&&g.parentIdMapping&&u._updateLastInsertedId(x.currentValue[g.idMapping]),s=0;s<f.length;s++)(f[s].editType==t.TreeGrid.EditingType.Dropdown||f[s].editType==t.TreeGrid.EditingType.DatePicker||f[s].editType==t.TreeGrid.EditingType.DateTimePicker)&&((c=e("#"+u._id+u._getFieldValue(f[s].field))).data("ejWidgets")&&c[c.data("ejWidgets")[0]]("destroy"))}else x.rowElement=i.add(h).closest("tr"),(R||!u._isRemoteData)&&(R&&"batchediting"==m||"batchediting"!=m&&!u._trigger("endEdit",x))&&(S=u._updateAction(x),g.idMapping&&g.parentIdMapping&&u._updateLastInsertedId(x.currentValue[g.idMapping]));S&&u._refreshAfterSaveRow(x,!0)}},_refreshAfterSaveRow:function(i,l){var n,o,r,a,d,s,c,u=this,g=u.model,m=g.columns,p=u.getUpdatedRecords()[i.rowIndex],h=g.currentViewData.indexOf(p);u._isEmptyRow&&"addNewRow"==i.requestType?(n=!1,g.editSettings.allowDeleting||(n=!0,g.editSettings.allowDeleting=!0),u.deleteRow(null,!0,null),u._isEmptyRow=!1,u._isEmptyRowDeleted=!0,n&&(g.editSettings.allowDeleting=!1)):(t.TreeGrid.refreshRow(u,h),"addNewRow"==i.requestType&&p.parentItem&&1==p.parentItem.childRecords.length&&t.TreeGrid.refreshRow(u,g.currentViewData.indexOf(p.parentItem)),g.showSummaryRow&&(i.editType="rowedit","addNewRow"==i.requestType&&"child"==g.editSettings.rowPosition&&u._createAndRenderSummaryRecords(i),u._updateSummaryRow(i)),g.showTotalSummary&&(i.editType="rowedit",u._updateTotalSummaryRow(i)),l&&"dialogEditing"==g.editSettings.editMode&&((o={}).data=p,o.item=p.item,o.requestType="recordUpdate",u._trigger("actionComplete",o),g.idMapping&&g.parentIdMapping&&u._updateLastInsertedId(o.item[g.idMapping]))),u._isRowEdit=!1,g.currentViewData.length>0&&g.enableAltRow&&!g.enableVirtualization&&t.TreeGrid.updateAltRow(u,g.currentViewData[0],0,0),u._cancelSaveTools(),r=m.filter(function(e){if("dropdownedit"==e.filterEditType&&"dropdownedit"!=e.editType)return!0}),g.allowFiltering&&r.length&&u._resizeFilteringElements(),u._commandColumnLength>0&&(a=t.TreeGrid.getRowByIndex(u,u.getUpdatedRecords().indexOf(p)),u._refreshUnboundTemplate(a),"addNewRow"==i.requestType&&g.editSettings.rowPosition==t.TreeGrid.RowPosition.Child&&(d=t.TreeGrid.getRowByIndex(u,u.getUpdatedRecords().indexOf(p.parentItem)),u._refreshUnboundTemplate(d))),g.allowTextWrap&&u._$frozenTableContent.length>0?(u._updateRowHeight(h),u._updateGridContentHeight(),u.getScrollElement().ejScroller("refresh"),s=u.getScrollElement().ejScroller("model.scrollTop"),u._getFrozenScrollElement().scrollTop(s),u.model.enableVirtualization&&u.updateHeight()):g.allowTextWrap&&(g.allowPaging&&!g.sizeSettings.height?u.updateHeight():u.getScrollElement().ejScroller("refresh")),g.allowTextWrap&&0==u._$frozenTableContent.length&&(c=u._getViewPortHeight(),u._$gridContainer.css({height:c+"px"}),e("#"+u._id+"e-gridcontent").css("height",c),u.getScrollElement().ejScroller("refresh"))},_updateAction:function(i){var l,n,o,r,a,d,s=this,c=s.model,u=c.idMapping,g="dragAndDrop"==i.requestType?i.draggedRowIndex:i.rowIndex,m=s.getUpdatedRecords()[g],p=!1,h={added:[],changed:[],deleted:[]};if(s._isRemoteData&&(n=c.selectionSettings.selectionType,o=s._dataManager.dataSource.batchUrl,t.isNullOrUndefined(o)&&"multiple"!=n&&"checkbox"!=n||(p=!0)),"addNewRow"==i.requestType)s._isRemoteData&&(p?h.added.push(i.addedRow):l=s._dataManager.insert(i.addedRow,s.model.query));else if("update"==i.requestType)s._isRemoteData?p?h.changed.push(i.currentValue):l=this._dataManager.update(u,i.currentValue,s.model.query):(t.copyObject(m,i.currentValue),t.copyObject(m.item,i.currentValue));else if("dragAndDrop"==i.requestType){if(s._isRemoteData)if(p)for(r=i.draggedRecords,a=0;a<r.length;a++)h.changed.push(r[a].item);else l=this._dataManager.update(u,m.item,s.model.query)}else"saveCellValue"==i.requestType?(d=i.data.item,s._isRemoteData&&e.isPlainObject(d)&&(p?h.changed.push(d):l=s._dataManager.update(u,d,s.model.query))):i.requestType==t.TreeGrid.Actions.Delete&&s._isRemoteData&&(p?h.deleted.push(s._getParentChildItem(i.deletedItems)):(d=i.data.item,l=s._dataManager.remove(u,d[u],this.model.query)));return p&&(l=s._dataManager.saveChanges(h,u,this.model.query._fromTable,this.model.query)),l&&e.isFunction(l.promise)&&!s._dataManager.dataSource.offline&&(s._waitingPopupObj.show(),l.done(function(l){if(i.requestType==t.TreeGrid.Actions.Delete)s._updateDeleteAction(i),s._cancelSaveTools();else if("addNewRow"==i.requestType||"update"==i.requestType){var n="addNewRow"==i.requestType?i.addedRow:i.currentValue;t.isNullOrUndefined(l)||t.isNullOrUndefined(l.record)||!e.isPlainObject(l.record)||t.copyObject(n,l.record),t.copyObject(m,n),t.copyObject(m.item,n),s._refreshAfterSaveRow(i,!0)}else"saveCellValue"==i.requestType&&s._refreshAfterSaveCell(i,!0);s._waitingPopupObj.hide()}),l.fail(function(e){if(i.error=e&&e.error?e.error:e,"update"==i.requestType)s._refreshAfterSaveRow(i,!0);else if("addNewRow"==i.requestType){var l=s.getUpdatedRecords().indexOf(m);s._isEmptyRow=!0,s.deleteRow(null,!0,l),s._isEmptyRow=!1}else"saveCellValue"==i.requestType&&(i.data[i.columnName]=i.previousValue,i.data.item[i.columnObject.field]=i.previousValue,s.selectRows(s.selectedRowIndex()),t.TreeGrid.refreshRow(s,c.currentViewData.indexOf(i.data)));s._waitingPopupObj.hide(),s._trigger("actionFailure",i)})),!s._isRemoteData},_getParentChildItem:function(e,i){for(var l,n=e.length,o=(i=t.isNullOrUndefined(i)?[]:i,0);o<n;o++)(l=e[o]).hasChildRecords?this._getParentChildItem(l.childRecords,i):i.push(l.item);return i},_excludeDetailRows:function(){var t=e(),i=this.model;return this.getTreeGridRows()&&this.getTreeGridRows().length>0&&(t=i.showDetailsRow&&i.detailsTemplate?this._frozenColumnsLength>0?[e(this.getTreeGridRows()[0]).not(".e-detailsrow"),e(this.getTreeGridRows()[1]).not(".e-detailsrow")]:e(this.getTreeGridRows()).not(".e-detailsrow"):this._frozenColumnsLength>0?[e(this.getTreeGridRows()[0]),e(this.getTreeGridRows()[1])]:e(this.getTreeGridRows())),t},getIndexByRow:function(t){var i=this._excludeDetailRows(),l=-1;return this._frozenColumnsLength>0?(-1==(l=e(i[0]).index(t))&&(l=e(i[1]).index(t)),l):i.index(t)},getTreeGridRows:function(){return this._gridRows},_keyDown:function(i){var l,n=this;if(i.shiftKey&&-1==n._shiftKeyFirstElementDetails.firstElementRowIndex)n._shiftKeyFirstElementDetails.firstElementRowIndex=n._focusingRowIndex,n._shiftKeyFirstElementDetails.firstElementCellIndex=n._cellIndex;else if(13==i.which&&null!=this._excelFilter&&!t.isNullOrUndefined(this._excelFilter._openedFltr)&&this._excelFilter._openedFltr.length&&this._excelFilter._openedFltr.is(":visible"))l=this._id+this._excelFilter._$colType,this._excelFilter._openedFltr.hasClass("e-dlgcustom")&&(l+="Custom"),this._excelFilter._openedFltr.find("#"+l+"_OkBtn").trigger("click");else{if(13===i.which&&e(i.target).hasClass("e-searchinput")&&e(i.target).closest("#"+n._id+"_toolbarItems"))return this._toolbarOperation(this._id+"_search",i.currentTarget),i.preventDefault(),!1;if("click"==i.type&&e(i.target).hasClass("e-searchitem"))return this._toolbarOperation(this._id+"_search",e(i.currentTarget).prev()[0].firstChild),i.preventDefault(),!1}},_focusTreeGridElement:function(){if("msie"==t.browserInfo().name)try{this.element[0].setActive()}catch(e){}else{var i=e(window).scrollTop();this.element[0].focus(),e(window).scrollTop(i)}},_onRecordClick:function(e){this._recordClickAction(e,"recordClick")},_onRecordDoubleClick:function(e){this._recordClickAction(e,"recordDoubleClick")},_recordClickAction:function(i,l){var n,o=this,r=e(i.target),a=o.model,d=r.closest("td"),s={},c=r.closest("tr");!(r.hasClass("e-rowcell")||r.parent().hasClass("e-rowcell")||r.closest("td").hasClass("e-rowcell")||r.closest("td").hasClass("e-rowcell")&&r.hasClass("e-cell"))||0!=c.find(".e-editedcell").length||c.hasClass("e-summaryrow")||d.hasClass("e-unboundcell")||(s.cell=d,s.cellIndex=o.getCellIndex(i),s.row=c,s.rowIndex=o.getIndexByRow(s.row),s.data=o.model.currentViewData[s.rowIndex],n=a.columns[s.cellIndex],s.columnName=n.headerText,s.cellValue=t.isNullOrUndefined(s.data)?"":s.data[n.field],s.targetElement=r,o._trigger(l,s))},_addRemoveAnimateClass:function(t){this._$gridContentTable&&this._$gridContentTable.find(".e-treegrid-animate").removeClass("e-treegrid-animate"),this._$gridHeaderContainer&&this._$gridHeaderContainer.find(".e-treegrid-animate").removeClass("e-treegrid-animate"),e(t).addClass("e-treegrid-animate")},_onClick:function(i){var l,n,o,r,a,d,s,c,u,g=this,m=g.model,p=e(i.target),h={},_=p.closest(".e-treegrid").attr("id"),f=g.getUpdatedRecords();if(p.closest(".e-treegrid").attr("id")!==this._id)return!1;if(g._clearContextMenu(),this._removeDetailsRow(i),m.allowDragAndDrop&&window.clearTimeout(g._dragTooltipTimer),m.allowColumnReordering&&(window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null),g._cellIndex=g.getCellIndex(i),p.hasClass("e-filtertext")||p.hasClass("e-cancel")||g.getHeaderTable().find(".e-cancel").addClass("e-hide"),"cell"==m.selectionSettings.selectionMode&&"dialogEditing"!=m.editSettings.editMode&&(m.editSettings.editMode="cellEditing"),n=g.getRowIndex(i),("click"==m.editSettings.beginEditAction||p.hasClass("e-treegridexpand")||p.hasClass("e-treegridcollapse"))&&0==p.closest(".e-scrollbar").length&&0==p.closest(".e-toolbaricons").length&&0==p.closest(".e-treegridtoolbaritem").length&&(("cellediting"==m.editSettings.editMode.toLowerCase()||"batchediting"==m.editSettings.editMode.toLowerCase()&&"cell"==m.editSettings.batchEditSettings.editMode.toLowerCase())&&(g._cellEditingDetails.rowIndex=n),o=m.currentViewData&&m.currentViewData[n]),!g.model.allowSelection||"multiple"!=g.model.selectionSettings.selectionType||g.model.isFromGantt||p.hasClass("e-downtail")||(p.hasClass("e-rowselect")?p.hasClass("e-spanclicked")?g._clearMultiSelectPopup():p.addClass("e-spanclicked"):e("#"+_+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")||this._multiSelectPopup.hide()),g._saveCellHandler(i),p.hasClass("e-summarytreegridexpand")||p.hasClass("e-summarytreegridcollapse"))return h.expanded=!p.hasClass("e-summarytreegridexpand"),g._isInManualExpandCollapse=!0,g.expandCollapseTotalSummary(h.expanded),g._isInManualExpandCollapse=!1,void g._addRemoveAnimateClass(p);if(!p.hasClass("e-summaryrowcell")&&!p.hasClass("e-footersummaryrowcell")&&!p.hasClass("e-summarytitle")){if((p.hasClass("e-treegridexpand")||p.hasClass("e-treegridcollapse"))&&-1!=n&&g.editFormValidate()){var w=p.closest("tr"),C=f.indexOf(o);h={};p.removeClass("e-treegrid-animate"),h.data=x,h.data=o,h.recordIndex=C,h.expanded=!w.hasClass("e-treegridrowexpand"),0!=e("#"+g._id+"EditForm").length||!p.hasClass("e-rowcell")&&p.closest(".e-rowcell").hasClass("e-templatecell")?g._cancelEditState():g._focusTreeGridElement(),(h.expanded?g._trigger("expanding",h):g._trigger("collapsing",h))||m.isFromGantt||(g._isRefreshAddedRecord?(h.data.expanded=h.expanded,g.updateExpandStatus(h.data,h.expanded),g.refreshContent(),g.renderRecords(),m.allowTextWrap&&g._frozenColumnsLength>0&&(g._updateRowHeight(),"auto"==m.sizeSettings.height&&g._updateContentHeight(),g.getScrollElement().ejScroller("refresh"),g._updateScrollCss()),g._isRefreshAddedRecord=!1):t.TreeGrid.sendExpandCollapseRequest(g,h)),m.allowPaging||m.enableVirtualization?(r=g.getUpdatedRecords(),(a=t.TreeGrid.getRowByIndex(this,r.indexOf(o)))&&g._addRemoveAnimateClass(e(a).find(".e-treegridcollapse,.e-treegridexpand"))):g._addRemoveAnimateClass(p)}else if(p.hasClass("e-rowcell")||p.parent().hasClass("e-rowcell")||p.closest("td").hasClass("e-rowcell")||p.parent().hasClass("e-detailsrowcell")||p.hasClass("e-detailsrowcell")||p.closest("td").hasClass("e-rowcell")&&p.hasClass("e-cell")){if(this._shiftSelectedRecord=null,e("#"+_+"_selectionpopup").is(":visible")&&(e("#"+_+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")?(i.ctrlKey=!0,m.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row&&(g._multiSelectCtrlRequest=!0)):(i.ctrlKey=!1,g._multiSelectCtrlRequest=!1)),m.isFromGantt&&g._ganttTouchTrigger&&(h={target:p,ctrlKey:i.ctrlKey},g._trigger("getCtrlRequestValue",h),i.ctrlKey=h.ctrlKey),0==e("#"+g._id+"EditForm").length&&(p.hasClass("e-rowcell")||!p.closest(".e-rowcell").hasClass("e-templatecell"))&&g._focusTreeGridElement(),l=g.getIndexByRow(p.closest("tr")),m.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row){if(g._checkboxSelection&&(0==e("#"+g._id+"EditForm").length||"click"==m.editSettings.beginEditAction)&&g.editFormValidate()){var x=g.model.currentViewData[l],v=(C=f.indexOf(x),!1);p.hasClass("e-checkbox")&&(v=!0),-1==C||g._rowSelectingEventTrigger(this.selectedRowIndex(),C,v,i.type)||(g.selectRows(C,null,v),g._cancelSaveTools(),g._rowSelectedEventTrigger(C,null,v,i.type))}m.selectionSettings.selectionType==t.TreeGrid.SelectionType.Multiple&&(g._multiSelectCtrlRequest=!!i.ctrlKey,i.shiftKey&&1==m.allowSelection&&(l=g.getIndexByRow(p.closest("tr")),x=m.currentViewData[l],l=f.indexOf(x),g._multiSelectShiftRequest=!0,g._rowSelectingEventTrigger(this.selectedRowIndex(),l,!1,i.type)||(g.getRows()&&null!=g._prevSelectedItem?g.getExpandStatus(g._prevSelectedItem)?g.selectRows(f.indexOf(g._prevSelectedItem),l):g.selectRows(l):g.getRows()&&null==g._prevSelectedItem&&g.selectRows(0,l),g._cancelSaveTools(),m.isFromGantt&&i.shiftKey?g._rowSelectedEventTrigger(l,t.isNullOrUndefined(g._prevSelectedItem)?0:m.updatedRecords.indexOf(g._prevSelectedItem)):g._rowSelectedEventTrigger(l,null,!1,i.type)))),g._checkboxSelection||g._multiSelectShiftRequest||0!=e("#"+g._id+"EditForm").length||-1!=n&&(x=m.currentViewData[n],l=f.indexOf(x),m.allowSelection&&!g._rowSelectingEventTrigger(this.selectedRowIndex(),l,!1,i.type)&&(g.selectRows(l),g._cancelSaveTools(),g._rowSelectedEventTrigger(l,null,!1,i.type))),g._multiSelectShiftRequest=!1}if(m.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Cell&&0==e("#"+g._id+"EditForm").length&&-1!=g._cellIndex&&-1!=l&&m.allowSelection){d=g._cellIndex>=g._frozenColumnsLength?1:0,s=g._frozenColumnsLength>0?g.getRows()[d][l]:g.getRows()[l];var S,R=m.columns,T=(x=m.currentViewData&&m.currentViewData[l],f.indexOf(x)),b=g._cellIndex>=g._frozenColumnsLength?g._cellIndex-g._frozenColumnsLength:g._cellIndex,y=s.childNodes[b],I=(g._previousSelectedCellDetails.rowIndex,g._previousSelectedCellDetails.cellIndex,e(y).closest("td"));if(g._focusingRowIndex=T,-1!=l){if(x.isSummaryRow)return;h={rowIndex:T,cellIndex:g._cellIndex,rowElement:s,cellElement:I[0]},c={rowIndex:T,cellIndex:g._cellIndex,cellElement:I[0],data:x},!g._cellSelectingEventTrigger(h)&&R[g._cellIndex].allowCellSelection&&("multiple"==m.selectionSettings.selectionType&&(i.ctrlKey||i.shiftKey)?i.ctrlKey?-1==(S="msie"==t.browserInfo().name&&t.browserInfo().version<9?g._getCellIndex(g._selectedCellDetails,"cellElement").indexOf(I[0]):g._selectedCellDetails.map(function(e){return e.cellElement}).indexOf(I[0]))?(e(I[0]).addClass("e-selectingcell"),g._selectedCellDetails.push(c),m.selectedCellIndexes.push({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),g._cellSelectedEventTrigger(h,g._previousSelectedCellDetails)):(e(I[0]).removeClass("e-selectingcell"),g._selectedCellDetails.splice(S,1),m.selectedCellIndexes.splice(S,1)):i.shiftKey&&(h={rowIndex:T,cellIndex:g._cellIndex},g._shiftKeySelectCells(h),g._rowIndexOfLastSelectedCell=T,g._focusingRowIndex=g._shiftKeyFirstElementDetails.firstElementRowIndex):(g._selectedCellDetails=[],m.selectedCellIndexes=[],e("#"+g._id).find(".e-selectingcell").removeClass("e-selectingcell"),e(I[0]).addClass("e-selectingcell"),g._selectedCellDetails.push(c),m.selectedCellIndexes.push({rowIndex:c.rowIndex,cellIndex:c.cellIndex}),g._cellSelectedEventTrigger(h,g._previousSelectedCellDetails),g._shiftKeyFirstElementDetails={firstElementRowIndex:-1,firstElementCellIndex:-1},g._updateSecondRowIndexBy=1),i.shiftKey||(g._previousSelectedCellDetails={rowElement:s,cellElement:I[0],cellIndex:h.cellIndex,rowIndex:T},g._rowIndexOfLastSelectedCell=g._focusingRowIndex,g._isShiftKeyNavigation=!1)),i.shiftKey||(g._rowIndexOfLastSelectedCell=g._focusingRowIndex),g._cancelSaveTools(),g._lastSelectedCellIndex=g._cellIndex}}g._isTouchTrigger&&g.model.allowSelection&&"multiple"==this.model.selectionSettings.selectionType&&!g.model.isFromGantt&&(g._isTouchTrigger&&null!=this._multiSelectPopup&&!this._multiSelectPopup.is(":visible")&&this._multiSelectPopup.find(".e-rowselect").hasClass("e-spanclicked")&&this._multiSelectPopup.show(),g._isTouchTrigger&&null!=this._multiSelectPopup&&!this._multiSelectPopup.find(".e-rowselect").hasClass("e-spanclicked")&&(p.hasClass("e-detailsrowcell")||p.parent("td").hasClass("e-detailsrowcell")||p.closest("tr").hasClass("e-detailsrow")||(this._multiSelectPopup.removeAttr("style"),u=p.closest(".e-rowcell").offset(),this._multiSelectPopup.offset({top:0,left:0}).offset({left:u.left+(p.closest(".e-rowcell").outerWidth()/2-this._multiSelectPopup.width()/2),top:u.top-this._multiSelectPopup.outerHeight()-10}).show())),g._isTouchTrigger=!1)}(p.hasClass("e-detailsrowcell")||p.parent("td").hasClass("e-detailsrowcell"))&&!p.closest("tr").hasClass("e-detailsrow")&&(i.ctrlKey||i.shiftKey||(!(e("#"+this._id+"EditForm").length>0)||!!this.editFormValidate())&&(g._isRowEdit?this.saveRow():g._detailsExpandCollapse(p))),g._isRowEdit&&p.focus(),p.closest("#"+g._id+"_ColumnMenu").hasClass("e-columnmenu")||0!=p.closest("div.e-excelfilter").length||p.hasClass("e-overlay")||g._clearColumnMenu(),"click"!=m.editSettings.beginEditAction||0!=p.closest("#"+g._id+"EditForm").length||g._isShiftKeyNavigation||g._isEmptyRowDeleted||g._editdblClickHandler(i),g._isEmptyRowDeleted=!1}},_isInFilteredState:function(){return this.model.allowFiltering&&this.model.filterSettings.filteredColumns.length>0||this._searchString.length>0},selectAllRows:function(i){var l,n=this,o=n.model,r=-1,a=n._isInFilteredState()?n._flatFilteredRecords:o.flatRecords,d=(n.getUpdatedRecords(),0);if(o.selectionSettings.enableSelectAll||n._isFromSetmodel){if(o.showSummaryRow&&(a=n._spliceSummaryRows(a)),!t.isNullOrUndefined(i)){for(i||(a=n._isInFilteredState()?n._flatFilteredRecords:e.extend([],o.selectedItems)),l=0;l<a.length;l++)if(i){if("checked"==a[l].checkboxState)continue;a[l].checkboxState="checked",o.selectedItems.push(a[l]),e("#"+this._id+"_checkbox"+a[l].ejRowId).removeClass("e-stop").addClass("e-checkmark"),e("#"+this._id+"_checkbox"+a[l].ejRowId).parent("span").removeAttr("class").addClass("e-chk-act")}else(r=o.selectedItems.indexOf(a[l]))>-1&&(a[l].checkboxState="unchecked",o.selectedItems.splice(r,1),e("#"+this._id+"_checkbox"+a[l].ejRowId).removeClass("e-checkmark"),e("#"+this._id+"_checkbox"+a[l].ejRowId).parent("span").removeAttr("class").addClass("e-chk-inact"),(o.selectionSettings.enableHierarchySelection||n._isFromSetmodel)&&n._updateParentSelection(a[l]));n._cancelSaveTools()}n._isInFilteredState()&&n._flatFilteredRecords.length>0&&o.selectedItems.length>0?d=n._flatFilteredRecords.filter(function(e){return"checked"==e.checkboxState}).length:d=o.selectedItems.length,d>0&&a.length>0?d!=a.length?(e("#"+this._id+"_headerCheckbox").removeClass("e-checkmark").addClass("e-stop"),e("#"+this._id+"_headerCheckbox").parent("span").removeAttr("class").addClass("e-chk-indeter")):(e("#"+this._id+"_headerCheckbox").removeClass("e-stop").addClass("e-checkmark"),e("#"+this._id+"_headerCheckbox").parent("span").removeAttr("class").addClass("e-chk-act")):(e("#"+this._id+"_headerCheckbox").removeClass("e-stop e-checkmark"),e("#"+this._id+"_headerCheckbox").parent("span").removeAttr("class").addClass("e-chk-inact"))}},_updateSelectedItems:function(t,i){var l,n,o=this.model;n=this.getUpdatedRecords().indexOf(t),t.checkboxState=i,l=e.inArray(t,o.selectedItems),"unchecked"==t.checkboxState?(-1!=l&&o.selectedItems.splice(l,1),n>-1&&(e("#"+this._id+"_checkbox"+t.ejRowId).removeClass("e-checkmark e-stop"),e("#"+this._id+"_checkbox"+t.ejRowId).parent("span").removeAttr("class").addClass("e-chk-inact"))):"checked"==t.checkboxState&&(-1==l&&o.selectedItems.push(t),n>-1&&(e("#"+this._id+"_checkbox"+t.ejRowId).removeClass("e-stop").addClass("e-checkmark"),e("#"+this._id+"_checkbox"+t.ejRowId).parent("span").removeAttr("class").addClass("e-chk-act")))},_traverseSelection:function(e,t,i){var l,n,o=this,r=0,a=this.model;if(o._updateSelectedItems(e,t),!i&&e.parentItem&&a.selectionSettings.enableHierarchySelection&&o._updateParentSelection(e.parentItem),e.hasChildRecords&&a.selectionSettings.enableHierarchySelection)for(l=e.childRecords,o._flatFilteredRecords.length>0&&(l=l.filter(function(e){return o._flatFilteredRecords.indexOf(e)>-1})),r=l.length,n=0;n<r;n++)l[n].hasChildRecords?o._traverseSelection(l[n],t,!0):l[n].isSummaryRow||o._updateSelectedItems(l[n],t)},_updateParentSelection:function(t){var i,l=this,n=this.model,o=[];t&&t.childRecords&&(o=l._spliceSummaryRows(t.childRecords)),l._flatFilteredRecords.length>0&&n.selectionSettings.enableHierarchySelection&&(o=o.filter(function(e){return l._flatFilteredRecords.indexOf(e)>-1})),i=o&&o.length;var r=!1,a=o.filter(function(e){return"indeterminate"==e.checkboxState}),d=o.filter(function(e){return"checked"==e.checkboxState});a.length>0||d.length>0&&d.length!=i?("checked"==t.checkboxState?(this._updateSelectedItems(t,"unchecked"),r=!0):"unchecked"==t.checkboxState&&(r=!0),r&&(e("#"+this._id+"_checkbox"+t.ejRowId).addClass("e-stop"),e("#"+this._id+"_checkbox"+t.ejRowId).parent("span").removeAttr("class").addClass("e-chk-indeter"),t.checkboxState="indeterminate",t.parentItem&&this._updateParentSelection(t.parentItem))):0==d.length&&0==a.length?(e("#"+this._id+"_checkbox"+t.ejRowId).removeClass("e-stop e-checkmark").parent("span").removeClass("e-chk-indeter"),"checked"==t.checkboxState?this._updateSelectedItems(t,"unchecked"):t.checkboxState="unchecked",t.parentItem&&this._updateParentSelection(t.parentItem)):(t.checkboxState="checked",this._updateSelectedItems(t,"checked"),t.parentItem&&this._updateParentSelection(t.parentItem))},_removeInnerDetailRows:function(i,l){for(var n,o=e(".e-detailscellwrapperfly"),r=o.length,a=0;a<r;a++)if(e.contains(o[a],i[0])||i==o[a]){!0;break}n=!1,t.isNullOrUndefined(o[a])&&(a=o.index(e("#"+this._id+"detailscellwrapper")),n=!0);var d=n?"":",",s=e(o[a]).attr("parentTreeGridIds"),c=e("[parentTreeGridIds$='"+d+s+"']");c.length;this._triggerDetailRowHideEvent(c,l)},_triggerDetailRowHideEvent:function(t,i){var l,n=this.model,o=t.length,r=0;if(o>0&&e("#"+this._id+"detailscellwrapper").length>0){e("#"+this._id+"detailscellwrapper");var a=n.selectedItem,d={};if(d.rowData=a,!this._trigger("detailsHidden",d)||i)for(;r<o;r++)l=e(t[r]).attr("id").replace("detailscellwrapper",""),e("#"+l).find(".e-detailsrowexpand").removeClass("e-detailsrowexpand").addClass("e-detailsrowcollapse"),e("#"+l).find(".e-detailsinfoiconhide").removeClass("e-detailsinfoiconhide").addClass("e-detailsinfoiconshow"),e(t[r]).remove()}},_removeDetailsRow:function(i,l){var n,o,r;this.model;if(i){if(o=n=e(i.target),n.parent("td").hasClass("e-detailsrowcell")&&(o=n.parent("td")),0==n.closest(".e-popup").length&&n[0]!=e("html").get(0)){for(var a=e(".e-detailscellwrapperfly"),d=a.length,s=0,c=!1;s<d;s++)if(e.contains(a[s],n[0])||n[0]==a[s]){c=!0;break}if(n.hasClass("e-detailscellwrapperfly")||o.hasClass("e-detailsrowexpand")||o.hasClass("e-detailsrowcollapse")||c||this._removeInnerDetailRows(e("#"+this._id+"detailscellwrapper"),l),n.hasClass("e-detailscellwrapperfly")||o.hasClass("e-detailsrowcollapse")||!o.hasClass("e-detailsrowexpand")&&c){r=!1,t.isNullOrUndefined(a[s])&&(s=a.index(e("#"+this._id+"detailscellwrapper")),r=!0);var u=r?"":",",g=e(a[s]).attr("parentTreeGridIds"),m=e("[parentTreeGridIds$='"+u+g+"']");this._triggerDetailRowHideEvent(m,l)}}}else e("#"+this._id+"detailscellwrapper").length>0&&this._removeInnerDetailRows(e("#"+this._id+"detailscellwrapper")[0],l),this._triggerDetailRowHideEvent(e("#"+this._id+"detailscellwrapper"),l)},showHideDetailsRow:function(i){var l,n,o=this,r=this.model;o._saveEditedElements(),r.showDetailsRow&&r.detailsTemplate&&r.showDetailsRowInfoColumn&&!t.isNullOrUndefined(i)&&i<=r.updatedRecords.length&&o.getExpandStatus(r.updatedRecords[i])&&(i!=this.selectedRowIndex()&&-1!=i&&e.inArray(i,-1==o._selectedRowsIndexes)&&r.allowSelection&&r.updatedRecords.length>i&&(o._rowSelectingEventTrigger(this.selectedRowIndex(),i)||(o.selectRows(i),o._rowSelectedEventTrigger(i))),this.updateScrollBar(i),(l=e(t.TreeGrid.getRowByIndex(o,i))).length>0&&r.updatedRecords[i]&&o.getExpandStatus(r.updatedRecords[i])&&(n=e(l).find(".e-detailsrowcell"),e(n).length>0&&e(n).hasClass("e-detailsrowcell")&&(this.element.find(".e-detailsrowexpand")[0]!=n[0]&&this._removeDetailsRow(),this._detailsExpandCollapse(e(n)))))},_detailsExpandCollapse:function(i){var l,n,o,r,a,d,s,c,u,g,m,p,h,_=this,f=this.model;if(i.parent("td").hasClass("e-detailsrowcell")&&(i=i.parent("td")),(n=(l=i.closest("tr")).find(".e-detailsrowcell")).hasClass("e-detailsrowcollapse")){if(o=this.getIndexByRow(l),r=this.model.currentViewData[o],t.isNullOrUndefined(r)||r.isSummaryRow)return;for(var w=this.getOffsetRect(l[0]),C=e(e.render[_._id+"_detailRowTemplate"](r)),x=e(C).find(".e-detailscellwrapper").attr({id:this._id+"detailscellwrapper"}),v=_._gridWidth-(_.element.find(".e-scrollcss").length>0?18:0)-2,S=this.element.parents().filter(".e-detailscellwrapperfly"),R=this._id,T="";S.length>0;)R+=","+(T=S.attr("id").replace("detailscellwrapper","")),S=e("#"+T).parents().filter(".e-detailscellwrapperfly");x.attr("parentTreeGridIds",R),(a=this.getOffsetRect(_._$gridContent[0])).bottom=a.top+_._$gridContent[0].offsetHeight,s=(d=w.top+l[0].offsetHeight)+f.detailsRowHeight,(d>a.bottom||s>a.bottom)&&((c=w.top-f.detailsRowHeight)>a.top&&(d=c)),x.removeClass("e-detailscellwrapper").addClass("e-detailscellwrapperfly"),f.cssClass&&x.addClass(f.cssClass),u=_.getScrollElement().ejScroller("isHScroll")?_.getScrollElement().ejScroller("option","scrollLeft"):0,(g=_.getMaxScrollWidth())>0&&u>g&&(u=g),m=0,this._frozenColumnsLength>0&&(m=e(this.element).find("#e-frozencontentdiv"+this._id).width()),x.css({top:d,left:w.left+u-m,"z-index":_.getMaxZIndex()+1,position:"absolute",width:v}).appendTo(this.element),this._trigger("refresh"),(p={}).detailsElement=x,p.data=r,p.rowIndex=this.selectedRowIndex(),this._trigger("detailsDataBound",p),(h={}).detailsElement=x,h.data=r,h.rowIndex=this.selectedRowIndex(),h.appendTarget=null,this._trigger("detailsShown",h)?this._removeInnerDetailRows(i):(n.find(".e-detailsinfoiconshow").removeClass("e-detailsinfoiconshow").addClass("e-detailsinfoiconhide"),n.removeClass("e-detailsrowcollapse").addClass("e-detailsrowexpand"),h.appendTarget&&(e(x).css({top:"auto",left:"auto",position:"auto"}),e(x).detach().appendTo(e("#"+h.appendTarget))))}else this._removeInnerDetailRows(i)},_onHeaderClick:function(i){var l,n,o,r,a,d,s,c,u,g=this,m=g.model;if(g._cellMouseLeave(),g._headerMouseLeave(),g._clearContextMenu(),this._removeDetailsRow(),e(i.target).is(".e-ascending, .e-descending")&&(i.target=i.target.parentNode),l=e(i.target),a=!0,g.getHeaderTable().find(".e-columnheader").find(".e-headercellactive").removeClass("e-headercellactive"),g._mouseDragged&&m.allowColumnReordering&&(a=!1),g._checkboxSelection&&m.allowSelection&&m.selectionSettings.enableSelectAll&&l.hasClass("e-headerCheckbox")&&(g.selectAllRows(!l.hasClass("e-checkmark")&&!l.hasClass("e-stop")),a=!1),!l.closest(".e-headercelldiv")||l.hasClass("e-columnmenu-icon")||l.hasClass("e-column-filter-icon")||l.hasClass("e-column-filtered-icon")||(n=l.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),!a||t.isNullOrUndefined(n)&&t.isNullOrUndefined(this.getColumnByField(n))||0==this.getColumnByField(n).allowSorting?g._saveEditedElements():a&&m.allowSorting&&(r=this.getColumnByField(n),o=l.closest(".e-headercell").find("span").hasClass("e-ascending")?t.sortOrder.Descending:t.sortOrder.Ascending,m.allowMultiSorting&&i.ctrlKey&&(g._multiSortRequest=!0),g._isRefreshAddedRecord=!1,m.isFromGantt?g.sortColumn(r.mappingName?r.mappingName:r.field,o):g.sortColumn(r.field,o),g.model.isFromGantt&&this.selectedRowIndex()>=0&&((d={}).data=g.model.selectedItem,d.target="ejTreeGrid",d.recordIndex=this.selectedRowIndex(),g._trigger("rowSelected",d)))),l.hasClass("e-column-filter-icon")||l.hasClass("e-column-filtered-icon")){if(g._batchEditStarts)return g._batchSaveLostWarning("Filtering"),g._batchTempDetails.filterTarget=i,!1;if(n=l.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),r=g.getColumnByField(n),g._checkFilterType(r),l.data("isClicked"))g._clearColumnMenu(),l.data("isClicked",!1);else if("menu"==m.filterSettings.filterType&&"excel"!=r.filterType||"excel"==m.filterSettings.filterType&&"menu"==r.filterType)g._updateFilterMenuList(i),e(".e-filtericon").data("isClicked",!1),l.data("isClicked",!0);else{var p=l[0].offsetWidth,h=l[0].offsetHeight,_=g.getOffsetRect(l[0]);_.top=_.top+h,_.left=_.left+p;var f=g.getOffsetRect(g.element[0]).left+g.element.width(),w=_.left,C=_.top,x=r.filterEditType?r.filterEditType:r.editType;switch(x=x.toLowerCase()){case"numericedit":x="number";break;case"stringedit":case"maskedit":case"dropdownedit":x="string";break;case"booleanedit":x="boolean";break;case"datepicker":case"datetimepicker":x=x.replace("picker","")}"excel"==m.filterSettings.filterType&&g._saveEditedElements(),e(window).width()<=g._responsiveMinWidth&&m.isResponsive&&m.enableResize?(g._renderResponsiveExcelFilter(r,x),e(".e-filtericon").data("isClicked",!1),g._mediaStatus=!0):(-1==e.inArray(x,g._excelColTypes)&&(g._clearFilterMenu(),e("#"+g._id+x+"_excelDlg").remove(),e("#"+g._id+x+"_CustomFDlg_wrapper").remove(),e("#"+g._id+x+"_CustomFDlg").remove(),g._excelFilter._openedFltr=null,g._excelColTypes.push(x),g._excelFilter.renderDialog(x)),s={True:g.localizedLabels.trueText,False:g.localizedLabels.falseText},c=[],e.grep(g.model.flatRecords,function(e){e.isSummaryRow||c.push(e.item)}),f<w+(u=e("#"+g._id+x+"_excelDlg").width())&&(w=w-u-p),g._excelFilter.openXFDialog({field:r.field,enableResponsiveRow:!0,displayName:r.headerText,dataSource:c,query:null,position:{X:w,Y:C},dimension:{height:e(window).height(),width:e(window).width()},cssClass:"resFilter",type:x,format:r.format,localizedStrings:s}),e(".e-filtericon").data("isClicked",!1),l.data("isClicked",!0),g._customFilter=null),g._filterIconTarget=i}this._addRemoveAnimateClass(l)}else l.hasClass("e-columnmenu-icon")?(l.data("isClicked")?(g._clearColumnMenu(),l.data("isClicked",!1)):(g._renderColumnMenu(i),e(".e-columnicon").data("isClicked",!1),l.data("isClicked",!0)),this._addRemoveAnimateClass(l)):g._clearColumnMenu();return!!l.hasClass("e-checkbox")||!(l.hasClass("e-columnmenu-icon")||l.hasClass("e-column-filter-icon")||l.hasClass("e-column-filtered-icon"))&&void 0},_renderResponsiveExcelFilter:function(i,l){var n,o,r,a,d,s,c,u,g,m,p,h=this,_=e.inArray(l,h._excelColTypes),f=e(window).width(),w=e(window).height();-1!=_&&(e("#"+h._id+l+"_excelDlg").remove(),h._excelColTypes.splice(_,1),h._excelFilter._openedFltr=null),h._excelFilter.renderDialog(l),n=t.buildTag("div.e-treegird-filterDialogHeaderDiv","",{width:"100%"}),o=t.buildTag("div.e-treegrid-label","<span>"+h._columnMenuTexts.menuFilter+"</span>",{"padding-top":"10px","font-weight":"bold","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"}),e(".e-filterMenuBtn").length>0&&e(".e-filterMenuBtn").remove();var C,x=t.buildTag("div.e-filterMenuBtn"),v=t.buildTag("input.e-responsiveFilterBtnLeft e-flat e-btnsub","",{"margin-left":"15px"}),S=t.buildTag("input.e-responsiveFilterBtnRight e-flat e-btncan","",{"margin-right":"12px"});n.append(o),h._excelDlg=C="#"+h._id+l+"_excelDlg",v.ejButton({text:h.localizedLabels.okButtonText,type:"button",click:function(){h._excelFilter._fltrBtnHandler(),e(C).css("display","none")}}),S.ejButton({text:h.localizedLabels.cancelButtonText,type:"button",click:function(){e(C).css("display","none"),h.element.css("display","block")}}),e(C).children().not(".e-searchcontainer").remove();var R=h._excelFilter,T=t.buildTag("div.e-treegrid-resFilterleftIcon","",{"padding-top":"10px"},{closeDialogue:C.slice(1),openDialogue:"responsiveFilter"}),b=t.buildTag("span.e-icon e-treegrid-resIcon e-treegrid-responsiveBack","",{},{closeDialogue:C.slice(1),openDialogue:"responsiveFilter"});T.click(function(t){e.proxy(h._closeDivIcon(t),this)}),n.append(T.append(b)),r=t.buildTag("div.e-treegrid-resFilterRigthIcon","",{"padding-top":"10px"},{closeDialogue:C.slice(1),gridEle:!0}),a=t.buildTag("span.e-icon e-treegrid-resIcon e-responsiveCustomFilter","",{},{closeDialogue:C.slice(1),gridEle:!0}),"boolean"!=l&&n.append(r.append(a)),(g=(d=e(C).css({height:w-20,padding:"0px",width:"99.7%"})).find(".e-searchcontainer .e-searchbox").css("margin-top","10px")).children().css("margin-top","10px"),s=d.find(".e-checkboxlist"),c=.65*w,h._checkBoxDiv=s,e(d.find(".e-searchcontainer")).addClass("e-treegrid-resultSearch"),d.find(".e-treegrid-resultSearch .e-btncontainer").remove(),v.addClass("e-treegrid-responsiveFilterBtnLeft").css({width:"43.6%"}),S.addClass("e-treegrid-responsiveFilterBtnRight").css("width","43.6%"),d.find(".e-excelLabel").remove(),u=t.buildTag("div.e-excelLabel",i.headerText,{"margin-top":"10px"}),g=d.find(".e-searchcontainer"),u.insertBefore(g.find(".e-searchbox")),d.prepend(n),d.find(".e-searchbox span").css("top","23px"),e(C).append(x.append(v).append(S)),s.ejScroller({height:c,width:"98%"}).ejScroller("refresh"),m={True:h.localizedLabels.trueText,False:h.localizedLabels.falseText},p=[],e.grep(h.model.flatRecords,function(e){e.isSummaryRow||p.push(e.item)}),h._excelFilter.openXFDialog({field:i.field,enableResponsiveRow:!0,displayName:i.headerText,dataSource:p,query:null,position:{X:0,Y:0},dimension:{height:w,width:f},cssClass:"resFilter",type:l,format:i.format,localizedStrings:m}),e(C).insertAfter(h.element),r.click(function(n){var o,r,a,d,s,c,u,g,m,p,_,T,b,y,I,D;e.proxy(h._closeDivIcon(n),this),o=w-30,R._openCustomFilter("customfilter"),r=e("#"+h._id+l+"_CustomFDlg").addClass("e-responsviesExcelFilter"),h._customFilter=r,t.isNullOrUndefined(r.find(".e-treegird-filterDialogHeaderDiv")[0])&&(a=t.buildTag("div.e-treegird-filterDialogHeaderDiv"),d=t.buildTag("div.e-treegrid-label","<span>"+R.localizedLabels.title+"</span>",{"font-weight":"bold","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"}),a.append(d),s=t.buildTag("div.e-treegrid-resFilterleftIcon","",{},{closeDialogue:h._id+l+"_CustomFDlg",openDialogue:C.slice(1)}),c=t.buildTag("span.e-icon e-treegrid-resIcon e-treegrid-responsiveBack","",{},{closeDialogue:h._id+l+"_CustomFDlg",openDialogue:C.slice(1)}),s.click(function(){r.css("display","none"),e("#"+h._id+l+"_CustomFDlg_wrapper").css("display","none");var t={True:h.localizedLabels.trueText,False:h.localizedLabels.falseText},n=[];e.grep(h.model.flatRecords,function(e){e.isSummaryRow||n.push(e.item)}),h._excelFilter.openXFDialog({field:i.field,enableResponsiveRow:!1,displayName:i.headerText,dataSource:n,query:null,position:{X:0,Y:0},dimension:{height:w,width:f},type:l,format:i.format,localizedStrings:t})}),a.append(s.append(c)),u=t.buildTag("div.e-treegrid-resFilterRigthIcon","",{},{closeDialogue:h._id+l+"_CustomFDlg",gridEle:!0}),g=t.buildTag("span.e-icon e-treegrid-resIcon e-treegrid-responsiveClose","",{},{closeDialogue:h._id+l+"_CustomFDlg",gridEle:!0}),a.append(u.append(g)),u.click(function(){r.css("display","none"),e("#"+h._id+l+"_CustomFDlg_wrapper").css("display","none"),h.element.css("display","block")}),r.prepend(a),r.insertAfter(h.element),r.find(".e-dlgfields").css("width","98%"),(m=r.find(".e-dlgfields:first").css("width","92%").css({"margin-left":"6px","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"})).css("margin-top","4%"),p=r.find(".e-dlgfields").find(".e-fieldset legend").text(),t.buildTag("div.e-responsiveLabelDiv",p,{"margin-left":"6px","font-family":"Segoe UI, Helvetica Neue, Ubuntu, Arial"}).insertAfter(m),_=r.find(".e-dlgfields").find(".e-fieldset").find("table").css("width","100%"),r.find(".e-dlgfields").find(".e-fieldset").replaceWith(_),_.parent("div").addClass("e-responsiveExcelFilterFieldDiv"),_.find(".e-dropdownlist"),_.find(".e-dropdownlist").each(function(t,i){var l=e(i).ejDropDownList("model.dataSource");e(i).ejDropDownList("destroy").ejDropDownList({width:"80%",dataSource:l})}),_.find(".e-autocomplete").each(function(t,i){var l=e(i).ejAutocomplete("model");e(i).ejAutocomplete("destroy").ejAutocomplete({width:"90%",dataSource:l.dataSource,fields:l.fields,enableDistinct:!0})}),_.find(".e-datepicker").each(function(t,i){e(i).ejDatePicker("instance").option("width","90%")}),_.find(".e-datetimepicker").each(function(t,i){e(i).ejDateTimePicker("instance").option("width","90%")}),_.find(".e-numerictextbox").each(function(t,i){e(i).ejNumericTextbox("instance").option("width","90%")})),T=v.clone(),b=S.clone(),T.ejButton({text:h.localizedLabels.okButtonText,type:"button",click:function(){h._excelFilter._openedFltr=r,h._excelFilter._fltrBtnHandler(),r.css("display","none"),e("#"+h._id+l+"_CustomFDlg_wrapper").css("display","none")}}),b.ejButton({text:h.localizedLabels.cancelButtonText,type:"button",click:function(){r.css("display","none"),e("#"+h._id+l+"_CustomFDlg_wrapper").css("display","none")}}),r.append(x.clone().append(T).append(b)),T.css("width","43.6%"),b.css("width","43.6%"),(y=r.find(".e-dlgfields .e-btncontainer").remove()).find("input:first").addClass("e-responsiveFilterBtnLeft").css("width","45.6%"),y.find("input:last").addClass("e-responsiveFilterBtnRight"),r.ejDialog({enableModal:!1,height:o,width:"100%",position:{X:0,Y:0},enableResize:!1,showHeader:!1}).ejDialog("open"),I=(I=h.getMaxZIndex()+1)>(D=e("#"+h._id+l+"_CustomFDlg_wrapper").css("z-index"))?I:D,r.css({position:"absolute",top:"0px",left:"0px","z-index":I,width:"95.5%"}),h._mediaStatus=!0})},_closeDivIcon:function(i){var l,n=e(i.target);t.isNullOrUndefined(n.attr("closeDialogue"))||(l=e("#"+n.attr("closeDialogue")),t.isNullOrUndefined(l.data("ejDialog"))?l.css("display","none"):l.ejDialog("close")),t.isNullOrUndefined(n.attr("gridEle"))||this.element.css("display","block"),t.isNullOrUndefined(n.attr("openDialogue"))||(this.model.enableResponsiveRow||-1!=n.attr("closeDialogue").indexOf("Custom")?(l=e("#"+n.attr("openDialogue")),t.isNullOrUndefined(l.data("ejDialog"))?l.css("display","block"):l.ejDialog("open")):this.element.css("display","block"))},_getExcelPredicate:function(l){var n,o,r,a,d,s=this,c=s.model,u=e.extend(!0,[],c.filterSettings.filteredColumns),g=u.length;for(s._excelFilter.getPredicate(u,null,!0),o=s._excelFilter._predicates[0],r=0;r<g;r++)(a=u[r]).value==s._dropDownListBlanksText?(d=(d=t.Predicate(a.field,"equal",null,!0)).or(a.field,"equal","",!0),o[a.field]=d,n=n!=i?n.and(d):d):n=t.isNullOrUndefined(n)?t.Predicate(a.field,a.operator,a.value,!a.matchcase):a.isComplex?n.and(a):n[a.predicate](a.field,a.operator,a.value,!a.matchcase),t.isNullOrUndefined(l)&&s._storePreviousFilteredValue(a.field,a.value,a.operator);return n},_checkFilterType:function(i){var l,n,o=this,r=o.model.filterSettings,a=i.filterEditType?i.filterEditType:i.editType;if(a=a.toLowerCase(),"excel"==r.filterType&&"menu"==i.filterType&&-1==e.inArray(a,o._menuColTypes)){switch(a){case"stringedit":l="String";break;case"numericedit":l="Numeric";break;case"datepicker":l="Datepicker";break;case"datetimepicker":l="Datetimepicker";break;case"dropdownedit":l="Dropdown",n=i;break;case"booleanedit":l="Boolean";break;default:l="String",a="stringedit"}o._renderEdittypeFilterMenu(l,n),o._menuColTypes.push(a)}else"menu"==r.filterType&&"excel"==i.filterType&&t.isNullOrUndefined(o._excelFilter)&&o._renderExcelFilter()},_triggerColumnResize:function(i,l,n){var o,r,a,d,s=this,c=s.model,u=s.getHeaderTable().find(".e-columnheader"),g=u.find(".e-headercell"),m=s._cellIndex,p=(e(s._target),0),h=e(n.target);return"columnResizeStart"==i&&(this._isFrozenStackedResize=!1,s._orgX=l,-1!=(m=s._currentCell=s._cellIndex=s.getCellIndex(n))&&this._frozenColumnsLength>0&&c.showStackedHeader&&c.stackedHeaderRows.length>0&&(h.closest(".e-movablecontentdiv").length>0||h.closest(".e-movableheaderdiv").length>0||h.closest(".e-movablefooterdiv").length>0?p+=this._frozenColumnsLength:h.closest(".e-frozenheaderdiv").length>0&&(h.hasClass("e-stackedHeaderCell")?this._isFrozenStackedResize=!0:p+=e(this.getHeaderTable()[0]).find(".e-stackedHeaderCell").length))),-1!=s._currentCell?(r=(o=g[s._currentCell+p]).offsetWidth,"columnResizeStart"==i?(s._isStackedResize=e(o).hasClass("e-stackedHeaderCell"),a={},a={columnIndex:m,column:s.model.columns[m],target:e(o),oldWidth:r},s._trigger("columnResizeStart",a)):"columnResizeEnd"==i?(u.find(".e-headercell").not(".e-detailheadercell").filter(":visible"),d=l-s._orgX,s._newWidth=r+d,s.__oldWidth=r,a={},a={columnIndex:m,column:c.columns[m],target:e(o),oldWidth:r,newWidth:s._newWidth,extra:d},s._trigger("columnResizeEnd",a)):(this.model.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||this.model.isFromGantt?!this.model.isFromGantt&&this.model.columnResizeSettings.columnResizeMode==t.TreeGrid.ColumnResizeMode.NextColumn&&this.model.showTotalSummary&&this._colgroupRefresh():this._updateTableWidth(),a={},r+(d=l-s._orgX),a={columnIndex:m,column:c.columns[m],oldWidth:s.__oldWidth,newWidth:s._newWidth},s._trigger("columnResized",a))):void 0},_headerMouseDown:function(t){var i,l,n,o,r=this,a=r._getCoordinate(t),d=r.model;if(r._cellMouseLeave(),r._headerMouseLeave(),!r.model.isFromGantt&&d.contextMenuSettings.showContextMenu&&r._contextMenuEventBinding(t),"touchstart"==t.type?(i=r._getElementByPosition(a.pageX,a.pageY),r._on(r.element,"touchmove",r._mouseMove),r._resizer&&r._resizer._touchStart(t)):i=e(t.target),r._on(e(document),"mouseup touchend",r._headerMouseUp),d.allowColumnReordering&&(i.closest(".e-columnheader").length>0&&r.dragColumn(t),"touchstart"==t.type&&(r._dragColumnTooltipTimer=window.setTimeout(function(){r._touchstart=!1,r._dragTooltip||"touchstart"!=t.type||(r.dragColumnToolTip(t),r._dragTooltip&&r._on(r.element,"touchmove",r.dragColumnToolTip))},550))),r.model.allowColumnResize){if(d.isFromGantt?r._on(r.element.closest(".e-gantt"),"mouseup touchend",r._mouseUp):r._on(r.element,"mouseup touchend",r._mouseUp),l=i.closest("tr"),this._target=i,n=a.pageX,a.pageY,-1!=navigator.userAgent.indexOf("WebKit")&&(n=a.pageX,a.pageY-document.body.scrollTop),l.length>0&&e(l[0]).hasClass("e-resizedragicon")&&!i.hasClass("e-columnicon")&&(i.is(".e-headercelldiv")&&(i=e(i[0].parentNode)),t.target=i,r._frozenColumnsLength>0&&(o=i.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),r.getColumnByField(o)),this._triggerColumnResize("columnResizeStart",n,t)))return;"touchstart"!=t.type&&r._resizer._mouseDown(t)}},_headerMouseUp:function(i){var l,n,o=this,r=o.model,a={},d=o._getCoordinate(i);"touchend"==i.type?(l=o._getElementByPosition(d.pageX,d.pageY),o._off(o.element,"touchmove",o._mouseMove)):l=e(i.target),o._off(e(document),"mouseup touchend",o._headerMouseUp),r.contextMenuSettings.showContextMenu&&o._contextMenuHandler&&o._displayContextMenu?o._headerRightClick(i):o._contextMenuHandler=!1,o._displayContextMenu=!0,o.model.allowColumnResize&&(r.isFromGantt?o._off(o.element.closest(".e-gantt"),"mouseup touchend",o._mouseUp):o._off(o.element,"mouseup touchend",o._mouseUp),this.element.find(".e-reSizeColbg").remove(),this.element.find(".e-columnheader").removeClass("e-resizedragicon"),o._resizer._expand=!1),r.allowColumnReordering&&(window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null,o._off(o.element,"mousemove touchmove",o.dragColumnToolTip),e(o._reordervline).remove(),e(o._dragmouseOverTooltip).remove(),(o._posx!=d.pageX||o._posy!=d.pageY)&&(o._mouseDragged=!0),r.allowColumnReordering&&l.closest(".e-headercell").length>0&&"mousemove"==o._headerDragStatus&&(n=r.columns,a.targetColumn=n[o._currentIndex],a.targetColumnIndex=o._currentIndex,a.draggedColumn=o._draggedColumn,a.draggedColumnIndex=n.indexOf(o._draggedColumn),t.isNullOrUndefined(a.targetColumn.nonColumn)&&!t.isNullOrUndefined(a.targetColumnIndex)&&a.targetColumnIndex!=a.draggedColumnIndex&&(o._trigger("columnDrop",a),a.cancel||o.reorderColumn(a.draggedColumn.field,a.targetColumnIndex)))),o._resetHeaderPrivateProperties()},_resetHeaderPrivateProperties:function(){this._timerDragDown&&(this._timerDragDown=window.clearInterval(this._timerDragDown)),this._timerDragUp&&(this._timerDragUp=window.clearInterval(this._timerDragUp));var e=this;e.model;e._draggedColumn=null,e._dragMouseDown=!1,e._dragTooltip=!1,e._headerDragStatus="",e._timerDragDown=null,e._timerDragUp=null,e._currentIndex=null,e._dragmouseOverTooltip=null},_contentMouseDown:function(i){var l,n=e(i.target),o=this,r=o.model,a=o._getCoordinate(i),d=n.closest(".e-treegrid").attr("id");return o._contentPageY=a.pageY,o._contentPageX=a.pageX,o._on(e(document),"mouseup touchend",o._mouseupHandler),r.isFromGantt&&("touchstart"==i.type&&(o._ganttTouchTrigger=!0),l={ctrlKey:i.ctrlKey},o._trigger("touchHandler",l),i.ctrlKey=l.ctrlKey),"touchstart"==i.type&&(o._isTouchEvent=!0,o._isTouchTrigger=!0),e("#"+d+"_selectionpopup").is(":visible")&&(e("#"+d+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")?(i.ctrlKey=!0,o.model.selectionSettings.selectionMode==t.TreeGrid.SelectionMode.Row&&(o._multiSelectCtrlRequest=!0)):(i.ctrlKey=!1,o._multiSelectCtrlRequest=!1)),!o.model.isFromGantt&&r.contextMenuSettings.showContextMenu&&o._contextMenuEventBinding(i),!(n.hasClass("e-vhandle")||n.hasClass("e-vscrollbar")||n.hasClass("e-vup")||n.hasClass("e-vdown")||n.hasClass("e-vhandlespace")||n.hasClass("e-hhandle")||n.hasClass("e-hscrollbar")||n.hasClass("e-hdown")||n.hasClass("e-hhandlespace")||n.closest(".e-editedcell").length>0||n.closest(".e-unboundeditedcell").length>0||n.parent().hasClass("e-unboundcelldiv")||(o._mouseDown=!0,t.isTouchDevice()&&i.preventDefault(),r.allowDragAndDrop&&(n.closest(".e-treegridrows").length>0||n.closest(".e-templatecell").length>0)&&("touchstart"==i.type?o._dragTooltipTimer=window.setTimeout(function(){o.dragRecord(i),o._multiSelectPopup&&o._multiSelectPopup.is(":visible")&&o._dragTooltip&&o._clearMultiSelectPopup()},550):o.dragRecord(i)),r.isFromGantt||"touchstart"==i.type&&o._on(o.element,"touchmove","#"+o._id+"e-gridcontent",o._touchScroll),!i.ctrlKey&&!i.shiftKey&&2!=i.which&&3!=i.which))||void 0},_touchScroll:function(t){var i,l,n,o,r,a=this,d=a.model,s=a._getCoordinate(t),c=a._contentPageX,u=a._contentPageY,g=s.pageX,m=s.pageY;a._isTouchTrigger=!1,o=g-c,r=m-u,"touchmove"==t.type&&t.preventDefault(),a._mouseDown&&!a._dragMouseDown&&(window.clearTimeout(this._dragTooltipTimer),this._dragTooltipTimer=null,window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null,i="touchmove"==t.type?a._getElementByPosition(s.pageX,s.pageY):e(t.target),!d.isFromGantt&&i.closest("div").find(".e-content")&&(n=u<m?-Math.abs(r):Math.abs(r),l=c<g?-Math.abs(o):Math.abs(o),a._contentPageX=g,a._contentPageY=m,a._updateScrollPosition(i,l,n)))},_updateScrollPosition:function(e,t,i){var l=this,n=l.getScrollElement().ejScroller("option","scrollTop"),o=l.getScrollElement().ejScroller("option","scrollLeft"),r=o+t,a=n+i,d=l.isVScroll()?l.getMaxScrollHeight():null,s=l.getScrollElement().ejScroller("isHScroll")?l.getScrollElement().find(".e-content").get(0).scrollWidth:null;d&&(((a=d<a?d:a<0?0:a)>0&&n>0||a<d&&n<d)&&(l._$gridContent.scrollTop(0),l.getScrollElement().ejScroller("scrollY",a,!0))),s&&(((r=s<r?s:r<0?0:r)>0&&o>0||r<s&&o<s)&&(l._$gridContent.scrollLeft(0),l.getScrollElement().ejScroller("scrollX",r,!0)))},_mouseMove:function(t){var i=this,l=this.model;window.clearTimeout(this._dragColumnTooltipTimer),this._dragColumnTooltipTimer=null,"touchmove"==t.type&&i._resizer&&i._resizer._allowStart&&(i._headerDragStatus=""),i.model.allowColumnResize&&0==i._headerDragStatus.length&&(i._resizer._mouseMove(t),i._resizer._expand&&i._cancelEditState(),"col-resize"!==e(t.target).parent().css("cursor")&&(!(l.allowSorting||l.showColumnChooser||!l.showColumnChooser&&l.allowFiltering&&"menu"==l.filterSettings.filterType)||e(t.target).closest("th").hasClass("e-detailheadercell")||e(t.target).closest("th").hasClass("e-stackedHeaderCell")?i.getHeaderTable().find(".e-columnheader").css({cursor:"default"}):i.getHeaderTable().find(".e-columnheader").css({cursor:"pointer"})))},_frozenWidth:function(){for(var e=this.getContentTable().find("colgroup").find("col").slice(0,this.model.scrollSettings.frozenColumns),t=0,i=0;i<e.length;i++)t+="none"==e[i].style.display?0:parseInt(e[i].style.width.replace("px",""));return t},_mouseUp:function(i){var l,n=this,o=n.model;if("mousemove"!=n._headerDragStatus&&o.allowColumnResize)if((e(i.target).hasClass("e-headercelldiv")||e(i.target).hasClass("e-reSizeColbg"))&&(n._focusTreeGridElement(),n._clearColumnMenu()),e(i.target).hasClass("e-reSizeColbg")||e(i.target).closest(".e-gridheader").length>0){if(n._resizer._expand){if(l=i.clientX,i.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(l=i.pageX,i.pageY),"touchend"==i.type&&(l=i.originalEvent.changedTouches[0].clientX,i.originalEvent.changedTouches[0].clientY),!t.isNullOrUndefined(n._currentCell)&&this._triggerColumnResize("columnResizeEnd",l,i))return this.element.find(".e-reSizeColbg").remove(),n._resizer._expand=!1,void(o.isFromGantt?n._off(n.element.closest(".e-gantt"),"mouseup touchend",n._mouseUp):n._off(n.element,"mouseup touchend",n._mouseUp));if(!t.isNullOrUndefined(n._currentCell)&&1==o.columns[n._currentCell].isFrozen&&l+100>this._gridWidth)return;n._resizer._mouseUp(i),!t.isNullOrUndefined(n._currentCell)&&n._currentCell>=0&&n._currentCell<o.columns.length&&o.columns[n._currentCell]&&(o.columns[n._currentCell].width=n._resizer._newWidth),t.isNullOrUndefined(n._currentCell)||this._triggerColumnResize("columnResized",l,i),o.allowTextWrap&&o.allowColumnResize&&n._updateRowHeight(),"auto"==o.sizeSettings.height&&o.allowColumnResize&&(n.getScrollElement().ejScroller("refresh"),n._updateContentHeight()),n.getScrollElement().ejScroller("refresh"),n._updateHeaderScrollLeft(),n._updateScrollCss(),o.isFromGantt&&n._trigger("refreshScrollCss")}}else this.element.find(".e-reSizeColbg").remove(),n._resizer._expand=!1,o.isFromGantt?n._off(n.element.closest(".e-gantt"),"mouseup touchend",n._mouseUp):n._off(n.element,"mouseup touchend",n._mouseUp)},_resizeFilteringElements:function(){var e,i,l,n=this;if(n.model.allowFiltering)for(e={},i=n.model.columns.length,e.requestType=t.TreeGrid.Actions.Filter,l=0;l<i;l++)n.model.columns[l].width=n.columnsWidthCollection[l],e.fieldname=n.model.columns[l].field,this._filteringElements(e)},_enableEditingEvents:function(){var e=this;e.model.editSettings.allowEditing?t.isTouchDevice()?(e._off(e.element,"doubletap ",".e-gridcontent",e._editdblClickHandler),e._on(e.element,"doubletap ",".e-gridcontent",e._editdblClickHandler)):(e._off(e.element,"dblclick ",".e-gridcontent",e._editdblClickHandler),e._on(e.element,"dblclick ",".e-gridcontent",e._editdblClickHandler)):t.isTouchDevice()?e._off(e.element,"doubletap ",".e-gridcontent",e._editdblClickHandler):e._off(e.element,"dblclick ",".e-gridcontent",e._editdblClickHandler)},_saveCellHandler:function(i){var l,n=e(i.target),o=this,r=o.model;if(r.isFromGantt&&n.closest("tr").length){var a=n.closest("tr"),d=(o.getRows(),this.getIndexByRow(a)),s=r.currentViewData&&r.currentViewData[d];l=r.updatedRecords.indexOf(s)}n.hasClass("e-vhandle")||n.hasClass("e-vscrollbar")||n.hasClass("e-vup")||n.hasClass("e-vdown")||n.hasClass("e-vhandlespace")||n.hasClass("e-vscroll")||n.hasClass("e-hhandle")||n.hasClass("e-hscrollbar")||n.hasClass("e-hup")||n.hasClass("e-hdown")||n.hasClass("e-hhandlespace")||n.hasClass("e-hscroll")||((n.closest(".e-gridcontent").length>0||n.hasClass(".e-gridcontent")||n.hasClass("e-summarytreegridexpand")||n.hasClass("e-summarytreegridcollapse"))&&(o._isRowEdit?0==n.closest("form#"+o._id+"EditForm").length&&0==n.closest("form#"+o._id+"EditFrozenForm").length&&e("#"+o._id+"EditForm").length>0&&o.saveRow():0==n.closest(".e-popup").length&&0==n.closest(".e-rowcell").find("#"+o._id+"EditForm").length&&0==n.closest("form#"+o._id+"EditFrozenForm").length&&e("#"+o._id+"EditForm").length>0&&o.saveCell()),"row"!=r.selectedMode||!r.isFromGantt||!r.updatedRecords.length||t.isNullOrUndefined(l)||n.hasClass("e-treegridexpand")||n.hasClass("e-treegridcollapse")||this.selectedRowIndex()==l||o._rowSelectingEventTrigger(this.selectedRowIndex(),l)||(r.allowSelection&&o.selectRows(l),o._rowSelectedEventTrigger(l)))},_contextMenuAction:function(t){var i,l=this,n=l.model,o=l._getCoordinate(t);if(i="taphold"==t.type?l._getElementByPosition(o.pageX,o.pageY):e(t.target),n.contextMenuSettings.showContextMenu){if(l._multiSelectCtrlRequest&&(l._multiSelectCtrlRequest=!1),3!=t.which||l._isTouchEvent)return l._contextMenuHandler=!0,!0;i.closest(".e-gridcontent").length>0?l._rightClick(t):i.closest(".e-gridheader").length>0&&l._headerRightClick(t)}else t.stopPropagation()},_rightClick:function(i){var l,n,o,r,a=this,d=a.model,s=e(i.target),c=(s[0].parentNode,{}),u=!1,g=a.getUpdatedRecords();if(s.closest(".e-treegrid").attr("id")!==this._id)return!1;if("cell"==d.selectionSettings.selectionMode&&"dialogEditing"!=d.editSettings.editMode&&(d.editSettings.editMode="cellEditing"),a.model.contextMenuSettings.showContextMenu){if(a._clearContextMenu(),this._removeDetailsRow(),a.disableTooltip(),s.hasClass("e-summaryrowcell")||s.hasClass("e-summarytitle"))return;if((s.hasClass("e-cell")||s.hasClass("e-treegridexpand"))&&s.closest("tr"),l=s.closest("tr"),n=a.getIndexByRow(l),a.model.currentViewData=a.getCurrentViewData(),o=a.model.currentViewData[n],n=g.indexOf(o),c.data=o,c.recordIndex=n,d.isEdit?u=s.closest(".e-rowcell").find("form#"+a._id+"EditForm").length>0||s.closest(".e-rowcell").find("form#"+a._id+"EditFrozenForm").length>0:this._isRowEdit&&(u=s.closest(".e-rowedit").find("form#"+a._id+"EditForm").length>0||s.closest(".e-rowedit").find("form#"+a._id+"EditFrozenForm").length>0||s.closest(".e-addedrow").find("form#"+a._id+"EditForm").length>0||s.closest(".e-addedrow").find("form#"+a._id+"EditFrozenForm").length>0),!u){if(!this.editFormValidate())return!0;a._saveEditedElements()}null==a.dataSource()||0==a.dataSource().length||u||0==d.flatRecords.length?(a._contextMenuItems=[],a._contextMenuItems=a._getContextMenuItems(),a._subContextMenuItems=[],a._updateContextmenuOption(n,o),a._clearContextMenu(),a._contextMenuItems.length>0&&a._renderContextMenu(i,n,o,u)):o&&(i.preventDefault(),a._contextMenuItems=[],a._contextMenuItems=a._getContextMenuItems(),a._subContextMenuItems=[],a._subContextMenuItems=a._getsubContextMenuItems(),a._updateContextmenuOption(n,o),a._clearContextMenu(),"row"==d.selectionSettings.selectionMode&&d.allowSelection&&!a._rowSelectingEventTrigger(this.selectedRowIndex(),n,!1,i.type)&&(a.selectRows(n),a._rowSelectedEventTrigger(n,null,!1,i.type)),"cell"==d.selectionSettings.selectionMode&&(r=a.getCellIndex(i),a.selectCells([{rowIndex:n,cellIndex:r}]),a._rowIndexOfLastSelectedCell=n),a._contextMenuItems.length>0&&a._renderContextMenu(i,n,o,u),a.editFormValidate()&&a._cancelSaveTools())}a._clearColumnMenu(),a._contextMenuHandler=!1,!a.model.isFromGantt&&d.contextMenuSettings.showContextMenu&&(t.isTouchDevice()?a._off(a.element,"taphold",a._contextMenuAction):a._off(a.element,"contextmenu",a._contextMenuAction))},_contextMenuEventBinding:function(){var e=this;t.isTouchDevice()?(e._off(e.element,"taphold",e._contextMenuAction),e._on(e.element,"taphold",e._contextMenuAction)):(e._off(e.element,"contextmenu",e._contextMenuAction),e._on(e.element,"contextmenu",e._contextMenuAction))},_headerRightClick:function(i){var l,n,o=this,r=o.model,a=e(i.target);i.preventDefault(),r.contextMenuSettings.showContextMenu&&(o._clearColumnMenu(),o._removeDetailsRow(),o.disableTooltip(),o._headerContextMenuItems=[],o._headerContextMenuItems=o._getHeaderContextMenuItems(i),l=a.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),n=o.getColumnByField(l),o._headerContextMenuItems.length>0&&!n.nonColumn&&o._renderHeaderContextMenu(i),o.editFormValidate()&&o._cancelSaveTools(),o._contextMenuHandler=!1,!r.isFromGantt&&r.contextMenuSettings.showContextMenu&&(t.isTouchDevice()?o._off(o.element,"taphold",o._contextMenuAction):o._off(o.element,"contextmenu",o._contextMenuAction)))},_editdblClickHandler:function(l){var n,o,r,a,d,s=this,c=s.model,u=e("#"+s._id+"EditForm"),g={},m=e(l.target),p=m.closest("tr"),h=s._cellEditingDetails;if(c.isFromGantt&&1==c.readOnly||m.hasClass("e-unboundcelldiv")||m.hasClass("e-unboundcell")||m.closest("td").hasClass("e-unboundcell")||l.ctrlKey)return!0;if(!(o=s.getUpdatedRecords(),m.hasClass("e-vhandle")||m.hasClass("e-vscrollbar")||m.hasClass("e-vup")||m.hasClass("e-vdown")||m.hasClass("e-vhandlespace")||m.hasClass("e-treegridexpand")||m.hasClass("e-treegridcollapse")||m.hasClass("e-hhandle")||m.hasClass("e-hscrollbar")||m.hasClass("e-hup")||m.hasClass("e-hdown")||m.hasClass("e-hhandlespace")||m.hasClass("e-summaryrowcell")||m.hasClass("e-footersummaryrowcell")||m.hasClass("e-summarytitle")||m.hasClass("e-lastsummaryrow"))){if(m.closest(".e-treegrid").length&&m.closest(".e-treegrid").attr("id")!==this._id)return!1;if(m.hasClass("e-rowcell")||m.parent().hasClass("e-rowcell")||m.closest("td").hasClass("e-rowcell")||m.closest("td").hasClass("e-rowcell")&&m.hasClass("e-cell")){if("normal"===c.editSettings.editMode&&c.editSettings.allowEditing){if("resourceView"==c.viewType)return!0;g.requestType=t.TreeGrid.Actions.BeginEdit,s._trigger("actionBegin",g)}if(s._cellEditingDetails.cancelSave)return void(s._cellEditingDetails.cancelSave=!1);if(0===u.length&&null!==s.getRows()){if("cellediting"==c.editSettings.editMode.toLowerCase()||"batchediting"==c.editSettings.editMode.toLowerCase()&&"cell"==c.editSettings.batchEditSettings.editMode.toLowerCase()){if(s._focusTreeGridElement(),s._cellEditingDetails.columnIndex=s.getCellIndex(l),"click"!=c.editSettings.beginEditAction&&(s._cellEditingDetails.rowIndex=s.getRowIndex(l)),(n=c.currentViewData[s._cellEditingDetails.rowIndex]).summaryRow)return;if(c.selectedItem=n,0==c.columns[h.columnIndex].allowEditing||"resourceView"==c.viewType&&"unassignedTask"==n.eResourceTaskType)return;(r=s._cellEditingDetails.columnIndex>=0&&c.columns[s._cellEditingDetails.columnIndex].field)&&(s.updateScrollBar(),c.editSettings.allowEditing&&s.cellEdit(s._cellEditingDetails.rowIndex,r))}else("rowediting"==c.editSettings.editMode.toLowerCase()||"dialogediting"==c.editSettings.editMode.toLowerCase()||"batchediting"==c.editSettings.editMode.toLowerCase()&&("row"==c.editSettings.batchEditSettings.editMode.toLowerCase()||"dialog"==c.editSettings.batchEditSettings.editMode.toLowerCase()))&&(c.currentViewData=s.getCurrentViewData(),-1!=s.getCellIndex(l)&&-1!=s.getRowIndex(l)&&(s._cellEditingDetails.columnIndex=s.getCellIndex(l),a=s.getRowIndex(l),c.enableVirtualization&&(d="row"==c.selectionSettings.selectionMode?c.selectedItem:c.updatedRecords[s._rowIndexOfLastSelectedCell],a=o.indexOf(d)),"dialogediting"==s.model.editSettings.editMode.toLowerCase()||"batchediting"==s.model.editSettings.editMode.toLowerCase()&&"dialog"==c.editSettings.batchEditSettings.editMode.toLowerCase()?s._showTreeGridAddEditDialog(a):(s.updateScrollBar(),s._editRow(a,i,s._cellEditingDetails.columnIndex))));(u=e("#"+s._id+"EditForm")).length>0&&s._editAddTools(),e.isFunction(e.validator)&&s._initValidator()}s.model.allowSelection||p.find(".e-active").removeClass("e-active").removeClass("e-selectionbackground"),s._clearContextMenu(),this._removeDetailsRow()}}},_popupHide:function(i){var l,n,o=this,r=o.model.columns,a=null,d=null,s=null,c=i&&e(i).closest("td");for(o.model.allowFiltering&&"filterbar"==o.model.filterSettings.filterType&&(c=i&&e(i).closest("td, th")),e("#"+o._id+"_ColumnMenu").length>0&&(t.isTouchDevice()||o._clearColumnMenu()),l=0;l<r.length;l++)a=null,r[l]&&(s=r[l].field.split(".").join(""),"datepicker"==r[l].editType||"datetimepicker"==r[l].editType?a=e("#"+o._id+s).data("ejDatePicker"):"dropdownedit"==r[l].editType&&((n=e("#"+o._id+s).data("ejDropDownList"))&&0==e(c).find("#"+n._id).length&&n.model&&n.hidePopup()),a&&0==e(c).find("#"+a._id).length&&a.hide(),("datepicker"==r[l].filterEditType||"datetimepicker"==r[l].filterEditType)&&((d=e("#"+o._id+"_"+s+"_filterbarcell").data("ejDatePicker"))&&0==e(c).find("#"+d._id).length&&d.hide()),"dropdownedit"==r[l].filterEditType&&((n=e("#"+o._id+"_"+s+"_filterbarcell").data("ejDropDownList"))&&0==e(c).find("#"+n._id).length&&n.hidePopup()))},_mouseWheel:function(t){var i=this,l=i.model,n=null,o=t;if(i._popupHide(),t=t.originalEvent,!e(t.target).hasClass("e-footersummaryrowcell")){if(i.getScrollElement().height()>i._$gridContainer.height())return void i.getScrollElement().ejScroller("scrollY",0,!0);if(t.wheelDelta?(n=-t.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(n=-n)):t.detail&&(n=t.detail/3),!n)return!1;var r=i.getScrollElement().ejScroller("option","scrollTop"),a=r+57*n,d=this.model.isFromGantt?parseInt(this.getRecordsHeight())-(i._viewPortHeight-18):"auto"==l.sizeSettings.height?0:this.getMaxScrollHeight();if(a>d&&(a=d),a<0&&(a=0),r!=a)try{t.preventDefault?t.preventDefault():o.preventDefault()}catch(e){}return i.updateScrollTop(a),!0}},_getCollapsedParentItem:function(e){var t=e.parentItem;return t?!0===this.getExpandStatus(t)?t:this._getCollapsedParentItem(t):null},_getRecordTopPosition:function(e,t){var i,l={},n=0,o=this.model;if("resourceView"==o.viewType){for(i=0;i<=t;i++)i==t?l.bottom=n+this._getTemplateRowHeight(e[i]):n+=this._getTemplateRowHeight(e[i]);l.top=n}else l.top=t*(o.rowHeight+this._detailsRowHeight),l.bottom+=o.rowHeight+this._detailsRowHeight;return l},updateScrollBar:function(e){var i,l,n,o,r,a,d,s,c,u,g,m,p,h,_,f=this,w=f.model,C=0,x=f.getUpdatedRecords();d=w.allowSelection?"row"==w.selectionSettings.selectionMode?this.selectedItem():x[f._rowIndexOfLastSelectedCell]:this.selectedItem(),i=w.allowPaging?x:f._isHierarchyFiltering&&w.enableVirtualization?f._updateFilterParent:f.getExpandedRecords(x),c=e||0==e?i.indexOf(x[e]):i.indexOf(d),w.allowTextWrap?(c=(s=f.getUpdatedRecords()).indexOf(d),w.enableVirtualization?(l=f._getAvgTextWrapRowHeight("updateHeight",c).height,n=s[c].textWrapRowHeight+f._detailsRowHeight):(u=t.TreeGrid.getRowByIndex(f,c)).length>0?(n=u.height()+f._detailsRowHeight,l=u[0].offsetTop):l=c*(n=w.rowHeight+f._detailsRowHeight)):(g=this._getRecordTopPosition(i,c),n=w.rowHeight+this._detailsRowHeight,l=g.top),m=l+n,p=(h=f.getScrollElement().children(".e-content").length)?f.getScrollElement().children(".e-content").scrollTop():f.getScrollElement().scrollTop(),o=w.allowTextWrap?f.model.enableVirtualization?f._getAvgTextWrapRowHeight("updateHeight").height:f._$gridContentTable.height():this.getRecordsHeight(),(f.getScrollElement().ejScroller("isHScroll")||f.element.find(".e-borderbox").length>0)&&(C=18),r=l<p,a="auto"!=w.sizeSettings.height&&p+f._viewPortHeight-C<m,(r||a)&&(l+f._viewPortHeight>o&&(l=o-f._viewPortHeight,a&&(l+=C)),_={requestType:t.TreeGrid.Actions.Scroll,delta:l},h?f.updateScrollTop(l):(f.getScrollElement().scrollTop(_.delta),f._completeAction(_)),w.enableVirtualization&&f._focusTreeGridElement())},_selectedItemDown:function(e){var t,i,l,n=this,o=this.model,r=n.getUpdatedRecords(),a=n.getExpandedRecords(r);t=n._prevSelectedItem&&this._getExpandStatusRecord(n._prevSelectedItem)?o.updatedRecords.indexOf(n._prevSelectedItem):0,n._shiftSelectedRecord&&this._getExpandStatusRecord(n._shiftSelectedRecord)?(l=a.indexOf(n._shiftSelectedRecord),i=o.updatedRecords.indexOf(a[l+1])):(l=a.indexOf(o.updatedRecords[t]),i=o.updatedRecords.indexOf(a[l+1])),(i>=r.length||-1==i)&&(i=r.length-1),n.updateScrollBar(i),n._multiSelectShiftRequest=!0,n.selectRows(t,i),n._rowSelectedEventTrigger(t,i,!1,e),n._multiSelectShiftRequest=!1,n._shiftSelectedRecord=o.updatedRecords[i]},_selectedItemUp:function(e){var t,i,l,n=this,o=this.model,r=n.getUpdatedRecords(),a=n.getExpandedRecords(r);t=n._prevSelectedItem&&this._getExpandStatusRecord(n._prevSelectedItem)?o.updatedRecords.indexOf(n._prevSelectedItem):0,n._shiftSelectedRecord&&this._getExpandStatusRecord(n._shiftSelectedRecord)?(l=a.indexOf(n._shiftSelectedRecord),i=o.updatedRecords.indexOf(a[l-1])):(l=a.indexOf(o.updatedRecords[t]),i=o.updatedRecords.indexOf(a[l-1])),i<0&&(i=0),n.updateScrollBar(i),n._multiSelectShiftRequest=!0,n.selectRows(t,i),n._rowSelectedEventTrigger(t,i,!1,e),n._multiSelectShiftRequest=!1,n._shiftSelectedRecord=o.updatedRecords[i]},_keyPressed:function(i,l){var n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C,x,v,S,R,T,b,y,I,D,E,M,k,F,O,H,z,P,A,N,G,L,j,B,V,U,W,q=this,$=this.model,K=q.getUpdatedRecords(),X=$.allowPaging?K:q.getExpandedRecords($.updatedRecords);if(this._removeDetailsRow(),!$.allowKeyboardNavigation)return!1;if("dialogEditing"==this.model.editSettings.editMode&&e(l).closest("#"+this._id+"_dialogEdit").length)return!0;var Y=!1,Q=e(l),J=e("#"+q._id+"EditForm");if("downArrow"!=i&&"upArrow"!=i&&"saveRequest"!=i&&"moveCellLeft"!=i&&"moveCellRight"!=i&&"cancelRequest"!=i&&"INPUT"==Q.prop("tagName"))return!0;switch($.isFromGantt?(m=e("#"+q._id.replace("ejTreeGrid","")+"_ContextMenu"),p=e("#"+q._id.replace("ejTreeGrid","")+"_SubContextMenu")):(m=e("#"+q._id+"_ContextMenu"),p=e("#"+q._id+"_SubContextMenu")),h=e("#"+q._id+"_ColumnMenu"),_=e("#"+q._id+"ccDiv_wrapper"),c=e("#"+q._id+"_headerContextMenu"),u=e("#"+q._id+"ccDiv_wrapper"),q._columnMenuTarget&&(v=e.trim(q._columnMenuTarget.prev("div.e-headercelldiv").attr("data-ej-mappingname")),(y=q.getColumnByField(v))&&(y.filterEditType?(D=y.filterEditType.indexOf("edit"),x=y.filterEditType):(D=y.editType.indexOf("edit"),x=y.editType),-1!=D?(a=(r=x.slice(0,D)).charAt(0).toUpperCase()+r.slice(1),d=e("#"+q._id+"filter"+a+"MenuDiv_wrapper")):(a=x.charAt(0).toUpperCase()+x.slice(1),d=e("#"+q._id+"filter"+a+"MenuDiv_wrapper"))),C=!t.isNullOrUndefined(d)&&d.is(":visible")),f="visible"==p.css("visibility"),w=_.is(":visible"),g=u.is(":visible"),i){case"saveRequest":if(0==m.length&&0==h.length&&0==c.length)(q._isRowEdit||q.model.isEdit)&&(Q.blur(),q._endEdit(),q._focusTreeGridElement()),"onEnter"==$.filterSettings.filterBarMode&&"filterbar"==$.filterSettings.filterType&&$.allowFiltering&&Q.closest("th").hasClass("e-filterbarcell")&&q._filterBarHandler(l);else if(m.length)q._moveToNextMenuItem("save");else if(c.length)if("contextMenu_Columns"==e("#"+q._activeMenuItemId).attr("id")){if(L=null,j=u.find("div.e-columnmenuselection"),w?L=j.data("column"):(le=c.find("div.e-columnmenuselection")).length>0&&(L=le[0].id),!t.isNullOrUndefined(L))switch(y=q._contextMenuColumnDetails,L){case"contextMenu_Columns":q._showKeyboardColumnChooser(!1,c,u,e("#contextMenu_Columns"));break;default:j.find("span").hasClass("e-disable")||("true"==j.find("span").attr("aria-checked")?q.hideColumn(L):q.showColumn(L))}}else q._moveToNextMenuItem("save");else if(h.length&&(L=null,j=_.find("div.e-columnmenuselection"),w?L=j.data("column"):(le=h.find("div.e-columnmenuselection")).length>0&&(L=le[0].id),!t.isNullOrUndefined(L)))switch(Q=q._columnMenuTarget,v=e.trim(Q.prev("div.e-headercelldiv").attr("data-ej-mappingname")),y=q.getColumnByField(v),L){case q._id+"_SortAscendingChooser":q.model.allowMultiSorting&&(q._multiSortRequest=!0),$.isFromGantt?q.sortColumn(y.mappingName?y.mappingName:y.field,t.sortOrder.Ascending):q.sortColumn(y.field,t.sortOrder.Ascending),q._multiSortRequest=!1;break;case q._id+"_SortDescendingChooser":q.model.allowMultiSorting&&(q._multiSortRequest=!0),$.isFromGantt?q.sortColumn(y.mappingName?y.mappingName:y.field,t.sortOrder.Descending):q.sortColumn(y.field,t.sortOrder.Descending),q._multiSortRequest=!1;break;case q._id+"_FreezeColumnsChooser":y&&!e(q._id+"_FreezeColumnChooser").hasClass("e-disable")&&(q._checkboxSelection&&$.columns[0].nonColumn&&!$.columns[0].isFrozen&&($.columns[0].isFrozen=!0),q.freezeColumn(y.field,!0));break;case q._id+"_UnfreezeColumnsChooser":y&&!e(q._id+"_UnfreezeColumnChooser").hasClass("e-disable")&&(q._checkboxSelection&&2==q._frozenColumnsLength&&$.columns[0].nonColumn&&$.columns[0].isFrozen&&($.columns[0].isFrozen=!1),q.freezeColumn(y.field,!1));break;case q._id+"_FreezePrecedingColumnsChooser":y&&!e(q._id+"_FreezePrecedingColumnsChooser").hasClass("e-disable")&&q.freezePrecedingColumns(y.field);break;case q._id+"_ColumnLeftChooser":y&&!e(q._id+"_ColumnLeftChooser").hasClass("e-disable")&&q.insertColumnChooser(y,"left");break;case q._id+"_ColumnRightChooser":y&&!e(q._id+"_ColumnRightChooser").hasClass("e-disable")&&q.insertColumnChooser(y,"right");break;case q._id+"_DeleteColumnChooser":y&&!e(q._id+"_DeleteColumnChooser").hasClass("e-disable")&&(q._targetColumnIndex=$.columns.indexOf(y),q._updateConfirmDialog.ejDialog("open"),q._clearColumnMenu());break;case q._id+"_RenameColumnChooser":y&&!e(q._id+"_RenameColumnChooser").hasClass("e-disable")&&(q._targetColumnIndex=$.columns.indexOf(y),q._renderColumnRenameDialog(y),q._columnRenameDialog.ejDialog("open"),q._clearColumnMenu());break;case q._id+"_FilterChooser":y&&e("#"+q._id+"_ColumnMenu").find(".e-expander").hasClass("e-treegridadaptivesubicon")&&(S=d[0].id.substring(q._id.length,d[0].id.indexOf("MenuDiv")),q._showFilterMenu(null,S,null,null,null,null,null,null,y,null));break;case q._id+"_ColumnsChooser":y&&e("#"+q._id+"_ColumnMenu").find(".e-expander").hasClass("e-treegridadaptivesubicon")&&!q.model.isFromGantt&&q._adaptiveColumnChooser();break;default:j.find("span").hasClass("e-disable")||("true"==j.find("span").attr("aria-checked")?q.hideColumn(L):q.showColumn(L))}break;case"cancelRequest":0==m.length&&0==h.length&&0==c.length?(J.length>0&&("cellediting"==(b=$.editSettings.editMode).toLowerCase()||"batchediting"==b.toLowerCase()&&"cell"==$.editSettings.batchEditSettings.editMode?q._isRowEdit?q.cancelRowEditCell():q.cancelEditCell():("rowediting"==b.toLowerCase()||"batchediting"==b.toLowerCase()&&"row"==$.editSettings.batchEditSettings.editMode)&&q.cancelRowEditCell(),q._cancelSaveTools()),q._focusTreeGridElement(),1==q._dragMouseDown&&(e(q._dragmouseOverTooltip).remove(),e(".e-dragintend").find(".e-icon").css({display:"none"}),e(".e-intendparent").find(".e-icon").css({display:"none"}),q._dropCancel=!0,q._dragMouseDown=!1,q._dragTooltip=!1,q._headerDragStatus="",q._dragTargetItem&&q._dragTargetItem.hasChildRecords&&0==q._dragTargetItem.level&&(R=t.TreeGrid.getRowByIndex(this,K.indexOf(q._dragTargetItem)),q._dragTargetItem?R.find(".e-treegridexpand").css({display:"inline-block"}):R.find(".e-treegridcollapse").css({display:"inline-block"})),q._off(q.element,"touchmove",".e-treegridrows, .e-templatecell",q.dragToolTip),q._off(q.element,"mousemove",".e-gridcontent, .e-templatecell",q.dragToolTip))):(q._clearContextMenu(),q._clearColumnMenu());break;case"editRecord":if($.isFromGantt&&1==$.readOnly)return;if(0==m.length&&0==h.length&&("cell"==$.selectionSettings.selectionMode&&"dialogEditing"!=$.editSettings.editMode&&($.editSettings.editMode="cellEditing"),b=(T=$.editSettings).editMode,T.allowEditing&&1==$.selectedItems.length||T.allowEditing&&"cell"==$.selectionSettings.selectionMode||T.allowEditing&&$.selectedItem&&q._checkboxSelection))if("cellediting"==b.toLowerCase()||"cell"==$.selectionSettings.selectionMode){if(y=q.model.columns[q._cellIndex],t.isNullOrUndefined(y)||!y.visible||0==y.allowEditing)return;q._cellEditingDetails.rowIndex="cell"===$.selectionSettings.selectionMode?this._rowIndexOfLastSelectedCell:this.selectedRowIndex(),q._cellEditingDetails.columnIndex=q._cellIndex,$.selectedItem=K[this.selectedRowIndex()],q._cellEditingDetails.columnIndex>-1&&(q.updateScrollBar(),I=y.field,"dialogEditing"==q.model.editSettings.editMode?I&&q._showTreeGridAddEditDialog():I&&q.cellEdit(q._cellEditingDetails.rowIndex,I),q._editAddTools())}else"rowediting"!=b.toLowerCase()||q._isRowEdit||"cell"==$.selectionSettings.selectionMode?"dialogediting"==b.toLowerCase()&&"cell"!=$.selectionSettings.selectionMode&&((D=q.selectedRowIndex())>=0&&q._showTreeGridAddEditDialog(D)):(D=q.selectedRowIndex())>=0&&(q.updateScrollBar(),q._editRow(D));break;case"topRowSelection":if($.allowPaging&&0==m.length&&0==h.length){if(q._isRowEdit||q.model.isEdit)return!0;K.length>0&&(E=0,K[0].isSummaryRow&&(ie=q._getNextRecord(E+1,K,i),E=K.indexOf(ie)),q._rowSelectingEventTrigger(this.selectedRowIndex(),E,!1,i)||(q.selectRows(E),q._focusTreeGridElement(),q.updateScrollBar(),q._rowSelectedEventTrigger(E,null,!1,i)))}break;case"nextPage":if(q._currentPage()<$.pageSettings.totalPages&&q.model.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&q._batchEditStarts&&!q._confirmDialog.is(":visible"))return q._batchSaveLostWarning("Paging"),q._batchTempDetails.currentPage=q._currentPage()+1,!0;$.allowPaging&&(M=q._currentPage(),q._focusTreeGridElement(),M<$.pageSettings.totalPages&&q.gotoPage(M+1));break;case"prevPage":if(1!=q._currentPage()&&q.model.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&q._batchEditStarts&&!q._confirmDialog.is(":visible"))return q._batchSaveLostWarning("Paging"),q._batchTempDetails.currentPage=q._currentPage()-1,!0;$.allowPaging&&(M=q._currentPage(),q._focusTreeGridElement(),1!=M&&q.gotoPage(M-1));break;case"bottomRowSelection":if(0==m.length&&0==h.length){if(q._isRowEdit||q.model.isEdit)return!0;K.length>0&&(K[k=K.length-1].isSummaryRow&&(ie=q._getNextRecord(k-1,K,i),k=K.indexOf(ie)),q._rowSelectingEventTrigger(this.selectedRowIndex(),k,!1,i)||(q.selectRows(k),q._focusTreeGridElement(),q.updateScrollBar(),q._rowSelectedEventTrigger(k,null,!1,i)))}break;case"firstRowSelection":if(0==m.length&&0==h.length){if(q._isRowEdit||q.model.isEdit)return!0;K.length>0&&("row"==$.selectionSettings.selectionMode?($.allowPaging&&q.gotoPage(1),$.allowSelection&&!q._rowSelectingEventTrigger(this.selectedRowIndex(),0,!1,i)&&(q.selectRows(0),q.updateScrollBar(),q._focusTreeGridElement(),q._rowSelectedEventTrigger(0,null,!1,i))):"cell"==$.selectionSettings.selectionMode&&(H={rowIndex:Z=q._focusingRowIndex,cellIndex:0},q._isShiftKeyNavigation=!1,q._cellIndex=0,q.selectCells([H])),q._cancelSaveTools())}break;case"lastRowSelection":if(0==m.length&&0==h.length){if(q._isRowEdit||q.model.isEdit)return!0;K.length>0&&((s=X[n=X.length-1]).isSummaryRow&&(s=q._getNextRecord(n-1,X,i)),$.allowPaging&&s&&(q.gotoPage($.pageSettings.totalPages),K=q._updatedPageData),o=K.indexOf(s),"row"==$.selectionSettings.selectionMode?$.allowSelection&&!q._rowSelectingEventTrigger(this.selectedRowIndex(),o,!1,i)&&(q.selectRows(o),q._focusTreeGridElement(),q.updateScrollBar(),q._rowSelectedEventTrigger(o,null,!1,i)):"cell"==$.selectionSettings.selectionMode&&(Z=q._focusingRowIndex,W=$.columns,q._isShiftKeyNavigation=!1,q._cellIndex=q._getLastVisibleColumnIndex(),H={rowIndex:Z,cellIndex:q._cellIndex},q.selectCells([H])),q._cancelSaveTools())}break;case"moveCellLeft":0==m.length&&0==h.length&&(q._isRowEdit?(ee=Q.closest("td").prev("td").length>0?Q.closest("td").prev("td")[0].cellIndex:-1,this._frozenColumnsLength>0&&e("#"+q._id+"EditForm").has(Q).length>0&&(ee+=this._frozenColumnsLength),(F=-1!=ee&&q._getPreviousElement(Q,ee)).length&&q._focusElementsForRowEdit(F)):$.editSettings.allowEditing&&"cellediting"==$.editSettings.editMode.toLowerCase()&&J.length>0&&q.editFormValidate()&&(Q.blur(),Y=q._moveCurrentCell("left")),$.allowSelection&&"cell"==$.selectionSettings.selectionMode&&!q._isRowEdit&&(0!=q._focusingRowIndex||0!=q._cellIndex)&&(q.model.isEdit?(ie=$.currentViewData[q._cellEditingDetails.rowIndex],q._focusingRowIndex=K.indexOf(ie),q._cellIndex=q._cellEditingDetails.columnIndex,H={rowIndex:q._focusingRowIndex,cellIndex:q._cellIndex},q.selectCells([H])):q._selectNextCell("left",i)));break;case"moveCellRight":0==m.length&&0==h.length&&(q._isRowEdit?(ee=-1==(ee=Q.closest("td").next("td").length>0?Q.closest("td").next("td")[0].cellIndex:-1)&&e("#"+q._id+"EditFrozenForm").has(Q).length>0?e("#"+q._id+"EditForm").find("td").eq(0).index():ee,this._frozenColumnsLength>0&&-1!=ee&&e("#"+q._id+"EditForm").has(Q).length>0&&(ee+=this._frozenColumnsLength),(O=-1!=ee&&q._getNextElement(Q,ee)).length&&q._focusElementsForRowEdit(O)):$.editSettings.allowEditing&&("cellEditing"==$.editSettings.editMode||"batchEditing"==$.editSettings.editMode||"cell"==$.selectionSettings.selectionMode)&&Q&&J.length>0&&this.editFormValidate()&&(Q.blur(),Y=q._moveCurrentCell("right")),$.allowSelection&&"cell"==$.selectionSettings.selectionMode&&!q._isRowEdit&&(q._focusingRowIndex!=q.getRows().length-1||q._cellIndex!=U-1)&&(q.model.isEdit?(ie=$.currentViewData[q._cellEditingDetails.rowIndex],q._focusingRowIndex=K.indexOf(ie),q._cellIndex=q._cellEditingDetails.columnIndex,H={rowIndex:q._focusingRowIndex,cellIndex:q._cellIndex},q.selectCells([H])):q._selectNextCell("right",i)));break;case"downArrow":if($.allowSelection)if(0==m.length&&0==h.length&&0==c.length){if(q._isRowEdit||q.model.isEdit)return!0;if(K.length>0&&$.selectedItem&&q.selectedRowIndex()>-1&&"row"==$.selectionSettings.selectionMode)n=K.length-1,q.selectedRowIndex()!=n&&(pe=K[q.selectedRowIndex()],(s=X[(o=X.indexOf(pe))+1])&&s.isSummaryRow&&(s=q._getNextRecord(o+1,X)),o=K.indexOf(s),s&&o<=n&&$.allowSelection&&!q._rowSelectingEventTrigger(this.selectedRowIndex(),o,!1,i)&&(q.selectRows(o),q.updateScrollBar(),q._focusTreeGridElement(),q._rowSelectedEventTrigger(q.selectedRowIndex(),null,!1,i))),q._cancelSaveTools();else if("cell"==$.selectionSettings.selectionMode&&q.selectedCellIndexes().length>0){var Z=q._focusingRowIndex+1,ee=q._cellIndex,te=K.length;q._isShiftKeyNavigation=!1,Z<te&&(pe=K[q._rowIndexOfLastSelectedCell],(s=X[(o=X.indexOf(pe))+1])&&s.isSummaryRow&&(s=q._getNextRecord(o+1,X)),Z=K.indexOf(s),s&&(H={rowIndex:Z,cellIndex:ee},q._focusingRowIndex=Z,q.selectCells([H]),q.updateScrollBar()))}}else m.length?q._moveToNextMenuItem("next"):c.length?g?(z=(N=u.find("div.e-columnmenuselection")).next("div.e-columnMenuListDiv")).length>0&&(N.removeClass("e-columnmenuselection"),z.addClass("e-columnmenuselection")):q._moveToNextMenuItem("next"):h.length&&(w?(z=(j=_.find("div.e-columnmenuselection")).next("div.e-columnMenuListDiv")).length>0&&(j.removeClass("e-columnmenuselection"),z.addClass("e-columnmenuselection")):(le=h.find("div.e-columnmenuselection"),(z=q._findNextColumnMenuItem(le,"next",!0)).length>0&&(le.removeClass("e-columnmenuselection"),z.addClass("e-columnmenuselection"),q._focusTreeGridElement(),q._isCloseFilterMenu=!0,q._clearFilterMenu())));break;case"rightArrow":if($.allowSelection)if(0==m.length&&0==h.length&&0==c.length){if(q._isRowEdit||q.model.isEdit)return!0;var ie=K[Z=q.selectedRowIndex()];(ue={}).data=ie,ue.recordIndex=Z,ue.expanded=!0,ie&&ie.hasChildRecords&&!ie.expanded&&q.selectedRowIndex()>=0&&(q._trigger("expanding",ue)||$.isFromGantt||t.TreeGrid.sendExpandCollapseRequest(q,ue),$.enableVirtualization&&q._focusTreeGridElement(),q.updateScrollBar()),q._cancelSaveTools(),$.allowSelection&&"cell"==$.selectionSettings.selectionMode&&(q._focusingRowIndex!=q.getRows().length-1||q._cellIndex!=U-1)&&q._selectNextCell("right",i)}else if(m.length&&!f)q._moveToNextMenuItem("expand");else if(c.length&&!g)q._moveToNextMenuItem("expand"),q._showKeyboardColumnChooser(!1,c,u,e("#contextMenu_Columns"));else if(h.length&&!w){q._showKeyboardColumnChooser(!0,h,_,e("#"+q._id+"_ColumnsChooser"));var le=h.find("div.e-columnmenuselection"),ne=(_.find("div.e-columnMenuListDiv"),q._columnListPosX,q._columnFilterPosX),oe=(q._columnChooserListIndex,e(document).width());if(le.length>0&&le[0].id==q._id+"_FilterChooser"&&!e("#"+q._id+"_ColumnMenu").find(".e-expander").hasClass("e-treegridadaptivesubicon"))if("menu"==$.filterSettings.filterType&&"excel"!=y.filterType){var re,ae=d[0].id.indexOf("_"),de="#"+d[0].id.slice(0,ae),se=e(de).ejDialog("instance"),ce=(q=this,{width:"auto",height:"auto",minWidth:"0px",minHeight:"0px",showHeader:!1,position:{X:1,Y:1},enableModal:!1,isResponsive:!1,enableResize:!1});e(de+"_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e(de).ejDialog(ce),oe<ne+e("#"+d[0].id).width()&&(ne=ne-h.width()-e("#"+d[0].id).width()),h.find("div.e-columnmenuselection").closest("li").index(),re={X:ne,Y:q._columnMenuPopupY+e("#"+q._id+"_FilterChooser").position().top},se.option({position:re}),se.open(),q._updatePreviousFilteredValue(y),d.css("z-index",q.getMaxZIndex()+1),q._focusTreeGridElement(),q._renderedSubMenuType=de+"Desktop"}else P=$.isFromGantt?e(this.element).closest(".e-gantt"):e(this.element),(A=this.getOffsetRect(P[0])).right=A.left+e(P).width(),q._openExcelFilter(y,ne,q._columnMenuPopupY,A,h.width())}break;case"leftArrow":if($.allowSelection)if(0==m.length&&0==h.length&&0==c.length){if(q._isRowEdit||q.model.isEdit)return!0;var ue;ie=K[Z=q.selectedRowIndex()];(ue={}).data=ie,ue.recordIndex=Z,ue.expanded=!1,ie&&ie.hasChildRecords&&ie.expanded&&q.selectedRowIndex()>=0&&(q._trigger("collapsing",ue)||$.isFromGantt||t.TreeGrid.sendExpandCollapseRequest(q,ue),$.enableVirtualization&&q._focusTreeGridElement(),q.updateScrollBar()),q._cancelSaveTools(),$.allowSelection&&"cell"==$.selectionSettings.selectionMode&&(0!=q._focusingRowIndex||0!=q._cellIndex)&&q._selectNextCell("left",i)}else m.length?q._moveToNextMenuItem("collapse"):c.length?(q._moveToNextMenuItem("collapse"),e("#"+q._id+"ccDiv").ejDialog("close")):h.length&&(w||C)&&(e("#"+q._id+"ccDiv").ejDialog("close"),q._isCloseFilterMenu=!0,q._clearFilterMenu());break;case"upArrow":if($.allowSelection)if(0==m.length&&0==h.length&&0==c.length){if(q._isRowEdit||q.model.isEdit)return!0;if("row"==$.selectionSettings.selectionMode&&this.selectedRowIndex()>0&&K.length>0&&$.selectedItem)pe=K[q.selectedRowIndex()],(s=X[(o=X.indexOf(pe))-1]).isSummaryRow&&(s=q._getNextRecord(o-1,X,i)),-1==(o=K.indexOf(s))||q._rowSelectingEventTrigger(this.selectedRowIndex(),o,!1,i)||(q.selectRows(o),q.updateScrollBar(),q._focusTreeGridElement(),q._rowSelectedEventTrigger(q.selectedRowIndex(),null,!1,i)),q._cancelSaveTools();else if("cell"==$.selectionSettings.selectionMode){Z=q._focusingRowIndex-1,ee=q._cellIndex,te=$.flatRecords.length;q._isShiftKeyNavigation=!1,-1!=Z&&(pe=K[q._rowIndexOfLastSelectedCell],(s=X[(o=X.indexOf(pe))-1])&&s.isSummaryRow&&(s=q._getNextRecord(o-1,X,i)),Z=K.indexOf(s),s&&(H={rowIndex:Z,cellIndex:ee},q._focusingRowIndex=Z,q.selectCells([H]),q.updateScrollBar()))}}else m.length?q._moveToNextMenuItem("prev"):c.length?g?(G=(N=u.find("div.e-columnmenuselection")).prev("div.e-columnMenuListDiv")).length>0&&(N.removeClass("e-columnmenuselection"),G.addClass("e-columnmenuselection")):q._moveToNextMenuItem("prev"):h.length&&(w?(G=(j=_.find("div.e-columnmenuselection")).prev("div.e-columnMenuListDiv")).length>0&&(j.removeClass("e-columnmenuselection"),G.addClass("e-columnmenuselection")):(le=h.find("div.e-columnmenuselection"),(G=q._findNextColumnMenuItem(le,"prev",!0)).length>0&&(le.removeClass("e-columnmenuselection"),G.addClass("e-columnmenuselection"),q._isCloseFilterMenu=!0,q._clearFilterMenu())));break;case"deleteRecord":if($.isFromGantt&&1==$.readOnly)return;if($.editSettings.allowDeleting&&0==m.length&&0==h.length){if(q._isRowEdit||q.model.isEdit)return!0;q.selectedRowIndex()>=0&&(q.deleteRow(),q._cancelSaveTools(),q._focusTreeGridElement())}break;case"totalRowCollapse":if(0==m.length&&0==h.length){q.model.isFromGantt?((ue={}).requestType="collapseAll",q._trigger("expandAllCollapseAllRequest",ue)):q.collapseAll();break}case"totalRowExpand":0==m.length&&0==h.length&&(q.model.isFromGantt?((ue={}).requestType="expandAll",q._trigger("expandAllCollapseAllRequest",ue)):q.expandAll());break;case"spaceBar":L=null,h.length&&w&&(L=(j=_.find("div.e-columnmenuselection")).data("column"),t.isNullOrUndefined(L)||j.find("span").hasClass("e-disable")||("true"==j.find("span").attr("aria-checked")?q.hideColumn(L):q.showColumn(L))),q._checkboxSelection&&Q.hasClass("e-treegrid")&&0==e("#"+q._id+"EditForm").length&&(q._rowSelectingEventTrigger(this.selectedRowIndex(),this.selectedRowIndex(),!0,i)||(q.selectRows(this.selectedRowIndex(),null,!0),q._cancelSaveTools(),q._rowSelectedEventTrigger(this.selectedRowIndex(),null,!0,i)));break;case"shiftDownArrow":if($.allowSelection&&"multiple"==$.selectionSettings.selectionType)if("cell"==$.selectionSettings.selectionMode){te=K.length;var ge,me=q._selectedCellDetails.length,pe=K[q._rowIndexOfLastSelectedCell];if((s=X[(o=X.indexOf(pe))+1])&&s.isSummaryRow&&(s=q._getNextRecord(o+1,X)),!s)return;if(ge=K.indexOf(s),q._focusingRowIndex>q._rowIndexOfLastSelectedCell){for(q._rowIndexOfLastSelectedCell=ge,q._selectedCellDetails.sort(function(e,t){return parseFloat(e.rowIndex)-parseFloat(t.rowIndex)}),q._getSelectedCellsinARow(q._selectedCellDetails[0].data.index,q._selectedCellDetails),B=0;B<q._selectedCellsinARow.length;B++)V=q._selectedCellDetails.indexOf(q._selectedCellsinARow[B]),e(q._selectedCellsinARow[B].cellElement).removeClass("e-selectingcell"),q._selectedCellDetails.splice(V,1);q.updateScrollBar()}else ge<te&&(ue={rowIndex:ge,cellIndex:q._lastSelectedCellIndex},q.updateScrollBar(),q._shiftKeySelectCells(ue),q._rowIndexOfLastSelectedCell=ge)}else q._selectedItemDown(i);break;case"shiftUpArrow":if($.allowSelection&&"multiple"==$.selectionSettings.selectionType)if("cell"==$.selectionSettings.selectionMode){if(me=q._selectedCellDetails.length,pe=K[q._rowIndexOfLastSelectedCell],(s=X[(o=X.indexOf(pe))-1])&&s.isSummaryRow&&(s=q._getNextRecord(o-1,X,"upArrow")),!s)return;if(ge=K.indexOf(s),me>0&&q._focusingRowIndex<q._rowIndexOfLastSelectedCell){for(q._rowIndexOfLastSelectedCell=ge,q._getSelectedCellsinARow(q._selectedCellDetails[me-1].data.index,q._selectedCellDetails),B=0;B<q._selectedCellsinARow.length;B++)V=q._selectedCellDetails.indexOf(q._selectedCellsinARow[B]),e(q._selectedCellsinARow[B].cellElement).removeClass("e-selectingcell"),q._selectedCellDetails.splice(V,1);q.updateScrollBar()}else ge>=0&&(ue={rowIndex:ge,cellIndex:q._lastSelectedCellIndex},q._rowIndexOfLastSelectedCell=ge,q.updateScrollBar(),q._shiftKeySelectCells(ue))}else q._selectedItemUp(i);break;case"shiftRightArrow":$.allowSelection&&"cell"==$.selectionSettings.selectionMode&&"multiple"==$.selectionSettings.selectionType&&(U=$.columns.length,(ee=q._lastSelectedCellIndex+1)<U-1&&(!$.columns[ee].visible||!$.columns[ee].allowCellSelection)&&(ee=q.getUpNextVisibleColumnIndex(ee)),ee<U&&(ue={rowIndex:q._rowIndexOfLastSelectedCell,cellIndex:ee},q._shiftKeyFirstElementDetails.firstElementRowIndex=q._focusingRowIndex,q._shiftKeySelectCells(ue),q._lastSelectedCellIndex=ee));break;case"shiftLeftArrow":$.allowSelection&&"cell"==$.selectionSettings.selectionMode&&"multiple"==$.selectionSettings.selectionType&&(-1==(ee=q._lastSelectedCellIndex-1)||$.columns[ee].visible&&$.columns[ee].allowCellSelection||(ee=q.getPreviousVisibleColumnIndex(ee)),ue={rowIndex:q._rowIndexOfLastSelectedCell,cellIndex:ee},-1!=ee&&(q._shiftKeyFirstElementDetails.firstElementRowIndex=q._focusingRowIndex,q._shiftKeySelectCells(ue),q._lastSelectedCellIndex=ee));break;case"shiftHomeButton":"cell"==$.selectionSettings.selectionMode&&"multiple"==$.selectionSettings.selectionType&&(ue={rowIndex:Z=q._rowIndexOfLastSelectedCell,cellIndex:0},q._cellIndex=0,q._lastSelectedCellIndex=0,q._shiftKeySelectCells(ue));break;case"shiftEndButton":"cell"==$.selectionSettings.selectionMode&&"multiple"==$.selectionSettings.selectionType&&(Z=q._rowIndexOfLastSelectedCell,W=$.columns,q._cellIndex=W.length-1,ue={rowIndex:Z,cellIndex:q._cellIndex},q._lastSelectedCellIndex=q._cellIndex,q._shiftKeySelectCells(ue));break;default:Y=!0}return Y},_showKeyboardColumnChooser:function(t,i,l,n){var o,r,a,d=this,s=d.model,c={};c.width="auto",c.height="auto",c.minWidth="0px",c.minHeight="0px",c.showHeader=!1,c.position={X:1,Y:1},c.enableModal=!1,c.isResponsive=!1,c.enableResize=!1,c.cssClass=s.cssClass,e("#"+d._id+"ccDiv_wrapper").addClass("e-treegridadaptivedialog"),e("#"+d._id+"ccDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e("#"+d._id+"ccDiv").ejDialog(c),e("#"+d._id+"ccDiv").css({height:"auto"});var u=i.find("div.e-columnmenuselection"),g=l.find("div.e-columnMenuListDiv"),m=d._columnListPosX,p=d._columnMenuPopupY,h=e(document).width(),_=t?i.width():d._headerContextMenuWidth;if(d._updateColumnMenuVisibility(),!(u.length>0&&u[0].id==n[0].id)||i.find(".e-expander").hasClass("e-treegridadaptivesubicon"))return!1;o=e("#"+d._id+"ccDiv").ejDialog("instance"),r=e("#"+d._id+"ccDiv_wrapper").width(),o.open(),h<m+i.width()&&(m=m-_-r),a={X:m,Y:p+n.position().top},o.option({position:a}),l.css("z-index",d.getMaxZIndex()+1),g.removeClass("e-columnmenuselection"),g.eq(0).addClass("e-columnmenuselection"),d._focusTreeGridElement(),d._renderedSubMenuType="ColumnDesktop"},_getNextElement:function(i,l){var n=this,o=n.model.columns;return i=i.closest("td").next("td"),this._frozenColumnsLength>0&&0==i.length&&(i=e("#"+n._id+"EditForm").find("td").eq(0),l=this._frozenColumnsLength),0!=i.length&&(!t.isNullOrUndefined(o[l])&&t.isNullOrUndefined(o[l].allowEditing)?i:l+1<o.length&&n._getNextElement(i,l+1))},_getPreviousElement:function(i,l){var n=this,o=n.model.columns;return i=i.closest("td").prev("td"),this._frozenColumnsLength>0&&0==i.length&&(i=e("#"+n._id+"EditFrozenForm").find("td").last()),0!=i.length&&l>-1&&(!t.isNullOrUndefined(o[l])&&t.isNullOrUndefined(o[l].allowEditing)||o[l].allowEditing?i:n._getPreviousElement(i,l-1))},_clearAllFilter:function(){var e=this,t=e.model.filterSettings.filteredColumns[0];e.model.allowFiltering=!0,e.model.filterSettings.filteredColumns=[],e.filterColumn(t.field,t.operator,"","and"),e._filteredColumnValue=[],e._filteredColumnValueID=[]},filterColumn:function(i,l,n,o,r,a){var d,s,c,u,g,m,p,h=this,_=h.model.filterSettings.filteredColumns;if(this.model.allowFiltering){if(h._batchEditStarts&&!h._confirmDialog.is(":visible"))return h._batchSaveLostWarning("Filtering"),(d=h._batchTempDetails).fieldName=i,d.filterOperator=l,d.filterValue=n,d.predicate=o,d.matchcase=r,d.actualFilterValue=a,!1;for((s={}).requestType=t.TreeGrid.Actions.Filter,s.currentFilterObject=[],Array.isArray(l)||(l=e.makeArray(l)),Array.isArray(n)||(n=e.makeArray(n)),c=!1,this._filterCollection,t.util.isNullOrUndefined(this._currentFilterColumn)&&(this._currentFilterColumn=this.getColumnByField(i)),u=0;u<l.length;u++){if(g={field:i,operator:l[u],value:n[u],matchcase:r,predicate:o,actualFilterValue:a},this._$colType="string",0==_.length&&""!==g.value)"date"!=this._$colType||"equal"!=l&&"notequal"!=l||"string"==typeof g.value?_.push(g):this._setDateFilters(g);else{if(h=this,!c){var f=t.DataManager(_),w=(new t.Query).where("field",t.FilterOperators.equal,g.field),C=f.executeLocal(w);for(m=0;m<C.length;m++)-1!=(p=e.inArray(C[m],_))&&_.splice(p,1)}""!==g.value&&("date"!=this._$colType||"equal"!=l&&"notequal"!=l||"string"==typeof g.value?_.push(g):this._setDateFilters(g))}c=!0,s.currentFilterObject.push(g)}s.filterCollection=_,s.currentFilteringColumn=i,s.fieldName=i,this.processBindings(s)&&(_.reverse().splice(0,l.length),_.reverse()),h._setFilterFieldValues(g)}},filterContent:function(e){var i,l,n,o,r=this,a=r.model.filterSettings.filteredColumns;if(!(e instanceof t.Predicate))return!1;-1!=(i=a.indexOf(e))?a.splice(i,1):(n=[],(l=[]).push(e.toJSON()),r._addPredicateObject(l,n),t.merge(a,n)),o={requestType:"filtering"},r.processBindings(o),r._setFilterFieldValues(n)},_addPredicateObject:function(e,i,l){for(var n,o,r=e.length,a=0;a<r;a++)(n=e[a]).isComplex?t.isNullOrUndefined(n.predicates)||this._addPredicateObject(n.predicates,i,n.condition):((o={}).field=n.field,o.operator=n.operator,o.value=n.value,o.matchcase=!n.ignoreCase,o.predicate=l,i.push(o))},_setFilterFieldValues:function(i){var l,n,o,r,a,d,s=this,c=s.model.filterSettings.filterType,u=[];for(t.isNullOrUndefined(i.length)?u.push(i):u=i,n=u.length,o=0;o<n;o++)r=u[o],(l=s.getColumnByField(r.field))&&("menu"==c||"excel"==c?(s.model.showColumnChooser||(a=s.getHeaderTable().find("div[data-ej-mappingname='"+r.field+"']").next(".e-filtericon"),""!=r.value.toString()||"false"==r.value.toString()?a.removeClass("e-column-filter-icon").addClass("e-column-filtered-icon"):a.removeClass("e-column-filtered-icon").addClass("e-column-filter-icon")),"menu"==c?(s._storePreviousFilteredValue(r.field,r.value,r.operator),s._filterString=r.value):s._filteredColumnValueID.push(r.field)):"filterbar"==c&&(d=s.getHeaderTable().find("#"+s._id+"_"+r.field.split(".").join("")+"_filterbarcell"),"numericedit"==l.filterEditType?e(d).ejNumericTextbox({value:r.value}):"datepicker"==l.filterEditType?e(d).ejDatePicker({value:r.value}):"datetimepicker"==l.filterEditType?e(d).ejDateTimePicker({value:r.value}):"dropdownedit"==l.filterEditType?e(d).ejDropDownList({value:r.value}):(""==d.val()||d.val()!=r.value)&&d.val(r.value)))},_cellSelectingEventTrigger:function(e){var t=this,i=(t.model,{}),l=e.rowIndex,n=e.cellIndex,o=t.getUpdatedRecords();return i.data=o[l],i.targetRow=e.rowElement,i.targetCell=e.cellElement,i.rowIndex=l,i.cellIndex=n,t._trigger("cellSelecting",i)},_cellSelectedEventTrigger:function(e,t){var i=this,l=(i.model,{}),n=e.rowIndex,o=e.cellIndex,r=t.rowIndex,a=t.cellIndex,d=i.getUpdatedRecords();return l.PreviousTargetRow=t.rowElement,l.previousTargetCell=t.cellElement,l.previousData=d[r],l.previousRowIndex=r,l.previousCellIndex=a,l.data=d[n],l.targetRow=e.rowElement,l.targetCell=e.cellElement,l.rowIndex=n,l.cellIndex=o,i._trigger("cellSelected",l)},_rowSelectingEventTrigger:function(e,i,l,n){var o,r=this,a=r.model,d={},s=r.getUpdatedRecords();return l||(l=!1),d.targetRow=t.TreeGrid.getRowByIndex(r,i),d.previousTreeGridRow=t.TreeGrid.getRowByIndex(r,e),d.data=s[i],d.previousData=s[e],d.recordIndex=i,d.previousIndex=e,d.actionType=t.isNullOrUndefined(n)?null:n,r.model.isFromGantt?d.target="ejTreeGrid":d.isCheckboxUpdate=l,(o=r._trigger("rowSelecting",d))&&(a.selectedItem=d.data),o},_rowSelectedEventTrigger:function(i,l,n,o){var r=this,a=r.model,d={},s=r.getUpdatedRecords(),c=e.extend({},s[i]);delete c.childRecords,delete c.parentItem,(d={targetRow:t.TreeGrid.getRowByIndex(r,i),recordIndex:i}).actionType=t.isNullOrUndefined(o)?null:o,n||(n=!1),t.isNullOrUndefined(l)||(d.toIndex=l),r.model.isFromGantt?(d.target="ejTreeGrid",d.data=a.updatedRecords[i],d.selectedItems=a.selectedItems):(d.data=c,d.isCheckboxUpdate=n),r._trigger("rowSelected",d)},_eventBindings:function(i){var l,n,o,r=this,a=r.model,d=0,s=r.getUpdatedRecords(),c=r.getRows();if(t.isNullOrUndefined(i)?(n=this._frozenColumnsLength>0?e(c[0]).length:e(c).length,i=a.currentViewData):n=i.length,r._commandColumnLength>0&&this._refreshUnboundTemplate(this.getContentTable()),null!=a.queryCellInfo||null!=a.rowDataBound||a.detailsDataBound)for(;d<n;d++)o=s.indexOf(i[d]),l=t.TreeGrid.getRowByIndex(this,o),r._rowEventTrigger(l,i[d])},_rowEventTrigger:function(t,i){var l,n=this,o=this.model;o.rowDataBound&&n._trigger("rowDataBound",{rowElement:t,data:i});t.cells;var r=e(t).find(".e-rowcell"),a=0,d=r.length,s=null,c=n.model.columns;if(o.queryCellInfo)for(;a<d;a++)e(r[a]).hasClass("e-rowcell")&&(s=c[a]),s&&n._cellEventTrigger(r[a],i,s);o.detailsDataBound&&e(t).next("tr").hasClass("e-detailsrow")&&(l=e(t).next("tr"),this._frozenColumnsLength>0&&(l=e(l[1])),this._trigger("detailsDataBound",{detailsElement:l,data:i}))},_cellEventTrigger:function(e,t,i){var l={cellElement:e,data:t,column:i};l.cellValue=l.column&&this._getCustomCellValue(t,l.column.field),this._trigger("queryCellInfo",l)},_completeAction:function(i){var l,n,o=this,r=o.model,a=r.sortSettings.sortedColumns,d=e("#"+o._id.replace("ejTreeGrid","")).data("ejGantt");if(r.isEdit=!1,r.allowPaging&&i.requestType!=t.TreeGrid.Actions.Scroll&&this._refreshGridPager(),t.TreeGrid.Actions.Sorting==i.requestType&&r.allowSorting||t.TreeGrid.Actions.Refresh==i.requestType){if(r.allowSorting)for(o._multiSortRequest||(o.getHeaderTable().find(".e-columnheader").find(".e-headercelldiv").find(".e-ascending,.e-descending").remove(),o.getHeaderTable().find("[aria-sort]").removeAttr("aria-sort")),l=0;l<a.length;l++)o._addSortElementToColumn(a[l].field,a[l].direction);o._multiSortRequest=!1}else t.TreeGrid.Actions.BeginEdit==i.requestType||t.TreeGrid.Actions.Add==i.requestType?(n=e("#"+o._id+"EditForm"),o.model.isEdit=!0,o.setWidthToColumns(),t.TreeGrid.Actions.Add==i.requestType&&n.find(".e-field:disabled").not(".e-identity").removeAttr("disabled").removeClass("e-disable"),e.isFunction(e.validator)&&this._initValidator()):r.isFromGantt&&i.requestType===t.TreeGrid.Actions.Scroll&&o._updateCurrentViewData();r.isFromGantt&&(d.model.sortSettings=r.sortSettings),(o._moveRow||"batchediting"==r.editSettings.editMode.toLowerCase())&&i.requestType!==t.TreeGrid.Actions.Refresh||o._trigger("actionComplete",i)},sendDataRenderingRequest:function(i){var l,n,o,r,a,d,s,c,u=this,g=this.model;if(u.model.currentViewData.length)switch(i.requestType){case t.TreeGrid.Actions.Delete:case t.TreeGrid.Actions.Refresh:case t.TreeGrid.Actions.Save:case t.TreeGrid.Actions.Filter:case t.TreeGrid.Actions.Sorting:case t.TreeGrid.Actions.Searching:case t.TreeGrid.Actions.ExpandCollapse:case t.TreeGrid.Actions.RefreshDataSource:case t.TreeGrid.Actions.DragAndDrop:case t.TreeGrid.Actions.Paging:case t.TreeGrid.Actions.Scroll:case t.TreeGrid.Actions.RowIndexUpdate:if(l=document.createElement("div"),i.requestType!=t.TreeGrid.Actions.Scroll)this._frozenColumnsLength>0?u._renderFrozenRecords():(u.getContentTable().find("colgroup").first().replaceWith(u._getMetaColGroup()),(m=u.getContentTable().children("tbody")).empty(),l.innerHTML=["<table>",e.render[u._id+"_Template"](u.model.currentViewData),"</table>"].join(""),u.getContentTable().get(0).replaceChild(l.firstChild.firstChild,u.getContentTable().get(0).lastChild),u.setGridRows(e(u.getContentTable().get(0).rows)));else{var m=u.getContentTable().children("tbody"),p=u.model.currentViewData,h=u._visibleRange,_=this._frozenColumnsLength>0?e(m[0]).children("tr:not(.e-detailsrow)").length:m.children("tr:not(.e-detailsrow)").length,f=!1;0!=p.length&&0!=m.find(".e-emptyText").length&&m.find(".e-emptyText").remove(),u._scrollTop>u._prevScrollTop?(n=h.top-u._prevRTop,(o=h.bottom-u._prevRBottom)>=0?r=o?p.slice(-o):[]:(this._frozenColumnsLength>0?(e(m.get(0)).children(":visible:gt("+(_+(o-1))+")").remove(),e(m.get(1)).children(":visible:gt("+(_+(o-1))+")").remove()):g.showDetailsRow&&!g.showDetailsRowInfoColumn?(a=2*(_+(o-1)),m.children(":visible:gt("+a+")").remove()):m.children(":visible:gt("+(_+(o-1))+")").remove(),r=[]),f=!0):(n=_-(u._prevRBottom-h.bottom+1),r=(o=u._prevRTop-h.top)>=0?p.slice(0,o):[],n=n>=0?n:-_-1,f=!1),this._frozenColumnsLength>0?u._renderFrozenRecords(r,o,n,f):(u.getContentTable().find("colgroup").first().replaceWith(u._getMetaColGroup()),f?(g.showDetailsRow&&!g.showDetailsRowInfoColumn?(a=2*n,m.children(":visible:lt("+a+")").remove()):m.children(":visible:lt("+n+")").remove(),d=e.render[u._id+"_Template"](r),m.append(d)):(g.showDetailsRow&&!g.showDetailsRowInfoColumn?(a=2*n+1,m.children(":visible:gt("+a+")").remove()):m.children(":visible:gt("+n+")").remove(),d=e.render[u._id+"_Template"](r),m.prepend(d)),u._gridRows=u.getContentTable().find("tr"),u.setGridRows(u._gridRows))}this._gridRows=this.getContentTable().get(0).rows,this._frozenColumnsLength>0&&(this._gridRows=[this._gridRows,this.getContentTable().get(1).rows]),u._$gridContent&&u._isRendered&&(u._trigger("refresh"),u._eventBindings(r),this._hideCollapsedDetailsRows())}else u._frozenColumnsLength>0?(s=t.buildTag("td",g.emptyRecordText,{},{colSpan:this._frozenColumns.length}),c=document,u.getContent().find("#e-frozencontentdiv"+u._id+" .e-table tbody").empty().append(e(c.createElement("tr")).addClass("e-emptyText").height(30).append(s)),s=t.buildTag("td",g.emptyRecordText,{visibility:"hidden"},{colSpan:this._unFrozenColumns.length}),u.getContent().find("#e-movablecontentdiv"+u._id+" .e-table tbody").empty().append(e(c.createElement("tr")).addClass("e-emptyText").height(30).append(s)),0==g.updatedRecords.length&&u._$gridContainer.find("#e-movablecontentdiv"+u._id+",#e-frozencontentdiv"+u._id).css("height","30px")):(u.getContentTable().find("tbody").empty().append(u._getEmptyTbody()),0==g.updatedRecords.length&&u._$gridContainer&&u._$gridContainer.css({height:"30px"})),u._gridRows=null,u.setGridRows(null);(u.model.showGridCellTooltip||u.model.showGridExpandCellTooltip)&&(u._cellMouseLeave(),u._headerMouseLeave()),i.requestType==t.TreeGrid.Actions.Scroll&&(i.requestType,t.TreeGrid.Actions.Refresh),u._completeAction(i)},_renderFrozenRecords:function(i,l,n,o){var r,a,d,s,c;this.getContent().find("#e-frozencontentdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[0]),this.getContent().find("#e-movablecontentdiv"+this._id+" .e-table colgroup").replaceWith(this._getMetaColGroup()[1]),r=this.getContentTable().children("tbody"),t.isNullOrUndefined(i)?(r.empty(),(a=document.createElement("div")).innerHTML=["<table>",e.render[this._id+"_JSONFrozenTemplate"](this.model.currentViewData),"</table>"].join(""),this.getContentTable().get(0).replaceChild(a.firstChild.firstChild,this.getContentTable().get(0).lastChild),(a=document.createElement("div")).innerHTML=["<table>",e.render[this._id+"_Template"](this.model.currentViewData),"</table>"].join(""),this.getContentTable().get(1).replaceChild(a.firstChild.firstChild,this.getContentTable().get(1).lastChild)):o?(this.model.showDetailsRow&&!this.model.showDetailsRowInfoColumn?(d=2*n,e(r.get(0)).children(":visible:lt("+d+")").remove(),e(r.get(1)).children(":visible:lt("+d+")").remove()):(e(r.get(0)).children(":visible:lt("+n+")").remove(),e(r.get(1)).children(":visible:lt("+n+")").remove()),s=e.render[this._id+"_JSONFrozenTemplate"](i),c=e.render[this._id+"_Template"](i),e(r.get(0)).append(s),e(r.get(1)).append(c)):(this.model.showDetailsRow&&!this.model.showDetailsRowInfoColumn?(d=2*n+1,e(r.get(0)).children(":visible:gt("+d+")").remove(),e(r.get(1)).children(":visible:gt("+d+")").remove()):(e(r.get(0)).children(":visible:gt("+n+")").remove(),e(r.get(1)).children(":visible:gt("+n+")").remove()),s=e.render[this._id+"_JSONFrozenTemplate"](i),c=e.render[this._id+"_Template"](i),e(r.get(0)).prepend(s),e(r.get(1)).prepend(c)),this.setGridContentTable(this.getContent().find(".e-table"))},_renderByFrozenDesign:function(){var i=e(document.createElement("div")),l=this._getMetaColGroup().find("col"),n={};return n.colgroup1=i.append(t.buildTag("colgroup").append(l.splice(0,this._frozenColumnsLength))).html(),n.colgroup2=i.html(t.buildTag("colgroup").append(l)).html(),e.render[this._id+"_FrozenTemplate"](n)},addFrozenTemplate:function(){var t="<div class='e-frozencontainer' id='e-frozencontainer"+this._id+"' style='overflow:hidden;float:left;'><div class='e-frozencontentdiv' id='e-frozencontentdiv"+this._id+"' style='width:100%;'><table class='e-table e-zerospace' style='width:100%' id='"+this._id+"frozene-table'>{{:colgroup1}}<tbody></tbody></table></div></div><div class='e-movablecontainer' id='e-movablecontainer"+this._id+"'><div class='e-movablecontent' id='e-movablecontent"+this._id+"'><div class='e-movablecontentdiv' id='e-movablecontentdiv"+this._id+"'><table class='e-table e-zerospace' id='"+this._id+"movablee-table'>{{:colgroup2}}<tbody></tbody></table></div></div></div>",i={};i[this._id+"_FrozenTemplate"]=t,e.templates(i)},sortSetting:function(t){var i,l=this,n=this.model,o=e("#"+l._id).find(".e-ascending.e-icon"),r=e("#"+l._id).find(".e-descending.e-icon");if(n.allowSorting=t,n.allowSorting||l.clearSorting(),o.length>0)for(i=0;i<o.length;i++)e(o[i]).css("visibility","hidden");if(r.length>0)for(i=0;i<r.length;i++)e(r[i]).css("visibility","hidden")},columnIndex:function(e){var t=this,i=t.model,l=(e=parseInt(e),i.columns);if(!isNaN(e)&&e>=0&&e<l.length&&l[e].visible&&!t._isCommandColumn(l[e])){if(l[e].nonColumn){if(!l[e+1]||!l[e+1].visible||t._isCommandColumn(l[e+1]))return;i.treeColumnIndex=e+1}else i.treeColumnIndex=e;t._addInitTemplate(),this.renderRecords(),i.showColumnChooser&&t._renderColumnChooserList(!0),t._updateWrapRowHeights("header","refreshAll")}},sortColumn:function(e,l){var n,o=this,r=o.model,a=r.sortSettings.sortedColumns,d={},s=0,c=a.length;if(o._cancelEditState(),o.clearSelection(),r.isFromGantt&&(n=t.TreeGrid.getColumnByMappingName(r.columns,e)),t.isNullOrUndefined(n)&&(n=this.getColumnByField(e)),r.allowSorting&&!t.isNullOrUndefined(n)&&0!=n.allowSorting){for(o._multiSortRequest||(r.sortSettings.sortedColumns=[]),d.requestType=t.TreeGrid.Actions.Sorting,d.columnName=e,o._cSortedColumn=e,o._cSortedDirection=d.columnSortDirection=l===i?t.sortOrder.Ascending:l;s<c;s++)if(a[s].field==o._cSortedColumn){a.splice(s,1);break}r.sortSettings.sortedColumns.push({field:o._cSortedColumn,direction:o._cSortedDirection}),o.processBindings(d)&&(o._cSortedDirection=o._cSortedColumn=null),o.selectedRowIndex()>=0&&o._isRendered&&o.selectedRowIndex(o._sortedRecords.indexOf(this.selectedItem())),o._clearColumnMenu(),o._clearContextMenu()}},clearSorting:function(){var e;this.model.sortSettings.sortedColumns=[],(e={}).requestType=t.TreeGrid.Actions.Sorting,this.processBindings(e)},deleteRow:function(i,l,n){var o,r,a=this,d=a.model,s=d.editSettings.editMode.toLowerCase(),c=a.getUpdatedRecords(),u=[];if(!d.editSettings.allowDeleting)return!1;if(d.editSettings.showDeleteConfirmDialog&&!a._confirmDialog.is(":visible")&&"batchediting"!=s&&!a._isEmptyRow)return a._isFromContextmenu=l,a._deleteRowIndex=n,void a._confirmDialog.ejDialog("open");if((o={}).requestType=t.TreeGrid.Actions.Delete,o.isFromContextmenu=l,l){if(o.data=d.isFromGantt?c[n]:!d.allowSelection&&!t.isNullOrUndefined(n)&&n>-1?c[n]:"row"==d.selectionSettings.selectionMode?d.selectedItem:a._rowIndexOfLastSelectedCell>-1?c[a._rowIndexOfLastSelectedCell]:c[a._emptyRowIndex],u.push(o.data),a._isEmptyRow)return o.deletedItems=u,a._updateDeleteAction(o),!0}else u=e.extend([],d.selectedItems),o.data=d.selectedItem;if(u.length||u.push(o.data),o.deletedItems=u,"batchediting"==s)if("save"==a._batchSaveCancel)o.data={},o.deletedItems=a.batchChanges.deleted;else{if("cancel"!=a._batchSaveCancel){for(r=0;r<u.length;r++)a._batchDeleteAction(u[r]),a._updateBatchDeletedRecords(u[r]);return a.clearSelection(),a._batchEditStarts=!0,a._cancelSaveTools(),!0}o.data={},o.deletedItems=a.batchChanges.added}if(a._trigger("actionBegin",o))return!0;a._updateAction(o)&&a._updateDeleteAction(o)},_batchDeleteAction:function(e){var t,i,l=this,n=l.model,o=(n.allowPaging?l._updatedPageData:n.updatedRecords).indexOf(e);if(e.isBatchDelete=!0,l.refreshRow(o),e.hasChildRecords)for(t=e.childRecords,i=0;i<t.length;i++)this._batchDeleteAction(t[i])},_updateBatchDeletedRecords:function(e){var t=this,i=t.batchChanges.changed,l=t.batchChanges.added;l.length>0&&-1!=l.indexOf(e)?l.splice(l.indexOf(e),1):i.length>0&&-1!=i.indexOf(e)&&i.splice(i.indexOf(e),1),-1==t.batchChanges.deleted.indexOf(e)&&t.batchChanges.deleted.push(e)},_updateDeleteAction:function(e){for(var i=this,l=i.model,n=l.editSettings.editMode.toLowerCase(),o=e.deletedItems.length,r=0;r<o;r++)e.data=e.deletedItems[r],i._selectedCellDetails=[],i._removeRecords(e);if("batchediting"==n&&("save"==i._batchSaveCancel||"cancel"==i._batchSaveCancel))return!0;i._ensureDataSource(e),i.updateHeight(),l.currentViewData.length>0&&l.enableAltRow&&t.TreeGrid.updateAltRow(i,l.currentViewData[0],0,0),i._checkboxSelection?(l.selectedCellIndexes=[],i._prevSelectedItem=null,e.isFromContextmenu||(l.selectedItems=[]),l.selectedItem=null,i.selectedRowIndex(-1),i.selectAllRows()):(l.selectedItems=[],l.selectedCellIndexes=[],l.selectedItem=null,i.selectedRowIndex(-1),i._prevSelectedItem=null,i._multiSelectPopup&&i._multiSelectPopup.is(":visible")&&!i.model.isFromGantt&&i._clearMultiSelectPopup()),i._isLoadonDemand&&l.allowPaging&&i._refreshDataSource()},_removeRecords:function(e){var i,l,n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C=this,x=C.model,v=x.editSettings.editMode.toLowerCase(),S=!1,R=this.dataSource();if(e&&(x.editSettings.allowDeleting||e.isDragAndDropDelete)&&e.requestType===t.TreeGrid.Actions.Delete){if(i=e.data,x.isFromGantt&&C.model.enableWBS&&(a=!1,i&&i.parentItem?r=(o=i.parentItem.childRecords).indexOf(i):x.flatRecords.length&&(r=(o=x.flatRecords.filter(function(e){return e&&0==e.level})).indexOf(i)),r!=o.length-1&&(a=!0)),l=x.flatRecords.indexOf(i),"resourceView"==x.viewType&&(d={data:e.data},C._trigger("updateResource",d),C.dataSource(d.returnObj.dataSource),C._jsonData=d.returnObj.jsondata,d.returnObj.tasks.length>0&&(S=!0)),i.parentItem&&((s=i.parentItem.childRecords)&&s.length>0)){for(c=s.indexOf(i),i.parentItem.childRecords.splice(c,1),e.updatedHierarchyRowIndexData=[],p=c;p<s.length;p++)s[p].hierarchyRowIndex=p,x.hierarchyRowIndexMapping&&(s[p].item[x.hierarchyRowIndexMapping]=p),i.isBatchAdd||("batchediting"!=v?e.updatedHierarchyRowIndexData.push(s[p]):-1==C.batchChanges.updatedHierarchyRowIndexData.indexOf(s[p])&&C.batchChanges.updatedHierarchyRowIndexData.push(s[p]));x.showSummaryRow&&((u=x.summaryRows.length)==s.length&&(i.parentItem.childRecords.splice(0,u),x.flatRecords.splice(l,u))),x.parentIdMapping||"resourceView"==x.viewType||i.parentItem.item[x.childMapping].splice(c,1)}if(C._checkboxSelection&&!e.isDragAndDropDelete)if(e.isFromContextmenu)C._removeChildRecords(x.selectedItems,e.data);else for(;x.selectedItems.length>0;)C._removeChildRecords(x.selectedItems,x.selectedItems[0]);if(-1!==(g=x.parentRecords.indexOf(i)))for(x.parentRecords.splice(g,1),m=x.parentRecords,e.updatedHierarchyRowIndexData=[],p=g;p<m.length;p++)m[p].hierarchyRowIndex=p,x.hierarchyRowIndexMapping&&(m[p].item[x.hierarchyRowIndexMapping]=p),i.isBatchAdd||("batchediting"!=v?e.updatedHierarchyRowIndexData.push(m[p]):-1==C.batchChanges.updatedHierarchyRowIndexData.indexOf(m[p])&&C.batchChanges.updatedHierarchyRowIndexData.push(m[p]));-1!==l&&(h=C.getChildCount(i,0),x.flatRecords.splice(l,h+1),x.ids&&x.ids.splice(l,h+1),S&&(x.flatRecords.push.apply(x.flatRecords,d.returnObj.tasks),x.ids&&x.ids.push.apply(x.ids,d.returnObj.ids),x.parentRecords.push.apply(x.parentRecords,d.returnObj.tasks)),"resourceView"==x.viewType&&"resourceTask"==i.eResourceTaskType&&i.parentItem&&0==i.parentItem.childRecords.length&&(_=x.flatRecords.indexOf(i.parentItem),x.flatRecords.splice(_,1),x.ids&&x.ids.splice(_,1),-1!=(_=x.parentRecords.indexOf(i.parentItem))&&x.parentRecords.splice(_,1))),x.updatedRecords=x.enableVirtualization?C.getExpandedRecords(x.flatRecords):x.flatRecords.slice(),C.updateCollapsedRecordCount(),x.parentIdMapping||"resourceView"==x.viewType?"resourceView"!=x.viewType&&(i.hasChildRecords&&i.childRecords.length>0&&C._removeChildItem(i),R instanceof t.DataManager?R.dataSource.offline&&R.dataSource.json?-1!==(f=R.dataSource.json.indexOf(i.item))&&R.dataSource.json.splice(f,1):C._isDataManagerUpdate&&(-1!==(f=C._jsonData.indexOf(i.item))&&C._jsonData.splice(f,1)):-1!==(f=R.indexOf(i.item))&&R.splice(f,1)):R instanceof t.DataManager?R.dataSource.offline&&R.dataSource.json?-1!==(n=R.dataSource.json.indexOf(i.item))&&R.dataSource.json.splice(n,1):C._isDataManagerUpdate&&(n=C._jsonData.indexOf(i.item),C._jsonData.splice(n,1)):-1!==(n=R.indexOf(i.item))&&R.splice(n,1),i.parentItem&&i.parentItem.childRecords&&0==i.parentItem.childRecords.length&&(i.parentItem.expanded=!1,i.parentItem.hasChildRecords=!1,i.parentItem.hasFilteredChildRecords=!0),x.showSummaryRow&&C._updateSummaryRow(e),x.showTotalSummary&&C._updateTotalSummaryRow(e),a&&(i.parentItem?w=o[r]:(o.splice(r,1),w=o[r]),C.updateWBSdetails(w)),x.isFromGantt&&(C.updateSerialNumber(l),x.enableSerialNumber&&C.updateSerialNumberPredecessors(l))}},updateSerialNumberPredecessors:function(e){var t,i,l,n,o,r,a,d;if(-1!=e){var s,c=this.model.flatRecords,u=c.length,g=[];for(t=e;t<u;t++)if(c[t].predecessor)for(i=c[t].predecessor,l=c[t].taskId,n=0;n<i.length;n++)i[n].to&&((o=+i[n].to!=l?+i[n].to:null)&&-1==g.indexOf(o)&&g.push(o));if(g.length)for(r=(s=c.filter(function(e){if(g.indexOf(e.taskId)>-1)return e})).length,a=0;a<r;a++)d=s[a],this.predecessorToSerialPredecessor(d)}},predecessorToSerialPredecessor:function(t){for(var i,l,n,o,r,a,d,s=this.model.flatRecords,c=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),u=t.predecessorsName?t.predecessorsName.split(","):[],g=null,m=0;m<u.length;m++)d=(a=u[m]).split("+"),a.indexOf("-")>=0&&(d=a.split("-")),(i=d[0].match(/(\d+|[A-z]+)/g))&&i.length&&(l=+i[0],n=i[1],(r=(o=s.filter(function(e){return e&&e.taskId==l}))[0]&&o[0].serialNumber+n+(d[1]?"+"+d[1]:""))&&(g=g?g+","+r:r));t.serialNumberPredecessor=g,t.item.serialNumberPredecessor=g,c.refreshGanttRecord(t)},updateWBSdetails:function(e){var t,i,l,n,o,r,a,d=this.model,s=e,c=s.WBS;s.parentItem?(i=(t=s.parentItem.childRecords).indexOf(s),o=(n=t).length):d.flatRecords.length&&(i=(n=d.flatRecords.filter(function(e){return e&&0==e.level})).indexOf(s),o=n.length),(l=n.slice(i,o)).length&&(r=-1!=c.lastIndexOf(".")?parseInt(c.substr(c.lastIndexOf(".")+1)):parseInt(c),a=s.parentItem?s.parentItem.WBS:null,r--,this.reCalculateWBS(l,r,a))},reCalculateWBS:function(t,i,l){var n,o,r=this,a=r.model,d=(a.currentViewData,e("#"+r._id.replace("ejTreeGrid","")).data("ejGantt")),s="";if(l)for(o=0;o<t.length;o++)n=i+o,s=t[o].WBS,t[o].WBS=l+"."+n,t[o].item.WBS=l+"."+n,a.enableWBSPredecessor&&r._getPredecessorIds(t[o]),s!=t[o].WBS&&d.refreshGanttRecord(t[o]),t[o].hasChildRecords&&r._updateChildWBS(t[o]);else for(o=0;o<t.length;o++)n=(i+o).toString(),s=t[o].WBS,t[o].WBS=n,t[o].item.WBS=n,a.enableWBSPredecessor&&r._getPredecessorIds(t[o]),s!=t[o].WBS&&d.refreshGanttRecord(t[o]),t[o].hasChildRecords&&r._updateChildWBS(t[o])},_updateChildWBS:function(t){for(var i=this,l=i.model,n=(l.currentViewData,t.childRecords),o=t.WBS,r=e("#"+i._id.replace("ejTreeGrid","")).data("ejGantt"),a="",d=0;d<n.length;d++)a=n[d].WBS,n[d].WBS=o+"."+(d+1),n[d].item.WBS=o+"."+(d+1),l.enableWBSPredecessor&&i._getPredecessorIds(n[d]),a!=n[d].WBS&&r.refreshGanttRecord(n[d]),n[d].hasChildRecords&&i._updateChildWBS(n[d])},_getPredecessorIds:function(e){for(var t=this,i=t.model,l=e.taskId,n=i.flatRecords,o=i.updatedRecords,r=n.filter(function(e){var t,i;if(e.predecessorsName)for(t=e.predecessorsName.split(","),i=0;i<t.length;i++)if(+t[i].match(/(\d+|[A-z]+)/g)[0]==l)return e}),a=0;a<r.length;a++)t.updateWBSPredecessor(r[a]),t.refreshRow(o.indexOf(r[a]))},updateSerialNumber:function(t){var i,l;if(-1!=t){var n=this.model.flatRecords,o=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt");for(i=t;i<n.length;i++)(l=n[i]).serialNumber=i+1,l.item.serialNumber=i+1,o.refreshGanttRecord(l,null,!0)}},search:function(e){var i=this,l={},n=i.model.searchSettings;i.model.allowSearching&&(l.requestType=t.TreeGrid.Actions.Searching,l.keyValue=e,i._searchString=e,""!=e?(n.key=e.toLowerCase()==this.localizedLabels.trueText.toLowerCase()?"true":e.toLowerCase()==this.localizedLabels.falseText.toLowerCase()?"false":e,n.fields=0!=this.model.searchSettings.fields.length?this.model.searchSettings.fields:this.getColumnFieldNames()):(n.key="",n.fields=[]),i.processBindings(l))},endEdit:function(){var e=this,t=e.model;return"cellediting"!=e.model.editSettings.editMode.toLowerCase()||e._isRowEdit?"dialogediting"!=e.model.editSettings.editMode.toLowerCase()&&("batchediting"!=t.editSettings.editMode.toLowerCase()||"dialog"!=t.editSettings.batchEditSettings.editMode)||e.saveRow():!this.editFormValidate()||e.saveCell()},updateReadOnly:function(e){this.model.readOnly=e},updateShowGridExpandCellTooltip:function(e){this.model.showGridExpandCellTooltip=e,this.refreshContent()},updateShowGridCellTooltip:function(e){this.model.showGridCellTooltip=e,this.refreshContent()},getVisibleRange:function(e){var t,i,l,n,o,r,a=this,d=this.model,s=d.rowHeight+a._detailsRowHeight,c=a._isHierarchyFiltering&&a.model.enableVirtualization?a._updateFilterParent:a.getUpdatedRecords();if("auto"!=d.sizeSettings.height||(a._viewPortHeight=a._getViewPortHeight(),0==a._viewPortHeight))return d.allowTextWrap?(l=(o=a._getVisibleTextWrapRows(a._scrollTop)).top,"scroll"==e&&a._scrollTop>a._prevScrollTop&&(o.bottom=o.bottom+4),i=o.bottom,a._offset=o.offSet):"resourceView"==d.viewType?(l=(r=this._getVisibleRangeForResourceGantt(a._scrollTop)).top,i=r.bottom,a._offset=r.topOffset):(l=a._scrollTop/s,i=a._getRowPosition(a._scrollTop+a._viewPortHeight),n=l-Math.floor(l),a._offset=n*s),t=Math.floor(l),t=Math.max(0,t),i=Math.min(c.length,i),a._visibleRange={top:t,bottom:i},a._visibleRange;a._visibleRange={top:0,bottom:a.getExpandedRecords(a.getUpdatedRecords()).length}},_getVisibleRangeForResourceGantt:function(e){for(var i,l,n,o={},r=this.model,a=e+this._viewPortHeight,d=0,s=e,c=r.updatedRecords,u=0;u<c.length&&(d=this._getTemplateRowHeight(c[u]),0==s&&t.isNullOrUndefined(i)?(i=0,l=0):e<0&&t.isNullOrUndefined(i)&&(i=u-1,l=this._getTemplateRowHeight(c[i])- -1*e),a<=0&&t.isNullOrUndefined(n)&&(n=u),e-=d,a-=d,t.isNullOrUndefined(i)||t.isNullOrUndefined(n));u++);return o.top=i,o.topOffset=l,o.bottom=t.isNullOrUndefined(n)?c.length:n,o},_getVisibleTextWrapRows:function(e){var t,i,l=this,n=this.model,o=0,r=0,a=0,d=!0,s=0,c=!0,u=0,g=0;for(n.allowPaging?(t=l._updatedPageData,o=l._updatedPageData.length):o=(t=n.updatedRecords).length,i=0;i<o;i++)if(s+=t[i].textWrapRowHeight,n.detailsTemplate&&!n.showDetailsRowInfoColumn&&(t[i].isSummaryRow||(s+=l._detailsRowHeight)),s>=e&&d&&(a=i,r=parseInt(e)-parseInt(s-t[i].textWrapRowHeight),d=!d),d||(g+=t[i].textWrapRowHeight),s>=e+l._viewPortHeight&&c||c&&i==t.length-1){u=i+1,c=!c;break}return g<l._viewPortHeight&&(a=parseInt((l._viewPortHeight-g)/n.rowHeight)>0?a-parseInt((l._viewPortHeight-g)/n.rowHeight):a-1),{top:a,offSet:r,bottom:u}},_getAvgTextWrapRowHeight:function(i,l){var n,o={};if(this.getRows().length>0){var r,a,d,s=this,c=this.model,u=0,g=!1,m=0,p=c.currentViewData;if(c.allowPaging?c.allowPaging&&(a=s._updatedPageData):a=c.updatedRecords,d=e("#"+s._id).find(".e-frozencontainer").length>0?c.showDetailsRow&&c.detailsTemplate&&!c.showDetailsRowInfoColumn?s.getTreeGridRows()[0]:s.getRows()[0]:c.showDetailsRow&&c.detailsTemplate&&!c.showDetailsRowInfoColumn?s.getTreeGridRows():s.getRows(),r="updateHeight"==i&&t.isNullOrUndefined(l)?a.length:"updateHeight"!=i||t.isNullOrUndefined(l)?d.length:l,d.length>0)for(n=0;n<r;n++)"getAvgHeight"==i?(p[u=s.getIndexByRow(d[n])]&&(p[u].textWrapRowHeight!=e(d[n]).height()&&e(d[n]).height()>=c.rowHeight&&(p[u].textWrapRowHeight=e(d[n]).height()),a.indexOf(p[u])>a.length-5&&!s._textWrapNoCalculate&&(g=!0)),m+=e(d[n]).height()):"updateHeight"==i&&(m+=a[n].textWrapRowHeight);"getAvgHeight"==i?o={avgHeight:m/=r,isEnd:g}:o={height:m}}else o={avgHeight:this.model.rowHeight,isEnd:!0,height:this.model.rowHeight};return o},_setWidthToHeaders:function(){var t,i,l,n,o=this._gridWidth;if(this._frozenColumnsLength>0){for(t=0,l=this.getHeaderContent().find(".e-headercell"),n=0;n<this.columnsWidthCollection.length;n++)t+=this.columnsWidthCollection[n],this._frozenColumnsLength-1==n&&(i=Math.ceil(t)),this.model.headerTextOverflow&&e(l[n]).css({width:this.columnsWidthCollection[n]+"px"});this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).width(o).next().css("margin-left",i+"px"),this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).outerWidth(i).end().find("#e-movableheaderdiv"+this._id).css("width","100%")}},setWidthToColumns:function(){for(var i,l,n,o=this,r=o.model,a=o.getContentTable().children("colgroup").find("col"),d=o.getHeaderTable().children("colgroup").find("col"),s=o._gridWidth,c=r.columns.length,u=0;u<d.length;u++)t.isNullOrUndefined(o.columnsWidthCollection[u])||(a.eq(u).width(o.columnsWidthCollection[u]),d.eq(u).width(o.columnsWidthCollection[u]));r.isFromGantt||(a.length>c&&a.eq(c).width(o._detailsColumnWidth),d.length>c&&d.eq(c).width(o._detailsColumnWidth)),r.showTotalSummary&&this._$totalSummaryRowContainer&&(i=e(this.getHeaderTable()).find("colgroup"),l=e(i).clone(),this._frozenColumnsLength>0?this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(l[0]).prependTo(this._$footertableContent[0]),e(l[1]).prependTo(this._$footertableContent[1])):this._$footertableContent&&(e(this._$footertableContent).find("colgroup").remove(),e(l).prependTo(this._$footertableContent))),this._frozenColumnsLength>0&&((n=this._getFrozenColumnWidth())<this._gridWidth&&(this.getContent().find("#e-movablecontainer"+this._id).css("margin-left",n+"px"),this.getContent().find("#e-frozencontainer"+this._id).outerWidth(n),this.getScrollElement().data("ejScroller")&&(this.getScrollElement().ejScroller("option","width",this._gridWidth-n-this._totalBorderWidth-1),this.getScrollElement().ejScroller("option","scrollTop",o._scrollTop),this.getScrollElement().ejScroller("option","scrollLeft",o._scrollLeft)),this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).next().css("margin-left",n+"px"),this.getHeaderContent().find("#e-frozenheaderdiv"+this._id).outerWidth(n).end().find("#e-movableheaderdiv"+this._id).css("width","100%"),this._$totalSummaryRowContainer&&(this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).width(s).next().css("margin-left",n+"px"),this._$totalSummaryRowContainer.find("#e-frozenfooterdiv"+this._id).outerWidth(n).end().find("#e-movablefooterdiv"+this._id).css("width","100%"),this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this._$totalSummaryRowContainer.find("#e-movablefooter"+this._id).css("margin-left","auto")),this.mobileDevice()||"safari"!=this.getBrowserDetails().browser||this.getHeaderContent().find("#e-movableheader"+this._id).add(this.getContent().find("#e-movablecontainer"+this._id)).css("margin-left","auto"))),r.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||r.isFromGantt||this._updateTableWidth()},_updateTableWidth:function(t){for(var i,l,n,o=0,r=this.model,a=this._getFrozenColumnWidth(),d=r.columns.length,s=0;s<d;s++)(r.columns[s].isFrozen||0!=r.columns[s].visible)&&(o+=r.columns[s].width);this._frozenColumnsLength>0?(o-=a,i=e(this.getHeaderTable()[1]),l=e(this.getContentTable()[1]),n=r.showTotalSummary?e(this._$footertableContent[1]):null):(i=this.getHeaderTable(),l=this.getContentTable(),n=r.showTotalSummary?e(this._$footertableContent[0]):null),r.showDetailsRow&&r.showDetailsRowInfoColumn&&r.detailsTemplate&&(o+=this._detailsColumnWidth),t||(i.width(o),l.width(o),n&&n.width(o)),o<this._gridWidth-a&&r.columns[d-1].visible?(i.addClass("e-tableLastCell"),r.currentViewData.length>0?l.addClass("e-tableLastCell"):l.removeClass("e-tableLastCell"),l.addClass("e-fixed-border")):(i.removeClass("e-tableLastCell"),l.removeClass("e-tableLastCell"),l.removeClass("e-fixed-border"))},_convertHtml:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},cellEdit:function(i,l){var n,o,r,a,d=this,s=d.model,c=i,u=d.getUpdatedRecords();if(o=1==s.allowSelection?"row"==s.selectionSettings.selectionMode?this.selectedItem():u[d._rowIndexOfLastSelectedCell]:this.selectedItem(),d.model.showGridCellTooltip&&d._cellMouseLeave(),d.model.isEdit&&d.saveCell(),e("#"+d._id+"EditForm").length>0)return!0;if(!o||s.isFromGantt&&o.hasChildRecords&&("status"===l||"startDate"===l&&o.isAutoSchedule||"endDate"===l&&o.isAutoSchedule||"duration"===l&&o.isAutoSchedule||"work"===l||"effortDriven"===l||"taskType"===l||"predecessor"===l||"taskId"===l)||s.isFromGantt&&(o.isAutoSchedule&&"fixedWork"==o.taskType&&"effortDriven"==l||!o.isAutoSchedule&&("taskType"==l||"effortDriven"==l)))return!1;if((s.enableVirtualization||"cell"===s.selectionSettings.selectionMode)&&(c=u.indexOf(o),i=s.currentViewData.indexOf(o)),(n=t.TreeGrid.getRowByIndex(this,c))&&e(n).find(".e-rowcell").length>0){var g=e(n),m=d.getColumnIndexByField(l),p=g.find(".e-rowcell").eq(m),h=d.model.columns[m],_=o,f=d._getCustomCellValue(_,h.field),w={},C={validationRules:t.isNullOrUndefined(h.validationRules)?{}:e.extend(!0,{},h.validationRules),columnName:h.field,value:t.isNullOrUndefined(f)?t.isNullOrUndefined(_.item[l])?null:_.item[l]:f,data:_,columnObject:h,cell:p},x=!0;return"notesText"==h.field?(C.value=t.isNullOrUndefined(_[l])?_.item&&_.item[l]:_[l],C.value=C.value?d._convertHtml(C.value):C.value):C.value=t.isNullOrUndefined(f)?t.isNullOrUndefined(_.item[l])?null:_.item[l]:f,s.isFromGantt&&"predecessor"===C.columnName&&(r=C.data.item[d.model.predecessorMapping],C.value=r||""),s.isFromGantt&&"taskMode"===C.columnName&&(a=!C.data.isAutoSchedule,C.value=a),w.data=_,w.columnIndex=m,w.rowElement=g,w.cellElement=p,d._cellEventTrigger(p,_,C.columnObject),!d._trigger("beginEdit",w)&&(g.hasClass("e-insertedrow")&&!C.columnObject.isTemplateColumn&&(x=!0),x&&e.extend(d._cellEditingDetails,{rowIndex:i,cellValue:C.value,columnIndex:m,fieldName:l,cellEditType:C.columnObject.editType,data:_}),C.columnIndex=m,d._renderCellEditObject(C,p),g.addClass("e-editedrow"),C.cell&&C.cell.addClass("e-editedcell"),d._updateHorizontalScrollBar(l),d._updateWrapRowHeights("total,header",null,d._cellEditingDetails.rowIndex,"cellEdit"),!0)}},_updateHorizontalScrollBar:function(t){var i,l,n=this,o=n.getScrollElement();if(o.ejScroller("isHScroll")){var r,a=n.model,d=a.columns,s=(d.length,n.getColumnIndexByField(t)),c=0,u=0,g=0,m=0,p=o.find(".e-content").width(),h=o.ejScroller("option","scrollLeft"),_=e("#"+n._id+"EditForm"),f=[];if("cell"==a.selectionSettings.selectionMode&&0==_.length?f=e("#"+n._id).find(".e-selectingcell"):(r=e(_).closest("tr.e-treegridrows"),f=e(r).find("td.e-rowcell")),n._frozenColumnsLength>0&&s<n._frozenColumnsLength)return!1;for(i=n._frozenColumnsLength;i<=s;i++)l="cell"==a.selectionSettings.selectionMode&&0==_.length?f[f.length-1]:e(f[i-n._frozenColumnsLength]),i==s&&(u=c,g=c+e(l).width()+parseFloat(e(l).css("padding-left"))+parseFloat(e(l).css("padding-right"))+1),d[i].visible&&(c=c+e(l).width()+parseFloat(e(l).css("padding-left"))+parseFloat(e(l).css("padding-right"))+1);(u<h||g>h+p)&&(m=u<h?h-(h-u)-3:h+(g-(h+p)+3),o.ejScroller("option",{scrollLeft:m}))}},updateAllowColumnResize:function(e){var i=this,l=i.model;l.allowColumnResize=e,l.allowColumnResize&&(i._resizer=new t.gridFeatures.gridResize(i)),i._enableColumnResizeEvents()},_predecessorFromSerialPredecessor:function(i){var l,n,o,r=this.model.flatRecords,a=[],d="";return!t.isNullOrUndefined(i)&&i.length>0&&(i.split(",").forEach(function(t){l=t.split("+"),t.indexOf("-")>=0&&(l=t.split("-")),(n=l[0].match(/(\d+|[A-z]+)/g))&&n[0]&&(e.map(r,function(e){if(e.serialNumber==n[0])return o=e.taskId,!1}),o&&a.push(o+(n[1]?n[1]:"")+(l[1]?"+"+l[1]:"")))}),d=a.length&&a.join(",")),d},_validatePredecessorString:function(e){var t,l,n,o=this.model,r=o.flatRecords.length,a=!1;return!(e.length>0)||(e.split(",").forEach(function(e){if(l=e.split("+"),"+",e.indexOf("-")>=0&&(l=e.split("-"),"-"),!(n=l[0].match(/(\d+|[A-z]+)/g)))return!1;o.enableSerialNumber?+n[0]<=r&&(a=!0):-1!=o.ids.indexOf(n[0])&&(a=!0),n&&a?n[1]&&("FS"==n[1].toUpperCase()||"FF"==n[1].toUpperCase()||"SF"==n[1].toUpperCase()||"SS"==n[1].toUpperCase()||(t=!1)):t=!1}),!(t!==i&&!t))},saveCell:function(){var i,l=this,n=l.model,o=e("#"+l._id+"EditForm");if(o.length>0){if(!l.editFormValidate())return!0;if(l._isRowEdit)return;if(l._cellEditingDetails.columnIndex>=0){l._focusTreeGridElement();var r,a=l.getUpdatedRecords().indexOf(l._cellEditingDetails.data),d=t.TreeGrid.getRowByIndex(this,a),s=o.closest("td"),c={},u=n.columns[l._cellEditingDetails.columnIndex],g=e("#"+l._id+l._cellEditingDetails.fieldName.split(".").join("")),m=!0;c={columnName:u.field,value:l.getCurrentEditCellData(),data:l._cellEditingDetails.data,previousValue:l._cellEditingDetails.cellValue,rowIndex:l._cellEditingDetails.rowIndex,columnObject:u,cellElement:s,rowElement:d},("datetimepicker"==l._cellEditingDetails.cellEditType||"dropdownedit"==l._cellEditingDetails.cellEditType||"datepicker"==l._cellEditingDetails.cellEditType)&&g.data("ejWidgets")&&g[g.data("ejWidgets")[0]]("destroy"),t.isNullOrUndefined(u.format)?"boolean"==c.columnObject.type?((i={})[c.columnObject.field]=c.value,c.cellElement.empty().html(e(e.templates.Grid_JSONTemplate.render(i))[0].cells[l._cellEditingDetails.columnIndex].innerHTML)):"notesText"==c.columnObject.field?c.cellElement.empty().html(l._convertHtml(c.value)):c.cellElement.empty().html(c.value):(r=l.formatting(u.format,c.value,n.locale),c.cellElement.empty().html(r));l._cellEditingDetails.cellEditType;var p=l._cellEditingDetails.fieldName,h=l._checkModfiedCellValue(c.previousValue,c.value,c.columnObject);!n.isFromGantt&&n.idMapping&&n.parentIdMapping&&p==n.idMapping&&l._validateIdValue(c.value)&&(c.value=c.previousValue,h=!1),n.isFromGantt?l._setGanttCellValue(c,p,h):(h||!l._isRemoteData)&&(h&&"batchediting"==l.model.editSettings.editMode.toLowerCase()&&(c.data.isBatchAdd||l._createBatchEditedFields(c.data,p,c.value,c.columnObject),l._batchEditStarts=!0),-1!=p.indexOf(".")?t.createObject(p,c.value,c.data[p]):c.data[p]=c.value,c.data.item[p]=c.data[p],c.requestType="saveCellValue",m=l._updateAction(c)),m&&l._refreshAfterSaveCell(c,!0)}}},_createBatchEditedFields:function(e,i,l,n){var o=this;o.model;e.batchEditedFields?e.batchEditedFields&&t.isNullOrUndefined(e.batchEditedFields[i])?e.batchEditedFields[i]=e[i]:e.batchEditedFields&&!t.isNullOrUndefined(e.batchEditedFields[i])&&(o._checkModfiedCellValue(e.batchEditedFields[i],l,n)||delete e.batchEditedFields[i]):(e.batchEditedFields={},e.batchEditedFields[i]=e[i]?e[i]:""),o._updateBatchChanges(e)},_updateBatchChanges:function(t){var i=this,l=(i.model,i.batchChanges.changed),n=i.batchChanges.added;e.isEmptyObject(t.batchEditedFields)?-1!=l.indexOf(t)&&l.splice(l.indexOf(t),1):-1==n.indexOf(t)&&-1==l.indexOf(t)&&l.push(t)},_refreshAfterSaveCell:function(i,l){var n,o,r,a,d=this,s=d.model;this._frozenColumnsLength>0?(s.allowSelection||(i.data.isSelected=!1),n=d._cellEditingDetails.columnIndex<this._frozenColumnsLength?e(e.render[d._id+"_JSONFrozenTemplate"](i.data))[0].cells[d._cellEditingDetails.columnIndex]:e(e.render[d._id+"_Template"](i.data))[0].cells[d._cellEditingDetails.columnIndex-this._frozenColumnsLength]):(s.allowSelection||(i.data.isSelected=!1),n=e(e.render[d._id+"_Template"](i.data))[0].cells[d._cellEditingDetails.columnIndex]),i.cellElement.removeClass("e-editedcell").replaceWith(n),i.cellElement=e(n),s.showDetailsRow&&!s.showDetailsRowInfoColumn&&s.detailsTemplate&&this._refreshDetailsRow(s.currentViewData.indexOf(i.data)),d._trigger("refresh"),i.data.treeMappingName||(i.data.treeMappingName=[]),0==i.data.treeMappingName.length&&i.data.treeMappingName.push(i.columnName),(l||i.isModified)&&"batchediting"!=s.editSettings.editMode.toLowerCase()&&d._trigger("endEdit",i)?(i.data[i.columnName]=i.previousValue,i.data.item[i.columnObject.field]=i.previousValue,d.selectRows(this.selectedRowIndex()),t.TreeGrid.refreshRow(d,s.currentViewData.indexOf(i.data))):s.idMapping&&s.parentIdMapping&&d._updateLastInsertedId(i.data[s.idMapping]),s.isEdit=!1,d._cellEventTrigger(i.cellElement[0],i.data,i.columnObject),e(i.rowElement).removeClass("e-editedrow"),s.showSummaryRow&&(i.editType="celledit",d._updateSummaryRow(i)),s.showTotalSummary&&(i.editType="celledit",d._updateTotalSummaryRow(i)),s.allowTextWrap&&(d._$frozenTableContent.length>0?(d._updateRowHeight(d._cellEditingDetails.rowIndex,"savecell"),d._updateGridContentHeight(),d.getScrollElement().ejScroller("refresh"),o=d.getScrollElement().ejScroller("model.scrollTop"),d._getFrozenScrollElement().scrollTop(o),s.enableVirtualization&&d.updateHeight()):d.getScrollElement().ejScroller("refresh"),s.allowPaging&&!s.sizeSettings.height&&d.updateHeight()),s.allowTextWrap&&0==d._$frozenTableContent.length&&(r=d._getViewPortHeight(),d._$gridContainer.css({height:r+"px"}),e("#"+d._id+"e-gridcontent").css("height",r),"auto"==s.sizeSettings.height&&d.getScrollElement().ejScroller("refresh")),d._cancelSaveTools(),a=i.columnObject,s.allowFiltering&&a&&"filterbar"==s.filterSettings.filterType&&"dropdownedit"==a.filterEditType&&"dropdownedit"!=a.editType&&d._resizeFilteringElements()},_setGanttCellValue:function(i,l,n){var o,r,a,d,s,c,u=this,g=u.model;if("taskMode"===l&&(n=i.value!==i.previousValue),"predecessor"===l){o={},i.value=e.trim(i.value),u._validatePredecessorString(i.value)?(o.predecessorString=i.value.split(","),o.currentRecord=i.data,o.requestType="validatePredecessor",u._trigger("actionComplete",o),o.result||(i.value=i.previousValue)):i.value=i.previousValue;var m,p=[],h=[],_=0;for(i.previousValue=i.data.predecessor,m=i.previousValue,i.value.length>0&&(a=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),h=i.data._calculatePredecessor(i.value,g.durationUnitEditText,g.durationUnit,a)),w=h.length,d=0,s=i.previousValue&&i.previousValue.length,d=0;d<s;d++)(C=m[d]).from===i.data.taskId.toString()&&p.push(C);for(_=0;_<w;_++)p.push(h[_]);i.data[u._cellEditingDetails.fieldName]=p,a&&!a._isValidPredecessorString&&(i.value=u._getPredecessorsValue(i.data),a._isValidPredecessorString=!0),i.data.item[g.predecessorMapping]=i.value,i.data.predecessorsName=i.value,g.enableWBS&&g.enableWBSPredecessor&&u.updateWBSPredecessor(i.data)}else if("serialNumberPredecessor"===l){o={},i.value=e.trim(i.value),i.value=u._checkSerialPredecessor(i.value),u._validatePredecessorString(i.value)?(o.predecessorString=i.value.split(","),o.currentRecord=i.data,o.requestType="validateSerialPredecessor",u._trigger("actionComplete",o),o.result||(i.value=i.previousValue)):i.value=i.previousValue,r=u._predecessorFromSerialPredecessor(i.value);var f,w,C;p=[],h=[],_=0;for(f=i.data.predecessor,i.prevDefaultPredecessors=f,i.previousValue=i.data.serialNumberPredecessor,r.length>0&&(a=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),h=i.data._calculatePredecessor(r,g.durationUnitEditText,g.durationUnit,a)),w=h.length,d=0,s=f&&f.length,d=0;d<s;d++)(C=f[d]).from===i.data.taskId.toString()&&p.push(C);for(_=0;_<w;_++)p.push(h[_]);i.data.predecessor=p,i.data.item[g.predecessorMapping]=r,i.data.predecessorsName=r,i.data.item.serialNumberPredecessor=i.value,i.data.serialNumberPredecessor=i.value,g.enableWBS&&g.enableWBSPredecessor&&u.updateWBSPredecessor(i.data)}else if("duration"===l){var x=i.value,v=i.data.duration,S=i.data.durationUnit;""==x?(v=x,g.allowUnscheduledTask?v=null:n=!1):(c=x.match(/(\d*\.*\d+|[A-z]+)/g))&&c.length<=2&&(v=parseFloat(c[0]),S=c[1]?c[1].toLowerCase():"",S=-1!=g.durationUnitEditText.minute.indexOf(S)?t.Gantt.DurationUnit.Minute:-1!=g.durationUnitEditText.hour.indexOf(S)?t.Gantt.DurationUnit.Hour:-1!=g.durationUnitEditText.day.indexOf(S)?t.Gantt.DurationUnit.Day:g.durationUnit),isNaN(v)||!n&&i.data.durationUnit.toLowerCase()==S?(i.data.item[g.durationMapping]=i.previousValue,n=!1):(i.data.item[g.durationMapping]=i.data.duration=v,i.data.durationUnit=S,n=!0)}else if(n){switch(l){case"taskId":i.data.item[g.idMapping]=i.value;break;case"taskName":i.data.item[g.taskNameMapping]=i.value;break;case"startDate":case"endDate":g.allowUnscheduledTask||i.value&&""!=i.value?"startDate"==l?i.data.item[g.startDateMapping]=i.value:"endDate"==l&&(i.data.item[g.endDateMapping]=i.value):(n=!1,i.value=i.previousValue);break;case"resourceInfo":i.data.item[g.resourceInfoMapping]=u._getResourceId(i.value);break;case"status":i.data.item[g.progressMapping]=i.value;break;case"notesText":i.data.item[g.notesMapping]=i.value,i.data.notes=i.value,i.data.notesText=i.value;break;case"taskMode":i.data.item[g.taskSchedulingModeMapping]=i.value,i.data.isAutoSchedule=1!=i.value;break;case"work":g.workMapping?i.data.item[g.workMapping]=i.value:i.data.item[u._cellEditingDetails.fieldName]=i.value;break;case"baselineStartDate":i.data.item[g.baselineStartDateMapping]=i.value;break;case"baselineEndDate":i.data.item[g.baselineEndDateMapping]=i.value;break;case"eResourceName":"groupTask"==i.data.eResourceTaskType?i.data.item[g.groupNameMapping]=i.value:"resourceTask"==i.data.eResourceTaskType&&(i.data.item[g.resourceNameMapping]=i.value),i.data.eResourceName=i.value;break;default:i.data.item[u._cellEditingDetails.fieldName]=i.value}i.data[l]=i.value}("startDate"===i.columnName||"endDate"===i.columnName||"duration"===i.columnName||"taskMode"===i.columnName||"predecessor"===i.columnName||"serialNumberPredecessor"===i.columnName||"status"==i.columnName||"baselineStartDate"==i.columnName||"baselineEndDate"==i.columnName)&&(i.isModified=n)},_checkSerialPredecessor:function(e){var t,i,l="",n=[];return e.length>0&&(e.split(",").forEach(function(e){i=e.split("+"),e.indexOf("-")>=0&&(i=e.split("-")),t=i[0].match(/(\d+|[A-z]+)/g),n.push(t[0]+(t[1]?t[1].toUpperCase():"FS")+(i[1]?"+"+i[1]:""))}),l=n.join(",")),l},updateWBSPredecessor:function(e){var t,i,l,n=this.model,o=e.predecessorsName,r=null;if(o&&o.length>0){for(t=o.split(","),i=0;i<t.length;i++){var a,d=t[i].match(/(\d+|[A-z]+)/g),s=+d[0],c=d[1];a=n.flatRecords.filter(function(e){return e&&e.taskId==s}),(l=c?a[0]&&a[0].WBS+c:a[0]&&a[0].WBS)&&(r=r?r+","+l:l)}e.WBSPredecessor=r,e.item.WBSPredecessor=r}else e.WBSPredecessor="",e.item.WBSPredecessor=""},getCurrentEditCellData:function(){var i,l,n,o,r=this,a=r.model,d=a.columns;if(e("#"+r._id+"EditForm").length){switch(l=e("#"+r._id+r._cellEditingDetails.fieldName.split(".").join("")),i=d[r._cellEditingDetails.columnIndex],r._cellEditingDetails.cellEditType){case t.TreeGrid.EditingType.String:n=l.val();break;case t.TreeGrid.EditingType.Numeric:n=parseFloat(l.val()),n=a.isFromGantt&&("work"==i.field||"status"==i.field||"duration"==i.field)||"unit"==i.field?isNaN(n)?r._cellEditingDetails.cellValue:n:l.ejNumericTextbox("model.value");break;case t.TreeGrid.EditingType.Maskedit:n=l.ejMaskEdit("model.value");break;case t.TreeGrid.EditingType.Dropdown:n=a.isFromGantt&&"resourceInfo"===r._cellEditingDetails.fieldName?r._getSelectedItem(l.ejDropDownList("model.selectedItems")):a.isFromGantt&&"taskMode"===r._cellEditingDetails.fieldName?"true"==l.ejDropDownList("model.value"):0==l.ejDropDownList("model.showCheckbox")&&l.ejDropDownList("model.multiSelectMode")==t.MultiSelectMode.None?l.ejDropDownList("model.itemValue"):l.ejDropDownList("getSelectedValue");break;case t.TreeGrid.EditingType.Boolean:n=l.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:""==(n=i&&!i.format?t.format(l.ejDatePicker("model.value"),this.model.dateFormat,this.model.locale):l.ejDatePicker("model.value"))&&a.isFromGantt&&(n=r._cellEditingDetails.cellValue);break;case t.TreeGrid.EditingType.DateTimePicker:var s=l.ejDateTimePicker("model.value"),c=l.ejDateTimePicker("model.dateTimeFormat"),u=l.ejDateTimePicker("model.locale");n=i&&!i.format?t.format(l.ejDateTimePicker("model.value"),this.model.dateFormat,this.model.locale):l.ejDateTimePicker("model.value"),t.format(l.val(),c,u)!==t.format(s,c,u)&&a.isFromGantt&&!a.allowUnscheduledTask&&(n=r._cellEditingDetails.cellValue);break;case"edittemplate":"string"==typeof(o=i.editTemplate.read)&&(o=t.util.getObject(o,window)),n=o(l)}return"string"==typeof n&&n.length&&"number"==a.columns[r._cellEditingDetails.columnIndex].type&&(n=parseFloat(n)),n}return null},getCurrentEditCellDataForRowEdit:function(i,l,n){var o,r,a,d,s,c,u,g=this,m=g.model,p=m.columns;i=i.split(".").join("");if(g.model.editSettings.allowEditing&&("dialogEditing"==g.model.editSettings.editMode||"batchediting"==m.editSettings.editMode.toLowerCase()&&"dialog"==m.editSettings.batchEditSettings.editMode)?(r=e("#"+g._id+"EditFormDialog").length,a=e("#"+g._id+i),d=!0):(r=e("#"+g._id+"EditForm").length,a=e("#"+g._id+i)),r){switch(o=p[n],l){case t.TreeGrid.EditingType.String:s=a.val();break;case t.TreeGrid.EditingType.Numeric:s=parseFloat(a.val()),s=a.data("ejNumericTextbox")?a.ejNumericTextbox("model.value"):s;break;case t.TreeGrid.EditingType.Dropdown:s=a.data("ejDropDownList")?0==a.ejDropDownList("model.showCheckbox")&&a.ejDropDownList("model.multiSelectMode")==t.MultiSelectMode.None?a.ejDropDownList("model.itemValue"):a.ejDropDownList("getSelectedValue"):a.val(),d||a.data("ejWidgets")&&a[a.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.Boolean:s=a.is(":checked");break;case t.TreeGrid.EditingType.DatePicker:c=a.hasClass("e-datepicker")?-1==m.dateFormat.toLowerCase().indexOf("hh")?a.ejDatePicker("model.value"):a.ejDateTimePicker("model.value"):a.val(),s=o&&!o.format?g.getFormatedDate(c):c,d||a.data("ejWidgets")&&a[a.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.DateTimePicker:s=a.hasClass("e-datetimepicker")?o&&!o.format?t.format(a.ejDateTimePicker("model.value"),this.model.dateFormat,this.model.locale):a.ejDateTimePicker("model.value"):a.val(),d||a.data("ejWidgets")&&a[a.data("ejWidgets")[0]]("destroy");break;case t.TreeGrid.EditingType.Maskedit:s=a.ejMaskEdit("model.value");break;case"edittemplate":"string"==typeof(u=o.editTemplate.read)&&(u=t.util.getObject(u,window)),s=u(a)}return"string"==typeof s&&s.length&&"number"==m.columns[n].type&&(s=parseFloat(s)),s}return null},_getResourceId:function(e){var t=[],i=0,l=e.length;for(i=0;i<l;i++)t.push(e[i][this.model.resourceIdMapping]);return t},_getSelectedItem:function(i){var l,n,o=this.model,r=0,a=i.length,d=o.resourceUnitMapping,s=o.resourceIdMapping,c=o.columns[this._cellEditingDetails.columnIndex].dropdownData,u=o.selectedItem.resourceInfo,g=[];if(c)for(r=0;r<a;r++){if(u)for(n=0;n<u.length;n++){if(u[n][s]===i[r]+1){l=n;break}l=-1}t.isNullOrUndefined(l)||-1==l?e.each(c,function(t,l){if(i[r]===t){var n=e.extend({},l);n[d]=100,g.push(n)}}):g.push(u[l])}return g},getFormatedDate:function(e){return t.format(e,this.model.dateFormat,this.model.locale)},getDateFromFormat:function(e){return"object"==typeof e?new Date(e):e?null==t.parseDate(e,this.model.dateFormat,this.model.locale)?new Date(e):t.parseDate(e,this.model.dateFormat,this.model.locale):void 0},formatting:function(i,l,n){var o,r,a,d,s,c;return i=i.replace(/%280/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">"),n=t.preferredCulture[n]?n:"en-US",o=i,r=i.split("{0:"),s=i.split("}"),a=r[0],d=s[1],"string"==typeof l&&e.isNumeric(l)&&(l=Number(l)),-1!=i.indexOf("{0:")?null!=(c=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(i))&&null!=l?null!=a&&null!=d?a+t.format(l,c[2],n)+d:t.format(l,c[2],n):null!=l?l:"":null!=this.data&&null==this.data.Value?(e.each(this.data,function(e,t){o=o.replace(new RegExp("\\{"+e+"\\}","gm"),t)}),o):this.data.Value},getColumnIndexByField:function(e){for(var t=this.model.columns,i=t.length,l=0;l<i&&t[l].field!=e;l++);return l==t.length?-1:l},getUpNextVisibleColumnIndex:function(e,t){var i=this.model.columns;for(e||(e=0);e<=i.length;e++)if(e==i.length&&("rightArrow"==t||"moveCellRight"==t)&&(e=0,this._focusingRowIndex+=1),i[e].visible&&i[e].allowCellSelection)return i.indexOf(i[e])},getPreviousVisibleColumnIndex:function(e,t){var i=this.model.columns;for(e||(e=i.length-1);e<i.length;e--)if(e<0&&("leftArrow"==t||"moveCellLeft"==t)&&(e=i.length-1,this._focusingRowIndex-=1),i[e].visible&&i[e].allowCellSelection)return i.indexOf(i[e])},getBrowserDetails:function(){var e=navigator.userAgent.match(/(firefox|chrome|opera|msie|safari)\s?\/?(\d+(.\d+)*)/i);return navigator.userAgent.match(/Trident\/7\./)?{browser:"msie",version:jQuery.uaMatch(navigator.userAgent).version}:{browser:e[1].toLowerCase(),version:e[2]}},mobileDevice:function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},getFieldNameByHeaderText:function(e){return t.isNullOrUndefined(this._fieldColumnNames[e])?null:this._fieldColumnNames[e]},clearSelection:function(i){var l,n,o,r,a,d,s,c,u=this,g=u.model,m=u.getUpdatedRecords();if(-1!=this.selectedRowIndex()||-1==this.selectedRowIndex()&&-1!=u._previousIndex||-1==i){if(l=this._frozenColumnsLength?e(u.getRows()[0]).add(u.getRows()[1]):u.getRows(),t.isNullOrUndefined(i)||-1==i){if(l&&l.find(".e-rowcell,.e-detailsrowcell").removeClass("e-selectionbackground").removeClass("e-active"),o=new t.DataManager(g.flatRecords),(r=new t.Query).search(!0,["isSelected"],t.FilterOperators.Equals,!0),(d=(a=o.executeLocal(r))&&a.length)>0)for(s=0,s=0;s<d;s++)a[s].isSelected=!1}else t.TreeGrid.getRowByIndex(u,i).find(".e-selectionbackground").removeClass("e-selectionbackground").removeClass("e-active"),(n=m[i])&&(n.isSelected=!1);u._checkboxSelection?(u.selectedRowIndex(-1),g.selectedItem=null,u._cancelSaveTools()):g.selectedItems.length>0&&-1!=i&&!t.isNullOrUndefined(i)?-1!=(c=e.inArray(m[i],g.selectedItems))&&(g.selectedItems.splice(c,1),m[i].isSelected=!1,g.selectedItem=g.selectedItems.length>0?g.selectedItems[g.selectedItems.length-1]:null,u.selectedRowIndex(m.indexOf(g.selectedItem))):(!g.selectedItems.length||g.selectedItems.length&&!u._multiSelectCtrlRequest||-1==i||t.isNullOrUndefined(i))&&(u.selectedRowIndex(-1),g.selectedItem=null,g.selectedItems=[],u._cancelSaveTools()),u.model.allowSelection&&"multiple"==u.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&!l.find(".e-rowcell,.e-detailsrowcell").hasClass("e-selectionbackground")&&!e("#"+u._id+"_selectionpopup").find(".e-rowselect").hasClass("e-spanclicked")&&u._clearMultiSelectPopup()}"cell"==g.selectionSettings.selectionMode&&(u._selectedCellDetails=[],g.selectedCellIndexes=[],e("#"+u._id).find(".e-selectingcell").removeClass("e-selectingcell"),u._rowIndexOfLastSelectedCell=-1,u._lastSelectedCellIndex=-1,u._focusingRowIndex=-1),u.model.allowSelection&&"multiple"==u.model.selectionSettings.selectionType&&t.isNullOrUndefined(i)&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&u._clearMultiSelectPopup()},_clearMultiSelectPopup:function(){var t=this;e("#"+t._id+"_selectionpopup").find(".e-rowselect").removeClass("e-spanclicked"),t._multiSelectPopup.hide(),t._multiSelectCtrlRequest=!1,t._isTouchTrigger=!1},getChildRecordsCount:function(e){for(var t=this,i=e.childRecords,l=0,n=i?i.length:0;l<n;l++)t._filteredRecords.length>0?-1!=t._filteredRecords.indexOf(i[l])&&(++t._removedCount,i[l].hasChildRecords&&i[l].expanded&&t.getChildRecordsCount(i[l])):(++t._removedCount,i[l].hasChildRecords&&i[l].expanded&&t.getChildRecordsCount(i[l]));return t._removedCount},getExpandStatus:function(e){var t=e.parentItem;return null==t||!1!==t.expanded&&(!t.parentItem||!1!==t.parentItem.expanded&&this.getExpandStatus(t.parentItem))},getColumnFieldNames:function(){var e=[],t=this.model,i=t.columns,l=0,n=t.searchSettings.fields,o=i.length;if(n.length>0)return n;for(;l<o;l++)i[l].field&&"resourceInfo"!=i[l].field&&"predecessor"!=i[l].field?e.push(i[l].field):"resourceInfo"==i[l].field?e.push("resourceNames"):"predecessor"==i[l].field&&e.push("predecessorsName");return e},_getColumnMappingNames:function(){for(var e=[],t=this.model.columns,i=0,l=t.length;i<l;i++)t[i].field&&"resourceInfo"!=t[i].field&&"predecessor"!=t[i].field&&"work"!=t[i].field&&"taskType"!=t[i].field&&"effortDriven"!=t[i].field?e.push(t[i].mappingName):"resourceInfo"==t[i].field?e.push("resourceNames"):"work"==t[i].field?e.push(t[i].field):"taskType"==t[i].field?e.push(t[i].field):"effortDriven"==t[i].field?e.push(t[i].field):"predecessor"==t[i].field&&e.push("predecessorsName");return e},renderRecords:function(e){var i=this,l=i.model;e||(e={},!l.isFromGantt&&l.enableCollapseAll?(e.requestType=t.TreeGrid.Actions.ExpandCollapse,i._isInExpandCollapseAll=!0):e.requestType=t.TreeGrid.Actions.Refresh),this.sendDataRenderingRequest(e),i._isInExpandCollapseAll=!1},_shiftKeySelectCells:function(i){var l,n,o,r=this,a=r.model,d=r.getUpdatedRecords(),s=r._shiftKeyFirstElementDetails.firstElementRowIndex,c=t.isNullOrUndefined(r._shiftKeyFirstElementDetails.firstElementCellIndex)?-1:r._shiftKeyFirstElementDetails.firstElementCellIndex,u=[s,i.rowIndex],g=[c,i.cellIndex];for(u.sort(function(e,t){return e-t}),g.sort(function(e,t){return e-t}),r._isShiftKeyNavigation=!0,r._selectedCellDetails=[],a.selectedCellIndexes=[],e("#"+r._id).find(".e-selectingcell").removeClass("e-selectingcell"),l=u[0];l<=u[1];l++)if(n=d&&d[l],a.currentViewData.indexOf(n),!t.isNullOrUndefined(n)&&!n.isSummaryRow)for(o=g[0];o<=g[1];o++)r.selectCells([{rowIndex:l,cellIndex:o}])},selectCells:function(i,l){var n,o,r,a,d,s,c,u,g=this,m=g.model,p=g.getUpdatedRecords(),h=g.getRows(),_=i.length,f=m.columns;if("single"==m.selectionSettings.selectionType&&(_=1),(!l||t.isNullOrUndefined(l))&&0==g._isShiftKeyNavigation&&(g._selectedCellDetails=[],m.selectedCellIndexes=[],e("#"+g._id).find(".e-selectingcell").removeClass("e-selectingcell")),"cell"==m.selectionSettings.selectionMode&&m.allowSelection&&h.length>0)for(r=0;r<_;r++)-1!=i[r].rowIndex&&(a=p&&p[i[r].rowIndex],d=m.currentViewData.indexOf(a),t.isNullOrUndefined(a)||a.isSummaryRow||(s=i[r].cellIndex>=g._frozenColumnsLength?1:0,c=i[r].cellIndex>=g._frozenColumnsLength?i[r].cellIndex-g._frozenColumnsLength:i[r].cellIndex,n=g._frozenColumnsLength>0?h[s][d]:h[d],!t.isNullOrUndefined(a)&&t.isNullOrUndefined(n)&&(n=e(e.render[g._id+"_Template"](a))[0]),o=n.childNodes[c],-1!=i[r].cellIndex&&f[i[r].cellIndex].allowCellSelection&&f[i[r].cellIndex].visible&&!g._cellSelectingEventTrigger({rowIndex:i[r].rowIndex,cellIndex:i[r].cellIndex,rowElement:n,cellElement:o})&&(e(o).addClass("e-selectingcell"),u={rowIndex:i[r].rowIndex,cellIndex:i[r].cellIndex,cellElement:o,data:a},-1==("msie"==t.browserInfo().name&&t.browserInfo().version<9?g._getCellIndex(g._selectedCellDetails,"cellElement").indexOf(o):g._selectedCellDetails.map(function(e){return e.cellElement}).indexOf(o))&&(g._selectedCellDetails.push(u),m.selectedCellIndexes.push({rowIndex:u.rowIndex,cellIndex:u.cellIndex})),g._cellSelectedEventTrigger({rowIndex:i[r].rowIndex,cellIndex:i[r].cellIndex,rowElement:n,cellElement:o},g._previousSelectedCellDetails),g._previousSelectedCellDetails={rowElement:n,cellElement:o,cellIndex:i[r].cellIndex,rowIndex:i[r].rowIndex},g._updateHorizontalScrollBar(f[i[r].cellIndex].field))));0==g._isShiftKeyNavigation&&(g._shiftKeyFirstElementDetails.firstElementRowIndex=g._focusingRowIndex,g._shiftKeyFirstElementDetails.firstElementCellIndex=g._cellIndex,g._rowIndexOfLastSelectedCell=u?u.rowIndex:g._rowIndexOfLastSelectedCell,g._lastSelectedCellIndex=g._cellIndex)},selectRows:function(i,l,n){var o,r,a,d,s,c,u,g,m,p=this,h=p.model;p.getRows();if(("cell"!=h.selectionSettings.selectionMode||-1==i)&&!t.TreeGrid.getRowByIndex(p,i).hasClass("e-summaryrow")){if((h.editSettings.allowEditing||h.editSettings.allowAdding)&&!p._isRowEdit&&"click"!=h.editSettings.beginEditAction&&e("#"+p._id+"EditForm").length>0&&p.endEdit())return void p.getRows();if(this._frozenColumnsLength>0&&e(p.getRows()[0]),o=p.getUpdatedRecords(),t.isNullOrUndefined(l)||t.isNullOrUndefined(i)){switch(i=t.isNullOrUndefined(i)?l:i,h.selectionSettings.selectionType){case t.TreeGrid.SelectionType.Checkbox:return a=o[i],p.clearSelection(-1),n&&(r="unchecked"==a.checkboxState?"checked":"unchecked",p._traverseSelection(a,r,!1),p.selectAllRows()),o[i]&&!o[i].isSelected&&(h.allowSelection&&t.TreeGrid.getRowByIndex(p,i).find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active"),o[i].isSelected=!0,h.selectedItem=o[i]),p._prevSelectedItem&&p._prevSelectedItem!=h.selectedItem&&(p._prevSelectedItem.isSelected=!1),p._prevSelectedItem=o[i],p.selectedRowIndex(i),h.selectedItems=p.getSelectedRecords(),!1;case t.TreeGrid.SelectionType.Multiple:if(p._multiSelectCtrlRequest&&-1!=i){a=o[i],d=e.inArray(a,h.selectedItems),p._prevSelectedItem=o[i],-1!=d&&p.clearSelection(i),-1==d&&(h.selectedItems.push(a),h.allowSelection&&t.TreeGrid.getRowByIndex(p,i).attr("aria-selected","true").find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active").attr("tabindex","0"),a.isSelected=!0,h.selectedItem=o[i]);break}case t.TreeGrid.SelectionType.Single:p.clearSelection(-1),h.selectedItem=null,i<=o.length-1&&(-1!=i&&h.selectedItems.push(o[i]),p._prevSelectedItem=o[i],p._shiftSelectedRecord=null,h.allowSelection&&t.TreeGrid.getRowByIndex(p,i).find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active"),o[i]&&(o[i].isSelected=!0,h.selectedItem=o[i]),p._prevSelectedItem&&p._prevSelectedItem!=h.selectedItem&&(p._prevSelectedItem.isSelected=!1))}h.selectedItems.length&&-1!=h.selectedItems.indexOf(o[i])?(p._prevSelectedItem=o[i],p._shiftSelectedRecord=null,this.selectedRowIndex()!=i&&this.selectedRowIndex(i)):0==h.selectedItems.length&&-1!=this.selectedRowIndex()?this.selectedRowIndex(-1):this.selectedRowIndex(h.updatedRecords.indexOf(h.selectedItems[h.selectedItems.length-1]))}else if(h.selectionSettings.selectionType==t.TreeGrid.SelectionType.Multiple)for(p.clearSelection(-1),s=i-l<0?o.slice(i,l+1):o.slice(l,i+1),m=0;m<s.length;m++)p.getExpandStatus(s[m])&&(s[m].isSelected=!0,u=o.indexOf(s[m]),c=t.TreeGrid.getRowByIndex(p,u),this._frozenColumnsLength?(g=e(c[0]).add(c[1]),c=c[0]):g=c,g&&e(g).find(".e-rowcell,.e-detailsrowcell").addClass(" e-selectionbackground e-active"),h.selectedItem=h.updatedRecords[u],this.selectedRowIndex(u));return h.selectedItems=p.getSelectedRecords(),h.isFromGantt||(p._multiSelectCtrlRequest=!1),h.isFromGantt&&p._cancelSaveTools(),!1}},getSelectedRecords:function(){var e,i=this.model,l=i.selectionSettings.selectionType;return i.allowFiltering&&i.filterSettings.filteredColumns.length>0||this._searchString.length>0?i.isFromGantt||l==t.TreeGrid.SelectionType.Single?e=i.updatedRecords:(l==t.TreeGrid.SelectionType.Multiple||l==t.TreeGrid.SelectionType.Checkbox)&&(e=this._flatFilteredRecords):e=i.flatRecords,("checkbox"==l?e.filter(function(e){return"checked"==e.checkboxState}):e.filter(function(e){return e.isSelected})).slice()},clearAllSelection:function(){var t=this,i=this.model;t.model.allowSelection&&"multiple"==t.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&t._clearMultiSelectPopup(),t.selectRows(-1),i.selectedItem=null,t._selectedCellDetails=[],i.selectedCellIndexes=[],t._rowIndexOfLastSelectedCell=-1,t._lastSelectedCellIndex=-1,t._focusingRowIndex=-1,e("#"+t._id).find(".e-selectingcell").removeClass("e-selectingcell"),t._cancelSaveTools()},getCellIndex:function(t,i){var l=e(t.target),n=-1;this.model;if(i&&(l=e(i)),l.hasClass("e-detailsrowcell")||l.closest("td").hasClass("e-detailsrowcell"))return-1;if("TD"==l.prop("tagName"))n=l.index();else if("DIV"==l.prop("tagName")&&l.hasClass("e-cell"))n=l.closest("td").index();else if("DIV"==l.prop("tagName")&&e(l.closest("td")[0]).hasClass("e-templatecell"))n=l.closest("td").index();else if(e(l.closest("td")[0]).hasClass("e-templatecell")&&e(l.closest("tr")[0]).hasClass("e-templaterow"))n=l.closest("td").index();else if("TD"==l.parent().prop("tagName"))l.closest("td"),n=l.parent().index();else if("TH"==l.prop("tagName")||"DIV"==l.prop("tagName")&&"col-resize"==e(l.closest("th")[0]).css("cursor")){var o="TH"==l.prop("tagName")?e(l):l.closest("th"),r=l[0].getBoundingClientRect(),a=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft;n=this._orgX<r.left+5+a&&o.prevAll(":visible:first")[0]?o.prevAll(":visible:first")[0].cellIndex:o.index()}else l.closest("td.e-rowcell").length>0&&(n=l.closest("td.e-rowcell").index());return-1!=n&&this._frozenColumnsLength>0&&(l.closest(".e-movablecontentdiv").length>0||l.closest(".e-movableheaderdiv").length>0||l.closest(".e-movablefooterdiv").length>0)&&(n+=this._frozenColumnsLength),n},getRowIndex:function(t){var i,l=e(t.target),n=this.getRows(),o=-1;this.model;if(l.closest(".e-gridcontainer").length>0){if(this._frozenColumnsLength>0)if(l.closest(".e-frozencontentdiv").length>0||l.closest(".e-frozencontainer").length>0)n=e(n[0]);else{if(!(l.closest(".e-movablecontentdiv").length>0||l.closest(".e-movablecontainer").length>0))return o;n=e(n[1])}return-1==(o=n.index(l))&&(i=l.closest("tr"),o=n.index(i)),o}},_cancelEditState:function(e){var i,l=this;t.isNullOrUndefined(e)||(i=0,l.getScrollElement().ejScroller("option","scrollLeft")!=(i=this._frozenColumnsLength>0?l._$gridHeaderContainer.find("#e-movableheader"+this._id).scrollLeft():l._$gridHeaderContainer.scrollLeft())&&(l.getScrollElement().ejScroller("option","scrollLeft",i),l.model.showTotalSummary&&l._$footerContainer&&(this._frozenColumnsLength>0?l._$footerContainer.find("#e-movablefooter"+this._id).scrollLeft(i):l._$footerContainer.scrollLeft(i)))),l.model.isEdit?l.cancelEditCell():l._isRowEdit&&l.cancelRowEditCell()},cancelEditCell:function(){var t,i,l,n=this,o=n.model,r=(n.model.selectedItem,n._cellEditingDetails.columnIndex),a=o.columns[r];if(o.isFromGantt&&!o.isEdit)return!0;l={columnName:a.field,value:n.getCurrentEditCellData(),data:n._cellEditingDetails.data,previousValue:n._cellEditingDetails.cellValue,columnObject:a},this._frozenColumnsLength>0?this._frozenColumnsLength<=n._cellEditingDetails.columnIndex?(r=n._cellEditingDetails.columnIndex-this._frozenColumnsLength,t=e(n.getRows()[1])[n._cellEditingDetails.rowIndex],e(t).hasClass("e-editedrow")&&e(t).removeClass("e-editedrow"),i=t.cells[r],e(i).removeClass("e-editedcell").empty().html(e(e.render[n._id+"_Template"](l.data))[0].cells[r].innerHTML)):(t=e(n.getRows()[0])[n._cellEditingDetails.rowIndex],e(t).hasClass("e-editedrow")&&e(t).removeClass("e-editedrow"),i=t.cells[r],e(i).removeClass("e-editedcell").empty().html(e(e.render[n._id+"_JSONFrozenTemplate"](l.data))[0].cells[r].innerHTML)):(t=e(n.getRows())[n._cellEditingDetails.rowIndex],e(t).hasClass("e-editedrow")&&e(t).removeClass("e-editedrow"),i=t.cells[r],e(i).removeClass("e-editedcell").empty().html(e(e.render[n._id+"_Template"](l.data))[0].cells[r].innerHTML)),n._cellEventTrigger(e(i)[0],l.data,l.columnObject),n.model.isEdit=!1,n._cancelSaveTools(),n._trigger("refresh")},_destroyWidgetElements:function(){for(var t,i,l=this.model.columns,n=l.length,o=0;o<n;o++)i=this._getFieldValue(l[o].field,o),(t=e("#"+this._id+i)).data("ejWidgets")&&t[t.data("ejWidgets")[0]]("destroy")},cancelRowEditCell:function(){var i,l,n,o,r,a=this,d=this.model,s=d.editSettings.allowDeleting,c=e(document.getElementById(a._id+"EditForm")),u=e("#"+a._id+"EditFrozenForm");c.length>0&&this._destroyWidgetElements(),i=e(c.closest("tr")),l=u.closest("tr"),n=a.getIndexByRow(i),o=d.currentViewData[n],(-1!=n||0!=c.length)&&(i.hasClass("e-addedrow")&&(a.model.editSettings.allowDeleting||(a.model.editSettings.allowDeleting=!0)),i.hasClass("e-editedrow")?(i.removeClass("e-editedrow").empty().html(e(e.render[a._id+"_Template"](o))[0].innerHTML),l.length>0&&l.removeClass("e-editedrow").empty().html(e(e.render[a._id+"_JSONFrozenTemplate"](o))[0].innerHTML),a._rowEventTrigger(i,o)):i.hasClass("e-rowedit")?(i.removeClass("e-rowedit").empty().html(e(e.render[a._id+"_Template"](o))[0].innerHTML),l.length>0&&l.removeClass("e-rowedit").empty().html(e(e.render[a._id+"_JSONFrozenTemplate"](o))[0].innerHTML),a._rowEventTrigger(i,o)):i.hasClass("e-addedrow")&&(a._isRefreshAddedRecord=!1,a._isEmptyRow=!0,a.deleteRow(null,!0,null),a._isEmptyRow=!1),d.isEdit=a._isRowEdit=!1,d.editSettings.allowDeleting=s,a._updateWrapRowHeights("total,header",null,n),a._cancelSaveTools(),a._trigger("refresh"),a._commandColumnLength>0&&(r=t.TreeGrid.getRowByIndex(a,a.getUpdatedRecords().indexOf(d.currentViewData[n])),a._refreshUnboundTemplate(r)))},refreshRow:function(i){var l=this,n=l.model,o=(n.allowPaging?l._updatedPageData:n.updatedRecords)[i],r=l.getIndexByRow(e("#"+l._id+"EditForm").closest("tr"));(n.enableVirtualization||n.allowPaging)&&(i=n.currentViewData.indexOf(o)),o&&i>-1&&(t.TreeGrid.refreshRow(this,i),r==i&&(l._isRowEdit=l.model.isEdit=!1,l._cancelSaveTools()))},_refreshDetailsRow:function(t){var i,l,n=this,o=this.model,r=n.model.currentViewData[t],a={};r&&(a=this._frozenColumnsLength>0?e(n.getRows()[1]):e(n.getRows()),(i=e(a[t]).next("tr")).hasClass("e-detailsrow")&&(i.remove(),l=e(e.render[n._id+"_detailRowTemplate"](r)),e(a[t]).after(l),n.setGridRows(e(n.getContentTable().get(0).rows)),this._gridRows=this.getContentTable().get(0).rows,this._frozenColumnsLength>0&&(this._gridRows=[this._gridRows,this.getContentTable().get(1).rows]),n._trigger("refresh"),o.detailsDataBound&&this._trigger("detailsDataBound",{detailsElement:l,data:r})))},_refreshedCellEventTrigger:function(t){var i,l=this,n=this.model;if(null!=n.queryCellInfo||null!=n.rowDataBound||null!=n.detailsDataBound){null!=n.rowDataBound&&l._trigger("rowDataBound",{rowElement:t.rowElement,data:t.data});var o=t.rowElement.cells,r=e(t.rowElement).find(".e-rowcell"),a=0,d=o.length,s=null,c=l.model.columns;if(null!=n.queryCellInfo)for(;a<d;a++)e(o[a]).hasClass("e-rowcell")&&(s=c[r.index(o[a])]),s&&l._cellEventTrigger(o[a],t.data,s);n.detailsDataBound&&e(t.rowElement).next("tr").hasClass("e-detailsrow")&&(i=e(t.rowElement).next("tr"),this._frozenColumnsLength>0&&(i=e(i[1])),this._trigger("detailsDataBound",{detailsElement:e(t.rowElement).next("tr"),data:t.data}))}},_refreshGridPager:function(){var e;if(null!=this.getPager()){var t=this,i=t.model,l=this.getPager().ejPager("model"),n={};if(n.currentPage=this._currentPage(),e=t._isHierarchyFiltering?t.getExpandedRecords(t._filterParentRecords).length:i.updatedRecords.length,0==i.currentViewData.length&&e>0&&1!=l.totalPages)return void t.gotoPage(n.currentPage-1);n.totalRecordsCount=t._isLoadonDemand?t._pageRecordCountOnDemand:t._isRemoteData?i.pageSettings.totalRecordsCount:t._gridRecordsCount,this.getPager().ejPager("option",n).ejPager("refreshPager"),i.pageSettings.totalPages=l.totalPages||null,t._isRemoteData||(i.pageSettings.totalRecordsCount=l.totalRecordsCount||null),t._updatePagerTextAlignment()}},_getVisibleChildRecordCount:function(e,t,i){var l,n,o;this.model;if(e.hasChildRecords)for(n=(l=e.childRecords).length,o=0;o<n;o++)-1!==i.indexOf(l[o])&&t++,l[o].hasChildRecords&&(t=this._getVisibleChildRecordCount(l[o],t,i));else-1!==i.indexOf(e)&&t++;return t},_renderAddedRow:function(e,i){var l,n=this,o=this.model;n._updateCurrentViewData(),o.enableVirtualization||o.allowPaging?(n.updateAltRow(),(l={}).requestType=t.TreeGrid.Actions.Refresh,n.sendDataRenderingRequest(l)):n.renderNewAddedRow(e,i),n.updateHeight(),n._updateFixedTableBorder()},renderNewAddedRow:function(i,l){var n,o,r,a,d,s=this,c=(this.model,s.getRows()),u=e.render[this._id+"_Template"](l),g=this._frozenColumnsLength>0;g&&(c=e(s.getRows()[1]),o=e(s.getRows()[0]),n=e.render[this._id+"_JSONFrozenTemplate"](l)),!t.isNullOrUndefined(c)&&c.length>0?c.length==i?(r=c.eq(i-1),g&&(a=o.eq(i-1)),e(r).next("tr").hasClass("e-detailsrow")?(e(r).next("tr").after(u),g&&e(a).next("tr").after(n)):(e(r).after(u),g&&e(a).after(n))):(c.eq(i).before(u),g&&o.eq(i).before(n)):this._frozenColumnsLength>0?s._renderFrozenRecords():(s.getContentTable().find("tbody").empty().append(s._getEmptyTbody()),d=document.createElement("div"),s.getContentTable().find("colgroup").first().replaceWith(s._getMetaColGroup()),s.getContentTable().children("tbody").empty(),d.innerHTML=["<table>",e.render[s._id+"_Template"](s.model.currentViewData),"</table>"].join(""),s.getContentTable().get(0).replaceChild(d.firstChild.firstChild,s.getContentTable().get(0).lastChild)),this._gridRows=this.getContentTable().get(0).rows,this._frozenColumnsLength>0&&(this._gridRows=[this._gridRows,this.getContentTable().get(1).rows]),s.setGridRows(e(s.getContentTable().get(0).rows))},onScrollHelper:function(e,t){var i=this;i._isFromChart=t,i.getScrollElement().ejScroller("scrollY",e,!0),!i.getScrollElement().ejScroller("isHScroll")&&this.model.isFromGantt&&i.getScrollElement().scrollTop(e)},isVScroll:function(){return!!this.getScrollElement().hasClass("e-scroller")&&this.getScrollElement().ejScroller("isVScroll")},refreshScroller:function(e){var t,i,l,n,o=this;o._$gridContent.removeClass("e-borderbox"),t=o.getScrollElement().ejScroller("option","scrollTop"),i=o.getScrollElement().ejScroller("option","scrollLeft"),o.getScrollElement().ejScroller("option",{persist:!0}),o.getScrollElement().ejScroller("option",{width:e}),i>(l=o.getMaxScrollWidth())&&(i=l>0?l:0),o._$gridContent.css("height",o._viewPortHeight),o.getScrollElement().ejScroller("refresh"),n=o.getScrollElement().ejScroller("isHScroll"),o.getScrollElement().ejScroller("option",{scrollTop:t}),n&&o.getScrollElement().ejScroller("option",{scrollLeft:i}),o._$gridHeaderContainer.scrollLeft(i),n?this.getScrollElement().scrollTop(0):this.getScrollElement().scrollTop(t)},getMaxScrollHeight:function(){return this.getScrollElement().children(".e-content").children().height()-this.getScrollElement().children(".e-content").height()},getMaxScrollWidth:function(){return this.getScrollElement().children(".e-content").find(".e-table").width()-this.getScrollElement().children(".e-content").width()},refreshHeight:function(){this.getScrollElement().ejScroller("refresh")},getColumnByHeaderText:function(e){for(var t=this.model.columns.length,i=this.model.columns,l=0;l<t&&i[l].headerText!=e;l++);return l==i.length?null:i[l]},hideColumn:function(i){var l,n,o,r,a,d,s=this,c=s.model,u=this.getColumnByHeaderText(i),g=e.inArray(u,c.columns),m=e.inArray(i,s._hiddenColumns);if(!u||s._isColumnHidable(u)){if(-1!=g&&g!=c.treeColumnIndex&&-1==m){s._cancelEditState(),s._hiddenColumns.push(i),s.model.columns[g].visible=!1,s.getHeaderTable().removeClass("e-table"),s.getContentTable().removeClass("e-table"),l=s.getHeaderTable().find("colgroup").find("col"),e(l).eq(g).hide(),n=s.getHeaderTable().find("tr").not(".e-stackedHeaderRow").find(".e-headercell"),e(n).eq(g).addClass("e-hide"),c.allowFiltering&&"filterbar"==c.filterSettings.filterType&&(o=s.getHeaderTable().find("thead").find("th.e-filterbarcell"),e(o).eq(g).addClass("e-hide")),1==s.model.columns[g].isFrozen&&s.setWidthToColumns();var p,h=s.getContentTable().find("colgroup").find("col"),_=!0,f=g;e(h).eq(g).hide(),h=s.getRows(),p=this._getFooterRows(),this._frozenColumnsLength>0?g<this._frozenColumnsLength?(h=e(s.getRows()[0]),p=e(p[0]),s._gridRows&&e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0?(r=parseInt(e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",r-1)):0==s.model.currentViewData.length&&(t.isNullOrUndefined(s._gridRows)||0==s._gridRows.length)&&(r=parseInt(e(s.getContentTable()[0]).find("tbody").find("td").attr("colspan")),e(s.getContentTable()[0]).find("tbody").find("td").attr("colspan",r-1))):(h=e(s.getRows()[1]),p=e(p[1]),_=!1,f=g-this._frozenColumnsLength,s._gridRows&&e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0?(r=parseInt(e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",r-1)):0==s.model.currentViewData.length&&(t.isNullOrUndefined(s._gridRows)||0==s._gridRows.length)&&(r=parseInt(e(s.getContentTable()[1]).find("tbody").find("td").attr("colspan")),e(s.getContentTable()[1]).find("tbody").find("td").attr("colspan",r-1))):0!=s.model.currentViewData.length||!t.isNullOrUndefined(s._gridRows)&&0!=s._gridRows.length?s._gridRows&&e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(r=parseInt(e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",r-1)):s.getContentTable().find("tbody").find("td").attr("colspan",s.model.columns.length-s._hiddenColumns.length),h.each(function(){var t=e(this).children("td").eq(f);e(t).addClass("e-hide"),c.showSummaryRow&&e(t).hasClass("e-summaryrowcell")&&_&&s._updateSummaryRowTitleCell(l,t[0].parentElement)}),c.showTotalSummary&&(a=s._$footertableContent.find("colgroup").find("col"),e(a).eq(g).hide(),p.each(function(){var t=e(this).children("td").eq(f);e(t).addClass("e-hide"),e(t).hasClass("e-footersummaryrowcell")&&s._updateSummaryRowTitleCell(a,t[0].parentElement)})),s.getHeaderTable().addClass("e-table"),s.getContentTable().addClass("e-table"),d=s.getScrollElement(),c.isFromGantt&&s._trigger("refreshScrollCss"),c.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||c.isFromGantt||this._updateTableWidth(),d.ejScroller("refresh"),s._updateScrollCss(),s._updateHeaderScrollLeft(),c.isFromGantt&&!d.ejScroller("isHScroll")&&d.scrollTop(d.data("ejScroller").scrollTop()),-1!=(g=e.inArray(i,s._visibleColumns))&&s._visibleColumns.splice(g,1),(c.showColumnChooser||c.contextMenuSettings.showContextMenu)&&(s._renderColumnChooserList(!0,i),s._updateColumnMenuVisibility()),s._addInitTemplate(),c.showTotalSummary&&c.collapsibleTotalSummary&&s._updateSummaryTitleColumn(),c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&(t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)||""==c.editSettings.dialogEditorTemplateID)?s._treeGridAddEditDialog():c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&!t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)&&""!=c.editSettings.dialogEditorTemplateID&&s._treeGridAddEditDialogTemplate()}this.model.showStackedHeader&&this._refreshStackedHeader(),c.isFromGantt&&s.updateToGanttColumns()}},clearFilter:function(i){var l,n,o,r,a=this,d=a.model;if(t.isNullOrUndefined(i)){for((l=d.filterSettings.filteredColumns)&&l.length;l&&l.length>0;)a.clearFilter(l[0].field);a._filteredColumnValue=[],a._filteredColumnValueID=[]}else n=a.getColumnByField(i),o=e.grep(d.filterSettings.filteredColumns,function(e){return e.field===i}),n&&o.length>0&&("immediate"==d.filterBarMode&&"numericedit"==n.filterEditType||(a._filterString="",a._fieldName="",a.filterColumn(i,"equal","","and"),a._storePreviousFilteredValue(a._fieldName,a._filterString,this._operator)),a._clearFilterElementValue(n),"menu"==d.filterSettings.filterType&&"excel"!=n.filterType||"excel"==d.filterSettings.filterType&&"menu"==n.filterType?(r=a._filteredColumnValueID.indexOf(n.field),a._filteredColumnValue.splice(r,1),a._filteredColumnValueID.splice(r,1)):("excel"==d.filterSettings.filterType&&"menu"!=n.filterType||"menu"==d.filterSettings.filterType&&"excel"==n.filterType)&&(r=a._filteredColumnValueID.indexOf(n.field),a._filteredColumnValueID.splice(r,1)),a._isExcelFilter&&a._excelFilter._predicates[0]&&delete a._excelFilter._predicates[0][n.field],d.showColumnChooser||a.getHeaderTable().find("div[data-ej-mappingname='"+n.field+"']").next(".e-filtericon").removeClass("e-column-filtered-icon").addClass("e-column-filter-icon"))},getColumnByField:function(e){for(var t=this.model.columns,i=0;i<t.length&&t[i].field!=e;i++);return i==t.length?null:t[i]},_clearFilterElementValue:function(t){var i=t.field.split(".").join(""),l=e("#"+this._id+"_"+i+"_filterbarcell");if(l&&l.length)switch(t.filterEditType){case"stringedit":e(l).val("");break;case"booleanedit":e(l).prop("checked",!1);break;case"numericedit":e(l).ejNumericTextbox("instance").option("value","");break;case"dropdownedit":e(l).ejDropDownList("instance").option("value","");break;case"datepicker":e(l).ejDatePicker("instance").option("value","");break;case"datetimepicker":e(l).ejDateTimePicker("instance").option("value","")}},_updateSummaryRowTitleCell:function(t,i){for(var l,n=t.length,o=0;o<n;o++)if("none"!=e(t[o]).css("display")){if(l=e(i).find(".e-summarytitle")[0],e(i.childNodes[o]).find(".e-summarytitle")[0])return;return void e(i.childNodes[o]).prepend(l)}},_updateFrozenColumnOnResize:function(e){var t,i,l,n,o=this,r=o.model,a=r.columns;if(this._getFrozenColumnWidth()+18>this._gridWidth){for(t=0,i=-1,n=0;n<o._frozenColumnsLength;n++)1==a[n].visible&&t<a[n].width&&(t=a[n].width,i=n);if(a[e].width<t-r.commonWidth)a[i].width==t&&(a[i].width=o.columnsWidthCollection[i]=a[i].width-a[e].width);else for(r.columns[e].width>r.commonWidth&&(r.columns[e].width=r.commonWidth),l=Math.round(a[e].width/o._frozenColumnsLength),n=0;n<o._frozenColumnsLength;n++)1==a[n].isFrozen&&1==a[n].visible&&(a[n].width=o.columnsWidthCollection[n]=a[n].width-l)}},showColumn:function(i){var l,n,o,r,a,d,s=this,c=s.model,u=this.getColumnByHeaderText(i),g=e.inArray(u,c.columns),m=e.inArray(i,s._visibleColumns);if(-1!=g&&-1==m){s._cancelEditState(),s._visibleColumns.push(i),s.model.columns[g].visible=!0,l=s.getHeaderTable().find("colgroup").find("col"),e(l).eq(g).show(),n=s.getHeaderTable().find("tr").not(".e-stackedHeaderRow").find(".e-headercell"),e(n).eq(g).removeClass("e-hide"),c.allowFiltering&&"filterbar"==c.filterSettings.filterType&&(o=s.getHeaderTable().find("thead").find("th.e-filterbarcell"),e(o).eq(g).removeClass("e-hide")),1==s.model.columns[g].isFrozen&&(s._updateFrozenColumnOnResize(g),s.setWidthToColumns());var p,h=s.getContentTable().find("colgroup").find("col"),_=!0,f=g;e(h).eq(g).show(),h=s.getRows(),p=this._getFooterRows(),this._frozenColumnsLength>0?g<this._frozenColumnsLength?(h=e(s.getRows()[0]),p=e(p[0]),s._gridRows&&e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(r=parseInt(e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[0]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",r+1))):(h=e(s.getRows()[1]),p=e(p[1]),_=!1,f=g-this._frozenColumnsLength,s._gridRows&&e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(r=parseInt(e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()[1]).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",r+1))):s._gridRows&&e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").length>0&&(r=parseInt(e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan")),e(s.getTreeGridRows()).find(".e-detailscellwrapper").parent(".e-detailsrowcell").attr("colspan",r+1)),h.each(function(){var t=e(this).children("td").eq(f);e(t).removeClass("e-hide"),c.showSummaryRow&&e(t).hasClass("e-summaryrowcell")&&_&&s._updateSummaryRowTitleCell(l,t[0].parentElement)}),c.showTotalSummary&&(a=s._$footertableContent.find("colgroup").find("col"),e(a).eq(g).show(),p.each(function(){var t=e(this).children("td").eq(f);e(t).removeClass("e-hide"),e(t).hasClass("e-footersummaryrowcell")&&s._updateSummaryRowTitleCell(a,t[0].parentElement)})),s._addInitTemplate(),c.showTotalSummary&&c.collapsibleTotalSummary&&s._updateSummaryTitleColumn(),d=s.getScrollElement(),c.isFromGantt&&s._trigger("refreshScrollCss"),c.columnResizeSettings.columnResizeMode!=t.TreeGrid.ColumnResizeMode.FixedColumns||c.isFromGantt||this._updateTableWidth(),d.ejScroller("refresh"),s._updateScrollCss(),s._updateHeaderScrollLeft(),c.isFromGantt&&!d.ejScroller("isHScroll")&&d.scrollTop(d.data("ejScroller").scrollTop()),-1!=(g=e.inArray(i,s._hiddenColumns))&&s._hiddenColumns.splice(g,1),(c.showColumnChooser||c.contextMenuSettings.showContextMenu)&&(s._renderColumnChooserList(!0,i),s._updateColumnMenuVisibility()),c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&(t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)||""==c.editSettings.dialogEditorTemplateID)?s._treeGridAddEditDialog():c.editSettings.allowEditing&&"dialogEditing"==c.editSettings.editMode&&!t.isNullOrUndefined(c.editSettings.dialogEditorTemplateID)&&""!=c.editSettings.dialogEditorTemplateID&&s._treeGridAddEditDialogTemplate()}this.model.showStackedHeader&&this._refreshStackedHeader(),c.isFromGantt&&s.updateToGanttColumns()},getHiddenColumns:function(){for(var e=this,t=(e.model,e._hiddenColumns),i=t.length,l=[],n=0;n<i;n++)l.push(e.getColumnByHeaderText(t[n]));return l},getColumnByIndex:function(e){var t=this.model.columns;return t.length>e?t[e]:null},getVisibleColumns:function(){for(var e=this,t=(e.model,e._visibleColumns),i=t.length,l=[],n=0;n<i;n++)l.push(e.getColumnByHeaderText(t[n]));return l},_getLastVisibleColumnIndex:function(){for(var e=this.model.columns,t=-1,i=e.length-1;i>=0;i--)if(0!=e[i].visible){t=i;break}return t},cancelEdit:function(){this._isRowEdit?this.cancelRowEditCell():this.model.isEdit&&this.cancelEditCell()},redraw:function(){this.resetModelCollections(),this._clearColumnMenu(),this._clearContextMenu(),this._removeDetailsRow(),this.element.empty(),this.element.off();jQuery.uaMatch(navigator.userAgent);var i=this,l=this.model;i._off(i.element,"click",i._onClick),i._off(i.element,"keydown",i._keyDown),i._off(i.element,"click","#"+i._id+"e-gridheader",i._onHeaderClick),i._off(i.element,"mousedown touchstart","#"+i._id+"e-gridheader",i._headerMouseDown),i._off(e(document),"mousedown touchstart",i._mouseDownHandler),i._off(i.element,"mousedown touchstart",".e-gridcontent",i._contentMouseDown),i._off(i.element,"click",i._onRecordClick),i._off(i.element,"dblclick",".e-gridcontent > div",i._onRecordDoubleClick),"immediate"==l.filterSettings.filterBarMode&&(i._off(i.element,"keyup",".e-filterbarcell input",i._filterBarHandler),i._off(i.element,"click",".e-filterbarcell .e-checkbox")._off(i.element,"click",".e-filterbarcell .e-checkbox",i._filterBarHandler)),i._off(i.element,"focus click",".e-filterbarcell input",i._filterBarClose),i._off(i.element,"click",".e-filterbarcell .e-cancel",i._filterBarClose),i.model.showGridCellTooltip&&!i.model.showGridExpandCellTooltip?"msie"==t.browserInfo().name?i._off(i.element,"mouseenter",".e-rowcell",i._mouseHover):i._off(i.element,"mousemove",".e-rowcell",i._mouseHover):i._off(i.element,"mouseenter",".e-rowcell",i._mouseHover),i.model.showGridCellTooltip&&("msie"==t.browserInfo().name?i._off(i.element,"mouseenter",".e-headercelldiv",i._headermouseHover):i._off(i.element,"mousemove",".e-headercelldiv",i._headermouseHover)),i._off(i.element,"mouseleave",".e-rowcell",i._cellMouseLeave),i._off(i.element,"mouseleave",i._cellMouseLeave),i._off(i.element,"mouseleave",".e-headercelldiv",i._headerMouseLeave),i._off(i.element,"mouseleave",i._headerMouseLeave),(l.isFromGantt||this._frozenColumnsLength)&&i._off(i.element,"mousewheel DOMMouseScroll",i._mouseWheel),l.enableResize&&l.isResponsive&&!l.isFromGantt&&i._off(e(window),"resize",i._windowResize),t.isTouchDevice()?i._off(i.element,"doubletap ",".e-gridcontent",i._editdblClickHandler):i._off(i.element,"dblclick ",".e-gridcontent",i._editdblClickHandler),l.contextMenuSettings.showContextMenu&&i._off(i.element,"keyup contextmenu taphold",this._preventContextMenu),this._init()},clearColumnMenu:function(){this._clearColumnMenu()},export:function(i,l,n){var o,r,a,d,s,c,u,g,m=this,p=m.model;return m.contextMenuOperations("Cancel"),o=m._getExportModel(p),r={action:i,method:"post","data-ajax":"false"},e("form#"+m._id+"export").remove(),a=t.buildTag("form#"+m._id+"export","",null,r),t.raiseWebFormsServerEvents?(d={model:o,originalEventType:l},s={model:JSON.stringify(o)},t.raiseWebFormsServerEvents(l,d,s)):(c={},n?e("body").find(".e-treegrid").each(function(i,l){var n,o,r,d,s=e(l).data("ejTreeGrid");t.isNullOrUndefined(s)||(n=s.model,o=m._getExportModel(n),c[i]=JSON.stringify(o),r={name:"TreeGridModel",type:"hidden",value:JSON.stringify(o)},d=t.buildTag("input","",null,r),a.append(d))}):(u={name:"TreeGridModel",type:"hidden",value:JSON.stringify(o)},g=t.buildTag("input","",null,u),a.append(g),a.append(this)),e("body").append(a),a.submit()),!0},_getExportModel:function(t){var l,n,o,r,a,d,s,c,u,g,m=t,p=m.updatedRecords,h=m.currentViewData,_=m.flatRecords,f=m.parentRecords,w=m.summaryRowRecords,C=m.selectedItem,x=m.selectedItems;delete m.updatedRecords,delete m.currentViewData,delete m.flatRecords,delete m.parentRecords,delete m.summaryRowRecords,delete m.selectedItem,delete m.selectedItems,l=e.extend(!0,{},m),m.updatedRecords=p,m.currentViewData=h,m.flatRecords=_,m.parentRecords=f,m.selectedItem=C,m.selectedItems=x,m.summaryRowRecords=w;var v=l.columns,S=v.length,R=l.stackedHeaderRows,T=l.filterSettings.filteredColumns,b=T.length;for(g=0;g<S;g++){if(l.columns[g].editType!=i)switch(v[g].editType){case"stringedit":case"edittemplate":v[g].editType="string";break;case"numericedit":v[g].editType="numeric";break;case"dropdownedit":v[g].editType="dropdown";break;case"booleanedit":v[g].editType="boolean"}if(v[g].filterEditType!=i)switch(v[g].filterEditType){case"stringedit":v[g].filterEditType="string";break;case"numericedit":v[g].filterEditType="numeric";break;case"dropdownedit":v[g].filterEditType="dropdown";break;case"booleanedit":v[g].filterEditType="boolean"}}for(g=0;g<b;g++)"equal"==T[g].operator?T[g].operator="equals":"notequal"==l.filterSettings.filteredColumns[g].operator&&(T[g].operator="notequals");if(m.showStackedHeader&&R.length>0)for(n=0;n<R.length;n++)for(o=R[n].stackedHeaderColumns,r=0;r<o.length;r++)a=Array.isArray(o[r].column)?o[r].column:e.map(o[r].column.split(","),e.trim),o[r].column=a;if(l.showStackedHeader)for(l.stackedHeaderRow=l.stackedHeaderRows,g=0;g<l.stackedHeaderRow.length;g++)for(l.stackedHeaderRow[g].stackedHeaderColumn=l.stackedHeaderRow[g].stackedHeaderColumns,d=l.stackedHeaderRow[g].stackedHeaderColumn,s=0;s<d.length;s++)l.stackedHeaderRow[g].stackedHeaderColumn[s].column=e.isArray(d[s].column)?d[s].column:d[s].column.split(",");if(u=(c=this.ignoreOnExport).length,this.ignoreOnExport)for(g=0;g<u;g++)delete l[c[g]];return l},_getNonContentHeight:function(){var i,l=this,n=l.model,o=0;return i=l.model.isFromGantt?0:1,o=l._$gridHeaderContent.outerHeight()+parseFloat(i),l.model.toolbarSettings.showToolbar&&(o+=t.isNullOrUndefined(e("#"+l._id+"_toolbarItems").outerHeight())?0:e("#"+l._id+"_toolbarItems").outerHeight()),n.allowPaging&&(o+=l.element.find(".e-pager").outerHeight()),o},_getViewPortHeight:function(){var t=this;return"auto"==t.model.sizeSettings.height?t._frozenColumnsLength>0?1==e("#"+t._id+"e-gridcontent").find(".e-hscrollbar").length?e("#"+t._id+"movablee-table").height()+18:e("#"+t._id+"movablee-table").height():1==e("#"+t._id+"e-gridcontent").find(".e-hscrollbar").length?e("#"+t._id+"e-table").height()+18:e("#"+t._id+"e-table").height():this.element.height()-this._getNonContentHeight()},updateViewPortHeight:function(){this._viewPortHeight=this._getViewPortHeight()},_updateScrollCss:function(){var t,i=this,l=i.model;if(!l.isFromGantt){var n=i.isVScroll(),o=(i._$gridHeaderContent.hasClass("e-scrollcss"),/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor));o&&i._$gridHeaderContent.removeClass("e-gridheader"),n?(this.mobileDevice()||i._$gridHeaderContent.addClass("e-scrollcss"),l.showTotalSummary&&i._$totalSummaryRowContainer&&i._$totalSummaryRowContainer.height()<=l.totalSummaryHeight&&0==i._$totalSummaryRowContainer.find(".e-vscrollbar").length&&(this.mobileDevice()?i._$totalSummaryRowContainer.width(i._$gridContent.width()):(i._$totalSummaryRowContainer.addClass("e-scrollcss"),i._$totalSummaryRowContainer.width(i._$gridContent.width()-17)))):(i._$gridHeaderContent.removeClass("e-scrollcss"),l.showTotalSummary&&i._$totalSummaryRowContainer&&i._$totalSummaryRowContainer.height()<=l.totalSummaryHeight&&(i._$totalSummaryRowContainer.removeClass("e-scrollcss"),i._$totalSummaryRowContainer.width(i._$gridContent.width()))),i.getScrollElement().hasClass("e-scroller")&&this._updateHeaderScrollLeft(this.getScrollElement().ejScroller("model.scrollLeft")),this._frozenColumnsLength&&((t="auto"==l.sizeSettings.height?e("#"+i._id+"movablee-table").height():this.getContent().find("#e-movablecontent"+i._id).height())!=this.getContent().find("#e-frozencontainer"+i._id).height()&&this.getContent().find("#e-frozencontainer"+i._id).height(t)),o&&(i._$gridHeaderContent[0].style.width=i._gridWidth+"px",i._$gridHeaderContent.addClass("e-gridheader")),i._resizeFilteringElements()}},_updatePagerIndex:function(){var e,i,l,n=this,o=n.model,r=[],a=-1,d=-1,s=o.updatedRecords;if(o.allowPaging){if(e=o.pageSettings.pageSize,o.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root){var c,u=n._isHierarchyFiltering?n._filterParentRecords:o.parentRecords.slice(),g=-1;n._gridRecordsCount=u.length,i=0==n._isLoadonDemand?n._gridRecordsCount<1?0:0==e?0:Math.ceil(n._gridRecordsCount/e):Math.ceil(n._pageRecordCountOnDemand/e),n._currentPage()>i&&n._currentPage(i),c=n._currentPage()*e>n._gridRecordsCount?n._gridRecordsCount:n._currentPage()*e,g=n._gridRecordsCount<=e?0:n._currentPage()*e-e,a=s.indexOf(u[c]),g>c?g=c-e:n._gridRecordsCount==c&&(a=s.length),d=s.indexOf(u[g]),n._updatedPageData=n._isHierarchyFiltering&&n.model.enableVirtualization?n._updateFilterParent.slice(d,a):this.getExpandedRecords(s.slice(d,a))}else r=this.getExpandedRecords(s),n._gridRecordsCount=o.enableVirtualization?n._isHierarchyFiltering?n._updateFilterParent.length:s.length:r.length,l=n._gridRecordsCount<1?0:0==e?0:Math.ceil(n._gridRecordsCount/e),n._currentPage()>l&&n._currentPage(l),a=n._currentPage()*e>n._gridRecordsCount?n._gridRecordsCount:n._currentPage()*e,(d=n._gridRecordsCount<e?0:n._currentPage()*e-e)>a&&(d=a-e),n._updatedPageData=n._isHierarchyFiltering&&n.model.enableVirtualization?n._updateFilterParent.slice(d,a):r.slice(d,a);n.updateHeight()}},_updateCurrentViewData:function(i){var l,n,o,r,a,d=this,s=d.model,c={},u=!1;s.enableVirtualization?(s.allowPaging?(i!=t.TreeGrid.Actions.Scroll&&d._updatePagerIndex(),d.getVisibleRange(i),s.currentViewData=s.sizeSettings.height?d._updatedPageData.slice(d._visibleRange.top,d._visibleRange.bottom):d._isHierarchyFiltering&&d.model.enableVirtualization?d._updateFilterParent:d._updatedPageData):(d.getVisibleRange(i),n=d._isHierarchyFiltering&&d.model.enableVirtualization?d._updateFilterParent:d.model.updatedRecords,s.currentViewData=n.slice(d._visibleRange.top,d._visibleRange.bottom)),s.allowDragAndDrop&&d._dragMouseDown&&d._isTouchEvent&&(o=d.getUpdatedRecords().indexOf(d._draggedRecord),(d._visibleRange.top>o+1||d._visibleRange.bottom<o)&&(d._dummyElement||(r=d._draggedElement.clone(),d._draggedElement.before(r),d._draggedElement.hide(),e(d.element).append(d._draggedElement),d._dummyElement=!0))),0!==d._vScrollDist&&(l=d._scrollTop-d._offset,c.requestType=i&&i==t.TreeGrid.Actions.Scroll?t.TreeGrid.Actions.Scroll:i&&i==t.TreeGrid.Actions.ExpandCollapse?t.TreeGrid.Actions.ExpandCollapse:t.TreeGrid.Actions.Refresh,"expandcollapse"!=i&&d.sendDataRenderingRequest(c),s.allowTextWrap&&s.enableVirtualization&&"scroll"==i&&(d._updateWrapRowHeights("total,header"),d._textWrapRowsDatas=d._getAvgTextWrapRowHeight("getAvgHeight")),u=!0,this._frozenColumnsLength>0?(d._$frozenTableContent.css({top:l}),d._$movableTableContent.css({top:l})):d._$tableContent.css({top:l}),s.allowTextWrap&&s.enableVirtualization&&(d._textWrapRowsDatas.isEnd&&!d._textWrapNoCalculate?(d.updateHeight(),d._textWrapNoCalculate=!0):parseInt(d._scrollTop)>=parseInt(d.getMaxScrollHeight()-10)&&!d._textWrapRowsDatas.isEnd&&!d._textWrapNoCalculate&&(d.updateHeight("extendHeight"),d._textWrapNoCalculate=!1),d._scrollTop>=d.getMaxScrollHeight()-10&&"expandcollapse"!=i&&(l=(a=d.getMaxScrollHeight())-(this._frozenColumnsLength>0?a+e("#"+d._id+"frozene-table").height()-e("#"+d._id+"e-gridcontainer").height():a+e("#"+d._id+"e-table").height()-e("#"+d._id+"e-gridcontainer").height()),this._frozenColumnsLength>0?(d._$frozenTableContent.css({top:l}),d._$movableTableContent.css({top:l})):d._$tableContent.css({top:l})),d._scrollTop<30&&(d._textWrapNoCalculate=!1))),d._prevRTop=d._visibleRange.top,d._prevRBottom=d._visibleRange.bottom):s.allowPaging?(d._updatePagerIndex(),s.currentViewData=d._updatedPageData):s.currentViewData=d.model.updatedRecords.slice(),d._isEnterKeyPressed&&(d._isEnterKeyPressed=!1,s.allowSelection&&s.editSettings.allowEditing&&(u||(d._cellEditingDetails.rowIndex+=1),d._rowSelectingEventTrigger(this.selectedRowIndex(),d._cellEditingDetails.rowIndex)||(d.selectRows(d._cellEditingDetails.rowIndex),d._rowSelectedEventTrigger(d._cellEditingDetails.rowIndex)),d.cellEdit(d._cellEditingDetails.rowIndex,d.model.columns[d._cellEditingDetails.columnIndex].field)))},_findFilteredParentRecords:function(e){for(var t=e.length,i=[],l=0;l<t;l++)e[l].hasChildRecords&&i.push(e[l]);return i},_getRowPosition:function(e){return Math.ceil(e/(this.model.rowHeight+this._detailsRowHeight))},_getMetaColGroup:function(){return this.getHeaderTable().find("colgroup").clone()},_getEmptyTbody:function(){var i=t.buildTag("td",this.model.emptyRecordText,{},{colSpan:this.model.columns.length-this._hiddenColumns.length}),l=document.createElement("tr");return l.className="e-emptyText",e(l).height(30).append(i)},_addSortElementToColumn:function(i,l){var n,o,r,a=this;this.model.isFromGantt?(n=t.TreeGrid.getColumnByMappingName(a.model.columns,i),t.isNullOrUndefined(n)&&(n=a.getColumnByField(i))):n=t.TreeGrid.getColumnByField(a.model.columns,i),o=e.inArray(n,a.model.columns),(r=this.getHeaderTable().find("thead tr:not('.e-stackedHeaderRow')").find(".e-headercell").not(".e-detailheadercell").eq(o).find(".e-headercelldiv")).find(".e-ascending,.e-descending").remove(),r.append(a._createSortElement().addClass("e-"+l).addClass("e-icon")),r.parent().attr("aria-sort",l)},_createSortElement:function(){return t.buildTag("span","&nbsp;")},_renderCellEditObject:function(i,l){var n,o,r,a=this,d=t.buildTag("form.e-treegridform#"+a._id+"EditForm","",{},{}),s=a._cellEditTemplate,c={},u=i.columnObject,g=u.field.split(".").join(""),m=i.value;"dropdownedit"==u.editType&&0==m&&(m=m.toString()),c[g]=m,a.getColumnIndexByField(u.field),l.empty(),l.addClass("e-validError"),o=s.find("#"+g+"_CellEdit").html(),"SELECT"==(n="predecessor"===u.field||"duration"===u.field?e(e.templates(o).render(i.data)):e(e.templates(o).render(c))).get(0).tagName&&(n.val(c[g]),null==n.val()&&n.val(n.find("option").first().val())),"INPUT"==n.get(0).tagName&&a.model.isFromGantt?"predecessor"!=u.field&&"duration"!=u.field&&n.val(c[g]):"INPUT"==n.get(0).tagName&&n.val(c[g]),d.append(n),l.append(d),(r={}).columnIndex=i.columnIndex,r.data=i.data.item,r.requestType="beginEdit",a._refreshEditForm(r),e.isFunction(e.validator)&&!e.isEmptyObject(i.validationRules)&&(a._initValidator(),a.setValidation()),a.model.isEdit=!0},getIndexofresourceInfo:function(e){for(var t,i=this.model.resourceIdMapping,l=this._cellEditingDetails.data.resourceInfo,n=0,o=l&&l.length,r=[];n<o;n++)for(t=0;t<e.length;t++)e[t][i]==l[n][i]&&r.push(t);return r},_refreshEditForm:function(l){var n,o,r,a,d,s,c,u,g,m,p=this,h=p.model;p.model.editSettings.allowEditing&&("dialogEditing"==p.model.editSettings.editMode||"batchediting"==h.editSettings.editMode.toLowerCase()&&"dialog"==h.editSettings.batchEditSettings.editMode)?(n=e("#"+p._id+"EditFormDialog"),o="",r=!0):(n=e("#"+p._id+"EditForm"),o=p.model.rowHeight-5);for(var _,f,w,C,x,v,S,R=!1,T=e("#"+p._id+"EditFrozenForm").add(n).find("input,select,textarea"),b=0,y=T.length,I=(h=p.model,{});b<y;b++)if(S=(_=T.eq(b)).attr("data-edittype"),x=t.TreeGrid.getColumnByField(h.columns,_.prop("name")),t.isNullOrUndefined(x)&&("dialogEditing"==p.model.editSettings.editMode||"batchediting"==h.editSettings.editMode.toLowerCase()&&"dialog"==h.editSettings.batchEditSettings.editMode)){if(_.hasClass("e-btn")||"dialogEditing"==p.model.editSettings.editMode&&!t.isNullOrUndefined(h.editSettings.dialogEditorTemplateID)&&""!=h.editSettings.dialogEditorTemplateID)return;_.closest("tr").addClass("e-hide")}else{switch("dialogEditing"!=p.model.editSettings.editMode&&("batchediting"!=h.editSettings.editMode.toLowerCase()||"dialog"!=h.editSettings.batchEditSettings.editMode)||t.isNullOrUndefined(h.editSettings.dialogEditorTemplateID)||""==h.editSettings.dialogEditorTemplateID||(S=x.editType),f="100%",S){case t.TreeGrid.EditingType.Numeric:I={},w=f,C=_.val(),I.width=w,I.locale=h.locale,I.height=o,I.showSpinButton=!0,I.cssClass=h.cssClass,C.length&&(I.value=parseFloat(C)),h.isFromGantt&&"status"===x.field&&(I.minValue=0,I.maxValue=100,I.decimalPlaces=0),t.isNullOrUndefined(x.editParams)||e.extend(I,x.editParams),_.ejNumericTextbox(I),_.prop("name",_.prop("name").replace(p._id,""));break;case t.TreeGrid.EditingType.DatePicker:(I={}).width=f,I.height=o,I.locale=h.locale,I.cssClass=h.cssClass,I.dateFormat=h.dateFormat,I.enableStrictMode=!0,h.isFromGantt&&(I.startDay=h.weekStartDay),_.val().length&&(I.value=p.getDateFromFormat(_.val())),x.format!==i&&x.format.length>0&&(v=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(x.format),I.dateFormat=v[2],_.val().length&&(I.value=t.format(new Date(_.val()),I.dateFormat,I.locale),_.val(I.value))),t.isNullOrUndefined(x.editParams)||e.extend(I,x.editParams),-1==h.dateFormat.toLowerCase().indexOf("hh")?_.ejDatePicker(I):_.ejDateTimePicker(I);break;case t.TreeGrid.EditingType.DateTimePicker:(I={}).width=f,I.height=o,I.locale=h.locale,I.cssClass=h.cssClass,I.displayDefaultDate=!0,I.dateTimeFormat=h.dateFormat,I.enableStrictMode=!0,h.isFromGantt&&(I.startDay=h.weekStartDay),_.val().length&&(I.value=p.getDateFromFormat(_.val())),x.format!==i&&x.format.length>0&&(v=new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(x.format),I.dateTimeFormat=v[2],_.val().length&&(I.value=t.format(new Date(_.val()),I.dateTimeFormat,I.locale),_.val(I.value))),t.isNullOrUndefined(x.editParams)||e.extend(I,x.editParams),_.ejDateTimePicker(I);break;case t.TreeGrid.EditingType.Dropdown:p._isRowEdit,a=x.dropdownData,d=x.field,h.isFromGantt&&"resourceInfo"===d?((I={}).width=f,I.height=o,I.showCheckbox=!0,I.dataSource=a,I.fields={id:h.resourceIdMapping,text:h.resourceNameMapping,value:h.resourceNameMapping},I.selectedItems=p.getIndexofresourceInfo(a),t.isNullOrUndefined(x.editParams)||e.extend(I,x.editParams),_.ejDropDownList(I)):((u={}).cssClass=h.cssClass,u.width=f,u.height=o,u.dataSource=a,t.isNullOrUndefined(x.editParams)||e.extend(u,x.editParams),_.ejDropDownList(u),_.ejDropDownList("instance")._setValue(_.attr("data-cellvalue")));break;case t.TreeGrid.EditingType.String:p.model.editSettings.allowEditing&&"dialogEditing"==p.model.editSettings.editMode?_.outerWidth("100%").height(27):_.outerWidth(f).height(h.rowHeight-9),_.css({margin:"0px",padding:"1px"});break;case t.TreeGrid.EditingType.Boolean:p._checkboxSelection&&x.nonColumn?_[0].style.display="none":((u={}).cssClass=h.cssClass,u.size="small",t.isNullOrUndefined(x.editParams)||e.extend(u,x.editParams),_.ejCheckBox(u),c=(s=_.parent(".e-chkbox-wrap")).parent("form"),r||(c.length>0?c.css("margin-left","45%"):s.css("margin-left","45%")));break;case t.TreeGrid.EditingType.Maskedit:(u={}).locale=h.locale,u.cssClass=h.cssClass,u.width=f,u.height=o,t.isNullOrUndefined(x.editParams)||e.extend(u,x.editParams),_.ejMaskEdit(u);break;case"edittemplate":g={rowdata:l.data,column:x,element:_,requestType:l.requestType},m=x.editTemplate.write,t.isNullOrUndefined(l)||"add"!=l.requestType||(g.rowdata={}),"string"==typeof m&&(m=t.util.getObject(m,window)),m(g)}_.is(":disabled")||R||_.is(":hidden")&&"object"!=typeof(_.data("ejDropDownList")||_.data("ejNumericTextbox")||_.data("ejDatePicker")||_.data("ejCheckBox"))||(p._isEnterKeyPressed||x!=h.columns[l.columnIndex])&&(l.columnIndex&&-1!=l.columnIndex||p._isEnterKeyPressed)||(p._focusElements(_.closest("td")),R=!0)}},_getRecordIndex:function(){var e=this,t=e.model,i=t.allowPaging?e._updatedPageData:e.getExpandedRecords(t.updatedRecords);return e.getVisibleRange(),i.slice(e._visibleRange.top,e._visibleRange.bottom).indexOf(t.selectedItem)},_initValidator:function(){for(var t=this,i=this._frozenColumnsLength>0?this.element.find(".e-treegridform"):e("#"+this._id+"EditForm").length>0?e("#"+this._id+"EditForm"):e("#"+this._id+"EditFormDialog"),l=0;l<i.length;l++)i.eq(l).validate({ignore:".e-hide",errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(e,i){t._renderValidator(e,i)}})},_renderValidator:function(i,l){var n,o,r,a;if(l.is(":hidden")&&(l=l.siblings("input:visible")),l.length){var d,s=this,c=s.model,u=l.closest(".e-rowcell"),g=e(i).addClass("e-error"),m=t.buildTag("div.e-errortail");(u=0==u.length?l.closest("td"):u).removeClass(".e-error"),"dialogEditing"!=c.editSettings.editMode?(n=((d=s._getRecordIndex())+1)*c.rowHeight,c.enableVirtualization||(o=s.getExpandedRecords(c.updatedRecords),d=c.allowPaging?s._updatedPageData.indexOf(c.selectedItem):o.indexOf(c.selectedItem)),-1==d&&("bottom"==c.editSettings.rowPosition?d=c.updatedRecords.length-1:"top"==c.editSettings.rowPosition&&(d=0),n=(d+1)*c.rowHeight),s._viewPortHeight<n+45?(m.addClass("e-bottomarrow"),r=d*c.rowHeight-45,a="append"):(m.addClass("e-toparrow"),r=(d+1)*c.rowHeight,a="prepend")):(r=u.offset().top-e("#"+this._id+"EditFormDialog").offset().top+u.parent()[0].offsetHeight,m.addClass("e-toparrow"),a="prepend"),e(g).css({top:r}),l.parent().hasClass("e-in-wrap")?g.insertAfter(l.closest(".e-widget")):g.insertAfter(l),g[a](m),g.show("slow")}},setValidation:function(){for(var e=this,i=e.model,l=0;l<this.model.columns.length;l++)if(!t.isNullOrUndefined(i.columns[l].validationRules)&&1==i.columns[l].visible)if(i.editSettings.editMode==t.TreeGrid.EditMode.RowEditing||i.editSettings.editMode==t.TreeGrid.EditMode.DialogEditing||e.element.find(".e-rowedit").length>0||e.element.find(".e-addedrow").length>0||i.editSettings.editMode==t.TreeGrid.EditMode.BatchEditing&&("dialog"==i.editSettings.batchEditSettings.editMode||"row"==i.editSettings.batchEditSettings.editMode))this.setValidationToField(i.columns[l].field,i.columns[l].validationRules);else if((i.editSettings.editMode==t.TreeGrid.EditMode.CellEditing||i.editSettings.editMode==t.TreeGrid.EditMode.BatchEditing&&"cell"==i.editSettings.batchEditSettings.editMode)&&e._cellEditingDetails.columnIndex==l)return void this.setValidationToField(i.columns[l].field,i.columns[l].validationRules)},setValidationToField:function(i,l){var n,o,r,a,d,s=i;t.isNullOrUndefined(i)||(s=s.replace(/[^a-z0-9\s_]/gi,"")),r=e("#"+this._id+"EditForm").length>0?e("#"+this._id+"EditForm"):e("#"+this._id+"EditFormDialog"),o=this.getColumnByField(i),!t.isNullOrUndefined(o)&&o.isFrozen&&(r=e("#"+this._id+"EditFrozenForm").length>0?e("#"+this._id+"EditFrozenForm"):e("#"+this._id+"EditFormDialog").length>0?e("#"+this._id+"EditFormDialog"):e("#"+this._id+"EditForm")),n=r.find("#"+this._id+s).length>0?r.find("#"+this._id+s):r.find("#"+s),l.regex&&(l[i+"regex"]=l.regex,delete l.regex,e.validator.addMethod(s+"regex",function(e,t,i){return(i instanceof RegExp?i:new RegExp(i)).test(e)},t.getObject("messages.regex",l)||this.getColumnByField(i).headerText+" should match the given pattern")),n.attr("name")||n.attr("name",i),n.rules("add",l),(a=e("#"+this._id+"EditForm").length>0?e("#"+this._id+"EditForm").validate():e("#"+this._id+"EditFormDialog").validate()).settings.messages[i]=a.settings.messages[i]||{},t.isNullOrUndefined(l.required)||(0==(d=t.isNullOrUndefined(l.messages&&l.messages.required)?e.validator.messages.required:l.messages.required).indexOf("This field")&&(d=d.replace("This field",this.getColumnByField(i).headerText)),a.settings.messages[i].required=d,n.hasClass("e-datepicker")&&n.ejDatePicker({watermarkText:""}))},_focusElements:function(e){var i,l,n,o=this;e.length&&(e.focus(),(i=e.children())[0]&&("select"==i[0].tagName.toLowerCase()||"input"==i[0].tagName.toLowerCase()?(i.focus().select(),i[0].focus()):i.find(".e-field.e-dropdownlist").length?i.find(".e-ddl").focus():i.find(".e-chkbox-wrap.e-widget").length?i.find(".e-chkbox-wrap.e-widget").focus():i.find(".e-datepicker").length<=0?i.find("input,select").select().focus():i.find("input,select").select())),l=o.getScrollElement().children(".e-content").scrollLeft(),n=o.getScrollElement().ejScroller("option","scrollLeft"),o.getScrollElement().hasClass("e-scroller")&&l!=n&&(t.isNullOrUndefined(l)||o.getScrollElement().ejScroller("option","scrollLeft",l)),o._updateHeaderScrollLeft(o.getScrollElement().children(".e-content").scrollLeft())},_focusElementsForRowEdit:function(e){if(e.length){var t=e.children();"select"==t[0].tagName.toLowerCase()||"input"==t[0].tagName.toLowerCase()?(t.focus().select(),t[0].focus()):t.find(".e-field.e-dropdownlist").length?t[0].focus():t.hasClass("e-chkbox-wrap")?t[0].focus():t.find(".e-datepicker").length<=0?t.find("input:visible,select").first().select().focus():t.find("input,select").select()}},_getHeightforResourceView:function(e){for(var t=0,i=0;i<e.length;i++)t+=this._getTemplateRowHeight(e[i]);return t},getRecordsHeight:function(){var e=this.model;return"resourceView"==e.viewType?e.enableVirtualization?this._getHeightforResourceView(e.updatedRecords):this._getHeightforResourceView(this.getExpandedRecords(e.updatedRecords)):e.enableVirtualization?this._isHierarchyFiltering&&this.model.enableVirtualization?this._updateFilterParent.length*e.rowHeight:this.getUpdatedRecords().length*e.rowHeight:e.rowHeight*(e.updatedRecords.length-this.getCollapsedRecordCount())},updateHeight:function(t){var i,l,n=this,o=this.model,r=0,a=0;if(n._isInExpandCollapseAll)return!0;n._$gridContainer&&n._$gridContent&&(!o.allowPaging||n.model.allowTextWrap&&o.enableVirtualization?o.enableVirtualization?"auto"==o.sizeSettings.height?r=n._getViewPortHeight():o.allowTextWrap?o.allowPaging&&!n._textWrapRowsDatas.isEnd?(n._textWrapRowsDatas=n._getAvgTextWrapRowHeight("getAvgHeight"),r=n._textWrapRowsDatas.avgHeight*n._updatedPageData.length):n._textWrapRowsDatas.isEnd?r=n._getAvgTextWrapRowHeight("updateHeight").height:"extendHeight"==t?r=e("#"+n._id+"e-gridcontainer").height()+(n.model.updatedRecords.length-n._visibleRange.bottom)*n.model.rowHeight:(n._textWrapRowsDatas=n._getAvgTextWrapRowHeight("getAvgHeight"),r="auto"==o.sizeSettings.height?n._getViewPortHeight():o.updatedRecords.length*n._textWrapRowsDatas.avgHeight):r=this.getRecordsHeight():r="auto"==o.sizeSettings.height?n._getViewPortHeight():this.getRecordsHeight():r="auto"==o.sizeSettings.height?n._getViewPortHeight():o.rowHeight*n._updatedPageData.length,o.showDetailsRow&&o.detailsTemplate&&!o.showDetailsRowInfoColumn&&"auto"!=o.sizeSettings.height&&(a=n._getExpandedDetailsRowHeight()),0==(r+=a)&&(0==o.currentViewData.length||0==o.flatRecords.length)&&(r=30),o.allowPaging&&!o.sizeSettings.height&&(o.allowTextWrap&&!o.enableVirtualization?n._$frozenTableContent.length>0?(l=i=n._$gridContainer.find("#e-frozencontentdiv"+n._id).outerHeight(),n._$gridContainer.find("#e-movablecontentdiv"+n._id).outerHeight()>l&&(i=n._$gridContainer.find("#e-movablecontentdiv"+n._id).outerHeight())):i=n._$gridContainer.find(".e-table").outerHeight():i=r,this._frozenColumnsLength>0?(n._$gridContent.css("height",i),o.allowPaging&&!o.sizeSettings.height&&n.getScrollElement().ejScroller("instance").option("height",i)):n.getScrollElement().hasClass("e-scroller")&&(n.getScrollElement().ejScroller("isHScroll")&&(i=r+n._scrollBarHeight),n.getScrollElement().ejScroller({height:i})),n._viewPortHeight=i,n._gridHeight=r+n._getNonContentHeight(),n._summaryRowsCount>0&&o.showTotalSummary&&(n._gridHeight+=n._$totalSummaryRowContainer.outerHeight()),n.element.height(n._gridHeight)),n.model.allowTextWrap&&!n.model.enableVirtualization?(n._$gridContainer.css({height:"auto",width:"auto"}),this._frozenColumnsLength&&n._$gridContainer.find("#e-movablecontentdiv"+n._id+",#e-frozencontentdiv"+n._id).css("height","auto")):(n._$gridContainer.css({height:r+"px",width:"auto"}),this._frozenColumnsLength&&n._$gridContainer.find("#e-movablecontentdiv"+n._id+",#e-frozencontentdiv"+n._id).css("height",r+"px")),"auto"==o.sizeSettings.height&&(n.getScrollElement().hasClass("e-scroller")&&n.getScrollElement().ejScroller("instance").option("height",0),n._updateContentHeight()),n.getScrollElement().hasClass("e-scroller")&&(n.getScrollElement().ejScroller("refresh"),n._textWrapRowsDatas.isEnd&&(n._textWrapRowsDatas.isEnd=!1),n._updateScrollCss()))},_updateFixedTableBorder:function(t){if("sorting"!=t&&"dragAndDrop"!=t){var i=this._frozenColumnsLength>0?e(this.getContentTable()[1]):e(this.getContentTable()),l=this.model;!l.isFromGantt&&i&&i.hasClass("e-fixed-border")&&(l.currentViewData.length>0&&!i.hasClass("e-tableLastCell")?i.addClass("e-tableLastCell"):0==l.currentViewData.length&&i.removeClass("e-tableLastCell"))}},_setScrollTop:function(t){var i=this,l=this.model,n=0,o=i._scrollTop,r=l.rowHeight,a=l.currentViewData.length,d=l.isFromGantt?i._id.replace("ejTreeGrid",""):i._id,s=e("#"+d).find(".e-ganttviewerbodyContianer");l.showDetailsRow&&l.detailsTemplate&&!l.showDetailsRowInfoColumn&&(r+=i._detailsRowHeight),l.allowPaging&&i._isNextPage&&(o=0,i._isNextPage=!1,i.getScrollElement().ejScroller("scrollY",o,!0)),0!==o&&(l.enableVirtualization?a*r<i._viewPortHeight&&("expandcollapse"==t&&l.allowTextWrap&&l.enableVirtualization?o=0:a>0&&((n=o-(i._viewPortHeight-(a-1)*r))<0&&(n=0)),l.isFromGantt?s.ejScroller("scrollY",n,!0):i.getScrollElement().ejScroller("scrollY",n,!0)):l.isFromGantt?s.ejScroller("scrollY",o,!0):("delete"==t&&((n=i.getUpdatedRecords().length*r-i._viewPortHeight)<0&&(o=0)),i.getScrollElement().ejScroller("scrollY",o,!0)))},rowHeightRefresh:function(){var e,t=this;this.model;t._updateWrapRowHeights(null,"virtualRefresh",null,"resize"),t._$frozenTableContent.length>0&&(t.getScrollElement().ejScroller("refresh"),e=t.getScrollElement().ejScroller("model.scrollTop"),t._getFrozenScrollElement().scrollTop(e))},_updateGridContentHeight:function(){var e,t,i=this,l=this.model;i._$totalSummaryRowContainer&&(i._$totalSummaryRowContainer.ejScroller({height:"auto"}),i._$footerContainer.css({overflow:"hidden"}),i._$totalSummaryRowContainer.find(".e-footercontainer").height()<l.totalSummaryHeight?i.isVScroll()&&i._$totalSummaryRowContainer.addClass("e-scrollcss"):(i._$totalSummaryRowContainer.removeClass("e-scrollcss"),i._$totalSummaryRowContainer.ejScroller({height:"auto"==l.sizeSettings.height?0:l.totalSummaryHeight}),i._$totalSummaryRowContainer.width(i._$gridContent.width()),"auto"!=l.sizeSettings.height&&i._$totalSummaryRowContainer.width("auto"))),l.allowPaging&&!l.sizeSettings.height?i._$frozenTableContent.length>0?(e=i._viewPortHeight=i._$gridContainer.find("#e-frozencontentdiv"+i._id).outerHeight(),i._$gridContainer.find("#e-movablecontentdiv"+i._id).outerHeight()>e&&(i._viewPortHeight=i._$gridContainer.find("#e-movablecontentdiv"+i._id).outerHeight())):i._viewPortHeight=i._$gridContainer.find(".e-table").outerHeight():(i._viewPortHeight=i._getViewPortHeight(),i._$totalSummaryRowContainer&&(i._viewPortHeight="auto"==l.sizeSettings.height?i._viewPortHeight:i._viewPortHeight-i._$totalSummaryRowContainer.outerHeight())),i._$gridContent.css({height:i._viewPortHeight+"px"}),i.getScrollElement().hasClass("e-scroller")&&i.getScrollElement().ejScroller("instance").option("height","auto"==l.sizeSettings.height?0:i._viewPortHeight),i._frozenColumnsLength&&("auto"==l.sizeSettings.height&&i._updateContentHeight(),(t=this.getContent().find("#e-movablecontent"+i._id).height())!=this.getContent().find("#e-frozencontainer"+i._id).height()&&(this.getContent().find("#e-frozencontainer"+i._id).height(t),i.getScrollElement().ejScroller("refresh"))),i._updateScrollCss()},_updateContentHeight:function(){var t,i=this;t=i._getViewPortHeight(),1==e("#"+i._id+"e-gridcontent").find(".e-hscrollbar").length?(e("#e-movablecontainer"+i._id).css("height",t),e("#e-movablecontent"+i._id).css("height",t-18),e("#e-movablecontentdiv"+i._id).css("height",t-18)):(e("#e-movablecontainer"+i._id).css("height",t),e("#e-movablecontent"+i._id).css("height",t)),e("#"+i._id+"e-gridcontent").css("height",t),e("#"+i._id+"e-gridcontainer").css("height",t),e("#"+i._id+"e-table").css("top",0),i.getScrollElement().ejScroller("refresh"),i._updateScrollCss()},getChildCount:function(e,t){var i,l;if(!e.hasChildRecords)return 0;for(l=0;l<e.childRecords.length;l++)t++,(i=e.childRecords[l]).hasChildRecords&&(t=this.getChildCount(i,t));return t},_updateFilteredRecords:function(e,t){var i,l=this,n=0,o=e.length,r=l.model.enableVirtualization;for(l._filteredData=e,l._flatFilteredRecords=[],l._filteredRecords=[],l._filteredGanttRecords=[],l._filterParentRecords=[],l._updateFilterParent=[];n<o;n++)i=e[n],(!t&&("child"==l.model.filterSettings.filterHierarchyMode||"none"==l.model.filterSettings.filterHierarchyMode)||t&&("child"==l.model.searchSettings.searchHierarchyMode||"none"==l.model.searchSettings.searchHierarchyMode))&&(l._isHierarchyFiltering=!0),l._addParentRecord(i,t),this.model.isFromGantt||(i.hasChildRecords&&i.childRecords.length>0&&(i.hasFilteredChildRecords=!!this._checkChildExsist(i,e,t)),i.parentItem&&(i.parentItem.hasFilteredChildRecords=!0));0!=e.length&&l._isHierarchyFiltering&&l._updateFilterLevel(),l._filteredRecords=r?l._isHierarchyFiltering?l._flatFilteredRecords:l.getExpandedRecords(l._flatFilteredRecords):l._flatFilteredRecords.slice(),0!=e.length&&l._isHierarchyFiltering&&l._updateFilterExpandState(l._filteredRecords)},_updateFilterExpandState:function(t){for(var i=this,l=t.length,n=0;n<l;n++)-1!=e.inArray(t[n].parentItem,i._flatFilteredRecords)?t[n].parentItem.expanded&&-1!=e.inArray(t[n].parentItem,i._updateFilterParent)?(i._updateFilterParent.push(t[n]),t[n].isDisplay=!0):t[n].isDisplay&&(t[n].isDisplay=!1):(i._updateFilterParent.push(t[n]),t[n].isDisplay=!0)},_updateFilterLevel:function(){for(var t=this,i=t._flatFilteredRecords,l=t._flatFilteredRecords.length,n=0;n<l;n++)-1!=e.inArray(i[n].parentItem,t._flatFilteredRecords)?i[n].filterLevel=i[n].parentItem.filterLevel+1:(i[n].filterLevel=0,t._filterParentRecords.push(i[n]))},_checkChildExsist:function(t,i,l){for(var n=t.childRecords,o=this,r=n.length,a=!1,d=0;d<r;d++)if(!l&&("child"==o.model.filterSettings.filterHierarchyMode||"both"==o.model.filterSettings.filterHierarchyMode)||l&&("child"==o.model.searchSettings.searchHierarchyMode||"both"==o.model.searchSettings.searchHierarchyMode)){if(-1!=e.inArray(n[d],o._flatFilteredRecords)){a=!0;break}n[d].isSummaryRow||o._flatFilteredRecords.push(n[d]),a=!0,n[d].hasChildRecords&&(a=this._checkChildExsist(n[d],i,l))}else{if(-1!=e.inArray(n[d],i)){a=!0;break}n[d].hasChildRecords&&(a=this._checkChildExsist(n[d],i,l))}return a},_clearFilterLevel:function(e){for(var t,i=0,l=e.length;i<l;i++)((t=e[i]).filterLevel||0==t.filterLevel)&&(t.hasChildRecords&&!t.hasFilteredChildRecords&&(t.hasFilteredChildRecords=!0),delete t.filterLevel),t.isDisplay&&delete t.isDisplay,this._isHierarchyFiltering=!1},_updateHasFilteredChildRecordsStatus:function(e){for(var t,i=0,l=e.length;i<l;i++)(t=e[i]).hasChildRecords&&!t.hasFilteredChildRecords&&(t.hasFilteredChildRecords=!0),t.filterLevel>0&&delete t.filterLevel},_addParentRecord:function(t,i){var l=this;if("none"==l.model.filterSettings.filterHierarchyMode&&!i||"none"==l.model.searchSettings.searchHierarchyMode&&i)if(null==t.parentItem){if(-1!=e.inArray(t,l._filteredData))return void(-1==e.inArray(t,l._flatFilteredRecords)&&(l._flatFilteredRecords.push(t),t.hasFilteredChildRecords=!0))}else l._addParentRecord(t.parentItem,i),-1!=e.inArray(t.parentItem,l._filteredData)||-1!=e.inArray(t.parentItem,l._flatFilteredRecords)?-1==e.inArray(t,l._flatFilteredRecords)&&l._flatFilteredRecords.push(t):-1!=e.inArray(t,l._filteredData)&&-1==e.inArray(t,l._flatFilteredRecords)&&l._flatFilteredRecords.push(t);else t.parentItem&&("child"==l.model.filterSettings.filterHierarchyMode&&!i||"child"==l.model.searchSettings.searchHierarchyMode&&i?-1!=e.inArray(t.parentItem,l._filteredData)&&l._addParentRecord(t.parentItem,i):l._addParentRecord(t.parentItem,i)),-1===e.inArray(t,l._flatFilteredRecords)&&l._flatFilteredRecords.push(t)},_updateExpandCollapseForSortedRecords:function(e,t){var i,l,n=this,o=0,r=n._sortedRecords.length,a=n._sortedRecords.indexOf(e);if(t)n._addNestedSortRecords(e,a);else{for(l=0,o=a+1;o<r&&(i=n._sortedRecords[o]).level!==e.level;o++)n.getExpandStatus(i)||l++;n._sortedRecords.splice(a+1,l)}},_addNestedSortRecords:function(i,l){var n,o,r,a,d,s=this,c=s.model.sortSettings.sortedColumns;if(c.length)for(o=c.length-1,s._queryManagar.queries=[],r=o;r>=0;r--)s._queryManagar.sortBy(c[r].field,c[r].direction);if(i.hasChildRecords)for(o=(n=t.DataManager(i.childRecords).executeLocal(s._queryManagar).result).length,a=0;a<o;a++)d=n[a],s._filteredRecords.length?-1!==e.inArray(d,s._filteredRecords)&&s._sortedRecords.splice(++l,0,d):s._sortedRecords.splice(++l,0,d),d.hasChildRecords&&d.expanded&&s._addNestedSortRecords(d,l)},updateEditSettings:function(e){var i=this;e&&(e.editMode&&("normal"===i.model.editSettings.editMode&&"cellEditing"===e.editMode?(i.model.editSettings.editMode=e.editMode,i._processEditing()):i.model.editSettings.editMode=e.editMode),t.isNullOrUndefined(e.allowAdding)||(i.model.editSettings.allowAdding=e.allowAdding),t.isNullOrUndefined(e.allowEditing)||(i.model.editSettings.allowEditing=e.allowEditing),t.isNullOrUndefined(e.allowDeleting)||(i.model.editSettings.allowDeleting=e.allowDeleting),t.isNullOrUndefined(e.beginEditAction)||(i.model.editSettings.beginEditAction=e.beginEditAction),i._enableEditingEvents())},updateAltRow:function(){var e,t=0,i=this.model.updatedRecords,l=i.length,n=!0;for(t=0;t<l;t++)!(e=i[t]).isSummaryRow&&this.getExpandStatus(e)&&(e.isAltRow=!n,n=e.isAltRow)},_getFilteredChildRecordsCount:function(e){var t,i=this,l=i.model,n=e&&e.childRecords&&e.childRecords.length,o=0;for(o=0;o<n;o++)t=e.childRecords[o],l.enableVirtualization?i.getExpandStatus(t)&&i._removedCount++:i._removedCount++,t.childRecords&&i._getFilteredChildRecordsCount(t);return i._removedCount},_sortingRecords:function(){var e,i,l,n,o=this,r=o.model,a=r.sortSettings.sortedColumns;if(o._queryManagar.queries=[],a.length)for(e=a.length-1;e>=0;e--)r.isFromGantt?(l=t.TreeGrid.getColumnByMappingName(o.model.columns,a[e].field),t.isNullOrUndefined(l)&&(l=this.getColumnByField(a[e].field)),i=l.field):i=a[e].field,r.isFromGantt&&("resourceInfo"===i?i="resourceNames":"predecessor"===i&&(i="predecessorsName")),o._queryManagar.sortBy(i,a[e].direction);return n=new t.DataManager(r.parentRecords).executeLocal(o._queryManagar).result,o._sortedRecords=[],o._storedIndex=-1,o._rowIndex=-1,o._createSortedRecords(n),o._tempsortedrecords=o._sortedRecords,o.model.updatedRecords=o._sortedRecords,o._isHierarchyFiltering&&(o._updateFilterParent=o._sortedRecords),r.allowPaging&&r.pageSettings.pageSizeMode===t.TreeGrid.PageSizeMode.Root&&(r.parentRecords=o._getParentRecords(o.model.updatedRecords,o,!0)),!0},_createSortedRecords:function(i){var l=this,n=l.model,o=l._sortedRecords,r=l.model.enableAltRow;n=this.model;i=l._spliceSummaryRows(i),e.each(i,function(e,i){var a,d;if(i.isSummaryRow)return a=i.parentItem.childRecords.indexOf(i),void i.parentItem.childRecords.splice(a,1);l._filterString.length>0||l._searchString.length>0||n.filterSettings.filteredColumns.length>0?l._filteredRecords.length>0&&-1!==l._filteredRecords.indexOf(i)&&(l._storedIndex++,l._rowIndex++,r&&(i.isAltRow=l._rowIndex%2!=0),o[l._storedIndex]=i):(l._storedIndex++,l._rowIndex++,r&&(i.isAltRow=l._rowIndex%2!=0),o[l._storedIndex]=i),i.hasChildRecords&&i.expanded?(i.childRecords=l._spliceSummaryRows(i.childRecords),d=t.DataManager(i.childRecords).executeLocal(l._queryManagar).result,l._createSortedRecords(d)):!i.hasChildRecords||i.expanded||n.enableVirtualization||(i.childRecords=l._spliceSummaryRows(i.childRecords),l._setChildRecords(i,o))})},_setChildRecords:function(e,i){var l,n,o=this,r=o.model,a=o.model.enableAltRow,d=e.childRecords.length;for(l=t.DataManager(e.childRecords).executeLocal(o._queryManagar).result,n=0;n<d;n++)o._filterString.length>0||o._searchString.length>0||r.filterSettings.filteredColumns.length>0?o._filteredRecords.length>0&&-1!==o._filteredRecords.indexOf(l[n])&&(o._storedIndex++,a&&(l[n].isAltRow=o._storedIndex%2!=0),i[o._storedIndex]=l[n],l[n].hasChildRecords&&this._setChildRecords(l[n],i)):(o._storedIndex++,a&&(l[n].isAltRow=o._storedIndex%2!=0),i[o._storedIndex]=l[n],l[n].hasChildRecords&&this._setChildRecords(l[n],i))},_updateSortedRecords:function(i){for(var l,n,o=this,r=0,a=i.length,d=this.model;r<a;r++)l=i[r],d.enableVirtualization||(o._filteredRecords.length>0?-1!==e.inArray(l,o._filteredRecords)&&-1===e.inArray(l,o._sortedRecords)&&o._sortedRecords.push(l):-1===e.inArray(l,o._sortedRecords)&&o._sortedRecords.push(l),l.hasChildRecords&&l.childRecords.length>0&&(n=t.DataManager(l.childRecords).executeLocal(o._queryManagar).result,o._updateSortedRecords(n)))},_removeSortElementFromColumn:function(i){var l=this,n=t.TreeGrid.getColumnByField(l.model.columns,i),o=e.inArray(n,l.model.columns),r=l.getHeaderTable().find("thead").find(".e-headercell").eq(o).find(".e-headercelldiv");r.find(".ascending,.descending").remove(),r.parent().removeAttr("aria-sort")},_addEmptyColumntoGrid:function(){var i=this;e(i.element).find(".e-gridheadercontainer table colgroup").append(t.buildTag("col","",{width:"auto"},{})),i._$gridContainer.find("table colgroup").append(t.buildTag("col","",{width:"auto"},{})),e(i.element).find(".e-gridheadercontainer table thead tr").append(t.buildTag("th.e-headercell"))},updateScrollTop:function(e,i){var l={},n=this;l.requestType=t.TreeGrid.Actions.Scroll,l.delta=e,!n.getScrollElement().ejScroller("isHScroll")&&this.model.isFromGantt?n._$gridContent.scrollTop(e):n._$gridContent.scrollTop(0),n.getScrollElement().ejScroller("scrollY",e,!0),n.model.isFromGantt&&!i?(n._completeAction(l),n._focusTreeGridElement()):n._isFromChart=!1},_selectNextCell:function(t,i){var l,n,o,r,a=this,d=a.model,s=d.columns,c=s.length,u=e("#"+a._id+"EditForm"),g=a.getUpdatedRecords(),m=d.allowPaging?g:a.getExpandedRecords(d.updatedRecords);switch(a._isShiftKeyNavigation=!1,t){case"right":if(a._focusingRowIndex>=g.length-1&&a._cellIndex>=c-1||-1==a._focusingRowIndex||-1==a._cellIndex)return void a.element[0].focus();if(a._cellIndex+=1,a._cellIndex==c){if(a._cellIndex=0,o=g[a._rowIndexOfLastSelectedCell],(n=m[(l=m.indexOf(o))+1])&&n.isSummaryRow&&(n=a._getNextRecord(l+1,m)),!n)return;a._focusingRowIndex=g.indexOf(n)}if(a._focusingRowIndex>=g.length)return;(!s[a._cellIndex].visible||!s[a._cellIndex].allowCellSelection)&&u.length<=0&&(a._cellIndex=a.getUpNextVisibleColumnIndex(a._cellIndex,i)),u.length>0&&s[a._cellEditingDetails.columnIndex].allowCellSelection&&(a._cellIndex=a._cellEditingDetails.columnIndex),r={rowIndex:a._focusingRowIndex,cellIndex:a._cellIndex},a.selectCells([r]),a.updateScrollBar();break;case"left":if(a._cellIndex-=1,c=s.length,a._cellIndex<0){if(a._cellIndex=c-1,o=g[a._rowIndexOfLastSelectedCell],(n=m[(l=m.indexOf(o))-1])&&n.isSummaryRow&&(n=a._getNextRecord(l-1,m,"upArrow")),!n)return;a._focusingRowIndex=g.indexOf(n)}if(a._focusingRowIndex<0)return;a._focusingRowIndex>=g.length&&(a._focusingRowIndex=g.length-1),(!s[a._cellIndex].visible||!s[a._cellIndex].allowCellSelection)&&u.length<=0&&(a._cellIndex=a.getPreviousVisibleColumnIndex(a._cellIndex,i)),u.length>0&&s[a._cellEditingDetails.columnIndex].allowCellSelection&&(a._cellIndex=a._cellEditingDetails.columnIndex),r={rowIndex:a._focusingRowIndex,cellIndex:a._cellIndex},a.selectCells([r]),a.updateScrollBar()}},_moveCurrentCell:function(i){var l,n,o,r=this,a=r._cellEditingDetails.rowIndex,d=r._cellEditingDetails.columnIndex,s=r.model,c=r.getUpdatedRecords();if(-1==a&&-1==d)return!1;switch(r.model.isEdit&&(r.saveCell(),r.model.isEdit=!1),s.enableVirtualization&&(l=s.currentViewData[a],r._cellEditingDetails.rowIndex=a=c.indexOf(l)),i){case"right":var u,g=(h=s.columns).length,m=r.getHiddenColumns(),p=e.extend([],h);if(m&&m.forEach(function(e){p.splice(p.indexOf(e),1)}),f=p.indexOf(h[d]),w=p.length,a==c.length-1&&f==w-1)return!0;if(f==w-1){for(u=0;!h[u].visible;)u++;if(r._cellEditingDetails.columnIndex=u,r._getNextRow(i,a,r))return!0}else{for(u=d+1;!h[u].visible;)u++;r._cellEditingDetails.columnIndex=u}for(;0==s.columns[u].allowEditing||!h[u].visible;)if(u+1!=s.columns.length)r._cellEditingDetails.columnIndex=++u;else if(r._cellEditingDetails.columnIndex=u=0,r._getNextRow(i,a,r))return!0;r.updateScrollBar(),r.cellEdit(r._cellEditingDetails.rowIndex,s.columns[r._cellEditingDetails.columnIndex].field),r._editAddTools();break;case"left":var h,_,f,w;g=(h=s.columns).length,m=r.getHiddenColumns(),p=e.extend([],h);if(m&&m.forEach(function(e){p.splice(p.indexOf(e),1)}),f=p.indexOf(h[d]),w=p.length,0==a&&0==f)return!0;if(0==f){for(_=s.columns.length-1;!h[_].visible;)_--;if(r._cellEditingDetails.columnIndex=_,r._getNextRow(i,a,r))return!0}else{for(_=d-1;!h[_].visible;)_--;r._cellEditingDetails.columnIndex=_}for(;0==s.columns[_].allowEditing||!h[_].visible;)if(_-1!=-1)r._cellEditingDetails.columnIndex=--_;else if(r._cellEditingDetails.columnIndex=_=g-1,r._getNextRow(i,a,r))return!0;r.updateScrollBar(),r.cellEdit(r._cellEditingDetails.rowIndex,s.columns[r._cellEditingDetails.columnIndex].field),r._editAddTools();break;case"up":if(0==a)return!0;r._cellEditingDetails.rowIndex=a-1,r.selectRows(r._cellEditingDetails.rowIndex),r._rowSelectedEventTrigger(r._cellEditingDetails.rowIndex),r.cellEdit(r._cellEditingDetails.rowIndex,s.columns[r._cellEditingDetails.columnIndex].field);break;case"down":if(a+1==c.length&&(r._focusTreeGridElement(),r._isEnterKeyPressed=!0),s.showSummaryRow&&a+1==c.length-s.summaryRows.length&&(r._isEnterKeyPressed=!0),r._isEnterKeyPressed)r._isEnterKeyPressed=!1;else{if(c.length>a+1)if(s.enableVirtualization){if((C=c[a+1])&&C.isSummaryRow&&(C=r._getNextRecord(a+1,c)),-1==(n=c.indexOf(C)))return!0;r._cellEditingDetails.rowIndex=n}else{var C,x=c[a],v=s.allowPaging?c:r.getExpandedRecords(s.updatedRecords);if((C=v[v.indexOf(x)+1])&&C.isSummaryRow&&(C=r._getNextRecord(a+1,v)),n=c.indexOf(C),a==v.length-1&&d==s.columns.length-1||-1==n)return!0;r._cellEditingDetails.rowIndex=n}r._rowSelectingEventTrigger(r.selectedRowIndex(),r._cellEditingDetails.rowIndex)||(r.selectRows(r._cellEditingDetails.rowIndex),r._rowSelectedEventTrigger(r._cellEditingDetails.rowIndex)),r.updateScrollBar(),(o={}).requestType=t.TreeGrid.Actions.Scroll,o.delta=r._$gridContent.children(".e-content").scrollTop(),r._trigger("actionComplete",o),r.cellEdit(r._cellEditingDetails.rowIndex,s.columns[r._cellEditingDetails.columnIndex].field),r._editAddTools()}}return!1},_getNextRecord:function(e,t,i){var l;do{l=t[e],"upArrow"==i||"lastRowSelection"==i||"bottomRowSelection"==i||"child"==i||"above"==i?e--:e++}while(l&&l.isSummaryRow);return l},_getNextRow:function(e,t,i){var l,n,o,r=i.model,a=i.getUpdatedRecords();if(l="right"==e?1:-1,r.enableVirtualization){if((d=a[t+l])&&d.isSummaryRow&&(o=l>0?"":"lastRowSelection",d=i._getNextRecord(t+l,a,o)),r.allowPaging&&d&&((n=a.indexOf(d))<0&&1==l?i.gotoPage(i._currentPage()+1):n<0&&-1==l&&i.gotoPage(i._currentPage()-1)),-1==(n=a.indexOf(d)))return!0;i._cellEditingDetails.rowIndex=n}else{var d,s=a[t],c=r.allowPaging?a:i.getExpandedRecords(r.updatedRecords);if((d=c[c.indexOf(s)+l])&&d.isSummaryRow&&(o=l>0?"":"lastRowSelection",d=i._getNextRecord(t+l,c,o)),r.allowPaging&&d&&((n=a.indexOf(d))<0&&1==l?i.gotoPage(i._currentPage()+1):n<0&&-1==l&&i.gotoPage(i._currentPage()-1)),-1==(n=a.indexOf(d)))return!0;i._cellEditingDetails.rowIndex=n}r.allowSelection&&"cell"==r.selectionSettings.selectionMode?(r.selectedItem=a[i._cellEditingDetails.rowIndex],i._rowIndexOfLastSelectedCell=i._cellEditingDetails.rowIndex):i._rowSelectingEventTrigger(i.selectedRowIndex(),i._cellEditingDetails.rowIndex)||(i.selectRows(i._cellEditingDetails.rowIndex),i._rowSelectedEventTrigger(i._cellEditingDetails.rowIndex))},_findColumnsWidth:function(){for(var e=this,t=e.model.columns.length,i=e.getHeaderTable().find("colgroup").find("col"),l=0;l<t;l++)e.columnsWidthCollection[l]=i.eq(l).width()},_calculateWidth:function(){for(var e=this.getHeaderTable().find("colgroup").find("col"),t=0,i=0;i<e.length;i++)t+=e.eq(i).width();return t},getScrollObject:function(){return this.getScrollElement().data("ejScroller")},_updateElementHeight:function(){this._calculateDimensions(),this.updateViewPortHeight()},getScrollElement:function(){return this._frozenColumnsLength>0?this.element.find("#e-movablecontainer"+this._id):this._$gridContent},_getFrozenScrollElement:function(){return this._frozenColumnsLength>0?this.element.find("#e-frozencontainer"+this._id):null},_getFrozenColumnWidth:function(e){var i,l=0,n=(e=t.isNullOrUndefined(e)?this._frozenColumnsLength:e,t.isNullOrUndefined(e)?this._frozenColumns:this.model.columns);if(e>0)for(i=0;i<e;i++)1==n[i].visible&&(l+=n[i]?this.columnsWidthCollection[i]:0);return l},_renderScroller:function(i){var l,n,o,r=this,a=r.model,d=(a.flatRecords.length,a.rowHeight,r._viewPortHeight),s=!1;if(a.allowPaging&&!a.sizeSettings.height&&a.allowTextWrap&&!a.enableVirtualization&&(r._$frozenTableContent.length>0?(l=d=r._$gridContainer.find("#e-frozencontentdiv"+r._id).outerHeight(),r._$gridContainer.find("#e-movablecontentdiv"+r._id).outerHeight()>l&&(d=r._$gridContainer.find("#e-movablecontentdiv"+r._id).outerHeight())):d=r._$gridContainer.find(".e-table").outerHeight()),!r._$gridContent.hasClass("e-scroller")||a.allowPaging&&!a.sizeSettings.height){var c=r._gridHeight?d:"auto",u=this._gridWidth;this._frozenColumnsLength>0&&(r._$gridContent.css("width",u-r._totalBorderWidth),u=u-this._getFrozenColumnWidth()-1),a.isFromGantt||!0,this.mobileDevice()&&!a.isFromGantt&&(s=!0,r._scrollBarHeight=10),r.getScrollElement().ejScroller({enableTouchScroll:!1,autoHide:s,scrollerSize:r._scrollBarHeight,height:r.model.isFromGantt?0:"auto"==a.sizeSettings.height?0:c,width:r.model.isFromGantt?u:u-r._totalBorderWidth,scroll:e.proxy(r._onScroll,r)})}else r.getScrollElement().ejScroller("refresh");r.getScrollElement().ejScroller("model.keyConfigs",{up:"",down:"",left:"",right:""}),t.isNullOrUndefined(i)&&r._updateScrollCss(),n=r.getScrollElement().ejScroller("isHScroll"),a.allowPaging&&!a.sizeSettings.height&&n&&(o=c+r._scrollBarHeight,r.getScrollElement().ejScroller({height:o}),r.getScrollElement().ejScroller("refresh")),!this.mobileDevice()&&"safari"==this.getBrowserDetails().browser&&this._frozenColumnsLength>0&&(this.getHeaderContent().find("#e-movableheader"+r._id).add(this.getContent().find("#e-movablecontainer"+r._id)).css("margin-left","auto"),this._$totalSummaryRowContainer&&this._$totalSummaryRowContainer.find("#e-movablefooter"+r._id).css("margin-left","auto")),this._frozenColumnsLength>0&&(r._$gridContent.height(c),r.getContent().find("#e-frozencontainer"+r._id).height(r.getContent().find("#e-movablecontent"+r._id).height()))},_destroy:function(){var i,l,n,o,r,a,d,s,c,u,g,m,p,h,_=this,f=this.model,w=f.columns;if(_.element.off(),_._off(_.element,"click",_._onClick),_._off(_.element,"keydown",_._keyDown),_._off(_.element,"click","#"+_._id+"e-gridheader",_._onHeaderClick),_._off(_.element,"mousedown touchstart","#"+_._id+"e-gridheader",_._headerMouseDown),_._off(e(document),"mousedown touchstart",_._mouseDownHandler),_._off(_.element,"mousedown touchstart",".e-gridcontent",_._contentMouseDown),_._off(_.element,"click",_._onRecordClick),_._off(_.element,"dblclick",".e-gridcontent > div",_._onRecordDoubleClick),"immediate"==f.filterSettings.filterBarMode&&(_._off(_.element,"keyup",".e-filterbarcell input",_._filterBarHandler),_._off(_.element,"click",".e-filterbarcell .e-checkbox")._off(_.element,"click",".e-filterbarcell .e-checkbox",_._filterBarHandler)),f.isResponsive&&_._off(this.element,"swipeleft swiperight",".e-gridcontent div > .e-table",e.proxy(this._swipeAction,this)),_._off(_.element,"mousemove",_._mouseMove),_._off(_.element,"touchmove",_._mouseMove),_._off(_.element,"focus click",".e-filterbarcell input",_._filterBarClose),_._off(_.element,"click",".e-filterbarcell .e-cancel",_._filterBarClose),_.model.showGridCellTooltip&&!_.model.showGridExpandCellTooltip?"msie"==t.browserInfo().name?_._off(_.element,"mouseenter",".e-rowcell",_._mouseHover):_._off(_.element,"mousemove",".e-rowcell",_._mouseHover):_._off(_.element,"mouseenter",".e-rowcell",_._mouseHover),_.model.showGridCellTooltip&&("msie"==t.browserInfo().name?_._off(_.element,"mouseenter",".e-headercelldiv",_._headermouseHover):_._off(_.element,"mousemove",".e-headercelldiv",_._headermouseHover)),_._off(_.element,"mouseleave",".e-rowcell",_._cellMouseLeave),_._off(_.element,"mouseleave",_._cellMouseLeave),_._off(_.element,"mouseleave",".e-headercelldiv",_._headerMouseLeave),_._off(_.element,"mouseleave",_._headerMouseLeave),(f.isFromGantt||this._frozenColumnsLength)&&_._off(_.element,"mousewheel DOMMouseScroll",_._mouseWheel),f.enableResize&&f.isResponsive&&!f.isFromGantt&&_._off(e(window),"resize",_._windowResize),t.isTouchDevice()?_._off(_.element,"doubletap ",".e-gridcontent",_._editdblClickHandler):_._off(_.element,"dblclick ",".e-gridcontent",_._editdblClickHandler),f.contextMenuSettings.showContextMenu&&_._off(_.element,"keyup contextmenu taphold",this._preventContextMenu),_.getScrollElement().ejScroller("content").stop(!0),this._clearColumnMenu(),this._clearContextMenu(),this._removeDetailsRow(),e("#"+this._id+"_toolbarItems_Main").remove(),_._columnRenameDialog&&(e("#"+_._columnRenameDialog.attr("id")+"_wrapper").clearQueue(),e("#"+_._columnRenameDialog.attr("id")+"_wrapper").stop(),_._columnRenameDialog.data("ejDialog")&&_._columnRenameDialog.data("ejDialog").destroy(),e("#"+_._columnRenameDialog.attr("id")+"_wrapper").remove(),e("#"+_._id+"ColumnRenameDialog").remove()),this.model.showColumnChooser&&(e("#"+_._id+"ccDiv_wrapper").clearQueue(),e("#"+_._id+"ccDiv_wrapper").stop(),e("#"+this._id+"ccDiv").data("ejDialog")&&e("#"+this._id+"ccDiv").data("ejDialog").destroy(),e("#"+_._id+"ccDiv_wrapper").remove(),e("#"+this._id+"ccDiv").remove()),_._updateConfirmDialog&&(e("#"+_._updateConfirmDialog.attr("id")+"_wrapper").clearQueue(),e("#"+_._updateConfirmDialog.attr("id")+"_wrapper").stop(),_._updateConfirmDialog.data("ejDialog")&&_._updateConfirmDialog.data("ejDialog").destroy(),e("#"+_._updateConfirmDialog.attr("id")+"_wrapper").remove(),e("#"+_._id+"ConfirmDialog").remove()),_._confirmDialog&&(e("#"+_._confirmDialog.attr("id")+"_wrapper").clearQueue(),e("#"+_._confirmDialog.attr("id")+"_wrapper").stop(),_._confirmDialog.data("ejDialog")&&_._confirmDialog.data("ejDialog").destroy(),e("#"+_._confirmDialog.attr("id")+"_wrapper").remove(),e("#"+_._id+"_ConfirmDialog").remove()),e("#"+_._id+"_dialogColumnAdd_wrapper").length>0&&(e("#"+_._id+"_dialogColumnAdd_wrapper").clearQueue(),e("#"+_._id+"_dialogColumnAdd_wrapper").stop(),e("#"+_._id+"_dialogColumnAdd").find(".e-datepicker").ejDatePicker("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-datetimepicker").ejDateTimePicker("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-numerictextbox").ejNumericTextbox("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-dropdownlist").ejDropDownList("destroy"),e("#"+_._id+"_dialogColumnAdd").find(".e-treegrid").ejTreeGrid("destroy"),e("#"+_._id+"_dialogColumnAdd").data("ejDialog")&&e("#"+_._id+"_dialogColumnAdd").data("ejDialog").destroy(),e("#"+_._id+"_dialogColumnAdd_wrapper").remove(),e("#"+_._id+"_dialogColumnAdd").remove()),f.allowFiltering&&!f.isFromGantt)for(i=0;i<w.length;i++)(l=e("#"+this._id+"_"+w[i].field.split(".").join("")+"_filterbarcell")).data("ejWidgets")&&e(l).data(e(l).data("ejWidgets")[0]).destroy();if(_.model.allowFiltering&&"menu"==_.model.filterSettings.filterType)for(n=_._renderedFilterMenuDialog,u=0;u<n.length;u++)n[u]&&(a=n[u].indexOf("edit"),o=n[u],-1!=a?r=(d=o.slice(0,a)).charAt(0).toUpperCase()+d.slice(1):r=o.charAt(0).toUpperCase()+o.slice(1)),"String"==r?e("#"+this._id+"filter"+r+"MenuDiv").find(".e-autocomplete").ejAutocomplete("destroy"):"Datepicker"==r?e("#"+this._id+"filter"+r+"MenuDiv").find(".e-datepicker").ejDatePicker("destroy"):"Datetimepicker"==r?e("#"+this._id+"filter"+r+"MenuDiv").find(".e-datetimepicker").ejDateTimePicker("destroy"):"Numeric"==r&&e("#"+this._id+"filter"+r+"MenuDiv").find(".e-numerictextbox").ejNumericTextbox("destroy"),e("#"+this._id+"filter"+r+"MenuDiv_wrapper").clearQueue(),e("#"+this._id+"filter"+r+"MenuDiv_wrapper").stop(),e("#"+this._id+"filter"+r+"MenuDiv").find(".e-dropdownlist").ejDropDownList("destroy"),e("#"+this._id+"filter"+r+"MenuDiv").data("ejDialog")&&e("#"+this._id+"filter"+r+"MenuDiv").data("ejDialog").destroy(),e("#"+this._id+"filter"+r+"MenuDiv_wrapper").remove(),e("#"+this._id+"filter"+r+"MenuDiv").remove();if(_._commandColumnLength>0)for(u=0;u<w.length;u++)w[u].commands&&w[u].commands.length>0&&e("#"+this._id+u+"_UnboundTemplate").remove();for(c=(s=["number","string","date","datetime","boolean"]).length,u=0;u<c;u++)switch(e("#"+_._id+s[u]+"_CustomDrop1_popup_wrapper").clearQueue(),e("#"+_._id+s[u]+"_CustomDrop1_popup_wrapper").stop(),e("#"+_._id+s[u]+"_CustomDrop1").data("ejDropDownList")&&e("#"+_._id+s[u]+"_CustomDrop1").data("ejDropDownList").destroy(),e("#"+_._id+s[u]+"_CustomDrop2_popup_wrapper").clearQueue(),e("#"+_._id+s[u]+"_CustomDrop2_popup_wrapper").stop(),e("#"+_._id+s[u]+"_CustomDrop2").data("ejDropDownList")&&e("#"+_._id+s[u]+"_CustomDrop2").data("ejDropDownList").destroy(),e("#"+_._id+s[u]+"_CheckBoxList_WaitingPopup").remove(),s[u]){case"string":e("#"+_._id+s[u]+"_CustomValue1_suggestion").remove(),e("#"+_._id+s[u]+"_CustomValue2_suggestion").remove();break;case"date":e("#e-"+_._id+s[u]+"_CustomValue1").remove(),e("#e-"+_._id+s[u]+"_CustomValue2").remove();break;case"datetime":e("#"+_._id+s[u]+"_CustomValue1_popup").remove(),e("#"+_._id+s[u]+"_CustomValue2_popup").remove()}for(_.element.empty().removeClass("e-treegrid-core e-treegrid "+_.model.cssClass),_.element.data("ejWaitingPopup")&&_.element.ejWaitingPopup("destroy"),u=0;u<w.length;u++)w[u].isTemplateColumn&&(g=w[u].headerText,t.isNullOrUndefined(g)||t.isNullOrUndefined(g.match(/(\\|[^0-9A-z-_])/g))||(g=g.replace(/(\\|[^0-9A-z-_])/g,"")),e("#"+_._id+g+e.inArray(w[u],_.model.columns)+"_Template").length>0&&e("#"+_._id+g+e.inArray(w[u],_.model.columns)+"_Template").remove()),w[u].headerTemplateID&&(m=this._id+(w[u].field?w[u].field:"")+e.inArray(w[u],this.model.columns)+"_HeaderTemplate",e("#"+m).remove());for(h in p=e.views.helpers)-1!=h.indexOf(this._id)&&delete p[h];_._columnChooserList.remove()},collapseAll:function(){var e=this,i=e.model,l={};i.enableVirtualization,e.getRows();e.editFormValidate()&&(e._expandCollapseSettings.state="collapseAll",e._expandCollapseSettings.atLevel="",e._expandCollapseSettings.level=0,e._expandCollapsePages=[],(e._isRowEdit||e.model.isEdit)&&(e._isRowEdit?e.cancelRowEditCell():e.cancelEditCell(),e.selectRows(-1),e._cancelSaveTools()),l.requestType=t.TreeGrid.Actions.ExpandCollapse,e._isInExpandCollapseAll=!0,e._collapseAllData(),i.flatRecords.length>0&&e._refreshTreeGridOnExpandCollapseAll(l),e._isInExpandCollapseAll=!1,e.updateHeight())},_triggerExpandingCollapsingEvent:function(e){return e.expanded?this._trigger("expanding",e):this._trigger("collapsing",e)},_collapseAllData:function(){var e,i,l,n=this,o=n.model,r={};if(r.requestType=t.TreeGrid.Actions.ExpandCollapse,o.allowPaging&&o.pageSettings.pageSizeMode==t.TreeGrid.PageSizeMode.Root&&o.enableVirtualization){var a=o.pageSettings.pageSize,d=n._currentPage(),s=a*d,c=a*(d-1);for(n._expandCollapsePages.push(d),e=c;e<s;e++)(l=n._isHierarchyFiltering?n._filterParentRecords[e]:n.model.parentRecords[e])&&(r.data=l,r.recordIndex=o.updatedRecords.indexOf(l),r.expanded=!1,l.hasChildRecords&&(n._triggerExpandingCollapsingEvent(r)||(n._expandCollapseInnerLevelRecord(l,r.expanded),t.TreeGrid.sendExpandCollapseRequest(n,r))))}else for(i=n._isHierarchyFiltering?n._filterParentRecords:n.model.parentRecords,e=0;e<i.length;e++)l=i[e],r.data=l,r.recordIndex=o.updatedRecords.indexOf(l),r.expanded=!1,l.hasChildRecords&&(n._triggerExpandingCollapsingEvent(r)||(n._expandCollapseInnerLevelRecord(l,r.expanded),t.TreeGrid.sendExpandCollapseRequest(n,r)))},_getContextMenuItems:function(){var e=this._contextMenuTexts;return[{headerText:e.addRowText,eventHandler:null,isDefault:!0,disable:!1,menuId:"Add",parentMenuId:null},{iconClass:"e-edit",headerText:e.editText,eventHandler:null,isDefault:!0,disable:!1,menuId:"Edit",parentMenuId:null},{headerText:e.deleteText,eventHandler:null,isDefault:!0,disable:!1,menuId:"Delete",parentMenuId:null},{iconClass:"e-save",headerText:e.saveText,eventHandler:null,isDefault:!0,isEdit:!0,disable:!1,menuId:"Save",parentMenuId:null},{iconClass:"e-cancel",headerText:e.cancelText,eventHandler:null,isDefault:!0,isEdit:!0,disable:!1,menuId:"Cancel",parentMenuId:null},{iconPath:null,headerText:e.aboveText,eventHandler:null,menuId:"Above",parentMenuId:"Add"},{iconPath:null,headerText:e.belowText,eventHandler:null,menuId:"Below",parentMenuId:"Add"}]},_getHeaderContextMenuItems:function(l){var n,o,r,a,d,s=[],c=this,u=c.model,g=e(l.target),m=c._columnMenuTexts,p=g.closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),h=c.getColumnByField(p);return null!=h&&(r=h.allowSorting==i||h.allowSorting,u.allowSorting&&r&&(s.push({iconClass:"e-columnmenu-ascending",headerText:m.sortAscendingText,eventHandler:null,isDefault:!1,disable:!1,menuId:"contextMenu_SortAscending",parentMenuId:null}),s.push({iconClass:"e-columnmenu-descending",headerText:m.sortDescendingText,eventHandler:null,isDefault:!1,disable:!1,menuId:"contextMenu_SortDescending",parentMenuId:null})),(u.showColumnChooser||u.contextMenuSettings.showContextMenu)&&(s.length,s.push({iconClass:"e-columnchooser-icon",headerText:m.columnsText,eventHandler:null,isDefault:!1,disable:!1,menuId:"contextMenu_Columns",parentMenuId:null,isExpanderIcon:!0})),u.isFromGantt||(h.allowFreezing||c._allowFreezingDefault&&t.isNullOrUndefined(h.allowFreezing))&&(c._frozenColumnsLength!=u.columns.length-1||h.isFrozen||(n=!0),a=this._getFrozenColumnWidth(),d=u.columns.indexOf(h),(a=a+this.columnsWidthCollection[d]+18)>this._gridWidth&&(n=!0),s.push({iconClass:"e-freezecolumn-icon",headerText:m.freezeText,eventHandler:null,isDefault:!1,disable:!(!n&&!h.isFrozen),menuId:"contextMenu_Freeze",parentMenuId:null}),s.push({iconClass:"e-unfreezecolumn-icon",headerText:m.unfreezeText,eventHandler:null,isDefault:!1,disable:!(1==h.isFrozen),menuId:"contextMenu_Unfreeze",parentMenuId:null}),c._checkboxSelection&&u.columns[0].nonColumn?1!=u.columns.indexOf(h)&&u.columns.indexOf(h)>this._frozenColumnsLength&&(o=!0):0!=u.columns.indexOf(h)&&u.columns.indexOf(h)>this._frozenColumnsLength&&(o=!0),a=this._getFrozenColumnWidth(d),(a+=18)>this._gridWidth&&(o=!1),s.push({iconClass:"e-freezecolumnbefore-icon",headerText:m.freezePrecedingColumnsText,eventHandler:null,menuId:"contextMenu_FreezePreceding",isDefault:!1,disable:!o,parentMenuId:null})),s)},_getsubContextMenuItems:function(){var e=this._contextMenuTexts;return[{iconPath:null,headerText:e.aboveText,eventHandler:null,menuId:"Above",parentMenuId:"Add"},{iconPath:null,headerText:e.belowText,eventHandler:null,menuId:"Below",parentMenuId:"Add"}]},_clearContextMenu:function(){e(".e-tgcontextmenu").remove(),e(".e-tginnerContextmenu").remove(),e(".e-tgheaderContextmenu").remove(),e("#"+this._id+"ccDiv").ejDialog("close")},_renderContextMenu:function(l,n,o,r){var a,d,s,c,u,g,m,p=this,h=p.model,_={},f=p._getCoordinate(l);if(p._contextMenuSelectedIndex=n,p._contextMenuSelectedItem=o,p._contextMenuEvent=l,r||this.editFormValidate()){if(l||(l=window.event),a=f.pageX,d=f.pageY,(u=this.getOffsetRect(p.element[0])).bottom=u.top+this.element[0].offsetHeight,u.right=u.left+e(this.element).width(),_.targetElement=l,_.item=o,_.index=n,_.columnIndex=p.getCellIndex(l),_.requestType="ContextMenuOpen",_.contextMenuItems=p._contextMenuItems,p._trigger("contextMenuOpen",_))return!1;p._activeMenuItemId=null,p._contextMenuItems=_.contextMenuItems,s=t.buildTag("div.e-tgcontextmenu e-js","",{display:"table",position:"absolute","z-index":p.getMaxZIndex()+1},{id:p._id+"_ContextMenu"}),h.cssClass&&s.addClass(h.cssClass),g=_.contextMenuItems.filter(function(e){if(null==e.parentMenuId||e.parentMenuId==i)return!0}),this._isContextMenuItems=!0,c=t.buildTag("ul.e-treegrid-contextmenu",e.render[p._id+"contextMenuTemplate"](g),{margin:"0px","padding-left":"0px","list-style-type":"none"},{"data-icon":!1,"data-role":"list-divider"}),s.append(c),e(document.body).append(s),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&h.isResponsive&&p._off(e(window),"resize",p.windowResize);var w=e(s).outerHeight(),C=e(s).outerWidth(),x=s.find(".e-menuitem");x.eq(0);if(x.outerWidth(C+2),(u.left>a||u.right<a+C)&&(u.right<a+C&&(a-=C),a<0&&(a=u.left+10)),u.bottom<d+w){var v=d-w,S=(u.bottom,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);v>u.top?d=v:d+w>S+window.innerHeight&&((m=d-(d+w-(S+window.innerHeight)))>0&&(d=parseInt(m)))}s.css({left:a+"px",top:d+"px"}),p._focusTreeGridElement(),e(s).css({height:"auto"}),p._on(s,"contextmenu",function(e){e.preventDefault()}),e(x).click(function(){p._contextMenuClickHandler(this)}),e(x).mouseenter(function(){e(this).hasClass("e-disable")||(s.find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),e(this).addClass("e-tgcontextmenu-mouseover"),p._activeMenuItemId=e(this).attr("id"),p._showSubContextMenu(this,_.contextMenuItems))}),p.model.allowSelection&&"multiple"==p.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&p._clearMultiSelectPopup(),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&h.isResponsive&&p._on(e(window),"resize",p.windowResize),l.preventDefault()}},_renderHeaderContextMenu:function(l){var n,o,r,a,d,s,c,u,g,m,p,h=this,_=h.model,f={};if(d=e(l.target).closest(".e-headercell").find(".e-headercelldiv").attr("data-ej-mappingname"),c=h.getColumnByField(d),h._contextMenuColumnDetails=c,_.isEdit||this._isRowEdit){if(!this.editFormValidate())return!0;h._saveEditedElements()}if(u=h._getCoordinate(l),l||(l=window.event),n=u.pageX,o=u.pageY,(g=h.getOffsetRect(h.element[0])).bottom=g.top+h.element[0].offsetHeight,g.right=g.left+e(this.element).width(),f.targetElement=l,f.headerContextMenuItems=h._headerContextMenuItems,f.columnIndex=h.getColumnIndexByField(d),f.requestType="ContextMenuOpen",h._trigger("contextMenuOpen",f))return!1;f.headerContextMenuItems=h._headerContextMenuItems,h._headerContextMenuItems=f.headerContextMenuItems,r=t.buildTag("div.e-tgheaderContextmenu e-js","",{display:"table",position:"absolute","z-index":h.getMaxZIndex()+1},{id:h._id+"_headerContextMenu"}),_.cssClass&&r.addClass(_.cssClass),m=f.headerContextMenuItems.filter(function(e){if(null==e.parentMenuId||e.parentMenuId==i)return!0}),this._isContextMenuItems=!1,a=t.buildTag("ul.e-treegrid-headercontextmenu",e.render[h._id+"contextMenuTemplate"](m),{margin:"0px","padding-left":"0px","list-style-type":"none"},{"data-icon":!1,"data-role":"list-divider"}),r.append(a),e(document.body).append(r),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&_.isResponsive&&h._off(e(window),"resize",h.windowResize);var w,C=e(r).outerHeight(),x=e(".e-tgheaderContextmenu").outerWidth()+.5,v=(w=r.find(".e-menuitem")).eq(0);h._activeMenuItemId=e(v).attr("id"),w.outerWidth(x),(g.left>n||g.right<n+x)&&(g.right<n+x&&(n-=x),n<0&&(n=g.left+10)),g.bottom<o+C&&((p=o-C)>0&&(o=p)),r.css({left:n+"px",top:o+"px"}),h._focusTreeGridElement(),e(r).css({height:"auto"}),h._on(r,"contextmenu",function(e){e.preventDefault()}),s=n+x,h._columnListPosX=s,h._headerContextMenuWidth=x,h._posx=n,h._posy=o,h._columnMenuPopupY=o,e("#contextMenu_SortAscending").on("click",function(){_.allowMultiSorting&&(h._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(_.isFromGantt?h.sortColumn(c.mappingName?c.mappingName:c.field,t.sortOrder.Ascending):h.sortColumn(c.field,t.sortOrder.Ascending),h._multiSortRequest=!1)}),e("#contextMenu_SortDescending").on("click",function(){_.allowMultiSorting&&(h._multiSortRequest=!0),0==e(this).find(".e-expander").length&&(_.isFromGantt?h.sortColumn(c.mappingName?c.mappingName:c.field,t.sortOrder.Descending):h.sortColumn(c.field,t.sortOrder.Descending),h._multiSortRequest=!1)}),e("#contextMenu_Freeze").click(function(){0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(h._checkboxSelection&&_.columns[0].nonColumn&&!_.columns[0].isFrozen&&(_.columns[0].isFrozen=!0),h.freezeColumn(c.field,!0)))}),e("#contextMenu_Unfreeze").click(function(){0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||(h._checkboxSelection&&2==h._frozenColumnsLength&&_.columns[0].nonColumn&&_.columns[0].isFrozen&&(_.columns[0].isFrozen=!1),h.freezeColumn(c.field,!1)))}),e("#contextMenu_FreezePreceding").click(function(){0==e(this).find(".e-expander").length&&(e(this).hasClass("e-disable")||h.freezePrecedingColumns(c.field))}),_.isFromGantt||h.model.isResponsive&&e(window).width()<=h._responsiveMinWidth&&e("#"+h._id+"_headerContextMenu").find(".e-expander").removeClass("e-treegridadaptivesubicon"),e("#contextMenu_Columns").mouseenter("click",function(t){h._showColumnChooser(t,g.right,s,x,o,n,e("#contextMenu_Columns"),!0)}),v.addClass("e-columnmenuselection"),e(w).mouseenter(function(){e(this).hasClass("e-disable")||(w.removeClass("e-columnmenuselection"),e(this).addClass("e-columnmenuselection"),h._activeMenuItemId=e(this).attr("id"),h._showSubContextMenu(this,f.headerContextMenuItems))}),e(".e-tgheaderContextmenu .e-menuitem").on("mouseenter click",function(t){var i=e(t.target).closest(".e-menuitem").attr("id");"contextMenu_Columns"==i?e(".e-tginnerContextmenu").remove():e("#"+h._id+"ccDiv").ejDialog("close")}),e(w).click(function(){h._contextMenuClickHandler(this)}),h.model.allowSelection&&"multiple"==h.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&h._clearMultiSelectPopup(),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&_.isResponsive&&h._on(e(window),"resize",h.windowResize)},_showSubContextMenu:function(i,l){var n,o,r,a,d,s,c=this.model,u=this,g=[],m=e(i).attr("id");r=l.filter(function(e){return e.menuId==m&&(g=e),e.parentMenuId==m||void 0}),g.parentMenuId||e(".e-tginnerContextmenu").remove(),g.parentMenuId&&this._removeContextMenu(g,l),r.length>0&&(n=t.buildTag("div.e-tginnerContextmenu e-js","",{display:"table",position:"absolute","z-index":u.getMaxZIndex()+1},{id:this._id+"_SubContextMenu"+m}),c.cssClass&&n.addClass(c.cssClass),o=t.buildTag("ul",e.render[u._id+"contextMenuTemplate"](r),{margin:"0px","padding-left":"0px"},{"data-icon":!1,type:"none","data-role":"list-divider"}),n.append(o),e(document.body).append(n),a=n.find(".e-menuitem"),d=e(n).outerWidth(),a.outerWidth(d>100?d:100),s=u._getSubContextMenuPosition(i,n),e(n).css({top:s.top,left:s.left}),e(a).mouseenter(function(){e(this).hasClass("e-disable")||(u._showSubContextMenu(this,l),e(this).closest(".e-tginnerContextmenu").find(".e-tgcontextmenu-mouseover").removeClass("e-tgcontextmenu-mouseover"),e(this).addClass("e-tgcontextmenu-mouseover"),u._activeMenuItemId=e(this).attr("id"))}),u._on(n,"contextmenu",function(e){e.preventDefault()}),e(a).click(function(){u._contextMenuClickHandler(this)}),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&c.isResponsive&&u._on(e(window),"resize",u.windowResize))},_removeContextMenu:function(t,i){var l,n,o=e("#"+this._id+"_SubContextMenu"+t.parentMenuId),r=e(o).find(".e-tgcontextmenu-mouseover");e(r).length>0&&((l=i.filter(function(t){if(t.menuId==e(r).attr("id"))return!0})).length>0&&((n=i.filter(function(e){if(e.parentMenuId==l[0].menuId)return!0})).length>0&&this._removeContextMenu(n[0],i)),e("#"+this._id+"_SubContextMenu"+e(r).attr("id")).remove())},_getSubContextMenuPosition:function(i,l){var n,o,r,a,d,s,c,u,g,m=this.model,p={top:"",left:""};if(0==(n=this._isContextMenuItems?e(i).closest(".e-tgcontextmenu"):e(i).closest(".e-tgheaderContextmenu")).length&&(n=e(i).closest(".e-tginnerContextmenu")),"msie"==t.browserInfo().name&&t.browserInfo().version<9&&m.isResponsive&&this._off(e(window),"resize",this.windowResize),o=e(l).outerWidth(),r=e(l).height(),s=this.getOffsetRect(i),a=e(n).outerWidth(),p.top=s.top-1,p.bottom=s.top+e(i).outerHeight(),p.left=s.left+e(n).width()+1,d=p.left,(c=this.getOffsetRect(this.element[0])).bottom=c.top+this.element[0].offsetHeight,c.right=c.left+e(this.element).width(),(c.left>d||c.right<d+o)&&(c.right<d+o&&(d=d-a-o),d>0&&(p.left=d)),c.bottom<p.top+r){var h=p.bottom-r,_=(p.top,c.bottom,window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop);h>c.top?p.top=h:p.top+r>_+window.innerHeight&&(u=p.top+r-(_+window.innerHeight),(g=p.top-u)>0&&(p.top=parseInt(g)-2))}return p},_contextMenuClickHandler:function(t){var i=e(t).attr("id"),l=this;if(!e(t).hasClass("e-disable")&&0==e(t).find(".e-expander").length)switch(i){case"Delete":l.contextMenuOperations("Delete");break;case"Above":l.contextMenuOperations("Above");break;case"Below":l.contextMenuOperations("Below");break;case"Add":l.contextMenuOperations("Add");break;case"Edit":l.contextMenuOperations("Edit");break;case"Save":l.contextMenuOperations("Save");break;case"Cancel":l.contextMenuOperations("Cancel");break;default:l.contextMenuOperations(i)}},_triggerMenuEventHandler:function(i,l,n){var o,r,a,d=n?this._contextMenuItems:this._headerContextMenuItems;t.isNullOrUndefined(d)||(o=d.filter(function(e){if(e.menuId.toString()===i)return!0})).length>0&&((r=o[0].eventHandler)&&("string"==typeof r&&(r=t.util.getObject(r,window)),e.isFunction(r)&&(a=t.event("customContextMenuHandler",this.model,l),r.call(this,a))))},_createContextMenuTemplate:function(){var t,i,l=this,n={};n["_"+l._id+"getHeaderName"]=e.proxy(l._getHeaderName,l),e.views.helpers(n),t="<li style='list-style-type:none;margin:0px;'>",t+="<div class='e-menuitem {{if disable}}e-disable{{/if}}{{if ~_"+l._id+"getHeaderName(#data)}} e-parent-menuitem{{/if}}' id={{:menuId}}  style='display:table;cursor:{{if disable}}default{{else}}pointer{{/if}};min-width:100px;'>{{if iconPath}}<div class='e-icon e-tgcontextmenu-image' style='background-image:{{:iconPath}};background-repeat:no-repeat;'/> {{else}}<div class='e-icon {{:iconClass}} e-tgcontextmenu-icon'/>{{/if}}<div class='e-tgcontextmenu-label'><span>{{:headerText}}</span></div>{{if ~_"+l._id+"getHeaderName(#data)}}<div class='e-icon e-expander'/> {{/if}}",t+="</div></li>",(i={})[l._id+"contextMenuTemplate"]=t,e.templates(i)},_getHeaderName:function(e){return(this._isContextMenuItems?this._contextMenuItems:this._headerContextMenuItems).filter(function(t){if(null!=e.menuId&&e.menuId==t.parentMenuId||e.isExpanderIcon)return!0}).length>0},_getColumnId:function(e){return e.name.replace(/\s/g,"")},_updateContextmenuOption:function(t){var l,n;if(Array.prototype.clean=function(e){for(var t=0;t<this.length;t++)this[t]==e&&(this.splice(t,1),t--);return this},(l=this)._isRowEdit||l.model.isEdit)l._contextMenuItems.splice(0,3);else{l._contextMenuItems.splice(3,2);var o=l.model.editSettings,r=e.extend(!0,[],l._contextMenuItems),a=l.model.contextMenuSettings.contextMenuItems.clean("").clean(i),d=[];if(e.each(a,function(t,i){-1===e.inArray(i.toLowerCase(),d)&&d.push(i.toLowerCase())}),l._contextMenuItems=[],-1==t)(-1!=d.indexOf("add")||0==d.length)&&(l._contextMenuItems[0]=r[0]),o.allowAdding||(l._contextMenuItems[0].disable=!0),l._contextAddMenuIndex=0;else if(0==d.length)l._contextMenuItems[0]=r[0],o.allowAdding||(l._contextMenuItems[0].disable=!0),l._contextAddMenuIndex=0,l._contextMenuItems[1]=r[2],o.allowDeleting||(l._contextMenuItems[1].disable=!0),l._contextMenuItems.push.apply(l._contextMenuItems,l._subContextMenuItems);else{for(n=0;n<d.length;n++)switch(d[n].toLowerCase()){case"add":l._contextMenuItems[n]=r[0],l._contextAddMenuIndex=n,o.allowAdding||(l._contextMenuItems[n].disable=!0);break;case"delete":l._contextMenuItems[n]=r[2],o.allowDeleting||(l._contextMenuItems[n].disable=!0);break;case"edit":l._contextMenuItems[n]=r[1],o.allowEditing||(l._contextMenuItems[n].disable=!0)}l._contextMenuItems.push.apply(l._contextMenuItems,l._subContextMenuItems)}}},_setInitialData:function(){for(var e,i,l=this,n=l.model,o=[],r={},a=0;a<n.columns.length;a++)switch((e=n.columns[a]).editType){case"booleanedit":r[e.field]=!1;break;case"stringedit":r[e.field]=null;break;case"datepicker":r[e.field]=t.format(new Date,this.model.dateFormat,this.model.locale);break;case"datetimepicker":r[e.field]=t.format(new Date,"MM/dd/yyyy hh:mm tt",this.model.locale);break;case"numericedit":r[e.field]=0;break;default:r[e.field]=null}o.push(r),(null==l.dataSource()||0==l.dataSource().length||0==n.flatRecords.length)&&((i=l._createRecord(o[0],0,null)).index=0,l._addRecord(i,t.TreeGrid.RowPosition.Top),l._clearContextMenu(),this._removeDetailsRow())},_subContextMenuAction:function(e,i,l){var n,o=this,r=o.model;(n=jQuery.extend(!0,{},e.item))[o.model.childMapping]=null,r.idMapping&&r.parentIdMapping&&n[r.parentIdMapping]&&delete n[r.parentIdMapping],"Above"==l?o._addRecord(n,t.TreeGrid.RowPosition.Above,null,"contextMenu"):"Below"==l&&o._addRecord(n,t.TreeGrid.RowPosition.Below,null,"contextMenu"),o._clearContextMenu()},_appendEditTemplateRow:function(i,l,n,o,r){var a,d,s,c,u,g,m,p,h,_=this.model,f=this,w=f.model.rowHeight,C=f.getUpdatedRecords();this._editedRowIndex=n,s=t.buildTag("table.e-table e-zerospace","",{}),this._frozenColumnsLength>0?o?(d=t.buildTag("form.e-treegridform#"+f._id+"EditFrozenForm","",{margin:"-2px 0px"},{}),s.append(f._$gridHeaderContainer.find("#e-frozenheaderdiv"+f._id).find("colgroup").clone())):(d=t.buildTag("form.e-treegridform#"+f._id+"EditForm","",{margin:"-2px 0px"},{}),s.append(f._$gridHeaderContainer.find("#e-movableheaderdiv"+f._id).find("colgroup").clone())):(d=t.buildTag("form.e-treegridform#"+f._id+"EditForm","",{margin:"-2px 0px"},{}),s.append(f.getHeaderTable().find("colgroup").clone())),!o&&_.showDetailsRow&&_.showDetailsRowInfoColumn&&_.detailsTemplate&&(c=l.find("td.e-detailsrowcell")),l.empty(),r?(l.addClass("e-addedrow"),l.next("tr").hasClass("e-detailsrow")&&l.next("tr").remove()):l.addClass("e-rowedit"),u=i.filter(function(e){return!(!1===e.visible)}),a=t.buildTag("td","",{padding:"1px"},{colspan:c?u.length+1:u.length}),g=_.allowSelection?t.buildTag("tr.e-treegridrows e-selectionbackground e-active",{height:w},{}):t.buildTag("tr.e-treegridrows",{height:w},{});var x=t.buildTag("tbody"),v=f._cellEditTemplate,S=i.length;for(m=0;m<S;m++)if(!t.isNullOrUndefined(m)&&i[m].visible){var R={},T=f._getFieldValue(i[m].field,_.columns.indexOf(i[m])),b=v.find("#"+T+"_CellEdit").html(),y=f._getCustomCellValue(C[n],i[m].field);R[T]=y,"dropdownedit"==i[m].editType&&0==R[i[m].field]&&(R[T]=R[T].toString()),p=e(e.templates(b).render(R)),f._isCommandColumn(i[m])?h=t.buildTag("td.e-rowcell e-unboundcell e-unboundeditedcell","",{height:w,"vertical-align":"middle;",overflow:"hidden"},{}):(h=t.buildTag("td.e-rowcell e-editedcell","",{height:w,"vertical-align":"middle;",overflow:"hidden"},{})).addClass("e-validError"),f._isCommandColumn(i[m])||0!=i[m].allowEditing||p.attr("disabled",!0).addClass("e-disable"),"SELECT"==p.get(0).tagName&&(p.val(R[i[m].field]),null==p.val()&&p.val(p.find("option").first().val())),"INPUT"==p.get(0).tagName&&p.val(R[T]),g.append(h.append(p)),x.append(g)}c&&g.append(c),s.append(x),d.append(s),a.append(d),l.append(a)},_editRow:function(i,l,n){var o,r,a,d=this,s=d.model,c=(s.rowHeight,d.getUpdatedRecords()),u=!1;if(d._editedRowIndex=i,(o=t.TreeGrid.getRowByIndex(d,i)).hasClass("e-summaryrow"))d._editAddTools();else{if(t.isNullOrUndefined(l)){if((r={}).data=c[i],r.rowElement=o,r.rowIndex=i,r.columnIndex=n,u=!1,d._trigger("beginEdit",r))return!1}else u=!0;for(this._frozenColumnsLength>0?(d._appendEditTemplateRow(d._frozenColumns,e(o[0]),i,!0,l),d._appendEditTemplateRow(d._unFrozenColumns,e(o[1]),i,!1,l)):d._appendEditTemplateRow(s.columns,e(o),i,!1,l),d._isRowEdit=!0,d._editAddTools(),r={},u?(r.data={},r.requestType="add"):(r.columnIndex=n,r.data=c[i],r.requestType="beginEdit"),d._refreshEditForm(r),d._updateWrapRowHeights("total,header",null,i,"rowEdit"),e.isFunction(e.validator)&&(d._initValidator(),d.setValidation()),s.selectedItem=c[i],a=0;a<s.columns.length;a++)d._isCommandColumn(s.columns[a])&&1==s.columns[a].isFrozen?this._refreshUnboundTemplate(o.find("#"+this._id+"EditFrozenForm")):d._isCommandColumn(s.columns[a])&&this._refreshUnboundTemplate(o.find("#"+this._id+"EditForm"))}},_renderColumnChooser:function(){var i=this,l=t.buildTag("div.e-columnSelector","","",{id:this._id+"ccDiv"});e("#"+i._id+"ccDiv_wrapper").remove(),i._renderColumnChooserList(!1),l.append(i._columnChooserList),l.insertAfter(i.element),l.data("columnMenuDialog","TreeGrid"),l.ejDialog({showOnInit:!1,allowKeyboardNavigation:!1,enableResize:!1,enableRTL:!1,showHeader:!1,width:"auto",allowDraggable:!1,position:{X:1,Y:1},enableAnimation:!1,minWidth:"0px",minHeight:"0px"}),e("#"+i._id+"ccDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content").addClass("e-treegrid-columnchooser")},_renderFilterMenu:function(e){var t,i,l=this,n=0,o=0,r=0,a=0,d=0,s=0,c=this.model.columns;if(!e)for(i=0;i<c.length;i++)("numericedit"==c[i].filterEditType||"numericedit"==c[i].editType)&&n++,("stringedit"==c[i].filterEditType||"stringedit"==c[i].editType)&&o++,("datepicker"==c[i].filterEditType||"datepicker"==c[i].editType)&&r++,("datetimepicker"==c[i].filterEditType||"datetimepicker"==c[i].editType)&&d++,("booleanedit"==c[i].filterEditType||"booleanedit"==c[i].editType)&&s++,("dropdownedit"==c[i].filterEditType||"dropdownedit"==c[i].editType)&&(a++,t=c[i]);(o>0||"stringedit"==e)&&(l._renderEdittypeFilterMenu("String"),l._renderedFilterMenuDialog.push("stringedit")),(n>0||"numericedit"==e)&&(l._renderEdittypeFilterMenu("Numeric"),l._renderedFilterMenuDialog.push("numericedit")),(r>0||"datepicker"==e)&&(l._renderEdittypeFilterMenu("Datepicker"),l._renderedFilterMenuDialog.push("datepicker")),(d>0||"datetimepicker"==e)&&(l._renderEdittypeFilterMenu("Datetimepicker"),l._renderedFilterMenuDialog.push("datetimepicker")),(a>0||"dropdownedit"==e)&&(l._renderEdittypeFilterMenu("Dropdown",t),l._renderedFilterMenuDialog.push("dropdownedit")),(s>0||"booleanedit"==e)&&(l._renderEdittypeFilterMenu("Boolean"),l._renderedFilterMenuDialog.push("booleanedit"))},_renderEdittypeFilterMenu:function(i,l){var n,o=this,r=t.buildTag("div.e-"+o._id+"filter"+i+"Selector e-filterMenuDiv e-treegridmenufilterwraper","",{},{id:this._id+"filter"+i+"MenuDiv"}),a=o._filterMenuTexts;n="Dropdown"==i?"<div class='e-filter-container'><div class='e-dropdown-filter-container'><input id='"+this._id+"filter"+i+"DropDown'/></div><div class='e-filter-button-container'><div class='e-filter-btn-filter'><button id='"+this._id+"filter"+i+"MenuButton' class='e-filterMenuDiv'>"+a.filterButton+"</button></div><div class='e-filter-btn-clear'><button id='"+this._id+"filter"+i+"ClearButton' class='e-filterMenuDiv'>"+a.clearButton+"</button></div></div></div>":"Boolean"==i?"<div class='e-filter-container'><div class='e-checkbox-filter-container'><span class='e-checkbox-filter-text'>"+a.filterValue+"</span><div class='e-checkbox-filter-control' style='padding-bottom:14px;padding-left: 48%;'><input id='"+this._id+"filter"+i+"InputBox'/></div><div class='e-filter-button-container'><div class='e-filter-btn-filter'><button id='"+this._id+"filter"+i+"MenuButton' class='e-filterMenuDiv'>"+a.filterButton+"</button></div><div class='e-filter-btn-clear'><button id='"+this._id+"filter"+i+"ClearButton' class='e-filterMenuDiv'>"+a.clearButton+"</button></div></div></div>":"<div class='e-filter-container'><div class='e-filter-operator'><input id='"+this._id+"filter"+i+"DropDown'/></div><span class='e-filter-text'>"+a.filterValue+"</span><div class='e-filter-value'><input id='"+this._id+"filter"+i+"InputBox'/></div><div class='e-filter-button-container'><div class='e-filter-btn-filter'><button id='"+this._id+"filter"+i+"MenuButton' class='e-filterMenuDiv'>"+a.filterButton+"</button></div><div class='e-filter-btn-clear'><button id='"+this._id+"filter"+i+"ClearButton' class='e-filterMenuDiv'>"+a.clearButton+"</button></div></div></div>",r.append(n),r.insertAfter(o.element),o._renderFilterMenuDialog(i+"MenuDiv",i,l,a),r.data("filter"+i+"MenuDialog","TreeGrid"),r.ejDialog({showOnInit:!1,allowKeyboardNavigation:!1,enableResize:!1,enableRTL:!1,showHeader:!1,width:"auto",allowDraggable:!1,position:{X:1,Y:1},enableAnimation:!1,cssClass:o.model.cssClass}),e("#"+o._id+"filter"+i+"MenuDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css({height:"auto",width:"auto"}).removeClass("e-widget-content"),e("#"+o._id+"filter"+i+"MenuDiv_wrapper").css("outline","none").addClass("e-treegrid-columnchooser")},_renderFilterMenuDialog:function(t,i,l,n){var o,r,a,d=this;"String"==i&&(o=n.stringMenuOptions,r="endswith",a={value:"value",text:"text"}),("Numeric"==i||"Datepicker"==i||"Datetimepicker"==i)&&(o=n.numberMenuOptions,r="GreaterThan",a={value:"value",text:"text"}),"Dropdown"==i&&(o=l.dropdownData,a=l.editParams?{value:l.editParams.fields.value,text:l.editParams.fields.text}:{value:"value",text:"text"}),"String"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejAutocomplete({width:"100%",watermarkText:n.enterValueText,filterType:r,enableResize:!1,enableDistinct:!0,locale:d.model.locale,cssClass:d.model.cssClass}),"Numeric"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejNumericTextbox({decimalPlaces:2,width:"100%",locale:d.model.locale}),"Boolean"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejCheckBox({size:"small"}),"Datetimepicker"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejDateTimePicker({width:"100%",locale:d.model.locale,cssClass:d.model.cssClass}),"Datepicker"==i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"InputBox").ejDatePicker({width:"100%",locale:d.model.locale,cssClass:d.model.cssClass}),"Boolean"!=i&&e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"DropDown").ejDropDownList({dataSource:o,selectedIndex:1,fields:a,select:function(t){"String"==i&&e("#"+d._id+"filter"+i+"InputBox").data("ejAutocomplete").option("filterType",t.value)},cssClass:d.model.cssClass,width:"100%"}),e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"MenuButton").ejButton({size:"normal",width:"100%",cssClass:d.model.cssClass,click:function(t){var i,l,n=e.trim(d._columnMenuTarget.prev("div.e-headercelldiv").attr("data-ej-mappingname")),o=d.getColumnByField(n);t.e.target.id==d._id+"filterStringMenuButton"&&(i=e("#"+d._id+"filterStringInputBox").data("ejAutocomplete"),l=e("#"+d._id+"filterStringMenuDiv").find("#"+d._id+"filterStringDropDown").data("ejDropDownList"),d._performMenuFilter(o,i.value(),l.model.value)),t.e.target.id==d._id+"filterNumericMenuButton"&&(i=e("#"+d._id+"filterNumericInputBox").data("ejNumericTextbox"),l=e("#"+d._id+"filterNumericMenuDiv").find("#"+d._id+"filterNumericDropDown").data("ejDropDownList"),d._performMenuFilter(o,i.model.value,l.model.value)),t.e.target.id==d._id+"filterDropdownMenuButton"&&(l=e("#"+d._id+"filterDropdownMenuDiv").find("#"+d._id+"filterDropdownDropDown").data("ejDropDownList"),d._performMenuFilter(o,l.model.value,"equal")),t.e.target.id==d._id+"filterDatepickerMenuButton"&&(i=e("#"+d._id+"filterDatepickerInputBox").data("ejDatePicker"),l=e("#"+d._id+"filterDatepickerMenuDiv").find("#"+d._id+"filterDatepickerDropDown").data("ejDropDownList"),d._performMenuFilter(o,i.model.value,l.model.value)),t.e.target.id==d._id+"filterDatetimepickerMenuButton"&&(i=e("#"+d._id+"filterDatetimepickerInputBox").data("ejDateTimePicker"),l=e("#"+d._id+"filterDatetimepickerMenuDiv").find("#"+d._id+"filterDatetimepickerDropDown").data("ejDropDownList"),d._performMenuFilter(o,i.model.value,l.model.value)),t.e.target.id==d._id+"filterBooleanMenuButton"&&("uncheck"==(i=e("#"+d._id+"filterBooleanInputBox").data("ejCheckBox")).model.checkState?d._performMenuFilter(o,!1,"equal"):"check"==i.model.checkState&&d._performMenuFilter(o,!0,"equal"))}}),e("#"+d._id+"filter"+t).find("#"+d._id+"filter"+i+"ClearButton").ejButton({size:"normal",width:"100%",cssClass:d.model.cssClass,click:function(t){var i,l=e.trim(d._columnMenuTarget.prev("div.e-headercelldiv").attr("data-ej-mappingname")),n=d.getColumnByField(l);d._isExcelFilter&&delete d._excelFilter._predicates[0][n.field],t.e.target.id==d._id+"filterStringClearButton"&&(i=e("#"+d._id+"filterStringMenuDiv").find("#"+d._id+"filterStringDropDown").data("ejDropDownList"),d._performMenuFilter(n,"",i.model.value)),t.e.target.id==d._id+"filterNumericClearButton"&&(i=e("#"+d._id+"filterNumericMenuDiv").find("#"+d._id+"filterNumericDropDown").data("ejDropDownList"),d._performMenuFilter(n,"",i.model.value)),t.e.target.id==d._id+"filterDropdownClearButton"&&(i=e("#"+d._id+"filterDropdownMenuDiv").find("#"+d._id+"filterDropdownDropDown").data("ejDropDownList"),d._performMenuFilter(n,"","equal")),t.e.target.id==d._id+"filterDatepickerClearButton"&&(i=e("#"+d._id+"filterDatepickerMenuDiv").find("#"+d._id+"filterDatepickerDropDown").data("ejDropDownList"),d._performMenuFilter(n,"",i.model.value)),t.e.target.id==d._id+"filterDatetimepickerClearButton"&&(i=e("#"+d._id+"filterDatetimepickerMenuDiv").find("#"+d._id+"filterDatetimepickerDropDown").data("ejDropDownList"),d._performMenuFilter(n,"",i.model.value)),t.e.target.id==d._id+"filterBooleanClearButton"&&d._performMenuFilter(n,"","equal")}})},_renderExcelFilter:function(){var i=this,l=i.model,n=l.filterSettings,o=0!=n.filteredColumns.length?n.filteredColumns[0].field:null,r={instance:this,showSortOptions:!!l.allowSorting&&!l.showColumnChooser,allowCaseSensitive:n.enableCaseSensitivity,maxFilterLimit:n.maxFilterChoices,interDeterminateState:!0,enableComplexBlankFilter:n.enableComplexBlankFilter,blankValue:n.blankValue,allowAccent:!0,filteredColumns:n.filteredColumns,filterHandler:e.proxy(i._filterHandler,i),cancelHandler:e.proxy(i._cancelHandler,i),initFilterCol:o,actionBegin:"actionBegin",actionComplete:"actionComplete"};i._excelFilter=new t.excelFilter(r),i._isExcelFilter=!0},_cancelHandler:function(){var t=this;e("#"+t._id).find(".e-filtericon").data("isClicked",!1),t._mediaStatus=!1,t.model.showColumnChooser&&!t._isCloseFilterMenu&&t._clearColumnMenu("cancelHandler"),t._isCloseFilterMenu=!1},_filterHandler:function(i){var l,n,o,r,a,d,s,c,u=this,g=u.model,m={};switch(m.requestType="sorting"==i.action?i.action:"filtering",n=g.filterSettings.filteredColumns,i.action){case"sorting":0!=u.getColumnByField(i.sortDetails.field).allowSorting&&(g.allowMultiSorting&&(u._multiSortRequest=!0),u.sortColumn(i.sortDetails.field,i.sortDetails.direction),u._multiSortRequest=!1);break;case"filtering":for(u.clearAllSelection(),l=t.DataManager(g.filterSettings.filteredColumns),o=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),r=l.executeLocal(o),a=0;a<r.length;a++)-1!=(d=e.inArray(r[a],g.filterSettings.filteredColumns))&&g.filterSettings.filteredColumns.splice(d,1);t.merge(g.filterSettings.filteredColumns,i.filterCollection),i.currentFilterCollection=i.filterCollection,m.currentFilteringColumn=i.fieldName,m.predicated=i.ejpredicate,u.processBindings(m)&&(g.filterSettings.filteredColumns=n),u._filterIconTarget&&(u._filterIconTarget.target.className="e-column-filtered-icon e-icon e-filtericon"),u._filteredColumnValueID.push(i.fieldName);break;case"clearfiltering":u.clearAllSelection(),s=i.filterDetails,delete u._excelFilter._predicates[0][i.fieldName],u.filterColumn(s.field,s.operator,s.value,s.predicate),u._storePreviousFilteredValue(s.field,s.value,s.operator),u._filterIconTarget&&(u._filterIconTarget.target.className="e-column-filter-icon e-icon e-filtericon"),-1!=u._filteredColumnValueID.indexOf(i.fieldName)&&(c=u._filteredColumnValueID.indexOf(i.fieldName),u._filteredColumnValueID.splice(c,1))}e("#"+u._id).find(".e-filtericon").data("isClicked",!1),u._mediaStatus=!1,g.showColumnChooser&&u._clearColumnMenu()},_renderColumnChooserList:function(i,l){for(var n,o,r=this,a=r.model.columns.length,d=r.model.columns,s=t.buildTag("div","",{"margin-left":"0px",width:"auto"}),c=0;c<a;c++)if(r.model.treeColumnIndex!=c&&1==d[c].showInColumnChooser){if((n=d[c]).nonColumn)continue;if(!t.isNullOrUndefined(n)){var u=t.buildTag("div","","",{class:"e-columnMenuListDiv"}),g=t.isNullOrUndefined(n.headerText)?n.field:n.headerText,m=t.buildTag("input","",{},{id:r._id+"_columnMenu_"+n.field.split(".").join(""),value:g,type:"checkbox"}),p=t.buildTag("label",g,{width:"auto"},{for:r._id+"_columnMenu_"+n.field.split(".").join("")});u.append(m),u.append(p),u.data("column",n.headerText),s.append(u),n.headerText==l&&u.addClass("e-columnmenuselection"),m.ejCheckBox({checked:!!t.isNullOrUndefined(n.visible)||n.visible,cssClass:r.model.cssClass,change:function(e){var i;i="msie"==t.browserInfo().name&&t.browserInfo().version<9?this.element.closest(".e-columnMenuListDiv").data().column:e.model.value,e.isChecked?r.showColumn(i):r.hideColumn(i),r._updateWrapRowHeights(null,"virtualRefresh")}})}}i?(r._columnChooserList.empty().append(s.children()),r._focusTreeGridElement()):r._columnChooserList=s,o=r._columnChooserList.find("div.e-columnMenuListDiv"),e(o).mouseenter(function(){o.removeClass("e-columnmenuselection"),e(this).addClass("e-columnmenuselection")})},_createColumnMenuTemplate:function(){var t="<li style='list-style-type:none;'><div class='e-columnmenuitem{{if enabled==false}} e-disable{{/if}}{{if (menuId =='Columns' || menuId =='Filter')}} e-parent-menuitem{{/if}}' style='display:table;cursor:pointer' id='"+this._id+"_{{:menuId}}Chooser'><div class='e-icon {{:icon}} e-treegridicon' style='display:inline-block;'></div><div class='e-menuitem-label' style='display:inline-block;width:auto'><span>{{:name}}</span></div>{{if (menuId =='Columns' || menuId =='Filter')}}<div class='e-icon e-expander e-treegridicon' style='display:inline-block;float:right;'/> {{/if}}</div>{{if menuId == 'RenameColumn' || menuId == 'SortDescending'}}<hr class='e-menuitem-hr'>{{/if}}</li>",i={};i[this._id+"columnMenuTemplate"]=t,e.templates(i)},_updateFilterMenuList:function(t){var i,l,n,o,r,a,d,s,c,u=this,g=u.model,m=e(t.target),p=m[0].offsetWidth,h=m[0].offsetHeight,_=e.trim(m.prev("div.e-headercelldiv").attr("data-ej-mappingname")),f=u.getColumnByField(_);l=i=0,u._clearFilterMenu(),u._clearColumnMenu("columnmenu"),u._columnMenuTarget=m,u._filterIconTarget=t,u._saveEditedElements(),(o=u.getOffsetRect(m[0])).top=o.top+h,u.model.isFromGantt,i=o.top+h,r=g.isFromGantt?e(this.element).closest(".e-gantt"):e(this.element),(n=this.getOffsetRect(r[0])).bottom=n.top+r[0].offsetHeight,n.right=n.left+e(r).width(),f.filterEditType?(s=f.filterEditType.indexOf("edit"),c=f.filterEditType):(s=f.editType.indexOf("edit"),c=f.editType),-1!=s?(d=(a=c.slice(0,s)).charAt(0).toUpperCase()+a.slice(1),u._showFilterMenu("filtermenu","filter"+d,o,p,n.right,l,null,null,f,i)):(d=c.charAt(0).toUpperCase()+c.slice(1),u._showFilterMenu("filtermenu","filter"+d,o,p,n.right,l,null,null,f,i)),u._updatePreviousFilteredValue(f)},_showColumnChooser:function(t,i,l,n,o,r,a,d){var s,c,u=this,g=u.model,m=e(window).width();if("mouseenter"==t.type&&m>u._responsiveMinWidth||d||!u.model.isResponsive||"click"==t.type&&m<=u._responsiveMinWidth&&u.model.isResponsive||g.isFromGantt){if(m>u._responsiveMinWidth||d||!u.model.isResponsive||g.isFromGantt){(s={}).width="auto",s.height="auto",s.minWidth="0px",s.minHeight="0px",s.showHeader=!1,s.position={X:r,Y:o},s.enableModal=!1,s.isResponsive=!1,s.enableResize=!1,s.cssClass=u.model.cssClass,e("#"+u._id+"ccDiv_wrapper").addClass("e-treegridadaptivedialog"),e("#"+u._id+"ccDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e("#"+u._id+"ccDiv").ejDialog(s),e("#"+u._id+"ccDiv").css({height:"auto"}),u._updateColumnMenuVisibility();var p=e("#"+u._id+"ccDiv").ejDialog("instance"),h=e("#"+u._id+"ccDiv_wrapper"),_=h.find("div.e-columnMenuListDiv");p.open(),i<l+h.width()&&(l=l-h.width()-n),c={X:l,Y:o+a.position().top},p.option({position:c}),h.css("z-index",u.getMaxZIndex()+1),_.removeClass("e-columnmenuselection"),_.eq(0).addClass("e-columnmenuselection"),u._focusTreeGridElement(),u._renderedSubMenuType="ColumnDesktop"}else u._adaptiveColumnChooser();g.allowFiltering&&("menu"==g.filterSettings.filterType||"excel"==g.filterSettings.filterType)&&(u._isCloseFilterMenu=!0,u._clearFilterMenu())}},_renderColumnMenu:function(l){var n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C,x,v=this,S=v.model,R=e(l.target),T=[],b=0,y=R[0].offsetWidth,I=R[0].offsetHeight,D=v._columnMenuTexts,E=e.trim(R.prev("div.e-headercelldiv").attr("data-ej-mappingname")),M=v.getColumnByField(E),k=M.allowSorting==i||M.allowSorting;if(v._batchEditStarts&&!v._confirmDialog.is(":visible"))return v._batchSaveLostWarning("ColumnMenu"),v._batchTempDetails.menuTarget=l,!0;if(n=a=0,v._clearColumnMenu("columnmenu"),v._columnMenuTarget=R,S.isEdit||this._isRowEdit){if(!this.editFormValidate())return!0;v._saveEditedElements()}S.showColumnChooser&&S.showColumnOptions&&(s=v._enableDisableInsertLabel(),T.push({name:D.insertColumnLeft,icon:"e-column-insertleft-icon",menuId:"ColumnLeft",enabled:s}),T.push({name:D.insertColumnRight,icon:"e-column-insertright-icon",menuId:"ColumnRight",enabled:s}),T.push({name:D.deleteColumn,icon:"e-column-delete-icon",menuId:"DeleteColumn",enabled:v._enableDisableDEL(M)}),T.push({name:D.renameColumn,icon:"e-column-rename-icon",menuId:"RenameColumn"})),S.allowFiltering&&(t.isNullOrUndefined(M.allowFiltering)||M.allowFiltering)&&("menu"==S.filterSettings.filterType||"excel"==S.filterSettings.filterType)&&(-1!=v._filteredColumnValueID.indexOf(M.field)?(T.push({name:D.menuFilter,icon:"e-column-filtered-icon",menuId:"Filter"}),d=T.length):(T.push({name:D.menuFilter,icon:"e-column-filter-icon",menuId:"Filter"}),d=T.length)),S.allowSorting&&k&&(T.push({name:D.sortAscendingText,icon:"e-columnmenu-ascending",menuId:"SortAscending"}),T.push({name:D.sortDescendingText,icon:"e-columnmenu-descending",menuId:"SortDescending"})),S.showColumnChooser&&(b=T.length,T.push({name:D.columnsText,icon:"e-columnchooser-icon",menuId:"Columns"})),S.isFromGantt||(M.allowFreezing||v._allowFreezingDefault&&t.isNullOrUndefined(M.allowFreezing))&&(u=!1,v._frozenColumnsLength!=S.columns.length-1||M.isFrozen||(c=!0),g=this._getFrozenColumnWidth(),m=S.columns.indexOf(M),(g=g+this.columnsWidthCollection[m]+18)>this._gridWidth&&(c=!0),T.push({name:D.freezeText,icon:"e-freezecolumn-icon",menuId:"FreezeColumns",enabled:!c&&!M.isFrozen}),T.push({name:D.unfreezeText,icon:"e-unfreezecolumn-icon",menuId:"UnfreezeColumns",enabled:1==M.isFrozen}),v._checkboxSelection&&S.columns[0].nonColumn?1!=S.columns.indexOf(M)&&S.columns.indexOf(M)>this._frozenColumnsLength&&(u=!0):0!=S.columns.indexOf(M)&&S.columns.indexOf(M)>this._frozenColumnsLength&&(u=!0),g=this._getFrozenColumnWidth(m),(g+=18)>this._gridWidth&&(u=!1),T.push({name:D.freezePrecedingColumnsText,icon:"e-freezecolumnbefore-icon",menuId:"FreezePrecedingColumns",enabled:u})),p=v.getOffsetRect(R[0]),h=v.getOffsetRect(v.element[0]),v.model.isFromGantt,a=p.top+I,v._columnChooserListIndex=b;var F=t.buildTag("div.e-columnmenu e-js","",{display:"table",position:"absolute",top:a,"z-index":1e4},{id:v._id+"_ColumnMenu"}),O=t.buildTag("ul.e-treegrid-columnmenu","",{},{}),H=e.render[v._id+"columnMenuTemplate"](T);S.cssClass&&F.addClass(S.cssClass),O.append(H),F.append(O),e(document.body).append(F),F.height(),_=F.outerWidth()+1,(n=p.left+y-_)<=h.left&&(n=h.left),o=n+_,r=n+_,v._columnListPosX=o,v._columnFilterPosX=r,v._columnMenuPopupY=a,F.css({left:n}),F.find(".e-columnmenuitem").outerWidth(_),f=S.isFromGantt?e(this.element).closest(".e-gantt"):e(this.element),(w=this.getOffsetRect(f[0])).bottom=w.top+f[0].offsetHeight,w.right=w.left+e(f).width(),S.isFromGantt||(v.model.isResponsive&&e(window).width()<=v._responsiveMinWidth?e("#"+v._id+"_ColumnMenu").find(".e-expander").addClass("e-treegridadaptivesubicon"):e("#"+v._id+"_ColumnMenu").find(".e-expander").removeClass("e-treegridadaptivesubicon")),e("#"+v._id+"_ColumnsChooser").on("mouseenter click",function(t){v._showColumnChooser(t,w.right,o,_,a,n,e("#"+v._id+"_ColumnsChooser"))}),e("#"+v._id+"_FilterChooser").on("mouseenter click",function(t){var i,l,o,s;("mouseenter"==t.type&&e(window).width()>v._responsiveMinWidth||!v.model.isResponsive||"click"==t.type&&e(window).width()<=v._responsiveMinWidth&&v.model.isResponsive)&&(v._updateColumnMenuVisibility(),v._checkFilterType(M),"menu"==S.filterSettings.filterType&&"excel"!=M.filterType||"excel"==S.filterSettings.filterType&&"menu"==M.filterType?(M.filterEditType?(i=M.filterEditType.indexOf("edit"),s=M.filterEditType):(M.editType="edittemplate"==M.editType?"stringedit":M.editType,i=M.editType.indexOf("edit"),s=M.editType),-1!=i?(o=(l=s.slice(0,i)).charAt(0).toUpperCase()+l.slice(1),v._showFilterMenu("columnchooser","filter"+o,r,_,w.right,n,b,d,M,a)):(o=s.charAt(0).toUpperCase()+s.slice(1),v._showFilterMenu("columnchooser","filter"+o,r,_,w.right,n,b,d,M,a)),v._updatePreviousFilteredValue(M),e("#"+v._id+"ccDiv").ejDialog("close")):v._openExcelFilter(M,r,a,w,_))}),e("#"+v._id+"_SortAscendingChooser,#"+v._id+"_SortDescendingChooser,#"+v._id+"_FreezeColumnsChooser,#"+v._id+"_UnfreezeColumnsChooser,#"+v._id+"_FreezePrecedingColumnsChooser,#"+v._id+"_ColumnLeftChooser,#"+v._id+"_ColumnRightChooser,#"+v._id+"_DeleteColumnChooser,#"+v._id+"_RenameColumnChooser").mouseenter(function(){e("#"+v._id+"ccDiv").ejDialog("close"),S.allowFiltering&&("menu"==S.filterSettings.filterType||"excel"==S.filterSettings.filterType)&&(v._isCloseFilterMenu=!0,v._clearFilterMenu())}),e("#"+v._id+"_SortAscendingChooser").click(function(){S.allowMultiSorting&&(v._multiSortRequest=!0),S.isFromGantt?v.sortColumn(M.mappingName?M.mappingName:M.field,t.sortOrder.Ascending):v.sortColumn(M.field,t.sortOrder.Ascending),v._multiSortRequest=!1}),e("#"+v._id+"_SortDescendingChooser").click(function(){S.allowMultiSorting&&(v._multiSortRequest=!0),S.isFromGantt?v.sortColumn(M.mappingName?M.mappingName:M.field,t.sortOrder.Descending):v.sortColumn(M.field,t.sortOrder.Descending),v._multiSortRequest=!1}),e("#"+v._id+"_FreezeColumnsChooser").click(function(){e(this).hasClass("e-disable")||(v._checkboxSelection&&S.columns[0].nonColumn&&!S.columns[0].isFrozen&&(S.columns[0].isFrozen=!0),v.freezeColumn(M.field,!0))}),e("#"+v._id+"_UnfreezeColumnsChooser").click(function(){e(this).hasClass("e-disable")||(v._checkboxSelection&&2==v._frozenColumnsLength&&S.columns[0].nonColumn&&S.columns[0].isFrozen&&(S.columns[0].isFrozen=!1),v.freezeColumn(M.field,!1))}),e("#"+v._id+"_FreezePrecedingColumnsChooser").click(function(){e(this).hasClass("e-disable")||v.freezePrecedingColumns(M.field)}),e("#"+v._id+"_ColumnLeftChooser").click(function(){if(e(this).hasClass("e-disable"))return!1;v.insertColumnChooser(M,"left")}),e("#"+v._id+"_ColumnRightChooser").click(function(){if(e(this).hasClass("e-disable"))return!1;v.insertColumnChooser(M,"right")}),e("#"+v._id+"_DeleteColumnChooser").click(function(){if(e(this).hasClass("e-disable"))return!1;v._targetColumnIndex=S.columns.indexOf(M),v._updateConfirmDialog.ejDialog("open"),v._clearColumnMenu()}),e("#"+v._id+"_RenameColumnChooser").click(function(){v._targetColumnIndex=S.columns.indexOf(M),v._renderColumnRenameDialog(M),v._columnRenameDialog.ejDialog("open"),v._clearColumnMenu()}),C=e("#"+v._id+"_ColumnMenu"),(x=C.find("div.e-columnmenuitem")).eq(0).addClass("e-columnmenuselection"),e(x).mouseenter(function(){e(this).hasClass("e-disable")||(x.removeClass("e-columnmenuselection"),e(this).addClass("e-columnmenuselection"))})},_openExcelFilter:function(t,i,l,n,o){var r,a,d,s=this,c=s.model,u=e(document).width(),g=t.filterEditType?t.filterEditType:t.editType,m=i;switch(g=g.toLowerCase(),n.right<m+266||u<m+266?m-o-266>0&&(m=m-o-268):m+=2,r={X:m,Y:l+e("#"+s._id+"_FilterChooser").position().top},g){case"numericedit":g="number";break;case"stringedit":case"maskedit":case"dropdownedit":g="string";break;case"booleanedit":g="boolean";break;case"datepicker":case"datetimepicker":g=g.replace("picker","")}u<=s._responsiveMinWidth&&c.isResponsive&&c.enableResize?(s._renderResponsiveExcelFilter(t,g),s._mediaStatus=!0,s._clearColumnMenu()):(-1==e.inArray(g,s._excelColTypes)&&(e("#"+s._id+g+"_excelDlg").remove(),e("#"+s._id+g+"_CustomFDlg_wrapper").remove(),e("#"+s._id+g+"_CustomFDlg").remove(),s._excelFilter._openedFltr=null,s._excelColTypes.push(g),s._excelFilter.renderDialog(g)),a={True:s.localizedLabels.trueText,False:s.localizedLabels.falseText},d=[],e.grep(s.model.flatRecords,function(e){e.isSummaryRow||d.push(e.item)}),s._isCloseFilterMenu=!0,s._excelFilter.openXFDialog({field:t.field,enableResponsiveRow:!0,displayName:t.headerText,dataSource:d,query:"",position:{X:r.X,Y:r.Y},dimension:{height:e(window).height(),width:e(window).width()},cssClass:"resFilter",type:g,format:t.format,localizedStrings:a}),s._isCloseFilterMenu=!1,e("#"+s._id+g+"_CheckBoxList").css("display","inline-block"),s._customFilter=null),e("#"+s._id+"ccDiv").ejDialog("close")},_adaptiveColumnChooser:function(){var t,i=this,l={},n=i.getOffsetRect(e("#"+i._id)[0]),o=i._columnMenuTexts;l.cssClass=i.model.cssClass,l.enableModal=!1,l.enableResize=!1,l.enableResize=!1,l.contentSelector="#"+i._id,l.rtl=i.model.rtl,l.allowDraggable=!1,l.showHeader=!0,l.minHeight="50px",l.minWidth="50px",l.width=e("#"+i._id).width()+"px",l.height=e("#"+i._id).height()+"px",l.position={X:n.left+"px",Y:n.top+"px"},l.isResponsive=!1,l.allowKeyboardNavigation=!1,l.title=o.columnsText,e("#"+i._id+"ccDiv_wrapper").removeClass("e-treegridadaptivedialog"),e("#"+i._id+"ccDiv_wrapper").addClass("e-dialog").addClass("e-shadow").find("div.e-dialog-scroller").css("height","100%"),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").addClass("e-treegridadaptivedialog"),e("#"+i._id+"ccDiv").ejDialog(l),e("#"+i._id+"ccDiv").ejDialog("open"),e("#"+i._id+"ccDiv").css({width:"100%",height:"100%"}),i.model.isResponsive&&(t=e("#"+i._id).height()-50+"px",e("#"+i._id+"ccDiv_wrapper").css({width:e("#"+i._id).width(),height:e("#"+i._id).height()}),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+i._id+"ccDiv").css({width:"100%",height:"auto"}),e("#"+i._id+"ccDiv").height()>e("#"+i._id+"ccDiv_wrapper").height()-48?(e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:e("#"+i._id).height()-48+"px",width:"auto",padding:"0px"}),e("#"+i._id+"ccDiv").removeClass("e-columnSelector"),e("#"+i._id+"ccDiv").ejDialog("refresh")):(e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({height:t,width:"auto"}),e("#"+i._id+"ccDiv").css({padding:"8px 16px"})),e("#"+i._id+"ccDiv_wrapper").removeClass("e-shadow"),e("#"+i._id+"ccDiv").removeClass("e-shadow")),i._renderedSubMenuType="AdaptiveColChooser",e("#"+i._id+"_ColumnMenu").remove()},_updatePreviousFilteredValue:function(i){var l,n,o,r,a,d,s,c,u=this,g=[];"stringedit"==(d=i.filterEditType?i.filterEditType:i.editType)&&(c=e("#"+u._id+"filterStringInputBox").data("ejAutocomplete"),l=e("#"+u._id+"filterStringMenuDiv").find("#"+u._id+"filterStringDropDown").data("ejDropDownList"),n=t.Query().select(i.field),o=new t.DataManager(u.model.flatRecords.slice()).executeLocal(n),c.option("dataSource",o),-1!=u._filteredColumnValueID.indexOf(i.field)?(r=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[r].value?l.option("value","startswith"):l.option("value",u._filteredColumnValue[r].dropdown),c.option("value",u._filteredColumnValue[r].value),e("#"+u._id+"filterStringInputBox").val(u._filteredColumnValue[r].value)):(l.option("value","startswith"),c.option("value",null))),"numericedit"==d&&(c=e("#"+u._id+"filterNumericInputBox").data("ejNumericTextbox"),l=e("#"+u._id+"filterNumericMenuDiv").find("#"+u._id+"filterNumericDropDown").data("ejDropDownList"),-1!=u._filteredColumnValueID.indexOf(i.field)?(r=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[r].value?l.option("value","lessthan"):l.option("value",u._filteredColumnValue[r].dropdown),c.option("value",u._filteredColumnValue[r].value),e("#"+u._id+"filterNumericInputBox").val(u._filteredColumnValue[r].value)):(c.option("value",null),l.option("value","lessthan"))),"datepicker"==d&&(c=e("#"+u._id+"filterDatepickerInputBox").data("ejDatePicker"),l=e("#"+u._id+"filterDatepickerMenuDiv").find("#"+u._id+"filterDatepickerDropDown").data("ejDropDownList"),-1!=u._filteredColumnValueID.indexOf(i.field)?(r=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[r].value?l.option("value","lessthan"):l.option("value",u._filteredColumnValue[r].dropdown),c.option("value",u._filteredColumnValue[r].value)):(c.option("value",null),l.option("value","lessthan")),i.format&&c.option("dateFormat",u._getDateFormat(i.format))),"datetimepicker"==d&&(c=e("#"+u._id+"filterDatetimepickerInputBox").data("ejDateTimePicker"),l=e("#"+u._id+"filterDatetimepickerMenuDiv").find("#"+u._id+"filterDatetimepickerDropDown").data("ejDropDownList"),-1!=u._filteredColumnValueID.indexOf(i.field)?(r=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[r].value?l.option("value","lessthan"):l.option("value",u._filteredColumnValue[r].dropdown),c.option("value",u._filteredColumnValue[r].value)):(c.option("value",null),l.option("value","lessthan")),i.format&&c.option("dateFormat",u._getDateFormat(i.format))),"dropdownedit"==d&&(e.extend(g,i.dropdownData),i.editParams?(a={value:i.editParams.fields.value,text:i.editParams.fields.text},(s={})[i.editParams.fields.text]=u._dropDownListBlanksText,s[i.editParams.fields.value]="(Blanks)"):(a={value:"value",text:"text"},s={text:u._dropDownListBlanksText,value:"(Blanks)"}),l=e("#"+u._id+"filterDropdownDropDown").data("ejDropDownList"),t.isNullOrUndefined(g)||0==g.length?(g=u._dropDownArrayCollection(i,i.field),(i.allowFilteringBlankContent||t.isNullOrUndefined(i.allowFilteringBlankContent))&&g.unshift(s),l.option("dataSource",g)):((i.allowFilteringBlankContent||t.isNullOrUndefined(i.allowFilteringBlankContent))&&g.unshift(s),l.option("dataSource",g)),l.option("fields",a),-1!=u._filteredColumnValueID.indexOf(i.field)?(r=u._filteredColumnValueID.indexOf(i.field),l.option("value",u._filteredColumnValue[r].value)):l.option("value",null)),"booleanedit"==d&&(c=e("#"+u._id+"filterBooleanInputBox").data("ejCheckBox"),-1!=u._filteredColumnValueID.indexOf(i.field)?(r=u._filteredColumnValueID.indexOf(i.field),""==u._filteredColumnValue[r].value?c.option("checkState","uncheck"):c.option("value",u._filteredColumnValue[r].value)):c.option("selectedIndex",""))},_performMenuFilter:function(e,i,l){var n,o=this;o.clearAllSelection(),n=e.filterEditType?e.filterEditType:e.editType,t.isNullOrUndefined(i)&&(i=""),o._filterString=i,-1==o._filteredColumnValueID.indexOf(e.field)&&""==i.toString()?(o.clearColumnMenu(),o._clearFilterMenu()):(("numericedit"==n||"datepicker"==n||"datetimepicker"==n)&&("datepicker"!=n&&"datetimepicker"!=n||"equal"!=l&&"notequal"!=l)?o.filterColumn(e.field,l,i,"and",!0):o.filterColumn(e.field,l,i,"and"),o.clearColumnMenu(),o._clearFilterMenu(),o._cancelSaveTools())},_storePreviousFilteredValue:function(e,t,i){var l,n=this;-1!=n._filteredColumnValueID.indexOf(e)||""==t.toString()&&"false"!=t.toString()?""!=t.toString()||"false"==t.toString()?(l=n._filteredColumnValueID.indexOf(e),n._filteredColumnValue[l].value=t,n._filteredColumnValue[l].dropdown=i):-1!=n._filteredColumnValueID.indexOf(e)&&(l=n._filteredColumnValueID.indexOf(e),n._filteredColumnValue.splice(l,1),n._filteredColumnValueID.splice(l,1)):(n._filteredColumnValue.push({column:e,value:t,dropdown:i}),n._filteredColumnValueID.push(e))},_showFilterMenu:function(t,i,l,n,o,r,a,d,s,c){var u,g,m,p,h,_,f;if(this.editFormValidate())if(e(window).width()<=this._responsiveMinWidth&&this.model.isResponsive&&!this.model.isFromGantt){var w,C={},x=(w=this).getOffsetRect(e("#"+w._id)[0]);C.cssClass=this.model.cssClass,C.enableModal=!1,C.isResponsive=!1,C.enableRTL=this.model.enableRTL,C.enableResize=!1,C.allowDraggable=!1,C.minWidth="50px",C.minHeight="50px",C.width=e("#"+w._id).width()+"px",C.height=e("#"+w._id).height()+"px",C.position={X:x.left+"px",Y:x.top+"px"},C.contentSelector="#"+w._id,C.rtl=w.model.rtl,C.allowKeyboardNavigation=!1,C.showHeader=!0,C.title=s.headerText,e("#"+w._id+i+"MenuDiv").removeClass("e-treegridadaptivedialog"),e("#"+w._id+i+"MenuDiv").ejDialog(C),e("#"+w._id+i+"MenuDiv_wrapper").addClass("e-dialog").addClass("e-shadow").find("div.e-dialog-scroller").addClass("e-treegridadaptivewidth"),e("#"+w._id+i+"MenuDiv").css({width:"100%",height:"auto"}),u=e("#"+w._id).height()-50+"px",e("#"+w._id+i+"MenuDiv").ejDialog("open"),e("#"+w._id+i+"MenuDiv_wrapper").find("div.e-dialog-scroller").css({height:u}),e("#"+w._id+i+"MenuDiv_wrapper").removeClass("e-shadow"),e("#"+w._id+i+"MenuDiv").removeClass("e-shadow"),e("#"+w._id+i+"MenuDiv").height()>e("#"+w._id+i+"MenuDiv_wrapper").height()-48&&e("#"+w._id+i+"MenuDiv").ejDialog("refresh"),w._renderedSubMenuType="#"+w._id+i+"MenuDiv",e("#"+w._id+"_ColumnMenu").remove()}else w=this,(C={}).width="auto",C.height="auto",C.minWidth="0px",C.minHeight="0px",C.showHeader=!1,C.position={X:1,Y:1},C.enableModal=!1,C.isResponsive=!1,C.enableResize=!1,C.cssClass=this.model.cssClass,e("#"+w._id+i+"MenuDiv_wrapper").removeClass("e-dialog").removeClass("e-shadow").find("div.e-dialog-scroller").css("height","100%").removeClass("e-widget-content"),e("#"+w._id+i+"MenuDiv").ejDialog(C),g=e("#"+w._id+i+"MenuDiv").ejDialog("instance"),m=e("#"+w._id+i+"MenuDiv_wrapper"),"columnchooser"==t?(h=e(document).width(),(o<l+m.width()||h<l+m.width())&&l-n-m.width()>0&&(l=l-n-m.width()),p={X:l,Y:c+e("#"+w._id+"_FilterChooser").position().top},g.option({position:p}),g.open()):(t="filtermenu")&&(f=n,r=(_=l).left+f-m.width(),_.left=r+m.width()+4,o<_.left+m.width()&&(_.left=_.left-m.width()-f),p={X:_.left,Y:_.top},g.option({position:p}),g.open()),w._renderedSubMenuType="#"+w._id+i+"MenuDivDesktop"},_clearResponsiveColumnMenu:function(){var t=this;e("div[id$='ccDiv']").each(function(){"TreeGrid"==e(this).data("columnMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+t._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({padding:"0px"}),e("#"+t._id+"ccDiv").addClass("e-columnSelector"),e("div[id$='filterStringMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterStringMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterNumericMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterNumericMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterBooleanMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterBooleanMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterDatepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterDatetimepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatetimepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='filterDropdownMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDropdownMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='ColumnRenameDialog']").each(function(){e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='dialogColumnAdd']").each(function(){e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+t._id).find(".e-filtericon").data("isClicked",!1)},_clearColumnMenu:function(t){var i=this,l=i.model;"columnmenu"===t&&e(window).width()<i._responsiveMinWidth&&i._clearResponsiveColumnMenu(),l.isResponsive&&e(window).width()<i._responsiveMinWidth?(e("#"+i._id+"_ColumnMenu").remove(),i._renderedSubMenuType&&-1==i._renderedSubMenuType.indexOf("AdaptiveColChooser")&&(e("div[id$='"+i._id+"ccDiv']").each(function(){"TreeGrid"==e(this).data("columnMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({padding:"0px"}),e("#"+i._id+"ccDiv").addClass("e-columnSelector"))):(e("#"+i._id+"_ColumnMenu").remove(),"resize"!=t&&(e("div[id$='"+i._id+"ccDiv']").each(function(){"TreeGrid"==e(this).data("columnMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+i._id+"ccDiv_wrapper").find("div.e-dialog-scroller").css({padding:"0px"}),e("#"+i._id+"ccDiv").addClass("e-columnSelector"),"resize"!=t&&"cancelHandler"!=t&&l.allowFiltering&&("menu"==l.filterSettings.filterType||"excel"==l.filterSettings.filterType)&&i._clearFilterMenu())),e("#"+i._id).find(".e-columnicon").data("isClicked",!1),e("#"+i._id).find(".e-filtericon").data("isClicked",!1)},_clearFilterMenu:function(){var t,i,l=this;l.model.allowFiltering&&(e("div[id$='"+l._id+"filterStringMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterStringMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+l._id+"filterNumericMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterNumericMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+l._id+"filterBooleanMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterBooleanMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+l._id+"filterDatepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+l._id+"filterDatetimepickerMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDatetimepickerMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("div[id$='"+l._id+"filterDropdownMenuDiv']").each(function(){"TreeGrid"==e(this).data("filterDropdownMenuDialog")&&e(this).data("ejDialog")&&e(this).ejDialog("close")}),e("#"+l._id+"filterStringDropDown_popup_list_wrapper").hide(),e("#"+l._id+"filterStringInputBox_suggestion").hide(),e("#"+l._id+"filterNumericDropDown_popup_list_wrapper").hide(),e("#"+l._id+"filterNumericInputBox_suggestion").hide(),e("#"+l._id+"filterDatepickerDropDown_popup_list_wrapper").hide(),e("#"+l._id+"filterDatepickerInputBox_suggestion").hide(),e("#"+l._id+"filterDatetimepickerDropDown_popup_list_wrapper").hide(),e("#"+l._id+"filterDatetimepickerInputBox_suggestion").hide(),e("#"+l._id+"filterDropdownDropDown_popup_list_wrapper").hide(),e("#"+l._id).find(".e-filtericon").data("isClicked",!1),(t=e("#"+l._id+"filterDatetimepickerInputBox").data("ejDateTimePicker"))&&t.hide(),(i=e("#"+l._id+"filterDatepickerInputBox").data("ejDatePicker"))&&i.hide(),l._isExcelFilter&&(l._excelFilter.closeXFDialog(),l._mediaStatus=!1))},_getDateFormat:function(e){return new RegExp("\\{0(:([^\\}]+))?\\}","gm").exec(e)[2]},_enableDisableDEL:function(e){var t=this.model,i=e.field,l=t.columns.indexOf(e);return t.isFromGantt?!("taskId"==i||"serialNumber"==i||"taskName"==i||"startDate"==i||"endDate"==i||"duration"==i&&!t.endDateMapping||l==t.treeColumnIndex):l!=t.treeColumnIndex},_enableDisableInsertLabel:function(){var e;return!(!this.model.isFromGantt&&this._frozenColumnsLength>0)||(e=this._getFrozenColumnWidth(),!((e+=250)>this._gridWidth))},insertColumnChooser:function(i,l){var n,o=this,r=o.model;0===e("#"+o._id+"_dialogColumnAdd").length&&(n=t.buildTag("div.e-dialog e-dialog-content e-widget-content","",{display:"none"},{id:o._id+"_dialogColumnAdd"}),o.element.append(n),o._on(e("#"+o._id+"_dialogColumnAdd"),"click keypress","#ColumnAddDialog_"+o._id+"_Ok ,#ColumnAddDialog_"+o._id+"_Cancel",o._buttonClick)),o.renderColumnAddDialog(),o._targetColumnIndex=r.columns.indexOf(i),o._insertPosition=l},renameColumn:function(e,t){var i=this,l=i.model,n=l.columns,o={requestType:"renameColumn"};o.columnObject=n[e],o.previousName=n[e].headerText,o.currentName=t,i._trigger("actionComplete",o)||(n[e].headerText=t,i._refreshFrozenColumns()),i._updateWrapRowHeights(),(l.allowTextWrap||"wrap"==l.headerTextOverflow)&&i._updateGridContentHeight()},_renderColumnRenameDialog:function(i){var l,n=this,o=n._columnMenuTexts,r=t.buildTag("div.e-treegridrenamedialog","",{},{"data-unselectable":"on"}),a=e("#"+n._id).width(),d=e("#"+n._id).height(),s=t.buildTag("form","",{height:"100%",width:"100%","font-size":"14px"},{id:n._id+"ColumnRenameForm",onsubmit:"return false"}),c=t.buildTag("span.e-buttons","<input class='e-treegrid-rename-dialog-btn-ok' type='button' id="+n._id+"RenameDialogOK value="+n._okButtonText+" /> <input class='e-treegrid-rename-dialog-btn-cancel' type='button' id="+n._id+"RenameDialogCancel value='"+n._cancelButtonText+"' />"),u=t.buildTag("div","",{},{class:"e-treegrid-rename-dialog-btn"}),g=t.buildTag("table","",{outline:"none",width:"100%","margin-top":"0px"},{"data-unselectable":"on"}),m=t.buildTag("tr"),p=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"});p.append("<label style='font-weight:normal;'>"+n._columnDialogTitle.renameColumn+"</label>"),m.append(p),g.append(m);var h=t.buildTag("tr"),_=t.buildTag("td.e-editValue"),f=t.buildTag("input.e-field e-ejinputtext","",{},{value:i.headerText,id:n._id+"RenameHeaderText",name:i.field,"data-dialog":"RenameHeaderText"});f.css({margin:"0px",padding:"1px 4px 1px 0px"}),_.html(f),h.append(_),g.append(h),s.append(g),r.append(s),n._columnRenameDialog=t.buildTag("div","","",{title:o.renameColumn,id:n._id+"ColumnRenameDialog"}),u.append(c),n._columnRenameDialog.append(r).append(u),n.element.append(n._columnRenameDialog),c.find("input").ejButton({cssClass:n.model.cssClass,showRoundedCorner:!0,size:"normal",click:e.proxy(n._triggerRenameColumn,n)}),e(window).width()<=n._responsiveMinWidth&&n.model.isResponsive&&!n.model.isFromGantt?n.model.isResponsive&&(l=n.getOffsetRect(e("#"+n._id)[0]),e("#"+n._id+"ColumnRenameDialog").removeClass("e-treegridadaptivedialog"),n._columnRenameDialog.ejDialog({width:a+"px",height:d+"px",position:{X:l.left+"px",Y:l.top+"px"},minHeight:"50px",minWidth:"50px",showOnInit:!1,allowDraggable:!1,enableResize:!1,enableModal:!1,isResponsive:!1,cssClass:this.model.cssClass}),e("#"+n._id+"ColumnRenameDialog_wrapper").removeClass("e-shadow").addClass("e-treegrid-dialog"),e("#"+n._id+"ColumnRenameDialog").removeClass("e-shadow")):(n._columnRenameDialog.ejDialog({width:"auto",height:"auto",minHeight:0,minWidth:240,showOnInit:!1,enableResize:!1,allowDraggable:!0,enableModal:!0,isResponsive:!0,cssClass:this.model.cssClass}),e("#"+n._id+"ColumnRenameDialog_wrapper").addClass("e-treegrid-dialog")),f.focus().select()},_triggerRenameColumn:function(e){var l,n=this;e!==i&&e.model.text==n._okButtonText&&(l=n._columnRenameDialog.find("#"+n._id+"RenameHeaderText").val(),n.renameColumn(n._targetColumnIndex,l),this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&(t.isNullOrUndefined(n.model.editSettings.dialogEditorTemplateID)||""==n.model.editSettings.dialogEditorTemplateID)?n._treeGridAddEditDialog():this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&!t.isNullOrUndefined(n.model.editSettings.dialogEditorTemplateID)&&""!=n.model.editSettings.dialogEditorTemplateID&&n._treeGridAddEditDialogTemplate()),n._columnRenameDialog.ejDialog("close")},renderColumnAddDialog:function(){var t,i,l,n,o,r=this,a=r.model.columnDialogFields,d={},s=r.getOffsetRect(e("#"+r._id)[0]);if(d.requestType="openColumnAddDialog",a.length)for(d.data={},t=0;t<a.length;t++)i=a[t],d.data[i]="";else d.data={field:"",headerText:"",editType:""};r._trigger("actionBegin",d)||(d.requestType="columnAdd",l=document.createElement("div"),e(l).addClass("e-addedColumn"),l.innerHTML=e.render[r._id+"_ColumnAddTemplate"](d.data),e("#"+r._id+"_dialogColumnAdd").html(e(l)),(n={}).cssClass=this.model.cssClass,n.enableResize=!1,n.width="auto",n.height="auto",n.contentSelector="#"+r._id,n.rtl=r.model.rtl,n.allowKeyboardNavigation=!1,o=r._columnDialogTitle.insertColumn,n.title=o,(e(window).width()>r._responsiveMinWidth||!r.model.isResponsive||r.model.isFromGantt)&&(n.enableModal=!0,n.allowDraggable=!0,n.isResponsive=!0,e("#"+r._id+"_dialogColumnAdd").ejDialog(n),e("#"+r._id+"_dialogColumnAdd").addClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").addClass("e-treegridadaptivedialog e-treegrid-dialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").addClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd").ejDialog("open"),e("#"+r._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css("width","438px")),e(window).width()<=r._responsiveMinWidth&&r.model.isResponsive&&!r.model.isFromGantt&&(n.isResponsive=!1,n.enableResize=!1,n.enableModal=!1,n.allowDraggable=!1,n.width=e("#"+r._id).width()+"px",n.height=e("#"+r._id).height()+"px",n.minHeight="150px",n.minWidth="150px",e("#"+r._id+"_dialogColumnAdd").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd").find(".e-dropdowntreegrid").css({width:e("#"+r._id).width()-80+"px",height:"150px"}),e("#"+r._id+"_dialogColumnAdd").ejDialog(n),e("#"+r._id+"_dialogColumnAdd").ejDialog("open"),e("#"+r._id+"_dialogColumnAdd_wrapper").removeClass("e-treegridadaptivedialog").addClass("e-treegrid-dialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").removeClass("e-treegridadaptivedialog"),e("#"+r._id+"_dialogColumnAdd_wrapper").css({left:s.left+"px",top:s.top+"px"}),e("#"+r._id+"_dialogColumnAdd_wrapper").removeClass("e-shadow"),e("#"+r._id+"_dialogColumnAdd").removeClass("e-shadow"),e("#"+r._id+"_dialogColumnAdd_wrapper").find("div.e-dialog-scroller").css({height:e("#"+r._id).height()-50+"px"})),r._clearColumnMenu(),r._refreshColumnAddForm(),e("#"+r._id+"_dialogColumnAdd").ejDialog("refresh"))},setAddColumnFields:function(){var t,i,l=this,n=l.model;if(n.columnDialogFields.length){for(l._addColumnFields=n.columnDialogFields,t=["field","headerText","editType"],i=0;i<t.length;i++)if(-1==e.inArray(t[i],l._addColumnFields))switch(t[i]){case"field":l._addColumnFields.splice(0,0,t[i]);break;case"headerText":l._addColumnFields.splice(1,0,t[i]);break;case"editType":l._addColumnFields.splice(2,0,t[i])}for(n.isFromGantt?(n.allowSorting||-1==l._addColumnFields.indexOf("allowSorting")||l._addColumnFields.splice(l._addColumnFields.indexOf("allowSorting"),1),"row"==n.selectionSettings.selectionMode&&-1!=l._addColumnFields.indexOf("allowCellSelection")&&l._addColumnFields.splice(l._addColumnFields.indexOf("allowCellSelection"),1)):(n.allowSorting||-1==l._addColumnFields.indexOf("allowSorting")||l._addColumnFields.splice(l._addColumnFields.indexOf("allowSorting"),1),n.allowFiltering||-1==l._addColumnFields.indexOf("allowFiltering")||l._addColumnFields.splice(l._addColumnFields.indexOf("allowFiltering"),1),"row"==n.selectionSettings.selectionMode&&-1!=l._addColumnFields.indexOf("allowCellSelection")&&l._addColumnFields.splice(l._addColumnFields.indexOf("allowCellSelection"),1)),-1!=l._addColumnFields.indexOf("displayAsCheckbox")&&l._addColumnFields.push(l._addColumnFields.splice(l._addColumnFields.indexOf("displayAsCheckbox"),1)[0]),l._addColumnFieldsTxt=[],i=0;i<l._addColumnFields.length;i++)switch(l._addColumnFields[i]){case"field":l._addColumnFieldsTxt.push(l._columnDialogTexts.field);break;case"headerText":l._addColumnFieldsTxt.push(l._columnDialogTexts.headerText);break;case"editType":l._addColumnFieldsTxt.push(l._columnDialogTexts.editType);break;case"filterEditType":l._addColumnFieldsTxt.push(l._columnDialogTexts.filterEditType);break;case"allowFiltering":l._addColumnFieldsTxt.push(l._columnDialogTexts.allowFiltering);break;case"allowFilteringBlankContent":l._addColumnFieldsTxt.push(l._columnDialogTexts.allowFilteringBlankContent);break;case"allowSorting":l._addColumnFieldsTxt.push(l._columnDialogTexts.allowSorting);break;case"visible":l._addColumnFieldsTxt.push(l._columnDialogTexts.visible);break;case"width":l._addColumnFieldsTxt.push(l._columnDialogTexts.width);break;case"textAlign":l._addColumnFieldsTxt.push(l._columnDialogTexts.textAlign);break;case"headerTextAlign":l._addColumnFieldsTxt.push(l._columnDialogTexts.headerTextAlign);break;case"isFrozen":l._addColumnFieldsTxt.push(l._columnDialogTexts.isFrozen);break;case"allowFreezing":l._addColumnFieldsTxt.push(l._columnDialogTexts.allowFreezing);break;case"allowCellSelection":l._addColumnFieldsTxt.push(l._columnDialogTexts.allowCellSelection);break;case"showInColumnChooser":l._addColumnFieldsTxt.push(l._columnDialogTexts.showInColumnChooser);break;case"clipMode":l._addColumnFieldsTxt.push(l._columnDialogTexts.clipMode);break;case"tooltip":l._addColumnFieldsTxt.push(l._columnDialogTexts.tooltip);break;case"headerTooltip":l._addColumnFieldsTxt.push(l._columnDialogTexts.headerTooltip);break;case"displayAsCheckbox":l._addColumnFieldsTxt.push(l._columnDialogTexts.displayAsCheckbox);break;case"priority":l._addColumnFieldsTxt.push(l._columnDialogTexts.priority)}}else l._addColumnFields=["field","headerText","editType"],l._addColumnFieldsTxt=[l._columnDialogTexts.field,l._columnDialogTexts.headerText,l._columnDialogTexts.editType]},setColumnCelEditType:function(e){var i,l=this;l.model.columns;return"field"==e||"filterEditType"==e||"editType"==e||"textAlign"==e||"headerTextAlign"==e||"clipMode"==e?i=t.buildTag("input.e-field e-dropdownlist","",{},{value:"{{:#data['"+e+"']}}",id:l._id+e+"ColumnAdd",name:e,"data-dialog":"ColumnAdd"}):"headerText"==e||"tooltip"==e||"headerTooltip"==e?(i=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:#data['"+e+"']}}",id:l._id+e+"ColumnAdd",name:e,"data-dialog":"ColumnAdd"})).css({margin:"0px",padding:"1px 4px 1px 0px"}):"allowFiltering"==e||"allowSorting"==e||"isFrozen"==e||"allowFreezing"==e?i=' <input type ="checkbox" id="'+l._id+e+'ColumnAdd" data-dialog ="ColumnAdd" name="'+e+'" data-edittype="booleanedit">':"allowFilteringBlankContent"==e||"visible"==e?i=' <input type ="checkbox" id="'+l._id+e+'ColumnAdd" data-dialog = "ColumnAdd" checked = "checked" name="'+e+'" data-edittype="booleanedit">':"allowCellSelection"==e?i=' <input type ="checkbox" id="'+l._id+e+'ColumnAdd" data-dialog = "ColumnAdd" checked = "checked" name="'+e+'" data-edittype="booleanedit">':"showInColumnChooser"==e||"displayAsCheckbox"==e?i=' <input type ="checkbox" id="'+l._id+e+'ColumnAdd" data-dialog = "ColumnAdd" checked = "checked" name="'+e+'" data-edittype="booleanedit">':("width"==e||"priority"==e)&&((i=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:#data['"+e+"']}}",id:l._id+e+"ColumnAdd",name:e,"data-dialog":"ColumnAdd"})).attr("data-edittype","numericedit"),i.css({margin:"0px",padding:"1px 4px 1px 0px"})),i},columnAddDialogTemplate:function(){var i,l,n,o,r,a,d,s=this,c=s.model;if(0!=c.columns.length){s.setAddColumnFields();var u,g,m,p,h,_,f=t.buildTag("div","",{},{"data-unselectable":"on"}),w=t.buildTag("form","",{height:"100%",width:"100%","font-size":"14px"},{id:s._id+"ColumnAddForm"}),C=t.buildTag("table","",{width:"100%","margin-top":"0px"},{"data-unselectable":"on"}),x=t.buildTag("tr","",{width:"100%"});for(l=0;l<s._addColumnFields.length;l++)x.children("td").length<2?(u=t.buildTag("td.e-add-property-container","",{},{"data-unselectable":"on"}),g=t.buildTag("table","",{width:"100%",outline:"none","margin-top":"0px"},{"data-unselectable":"on"}),m=t.buildTag("tr"),(p=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"})).append("<label style='font-weight:normal;'>"+s._addColumnFieldsTxt[l]+"</label>"),m.append(p),g.append(m),h=t.buildTag("tr"),_=t.buildTag("td.e-editValue"),i=s.setColumnCelEditType(s._addColumnFields[l]),_.html(i),h.append(_),g.append(h),"displayAsCheckbox"==s._addColumnFields[l]&&g.addClass("e-display-checkbox-conatiner").css("display","none"),u.append(g),x.append(u)):(C.append(x),x=t.buildTag("tr"),l--);C.append(x),n=t.buildTag("tr"),c.showColumnChooser&&(u=t.buildTag("td.e-add-property-container","",{},{colspan:2,"data-unselectable":"on"}),g=t.buildTag("table#"+s._id+"dropdownDataTable","",{width:"100%",outline:"none"},{"data-unselectable":"on"}),o=t.buildTag("tr"),(r=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"})).append("<label for='dropdownData' style='font-weight:normal;'>"+s._columnDialogTexts.columnsDropdownData+"</label>"),o.append(r),g.append(o),m=t.buildTag("tr"),(p=t.buildTag("td.e-editLabel","",{outline:"none"},{"data-unselectable":"on"})).append("<span class='e-addpre e-icon e-enable e-add-dialog' style='cursor:pointer; width: auto;'>"+s._columnDialogTexts.addData+"</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class='e-deletepre e-icon e-disable e-add-dialog' style='cursor:pointer; width: auto;'>&nbsp;&nbsp;"+s._columnDialogTexts.deleteData+"</span>"),m.append(p),g.append(m),h=t.buildTag("tr"),_=t.buildTag("td.e-editValue"),e("#"+s._id).width()<=s._responsiveMinWidth?(a=e("#"+s._id).width()-80+"px",r=t.buildTag("div.e-dropdowntreegrid","",{width:a,overflow:"hidden"})):r=t.buildTag("div.e-dropdowntreegrid","",{width:"438px",overflow:"hidden"}),d=t.buildTag("div#treegrid"+s._id+"dropdownData","",{width:"100%",height:"150px"},{}),r.append(d),_.append(r),h.append(_),g.append(h),u.append(g),n.append(u),C.append(n)),w.append(C),f=s.renderColumnAddDialogButton(w,f),e.templates(s._id+"_ColumnAddTemplate",f.html())}},renderColumnAddDialogButton:function(e,i){var l,n="ColumnAddDialog_",o=this,r=o.model,a=t.buildTag("div.e-add-dialog-btn-ok","",{},{}),d=t.buildTag("div","",{},{}),s=t.buildTag("input","",{"border-radius":"3px"},{type:"button",id:n+o._id+"_Ok"}),c=o._okButtonText;s.ejButton({cssClass:r.cssClass,text:c,width:"100%"});var u=t.buildTag("div.e-add-dialog-btn-cancel","",{},{}),g=t.buildTag("div","",{},{}),m=o._cancelButtonText,p=t.buildTag("input","",{"border-radius":"3px"},{type:"button",id:n+o._id+"_Cancel"});return p.ejButton({cssClass:r.cssClass,text:m,width:"100%"}),l=t.buildTag("div","",{},{class:"e-treegrid-add-btn"}),d.append(s),a.append(d),l.append(a),g.append(p),u.append(g),l.append(u),e.appendTo(i),l.appendTo(i),i},_buttonClick:function(l){var n,o,r,a,d,s;if(0!=l.keyCode&&l.keyCode!==i&&13!=l.keyCode)return!0;var c,u,g,m=this,p=m.model,h=p.treeColumnIndex,_=!1,f={},w=m._addColumnFields,C=p.columns,x={};if(l.target.id=="ColumnAddDialog_"+m._id+"_Ok"){for(n=document.getElementById(m._id+"ColumnAddForm"),r=0;r<w.length;r++)if(a=w[r],c=e(n).find("#"+m._id+a+"ColumnAdd"),"editType"==a||"filterEditType"==a||"textAlign"==a||"headerTextAlign"==a||"clipMode"==a){if(o=c.data("ejDropDownList"),f[a]=o._selectedValue,"editType"==a&&"dropdownedit"==f[a]){var v=e(n).find("#treegrid"+m._id+"dropdownData").data("ejTreeGrid").model.dataSource;v.length>0&&(f.dropdownData=v)}}else"showInColumnChooser"==a||"allowCellSelection"==a||"allowSorting"==a||"allowFiltering"==a||"allowFilteringBlankContent"==a||"visible"==a||"isFrozen"==a||"allowFreezing"==a||"displayAsCheckbox"==a?(d=c.data("ejCheckBox"),f[a]=d._isChecked):""!=c.val()||"headerText"!=a&&"field"!=a?f[a]="priority"==a?c.ejNumericTextbox("getValue"):c.val():"field"==a?f[a]="Column"+(p.columns.length+1):"headerText"==a&&(f[a]="Column "+(p.columns.length+1));"left"==m._insertPosition?u=m._targetColumnIndex:"right"==m._insertPosition&&(u=m._targetColumnIndex+1),u<=h&&(p.treeColumnIndex=h+1),p.isFromGantt||u<=m._frozenColumnsLength-1&&(_=!0),s={},s=p.isFromGantt?{field:f.field,headerText:f.headerText,editType:f.editType,allowSorting:t.isNullOrUndefined(f.allowSorting)?null:f.allowSorting,visible:0!=f.visible,width:f.width?f.width:150,textAlign:f.textAlign?f.textAlign:"left",headerTextAlign:f.headerTextAlign?f.headerTextAlign:"left",dropdownData:f.dropdownData?f.dropdownData:null,allowCellSelection:t.isNullOrUndefined(f.allowCellSelection)?null:f.allowCellSelection,mappingName:f.field,displayAsCheckbox:0!=f.displayAsCheckbox,clipMode:f.clipMode?f.clipMode:"clip",tooltip:f.tooltip,headerTooltip:f.headerTooltip}:{field:f.field,headerText:f.headerText,editType:f.editType,filterEditType:f.filterEditType?f.filterEditType:"stringedit",allowFiltering:t.isNullOrUndefined(f.allowFiltering)?null:f.allowFiltering,allowFilteringBlankContent:t.isNullOrUndefined(f.allowFilteringBlankContent)?null:f.allowFilteringBlankContent,allowSorting:t.isNullOrUndefined(f.allowSorting)?null:f.allowSorting,visible:0!=f.visible,width:f.width?f.width:150,textAlign:f.textAlign?f.textAlign:"left",headerTextAlign:f.headerTextAlign?f.headerTextAlign:"left",clipMode:f.clipMode?f.clipMode:"clip",tooltip:f.tooltip,headerTooltip:f.headerTooltip,isFrozen:1==f.isFrozen||1==_,allowFreezing:t.isNullOrUndefined(f.allowFreezing)?null:f.allowFreezing,dropdownData:f.dropdownData?f.dropdownData:null,allowCellSelection:t.isNullOrUndefined(f.allowCellSelection)?null:f.allowCellSelection,showInColumnChooser:0!=f.showInColumnChooser,displayAsCheckbox:0!=f.displayAsCheckbox,priority:f.priority?f.priority:""},x.requestType="insertColumn",x.columnObject=s,x.insertIndex=u,m._trigger("actionComplete",x)||(C.splice(x.insertIndex,0,x.columnObject),m._refreshFrozenColumns(),m._updateWrapRowHeights(null,"virtualRefresh"),p.isFromGantt&&m._updateAddEditDialogTemplate()),e("#"+m._id+"_dialogColumnAdd").ejDialog("close"),p.allowFiltering&&"menu"==p.filterSettings.filterType&&(g=x.columnObject.filterEditType?x.columnObject.filterEditType:x.columnObject.editType,-1==m._renderedFilterMenuDialog.indexOf(g)&&m._renderFilterMenu(g)),this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&(t.isNullOrUndefined(p.editSettings.dialogEditorTemplateID)||""==p.editSettings.dialogEditorTemplateID)?m._treeGridAddEditDialog():this.model.editSettings.allowEditing&&"dialogEditing"==this.model.editSettings.editMode&&!t.isNullOrUndefined(p.editSettings.dialogEditorTemplateID)&&""!=p.editSettings.dialogEditorTemplateID&&m._treeGridAddEditDialogTemplate()}else l.target.id=="ColumnAddDialog_"+m._id+"_Cancel"&&e("#"+m._id+"_dialogColumnAdd").ejDialog("close");if("dialogEditing"==this.model.editSettings.editMode||"batchediting"==p.editSettings.editMode.toLowerCase()&&"dialog"==p.editSettings.batchEditSettings.editMode)if(l.target.id=="EditFormDialog_"+this._id+"_Save"){if(!m.editFormValidate())return!0;this.element.find(".e-dialogaddrow .e-treegridform").length>0?(m.model.allowSelection&&"multiple"==m.model.selectionSettings.selectionType&&this._multiSelectPopup&&this._multiSelectPopup.is(":visible")&&m._clearMultiSelectPopup(),m._treegridDialogAddRow()&&(m._isTreeAddEditDialogSave=!0,e("#"+this._id+"_dialogEdit").ejDialog("close"))):this.element.find(".e-dialogeditedrow .e-treegridform").length>0&&(m.endEdit()||(m._isTreeAddEditDialogSave=!0,e("#"+this._id+"_dialogEdit").ejDialog("close")))}else l.target.id=="EditFormDialog_"+this._id+"_Cancel"&&e("#"+this._id+"_dialogEdit").ejDialog("close");return!1},_treegridDialogAddRow:function(){for(var e,i,l,n=this,o=n.model.columns,r={},a=0;a<o.length;a++)if(i=(e=o[a]).field,!t.isNullOrUndefined(e)&&""!=i&&!n._isCommandColumn(e)){if(n._checkboxSelection&&e.nonColumn)continue;l=n.getCurrentEditCellDataForRowEdit(i,e.editType,a),l=t.isNullOrUndefined(l)||e.editType==t.TreeGrid.EditingType.Numeric&&isNaN(l)?null:l,-1!=i.indexOf(".")?t.createObject(i,l,r):r[i]=l}return!!n._addRecord(r,n.model.editSettings.rowPosition,null,"dialog")},_refreshColumnAddForm:function(){for(var i,l,n,o,r,a,d,s,c,u,g,m,p,h,_=this,f=e("#"+_._id+"ColumnAddForm"),w=f.find("input,select"),C=0,x=!1,v=w.length,S=_.model,R={},T=[],b=(_.model.rowHeight,_._editTypeText),y=_._textAlignTypeText,I=_._clipModeText;C<v;C++){if(l="100%",o=(i=w.eq(C)).prop("name"),i.hasClass("e-dropdownlist"))if("field"==o){for(u=[],d=[],S.columns.length&&(T=e.map(S.columns,function(e){return S.isFromGantt&&e.mappingName?e.mappingName:e.field})),_._dataSourcefields.length||(_._dataSourcefields=e.extend(!0,[],T),_.getAllDataSourceFields()),s=0;s<_._dataSourcefields.length;s++)-1==e.inArray(_._dataSourcefields[s],T)&&_._dataSourcefields[s]!=S.notesMapping&&(S.isFromGantt&&"serialNumber"!=_._dataSourcefields[s]||!S.isFromGantt)&&d.push(_._dataSourcefields[s]);for(c=0;c<d.length;c++)u.push({text:d[c]});i.ejDropDownList({width:l,cssClass:S.cssClass,dataSource:u,fields:{text:"text",value:"text"}})}else"editType"==o||"filterEditType"==o?(u=[{text:b.string,value:"stringedit"},{text:b.numeric,value:"numericedit"},{text:b.datePicker,value:"datepicker"},{text:b.dateTimePicker,value:"datetimepicker"},{text:b.dropdown,value:"dropdownedit"},{text:b.boolean,value:"booleanedit"}],i.ejDropDownList({width:l,dataSource:u,cssClass:S.cssClass,fields:{text:"text",value:"value"},selectedIndex:0,change:function(t){var i,l=!1;1==e(a).is(":hidden")&&"dropdownedit"==t.value?(e(a).attr("hidden",!1),l=!0):0==e(a).is(":hidden")&&"dropdownedit"!=t.value&&(e(a).attr("hidden",!0),l=!0),i=e("#"+_._id+"_dialogColumnAdd").find(".e-display-checkbox-conatiner"),"booleanedit"==t.value&&i.length>0&&"none"==i.css("display")?(i.css("display","block"),l=!0):"booleanedit"!=t.value&&i.length>0&&"block"==i.css("display")&&(i.css("display","none"),l=!0),l&&e("#"+_._id+"_dialogColumnAdd").ejDialog("refresh")}})):"textAlign"==o||"headerTextAlign"==o?(g=[{text:y.left,value:"left"},{text:y.right,value:"right"},{text:y.center,value:"center"}],i.ejDropDownList({width:l,dataSource:g,cssClass:S.cssClass,fields:{text:"text",value:"value"},selectedIndex:0})):"clipMode"==o&&(m=[{text:I.clip,value:"clip"},{text:I.ellipsis,value:"ellipsis"}],i.ejDropDownList({width:l,dataSource:m,cssClass:S.cssClass,fields:{text:"text",value:"value"},selectedIndex:0}));else i.hasClass("e-numerictextbox")?(n=i.val(),R.width=l,R.showSpinButton=!0,R.cssClass=S.cssClass,"width"==o?(R.maxValue=250,R.minValue=30,R.value=n.length?parseFloat(n):150):"priority"==o&&(R.maxValue=6,R.minValue=1,R.value=n.length?parseFloat(n):null),i.ejNumericTextbox(R)):("showInColumnChooser"==o||"allowCellSelection"==o||"allowFiltering"==o||"allowFilteringBlankContent"==o||"allowSorting"==o||"visible"==o||"isFrozen"==o||"allowFreezing"==o||"displayAsCheckbox"==o)&&((p={}).cssClass=S.cssClass,p.size="small",i.ejCheckBox(p));i.is(":disabled")||x||i.is(":hidden")&&"object"!=typeof i.data("ejDropDownList")||_._isEnterKeyPressed||(_._focusElements(i.closest("td")),x=!0)}r="#treegrid"+_._id+"dropdownData",e(r).length&&(h=[],e(r).ejTreeGrid({dataSource:h,allowSorting:!1,allowAdding:!0,columns:[{headerText:_._columnDialogTexts.dropdownTableText,field:"text",editType:t.TreeGrid.EditingType.String,width:"150px"},{headerText:_._columnDialogTexts.dropdownTableValue,field:"value",editType:t.TreeGrid.EditingType.String,width:"150px"}],enableAltRow:!0,allowColumnResize:!0,cssClass:S.cssClass,enableResize:!0,editSettings:{allowAdding:!0,allowDeleting:!0,allowEditing:!0,editMode:"cellEditing"},locale:S.locale,treeColumnIndex:5,emptyRecordText:"Add values for dropdown",rowSelected:function(t){t.data&&(e(".e-deletepre").addClass("e-enable").removeClass("e-disable"),e(".e-deletepre").bind("click",e.proxy(_._deleteDropDownRow,_,e(r))))}}),a=f.find("#"+_._id+"dropdownDataTable").parent()[0],e(a).attr("hidden",!0),e(".e-addpre").bind("click",e.proxy(_._addDropDownRow,_,e(r))))},_addDropDownRow:function(e){var t=e.data("ejTreeGrid"),i=t.model.dataSource.length,l={text:"Text "+(i+1),value:"Value"+(i+1)};t.addRow(l,"bottom")},_deleteDropDownRow:function(t){var i=t.data("ejTreeGrid"),l=i.model.updatedRecords.length,n=i.model.selectedItem;0!=l&&n&&(i.deleteRow(),e(".e-deletepre").addClass("e-disable").removeClass("e-enable"),e(".e-deletepre").unbind("click",e.proxy(this._deleteDropDownRow,this,t)))},getAllDataSourceFields:function(){for(var t,i,l=this,n=l.model,o=n.dataSource,r=0;r<o.length;r++)for(i in t=o[r])i==n.childMapping?l.getChildKeys(t[i]):-1==e.inArray(i,l._dataSourcefields)&&(n.isFromGantt?"undefined"!=i&&i!=n.notesMapping&&l._dataSourcefields.push(i):"object"!=typeof t[i]&&"ejvalue"!=i&&l._dataSourcefields.push(i))},getChildKeys:function(t){var i,l,n,o=this,r=o.model;if(t)for(i=0;i<t.length;i++)for(n in l=t[i])n==r.childMapping?o.getChildKeys(l[n]):-1==e.inArray(n,o._dataSourcefields)&&"object"!=typeof l[n]&&"ejvalue"!=n&&o._dataSourcefields.push(n)},_renderUpdateConfirmDialog:function(){var i=this,l=i._confirmDeleteText,n=t.buildTag("div.e-content",i._deleteColumnText),o=t.buildTag("span.e-buttons","<input class='e-confirm-dialog-btn-ok' type='button' id="+i._id+"ConfirmDialogOK value="+i._okButtonText+" /> <input class='e-confirm-dialog-btn-cancel' type='button' id="+i._id+"ConfirmDialogCancel value='"+i._cancelButtonText+"' />"),r=t.buildTag("div","",{},{class:"e-confirm-dialog-btn"});r.append(o),i._updateConfirmDialog=t.buildTag("div","","",{title:l,id:i._id+"ConfirmDialog"}),i._updateConfirmDialog.append(n).append(r),i.element.append(i._updateConfirmDialog),o.find("input").ejButton({cssClass:i.model.cssClass,showRoundedCorner:!0,size:"normal",click:e.proxy(i._triggerUpdateConfirm,i)}),i._updateConfirmDialog.ejDialog({width:"auto",minHeight:0,minWidth:0,showOnInit:!1,isResponsive:!0,enableResize:!1,enableModal:!0,cssClass:i.model.cssClass}),e("#"+i._id+"ConfirmDialog_wrapper").addClass("e-treegrid-dialog")},_triggerUpdateConfirm:function(e){var t=this;e!==i&&e.model.text==t._okButtonText&&t._updateConfirmDialog.find(".e-content").text()==t._deleteColumnText&&t.deleteColumn(t._targetColumnIndex),t._updateConfirmDialog.ejDialog("close")},deleteColumn:function(t){var i,l,n=this,o=n.model,r=o.columns,a=o.sortSettings&&o.sortSettings.sortedColumns.length?o.sortSettings.sortedColumns:null,d=r[t],s={};t==o.treeColumnIndex||r[t].nonColumn||(s.requestType="deleteColumn",s.columnObject=d,s.deleteIndex=t,n._trigger("actionComplete",s)||(!o.isFromGantt&&o.allowSorting&&o.filterSettings.filteredColumns.length>0&&n.clearFilter(d.field),i=r.splice(t,1),a&&((l=e.grep(a,function(e){return o.isFromGantt?e.field==i[0].mappingName:e.field==i[0].field})).length&&(a.splice(a.indexOf(l[0]),1),n.processBindings(),o.isFromGantt&&(s.requestType="sorting",n._trigger("actionComplete",s)))),t<=o.treeColumnIndex&&(o.treeColumnIndex=o.treeColumnIndex-1),o.showTotalSummary&&o.collapsibleTotalSummary&&t==n._summaryColumnIndex&&(n._summaryColumnIndex=0),n._refreshFrozenColumns(),n._updateWrapRowHeights(null,"virtualRefresh"),o.isFromGantt&&n._updateAddEditDialogTemplate()))},getOffsetRect:function(e){var t=e.getBoundingClientRect(),i=document.body,l=document.documentElement,n=window.pageYOffset||l.scrollTop||i.scrollTop,o=window.pageXOffset||l.scrollLeft||i.scrollLeft,r=l.clientTop||i.clientTop||0,a=l.clientLeft||i.clientLeft||0,d=t.top+n-r,s=t.left+o-a;return{top:Math.round(d),left:Math.round(s)}},_moveToNextMenuItem:function(t){var i,l,n,o,r,a,d,s=this.model,c={};switch(this._isContextMenuItems||s.isFromGantt?(s.isFromGantt?(i=e("#"+this._id.replace("ejTreeGrid","")).data("ejGantt"),n=e("#"+this._id.replace("ejTreeGrid","")+"_ContextMenu")):(i=this,n=e("#"+this._id+"_ContextMenu")),o=i._contextMenuItems):(i=this,n=e("#"+this._id+"_headerContextMenu"),o=i._headerContextMenuItems),l=e("#"+i._activeMenuItemId),t){case"next":0==l.length?c=n.find("div.e-menuitem:not(.e-disable)").first():(c=l.closest("li").next("li").find("div.e-menuitem")).length>0&&c.hasClass("e-disable")&&(c=this._findContextMenuItem(c,"next")),e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId).remove();break;case"prev":c=this._findContextMenuItem(l,"prev"),e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId).remove();break;case"expand":l.length>0&&(i._showSubContextMenu(l[0],o),(a=e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId)).length>0&&(c=a.find("div.e-menuitem:not(.e-disable)").first()));break;case"collapse":(a=e(l).closest(".e-tginnerContextmenu")).length>0&&(r=a.attr("id").replace(i._id+"_SubContextMenu",""),c=e("#"+r),e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId).remove(),a.remove());break;case"save":l.length>0&&(0==e("#"+i._activeMenuItemId).find(".e-expander").length?(s.isFromGantt?i._contextMenuClickHandler(e("#"+i._activeMenuItemId)):i.contextMenuOperations(i._activeMenuItemId),i._clearContextMenu()):(i._showSubContextMenu(l[0],o),(a=e("#"+i._id+"_SubContextMenu"+i._activeMenuItemId)).length>0&&(c=a.find("div.e-menuitem:not(.e-disable)").first())))}c.length>0&&(d=this._isContextMenuItems||s.isFromGantt?"e-tgcontextmenu-mouseover":"e-columnmenuselection",("next"==t||"prev"==t)&&l.removeClass(d),c.addClass(d),i._activeMenuItemId=e(c).attr("id"))},_findNextColumnMenuItem:function(e,t,i){var l,n,o=this;return l=i?e.closest("li").next("li").find("div.e-columnmenuitem"):e.closest("li").next("li").find("div.e-menuitem "),n=i?e.closest("li").prev("li").find("div.e-columnmenuitem"):e.closest("li").prev("li").find("div.e-menuitem"),"next"===t?l.length>0&&l.hasClass("e-disable")?i?o._findNextColumnMenuItem(l,"next",!0):o._findNextColumnMenuItem(l,"next",!1):l:n.length>0&&n.hasClass("e-disable")?i?o._findNextColumnMenuItem(n,"prev",!0):o._findNextColumnMenuItem(n,"prev",!1):n},_getFieldValue:function(e,t){return""!=e?e.split(".").join(""):"TGcolumn"+t},_findContextMenuItem:function(e,t){var i,l;return"next"===t?(i=e.closest("li").next("li").find("div.e-menuitem")).length>0&&i.hasClass("e-disable")?this._findContextMenuItem(i,"next"):i:(l=e.closest("li").prev("li").find("div.e-menuitem")).length>0&&l.hasClass("e-disable")?this._findContextMenuItem(l,"prev"):l},updateRecordByIndex:function(i,l){var n,o=this,r=o.model,a=r.updatedRecords,d={},s=i,c=s>-1&&a.length>0?a[s]:null;if(o._isRowEdit?o.cancelRowEditCell():o.model.isEdit&&o.cancelEditCell(),t.isNullOrUndefined(c)||c.isSummaryRow)return!1;var u=c.item,g=e.extend(!0,{},u),m=e.extend(!0,{},r.columns);e.each(l,function(i,l){var n,a=i,d=l;if(!t.isNullOrUndefined(a)&&(n=!1,e.each(m,function(e,t){if(t.field==a)return n=!0,delete m[parseInt(e)],!1}),n)){if("batchEditing"==r.editSettings.editMode){var s={},u=t.copyObject({},c.item);r.columns.filter(function(e){e.field==a&&(s=e)});(s.editType==t.TreeGrid.EditingType.DatePicker||s.editType==t.TreeGrid.EditingType.DateTimePicker)&&(d=t.parseDate(d,r.dateFormat,r.locale)),o._checkModfiedCellValue(t.getObject(a,u),d,s)&&(o._createBatchEditedFields(c,a,d,s),o._batchEditStarts=!0,o._updateBatchChanges(c.item))}(c=o._restoreCustomData(c,d,a)).item=o._restoreCustomData(c.item,d,a)}}),n=r.currentViewData.indexOf(c),r.enableVirtualization?n>-1&&t.TreeGrid.refreshRow(o,n):t.TreeGrid.refreshRow(o,n),r.idMapping&&r.parentIdMapping&&o._updateLastInsertedId(c[r.idMapping]),d.editType="rowedit",d.previousValue=g,d.currentValue=c.item,d.rowIndex=s,r.showSummaryRow&&o._updateSummaryRow(d),r.showTotalSummary&&o._updateTotalSummaryRow(d),"batchEditing"==r.editSettings.editMode&&o._cancelSaveTools()},_saveEditedElements:function(){var e=this;e.model.isEdit?e.saveCell():e._isRowEdit&&e.saveRow()}}),t.TreeGrid.Actions={Sorting:"sorting",BeginEdit:"beginedit",Save:"save",Add:"add",Delete:"delete",Cancel:"cancel",Refresh:"refresh",Searching:"searching",ExpandCollapse:"expandcollapse",Selection:"selection",rowHover:"rowHover",Scroll:"scroll",ContextMenuAdd:"contextMenuAdd",RefreshDataSource:"refreshDataSource",DragAndDrop:"dragAndDrop",Paging:"paging",Filter:"filtering",RowIndexUpdate:"rowIndexUpdate"},t.TreeGrid.SelectionType={Single:"single",Multiple:"multiple",Checkbox:"checkbox"},t.TreeGrid.FilterType={FilterBar:"filterbar",Menu:"menu",Excel:"excel"},t.TreeGrid.FilterHierarchyMode={Parent:"parent",Child:"child",Both:"both",None:"none"},t.TreeGrid.SearchHierarchyMode={Parent:"parent",Child:"child",Both:"both",None:"none"},t.TreeGrid.HeaderTextOverflow={None:"none",Wrap:"wrap"},t.TreeGrid.EditMode={CellEditing:"cellEditing",RowEditing:"rowEditing",DialogEditing:"dialogEditing",BatchEditing:"batchEditing"},t.TreeGrid.BatchEditMode={Cell:"cell",Row:"row",Dialog:"dialog"},t.TreeGrid.ClipMode={Clip:"clip",Ellipsis:"ellipsis"},t.TreeGrid.PageSizeMode={All:"all",Root:"root"},t.TreeGrid.PrintMode={AllPages:"allPages",CurrentPage:"currentPage"},t.TreeGrid.RowPosition={Top:"top",Bottom:"bottom",Above:"aboveSelectedRow",Below:"belowSelectedRow",Child:"child"},t.TreeGrid.BeginEditAction={DblClick:"dblClick",Click:"click"},t.TreeGrid.EditingType={String:"stringedit",Boolean:"booleanedit",Numeric:"numericedit",Dropdown:"dropdownedit",DatePicker:"datepicker",DateTimePicker:"datetimepicker",Maskedit:"maskedit"},t.TreeGrid.ContextMenuItems={Add:"add",Edit:"edit",Delete:"delete"},t.TreeGrid.ColumnResizeMode={Normal:"normal",FixedColumns:"fixedcolumns",NextColumn:"nextcolumn"},t.TreeGrid.UnboundType={Edit:"edit",Save:"save",Delete:"delete",Cancel:"cancel"},t.TreeGrid=t.TreeGrid||{},t.TreeGrid._initCellEditType=function(i,l,n,o,r,a,d){var s,c,u,g,m,p,h,_,f,w=i,C=w.model,x=a?d:C.columns,v=x[o];r=r||"",(x[o].field||"").split(".");switch(x[o].editTemplate?x[o].editType="edittemplate":t.isNullOrUndefined(x[o].editType)&&(v.editType="stringedit"),s="dialogEditing"==w.model.editSettings.editMode?x[o].field:w._getFieldValue(x[o].field,o),v.editType){case"stringedit":C.isFromGantt?(c={},"predecessor"===v.field&&(c["_"+n+"predecessorCell"]=e.proxy(w._getPredecessorsValue,w)),e.views.helpers(c),"predecessor"===v.field?u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+n+"predecessorCell(#data)}}",id:n+v.field+r,name:v.field,"data-dialog":r}):"duration"===v.field?((c={})["_"+n+"getDurationStringValue"]=e.proxy(t.Gantt._getDurationStringValue,w),e.views.helpers(c),u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+n+"getDurationStringValue(#data)}}",id:n+v.field+r,name:v.field,"data-dialog":r})):u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:n+x[o].field+r,name:x[o].field,"data-dialog":r})):u=t.buildTag("input.e-field e-ejinputtext","",{},{value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:n+w._getFieldValue(v.field,o)+r,name:v.field,autocomplete:"off","data-dialog":r}),u.attr("data-edittype",x[o].editType),l.html(u);break;case"maskedit":(u=t.buildTag("input.e-field e-maskedit","",{},{value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:n+w._getFieldValue(v.field,o)+r,name:v.field,"data-dialog":r})).attr("data-edittype",x[o].editType),l.html(u);break;case"booleanedit":l.html("{{if true===~_"+w._id+'cellValue(#data,"'+s+'")}}<input type ="checkbox" id="'+n+w._getFieldValue(x[o].field,o)+r+'" data-dialog ="'+r+'" name="'+x[o].field+'" checked="checked" data-edittype="'+x[o].editType+'"></input> {{else}}<input type ="checkbox" id="'+n+w._getFieldValue(x[o].field,o)+r+'" data-dialog ="'+r+'" name="'+x[o].field+'" data-edittype="'+x[o].editType+'">{{/if}}');break;case"numericedit":(g=t.buildTag("input.e-numerictextbox e-field","",{},{type:"text",value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:n+w._getFieldValue(x[o].field,o)+r,name:x[o].field,"data-dialog":r})).attr("data-edittype",x[o].editType),l.append(g);break;case"datepicker":(m=t.buildTag("input.e-datepicker e-field","",{},{type:"text",value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:n+w._getFieldValue(x[o].field,o)+r,name:x[o].field,"data-dialog":r})).attr("data-edittype",x[o].editType),l.append(m);break;case"datetimepicker":(m=t.buildTag("input.e-datetimepicker e-field","",{},{type:"text",value:"{{:~_"+w._id+"cellValue(#data,'"+s+"')}}",id:n+w._getFieldValue(x[o].field,o)+r,name:x[o].field,"data-dialog":r})).attr("data-edittype",x[o].editType),l.append(m);break;case"dropdownedit":(p=t.buildTag("input.e-field e-dropdownlist","",{},{type:"text",id:n+w._getFieldValue(x[o].field,o)+r,name:x[o].field,"data-dialog":r})).attr("data-edittype",x[o].editType).attr("data-cellvalue","{{:~_"+w._id+"cellValue(#data,'"+s+"')}}"),l.append(p);break;case"edittemplate":"string"==typeof(h=x[o].editTemplate.create)?(_=t.util.getObject(h,window),f=e.isFunction(_)?e(_()).attr({id:n+w._getFieldValue(v.field,o),name:v.field}):1==e(h).length&&"SCRIPT"==e(h).get(0).tagName?e(e(h).html()).attr({id:n+w._getFieldValue(v.field,o),name:v.field}):e(h).attr({id:n+w._getFieldValue(v.field,o),name:v.field})):f=e(h()).attr({id:n+w._getFieldValue(v.field,o),name:v.field}),f.attr("data-edittype",x[o].editType),l.append(f)}},t.TreeGrid.ToolbarItems={Add:"add",Edit:"edit",Delete:"delete",Update:"update",Cancel:"cancel",ExpandAll:"expandAll",CollapseAll:"collapseAll",PdfExport:"pdfExport",ExcelExport:"excelExport",Print:"print",Search:"search"},t.TreeGrid.SummaryType={Sum:"sum",Average:"average",Maximum:"maximum",Minimum:"minimum",Count:"count",MinimumDate:"minimumDate",MaximumDate:"maximumDate",TrueCount:"trueCount",FalseCount:"falseCount",Custom:"custom"},t.TreeGrid.SelectionMode={Row:"row",Cell:"cell"},t.TreeGrid.Locale=t.TreeGrid.Locale||{},t.TreeGrid.Locale.default=t.TreeGrid.Locale["en-US"]={toolboxTooltipTexts:{addTool:"Add",editTool:"Edit",updateTool:"Update",deleteTool:"Delete",cancelTool:"Cancel",expandAllTool:"Expand All",collapseAllTool:"Collapse All",pdfExportTool:"PDF Export",excelExportTool:"Excel Export",printTool:"Print",searchTool:"Search"},contextMenuTexts:{addRowText:"Add Row",editText:"Edit",deleteText:"Delete",saveText:"Save",cancelText:"Cancel",aboveText:"Above",belowText:"Below"},filterMenuTexts:{stringMenuOptions:[{text:"Starts With",value:"startswith"},{text:"Ends With",value:"endswith"},{text:"Contains",value:"contains"},{text:"Equals",value:"equal"},{text:"Does Not Equal",value:"notequal"}],numberMenuOptions:[{text:"Less Than",value:"lessthan"},{text:"Greater Than",value:"greaterthan"},{text:"Less Than Or Equal To",value:"lessthanorequal"},{text:"Greater Than Or Equal To",value:"greaterthanorequal"},{text:"Equals",value:"equal"},{text:"Does Not Equal",value:"notequal"}],filterValue:"Filter Value",filterButton:"Filter",clearButton:"Clear",enterValueText:"enter value"},columnMenuTexts:{sortAscendingText:"Sort Ascending",sortDescendingText:"Sort Descending",columnsText:"Columns",freezeText:"Freeze",unfreezeText:"Unfreeze",freezePrecedingColumnsText:"Freeze Preceding Columns",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",renameColumn:"Rename Column",menuFilter:"Filter"},columnDialogTexts:{field:"Field",headerText:"Header Text",editType:"Edit Type",filterEditType:"Filter Edit Type",allowFiltering:"Allow Filtering",allowFilteringBlankContent:"Allow Filtering Blank Content",allowSorting:"Allow Sorting",visible:"Visible",width:"Width",textAlign:"Text Alignment",headerTextAlign:"Header Text Alignment",isFrozen:"Is Frozen",allowFreezing:"Allow Freezing",columnsDropdownData:"Column Dropdown Data",dropdownTableText:"Text",dropdownTableValue:"Value",addData:"Add",deleteData:"Remove",allowCellSelection:"Allow Cell Selection",showInColumnChooser:"Show In Column Chooser",clipMode:"Clip Mode",tooltip:"Tooltip",headerTooltip:"Header Tooltip",displayAsCheckbox:"Display As Checkbox",priority:"Priority"},columnDialogTitle:{insertColumn:"Insert Column",deleteColumn:"Delete Column",renameColumn:"Rename Column"},editTypeTexts:{string:"String",numeric:"Numeric",datePicker:"Date Picker",dateTimePicker:"Date Time Picker",dropdown:"Dropdown",boolean:"Boolean"},textAlignTypes:{right:"Right",left:"Left",center:"Center"},clipModeTexts:{clip:"Clip",ellipsis:"Ellipsis"},deleteColumnText:"Are you sure you want to delete this column?",deleteRecordText:"Are you sure you want to delete record?",okButtonText:"OK",cancelButtonText:"Cancel",confirmDeleteText:"Confirm Delete",batchSaveConfirmText:"Are you sure you want to save changes?",batchSaveLostChangesText:"Unsaved changes will be lost. Are you sure you want to continue?",cancelEditText:"Are you sure you want to cancel the changes?",dropDownListBlanksText:"(Blanks)",dropDownListClearText:"(Clear Filter)",trueText:"True",falseText:"False",emptyRecord:"No records to display"},t.TreeGrid._getrowClassName=function(){var e="gridrowIndex",t=this;return t.data.parentItem&&(e+=t.data.parentItem.index.toString()),e+="level",e+=t.data.level.toString(),t.data.isSummaryRow&&(e+=" ",e+="e-summaryrow"),t.data.footerSummaryRowRecord&&(e+=" ",e+="e-footersummaryrow"),t.data.isFirstFooterSummary&&(e+=" ",e+="e-firstfootersummaryrow"),e},t.TreeGrid._getSummaryRowtdClassName=function(){var e="";return this.data.isSummaryRow&&(e+=" ",e+="e-summaryrowcell"),this.data.footerSummaryRowRecord&&(e+=" ",e+="e-footersummaryrowcell"),e},t.TreeGrid.getColumnByField=function(e,t){for(var i=0;i<e.length&&e[i].field.split(".").join("")!=t.split(".").join("");i++);return i==e.length?null:e[i]},t.TreeGrid.getColumnByMappingName=function(e,t){for(var i=0;i<e.length&&e[i].mappingName!=t;i++);return i==e.length?null:e[i]},t.TreeGrid.sendExpandCollapseRequest=function(i,l){var n,o,r,a,d=i,s=d.model;s.toolbarSettings.toolbarItems;if(l.requestType=t.TreeGrid.Actions.ExpandCollapse,d._isRowEdit?d.cancelRowEditCell():d.model.isEdit&&d.cancelEditCell(),s.enableVirtualization){if(d._isFromGantt){if(d._isLoadonDemand&&!l.data.isChildRetrieved&&1==l.expanded)return void t.TreeGrid.expandRowsonDemand(d,l.data,l);d._$treegridHelper.ejTreeGrid("processBindings",l)}else{if(d._isLoadonDemand&&!l.data.isChildRetrieved&&1==l.expanded)return void t.TreeGrid.expandRowsonDemand(d,l.data,l);d.processBindings(l)}d._isFromGantt?!1===d._isInExpandCollapseAll&&(s.enableAltRow&&d._$treegridHelper.ejTreeGrid("updateAltRow"),d._$treegridHelper.ejTreeGrid("sendDataRenderingRequest",l),d._$treegridHelper.ejTreeGrid("updateHeight"),d.model.updatedGanttRecords=d.getUpdatedRecords(),d.model.currentViewData=d.getCurrentViewData(),d._$ganttchartHelper.ejGanttChart("clearConnectorLines"),d._$ganttchartHelper.ejGanttChart("refreshHelper",d.model.currentViewData,d.model.updatedGanttRecords)):!1===d._isInExpandCollapseAll&&(s.enableAltRow&&d.updateAltRow(),d.sendDataRenderingRequest(l),d._updateWrapRowHeights("total,header"),d._setScrollTop(),d.updateHeight())}else{var c,u,g=l.data,m=0;g.expanded,l.expanded;if(c=d.model.currentViewData.indexOf(g),d._frozenColumnsLength&&d.getRows()?u=e(d.getRows()[0][c]).add(d.getRows()[1][c]):d.getRows()&&(u=d.getRows()&&e(d.getRows()[c])),l.expanded){if(g.expanded=l.expanded,d._isLoadonDemand&&!g.isChildRetrieved)return void t.TreeGrid.expandRowsonDemand(d,g,l);u&&t.TreeGrid.expandRecord(d,g,l.expanded,l),g.hasFilteredChildRecords&&(u&&u.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),u&&u.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),s.enableAltRow&&!1===d._isInExpandCollapseAll&&!s.allowPaging&&t.TreeGrid.updateAltRow(d,g,c,1)}else d._collapsedRecordCount=0,u&&t.TreeGrid.collapseRecord(d,g,l.expanded),g.expanded=l.expanded,g.hasFilteredChildRecords&&(u&&u.find(".e-treegridexpand").removeClass("e-treegridexpand").addClass("e-treegridcollapse"),u&&u.removeClass("e-treegridrowexpand").addClass("e-treegridrowcollapse")),s.enableAltRow&&!1===d._isInExpandCollapseAll&&0!=d._collapsedRecordCount&&!s.allowPaging&&t.TreeGrid.updateAltRow(d,g,c,d._collapsedRecordCount);o=0,d._isFromGantt?(d._$treegridHelper.ejTreeGrid("updateExpandStatus",g,l.expanded),d._$treegridHelper.ejTreeGrid("updateCollapsedRecordCount"),o=d._$treegridHelper.ejTreeGrid("getCollapsedRecordCount")):(d.updateExpandStatus(g,l.expanded),d.updateCollapsedRecordCount(),o=d.getCollapsedRecordCount()),s.allowPaging&&("ejTreeGridcollapsing"==l.type||"ejTreeGridexpanding"==l.type)&&(t.isNullOrUndefined(d.getPager())||d.gotoPage(),s.enableAltRow&&!1===d._isInExpandCollapseAll&&t.TreeGrid.updateAltRow(d,g,c,1)),d._isFromGantt?!1===d._isInExpandCollapseAll&&(d._totalCollapseRecordCount=o,d._$ganttchartHelper.ejGanttChart("clearConnectorLines"),d._$treegridHelper.ejTreeGrid("updateHeight"),m=d._$treegridHelper.ejTreeGrid("getRecordsHeight"),d._$ganttchartHelper.ejGanttChart("updateHeight",m),d._$ganttchartHelper.ejGanttChart("setCollapsedRecordCount",o),d._$ganttchartHelper.ejGanttChart("refreshGridLinesTable",d.model.updatedRecords.length-o)):!1===d._isInExpandCollapseAll&&(s.allowTextWrap&&d._$frozenTableContent.length>0?(d._updateWrapRowHeights("total,header"),d._updateScrollCss()):d.updateHeight())}if(d._isFromGantt&&d.model.predecessorMapping&&!1===d._isInExpandCollapseAll&&d._refreshConnectorLines(!1,!1,!0),d._isFromGantt){var p=d._$treegridHelper.ejTreeGrid("instance"),h=d._$ganttchartHelper.ejGanttChart("instance"),_=p._$gridContent.ejScroller("option","scrollTop");h._$bodyContainer.ejScroller("option","scrollTop",_),p.getScrollElement().ejScroller("isHScroll")||p.getScrollElement().scrollTop(_)}(r={}).recordIndex=l.recordIndex,r.data=l.data,r.requestType=l.requestType,r.expanded=l.expanded,t.isNullOrUndefined(r.data.item[s.expandStateMapping])||(r.data[s.expandStateMapping]=l.expanded,r.data.item[s.expandStateMapping]=l.expanded),l.expanded?d._trigger("expanded",r):d._trigger("collapsed",r),a=d.selectedItem(),!d._isFromGantt&&a&&(1==s.selectedItems.length||d._checkboxSelection)&&(d.getExpandStatus(a)||l.expanded||(d.selectRows(-1),d.selectedRowIndex(-1),a.isSelected=!1,s.selectedItem=null,a=null),n=s.allowPaging?d._updatedPageData:d.model.updatedRecords,s.enableVirtualization&&a&&n.indexOf(a)!==d.selectedRowIndex()&&d.selectRows(n.indexOf(a)),d._cancelSaveTools())},t.TreeGrid.expandRowsonDemand=function(e,i,l){var n=e,o=n.model,r=t.Query().select(n._fieldNamesToQuery),a=o.flatRecords;o.updatedRecords;if(n._isFromGantt){var d=t.Predicate(o.parentTaskIdMapping,t.FilterOperators.equal,i.item[o.taskIdMapping]),s=o.taskIdMapping;o.parentTaskIdMapping}else d=t.Predicate(o.parentIdMapping,t.FilterOperators.equal,i.item[o.idMapping]),s=o.idMapping,o.parentIdMapping;return i.isChildRetrieved?(i.expanded=!0,t.TreeGrid.sendExpandCollapseRequest(n,l),!0):!!n._trigger("actionBegin",l)||(r.where(d),n._waitingPopupObj.show(),r.requiresCount(),void n.dataSource().executeQuery(r).done(t.proxy(function(e){for(var r,d,c,u=e.result,g=u.length,m=[],p=[],h=[],_=a.indexOf(i),f=(i.childRecords&&i.childRecords.length,0);f<g;f++)n._isFromGantt?(d=n._createGanttRecord(u[f],i.level+1,i),o.enableWBS&&(r=i.WBS,d.WBS=r+"."+(f+1))):d=n._createRecord(u[f],i.level+1,i),d.index=a.length+m.length,i.childRecords.push(d),(d.item[o.hasChildMapping]||-1!=n._assignedParendIDs.indexOf(d.item[s]))&&(d.hasChildRecords=!0,d.childRecords=[],d.isChildRetrieved=!1,n._allParentItems.push(d),n._isFromGantt&&(d.manualStartDate=d.startDate,d.manualEndDate=d.endDate,d.manualDuration=d.duration,d.isAutoSchedule||n._updateManualParentItem(d,null,!0))),d.item[s]&&p.push(d.item[s]),m.push(d),h.push(u[f]);n._taskIds.splice.apply(n._taskIds,[_+1,0].concat(p)),n._isFromGantt&&o.ids.splice.apply(o.ids,[_+1,0].concat(p.toString().split(","))),a.splice.apply(a,[_+1,0].concat(m)),n._isDataManagerUpdate&&n._jsonData.splice.apply(n._jsonData,[_+1,0].concat(h)),i.isChildRetrieved=!0,i.expanded=!0,c={recordIndex:_,data:i,requestType:"expandcollapse",expanded:!0},l&&(l.isExpandingParticularLevelParent||n._isInExpandCollapseAll)?t.TreeGrid.expandMultipleRecordsonDemand(n,i,l,c):(n._renderExpandedChildRecords(l),n._trigger("expanded",c))})).fail(t.proxy(function(e){n._triggerFailureEvent(e,n)})))},t.TreeGrid.expandMultipleRecordsonDemand=function(e,i,l,n){var o,r,a,d,s,c=e;if(l.isExpandingParticularLevelParent)for(a=c._allParentItems.filter(function(e){if(e.level==l.recordLevel&&!e.expanded&&e.hasChildRecords)return e}),o=i.parentItem,r=0;r<l.recordLevel;r++)o&&o.isChildRetrieved&&(o.expanded=!0),o=o&&o.parentItem;for(c._isInExpandCollapseAll&&(a=c._allParentItems.filter(function(e){if(!e.expanded&&e.hasChildRecords)return e})),d=0;d<a.length&&((s={}).data=a[d],s.recordIndex=c.model.updatedRecords.indexOf(a[d]),s.expanded=!0,l.isExpandingParticularLevelParent&&(s.recordLevel=l.recordLevel,s.isExpandingParticularLevelParent=!0),s.requestType=t.TreeGrid.Actions.ExpandCollapse,t.TreeGrid.expandRowsonDemand(c,a[d],s));d++)c._allParentItems.splice(c._allParentItems.indexOf(a[d]),1),a.splice(a.indexOf(a[d]),1),a.length>0&&(d=-1);0==a.length&&(c._isInExpandCollapseAll=!1,c._renderExpandedChildRecords(l),c._trigger("expanded",n))},t.TreeGrid.expandRecord=function(i,l,n){var o,r,a,d=i,s=".gridrowIndex"+l.index.toString()+"level"+(l.level+1).toString(),c=".detailsrowgridrowIndex"+l.index.toString()+"level"+(l.level+1).toString(),u=e(d.element).find(s),g=0,m=u.length,p=d.model,h=e(d.element).find(c),_=e(d.element).find(s),f=d.getRows(),w=e(f[a]);for(a=p.currentViewData.indexOf(l),l.hasChildRecords&&l.childRecords.length>0&&(w.find(".e-treegridcollapse").removeClass("e-treegridcollapse").addClass("e-treegridexpand"),w.removeClass("e-treegridrowcollapse").addClass("e-treegridrowexpand")),d._expandedRecordsCount+=d._isFromGantt||d._frozenColumnsLength>0?_.length/2:_.length,_.css({display:"table-row"}),h.filter("tr.e-detailsrowexpanded").css("display","table-row"),(d._isFromGantt||d._frozenColumnsLength>0)&&(m/=2);g<m;g++)o=u[g],a=-1,-1!==(a=d._frozenColumnsLength>0?e(d.getRows()[0]).index(o):d.getRows().index(o))&&(d._isFromGantt,(r=d.model.updatedRecords[a]).isExpanded=!0,r.expanded&&t.TreeGrid.expandRecord(d,r,n))},t.TreeGrid.collapseRecord=function(i,l,n){var o,r,a,d=i,s=(d.model,".gridrowIndex"+l.index.toString()+"level"+(l.level+1).toString()),c=".detailsrowgridrowIndex"+l.index.toString()+"level"+(l.level+1).toString(),u=e(d.element).find(s),g=0,m=u.length,p=e(d.element).find(c),h=e(d.element).find(s);d.getRows();for(d._collapsedRecordCount+=d._isFromGantt||d._frozenColumnsLength>0?h.length/2:h.length,h.css({display:"none"}),p.css({display:"none"}),(d._isFromGantt||d._frozenColumnsLength>0)&&(m/=2);g<m;g++)o=u[g],r=-1,-1!==(r=d._frozenColumnsLength>0?e(d.getRows()[0]).index(o):d.getRows().index(o))&&((a=d.getUpdatedRecords()[r]).expanded&&t.TreeGrid.collapseRecord(d,a,n))},t.TreeGrid.updateAltRow=function(t,i,l,n){var o,r,a,d=t,s=0,c=d.model,u=c.updatedRecords,g=u.length,m=i.isAltRow,p=d.getRows();if(r=d._frozenColumnsLength?d.getRows()[0]:d.getRows(),!c.rowTemplateID&&!c.altRowTemplateID)for(s=l+n;s<g;s++)e(r[s]).hasClass("e-summaryrow")||"none"!==e(r[s]).css("display")&&(o=u[s],0!=s&&(o.isAltRow=!m),m=o.isAltRow,a={},a=d._frozenColumnsLength?e(p[0][s]).add(p[1][s]):e(p[s]),m?e(a).addClass("e-alt-row"):e(a).removeClass("e-alt-row"))},t.TreeGrid.refreshRow=function(i,l){var n,o,r,a,d=i,s=d.model,c=d.model.currentViewData[l];c&&(d._frozenColumnsLength>0?(o=e(d.getRows()[0][l]),n=e(d.getRows()[1][l]),s.showDetailsRow&&s.detailsTemplate&&c.isDetailsExpanded&&((r=o.next("tr")).hasClass("e-detailsrow")&&(r.remove(),n.next("tr").remove())),o.replaceWith(e(e.render[d._id+"_JSONFrozenTemplate"](c))),n.replaceWith(e(e.render[d._id+"_Template"](c)))):(n=e(d.getRows()[l]),s.showDetailsRow&&s.detailsTemplate&&c.isDetailsExpanded&&((r=n.next("tr")).hasClass("e-detailsrow")&&r.remove()),s.allowSelection||(c.isSelected=!1),n.replaceWith(e(e.render[d._id+"_Template"](c)))),d.setGridRows(e(d.getContentTable().get(0).rows)),d._gridRows=d.getContentTable().get(0).rows,d._frozenColumnsLength>0&&(d._gridRows=[d._gridRows,d.getContentTable().get(1).rows]),a=t.TreeGrid.getRowByIndex(d,d.getUpdatedRecords().indexOf(s.currentViewData[l])),d._trigger("refresh"),d._rowEventTrigger(a,c))},t.TreeGrid.getRowByIndex=function(i,l,n){var o,r,a;try{var d=(o="ejTreeGrid"==i.pluginName?i:i._$treegridHelper.data("ejTreeGrid")).getRows(),s=(o.model,o.getUpdatedRecords()),c=e();return o.model.enableVirtualization&&(r=s[l],l=o.model.currentViewData.indexOf(r)),t.isNullOrUndefined(n)?o._frozenColumnsLength>0?(d[0][l]&&(c.push(d[0][l]),c.push(d[1][l])),c):e(d[l]):(o.model.enableVirtualization&&(a=s[n],n=o.model.currentViewData.indexOf(a)),o._frozenColumnsLength>0?(c.push(e(d[0]).slice(l,n)),c.push(e(d[1]).slice(l,n)),c):e(d.slice(l,n)))}catch(t){return e()}}})(jQuery,Syncfusion),function(e,t){t.gridFeatures=t.gridFeatures||{},t.gridFeatures.gridResize=function(t){this.$headerTable=t.getHeaderTable(),this.gridInstance=t,this._colMinWidth=15,this._$visualElement=e(),this._currentCell=-1,this._allowStart=!1,this._oldWidth=null,this._orgX=null,this._orgY=null,this._extra=null,this._expand=!1,this._target=null,this._cellIndex=-1},t.gridFeatures.gridResize.prototype={_mouseHover:function(t){var i,l,n,o,r;if(!this._$visualElement.is(":visible")&&(this._allowStart=!1,e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),i=e(t.target),e(t.target).hasClass("e-filtericon")&&("col-resize"==e(t.target).css("cursor")||"col-resize"==e(t.target).closest("tr").css("cursor"))&&(e(t.target).css("cursor","pointer"),e(t.target).closest("tr").css("cursor","pointer")),i.hasClass("e-headercell"))){var a=t.target,d=a.getBoundingClientRect(),s=0,c=0;(t.type="mousemove")?(s=t.clientX,c=t.clientY):(t.type="touchmove")?(s=evt.originalEvent.changedTouches[0].clientX,c=evt.originalEvent.changedTouches[0].clientY):(t.type="MSPointerMove")&&(s=t.originalEvent.clientX,c=t.originalEvent.clientY),l=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+this.gridInstance.element.children(".e-gridheader").find(".e-columnheader").offset().left,(s>=d.left+document.documentElement.scrollLeft+a.offsetWidth-5||s<=d.left+3)&&s<l&&s>=d.left&&c<=d.top+document.documentElement.scrollTop+t.target.offsetHeight?(n=s>d.left+3?e(t.target).find(".e-headercelldiv"):e(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),o=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,r=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-o,(this.gridInstance.model.enableRTL&&s<=r||!this.gridInstance.model.enableRTL&&s>=r)&&((this.gridInstance.model.showStackedHeader||n.length)&&-1==e.inArray(e(n).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)?(this.gridInstance.model.showStackedHeader&&e(i.parents("thead")).find("tr").addClass("e-resizedragicon"),this.gridInstance.model.showStackedHeader||i.parent().addClass("e-resizedragicon"),this._currentCell=e(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(a):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(a),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):(i.parent().css("cursor","pointer"),this._currentCell=-1))):(this.gridInstance.element.find(".e-columnheader").removeClass("e-resizedragicon"),this._currentCell=-1)}},_start:function(t,i){var l,n,o,r,a,d,s,c=this.gridInstance.getHeaderTable().find(".e-columnheader");if(n=e(this._target).hasClass("e-stackedHeaderCell")?c.find(".e-headercell").not(".e-hide"):c.find(".e-headercell").not(".e-stackedHeaderCell,.e-hide"),-1!=this._currentCell&&this._currentCell<n.length&&(o=n[this._currentCell]),void 0!==o)if(r=o.getBoundingClientRect(),l=this._tableY=r.top+parseInt(-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart){if(a=this._$visualElement=e(document.createElement("div")),d=this.gridInstance.element.find(".e-gridcontent").first().height()+this.gridInstance.element.find(".e-gridheader").height(),this.gridInstance.model.showStackedHeader&&this.gridInstance.model.stackedHeaderRows.length>0){var u=this.gridInstance.getHeaderTable().find("tr.e-columnheader"),g=(u.length,e(this._target).parent("tr")[0].rowIndex);for(s=0;s<g;s++)d-=e(u[s]).height()}a.addClass("e-reSizeColbg").appendTo(this.gridInstance.element).attr("unselectable","on").css("visibility","hidden"),this.gridInstance._resizeTimeOut=setTimeout(function(){a.css({visibility:"visible",height:d+"px",cursor:"col-resize",left:t,top:l,position:"fixed"})},100),this._oldWidth=o.offsetWidth,this._orgX=t,this._orgY=i,this._extra=t-this._orgX,this._expand=!0}else this._currentCell=-1},_mouseMove:function(e){if(this._expand){var t=0,i=0;"mousemove"==e.type?(t=e.clientX,i=e.clientY):"MSPointerMove"==e.type?(t=e.originalEvent.clientX,i=e.originalEvent.clientY):"touchmove"==e.type&&(t=e.originalEvent.changedTouches[0].clientX,i=e.originalEvent.changedTouches[0].clientY),0==t&&0==i&&-1!=navigator.userAgent.indexOf("WebKit")&&(t=e.pageX,i=e.pageY),t+=document.documentElement.scrollLeft,e.preventDefault(),this._moveVisual(t)}else this._mouseHover(e)},_touchStart:function(t){var i,l,n,o,r,a;if(!this._$visualElement.is(":visible")){if(this._allowStart=!1,e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),(i=e(t.target)).hasClass("e-headercell")){var d=t.target,s=d.getBoundingClientRect(),c=0,u=0;"touchstart"==t.type&&(c=t.originalEvent.changedTouches[0].clientX,u=t.originalEvent.changedTouches[0].clientY),l=this.gridInstance.element.children(".e-gridheader"),n=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderContent().width()+l.find(".e-columnheader").offset().left:this.gridInstance.getHeaderTable().width()+l.find(".e-columnheader").offset().left,(c>=s.left+document.documentElement.scrollLeft+d.offsetWidth-10||c<=s.left+8)&&c<n&&c>=s.left&&u<=s.top+document.documentElement.scrollTop+t.target.offsetHeight?(o=c>s.left+8?e(t.target).find(".e-headercelldiv"):e(t.target).prevAll("th:visible:first").find(".e-headercelldiv"),r=window.pageXOffset||document.documentElement.scrollTop||document.body.scrollTop,a=this.gridInstance.element.find(".e-headercell").not(".e-detailheadercell").offset().left+10-r,(this.gridInstance.model.enableRTL&&c<=a||!this.gridInstance.model.enableRTL&&c>=a)&&((this.gridInstance.model.showStackedHeader||o.length)&&-1==e.inArray(e(o).attr("data-ej-mappingname"),this.gridInstance._disabledResizingColumns)?(this._currentCell=e(t.target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell:visible").index(d):this.gridInstance.getHeaderContent().find(".e-headercell:visible").not(".e-stackedHeaderCell,.e-detailheadercell").index(d),this.gridInstance.model.enableRTL&&(this._currentCell=this._currentCell-1),this._allowStart=!0):this._currentCell=-1)):this._currentCell=-1}if(this._allowStart){if(this._target=i,"ejGrid"==this.gridInstance.pluginName&&this.gridInstance.model.allowResizing){if(this._triggerResizeEvents("resizeStart",c))return}else if("ejTreeGrid"==this.gridInstance.pluginName&&this.gridInstance.model.allowColumnResize&&this.gridInstance._triggerColumnResize("columnResizeStart",c,t))return;return this,c+=document.documentElement.scrollLeft,2!=t.button&&this._start(c,u),!1}return!0}},_getCellIndex:function(t){e(t._target);var i,l,n=t._target,o=n.getBoundingClientRect(),r=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft;return this._orgX<o.left+5+r&&(n=e(n).prevAll(":visible:first")[0]),l=i=n.cellIndex,t.gridInstance.model.groupSettings.groupedColumns.length&&(l=i-t.gridInstance.model.groupSettings.groupedColumns.length),l},_reSize:function(i){var l,n,o,r,a,d,s,c,u,g,m,p,h,_,f,w,C;if(this._initialTableWidth=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns?this.gridInstance.getHeaderTable().first().parent().width()+this.gridInstance.getHeaderTable().last().parent().width():this.gridInstance.getHeaderTable().parent().width(),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell=this._currentCell-1:this.gridInstance.model.enableRTL||this._getResizableCell(),n=this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.getHeaderTable().find("thead"):e(this._target).parents("thead"),-1!=this._currentCell&&this._expand){this._expand=!1;var x=(e(this._target).hasClass("e-stackedHeaderCell")?n.find(".e-headercell:not(.e-detailheadercell)").filter(":visible"):n.find(".e-headercell:not(.e-detailheadercell,.e-stackedHeaderCell)").filter(":visible"))[this._currentCell],v=x.offsetWidth,S=i-this._orgX;if(this.gridInstance.model.enableRTL&&(S=-S),parseInt(S)+parseInt(v)>this._colMinWidth){if(0!=S&&n.css("cursor","default"),"nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&(o=this.gridInstance.getHeaderTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),o=this.gridInstance._$headerCols),r=o.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),a=parseInt(r[0].style.width)),this._resizeColumnUsingDiff(v,S),d=(l=this.gridInstance.element.find(".e-gridcontent").first()).find("div").hasClass("e-content"),(s=!t.isIOSWebView()&&this.gridInstance.getBrowserDetails())&&"msie"==s.browser&&this.gridInstance.model.allowScrolling&&(c=this.gridInstance.getContentTable().width(),u=this.gridInstance._calculateWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns>0?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterTable().last().width(u-this.gridInstance.getFooterContent().find(".e-frozenfootertdiv").width()):u>c&&this.gridInstance.model.showSummary&&this.gridInstance.getFooterTable().width(u),parseInt(s.version,10)>8&&this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length&&(u>c?this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",2e3/l.find("table").first().width()+"%"):(this.gridInstance.getContentTable().css("width","100%"),this.gridInstance._groupingAction(!0),this.gridInstance.getContentTable().children("colgroup").find("col").first().css("width",(this.gridInstance.getHeaderTable().find("colgroup").find("col").first().width()/l.find("table").first().width()*100).toFixed(2)+"%"))),this.gridInstance.getHeaderTable().parent().scrollLeft(l.find(".e-content").scrollLeft()-1)),this.gridInstance._colgroupRefresh(),this.gridInstance.model.allowTextWrap&&(this.gridInstance._isResized=!0,this.gridInstance.rowHeightRefresh()),this.gridInstance.model.groupSettings.groupedColumns.length&&!this.gridInstance.model.isEdit&&this.gridInstance._recalculateIndentWidth(),"normal"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model))if("nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)){g=this.gridInstance.getHeaderTable().find("colgroup").find("col"),m=this.gridInstance.getContentTable().find("colgroup").find("col"),t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),g=this.gridInstance._$headerCols,m=this.gridInstance._$contentCols);var R,T=this._currentCell+1,b=g.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?T+this.gridInstance.model.groupSettings.groupedColumns.length:T);if((A=parseInt(b[0].style.width)+(a-parseInt(r[0].style.width)))<this._colMinWidth&&(A=this._colMinWidth),b.width(A),this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var y=this.gridInstance.getContentTable().find(".e-recordtable"),I=y.find("colgroup"),D=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(I=I.not(y.find(".e-detailrow").find("colgroup")).get()),w=0;w<I.length;w++)(p=e(I[w]).find("col").filter(this._diaplayFinder)).length>D&&p.splice(0,p.length-D),e(p[T]).width(A)}if(this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(T>=0&&T<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+S>this.gridInstance.element.find(".e-headercontent").first().width())return;R=m.filter(this._diaplayFinder).eq(T)}else R=m.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)?T+this.gridInstance.model.groupSettings.groupedColumns.length:T);if(R.width(A),this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings.frozenColumns>0&&e(x).is(":last-child")&&"ejGrid"==this.gridInstance.pluginName){var E=r.width()-a,M=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+E,k=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-E,F=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+E;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(M),this.gridInstance.getContent().find(".e-frozencontentdiv").width(M),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(M),this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(k),this.gridInstance.getContent().find(".e-movablecontentdiv").width(k),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooterdiv").width(k),this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",F),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",F),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",F)}if(this.gridInstance.model.scrollSettings.frozenColumns>0&&e(x).is(":last-child")&&"ejTreeGrid"==this.gridInstance.pluginName){E=r.width()-a,M=this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width()+E,k=this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width()-E,F=parseInt(this.gridInstance.getHeaderContent().find(".e-movableheader")[0].style["margin-left"])+E;this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(M),this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",F),this.gridInstance.getHeaderContent().find(".e-movableheaderdiv").width(k),this.gridInstance.getContent().find(".e-frozencontainer").width(M).next().css("margin-left",F+"px"),this.gridInstance.getContent().find(".e-movablecontent").width(k),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(M),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",F+"px")),this.gridInstance._renderScroller(!0)}this.gridInstance.model.scrollSettings.frozenColumns>0&&e(this._target).parent("tr").parents("div:first").hasClass("e-frozenheaderdiv")&&"ejGrid"==this.gridInstance.pluginName&&(this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(this._newWidth),this.gridInstance.getContent().find(".e-frozencontentdiv").width(this._newWidth),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(this._newWidth))}else this.gridInstance.model.scrollSettings.frozenColumns||(h=this.gridInstance.getHeaderTable().width(),"ejTreeGrid"==this.gridInstance.pluginName||this.gridInstance.model.allowScrolling||this.gridInstance.model.isResponsive?this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().css("width",h+parseInt(S)):e("#"+this.gridInstance._id).css("width",h+parseInt(S)),this.gridInstance.model.scrollSettings.width+=parseInt(S),this.gridInstance.getContent().width()>this.gridInstance.getContentTable().width()?(this.gridInstance.getContentTable().addClass("e-tableLastCell"),this.gridInstance.getHeaderTable().addClass("e-tableLastCell")):(this.gridInstance.getContentTable().removeClass("e-tableLastCell"),this.gridInstance.getHeaderTable().removeClass("e-tableLastCell")));if("msie"==s.browser||!s||!this.gridInstance.model.allowScrolling||0!=this.gridInstance.model.scrollSettings.frozenColumns||("fixed"!=this.gridInstance.model.columnLayout&&(this.gridInstance.getHeaderTable().width("100%"),this.gridInstance.getContentTable().width("100%")),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width("100%"),((_=this.gridInstance._calculateWidth())<=this.gridInstance.getContentTable().width()||this.gridInstance.getHeaderTable().width()>this.gridInstance.getContentTable().width())&&this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable())&&this.gridInstance.getFooterTable().width(_)),this.gridInstance.model.allowResizing&&"default"==this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor")){var O=this._currentCell,H=e(this._target),z=[],P=[],A=v+S,N={};if(this.gridInstance.model.showStackedHeader&&H.hasClass("e-stackedHeaderCell")){var G,L=H.parent(".e-stackedHeaderRow").index(),j=H.text(),B=this.gridInstance.model.stackedHeaderRows[L].stackedHeaderColumns;for(w=0;w<B.length;w++)B[w].headerText==j&&(G=B[w].column);for(f=G|[],t.isNullOrUndefined(G)||G instanceof Array||(f=G.split(",")),w=0;w<f.length;w++)C=this.gridInstance.getColumnIndexByField(f[w]),z.push(C),P.push(this.gridInstance.model.columns[C]);N={columnIndex:z,column:P,oldWidth:v,newWidth:A}}else N={columnIndex:O,column:this.gridInstance.model.columns[O],oldWidth:v,newWidth:A};this.gridInstance._trigger("resized",N)}this.gridInstance.model.allowScrolling&&(this.gridInstance.getScrollObject().refresh(this.gridInstance.model.scrollSettings.frozenColumns>0),this.gridInstance.model.isResponsive&&this.gridInstance.model.minWidth&&this.gridInstance.windowonresize(),!d&&l.find("div").hasClass("e-content")&&this.gridInstance.refreshScrollerEvent(),this.gridInstance._isHscrollcss())}}this._target=null,this._$visualElement.remove(),this._expand=!1,this._currentCell=-1,this._allowStart=!1},_getFrozenResizeWidth:function(){for(var e=this.gridInstance.getHeaderTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),t=0,i=0;i<e.length;i++)"none"!=e.eq(i).css("display")&&(t+=parseInt(e[i].style.width.replace("px","")));return t},_diaplayFinder:function(){return"none"!=e(this).css("display")},_resizeColumnUsingDiff:function(i,l){var n,o,r,a,d,s,c,u,g,m,p,h,_,f,w;this._currntCe=this._currentCell,this._widthchanges(i,l);var C,x,v=this._newWidth,S=this._extra,R=this._$headerCols,T=this._$ContentCols,b=this._$headerCol;this._$frozenCols;if(("ejTreeGrid"!=this.gridInstance.pluginName||!(l>0)||t.isNullOrUndefined(this.gridInstance._currentCell)||1!=this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen||!((w=this.gridInstance._frozenWidth())>this.gridInstance._gridWidth-68))&&v>0&&0!=l){if(v<this._colMinWidth&&(v=this._colMinWidth),"nextcolumn"==t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&(n=b.next(),(o=!(!this.gridInstance.model.scrollSettings.frozenColumns||this._currentCell!=this.gridInstance.model.scrollSettings.frozenColumns-1))&&(n=R.eq(this.gridInstance.model.scrollSettings.frozenColumns)),(o||!b.is(":last-child"))&&n.width()+(b.width()-v)<=this._colMinWidth&&(v=b.width()+(n.width()-this._colMinWidth))),l=v-i,this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns){if(this._currentCell>=0&&this._currentCell<this.gridInstance.model.scrollSettings.frozenColumns&&this._getFrozenResizeWidth()+l>this.gridInstance.element.find(".e-headercontent").first().width())return;C=T.filter(this._diaplayFinder).eq(this._currentCell)}else C=T.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell);if(e(this._target).parent("tr").hasClass("e-stackedHeaderRow")?this._resizeStackedHeaderColumn(e(this._target).parent("tr"),S,this._currntCe):b.outerWidth(v),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterTable()))if(this._$footerCols=this.gridInstance.getFooterTable().find("colgroup").find("col"),E=this.gridInstance.model.columns.length,this._$footerCols.length>E&&this._$footerCols.splice(0,this._$footerCols.length-E),x=(r=this._$footerCols).filter(this._diaplayFinder).eq(this._currentCell),e(this._target).parent("tr").hasClass("e-stackedHeaderRow"))for(u=0;u<this._changedcell.length;u++)x=r.filter(this._diaplayFinder).eq(u),(w=parseInt(S)+parseInt(r[u].style.width))<this._colMinWidth&&(w=this._colMinWidth),x.outerWidth(w);else x.outerWidth(v);if(e(this._target).parent("tr").hasClass("e-stackedHeaderRow")){if(this.gridInstance.model.groupSettings.groupedColumns.length)for(I=(y=this.gridInstance.getContentTable().find(".e-recordtable")).find("colgroup"),u=0;u<this._changedcell.length;u++)for(D=this._changedcell[u],a=0;a<I.length;a++)d=e(I[a]).children().filter(this._diaplayFinder),(w=parseInt(S)+parseInt(d[D].style.width))<this._colMinWidth&&(w=this._colMinWidth),e(d[D]).width(w);for(this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder).length,u=0;u<this._changedcell.length;u++)s=this.gridInstance.getContentTable().find("colgroup").find("col").filter(this._diaplayFinder)[this._changedcell[u]],(w=parseInt(S)+parseInt(s.style.width))<this._colMinWidth&&(w=this._colMinWidth),e(s).outerWidth(w),this.gridInstance.model.isEdit&&this.gridInstance.model.allowGrouping&&0==this.gridInstance.model.groupSettings.groupedColumns.length&&(c=this.gridInstance.getContentTable().find(".gridform").find("colgroup col").filter(this._diaplayFinder)[this._changedcell[u]],e(c).outerWidth(w))}else{if(this.gridInstance.model.groupSettings&&this.gridInstance.model.groupSettings.groupedColumns.length){var y,I=(y=this.gridInstance.getContentTable().find(".e-recordtable")).find("colgroup"),D=this._currentCell,E=this.gridInstance.getVisibleColumnNames().length;for(this.gridInstance.getContentTable().find(".e-detailrow").length&&(I=I.not(y.find(".e-detailrow").find("colgroup")).get()),u=0;u<I.length;u++)(g=e(I[u]).find("col").filter(this._diaplayFinder)).length>E&&g.splice(0,g.length-E),e(g[D]).width(v)}C.outerWidth(v),this.gridInstance.model.isEdit&&(p=(m=this.gridInstance.getContentTable().find(".e-editedrow,.e-addedrow")).find("table").find("colgroup col"),h=m.hasClass("e-addedrow")&&this.gridInstance.model.groupSettings.groupedColumns.length?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length-1:this._currentCell,p.filter(this._diaplayFinder).eq(h).outerWidth(v))}if(this.gridInstance._findColumnsWidth(),this.gridInstance.model.scrollSettings&&this.gridInstance.model.scrollSettings.frozenColumns&&"nextcolumn"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model)&&"ejGrid"==this.gridInstance.pluginName){for(_=this.gridInstance.getContentTable().find("colgroup").find("col").slice(0,this.gridInstance.model.scrollSettings.frozenColumns),w=0,u=0;u<_.length;u++)w+="none"==_[u].style.display?0:parseInt(_[u].style.width.replace("px",""));this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w),f=this.gridInstance.model.enableRTL?"margin-right":"margin-left",this.gridInstance.getContent().find(".e-frozencontentdiv").width(w).next().css(f,w+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w).next().css(f,w+"px"),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-frozenfooterdiv").width(w)}"ejTreeGrid"==this.gridInstance.pluginName&&(!t.isNullOrUndefined(this.gridInstance._currentCell)&&1==this.gridInstance.model.columns[this.gridInstance._currentCell].isFrozen&&"nextcolumn"!=t.getObject("resizeSettings.resizeMode",this.gridInstance.model)||!this.gridInstance._isFrozenStackedResize&&this.gridInstance._isStackedResize&&this.gridInstance._frozenColumnsLength>0)&&(w=this.gridInstance._frozenWidth(),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w),this.gridInstance.getContent().find(".e-frozencontainer").width(w).next().css("margin-left",w+"px"),this.gridInstance.getHeaderContent().find(".e-frozenheaderdiv").width(w).next().css("margin-left",w+"px"),this.gridInstance.model.showTotalSummary&&(this.gridInstance._$totalSummaryRowContainer.find(".e-frozenfooterdiv").width(w),this.gridInstance._$totalSummaryRowContainer.find(".e-movablefooter").css("margin-left",w+"px")),this.gridInstance._findColumnsWidth(),this.gridInstance._renderScroller(!0)),this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||this.gridInstance.getHeaderTable().find(".e-columnheader").css("cursor","default")}},_resizeStackedHeaderColumn:function(t,i,l){var n,o,r,a,d;this._changedcell=[];var s=0,c=0,u=this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell")[l],g=e(u).attr("colspan"),m=e(u).parent("tr"),p=(m.next(),u.cellIndex);for(this.gridInstance.model.groupSettings.showGroupedColumn&&(s+=c=this.gridInstance.model.groupSettings.groupedColumns.length);p>c;)p--,n=e(m).children("th").not(".e-detailheadercell")[p],s+=parseInt(e(n).attr("colspan"));for(this._currentCell=s,o=s+parseInt(g),r=s;r<o;r++)a=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder)[r],this._changedcell.push(r-c),(d=parseInt(i)+parseInt(a.style.width))<this._colMinWidth&&(d=this._colMinWidth),e(a).outerWidth(d)},_triggerResizeEvents:function(i,l){var n,o,r,a,d,s,c,u,g=this.gridInstance.getHeaderTable().find(".e-columnheader"),m=g.find(".e-headercell").filter(":visible"),p=this._cellIndex,h=e(this._target),_=[],f=[];if("resizeStart"==i&&(this._orgX=l,p=this._cellIndex=this._getCellIndex(this,l)),this.gridInstance.model.enableRTL&&(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?n=this._currentCell-1:(this.gridInstance.model.enableRTL||this._getResizableCell(),n=this._currentCell),r=(o=m[n]).offsetWidth,this.gridInstance.model.showStackedHeader&&h.hasClass("e-stackedHeaderCell")){var w,C=h.parent(".e-stackedHeaderRow").index(),x=h.text(),v=this.gridInstance.model.stackedHeaderRows[C].stackedHeaderColumns;for(d=0;d<v.length;d++)v[d].headerText==x&&(w=v[d].column);for(a=w|[],t.isNullOrUndefined(w)||w instanceof Array||(a=w.split(",")),d=0;d<a.length;d++)s=this.gridInstance.getColumnIndexByField(a[d]),_.push(s),f.push(this.gridInstance.model.columns[s])}return"resizeStart"==i?(u={},u=this.gridInstance.model.showStackedHeader&&h.hasClass("e-stackedHeaderCell")?{columnIndex:_,column:f,target:h,oldWidth:r}:{columnIndex:p,column:this.gridInstance.model.columns[p],target:e(o),oldWidth:r},this.gridInstance._trigger("resizeStart",u)):(g.find(".e-headercell").not(".e-detailheadercell").filter(":visible"),c=l-this._orgX,this._widthchanges(r,c),this.gridInstance._colgroupRefresh(),u={},u=this.gridInstance.model.showStackedHeader&&h.hasClass("e-stackedHeaderCell")?{columnIndex:_,column:f,target:e(o),oldWidth:r,newWidth:this._newWidth,extra:c}:{columnIndex:p,column:this.gridInstance.model.columns[p],target:e(o),oldWidth:r,newWidth:this._newWidth,extra:c},this.gridInstance._trigger("resizeEnd",u))},_widthchanges:function(i,l){var n=this._$headerCols=this.gridInstance.getHeaderTable().find("colgroup").find("col");this._$ContentCols=this.gridInstance.getContentTable().find("colgroup").find("col");t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)||(this.gridInstance._detailColsRefresh(),n=this._$headerCols=this.gridInstance._$headerCols,this._$ContentCols=this.gridInstance._$contentCols);var o=this._$headerCol=n.filter(this._diaplayFinder).eq(this.gridInstance.model.allowGrouping&&t.isNullOrUndefined(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)?this._currentCell+this.gridInstance.model.groupSettings.groupedColumns.length:this._currentCell),r=(this._$frozenCols=n.slice(0,this.gridInstance.model.scrollSettings?this.gridInstance.model.scrollSettings.frozenColumns:0),o[0].style.width),a=-1!=r.indexOf("%"),d=!r||a?e(this._target).outerWidth():r,s=a?1:i/parseInt(d);this._extra=l/s,this._newWidth=parseInt(l)+parseInt(d)},_mouseUp:function(e){var i,l;if(this.gridInstance._resizeTimeOut&&(clearTimeout(this.gridInstance._resizeTimeOut),this.gridInstance._resizeTimeOut=0),this._expand){if(i=e.clientX,l=e.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(i=e.pageX,l=e.pageY),"touchend"==e.type&&(i=e.originalEvent.changedTouches[0].clientX,l=e.originalEvent.changedTouches[0].clientY),this.gridInstance.model.allowResizing&&(this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")||"touchend"==e.type)&&this._triggerResizeEvents("resizeEnd",i))return void this.gridInstance.element.find(".e-reSizeColbg").remove();if(i+=document.documentElement.scrollLeft,this._reSize(i,l),!t.isNullOrUndefined(this._currntCe)&&this._currntCe>=0){var n=t.DataManager(this.gridInstance.model.columns).executeLocal((new t.Query).where("visible","equal",!0)),o=n[this._currntCe],r=this.gridInstance.model.columns.indexOf(o);n.length!=this.gridInstance.model.columns.length?this.gridInstance.model.columns[r].width=this.gridInstance.columnsWidthCollection[r]:this.gridInstance.model.columns[this._currntCe].width=this.gridInstance.columnsWidthCollection[this._currntCe]}}},_getResizableCell:function(){var t,i,l,n,o,r,a,d=this.gridInstance.model.scrollSettings.frozenColumns;if(o=(t=e(this._target).hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderTable().find(".e-columnheader"):this.gridInstance.getHeaderTable().find(".e-columnheader").not(".e-stackedHeaderRow")).find(".e-headercell").not(".e-hide,.e-detailheadercell"),i=-1!=navigator.userAgent.indexOf("WebKit")?document.body.scrollLeft:document.documentElement.scrollLeft,d&&-1!=this._currentCell&&this._currentCell==d-1&&(l=o[this._currentCell].getBoundingClientRect().left+i+5>this._orgX),!d||this._currentCell!=d-1||l)for(n=e(this._target).closest(".e-columnheader").index(),t=e(this._target).hasClass("e-stackedHeaderCell")?t[n]:t,o=e(t).find(".e-headercell").not(".e-hide,.e-detailheadercell"),r=0;r<o.length;r++){if((a=o[r].getBoundingClientRect()).left+i+5>this._orgX&&o[r].offsetHeight+a.top>=this._orgY)return void(this._currentCell=r-1);if(r==o.length-1||this.gridInstance.model.showStackedHeader&&e(this._target).get(0)===o[r])return void(this._currentCell=r)}},_moveVisual:function(e){var t=this.gridInstance.getHeaderContent().find("div").first()[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<e||e<t.left+document.documentElement.scrollLeft?this._$visualElement.remove():-1!=this._currentCell&&this._$visualElement.css({left:e,top:this._tableY})},_mouseDown:function(t){var i,l;return!this._allowStart||!e(t.target).closest("tr").hasClass("e-resizedragicon")||(this._target=t.target,i=t.clientX,l=t.clientY,-1!=navigator.userAgent.indexOf("WebKit")&&(i=t.pageX,l=t.pageY-(window.pageYOffset||document.body.scrollTop||0)),this.gridInstance.model.allowResizing&&this.gridInstance.getHeaderTable().find(".e-columnheader").hasClass("e-resizedragicon")&&(e(t.target).is(".e-headercelldiv")&&(t.target=t.target.parentNode),this._target=t.target,this._triggerResizeEvents("resizeStart",i))?void 0:(this,i+=document.documentElement.scrollLeft,2!=t.button&&this._start(i,l),!1))},_columnResizeToFit:function(i){var l,n,o,r,a,d,s,c,u,g,m,p,h,_,f=this.gridInstance.getHeaderTable().find(".e-columnheader").filter(function(){return"col-resize"==e(this).css("cursor")});if(this.gridInstance.model.allowResizeToFit&&f.length){e(i.target).is(".e-headercelldiv")&&(i.target=i.target.parentNode);var w,C=e(i.target),x=0,v=0;if(w=C.hasClass("e-stackedHeaderCell")?this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-detailheadercell"):this.gridInstance.getHeaderContent().find(".e-headercell").not(".e-stackedHeaderCell,.e-detailheadercell"),this._target=C,C.hasClass("e-headercell")){var S=i.target,R=e.inArray(S,w),T=R;this._orgX=i.pageX,this.gridInstance.model.enableRTL?this._currentCell=R:this._getResizableCell(),R!=this._currentCell&&(R=T=this._currentCell,S=i.target.previousSibling);var b=w.filter(":visible")[T],y=[],I=[],D=[];if(v=this.gridInstance.model.groupSettings.groupedColumns.length,t.isNullOrUndefined(this.gridInstance.model.detailsTemplate)&&t.isNullOrUndefined(this.gridInstance.model.childGrid)||(v+=1),e(S).parent("tr").hasClass("e-stackedHeaderRow")){var E=e(b).attr("colspan"),M=e(b).parent("tr"),k=b.cellIndex;for(M.next();k>v;)k--,l=e(M).children("th")[k],x+=parseInt(e(l).attr("colspan"));n=x+parseInt(E)}else x=T,n=T+1;var F=0,O=0,H=0,z=[],P=[];if(-1!=x)for(r={columnIndex:x+(o=w.slice(0,x+1).filter(".e-hide").length),column:this.gridInstance.model.columns[x+o],target:C,oldWidth:d},this.gridInstance._trigger("resizeStart",r),_=x;_<n;_++){if(o=w.slice(0,_+1).filter(".e-hide").length,H=this._getContentWidth(_+o),a=this.gridInstance.getHeaderTable().find(".e-headercell:not(.e-hide, .e-stackedHeaderCell)").children(".e-headercelldiv").eq(_),O=this._getHeaderContentWidth(a),F=O>H?O:H,F+=parseInt((a.css("padding-left"),10+(a.css("padding-right"),10))),d=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder).eq(_+v).width(),F=d>F?F:this._colMinWidth<F?F:this._colMinWidth,s=this.gridInstance.getHeaderTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&s.splice(0,1),s.eq(_+v).width(F),this.gridInstance.model.groupSettings.groupedColumns.length&&(c=this.gridInstance.getContentTable().find(".e-recordtable").find("colgroup"),u=this,e.each(c,function(t,i){e(i).find("col").filter(u._diaplayFinder).eq(_).width(F)})),g=this.gridInstance.getContentTable().find("col").filter(this._diaplayFinder),(this.gridInstance.model.detailsTemplate||this.gridInstance.model.childGrid)&&g.splice(0,1),g.eq(_+v).width(F),this.gridInstance.model.isEdit)for(this.gridInstance.getContentTable().find(".e-editedrow").find("col"),m=this.gridInstance.element.find(".gridform"),p=0;p<m.length;p++)e(m[p]).find("col").eq(_+v).width(F);z.push(this.gridInstance.model.columns[_+o]),P.push(Math.abs(F-d)),y.push(_+o),I.push(F),D.push(d),(this.gridInstance.model.scrollSettings.frozenColumns>0||this.gridInstance.model.groupSettings.groupedColumns.length&&this.gridInstance.model.isEdit)&&(h=_+o,this.gridInstance.columnsWidthCollection[h]=F,this.gridInstance.setWidthToColumns(),this.gridInstance.model.scrollSettings.frozenColumns<=h+1&&(this.gridInstance.getHeaderContent().find(".e-movableheader").css("margin-left",F),this.gridInstance.getContent().find(".e-movablecontent").css("margin-left",F),this.gridInstance.model.showSummary&&!t.isNullOrUndefined(this.gridInstance.getFooterContent())&&this.gridInstance.getFooterContent().find(".e-movablefooter").css("margin-left",F)))}for(this.gridInstance._colgroupRefresh(),this.gridInstance._recalculateIndentWidth(),r={columnIndex:y,column:z,target:b,oldWidth:D,newWidth:I,extra:P},this.gridInstance._trigger("resizeEnd",r),_=0;_<y.length;_++)this.gridInstance.columnsWidthCollection[y[_]]=I[_],this.gridInstance.model.columns[y[_]].width=I[_];r={columnIndex:y,column:z,target:b,oldWidth:D,newWidth:I,extra:P},this.gridInstance._trigger("resized",r),this.gridInstance.model.summaryRows.length>0&&this.gridInstance._summaryColRrefresh(),this.gridInstance._findColumnsWidth()}}},_getContentWidth:function(i){var l,n,o=0,r=t.buildTag("span",{},{}),a=this.gridInstance;return t.isNullOrUndefined(a._gridRows)||(n=a._gridRows,a.model.scrollSettings.frozenColumns&&a.model.currentViewData.length&&i>=a.model.scrollSettings.frozenColumns&&(n=n[1],i-=a.model.scrollSettings.frozenColumns),e.each(n,function(t,n){if(e(n).is(".e-row,.e-alt_row")&&!e(n).is(".e-editedrow")){var d=e(n).find("td.e-rowcell").eq(i),s=e(d).html();a.model.columns[i].commands?r.html(e(s).children()):d.hasClass("e-validError")?r.html(e(s).attr("value")):r.html(s),e(d).html(r),(l=d.find("span:first").width()>0?d.find("span:first").width()+parseFloat(d.css("padding-left"))+parseFloat(d.css("padding-right")):d.find("span:first").width())>o&&(o=l),e(d).html(s)}})),a._refreshUnboundTemplate(this.gridInstance.getContentTable()),o},_getHeaderContentWidth:function(e){var i,l,n=0,o=t.buildTag("span",{},{}),r="msie"==this.gridInstance.getBrowserDetails().browser;return r&&o.css("position","absolute"),i=e.html(),o.html(i),e.html(o),n=e.find("span:first").width()+parseFloat(e.css("padding-left"))+parseFloat(e.css("padding-right")),r&&(n+=2),this.gridInstance.model.allowFiltering&&("menu"==this.gridInstance.model.filterSettings.filterType||"excel"==this.gridInstance.model.filterSettings.filterType)&&(n=n+(l=e.parent().find(".e-filtericon")).width()+10,l.length&&(n+=parseFloat(l.css("margin-left")))),e.html(i),n}}}(jQuery,Syncfusion)})},1449:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var n,o=arguments.length,r=o<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(5),r=i(1012),a=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.treeGridData=e.getGanttData(),this.selection={selectionType:ej.TreeGrid.SelectionType.Checkbox,selectionMode:ej.TreeGrid.SelectionMode.Row,enableSelectAll:!0,enableHierarchySelection:!0}}return e=l([o.Component({selector:"ej-app",template:i(1947),styles:[i(1021)],providers:[r.GanttDataService]}),n("design:paramtypes",[r.GanttDataService])],e)}();t.CheckboxSelectionComponent=a},1450:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var n,o=arguments.length,r=o<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(5),r=i(1012),a=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.treeGridData=e.getGanttData()}return e=l([o.Component({selector:"ej-app",template:i(1948),styles:[i(1021)],providers:[r.GanttDataService]}),n("design:paramtypes",[r.GanttDataService])],e)}();t.ColumnReorderComponent=a},1451:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var n,o=arguments.length,r=o<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(5),r=i(1012),a=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.treeGridData=e.getGanttData()}return e=l([o.Component({selector:"ej-app",template:i(1949),styles:[i(1021)],providers:[r.GanttDataService]}),n("design:paramtypes",[r.GanttDataService])],e)}();t.DefaultComponent=a},1452:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var n,o=arguments.length,r=o<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(5),r=i(1012),a=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.treeGridData=e.getGanttData(),this.editsettings={allowAdding:!0,allowEditing:!0,allowDeleting:!0},this.toolbarsettings={showToolbar:!0,toolbarItems:["add","edit","delete","update","cancel","expandAll","collapseAll"]}}return e=l([o.Component({selector:"ej-app",template:i(1950),styles:[i(1021)],providers:[r.GanttDataService]}),n("design:paramtypes",[r.GanttDataService])],e)}();t.EditingComponent=a},1453:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var n,o=arguments.length,r=o<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var o=i(5),r=i(1012),a=function(){function e(e){this.ganttDataService=e,this.treeColumnIndex=1,this.treeGridData=e.getGanttData()}return e=l([o.Component({selector:"ej-app",template:i(1951),styles:[i(1021)],providers:[r.GanttDataService]}),n("design:paramtypes",[r.GanttDataService])],e)}();t.PagingComponent=a},1522:function(e,t,i){"use strict";var l=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function l(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}();Object.defineProperty(t,"__esModule",{value:!0}),i(1042);var n=i(12),o=i(5),r=function(e){function t(t){var i=e.call(this,[])||this;return i.parent=t,i}return l(t,e),t.decorators=[{type:o.Directive,args:[{selector:"e-treegrid-columns>e-treegrid-column"}]}],t.ctorParameters=function(){return[{type:n.EJComponents,decorators:[{type:o.Inject,args:[o.forwardRef(function(){return d})]}]}]},t.propDecorators={allowCellSelection:[{type:o.Input,args:["allowCellSelection"]}],allowEditing:[{type:o.Input,args:["allowEditing"]}],allowFiltering:[{type:o.Input,args:["allowFiltering"]}],allowFilteringBlankContent:[{type:o.Input,args:["allowFilteringBlankContent"]}],allowFreezing:[{type:o.Input,args:["allowFreezing"]}],allowSorting:[{type:o.Input,args:["allowSorting"]}],angularTemplate:[{type:o.Input,args:["angularTemplate"]}],clipMode:[{type:o.Input,args:["clipMode"]}],commands:[{type:o.Input,args:["commands"]}],displayAsCheckbox:[{type:o.Input,args:["displayAsCheckbox"]}],dropdownData:[{type:o.Input,args:["dropdownData"]}],editParams:[{type:o.Input,args:["editParams"]}],editTemplate:[{type:o.Input,args:["editTemplate"]}],editType:[{type:o.Input,args:["editType"]}],field:[{type:o.Input,args:["field"]}],filterEditType:[{type:o.Input,args:["filterEditType"]}],filterType:[{type:o.Input,args:["filterType"]}],format:[{type:o.Input,args:["format"]}],headerTemplateID:[{type:o.Input,args:["headerTemplateID"]}],headerText:[{type:o.Input,args:["headerText"]}],headerTextAlign:[{type:o.Input,args:["headerTextAlign"]}],headerTooltip:[{type:o.Input,args:["headerTooltip"]}],isFrozen:[{type:o.Input,args:["isFrozen"]}],isTemplateColumn:[{type:o.Input,args:["isTemplateColumn"]}],priority:[{type:o.Input,args:["priority"]}],showCheckbox:[{type:o.Input,args:["showCheckbox"]}],showInColumnChooser:[{type:o.Input,args:["showInColumnChooser"]}],template:[{type:o.Input,args:["template"]}],templateID:[{type:o.Input,args:["templateID"]}],textAlign:[{type:o.Input,args:["textAlign"]}],tooltip:[{type:o.Input,args:["tooltip"]}],validationRules:[{type:o.Input,args:["validationRules"]}],visible:[{type:o.Input,args:["visible"]}],width:[{type:o.Input,args:["width"]}]},t}(n.ComplexTagElement);t.TreeGridColumnDirective=r;var a=function(e){function t(t){return e.call(this,"columns")||this}return l(t,e),t.decorators=[{type:o.Directive,args:[{selector:"ej-treegrid>e-treegrid-columns",queries:{children:new o.ContentChildren(r)}}]}],t.ctorParameters=function(){return[{type:n.EJComponents,decorators:[{type:o.Inject,args:[o.forwardRef(function(){return d})]}]}]},t}(n.ArrayTagElement);t.TreeGridColumnsDirective=a;var d=function(e){function t(t,i,l,n){var r=e.call(this,"TreeGrid",t,i,["columns"],l,n)||this;return r.el=t,r.cdRef=i,r._ejIterableDiffers=l,r._ejkeyvaluediffers=n,r.dataSource_twoChange=new o.EventEmitter,r.selectedRowIndex_twoChange=new o.EventEmitter,r.actionBegin_output=new o.EventEmitter,r.actionComplete_output=new o.EventEmitter,r.beforePrint_output=new o.EventEmitter,r.beginEdit_output=new o.EventEmitter,r.cellSelected_output=new o.EventEmitter,r.cellSelecting_output=new o.EventEmitter,r.collapsed_output=new o.EventEmitter,r.collapsing_output=new o.EventEmitter,r.columnDrag_output=new o.EventEmitter,r.columnDragStart_output=new o.EventEmitter,r.columnDrop_output=new o.EventEmitter,r.columnResizeEnd_output=new o.EventEmitter,r.columnResizeStart_output=new o.EventEmitter,r.columnResized_output=new o.EventEmitter,r.contextMenuOpen_output=new o.EventEmitter,r.create_output=new o.EventEmitter,r.detailsDataBound_output=new o.EventEmitter,r.detailsHidden_output=new o.EventEmitter,r.detailsShown_output=new o.EventEmitter,r.endEdit_output=new o.EventEmitter,r.expanded_output=new o.EventEmitter,r.expanding_output=new o.EventEmitter,r.load_output=new o.EventEmitter,r.queryCellInfo_output=new o.EventEmitter,r.recordClick_output=new o.EventEmitter,r.recordDoubleClick_output=new o.EventEmitter,r.rowDataBound_output=new o.EventEmitter,r.rowDrag_output=new o.EventEmitter,r.rowDragStart_output=new o.EventEmitter,r.rowDragStop_output=new o.EventEmitter,r.rowDropActionBegin_output=new o.EventEmitter,r.rowSelected_output=new o.EventEmitter,r.rowSelecting_output=new o.EventEmitter,r.toolbarClick_output=new o.EventEmitter,r}return l(t,e),t.decorators=[{type:o.Component,args:[{selector:"ej-treegrid",template:""}]}],t.ctorParameters=function(){return[{type:o.ElementRef},{type:o.ChangeDetectorRef},{type:o.IterableDiffers},{type:o.KeyValueDiffers}]},t.propDecorators={allowColumnReordering_input:[{type:o.Input,args:["allowColumnReordering"]}],allowColumnResize_input:[{type:o.Input,args:["allowColumnResize"]}],allowDragAndDrop_input:[{type:o.Input,args:["allowDragAndDrop"]}],allowFiltering_input:[{type:o.Input,args:["allowFiltering"]}],allowKeyboardNavigation_input:[{type:o.Input,args:["allowKeyboardNavigation"]}],allowMultiSorting_input:[{type:o.Input,args:["allowMultiSorting"]}],allowPaging_input:[{type:o.Input,args:["allowPaging"]}],allowSearching_input:[{type:o.Input,args:["allowSearching"]}],allowSelection_input:[{type:o.Input,args:["allowSelection"]}],allowSorting_input:[{type:o.Input,args:["allowSorting"]}],allowTextWrap_input:[{type:o.Input,args:["allowTextWrap"]}],altRowTemplateID_input:[{type:o.Input,args:["altRowTemplateID"]}],cellTooltipTemplate_input:[{type:o.Input,args:["cellTooltipTemplate"]}],childMapping_input:[{type:o.Input,args:["childMapping"]}],collapsibleTotalSummary_input:[{type:o.Input,args:["collapsibleTotalSummary"]}],columnDialogFields_input:[{type:o.Input,args:["columnDialogFields"]}],columnResizeSettings_input:[{type:o.Input,args:["columnResizeSettings"]}],commonWidth_input:[{type:o.Input,args:["commonWidth"]}],contextMenuSettings_input:[{type:o.Input,args:["contextMenuSettings"]}],cssClass_input:[{type:o.Input,args:["cssClass"]}],detailsTemplate_input:[{type:o.Input,args:["detailsTemplate"]}],detailsRowHeight_input:[{type:o.Input,args:["detailsRowHeight"]}],dragTooltip_input:[{type:o.Input,args:["dragTooltip"]}],editSettings_input:[{type:o.Input,args:["editSettings"]}],enableAltRow_input:[{type:o.Input,args:["enableAltRow"]}],enableCollapseAll_input:[{type:o.Input,args:["enableCollapseAll"]}],enableLoadOnDemand_input:[{type:o.Input,args:["enableLoadOnDemand"]}],enableResize_input:[{type:o.Input,args:["enableResize"]}],enableVirtualization_input:[{type:o.Input,args:["enableVirtualization"]}],expandStateMapping_input:[{type:o.Input,args:["expandStateMapping"]}],filterSettings_input:[{type:o.Input,args:["filterSettings"]}],headerTextOverflow_input:[{type:o.Input,args:["headerTextOverflow"]}],idMapping_input:[{type:o.Input,args:["idMapping"]}],isResponsive_input:[{type:o.Input,args:["isResponsive"]}],locale_input:[{type:o.Input,args:["locale"]}],pageSettings_input:[{type:o.Input,args:["pageSettings"]}],parentIdMapping_input:[{type:o.Input,args:["parentIdMapping"]}],parseRowTemplate_input:[{type:o.Input,args:["parseRowTemplate"]}],query_input:[{type:o.Input,args:["query"]}],rowHeight_input:[{type:o.Input,args:["rowHeight"]}],rowTemplateID_input:[{type:o.Input,args:["rowTemplateID"]}],searchSettings_input:[{type:o.Input,args:["searchSettings"]}],selectionSettings_input:[{type:o.Input,args:["selectionSettings"]}],showColumnChooser_input:[{type:o.Input,args:["showColumnChooser"]}],showColumnOptions_input:[{type:o.Input,args:["showColumnOptions"]}],showDetailsRow_input:[{type:o.Input,args:["showDetailsRow"]}],showDetailsRowInfoColumn_input:[{type:o.Input,args:["showDetailsRowInfoColumn"]}],showGridCellTooltip_input:[{type:o.Input,args:["showGridCellTooltip"]}],showGridExpandCellTooltip_input:[{type:o.Input,args:["showGridExpandCellTooltip"]}],showStackedHeader_input:[{type:o.Input,args:["showStackedHeader"]}],showSummaryRow_input:[{type:o.Input,args:["showSummaryRow"]}],showTotalSummary_input:[{type:o.Input,args:["showTotalSummary"]}],sizeSettings_input:[{type:o.Input,args:["sizeSettings"]}],sortSettings_input:[{type:o.Input,args:["sortSettings"]}],toolbarSettings_input:[{type:o.Input,args:["toolbarSettings"]}],totalSummaryHeight_input:[{type:o.Input,args:["totalSummaryHeight"]}],treeColumnIndex_input:[{type:o.Input,args:["treeColumnIndex"]}],columnResizeSettings_columnResizeMode_input:[{type:o.Input,args:["columnResizeSettings.columnResizeMode"]}],contextMenuSettings_contextMenuItems_input:[{type:o.Input,args:["contextMenuSettings.contextMenuItems"]}],contextMenuSettings_showContextMenu_input:[{type:o.Input,args:["contextMenuSettings.showContextMenu"]}],dragTooltip_showTooltip_input:[{type:o.Input,args:["dragTooltip.showTooltip"]}],dragTooltip_tooltipItems_input:[{type:o.Input,args:["dragTooltip.tooltipItems"]}],dragTooltip_tooltipTemplate_input:[{type:o.Input,args:["dragTooltip.tooltipTemplate"]}],editSettings_allowAdding_input:[{type:o.Input,args:["editSettings.allowAdding"]}],editSettings_allowDeleting_input:[{type:o.Input,args:["editSettings.allowDeleting"]}],editSettings_allowEditing_input:[{type:o.Input,args:["editSettings.allowEditing"]}],editSettings_batchEditSettings_input:[{type:o.Input,args:["editSettings.batchEditSettings"]}],editSettings_batchEditSettings_editMode_input:[{type:o.Input,args:["editSettings.batchEditSettings.editMode"]}],editSettings_beginEditAction_input:[{type:o.Input,args:["editSettings.beginEditAction"]}],editSettings_dialogEditorTemplateID_input:[{type:o.Input,args:["editSettings.dialogEditorTemplateID"]}],editSettings_editMode_input:[{type:o.Input,args:["editSettings.editMode"]}],editSettings_rowPosition_input:[{type:o.Input,args:["editSettings.rowPosition"]}],editSettings_showDeleteConfirmDialog_input:[{type:o.Input,args:["editSettings.showDeleteConfirmDialog"]}],filterSettings_enableCaseSensitivity_input:[{type:o.Input,args:["filterSettings.enableCaseSensitivity"]}],filterSettings_enableComplexBlankFilter_input:[{type:o.Input,args:["filterSettings.enableComplexBlankFilter"]}],filterSettings_filterBarMode_input:[{type:o.Input,args:["filterSettings.filterBarMode"]}],filterSettings_filterHierarchyMode_input:[{type:o.Input,args:["filterSettings.filterHierarchyMode"]}],filterSettings_filterType_input:[{type:o.Input,args:["filterSettings.filterType"]}],filterSettings_maxFilterChoices_input:[{type:o.Input,args:["filterSettings.maxFilterChoices"]}],pageSettings_currentPage_input:[{type:o.Input,args:["pageSettings.currentPage"]}],pageSettings_pageCount_input:[{type:o.Input,args:["pageSettings.pageCount"]}],pageSettings_pageSize_input:[{type:o.Input,args:["pageSettings.pageSize"]}],pageSettings_pageSizeMode_input:[{type:o.Input,args:["pageSettings.pageSizeMode"]}],pageSettings_printMode_input:[{type:o.Input,args:["pageSettings.printMode"]}],pageSettings_template_input:[{type:o.Input,args:["pageSettings.template"]}],pageSettings_totalRecordsCount_input:[{type:o.Input,args:["pageSettings.totalRecordsCount"]}],searchSettings_fields_input:[{type:o.Input,args:["searchSettings.fields"]}],searchSettings_ignoreCase_input:[{type:o.Input,args:["searchSettings.ignoreCase"]}],searchSettings_key_input:[{type:o.Input,args:["searchSettings.key"]}],searchSettings_operator_input:[{type:o.Input,args:["searchSettings.operator"]}],searchSettings_searchHierarchyMode_input:[{type:o.Input,args:["searchSettings.searchHierarchyMode"]}],selectionSettings_enableHierarchySelection_input:[{type:o.Input,args:["selectionSettings.enableHierarchySelection"]}],selectionSettings_enableSelectAll_input:[{type:o.Input,args:["selectionSettings.enableSelectAll"]}],selectionSettings_selectionMode_input:[{type:o.Input,args:["selectionSettings.selectionMode"]}],selectionSettings_selectionType_input:[{type:o.Input,args:["selectionSettings.selectionType"]}],sizeSettings_height_input:[{type:o.Input,args:["sizeSettings.height"]}],sizeSettings_width_input:[{type:o.Input,args:["sizeSettings.width"]}],toolbarSettings_showToolbar_input:[{type:o.Input,args:["toolbarSettings.showToolbar"]}],toolbarSettings_toolbarItems_input:[{type:o.Input,args:["toolbarSettings.toolbarItems"]}],columns_input:[{type:o.Input,args:["columns"]}],selectedCellIndexes_input:[{type:o.Input,args:["selectedCellIndexes"]}],stackedHeaderRows_input:[{type:o.Input,args:["stackedHeaderRows"]}],summaryRows_input:[{type:o.Input,args:["summaryRows"]}],filterSettings_filteredColumns_input:[{type:o.Input,args:["filterSettings.filteredColumns"]}],sortSettings_sortedColumns_input:[{type:o.Input,args:["sortSettings.sortedColumns"]}],toolbarSettings_customToolbarItems_input:[{type:o.Input,args:["toolbarSettings.customToolbarItems"]}],options:[{type:o.Input,args:["options"]}],dataSource_two:[{type:o.Input,args:["dataSource"]}],dataSource_twoChange:[{type:o.Output,args:["dataSourceChange"]}],selectedRowIndex_two:[{type:o.Input,args:["selectedRowIndex"]}],selectedRowIndex_twoChange:[{type:o.Output,args:["selectedRowIndexChange"]}],actionBegin_output:[{type:o.Output,args:["actionBegin"]}],actionComplete_output:[{type:o.Output,args:["actionComplete"]}],beforePrint_output:[{type:o.Output,args:["beforePrint"]}],beginEdit_output:[{type:o.Output,args:["beginEdit"]}],cellSelected_output:[{type:o.Output,args:["cellSelected"]}],cellSelecting_output:[{type:o.Output,args:["cellSelecting"]}],collapsed_output:[{type:o.Output,args:["collapsed"]}],collapsing_output:[{type:o.Output,args:["collapsing"]}],columnDrag_output:[{type:o.Output,args:["columnDrag"]}],columnDragStart_output:[{type:o.Output,args:["columnDragStart"]}],columnDrop_output:[{type:o.Output,args:["columnDrop"]}],columnResizeEnd_output:[{type:o.Output,args:["columnResizeEnd"]}],columnResizeStart_output:[{type:o.Output,args:["columnResizeStart"]}],columnResized_output:[{type:o.Output,args:["columnResized"]}],contextMenuOpen_output:[{type:o.Output,args:["contextMenuOpen"]}],create_output:[{type:o.Output,args:["create"]}],detailsDataBound_output:[{type:o.Output,args:["detailsDataBound"]}],detailsHidden_output:[{type:o.Output,args:["detailsHidden"]}],detailsShown_output:[{type:o.Output,args:["detailsShown"]}],endEdit_output:[{type:o.Output,args:["endEdit"]}],expanded_output:[{type:o.Output,args:["expanded"]}],expanding_output:[{type:o.Output,args:["expanding"]}],load_output:[{type:o.Output,args:["load"]}],queryCellInfo_output:[{type:o.Output,args:["queryCellInfo"]}],recordClick_output:[{type:o.Output,args:["recordClick"]}],recordDoubleClick_output:[{type:o.Output,args:["recordDoubleClick"]}],rowDataBound_output:[{type:o.Output,args:["rowDataBound"]}],rowDrag_output:[{type:o.Output,args:["rowDrag"]}],rowDragStart_output:[{type:o.Output,args:["rowDragStart"]}],rowDragStop_output:[{type:o.Output,args:["rowDragStop"]}],rowDropActionBegin_output:[{type:o.Output,args:["rowDropActionBegin"]}],rowSelected_output:[{type:o.Output,args:["rowSelected"]}],rowSelecting_output:[{type:o.Output,args:["rowSelecting"]}],toolbarClick_output:[{type:o.Output,args:["toolbarClick"]}],tag_columns:[{type:o.ContentChild,args:[a]}]},t}(n.EJComponents);t.TreeGridComponent=d,t.EJ_TREEGRID_COMPONENTS=[d,a,r]},1947:function(e,t){e.exports='<ej-treegrid id="TreeGridControl" [selectionSettings]="selection" [dataSource]="treeGridData" childMapping="subtasks" [treeColumnIndex]=treeColumnIndex sizeSettings.height="400px"\r\n    sizeSettings.width="100%">\r\n    <e-treegrid-columns>\r\n        <e-treegrid-column field="taskID" headerText="Task ID"></e-treegrid-column>\r\n        <e-treegrid-column field="taskName" headerText="TaskName" [showCheckbox]= "true"></e-treegrid-column>\r\n        <e-treegrid-column field="startDate" headerText="Start Date"></e-treegrid-column>\r\n        <e-treegrid-column field="endDate" headerText="End Date"></e-treegrid-column>\r\n        <e-treegrid-column field="duration" headerText="Duration"></e-treegrid-column>\r\n        <e-treegrid-column field="progress" headerText="Progress"></e-treegrid-column>\r\n    </e-treegrid-columns>\r\n</ej-treegrid>'},1948:function(e,t){e.exports='<ej-treegrid id="TreeGridControl" [allowColumnReordering]="true" [dataSource]="treeGridData" childMapping="subtasks" [treeColumnIndex]=treeColumnIndex sizeSettings.height="400px"\r\n    sizeSettings.width="100%">\r\n    <e-treegrid-columns>\r\n        <e-treegrid-column field="taskID" headerText="Task ID"></e-treegrid-column>\r\n        <e-treegrid-column field="taskName" headerText="TaskName"></e-treegrid-column>\r\n        <e-treegrid-column field="startDate" headerText="Start Date"></e-treegrid-column>\r\n        <e-treegrid-column field="endDate" headerText="End Date"></e-treegrid-column>\r\n        <e-treegrid-column field="progress" headerText="Progress">   \r\n        </e-treegrid-column>\r\n    </e-treegrid-columns>\r\n</ej-treegrid>'},1949:function(e,t){e.exports='<ej-treegrid id="TreeGridControl" [dataSource]="treeGridData" childMapping="subtasks" [treeColumnIndex]=treeColumnIndex sizeSettings.height="400px"\r\n    sizeSettings.width="100%">\r\n    <e-treegrid-columns>\r\n        <e-treegrid-column field="taskID" headerText="Task ID"></e-treegrid-column>\r\n        <e-treegrid-column field="taskName" headerText="TaskName"></e-treegrid-column>\r\n        <e-treegrid-column field="startDate" headerText="Start Date"></e-treegrid-column>\r\n        <e-treegrid-column field="endDate" headerText="End Date"></e-treegrid-column>\r\n        <e-treegrid-column field="duration" headerText="Duration"></e-treegrid-column>\r\n        <e-treegrid-column field="progress" headerText="Progress"></e-treegrid-column>\r\n    </e-treegrid-columns>\r\n</ej-treegrid>'},1950:function(e,t){e.exports='<ej-treegrid id="TreeGridControl" [dataSource]="treeGridData" \r\nchildMapping="subtasks" \r\n[treeColumnIndex]=treeColumnIndex \r\nsizeSettings.height="400px"\r\n[editSettings]="editsettings"\r\n[toolbarSettings]="toolbarsettings"\r\n    sizeSettings.width="100%">\r\n    <e-treegrid-columns>\r\n        <e-treegrid-column field="taskID" headerText="Task ID" editType="numericedit"></e-treegrid-column>\r\n        <e-treegrid-column field="taskName" headerText="TaskName"></e-treegrid-column>\r\n        <e-treegrid-column field="startDate" headerText="Start Date" editType="datepicker"></e-treegrid-column>\r\n        <e-treegrid-column field="endDate" headerText="End Date" editType="datepicker"></e-treegrid-column>\r\n        <e-treegrid-column field="duration" headerText="Duration" editType="numericedit"></e-treegrid-column>\r\n        <e-treegrid-column field="progress" headerText="Progress" editType="numericedit"></e-treegrid-column>\r\n    </e-treegrid-columns>\r\n</ej-treegrid>'},1951:function(e,t){e.exports='<ej-treegrid id="TreeGridControl" [allowPaging] ="true" [dataSource]="treeGridData" childMapping="subtasks" [treeColumnIndex]=treeColumnIndex sizeSettings.height="400px"\r\n    sizeSettings.width="100%">\r\n    <e-treegrid-columns>\r\n        <e-treegrid-column field="taskID" headerText="Task ID"></e-treegrid-column>\r\n        <e-treegrid-column field="taskName" headerText="TaskName" ></e-treegrid-column>\r\n        <e-treegrid-column field="startDate" headerText="Start Date"></e-treegrid-column>\r\n        <e-treegrid-column field="endDate" headerText="End Date"></e-treegrid-column>\r\n        <e-treegrid-column field="progress" headerText="Progress">   \r\n        </e-treegrid-column>\r\n    </e-treegrid-columns>\r\n</ej-treegrid>'},478:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var n,o=arguments.length,r=o<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,l);else for(var a=e.length-1;a>=0;a--)(n=e[a])&&(r=(o<3?n(r):o>3?n(t,i,r):n(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),o=i(78),r=i(1522),a=i(1451),d=i(1452),s=i(1453),c=i(1450),u=i(1449);t.treegridAppRoutes=[{path:"default",component:a.DefaultComponent,data:{name:"Default",location:"app/components/treegrid/default.component"}},{path:"editing",component:d.EditingComponent,data:{name:"Editing",location:"app/components/treegrid/editing.component"}},{path:"paging",component:s.PagingComponent,data:{name:"Paging",location:"app/components/treegrid/paging.component"}},{path:"columnreorder",component:c.ColumnReorderComponent,data:{name:"Column Reorder",location:"app/components/treegrid/columnreorder.component"}},{path:"checkboxselection",component:u.CheckboxSelectionComponent,data:{name:"Checkbox Selection",location:"app/components/treegrid/checkboxselection.component"}},{path:"",redirectTo:"default"}],t.TreeGridRouting=o.RouterModule.forChild(t.treegridAppRoutes);var g=function(){function e(){}return e=l([n.NgModule({imports:[t.TreeGridRouting],declarations:[a.DefaultComponent,r.EJ_TREEGRID_COMPONENTS,d.EditingComponent,s.PagingComponent,c.ColumnReorderComponent,u.CheckboxSelectionComponent]})],e)}();t.TreeGridModule=g}});