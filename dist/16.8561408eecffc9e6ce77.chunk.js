webpackJsonp([16],{1007:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(){}return e.prototype.pivot_data=function(){return[{Amount:100,Country:"Canada",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Alberta"},{Amount:200,Country:"Canada",Date:"FY 2006",Product:"Van",Quantity:3,State:"British Columbia"},{Amount:300,Country:"Canada",Date:"FY 2007",Product:"Car",Quantity:4,State:"Brunswick"},{Amount:150,Country:"Canada",Date:"FY 2008",Product:"Bike",Quantity:3,State:"Manitoba"},{Amount:200,Country:"Canada",Date:"FY 2006",Product:"Car",Quantity:4,State:"Ontario"},{Amount:100,Country:"Canada",Date:"FY 2007",Product:"Van",Quantity:1,State:"Quebec"},{Amount:200,Country:"France",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Charente-Maritime"},{Amount:250,Country:"France",Date:"FY 2006",Product:"Van",Quantity:4,State:"Essonne"},{Amount:300,Country:"France",Date:"FY 2007",Product:"Car",Quantity:3,State:"Garonne (Haute)"},{Amount:150,Country:"France",Date:"FY 2008",Product:"Van",Quantity:2,State:"Gers"},{Amount:200,Country:"Germany",Date:"FY 2006",Product:"Van",Quantity:3,State:"Bayern"},{Amount:250,Country:"Germany",Date:"FY 2007",Product:"Car",Quantity:3,State:"Brandenburg"},{Amount:150,Country:"Germany",Date:"FY 2008",Product:"Car",Quantity:4,State:"Hamburg"},{Amount:200,Country:"Germany",Date:"FY 2008",Product:"Bike",Quantity:4,State:"Hessen"},{Amount:150,Country:"Germany",Date:"FY 2007",Product:"Van",Quantity:3,State:"Nordrhein-Westfalen"},{Amount:100,Country:"Germany",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Saarland"},{Amount:150,Country:"United Kingdom",Date:"FY 2008",Product:"Bike",Quantity:5,State:"England"},{Amount:250,Country:"United States",Date:"FY 2007",Product:"Car",Quantity:4,State:"Alabama"},{Amount:200,Country:"United States",Date:"FY 2005",Product:"Van",Quantity:4,State:"California"},{Amount:100,Country:"United States",Date:"FY 2006",Product:"Bike",Quantity:2,State:"Colorado"},{Amount:150,Country:"United States",Date:"FY 2008",Product:"Car",Quantity:3,State:"New Mexico"},{Amount:200,Country:"United States",Date:"FY 2005",Product:"Bike",Quantity:4,State:"New York"},{Amount:250,Country:"United States",Date:"FY 2008",Product:"Car",Quantity:3,State:"North Carolina"},{Amount:300,Country:"United States",Date:"FY 2007",Product:"Van",Quantity:4,State:"South Carolina"}]},e.prototype.pivot_rows=function(){return[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}]},e.prototype.pivot_columns=function(){return[{fieldName:"Product",fieldCaption:"Product"}]},e.prototype.pivot_values=function(){return[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}]},e.prototype.pivot_chartvalues=function(){return[{fieldName:"Amount",fieldCaption:"Amount"}]},e.prototype.pivot_Olaprows=function(){return[{fieldName:"[Date].[Fiscal]"}]},e.prototype.pivot_namedsetrows=function(){return[{fieldName:"[Core Product Group]",isNamedSets:!0}]},e.prototype.pivot_gaugerows=function(){return[{fieldName:"[Date].[Fiscal]",filterItems:{filterType:"include",values:["[Date].[Fiscal].[Fiscal Year].&amp;[2004]"]}}]},e.prototype.pivot_gaugecolumns=function(){return[{fieldName:"[Customer].[Customer Geography]",filterItems:{filterType:"include",values:["[Customer].[Customer Geography].[Country].&amp;[Australia]"]}}]},e.prototype.pivot_Olapcolumns=function(){return[{fieldName:"[Customer].[Customer Geography]"}]},e.prototype.pivot_Olapvalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}]},e.prototype.pivot_MultipleAxesvalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"},{fieldName:"[Measures].[Customer Count]"}],axis:"columns"}]},e.prototype.pivot_gaugevalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"},{fieldName:"[Measures].[Internet Revenue Status]"},{fieldName:"[Measures].[Internet Revenue Trend]"},{fieldName:"[Measures].[Internet Revenue Goal]"}],axis:"columns"}]},e.prototype.pivot_Olapfilters=function(){return[]},e.prototype.pivot_cube=function(){return"Adventure Works"},e.prototype.pivot_datacube=function(){return"//bi.syncfusion.com/olap/msmdpump.dll"},e.prototype.pivot_catelog=function(){return"Adventure Works DW 2008 SE"},e.prototype.size=function(){return{height:"460px",width:"950px"}},e.prototype.primaryYAxis=function(){return{title:{text:"Amount"}}},e.prototype.primaryYAxisOlap=function(){return{title:{text:"Customer Count"}}},e.prototype.primaryXAxis=function(){return{title:{text:"Fiscal Year"},labelRotation:0}},e.prototype.legend=function(){return{visible:!0}},e.prototype.commonSeriesOptions=function(){return{enableAnimation:!0,type:ej.PivotChart.ChartTypes.Column,tooltip:{visible:!0}}},e.prototype.zooming=function(){return{enableScrollbar:!0}},e.prototype.axes=function(){return[{orientation:"vertical",rowIndex:0,majorGridLines:{visible:!1},axisLine:{visible:!0},name:"yAxisConfig",title:{text:"Internet Sales Amount"},opposedPosition:!0,labelFormat:"c"}]},e.prototype.scales=function(){return[{showRanges:!0,radius:150,showScaleBar:!0,size:1,border:{width:.5},showIndicators:!0,showLabels:!0,pointers:[{showBackNeedle:!0,backNeedleLength:20,length:120,width:7},{type:"marker",markerType:"diamond",distanceFromScale:5,placement:"center",backgroundColor:"#29A4D9",length:25,width:15}],ticks:[{type:"major",distanceFromScale:2,height:16,width:1,color:"#8c8c8c"},{type:"minor",height:6,width:1,distanceFromScale:2,color:"#8c8c8c"}],labels:[{color:"#8c8c8c"}],ranges:[{distanceFromScale:-5,backgroundColor:"#fc0606",border:{color:"#fc0606"}},{distanceFromScale:-5}],customLabels:[{position:{x:180,y:290},font:{size:"10px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"},{position:{x:180,y:320},font:{size:"10px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"},{position:{x:180,y:150},font:{size:"12px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"}]}]},e}();t.PivotDataService=a},1009:function(e,t,i){var a,l,r;
/*!
*  filename: ej.olap.base.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.olap.base.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(n){l=[i(4)],void 0===(r="function"==typeof(a=n)?a.apply(t,l):a)||(e.exports=r)}(function(){!function(e,t,i){t.olap=t.olap||{},t.olap.base={_initProperties:function(){this._columnHeaders=[],this._rowHeaders=[],this._valueCells=[],this.pivotEngine=[],this.olapCtrlObj=null,this._cBIndx=null,this._rBIndx=null,this._OlapDataSource,this._measureDt={},this._cTotIndexInfo=null,this._rTotIndexInfo=null,this._kpi=null,this._rowCount=0,this._colCount=0,this._isPaging=!1,this._indexRCell=0,this._indexCCell=0},_initControlProperties:function(e){e._drilledCellSet=e.model.enablePaging||e.model.enableVirtualScrolling?t.isNullOrUndefined(e._drilledCellSet)?[]:e._drilledCellSet:[],e.XMLACellSet=null,e._isMondrian=e.model.dataSource.providerName==t.olap.Providers.Mondrian,(t.isNullOrUndefined(e._fieldData)||!t.isNullOrUndefined(e._fieldData)&&t.isNullOrUndefined(e._fieldData.hierarchy))&&this._getFieldItemsInfo(e),this._currIndex={},this._isRowDrilled=!1,this._isColDrilled=!1,this._isNoSummary="nosummaries"==e.model.layout},getJSONData:function(i,a,l){var r,n,s;i.action&&("initialLoad"==i.action||"navPaging"==i.action)&&(this._initControlProperties(l),this._applyTrim(l)),"loadFieldElements"==i.action&&(l._baseSavedProperties=e.extend(!0,{},{drilledCellSet:l._drilledCellSet,XMLACellSet:l.XMLACellSet,columnHeaders:this._columnHeaders,rowHeaders:this._rowHeaders,valueCells:this._valueCells,pivotEngine:this.pivotEngine,olapCtrlObj:this.olapCtrlObj,cBIndx:this._cBIndx,rBIndx:this._rBIndx,OlapDataSource:this._OlapDataSource,measureDt:this._measureDt,cTotIndexInfo:this._cTotIndexInfo,rTotIndexInfo:this._rTotIndexInfo,kpi:this._kpi,rowCount:this._rowCount,colCount:this._colCount,isPaging:this._isPaging,indexRCell:this._indexRCell,indexCCell:this._indexCCell})),this._initProperties(),this.olapCtrlObj=l,this._OlapDataSource=a,a.data,l.model.enableGroupingBar&&"loadFieldElements"!=i.action&&l._createGroupingBar(a),this._isPaging=!(!this.olapCtrlObj.model.enablePaging&&!this.olapCtrlObj.model.enableVirtualScrolling||t.isNullOrUndefined(this._OlapDataSource.pagerOptions)||0==this._OlapDataSource.pagerOptions.categoricalPageSize||0==this._OlapDataSource.pagerOptions.seriesPageSize),r=a.MDXQuery?a.MDXQuery:this._getParsedMDX(a,a.cube,!(!i.action||"navPaging"==i.action||!this._isPaging||t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions))),s=this._getConnectionInfo(this.olapCtrlObj.model.dataSource.data),n=t.isNullOrUndefined(a.providerName)||a.providerName==t.olap.Providers.SSAS?'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+r+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+a.catalog+"</Catalog> <LocaleIdentifier>"+s.LCID+"</LocaleIdentifier> </PropertyList> </Properties></Execute> </Body> </Envelope>":'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+r+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+a.sourceInfo+"</DataSourceInfo><Catalog>"+a.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>","drilldown"!=i.action||this._isPaging?this.olapCtrlObj.doAjaxPost("POST",s.url,{XMLA:n},i.action&&"navPaging"!=i.action&&this._isPaging&&!t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)?this._generatePagingData:this._generateJSONData,null,i):this.olapCtrlObj.doAjaxPost("POST",s.url,{XMLA:n},this._onDemandExpand,null,i)},_getParsedMDX:function(e,a,l){var r,n,s,o,d,u;if(e!=i){if(r="",(d=e.providerName==t.olap.Providers.Mondrian)&&0==e.columns.length&&!("columns"==e.values[0].axis&&e.values[0].measures.length>0))return"";n=t.olap._mdxParser._getRowMDX(e),s=t.olap._mdxParser._getcolumnMDX(e),delete e._isCollapse,n=n.length>0?this._isPaging&&!l||d?"("+n+")":"NON EMPTY("+n+")":"",s=s.length>0?this._isPaging&&!l||d?"("+s+")":"NON EMPTY("+s+")":"",!this._isPaging||l||t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)||(n=(u=this._getPagingQuery(n,s)).rowQuery,s=u.columnQuery),o=t.olap._mdxParser._getSlicerMDX(e,this.olapCtrlObj),r="\nSelect \n"+(""==s?"{}":s)+"\ndimension properties MEMBER_TYPE,CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME  ON COLUMNS \n"+(""==n?"":","+n+"\ndimension properties MEMBER_TYPE,CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME  ON ROWS")+"\n "+t.olap._mdxParser._getIncludefilterQuery(e,a,this.olapCtrlObj)+o+"\n CELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE \n ",""==s&&r.replace(/NON EMPTY/g," "),r=this._getCalculatedItems(r)}return r},_getCalculatedItems:function(i){var a,l,r=this.olapCtrlObj.model.calculatedMembers;if(r&&r.length>0){for(a="\nWITH",l=0;l<r.length;l++){var n=(r[l].expression.indexOf("Measure")>-1?"[Measures].":r[l].hierarchyUniqueName+".")+"["+(r[l].caption||r[l].name)+"]",s=t.isNullOrUndefined(r[l].formatString)?t.isNullOrUndefined(r[l].format)?null:r[l].format:r[l].formatString;a+="\n MEMBER "+n+" as ("+r[l].expression+" ) "+(t.isNullOrUndefined(s)?"":', FORMAT_STRING ="'+e.trim(s)+'"')}return(a=a.replace(/\&/g,"&amp;"))+" "+i}return i},_getPagingQuery:function(e,t){var i=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj._categCurrentPage)&&this._colCount>0?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize):this.olapCtrlObj._categCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage),a=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj._seriesCurrentPage)&&this._rowCount>0?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize):this.olapCtrlObj._seriesCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage),l=e;return{rowQuery:""!=e?"SUBSET({"+(this.olapCtrlObj._isMondrian?"":"NONEMPTY")+"("+e+(this.olapCtrlObj._isMondrian||""==t?"":","+t)+")},"+((0==a?1:a)-1)*this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize+","+this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize+")":"",columnQuery:""!=t?"SUBSET({"+(this.olapCtrlObj._isMondrian?"":"NONEMPTY")+"("+t+(this.olapCtrlObj._isMondrian||""==l?"":","+l)+")},"+((0==i?1:i)-1)*this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize+","+this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize+")":""}},_getAxisElementsUName:function(e){for(var t="",i=0;i<e.length;i++)t+=""==t?"{"+e[i].uniqueName+"}":", {"+e[i].uniqueName+"}";return t},_generatePagingData:function(i,a){var l,r,n;if(e(a).find("Error").length>0)return t.Pivot._createErrorDialog(e(a).find("faultstring").text(),i.action,this.olapCtrlObj),!1;l=e(a).find("Axes, CellData"),this._rowCount=e(l.find("Axis[name|='Axis1']").find("Tuples")).length>0?e(l.find("Axis[name|='Axis1']").find("Tuples")[0]).children().length:0,this._colCount=e(l.find("Axis[name|='Axis0']").find("Tuples")).length>0?e(l.find("Axis[name|='Axis0']").find("Tuples")[0]).children().length:0,r=this._getParsedMDX(this.olapCtrlObj.model.dataSource,this.olapCtrlObj.model.dataSource.cube,!1),n=this._getConnectionInfo(this.olapCtrlObj.model.dataSource.data),this.olapCtrlObj._isMondrian&&(this._controlObj=this.olapCtrlObj),this.olapCtrlObj.doAjaxPost("POST",n.url,{XMLA:t.olap._mdxParser.getSoapMsg(r,this.olapCtrlObj.model.dataSource.data,this.olapCtrlObj.model.dataSource.catalog)},this._generateJSONData,null,i)},_generateJSONData:function(a,l){var r,n,s,o,d,u,c,p,m,h,g,f,_;if(this.olapCtrlObj.model.dataSource=this._OlapDataSource,this._isPaging&&"drilldown"==a.action&&this._onDemandExpand(a,l),r=[],n=[],e(l).find("Error").length>0)return t.Pivot._createErrorDialog(e(l).find("faultstring").text(),"Error",this.olapCtrlObj),!1;if(e(l).find("Axis[name|='SlicerAxis']").remove(),this.olapCtrlObj.XMLACellSet=e(l).find("Axes, CellData"),[],"onDemandDrill"==a&&(this.olapCtrlObj.XMLACellSet=l),s=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"),o=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple"),s.length>0){if(d=e(this.olapCtrlObj.XMLACellSet[1]).children(),this._rowHeaders=this._getHeaderCollection(o,"rowheader"),this._columnHeaders=this._getHeaderCollection(s,"colheader"),this._valueCells=this._getValueCells(d,s.length),this._indexRCell="rowheader"==this._measureDt.axis?t.sum(this._rowHeaders.maxLvlLen)+1:t.sum(this._rowHeaders.maxLvlLen),this._indexCCell="colheader"==this._measureDt.axis?t.sum(this._columnHeaders.maxLvlLen)+1:t.sum(this._columnHeaders.maxLvlLen),this._rowHeaders.headers.length>0&&0==t.sum(this._rowHeaders.maxLvlLen)&&(this._indexRCell=this._rowHeaders.headers[0].length),this._columnHeaders.headers.length>0&&0==t.sum(this._columnHeaders.maxLvlLen)&&(this._indexCCell=this._columnHeaders.headers[0].length),this._isPaging)for(g=0;g<this._rowHeaders.headers.length;g++)for(_=0;_<this._columnHeaders.headers.length;_++)t.isNullOrUndefined(this._valueCells[g])?(this._valueCells[g]=[],this._valueCells[g][_]={FormatString:"#,#",Value:""}):t.isNullOrUndefined(this._valueCells[g][_])&&(this._valueCells[g][_]={FormatString:"#,#",Value:""});for(this._populateEngine(this._rowHeaders.headers,this._columnHeaders.headers,this._valueCells),e(this.olapCtrlObj).find(".e-pivotGridTable").remove(),this.olapCtrlObj._measureDt=this._measureDt,u=this._rowHeaders.headers.length+this._indexCCell,c=this._columnHeaders.headers.length+this._indexRCell,this.pivotEngine.length>1&&(u=this.pivotEngine.length),g=0;g<u;g++)for(_=0;_<c;_++)r[_]==i&&(r[_]=[]),this.pivotEngine[g]!=i&&this.pivotEngine[g][_]!=i?(r[_][g]={Index:_+","+g,CSS:""==this.pivotEngine[g][_].CSS?"none":this.pivotEngine[g][_].CSS==i?"value":this.pivotEngine[g][_].CSS,Value:this.pivotEngine[g][_].Value,State:this.pivotEngine[g][_].ChildCount>0?2:this.pivotEngine[g][_].ChildCount<0?1:0,RowSpan:this.pivotEngine[g][_].RowSpan!=i?this.pivotEngine[g][_].RowSpan:1,ColSpan:this.pivotEngine[g][_].ColSpan!=i?this.pivotEngine[g][_].ColSpan:1,Info:this.pivotEngine[g][_].UName+"::"+this.pivotEngine[g][_].LName+"::"+this.pivotEngine[g][_].Value+"::"+this.pivotEngine[g][_].PUName,Span:"Block"==this.pivotEngine[g][_].Span?"Block":"None",Expander:1},this.pivotEngine[g][_].kpiInfo&&(r[_][g].kpi=this.pivotEngine[g][_].kpi,r[_][g].kpiInfo=this.pivotEngine[g][_].kpiInfo),this.pivotEngine[g][_].ActualValue&&(r[_][g].ActualValue=this.pivotEngine[g][_].ActualValue,r[_][g].Format=this.pivotEngine[g][_].FormatString)):this.pivotEngine[g]!=i&&(p="none",g<this._indexCCell&&_<this._indexRCell&&(p="rowheader"),r[_][g]={Index:_+","+g,CSS:p,Value:"",State:0,RowSpan:1,ColSpan:1,Info:"",Span:"Block",Expander:0});for(g=0;g<c;g++)for(_=0;_<u;_++)r[g]!=i&&r[g][_]!=i&&n.push(r[g][_]);for(m=0,h=0;h<n.length&&0==parseInt(n[h].Index.split(",")[0]);h++)m++}if(this.olapCtrlObj._isExporting&&this.olapCtrlObj.model.enableCompleteDataExport){for(_=0;_<this._indexRCell;_++)for(f="",g=this._indexCCell;g<r[0].length;g++)""!=r[_][g].Info&&(f==r[_][g].Info?r[_][g].Span="Block":f=r[_][g].Info);for(g=0;g<this._indexCCell;g++)for(f="",_=this._indexRCell;_<r.length;_++)""!=r[_][g].Info&&(f==r[_][g].Info?r[_][g].Span="Block":f=r[_][g].Info);this.olapCtrlObj._fullExportedData={jsonObj:n,tranposeEngine:r,rowCount:m},this.olapCtrlObj._drilledCellSet=this.olapCtrlObj._baseSavedProperties.drilledCellSet,this.olapCtrlObj.XMLACellSet=this.olapCtrlObj._baseSavedProperties.XMLACellSet,this._columnHeaders=this.olapCtrlObj._baseSavedProperties.columnHeaders,this._rowHeaders=this.olapCtrlObj._baseSavedProperties.rowHeaders,this._valueCells=this.olapCtrlObj._baseSavedProperties.valueCells,this.pivotEngine=this.olapCtrlObj._baseSavedProperties.pivotEngine,this.olapCtrlObj=this.olapCtrlObj._baseSavedProperties.olapCtrlObj,this._cBIndx=this.olapCtrlObj._baseSavedProperties.cBIndx,this._rBIndx=this.olapCtrlObj._baseSavedProperties.rBIndx,this._OlapDataSource=this.olapCtrlObj._baseSavedProperties.OlapDataSource,this._measureDt=this.olapCtrlObj._baseSavedProperties.measureDt,this._cTotIndexInfo=this.olapCtrlObj._baseSavedProperties.cTotIndexInfo,this._rTotIndexInfo=this.olapCtrlObj._baseSavedProperties.rTotIndexInfo,this._kpi=this.olapCtrlObj._baseSavedProperties.kpi,this._rowCount=this.olapCtrlObj._baseSavedProperties.rowCount,this._colCount=this.olapCtrlObj._baseSavedProperties.colCount,this._isPaging=this.olapCtrlObj._baseSavedProperties.isPaging,this._indexRCell=this.olapCtrlObj._baseSavedProperties.indexRCell,this._indexCCell=this.olapCtrlObj._baseSavedProperties.indexCCell,this.olapCtrlObj._baseSavedProperties={}}else this.olapCtrlObj._pivotRecords={records:n,rowCount:m},"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotGrid"!=this.olapCtrlObj.pluginName?"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotChart"!=this.olapCtrlObj.pluginName&&"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotGauge"!=this.olapCtrlObj.pluginName&&"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotTreeMap"!=this.olapCtrlObj.pluginName?(this._renderPager(a),this.olapCtrlObj.generateJSON({baseObj:this,tranposeEngine:r,jsonObj:n})):(this.olapCtrlObj.generateJSON({baseObj:this},r),this._isPaging&&this._renderPager(a)):this._renderPivotGrid(a,n),this._columnHeaders=this._rowHeaders=this._valueCells=this.pivotEngine=[],this._cBIndx=this._rBIndx=null,this._measureDt={axis:"",posision:null},this._cTotIndexInfo=this._rTotIndexInfo=null},_renderPager:function(e){var i,a,l,r;this._isPaging&&("navPaging"!=e.action&&(t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)?this.olapCtrlObj.model.enablePaging&&(l={CategoricalCurrentPage:1,CategoricalPageSize:1,SeriesCurrentPage:1,SeriesPageSize:1},r={Column:1,Row:1},this.olapCtrlObj._pagerObj.initPagerProperties(r,l),this.olapCtrlObj._pagerObj.element.css("opacity","0.5"),this.olapCtrlObj._pagerObj.element.find(".e-pagerTextBox").attr("disabled","disabled"),this.olapCtrlObj._pagerObj._unwireEvents()):(i=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj._categCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize):this.olapCtrlObj._categCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage),a=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj._seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize):this.olapCtrlObj._seriesCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage),i=0==i?1:i,a=0==a?1:a,this._colCount=0==this._colCount?1:this._colCount,this._rowCount=0==this._rowCount?1:this._rowCount,this.olapCtrlObj.model.enablePaging?(l={CategoricalCurrentPage:i,CategoricalPageSize:this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:a,SeriesPageSize:this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize},r={Column:this._colCount,Row:this._rowCount},this.olapCtrlObj._pagerObj.element.css("opacity","1"),this.olapCtrlObj._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),this.olapCtrlObj._pagerObj._unwireEvents(),this.olapCtrlObj._pagerObj._wireEvents(),this.olapCtrlObj._pagerObj.initPagerProperties(r,l)):this.olapCtrlObj.model.enableVirtualScrolling&&(this.olapCtrlObj._categPageCount=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize),this.olapCtrlObj._seriesPageCount=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)),this.olapCtrlObj._categCurrentPage=i,this.olapCtrlObj._seriesCurrentPage=a,t.isNullOrUndefined(this.olapCtrlObj._pivotGrid)||(this.olapCtrlObj._pivotGrid._categCurrentPage=i,this.olapCtrlObj._pivotGrid._seriesCurrentPage=a,this.olapCtrlObj._pivotGrid._categPageCount=this.olapCtrlObj._categPageCount,this.olapCtrlObj._pivotGrid._seriesPageCount=this.olapCtrlObj._seriesPageCount))),t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)||(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage=this.olapCtrlObj._categCurrentPage,this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage=this.olapCtrlObj._seriesCurrentPage))},_renderPivotGrid:function(e,i){this.olapCtrlObj._dataModel="XMLA",this.olapCtrlObj.setJSONRecords(JSON.stringify(i)),this.olapCtrlObj.setOlapReport(this.olapCtrlObj.model.dataSource),this._renderPager(e),this.olapCtrlObj.model.enableGroupingBar&&this.olapCtrlObj._createGroupingBar(this.olapCtrlObj.model.dataSource),null!=this.olapCtrlObj.model.layout&&this.olapCtrlObj.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.olapCtrlObj.excelLikeLayout(i):this.olapCtrlObj.renderControlFromJSON(i),e.action&&("initialLoad"==e.action||"navPaging"==e.action)&&(this.olapCtrlObj._trigger("renderSuccess",this.olapCtrlObj),this.olapCtrlObj._fieldData={hierarchy:this.olapCtrlObj._fieldData.hierarchy,measures:this.olapCtrlObj._fieldData.measures})},_onDemandExpand:function(t,i){var a,l,r,n,s,o,d,u="",c=this.olapCtrlObj.XMLACellSet,p=e(this.olapCtrlObj.XMLACellSet).find("Axis[name='Axis0'] Tuple").length,m=e(this.olapCtrlObj.XMLACellSet).find("Axis[name='Axis1'] Tuple").length;m=m||1,e(i).find("CellData Cell").length,e(this.olapCtrlObj.XMLACellSet[1]).children().length,t.cellInfo.previousElements.split(">#>");var h=e(i).find("Axis[name|='Axis0']").find("Tuple"),g=e(i).find("Axis[name|='Axis1']").find("Tuple"),f=h.length;l=g.length,e(i).find("Axis[name='SlicerAxis']").remove();var _,b,v=t.cellInfo.itemPosition,C=0,S=!1,O="";for(b="rowheader"==t.cellInfo.axis?g[0]:h[0],u=_=e(b).find("Member:nth-child("+(v+1)+") PARENT_UNIQUE_NAME").text(),n=v+1;n>0;n--)c=e(c).find("Tuple Member:nth-child("+n+") UName:contains('"+_+"')").parents("tuple"),O=(_=e(b).find("Member:nth-child("+(n-1)+") UName").text())+O;if(u=O+u,r=c.index()+1,u=t.cellInfo.previousElements.split(">#>").join().replace(/,/g,""),a=t.cellInfo.preRepItm.split(">#>").join().replace(/,/g,""),this.olapCtrlObj._drilledCellSet&&(C=this.olapCtrlObj._drilledCellSet.length),u=u+" !#"+t.cellInfo.axis,this.olapCtrlObj._drilledCellSet[0]&&C)for(s=0;s<C;s++){for(o=this.olapCtrlObj._drilledCellSet[s].length,t.cellInfo.parentUniqueName,d=0;d<o;d++){if(t.cellInfo.previousElements.startsWith(this.olapCtrlObj._drilledCellSet[s][d].key)){this.olapCtrlObj._drilledCellSet[s].push({key:u,repItms:a}),S=!0;break}if(this.olapCtrlObj._drilledCellSet[s][d].key.startsWith(t.cellInfo.previousElements)){this.olapCtrlObj._drilledCellSet[s].splice(d,0,{key:u,repItms:a}),S=!0;break}}if(S)break}else this.olapCtrlObj._drilledCellSet[0]=[],this.olapCtrlObj._drilledCellSet[0][0]={key:u,repItms:a},S=!0;S||(this.olapCtrlObj._drilledCellSet[C]=[],this.olapCtrlObj._drilledCellSet[C].push({key:u,repItms:a})),this._isPaging||("rowheader"==t.cellInfo.axis?(e(i).find("Axis[name|='Axis1']").find("Tuple"),this._insertCellSet("rowheader",c,g,h,l,p,f,r,i)):(e(i).find("Axis[name|='Axis1']").find("Tuple"),this._insertCellSet("colheader",c,h,g,m,p,f,r,i)),this._generateJSONData("onDemandDrill",this.olapCtrlObj.XMLACellSet))},_insertCellSet:function(t,i,a,l,r,n,s,o,d){var u,c,p,m,h,g=e(e(d).find("CellData Cell")[0]).clone();e(g).find("FmtValue").text(""),i.length>1?e(i[0]).after(a):e(i).after(a),c=n,"rowheader"==t?u=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"):(u=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple"),c=s);var f=0,_=e(u).filter(function(t,i){if(l[f]&&e(i).find("UName").text()==e(l[f]).find("UName").text())return f++,!0}),b=0,v=!1;for(p=0;p<r;p++){var C,S="",O=0,x=0;for(C="rowheader"==t?(o+p)*c:p*(n+c)+o,m=0;m<c;m++)"rowheader"==t&&e(_[O]).index()==m||"colheader"==t&&e(_[b]).index()==p||!u.length?(h="rowheader"==t?p*s:b*s,S=e(e(d).find("CellData Cell")[h+O]).clone(),e(this.olapCtrlObj.XMLACellSet).find("CellData Cell:nth-child("+(C+x)+")").after(S),O++,v=!0):e(this.olapCtrlObj.XMLACellSet).find("CellData Cell:nth-child("+(C+x)+")").after(e(g).clone()),x++;"colheader"==t&&(v&&b++,v=!1)}this._setCellOrdinal(this.olapCtrlObj.XMLACellSet[1])},_clearDrilledCellSet:function(){for(var t,i=e.extend([],this.olapCtrlObj._drilledCellSet),a="",l=0;l<i.length;l++)(a=i[l][0].key.split("!#")).length&&(t=this._getDrilledMemeber({item:{previousElements:a[0]}})),t.length&&this._onDemandCollapse({drilledMembers:t,action:""},a[1])},_onDemandCollapse:function(i,a){e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"),e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple");try{this.olapCtrlObj.model.dataSource=t.olap._mdxParser._clearCollapsedItems(a,i.drilledMembers[i.drilledMembers.length-1],this.olapCtrlObj.model.dataSource),i.drilledMembers=i.drilledMembers.splice(0,i.drilledMembers.length-1)}catch(e){this.olapCtrlObj._ogridWaitingPopup.hide()}i.drilledMembers.length?this._onDemandCollapse({drilledMembers:i.drilledMembers,action:i.action},a):"collapse"==i.action&&(this.olapCtrlObj.model.dataSource._isCollapse=!0,delete this._currIndex.axis,this.getJSONData({action:"onDemandCollapse"},this.olapCtrlObj.model.dataSource,this.olapCtrlObj))},_removeCellSets:function(t,i,a,l,r,n){for(var s,o,d,u,c,p,m,h=t.length,g=r[0],f=0;f<i.length;f++)if(e(i[f]).find("UName").text()==e(g).find("UName").text()){m=i[f];break}if(s=h,o=e(m).index())if("rowheader"==n){for(p=a.length;s>0;)e(e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple")[o]).remove(),s--;for(c=ext=o;c<ext+h;c++)d=e(e(this.olapCtrlObj.XMLACellSet[1]).children()).splice(o*p,p),e(d).remove()}else{for(p=i.length,u=a.length;s>0;)e(e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple")[o]).remove(),s--;for(c=0;c<u;c++)d=e(e(this.olapCtrlObj.XMLACellSet[1]).children()).splice(p*c-c*h+o,h),e(d).remove()}this._setCellOrdinal(this.olapCtrlObj.XMLACellSet[1])},_getDrilledMemeber:function(t){for(var i,a,l=[],r=t.item.previousElements.split(">#>").join().replace(/,/g,""),n=this.olapCtrlObj._drilledCellSet,s=(l=e.map(this.olapCtrlObj._drilledCellSet,function(t){return l=e.map(t,function(e){if(e.key.startsWith(r))return e})}),0);s<n.length;s++)for(i=0,a=n[s];n[s]&&i<n[s].length;i++)a[i]&&a[i].key.startsWith(r)&&(a.splice(i,1),i--,a.length||(n.splice(s,1),s--));return l},_getHeaderCollection:function(t,a){var l,r,n,s,o,d,u,c,p,m,h,g,f=[],_="",b=[],v=null,C={},S={},O=this;if(l=e(t).filter(function(t,i){var l,s,o,d=e(i).find("Member"),u=!("4"==e(d[0]).find("MEMBER_TYPE").text())&&-1!=e(d[0]).find("LName").text().indexOf("[(All)]"),c=u?1:0,p=0;for(v=null,u?(n=0,_="total"):(_="",n=d.length),l=1,-1!=e(d[0]).find("LName").text().toLowerCase().indexOf("[measures]")&&(l=0);l<d.length;l++)s=!1,"colheader"==a&&O._OlapDataSource.columns[l]?(O._OlapDataSource.columns[l].hasAllMember||null!=O._OlapDataSource.columns[l].expression)&&(s=!0):"rowheader"==a&&O._OlapDataSource.rows[l]&&(O._OlapDataSource.rows[l].hasAllMember||null!=O._OlapDataSource.rows[l].expression)&&(s=!0),-1!=e(d[l]).find("LName").text().toLowerCase().indexOf("[measures]")||s?(p=u,S.axis=a,S.posision=l,4==parseInt(e(d[l]).find("MEMBER_TYPE").text())&&(-1!=(o=e(d[l]).find("UName").text().toLowerCase()).indexOf("trend]")?(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[l]).find("UName").text(),"trend"))&&(v="trend",S.isKpiExist=!0)):-1!=o.indexOf("status]")?(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[l]).find("UName").text(),"status"))&&(v="status",S.isKpiExist=!0)):-1!=o.indexOf("goal]")&&(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[l]).find("UName").text()+"::"+e(d[l]).find("Caption").text(),"goal"))&&(v="goal",S.isKpiExist=!0)))):p=-1!=e(d[l]).find("LName").text().indexOf("[(All)]"),(0==u&&1==p||1==u&&0==p)&&(c++,n=l,_="total"),u=p;return r=t,c<2&&f.push({selIndx:r,totLvl:n,type:_,kpi:v,kpiInfo:C}),c<2}).map(function(t,l){for(var r,n,s,o,d=e(l).find("Member"),u=[],c=0;c<d.length;c++)r=!1,n=parseInt(e(d[c]).find("LNum").text()),"colheader"==a&&O._OlapDataSource.columns[c]?O._OlapDataSource.columns[c].hasAllMember||null!=O._OlapDataSource.columns[c].expression?n+=1:r=null!=O._OlapDataSource.columns[c].expression:"rowheader"==a&&O._OlapDataSource.rows[c]&&(O._OlapDataSource.rows[c].hasAllMember||null!=O._OlapDataSource.rows[c].expression?n+=1:r=null!=O._OlapDataSource.rows[c].expression),s=e(d[c]).find("PARENT_UNIQUE_NAME").length?e(d[c]).find("PARENT_UNIQUE_NAME").text():"",u.push({CSS:a,Value:""==e(d[c]).find("Caption").text()?"(Blank)":e(d[c]).find("Caption").text(),ColSpan:1,RowSpan:1,HUName:e(d[c]).attr("Hierarchy"),LName:e(d[c]).find("LName").text(),UName:e(d[c]).find("UName").text(),ChildCount:parseInt(e(d[c]).find("CHILDREN_CARDINALITY").text()),PUName:s,isCalcMem:r,LNum:n,MemberType:parseInt(e(d[c]).find("MEMBER_TYPE").text())}),(-1!=e(d[c]).find("LName").text().toLowerCase().indexOf("[measures]")||r)&&f[t].kpi&&(u[u.length-1].kpiInfo=f[t].kpiInfo,u[u.length-1].kpi=f[t].kpi),b[c]==i?b[c]=n:b[c]<n&&(b[c]=n);return(o=[])[0]=u,o}),"colheader"==a?this._cTotIndexInfo=f:this._rTotIndexInfo=f,l={headers:l,indxInfo:f,maxLvlLen:b},e.isEmptyObject(S)||(this._measureDt=e.extend({},S)),1,a.indexOf(this._OlapDataSource.values[0].axis.substring(0,3))>-1&&(this._measureDt.measureCount=this._OlapDataSource.values[0].measures.length),!this._OlapDataSource._enableBasicEngine&&!this._isPaging){var x={headers:[],indxInfo:[]},y=f.length,P=x.length,N=[],M=[];try{for(p=0;p<y;p++)p<y&&"total"==l.indxInfo[p].type&&(x.indxInfo.push(l.indxInfo.splice(p,1)[0]),x.headers.push(l.headers.splice(p,1)[0]),y--,p--);var T=l.headers.length>0?l.headers[0].length:0,L=0,w=0;for(this._measureDt.posision==T-1&&this._measureDt.axis==a&&(w=1),y=l.headers.length,p=0;p<=y;p++){var j=null,D=null,I=null,E=null;for(j=(E=this._updateMemberVariables(l.headers,j,D,I,p)).prev,D=E.next,I=E.cur,E=null,k=T-2-w;k>=0;k--)if(s=this._comparePrevMembers(l.headers,y,p,k,T,-2),p==y||p>0&&(j&&j[k].UName!=I[k].UName||j[k].UName==I[k].UName&&s))if(I&&j[k].UName==I[k].PUName)p-=o=this._removeSubtotalMembers(l,p,k),y-=o,j=(E=this._updateMemberVariables(l.headers,j,D,I,p)).prev,D=E.next,I=E.cur,E=null;else{var A,R=j,V=(P=0,0),U=0;for(j&&(U=j[k].LNum),I&&(V=I[k].LNum),d=!1,u=V;u<=U;u++){for(P=(A=this._getSummaryHeaders(R,x,k,d,w)).headers.length;A.headers.length>0;)l.headers.splice(p,0,A.headers.pop()),l.indxInfo.splice(p,0,A.indexInfo.pop());d=!0,p+=P,y+=P,R=l.headers[p-1]}}if(p==y&&x.headers.length>0){for(c=0;x.headers.length>0;)l.headers.splice(p,0,x.headers.pop()),l.indxInfo.splice(p,0,x.indxInfo.pop()),y++,c++;p+=c}}var k=0,F="";for(N={headers:[],indxInfo:[]},k=T-1-w,y=l.headers.length,p=0;p<y;p++)if(j=this._findPreviousMember(l.headers,p-1,k),p>0&&l.headers[p-1][k].UName!=l.headers[p][k].UName&&k==T-1-w&&b[k]>1){if(p>0&&l.headers[p]!=i&&0!=l.headers[p-1][k].LNum&&l.headers[p-1][k].UName==l.headers[p][k].PUName)for(m=j;m<0;m++)l.indxInfo[p+m].lnum=l.headers[p+m][k].LNum,l.indxInfo[p+m].type="total",N.indxInfo.push(l.indxInfo.splice(p+m,1)[0]),N.headers.push(l.headers.splice(p+m,1)[0]),p+1==y?F=l.headers[p][k].PUName:(p--,y--);0!=p&&l.headers[p]!=i&&l.headers[p-1][k].LNum>l.headers[p][k].LNum&&(h=[],y=(g=this._insertSummaryHeaders(l,N,h,p,k,T,L,F,!1,M)).itmCnt,p=g.hCnt,L=g.insCnt,M[k]=g.subPos)}}catch(e){this.olapCtrlObj._waitingPopup.hide()}}return"rowheader"==a?this._rBIndx=f:this._cBIndx=f,l},_insertSummaryHeaders:function(t,a,l,r,n,s,o,d,u,c){l=[];var p,m,h,g,f,_,b,v="";o=0;for(t.headers[r-1]&&(d=t.headers[r-1][n].PUName),h=t.headers.length,p=t.headers[r][n].LNum,m=t.headers[r-1][n].LNum,g=this._comparePrevMembers(t.headers,h,r,n,s,o),f=p;f<m;f++){for(e.grep(a.headers,function(e,a){(d==e[n].UName||t.headers[r+1+o]!=i&&t.headers[r][n].UName!=t.headers[r+1+o][n].UName&&t.headers[r][n].PUName==e[n].UName&&g)&&(v=e[n].PUName,l.push(a))}),d=v,g&&(l.reverse(),g=!1);l.length>0;){for(_=l.length-1,b=l[l.length-1],t.headers.splice(r,0,a.headers.splice(l[l.length-1],1)[0]),t.indxInfo.splice(r,0,a.indxInfo.splice(l[l.length-1],1)[0]);_>=0;)b<l[_]&&l[_]--,_--;l.pop(),h++,o++,u&&c[n]++}o>0&&(r+=o,o=0)}return{itmCnt:h,hCnt:r,insCnt:o,subPos:c[n]}},_comparePrevMembers:function(e,t,i,a,l,r){var n,s=!1;if(a>0&&i<t&&i+1+r>=0&&i+1+r<t)for(n=a-1;n>=0;n--)e[i][n].UName!=e[i+1+r][n].UName&&(s=!0);return s},_updateMemberVariables:function(e,t,i,a,l){return e[l]&&(a=e[l]),i=e[l+1]?e[l+1]:null,{cur:a,prev:e[l-1]?e[l-1]:null,next:i}},_removeSubtotalMembers:function(e,t,i){for(var a=t-1,l=e.headers[a][i].UName;e.headers[a]&&e.headers[a][i].UName==l;)e.indxInfo.splice(a,1),e.headers.splice(a,1),a--;return t-(a+1)},_getSummaryHeaders:function(t,i,a,l){var r,n=i.headers,s=t,o=a,d=[],u=[],c=i.indxInfo;return r=e.grep(n,function(e,t){for(var i=!1,a=o;a>=0&&(e[a].UName==s[a].UName||l&&a==o&&e[a].UName==s[a].PUName);a--)0==a&&(i=!0,u.push(c[t]));return i}),i.headers=e.grep(n,function(e,t){for(var i=!0,a=o;a>=0&&(e[a].UName==s[a].UName||l&&a==o&&e[a].UName==s[a].PUName);a--)0==a&&(i=!1);return i&&d.push(c[t]),i}),i.indxInfo=d,{headers:r,indexInfo:u}},_drillOrderHeaderCollection:function(t,i,a){var l=i,r=a,n=this;return e(t).map(function(t,i){var a,s,o,d,u=e(l[i.selIndx]).find("Member"),c=[];for(c[0]=[],a=0;a<u.length;a++)s=parseInt(e(u[a]).find("LNum").text()),"colheader"==r&&n._OlapDataSource.columns[a]?n._OlapDataSource.columns[a].hasAllMember&&(s+=1):"rowheader"==r&&n._OlapDataSource.rows[a]&&n._OlapDataSource.rows[a].hasAllMember&&(s+=1),o=e(u[a]).find("PARENT_UNIQUE_NAME").length?e(u[a]).find("PARENT_UNIQUE_NAME").text():"",c[0].push({CSS:r,Value:e(u[a]).find("Caption").text(),ColSpan:1,RowSpan:1,HUName:e(u[a]).attr("Hierarchy"),LName:e(u[a]).find("LName").text(),UName:e(u[a]).find("UName").text(),ChildCount:parseInt(e(u[a]).find("CHILDREN_CARDINALITY").text()),PUName:o,LNum:s,MemberType:parseInt(e(u[a]).find("MEMBER_TYPE").text())}),d=c[0][c[0].length-1],i.kpiInfo&&d.UName.toLowerCase().indexOf("[measures]")>-1&&4==d.MemberType&&(c[0][c[0].length-1].kpiInfo=i.kpiInfo),i.kpi&&d.UName.toLowerCase().indexOf("[measures]")>-1&&4==d.MemberType&&(c[0][c[0].length-1].kpi=i.kpi);return c})},_loadKpi:function(e,t,i){i={action:"loadFieldElements"};var a=this._getConnectionInfo(e.data),l='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_KPIS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog></PropertyList></Properties></Discover></Body></Envelope>";this.olapCtrlObj.doAjaxPost("POST",a.url,{XMLA:l},this._loadKpiSuccess,null,i)},_loadKpiSuccess:function(e,t){this._kpi=t},_isKpi:function(t,i){var a=e(this._kpi).find("row:contains("+t.split("::")[0]+")"),l={};return!!a.length&&("trend"==i?(l.Graphic=e(a).find("KPI_TREND_GRAPHIC").text(),l.Value=e(a).find("KPI_NAME").text()):"status"==i?(l.Graphic=e(a).find("KPI_STATUS_GRAPHIC").text(),l.Value=e(a).find("KPI_NAME").text()):"goal"==i&&(l.Caption=t.split("::")[1],l.Value=e(a).find("KPI_NAME").text()),l)},_getValueCells:function(i,a){var l,r,n,s,o,d=this._columnHeaders.headers.length,u=this._rowHeaders.headers.length?this._rowHeaders.headers.length:1,c=0,p=0;if(this._valueCells[c]=[],this._fillAllValueCells(),i=e(this.olapCtrlObj.XMLACellSet[1]).children(),this._OlapDataSource._enableBasicEngine||this._isPaging)for(n=0;n<i.length;n++)p<d&&(this._valueCells[c][p]={ActualValue:e(i[n]).find("Value").text(),Value:e(i[n]).find("FmtValue")[0]?e(i[n]).find("FmtValue").text():"",FormatString:e(i[n]).find("FormatString")[0]?e(i[n]).find("FormatString").text():"",kpi:!t.isNullOrUndefined(this._cBIndx[p])&&this._cBIndx[p].kpi?this._cBIndx[p].kpi:!t.isNullOrUndefined(this._rBIndx[c])&&this._rBIndx[c].kpi?this._rBIndx[c].kpi:""},p++),p==d&&c+1<u&&(p=0,c++,this._valueCells[c]=[]);else for(l=0;l<u;l++)for(r=this._rBIndx.length?this._rBIndx[l].selIndx:0,n=0;n<d;n++)i&&(s=e(i[r*a+this._cBIndx[n].selIndx]),o="",(this._columnHeaders.indxInfo[n]&&"total"==this._columnHeaders.indxInfo[n].type||this._rowHeaders.indxInfo[l]&&"total"==this._rowHeaders.indxInfo[l].type)&&(o="summary"),p<d&&(this._valueCells[l][n]={ActualValue:e(s).find("Value").text(),Value:e(s).find("FmtValue")[0]?this._getFormatedValue(e(s),e(s).find("FormatString")[0]):"",FormatString:e(s).find("FormatString")[0]?e(s).find("FormatString").text():"",kpi:this._cBIndx[n].kpi?this._cBIndx[n].kpi:this._rBIndx[l]?this._rBIndx[l].kpi:"",summary:o,Span:this._isNoSummary&&"summary"==o?"Block":"None"},p++),p==d&&c+1<u&&(p=0,c++,this._valueCells[c]=[]));return this._valueCells},_fillAllValueCells:function(i){var a,l,r,n,s;i=e(this.olapCtrlObj.XMLACellSet[1]).children();if(!t.isNullOrUndefined(i))for(a=!e(i[0]).clone(),e(a).find("FmtValue").text(""),i,l=0;l<i.length;l++)if(r=parseInt(e(i[l]).attr("CellOrdinal")),i[l+1]&&(n=parseInt(e(i[l+1]).attr("CellOrdinal"))),r+1<n)for(s=r+1;s<n;s++)e(i[l]).after(e(a).clone().attr("CellOrdinal",s)[0]);return i},_setCellOrdinal:function(t){for(var i=e(t).find("Cell"),a=0;a<i.length;a++)e(i[a]).attr("CellOrdinal",a)},_getFormatedValue:function(i,a){var l;if(("en-US"==this.olapCtrlObj.model.locale||!e.isNumeric(parseFloat(e(i).find("Value").text())))&&e(i).length>0)l=e(i).find("FmtValue").text();else switch(a=e(a).length>0?e(a).text().toLowerCase():t.isNullOrUndefined(a)?"":a.length>0?a:"",l=e(i).length>0?parseFloat(i.find("Value").text()):i,a){case"decimal":l=parseFloat(t.widgetBase.formatting("{0:D2}",l,this.olapCtrlObj.model.locale));break;case"percent":l=t.widgetBase.formatting("{0:P0}",l,this.olapCtrlObj.model.locale);break;case"number":l=t.widgetBase.formatting("{0:N}",l,this.olapCtrlObj.model.locale);break;case"currency":l=t.widgetBase.formatting("{0:C2}",l,this.olapCtrlObj.model.locale);break;case"date":l=new Date(864e5*(Number(l)-2)+new Date("01/01/1900").getTime()),this._isDateTime(l)&&(l=t.widgetBase.formatting("{0:MM/dd/yyyy}",l,this.olapCtrlObj.model.locale));break;case"scientific":l=Number(l).toExponential(2).replace("e","E");break;case"accounting":l=this._toAccounting(l,"{0:C2}",this.olapCtrlObj.model.locale);break;case"time":l=new Date(864e5*(Number(l)-2)+new Date("01/01/1900").getTime()),this._isDateTime(l)&&(l=t.widgetBase.formatting("{0:h:mm:ss tt}",l,this.olapCtrlObj.model.locale));break;case"fraction":l="numerator"in(l=this._toFraction(l))?l.integer+" "+l.numerator+"/"+l.denominator:l.integer;break;default:l=e(i).find("FmtValue").text()}return l},_isDateTime:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},_toAccounting:function(e,i,a){var l,r,n,s,o=t.preferredCulture(a).numberFormat.currency.symbol;return val=t.widgetBase.formatting(i,e,this.olapCtrlObj.model.locale),n=val.replace(o,""),!(s=val.indexOf(o))||e<0&&1===s?(l=o,r=Number(e)?n:"-"):(l=Number(e)?n:"-",r=o),l+"   "+r},_toFraction:function(e){if(this._isNumber(e)){var t=e.toString(),i=t.split(".")[0],a=t.split(".")[1];if(!a)return{integer:e};var l=(+a).toString(),r=this._getPlaceValue(a,l),n=this._getGCD(l,r);return{integer:i,numerator:Number(l)/n,denominator:Number(r)/n}}return null},_isNumber:function(e){return e-parseFloat(e)>=0},_getGCD:function(e,t){return e=Number(e),(t=Number(t))?this._getGCD(t,e%t):e},_getPlaceValue:function(e,t){var i=e.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},_populateEngine:function(a,l,r){var n,s,o,d,u,c=a.length,p=l.length,m=c?a[0].length:c,h=p?l[0].length:p,g=[],f=r.length,_=r[0].length;try{this.pivotEngine=[];var b,v=[],C=[],S=[],O=!1;for(d=0;d<p;d++)for(this.pivotEngine[d+h]==i&&(this.pivotEngine[d+h]=[]),0==d&&(this.pivotEngine[0]=[],this.pivotEngine[0][0]={CSS:"none",Value:"",ColSpan:this._indexCCell?this._indexCCell:1,RowSpan:this._indexRCell?this._indexRCell:1,HUName:"",LName:"",UName:"",LNum:""}),n=0;n<h;n++)O=!1,this._OlapDataSource.columns&&this._OlapDataSource.columns[n]&&this._OlapDataSource.columns[n].isNamedSets&&(O=!0),this._pivotEngineSpanCalculation("colheader",l,a,this._columnHeaders.maxLvlLen,r,n,d,C,v,this._cTotIndexInfo,O,S);for(b=this.pivotEngine.slice(),this.pivotEngine=[],d=0;d<b.length;d++)if(b[d])for(n=0;n<b[d].length;n++)b[d][n]&&(this.pivotEngine[n]==i&&(this.pivotEngine[n]=[]),this.pivotEngine[n][d]={CSS:b[d][n].CSS,ColSpan:b[d][n].RowSpan,HUName:b[d][n].HUName,LName:b[d][n].LName,LNum:b[d][n].LNum,RowSpan:b[d][n].ColSpan,UName:b[d][n].UName,PUName:b[d][n].PUName,Value:b[d][n].Value,ChildCount:b[d][n].ChildCount,MemberType:b[d][n].MemberType,Span:"Block"==b[d][n].Span?"Block":"None"},b[d][n].kpiInfo&&(this.pivotEngine[n][d].kpiInfo=b[d][n].kpiInfo,this.pivotEngine[n][d].kpi=b[d][n].kpi));var x=[],y=[];S=[];for(d=0;d<c;d++)for(this.pivotEngine[d+this._indexCCell]==i&&(this.pivotEngine[d+this._indexCCell]=[]),n=0;n<m;n++)O=!1,this._OlapDataSource.rows&&this._OlapDataSource.rows[n]&&this._OlapDataSource.rows[n].isNamedSets&&(O=!0),this._pivotEngineSpanCalculation("rowheader",a,l,this._rowHeaders.maxLvlLen,r,n,d,y,x,this._rTotIndexInfo,O,S);for(g=e.extend(!0,[],this.pivotEngine),m="rowheader"==this._measureDt.axis?this._indexRCell+1:this._indexRCell,h=this._indexCCell?this._indexCCell:h,d=0;d<f;d++)for(this.pivotEngine[d+h]!=i&&(m=this.pivotEngine[d+h].length),n=0;n<_;n++)t.isNullOrUndefined(r[d][n])||(this.pivotEngine[d+h]==i&&(this.pivotEngine[d+h]=[]),s=this._setClassName(r[d][n]),r[d][n].CSS=s,s.indexOf("kpiiconvalue")>-1&&("ejPivotGrid"==this.olapCtrlObj.pluginName||"ejPivotClient"==this.olapCtrlObj.pluginName)?r[d][n].Value="":s.indexOf("kpiiconvalue")>-1&&(r[d][n].Value=parseInt(r[d][n].Value)),this.pivotEngine[d+this._indexCCell][n+this._indexRCell]=r[d][n]);if(e.grep(this.pivotEngine,function(e){return e}),this._isPaging){for(t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName)||"collapse"!=this.olapCtrlObj._pagingSavedObjects.curDrilledItem.action?t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index)?t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName)||(e.each(this.olapCtrlObj._pagingSavedObjects.savedHdrEngine,function(i,a){e.each(a,function(e,a){if(!t.isNullOrUndefined(a)&&a.UName==t.olap.base.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName.split("::")[0].split("amp;").join(""))return t.olap.base.olapCtrlObj._pagingSavedObjects.drillEngine.push(t.olap.base.olapCtrlObj._pagingSavedObjects.savedHdrEngine[i][e]),!1})}),this.olapCtrlObj._pagingSavedObjects.drillEngine[this.olapCtrlObj._pagingSavedObjects.drillEngine.length-1].ChildCount=-1):(this.olapCtrlObj._pagingSavedObjects.drillEngine.push(this.olapCtrlObj._pagingSavedObjects.savedHdrEngine[parseInt(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index.split(",")[1])][parseInt(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index.split(",")[0])]),this.olapCtrlObj._pagingSavedObjects.drillEngine[this.olapCtrlObj._pagingSavedObjects.drillEngine.length-1].ChildCount=-1):e.each(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e,i){if(i.UName==t.olap.base.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName.split("::")[0].split("amp;").join(""))return t.olap.base.olapCtrlObj._pagingSavedObjects.drillEngine.splice(e,1),!1}),e.map(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(i){var a=0,l=e.map(t.olap.base.olapCtrlObj.model.dataSource.columns,function(e,l){return t.olap.base.olapCtrlObj._isMondrian?(a=e.fieldName.replace(/\]/g,"").replace(/\[/g,"")==i.HUName.replace(/\[/g," ").replace(/\[/g,"")?l:a,e.fieldName.replace(/\]/g,"").replace(/\[/g,"")==i.HUName.replace(/\[/g," ").replace(/\[/g,"")):(a=e.fieldName==i.HUName?l:a,e.fieldName==i.HUName)});i.CSS=l[a]?"colheader":"rowheader"}),this.olapCtrlObj._pagingSavedObjects.curDrilledItem={},d=this.pivotEngine[0][0].RowSpan-2;d>=0;d--){for("empty",n=1;n<this.pivotEngine[this.pivotEngine[0][0].RowSpan-1].length;n++)t.isNullOrUndefined(this.pivotEngine[d])&&(this.pivotEngine[d]=[]),t.isNullOrUndefined(this.pivotEngine[d+1])||!t.isNullOrUndefined(this.pivotEngine[d][n])||t.isNullOrUndefined(this.pivotEngine[d+1][n])||(this.pivotEngine[d][n]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==t.olap.base.pivotEngine[d+1][n].PUName})[0],t.isNullOrUndefined(this.pivotEngine[d][n])||(this.pivotEngine[d][n].ColSpan=t.isNullOrUndefined(this.pivotEngine[d][n-1])||this.pivotEngine[d][n-1].UName!=this.pivotEngine[d][n].UName?1:this.pivotEngine[d][n-1].ColSpan+1,this.pivotEngine[d][n].RowSpan=1,this.pivotEngine[d][n].UName));for(o=1,n=this.pivotEngine[this.pivotEngine[0][0].RowSpan-1].length-2;n>0;n--)t.isNullOrUndefined(this.pivotEngine[d])||t.isNullOrUndefined(this.pivotEngine[d][n])||t.isNullOrUndefined(this.pivotEngine[d][n+1])||this.pivotEngine[d][n+1].UName!=this.pivotEngine[d][n].UName?t.isNullOrUndefined(this.pivotEngine[d])||t.isNullOrUndefined(this.pivotEngine[d][n+1])||(this.pivotEngine[d][n+1].ColSpan=1==o?this.pivotEngine[d][n+1].ColSpan:o,o=1):(this.pivotEngine[d][n].ColSpan,this.pivotEngine[d][n+1].ColSpan,o++)}for(d=this.pivotEngine[0][0].RowSpan;d<this.pivotEngine.length;d++)for(u="empty",n=this.pivotEngine[0][0].ColSpan-1;n>=0;n--)t.isNullOrUndefined(this.pivotEngine[d][n])?t.isNullOrUndefined(this.pivotEngine[d-1][n])||this.pivotEngine[d-1][n].UName!=u?(this.pivotEngine[d][n]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==u})[0],t.isNullOrUndefined(this.pivotEngine[d][n])||(this.pivotEngine[d][n].RowSpan=1,this.pivotEngine[d][n].ColSpan=1,u=this.pivotEngine[d][n].PUName)):(this.pivotEngine[d][n]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==u})[0],t.isNullOrUndefined(this.pivotEngine[d][n])||(this.pivotEngine[d][n].RowSpan=this.pivotEngine[d-1][n].RowSpan+1,this.pivotEngine[d][n].ColSpan=1,u=this.pivotEngine[d][n].PUName)):u=this.pivotEngine[d][n].PUName;this.olapCtrlObj._pagingSavedObjects.savedHdrEngine=g}}catch(e){this.olapCtrlObj._waitingPopup.hide()}},_pivotEngineSpanCalculation:function(t,a,l,r,n,s,o,d,u,c,p,m){var h,g,f,_,b,v,C,S,O,x,y,P=a.length,N="",M=l.length,T=P?a[0].length:P,L=M?l[0].length:M;n.length,n[0].length;"rowheader"==t?(L=this._indexCCell?this._indexCCell:L,N="row"):(L=this._indexRCell?this._indexRCell:L,N="col"),g=0,p&&(a[o][s].ChildCount=0),this._measureDt.axis==t&&this._measureDt.posision==T-1&&(g=1),d[s]||(d[s]=[]),this._isNoSummary&&!m[s]&&(m[s]=[]),this.pivotEngine[o+L]||(this.pivotEngine[o+L]=[]),u[s]=o;var w=r[s]?r[s]:1,j=0,D=0;for(f=0;f<s;f++)r[f]&&(j+=r[f]-1,D+=r[f]);if(!this._OlapDataSource._enableBasicEngine||this._OlapDataSource._checkSummaryHeaders)for(_=1;_<=w;_++){var I,E=!1,A=a[o][s].LNum;if(d[s][_]==i&&(d[s][_]=0),this._isNoSummary&&m[s][_]==i&&(m[s][_]=0),a[o-1]&&d[s][A]&&(0!=a[o][s].LNum&&a[o-1][s].PUName==a[o][s].UName||s+g==T-1&&a[o-1][s].LNum<a[o][s].LNum)&&(b=d[s][A],this._isNoSummary&&(b+=m[s][A],m[s][A]=0),this.pivotEngine[o+L-b][s+A-1+j]=a[o][s],s+g!=T-1&&(this.pivotEngine[o+L][s+A-1+j]=e.extend({},a[o][s]),this._isNoSummary&&(this.pivotEngine[o+L][s+A-1+j].Span="Block")),this._isNoSummary&&(this.pivotEngine[o+L-b][s+A-1+j].RowSpan=0),p||(this.pivotEngine[o+L-b][s+A-1+j].ChildCount=-1),this.pivotEngine[o+L-b][s+A-1+j].ColSpan=1,this.pivotEngine[o+L-b][s+A-1+j].RowSpan+=d[s][A],this._drilledJSONData(o+L-b,o+L,s+A-1+j,a[o][s]),d[s][A]=0,s+g==T-1&&a[o-1][s].LNum>a[o][s].LNum)){for(v=r[s]-A,C=this._findNextMember(a,o,s),S=0;S<C;S++)this.pivotEngine[o+L+S]||(this.pivotEngine[o+L+S]=[]),this.pivotEngine[o+L+S][s+j+A]={CSS:"summary "+N,Value:"Total",ColSpan:v,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"};this._isNoSummary||(this.pivotEngine[o+L-b][s+A-1+j].RowSpan+=C-1)}if(a[o][s].LNum>_&&(!this._isNoSummary||"total"!=c[o].type)?d[s][_]++:a[o][s].LNum>_&&this._isNoSummary&&"total"==c[o].type&&m[s][_]++,I=o+L,_==a[o][s].LNum&&0==o&&a[o][s].LNum>1)this.pivotEngine[I]||(this.pivotEngine[I]=[]),this.pivotEngine[I][s+_-1+j]=a[o][s],(!(a[o+1]!=i&&a[o][s].LNum<a[o+1][s].LNum)||s+g==T-1&&a[o+1]&&a[o][s].LNum<a[o+1][s].LNum)&&(this.pivotEngine[I][s+_-1+j].ColSpan+=r[s]-this.pivotEngine[I][s+_-1+j].LNum);else if(0!=o&&a[o][s].LNum>1&&_==a[o][s].LNum&&a[o-1][s].UName!=a[o][s].UName&&a[o-1][s].PUName!=a[o][s].UName)this.pivotEngine[I]==i&&(this.pivotEngine[I]=[]),this.pivotEngine[I][s+_-1+j]=a[o][s],(!(a[o+1]!=i&&a[o][s].LNum<a[o+1][s].LNum)||s+g==T-1&&a[o+1]&&a[o][s].LNum<a[o+1][s].LNum)&&(this.pivotEngine[I][s+_-1+j].ColSpan+=r[s]-this.pivotEngine[I][s+_-1+j].LNum);else if(0!=o&&_==a[o][s].LNum&&a[o-1][s].UName==a[o][s].UName)this._isNoSummary&&"total"==c[o].type?this._isNoSummary&&"total"==c[o].type&&m[s][_]++:d[s][_]++,this.pivotEngine[o+L][s+_-1+j]=a[o][s],this._isNoSummary&&"total"==c[o].type&&(this.pivotEngine[o+L][s+_-1+j].Span="Block"),(a[o+1]!=i&&a[o+1][s].UName!=a[o][s].UName||o+1==P&&d[s][_]>0)&&(O=d[s][_],x=a[o][s].LNum,this._isNoSummary&&(O+=m[s][_],m[s][_]=0),O&&this.pivotEngine[o+L-O][s+x-1+j]!=i&&this.pivotEngine[o+L-O][s+x-1+j].Value!=i&&(this.pivotEngine[o+L-O][s+x-1+j].RowSpan+=d[s][_],this._drilledJSONData(o+L-O,o+L,s+x-1+j,a[o][s])),d[s][_]=0);else if(a[o][s].LNum<2&&(_==a[o][s].LNum||0==a[o][s].LNum)||a[o][s].LNum<_&&a[o-1]&&a[o][s].LNum<a[o-1][s].LNum&&"total"==c[o].type&&this._measureDt.axis==t)if(_-1,a[o-1]&&a[o-1][s].UName==a[o][s].UName&&a[o][s].LName.toLowerCase().indexOf("[measures]")>-1&&(this.pivotEngine[o+L][s+_-1+j]=e.extend({},a[o][s]),this._measureDt.measureCount>1&&t==this._measureDt.axis||this._isNoSummary&&"total"==c[o].type?this._measureDt.measureCount>1&&t==this._measureDt.axis||!this._isNoSummary||"total"!=c[o].type||m[s][_]++:d[s][_]++,this._isNoSummary&&"total"==c[o].type&&(this.pivotEngine[o+L][s+_-1+j].Span="Block")),-1!=a[o][s].UName.indexOf("Measures")&&this._isPaging||"total"==c[o].type)if("total"==c[o].type&&-1==a[o][s].LName.toLowerCase().indexOf("[measures]")&&a[o][s].LNum!=_&&0!=r[s]){if((a[o][s-1]&&-1==a[o][s-1].LName.toLowerCase().indexOf("[measures]")||this._measureDt.axis!=t)&&(s>c[o].totLvl||s==T-1&&_>c[o].totLvl&&0!=c[o].totLvl||0==c[o].totLvl&&_-1>c[o].totLvl))break;for(var R=1,V=1,U=0;a[o-V][s]&&0==a[o-V][s].LNum&&!a[o][s].LName.toLowerCase().indexOf("[measures]")>-1;)a[o][s-1]&&a[o-V+1][s-1].UName!=a[o-V][s-1].UName&&U++,V++;0==a[o][s].LNum&&!a[o][s].LName.toLowerCase().indexOf("[measures]")>-1&&(y=0,0,o>0&&s>0&&a[o][s].LName.indexOf("(All)")>-1&&a[o][s-1]&&r[s-1]>1&&(y=this._findPreviousMember(a,o,s-1)),0!=o&&a[o][s-1]&&r[s-1]>1&&a[o+y]&&a[o][s-1].LNum<a[o+y][s-1].LNum&&(U=r[s-1]-a[o][s-1].LNum),"rowheader"==t?(R=this._indexRCell-D+U,this._indexRCell-R):"colheader"==t&&(R=this._indexCCell-D+U,this._indexCCell-R),(1!=r.length&&s==T-1||r.length>1&&s<T-1)&&(E=!0),this._measureDt.axis==t&&(R-=1),1,0!=o&&a[o][s-1]&&a[o][s-1].LNum+1,1,y=o+L,this.pivotEngine[o+L][s+_-1+j-U]={CSS:"summary "+N,Value:"Total",ColSpan:R,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"})}else-1!=a[o][s].LName.toLowerCase().indexOf("[measures]")?(a[o-1]&&a[o-1][s].UName==a[o][s].UName||(this.pivotEngine[o+L][s+_-1+j]=e.extend({},a[o][s]),this._isNoSummary&&"total"==c[o].type&&(this.pivotEngine[o+L][s+_-1+j].Span="Block")),(a[o-1]&&a[o-1][s].UName!=a[o][s].UName||o+1==P)&&(h=d[s][_],this._isNoSummary&&(h+=m[s][_],m[s][_]=0),h&&this.pivotEngine[o+L-h][s+_-1+j]!=i&&(this.pivotEngine[o+L-h][s+_-1+j].RowSpan+=d[s][_],this._drilledJSONData(o+L-h,o+L,s+_-1+j,a[o][s])),d[s][_]=0)):"total"==c[o].type&&1==a.length&&(this.pivotEngine[o+L][s+_-1+j]={CSS:"summary "+N,Value:"Total",ColSpan:1,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"});else a[o-1]&&a[o-1][s].UName==a[o][s].UName||(this.pivotEngine[o+L][s+_-1+j]=a[o][s],h=d[s][_],this._isNoSummary&&(h+=m[s][_],m[s][_]=0),h&&this.pivotEngine[o+L-h][s+_-1+j]!=i&&(this.pivotEngine[o+L-h][s+_-1+j].RowSpan+=d[s][_],this._drilledJSONData(o+L-h,o+L,s+_-1+j,a[o][s])),d[s][_]=0),0==!a[o][s].LNum&&(!(a[o+1]!=i&&a[o][s].LNum<a[o+1][s].LNum)||s+g==T-1&&a[o+1]&&a[o][s].LNum<a[o+1][s].LNum)&&this.pivotEngine[o+L][s+_-1+j]&&(this.pivotEngine[o+L][s+_-1+j].ColSpan+=r[s]-this.pivotEngine[o+L][s+_-1+j].LNum);if(E)break}else this.pivotEngine[o+L][s]=a[o][s]},_findNextMember:function(e,t,i){for(var a=0;e[t+a]&&e[t][i].UName==e[t+a][i].UName;)a++;return a},_findPreviousMember:function(e,t,i){for(var a=-1;e[t+a]&&e[t][i].UName==e[t+a][i].UName;)a--;return a},_drilledJSONData:function(t,i,a,l){for(var r=t+1;r<i;r++)this.pivotEngine[r][a]=e.extend({},l),this._isNoSummary&&(this.pivotEngine[r][a].Span="Block")},_setClassName:function(e){var t=parseInt(e.Value),i="value";if(e.kpi)if("trend"==e.kpi)switch(t){case-1:i="value kpiiconvalue kpidownarrow";break;case 0:i="value kpiiconvalue kpirightarrow";break;case 1:i="value kpiiconvalue kpiuparrow"}else if("status"==e.kpi)switch(t){case-1:i="value kpiiconvalue kpidiamond";break;case 0:i="value kpiiconvalue kpitriangle";break;case 1:i="value kpiiconvalue kpicircle"}return e.summary+" "+i},_getFieldItemsInfo:function(e){var t=this._getConnectionInfo(e.model.dataSource.data),i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_HIERARCHIES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+t.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>";e.doAjaxPost("POST",t.url,{XMLA:i},this._getHierarchyInfo,null,{pvtGridObj:e,action:"loadFieldElements"})},_getHierarchyInfo:function(t,i){for(var a,l,r=[],n=t.pvtGridObj,s=this._getConnectionInfo(n.model.dataSource.data),o=0;o<e(i).find("row").length;o++)a=e(e(i).find("row")[o]),r.push({pid:a.find("DIMENSION_UNIQUE_NAME").text(),id:a.find("HIERARCHY_UNIQUE_NAME").text(),name:a.find("HIERARCHY_CAPTION").text(),tag:a.find("HIERARCHY_UNIQUE_NAME").text(),hasAllMember:0==a.children("ALL_MEMBER").length});n._fieldData={hierarchy:r,hierarchySuccess:i,measures:[]},s.LCID.indexOf("1033")>=0&&!n.model.enableDrillThrough||(l='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASURES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+n.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+n.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+n.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+s.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>",n.doAjaxPost("POST",s.url,{XMLA:l},this._getMeasureInfo,null,{pvtGridObj:n,action:"loadFieldElements"}))},_getMeasureInfo:function(t,i){for(var a=[],l=0;l<e(i).find("row").length;l++){var r=e(e(i).find("row")[l]),n=r.children("MEASUREGROUP_NAME").text(),s=r.find("MEASURE_UNIQUE_NAME").text();a.push({id:s,pid:n,name:r.children("MEASURE_CAPTION").text(),tag:s})}t.pvtGridObj._fieldData.measures=a,t.pvtGridObj._fieldData.measureSuccess=i},_getConnectionInfo:function(t){var i={url:"",LCID:"1033"};return""!=t&&e.map(t.split(";"),function(e){e.toLowerCase().indexOf("locale")<0&&0==i.url.length?i.url=e:e.toLowerCase().indexOf("locale")>=0&&(i.LCID=e.replace(/ /g,"").split("=")[1])}),i},_applyTrim:function(a){var l=[],r=a.model.dataSource,n=this;a._fieldData&&a._fieldData.measures&&a._fieldData.hierarchy?(e.merge(l,a._fieldData.hierarchy),e.merge(l,a._fieldData.measures)):!a._fieldData||!a._fieldData.hierarchy||a._fieldData.hierarchy,r.rows=e.map(r.rows,function(a){if(!t.isNullOrUndefined(a)&&a.fieldName!=i)return a.fieldName=e.trim(a.fieldName),n._getCaption(a,l)}),r.columns=e.map(r.columns,function(a){if(!t.isNullOrUndefined(a)&&a.fieldName!=i)return a.fieldName=e.trim(a.fieldName),n._getCaption(a,l)}),r.filters=e.map(r.filters,function(a){if(!t.isNullOrUndefined(a)&&a.fieldName!=i)return a.fieldName=e.trim(a.fieldName),n._getCaption(a,l)}),r.values=r.values.length>0&&r.values[0].measures!=i?r.values:[{measures:[],axis:"columns"}],r.values[0].measures=e.map(r.values[0].measures,function(a){if(!t.isNullOrUndefined(a)&&a.fieldName!=i)return a.fieldName=e.trim(a.fieldName),n._getCaption(a,l)}),a.model.dataSource=r},_getCaption:function(a,l){var r=a.fieldName,n=[];return t.isNullOrUndefined(a.fieldCaption)&&(l.length>0?(n=e.map(l,function(t){if(t.tag!=i&&t.tag.toLowerCase()==e.trim(r.toLowerCase()))return t}),r.toLowerCase().indexOf("[measures]")>=0&&0==n.length&&r.split(".[").length>0?a.fieldCaption=r.split(".[")[1].replace(/]/g,""):n.length>0&&(a.hasAllMember=!!n[0].hasAllMember,a.fieldCaption=n[0].name)):0==n.length&&(a.fieldCaption=r)),a},clearDrilledItems:function(a,l,r){var n=l.action;return a.rows=e.grep(a.rows,function(e){return e.filterItems!=i&&"filtering"!=n&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=n&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),a.columns=e.grep(a.columns,function(e){return e.filterItems!=i&&"filtering"!=n&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=n&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),a.filters=e.grep(a.filters,function(e){return e.filterItems!=i&&"filtering"!=n&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=n&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),"filtering"!=n&&(r._currentReportItems=e.map(r._currentReportItems,function(e){if(!t.isNullOrUndefined(e.dataSrc)){if(e.dataSrc.cube!=a.cube)return e;if(e.dataSrc.reportName!=a.reportName)return e}}),t.isNullOrUndefined(r._schemaData)||r._schemaData.element.find(".filter").remove(),r._savedReportItems=e.extend(!0,[],r._currentReportItems)),t.olap.base._clearDrilledCellSet(),a}},t.olap._mdxParser={_getRowMDX:function(a){var l,r,n=e(a)[0].rows,s="",o="",d=[],u=!1,c=!1,p=a._isCollapse,m=a.values.length>0&&a.values[0].measures!=i&&a.values[0].axis==t.olap.AxisName.Row;if(t.isNullOrUndefined(a.providerName)||a.providerName==t.olap.Providers.SSAS){if(n.length>0){for(c=!t.isNullOrUndefined(n[0].drillCellInfo),l=0;l<n.length;l++){var h=!(t.isNullOrUndefined(n[l].isNamedSets)||!n[l].isNamedSets),g="",f="";n[l].fieldName==i||h?h&&(s=l>0?s+"*{"+n[l].fieldName+"}":"{"+n[l].fieldName+"}"):(g=this._getDimensionQuery(n[l],a,"rows",l,!1),d.push(g.replace(/["'\(\)]/g,"").replace(/["'\{\}]/g,"").replace(/\levels0/g,"levels(0)")),t.olap.base._isPaging&&c&&(f=this._getDimensionQuery(n[l],a,"rows",l,!0)),n[l].sortOrder&&n[l].sortOrder!=t.olap.SortOrder.None?(r=n[l].sortOrder==t.olap.SortOrder.Ascending?"asc":"desc",u=!0,s=s+(l>0?"*":"")+"{ORDER({HIERARCHIZE({"+(t.olap.base._isPaging&&c?f:g)+"})},"+n[l].fieldName+".CurrentMember.MEMBER_CAPTION,"+r+")}"):s=s+(l>0?"*":"")+"{HIERARCHIZE({({"+(t.olap.base._isPaging&&c?f:g)+"})})}")}t.olap.base._isPaging&&this._updateOlapReport(e(a)[0].rows,s,"rows",d),p&&(u=p),s=(u?" ":" HIERARCHIZE ")+"( {"+(t.olap.base._isPaging?s:this._updateOlapReport(e(a)[0].rows,s,"rows",d))+"})",p&&(s="HIERARCHIZE("+s+")")}m&&(o=t.olap._mdxParser._getMeasuresQuery(a),s=""!=s?(t.olap.base._isPaging?s.slice(0,-1):s)+(""!=s&&""!=o?t.olap.base._isPaging?"*":",":"")+o:(t.olap.base._isPaging&&""!=o?"(":"")+o),t.olap.base._isPaging&&(s=""!=s?""==o?("}"!=s[s.length-1]?s.slice(0,-1):s)+this._getDrilledSection(a,e.extend(!0,{},n),"row",o)+")":s+this._getDrilledSection(a,e.extend(!0,{},n),"row",o)+")":"")}else s=this._generateAxisMDXOnMondrian(a,n,m);return s},_generateAxisMDXOnMondrian:function(e,i,a){for(var l,r,n="",s=0;s<i.length;s++)l=t.olap.base._isPaging?"({"+i[s].fieldName+".children})":"DrillDownLevel({"+i[s].fieldName+"})",!t.isNullOrUndefined(i[s].drilledItems)&&i[s].drilledItems.length>0&&(l=this._getDrilledMDXOnMondrian(i[s].drilledItems,l)),!t.isNullOrUndefined(i[s].filterItems)&&!t.isNullOrUndefined(i[s].filterItems.values)&&i[s].filterItems.values.length>0&&(l="({{hierarchize(Union(Intersect((Except("+("Descendants("+i[s].fieldName+","+e._maxLevel+", SELF_AND_BEFORE)")+","+(r="{"+i[s].filterItems.values.join()+"}")+")),"+l+"),Except("+l+","+r+")))}})"),n+=(""==n?"":"*")+l;return a&&(n+=(""==n?"":"*")+t.olap._mdxParser._getMeasuresQuery(e)),n},_getDrilledMDXOnMondrian:function(e,i){for(var a=0;a<e.length;a++)i=t.olap.base._isPaging?"Except(DrillDownMember("+i+", {"+e[a].join()+"}),{"+e[a].join()+"})":"(DrillDownMember("+i+", {"+e[a].join()+"}))";return i},_getcolumnMDX:function(a){var l,r,n=e(a)[0].columns,s="",o="",d=[],u=!1,c=!1,p=a._isCollapse,m=a.values.length>0&&a.values[0].measures!=i&&a.values[0].axis==t.olap.AxisName.Column;if(t.isNullOrUndefined(a.providerName)||a.providerName==t.olap.Providers.SSAS){if(n.length>0){for(c=!t.isNullOrUndefined(n[0].drillCellInfo),l=0;l<n.length;l++){var h=!(!t.isNullOrUndefined(n[l].isNamedSets)&&n[l].isNamedSets),g=(u=!1,""),f="";n[l].fieldName!=i&&h?(g=this._getDimensionQuery(n[l],a,"columns",l,!1),d.push(g.replace(/["'\(\)]/g,"").replace(/["'\{\}]/g,"")),t.olap.base._isPaging&&c&&(f=this._getDimensionQuery(n[l],a,"columns",l,!0)),n[l].sortOrder&&n[l].sortOrder!=t.olap.SortOrder.None?(r=n[l].sortOrder==t.olap.SortOrder.Ascending?"asc":"desc",u=!0,s=s+(l>0?"*":"")+"{ ORDER ({HIERARCHIZE ({"+(t.olap.base._isPaging&&c?f:g)+"})},"+n[l].fieldName+".CurrentMember.MEMBER_CAPTION,"+r+")}"):s=s+(l>0?"*":"")+"{"+(t.olap.base._isPaging&&c?f:g)+"}"):s=l>0?s+"*{"+n[l].fieldName+"}":"{"+n[l].fieldName+"}"}t.olap.base._isPaging&&c&&this._updateOlapReport(e(a)[0].columns,s,"columns",d),p&&(u=p),s=(u?" ":" HIERARCHIZE ")+"( {"+(t.olap.base._isPaging?s:this._updateOlapReport(n,s,"columns",d))+"})",p&&(s="HIERARCHIZE("+s+")")}m&&(o=t.olap._mdxParser._getMeasuresQuery(a),s=""!=s?(t.olap.base._isPaging?s.slice(0,-1):s)+(""!=s&&""!=o?t.olap.base._isPaging?"*":",":"")+o:(t.olap.base._isPaging&&""!=o?"(":"")+o),t.olap.base._isPaging&&(s=""!=s?""==o?("}"!=s[s.length-1]?s.slice(0,-1):s)+this._getDrilledSection(a,e.extend(!0,{},n),"column",o)+")":s+this._getDrilledSection(a,e.extend(!0,{},n),"column",o)+")":"")}else s=this._generateAxisMDXOnMondrian(a,n,m);return s},_getDrilledSection:function(i,a,l,r){var n="";a=a;return e.each(a,function(i,a){t.isNullOrUndefined(a.drilledItems)||e.each(a.drilledItems,function(t,a){var l="",s="";e.each(a,function(e,t){l=""==l?"{"+t+"}":l+"*{"+t+"}",t=e==i?t.replace(".children",""):t,s=""==s?"{"+t+"}":s+"*{"+t+"}"}),""!=r&&(l=l+"*"+r,s=s+"*"+r),n=""==n?"+{"+l+"}-{"+s+"}":n+"+{"+l+"}-{"+s+"}"})}),n},_getSortedMembers:function(i){var a,l=i.fieldName;return i.sortOrder&&i.sortOrder!=t.olap.SortOrder.None?(a="ascending"==i.sortOrder?"asc":"desc",e.map(i.drilledItems,function(t){return e.map(t,function(e){return e.indexOf(l)>=0&&(e="order ( "+e+" , "+l+".CurrentMember.MEMBER_CAPTION,"+a+")"),e})})):i.drilledItems},_getAvailCount:function(i,a,l){var r=0;return e.each(i.split("--"),function(e,i){i=i.replace(l[e],""),a.split("--").length>0&&!t.isNullOrUndefined(a.split("--")[e])&&(r+=i.indexOf(a.split("--")[e])>-1&&!((i+"$").indexOf(a.split("--")[e])>-1)||a.split("--")[e].indexOf(i)>-1&&!(a.split("--")[e].indexOf(i+"$")>-1)?1:0)}),r},_updateTmpItems:function(i,a,l,r){var n=e.map(a.split("--"),function(e,i){return t.isNullOrUndefined(l.split("--")[i])||e.replace(r[i],"")!=l.split("--")[i].replace(r[i],"")||-1!=e.indexOf(r[i])?e:l.split("--")[i]}).join("--");-1==i.indexOf(n)&&i.push(n)},_updateExpandCollection:function(i,a,l){return e.each(a,function(r,n){e.each(a,function(a,r){var s,o,d;n!=r&&(s=0,e.each(r.split("--"),function(e,i){i=i.replace(l[e],""),t.isNullOrUndefined(n.split("--")[e])||(s+=r.split(l[e]).join("").indexOf(n.split("--")[e].replace(l[e],""))>-1||n.split("--")[e].replace(l[e],"").indexOf(i)>-1?1:0)}),s==r.split("--").length&&t.olap._mdxParser._updateTmpItems(i,n,r,l),s==n.split("--").length&&t.olap._mdxParser._updateTmpItems(i,r,n,l),o=[],d=0,e.each(r.split("--"),function(e,i){var a=n.split("--").length>e?n.split("--")[e]:"";t.isNullOrUndefined(a)||""==a||(i!=a&&i.indexOf("$")>-1&&(i.indexOf(a)>-1||a.indexOf(i)>-1)&&n.split("--").length-1>e?(o.push(i),d++):o.push(a))}),d>0&&i.push(o.concat(e.map(n.split("--"),function(e,t){if(t>=o.length)return e})).join("--")))})}),i},_updateDrillQuery:function(i,a,l,r){var n,s,o,d=t.olap.base._isRowDrilled||t.olap.base._isColDrilled,u=e.map(i,function(i){var a=e.map(t.olap.base.olapCtrlObj._prevDrillElements,function(e){if(e.indexOf(i.fieldName)>-1)return e}).join("$");if(""!=a)return a}).join("--"),c=e.map(r,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),p=e.map(i,function(e){return!t.isNullOrUndefined(e.hasAllMember)&&e.hasAllMember?".levels(0).AllMembers":".children"});d||""==u||(t.isNullOrUndefined(i[u.split("--").length-1]._prevDimElements)||-1!=i[u.split("--").length-1]._prevDimElements.indexOf(u+p[u.split("--").length-1])?i[u.split("--").length-1]._prevDimElements=i[u.split("--").length-1]._prevDimElements.filter(function(e){if(t.olap._mdxParser._getAvailCount(e,u,p)!=u.split("--").length)return e}):i[u.split("--").length-1]._prevDimElements.push(u+p[u.split("--").length-1]+"!#collapse")),i=e.map(i,function(i){return t.isNullOrUndefined(i._prevDimElements)?i:(i._prevDimElements=e.map(i._prevDimElements,function(i){var a=-1!=i.indexOf("!#collapse");return d?i.indexOf("!#collapse")>-1?(i=i.replace("!#collapse",""),t.olap._mdxParser._getAvailCount(i,u,p)!=u.split("--").length?i:void 0):i:""!=u?(i=i.replace("!#collapse",""),t.olap._mdxParser._getAvailCount(i,u,p)==u.split("--").length?e.map(i.split("--"),function(e,t){return t==u.split("--").length-1&&-1==e.indexOf(p[t])?u.split("--")[u.split("--").length-1]+"":e}).join("--")+(a?"!#collapse":""):i+(a?"!#collapse":"")):i}),""!=u&&(i._prevDimElements=e.map(i._prevDimElements,function(e){if(!(e.indexOf("!#collapse")>-1&&i._prevDimElements.filter(function(e){if(-1==e.indexOf("!#collapse"))return e}).indexOf(e.replace("!#collapse",""))>-1||-1==e.indexOf("!#collapse")&&i._prevDimElements.map(function(e){if(e.indexOf("!#collapse")>-1)return e.replace("!#collapse","")}).indexOf(e)>-1))return e})),i)});var m=e.map(i,function(e){if(!t.isNullOrUndefined(e._prevDimElements))return e._prevDimElements}).filter(function(e){if(-1==e.indexOf("!#collapse"))return e}),h=e.map(i,function(e){if(!t.isNullOrUndefined(e._prevDimElements))return e._prevDimElements}).filter(function(e){if(e.indexOf("!#collapse")>-1)return e}).map(function(e){return e.replace("!#collapse","")}),g=0==u.length?i.length:u.split("--").length,f=[];return d&&(m=e.map(m,function(e){if(t.olap._mdxParser._getAvailCount(e,u,p)==u.split("--").length)return e})),n=t.olap._mdxParser._updateExpandCollection([],m,p),s=t.olap._mdxParser._updateExpandCollection([],n,p),m=m.concat(n.concat(s)),n=[],e.each(m,function(t,i){e.each(h,function(t,a){var l=[],r=0;i.split("--").length>a.split("--").length&&(e.each(a.split("--"),function(e,t){var a=i.split("--")[e];(t.replace(p[e],"").indexOf(a.replace(p[e],""))>-1||a.replace(p[e],"").indexOf(t.replace(p[e],""))>-1)&&(l.push(t),r++)}),a.split("--").length==r&&r<i.split("--").length&&-1==n.indexOf(l.concat(e.map(i.split("--"),function(e,t){if(t>=l.length)return e})).join("--"))&&-1==h.indexOf(l.concat(e.map(i.split("--"),function(e,t){if(t>=l.length)return e})).join("--"))&&n.push(l.concat(e.map(i.split("--"),function(e,t){if(t>=l.length)return e})).join("--")))})}),h=h.concat(n),m=e.map(m,function(i){var a=d?g:i.split("--").length;return e.map(i.split("--"),function(e,i){return i<a-1?!t.isNullOrUndefined(u.split("--")[i])&&(u.split("--")[i].indexOf(e.replace(p[i],"")>-1)||e.replace(p[i],"").indexOf(u.split("--")[i])>-1)&&d?c[i].split("&amp;").join("&"):e.split("$")[e.split("$").length-1]:i==a-1?d?c[i].split("&amp;").join("&"):e.replace(p[i],"").split("$")[e.split("$").length-1]+p[i]:e.split("$")[e.split("$").length-1]}).join("--")}).sort(function(e,t){return e.split("--").length-t.split("--").length}),m=e.map(m,function(t){var i=[];return(i=t.split("--").length<c.length?[t.split("&").join("&amp;").split("--").concat(e.map(c,function(e,i){if(t.split("--").length-1<i)return e}))]:[t.split("&").join("&amp;").split("--")]).join()!=c.join()?i:void 0}),h=e.map(h,function(t){return t.split("--").length<c.length?[t.split("&").join("&amp;").split("--").map(function(e){return e.split("$")[e.split("$").length-1]}).concat(e.map(c,function(e,i){if(t.split("--").length-1<i)return e}))]:[t.split("&").join("&amp;").split("--").map(function(e){return e.split("$")[e.split("$").length-1]})]}),f=[],e.each(e.map(m,function(e){return e.join("--")}),function(e,t){(0==f.length||-1==f.indexOf(t))&&f.push(t)}),o={expandCollection:m=e.map(f,function(e){return[e.split("--")]}),collapseCollection:h},m.length>0&&i.length>1&&r[r.length-1].indexOf(".children")<0&&(a=this._getDrillQuery(o,a,i)),a},_updateOlapReport:function(a,l,r,n){var s,o,d,u=this;return"rows"==r?(s=e.map(a,function(e,t){if(a[t].drilledItems!=i)return u._getSortedMembers(e,a)}),t.olap.base._isRowDrilled&&"rows"==t.olap.base._currIndex.axis&&a[t.olap.base._currIndex.Index]!=i&&a[t.olap.base._currIndex.Index].drilledItems!=i?(d=e.map(n,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),a[t.olap.base._currIndex.Index].drilledItems.push(d),t.olap.base._isRowDrilled=!1):s.length>0&&(t.olap.base._currIndex.axis==i||"columns"==t.olap.base._currIndex.axis&&!t.olap.base._isRowDrilled)&&(l=this._getDrillQuery(s,l,a)),t.isNullOrUndefined(t.olap.base._currIndex.axis)||"rows"!=t.olap.base._currIndex.axis||(t.olap.base._currIndex={})):(o=e.map(a,function(e,t){if(a[t].drilledItems!=i)return u._getSortedMembers(e,a)}),t.olap.base._isColDrilled&&"columns"==t.olap.base._currIndex.axis&&a[t.olap.base._currIndex.Index]!=i&&a[t.olap.base._currIndex.Index].drilledItems!=i?(d=e.map(n,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),a[t.olap.base._currIndex.Index].drilledItems.push(d),t.olap.base._isColDrilled=!1):o.length>0&&(t.olap.base._currIndex.axis==i||"rows"==t.olap.base._currIndex.axis&&!t.olap.base._isColDrilled)&&(l=this._getDrillQuery(o,l,a)),t.isNullOrUndefined(t.olap.base._currIndex.axis)||"columns"!=t.olap.base._currIndex.axis||(t.olap.base._currIndex={})),l},_getDrillQuery:function(a,l,r){for(var n,s,o,d="",u=a,c=0;c<u.length;c++)if(u[c][u[c].length-1].toLowerCase().indexOf(".children")>=0||u[c][u[c].length-1].toLowerCase().indexOf("drilldownlevel")>=0||u[c][u[c].length-1].toLowerCase().indexOf("members")>=0||(u[c][u[c].length-1]=u[c][u[c].length-1]+".children"),u[c].length!=r.length){for(n=e.map(r,function(a){if(a.fieldName!=i&&a.fieldName!=u[c][[u[c].length-1]].split(".").splice(0,2).join("."))return{uniqueName:t.olap.base._isPaging?"("+e.trim(a.fieldName)+").children":"DrillDownLevel("+e.trim(a.fieldName)+")",fieldName:e.trim(a.fieldName)}}),s=0;s<n.length;s++)o=this._getItemPosition(r,n[s].fieldName)[0],u[c].toString().indexOf(n[s].fieldName)>=0||u[c].splice(o,0,n[s].uniqueName);d=d+""+(c>0?",":"")+"\n ("+u[c]+")"}else d=d+""+(c>0?",":"")+"\n ("+u[c].toString()+")\n";return"("+l+"),"+d},_createDrillThroughQuery:function(i,a){var l,r;if(a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)a._waitingPopup.show(),l=e(a.element).hasClass("e-pivotclient")?a.element.find(".e-pivotgrid").data("ejPivotGrid"):a,a.doAjaxPost("POST",a.model.url+"/"+a.model.serviceMethodSettings.drillThroughDataTable,JSON.stringify({currentReport:e(a.element).parents(".e-pivotclient").length>0?a.currentReport:JSON.parse(l.getOlapReport()).Report,layout:e(a.element).hasClass("e-pivotclient")?a.model.gridLayout:a.model.layout,cellPos:"",selector:i}),function(e){this._trigger("drillThrough",{element:e.element,data:e})}),a._waitingPopup.hide();else{var n=a.measureGrp,s="",o="DRILLTHROUGH Select("+a._colHeader.join()+","+a._rowHeader.join()+") on 0 from ["+a.model.dataSource.cube+"]";e.map(a._fieldData.measures,function(e){e.pid==n&&(s+=""==s?"["+n+"]."+e.id.split(".")[1]:",["+n+"]."+e.id.split(".")[1])}),o=o.replace(/&/g,"&amp;"),r=a._getConnectionInfo(a.model.dataSource.data),pData='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+o+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+a.model.dataSource.catalog+"</Catalog> </PropertyList> </Properties></Execute> </Body> </Envelope>",a.doAjaxPost("POST",r.url,{XMLA:pData},t.Pivot._generateDrillData,null,{pvtGridObj:a,action:"loadFieldElements"})}},_getDimensionQuery:function(a,l,r,n,s){var o="";return a.drillCellInfo==i||s?o=t.isNullOrUndefined(a.expression)?t.isNullOrUndefined(a.hasAllMember)||!a.hasAllMember?t.olap.base._isPaging?"(("+e.trim(a.fieldName)+").children)":"DrillDownlevel(("+e.trim(a.fieldName)+"))":"(("+e.trim(a.fieldName)+").levels(0).AllMembers)":"("+a.hierarchyUniqueName+".["+(a.fieldCaption||a.fieldName)+"])":(o="{("+a.drillCellInfo.uniqueName+")}",delete a.drillCellInfo),o},_updateReport:function(i,a,l,r){var n,s,o,d={};r._isMondrian?(n=a.preRepItm.split(">#>"),s=(o=a.itemPosition)?a.previousElements.split(n[o-1])[1].split("][").length:a.previousElements.split("][").length,l.drilledItems&&(l.drilledItems.length<=s-1&&(l.drilledItems[s-1]=[]),a.action&&"collapse"==a.action?l.drilledItems[s-1]=e.grep(l.drilledItems[s-1],function(e){return e!=n[o]}):l.drilledItems[s-1].push(n[o])),d={action:"mondrianDrilldown"}):(l.drillCellInfo=e.extend({},a),l.drillCellInfo.uniqueName="("+e.trim(l.drillCellInfo.uniqueName)+".children)",d={action:"drilldown",cellInfo:a}),t.olap.base.getJSONData(d,r.model.dataSource,r)},_splitCellInfo:function(e){var i,a=t.olap.base.olapCtrlObj._isMondrian?1:2;return e&&(i={hierarchyUniqueName:e.split("::")[1].split(".").splice(0,a).join("."),uniqueName:e.split("::")[0],levelUniqueName:e.split("::")[1],leveName:e.split("::")[2],parentUniqueName:e.split("::")[3]}),i},updateDrilledReport:function(a,l,r){var n,s,o,d,u;t.olap.base._isPaging&&!t.isNullOrUndefined(r._pagingSavedObjects.curDrilledItem)&&(r._pagingSavedObjects.curDrilledItem=a);t.olap._mdxParser;var c,p,m,h=null,g="",f="";if((c=this._splitCellInfo(a.uniqueName)).targetUName=a.uniqueName,c.previousElements="",(p="rowheader"==l?r.model.dataSource.rows:"colheader"==l?r.model.dataSource.columns:null).length>0){if(h=(m=e.map(p,function(t,a){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(c.hierarchyUniqueName).toLowerCase()?{report:t,index:a}:t.hierarchyUniqueName!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(c.hierarchyUniqueName).toLowerCase()?{report:t,index:a}:void 0}))[0].report,c.itemPosition=m[0].index,!t.isNullOrUndefined(r._pivotRecords)||t.isNullOrUndefined(r._pivotClientObj)||t.isNullOrUndefined(r._pivotClientObj._pivotRecords)||(r._pivotRecords=r._pivotClientObj._pivotRecords),n=e.map(r._pivotRecords.records,function(e){if(e.Info.replace(/&/g,"&amp;")==a.uniqueName)return e.Index}),h.drilledItems!=i?h.drilledItems:h.drilledItems=[],t.olap.base._currIndex={axis:"rowheader"==l?"rows":"columns",Index:m[0].index},"ejPivotChart"==r.pluginName||"ejPivotTreeMap"==r.pluginName||t.isNullOrUndefined(a.index)){for(c.cellIndex=n.length>0?"":a.index,c.axis=b=l,"rowheader"!=l?t.olap.base._isColDrilled=a.action==i||"collapse"!=a.action:t.olap.base._isRowDrilled=a.action==i||"collapse"!=a.action,s=0;s<r.model.dataSource.rows.length&&a.seriesInfo[s]!=a.uniqueName;s++)r.model.dataSource.rows[s].drillCellInfo=this._splitCellInfo(a.seriesInfo[s]);for(c.previousElements="",c.preRepItm="",s=0;s<a.uniqueNameArray.length;s++)c.previousElements+=this._splitCellInfo(a.uniqueNameArray[s]).uniqueName;for(s=0;s<a.seriesInfo.length;s++)c.preRepItm+=""==c.preRepItm?this._splitCellInfo(a.seriesInfo[s]).uniqueName:">#>"+this._splitCellInfo(a.seriesInfo[s]).uniqueName}else{c.cellIndex=a.index;var _=c.hierarchyUniqueName,b="",v=(g="",""),C=c.cellIndex.split(",")[0],S=c.cellIndex.split(",")[1];if("rowheader"==l)for(b="rowheader",t.olap.base._isRowDrilled=a.action==i||"collapse"!=a.action,s=parseInt(C);s>=0;s--)!r._pivotRecords.records[parseInt(s*r._pivotRecords.rowCount+parseInt(C))].Info.indexOf(_)>=0&&(v=r._pivotRecords.records[parseInt(s*r._pivotRecords.rowCount+parseInt(S))].Info,(o=this._splitCellInfo(v))&&(g=o.uniqueName+g),""==v||v.indexOf(_)>=0||((d=this._splitCellInfo(v)).uniqueName=d.uniqueName.replace(/&/g,"&amp;"),f=d.uniqueName+">#>"+f,currReport=e.map(p,function(t,a){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?a:t.hierarchyUniqueName!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?a:void 0}),"collapse"!=a.action&&(r.model.dataSource.rows[currReport[0]].drillCellInfo=d),_=d.hierarchyUniqueName));else for(b="colheader",t.olap.base._isColDrilled=a.action==i||"collapse"!=a.action,s=parseInt(S);s>=0;s--)!r._pivotRecords.records[parseInt(C*r._pivotRecords.rowCount+parseInt(s))].Info.indexOf(_)>=0&&(v=r._pivotRecords.records[parseInt(C*r._pivotRecords.rowCount+parseInt(s))].Info,(o=this._splitCellInfo(v))&&(g=o.uniqueName+(r._isMondrian?"":">#>")+g),""==v||v.indexOf(_)>=0||((d=this._splitCellInfo(v)).uniqueName=d.uniqueName.replace(/&/g,"&amp;"),f=d.uniqueName+(r._isMondrian?">#>":"")+f,currReport=e.map(p,function(t,a){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?a:t.expression!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?a:void 0}),"collapse"!=a.action&&(r.model.dataSource.columns[currReport[0]].drillCellInfo=d),_=d.hierarchyUniqueName));f+=c.uniqueName,c.previousElements=g.replace(/&amp;/g,"&"),c.preRepItm=f.replace(/&amp;/g,"&"),c.axis=b}if(c.previousElements=c.previousElements.replace(/&amp;/g,"&"),c.preRepItm=c.preRepItm.replace(/&amp;/g,"&"),a.action)if(a.action){if(r._isMondrian)return c.action="collapse",void t.olap._mdxParser._updateReport(h.drilledItems,c,h,r);if(t.isNullOrUndefined(c)||t.isNullOrUndefined(c.previousElements)||""==c.previousElements||(t.olap.base.olapCtrlObj._prevDrillElements=c.previousElements.split("][").join("]>#>[").split(">#>")),(u=t.olap.base._getDrilledMemeber({item:c})).length&&!t.olap.base._isPaging)t.olap.base._onDemandCollapse({drilledMembers:u,action:a.action},b);else{for(;0!=u.length;)t.olap.base.olapCtrlObj.model.dataSource=t.olap._mdxParser._clearCollapsedItems(b,u[u.length-1],t.olap.base.olapCtrlObj.model.dataSource),u=u.splice(0,u.length-1);t.olap.base.getJSONData(a,t.olap.base.olapCtrlObj.model.dataSource,t.olap.base.olapCtrlObj)}}else e(a.drilledMember).clone(!0),t.olap.base._onDemandExpand({action:"drilldown",cellInfo:c,isExist:!0},a.drilledMember);else u=t.olap.base._getDrilledMemeber({item:c}),t.olap._mdxParser._updateReport(h.drilledItems,c,h,r)}},_clearCollapsedItems:function(t,a,l){return"rowheader"==t?l.rows=e.map(l.rows,function(t){return t.drilledItems!=i&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(a.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t}):"colheader"==t&&(l.columns=e.map(l.columns,function(t){return t.drilledItems!=i&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(a.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t})),l},_getSlicerMDX:function(t,a){for(var l=e(t)[0].filters,r="",n=this,s=a._fieldData,o=e.merge(e.merge([],t.columns),t.rows),d=0;d<l.length;d++)e.grep(o,function(e){var t=n._getDimensionUniqueName(e.fieldName,s),i=n._getDimensionUniqueName(l[d].fieldName,s);return t==i&&!(a._isMondrian&&""==i&&""==t)}).length>0||(l[d].fieldName!=i&&l[d].filterItems==i?r=r+(""!=r?"*":"")+"{"+this._getDimensionQuery(l[d])+"}":l[d].filterItems!=i&&(r=r+(""!=r?"*":"")+"{"+l[d].filterItems.values.toString()+"}"));return""!=r?"where ("+r.replace(/DrillDownlevel/g,"")+")":""},_getDimensionUniqueName:function(t,i){var a,l=i.hierarchy;return l?(a=e.map(l,function(e){if(e.id.toLowerCase()==t.toLowerCase())return e.pid})).length>0?a[0]:"":t.split(".")[0]},_getMeasuresQuery:function(t){var a,l,r,n=e(t)[0].values,s=[];return n.length>0&&(null!=(r=(l=jQuery.map(n,function(e,t){if(e.measures!=i)return{measureElements:e.measures,Index:t,axisName:e.axis}})).length>0?e.map(l[0].measureElements,function(e){return e.fieldName}):null)&&s.push({values:r,Index:l[0].Index}),n.axis),""!=(a=e.map(s,function(e){return e.values.toString()}))[0]?"{"+a+"}":""},_getIncludefilterQuery:function(t,a,l){var r,n,s,o="FROM ["+a+"]",d="FROM ( SELECT (",u=l._fieldData,c=[],p="COLUMNS";if(l._isMondrian)return o;for(r=e.map(e(t.rows),function(e){if(e.filterItems!=i)return[e.filterItems.values]}),n=e.map(e(t.columns),function(e){if(e.filterItems!=i)return[e.filterItems.values]}),s=0;s<t.filters.length;s++){var m=t.filters,h=this,g=!1;e.map(t.columns,function(e){h._getDimensionUniqueName(e.fieldName,u)==h._getDimensionUniqueName(m[s].fieldName,u)&&m[s].filterItems!=i&&(n.push(m[s].filterItems.values),g=!0)}),g||e.map(t.rows,function(e){h._getDimensionUniqueName(e.fieldName,u)==h._getDimensionUniqueName(m[s].fieldName,u)&&m[s].filterItems!=i&&r.push(m[s].filterItems.values)})}if(t.enableAdvancedFilter){for(s=0;s<=t.columns.length-1;s++)t.columns[s].advancedFilter&&e.merge(c,this._getAdvancedFilterQuery(t.columns[s],d,p));for(s=0;s<=t.rows.length-1;s++)t.rows[s].advancedFilter&&e.merge(c,this._getAdvancedFilterQuery(t.rows[s],d,p))}for(s=0;s<=n.length-1;s++)d=0==s?d+"{"+n[s].toString()+"}":d+",{"+n[s].toString()+"}";for(n.length>0&&(d=r.length>0?d+" ) on COLUMNS ,(":d+" ) on COLUMNS "),s=0;s<=r.length-1;s++)d=s>0?d+",{"+r[s].toString()+"}":d+"{"+r[s].toString()+"}";return d=n.length>0&&r.length>0?d+=") on ROWS ":0==n.length&&r.length>0?d+") on COLUMNS ":d,c.length>0&&(c=(n.length>0||r.length>0?d:"")+" "+c.join(" ")+" "+o+Array(c.length+1+n.length+r.length).join(")")),o=0==n.length&&0==r.length?o:d+o+")",c.length>0?c:o},_getAdvancedFilterQuery:function(i,a,l){var r=[],n=this;return e.map(i.advancedFilter,function(a){t.isNullOrUndefined(a.labelFilterOperator)&&a.labelFilterOperator==t.olap.LabelFilterOptions.None&&t.isNullOrUndefined(a.valueFilterOperator)&&a.valueFilterOperator==t.olap.ValueFilterOptions.None||r.push("FROM (SELECT Filter("+e.trim(a.name)+".AllMembers, "+n._getAdvancedFilterCondtions(i.fieldName,a.advancedFilterType==t.olap.AdvancedFilterType.LabelFilter||t.isNullOrUndefined(a.advancedFilterType)?a.labelFilterOperator:a.valueFilterOperator,a.values,a.advancedFilterType,a.measure)+")) on "+l)}),r},_getAdvancedFilterCondtions:function(e,i,a,l,r){var n="";l=t.isNullOrUndefined(l)?"label":l;switch(i.toLowerCase()){case"equals":n="("+("value"!=l?e+'.CurrentMember.member_caption ="'+a[0]+'"':r+" = "+a[0]);break;case"notequals":n="("+("value"!=l?e+'.CurrentMember.member_caption &lt;&gt;"'+a[0]+'"':r+" &lt;&gt;"+a[0]);break;case"contains":n="( InStr (1,"+e+'.CurrentMember.member_caption,"'+a[0]+'")&gt;0';break;case"notcontains":n="( InStr (1,"+e+'.CurrentMember.member_caption,"'+a[0]+'")=0';break;case"beginswith":n="( Left ("+e+".CurrentMember.member_caption,"+a[0].length+')="'+a[0]+'"';break;case"notbeginswith":n="( Left ("+e+".CurrentMember.member_caption,"+a[0].length+')&lt;&gt;"'+a[0]+'"';break;case"endswith":n="( Right ("+e+".CurrentMember.member_caption,"+a[0].length+')="'+a[0]+'"';break;case"notendswith":n="( Right ("+e+".CurrentMember.member_caption,"+a[0].length+')&lt;&gt;"'+a[0]+'"';break;case"greaterthan":n="("+("value"!=l?e+'.CurrentMember.member_caption &gt;"'+a[0]+'"':r+" &gt;"+a[0]);break;case"greaterthanorequalto":n="("+("value"!=l?e+'.CurrentMember.member_caption &gt;="'+a[0]+'"':r+" &gt;="+a[0]);break;case"lessthan":n="("+("value"!=l?e+'.CurrentMember.member_caption &lt;"'+a[0]+'"':r+" &lt;"+a[0]);break;case"lessthanorequalto":n="("+("value"!=l?e+'.CurrentMember.member_caption &lt;="'+a[0]+'"':r+" &lt;="+a[0]);break;case"between":n="("+("value"!=l?e+'.CurrentMember.member_caption &gt;="'+a[0]+'"AND '+e+'.CurrentMember.member_caption &lt;="'+a[1]+'"':r+" &gt;="+a[0]+" AND "+r+"&lt;="+a[1]);break;case"notbetween":n="("+("value"!=l?e+'.CurrentMember.member_caption &gt;="'+a[0]+'"OR '+e+'.CurrentMember.member_caption &lt;="'+a[1]+'"':r+" &gt;="+a[0]+" OR "+r+"&lt;="+a[1]);break;default:n="( InStr (1,"+e+'.CurrentMember.member_caption,"'+a[0]+'")&gt;0'}return n},_getItemPosition:function(t,a){return e.map(t,function(t,l){if(t.fieldName!=i&&e.trim(t.fieldName)==e.trim(a))return l})},getAllMember:function(i,a,l){if(!t.isNullOrUndefined(l)){var r="select {"+a+"} dimension properties CHILDREN_CARDINALITY on 0 from ["+e.trim(i.cube)+"]",n=t.olap._mdxParser.getSoapMsg(r,i.data,i.catalog),s=t.olap.base._getConnectionInfo(i.data);l.doAjaxPost("POST",s.url,{XMLA:n},l._generateAllMember,null,{action:"loadFieldElements"})}},getMembers:function(i,a,l){var r=t.Pivot.getReportItemByFieldName(a,i).item;t.olap.base.olapCtrlObj._isMondrian&&(t.isNullOrUndefined(l.model.pivotControl)||(this._controlObj=l.model.pivotControl));var n="select {"+(r&&r.hasAllMember?a+".levels(0).AllMembers":a+".children")+"}dimension properties CHILDREN_CARDINALITY, MEMBER_TYPE on 0 from ["+e.trim(i.cube)+"]",s=t.olap._mdxParser.getSoapMsg(n,i.data,i.catalog),o=t.olap.base._getConnectionInfo(i.data);l.doAjaxPost("POST",o.url,{XMLA:s},l._generateMembers,null,{action:"fetchMembers"})},getChildren:function(e,i,a){var l,r,n="select {"+i+".children} dimension properties CHILDREN_CARDINALITY on 0 from ["+e.cube+"]",s=a.model.pivotControl;!t.isNullOrUndefined(s)&&t.olap.base.olapCtrlObj._isMondrian&&(this._controlObj=a.model.pivotControl),l=t.olap._mdxParser.getSoapMsg(n,e.data,e.catalog),r=t.olap.base._getConnectionInfo(e.data),a.doAjaxPost("POST",r.url,{XMLA:l},t.Pivot.generateChildMembers,null,{action:"nodeExpand",currentNode:i})},getSoapMsg:function(e,i,a){var l,r=t.olap.base._getConnectionInfo(i);return!t.isNullOrUndefined(this._controlObj)||!t.isNullOrUndefined(t.olap.base.olapCtrlObj)&&t.olap.base.olapCtrlObj._isMondrian?(l='<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+e+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+(t.isNullOrUndefined(this._controlObj)?t.olap.base.olapCtrlObj.model.dataSource.sourceInfo:this._controlObj.model.dataSource.sourceInfo)+"</DataSourceInfo><Catalog>"+a+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>",delete this._controlObj):l='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+e+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+a+"</Catalog> <LocaleIdentifier>"+r.LCID+"</LocaleIdentifier></PropertyList> </Properties> </Execute> </Body> </Envelope>",l}},t.olap.SortOrder={None:"none",Ascending:"ascending",Descending:"descending"},t.olap.Providers={SSAS:"ssas",Mondrian:"mondrian"},t.olap.AdvancedFilterType={LabelFilter:"label",ValueFilter:"value"},t.olap.ValueFilterOptions={None:"none",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.olap.LabelFilterOptions={None:"none",BeginsWith:"beginswith",NotBeginsWith:"notbeginswith",EndsWith:"endswith",NotEndsWith:"notendswith",Contains:"contains",NotContains:"notcontains",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.olap.AxisName={Row:"rows",Column:"columns"}}(jQuery,Syncfusion)})},1010:function(e,t,a){var l,r,n;
/*!
*  filename: ej.pivot.common.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivot.common.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(i){r=[a(4)],void 0===(n="function"==typeof(l=i)?l.apply(t,r):l)||(e.exports=n)}(function(){ej.Pivot=ej.Pivot||{},function(e,t,a){t.Pivot={addReportItem:function(e,i){var a,l;if(i.isMeasuresDropped)""!=i.droppedClass?e.values[0].axis="row"==i.droppedClass?"rows":"column"==i.droppedClass?"columns":e.values[0].axis:e.values[0].measures=[];else{for(l in a=this.removeReportItem(e,i.droppedFieldName,i.isMeasuresDropped),t.isNullOrUndefined(a)&&(a={fieldName:i.droppedFieldName,fieldCaption:i.droppedFieldCaption,format:i.droppedFieldFormat,formatString:i.droppedFieldFormatString,showSubTotal:i.droppedFieldShowSubTotal,expression:i.droppedExpression,hierarchyUniqueName:i.droppedHierarchyUniqueName,summaryType:i.summaryType}),a)("format"==l||"formatString"==l)&&(t.isNullOrUndefined(a[l])||""==a[l])&&delete a[l];switch(i.droppedClass){case"row":""!=i.droppedPosition.toString()?e.rows.splice(i.droppedPosition,0,a):e.rows.push(a);break;case"column":""!=i.droppedPosition.toString()?e.columns.splice(i.droppedPosition,0,a):e.columns.push(a);break;case"value":""==e.cube?""!=i.droppedPosition.toString()?e.values.splice(i.droppedPosition,0,a):e.values.push(a):""!=i.droppedPosition.toString()?e.values[0].measures.splice(i.droppedPosition,0,a):e.values[0].measures.push(a);break;case"filter":""!=i.droppedPosition.toString()?e.filters.splice(i.droppedPosition,0,a):e.filters.push(a)}}},removeReportItem:function(i,a,l){var r,n=""==i.cube?t.Pivot.AnalysisMode.Pivot:t.Pivot.AnalysisMode.Olap,s=e.grep(i.columns,function(e){return e.fieldName==a});return l?i.values[0].measures=[]:s.length>0?i.columns=e.grep(i.columns,function(e){return e.fieldName!=a}):(s=e.grep(i.rows,function(e){return e.fieldName==a})).length>0?i.rows=e.grep(i.rows,function(e){return e.fieldName!=a}):(r=n==t.Pivot.AnalysisMode.Olap?i.values[0].measures:i.values,(s=e.grep(r,function(e){return e.fieldName==a})).length>0?i.values=n==t.Pivot.AnalysisMode.Olap?[{measures:e.grep(r,function(e){return e.fieldName!=a}),axis:i.values[0].axis}]:e.grep(r,function(e){return e.fieldName!=a}):(s=e.grep(i.filters,function(e){return e.fieldName==a})).length>0&&(i.filters=e.grep(i.filters,function(e){return e.fieldName!=a}))),s[0]},getReportItemByFieldName:function(i,a){var l,r="columns",n=e.grep(a.columns,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()});return 0==n.length&&(n=e.grep(a.rows,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="rows"),0==n.length&&(l=""==a.cube?a.values:a.values.length>0&&!t.isNullOrUndefined(a.values[0].measures)?a.values[0].measures:[],n=e.grep(l,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="values"),0==n.length&&(n=e.grep(a.filters,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="filters"),{item:n[0],axis:r}},getReportItemByFieldCaption:function(i,a){var l,r="columns",n=e.grep(a.columns,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()});return 0==n.length&&(n=e.grep(a.rows,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="rows"),0==n.length&&(l=""==a.cube?a.values:a.values.length>0&&!t.isNullOrUndefined(a.values[0].measures)?a.values[0].measures:[],n=e.grep(l,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="values"),0==n.length&&(n=e.grep(a.filters,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="filters"),{item:n[0],axis:r}},closePreventPanel:function(i){var a="close"!=i.type?i:this;a.element.find("[id^='preventDiv']").remove(),t.isNullOrUndefined(a.model.pivotControl)?a._currentReportItems=e.extend(!0,[],a._savedReportItems):(a.model.pivotControl.element.find("[id^='preventDiv']").remove(),a.model.pivotControl._currentReportItems=e.extend(!0,[],a.model.pivotControl._savedReportItems)),t.isNullOrUndefined(a._waitingPopup)||a._waitingPopup.hide(),t.isNullOrUndefined(a.model.pivotControl)||t.isNullOrUndefined(a.model.pivotControl._waitingPopup)||a.model.pivotControl._waitingPopup.hide()},openPreventPanel:function(i){var a=t.buildTag("div#preventDiv.errorDlg").css({width:e("body").width()+"px",height:e("body").height()+"px",position:"absolute",top:e("body").offset().top+"px",left:e("body").offset().left+"px","z-index":10})[0].outerHTML;e("#"+i._id).append(a)},_createErrorDialog:function(i,a,l){var r,n;if(t.Pivot.closePreventPanel(l),l._errorDialog=a,t.Pivot.openPreventPanel(l),0==l.element.find(".e-errorDialog:visible").length&&(r=t.isNullOrUndefined(i.Exception)?t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent action:",i)[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn",l._getLocalizedLabels("OK"),{margin:"20px 0 10px 165px"}).attr("title",l._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML)[0].outerHTML).attr("title",a)[0].outerHTML:t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent action:",i.Exception.Message)[0].outerHTML+t.buildTag("br")[0].outerHTML+t.buildTag("div."+l._id+"stackTraceContent","Stack Trace :"+i.Exception.StackTraceString)[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn",l._getLocalizedLabels("OK"),{margin:"20px 0 10px 165px"}).attr("title",l._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML)[0].outerHTML).attr("title",a)[0].outerHTML,l.element.append(r),l.element.find(".e-errorDialog").ejDialog({target:"#"+l._id,enableResize:!1,enableRTL:l.model.enableRTL,width:"400px",close:t.proxy(t.Pivot.closePreventPanel,l)}),n=l.element.find(".e-errorDialog").data("ejDialog"),e("#"+n._id+"_wrapper").css({left:"50%",top:"50%"}),l.element.find(".errOKBtn").ejButton({type:t.ButtonType.Button,width:"50px"}).on(t.eventType.click,function(){"nodeCheck"!=l._errorDialog||t.isNullOrUndefined(l._schemaData)||t.isNullOrUndefined(l._schemaData._selectedTreeNode)||l._schemaData._tableTreeObj.uncheckNode(l._schemaData._selectedTreeNode),l.element.find("#preventDiv").remove(),(l._errorDialog==l._getLocalizedLabels("Success")||l._errorDialog==l._getLocalizedLabels("Warning")||l._errorDialog==l._getLocalizedLabels("Exception")||l._errorDialog==l._getLocalizedLabels("Error"))&&l.element.children("#ErrorDialog_wrapper").remove()}),l.element.find(".e-dialog .e-close").attr("title","Close"),t.isNullOrUndefined(e("#"+l._id).data("ejWaitingPopup"))||e("#"+l._id).data("ejWaitingPopup").hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide(),!t.isNullOrUndefined(i.Exception))){var s="Show more";e("."+l._id+"stackTraceContent").each(function(){var i=e(this).html();if(i.length>50){l._id;var a=i.substr(0,50),r=i.substr(50,i.length-50),n=a+t.buildTag("span."+l._id+"moreellipses","...")[0].outerHTML+t.buildTag("span."+l._id+"morecontent",t.buildTag("span",r).css("display","none")[0].outerHTML+t.buildTag("a."+l._id+"morelink",s).css("display","block")[0].outerHTML)[0].outerHTML;e(this).html(n)}}),e("."+l._id+"morelink").click(function(){return e(this).hasClass("less")?(e(this).removeClass("less"),e(this).html(s)):(e(this).addClass("less"),e(this).html("Show less")),e(this).parent().prev().toggle("slow",function(){}),e(this).prev().toggle("slow",function(){}),!1})}},_updateValueSortingIndex:function(i,l){if(i.SortColIndex!=a)t.PivotAnalysis._valueSorting=JSON.parse(i.SortColIndex)[0],t.PivotAnalysis._sort=l.model.valueSortSettings.sortOrder;else{i=i[0]!=a?i:i.d!=a?i.d:i;var r=e.map(i,function(e){if(null!=e)var t=e.Key;if(null!=t&&t!=a&&"SortColIndex"==t)return e});r.length>0?(i.splice(e.map(i,function(e,t){if("SortColIndex"==e.Key)return t}),1),t.PivotAnalysis._valueSorting=JSON.parse(r[0].Value),t.PivotAnalysis._sort=l.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null}},_memberSortBtnClick:function(i){var l,r,n,s,o,d,u,c=this.element.hasClass("e-pivotclient")&&"servermode"==this.model.operationalMode&&"olap"==this.model.analysisMode,p="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this,m="ejPivotGrid"==this.pluginName&&p.model.analysisMode==t.Pivot.AnalysisMode.Olap&&p.model.operationalMode==t.Pivot.OperationalMode.ServerMode,h=e(i.target).parents(".e-memberEditorDiv").find(".e-editorTreeView"),g=this._sortType=e(i.target).hasClass("e-memberAscendingIcon")?"ascending":"descending",f=[],_=jQuery.extend(!0,[],this._memberTreeObj._dataSource);if(this.element.find(".e-memberDrillPager").is(":visible")&&(l=this.model.memberEditorPageSize==a?this.model.pivotControl.model.memberEditorPageSize:this.model.memberEditorPageSize,f=t.Pivot._getParentsTreeList(this,this._drilledNode,this._editorTreeData).concat(t.DataManager(this._editorDrillTreeData[this._drilledNode]).executeLocal(t.Query().sortBy("name",this._sortType).page(this._memberDrillPageSettings.currentMemberDrillPage,l)))),!t.isNullOrUndefined(h)&&h.length>0){if(t.Pivot.updateTreeView(this),r=(this.model.enableMemberEditorPaging||!t.isNullOrUndefined(this.model.pivotControl)&&this.model.pivotControl.model.enableMemberEditorPaging)&&!this._isSearchApplied?this._editorTreeData:h.data("ejTreeView").model.fields.dataSource,n=c||"All"!=r[0].id&&"(All)_0"!=r[0].id?r:r.slice(1),f.length>0&&(n=f),n.length>1&&"SearchFilterSelection"==n[0].id&&(n=n.slice(1)),s=c?[]:r.length>1&&("All"==r[0].id||"(All)_0"==r[0].id)?r.splice(0,1):[],o=t.DataManager(n).executeLocal(t.Query().sortBy("name",g)),!t.isNullOrUndefined(s)&&s.length>0&&(o.splice(0,0,s[0]),r.splice(0,0,s[0])),(this.model.enableMemberEditorPaging||!t.isNullOrUndefined(this.model.pivotControl)&&this.model.pivotControl.model.enableMemberEditorPaging)&&0==f.length&&(o=t.DataManager(o).executeLocal(t.Query().page(this._memberPageSettings.currentMemeberPage,(this.model.memberEditorPageSize||this.model.pivotControl.model.memberEditorPageSize)+(1==this._memberPageSettings.currentMemeberPage?1:0)))),p.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&o.length>0&&"All"!=o[0].id&&"(All)_0"!=o[0].id&&!t.isNullOrUndefined(s)&&s.length>0&&o.splice(0,0,s[0]),s={},h.data("ejTreeView").model.fields.dataSource.length>1&&"SearchFilterSelection"==h.data("ejTreeView").model.fields.dataSource[1].id&&"SearchFilterSelection"!=o[1].id&&o.splice(1,0,{id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:this._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),c&&this._isSearchApplied&&o.splice(0,0,{id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:this._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),t.isNullOrUndefined(h)||h.ejTreeView({fields:{dataSource:jQuery.extend(!0,[],o)}}),f.length>0&&!t.isNullOrUndefined(_)&&(this._memberTreeObj._dataSource=_),m)for(d=this.element.find(".e-editorTreeView").find("li"),u=0;u<d.length;u++)t.isNullOrUndefined(e(d[u]).attr("id"))||e(d[u]).attr("data-tag",t.DataManager(h.data("ejTreeView").model.fields.dataSource).executeLocal(t.Query().where("id","equal",e(d[u]).attr("id")))[0].tag);t.Pivot._separateAllMember(this)}},_contextMenuOpen:function(i,a){var l,r,n,s;if(t.Pivot.openPreventPanel(a),a._selectedMember=e(i.target),"ejPivotGrid"==a.pluginName?(l=a.model.analysisMode==t.Pivot.AnalysisMode.Olap?"olap":"pivot",n=e("#pivotTree").data("ejMenu")):(t.isNullOrUndefined(a.model.pivotControl)||(l=a.model.pivotControl.model.analysisMode==t.Pivot.AnalysisMode.Olap?"olap":"pivot"),n=e("#"+a._id+"_pivotTreeContextMenu").data("ejMenu")),l==t.Pivot.AnalysisMode.Olap){if(t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))&&e(i.target).hasClass("e-pivotButton")&&e(i.target).children(".e-pvtBtn:eq(0)").length>0)return n.disable(),a._selectedMember=e(i.target).children(".e-pvtBtn:eq(0)"),!1;!t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))&&e(i.target).parent().attr("data-tag").split(":")[1].toLowerCase().startsWith("[measures]")?n.disable():t.isNullOrUndefined(a._selectedMember.parent().attr("data-tag"))||"measures"!=a._selectedMember.parent().attr("data-tag").split(":")[1].toLowerCase()?t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))?n.disable():(n.disableItem(a._getLocalizedLabels("AddToValues")),e(i.target.parentElement).find(".e-namedSetCDB").length>0?n.disableItem(a._getLocalizedLabels("AddToFilter")):n.enableItem(a._getLocalizedLabels("AddToFilter")),n.enableItem(a._getLocalizedLabels("AddToRow")),n.enableItem(a._getLocalizedLabels("AddToColumn"))):(n.disableItem(a._getLocalizedLabels("AddToValues")),n.disableItem(a._getLocalizedLabels("AddToFilter")),n.enableItem(a._getLocalizedLabels("AddToRow")),n.enableItem(a._getLocalizedLabels("AddToColumn")))}else l==t.Pivot.AnalysisMode.Pivot&&(r=i.target.textContent,e(i.target).hasClass("e-btn")?(n.enable(),"ejPivotGrid"==a.pluginName&&(n.disableItem(a._getLocalizedLabels("CalculatedField")),"values"==e(i.target).parents(".e-pivotButton").attr("data-tag").split(":")[0].toLowerCase()&&(a.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&e.grep(a.model.dataSource.values,function(e){return e.fieldCaption==r&&1==e.isCalculatedField}).length>0?n.disable():a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&e.grep(JSON.parse(a.getOlapReport()).PivotCalculations,function(e){return e.FieldHeader==r&&8==e.CalculationType}).length>0&&n.disable(),n.enableItem(a._getLocalizedLabels("CalculatedField"))))):e("#pivotTree").length>0?(n=e("#pivotTree").data("ejMenu")).disable():n.disable());s=a.model.pivotControl,t.isNullOrUndefined(s)||s.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||0==e(i.target).parents(".e-schemaValue").length&&n.disableItem(a._getLocalizedLabels("SummarizeValueBy"))},_searchTreeNodes:function(i){var a,l,r,n,s,o,d=e(i.target).hasClass("searchTreeView")?this.element.find(".searchTreeView").data("ejMaskEdit"):this.element.find(".searchEditorTreeView").data("ejMaskEdit"),u=e(i.target).hasClass("searchTreeView")?this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-schemaFieldTree").data("ejTreeView"):this.element.find(".e-cubeTreeView").data("ejTreeView"):this.element.find(".e-editorTreeView").data("ejTreeView"),c={id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),hasChildren:!1,checkedStatus:!0,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"},p=u.element,m=p.find("li[data-isItemSearch='true']"),h=t.isNullOrUndefined(d.get_StrippedValue())?"":d.get_StrippedValue().toLowerCase();if(m.length>0&&e(m).each(function(e,t){t.removeAttribute("data-isItemSearch")}),h.length>0){var g=[],f=[],_=p.find("ul>li>div>a");for(a=0;a<_.length;a++)-1!=e(_[a]).text().toLowerCase().indexOf(h)||"(All)_0"==e(e(_[a]).closest("li")).attr("id")||"All"==e(e(_[a]).closest("li")).attr("id")||"SearchFilterSelection"==e(e(_[a]).closest("li")).attr("id")?g.push(_[a]):f.push(_[a]);for((l=p.find(g).closest("li").css("display","block")).length>0&&(this._isOptionSearch=!0,e(l).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&i.setAttribute("data-isItemSearch",!0)}),p.hasClass("e-editorTreeView")&&(!p.find("li span.e-searchfilterselection").length>0?("(All)_0"==p.find("li:first").attr("id")||"All"==p.find("li:first").attr("id")?(l.length>1&&u.insertAfter(c,p.find("li:first")),(this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl.model.analysisMode:this.model.analysisMode)==t.Pivot.AnalysisMode.Pivot&&p.find("li span.e-searchfilterselection").closest("li").css("padding","0")):u.insertBefore(c,p.find("li:first")),p.find("li span.e-searchfilterselection").closest("li").attr("data-tag",c.tag)):p.find("li span.e-searchfilterselection").length>0&&!this._isSelectSearchFilter&&u.uncheckNode(p.find("li span.e-searchfilterselection").closest("li")))),p.find(f).closest("li").css("display","none"),o=0;o<l.length;o++)(n=(r=e(l[o])).parents("ul").closest("li").css("display","block")).length>0&&(u.expandNode(n),-1!=u.model.expandedNodes.indexOf(e(u._liList).index(n))||t.isNullOrUndefined(window._temp)||window._temp.push(n)),(s=r.children("ul")).length>0&&0==s.children("li:visible").length&&(r.children("ul").children("li").css("display","block"),u.expandNode(l[o]),-1!=u.model.expandedNodes.indexOf(e(u._liList).index(l[o]))||t.isNullOrUndefined(window._temp)||window._temp.push(l[o]))}else{p.find("ul>li").css("display","block"),p.find("li span.e-searchfilterselection").closest("li").length>0&&u.removeNode(p.find("#SearchFilterSelection")),e(p.find("ul>li")).each(function(e,t){t.removeAttribute("data-isItemSearch")}),this._isOptionSearch=!1;var b=e(p).find("ul>li"),v=0,C=0;if("(All)_0"==e(e(b)[0]).attr("id")||"All"==e(e(b)[0]).attr("id")){for(o=1;o<e(b).length;o++)e(e(b)[o]).find("span.e-checkmark").length>0?v++:C++;v>0&&C>0?e(p.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-checkmark").addClass("e-stop"):v>0&&0==C?e(p.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-stop").addClass("e-checkmark"):e(p.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-checkmark").removeClass("e-stop")}if(!t.isNullOrUndefined(window._temp))for(o=0;o<window._temp.length;o++)u._collpaseNode(window._temp[o]);window._temp=[],e(i.target).hasClass("searchTreeView")&&u.collapseAll()}},_updateSearchFilterSelection:function(i,a,l){var r,n;"SearchFilterSelection"==e(i.currentElement).attr("id")&&(r=e(a).find("li:not([data-isItemSearch='true'])"),"nodeCheck"==i.type?(l._isSelectSearchFilter=!0,l._isOptionSearch?r.length>0&&e(r).each(function(i,r){"SearchFilterSelection"!=e(r).attr("id")&&!t.isNullOrUndefined(l._currentFilterList[e(r).attr("id")])&&l._currentFilterList[e(r).attr("id")].checkedStatus&&e(a).ejTreeView("checkNode",e(r))}):r.length>0&&(e(l._editorTreeData).each(function(i,a){for(var n=0;n<r.length;n++){if(r[n].id==a.id){a.checkedStatus=e(r[n]).find(".checked").length>0;break}t.isNullOrUndefined(l._currentFilterList)||(a.checkedStatus=l._currentFilterList[e(a).attr("id")].checkedStatus)}}),n=!0,e(l._editorTreeData).each(function(e,t){if(t.checkedStatus)return n=!1,!1}),n&&l._editorTreeData.length>0?(l._dialogOKBtnObj.disable(),l.element.find(".e-dialogOKBtn").attr("disabled","disabled")):(l._dialogOKBtnObj.enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")))):"nodeUncheck"==i.type&&(l._isSelectSearchFilter=!1,l._isOptionSearch?r.length>0&&e(r).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&e(a).ejTreeView("uncheckNode",e(i))}):r.length>0&&(e(l._editorTreeData).each(function(t,i){for(var a=0;a<r.length;a++){if(r[a].id==i.id){i.checkedStatus=e(r[a]).find(".checked").length>0;break}i.checkedStatus=!1}}),n=!0,e(l._editorTreeData).each(function(e,t){if(t.checkedStatus)return n=!1,!1}),n&&l._editorTreeData.length>0?(l._dialogOKBtnObj.disable(),l.element.find(".e-dialogOKBtn").attr("disabled","disabled")):(l._dialogOKBtnObj.enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")))))},editorTreeNavigatee:function(i,a){var l,r;if(e(i.target).parents(".e-memberPager").length>0){if(r=a._memberPageSettings.currentMemeberPage,!e(i.target).hasClass("e-pageDisabled")){if(e(i.target).hasClass("e-nextPage"))a._memberPageSettings.startPage+=a.model.memberEditorPageSize,a._memberPageSettings.currentMemeberPage+=1,a._memberPageSettings.endPage+=a.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))a._memberPageSettings.currentMemeberPage-=1,a._memberPageSettings.startPage=Math.abs(a._memberPageSettings.startPage-(a._memberPageSettings.currentMemeberPage,a.model.memberEditorPageSize)),a._memberPageSettings.endPage-=a.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))a._memberPageSettings.currentMemeberPage=1,a._memberPageSettings.endPage=a.model.memberEditorPageSize,a._memberPageSettings.startPage=0;else if(e(i.target).hasClass("e-lastPage"))a._memberPageSettings.currentMemeberPage=parseInt(e.trim(a.element.find(".e-memberPageCount").text().split("/")[1])),a._memberPageSettings.endPage=a._memberPageSettings.currentMemeberPage*a.model.memberEditorPageSize,a._memberPageSettings.startPage=a._memberPageSettings.endPage-a.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(a.element.find(".e-memberPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return a.element.find(".e-memberCurrentPage").val(r),!1;a._memberPageSettings.currentMemeberPage=parseInt(e(i.target).val()),a._memberPageSettings.endPage=a._memberPageSettings.currentMemeberPage*a.model.memberEditorPageSize,a._memberPageSettings.startPage=1==a._memberPageSettings.currentMemeberPage||0==a._memberPageSettings.currentMemeberPage?0:a._memberPageSettings.endPage-a.model.memberEditorPageSize}a._waitingPopup.show(),a.element.hasClass("e-pivotclient")&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(a.model.enableMemberEditorSorting&&(a._editorTreeData=t.DataManager(a._editorTreeData).executeLocal(t.Query().sortBy("name",a._sortType))),this.editorTreePageInfoSuccess(a._editorTreeData,a)):("ejPivotSchemaDesigner"!=a.pluginName?a._isMemberPageFilter=!0:a.model.pivotControl._isMemberPageFilter=!0,t.Pivot.updateTreeView(a),l=t.DataManager(a._editorTreeData).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType).where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0")).page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)),a._memberPageSettings.currentMemeberPage>1?a.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberPageSettings.currentMemeberPage==parseInt(e.trim(a.element.find(".e-memberPageCount").text().split("/")[1]))?a.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),a.element.find(".e-memberCurrentPage").val(a._memberPageSettings.currentMemeberPage),a.element.find(".e-nextPageDiv .e-pageDisabled").css("opacity","0.5"),a.element.find(".e-nextPageDiv .e-pageEnabled").css("opacity","1"),t.Pivot._createSearchTreeview(l,a),a._waitingPopup.hide())}}else if(e(i.target).parents(".e-memberSearchPager").length>0){if(r=a._memberSearchPageSettings.currentMemberSearchPage,!e(i.target).hasClass("e-pageDisabled")){if(e(i.target).hasClass("e-nextPage"))a._memberSearchPageSettings.startSearchPage+=a.model.memberEditorPageSize,a._memberSearchPageSettings.currentMemberSearchPage+=1,a._memberSearchPageSettings.endSearchPage+=a.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))a._memberSearchPageSettings.currentMemberSearchPage-=1,a._memberSearchPageSettings.startSearchPage=Math.abs(a._memberSearchPageSettings.startSearchPage-(a._memberSearchPageSettings.currentMemberSearchPage,a.model.memberEditorPageSize)),a._memberSearchPageSettings.endSearchPage-=a.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))a._memberSearchPageSettings.currentMemberSearchPage=1,a._memberSearchPageSettings.endSearchPage=a.model.memberEditorPageSize,a._memberSearchPageSettings.startSearchPage=0;else if(e(i.target).hasClass("e-lastPage"))a._memberSearchPageSettings.currentMemberSearchPage=parseInt(e.trim(a.element.find(".e-memberSearchPageCount").text().split("/")[1])),a._memberSearchPageSettings.endSearchPage=a._memberSearchPageSettings.currentMemberSearchPage*a.model.memberEditorPageSize,a._memberSearchPageSettings.startSearchPage=a._memberSearchPageSettings.endSearchPage-a.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(a.element.find(".e-memberSearchPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return a.element.find(".e-memberCurrentSearchPage").val(r),!1;a._memberSearchPageSettings.currentMemberSearchPage=parseInt(e(i.target).val()),a._memberSearchPageSettings.endSearchPage=a._memberSearchPageSettings.currentMemberSearchPage*a.model.memberEditorPageSize,a._memberSearchPageSettings.startSearchPage=1==a._memberSearchPageSettings.currentMemberSearchPage||0==a._memberSearchPageSettings.currentMemberSearchPage?0:a._memberSearchPageSettings.endSearchPage-a.model.memberEditorPageSize}a._waitingPopup.show(),a.element.hasClass("e-pivotclient")&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._editorTreeSearchPageInfoSuccess(a._editorSearchTreeData,a):("ejPivotSchemaDesigner"!=a.pluginName?a._isMemberPageFilter=!0:a.model.pivotControl._isMemberPageFilter=!0,this._editorTreeSearchPageInfoSuccess(a._editorSearchTreeData,a))}}else if(e(i.target).parents(".e-memberDrillPager").length>0&&(r=a._memberDrillPageSettings.currentMemberDrillPage,!e(i.target).hasClass("e-pageDisabled"))){if(e(i.target).hasClass("e-nextPage"))a._memberDrillPageSettings.startDrillPage+=a.model.memberEditorPageSize,a._memberDrillPageSettings.currentMemberDrillPage+=1,a._memberDrillPageSettings.endDrillPage+=a.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))a._memberDrillPageSettings.currentMemberDrillPage-=1,a._memberDrillPageSettings.startDrillPage=Math.abs(a._memberDrillPageSettings.startDrillPage-(a._memberDrillPageSettings.currentMemberDrillPage,a.model.memberEditorPageSize)),a._memberDrillPageSettings.endDrillPage-=a.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))a._memberDrillPageSettings.currentMemberDrillPage=1,a._memberDrillPageSettings.endDrillPage=a.model.memberEditorPageSize,a._memberDrillPageSettings.startDrillPage=0;else if(e(i.target).hasClass("e-lastPage"))a._memberDrillPageSettings.currentMemberDrillPage=parseInt(e.trim(a.element.find(".e-memberDrillPageCount").text().split("/")[1])),a._memberDrillPageSettings.endDrillPage=a._memberDrillPageSettings.currentMemberDrillPage*a.model.memberEditorPageSize,a._memberDrillPageSettings.startDrillPage=a._memberDrillPageSettings.endDrillPage-a.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(a.element.find(".e-memberDrillPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return a.element.find(".e-memberCurrentDrillPage").val(r),!1;a._memberDrillPageSettings.currentMemberDrillPage=parseInt(e(i.target).val()),a._memberDrillPageSettings.endDrillPage=a._memberDrillPageSettings.currentMemberDrillPage*a.model.memberEditorPageSize,a._memberDrillPageSettings.startDrillPage=1==a._memberDrillPageSettings.currentMemberDrillPage||0==a._memberDrillPageSettings.currentMemberDrillPage?0:a._memberDrillPageSettings.endDrillPage-a.model.memberEditorPageSize}a._waitingPopup.show(),this._editorTreeDrillPageInfoSuccess(a._memberTreeObj._dataSource.slice(),a)}},editorTreePageInfoSuccess:function(i,l){setTimeout(function(){var r,n;l._memberPageSettings.currentMemeberPage>1?l.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberPageSettings.currentMemeberPage==parseInt(e.trim(l.element.find(".e-memberPageCount").text().split("/")[1]))?l.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),l.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(r=i[0]!=a?i[0].Value:i.d!=a?i.d[0].Value:i.EditorTreeInfo,(n=e.parseJSON(r)).splice(-1,1)),l.element.find(".e-memberCurrentPage").val(l._memberPageSettings.currentMemeberPage),l._appendTreeViewData(l.model.operationalMode==t.Pivot.OperationalMode.ClientMode?n:t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",a).page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize)),l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0),l._waitingPopup.hide()},0)},_editorTreeDrillPageInfoSuccess:function(i,l){setTimeout(function(){var r,n,s;l._memberDrillPageSettings.currentMemberDrillPage>1?l.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberDrillPageSettings.currentMemberDrillPage==parseInt(e.trim(l.element.find(".e-memberDrillPageCount").text().split("/")[1]))?l.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),l.element.find(".e-memberCurrentDrillPage").val(l._memberDrillPageSettings.currentMemberDrillPage),n=0,i.length>0&&i[0].length>0&&"All"==i[0][0].id&&i[0].splice(0,1),e.each(i,function(e,t){if(1!=t.length||!t[0].expanded)return!1;n=e}),s=l.model.enableMemberEditorSorting&&l._sortType?t.DataManager(t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",i[n][0].id).sortBy("name",l._sortType))).executeLocal(t.Query().where("pid","notequal",a).page(l._memberDrillPageSettings.currentMemberDrillPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize)):t.DataManager(t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",i[n][0].id))).executeLocal(t.Query().where("pid","notequal",a).page(l._memberDrillPageSettings.currentMemberDrillPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize)),l._editorDrillTreePageSettings[i[n][0].id]=e.extend(!0,{},l._memberDrillPageSettings),l.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0?(r=t.Pivot._getParentsTreeList(l,i[n][0].id,l._editorTreeData).concat(s),"ejPivotClient"!=l.pluginName?t.Pivot._createSearchTreeview(r,l):l._appendTreeViewData(r,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0)):"ejPivotClient"!=l.pluginName?t.Pivot._createSearchTreeview(s,l):l._appendTreeViewData(s,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0),l._waitingPopup.hide()},0)},_editorTreeSearchPageInfoSuccess:function(i,a){setTimeout(function(){var l,r="ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize;for(a._memberSearchPageSettings.currentMemberSearchPage>1?a.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberSearchPageSettings.currentMemberSearchPage==parseInt(e.trim(a.element.find(".e-memberSearchPageCount").text().split("/")[1]))?a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),i=t.DataManager(i).executeLocal(t.Query().where(t.Predicate("id","notequal","(All)_0").and("id","notequal","All"))).slice((a._memberSearchPageSettings.currentMemberSearchPage-1)*r,(a._memberSearchPageSettings.currentMemberSearchPage-1)*r+r),l=0;l<i.length;l++)t.isNullOrUndefined(i[l].pid)||(i[l].parentId=i[l].pid);for(l=0;l<i.length;l++)t.Pivot._appendParentNodes(i,i[l],a);a.element.find(".e-memberCurrentSearchPage").val(a._memberSearchPageSettings.currentMemberSearchPage),i.splice(0,0,{id:"SearchFilterSelection",name:a._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:a._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(i,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):t.Pivot._createSearchTreeview(i,a),a._waitingPopup.hide(),a._parentNodeCollection={},a._parentSearchNodeCollection={}},0)},_drillEditorTreeNode:function(i,l,r){var n,s;l._waitingPopup.show(),n=i.childNodes,l._isEditorDrillPaging&&!l._isEditorCollapseDrillPaging?l.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0&&(l._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0},t.isNullOrUndefined(i.parentNode.id)||(l._editorDrillTreeData[i.parentNode.id]=n.slice(),l._editorDrillTreePageSettings[i.parentNode.id]=e.extend(!0,{},l._memberDrillPageSettings)),this._refreshDrillEditorPager(i,l,r)):l._isEditorCollapseDrillPaging&&(l.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0&&(l._isEditorCollapseDrillPaging=!1,l._memberDrillPageSettings=t.isNullOrUndefined(i.parentNode.id)?i.drillPageSettings:i.drillPageSettings[i.parentNode.id]),this._refreshDrillEditorPager(i,l,r)),l._drilledNode=i.parentNode.id,s=t.isNullOrUndefined(i.parentNode.id)?i.parentNode.concat(i.childNodes):this._getParentsTreeList(l,i.parentNode.id,l._editorTreeData).concat(t.DataManager(n).executeLocal(t.Query().where("pid","notequal",a).page(l._memberDrillPageSettings.currentMemberDrillPage,r))),"ejPivotClient"==l.pluginName&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l._appendTreeViewData(s,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):t.Pivot._createSearchTreeview(s,l),l._waitingPopup.hide()},_refreshDrillEditorPager:function(t,i,a){i.element.find(".e-memberPager,.e-memberSearchPager").css("display","none"),i.element.find(".e-memberDrillPager").css("display","block");var l=t.childNodes.length/a;l!=Math.round(l)&&(l=parseInt(l)+1),i._memberDrillPageSettings.currentMemberDrillPage==l&&i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").addClass("disabled"),i.element.find(".e-memberDrillPageCount").html("/ "+l),i.element.find(".e-memberCurrentDrillPage").val(i._memberDrillPageSettings.currentMemberDrillPage),i._memberDrillPageSettings.currentMemberDrillPage>1?i.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):i.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),i._memberDrillPageSettings.currentMemberDrillPage==parseInt(e.trim(i.element.find(".e-memberDrillPageCount").text().split("/")[1]))?i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),t.childNodes=t.childNodes.slice((i._memberDrillPageSettings.currentMemberDrillPage-1)*a,i._memberDrillPageSettings.currentMemberDrillPage*a)},_getParentsTreeList:function(e,i,a){var l,r=[];do{parentNodes=t.DataManager(a).executeLocal(t.Query().where("id","equal",i)),l=!t.isNullOrUndefined(parentNodes)&&parentNodes.length>0&&!t.isNullOrUndefined(parentNodes[0].pid),r.push(new t.Predicate("id","equal",i)),i=l?parentNodes[0].pid:null}while(!t.isNullOrUndefined(i));return t.DataManager(a).executeLocal(t.Query().where(t.Predicate.or(r)))},_onNodeCollapse:function(i){var l,r=t.isNullOrUndefined(i.olapCtrlObj)?this:i.olapCtrlObj,n=!1,s={memberEditorPageSize:"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl.model.memberEditorPageSize:r.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl.model.enableMemberEditorPaging:r.model.enableMemberEditorPaging};if(jQuery.each(r._editorTreeData,function(e,a){a.id==i.id?(t.isNullOrUndefined(a.pid)||(i.parentId=a.pid),a.expanded=!1):a.pid==i.id&&(t.isNullOrUndefined(r._editorDrillTreeData[a.id])||(n=!0))}),s.enableMemberEditorPaging&&(n||!t.isNullOrUndefined(r._editorDrillTreeData[i.id])||""==i.parentId)){r.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),r._lastSavedTree=[],r._isEditorDrillPaging=!1,r.element.find(".e-memberPager").length>0?(r.element.find(".e-memberPager").css("display","block"),r.element.find(".e-memberDrillPager,.e-memberSearchPager").css("display","none")):r.element.find(".e-memberDrillPager, .e-memberSearchPager").css("display","none");var o=[],d=i.parentId,u=!1,c=!1,p="";if(!t.isNullOrUndefined(d)&&""!=d){do{parentNodes=t.DataManager(r._editorTreeData).executeLocal(t.Query().where("id","equal",d)),u=!!(u||s.memberEditorPageSize<=t.DataManager(r._editorTreeData).executeLocal(t.Query().where("pid","equal",d)).length),o.push(new t.Predicate(u?"id":"pid","equal",d)),!c&&u&&s.memberEditorPageSize<t.DataManager(r._editorTreeData).executeLocal(t.Query().where("pid","equal",d)).length&&(c=!0,p=d),d=parentNodes[0].pid}while(!t.isNullOrUndefined(d));u?o.push(new t.Predicate("id","equal",i.parentId)):o.push(new t.Predicate("pid","equal",a))}u?(t.Pivot._makeAncestorsExpandable(r,i.parentId),r._isEditorCollapseDrillPaging=!0,(l={drillPageSettings:t.isNullOrUndefined(r._editorDrillTreePageSettings[p])&&"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl._editorDrillTreePageSettings[p]:r._editorDrillTreePageSettings[p],parentNode:t.DataManager(e.extend(!0,[],r._editorTreeData)).executeLocal(t.Query().where(t.Predicate.or(o))),childNodes:t.DataManager(e.extend(!0,[],r._editorTreeData)).executeLocal(t.Query().where("pid","equal",p))}).parentNode=e.grep(l.parentNode,function(t){var i=!1;return e.each(l.childNodes,function(e,a){a.id==t.id&&(a.expanded=!0,i=!0)}),!i}),t.Pivot._drillEditorTreeNode(l,r,s.memberEditorPageSize)):(r.model.enableMemberEditorSorting&&(r._editorTreeData=t.DataManager(r._editorTreeData).executeLocal(t.Query().sortBy("name",r._sortType))),0==o.length&&o.push(new t.Predicate("pid","equal",a)),r.element.find(".e-memberPager").length>0?"ejPivotClient"!=r.pluginName?t.Pivot._createSearchTreeview(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(o)).page(r._memberPageSettings.currentMemeberPage,s.memberEditorPageSize)),r):r._appendTreeViewData(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(o)).page(r._memberPageSettings.currentMemeberPage,s.memberEditorPageSize)),r.element.find(".pvtBtn").parent("[data-tag='Slicers:"+r._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):"ejPivotClient"!=r.pluginName?t.Pivot._createSearchTreeview(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(o))),r):r._appendTreeViewData(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(o))),r.element.find(".pvtBtn").parent("[data-tag='Slicers:"+r._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0))}},_searchEditorTreeNodes:function(i,l){if(t.isNullOrUndefined(window.event)?0!=i.which&&13!=i.which:0!=window.event.which&&13!=window.event.which){t.isNullOrUndefined(l._waitingPopup.element)||l._waitingPopup.show();var r=this;setTimeout(function(){var i,n,s,o={memberEditorPageSize:"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging},d="";if("ejPivotClient"!=l.pluginName||t.isNullOrUndefined(l._pivotSchemaDesigner)){if(t.isNullOrUndefined(l.element.find(".searchEditorTreeView"))||0==l.element.find(".searchEditorTreeView").length)return!1;d=t.isNullOrUndefined(e.trim(l.element.find(".searchEditorTreeView").val()))?"":e.trim(l.element.find(".searchEditorTreeView").val()).toLowerCase()}else{if(t.isNullOrUndefined(l._pivotSchemaDesigner.element.find(".searchEditorTreeView"))||0==l._pivotSchemaDesigner.element.find(".searchEditorTreeView").length)return!1;d=t.isNullOrUndefined(e.trim(l._pivotSchemaDesigner.element.find(".searchEditorTreeView").val()))?"":e.trim(l._pivotSchemaDesigner.element.find(".searchEditorTreeView").val()).toLowerCase()}if(""!=d){var u=jQuery.extend(!0,[],t.DataManager(l._editorTreeData).executeLocal(t.Query().where("name","contains",d,!0).sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType))),c=e.extend(!0,[],u.slice(0,o.memberEditorPageSize+1)),p=o.enableMemberEditorPaging?c:u;for(i=0;i<p.length;i++)t.isNullOrUndefined(p[i].pid)||(p[i].parentId=p[i].pid);for(i=0;i<p.length;i++)r._appendParentNodes(p,p[i],l);l._isSearchApplied=!0,u.length>0?(l._isSelectSearchFilter=!0,o.enableMemberEditorPaging&&(l.element.find(".e-memberSearchPager").find(".e-nextPageDiv").length>0||l.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0)&&(l._memberSearchPageSettings.currentMemberSearchPage=1,l._memberSearchPageSettings.startSearchPage=0,l._memberSearchPageSettings.endSearchPage=0,l.element.find(".e-memberPager,.e-memberDrillPager").css("display","none"),l._editorSearchTreeData=u.slice(),(n=t.DataManager(u).executeLocal(t.Query().where(t.Predicate("id","notequal","(All)_0").and("id","notequal","All"))).length/o.memberEditorPageSize)!=Math.round(n)&&(n=parseInt(n)+1),n>1&&l.element.find(".e-memberSearchPager").css("display","block"),l._memberSearchPageSettings.currentMemberSearchPage==n&&l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").addClass("disabled"),l.element.find(".e-memberSearchPageCount").html("/ "+n),l.element.find(".e-memberCurrentSearchPage").val(l._memberSearchPageSettings.currentMemberSearchPage),l._memberSearchPageSettings.currentMemberSearchPage>1?l.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberSearchPageSettings.currentMemberSearchPage==parseInt(e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1]))?l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"))):(l.element.find(".e-memberPager,.e-memberSearchPager,.e-memberDrillPager").css("display","none"),l.element.find(".e-dialogFooter").css("margin-top","5px")),p.length>0&&("All"==p[0].id&&p.splice(0,1),p.splice(0,0,{id:"SearchFilterSelection",name:l._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:l._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"})),"ejPivotClient"==l.pluginName&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l._appendTreeViewData(p,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):r._createSearchTreeview(p,l)}else l._isSearchApplied=!1,l._isSelectSearchFilter=!0,s=!t.isNullOrUndefined(l._lastSavedTree)&&e.grep(l._lastSavedTree,function(e){return e.pid}).length>0,o.enableMemberEditorPaging&&l.element.find(".e-memberSearchPager").find(".e-nextPageDiv").length>0&&(l._editorSearchTreeData=[],""!=l.element.find(".e-memberPageCount").text()&&l.element.find(".e-memberPager").css("display","block"),l.element.find(".e-memberSearchPager").css("display","none")),s&&""!=l.element.find(".e-memberDrillPageCount").text()&&(l.element.find(".e-memberDrillPager").css("display","block"),l.element.find(".e-memberPager").css("display","none")),"ejPivotClient"==l.pluginName&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l._appendTreeViewData(o.enableMemberEditorPaging?s?t.DataManager(l._lastSavedTree).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType)):t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",a).page(l._memberPageSettings.currentMemeberPage,o.memberEditorPageSize).sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType)):l._editorTreeData,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):r._createSearchTreeview(o.enableMemberEditorPaging?s?t.DataManager(l._lastSavedTree).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType)):t.DataManager(l._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0")).page(l._memberPageSettings.currentMemeberPage,o.memberEditorPageSize).sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType)):l._editorTreeData,l);l._waitingPopup.hide(),l._parentNodeCollection={},l._parentSearchNodeCollection={}},0)}},_createSearchTreeview:function(i,a){"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableMemberEditorPaging:a.model.enableMemberEditorPaging;var l,r,n="ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableAdvancedFilter:a.model.enableAdvancedFilter,s="ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableMemberEditorSorting:a.model.enableMemberEditorSorting,o=a.element.find(".e-pvtBtn").parent("[data-tag='Slicers:"+(a._selectedFieldName||a._dialogHead)+"']").length>0,d=("ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.analysisMode:a.model.analysisMode,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.operationalMode:a.model.operationalMode);for(!a._isSearchApplied&&0==a._editorSearchTreeData.length&&i.length>0&&(a._lastSavedTree=i),i.length>0&&(i=t.DataManager(i).executeLocal(t.Query().where(t.Predicate("id","notequal","All").and("id","notequal","(All)_0")))).splice(0,0,{id:"All",name:n&&!o?"(Select All)":d==t.Pivot.OperationalMode.ServerMode?"(All)":"All",checkedStatus:a._isAllMemberChecked,_isAllMemberChecked:a._isAllMemberChecked}),a.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:a.model.enableRTL,beforeDelete:function(e){if(!t.isNullOrUndefined(e.event)&&"keydown"==e.event.type&&"delete"==e.event.originalEvent.key.toLowerCase())return!1},height:s?"200px":"245px",fields:{id:"id",text:"name",isChecked:"checkedStatus",parentId:"pid",expanded:"expanded",hasChild:"hasChildren",dataSource:t.Pivot._showEditorLinkPanel(i,a,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl:a)}}),l=a.element.find(".e-editorTreeView").find("li"),r=0;r<l.length;r++)t.isNullOrUndefined(e(l[r]).attr("id"))||e(l[r]).attr("data-tag",t.DataManager(i).executeLocal(t.Query().where("id","equal",e(l[r]).attr("id")))[0].tag);a._memberTreeObj=a.element.find(".e-editorTreeView").data("ejTreeView"),a._memberTreeObj.model.nodeCheck=t.proxy(a._nodeCheckChanges,a),a._memberTreeObj.model.nodeUncheck=t.proxy(a._nodeCheckChanges,a),"ejPivotGrid"==a.pluginName?a.model.operationalMode==t.Pivot.OperationalMode.ClientMode?a._memberTreeObj.model.beforeExpand=t.proxy(a._beforeNodeExpand,a):a._memberTreeObj.model.nodeClick=t.proxy(a._nodeExpand,a):(a.model.pivotControl.model.operationalMode==t.Pivot.OperationalMode.ClientMode?a._memberTreeObj.model.beforeExpand=t.proxy(a._beforeNodeExpand,a):a._memberTreeObj.model.nodeClick=t.proxy(a._nodeExpand,a),a._memberTreeObj.model.beforeCollapse=t.proxy(t.Pivot._onNodeCollapse,a)),t.isNullOrUndefined(a.element.find(".e-dialog .e-text:visible").first())||(a.element.find(".e-dialog .e-text:visible").length>0?(a.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").addClass("e-hoverCell"),a.element.find(".e-dialog button").removeClass("e-hoverCell")):a.element.find(".e-dialog button:visible").first().attr("tabindex","-1").addClass("e-hoverCell")),0==a._memberTreeObj.element.find(".e-plus").length&&0==a._memberTreeObj.element.find(".e-minus").length&&a._memberTreeObj.element.find(".e-item").css("padding","0px"),a.model.enableMemberEditorSorting&&this._separateAllMember(a)},_separateAllMember:function(e){var i=e.element.hasClass("e-pivotclient")&&"servermode"==e.model.operationalMode&&"olap"==e.model.analysisMode,a="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.enableAdvancedFilter:e.model.enableAdvancedFilter,l="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.enableRTL:e.model.enableRTL,r="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.analysisMode:e.model.analysisMode,n=i?"":t.buildTag("div.e-checkAllBox",t.buildTag("input#allElement.allMember","",{float:l?"right":"left"},{name:"row",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.e-allElementLabel",a?"(Select All)":"All",{"margin-left":"5px"})[0].outerHTML,{width:"100px",float:l?"right":"left"})[0].outerHTML,s=t.buildTag("div.memberSortDiv",t.buildTag("div.e-icon e-memberAscendingIcon",{margin:"5px"})[0].outerHTML+t.buildTag("div.e-icon e-memberDescendingIcon")[0].outerHTML,{height:"35px","margin-left":"5px",float:l?"left":"right"})[0].outerHTML,o=t.buildTag("div.memberSortingDiv",n+s,{height:"20px",margin:"ejPivotSchemaDesigner"==e.pluginName?l?r==t.Pivot.AnalysisMode.Pivot?"10px 15px 0px 21px":"10px 31px 0px 12px":r==t.Pivot.AnalysisMode.Pivot?"10px 0px 0px 8px":"10px 0px 0px 20px":l?r==t.Pivot.AnalysisMode.Pivot?"10px 15px 0px 20px":"10px 28px 0px 20px":r==t.Pivot.AnalysisMode.Pivot?"10px 0px 0px 20px":"10px 0px 0px 29px"});a&&e.element.find(".e-editorTreeView").css("margin-top","10px"),e.element.find(".memberSortingDiv, .e-separateDiv").remove(),r==t.Pivot.AnalysisMode.Pivot&&e.element.find(".e-editorTreeView").addClass("e-treeViewUl"),i||e.element.find(".e-editorTreeView").before(o),("All"==e.element.find(".e-editorTreeView li:first").attr("id")||"(All)_0"==e.element.find(".e-editorTreeView li:first").attr("id"))&&e.element.find(".e-editorTreeView li:first").css("display","none"),i?(e.element.find(".memberSortDiv, .e-separateDiv").remove(),e.element.find(".e-checkOptions").after(t.buildTag("div.e-separateDiv",{margin:"0px 5px"})[0].outerHTML),e.element.find(".e-checkOptions").append(s),a&&e.element.find(".e-editorTreeView").height(235)):(e.element.find(".memberSortingDiv").after(t.buildTag("div.e-separateDiv",{})[0].outerHTML),e.element.find(".allMember").ejCheckBox({size:"small",width:"40px",checked:"disabled"!=e.element.find(".e-dialogOKBtn").attr("disabled"),change:t.proxy(e._nodeCheckChanges,e)})),"ascending"==e._sortType?e.element.find(".e-memberAscendingIcon").addClass("e-selectedSort"):"descending"==e._sortType&&e.element.find(".e-memberDescendingIcon").addClass("e-selectedSort")},_checkChanges:function(e){var t="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this;e.isChecked?t._nodeCheckChanges(e):e.isChecked||t._nodeUnCheckChanges(e)},_fetchMemberPageSuccess:function(i){var l,r="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this;i[0]!=a&&i.length>0?(l=i[0].Value,null!=i[1]&&i[1]!=a&&(this.model.customObject=i[1].Value)):i.d!=a&&i.d.length>0?(l=i.d[0].Value,null!=i.d[1]&&i.d[1]!=a&&(this.model.customObject=i.d[1].Value)):i!=a&&i.length>0?(l=i.EditorTreeInfo,null!=i&&i.customObject!=a&&(this.model.customObject=i.customObject)):i!=a&&(l=i.EditorTreeInfo,null!=i&&i.customObject!=a&&(this.model.customObject=i.customObject)),this._memberPageSettings.endPage="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl.model.memberEditorPageSize:this.model.memberEditorPageSize,this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1,filteredData=JSON.parse(l),this._editorTreeData=e.extend(!0,[],filteredData),r.model.enableAdvancedFilter&&(this._editorTreeData=e.map(this._editorTreeData,function(e){if(t.isNullOrUndefined(e.levels))return e})),("ejPivotSchemaDesigner"==this.pluginName&&this.model.pivotControl&&this.model.pivotControl.model.enableAdvancedFilter&&this.model.pivotControl.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.pivotControl.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||"ejPivotGrid"==this.pluginName&&this.model.enableAdvancedFilter&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this._memberPagingAvdData=filteredData.splice(filteredData.length-1,1)),this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0"))).length,filteredData=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",a).page(this._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl.model.memberEditorPageSize+1:this.model.memberEditorPageSize+1)),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(filteredData)})},_memberPageNodeUncheck:function(i,a){var l,r="",n=null,s="ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableMemberEditorPaging:a.model.enableMemberEditorPaging;e(i.currentElement).parent().parent().hasClass("e-editorTreeView")&&!a._isSearchApplied&&s?(r=t.DataManager(a._editorTreeData).executeLocal(t.Query().page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize+1:a.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(a._editorSearchTreeData)||(n=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize+1:a.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0])):(r=t.DataManager(a._editorTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(a._editorSearchTreeData)||(n=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0])),t.isNullOrUndefined(r)||(r.checkedStatus=!1,t.isNullOrUndefined(r.pid)||(l=t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",r.pid).where("checkedStatus","equal",!0)),t.isNullOrUndefined(l)||0!=l.length||t.Pivot._unSelectParentTreeNode(r,a)),l=t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",r.id)),!t.isNullOrUndefined(l)&&l.length>0&&t.Pivot._unSelectChildTreeNode(r,a)),t.isNullOrUndefined(n)||(n.checkedStatus=!1,t.isNullOrUndefined(n.pid)||(l=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",n.pid).where("checkedStatus","equal",!0)),t.isNullOrUndefined(l)||0!=l.length||t.Pivot._unSelectParentTreeNode(n,a)),l=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",r.id)),!t.isNullOrUndefined(l)&&l.length>0&&t.Pivot._unSelectChildTreeNode(n,a))},_memberPageNodeCheck:function(i,a){var l,r,n="",s=null,o="ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableMemberEditorPaging:a.model.enableMemberEditorPaging;if(e(i.currentElement).parent().parent().hasClass("e-editorTreeView")&&!a._isSearchApplied&&o?(n=t.DataManager(a._editorTreeData).executeLocal(t.Query().page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize+1:a.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(a._editorSearchTreeData)||(s=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize+1:a.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0])):(n=t.DataManager(a._editorTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(a._editorSearchTreeData)||(s=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0])),!t.isNullOrUndefined(n)&&(n.checkedStatus=!0,t.isNullOrUndefined(n.pid)||t.Pivot._selectParentTreeNode(n,a),!t.isNullOrUndefined(n.id)&&(l=t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",n.id)),!t.isNullOrUndefined(l)&&l.length>0)))for(r=0;r<l.length;r++)l[r].checkedStatus=!0,(l[r].expanded||l[r].isChildMerged)&&t.Pivot._selectChildTreeNode(l[r],a);if(!t.isNullOrUndefined(s)&&(s.checkedStatus=!0,t.isNullOrUndefined(s.pid)||t.Pivot._selectParentTreeNode(s,a),!t.isNullOrUndefined(s.id)&&(l=t.DataManager(a._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",s.id)),!t.isNullOrUndefined(l)&&l.length>0)))for(r=0;r<l.length;r++)l[r].checkedStatus=!0,t.Pivot._selectChildTreeNode(l[r],a)},_appendParentNodes:function(e,i,a){var l,r;t.isNullOrUndefined(i.pid)||(t.isNullOrUndefined(a._parentNodeCollection[i.pid])?(l=jQuery.extend(!0,[],t.DataManager(a._editorTreeData).executeLocal(t.Query().where("id","equal",i.pid))),a._parentNodeCollection[i.pid]=l):l=a._parentNodeCollection[i.pid],!t.isNullOrUndefined(l)&&l.length>0&&(t.isNullOrUndefined(a._parentSearchNodeCollection[l[0].id])?(r=jQuery.extend(!0,[],t.DataManager(e).executeLocal(t.Query().where("id","equal",l[0].id))),a._parentSearchNodeCollection[l[0].id]=l):r=a._parentSearchNodeCollection[l[0].id]),t.isNullOrUndefined(r)||(0==r.length?(l[0].expanded=!0,e.push(l[0]),t.isNullOrUndefined(l[0].pid)||this._appendParentNodes(e,l[0],a)):r[0].expanded=!0))},_selectParentTreeNode:function(e,i){var a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("id","equal",e.pid));!t.isNullOrUndefined(a)&&a.length>0&&(a[0].checkedStatus=!0,this._selectParentTreeNode(a[0],i))},_selectChildTreeNode:function(e,i){var a,l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id));if(!t.isNullOrUndefined(l)&&l.length>0)for(a=0;a<l.length;a++)l[a].checkedStatus=!0,(l[a].expanded||l[a].isChildMerged)&&this._selectChildTreeNode(l[a],i)},_unSelectChildTreeNode:function(e,i){var a,l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id));if(!t.isNullOrUndefined(l)&&l.length>0)for(a=0;a<l.length;a++)l[a].checkedStatus=!1,(l[a].expanded||l[a].isChildMerged)&&this._unSelectChildTreeNode(l[a],i)},_unSelectParentTreeNode:function(e,i){var a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("id","equal",e.pid));!t.isNullOrUndefined(a)&&a.length>0&&(a[0].checkedStatus=!1,0==t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",a[0].pid).where("checkedStatus","equal",!0)).length&&this._unSelectParentTreeNode(a[0],i))},_getSelectedTreeState:function(e,i){var l,r,n,s,o,d;if(e){for(o=[],l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",a)),d=0;d<l.length;d++){if(r=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",l[d].id)),n={caption:l[d].name,parentId:t.isNullOrUndefined(l[d].pid)?"None":l[d].pid,id:l[d].id,checked:l[d].checkedStatus,expanded:r.length>0,childNodes:[],tag:l[d].tag},r.length>0)for(s=0;s<r.length;s++)n.childNodes.push(this._getEditorSlicerInfo(r[s],i));o.push(n)}return JSON.stringify(o)}for(o="",d=0;d<i._editorTreeData.length;d++)1==i._editorTreeData[d].checkedStatus&&(o+="::"+i._editorTreeData[d].id+"||"+i._editorTreeData[d].tag);return o},_getUnSelectedTreeState:function(e){for(var t="",i=0;i<e._editorTreeData.length;i++)0==e._editorTreeData[i].checkedStatus&&(t+="::"+e._editorTreeData[i].id+"||"+e._editorTreeData[i].tag);return t},_getEditorSlicerInfo:function(e,i){var a,l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id)),r={caption:e.name,parentId:t.isNullOrUndefined(e.pid)?"None":e.pid,id:e.id,checked:e.checkedStatus,expanded:l.length>0,childNodes:[],tag:e.tag};if(l.length>0)for(a=0;a<l.length;a++)r.childNodes.push(this._getEditorSlicerInfo(l[a],i));return r},_editorLinkPanelClick:function(){this.element.find(".e-dialog").hide(),t.Pivot._createErrorDialog(this._getLocalizedLabels("EditorLinkPanelAlert").split("1000").join(this.model.maxNodeLimitInMemberEditor),this._getLocalizedLabels("Warning"),this)},_showEditorLinkPanel:function(i,a,l){var r,n;if(!l.model.enableMemberEditorPaging&&(l.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||a._isSearchApplied||(a._editorTreeData=i),i.length>l.model.maxNodeLimitInMemberEditor+(a._isSearchApplied?1:0))){var s=[],o={},d={},u=!1;for(r=0;r<i.length;r++)t.isNullOrUndefined(o[i[r].pid])?(t.isNullOrUndefined(i[r].pid)||(n=e.grep(i,function(e){if(e.id==i[r].pid)return e})).length>0&&(d[i[r].pid]=!!n[0].expanded),o[i[r].pid]=1):o[i[r].pid]++,o[i[r].pid]<=l.model.maxNodeLimitInMemberEditor+(a._isSearchApplied&&t.isNullOrUndefined(i[r].pid)?1:0)?s.push(i[r]):(t.isNullOrUndefined(d[i[r].pid])||d[i[r].pid])&&(u=!0);i=s,u&&a.element.find("div.e-linkOuterPanel").css("display","block")}return i},createErrorDialog:function(i){var a,l;t.Pivot.openPreventPanel(i),0==i.element.find(".e-errorDialog").length?(l=t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent",i._getLocalizedLabels("AlertMsg"))[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn","OK")[0].outerHTML)[0].outerHTML).attr("title",i._getLocalizedLabels("Warning"))[0].outerHTML,i.element.append(l),i.element.find(".e-errorDialog").ejDialog({target:"#"+i._id,enableResize:!1,enableRTL:i.model.enableRTL,width:"400px"}),a=i.element.find(".e-errorDialog").data("ejDialog"),e("#"+a._id+"_wrapper").css({left:"50%",top:"50%"}),i.element.find(".errOKBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(t.Pivot.errOKBtnClick,i)}),i.element.find(".e-dialog .e-close").attr("title",i._getLocalizedLabels("Close"))):(a=i.element.find(".e-errorDialog").data("ejDialog")).open()},errOKBtnClick:function(){this.element.find("#preventDiv").remove(),this.element.find(".e-errorDialog").data("ejDialog")._ejDialog.find("div.e-dialog-icon").trigger("click")},doAjaxPost:function(i,l,r,n,s,o){var d,u,c,p=!0;r.XMLA==a?(d="application/json; charset=utf-8",u="json",c=e.proxy(n,this)):(d="text/xml",u="xml",r=r.XMLA,c=e.proxy(n,t.olap.base,o),p=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)&&(!t.isNullOrUndefined(o)&&"loadFieldElements"!=o.action)),e.ajax({type:i,url:l,contentType:d,async:p,dataType:u,data:r,success:c,complete:t.proxy(function(t){e.proxy(t,this);this._currentAction,this.element},this),error:t.proxy(function(e){void 0!==this._ogridWaitingPopup&&null!=this._ogridWaitingPopup&&this._ogridWaitingPopup.hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide();var t={action:""!=this._drillAction?this._drillAction:"initialize",customObject:"",element:this.element,Message:e};this._trigger("renderFailure",t),this.renderControlFromJSON(""),"XMLA"==this._dataModel&&this._createErrorDialog(e.statusText,this._getLocalizedLabels("Error")),e.statusText},this)})},getCubeList:function(t,i){for(var a,l=[],r=0;r<e(i).find("row").length;r++)a=e(e(i).find("row")[r]),l.push({name:e(a).children("CUBE_NAME").text()});t.pvtCtrldObj.setCubeList(l)},generateTreeViewData:function(e){var t={catalog:e.model.pivotControl.model.dataSource.catalog,cube:e.model.pivotControl.model.dataSource.cube,url:e.model.pivotControl.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(t,this.loadDimensionElements,{schemaData:e,action:"loadFieldElements"})},loadDimensionElements:function(i,l){var r,n=i.schemaData.model.pivotControl,s={},o=(t.olap.base._getConnectionInfo(n.model.dataSource.data),{}),d=n.model.dataSource.providerName==t.olap.Providers.Mondrian;for(o={catalog:n.model.dataSource.catalog,cube:n.model.dataSource.cube,url:n.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},n.schemaTreeView=[],n.reportItemNames=[],r=0;r<e(l).find("row").length;r++){var u=e(e(l).find("row")[r]),c=u.find("DIMENSION_UNIQUE_NAME").text(),p=u.find("DIMENSION_CAPTION").text();c.toLowerCase().indexOf("[measure")>=0?s={hasChildren:!0,isSelected:!1,id:c,name:p,spriteCssClass:"[measures]"==c.toLowerCase()?"e-folderCDB e-icon":"e-dimensionCDB e-icon",tag:c}:!e(e(l).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&n.schemaTreeView.push({hasChildren:!0,isSelected:!1,id:d?c+"~#^Dim":c,name:p,spriteCssClass:"e-dimensionCDB e-icon",tag:c,defaultHierarchy:e(e(l).find("row")[r]).children("DEFAULT_HIERARCHY").text()})}n.schemaTreeView.splice(0,0,s),!n.model.enableDrillThrough||i.schemaData!=a&&i.schemaData.model.olap.showNamedSets?(o.request="MDSCHEMA_SETS",t.Pivot._getTreeData(o,t.Pivot.loadNamedSetElements,i)):(o.request="MDSCHEMA_HIERARCHIES",(t.isNullOrUndefined(n._fieldData)||!t.isNullOrUndefined(n._fieldData)&&t.isNullOrUndefined(n._fieldData.hierarchy))&&this._getFieldItemsInfo(n),n._fieldData.hierarchySuccess==a?t.Pivot._getTreeData(o,n.loadHierarchyElements,i):t.Pivot.loadHierarchyElements(i,n._fieldData.hierarchySuccess))},loadNamedSetElements:function(i,l){var r,n,s,o=i.schemaData.model.pivotControl,d={catalog:o.model.dataSource.catalog,cube:o.model.dataSource.cube,url:o.model.dataSource.data,request:"MDSCHEMA_HIERARCHIES"},u=(l=o.model.dataSource,[]);for(r=e.map(l.rows,function(e){if(e.fieldName!=a)return e.fieldName}),e.merge(r,e.map(l.columns,function(e){if(e.fieldName!=a)return e.fieldName})),e.merge(r,e.map(l.filters,function(e){if(e.fieldName!=a)return e.fieldName})),n=0;n<e(l).find("row").length;n++)s=e(e(l).find("row")[n]),e.inArray(s.find("DIMENSIONS").text().split(".")[0],u)>=0||(o.schemaTreeView.push({hasChildren:!0,isSelected:!1,pid:s.find("DIMENSIONS").text().split(".")[0],id:s.find("SET_DISPLAY_FOLDER").text()+"_"+s.find("DIMENSIONS").text().split(".")[0],name:s.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"e-folderCDB e-icon namedSets"}),u.push(s.find("DIMENSIONS").text().split(".")[0])),o.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray("["+e.trim(s.children("SET_NAME").text())+"]",r)>=0,pid:s.find("SET_DISPLAY_FOLDER").text()+"_"+s.find("DIMENSIONS").text().split(".")[0],id:"["+e.trim(s.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:s.children("SET_CAPTION").text(),spriteCssClass:"e-namedSetCDB e-icon",tag:s.find("EXPRESSION").text()});t.isNullOrUndefined(o._fieldData)||o._fieldData.hierarchySuccess==a?t.Pivot._getTreeData(d,t.Pivot.loadHierarchyElements,i):t.Pivot.loadHierarchyElements(i,o._fieldData.hierarchySuccess)},loadHierarchyElements:function(i,l){var r,n,s=i.schemaData.model.pivotControl,o={catalog:s.model.dataSource.catalog,cube:s.model.dataSource.cube,url:s.model.dataSource.data,request:"MDSCHEMA_LEVELS"},d=s.model.dataSource,u=s.model.dataSource.providerName==t.olap.Providers.Mondrian;for(r=e.map(d.rows,function(e){if(e.fieldName!=a)return e.fieldName}),e.merge(r,e.map(d.columns,function(e){if(e.fieldName!=a)return e.fieldName})),e.merge(r,e.map(d.filters,function(e){if(e.fieldName!=a)return e.fieldName})),n=0;n<e(l).find("row").length;n++){var c=e(e(l).find("row")[n]),p=c.find("DIMENSION_UNIQUE_NAME").text(),m=c.find("HIERARCHY_UNIQUE_NAME").text();e(s.schemaTreeView).filter(function(e,t){return t.tag==p}).map(function(e,t){return t}).length>0&&(p!=m||u)&&s.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray(m,r)>=0,pid:p+(u?"~#^Dim":""),id:m,name:c.find("HIERARCHY_CAPTION").text(),spriteCssClass:"2"!=c.find("HIERARCHY_ORIGIN").text()&&"6"!=c.find("HIERARCHY_ORIGIN").text()?"e-hierarchyCDB e-icon":"e-attributeCDB e-icon",tag:m})}t.Pivot._getTreeData(o,t.Pivot.loadLevelElements,i)},loadLevelElements:function(i,a){var l,r=i.schemaData.model.pivotControl,n=e.map(e(a).find("row"),function(t){if("1"!=parseInt(e(t).children("LEVEL_TYPE").text())&&"[measures]"!=e(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase())return{hasChildren:!1,isChecked:!1,id:e(t).find("LEVEL_UNIQUE_NAME").text(),pid:e(t).find("HIERARCHY_UNIQUE_NAME").text(),name:e(t).find("LEVEL_CAPTION").text(),tag:e(t).find("LEVEL_UNIQUE_NAME").text(),spriteCssClass:"e-level"+parseInt(e(t).children("LEVEL_NUMBER").text())+" e-icon"}});e.merge(r.schemaTreeView,n),(!r.model.enableDrillThrough||r._fieldData.measureSuccess)&&(t.isNullOrUndefined(r._fieldData)||!r._fieldData.measureSuccess?(l={catalog:r.model.dataSource.catalog,cube:r.model.dataSource.cube,url:r.model.dataSource.data,request:"MDSCHEMA_MEASURES"},t.Pivot._getTreeData(l,t.Pivot.loadMeasureElements,i)):t.Pivot.loadMeasureElements(i,r._fieldData.measureSuccess))},loadMeasureGroups:function(i,a){t.isNullOrUndefined(i.pivotControl._fieldData)&&(i.pivotControl._fieldData={}),i.pivotControl._fieldData.measuresGroups=e(a).find("row")},loadMeasureElements:function(i,l){var r,n,s,o,d=i.schemaData.model.pivotControl,u={catalog:d.model.dataSource.catalog,cube:d.model.dataSource.cube,url:d.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},c=[];r=e.map(d.model.dataSource.values,function(e){if(e.measures!=a)return e.measures}),d.reportItemNames=e.map(r,function(e){if(e.fieldName!=a)return e.fieldName}),"en-US"!=d.model.locale&&(u={catalog:d.model.dataSource.catalog,cube:d.model.dataSource.cube,url:d.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.Pivot._getTreeData(u,t.Pivot.loadMeasureGroups,{pivotControl:d,action:"loadFieldElements"}));var p,m,h,g=[],f=[],_=[],b=[],v=[];if("ejPivotClient"==d.pluginName&&(d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Ascending||d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Descending)&&d.model.sortCubeMeasures!=t.PivotAnalysis.SortOrder.None){for(sortType=d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Ascending?"ascending":"descending",s=0;s<e(l).find("row").length;s++)f.push({name:e(l).find("row:eq("+s+") MEASURE_CAPTION").text()});for(m=t.DataManager(f).executeLocal(t.Query().sortBy("name",sortType)),e.each(m,function(t,i){for(var a=0;a<e(l).find("row").length;a++)i.name==e(l).find("row:eq("+a+") MEASURE_CAPTION").text()&&_.push(e(l).find("row:eq("+a+")"))}),s=0;s<_.length;s++)e.inArray(e(_[s]).children("MEASUREGROUP_NAME").text(),g)>=0||(g.push(e(_[s]).children("MEASUREGROUP_NAME").text()),b.push({name:e(_[s]).children("MEASUREGROUP_NAME").text()}));p=t.DataManager(b).executeLocal(t.Query().sortBy("name",sortType)),e.each(p,function(t,i){for(var a=0;a<_.length;a++)i.name==e(_[a]).children("MEASUREGROUP_NAME").text()&&v.push(e(_[a]))}),h=v}else h=e(l).find("row");for(s=0;s<h.length;s++){var C=e(h[s]),S=C.children("MEASUREGROUP_NAME").text(),O=C.find("MEASURE_UNIQUE_NAME").text();e.inArray(S,c)>=0||("en-US"!=d.model.locale?n=(o=e.map(d._fieldData.measuresGroups,function(t){if(e(t).children("MEASUREGROUP_NAME").text()==S)return e(t).children("MEASUREGROUP_CAPTION").text()})).length>0?o[0]:S:n=S,""!=S&&d.schemaTreeView.push({hasChildren:!0,isChecked:!1,pid:"[Measures]",id:S,name:n,spriteCssClass:"e-measureGroupCDB e-icon",tag:S}),c.push(S)),d.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray(O,d.reportItemNames)>=0,id:O,pid:""==S?"[Measures]":S,name:C.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:O}),e.inArray(O,d.reportItemNames)>=0&&d.reportItemNames.splice(d.reportItemNames.indexOf(O),1)}t.isNullOrUndefined(i.schemaData)||!i.schemaData.model.olap.showKpi&&!d.model.enableKPI?t.isNullOrUndefined(i.schemaData)||i.schemaData._createTreeView(this,d.schemaTreeView):(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"kpiCDB e-folderCDB e-icon",tag:""},d.schemaTreeView.splice(1,0,treeNodeElement),u.request="MDSCHEMA_KPIS",t.Pivot._getTreeData(u,t.Pivot.loadKPIElements,i))},loadKPIElements:function(t,i){for(var a=t.schemaData.model.pivotControl,l=this.reportItemNames,r=[],n=0;n<e(i).find("row").length;n++){var s=e(e(i).find("row")[n]),o=s.children("KPI_CAPTION").text(),d=s.children("KPI_goal").text(),u=s.children("KPI_STATUS").text(),c=s.children("KPI_TREND").text(),p=s.find("KPI_VALUE").text();e.inArray(s.children("KPI_NAME").text(),r)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:o,name:o,spriteCssClass:"e-measureGroupCDB e-icon",tag:o},a.schemaTreeView.push(treeNodeElement),r.push(o)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(d,l)>=0,id:d,pid:o,name:a.model.enableKPI?"Goal":a._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:d},a.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(u,l)>=0,id:u,pid:o,name:a.model.enableKPI?"Status":a._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:u},a.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(c,l)>=0,id:c,pid:o,name:a.model.enableKPI?"Trend":a._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:c},a.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(p,l)>=0,id:p,pid:o,name:a.model.enableKPI?"Value":a._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:p},a.schemaTreeView.push(treeNodeElement)}t.schemaData._createTreeView(this,a.schemaTreeView),delete a.reportItemNames,delete a.schemaTreeView},_createCalcMemberDialog:function(i,l){var r,n,s,o,d,u,c,p;l=t.isNullOrUndefined(l.model)?this:l;r=i.length>1&&i[0]!=a?JSON.parse(i[0].Value):i.d!=a?JSON.parse(i.d[0].Value):JSON.parse(i.CubeTreeInfo),null!=l.model.afterServiceInvoke&&l._trigger("afterServiceInvoke",{action:"fetchCalcMemberTreeView",element:l.element,customObject:l.model.customObject}),t.Pivot.openPreventPanel(l),l.element.find(".e-calcMemberDialog",".e-clientDialog",".e-dialog").remove();var m=t.buildTag("div.e-cubeBrowserCalcMember",t.buildTag("div#"+l._id+"_cubeTreeViewCalcMember.e-cubeTreeViewCalcMember")[0].outerHTML,{})[0].outerHTML,h=t.buildTag("label.lblCaption",l._getLocalizedLabels("Caption"),{})[0].outerHTML+t.buildTag("input#"+l._id+"_captionFieldCM.captionFieldCM","",{}).attr("aria-label",l._getLocalizedLabels("Caption"))[0].outerHTML,g=t.buildTag("label.lblexpression",l._getLocalizedLabels("Expression"),{})[0].outerHTML+t.buildTag("textarea#"+l._id+"_expressionFieldCM.e-textarea e-droppable expressionFieldCM"+(l.model.enableRTL?" e-rtl":""),"",{}).attr("aria-label",l._getLocalizedLabels("Expression"))[0].outerHTML,f=t.buildTag("label.lblmemberType",l._getLocalizedLabels("MemberType"),{})[0].outerHTML+t.buildTag("input#"+l._id+"_memberTypeFieldCM.memberTypeFieldCM","",{}).attr("aria-label",l._getLocalizedLabels("MemberType"))[0].outerHTML+t.buildTag("input#"+l._id+"_dimensionFieldCM.dimensionFieldCM","",{}).attr("aria-label","dimension")[0].outerHTML,_=t.buildTag("label.lblformat",l._getLocalizedLabels("FormatString"),{})[0].outerHTML+t.buildTag("input#"+l._id+"_formatFieldCM.formatFieldCM","",{}).attr("aria-label",l._getLocalizedLabels("FormatString"))[0].outerHTML+t.buildTag("input#"+l._id+"_customFormatFieldCM.customFormatFieldCM","",{}).attr("aria-label","custom format")[0].outerHTML,b=t.buildTag("div.e-calcMemberFieldPanel",h+g+f+_,{})[0].outerHTML,v=t.buildTag("button#"+l._id+"_btnOk.e-btnCalcMemberOk",l._getLocalizedLabels("OK"),{},{name:l._getLocalizedLabels("OK")}).attr("aria-label",l._getLocalizedLabels("OK")).attr("title",l._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,C=t.buildTag("button#"+l._id+"_btnCancel.btnCalcMemberCancel",l._getLocalizedLabels("Cancel"),{},{name:l._getLocalizedLabels("Cancel")}).attr("aria-label",l._getLocalizedLabels("Cancel")).attr("title",l._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,S=t.buildTag("div.e-calcMemberFooter",v+C,{})[0].outerHTML;for(l._calcMemberDialog=t.buildTag("div#"+l._id+"_calcMemberDialog",m+b+S,{})[0].outerHTML,e(l._calcMemberDialog).appendTo("#"+l._id),e("#"+l._id+"_calcMemberDialog").ejDialog({width:"auto",title:l._getLocalizedLabels("CalculatedMember"),cssClass:l.model.cssClass+" e-calcMemberDialog",enableModal:!1,target:"#"+l._id,enableRTL:l.model.enableRTL,enableResize:!1,close:t.proxy(function(){t.Pivot.closePreventPanel(l)},l),beforeOpen:t.proxy(function(){l.element.find(".e-calcMemberDialog .e-dialog").css("display","block")},l)}),l._calcMemberDialog=l.element.find("#"+l._id+"_calcMemberDialog").data("ejDialog"),e("#"+l._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80px",enableRTL:l.model.enableRTL,click:t.proxy(function(){l._calcMemberDialog.close(),l._selectedCalcMember=null,t.Pivot.closePreventPanel(l)},l)}),e("#"+l._id+"_btnOk").ejButton({type:t.ButtonType.Button,width:"80px",enableRTL:l.model.enableRTL,click:t.proxy(function(){var i,a,r,n,s,o,d;if(""!=e.trim(l.element.find("#"+l._id+"_captionFieldCM").val())&&""!=e.trim(l.element.find("#"+l._id+"_expressionFieldCM").val()))if("Custom"!=l.element.find("#"+l._id+"_formatFieldCM").val()||""!=e.trim(l.element.find("#"+l._id+"_customFormatFieldCM").val())){if(t.isNullOrUndefined(l._selectedCalcMember))for(i=0;i<l._calcMembers.length;i++)if(e.trim(l.element.find("#"+l._id+"_captionFieldCM").val()).toLowerCase()==l._calcMembers[i].name.toLowerCase()){if(!confirm(l._getLocalizedLabels("Confirm")))return;l._selectedCalcMember=e.trim(l.element.find("#"+l._id+"_captionFieldCM").val())}if(l._calcMemberDialog.close(),t.Pivot.closePreventPanel(l),a="",t.isNullOrUndefined(l._selectedCalcMember)||(s=t.DataManager(l._calcMembers).executeLocal(t.Query().where("name","equal",l._selectedCalcMember,!0)),!t.isNullOrUndefined(s)&&s.length>0&&(a=s[0].tag)),l._waitingPopup.show(),r={action:"calculatedMember",olapReport:l.currentReport,clientReports:l.reports,caption:l.currentCubeName+"%"+e.trim(l.element.find("#"+l._id+"_captionFieldCM").val()),expression:e.trim(l.element.find("#"+l._id+"_expressionFieldCM").val()),memberType:l.element.find("#"+l._id+"_memberTypeFieldCM").val(),dimension:l.element.find("#"+l._id+"_dimensionFieldCM").val(),formatString:"Custom"==l.element.find("#"+l._id+"_formatFieldCM").val()?e.trim(l.element.find("#"+l._id+"_customFormatFieldCM").val()):l.element.find("#"+l._id+"_formatFieldCM").val(),uniqueName:a,customObject:l.model.customObject},l.model.operationalMode==t.Pivot.OperationalMode.ServerMode)l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.calculatedMember,JSON.stringify(r),l._calcMemberDroppedSuccess);else{r.caption=r.caption.replace("%",""),n="",n=r.memberType.toLowerCase().indexOf("measure")>-1?"[Measures].["+e.trim(r.caption)+"]":e(jQuery("[id*='["+r.dimension+"]']")[0]).attr("data-defaulthierarchy")+".["+e.trim(r.caption)+"]",s={caption:r.caption,expression:r.expression,tag:n,hierarchyUniqueName:"["+e.trim(r.dimension)+"].["+e.trim(r.dimension)+"]",memberType:r.memberType,formatString:r.formatString?r.formatString:r.format?r.format:null},-1==r.memberType.toLowerCase().indexOf("measure")&&null!=l._selectedCalcMember&&(t.Pivot.getReportItemByFieldName(this._schemaData._selectedFieldName,this.model.dataSource).item.hierarchyUniqueName=s.hierarchyUniqueName),l._selectedCalcMember=null;var u={id:r.caption,pid:"_0",name:r.caption,hasChildren:!1,spriteCssClass:"e-calcMemberCDB e-icon",tag:n,expression:r.expression,formatString:null,nodeType:0,hierarchyUniqueName:"Measure"==r.memberType?"":s.hierarchyUniqueName},c=!1,p=s.caption;l.model.calculatedMembers=e.grep(l.model.calculatedMembers,function(e){return e.caption==p&&(c=!0,e.caption=s.caption,e.expression=s.expression,e.hierarchyUniqueName=s.hierarchyUniqueName,e.memberType=r.memberType,e.formatString=r.formatString),e}),"_0"!=(o=l.element.find(".e-schemaFieldTree").data("ejTreeView").model.fields).dataSource[0].id&&o.dataSource.splice(0,0,{id:"_0",name:"Calculated Members",hasChildren:!0,spriteCssClass:"e-calcMemberGroupCDB e-icon",tag:""}),c?(d=this._schemaData._selectedFieldName,o.dataSource=e.grep(o.dataSource,function(e){return e.id==d&&(e.expression=s.expression,e.hierarchyUniqueName=s.hierarchyUniqueName,e.expression=s.expression,e.memberType=s.memberType,e.formatString=s.formatString),e})):l.model.calculatedMembers.push(s),c?l.refreshControl():o.dataSource.push(u),t.Pivot._refreshFieldList(l)}}else t.Pivot._createErrorDialog(l._getLocalizedLabels("EmptyFormat"),l._getLocalizedLabels("Warning"),l);else t.Pivot._createErrorDialog(l._getLocalizedLabels("EmptyField"),l._getLocalizedLabels("Warning"),l)},l)}),l.element.find("#"+l._id+"_cubeTreeViewCalcMember").ejTreeView({fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:r},allowDragAndDrop:!0,enableRTL:l.model.enableRTL,allowDropChild:!1,allowDropSibling:!1,dragAndDropAcrossControl:!0,cssClass:"calcMemberTreeViewDragedNode",nodeDropped:t.proxy(function(t){null!=t.target&&t.target.attr("id")==l._id+"_expressionFieldCM"&&l.element.find("#"+l._id+"_expressionFieldCM").val(l.element.find("#"+l._id+"_expressionFieldCM").val()+e(t.droppedElement).attr("data-tag"))},l),beforeExpand:t.proxy(t.Pivot._getMemberChildNodes,l)}),l.element.find("#"+l._id+"_captionFieldCM").ejMaskEdit({name:"inputbox",inputMode:t.InputMode.Text,watermarkText:"",maskFormat:"",textAlign:l.model.enableRTL?"right":"left",width:"100%"}),l.element.find("#"+l._id+"_customFormatFieldCM").ejMaskEdit({name:"inputbox",inputMode:t.InputMode.Text,watermarkText:"",maskFormat:"",textAlign:l.model.enableRTL?"right":"left",width:"100%",cssClass:"e-calcMemberCustomFormat"}),l.element.find(".e-calcMemberCustomFormat").css("visibility","hidden"),l.element.find("#"+l._id+"_memberTypeFieldCM").ejDropDownList({dataSource:[{text:"Measure",value:"Measure"},{text:"Dimension",value:"Dimension"}],enableRTL:l.model.enableRTL,width:"100%",selectedIndex:0,change:t.proxy(function(e){"Dimension"==e.text?l.element.find(".e-calcMemberDimensionField").css("visibility","visible"):l.element.find(".e-calcMemberDimensionField").css("visibility","hidden")},l)}),n=t.DataManager(r).executeLocal(t.Query().where("spriteCssClass","contains","e-dimensionCDB")),s=[],p=0;p<n.length;p++)s.push({text:n[p].name,value:n[p].name});for(l.element.find("#"+l._id+"_dimensionFieldCM").ejDropDownList({dataSource:s,selectedIndex:0,width:"100%",enableRTL:l.model.enableRTL,cssClass:"e-calcMemberDimensionField"}),l.element.find(".e-calcMemberDimensionField").css("visibility","hidden"),l.element.find("#"+l._id+"_formatFieldCM").ejDropDownList({dataSource:[{text:"Standard",value:"Standard"},{text:"Currency",value:"Currency"},{text:"Percent",value:"Percent"},{text:"Custom",value:"Custom"}],enableRTL:l.model.enableRTL,selectedIndex:0,width:"100%",enableRTL:l.model.enableRTL,change:t.proxy(function(e){"Custom"==e.text?l.element.find(".e-calcMemberCustomFormat").css("visibility","visible"):l.element.find(".e-calcMemberCustomFormat").css("visibility","hidden")},l)}),o=l.element.find(".e-cubeTreeViewCalcMember").find("li"),p=0;p<o.length;p++)t.isNullOrUndefined(e(o[p]).attr("id"))||e(o[p]).attr("data-tag",t.DataManager(r).executeLocal(t.Query().where("id","equal",e(o[p]).attr("id")))[0].tag);for(d=l.element.find(".e-cubeTreeViewCalcMember .e-folderCDB"),p=0;p<d.length;p++)e(d[p].parentElement).removeClass("e-draggable");if(l.element.find(".e-cubeTreeViewCalcMember .calcMemberGroupCDB").length>0&&l.element.find(".e-cubeTreeViewCalcMember .calcMemberGroupCDB").parent().removeClass("e-draggable"),l._calcMemberTreeObj=l.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView"),!t.isNullOrUndefined(l._selectedCalcMember)&&(u={},(u=l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.DataManager(l._calcMembers).executeLocal(t.Query().where("name","equal",l._selectedCalcMember)):t.DataManager(l.model.calculatedMembers).executeLocal(t.Query().where("caption","equal",l._selectedCalcMember))).length>0)){if(c=0,c=l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?u[0].nodeType:u.length>0&&u[0].memberType&&("dimension"==u[0].memberType||"Dimension"==u[0].memberType)?1:0,l.element.find("#"+l._id+"_captionFieldCM").val(u[0].caption||u[0].name),l.element.find("#"+l._id+"_expressionFieldCM").val(u[0].expression),l.element.find("#"+l._id+"_memberTypeFieldCM").data("ejDropDownList").selectItemsByIndices(c),1==c){var O=(l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?u[0].tag:u[0].hierarchyUniqueName).split(".")[0].replace(/\[/g,"").replace(/\]/g,""),x=l.element.find("#"+l._id+"_dimensionFieldCM").data("ejDropDownList").model.dataSource;for(p=0;p<x.length;p++)x[p].value==O&&l.element.find("#"+l._id+"_dimensionFieldCM").data("ejDropDownList").selectItemsByIndices(p)}t.isNullOrUndefined(u[0].formatString)||("Standard"==u[0].formatString?l.element.find("#"+l._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(0):"Currency"==u[0].formatString?l.element.find("#"+l._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(1):"Percent"==u[0].formatString?l.element.find("#"+l._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(2):(l.element.find("#"+l._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(3),l.element.find("#"+l._id+"_customFormatFieldCM").val(u[0].formatString)))}l._waitingPopup.hide()},_refreshFieldList:function(i){var a,l,r,n,s,o=i.element.find(".e-schemaFieldTree").data("ejTreeView");for(o.refresh(),a=o.model.fields.dataSource,l=i.element.find(".e-schemaFieldTree li"),r=0;r<e(l).length;r++)n=e(e(l)[r]).attr("id"),(s=e.map(a,function(e){if(e.id==n)return{tag:e.tag,expression:e.expression,defaultHierarchy:e.defaultHierarchy}})).length>0&&""!=s[0]&&(e(e(l)[r]).attr("data-tag",s[0].tag),t.isNullOrUndefined(s[0].expression)||e(e(l)[r]).attr("expression",s[0].expression),t.isNullOrUndefined(s[0].defaultHierarchy)||e(e(l)[r]).attr("data-defaultHierarchy",s[0].defaultHierarchy))},_getMemberChildNodes:function(i){var a,l,r;if((e(i.currentElement).find("a > span")[0].className.indexOf("level")>-1||e(i.currentElement).find("a > span")[0].className.indexOf("member")>-1)&&(a=t.DataManager(this._calcMemberTreeObj.dataSource()).executeLocal(t.Query().where("pid","equal",e(i.currentElement).attr("id")).where("name","equal","(Blank)")),!t.isNullOrUndefined(a)&&a.length>0))if(this._calcMemberTreeObj.hideNode(a[0].id),this.pNode=i.currentElement,this._waitingPopup.show(),l=e(i.currentElement).find("a > span")[0].className.indexOf("level")>-1?"level":"member",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var n=this.model.dataSource,s=this.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView"),o=e.map(s.model.fields.dataSource,function(t){if(t.id==e(i.currentElement).attr("id"))return t});if(e(i.currentElement).children("ul").children().length>1)this._waitingPopup&&this._waitingPopup.hide();else{o.length>0&&(this._calcExpanded=o[0]);var d="select {"+e(i.currentElement).attr("data-tag")+".members}dimension properties CHILDREN_CARDINALITY, MEMBER_TYPE on 0 from ["+e.trim(n.cube)+"]",u=t.olap._mdxParser.getSoapMsg(d,n.data,n.catalog),c=t.olap.base._getConnectionInfo(n.data);this.doAjaxPost("POST",c.url,{XMLA:u},t.proxy(this._generateCalculatedMember,this),null,{action:"fetchMembers"})}}else null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"fetchMemberChildNodes",element:this.element,customObject:this.model.customObject}),r=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMemberTreeNodes,JSON.stringify({action:"fetchMemberChildNodes",dimensionName:e(i.currentElement).attr("data-tag")+":"+l+":"+e(i.currentElement).attr("id"),olapReport:this.currentReport,customObject:r}),t.proxy(t.Pivot._fetchMemberSuccess,this))},_fetchMemberSuccess:function(l){var r,n,s;for(r=l.length>1&&l[0]!=a?JSON.parse(l[0].Value):l.d!=a?JSON.parse(l.d[0].Value):JSON.parse(l.MemberChildNodes),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"fetchMemberChildNodes",element:this.element,customObject:this.model.customObject}),this._calcMemberTreeObj.model.beforeExpand=null,this._calcMemberTreeObj.addNode(r,e(this.pNode)),n=t.DataManager(this._calcMemberTreeObj.dataSource()).executeLocal(t.Query().where("pid","equal",e(this.pNode).attr("id")).where("name","equal","(Blank)")),!t.isNullOrUndefined(n)&&n.length>0&&this._calcMemberTreeObj.removeNode(n[0].id),e.each(e(this.pNode).children().find("li"),function(e,t){t.setAttribute("data-tag",r[e].tag)}),s=e(this.pNode).children().find("li"),i=0;i<s.length;i++)1==r[i].hasChildren&&(this._calcMemberTreeObj.addNode({id:r[i].id+"_Blank_"+i,name:"(Blank)",parentId:r[i].id},s[i]),this.element.find("#"+r[i].id).find("> div > div:first").removeClass("e-process"),this._calcMemberTreeObj.collapseNode(this.element.find("#"+r[i].id)));this._calcMemberTreeObj.model.beforeExpand=t.proxy(t.Pivot._getMemberChildNodes,this),this._waitingPopup.hide()},_drillThroughCellClick:function(a,l){var r,n,s,o,d,u,c;if(l._waitingPopup.show(),s=e(a.currentTarget.parentElement).attr("data-p"),l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)(n=e(l.element).parents(".e-pivotclient").length>0||e(l.element).parents(".e-maximumView").length>0?l._pivotClientObj:l).doAjaxPost("POST",n.model.url+"/"+n.model.serviceMethodSettings.drillThroughDataTable,JSON.stringify({currentReport:JSON.parse(l.getOlapReport()).Report,layout:l.model.layout,cellPos:s,selector:"",customObject:JSON.stringify(n.model.customObject)}),function(e){n._trigger("drillThrough",{element:l.element,data:e})});else{for(o=e("#"+l._id).find("tbody").find("tr:first").find("th").length,i=0;i<o;i++)-1!=(d=-1!=l.getJSONRecords()[parseInt(i*l._rowCount+parseInt(s.split(",")[1]))].Info.indexOf("Measures")||l.getJSONRecords()[parseInt(i*l._rowCount+parseInt(s.split(",")[1]))].RowSpan<=1?l.getJSONRecords()[parseInt(i*l._rowCount+parseInt(s.split(",")[1]))].Info.split("::")[0]:"").indexOf("Measures")&&(r=d),""!=d&&(l._rowHeader[i]=d);for(u=e("#"+l._id).find("tbody").find('[data-p="'+parseInt(s.split(",")[0])+","+parseInt(s.split(",")[1])+'"]').closest("tbody").prev().children("tr").length,i=0;i<u;i++)-1!=(c=-1!=l.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*l._rowCount+i)].Info.indexOf("Measures")||l.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*l._rowCount+i)].ColSpan<=1?l.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*l._rowCount+i)].Info.split("::")[0]:"").indexOf("Measures")&&(r=c),""!=c&&(l._colHeader[i]=c);for((t.isNullOrUndefined(l._fieldData)||!t.isNullOrUndefined(l._fieldData)&&t.isNullOrUndefined(l._fieldData.hierarchy))&&l._getFieldItemsInfo(l),j=0;j<l._fieldData.measures.length;j++)r==l._fieldData.measures[j].id&&(l.measureGrp=l._fieldData.measures[j].pid);l._rowHeader=e.grep(l._rowHeader,function(e){return 0==e||e}),l._colHeader=e.grep(l._colHeader,function(e){return 0==e||e}),l._createDrillThroughQuery("",l)}},openHierarchySelector:function(e,i){var a,l,r;e.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._createDrillThroughDialog(e,i):(e._waitingPopup.show(),l=(a=e.target.className.indexOf("e-pivotclient")>=0?e._pivotGrid:e)._getConnectionInfo(e.model.dataSource.data),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASUREGROUP_DIMENSIONS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.model.dataSource.cube+"</CUBE_NAME><MEASUREGROUP_NAME>"+a.measureGrp+"</MEASUREGROUP_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+l.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>",this.doAjaxPost("POST",l.url,{XMLA:r},a._loadDimensionElements,null,{pvtGridObj:a,action:"loadMeasureElements"}))},_createDrillThroughDialog:function(i,a){var l,r,n,s;i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&a.shift(),i.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove();var o=t.buildTag("label#",i._getLocalizedLabels("SelectHierarchy"))[0].outerHTML,d="<div class=e-cubeTable style='width:200px; overflow:auto'><div valign=\"bottom\">"+this._createHierarchyBrowser()+"</div></div>",u=t.buildTag("div#dropDlg.dropDlg",'<table class="e-outerTable"><tr><td>'+d+"</td><td>"+o+"<br><textarea id='hrSel' style='width:270px; height:300px; resize:none; margin:0px 5px 0 5px'></textarea></br><br></td></tr></table>")[0].outerHTML+"</br>",c=t.buildTag("div",t.buildTag("button#btnOK.dialogBtnOK",i._getLocalizedLabels("OK")).attr("title",i._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML+t.buildTag("button#btnCancel.dialogBtnCancel",i._getLocalizedLabels("Cancel")).attr("title",i._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,{float:"right",margin:"-5px 0 6px"})[0].outerHTML,p=t.buildTag("div#clientDialog.e-clientDialog",u+c,{opacity:"1"}).attr("title","Hierarchy Selector")[0].outerHTML;for(e(p).appendTo("#"+i._id),e("#btnOK, #btnCancel").ejButton(),e("#btnOK, #btnCancel").css({margin:"0 20px 20px 0",width:"50px"}),i.element.find(".e-clientDialog").ejDialog({width:550,target:"#"+i._id,enableResize:!1,enableRTL:i.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,i)}),i.element.find(".cubeTreeViewHierarchy").ejTreeView({showCheckbox:!0,fields:{id:"id",parentId:"pid",text:"name",isChecked:"isSelected",spriteCssClass:"spriteCssClass",dataSource:i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.isNullOrUndefined(a.d)?e.parseJSON(a):e.parseJSON(a.d):a},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:!!i.model.enableRTL,beforeDelete:function(){return!1},dragAndDropAcrossControl:!0,nodeDropped:t.proxy(this._hierarchyNodeDropped,i)}),i._tableTreeObj=i.element.find(".cubeTreeViewHierarchy").data("ejTreeView"),i._tableTreeObj.element.find(".e-ul").css({width:"100%",height:"100%"}),i._tableTreeObj.element.find(".e-chkbox-wrap").remove(),l=i._tableTreeObj.element.find("li"),r=0;r<l.length;r++)n=i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.isNullOrUndefined(a.d)?e.parseJSON(a)[r].tag:e.parseJSON(a.d)[r].tag:a[r].tag,l[r].setAttribute("data-tag",n);i._tableTreeObj&&i._tableTreeObj.element.find("li").mouseover(t.proxy(function(t){e(t.target).parent().find(".e-measureGroupCDB, .e-dimensionCDB, .e-folderCDB").length>0&&e(t.target).css("cursor","default")},i)),s=i,e("#btnOK").click(function(){var i=e("#hrSel").val();e(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog, .drilltableDialog").remove(),s._waitingPopup.show(),t.olap._mdxParser._createDrillThroughQuery(i,s),s._waitingPopup.hide()}),e("#btnCancel").click(function(){e(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),s._waitingPopup.hide()}),i.model.enableRTL&&(e(".e-dialog").addClass("e-rtl"),e(".dialogBtnCancel").css("margin","0 -70px 0 0"))},_createHierarchyBrowser:function(){return t.buildTag("div.cubeBrowserHierarchy",t.buildTag("div.cubeTreeViewHierarchy")[0].outerHTML,{width:"200px",height:"300px",overflow:"auto"})[0].outerHTML},_hierarchyNodeDropped:function(i){var a,l,r;if("hrSel"==i.dropTarget[0].id&&(a=e(e(i.droppedElement).children()[0]).find(".e-dimensionCDB").length>0?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement).find("li:first").attr("data-tag"):e(i.droppedElement).find("li:first")[0].id:0==e(i.droppedElement).find("li:first").length?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement.parent().parent()).attr("data-tag"):e(i.droppedElement.parent().parent())[0].id:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement).attr("data-tag"):i.droppedElementData.id,!t.isNullOrUndefined(a))){for(a=a.replace("[","[$"),l=0;l<e("#hrSel").val().split(",").length;l++)if(a==e("#hrSel").val().split(",")[l])return!1;0!=(r=this.element.find("#hrSel").val()).length?(r=r+","+a,this.element.find("#hrSel").val(r)):this.element.find("#hrSel").val(a)}},_generateDrillData:function(t,i){for(var a=e(i).find("row").children(),l=e.map(a,function(e){var t=e.textContent;return'"'+e.tagName.replace(/_x005B_/g,"[").replace(/_x0020_/g," ").replace(/_x005D_/g,"]").replace(/_x0024_/g,"$").replace("].[","]-[")+'":"'+t+'"'}),r=l[0],n="",s=0;s<l.length;s++)l[s]!=r?n+=","+l[s]:n+=""==n?"[{"+l[s]:"}, {"+l[s];n+="}]",e(t.pvtGridObj.element).parents(".e-pivotclient").length>0?e(t.pvtGridObj.element).parents(".e-pivotclient").data("ejPivotClient")._trigger("drillThrough",{element:t.pvtGridObj.element,data:n}):t.pvtGridObj._trigger("drillThrough",{element:t.pvtGridObj.element,data:n})},_getFilterStateMember:function(i,a,l,r,n){if("include"==l.filterItems.filterType)if(1==l.filterItems.values.length)if(t.isNullOrUndefined(r._fieldSelectedMembers[l.fieldName.toLowerCase()])&&i){var s="select {"+l.filterItems.values[0]+"}dimension properties CHILDREN_CARDINALITY on 0 from ["+e.trim(r.model.dataSource.cube)+"]",o=t.olap._mdxParser.getSoapMsg(s,r.model.dataSource.data,r.model.dataSource.catalog),d=t.olap.base._getConnectionInfo(r.model.dataSource.data);this.doAjaxPost("POST",d.url,{XMLA:o},t.proxy(this._getInitialSlicerName,this),null,{controlObject:r,action:"fetchMembers"}),n=r._slicerName}else i||(n=l.filterItems.values[0]);else n=r._getLocalizedLabels("MultipleItems");else n=a.length-(-1==l.filterItems.values.indexOf("All")?l.filterItems.values.length:l.filterItems.values.length-1)==1?a.filter(function(e){if(-1==l.filterItems.values.indexOf(e))return e}):r._getLocalizedLabels("MultipleItems");return n},_getFilterState:function(i,l,r,n){var s,o,d="";if(n.model.operationalMode==t.Pivot.OperationalMode.ClientMode)i?(t.isNullOrUndefined(t.olap.base.olapCtrlObj)&&(t.olap.base.olapCtrlObj=n),("All"==n._fieldSelectedMembers[r.fieldName.toLowerCase()]||t.isNullOrUndefined(n._fieldSelectedMembers[r.fieldName.toLowerCase()]))&&t.olap._mdxParser.getAllMember(n.model.dataSource,r.fieldName,n),d="All"==n._fieldSelectedMembers[r.fieldName.toLowerCase()]||t.isNullOrUndefined(n._fieldSelectedMembers[r.fieldName.toLowerCase()])?n._allMember:n._fieldSelectedMembers[r.fieldName.toLowerCase()],d=this._getFilterStateMember(i,l,r,n,d)):d=this._getFilterStateMember(i,l,r,n,d);else if(n.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if((s=t.isNullOrUndefined(n._tempFilterData)?[]:e.map(n._tempFilterData,function(e){return e[r.DimensionName]})).length>0&&n._fieldMembers[r.DimensionName])d=n._fieldMembers[r.DimensionName].length-s.length==1?n._fieldMembers[r.DimensionName].filter(function(e){if(-1==s.indexOf(e))return e}):n._getLocalizedLabels("MultipleItems");else if(t.isNullOrUndefined(n._clientReportCollection))d=n._getLocalizedLabels("All");else for(o=0;o<n._clientReportCollection.length;o++){if(!t.isNullOrUndefined(n._clientReportCollection[o]._fieldSelectedMembers)&&(""==n._currentRecordName&&n.element.find("#reportList")!=a&&n.element.find("#reportList")[0].value==n._clientReportCollection[o].name||""!=n._currentRecordName&&n._currentReportName==n._clientReportCollection[o].name)){n._fieldSelectedMembers[r.Tag]=n._clientReportCollection[o]._fieldSelectedMembers[r.DimensionName],d="All"==n._fieldSelectedMembers[r.Tag]||n._fieldSelectedMembers[r.Tag]==a?n._getLocalizedLabels("All"):n._fieldSelectedMembers[r.Tag];break}d=n._getLocalizedLabels("All")}else d=("All"==n._fieldSelectedMembers[r.Tag]?r.AllMember:n._fieldSelectedMembers[r.Tag])||r.AllMember;return d},_getInitialSlicerName:function(t,i){t.controlObject._slicerName=e(e(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},_getTreeViewItems:function(t){for(var i,a=t.element.find(".e-editorTreeView"),l=[],r=e(a).find(":input.nodecheckbox"),n=0;n<r.length;n++)i=e(r[n]).parents("li:eq(0)"),l.push({Id:i[0].id,name:e(i[0]).find("a:eq(0)").text()});return l},_getEditorMember:function(i,a,l){var r,n,s,o=l?a._schemaData._editorTreeData:a._editorTreeData,d=[];if(a.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if(0==o.length){var u=this._getTreeViewItems(l?a._schemaData:a,o),c=e.extend(!0,[],l?a._schemaData._memberTreeObj.dataSource():a._memberTreeObj.dataSource()),p=e.map(u,function(i){if("All"!=i.Id)return e.map(c,function(e){i.Id==e.id&&((i=e).name=t.isNullOrUndefined(i.parentId)?i.name+"_1":i.name)}),i}),m=e.map(p,function(t){return e.map(p,function(e){t.parentId==e.id&&(t.name=t.name+"_"+(Number(e.name.split("_")[e.name.split("_").length-1])+1))}),t});e.map(m,function(e){var t=e.name.split("_")[e.name.split("_").length-2],i=Number(e.name.split("_")[e.name.split("_").length-1]),a=e.checkedStatus;d.push({name:t,checked:a,level:Number(i)})})}else e.map(o,function(e){d.push({name:e.name,id:e.id,pid:e.pid,checked:e.checkedStatus,level:e.level})});return this._updateEditorMembers(i,d,a,o)}if(a.model.analysisMode==t.Pivot.AnalysisMode.Olap)return r=l?a._schemaData.element.find(".e-editorTreeView"):a.element.find(".e-editorTreeView"),m=o.length>0?o:e(r).find(":input.nodecheckbox"),o.length>0?e.map(m,function(e){d.push({name:e.name,id:e.id,pid:e.pid,checked:e.checkedStatus,level:Number(e.id.split("_")[e.id.split("_").length-1])})}):e.map(m,function(t){if("All"!=e(t).parents("li:eq(0)").attr("id")){var i=e(t).parent().siblings("a").text(),a=t.value.split("_")[t.value.split("_").length-1],l=!(!t.checked&&"mixed"!=e(t.parentElement).attr("aria-checked"));d.push({name:i,checked:l,level:Number(a)})}}),this._updateEditorMembers(i,d,a,o);for(n=[],s=1;s<i.length;s++)n.push(e(i[s].parentElement).siblings("a").text());return n},_updateEditorMembers:function(i,a,l,r){var n,s,o,d,u,c;if(a.length>0&&"All"==a[0].name&&a.splice(0,1),!t.isNullOrUndefined(l._fieldMembers[i]))if(0==r.length){var p=[],m=0,h="",g=l._fieldMembers[i];for(n=0;n<a.length;n++)if(t.isNullOrUndefined(g[n+m])||a[n].level==g[n+m].level)p.push(a[n]);else if(t.isNullOrUndefined(g[n+m])||a[n].level<g[n+m].level){o=n;do{a[n-1].checked&&p.push(g[o]),m++,o++}while(a[n].level<g[o].level);n--}else if(t.isNullOrUndefined(g[n+m])||a[n].level>g[n+m].level){s=g[n+m].level,o=n;do{p.push(a[o]),m--,n=++o-1}while(a[o].level>s)}l._fieldMembers[i]=p}else d=e.extend(!0,[],l._fieldMembers[i]),u=[],e.each(a,function(e,t){for(var i=!1,a=0;a<d.length;a++)if(t.id==d[a].id){d.splice(a,1,t),i=!0;break}i||u.push(t)}),l._fieldMembers[i]=d.concat(u);l._fieldMembers[i]=t.isNullOrUndefined(l._fieldMembers[i])?a:l._fieldMembers[i];var f=1,_="",b="",v=[];do{if(c=e.map(l._fieldMembers[i],function(e){if(e.level==f)return e}),v=e.map(c,function(e){if(e.checked)return e}),c.length==v.length)h=1==f?"All":_,c.length>1&&(b="All"),f++;else if(1==v.length)_=h="All"==b?"multiple":v[0].name,f++;else if(v.length>1&&c.length>v.length){h="multiple";break}}while(v.length>0&&"All"!=h&&"multiple"!=h&&e.map(l._fieldMembers[i],function(e){if(e.level==f)return e}).length>0);return h},_getTreeData:function(e,i,a){var l=t.olap.base._getConnectionInfo(e.url),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME>"+("loadcubelist"==a.action?"":"<CUBE_NAME>"+e.cube+"</CUBE_NAME>")+"</RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog><LocaleIdentifier>"+l.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>";a.action="loadFieldElements",this.doAjaxPost("POST",l.url,{XMLA:r},i,null,a)},updateTreeView:function(i){var a,l,r,n,s,o,d=i.element.find(".e-editorTreeView").find("li"),u=d.length,c=i._memberTreeObj.dataSource(),p=c.length;if(i.element.find(".e-editorTreeView").parents("#"+i._id+"_ClientDialog").find(".e-editorPara").text()==i._getLocalizedLabels("KPIs"))for(s=0;s<u;s++)for(a=e(d[s]).find("span:first").attr("aria-checked"),o=0;o<p;o++)d[s].id!=c[o].id||"mixed"!=a&&"true"!=a?d[s].id==c[o].id&&"false"==a&&(t.isNullOrUndefined(c[o].parentId)?c[o].checkedStatus=!1:e(d[s].parentElement).parent().attr("id")==c[o].parentId&&(c[o].checkedStatus=!1)):t.isNullOrUndefined(c[o].parentId)?c[o].checkedStatus=!0:e(d[s].parentElement).parent().attr("id")==c[o].parentId&&(c[o].checkedStatus=!0);else for(s=0;s<u;s++)for(a=e(d[s]).find("span:first").attr("aria-checked"),o=0;o<p;o++){if(d[s].id==c[o].id&&("mixed"==a||"true"==a)){c[o].checkedStatus=!0;break}if(d[s].id==c[o].id&&"false"==a){c[o].checkedStatus=!1;break}}for(s=0;s<c.length;s++)if(l=!1,1==c[s].checkedStatus){for(o=0;o<c.length;o++)if(c[o].hasOwnProperty("parentId")&&c[o].parentId==c[s].id&&1==c[o].checkedStatus){l=!0;break}if(!l)for(r=0;r<c.length;r++)c[r].hasOwnProperty("parentId")&&c[r].parentId==c[s].id&&(c[r].checkedStatus=!0)}else if(0==c[s].checkedStatus)for(n=0;n<c.length;n++)c[n].hasOwnProperty("parentId")&&c[n].parentId==c[s].id&&(c[n].checkedStatus=!1);for(s=0;s<u;s++)if(null==e(d[s]).attr("data-tag"))for(o=0;o<p;o++)if(e(d[s]).attr("id")==c[o].id){e(d[s]).attr("data-tag",c[o].tag);break}return i._memberTreeObj},getNodesState:function(e){for(var t="",i="",a="ejTreeView"==e.pluginName?e.dataSource():e,l=0;l<a.length;l++)1==a[l].checkedStatus?t+="::"+a[l].id+"||"+a[l].tag+"||"+(a[l].parentId||a[l].pid)+"||"+a[l].name:i+="::"+(a[l].parentId||a[l].pid)+"||"+a[l].tag+"||"+a[l].name;return{selectedNodes:t,unSelectedNodes:i}},removeParentSelectedNodes:function(t){for(var i,l=e.extend([],t),r=0;r<t.length;r++)for(i=0;i<l.length;i++)l[i].Id==t[r].parentId&&l.splice(i,1);return e.map(l,function(e){if(""!=e.tag&&e.tag!=a)return e.tag.replace(/\&/g,"&amp;")})},getChildNodes:function(i,l,r,n,s){var o,d,u,c=i.targetElement,p=(n.cube,n.catalog,n.data,s._generateChildMembers,e(i.currentElement).find("li").length),m=!1,h={memberEditorPageSize:"ejPivotSchemaDesigner"==s.pluginName?s.model.pivotControl.model.memberEditorPageSize:s.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==s.pluginName?s.model.pivotControl.model.enableMemberEditorPaging:s.model.enableMemberEditorPaging};if(h.enableMemberEditorPaging){for(o=0;o<s._memberTreeObj.dataSource().length;o++)if(s._memberTreeObj.dataSource()[o].parentId==i.id||s._memberTreeObj.dataSource()[o].pid==i.id)return i.isChildLoaded=!0,void t.Pivot.closePreventPanel(s)}else s._isSearchApplied=!1;if(jQuery.each(s._editorTreeData,function(e,t){if(t.id==i.id)return t.expanded=!0,t.isChildMerged=!0,!1}),0==p){var g=t.buildTag("span.nodeExpand e-load e-icon")[0].outerHTML,f=e(c).parents("li:eq(0)").attr("id");e.map(r,function(i){var r,n,o,d;i.fieldName!=l||t.isNullOrUndefined(i.filterItems)||(r=i.filterItems,(t.isNullOrUndefined(s.model.pivotControl)?s.model.enableMemberEditorPaging:s.model.pivotControl.model.enableMemberEditorPaging)?(r=e.map(r,function(e){if(e.pid!=a&&e.pid==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"))return m=!0,e})).length>0&&1==m&&(n=t.Pivot._generateChildWithAncestors(s,e(c).parents("li:eq(0)"),h.enableMemberEditorPaging,h.memberEditorPageSize),h.enableMemberEditorPaging&&(r.length>=h.memberEditorPageSize||n.lstChildren.length>=h.memberEditorPageSize)?(s._isEditorDrillPaging=!0,s.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),s._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(s,e(c).parents("li:eq(0)")[0].id),o=n.allLvlLst.length>1&&n.lstChildren.length>=h.memberEditorPageSize?t.Pivot._getParentsTreeList(s,n.lstParents[0].id,s._editorTreeData):e.grep(s._editorTreeData,function(t){return t.id==e(c).parents("li:eq(0)")[0].id})[0],d={childNodes:n.allLvlLst.length>1&&n.lstChildren.length>=h.memberEditorPageSize?n.lstChildren:r,parentNode:o},t.Pivot._drillEditorTreeNode(d,s,h.memberEditorPageSize)):(e(c).parents("li:eq(0)").find(".nodeExpand").remove(),e(c).parents("li:eq(0)").removeClass("e-load"),e.each(r,function(e,t){delete t.parentId}),s._onDemandNodeExpand=!1,s._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(r,s,"ejPivotSchemaDesigner"==s.pluginName?s.model.pivotControl:s),e(c).parents("li:eq(0)")),s._onDemandNodeExpand=!1,s._memberTreeObj.model.nodeCheck=t.proxy(s._nodeCheckChanges,s),s._memberTreeObj.model.nodeUncheck=t.proxy(s._nodeCheckChanges,s),e.each(e(c).parents("li:eq(0)").find("li"),function(e,i){t.isNullOrUndefined(r[e])||i.setAttribute("data-tag",r[e].tag)}))):e.map(r,function(e){(e.parentId!=a&&e.parentId==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-")||e.pid!=a&&e.pid==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"))&&(m=!0)}))});i.isChildLoaded=!!m,m?jQuery.grep(s._editorTreeData,function(e){if(e.pid==i.id)return e}).length>10&&s.element.find("a.e-linkPanel").css("display","block"):(e(c).parents("li:eq(0)").prepend(g),e(c).parents("li:eq(0)").attr("data-tag")==a&&((d=e.map(r,function(e){if(e.fieldName==l)return e})[0])&&e.map(d.filterItems,function(t){t.id==e(c).parents("li:eq(0)").attr("id")&&e(c).parents("li:eq(0)").attr("data-tag",t.tag)})),u=e(c).parents("li:eq(0)").attr("data-tag").replace(/\&/g,"&amp;"),t.olap._mdxParser.getChildren(n,u,s))}},_getFilterParams:function(e,i,a){var l,r,n,s="";if("schemaValue"!=e){if(l="",!t.isNullOrUndefined(i))for(r=0;r<i.length;r++)if(!t.isNullOrUndefined(i[r][a]))for(n=0;n<i[r][a].length;n++)l+="##"+i[r][a][n];""!=l&&(s=e+"::"+a+"::FILTERED"+l)}return s},generateChildMembers:function(i,a){var l,r,n,s,o,d,u=e(a).find("Axis:eq(0) Tuple"),c=[],p=this;t.isNullOrUndefined(p.olapCtrlObj)||(p=p.olapCtrlObj);var m={memberEditorPageSize:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl.model.memberEditorPageSize:p.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl.model.enableMemberEditorPaging:p.model.enableMemberEditorPaging},h={currentReportItems:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl._currentReportItems:p._currentReportItems,savedReportItems:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl._savedReportItems:p._savedReportItems},g=p.element.find("[data-tag='"+i.currentNode.replace(/&amp;/g,"&")+"']");for(r=0;r<u.length;r++){var f=e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[0]).text(),_=""==e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children()).find("Caption").text()?"(Blank)":e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children()).find("Caption").text(),b={hasChildren:"0"!=e(u[r]).find("CHILDREN_CARDINALITY").text(),checkedStatus:"true"==e(e(g).find("input.nodecheckbox")[0]).parent().attr("aria-checked"),id:f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_"),name:_,tag:f,level:parseInt(e(u[r]).find("LNum").text())};c.push(b)}c.length>0&&p.model.enableMemberEditorSorting&&null!=p._sortType&&(c=t.DataManager(c).executeLocal(t.Query().sortBy("name",p._sortType))),l=e(g).parents("li").length>1?e(g).parents("li").first():e(g).parents("li"),e(e(l).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1}),p._memberTreeObj=p.element.find(".e-editorTreeView").data("ejTreeView"),c.length>0&&(n="ejPivotGrid"==p.pluginName?p._selectedField:p._selectedFieldName,e.map(h.currentReportItems,function(i){i.fieldName!=n||t.isNullOrUndefined(i.filterItems)||(e.each(c,function(t,i){i.pid=e(g).attr("id")}),e.merge(i.filterItems,c),p._editorTreeData=i.filterItems)}),0==h.currentReportItems.length&&p._editorTreeData.concat(c)),g.find(".nodeExpand").remove(),g.find(".e-load").removeClass("e-load"),jQuery.each(p._editorTreeData,function(e,t){if(t.id==g[0].id)return t.expanded=!0,!1}),m.enableMemberEditorPaging?(s=t.Pivot._generateChildWithAncestors(p,g,m.enableMemberEditorPaging,m.memberEditorPageSize),c.length>=m.memberEditorPageSize||s.lstChildren.length>=m.memberEditorPageSize?(p._isEditorDrillPaging=!0,p.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),p._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(p,g[0].id),o=s.allLvlLst.length>1&&s.lstChildren.length>=m.memberEditorPageSize?t.Pivot._getParentsTreeList(p,s.lstParents[0].id,p._editorTreeData):e.grep(p._editorTreeData,function(e){return e.id==g[0].id})[0],d={childNodes:s.allLvlLst.length>1&&s.lstChildren.length>=m.memberEditorPageSize?s.lstChildren:c,parentNode:o},t.Pivot._drillEditorTreeNode(d,p,m.memberEditorPageSize)):p._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(c,p,"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl:p),e(g))):p._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(c,p,"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl:p),e(g)),e.each(g.find("li"),function(e,i){t.isNullOrUndefined(c[e])||i.setAttribute("data-tag",c[e].tag)}),h.savedReportItems=e.extend(!0,[],h.currentReportItems)},_generateChildWithAncestors:function(i,a,l,r){var n,s,o=[],d=[e.grep(i._editorTreeData,function(e){return e.id==a[0].id})[0]],u=[];if(l){jQuery.each(i._editorTreeData,function(e,t){if(t.id==a[0].id)return t.expanded=!0,!1}),o.push(d[0]);do{for(n=[],u=[],s=0;s<d.length&&(e.each(i._editorTreeData,function(e,i){t.isNullOrUndefined(i.pid)||i.pid!=d[s].id||(i.expanded&&(n.push(i),o.push(i)),u.push(i))}),!(u.length>=r));s++)u=[];if(d=n.length>0&&u.length<r?n:d,u.length>=r)break}while(n.length>0)}return{allLvlLst:o,lstParents:d,lstChildren:u}},_makeAncestorsExpandable:function(e,i){var a=t.DataManager(e._editorTreeData).executeLocal(t.Query().where("id","equal",i));a.length>0&&(a[0].expanded=!0,i=a[0].pid),!t.isNullOrUndefined(i)&&a.length>0&&this._makeAncestorsExpandable(e,i)},_jsonToEngine:function(e){for(var i,a=e,l=[],r=0;r<a.length;r++)i=parseInt(a[r].Index.split(",")[0]),t.isNullOrUndefined(l[i])?(l[i]=[],l[i].push(a[r])):l[i].push(a[r]);return l},_cropJson:function(i,a){var l,r,n,s,o,d,u,c,p=0,m=0,h=1;if(r=(l=i.model.operationalMode==t.Pivot.OperationalMode.ServerMode?{columns:JSON.parse(i.getOlapReport()).PivotColumns,rows:JSON.parse(i.getOlapReport()).PivotRows,values:JSON.parse(i.getOlapReport()).PivotCalculations}:{columns:i.model.dataSource.columns,rows:i.model.dataSource.rows,values:i.model.dataSource.values}).columns.length+(l.values.length>0&&"rows"!=l.values[0].axis?1:0),n=l.rows.length+(l.values.length>0&&"rows"==l.values[0].axis?1:0),r=0==r?1:r,n=0==n?1:n,""==i._drillAction&&i.model.enableCollapseByDefault){if(f=e.extend(!0,[],t.Pivot._jsonToEngine(a)),r+n>2){for(;m<f[0].length;)if(l.rows.length>1&&-1==f[0][m].CSS.indexOf("summary")&&m+h>r||0==l.columns.length&&0==l.values.length&&-1==f[0][m].CSS.indexOf("summary")||m>0&&h<l.columns.length){for(s=0;s<f.length;s++)f[s].splice(m,1);h++}else m++;for(h=1;p<f.length;)l.columns.length>1&&-1==f[p][0].CSS.indexOf("summary")&&p+h>n||0==l.rows.length&&0==l.values.length&&-1==f[p][0].CSS.indexOf("summary")||p>0&&h<l.rows.length?(f.splice(p,1),h++):p+=f[p][0].CSS.indexOf("summary")>-1?f[p][0].ColSpan:1}for((f=e.map(f,function(t){return[e.map(t,function(e){return("summary rstot"==e.CSS||"summary cstot"==e.CSS||"summary stot"==e.CSS)&&(e.State=2,e.Value=e.Value.replace("Total","")),e})]}))[0][0].ColSpan="none"==f[0][0].CSS&&l.values.length>0&&"rows"==l.values[0].axis&&l.rows.length>0?2:1,f[0][0].RowSpan="none"==f[0][0].CSS&&l.values.length>0&&"rows"!=l.values[0].axis&&l.columns.length>0?2:1,r=l.values.length>0&&"rows"==l.values[0].axis?l.values.length:1,n=l.values.length>0&&"rows"!=l.values[0].axis?l.values.length:1,p=0;p<f[0].length;p++)f[0][p].CSS.indexOf("summary")>-1&&(f[0][p].RowSpan=r,f[0][p].ColSpan=1);for(p=0;p<f.length;p++)f[p][0].CSS.indexOf("summary")>-1&&(f[p][0].ColSpan=n,f[p][0].RowSpan=1);return e.map(f,function(e){return e})}if(i.model.enableCollapseByDefault||""!=i._drillAction){var g=0,f=e.extend(!0,[],t.Pivot._jsonToEngine(i._croppedJson)),_=e.extend(!0,[],t.Pivot._jsonToEngine(i._compJson)),b=e.extend(!0,[],i._compJson),v=""==i._drillParams.currRow?"column":"row";for(o=0;o<i._compJson.length&&0==parseInt(i._compJson[o].Index.split(",")[0]);o++)g++;return d=t.Pivot._getDrillRange(l,v,i,g,b),u=t.Pivot._sliceJson(l,v,r,n,i,b,d.startPos,d.endPos,g,f),"drilldown"==i._drillAction&&(c=t.Pivot._mergeJson(l,i,v,r,n,b,_,f,u,d.startPos,d.endPos,g)),e.map("drilldown"==i._drillAction?c:u,function(e){return e})}return a},_getEnginePos:function(i,a,l){var r=e.map(t.isNullOrUndefined(l[parseInt(i.split(",")[0])])?l[parseInt(a.split(",")[0])]:l[parseInt(i.split(",")[0])],function(e,t){if(e.Index==e.Index.split(",")[0]+","+a.split(",")[1])return t})[0];return{colPos:e.map(l,function(t,i){var l=!1;return e.each(t,function(e,t){t.Index==a&&(l=!0)}),l?i:void 0})[0],rowPos:r}},_mergeJson:function(i,a,l,r,n,s,o,d,u,c,p,m){var h,g,f,_,b,v,C=t.Pivot._getIndices(l,s,a,d,c,p,m),S=C.columnIndices,O=C.rowIndices,x=C.rowSpan,y=C.colSpan,P=t.Pivot._getEnginePos(c,p,d),N=P.colPos,M=P.rowPos,T=[];if("row"==l){if(t.isNullOrUndefined(d[parseInt(c.split(",")[0])+1])){h=parseInt(c.split(",")[0])+1;do{T=e.map(o[h],function(e){if(O.indexOf(parseInt(e.Index.split(",")[1]))>-1)return e.Span="Block",e}),d[h]=T,h++}while(h<y&&!a.model.enableCollapseByDefault)}}else if(parseInt(d[0][parseInt(c.split(",")[1])+1].Index.split(",")[1])!=parseInt(c.split(",")[1])+1)for(v=0;v<o.length;v++){h=parseInt(c.split(",")[1])+1;do{g=o[v][h],S.indexOf(parseInt(g.Index.split(",")[0]))>-1&&(g.Span="Block",d[v].splice(h,0,g)),h++}while(h<x&&!a.model.enableCollapseByDefault)}if("row"==l){for(b=0,v=0;v<d.length;v++)if(!t.isNullOrUndefined(d[v])){f=M,_=0;do{f==M&&d[v].splice(f,1,u[b][_]),f++,_++,d[v].splice(f,0,u[b][_])}while(t.isNullOrUndefined(u[b][_])||parseInt(u[b][_].Index.split(",")[1])<parseInt(p.split(",")[1]));b++}}else for(b=u.length-1,v=N;v>=n;v--)t.isNullOrUndefined(u[b])||d.splice(v,1,u[b]),b--;return t.Pivot._drillSpanCalculation(d,a)},_getIndices:function(i,a,l,r,n,s,o){var d,u=e.map(r,function(e){if(!t.isNullOrUndefined(e))return parseInt(e[0].Index.split(",")[0])}),c=e.map(r[0],function(e){if(!t.isNullOrUndefined(e))return parseInt(e.Index.split(",")[1])});if(l.model.enableCollapseByDefault)"row"==i?u.push(parseInt(n.split(",")[0])+1):c.push(parseInt(n.split(",")[1])+1);else{var p=a[parseInt(s.split(",")[0])*o+parseInt(s.split(",")[1])],m=parseInt(p.Index.split(",")[0]),h=parseInt(p.Index.split(",")[1]),g=p.ColSpan,f=p.RowSpan;if("row"==i)for(d=m+1;d<g;d++)-1==u.indexOf(d)&&u.push(d);else for(d=h+1;d<f;d++)-1==c.indexOf(d)&&c.push(d)}return{columnIndices:u,rowIndices:c,colSpan:g,rowSpan:f}},_sliceJson:function(i,a,l,r,n,s,o,d,u,c){var p,m,h,g,f,_,b,v,C,S,O,x,y=[],P=i.values.length>0&&"rows"!=i.values[0].axis?1:0;if("drilldown"==n._drillAction){var N="row"==a?"0,"+parseInt(o.split(",")[1]):parseInt(o.split(",")[0])+",0",M="row"==a?"0,"+parseInt(d.split(",")[1]):parseInt(d.split(",")[0])+",0",T=t.Pivot._getIndices(a,s,n,c,o,d,u),L=T.columnIndices,w=T.rowIndices,j=parseInt(N.split(",")[0])*u+u,D=0;N="row"==a?N:parseInt(N.split(",")[0])*u+",0";do{for(p="row"==a?parseInt(N.split(",")[1]):parseInt(N.split(",")[0]),D="row"==a?0:D;!t.isNullOrUndefined(s[p])&&("column"!=a||j>p);)("row"==a?L.indexOf(parseInt(s[p].Index.split(",")[0]))>-1:w.indexOf(parseInt(s[p].Index.split(",")[1]))>-1)&&(t.isNullOrUndefined(y[D])&&(y[D]=[]),y[D].push(s[p]),"row"==a&&D++),p+="row"==a?u:1;"column"==a&&(j+=u,D++),N="row"==a?"0,"+(parseInt(N.split(",")[1])+1):parseInt(N.split(",")[0])+u+",0"}while(N!=("row"==a?"0,"+(parseInt(M.split(",")[1])+1):(parseInt(M.split(",")[0])+1)*u+",0"));if(("row"==a?r-1>parseInt(n._drillParams.currPos.split(",")[0])+1:l-P-1>parseInt(n._drillParams.currPos.split(",")[1])+1)&&n.model.enableCollapseByDefault){V="row"==a?0:parseInt(n._drillParams.currPos.split(",")[1])+1,I="row"==a?parseInt(n._drillParams.currPos.split(",")[0])+1:0;do{if(m=!1,!(t.isNullOrUndefined(y[I])||t.isNullOrUndefined(y[I][V])||-1!=y["row"==a?I-1:I]["row"==a?V:V-1].CSS.indexOf("summary")||"rowheader"!=y[I][V].CSS&&"colheader"!=y[I][V].CSS&&"none"!=y[I][V].CSS&&""!=y[I][V].Value))if("row"==a)for(x=0;x<y.length;x++)t.isNullOrUndefined(y[x])||(y[x].splice(V,1),m=!0);else delete y[I],m=!0;"row"==a?V=m?V:V+1:I+=1}while("row"==a?V<y[0].length:I<y.length)}var I=parseInt(n._drillParams.currPos.split(",")[0])+("row"==a?1:0),E="",A=0,R=0,V=parseInt(n._drillParams.currPos.split(",")[1])+1;if(n.model.enableCollapseByDefault)do{if("row"==a?I==parseInt(n._drillParams.currPos.split(",")[0])+1:V==parseInt(n._drillParams.currPos.split(",")[1])+1){for(x="row"==a?y[I].length-1:y.length-1;x>=0;x--)if(("column"!=a||!t.isNullOrUndefined(y[x]))&&(v="row"==a?y[I][x]:y[x][V]).CSS.indexOf("summary")>-1){v.State=2,v.Expander=1;var U=I,k=V,F=0;if("row"==a){do{F++,U++}while(!t.isNullOrUndefined(c[U])&&("none"==c[U][0].CSS||""==c[U][0].Value));v.ColSpan=F}else{do{F++,k++}while(!t.isNullOrUndefined(c[0][k])&&("none"==c[0][k].CSS||""==c[0][k].Value));v.RowSpan=F}v.Value=v.Value.replace(" Total","")}}else for(h="","column"==a&&(h=e.map(y,function(e,i){if(!t.isNullOrUndefined(e))return i})[0]),x="row"==a?y[I].length-1:y.length-1;x>=0;x--)"column"==a&&t.isNullOrUndefined(y[x])||(g=(v="row"==a?y[I][x]:y[x][V]).Value.replace(" Total",""),E=""==E&&""!=v.Value.replace(" Total","")?v.Value.replace(" Total",""):""!=v.Value.replace(" Total","")&&E!=v.Value.replace(" Total","")?v.Value.replace(" Total",""):E,""!=g&&g!=E||0==x||h==x?(v.CSS="row"==a?"rowheader":"colheader",v.State=1,v.Expander=1,v.Value=E,"row"==a?v.RowSpan=I>parseInt(n._drillParams.currPos.split(",")[0])-1?A:v.RowSpan:v.ColSpan=V>parseInt(n._drillParams.currPos.split(",")[1])-1?R:v.ColSpan,A=1,R=1):(v.CSS.indexOf("summary")>-1&&("row"==a?v.ColSpan=parseInt(n._drillParams.currPos.split(",")[0])+2-I:v.RowSpan=parseInt(n._drillParams.currPos.split(",")[1])+2-V),A++,R++));"row"==a?I--:V--}while("row"==a?I>=0:V>=0)}else{var z=t.Pivot._getEnginePos(o,d,c);I=z.colPos,V=z.rowPos;if("row"==a){for(f=0,e.each(c[0],function(e,t){if(parseInt(t.Index.split(",")[1])==parseInt(o.split(",")[1]))return f=e,!1}),x=parseInt(o.split(",")[1]);x<parseInt(d.split(",")[1]);x++)for(_=0;_<c.length;_++)if(!t.isNullOrUndefined(c[_])){for(b="",v="",k=f;k<c[_].length;k++)if(parseInt(c[_][k].Index.split(",")[1])==x){v=c[_][k],b=k,c[_].splice(k,1);break}t.isNullOrUndefined(c[_][b])||"none"!=c[_][b].CSS&&""!=c[_][b].Value&&("rowheader"!=c[_][b].CSS||0!=c[_][b].Expander)||"rowheader"!=v.CSS||(c[_][b].CSS="rowheader",c[_][b].Value=v.Value,c[_][b].State=v.State,c[_][b].Expander=v.Expander)}}else for(C=[],x=parseInt(o.split(",")[0]);x<parseInt(d.split(",")[0]);x++)if(C=0!=C.length||t.isNullOrUndefined(c[x])?C:c[x],delete c[x],parseInt(d.split(",")[0])-x==1){S=0;do{("none"==c[x+1][S].CSS||""==c[x+1][S].Value||"colheader"==c[x+1][S].CSS&&0==c[x+1][S].Expander)&&(c[x+1][S].CSS=C[S].CSS,c[x+1][S].Value=C[S].Value,c[x+1][S].State=C[S].State,c[x+1][S].Expander=C[S].Expander),S++}while(S<=parseInt(d.split(",")[1]))}if(0==(O="row"==a?e.map(c[parseInt(d.split(",")[0])+1],function(e){if("rowheader"==e.CSS||e.CSS.indexOf("summary")>-1)return e}).length:e.map(c,function(e){if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(e[V+1])&&("colheader"==e[V+1].CSS||e[V+1].CSS.indexOf("summary")>-1))return e}).length))if("row"==a){I=parseInt(d.split(",")[0])+1;do{delete c[I],I++}while(!t.isNullOrUndefined(c[I])&&("none"==c[I][0].CSS||""==c[I][0].Value))}else{V=parseInt(d.split(",")[1])+1;do{for(x=0;x<c.length;x++)t.isNullOrUndefined(c[x])||(c[x]=e.map(c[x],function(e){if(parseInt(e.Index.split(",")[1])!=V)return e}));V++}while(V<c[0][0].RowSpan-(i.values.length>0&&"rows"!=i.values[0].axis?1:0))}if(I=(z=t.Pivot._getEnginePos(o,d,c)).colPos,V=z.rowPos,"row"==a){for(x=0;x<c[parseInt(d.split(",")[0])].length;x++)if(c[parseInt(d.split(",")[0])][x].Index==d){c[parseInt(d.split(",")[0])][x].Value=c[parseInt(d.split(",")[0])][x].Value.replace(" Total",""),c[parseInt(d.split(",")[0])][x].State=2,c[parseInt(d.split(",")[0])][x].ColSpan=0==O?c[parseInt(d.split(",")[0])][x].ColSpan-1:c[parseInt(d.split(",")[0])][x].ColSpan;break}}else c[I][V].Value=c[I][V].Value.replace(" Total",""),c[I][V].State=2,c[I][V].RowSpan=0==O?c[I][V].RowSpan-1:c[I][V].RowSpan;y=t.Pivot._drillSpanCalculation(c,n)}return y},_getDrillRange:function(i,a,l,r,n){var s,o,d=0,u=0,c="",p="",m=r,h="row"==a?l._drillParams.currRow.split(">#>"):l._drillParams.currCol.split(">#>");do{if((s="row"==a?parseInt((d-1)/r):u)+1==h.length){if((!("none"!=n[d].CSS&&""!=n[d].Value||t.isNullOrUndefined(n["row"==a?d-r:d-1])||"string"!=typeof n["row"==a?d-r:d-1].Value||n["row"==a?d-r:d-1].Value.replace(" Total","")!=e.trim(h[s<1?0:s-1]))||"string"==typeof n[d].Value&&""!=n[d].Value&&n[d].Value.replace(" Total","")!=e.trim(h[s]))&&""!=c){for(o="row"==a?d-1:d-r;!t.isNullOrUndefined(n[o])&&"summary rstot"!=n[o].CSS&&"summary cstot"!=n[o].CSS&&"summary stot"!=n[o].CSS;)o="row"==a?o-1:o-r;t.isNullOrUndefined(n[o])||(p=n[o].Index);break}"string"==typeof n[d].Value&&n[d].Value.replace(" Total","")==e.trim(h[s])&&(c=""==c?n[d].Index:c)}else n[d].Value.replace(" Total","")==e.trim(h[s])&&(d="row"==a?m*(s+1)+(d-1):d-m+1);u=(d="row"==a?d+1:d+r)%r,"column"==a&&d>n.length&&(d=++u)}while(n.length>d&&""==p);return"drillup"==l._drillAction&&l.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&("column"==a&&i.values.length>0&&"row"!=i.values[0].axis?p=parseInt(p.split(",")[0])-(i.values.length-1)+","+p.split(",")[1]:"row"==a&&i.values.length>0&&"row"==i.values[0].axis&&(p=p.split(",")[0]+","+(parseInt(p.split(",")[1])-(i.values.length-1)))),{startPos:c,endPos:p}},_drillSpanCalculation:function(i,a){for(var l,r,n,s,o,d=a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(a.getOlapReport()).PivotCalculations:a.getOlapReport().values,u=a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(a.getOlapReport()).PivotColumns:a.getOlapReport().columns,c=a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(a.getOlapReport()).PivotRows:a.getOlapReport().rows,p=[],m=[],h=e.map(i,function(e){if(!t.isNullOrUndefined(e))return e[0]}).length,g=0;g<i[0].length;g++){for(y=0,l=0,o=0;o<i.length;o++)t.isNullOrUndefined(i[o])||t.isNullOrUndefined(i[o][g])||(y++,i[o][g].ColSpan>h-y+1&&(i[o][g].ColSpan=h-y+1),"none"!=i[o][g].CSS&&""!=i[o][g].Value&&l++);0==l&&p.push(g)}for(g=0;g<i.length;g++)t.isNullOrUndefined(i[g])||(r=e.map(i[g],function(e,t){if(-1==p.indexOf(t))return e.RowSpan>=i[g].length-t&&(e.RowSpan=i[g].length-t),"summary value"==e.CSS&&(e.RowSpan=1,e.ColSpan=1),e}),m[g]=r);i=m;var f=u.length+(d.length>0&&"rows"!=d[0].axis?d.length:0),_=c.length+(d.length>0&&"rows"==d[0].axis?d.length:0),b=-1;do{b++}while(!(t.isNullOrUndefined(i[0])||t.isNullOrUndefined(i[0][b])||"none"!=i[0][b].CSS&&""!=i[0][b].Value));i[0][0].RowSpan=b>f?f:b,b=d.length>0&&"rows"!=d[0].axis?b-1:b,n=-1,s=0;do{n++}while(!t.isNullOrUndefined(i[n])&&("none"==i[n][0].CSS||""==i[n][0].Value));for(i[0][0].ColSpan=n>_?_:n,g=0;g<i[0].length;g++)for(y=d.length>0&&"rows"==d[0].axis?1:0,o=0;o<i[0][0].ColSpan;o++)t.isNullOrUndefined(i[o][g])||(y++,(0!=g||0!=o)&&i[o][g].ColSpan>i[0][0].ColSpan-y+1&&i[0][0].ColSpan-y+1>0&&(i[o][g].ColSpan=i[0][0].ColSpan-y+1));for(g=i[0][0].ColSpan-1;g<i.length;g++)if(y=d.length>0&&"rows"!=d[0].axis?1:0,!t.isNullOrUndefined(i[g]))for(o=0;o<i[0][0].RowSpan;o++)y++,(0!=g||0!=o)&&i[g][o].RowSpan>i[0][0].RowSpan-y+1&&i[0][0].RowSpan-y+1>0&&(i[g][o].RowSpan=i[0][0].RowSpan-y+1);if(!t.isNullOrUndefined(c)&&c.length>1){n=d.length>0&&"rows"==d[0].axis?n-1:n;do{i[s]=e.map(i[s],function(e){return e.CSS.indexOf("summary")>-1&&(e.ColSpan=n-s),e});var v=0,C=!1,S="";for(g=i[s].length-1;g>=i[0][0].RowSpan;g--)"summary rstot"==i[s][g].CSS||"summary stot"==i[s][g].CSS?(t.isNullOrUndefined(i[s][g+1])||"rowheader"!=i[s][g+1].CSS||(i[s][g+1].RowSpan=v),v=0,C=!0,S=""):i[0][0].RowSpan-g==0?i[s][g].RowSpan=C||S==i[s][g].Value?v+1:i[s][g].RowSpan:(S=i[s][g].Value,v++);s++}while(n>s+(d.length>0&&"rows"==d[0].axis?1:0))}if(!t.isNullOrUndefined(u)&&u.length>1){s=0;do{for(g=0;g<i.length;g++)!t.isNullOrUndefined(i[g])&&i[g][s].CSS.indexOf("summary")>-1&&(i[g][s].RowSpan=b-s);var O=0,x=(C=!1,""),y=(S="",e.grep(i,function(e,i){if(!t.isNullOrUndefined(e)&&"none"!=e[0].CSS&&""!=e[0].Value)return x=""==x?i:x,e}).length);for(g=i.length-1;g>=x;g--)y-=t.isNullOrUndefined(i[g])||"none"==i[g][0].CSS||""==i[g][0].Value?0:1,t.isNullOrUndefined(i[g])||"summary cstot"!=i[g][s].CSS&&"summary stot"!=i[g][s].CSS?0!=y||t.isNullOrUndefined(i[g])?t.isNullOrUndefined(i[g])||(S=i[g][s].Value,O++):i[g][s].ColSpan=C||S==i[g][s].Value?O+1:i[g][s].ColSpan:(t.isNullOrUndefined(i[g+1])||t.isNullOrUndefined(i[g+1][s])||"rowheader"!=i[g+1][s].CSS&&"colheader"!=i[g+1][s].CSS||(i[g+1][s].ColSpan=O),O=0,C=!0,S="");s++}while(b>s+(d.length>0&&"rows"!=d[0].axis?1:0))}return i},_calculatePagingSpan:function(i,a){var l,r;if(null!=i&&""!=i&&i.length>0){for(a._rowCount=0,l=jQuery.extend(!0,[],i),a._compJson=""==a._drillAction?jQuery.extend(!0,[],l):a._compJson,a._croppedJson=t.Pivot._cropJson(a,l),l=e.extend(!0,[],a._croppedJson),r=0;r<l.length&&0==parseInt(l[r].Index.split(",")[0]);r++)a._rowCount++;var n=a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(a.getOlapReport()).PivotRows.length:a.getOlapReport().rows.length,s=a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(a.getOlapReport()).PivotColumns.length:a.getOlapReport().columns.length,o=a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(a.getOlapReport()).PivotCalculations.length:a.getOlapReport().values.length;l.length,a._rowCount;for(r=(0==l[0].RowSpan?0:l[0].RowSpan-1)+a.model.dataSource.pagerOptions.seriesPageSize;r<l.length&&r<a._rowCount;r+=a.model.dataSource.pagerOptions.seriesPageSize){if(l[r].CSS.indexOf("summary")>-1||l[r].CSS.indexOf("rowheader")>-1&&0==l[r].Expander&&null!=l[r+a._rowCount]&&l[r+a._rowCount].CSS.indexOf("value")>-1)continue;n>1&&t.Pivot._calculateRowPagingSpan(r,l,1,n,a)}for(r=((0==l[0].ColSpan?0:l[0].ColSpan-1)+a.model.dataSource.pagerOptions.categoricalPageSize)*a._rowCount;r<l.length;r+=a.model.dataSource.pagerOptions.categoricalPageSize*a._rowCount){if(l[r].CSS.indexOf("summary")>-1&&o<=1)continue;if(1==a.model.dataSource.pagerOptions.categoricalPageSize&&(l[r].CSS.indexOf("stot")>-1&&null!=l[r+a._rowCount]&&l[r+a._rowCount].CSS.indexOf("gtot")>-1||l[r].CSS.indexOf("gtot")>-1&&null==l[r+a._rowCount]))continue;t.Pivot._calculateColumnPagingSpan(r,l,1,s,o,a)}a._relPagingRecords=jQuery.extend(!0,[],l),a._rowCount=0}},_generatePagingRecords:function(i){var a,l,r,n,s;if(null!=i._relPagingRecords&&i._relPagingRecords.length>0){for(a=e.extend(!0,[],i._relPagingRecords),i._rowCount=0,h=0;h<a.length&&0==parseInt(a[h].Index.split(",")[0]);h++)i._rowCount++;var o=a.length/i._rowCount,d=0==a[0].RowSpan?0:a[0].RowSpan-1,u=0==a[0].ColSpan?0:a[0].ColSpan-1,c=Math.ceil((o-(u+1))/i.model.dataSource.pagerOptions.categoricalPageSize),p=Math.ceil((i._rowCount-(d+1))/i.model.dataSource.pagerOptions.seriesPageSize);i.model.dataSource.pagerOptions.categoricalCurrentPage=i.model.dataSource.pagerOptions.categoricalCurrentPage>c?c:i.model.dataSource.pagerOptions.categoricalCurrentPage,i.model.dataSource.pagerOptions.seriesCurrentPage=i.model.dataSource.pagerOptions.seriesCurrentPage>p?p:i.model.dataSource.pagerOptions.seriesCurrentPage,i._seriesPageCount=i.model.enablePaging?i._rowCount-(d+1):p,i._categPageCount=i.model.enablePaging?o-(u+1):c,i._categCurrentPage=i.model.dataSource.pagerOptions.categoricalCurrentPage,i._seriesCurrentPage=i.model.dataSource.pagerOptions.seriesCurrentPage;var m,h,g,f,_,b,v,C,S,O,x=[],y=d+1+i.model.dataSource.pagerOptions.seriesPageSize,P=u+1+i.model.dataSource.pagerOptions.categoricalPageSize;for(m=h=g=f=_=b=v=C=S=O=0,n=0;n<d+1;n++){for(s=0;s<u+1;s++)null!=a[h]&&(x[f]=a[h],h+=i._rowCount,f+=y);h=++m,f=++g}for(_=h=d+(0==i.model.dataSource.pagerOptions.seriesCurrentPage||1==i.model.dataSource.pagerOptions.seriesCurrentPage?0:(i.model.dataSource.pagerOptions.seriesCurrentPage-1)*i.model.dataSource.pagerOptions.seriesPageSize)+1,b=f=d+1,n=0;n<i.model.dataSource.pagerOptions.seriesPageSize;n++){for(s=0;s<u+1;s++)null!=a[h]&&(x[f]=a[h],h+=i._rowCount,f+=y);if(f=++b,(h=++_)>i._rowCount-1)break}for(v=h=(u+1)*i._rowCount+(0==i.model.dataSource.pagerOptions.categoricalCurrentPage||1==i.model.dataSource.pagerOptions.categoricalCurrentPage?0:(i.model.dataSource.pagerOptions.categoricalCurrentPage-1)*i.model.dataSource.pagerOptions.categoricalPageSize*i._rowCount),C=f=(u+1)*y,n=0;n<d+1;n++){for(s=0;s<i.model.dataSource.pagerOptions.categoricalPageSize;s++)null!=a[h]&&(x[f]=a[h],h+=i._rowCount,f+=y);if(f=++C,null==a[h=++v])break}for(S=h=(u+1)*i._rowCount+(0==i.model.dataSource.pagerOptions.categoricalCurrentPage||1==i.model.dataSource.pagerOptions.categoricalCurrentPage?0:(i.model.dataSource.pagerOptions.categoricalCurrentPage-1)*i.model.dataSource.pagerOptions.categoricalPageSize*i._rowCount)+d+(0==i.model.dataSource.pagerOptions.seriesCurrentPage||1==i.model.dataSource.pagerOptions.seriesCurrentPage?0:(i.model.dataSource.pagerOptions.seriesCurrentPage-1)*i.model.dataSource.pagerOptions.seriesPageSize)+1,O=f=(u+1)*y+d+1,l=0,n=0;n<i.model.dataSource.pagerOptions.seriesPageSize;n++){for(s=0;s<i.model.dataSource.pagerOptions.categoricalPageSize;s++)null!=a[h]&&(x[f]=a[h],l=parseInt(a[h].Index.split(",")[1]),h+=i._rowCount,f+=y);if(f=++O,null==a[h=++S]||l>parseInt(a[h].Index.split(",")[1]))break}for(i._rowCount=0,x=x.filter(function(e){return null!=e}),y=0,h=0;h<x.length&&0==parseInt(x[h].Index.split(",")[0]);h++)y++;for(P=x.length/y,n=0;n<P;n++)for(s=0;s<y;s++)t.isNullOrUndefined(x[n*y+s])||(x[n*y+s].Index=n+","+s);for(r=t.Pivot._drillSpanCalculation(t.Pivot._jsonToEngine(x),i),n=0;n<r.length;n++)for(s=0;s<r[n].length;s++)r[n][s].Index=n+","+s;return e.map(r,function(e){return e})}},_calculateRowPagingSpan:function(e,i,a,l,r){var n,s;if(i[e].CSS.indexOf("summary")>-1||i[e].CSS.indexOf("rowheader")>-1&&0==i[e].Expander&&a<l&&null!=i[e+r._rowCount]&&i[e+r._rowCount].CSS.indexOf("value")>-1)return!1;if(1==i[e].Expander&&i[e].RowSpan>1)i[e+1].RowSpan=i[e].RowSpan-1,i[e].RowSpan=1,i[e+1].Expander=i[e].Expander,i[e+1].State=i[e].State,i[e+1].Value=i[e].Value,i[e+1].CSS=i[e].CSS,-1==i[e+r._rowCount].CSS.indexOf("value")&&a<l-1&&t.Pivot._calculateRowPagingSpan(e+r._rowCount,i,a+1,l,r);else if(0==i[e].Expander&&null!=i[e+r._rowCount]&&a<l&&-1==i[e+r._rowCount].CSS.indexOf("value"))for(n=1,s=e-1;s>=0;s--)if(n++,1==i[s].Expander){i[s].RowSpan!=n&&(i[e+1].RowSpan=i[s].RowSpan-n,i[s].RowSpan=n,i[e+1].Expander=i[s].Expander,i[e+1].State=i[s].State,i[e+1].Value=i[s].Value,i[e+1].CSS=i[s].CSS,-1==i[e+r._rowCount].CSS.indexOf("value")&&a<l-1&&t.Pivot._calculateRowPagingSpan(e+r._rowCount,i,a+1,l,r));break}},_calculateColumnPagingSpan:function(e,i,a,l,r,n){var s,o;if(i[e].CSS.indexOf("summary")>-1&&r<=1)return!1;if(null!=i[e+n._rowCount]&&(1==i[e].Expander&&i[e].ColSpan>1||i[e].CSS.indexOf("summary")>-1&&i[e].ColSpan>1||a==l&&r>1&&i[e].ColSpan>1))i[e+n._rowCount].ColSpan=i[e].ColSpan-1,i[e].ColSpan=1,i[e+n._rowCount].Expander=i[e].Expander,i[e+n._rowCount].RowSpan=i[e].RowSpan,i[e+n._rowCount].State=i[e].State,i[e+n._rowCount].Value=i[e].Value,i[e+n._rowCount].CSS=i[e].CSS,a<l&&-1==i[e].CSS.indexOf("summary")&&t.Pivot._calculateColumnPagingSpan(e+1,i,a+1,l,r,n);else if(0==i[e].Expander&&null!=i[e+n._rowCount]&&1!=i[e+n._rowCount].Expander)for(s=1,o=e-n._rowCount;o>=0;o-=n._rowCount)if(s++,1==i[o].Expander||i[o].CSS.indexOf("summary")>-1&&i[o].ColSpan>1||a==l&&r>1&&i[o].ColSpan>1){i[o].ColSpan!=s&&(i[e+n._rowCount].ColSpan=i[o].ColSpan-s,i[o].ColSpan=s,i[e+n._rowCount].RowSpan=i[o].RowSpan,i[e+n._rowCount].Expander=i[o].Expander,i[e+n._rowCount].State=i[o].State,i[e+n._rowCount].Value=i[o].Value,i[e+n._rowCount].CSS=i[o].CSS,a<l&&-1==i[o].CSS.indexOf("summary")&&t.Pivot._calculateColumnPagingSpan(e+1,i,a+1,l,r,n));break}},createAdvanceFilterTag:function(i,a){var l,r,n,s,o,d,u,c,p,m,h="",g=(t.buildTag("li.e-separator").css("margin-left","29px")[0].outerHTML,a.element.hasClass("e-pivotschemadesigner")?a.model.pivotControl.model.operationalMode:a.model.operationalMode),f=a.element.hasClass("e-pivotschemadesigner")?a.model.pivotControl.model.analysisMode:a.model.analysisMode;if("filterTag"==i.action)h=[{id:"ascOrder",text:a._getLocalizedLabels("SortAtoZ"),parentId:null,spriteCssClass:"e-ascImage e-icon"},{id:"descOrder",text:a._getLocalizedLabels("SortZtoA"),parentId:null,spriteCssClass:"e-descImage e-icon"},{id:"clearSorting",text:a._getLocalizedLabels("ClearSorting"),parentId:null,spriteCssClass:"e-clrSort e-icon"},{id:"sep1",parentId:null,text:"",spriteCssClass:"e-seperator"},{id:"clearAllFilters",text:a._getLocalizedLabels("ClearFilterFrom"),parentId:null,spriteCssClass:"e-clrFilter e-icon"},{id:"labelFilterBtn",text:a._getLocalizedLabels("LabelFilters"),parentId:null},{id:"valueFilterBtn",text:a._getLocalizedLabels("ValueFilters"),parentId:null},{id:"labelClearFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("ClearFilter"),spriteCssClass:"e-clrFilter e-icon"},{id:"sep2",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"equals_labelFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("Equals"),spriteCssClass:"sprite"},{id:"notequals_labelFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("DoesNotEquals")+"...",spriteCssClass:"sprite"},{id:"sep3",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"beginswith",parentId:"labelFilterBtn",text:a._getLocalizedLabels("BeginsWith")+"...",spriteCssClass:"sprite"},{id:"notbeginswith",parentId:"labelFilterBtn",text:a._getLocalizedLabels("DoesNotBeginsWith")+"...",spriteCssClass:"sprite"},{id:"endswith",parentId:"labelFilterBtn",text:a._getLocalizedLabels("EndsWith")+"...",spriteCssClass:"sprite"},{id:"notendswith",parentId:"labelFilterBtn",text:a._getLocalizedLabels("DoesNotEndsWith")+"...",spriteCssClass:"sprite"},{id:"sep4",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"contains",parentId:"labelFilterBtn",text:a._getLocalizedLabels("Contains")+"...",spriteCssClass:"sprite"},{id:"notcontains",parentId:"labelFilterBtn",text:a._getLocalizedLabels("DoesNotContains")+"...",spriteCssClass:"sprite"},{id:"sep5",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"greaterthan_labelFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("GreaterThan")+"...",spriteCssClass:"sprite"},{id:"greaterthanorequalto_labelFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("GreaterThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"lessthan_labelFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("LessThan")+"...",spriteCssClass:"sprite"},{id:"lessthanorequalto_labelFilter",parentId:"labelFilterBtn",text:a._getLocalizedLabels("LessThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"valueClearFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("ClearFilter"),spriteCssClass:"e-clrFilter e-icon"},{id:"sep6",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"equals_valueFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("Equals"),spriteCssClass:"equals"},{id:"notequals_valueFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("DoesNotEquals")+"...",spriteCssClass:"sprite"},{id:"sep7",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"greaterthan_valueFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("GreaterThan")+"...",spriteCssClass:"sprite"},{id:"greaterthanorequalto_valueFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("GreaterThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"lessthan_valueFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("LessThan")+"...",spriteCssClass:"sprite"},{id:"lessthanorequalto_valueFilter",parentId:"valueFilterBtn",text:a._getLocalizedLabels("LessThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"sep8",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"between",parentId:"valueFilterBtn",text:a._getLocalizedLabels("Between")+"...",spriteCssClass:"sprite"},{id:"notbetween",parentId:"valueFilterBtn",text:a._getLocalizedLabels("NotBetween")+"...",spriteCssClass:"sprite"},{id:"topCount",parentId:"valueFilterBtn",text:a._getLocalizedLabels("Top10")+"...",spriteCssClass:"sprite"}],(g==t.Pivot.OperationalMode.ClientMode||g==t.Pivot.OperationalMode.ServerMode&&f==t.Pivot.AnalysisMode.Pivot)&&h.splice(h.length-1,2);else if("clearFilter"==i.action)h=t.buildTag("div.clearSorting",t.buildTag("span.e-clrSort","",{padding:"0px 10px 0px 4px"}).addClass("e-icon").attr("aria-label","clear sort")[0].outerHTML+t.buildTag("span.clearSortText","Clear Sorting",{padding:"5px 0px"})[0].outerHTML)[0].outerHTML+t.buildTag("div.separator",{padding:"5px 0px"})[0].outerHTML+t.buildTag("div.clearAllFilters",t.buildTag("span.e-clrFilter","",{padding:"0px 10px 0px 4px"}).addClass("e-icon").attr("aria-label"," clear filter")[0].outerHTML+t.buildTag("span.clearFltrText",'Clear Filter From"'+i.selectedLevel.text+'"',{padding:"5px 0px"})[0].outerHTML)[0].outerHTML;else if("sort"==i.action)h=t.buildTag("div#sortDiv.sortDiv",t.buildTag("li#ascOrder.e-ascOrder",t.buildTag("span.e-ascImage").addClass("e-icon").attr("aria-label","ascending")[0].outerHTML+a._getLocalizedLabels("Sort")+" A to Z")[0].outerHTML+t.buildTag("li#descOrder.e-descOrder",t.buildTag("span.e-descImage").addClass("e-icon").attr("aria-label","descending")[0].outerHTML+a._getLocalizedLabels("Sort")+" Z to A")[0].outerHTML)[0].outerHTML;else if("labelFilterDlg"==i.action||"valueFilterDlg"==i.action){if(l="",r=[],"labelFilterDlg"==i.action)l=t.buildTag("table.labelfilter",t.buildTag("tr",t.buildTag("td",a._getLocalizedLabels("LabelFilterLabel")).attr("colspan","2")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'  style='width:220px'/>")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1'  value='"+(i.filterInfo.length>0?g==t.Pivot.OperationalMode.ClientMode?i.filterInfo[0].values[0]:i.filterInfo[0].value1:"")+"' style='display:inline; width:160px; height:19px; margin-left:7px;' class='e-filterValues'/></br>")[0].outerHTML)[0].outerHTML)[0].outerHTML,r=[{value:"equals",option:a._getLocalizedLabels("Equals").toLowerCase()},{value:"not equals",option:a._getLocalizedLabels("DoesNotEquals").toLowerCase()},{value:"begins with",option:a._getLocalizedLabels("BeginsWith").toLowerCase()},{value:"not begins with",option:a._getLocalizedLabels("DoesNotBeginsWith").toLowerCase()},{value:"ends with",option:a._getLocalizedLabels("EndsWith").toLowerCase()},{value:"not ends with",option:a._getLocalizedLabels("DoesNotEndsWith").toLowerCase()},{value:"contains",option:a._getLocalizedLabels("Contains").toLowerCase()},{value:"not contains",option:a._getLocalizedLabels("DoesNotContains").toLowerCase()},{value:"greater than",option:a._getLocalizedLabels("IsGreaterThan").toLowerCase()},{value:"greater than or equal to",option:a._getLocalizedLabels("IsGreaterThanOrEqualTo").toLowerCase()},{value:"less than",option:a._getLocalizedLabels("IsLessThan").toLowerCase()},{value:"less than or equal to",option:a._getLocalizedLabels("IsLessThanOrEqualTo").toLowerCase()}];else{if(n=[],o="between"==e(i.selectedArgs.element).attr("id")||"notbetween"==e(i.selectedArgs.element).attr("id")||"between"==i.selectedArgs.value||"not between"==i.selectedArgs.value?"4":"3",a.element.find(".e-cubeTreeView ").length>0)n=e.map(a.element.find(".e-cubeTreeView [data-tag*='[Measures]'] "),function(t){return{option:e(t).text(),value:e(t).attr("data-tag")}});else for(d=a.element.hasClass("e-pivotschemadesigner")?a.element.find(".e-schemaValue .e-pivotButton"):a.element.find(".groupingBarPivot .values .e-pivotButton"),d=a._schemaData&&0==d.length?e(a._schemaData.element.find(".e-schemaValue .e-pivotButton")):d,u=0;u<d.length;u++)n.push({option:e(d[u]).text(),value:e(d[u]).attr("data-tag").split(":")[1]});s=e(i.selectedArgs.element).hasClass("topCount")?t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions' />").attr("width","80px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterValue1' class='e-filterValues' />").attr("width","50px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML:t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'/>").attr("width","180px")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1' value='"+(i.filterInfo.length>0?g==t.Pivot.OperationalMode.ClientMode?i.filterInfo[0].values[0]:i.filterInfo[0].value1:"")+"' style='display:inline; width:190px; height:19px;' class='e-filterValues'/>"+("4"==o?"<span>"+a._getLocalizedLabels("and")+" </span><input type='text' id='filterValue2' value='"+(i.filterInfo.length>0?g!=t.Pivot.OperationalMode.ClientMode||t.isNullOrUndefined(i.filterInfo[0].values[1])?g!=t.Pivot.OperationalMode.ServerMode||t.isNullOrUndefined(i.filterInfo[0].value2)?"":i.filterInfo[0].value2:i.filterInfo[0].values[1]:"")+"' style='display:inline; width:190px; height:19px;' class='e-filterValues'/> </br>":"</br>"))[0].outerHTML,l=t.buildTag("table.valuefilter",t.buildTag("tr",t.buildTag("td",a._getLocalizedLabels("ValueFilterLabel")).attr("colspan","Between"==i.text?"4":"3")[0].outerHTML)[0].outerHTML+t.buildTag("tr",s)[0].outerHTML)[0].outerHTML,r=[{value:"equals",option:a._getLocalizedLabels("Equals").toLowerCase()},{value:"not equals",option:a._getLocalizedLabels("DoesNotEquals").toLowerCase()},{value:"greater than",option:a._getLocalizedLabels("IsGreaterThan").toLowerCase()},{value:"greater than or equal to",option:a._getLocalizedLabels("IsGreaterThanOrEqualTo").toLowerCase()},{value:"less than",option:a._getLocalizedLabels("IsLessThan").toLowerCase()},{value:"less than or equal to",option:a._getLocalizedLabels("IsLessThanOrEqualTo").toLowerCase()},{value:"between",option:a._getLocalizedLabels("Between").toLowerCase()},{value:"not between",option:a._getLocalizedLabels("NotBetween").toLowerCase()}]}c=t.buildTag("div",t.buildTag("button#filterDlgOKBtn.e-dialogOKBtn",a._getLocalizedLabels("OK")).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML+t.buildTag("button#filterDlgCancelBtn.e-dialogCancelBtn",a._getLocalizedLabels("Cancel")).attr("title",a._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,{float:a.model.enableRTL?"left":"right",margin:"8px 0 6px"})[0].outerHTML,a.element.find(".e-dialog").remove(),e(t.buildTag("div#filterDialog.filterDialog",l+c,{opacity:"1"})).appendTo("#"+a._id),a.element.find(".filterDialog").ejDialog({enableRTL:a.model.enableRTL,enableResize:!1,cssClass:"e-labelValueFilterDlg",width:"auto",content:"#"+a._id,close:t.proxy(t.Pivot.closePreventPanel,a)}),"valueFilterDlg"==i.action&&(a.element.find(".filterMeasures").ejDropDownList({dataSource:n,width:"180px",height:"25px",fields:{text:"option",value:"value"},create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),a._measureDDL=a.element.find(".filterMeasures").data("ejDropDownList"),""!=(p=i.filterInfo.length>0&&!t.isNullOrUndefined(i.filterInfo[0].measure)?i.filterInfo[0].measure:n.length>0?n[0].value:"")&&a._measureDDL.selectItemByValue(p)),"topCount"==e(i.selectedArgs.element).attr("id")?(a.element.find("#filterOptions").ejDropDownList({dataSource:[{option:"Top",value:"topCount"},{option:"Bottom",value:"BottomCount"}],fields:{text:"option",value:"value"},value:i.filterInfo.length>0?i.filterInfo[0].operator:"topCount",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),a.element.find("#filterValue1").ejNumericTextbox({value:i.filterInfo.length>0?parseInt(i.filterInfo[0].value1):5,minValue:1})):(m=e(i.selectedArgs.element).parent().children('li:not([id^="sep"])').index(i.selectedArgs.element),a.element.find(".filterOptions").ejDropDownList({dataSource:r,width:"180px",height:"25px",fields:{value:"value",text:"option"},selectedIndices:[m-1],change:t.proxy(a._filterOptionChanged,a),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),0==e(i.selectedArgs.element).length&&a.element.find(".filterOptions").data("ejDropDownList").selectItemByValue(i.selectedArgs.selectedValue)),a.element.find("#filterDlgOKBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(a._filterElementOkBtnClick,a)}),a.element.find("#filterDlgCancelBtn").ejButton({type:t.ButtonType.Button,click:function(){e(".e-dialog").hide(),t.Pivot.closePreventPanel(a)}}),a.element.find(".e-titlebar").prepend(t.buildTag("div",("valueFilterDlg"==i.action?a._getLocalizedLabels("ValueFilters")+"(":a._getLocalizedLabels("LabelFilters")+"(")+(-1==a._selectedLevelUniqueName.indexOf(".")?a._selectedLevelUniqueName:a._selectedLevelUniqueName.indexOf(".")<0?a._selectedLevelUniqueName:a._selectedLevelUniqueName.split(".")[2].replace(/\[/g,"").replace(/\]/g,""))+")",{display:"inline"}))}return h}},t.Pivot.SortOrder={None:"none",Ascending:"ascending",Descending:"descending"},t.Pivot.AdvancedFilterType={LabelFilter:"label",ValueFilter:"value"},t.Pivot.ValueFilterOptions={None:"none",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.Pivot.LabelFilterOptions={None:"none",BeginsWith:"beginswith",NotBeginsWith:"notbeginswith",EndsWith:"endswith",NotEndsWith:"notendswith",Contains:"contains",NotContains:"notcontains",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.Pivot.AnalysisMode={Olap:"olap",Pivot:"pivot"},t.Pivot.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"}}(jQuery,Syncfusion)})},1011:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
*  filename: ej.pivotanalysis.base.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotanalysis.base.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e){__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=e)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(function(){!function($,ej,undefined){ej.PivotAnalysis={_initProperties:function(){this._colkeyvalues=[],this._rowKeyValues=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._gridMatrix=null,this._rowTotCalc=[],this._colTotCalc=[],this._transposeEngine=[],this._tRowCnt=0,this._tColCnt=0,this._cellType="",this._valueFilterArray=ej.isNullOrUndefined(this._valueFilterArray)?[]:this._valueFilterArray,this._currentFilterVal={},this._fieldMembers={},this._summaryTypes=[],this._editCellsInfo=[],this._locale="en-US",this._valueSorting=ej.isNullOrUndefined(this._valueSorting)?null:this._valueSorting,this._sort=ej.isNullOrUndefined(this._sort)?null:this._sort,this._isPaging=!1,this._colHdrLen=1,this._rowHdrLen=1,this._rowMembers={},this._colMembers={},this._calcMembers={}},setFieldCaptions:function(e){$.each(e.rows,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.columns,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.filters,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.values,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)})},getTreeViewData:function(e){var t,i,a,l,r,n,s=[],o=[];if(null!=e.data)for(a=0;a<e.data.length;a++)jQuery.each(e.data[a],function(e){-1==jQuery.inArray(e,s)&&s.push(e)});for(jQuery.each(e.values,function(e,t){1==t.isCalculatedField&&-1==jQuery.inArray(t.fieldName,s)&&s.push(t.fieldName)}),t=[e.rows,e.columns,e.filters,e.values],i=[].concat.apply([],t),a=0;a<s.length;a++){for(l=0;l<i.length;l++)(s[a].caption==undefined||""==s[a].caption)&&i[l].fieldName==s[a]&&(s[a]={name:i[l].fieldName,caption:i[l].fieldCaption,format:i[l].format,formatString:i[l].formatString,showSubTotal:!!ej.isNullOrUndefined(i[l].showSubTotal)||i[l].showSubTotal});(s[a].caption==undefined||""==s[a].caption)&&(s[a]={name:s[a].name||s[a],caption:s[a].name||s[a]})}for(r=0;r<s.length;r++)n=$.grep(e.rows,function(e){return e.fieldName==s[r].name}).length>0||$.grep(e.columns,function(e){return e.fieldName==s[r].name}).length>0||$.grep(e.values,function(e){return e.fieldName==s[r].name}).length>0||$.grep(e.filters,function(e){return e.fieldName==s[r].name}).length>0,o.push({id:s[r].name,name:s[r].name,caption:s[r].caption,format:s[r].format,formatString:s[r].formatString,showSubTotal:!!ej.isNullOrUndefined(s[r].showSubTotal)||s[r].showSubTotal,isSelected:n,spriteCssClass:""});return o},pivotEnginePopulate:function(model){var dataSource=model.dataSource,currentObj=this,isLiteral=!1,rowFilters,lit,formatSt,uV,fields,vC,list,cnt,nC,outputString,rC,cC,isFiltered,cCnt,rCnt,temp,value,val,j,k,formula,oldValue,newValue,i;this._initProperties(),model.dataSource.enableAdvancedFilter&&0==this._valueFilterArray.length&&(this._valueFilterArray=$.grep(dataSource.columns,function(e){if(e.advancedFilter&&e.advancedFilter.length>0&&e.advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter)return e.advancedFilter}),rowFilters=$.grep(dataSource.rows,function(e){if(e.advancedFilter&&e.advancedFilter.length>0&&e.advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter)return e.advancedFilter}),rowFilters.length>0&&$.merge(this._valueFilterArray,rowFilters)),this._locale=model.locale;var colAxis=dataSource.columns,rowAxis=dataSource.rows,filters=dataSource.filters,calcValues=dataSource.values,colLen,jsonObj=[],pivotFieldList=[],rowLen;for(lit=0;dataSource.values.length>lit;lit++)if(formatSt="",dataSource.values[lit].format&&(formatSt=dataSource.values[lit].format.toLowerCase()),"string"==formatSt||"text"==formatSt||"literal"==formatSt){isLiteral=!0;break}if(this._editCellsInfo=[],!ej.isNullOrUndefined(model.editCellsInfo)){var rowHeaders=model.editCellsInfo.rowHeader,colHeaders=model.editCellsInfo.columnHeader,values=model.editCellsInfo.JSONRecords;if(!ej.isNullOrUndefined(values)){for(uV=0;uV<values.length;uV++)fields={},rowAxis.length>0&&(fields.row=rowHeaders[uV].toString().split("#").splice(0,rowAxis.length).join(">#>")),colAxis.length>0&&(fields.column=colHeaders[uV].toString().split("#").splice(0,colAxis.length).join(">#>")),fields.value=colHeaders[uV].toString().split("#")[colHeaders[uV].toString().split("#").length-1]+"#"+values[uV].Value,this._editCellsInfo.push(fields);for(vC=0;vC<calcValues.length;vC++)$.each(this._editCellsInfo,function(e,t){calcValues[vC].fieldName==t.value.split("#")[0]&&(ej.PivotAnalysis._editCellsInfo[e].value=vC+"#"+t.value.split("#")[1])})}}for(i=0;i<calcValues.length;i++)this._summaryTypes.push(null!=calcValues[i].summaryType&&calcValues[i].summaryType!=undefined?calcValues[i].summaryType:ej.PivotAnalysis.SummaryType.Sum);if(null!=dataSource.data)for(cnt=0;cnt<dataSource.data.length;cnt++){list=jQuery.extend(!0,{},dataSource.data[cnt]);var table={keys:[],uniqueName:"",value:null},row={keys:[],uniqueName:"",value:null},col={keys:[],uniqueName:"",value:null},values={keys:[],uniqueName:"",value:null},isExcluded=!1;for(i=0;i<filters.length;i++)if(val=this._getReflectedValue(list,filters[i].fieldName,null,null),this._fieldMembers[filters[i].fieldName]==undefined||null==this._fieldMembers[filters[i].fieldName]?this._fieldMembers[filters[i].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[filters[i].fieldName])&&this._fieldMembers[filters[i].fieldName].push(val),null!=filters[i].filterItems&&filters[i].filterItems!=undefined&&((filters[i].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==filters[i].filterItems.filterType)&&$.inArray(val,filters[i].filterItems.values)>=0||filters[i].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,filters[i].filterItems.values)<0)){isExcluded=!0;break}for(nC=0;nC<calcValues.length;nC++)val="",calcValues[nC]!=undefined&&null!=calcValues[nC]&&(list[calcValues[nC].fieldName]=model.dataSource.isFormattedValues?this._getNumber($(list).prop(calcValues[nC].fieldName),calcValues[nC].formatString):list[calcValues[nC].fieldName],val=this._getReflectedValue(list,calcValues[nC].fieldName,calcValues[nC].format,calcValues[nC].formatString),this._fieldMembers[calcValues[nC].fieldName]==undefined||null==this._fieldMembers[calcValues[nC].fieldName]?this._fieldMembers[calcValues[nC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[calcValues[nC].fieldName])&&this._fieldMembers[calcValues[nC].fieldName].push(val)),outputString=null!=val?val.toString().replace(/([AMPME~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,-.\/? ])+/g,""):"0",outputString=outputString.replace(ej.globalize.preferredCulture(this._locale).numberFormat.currency.symbol,""),$.isNumeric(outputString)||"date"==calcValues[nC].format?values.keys.push(null!=val?val:null):(values.keys.push(1),isLiteral&&(""==values.uniqueName&&(values.uniqueName=[]),ej.isNullOrUndefined(calcValues[nC].format)||"string"!=calcValues[nC].format.toLowerCase()&&"literal"!=calcValues[nC].format.toLowerCase()&&"text"!=calcValues[nC].format.toLowerCase()?values.uniqueName.push(" "):values.uniqueName.push(val)));for(rC=0;rC<rowAxis.length;rC++){if(val="",rowAxis[rC]!=undefined&&null!=rowAxis[rC])if(val=this._getReflectedValue(list,rowAxis[rC].fieldName,ej.isNullOrUndefined(rowAxis[rC].format)?null:rowAxis[rC].format,ej.isNullOrUndefined(rowAxis[rC].format)||ej.isNullOrUndefined(rowAxis[rC].formatString)?null:rowAxis[rC].formatString),this._fieldMembers[rowAxis[rC].fieldName]==undefined||null==this._fieldMembers[rowAxis[rC].fieldName]?this._fieldMembers[rowAxis[rC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[rowAxis[rC].fieldName])&&this._fieldMembers[rowAxis[rC].fieldName].push(val),dataSource.enableAdvancedFilter&&!ej.isNullOrUndefined(rowAxis[rC].advancedFilter)&&rowAxis[rC].advancedFilter.length&&rowAxis[rC].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.LabelFilter){if(isFiltered=this._applyLabelFilter(rowAxis[rC].advancedFilter,val),isFiltered){isExcluded=!0;break}}else if(null!=rowAxis[rC].filterItems&&rowAxis[rC].filterItems!=undefined&&((rowAxis[rC].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==rowAxis[rC].filterItems.filterType)&&$.inArray(val,rowAxis[rC].filterItems.values)>=0||rowAxis[rC].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,rowAxis[rC].filterItems.values)<0)){isExcluded=!0;break}null!=val&&val.toString().replace(/^\s+|\s+$/gm,"")||(val="(blank)"),row.keys.push(val),row.uniqueName+=""==row.uniqueName?val:">#>"+val,table.keys.push(val),table.uniqueName+=""==table.uniqueName?val:">#>"+val}for(cC=0;cC<colAxis.length;cC++){if(val="",colAxis[cC]!=undefined&&null!=colAxis[cC])if(val=this._getReflectedValue(list,colAxis[cC].fieldName,ej.isNullOrUndefined(colAxis[cC].format)?null:colAxis[cC].format,ej.isNullOrUndefined(colAxis[cC].format)||ej.isNullOrUndefined(colAxis[cC].formatString)?null:colAxis[cC].formatString),this._fieldMembers[colAxis[cC].fieldName]==undefined||null==this._fieldMembers[colAxis[cC].fieldName]?this._fieldMembers[colAxis[cC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[colAxis[cC].fieldName])&&this._fieldMembers[colAxis[cC].fieldName].push(val),dataSource.enableAdvancedFilter&&!ej.isNullOrUndefined(colAxis[cC].advancedFilter)&&colAxis[cC].advancedFilter.length&&colAxis[cC].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.LabelFilter){if(isFiltered=this._applyLabelFilter(colAxis[cC].advancedFilter,val),isFiltered){isExcluded=!0;break}}else if(null!=colAxis[cC].filterItems&&colAxis[cC].filterItems!=undefined&&((colAxis[cC].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==colAxis[cC].filterItems.filterType)&&$.inArray(val,colAxis[cC].filterItems.values)>=0||colAxis[cC].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,colAxis[cC].filterItems.values)<0)){isExcluded=!0;break}null!=val&&val.toString().replace(/^\s+|\s+$/gm,"")||(val="(blank)"),col.keys.push(val),col.uniqueName+=""==col.uniqueName?val:">#>"+val,table.keys.push(val),table.uniqueName+=""==table.uniqueName?val:">#>"+val}if(!isExcluded)if(this._isMemberExist("row",row,$.extend(!0,{},values),dataSource),this._isMemberExist("column",col,$.extend(!0,{},values),dataSource),!model.enablePaging&&!model.enableVirtualScrolling||0==row.keys.length&&0==col.keys.length)this._isMemberExist("calc",table,$.extend(!0,{},values),dataSource);else if(row.keys.length>0&&col.keys.length>0)for(rCnt=0;rCnt<row.keys.length;rCnt++)for(cCnt=0;cCnt<col.keys.length;cCnt++)row.keys.length==rCnt+1&&col.keys.length==cCnt+1?this._isMemberExist("calc",{keys:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)),uniqueName:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)),uniqueName:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)).join(">#>"),value:null},$.extend(!0,{},values),dataSource);else if(0==row.keys.length)for(cCnt=0;cCnt<col.keys.length;cCnt++)col.keys.length==cCnt+1?this._isMemberExist("calc",{keys:col.keys.slice(0,cCnt+1),uniqueName:col.keys.slice(0,cCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:col.keys.slice(0,cCnt+1),uniqueName:col.keys.slice(0,cCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource);else for(rCnt=0;rCnt<row.keys.length;rCnt++)row.keys.length==rCnt+1?this._isMemberExist("calc",{keys:row.keys.slice(0,rCnt+1),uniqueName:row.keys.slice(0,rCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:row.keys.slice(0,rCnt+1),uniqueName:row.keys.slice(0,rCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource)}for(i=0;i<calcValues.length;i++)if(temp=$.grep(calcValues,function(e){return 1==e.isCalculatedField}),calcValues[i].isCalculatedField&&temp.length!=calcValues.length)for(j=0;j<this._tableKeysCalcValues.length;j++){for(formula=calcValues[i].formula.replace(/\s/g,""),k=0;k<calcValues.length;k++)1!=calcValues[k].isCalculatedField&&(value=ej.globalize.parseFloat(null==this._tableKeysCalcValues[j].value.keys[k]?"0":"date"==calcValues[k].format?this._dateToInt(this._tableKeysCalcValues[j].value.keys[k].toString()).toString():"time"==calcValues[k].format?this._dateToInt(new Date("1900",this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[0],this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[1],this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[2].split(" ")[0]).toString()).toString():this._tableKeysCalcValues[j].value.keys[k].toString(),this._locale),formula=formula.replace(new RegExp(calcValues[k].fieldName,"g"),"percentage"==calcValues[k].format&&0!=value?value<0?"("+value/100+")":value:value<0?"("+value+")":value));formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",calcValues[i].format,calcValues[i].formatString):null==dataSource.values[i].format?0:"0",newValue=null==dataSource.values[i].format?0:"0",this._tableKeysCalcValues[j].value.keys[i]=this._getSummaryValue(oldValue,newValue,1,this._summaryTypes[i],dataSource.values[i].format,dataSource.values[i].formatString)}else if(calcValues[i].isCalculatedField)for(val={keys:[],uniqueName:"",value:null},j=0;j<this._tableKeysCalcValues.length;j++){for(k=0;k<calcValues.length&&calcValues[k].isCalculatedField;k++)formula=calcValues[k].formula.replace(/\s/g,""),formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",calcValues[k].format,calcValues[k].formatString):null==dataSource.values[k].format?0:"0",newValue=null==dataSource.values[k].format?0:"0",val.keys.push(this._getSummaryValue(oldValue,newValue,1,"sum",dataSource.values[k].format,dataSource.values[k].formatString));this._tableKeysCalcValues[j].value=val,val={keys:[],uniqueName:"",value:null}}if(rowAxis.length>0&&(this._rowKeysCalcValues=this._sortHeaders(this._rowKeysCalcValues,rowAxis,0)),colAxis.length>0&&(this._colKeysCalcValues=this._sortHeaders(this._colKeysCalcValues,colAxis,0)),this._colkeyvalues=$.extend([],this._colKeysCalcValues),this._rowKeyValues=$.extend([],this._rowKeysCalcValues),colAxis.length>0&&this._insertTotalHeader(colAxis,this._colKeysCalcValues),rowAxis.length>0)this._insertTotalHeader(rowAxis,this._rowKeysCalcValues);else if(calcValues.length>0)if(this._rowKeysCalcValues.length>0)this._rowKeysCalcValues[0].keys[0]="Grand Total";else{for(this._rowKeysCalcValues.push({keys:[""],value:{keys:[]}}),i=0;i<calcValues.length;i++)this._rowKeysCalcValues[0].value.keys.push();this._rowKeysCalcValues[0].keys[0]="Grand Total"}return this._fillEngine(model)},_fillEngine:function(e){var t,i,a,l,r,n,s,o,d;(e.enablePaging||e.enableVirtualScrolling)&&(this._isPaging=!0,this._colHdrLen=1,this._rowHdrLen=1,this._controlObj._colKeysCalcValues=$.extend(!0,[],this._colKeysCalcValues),this._controlObj._rowKeysCalcValues=$.extend(!0,[],this._rowKeysCalcValues),this._controlObj._tableKeysCalcValues=$.extend(!0,[],this._tableKeysCalcValues),this._cropHeaders(),this._applyPaging());var u=e.dataSource,c=[],p=u.columns,m=u.rows,h=(u.filters,u.values);for(this._tRowCnt=0,this._tColCnt=0,this._currentFilterVal=this._valueFilterArray.length>0?this._valueFilterArray[0]:{},this._calculateValues(u),a=0;a<this._valueFilterArray.length;a++)this._advancedFilterInfo.length>0&&(this,this._rowKeysCalcValues=this._filterKeyValues(this._rowKeyValues),this._colKeysCalcValues=this._filterKeyValues(this._colkeyvalues),this._gridMatrix=null,this._colkeyvalues=$.extend([],this._colKeysCalcValues),this._rowKeyValues=$.extend([],this._rowKeysCalcValues),p.length>0&&this._insertTotalHeader(p,this._colKeysCalcValues),m.length>0?this._insertTotalHeader(m,this._rowKeysCalcValues):h.length>0&&(this._rowKeysCalcValues[0].keys[0]="Grand Total"),this._tRowCnt=0,this._tColCnt=0,this._currentFilterVal=this._valueFilterArray.length!=a+1?this._valueFilterArray[a+1]:{},this._calculateValues(u));if(t=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType,this._colTotCalc=[],this._rowTotCalc=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._transposeEngineCreation(),!ej.isNullOrUndefined(e.valueSortSettings)&&!ej.isNullOrUndefined(e.valueSortSettings.sortOrder)&&"none"!=e.valueSortSettings.sortOrder&&e.dataSource.values.length>0&&(!ej.isNullOrUndefined(this._valueSorting)||!ej.isNullOrUndefined(e.valueSortSettings.headerText)&&""!=e.valueSortSettings.headerText))if(i=0,e.valueSortSettings.headerDelimiters=e.valueSortSettings.headerDelimiters==undefined?"##":e.valueSortSettings.headerDelimiters,ej.isNullOrUndefined(this._valueSorting)){for(a=0;a<this._transposeEngine.length;a++){for(l=0;l<e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length;l++)ej.isNullOrUndefined(this._transposeEngine[a][l])||this._transposeEngine[a][l].Value!=e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters)[l]||i++;if(i==e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length){this._valueSorting=a;break}i=0}this._sort=ej.isNullOrUndefined(e.valueSortSettings)||ej.isNullOrUndefined(e.valueSortSettings.sortOrder)?this._sort:e.valueSortSettings.sortOrder,e.dataSource.columns.length+1!=e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length||ej.isNullOrUndefined(this._valueSorting)||this._applyValueSorting(e)}else this._applyValueSorting(e);for(r=0;r<this._tColCnt-1;r++){if(r<(n=0==m.length?1:this._isPaging?this._rowHdrLen:m.length))for(0==(s=(t?1:this._isPaging?this._colHdrLen:p.length)+(u.values.length>0?1:0))&&n>0&&(s=1),o=0;o<s;o++)this._gridMatrix.length>0&&c.push({Index:r+","+o,CSS:"none",Value:"",State:0,ColSpan:0==r&&0==o?n:1,RowSpan:0==r&&0==o?(t?1:this._isPaging?this._colHdrLen:p.length)+(u.values.length>0?1:0):1,Info:"",Span:"None",Expander:0});for(d=0;d<this._tRowCnt-1;d++)this._transposeEngine[r]==undefined||this._transposeEngine[r][d]==undefined||d<(t?1:this._isPaging?this._colHdrLen:p.length)+(u.values.length>0?1:0)&&r<n||c.push(this._transposeEngine[r][d])}return this._gridMatrix=[],u.rows[0]==undefined&&(u.rows.length=0),{json:c,pivotEngine:this._transposeEngine}},_cropHeaders:function(){var e,t,i,a,l=this._controlObj._drillHeaders.row,r=this._controlObj._drillHeaders.column,n=[],s=2,o=this._controlObj.model.enableCollapseByDefault,d=this._controlObj.model.dataSource.rows.length,u=this._controlObj.model.dataSource.columns.length;do{if(t=2==s?$.extend(!0,[],this._rowKeysCalcValues):$.extend(!0,[],this._colKeysCalcValues),o||(2==s?l.length>0:r.length>0)){for(i=0,e="",a=t.length-1;a>=0;a--)if(!ej.isNullOrUndefined(t[a])){ej.isNullOrUndefined(t[a].cellType)||ej.isNullOrUndefined(t[a].uniqueName)||(-1==t[a].uniqueName.indexOf(">#>")?t[a].uniqueName==e:-1!=t[a].uniqueName.indexOf(e))||(e="",i=t[a].level),o&&0==t[a].level&&""==e&&(i=0),(o?t[a].level!=i:""!=e)||ej.isNullOrUndefined(t[a].cellType)||ej.isNullOrUndefined(t[a].uniqueName)||!(2==s?l.indexOf(t[a].uniqueName)>-1:r.indexOf(t[a].uniqueName)>-1)||(e=t[a].uniqueName,i++);var c=e==t[a].uniqueName,p="RGTot"==t[a].cellType,m=t[a].level==i;(o?c||p||m||(2==s?i>d-2:i>u-2):""==e||ej.isNullOrUndefined(t[a].uniqueName)||c)&&((o?m:c)&&!ej.isNullOrUndefined(t[a].keys)&&t[a].keys.length>0&&!p&&""!=t[a].uniqueName&&(t[a].keys[t[a].keys.length-1]=t[a].keys[t[a].keys.length-1].replace(" Total","").replace("%####%",""),t[a].expander=2),n.push(t[a]))}2==s?this._rowKeysCalcValues=$.extend(!0,[],n.reverse()):this._colKeysCalcValues=$.extend(!0,[],n.reverse())}n=[],s--}while(s>0)},_applyPaging:function(){var e,t=[];this._controlObj._seriesPageCount=this._controlObj.model.enablePaging?this._rowKeysCalcValues.length:Math.ceil(this._rowKeysCalcValues.length/this._controlObj.model.dataSource.pagerOptions.seriesPageSize),this._controlObj._categPageCount=this._controlObj.model.enablePaging?this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1):Math.ceil(this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)/this._controlObj.model.dataSource.pagerOptions.categoricalPageSize),this._controlObj._categPageCount=0==this._controlObj._categPageCount?1:this._controlObj._categPageCount,this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage*this._controlObj.model.dataSource.pagerOptions.seriesPageSize>this._rowKeysCalcValues.length?Math.ceil(this._rowKeysCalcValues.length/this._controlObj.model.dataSource.pagerOptions.seriesPageSize):this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage,this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage=this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize>this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)?Math.ceil(this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)/this._controlObj.model.dataSource.pagerOptions.categoricalPageSize):this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage,this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage=0==this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage?1:this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage,this._controlObj._seriesCurrentPage=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage,this._controlObj._categCurrentPage=this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage;var i=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage*this._controlObj.model.dataSource.pagerOptions.seriesPageSize-this._controlObj.model.dataSource.pagerOptions.seriesPageSize,a=Math.ceil((this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize-this._controlObj.model.dataSource.pagerOptions.categoricalPageSize)/(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)),l=i+this._controlObj.model.dataSource.pagerOptions.seriesPageSize,r=Math.ceil(this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize/(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1));a=(this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage-1)*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize%this._controlObj.model.dataSource.values.length>0?a-1:a;for(e=i;e<l;e++)t.push(this._rowKeysCalcValues[e]);for(t=this._spanCalculation(t),this._rowKeysCalcValues=$.extend(!0,[],t),t=[],e=a;e<r;e++)t.push(this._colKeysCalcValues[e]);t=this._spanCalculation(t),this._colKeysCalcValues=$.extend(!0,[],t)},_spanCalculation:function(e){for(var t,i,a,l,r=0;r<e.length;r++)if(e.length>0&&!ej.isNullOrUndefined(e[r])&&!ej.isNullOrUndefined(e[r].uniqueName)){for(t=e[r].uniqueName.split(">#>"),[],e[r].keys[e[r].level]=e[r].keys[0],e[r].span=ej.isNullOrUndefined(e[r].span)?[]:e[r].span,i=ej.isNullOrUndefined(e[r].level)?e[r].span.length>0?e[r].span.length-2:e[r].keys.length-2:e[r].level-1;i>=0;i--){a=r+1,e[r].keys[i]=t[i],e[r].span[i]=1;do{if(!(!ej.isNullOrUndefined(e[a])&&e[a].uniqueName.split(">#>").indexOf(t[i])>-1&&e[a].uniqueName.split(">#>").indexOf(t[i])<e[a].uniqueName.split(">#>").length-1))break;e[r].span[i]++,a++}while(a<e.length)}ej.isNullOrUndefined(e[r].span)||0!=e[r].span.length||delete e[r].span}return l=e.length,$.map(e,function(e,t){if(!ej.isNullOrUndefined(e)&&!ej.isNullOrUndefined(e.span))for(var i=0;i<e.span.length;i++)e.span[i]=e.span[i]>l-t?l-t:e.span[i];return e})},_applyValueSorting:function(e){for(var t,i,a,l,r,n,s,o,d,u,c=[],p=[],m=0,h=0,g="",f=0;f<this._transposeEngine.length;f++)for(c[m]=[],ej.isNullOrUndefined(p[h])&&(p[h]=[]),u=0;u<this._transposeEngine[f].length&&this._valueSorting==Number(this._transposeEngine[f][u].Index.split(",")[0]);u++)("colheader"==this._transposeEngine[f][u].CSS||"calc"==$.trim(this._transposeEngine[f][u].CSS)||"colheader calc"==this._transposeEngine[f][u].CSS||"summary cstot"==this._transposeEngine[f][u].CSS||"summary cstot calc"==this._transposeEngine[f][u].CSS||"summary cgtot"==this._transposeEngine[f][u].CSS||"summary cgtot calc"==this._transposeEngine[f][u].CSS)&&(g=""==g?this._transposeEngine[f][u].Value:g+e.valueSortSettings.headerDelimiters+this._transposeEngine[f][u].Value),"value"==this._transposeEngine[e.dataSource.rows.length][u].CSS&&(c[m].push(this._transposeEngine[f][u]),h=0),"summary value"==this._transposeEngine[e.dataSource.rows.length][u].CSS&&(p[h].push(this._transposeEngine[f][u]),c[m].length>0&&(c[m+=1]=[]),"summary rgtot"!=this._transposeEngine[0][u].CSS&&p[h].length>0&&h++,ej.isNullOrUndefined(p[h])&&(p[h]=[]));for(e.valueSortSettings.headerText=g,e.valueSortSettings.sortOrder=this._sort,m=0;m<c.length;m++)for(f=0;f<c[m].length;f++)for(u=f;u<c[m].length;u++)("descending"==this._sort?this._getNumber(c[m][f].Value)<this._getNumber(c[m][u].Value):this._getNumber(c[m][f].Value)>this._getNumber(c[m][u].Value))&&(a=c[m][u],c[m][u]=c[m][f],c[m][f]=a);for(m=0;m<c.length;m++)0==c[m].length&&c.splice(m,1);for(t=[],f=0;f<this._tRowCnt-1;f++)t[f]={index:0,level:-1};var _=0,b=[],v=[];for(m=p.length-2;m>=0;m--){for(i=0,u=0;u<p[m].length;u++)for(f=u;f<p[m].length;f++)("descending"==this._sort?this._getNumber(p[m][u].Value)<this._getNumber(p[m][f].Value):this._getNumber(p[m][u].Value)>this._getNumber(p[m][f].Value))&&(a=p[m][f],p[m][f]=p[m][u],p[m][u]=a);if(0==_)for(u=0;u<p[m].length;u++)t[i=0==i?this._transposeEngine[_][Number(p[m][u].Index.split(",")[1])].MCnt+e.dataSource.columns.length+1:this._transposeEngine[_][Number(p[m][u].Index.split(",")[1])].MCnt+i+1]={index:Number(p[m][u].Index.split(",")[1]),level:_},b[u]==undefined&&(b[u]={}),b[u].end=Number(p[m][u].Index.split(",")[1]),b[u].start=Number(p[m][u].Index.split(",")[1])-this._transposeEngine[_][Number(p[m][u].Index.split(",")[1])].MCnt;else{for(l=[],r=0,o=0;o<b.length;o++){for(l=[],u=0;u<p[m].length;u++)Number(p[m][u].Index.split(",")[1])>b[o].start&&Number(p[m][u].Index.split(",")[1])<b[o].end&&l.push(p[m][u]);for(u=0;u<l.length;u++)t[i=0==i?this._transposeEngine[_][Number(l[u].Index.split(",")[1])].MCnt+e.dataSource.columns.length+1:this._transposeEngine[_][Number(l[u].Index.split(",")[1])].MCnt+i+1]={index:Number(l[u].Index.split(",")[1]),level:_},v[r]==undefined&&(v[r]={}),v[r].end=Number(l[u].Index.split(",")[1]),v[r].start=Number(l[u].Index.split(",")[1])-this._transposeEngine[_][Number(l[u].Index.split(",")[1])].MCnt,r++;for(;i<this._tRowCnt-2&&t[i].level>t[i+1].level;)i++;i--}b=jQuery.extend(!0,[],v)}_++}if(1==p.length&&p[0].length>0)for(n=e.dataSource.columns.length+1,f=0;f<c[0].length;f++)t[n]={index:Number(c[0][f].Index.split(",")[1])},n++;for(s=e.dataSource.columns.length+1,o=0;o<b.length;o++)for(m=0;m<c.length;m++)if(Number(c[m][0].Index.split(",")[1])>=b[o].start&&Number(c[m][0].Index.split(",")[1])<=b[o].end){for(u=0,f=b[o].start;f<b[o].end;f++)t[s]={index:Number(c[m][u].Index.split(",")[1])},u++,s++;for(s++;0!=t[s].index&&s<=t.length;)s++}for(d=[],f=0;f<e.dataSource.columns.length+1;f++)t[f]={index:f};for(f=0;f<t.length-1;f++)d.push(this._gridMatrix[t[f].index]);for(d.push(this._gridMatrix[f]),f=0;f<this._gridMatrix.length&&this._gridMatrix[f]!=undefined&&d[f]!=undefined;f++)for(u=0;u<this._gridMatrix[f].length&&this._gridMatrix[f][u]!=undefined;u++)this._gridMatrix[f][u]!=undefined&&d[f][u]!=undefined&&(d[f][u].Index=this._gridMatrix[f][u].Index);for(u=0;u<e.dataSource.rows.length-1;u++){var C=e.dataSource.columns.length+1,S=0,O=(m=0,!1);for(f=e.dataSource.columns.length+(e.dataSource.values.length>0?1:0);f<d.length;f++)if(d[f]!=undefined&&d[f][u]!=undefined&&"rowheader"==d[f][u].CSS&&d[f][u].RowSpan!=undefined&&(O=!0,S=S>d[f][u].RowSpan?S:d[f][u].RowSpan),d[f]!=undefined&&d[f][u]!=undefined&&"summary rstot"==d[f][u].CSS&&O&&!ej.isNullOrUndefined(d[C])){for(O=!1;d[C]==undefined||d[C][u]==undefined;)C++;d[C][u].RowSpan=S,S=0,0,C=f+1,m++}}this._gridMatrix=d,this._transposeEngineCreation()},_transposeEngineCreation:function(){var e,t,i;for(this._tColCnt=this._isPaging&&this._gridMatrix.length>0?!ej.isNullOrUndefined(this._gridMatrix[0])&&this._gridMatrix[0].length>0?this._gridMatrix[0].length+1:this._gridMatrix[this._gridMatrix.length-1].length+1:this._tColCnt,e=0;e<this._tRowCnt-1;e++)for(t=0;t<this._tColCnt-1;t++)this._transposeEngine[t]==undefined&&(this._transposeEngine[t]=[]),this._gridMatrix[e]!=undefined&&this._gridMatrix[e][t]!=undefined?(i="string"==typeof this._gridMatrix[e][t]||"number"==typeof this._gridMatrix[e][t]||"object"==typeof this._gridMatrix[e][t]?0==this._gridMatrix[e][t].Value?this._gridMatrix[e][t].Value:this._gridMatrix[e][t].Value==undefined?"":ej.isNullOrUndefined(this._gridMatrix[e][t].valueText)?this._gridMatrix[e][t].Value:this._gridMatrix[e][t].valueText:"",this._transposeEngine[t][e]={Index:t+","+e,CSS:this._gridMatrix[e][t].CSS,Value:"string"==typeof i&&i.indexOf("%####%")>-1?i.replace("%####%",""):i,State:this._gridMatrix[e][t].State,RowSpan:this._gridMatrix[e][t].RowSpan!=undefined?this._gridMatrix[e][t].RowSpan:1,ColSpan:this._gridMatrix[e][t].ColSpan!=undefined?this._gridMatrix[e][t].ColSpan:1,Info:this._gridMatrix[e][t].Info,Span:"None",Expander:this._gridMatrix[e][t].Expander,MCnt:this._gridMatrix[e][t].MCnt!=undefined?this._gridMatrix[e][t].MCnt:1}):this._gridMatrix[e]!=undefined&&(this._transposeEngine[t][e]={Index:t+","+e,CSS:"none",Value:"",State:0,RowSpan:1,ColSpan:1,Info:"",Span:"None",Expander:0})},_filterKeyValues:function(e){var t=this;return $.grep(e,function(e){for(var i=!1,a=0;a<(!ej.isNullOrUndefined(e.uniqueName)&&e.uniqueName.split(">#>").length)&&(i=$.inArray(e.uniqueName.split(">#>")[a],t._advancedFilterInfo)>-1||i,!(i=$.inArray(e.uniqueName,t._advancedFilterInfo)>-1||i));a++);if(!i)return e})},_getFilteredIndex:function(e,t,i,a){return $.map(t,function(t,l){if(e.length>0&&a[i].keys.length>0&&e[a[i].keys.length-1].advancedFilter&&e[a[i].keys.length-1].advancedFilter.length>0&&(e[a[i].keys.length-1].advancedFilter[0].measure==t.fieldName||e[a[i].keys.length-1].advancedFilter[0].name==t.fieldName))return l})[0]},_applyValueFilter:function(e,t){var i,a,l=!1;if(e.length>0&&!ej.isNullOrUndefined(t))switch(t=this._isNumber(t)?t:ej.parseFloat(t,this._locale),i=e[0].valueFilterOperator,a=e[0].values,i.toLowerCase()){case"equals":l=!(t==JSON.parse(e[0].values[0]));break;case"notequals":l=!(t!=JSON.parse(e[0].values[0]));break;case"greaterthan":l=!(t>JSON.parse(e[0].values[0]));break;case"greaterthanorequalto":l=!(t>=JSON.parse(e[0].values[0]));break;case"lessthan":l=!(t<JSON.parse(e[0].values[0]));break;case"lessthanorequalto":l=!(t<=JSON.parse(e[0].values[0]));break;case"between":l=!(t>JSON.parse(a[0])&&t<JSON.parse(a[1]));break;case"notbetween":l=!!(t>JSON.parse(a[0])&&t<JSON.parse(a[1]));break;default:l=!(t==JSON.parse(e[0].values[0]))}return l},_applyLabelFilter:function(e,t){if(e.length>0){var i=e[0].labelFilterOperator,a=e[0].values,l=!1;switch(t=ej.isNullOrUndefined(t)?"":t.toString(),i.toLowerCase()){case"equals":l=!(t.toLowerCase()==a[0].toLowerCase());break;case"notequals":l=t.toLowerCase()==a[0].toLowerCase();break;case"contains":l=!(t.toLowerCase().indexOf(a[0].toLowerCase())>-1);break;case"notcontains":l=t.toLowerCase().indexOf(a[0].toLowerCase())>-1;break;case"beginswith":l=!(0==t.toLowerCase().indexOf(a[0].toLowerCase()));break;case"notbeginswith":l=0==t.toLowerCase().indexOf(a[0].toLowerCase());break;case"endswith":l=ej.isNullOrUndefined(t.toLowerCase().match(a[0].toLowerCase()+"$"));break;case"notendswith":l=!ej.isNullOrUndefined(t.toLowerCase().match(a[0].toLowerCase()+"$"));break;case"greaterthan":l=!(t.toLowerCase()>a[0].toLowerCase());break;case"greaterthanorequalto":l=!(t.toLowerCase()>=a[0].toLowerCase());break;case"lessthan":l=!(t.toLowerCase()<a[0].toLowerCase());break;case"lessthanorequalto":l=!(t.toLowerCase()<=a[0].toLowerCase());break;case"between":l=!(t.toLowerCase()>a[0].toLowerCase()||t.toLowerCase()<a[1].toLowerCase());break;case"notbetween":l=!!(t.toLowerCase()>a[0].toLowerCase()||t.toLowerCase()<a[1].toLowerCase());break;default:l=!(t.toLowerCase().indexOf(a[0].toLowerCase())>-1)}return l}},getMembers:function(e,t){var i,a,l;if(ej.isNullOrUndefined(t))return ej.isNullOrUndefined(this._fieldMembers)?[]:ej.isNullOrUndefined(this._fieldMembers[e])?[]:this._fieldMembers[e];for(i={},a=0;a<t.length;a++)l=t[a],$.each(l,function(e,t){ej.isNullOrUndefined(i[e])?i[e]=[t]:i[e].indexOf(t)<0&&i[e].push(t)});return i[e]},_powerFunction:function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},_calculatedFieldSummaryValue:function(index,calValue,dataSource){var formula,i,value,oldValue,newValue;if(1==dataSource.values[index].isCalculatedField){for(formula=dataSource.values[index].formula.replace(/\s/g,""),i=0;i<dataSource.values.length;i++)1!=dataSource.values[i].isCalculatedField&&(value=ej.globalize.parseFloat(null==calValue[i]?"0":"date"==dataSource.values[i].format?this._dateToInt(calValue[i].toString()).toString():"time"==dataSource.values[i].format?this._dateToInt(new Date("1900",calValue[i].toString().split(":")[0],calValue[i].toString().split(":")[1],calValue[i].toString().split(":")[2].split(" ")[0]).toString()).toString():calValue[i].toString(),this._locale),formula=formula.replace(new RegExp(dataSource.values[i].fieldName,"g"),"percentage"==dataSource.values[i].format&&0!=value?value<0?"("+value/100+")":value:value<0?"("+value+")":value));return formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",dataSource.values[index].format,dataSource.values[index].formatString):null==dataSource.values[index].format?0:"0",newValue=null==dataSource.values[index].format?0:"0",this._getSummaryValue(oldValue,newValue,1,"count"==this._summaryTypes[index]?"sum":this._summaryTypes[index],dataSource.values[index].format,dataSource.values[index].formatString)}},_sortHeaders:function(e,t,i){for(var a,l=[],r=[],n=0,s=t[i].sortOrder!=ej.PivotAnalysis.SortOrder.None?ej.isNullOrUndefined(t[i].format)?ej.DataManager(e).executeLocal(ej.Query().sortBy("keys."+i,null!=t[i].sortOrder&&t[i].sortOrder==ej.PivotAnalysis.SortOrder.Descending?ej.sortOrder.Descending:ej.sortOrder.Ascending,!1)):this._getSortedHeaders(e,t,i):e;n<s.length;)a=s[n].keys[i],(l=$.grep(s,function(e){return e.keys[i]==a})).length>1&&i+1<s[n].keys.length&&(l=this._sortHeaders(l,t,i+1)),r=r.concat(l),n+=l.length;return r},_getSortedHeaders:function(e,t,i){return t[i].sortOrder==ej.PivotAnalysis.SortOrder.Descending?e.sort(function(e,a){return ej.PivotAnalysis._formatToInt(a.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)-ej.PivotAnalysis._formatToInt(e.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)}):e.sort(function(e,a){return ej.PivotAnalysis._formatToInt(e.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)-ej.PivotAnalysis._formatToInt(a.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)})},_isValidTime:function(e){var t=e.indexOf(":")>-1?e.split(":"):[];return 3==t.length&&(t[3]=t[2].indexOf(" ")>-1?t[2].split(" ")[1]:"AM",t[2]=t[2].indexOf(" ")>-1?t[2].split(" ")[0]:t[2],!(!(Number(t[0])>-1&&Number(t[0])<13&&Number(t[1])>-1&&Number(t[1])<61&&jQuery.isNumeric(t[2]))||"AM"!=t[3]&&"PM"!=t[3]))},_getNumber:function(e,t){return ej.isNullOrUndefined(e)||(jQuery.isNumeric(e.toString().replace(/[,.]/g,""))?(e=e.toString().replace(/[,]/g,","==ej.preferredCulture(this._locale).numberFormat[","]?"":"~").replace(/[.]/g,"."==ej.preferredCulture(this._locale).numberFormat["."]?".":""),e=Number(e.toString().replace(/[~]/g,"."))):e=this._isValidTime(e)?this._formatToInt(e,"time",t):ej.isNullOrUndefined(ej.parseDate(e,t==undefined?"MM/dd/yyyy":t))?-1!=e.indexOf("/")&&2==e.split("/")?this._formatToInt(e,"fraction",undefined):$.trim(e).indexOf("%")==$.trim(e).length-1?Number(e.replace(/[^\d.-]/g,""))/100:/[a-zA-Z]/.test(e)?1:Number(e.replace(/[^\d.-]/g,"")):this._formatToInt(e,"date",t)),e},_setFormat:function(e,t,i){switch(t){case"percentage":var a=jQuery.isNumeric(e)?1:100;e="string"==typeof e?$.trim(e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",",".").replace(ej.preferredCulture(this._locale).numberFormat.percent.symbol,"")):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:P}",""==e?0:e/a,this._locale);break;case"decimal":case"number":e="string"==typeof e?e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:N}",e,this._locale);break;case"currency":e="string"==typeof e?$.trim(e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",",".").replace(ej.preferredCulture(this._locale).numberFormat.currency.symbol,"")):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:C2}",""==e?0:e,this._locale);break;case"date":jQuery.isNumeric(e)?(e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale))):"Invalid Date"!=new Date(e)?(e=new Date(e),e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale)):(e=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime()),e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale));break;case"scientific":e="string"==typeof e?e.split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e=jQuery.isNumeric(e)?e:0,e=Number(e).toExponential(2).replace("e","E");break;case"accounting":e=this._toAccounting(e,i||"{0:C2}",this._locale);break;case"time":jQuery.isNumeric(e)?(e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale))):this._isValidTime(e)?e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale):(e=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime()),e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale));break;case"fraction":e="string"==typeof e?e.split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e="numerator"in(e=jQuery.isNumeric(e)?this._toFraction(e):this._toFraction(0))?e.integer+" "+e.numerator+"/"+e.denominator:e.integer}return e},_getReflectedValue:function(e,t,i,a){var l=$(e).prop(t);return null==l?l:(jQuery.isNumeric(l)||"Invalid Date"!=new Date(l)||(i=a=null),this._setFormat(l,i,a))},_formatToInt:function(value,format,formatString){var time;switch(format){case"date":value=null!=ej.parseDate(value.toString(),formatString==undefined?"MM/dd/yyyy":formatString,this._locale)?this._dateToInt(ej.parseDate(value,formatString==undefined?"MM/dd/yyyy":formatString,this._locale)):value;break;case"percentage":value=0!=value?ej.globalize.parseFloat(value.toString(),this._locale)/100:Number(value);break;case"currency":case"accounting":value=0!=value?ej.globalize.parseFloat(ej.globalize.format(value.toString(),"c",this._locale),this._locale):Number(value);break;case"decimal":case"number":value=0!=value?ej.globalize.parseFloat(value.toString(),this._locale):Number(value);break;case"scientific":value=0!=value||0==value?parseFloat(value):Number(value);break;case"time":this._isNumber(value)||(time=value.toString().split(":"),time=new Date("1900",time[0],time[1],time[2].split(" ")[0]).toString(),value=this._dateToInt(time));break;case"fraction":var temp1=parseFloat(value.toString().split(" ")[0]),temp2=eval(value.toString().split(" ")[1])!=undefined?parseFloat(eval(value.toString().split(" ")[1])):parseFloat(0),value=0!=value?temp1+temp2:Number(value)}return value},_isDateTime:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},_toAccounting:function(e,t,i){var a,l,r,n,s=ej.preferredCulture(i).numberFormat,o=s.currency.symbol;return val=ej.widgetBase.formatting(t,e,i),val=val.indexOf(" ")>-1?val.split(" ").join(""):val,r=val.replace(o,""),n=jQuery.isNumeric(r.toString().split(s[","]).join("").replace(",","."))?val.indexOf(o):0,r=jQuery.isNumeric(r.toString().split(",").join(""))?r:"0.00",!n||Number(r)<0&&1===n?(a=o,l=r):(a=r,l=o),a+"   "+l},_toFraction:function(e){if(this._isNumber(e)){var t=e.toString(),i=t.split(".")[0],a=t.split(".")[1];if(!a)return{integer:e};var l=(+a).toString(),r=this._getPlaceValue(a,l),n=this._getGCD(l,r);return{integer:i,numerator:Number(l)/n,denominator:Number(r)/n}}return null},_isNumber:function(e){return e-parseFloat(e)>=0},_getGCD:function(e,t){return e=Number(e),(t=Number(t))?this._getGCD(t,e%t):e},_getPlaceValue:function(e,t){var i=e.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},_cellEdit:function(e,t,i,a){return $.each(this._editCellsInfo,function(l,r){if(e==(ej.isNullOrUndefined(r.row)&&ej.isNullOrUndefined(r.column)?"":ej.isNullOrUndefined(r.row)?r.column:ej.isNullOrUndefined(r.column)?r.row:r.row+">#>"+r.column)&&i==parseInt(r.value.split("#")[0]))return t=ej.PivotAnalysis._setFormat(ej.isNullOrUndefined(a.format)?jQuery.isNumeric(r.value.split("#")[1].toString().split(",").join(""))?parseFloat(r.value.split("#")[1].toString().split(",").join("")):0:r.value.split("#")[1],a.format,a.formatString),!1}),t},_isMemberExist:function(e,t,i,a){var l,r,n,s,o,d;switch(e){case"row":if(r=!1,(n=0==this._rowKeysCalcValues.length?0:this._rowMembers[t.uniqueName])>-1&&(r=!0,l=n),0==this._rowKeysCalcValues.length&&(this._rowKeysCalcValues.push(t),this._rowMembers[t.uniqueName]=this._rowKeysCalcValues.length-1),r)for(s=0;s<i.keys.length;s++){if(null==this._rowKeysCalcValues[l].value){this._rowKeysCalcValues[l].value=i;break}this._rowKeysCalcValues[l].value.keys[s]+=i.keys[s]}else this._rowKeysCalcValues.push(t),this._rowMembers[t.uniqueName]=this._rowKeysCalcValues.length-1;break;case"column":if(r=!1,(n=0==this._colKeysCalcValues.length?0:this._colMembers[t.uniqueName])>-1&&(r=!0,l=n),0==this._colKeysCalcValues.length&&(a.columns.length>0||a.values.length>0)&&(this._colKeysCalcValues.push(t),this._colMembers[t.uniqueName]=this._colKeysCalcValues.length-1),r)for(s=0;s<i.keys.length;s++){if(null==this._colKeysCalcValues[l].value){this._colKeysCalcValues[l].value=i;break}this._colKeysCalcValues[l].value.keys[s]+=i.keys[s]}else(a.columns.length>0||a.values.length>0)&&(this._colKeysCalcValues.push(t),this._colMembers[t.uniqueName]=this._colKeysCalcValues.length-1);break;case"calc":if(r=!1,(n=0==this._tableKeysCalcValues.length?0:this._calcMembers[t.uniqueName])>-1&&(r=!0,l=n),0==this._tableKeysCalcValues.length&&(this._tableKeysCalcValues.push(t),this._calcMembers[t.uniqueName]=this._tableKeysCalcValues.length-1),r)for(s=0;s<i.keys.length;s++){if(null==this._tableKeysCalcValues[l].value){for(this._tableKeysCalcValues[l].value=i,this._tableKeysCalcValues[l].value.count=1,d=0;d<i.keys.length;d++)this._summaryTypes[d]==ej.PivotAnalysis.SummaryType.Count&&(this._tableKeysCalcValues[l].value.keys[d]=this._tableKeysCalcValues[l].value.count);break}o=a.values[s],this._tableKeysCalcValues[l].value.uniqueName[s]==i.uniqueName[s]&&(ej.isNullOrUndefined(o.formatString)||"single-entry"!=o.formatString.toLowerCase())||(this._tableKeysCalcValues[l].value.uniqueName[s]=" "),0==s&&this._tableKeysCalcValues[l].value.count++,1!=a.values[s].isCalculatedField&&(this._tableKeysCalcValues[l].value.keys[s]=this._getSummaryValue(this._tableKeysCalcValues[l].value.keys[s],i.keys[s],this._tableKeysCalcValues[l].value.count,this._summaryTypes[s],a.values[s].format,a.values[s].formatString))}else for(this._tableKeysCalcValues.push(t),this._calcMembers[t.uniqueName]=this._tableKeysCalcValues.length-1,this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value=i,d=0;d<i.keys.length;d++)this._summaryTypes[d]==ej.PivotAnalysis.SummaryType.Count&&(this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value.keys[d]=1),this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value.count=1}},_getSummaryValue:function(e,t,i,a,l,r){if(t=ej.isNullOrUndefined(t)?null:0==t?0:t,e=ej.isNullOrUndefined(e)?null:0==e?0:e,!ej.isNullOrUndefined(t)&&!ej.isNullOrUndefined(e)){switch(e=this._formatToInt(e,l,r),t=this._formatToInt(t,l,r),a){case ej.PivotAnalysis.SummaryType.Sum:e+=t;break;case ej.PivotAnalysis.SummaryType.Average:e=(e*(i-1)+t)/i,Math.floor(e)!=e&&(e=Number(e.toFixed(2)));break;case ej.PivotAnalysis.SummaryType.Min:e=1==i?t:Math.min(e,t);break;case ej.PivotAnalysis.SummaryType.Max:e=1==i?t:Math.max(e,t);break;case ej.PivotAnalysis.SummaryType.Count:e=i}switch(l){case"percentage":e=ej.widgetBase.formatting(r||"{0:P}",e,this._locale);break;case"decimal":case"number":e=ej.widgetBase.formatting(r||"{0:N}",e,this._locale);break;case"date":e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:"+(r==undefined?"MM/dd/yyyy":r)+"}",e,this._locale));break;case"currency":e=ej.widgetBase.formatting(r||"{0:C2}",e,this._locale);break;case"scientific":e=e.toExponential(2).replace("e","E");break;case"accounting":e=this._toAccounting(e,r||"{0:C2}",this._locale);break;case"time":e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale));break;case"fraction":e="numerator"in(e=this._toFraction(e))?e.integer+" "+e.numerator+"/"+e.denominator:e.integer}}return e},_dateToInt:function(e){var t=new Date("01/01/1900");return((this._isDateTime(e)?e:new Date(e)).getTime()-t.getTime())/864e5+2},_insertTotalHeader:function(e,t){var i,a,l,r,n;if(e.length<=1)t.push({cellType:"RGTot",keys:["Grand Total"],tot:"sub"});else{for(i=-1,a=e.length-2;a>=0;a--)if(i++,(l=t.length)>0){r=t[0].uniqueName.split(">#>"),t[0].keys[i],r=r.slice(0,a+1).join(">#>");var s="",o=0,d="";for(n=1;n<=l;n++)t[n]!=undefined?(s=(s=t[n].uniqueName.split(">#>")).slice(0,a+1).join(">#>"),d=t[n].keys[a+1]):s=undefined,s!=undefined&&-1==s.indexOf("%####%")?r!=undefined&&s!=r&&(t.splice(n,0,{keys:[r.split(">#>")[a]+" Total%####%"],cellType:"SubTot",uniqueName:r,level:a,mSpan:n-o}),t[o].span==undefined&&(t[o].span=[]),t[o].span[a]=n-o,l++,r=s,o=++n,d):r!=undefined&&(t.splice(n,0,{keys:[r.split(">#>")[a]+" Total%####%"],cellType:"SubTot:",uniqueName:r,level:a,mSpan:n-o}),t[o].span==undefined&&(t[o].span=[]),t[o].span[a]=n-o,l++,r=s,o=++n,d)}t.push({cellType:"RGTot",keys:["Grand Total"]})}},_isPreviousLevelEqual:function(e,t,i,a){for(var l=a-1;l>=0;l--)return e[t].keys[l]!=e[i].keys[l]},_calculateValues:function(e){var t,i,a=this._rowKeysCalcValues.length+(e.values.length>0?1:0),l=0==this._colKeysCalcValues.length?1:this._colKeysCalcValues.length*(0==e.values.length?1:e.values.length)+1-(this._isPaging&&e.values.length>0&&e.pagerOptions.categoricalPageSize<e.values.length*this._colKeysCalcValues.length?e.values.length-(e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length==0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize:e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length):0);this._isPaging&&(0==e.columns.length?ej.PivotAnalysis._colHdrLen=0:$.each(this._colKeysCalcValues,function(e,t){!ej.isNullOrUndefined(t)&&t.keys.length>ej.PivotAnalysis._colHdrLen&&(ej.PivotAnalysis._colHdrLen=t.keys.length)}),0==e.rows.length?ej.PivotAnalysis._rowHdrLen=0:$.each(this._rowKeysCalcValues,function(e,t){!ej.isNullOrUndefined(t)&&t.keys.length>ej.PivotAnalysis._rowHdrLen&&(ej.PivotAnalysis._rowHdrLen=t.keys.length)})),this._gridMatrix=new Array(a+(this._isPaging?this._rowHdrLen:e.rows.length)+1),this._populateRowHeaders(e,a+(this._isPaging?this._rowHdrLen:e.rows.length)+1,0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length),t=(this._isPaging?this._colHdrLen:e.columns.length)+1,i=(this._isPaging&&e.pagerOptions.categoricalPageSize+1<l?e.pagerOptions.categoricalPageSize+1:l)+(0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length),this._populateColumnHeaders(e,t,i),this._advancedFilterInfo=[],e.values.length>0&&this._populateCalcTable(e),this._tRowCnt=a+t,this._tColCnt=i},_populateRowHeaders:function(e,t,i){var a,l,r,n,s;if(0!=this._rowKeysCalcValues.length){for(a=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1+(e.values.length>0?1:0):(this._isPaging?this._colHdrLen:e.columns.length)+(e.values.length>0?1:0),this._gridMatrix=[],"",l=0;l<this._rowKeysCalcValues.length;l++){this._rowKeysCalcValues[l];var o=0,d=0,u=0,c=0;if(this._rowKeysCalcValues[l].keys!=undefined&&0!=this._rowKeysCalcValues[l].keys.length)for(this._gridMatrix[a]=new Array(i),c=this._rowKeysCalcValues[l].keys.length,r=0;r<c;r++)this._rowKeysCalcValues[l].cellType!=undefined&&ej.isNullOrUndefined(this._rowKeysCalcValues[l].span)?this._rowKeysCalcValues[l].cellType.indexOf("SubTot")>-1?(d=0==o?this._rowKeysCalcValues[l].level+o:o,u=i-this._rowKeysCalcValues[l].level,this._cellType="summary rstot"):(this._cellType="summary rgtot",d=o,u=this._isPaging?this._rowHdrLen:e.rows.length):(this._cellType="rowheader",d=o,u=1),n=c>1&&c-r>1?1:ej.isNullOrUndefined(this._rowKeysCalcValues[l].expander)?0:2,s=$.extend(!0,[],this._rowKeysCalcValues[l].keys),this._gridMatrix[a][d]={Index:d+","+a,CSS:this._cellType,Value:this._rowKeysCalcValues[l].keys[r],State:n,RowSpan:this._rowKeysCalcValues[l].span!=undefined?this._rowKeysCalcValues[l].span[r]:1,ColSpan:u,Info:s.splice(0,r+1).join(">#>"),Span:"None",Expander:this._rowKeysCalcValues[l].span!=undefined?this._rowKeysCalcValues[l].span[r]!=undefined?1:ej.isNullOrUndefined(this._rowKeysCalcValues[l].expander)?0:1:ej.isNullOrUndefined(this._rowKeysCalcValues[l].expander)?0:2,MCnt:this._rowKeysCalcValues[l].mSpan!=undefined&&ej.isNullOrUndefined(this._rowKeysCalcValues[l].span)?this._rowKeysCalcValues[l].mSpan:0},this._rowKeysCalcValues[l].level-r==1&&delete this._rowKeysCalcValues[l].span,o++;a++}this._cellType=""}},_populateColumnHeaders:function(e,t){var i,a,l,r,n,s,o;if(0!=this._colKeysCalcValues.length){var d,u,c,p,m,h,g=d=0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length,f=0==e.values.length?1:e.values.length,_=u=0,b=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1:this._isPaging?this._colHdrLen:e.columns.length;for(i=0;i<this._colKeysCalcValues.length;i++){for(_=0,c=0,p=0,0,m=f,h=0,this._isPaging&&e.values.length>0&&(h=(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length,0==i?m=(m=(1==e.pagerOptions.categoricalCurrentPage&&e.values.length>e.pagerOptions.categoricalPageSize?e.pagerOptions.categoricalPageSize:e.values.length)-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length)<1?e.values.length:e.values.length>e.pagerOptions.categoricalPageSize&&m>e.pagerOptions.categoricalPageSize?e.pagerOptions.categoricalPageSize:m:this._colKeysCalcValues.length-i==1?m=(m=e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length)<1||e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?e.values.length:m:m=e.values.length),this._colKeysCalcValues[i].keys,this._gridMatrix[_]==undefined&&(this._gridMatrix[_]=[]),u=this._colKeysCalcValues[i].keys.length,a=0;a<u;a++){for(this._gridMatrix[_]==undefined&&(this._gridMatrix[_]=[]),this._colKeysCalcValues[i].cellType!=undefined&&ej.isNullOrUndefined(this._colKeysCalcValues[i].span)?this._colKeysCalcValues[i].cellType.indexOf("SubTot")>-1?(c=0==_?this._colKeysCalcValues[i].level+_:_,p=t-this._colKeysCalcValues[i].level-1,this._cellType="summary cstot"):(c=_,p=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1:this._isPaging?this._colHdrLen:e.columns.length,this._cellType="summary cgtot"):(c=_,p=1,this._cellType="colheader"),l=u>1&&u-a>1?1:ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:2,s=0;s<m;s++)r=$.extend(!0,[],this._colKeysCalcValues[i].keys),this._gridMatrix[c][f*i+s+d-(i>0?h:0)]={Index:g+","+c,CSS:this._cellType,Value:this._colKeysCalcValues[i].keys[a],State:l,ColSpan:s>0?1:this._isPaging&&0==i&&!ej.isNullOrUndefined(this._colKeysCalcValues[i].span)&&this._colKeysCalcValues[i].span[a]>=this._colKeysCalcValues.length?e.pagerOptions.categoricalPageSize:(this._colKeysCalcValues[i].span!=undefined?this._colKeysCalcValues[i].span[a]==undefined?1:this._colKeysCalcValues[i].span[a]:1)*(this._colKeysCalcValues.length-i==1?m:f)-(0==i?h:0),RowSpan:p,Info:r.splice(0,a+1).join(">#>"),Span:"None",Expander:s>0?ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:1:this._colKeysCalcValues[i].span!=undefined&&this._colKeysCalcValues[i].span[a]!=undefined?1:ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:1};this._colKeysCalcValues[i].level-a==1&&delete this._colKeysCalcValues[i].span,_++}if(e.values.length>0)for(s=0;s<m;s++)this._gridMatrix[b]==undefined&&(this._gridMatrix[b]=[]),n=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length+s:s,this._gridMatrix[b][f*i+s+d-(i>0?h:0)]={Index:f*i+s+d-(i>0?h:0)+","+_,CSS:this._cellType+" calc",Value:e.values[n].fieldCaption==undefined?e.values[n].fieldName:e.values[n].fieldCaption,State:0,ColSpan:1,RowSpan:1,Info:"",Span:"None",Expander:0};g++}if(this._cellType="",this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length>0&&t>1)for(s=0;s<t;s++)for(o=0;o<this._gridMatrix[s].length;o++)!ej.isNullOrUndefined(this._gridMatrix[s][o])&&this._gridMatrix[s][o].ColSpan>this._gridMatrix[s].length-o&&(this._gridMatrix[s][o].ColSpan=this._gridMatrix[s].length-o)}},_populateCalcTable:function(e){var t,i,a,l,r,n,s,o,d,u,c,p,m,h,g,f,_,b,v,C=[],S=null,O=e.values.length,x=this;this._rowTotCalc=[],this._rowTotCalc=[];var y,P=0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length,N=!1,M=0,T=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?2:(this._isPaging?this._colHdrLen:e.columns.length)+1,L=T,w=!1,j={};for($.grep(x._tableKeysCalcValues,function(e){j[e.uniqueName]=e}),t=$.grep(this._tableKeysCalcValues,function(e){if(ej.isNullOrUndefined(e.cellType))return e}),$.grep(this._tableKeysCalcValues,function(e){if(!ej.isNullOrUndefined(e.cellType))return e}),f=0;f<this._rowKeysCalcValues.length;f++){for(this._colTotCalc=[],y=P,N=!0,this._gridMatrix[f+T]==undefined&&(this._gridMatrix[f+T]=[]),this._rowTotCalc[M]=[],i=0;i<this._colKeysCalcValues.length;i++){if(C=[],S=null,this._cellType="value",_=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,b=(b=this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length-i==1&&i>0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length:O)<1||this._isPaging&&e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?O:b,e.columns.length>0&&e.rows.length>0)if(!x._isPaging||"RGTot"!=x._rowKeysCalcValues[f].cellType&&"RGTot"!=x._colKeysCalcValues[i].cellType){if(a=x._rowKeysCalcValues[f].uniqueName+">#>"+x._colKeysCalcValues[i].uniqueName,l=j[a]){for(o=0;o<l.value.keys.length;o++)C.push(l.value.keys[o]);""!=l.value.uniqueName&&(S=l.value.uniqueName)}}else r=0,$.grep(t,function(t){if("RGTot"==x._rowKeysCalcValues[f].cellType&&"RGTot"==x._colKeysCalcValues[i].cellType||("RGTot"==x._rowKeysCalcValues[f].cellType?t.uniqueName.indexOf(x._colKeysCalcValues[i].uniqueName)>-1:t.uniqueName.indexOf(x._rowKeysCalcValues[f].uniqueName)>-1))for(r++,o=0;o<t.value.keys.length;o++)ej.isNullOrUndefined(C[o])?C.push(t.value.keys[o]):C[o]=e.values[o].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(o,C,e):ej.PivotAnalysis._getSummaryValue(C[o],t.value.keys[o],r,"count"==ej.PivotAnalysis._summaryTypes[o]?"sum":ej.PivotAnalysis._summaryTypes[o],e.values[o].format,e.values[o].formatString)});else 0==e.rows.length?x._isPaging?(r=0,$.grep(t,function(t){if("RGTot"==x._colKeysCalcValues[i].cellType||t.uniqueName.indexOf(x._colKeysCalcValues[i].uniqueName)>-1)for(r++,o=0;o<t.value.keys.length;o++)ej.isNullOrUndefined(C[o])?C.push(t.value.keys[o]):C[o]=e.values[o].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(o,C,e):ej.PivotAnalysis._getSummaryValue(C[o],t.value.keys[o],r,"count"==ej.PivotAnalysis._summaryTypes[o]?"sum":ej.PivotAnalysis._summaryTypes[o],e.values[o].format,e.values[o].formatString)})):$.grep(x._tableKeysCalcValues,function(e){if(e.uniqueName==x._colKeysCalcValues[i].uniqueName){for(o=0;o<e.value.keys.length;o++)C.push(e.value.keys[o]);""!=e.value.uniqueName&&(S=e.value.uniqueName)}}):x._isPaging?(r=0,$.grep(t,function(t){if("RGTot"==x._rowKeysCalcValues[f].cellType||t.uniqueName.indexOf(x._rowKeysCalcValues[f].uniqueName)>-1)for(r++,o=0;o<t.value.keys.length;o++)ej.isNullOrUndefined(C[o])?C.push(t.value.keys[o]):C[o]=e.values[o].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(o,C,e):ej.PivotAnalysis._getSummaryValue(C[o],t.value.keys[o],r,"count"==ej.PivotAnalysis._summaryTypes[o]?"sum":ej.PivotAnalysis._summaryTypes[o],e.values[o].format,e.values[o].formatString)})):$.grep(x._tableKeysCalcValues,function(e){if(e.uniqueName==x._rowKeysCalcValues[f].uniqueName){for(o=0;o<e.value.keys.length;o++)C.push(e.value.keys[o]);""!=e.value.uniqueName&&(S=e.value.uniqueName)}});if(this._editCellsInfo.length>0)for(v=0;v<e.values.length;v++)C[v]=ej.PivotAnalysis._cellEdit(e.columns.length>0&&e.rows.length>0?this._rowKeysCalcValues[f].uniqueName+">#>"+this._colKeysCalcValues[i].uniqueName:0==e.rows.length?this._colKeysCalcValues[i].uniqueName:this._rowKeysCalcValues[f].uniqueName,C[v],v,e.values[v]);if(this._colKeysCalcValues[i].cellType!=undefined&&(this._colKeysCalcValues[i].cellType.indexOf("SubTot")>-1||this._colKeysCalcValues[i].cellType.indexOf("RGTot")>-1)){if(!this._isPaging){for(C=[],S=null,o=0;o<O;o++)for(d=0,r=0,n=y;n<=i*O+P;n++)this._gridMatrix[f+T]!=undefined&&this._gridMatrix[f+T][y+d*O+o]!=undefined&&this._gridMatrix[f+T][y+d*O+o].Value!=undefined&&(C[o]==undefined&&(C[o]=0),r++,C[o]=e.values[o].isCalculatedField?this._calculatedFieldSummaryValue(o,C,e):this._getSummaryValue(C[o],this._gridMatrix[f+T][y+d*O+o].Value,r,"count"==this._summaryTypes[o]?"sum":this._summaryTypes[o],e.values[o].format,e.values[o].formatString)),d++;0,y=(i+1)*O+P,ej.isNullOrUndefined(C)||this._colTotCalc.push({uniqueName:this._colKeysCalcValues[i].uniqueName,level:this._colKeysCalcValues[i].level,value:C}),this._colKeysCalcValues[i-1]!=undefined&&this._colKeysCalcValues[i-1].cellType!=undefined&&this._colKeysCalcValues[i-1].cellType.indexOf("SubTot")>-1&&-1==this._colKeysCalcValues[i-1].cellType.indexOf("RGTot")&&($(this._colTotCalc).filter(function(e,t){return t!=undefined&&t.uniqueName!=undefined&&x._colKeysCalcValues[i].uniqueName!=undefined&&t.level!=undefined&&x._colKeysCalcValues[i].level!=undefined&&0===t.uniqueName.indexOf(x._colKeysCalcValues[i].uniqueName)&&x._colKeysCalcValues[i].level+1==t.level}).map(function(t,i){for(var a=0;a<i.value.length;a++)C[a]=ej.isNullOrUndefined(C[a])?0:C[a],i.value[a]=ej.isNullOrUndefined(i.value[a])?0:i.value[a],e.values[a].isCalculatedField?C[a]=ej.PivotAnalysis._calculatedFieldSummaryValue(a,C,e):C[a]+=i.value[a];return C}),ej.isNullOrUndefined(C)||this._colTotCalc.push({uniqueName:this._colKeysCalcValues[i].uniqueName,level:this._colKeysCalcValues[i].level,value:C}))}this._cellType="summary value"}if(this._colKeysCalcValues[i].cellType!=undefined&&this._colKeysCalcValues[i].cellType.indexOf("RGTot")>-1&&0==C&&(this._isPaging||(C=[],S=null,r=0,$(this._colTotCalc).filter(function(e,t){return t!=undefined&&t!=undefined&&t.level!=undefined&&0==t.level}).map(function(t,i){for(var a=0;a<i.value.length;a++)C[a]=ej.isNullOrUndefined(C[a])?0:C[a],i.value[a]=ej.isNullOrUndefined(i.value[a])?0:i.value[a],r++,C[a]=e.values[a].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(a,C,e):ej.PivotAnalysis._getSummaryValue(C[a],i.value[a],r,"count"==x._summaryTypes[a]?"sum":x._summaryTypes[a],e.values[a].format,e.values[a].formatString);return C})),this._cellType="summary value"),this._rowKeysCalcValues[f].cellType!=undefined&&(this._rowKeysCalcValues[f].cellType.indexOf("SubTot")>-1||this._rowKeysCalcValues[f].cellType.indexOf("RGTot")>-1)){if(!this._isPaging){for(C=[],S=null,this._rowKeysCalcValues[f].uniqueName,this._rowKeysCalcValues[f-1]!=undefined&&this._rowKeysCalcValues[f-1].cellType!=undefined&&this._rowKeysCalcValues[f-1].cellType.indexOf("SubTot")>-1&&-1==this._rowKeysCalcValues[f].cellType.indexOf("RGTot")&&(r=0,$(this._rowTotCalc).filter(function(e,t){return t[0]!=undefined&&t[0].uniqueName!=undefined&&x._rowKeysCalcValues[f].uniqueName!=undefined&&t[0].level!=undefined&&x._rowKeysCalcValues[f].level!=undefined&&0===t[0].uniqueName.indexOf(x._rowKeysCalcValues[f].uniqueName)&&x._rowKeysCalcValues[f].level+1==t[0].level}).map(function(t,a){if(a[P+i].length>0){r++;for(var l=0;l<a[P+i].length;l++)C[l]=ej.isNullOrUndefined(C[l])?0:C[l],a[P+i][l]=ej.isNullOrUndefined(a[P+i][l])?0:a[P+i][l],C[l]=e.values[l].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(l,C,e):ej.PivotAnalysis._getSummaryValue(C[l],a[P+i][l],r,"count"==x._summaryTypes[l]?"sum":x._summaryTypes[l],e.values[l].format)}return C})),this._rowKeysCalcValues[f].cellType!=undefined&&this._rowKeysCalcValues[f].cellType.indexOf("RGTot")>-1&&(r=0,$(this._rowTotCalc).filter(function(e,t){return t!=undefined&&t[0]!=undefined&&t[0].level!=undefined&&0==t[0].level}).map(function(t,a){if(a[P+i].length>0){r++;for(var l=0;l<a[P+i].length;l++)C[l]=ej.isNullOrUndefined(C[l])?0:C[l],a[P+i][l]=ej.isNullOrUndefined(a[P+i][l])?0:a[P+i][l],C[l]=e.values[l].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(l,C,e):ej.PivotAnalysis._getSummaryValue(C[l],a[P+i][l],r,"count"==x._summaryTypes[l]?"sum":x._summaryTypes[l],e.values[l].format,e.values[l].formatString)}return C})),r=1,n=L;n<=f+T;n++){for(s=!1,o=0;o<O;o++)d=0,this._gridMatrix[n]!=undefined&&this._gridMatrix[n][P+i*O+o]!=undefined&&this._gridMatrix[n][P+i*O+o].Value!=undefined&&(C[o]==undefined&&(C[o]=0),s=!0,C[o]=e.values[o].isCalculatedField?this._calculatedFieldSummaryValue(o,C,e):this._getSummaryValue(C[o],this._gridMatrix[n][P+i*O+o].Value,r,"count"==this._summaryTypes[o]?"sum":this._summaryTypes[o],e.values[o].format,e.values[o].formatString)),d++;s&&r++}0,w=!0,N&&(this._rowTotCalc[M][0]={uniqueName:this._rowKeysCalcValues[f].uniqueName,level:this._rowKeysCalcValues[f].level},N=!1),this._rowTotCalc[M][P+i]=C}this._cellType="summary value"}if(e.enableAdvancedFilter){var D=0,I=this._currentFilterVal.fieldName?ej.Pivot.getReportItemByFieldName(this._currentFilterVal.fieldName,e):null;null!=I&&"rows"==I.axis&&(D=this._getFilteredIndex(e.rows,e.values,f,this._rowKeysCalcValues)),ej.isNullOrUndefined(D)||null==I||"rows"==I.axis||(D=this._getFilteredIndex(e.columns,e.values,i,this._colKeysCalcValues)),ej.isNullOrUndefined(D)||(u=this._rowKeysCalcValues[f].keys.length>0&&e.rows.length>0&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter.length>0&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter?1:null,c=!(!I||null==I||null==u||e.rows[this._rowKeysCalcValues[f].keys.length-1].fieldName!=I.item.fieldName)&&this._applyValueFilter(e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter,C[D]),this._colKeysCalcValues[i].keys.indexOf("Grand Total")>=0&&c&&this._rowKeysCalcValues[f].uniqueName?this._advancedFilterInfo.push(this._rowKeysCalcValues[f].uniqueName):0==e.columns.length&&c&&this._rowKeysCalcValues[f].uniqueName&&this._advancedFilterInfo.push(this._rowKeysCalcValues[f].uniqueName),p=this._colKeysCalcValues[i].keys.length>0&&e.columns.length>0&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter.length>0&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter?1:null,m=null!=I&&null!=p&&e.columns[this._colKeysCalcValues[i].keys.length-1].fieldName==I.item.fieldName&&this._applyValueFilter(e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter,C[D]),this._colKeysCalcValues[i].uniqueName&&"string"===jQuery.type(this._rowKeysCalcValues[f].keys[0])&&this._rowKeysCalcValues[f].keys[0].indexOf("Grand Total")>-1&&m&&this._advancedFilterInfo.push(this._colKeysCalcValues[i].uniqueName))}for(h=this._isPaging&&e.values.length>0?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,v=_;v<b;v++)C!=undefined&&C.length!=undefined?(g=null,null!=S&&""!=S[v]&&" "!=S[v]&&(g=S[v]),this._gridMatrix[T+f][O*i+v+P-h]={Index:O*i+v+P-h+","+T+f,CSS:this._cellType,Value:C[v],valueText:g,State:0,ColSpan:1,RowSpan:1,Info:"",Span:"None",Expander:0}):this._gridMatrix[T+f][O*i+v+P-h]=0}w&&(M++,L=f+T+1,w=!1)}for(f=0;f<this._rowKeysCalcValues.length;f++)for(i=0;i<this._colKeysCalcValues.length;i++)for(_=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,b=(b=this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length-i==1&&i>0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length:O)<1||this._isPaging&&e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?O:b,v=_;v<b;v++)e.values[v].isCalculatedField&&null==this._gridMatrix[T+f][O*i+v+P-h].Value&&(this._gridMatrix[T+f][O*i+v+P-h].Value=this._calculatedFieldSummaryValue(v,[],e));return this._gridMatrix}},ej.PivotAnalysis.SortOrder={Ascending:"ascending",Descending:"descending",None:"none"},ej.PivotAnalysis.FilterType={Exclude:"exclude",Include:"include"},ej.PivotAnalysis.SummaryType={Sum:"sum",Average:"average",Count:"count",Min:"min",Max:"max"}}(jQuery,Syncfusion)})},1039:function(e,t,i){var a,l,r;
/*!
*  filename: ej.pivotchart.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotchart.min.js
*  version : 17.1.0.47
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(n){l=[i(15),i(4),i(21),i(65),i(38),i(16),i(55),i(66),i(97),i(1011),i(1009),i(1010)],void 0===(r="function"==typeof(a=n)?a.apply(t,l):a)||(e.exports=r)}(function(){!function(e,t,i){t.widget("ejPivotChart","ej.PivotChart",{_rootCSS:"e-pivotchart",element:null,model:null,_requiresID:!0,validTags:["div","span"],defaults:e.extend(t.datavisualization.Chart.prototype.defaults,{url:"",analysisMode:"pivot",operationalMode:"clientmode",cssClass:"",currentReport:"",customObject:{},enableRTL:!1,enableDefaultValue:!1,isResponsive:!1,enable3D:!1,enableContextMenu:!1,enableMultiLevelLabels:!1,enableXHRCredentials:!1,rotation:0,serviceMethodSettings:{initialize:"InitializeChart",drillDown:"DrillChart",exportPivotChart:"Export",paging:"paging"},dataSource:{data:null,sourceInfo:"",providerName:"ssas",isFormattedValues:!1,columns:[],cube:"",catalog:"",rows:[],values:[],filters:[]},locale:null,drillSuccess:null,load:null,beforeServiceInvoke:null,afterServiceInvoke:null,renderComplete:null,renderFailure:null,renderSuccess:null,beforeExport:null,beforeSeriesRender:null,beforePivotEnginePopulate:null}),dataTypes:{dataSource:{data:"data",columns:"array",rows:"array",values:"array",filters:"array"},marker:"data",crossHair:"data",size:"data",serviceMethodSettings:{initialize:"enum",drillDown:"enum",exportPivotChart:"enum",paging:"enum"},zooming:"data",customObject:"data"},observables:["title.text","commonSeriesOptions.type","locale"],titleText:t.util.valueFunction("title.text"),seriesType:t.util.valueFunction("commonSeriesOptions.type"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(e){this._olapReport=e},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=e.parseJSON(t)},getPivotEngine:function(){return this._pivotEngine},setPivotEngine:function(e){this._pivotEngine=e},_init:function(){this._initPrivateProperties(),this._load()},_destroy:function(){this._pivotEngine=null,this.element.empty().removeClass("e-pivotchart"+this.model.cssClass).removeAttr("tabindex"),this._waitingPopup!=i&&this._waitingPopup.destroy(),""==this.element.attr("class")&&this.element.removeAttr("class")},_initPrivateProperties:function(){this._id=this.element.attr("id"),this._olapReport="",this._JSONRecords=null,this._currentAction="initialize",this._selectedItem="",this._selectedIndex=-1,this._selectedTagInfo=null,this._tagCollection=[],this._selectedTags=[],this._labelCurrentTags=[],this._startDrilldown=!1,this._drillAction="",this._initZooming=!1,this._dimensionIndex=-1,this._selectedMenuItem="",this._pivotEngine=null,this._curFocus=null,this._prevDrillElements=[],this._drillParams=[],this._currentDrillInfo=[],this._selectedSeriesInfo=[],this._waitingPopup=null,this._pivotClientObj=null,this._xTitle=null,this._yTitle=null,this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}}},_load:function(){var a,l;if(this.model.locale=!t.isNullOrUndefined(t.util.getVal(this.locale()))&&e.isFunction(this.locale)?this.locale():"en-US",a={action:"initialize",element:this.element,customObject:this.model.customObject},this._trigger("load",a),this.element.addClass(this.model.cssClass),e(this.element).parents(".e-pivotclient").length>0?(this._pivotClientObj=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+this._pivotClientObj._id+"_maxView")[0]?e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()):(this.element.ejWaitingPopup({showOnInit:!0}),this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.show()),""!=this.model.zooming&&(this._initZooming=!0),null==this.model.dataSource.data&&""!=this.model.url||this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode){if(this.model.operationalMode=t.PivotChart.OperationalMode.ServerMode,""==this.model.url)return void this.renderChartFromJSON("");null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._currentAction,element:this.element,customObject:this.model.customObject}),l=JSON.stringify(this.model.customObject),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initialize",currentReport:this.model.currentReport,customObject:l}),this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?this._generateData:this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initialize"}),this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?this._generateData:this.renderControlSuccess)}else this.model.operationalMode=t.PivotChart.OperationalMode.ClientMode,this.model.analysisMode=""!=this.model.dataSource.cube?t.PivotChart.AnalysisMode.Olap:t.PivotChart.AnalysisMode.Pivot,this.refreshControl()},refreshControl:function(){var i,a,l,r;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if(t.PivotAnalysis.setFieldCaptions(this.model.dataSource),t.isNullOrUndefined(this._pivotClientObj)||(this.model.valueSortSettings=this._pivotClientObj.model.valueSortSettings),i=t.PivotAnalysis.pivotEnginePopulate(this.model),a=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,this._pivotEngine=i.pivotEngine,i.pivotEngine.length>0)if(t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)||this.model.enableMultiLevelLabels)this._generateData(this._pivotEngine);else{for(l=this._cloneEngine(this._pivotEngine),r=0;r<this._labelCurrentTags.expandedMembers.length;r++)this._cropData(l,this._labelCurrentTags.expandedMembers[r],0,!0);this._generateData(l)}else t.isNullOrUndefined(this._waitingPopup)||(t.isNullOrUndefined(a)||(a._isTimeOut=!1),this._waitingPopup.hide());else t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)},_setFirst:!1,_setModel:function(i){var a,l,r=this.element.find("#"+this._id+"Container").data("ejChart");for(a in i)switch(a){case"olapReport":this.setOlapReport(i[a]),this._load();break;case"jsonData":this.setJSONRecords(i[a]),this.element.renderChartFromJSON(i[a]);break;case"refreshPivotChart":this.element.renderChartFromJSON(i[a]);break;case"customObject":this.model.customObject=i[a];break;case"height":this.model.size.height=i[a],r&&r.redraw();break;case"width":this.model.size.width=i[a],r&&r.redraw();break;case"enableDefaultValue":this.model.enableDefaultValue=i[a];break;case"operationalMode":this.model.operationalMode=i[a];break;case"analysisMode":this.model.analysisMode=i[a];break;case"commonSeriesOptions":if(r){for(!t.isNullOrUndefined(t.util.getVal(i[a]).type)&&e.isFunction(t.util.getVal(i[a]).type)?this.seriesType(i[a].type()):t.isNullOrUndefined(i[a].type)||this.seriesType(i[a].type),r.model.commonSeriesOptions=e.extend({},r.model.commonSeriesOptions,i[a]),r.model.type=r.model.commonSeriesOptions.type=this.seriesType(),l=0;l<r.model.series.length;l++)r.model.series[l].type=r.model.type;r.redraw()}break;case"title":r&&(!t.isNullOrUndefined(t.util.getVal(i[a]).text)&&e.isFunction(t.util.getVal(i[a]).text)?this.titleText(i[a].text()):t.isNullOrUndefined(i[a].text)||this.titleText(i[a].text),r.model.title.text=this.titleText(),r.redraw());break;case"animation":this.model.animation=i[a];break;case"crossHair":this.model.crossHair=i[a];break;case"marker":this.model.marker=i[a];break;case"zooming":this.model.zooming=i[a];break;case"legend":this.model.legend=i[a];break;case"primaryXAxis":this.model.primaryXAxis=i[a];break;case"primaryYAxis":this.model.primaryYAxis=i[a];break;case"dataSource":this.model.dataSource=e.extend({},this.model.dataSource,i[a]),this.refreshControl(),this._schemaData&&this._schemaData._load();break;case"locale":this.locale(t.util.getVal(i[a])),this._load();break;case"enableRTL":this.model.enableRTL=i[a],this._load();break;case"isResponsive":this.model.isResponsive=i[a],r&&r.redraw();break;case"enable3D":this.model.enable3D=i[a],r&&r.redraw();break;case"enableContextMenu":this.model.enableContextMenu=i[a],r&&r.redraw();break;case"enableMultiLevelLabels":this.model.enableMultiLevelLabels=i[a],this._load();break;case"rotation":this.model.rotation=i[a],r&&r.redraw();break;default:e.extend(!0,this.model,{},i[a])}r&&this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()})},_keyDownPress:function(e){var i,a,l;13!==e.which||t.isNullOrUndefined(this._curFocus)||this._curFocus.click(),(39===e.which||37===e.which||38===e.which||40===e.which)&&this.element.find(".e-dialog").length>0&&(e.preventDefault(),(i=this.element.find(".e-dialog")).tabindex=-1,i.focus(),a=i.find("li"),39===e.which||40===e.which?(t.isNullOrUndefined(this._curFocus)?this._curFocus=a.eq(0):(this._curFocus.removeClass("e-hoverCell"),l=this._curFocus.next(),this._curFocus=l.length>0?l:a.eq(0)),this._curFocus.addClass("e-hoverCell")):(37===e.which||38===e.which)&&(t.isNullOrUndefined(this._curFocus)?this._curFocus=a.last():(this._curFocus.removeClass("e-hoverCell"),l=this._curFocus.prev(),this._curFocus=l.length>0?l:a.last()),this._curFocus.addClass("e-hoverCell")))},_wireEvents:function(){this._on(e(document),"keydown",this._keyDownPress),!this.model.enableContextMenu||this.element.parents(".e-pivotclient").length>0||this._on(this.element,"contextmenu","#"+this._id+"Container",t.proxy(function(){var i,a,l="<li class='chartTypes'><a>"+this._getLocalizedLabels("ChartTypes")+"</a><ul><li class='e-line'><a>"+this._getLocalizedLabels("Line")+"</a></li><li class='e-spline'><a>"+this._getLocalizedLabels("Spline")+"</a></li><li class='e-column'><a>"+this._getLocalizedLabels("Column")+"</a></li><li class='e-area'><a>"+this._getLocalizedLabels("Area")+"</a></li><li class='e-splinearea'><a>"+this._getLocalizedLabels("SplineArea")+"</a></li><li class='e-stepline'><a>"+this._getLocalizedLabels("StepLine")+"</a></li><li class='e-steparea'><a>Step Area</a></li><li class='e-pie'><a>Pie</a></li><li class='e-bar'><a>Bar</a></li><li class='e-stackingarea'><a>Stacking Area</a></li><li class='e-stackingcolumn'><a>"+this._getLocalizedLabels("StackingColumn")+"</a></li><li class='e-stackingbar'><a>"+this._getLocalizedLabels("StackingBar")+"</a></li><li class='e-funnel'><a>"+this._getLocalizedLabels("Funnel")+"</a></li><li class='e-pyramid'><a>"+this._getLocalizedLabels("Pyramid")+"</a></li><li class='e-doughnut'><a>"+this._getLocalizedLabels("Doughnut")+"</a></li><li class='e-scatter'><a>"+this._getLocalizedLabels("Scatter")+"</a></li><li class='e-bubble'><a>"+this._getLocalizedLabels("Bubble")+"</a></li></ul></li>",r="<li class='chart3DTypes'><a>"+this._getLocalizedLabels("TDCharts")+"</a><ul><li class='e-column'><a>"+this._getLocalizedLabels("ColumnTD")+"</a></li><li class='e-pie'><a>"+this._getLocalizedLabels("PieTD")+"</a></li><li class='e-bar'><a>"+this._getLocalizedLabels("BarTD")+"</a></li><li class='e-stackingbar'><a>"+this._getLocalizedLabels("StackingBarTD")+"</a></li><li class='e-stackingcolumn'><a>"+this._getLocalizedLabels("StackingColumnTD")+"</a></li><li class='e-disable3D'><a>"+this._getLocalizedLabels("DisableTD")+"</a></li></ul></li>",n="<li class='exportTypes'><a>"+this._getLocalizedLabels("Exporting")+"</a><ul><li class='e-excel'><a>"+this._getLocalizedLabels("Excel")+"</a></li><li class='e-word'><a>"+this._getLocalizedLabels("Word")+"</a></li><li class='e-pdf'><a>"+this._getLocalizedLabels("Pdf")+"</a></li><li class='e-png'><a>"+this._getLocalizedLabels("PNG")+"</a></li><li class='e-emf'><a>"+this._getLocalizedLabels("EMF")+"</a></li><li class='e-gif'><a>"+this._getLocalizedLabels("GIF")+"</a></li><li class='e-jpg'><a>"+this._getLocalizedLabels("JPG")+"</a></li><li class='e-bmp'><a>"+this._getLocalizedLabels("BMP")+"</a></li></ul></li>",s="<li class='e-smartLabels'><a>"+this._getLocalizedLabels("SmartLabels")+"</a><ul><li class='e-rotate45'><a>"+this._getLocalizedLabels("Rotate45")+"</a></li><li class='e-rotate90'><a>"+this._getLocalizedLabels("Rotate90")+"</a></li><li class='e-trim'><a>"+this._getLocalizedLabels("Trim")+"</a></li><li class='e-multipleRows'><a>"+this._getLocalizedLabels("MultipleRows")+"</a></li><li class='e-wrap'><a>"+this._getLocalizedLabels("Wrap")+"</a></li><li class='e-hiding'><a>"+this._getLocalizedLabels("Hide")+"</a></li><li class='e-wrapByWord'><a>"+this._getLocalizedLabels("WrapByWord")+"</a></li></ul></li>",o="<li class='e-interaction'><a>"+this._getLocalizedLabels("Interactions")+"</a><ul><li class='e-crossHair'><a>"+this._getLocalizedLabels("CrossHair")+"</a></li><li class='e-trackBall'><a>"+this._getLocalizedLabels("TrackBall")+"</a></li><li class='none'><a>"+this._getLocalizedLabels("None")+"</a></li></ul></li>",d=t.buildTag("ul#"+this._id+"_ContextMenu",t.buildTag("li.e-toolTip",t.buildTag("a",this._getLocalizedLabels("Tooltip"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-legend",t.buildTag("a",this._getLocalizedLabels("Legend"))[0].outerHTML)[0].outerHTML+(this.model.enable3D?"":t.buildTag("li.e-zooming",t.buildTag("a",this._getLocalizedLabels("Zooming"))[0].outerHTML)[0].outerHTML)+l+r+n+(this.model.enable3D?"":o+s))[0].outerHTML;e("#"+this._id).append(d),i=this.element.find("#"+this._id+"Container"),this.element.find("#"+this._id+"_ContextMenu").ejMenu({width:"150px",menuType:t.MenuType.ContextMenu,contextMenuTarget:i,enableRTL:this.model.enableRTL,click:t.proxy(this._contextMenuClick,this)}),a=t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label",this._getLocalizedLabels("EnabledState"))[0].outerHTML,this.model.enable3D?e("#"+this._id+"_ContextMenu").find(".chart3DTypes ."+this.model.commonSeriesOptions.type+" a:eq(0)").append(a):e("#"+this._id+"_ContextMenu").find(".chartTypes ."+this.model.commonSeriesOptions.type+" a:eq(0)").append(a),this.model.commonSeriesOptions.tooltip.visible&&e("#"+this._id+"_ContextMenu").find(".e-toolTip a:eq(0)").append(a),this.model.zooming.enable&&e("#"+this._id+"_ContextMenu").find(".e-zooming a:eq(0)").append(a),this.model.legend.visible&&e("#"+this._id+"_ContextMenu").find(".e-legend a:eq(0)").append(a),"none"!=this.model.primaryXAxis.labelIntersectAction&&(e("#"+this._id+"_ContextMenu").find(".e-smartLabels a:eq(0)").append(a),e("#"+this._id+"_ContextMenu").find(".e-smartLabels ."+this.model.primaryXAxis.labelIntersectAction+" a:eq(0)").append(a),"hide"==this.model.primaryXAxis.labelIntersectAction&&e("#"+this._id+"_ContextMenu").find(".e-smartLabels .e-hiding a:eq(0)").append(a)),"crosshair"==this.model.crosshair.type&&this.model.crosshair.visible&&(e("#"+this._id+"_ContextMenu").find(".e-interaction a:eq(0)").append(a),e("#"+this._id+"_ContextMenu").find(".e-interaction .e-crossHair a:eq(0)").append(a),this.mode.enable3D||e("#"+this._id+"_ContextMenu").ejMenu("disableItem",this._getLocalizedLabels("Tooltip"))),"trackBall"==this.model.crosshair.type&&this.model.crosshair.visible&&(e("#"+this._id+"_ContextMenu").find(".e-interaction a:eq(0)").append(a),e("#"+this._id+"_ContextMenu").find(".e-interaction .e-trackBall a:eq(0)").append(a),this.mode.enable3D||e("#"+this._id+"_ContextMenu").ejMenu("disableItem",this._getLocalizedLabels("Tooltip"))),this.model.crosshair.visible||e("#"+this._id+"_ContextMenu").find(".e-interaction .none a:eq(0)").append(a)})),this._on(this.element,"click",".e-menuList.exp, .e-menuList.clp, .e-menuList.exit",this._seriesContextClick),t.isNullOrUndefined(this._pivotClientObj)&&e(window).on("resize",e.proxy(this._reSizeHandler,this)),this._on(this.element,"click",".e-chart3DImg",function(i){var a=this;a._createDialog(i),e(".e-chart3DTypesIcon").click(function(e){a._contextMenuClick(e),t.isNullOrUndefined(this._pivotClientObj)||(a._pivotClientObj._unWireEvents(),a._pivotClientObj._wireEvents())})}),this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(this._on(this.element,"click",".e-toolTipImg",function(){this.model.commonSeriesOptions.tooltip.visible=!this.model.commonSeriesOptions.tooltip.visible,this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()}),this.model.commonSeriesOptions.tooltip.visible?this.element.find(".e-toolTipImg").addClass("e-enabled"):this.element.find(".e-toolTipImg").removeClass("e-enabled")}),this._on(this.element,"click",".e-exportImg",function(t){var i=this;i._createDialog(t),e(".e-exportTypesIcon").click(function(e){i._contextMenuClick(e)})}),this._on(this.element,"click",".e-smartLabels",function(t){var i=this;i._createDialog(t),e(".e-smartLabelsIcon").click(function(e){i._contextMenuClick(e)})}),this._on(this.element,"click",".e-interaction",function(t){var i=this;i._createDialog(t),e(".e-interactionsIcon").click(function(e){i._contextMenuClick(e)})}),this._on(this.element,"click",".e-icon-xAxis-title",function(){this.element.find(".e-icon-xAxis-title").hasClass("e-enabled")?(this.element.find(".e-icon-xAxis-title").removeClass("e-enabled"),this.model.primaryXAxis.title.enable=!1):(this.element.find(".e-icon-xAxis-title").addClass("e-enabled"),this.model.primaryXAxis.title.enable=!0),this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()})}),this._on(this.element,"click",".e-icon-yAxis-title",function(){this.element.find(".e-icon-yAxis-title").hasClass("e-enabled")?(this.element.find(".e-icon-yAxis-title").removeClass("e-enabled"),this.model.primaryYAxis.title.enable=!1):(this.element.find(".e-icon-yAxis-title").addClass("e-enabled"),this.model.primaryYAxis.title.enable=!0),this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()})}),this._on(this.element,"click",".e-legend",function(e){this._contextMenuClick(e)}),this._on(this.element,"click",".e-zooming",function(e){this._contextMenuClick(e)}))},_unWireEvents:function(){this._off(e(document),"keydown",this._keyDownPress),e(document.body).off("click"),this._off(this.element,"click",".e-menuList.exp, .e-menuList.clp, .e-menuList.exit",this._seriesContextClick),e(window).off("resize",e.proxy(this._reSizeHandler,this)),this._off(this.element,"contextmenu"),this._off(this.element,"click",".e-chartTypesImg"),this._off(this.element,"click",".e-toolTipImg"),this._off(this.element,"click",".e-chart3DImg"),this._off(this.element,"click",".e-exportImg"),this._off(this.element,"click",".e-legend"),this._off(this.element,"click",".e-zooming"),this._off(this.element,"click",".e-smartLabels"),this._off(this.element,"click",".e-interaction"),this._off(this.element,"click",".e-icon-xAxis-title"),this._off(this.element,"click",".e-icon-yAxis-title")},_seriesContextClick:function(a){var l,r,n,s,o,d;if(this._curFocus=null,-1==a.target.innerHTML.indexOf(this._getLocalizedLabels("Expand"))&&-1==a.target.innerHTML.indexOf(this._getLocalizedLabels("Collapse"))&&-1==a.target.innerHTML.indexOf(this._getLocalizedLabels("Exit")))return!1;if(a.target.innerHTML==this._getLocalizedLabels("Exit"))this.element.find("#"+this._id+"ExpandMenu, .e-expandMenu, .e-dialog").remove();else if(a.target.innerHTML.indexOf(this._getLocalizedLabels("Expand"))>-1)if(this._drillAction="drilldown",e(this.element).parents(".e-pivotclient").length>0?(s=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+s._id+"_maxView")[0]?e("#"+s._id+"_maxView").ejWaitingPopup({showOnInit:!0}):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode)u=this.model.enableRTL?a.target.innerHTML.split(" - ")[0]:a.target.innerHTML.split(" - ")[1],this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?this._getChartDrillDown("",u,a):(this._labelCurrentTags.collapsedMembers=e.grep(this._labelCurrentTags.collapsedMembers,function(e){return e!=u}),l=e(this.getJSONRecords().seriesTags).filter(function(e,t){return t.split("::")[2]==u})[0],r=t.olap._mdxParser._splitCellInfo(l),this._getChartDrillDown(l,r,a));else if(n=JSON.stringify(this.model.customObject),this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot)u=this.model.enableRTL?a.target.innerHTML.split(" - ")[0]:a.target.innerHTML.split(" - ")[1],this._selectedItem=u,t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&(this._labelCurrentTags.expandedMembers=[]),this._labelCurrentTags.expandedMembers.push(u),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers)+(t.isNullOrUndefined(this._pivotClientObj)?"":"-##-"+JSON.stringify(this._pivotClientObj.model.valueSortSettings)),customObject:n,currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers),currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess);else{d=this,this._isDrilled||(this._isDrilled=!0,jQuery.each(a.target.parentElement.children,function(e,t){t.innerHTML==a.target.innerHTML&&(d._dimensionIndex=e)}));try{o=JSON.parse(this.getOlapReport()).Report}catch(e){o=this.getOlapReport()}this._drillAction="drilldown",this._selectedItem=this.model.enableRTL?e.trim(a.target.innerHTML.replace(" - "+this._getLocalizedLabels("Expand"),"")):e.trim(a.target.innerHTML.replace(this._getLocalizedLabels("Expand")+" - ","")),jQuery.each(this._labelCurrentTags,function(e,t){if(t.name==d._selectedItem)return d._tagCollection=[],d._tagCollection=d._selectedTags.slice(),d._selectedTagInfo=t.tag,d._selectedMenuItem=t.name,!1}),this._startDrilldown=!0,null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:o,customObject:n}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:o,clientReports:this._pivotClientObj.reports,customObject:n}),this.renderControlSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:o}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:o,clientReports:this._pivotClientObj.reports}),this.renderControlSuccess)}else if(this._drillAction="drillup",e(this.element).parents(".e-pivotclient").length>0?(s=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+s._id+"_maxView")[0]?e("#"+s._id+"_maxView").ejWaitingPopup({showOnInit:!0}):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode)u=this.model.enableRTL?a.target.innerHTML.split(" - ")[0]:a.target.innerHTML.split(" - ")[1],this._getChartDrillDown("",u,a);else if(n=JSON.stringify(this.model.customObject),this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){var u=this.model.enableRTL?a.target.innerHTML.split(" - ")[0]:a.target.innerHTML.split(" - ")[1],c=!1,p=[];jQuery.map(this._labelCurrentTags.expandedMembers,function(e){e==u&&(c=!0),c||p.push(e)}),this._selectedItem=u,this._labelCurrentTags.expandedMembers=p,this._currentDrillInfo=e.extend([],this._labelCurrentTags.expandedMembers,!0).concat([u]),e(this.element).parents(".e-pivotclient").length>0&&(this._labelCurrentTags.expandedMembers=[],(s=e(this.element).parents(".e-pivotclient").data("ejPivotClient"))._drillParams.length>0&&(s._drillParams=e.grep(s._drillParams,function(e){return e.indexOf(u)<0}),s._getDrilledMember())),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers)+(t.isNullOrUndefined(this._pivotClientObj)?"":"-##-"+JSON.stringify(this._pivotClientObj.model.valueSortSettings)),customObject:n,currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers),currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess)}else{try{o=JSON.parse(this.getOlapReport()).Report}catch(e){o=this.getOlapReport()}this._drillAction="drillup",this._selectedItem=this.model.enableRTL?e.trim(a.target.innerHTML.replace(" - "+this._getLocalizedLabels("Collapse"),"")):e.trim(a.target.innerHTML.replace(this._getLocalizedLabels("Collapse")+" - ","")),this._tagCollection=[],this._tagCollection=this._selectedTags.slice(),d=this,jQuery.each(this._tagCollection,function(e,t){if(t.name==d._selectedItem)return d._selectedIndex=e,d._selectedTagInfo=t.tag,d._tagCollection.splice(e,d._tagCollection.length),!1}),0==this._tagCollection.length&&(this._isDrilled=!1),this._startDrilldown=!0,null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:o,customObject:n}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:o,clientReports:this._pivotClientObj.reports,customObject:n}),this.renderControlSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:o}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:o,clientReports:reports}),this.renderControlSuccess)}},_createDialog:function(a){var l,r,n,s,o=this;e(a.target).hasClass("e-exportImg")?(l=t.buildTag("div.e-exportTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-excel e-exportTypesIcon").attr({title:this._getLocalizedLabels("Excel"),"aria-label":this._getLocalizedLabels("Excel"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-word e-exportTypesIcon").attr({title:this._getLocalizedLabels("Word"),"aria-label":this._getLocalizedLabels("Word"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pdf e-exportTypesIcon").attr({title:this._getLocalizedLabels("Pdf"),"aria-label":this._getLocalizedLabels("Pdf"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-png e-exportTypesIcon").attr({title:this._getLocalizedLabels("PNG"),"aria-label":this._getLocalizedLabels("PNG"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-emf e-exportTypesIcon").attr({title:this._getLocalizedLabels("EMF"),"aria-label":this._getLocalizedLabels("EMF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-gif e-exportTypesIcon").attr({title:this._getLocalizedLabels("GIF"),"aria-label":this._getLocalizedLabels("GIF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-jpg e-exportTypesIcon").attr({title:this._getLocalizedLabels("JPG"),"aria-label":this._getLocalizedLabels("JPG"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-bmp e-exportTypesIcon").attr({title:this._getLocalizedLabels("BMF"),"aria-label":this._getLocalizedLabels("BMF"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-exportTypesDialog").length&&(e(l).appendTo(this.element),e(l).css("left",a.target.offsetLeft+20+"px").css("top",a.target.offsetTop+15+"px"),this.model.enableRTL&&e(l).addClass("e-rtl"))):e(a.target).hasClass("e-chart3DImg")?(r=t.buildTag("div.e-chart3DTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-column3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("ColumnTD"),"aria-label":this._getLocalizedLabels("ColumnTD"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pie3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("PieTD"),"aria-label":this._getLocalizedLabels("PieTD"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-bar3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("BarTD"),"aria-label":this._getLocalizedLabels("BarTD"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-stackingbar3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("StackingBarTD"),"aria-label":this._getLocalizedLabels("StackingBarTD"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-stackingcolumn3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("StackingColumnTD"),"aria-label":this._getLocalizedLabels("StackingColumnTD"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-disable3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("DisableTD"),"aria-label":this._getLocalizedLabels("DisableTD"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-chart3DTypesDialog").length&&(e(r).appendTo(this.element),e(r).css("left",a.target.offsetLeft+20+"px").css("top",a.target.offsetTop+15+"px"),o.model.enable3D&&e("."+this.model.type+"3D").addClass("e-enabled"),this.model.enableRTL&&e(r).addClass("e-rtl"))):e(a.target).hasClass("e-smartLabels")?(n=t.buildTag("div.e-smartLabelsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rotate45 e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Rotate45"),"aria-label":this._getLocalizedLabels("Rotate45"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-rotate90 e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Rotate90"),"aria-label":this._getLocalizedLabels("Rotate90"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-trim e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Trim"),"aria-label":this._getLocalizedLabels("Trim"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-multipleRows e-smartLabelsIcon").attr({title:this._getLocalizedLabels("MultipleRows"),"aria-label":this._getLocalizedLabels("MultipleRows"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-wrap e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Wrap"),"aria-label":this._getLocalizedLabels("Wrap"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-hiding e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Hide"),"aria-label":this._getLocalizedLabels("Hide"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-wrapByWord smartLabelsIcon").attr({title:this._getLocalizedLabels("WrapByWord"),"aria-label":this._getLocalizedLabels("WrapByWord"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-smartLabelsDialog").length&&(e(n).appendTo(this.element),e(n).css("left",a.target.offsetLeft+20+"px").css("top",a.target.offsetTop+15+"px"),"none"!=o.model.primaryXAxis.labelIntersectAction&&"hide"!=o.model.primaryXAxis.labelIntersectAction&&o.model.primaryXAxis.labelIntersectAction!=i&&e("."+o.model.primaryXAxis.labelIntersectAction).addClass("e-enabled"),"hide"==o.model.primaryXAxis.labelIntersectAction&&e(".e-hiding").addClass("e-enabled"),this.model.enableRTL&&e(n).addClass("e-rtl"))):e(a.target).hasClass("e-interaction")&&(s=t.buildTag("div.e-interactionsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-crossHair e-interactionsIcon").attr({title:this._getLocalizedLabels("CrossHair"),"aria-label":this._getLocalizedLabels("CrossHair"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-trackBall e-interactionsIcon").attr({title:this._getLocalizedLabels("TrackBall"),"aria-label":this._getLocalizedLabels("TrackBall"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.none e-interactionsIcon").attr({title:this._getLocalizedLabels("None"),"aria-label":this._getLocalizedLabels("None"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-interactionsDialog").length&&(e(s).appendTo(this.element),e(s).css("left",a.target.offsetLeft+20+"px").css("top",a.target.offsetTop+15+"px"),"crosshair"==this.model.crosshair.type&&this.model.crosshair.visible&&this.element.find(".e-crossHair").addClass("e-enabled"),"trackBall"==this.model.crosshair.type&&this.model.crosshair.visible&&this.element.find(".e-trackBall").addClass("e-enabled"),this.model.crosshair.visible||this.element.find(".none").addClass("e-enabled"),this.model.enableRTL&&e(s).addClass("e-rtl")))},_contextMenuClick:function(i){chrtObj=e("#"+this._id).data("ejPivotChart");var a=e(this.element).parents(".e-pivotclient").length>0?e(i.target).attr("class").split(" ")[0]:e(i.element).attr("class").split(" ")[0];if(e(i.element).parents().hasClass("chartTypes"))chrtObj.model.enable3D=!1,chrtObj.model.type=chrtObj.model.commonSeriesOptions.type=!t.isNullOrUndefined(a)&&a.split("-").length>1?a.split("-")[1]:a,"funnel"==chrtObj.model.type&&(chrtObj.model.commonSeriesOptions.marker={dataLabel:{visible:!0,shape:"none",font:{color:"white",size:"12px",fontWeight:"lighter"}}}),("pie"==chrtObj.model.type||"doughnut"==chrtObj.model.type)&&(chrtObj.model.commonSeriesOptions.explode=!0),chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).hasClass("e-toolTip"))chrtObj.model.commonSeriesOptions.tooltip.visible=!chrtObj.model.commonSeriesOptions.tooltip.visible,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).hasClass("e-legend")||e(i.target).hasClass("e-legend"))chrtObj.model.legend.visible=!chrtObj.model.legend.visible,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).hasClass("e-zooming")||e(i.target).hasClass("e-zooming"))chrtObj.model.zooming.enable=!chrtObj.model.zooming.enable,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).parents().hasClass("e-smartLabels")||e(i.target).hasClass("e-smartLabelsIcon"))chrtObj.model.primaryXAxis.labelIntersectAction="e-hiding"==a?"hide":!t.isNullOrUndefined(a)&&a.split("-").length>1?a.split("-")[1]:a,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).parents().hasClass("e-interaction")||e(i.target).hasClass("e-interactionsIcon"))"e-crossHair"==a&&(chrtObj.model.crosshair.type=t.datavisualization.Chart.CrosshairType.Crosshair,chrtObj.model.crosshair.visible=!0),"e-trackBall"==a&&(chrtObj.model.crosshair.type=t.datavisualization.Chart.CrosshairType.TrackBall,chrtObj.model.crosshair.visible=!0),"none"==a&&(chrtObj.model.crosshair.visible=!1),chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).parents().hasClass("chart3DTypes")||e(i.target).hasClass("e-chart3DTypesIcon"))chrtObj.model.enable3D=!0,"e-disable3D"!=a&&(a=a.split("3")[0]),"e-disable3D"==a&&(chrtObj.model.enable3D=!1,a=chrtObj.model.commonSeriesOptions.type),chrtObj.model.type=chrtObj.model.commonSeriesOptions.type=!t.isNullOrUndefined(a)&&a.split("-").length>1?a.split("-")[1]:a,"e-pie"==a&&(chrtObj.model.rotation=24),chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else switch(e(this.element).parents(".e-pivotclient").length>0&&!t.isNullOrUndefined(this._pivotClientObj)&&(this.model.beforeExport=this._pivotClientObj.model.beforeExport),a=!t.isNullOrUndefined(a)&&a.split("-").length>1?a.split("-")[1]:a){case"excel":case"word":case"pdf":chrtObj.exportPivotChart(a,"Sample");break;case"png":chrtObj.exportPivotChart(a,"Sample",t.PivotChart.ExportOptions.PNG);break;case"emf":chrtObj.exportPivotChart(a,"Sample",t.PivotChart.ExportOptions.EMF);break;case"gif":chrtObj.exportPivotChart(a,"Sample",t.PivotChart.ExportOptions.GIF);break;case"jpg":chrtObj.exportPivotChart(a,"Sample",t.PivotChart.ExportOptions.JPG);break;case"bmp":chrtObj.exportPivotChart(a,"Sample",t.PivotChart.ExportOptions.BMP)}},generateJSON:function(e,i){var a,l,r;if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&this._labelCurrentTags.expandedMembers.length>0&&!this.model.enableMultiLevelLabels)for(a=0,l=0;l<this._labelCurrentTags.expandedMembers.length;l++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[l])&&this._labelCurrentTags.expandedMembers[l].length>0)for(l>0&&!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[l-1])&&this._labelCurrentTags.expandedMembers[l-1].length>0&&this._cropData(i,this._selectedSeriesInfo[l-1].split("::")[2],l-1+a,!1),r=0;r<this._labelCurrentTags.expandedMembers[l].length;r++)this._cropData(i,this._labelCurrentTags.expandedMembers[l][r].split("::")[2],l+a,!0),a++;this._generateData(i)},_jsonToEngine:function(e){for(var i,a=JSON.parse(e),l=[],r=0;r<a.length;r++)i=parseInt(a[r].Index.split(",")[0]),t.isNullOrUndefined(l[i])?(l[i]=[],l[i].push(a[r])):l[i].push(a[r]);return l},_generateData:function(a){var l,r,n,s,o,d,u,c,p,m,h,g,f,_,b,v,C={};if(!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj._isExporting&&(C=e.extend(!0,{},{pivotEngine:this._pivotEngine,labelCurrentTags:this._labelCurrentTags,drillParams:this._drillParams})),!1,a[2]!=i?"Olap"==a[2].Value||"Olap"==a[2]:a.d!=i?!t.isNullOrUndefined(a.d[2])&&"Olap"==a.d[2].Value:"Olap"==a.AnalysisMode)this.renderControlSuccess(a);else{var S={seriesNames:[],chartLables:[],labelTags:[],multiLevelLabels:[],multiLevelLabelTags:[],seriesTags:[],points_Y:[],labelFormat:[],measureNames:""},O="",x=[];if(this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&(l={},a[0]!=i?(e(this.element).parents(".e-pivotclient").length>0?l.JsonRecords=t.isNullOrUndefined(a[0].Value)?a[0]:a[0].Value:(l.JsonRecords={},l.JsonRecords.ChartJSON=t.isNullOrUndefined(a[0].Value)?a[0]:a[0].Value,l.JsonRecords.GridJSON=t.isNullOrUndefined(a[3].Value)?a[3]:a[3].Value),l.PivotReport=t.isNullOrUndefined(a[1].Value)?a[1]:a[1].Value,a=l):a.d!=i&&(e(this.element).parents(".e-pivotclient").length>0?t.isNullOrUndefined(a.d[0])||(r=a.d[0].Key,l.JsonRecords="JsonRecords"==r?a.d[0].Value:[]):(l.JsonRecords={},l.JsonRecords.ChartJSON=t.isNullOrUndefined(a.d[0])||"JsonRecords"!=a.d[0].Key?[]:a.d[0].Value,l.JsonRecords.GridJSON=t.isNullOrUndefined(a.d[3])||"GridJSON"!=a.d[3].Key?[]:a.d[3].Value),l.PivotReport=t.isNullOrUndefined(a.d[1])||"PivotReport"!=a.d[1].Key&&"OlapReport"!=a.d[1].Key?[]:a.d[1].Value,a=l),O=a.PivotReport||a.OlapReport,a=t.isNullOrUndefined(a.JsonRecords.GridJSON)?t.isNullOrUndefined(a.GridJSON)?a.JsonRecords:this._jsonToEngine(a.GridJSON):this._jsonToEngine(a.JsonRecords.GridJSON),this._pivotEngine=a,x=t.isNullOrUndefined(JSON.parse(O).values)?JSON.parse(O).PivotCalculations:JSON.parse(JSON.parse(O).values),S.labelFormat=e.map(x,function(e){return e.Format.toLowerCase()})),(n=a.length)>0&&a[0].length>0){var y=a[0].length,P=[],N=[];for(s=this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)||this.model.enableMultiLevelLabels?this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?a[0][0].ColSpan:this.model.dataSource.rows.length:this.model.dataSource.rows.length-this._labelCurrentTags.expandedMembers.length:a[0][0].ColSpan,this.model.enableMultiLevelLabels&&(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode||this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)?o=a[0][0].RowSpan:(o=this.model.dataSource.columns.length,this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?o+=this.model.dataSource.values.length>0?1:0:o=a[0][0].RowSpan),d="",v=s;v<n;v++){for(u="",j=!1,_=0;_<o;_++)if(!t.isNullOrUndefined(a[v][_])){if(a[v][_].CSS.indexOf("summary")>=0){j=!0,P.push(v);break}a[v][_].Info.indexOf("Measure")>=0&&d.indexOf(a[v][_].Value)<0&&(d+=""==d?a[v][_].Value:"~~"+a[v][_].Value),u+=(""==u?"":""==a[v][_].Value?"":"~~")+a[v][_].Value}j||""==u||S.seriesNames.push(u)}for(v=o;v<y;v++)if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){if(this.model.enableMultiLevelLabels&&s>1){this._drillParams=""!=this._drillAction?this._drillParams:[];var M=e.extend(!0,[],this._drillParams.sort()),T=M.length>0?-1:0,L="";for(v=o;v<y;v++)for(c=M[0],p="",_=0;_<s;_++)p+=""==p?a[_][v].Value:">#>"+a[_][v].Value,(-1==T||""==L||p==M[1])&&(p==c||p==M[1])&&(p==M[1]&&(c=M[1],M.splice(0,1)),T=_+1,L=p),!t.isNullOrUndefined(c)&&T>0&&T==s-1&&_==s-1?(N.push(v),S.chartLables.push(c.split(">#>").join("~~")+"~~"+a[_][v].Value)):!t.isNullOrUndefined(c)&&T>0&&T==_&&a[_][v].CSS.indexOf("summary")>-1?(N.push(v),S.chartLables.push(c.split(">#>").join("~~")+"~~"+a[_][v].Value.split(" Total")[0])):T-1==_&&a[_][v].CSS.indexOf("summary")>-1?(""!=L&&(M[0]=M[0].split(">#>").slice(0,M[0].split(">#>").length-1).join(">#>"),""==M[0]&&(M.splice(0,1),L="")),T-=1):(0==T||""==L)&&0==_&&a[0][v].CSS.indexOf("summary")>-1&&(t.isNullOrUndefined(c)||c.split(">#>")[0]!=a[0][v].Value.split(" Total")[0])&&"Grand Total"!=a[_][v].Value&&(N.push(v),S.chartLables.push(a[_][v].Value.split(" Total")[0]))}else s>1?"summary rstot"==a[0][v].CSS&&"Grand Total"!=a[0][v].Value&&S.chartLables.push(a[0][v].Value.replace(" Total","")):"rowheader"==a[0][v].CSS&&S.chartLables.push(a[0][v].Value);this.model.enableMultiLevelLabels&&(S.multiLevelLabels=e.extend(!0,[],S.chartLables))}else if(t.isNullOrUndefined(this._labelCurrentTags.collapsedMembers)&&(this._labelCurrentTags.collapsedMembers=[]),s>1){var w="",j=!1,D="";for(_=0;_<s;_++)if("rowheader"==a[_][v].CSS)w+=""==w?a[_][v].Value:(""!=a[_][v].Info&&""!=a[_-1][v].Info&&a[_][v].Info.split("::")[3]==a[_-1][v].Info.split("::")[0]?"#":"~~")+a[_][v].Value,-1==a[_][v].Info.indexOf("[Measures]")&&(D+=""==D?a[_][v].Info:(""!=a[_][v].Info&&""!=a[_-1][v].Info&&a[_][v].Info.split("::")[3]==a[_-1][v].Info.split("::")[0]?"#":"~~")+a[_][v].Info),e.inArray(a[_][v].Value,this._labelCurrentTags.collapsedMembers)<0&&2==a[_][v].State&&this._labelCurrentTags.collapsedMembers.push(a[_][v].Value),e.inArray(a[_][v].Info,S.seriesTags)<0&&-1==a[_][v].Info.indexOf("[Measures]")&&S.seriesTags.push(a[_][v].Info);else if((!this.model.enableMultiLevelLabels||""==w||a[_][v].CSS.indexOf("summary")>=0)&&(this.model.enableMultiLevelLabels||-1==a[_][v].CSS.indexOf("none")&&-1==a[_][v].CSS.indexOf("value"))){j=!0,N.push(v);break}j||(S.chartLables.push(w),S.labelTags.push(D))}else"rowheader"==a[0][v].CSS&&(S.chartLables.push(a[0][v].Value),S.labelTags.push(a[0][v].Info),S.seriesTags.push(a[0][v].Info)),2==a[0][v].State&&this._labelCurrentTags.collapsedMembers.push(a[0][v].Value);if(this.model.enableMultiLevelLabels)if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){for(m=0,_=0;_<S.multiLevelLabels.length;_++)S.multiLevelLabels[_]=e.map(S.multiLevelLabels[_].split("~~"),function(e){return e+"#1"}).join("~~"),m=S.multiLevelLabels[_].split("~~").length>m?S.multiLevelLabels[_].split("~~").length:m;for(h=0;h<S.multiLevelLabels.length;h++)if(m>1&&S.multiLevelLabels[h].split("~~").length<m){g=S.multiLevelLabels[h].split("~~")[S.multiLevelLabels[h].split("~~").length-1].split("#1")[0];do{S.multiLevelLabels[h]+="~~"+g+"#0"}while(S.multiLevelLabels[h].split("~~").length<m)}}else for(v=o;v<y;v++)if(s>1){w="",D="",j=!1;for(_=0;_<s;_++)if("rowheader"==a[_][v].CSS)w+=""==w?a[_][v].Value+"#"+a[_][v].Expander:"~~"+a[_][v].Value+"#"+a[_][v].Expander,D+=""==D?a[_][v].Info+"::"+a[_][v].State:"~~"+a[_][v].Info+"::"+a[_][v].State;else if(a[_][v].CSS.indexOf("none")>=0&&""!=w)w+="~~"+w.split("~~")[w.split("~~").length-1].split("#")[0]+"#"+a[_][v].Expander,D+="~~"+D.split("~~")[D.split("~~").length-1];else if(""==w||a[_][v].CSS.indexOf("summary")>=0||a[_][v].CSS.indexOf("value")>=0){j=a[_][v].CSS.indexOf("summary")>=0;break}j||""==w||(S.multiLevelLabels.push(w),S.multiLevelLabelTags.push(D))}else"rowheader"==a[0][v].CSS&&(S.multiLevelLabels.push(a[0][v].Value+"#"+a[0][v].Expander),S.multiLevelLabelTags.push(a[0][v].Info+"::"+a[0][v].State));for(v=o;v<y;v++)if(f=[],s>1){if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){if(this.model.enableMultiLevelLabels){if(e.inArray(v,N)>-1){for(_=s;_<n;_++)e.inArray(_,P)<0&&f.push(a[_][v].Value);S.points_Y.push(f)}}else if("summary rstot"==a[0][v].CSS&&"Grand Total"!=a[0][v].Value){for(_=s;_<n;_++)e.inArray(_,P)<0&&f.push(a[_][v].Value);S.points_Y.push(f)}}else if(e.inArray(v,N)<0){for(_=s;_<n;_++)e.inArray(_,P)<0&&a[_][v].CSS.indexOf("value")>-1&&(f.push(""==a[_][v].Value?0:t.parseFloat(a[_][v].ActualValue)),t.isNullOrUndefined(a[_][v].Format)||(S.labelFormat=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?S.labelFormat.length>0?S.labelFormat==a[_][v].Format?a[_][v].Format:S.labelFormat+"_"+a[_][v].Format:a[_][v].Format:"Number"));S.points_Y.push(f)}}else if("rowheader"==a[0][v].CSS){for(_=a[0][0].ColSpan;_<n;_++)e.inArray(_,P)<0&&(f.push(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?""==a[_][v].Value?0:t.parseFloat(a[_][v].ActualValue):a[_][v].Value),t.isNullOrUndefined(a[_][v].Format)||(S.labelFormat=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?S.labelFormat.length>0?S.labelFormat==a[_][v].Format?a[_][v].Format:S.labelFormat+"_"+a[_][v].Format:a[_][v].Format:"Number"));S.points_Y.push(f)}}if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)S.measureNames=d;else for(b=this.model.enableMultiLevelLabels&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?e(x).map(function(e,t){return t.FieldHeader}):e(this.model.dataSource.values).map(function(e,t){return t.fieldCaption}),v=0;v<b.length;v++)S.measureNames+=""==S.measureNames?b[v]:"~"+b[v];if(this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode)this.renderControlSuccess({JsonRecords:JSON.stringify(S),OlapReport:O});else{if(!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj._isExporting)return C=e.extend(!0,{},{pivotEngine:this._pivotEngine,labelCurrentTags:this._labelCurrentTags,drillParams:this._drillParams}),this._pivotEngine=C.pivotEngine,this._labelCurrentTags=C.labelCurrentTags,this._drillParams=C.drillParams,this._getChartSeries(S);this.renderControlSuccess({JsonRecords:JSON.stringify(S),OlapReport:JSON.stringify(this.model.dataSource)})}S={}}},_cloneEngine:function(t){for(var i=e.extend(!0,[],t),a=0;a<t.length;a++)i[a]=e.extend(!0,[],t[a]);return i},_cropData:function(e,i,a,l){var r,n,s,o=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?e[0][0].RowSpan:this.model.dataSource.columns.length+(0==this.model.dataSource.values.length||"rows"==this.model.dataSource.values[0].axis?0:1);if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap){r=a;do{for(n=!1,s=0;s<e[a].length;){if(e[a][s].Value==i){n=!0;break}s++}if(n)break;a=a==r?e[0][0].ColSpan:a,r="",a--}while(!n&&a>-1)}for(a=-1==a?0:a;o<e[a].length;)if(e[a][o].Value!=i)for(s=0;s<e.length;s++)e[s].splice(o,1);else o+=e[a][o].RowSpan;this.model.analysisMode!=t.PivotChart.AnalysisMode.Olap&&l&&e.splice(a,1)},refreshPagedPivotChart:function(e,i){if("undefined"!=typeof ochartWaitingPopup&&null!=ochartWaitingPopup&&ochartWaitingPopup.show(),e=-1!=e.indexOf("categ")?"categorical":"series",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.dataSource.providerName==t.olap.Providers.Mondrian)"categorical"==e?this._categCurrentPage=parseInt(i):this._seriesCurrentPage=parseInt(i),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else{var a;try{a=JSON.parse(this.getOlapReport())}catch(e){a=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:e+":"+i,currentReport:a,customObject:JSON.stringify(this.model.customObject)}),this.renderControlSuccess)}},_updatePageSettings:function(t,i){var a=e.map(t,function(e){if("PageSettings"==e.Key)return e}),l=e.map(t,function(e){if("HeaderCounts"==e.Key)return e});a.length>0&&null!=i._pagerObj&&(i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(JSON.parse(l[0].Value),JSON.parse(a[0].Value)))},_setTitleText:function(i,a){var l,r,n,s,o,d,u;this._xTitle=t.isNullOrUndefined(this._xTitle)?t.isNullOrUndefined(this.model.primaryXAxis.title.text)||this.model.primaryXAxis.title.enable?this._xTitle:this.model.primaryXAxis.title.text:this._xTitle,this._yTitle=t.isNullOrUndefined(this._yTitle)?t.isNullOrUndefined(this.model.primaryYAxis.title.text)||this.model.primaryYAxis.title.enable?this._yTitle:this.model.primaryYAxis.title.text:this._yTitle;var c,p="",m="";if(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(l=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this.getOlapReport()).PivotRows:this.model.dataSource.rows,r=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(l=JSON.parse(this.getOlapReport()).PivotRows,r=JSON.parse(this.getOlapReport()).PivotColumns,c="FieldName"):(l=this.model.dataSource.rows,r=this.model.dataSource.columns,c="fieldCaption"),!t.isNullOrUndefined(l))for(d=0;d<l.length;d++)p+=(""==p?"":"~")+l[d][c];if(!t.isNullOrUndefined(r))for(u=0;u<r.length;u++)m+=(""==m?"":"~")+r[u][c];if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)for(n=0;n<this.model.dataSource.values[0].measures.length;n++)"rows"==this.model.dataSource.values[0].axis?p+=(""==p?"":"~")+this.model.dataSource.values[0].measures[n].fieldCaption:m+=(""==m?"":"~")+this.model.dataSource.values[0].measures[n].fieldCaption}else{for(s=i.split("><")[0].split("||"),o=i.split("><")[1].split("||"),d=0;d<s.length;d++)p+=(""==p?"":"~")+a.element.find(".e-cubeTreeView").find("li[data-tag='"+s[d]+"'] a:eq(0)").text();for(u=0;u<o.length;u++)m+=(""==m?"":"~")+a.element.find(".e-cubeTreeView").find("li[data-tag='"+o[u]+"'] a:eq(0)").text()}this.model.primaryXAxis.title=this.model.primaryXAxis.title.enable?e.extend({},{enable:!0,enableTrim:!0,text:p}):e.extend({},{enable:!1,enableTrim:!0,text:p}),this.model.primaryYAxis.title=this.model.primaryYAxis.title.enable?e.extend({},{enable:!0,enableTrim:!0,text:m}):e.extend({},{enable:!1,enableTrim:!0,text:m})},renderControlSuccess:function(a){var l,r,n,s,o,d,u,c,p,m,h,g,f;t.isNullOrUndefined(this._pivotClientObj)||this.model.operationalMode!=t.PivotChart.OperationalMode.ServerMode||t.Pivot._updateValueSortingIndex(a,this._pivotClientObj),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&(e("#"+this._pivotClientObj._id+"_maxView")[0]?e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}):oclientWaitingPopup.show());try{if(a[0]!=i){if(this.setJSONRecords(a[0].Value),this.setOlapReport(a[1].Value),t.isNullOrUndefined(a[2])||"AnalysisMode"==(l=a[2].Key)&&"Olap"==a[2].Value&&(this.model.analysisMode=t.PivotChart.AnalysisMode.Olap),!t.isNullOrUndefined(this._pivotClientObj)){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this._pivotClientObj.currentReport=JSON.parse(this.getOlapReport()).Report;else try{this._pivotClientObj.currentReport=JSON.parse(a[1].Value).Report}catch(e){this._pivotClientObj.currentReport=a[1].Value}null!=a[2]&&a[2]!=i&&("ClientReports"==(l=a[2].Key)&&(this._pivotClientObj.reports=a[2].Value)),a[3]&&("Title"==(l=a[3].Key)&&""!=a.d[3].Value&&this._setTitleText(a[3].Value,this._pivotClientObj)),this._updatePageSettings(a,this._pivotClientObj)}null!=a[2]&&a[2]!=i&&("ClientReports"==!(l=a[2].Key)&&"AnalysisMode"!=l&&(this.model.customObject=a[2].Value)),null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=i&&null!=this._pagerObj&&null!=a[2]&&a.d[2]!=i&&this._pagerObj.initPagerProperties(JSON.parse(a.d[3].Value),JSON.parse(a.d[2].Value))}else if(a.d!=i){if(this.setJSONRecords(a.d[0].Value),this.setOlapReport(a.d[1].Value),"AnalysisMode"==a.d[2].Key&&"Olap"==a.d[2].Value&&(this.model.analysisMode=t.PivotChart.AnalysisMode.Olap),!t.isNullOrUndefined(this._pivotClientObj)){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this._pivotClientObj.currentReport=JSON.parse(this.getOlapReport()).Report;else try{this._pivotClientObj.currentReport=JSON.parse(a.d[1].Value).Report}catch(e){this._pivotClientObj.currentReport=a.d[1].Value}null!=a.d[2]&&a.d[2]!=i&&("ClientReports"==(l=a.d[2].Key)&&(this._pivotClientObj.reports=a.d[2].Value)),a.d[3]&&("Title"==(l=a.d[3].Key)&&""!=a.d[3].Value&&this._setTitleText(a.d[3].Value,this._pivotClientObj)),this._updatePageSettings(a.d,this._pivotClientObj)}null!=a.d[2]&&a.d[2]!=i&&("ClientReports"==(l=a.d[2].Key)||(this.model.customObject=a.d[2].Value)),null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=i&&(null!=a.d[2]&&a.d[2]!=i&&("PageSettings"==(l=a.d[2].Key)&&this._pagerObj.initPagerProperties(JSON.parse(a.d[3].Value),JSON.parse(a.d[2].Value))),null!=a.d[3]&&a.d[3]!=i&&("PageSettings"==(l=a.d[3].Key)&&this._pagerObj.initPagerProperties(JSON.parse(a.d[4].Value),JSON.parse(a.d[3].Value))))}else if(this.setJSONRecords(a.JsonRecords),this.setOlapReport(a.OlapReport),"Olap"==a.AnalysisMode&&(this.model.analysisMode=t.PivotChart.AnalysisMode.Olap),null!=a.customObject&&null!=a.customObject&&(this.model.customObject=a.customObject),!t.isNullOrUndefined(this._pivotClientObj)){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this._pivotClientObj.currentReport=JSON.parse(this.getOlapReport()).Report;else try{this._pivotClientObj.currentReport=JSON.parse(a.OlapReport).Report}catch(e){this._pivotClientObj.currentReport=a.OlapReport}void 0!==this._pivotClientObj.reports&&a.reports!=i&&"undefined"!=a.reports&&(this._pivotClientObj.reports=a.reports),a&&a.Title&&this._setTitleText(a.Title,this._pivotClientObj)}if(null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&(r=""!=this._drillAction?{action:this._drillAction,element:this.element,customObject:this.model.customObject}:{action:this._currentAction,element:this.element,customObject:this.model.customObject},this._trigger("afterServiceInvoke",r)),o=this.model.size.height,d=this.model.size.width,n=t.isNullOrUndefined(o)?this.element.height()>0?this.element.height():450:"string"==typeof o&&-1!=o.indexOf("%")?this.element.height()/100*parseInt(o):o,s=t.isNullOrUndefined(d)?this.element.width()>0?this.element.width():600:"string"==typeof d&&-1!=d.indexOf("%")?this.element.width()/100*parseInt(d):d,e(this.element).parents(".e-pivotclient").length>0||(this.model.size.height=n+"px",this.model.size.width=s+"px",this.model.isResponsive||this.element.width(s)),u=t.buildTag("div#"+this._id+"Container","",{height:t.isNullOrUndefined(this._pivotClientObj)?n:this._pivotClientObj._chartHeight,width:t.isNullOrUndefined(this._pivotClientObj)?s:this._pivotClientObj.model.enableSplitter?this._pivotClientObj.element.find(".controlPanelTD").width():this._pivotClientObj._toggleExpand?this._pivotClientObj.element.find(".controlPanelTD").width()-15:e("#"+this._pivotClientObj._id+"_maxView").length>0&&this._pivotClientObj._pivotChart?e("#"+this._pivotClientObj._pivotChart._id+"Container").width():this._pivotClientObj._chartWidth})[0].outerHTML,e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?(c=this._pivotClientObj.model.enableSplitter?e("<div id="+this._id+"toolBar style='width:"+this._pivotClientObj._chartWidth+";height:"+this._pivotClientObj._chartHeight+";margin-top:35px;margin-left:5px'></div>"):e("<div id="+this._id+"toolBar style='width:"+this._pivotClientObj._chartWidth+";height:"+this._pivotClientObj._chartHeight+";overflow:auto;margin-top:35px;margin-left:5px'></div>"),e(c).html(u),this.element.html(c)):this.element.html(u),this.model.commonSeriesOptions.type==t.PivotChart.ChartTypes.Funnel||this.model.commonSeriesOptions.type==t.PivotChart.ChartTypes.Pyramid?(this.model.legend.toggleSeriesVisibility=!1,this.model.commonSeriesOptions.marker={dataLabel:{visible:!0,shape:"none",font:{color:this.element.css("color"),size:"12px",fontWeight:"lighter"}}}):this.model.legend.toggleSeriesVisibility=!0,this.model.operationalMode!=t.PivotChart.OperationalMode.ClientMode&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||t.isNullOrUndefined(this._pivotClientObj)||this._setTitleText("Title",this._pivotClientObj),this.renderChartFromJSON(this.getJSONRecords()),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(e("#"+this._id).prepend("<div class='e-chartToolBar' style='height:40px;width:"+this._pivotClientObj.element.find(".chartContainer").width()+"px'></div>"),p=t.buildTag("ul",t.buildTag("li.e-chart3DImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("TDCharts")).attr({title:this._getLocalizedLabels("TDCharts"),tabindex:0})[0].outerHTML+t.buildTag("li.e-exportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Exporting")).attr({title:this._getLocalizedLabels("Exporting"),tabindex:0})[0].outerHTML+(this.model.enable3D?"":t.buildTag("li.e-smartLabels e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SmartLabels")).attr({title:this._getLocalizedLabels("SmartLabels"),tabindex:0})[0].outerHTML)+(this.model.enable3D?"":t.buildTag("li.e-interaction e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Interactions")).attr({title:this._getLocalizedLabels("Interactions"),tabindex:0})[0].outerHTML))[0].outerHTML+t.buildTag("ul",t.buildTag("li#"+this._id+"_toolTipImg.e-toolTipImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Tooltip")).attr({title:this._getLocalizedLabels("Tooltip"),tabindex:0})[0].outerHTML+t.buildTag("li.e-legend e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Legend")).attr({title:this._getLocalizedLabels("Legend"),tabindex:0})[0].outerHTML+(this.model.enable3D?"":t.buildTag("li.e-zooming e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Zooming")).attr({title:this._getLocalizedLabels("Zooming"),tabindex:0})[0].outerHTML)+t.buildTag("li.e-icon-xAxis-title e-icon","",{}).attr("aria-label","X-Axis title").attr({title:"X-Axis title",tabindex:0})[0].outerHTML+t.buildTag("li.e-icon-yAxis-title e-icon","",{}).attr("aria-label","Y-Axis title").attr({title:"Y-Axis title",tabindex:0})[0].outerHTML)[0].outerHTML,e(".e-chartToolBar").append(e(p)),e(".e-chartToolBar").ejToolbar({enableRTL:this.model.enableRTL,enableSeparator:!0,height:"35px"}),this.model.enable3D&&this.element.find(".e-chart3DImg").addClass("e-enabled"),this.model.zooming.enable&&this.element.find(".e-zooming").addClass("e-enabled"),this.model.legend.visible&&this.element.find(".e-legend").addClass("e-enabled"),t.isNullOrUndefined(this.model.primaryXAxis.labelIntersectAction)||this.element.find(".e-smartLabels").addClass("e-enabled"),this.model.primaryXAxis.title.enable&&this.element.find(".e-icon-xAxis-title").addClass("e-enabled"),this.model.primaryYAxis.title.enable&&this.element.find(".e-icon-yAxis-title").addClass("e-enabled"),this.model.commonSeriesOptions.tooltip.visible&&this.element.find(".e-toolTipImg").addClass("e-enabled"),this.model.crosshair.visible&&this.element.find(".e-interaction").addClass("e-enabled"),"trackball"==this.model.crosshair.type&&this.element.find(".e-trackBall").addClass("e-enabled"),"crosshair"==this.model.crosshair.type&&this.element.find(".e-crossHair").addClass("e-enabled"),this.model.crosshair.visible||this.element.find(".none").addClass("e-enabled"),this._pivotClientObj._unWireEvents(),this._pivotClientObj._wireEvents()),this._unWireEvents(),this._wireEvents(),""!=this._drillAction){if(this.model.currentReport=this.getOlapReport(),this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&!this.model.enableMultiLevelLabels)if(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode){if(h=this.getJSONRecords(),this.model.dataSource.rows.length-this._labelCurrentTags.expandedMembers.length>1)for(this._labelCurrentTags.collapsedMembers=[],g=0;g<h.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(h.chartLables[g])}else if(h=this.getJSONRecords(),m=t.isNullOrUndefined(JSON.parse(this.getOlapReport()).rows)?JSON.parse(this.getOlapReport()).PivotRows:JSON.parse(JSON.parse(this.getOlapReport()).rows),this._labelCurrentTags.collapsedMembers=[],m.length-this._labelCurrentTags.expandedMembers.length>1)for(g=0;g<h.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(h.chartLables[g]);t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("chartDrillSuccess",this.element),this._trigger("drillSuccess",this.element)}else if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot)if(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode){if(h=this.getJSONRecords(),this._labelCurrentTags={collapsedMembers:[]},this.model.dataSource.rows.length>1)for(g=0;g<h.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(h.chartLables[g])}else if(h=this.getJSONRecords(),this.model.currentReport=JSON.parse(this.getOlapReport()),this._labelCurrentTags={collapsedMembers:[]},e(this.element).parents(".e-pivotclient").length>0?this.model.currentReport.PivotRows.length>1:JSON.parse(this.model.currentReport.rows).length>1)for(g=0;g<h.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(h.chartLables[g]);f=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,t.isNullOrUndefined(f)||(f._isTimeOut=!1),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup?this._waitingPopup.hide():(e("#"+this._pivotClientObj._id+"_maxView")[0]?(e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!1}),this._pivotClientObj._waitingPopup.hide()):t.isNullOrUndefined(this._pivotClientObj._pivotGrid)||(this._pivotClientObj&&this._pivotClientObj._pivotGrid._drillAction&&!this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._drillAction&&!this._pivotClientObj._pivotChart._startDrilldown?this._pivotClientObj._waitingPopup.hide():!this._pivotClientObj||""!=this._pivotClientObj._pivotGrid._drillAction||""!=this._pivotClientObj._pivotChart._drillAction||this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._startDrilldown||null==this._pivotClientObj._pivotGrid._JSONRecords&&null!=this._pivotClientObj._pivotChart._JSONRecords?!this._pivotClientObj._pivotChart._startDrilldown||this._pivotClientObj._pivotGrid._startDrilldown||e("#"+this._pivotClientObj._id+"_maxView")[0]?this._pivotClientObj._pivotChart._startDrilldown||this._pivotClientObj._pivotGrid._startDrilldown||""!=this._pivotClientObj._pivotChart._drillAction||""!=this._pivotClientObj._pivotGrid._drillAction||null==this._pivotClientObj._pivotGrid._JSONRecords&&null!=this._pivotClientObj._pivotChart._JSONRecords||this._pivotClientObj._waitingPopup.hide():this._pivotClientObj._waitingPopup.show():this._pivotClientObj._waitingPopup.hide()),"chartonly"==this._pivotClientObj.model.displaySettings.mode&&this._pivotClientObj._waitingPopup.hide()),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj._pivotChart._startDrilldown=!1)}catch(e){}t.isNullOrUndefined(a.Exception)||t.Pivot._createErrorDialog(a,"Exception",this),this._trigger("renderSuccess",this)},_getChartSeries:function(a){var l,r,n,s=this,o=[];this.model.enableRTL&&(a.chartLables=e.map(a.chartLables,function(e){return e.split("~~").map(function(e){return e.split("#").reverse().join("#")}).reverse().join("~~")}),a.seriesNames=e.map(a.seriesNames,function(e){return e.split("~~").map(function(e){return e.split("#").reverse().join("#")}).reverse().join("~~")})),l=[];var d,u,c=[],p=(l=s.model.analysisMode==t.PivotChart.AnalysisMode.Olap?e.map(e.extend([],a.chartLables,!0),function(e){return e.split("#").join("~~")}):e.map(e.extend([],a.chartLables,!0),function(e){return!t.isNullOrUndefined(s._labelCurrentTags.expandedMembers)&&s._labelCurrentTags.expandedMembers.length>0?s._labelCurrentTags.expandedMembers.join("~~")+"~~"+e:e}),[]),m=0,h=0,g=this.model.series[0].trendlines[0];if(u=""!=a.measureInfo?parseInt(a.measureInfo):0,jQuery.each(l,function(e){var r,n,o,p=[];if(u>1&&"DrillChart"!=a.addInfo.action||u>1&&"1"==a.addInfo.levelHash){for(r=(e+1)*u-u,n=0;n<u;n++)if(a.points_Y[r+n]!=i&&l[e].split("~~")[0]==a.points_Y[r+n][0].Item1)for(o=0;o<a.points_Y[e].length;o++)(d={xValues:l[e],yValues:a.points_Y[r+n][o].Item2.indexOf(",")>-1?t.globalize.parseFloat(t.globalize.format(a.points_Y[r+n][o].Item2,"c",s.locale()),s.locale()):""==a.points_Y[r+n][o].Item2?0:t.globalize.parseFloat(a.points_Y[r+n][o].Item2),text:""==a.points_Y[r+n][o].Item2?0:a.points_Y[r+n][o].Item2}).yValues=t.isNullOrUndefined(d.yValues)?d.yValues:jQuery.isNumeric(d.yValues)?d.yValues:t.globalize.parseFloat(a.points_Y[r+n][o].Item2.toString().replace(/[^\d.,-]/g,"")),p.push(d)}else for(o=0;o<a.points_Y[e].length;o++)s.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&s.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(d="bubble"==s.seriesType()?{xValues:l[e],yValues:""==a.points_Y[e][o].Item2?0:a.points_Y[e][o].Item2,size:""==a.points_Y[e][o].Item2?0:a.points_Y[e][o].Item2}:{xValues:l[e],yValues:""==a.points_Y[e][o].Item2?0:t.globalize.parseFloat(a.points_Y[e][o].Item2),text:""==a.points_Y[e][o].Item2?"0":a.points_Y[e][o].Item2.toString()}).yValues=t.isNullOrUndefined(d.yValues)?d.yValues:jQuery.isNumeric(d.yValues)?d.yValues:t.globalize.parseFloat(a.points_Y[e][o].Item2.toString().replace(/[^\d.,-]/g,"")):(d="bubble"==s.seriesType()?{xValues:l[e].toString().split("#")[l[e].toString().split("#").length-1],yValues:""==a.points_Y[e][o]?0:a.points_Y[e][o],size:""==a.points_Y[e][o]?0:a.points_Y[e][o]}:{xValues:l[e].toString().split("#")[l[e].toString().split("#").length-1],yValues:""==a.points_Y[e][o]?0:a.points_Y[e][o],text:""==a.points_Y[e][o]?"0":a.points_Y[e][o].toString()}).yValues=t.isNullOrUndefined(d.yValues)?d.yValues:jQuery.isNumeric(d.yValues)?d.yValues:t.globalize.parseFloat(a.points_Y[e][o].toString().replace(/[^\d.,-]/g,"")),p.push(d);c.push(p)}),u>1&&"DrillChart"!=a.addInfo.action||u>1&&"1"==a.addInfo.levelHash)for(r=0;r<u*a.seriesNames.length;r++)p.push([]);else jQuery.each(a.seriesNames,function(){p.push([])});if(jQuery.each(l,function(e){for(var i=0;i<c[e].length;i++)t.isNullOrUndefined(p[i])&&(p[i]=[]),p[i].push(c[e][i])}),u>1&&"DrillChart"!=a.addInfo.action||u>1&&"1"==a.addInfo.levelHash)for(n=0;n<u*a.seriesNames.length;n++)o[h]={dataSource:p[n],xName:"xValues",yName:"yValues",name:a.seriesNames[m],trendlines:[g]},h++,++m==a.seriesNames.length&&(m=0);else"bubble"==this.seriesType()?jQuery.each(a.seriesNames,function(e){o[m]={dataSource:p[e],xName:"xValues",yName:"yValues",size:"size",name:a.seriesNames[m],trendlines:[g]},m++}):jQuery.each(a.seriesNames,function(e){o[m]={dataSource:p[e],xName:"xValues",yName:"yValues",name:a.seriesNames[m],marker:{dataLabel:{textMappingName:"text"}},trendlines:[g]},m++});return o},renderChartFromJSON:function(i){var a,l,r,n,s,o,d,u,c,p,m,h,g,f,_,b,v,C,S,O,x,y,P,N,M,T,L,w,j,D,I;if(!this.model.enableDefaultValue&&!t.isNullOrUndefined(i)&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&""==i.measureNames&&!t.isNullOrUndefined(i.points_Y)&&i.points_Y.length>0&&(i.points_Y=e.map(i.points_Y,function(i){return e.map(i,function(e){return t.isNullOrUndefined(e.Item2)?e=0:e.Item2="",e})})),this.setJSONRecords(JSON.stringify(i)),a=[],null==i||""==i)""==i&&(l=t.buildTag("div#"+this._id+"Container")[0].outerHTML,this.element.html(l)),a=[],this.model.primaryXAxis.multiLevelLabels=[];else if(null!=i&&i.chartLables.length>0&&i.points_Y.length>0){if(a=this._getChartSeries(i),r={series:e.extend(!0,[],a),axes:this.model.axes},this.model.axes.length<=a.length)for(y=0;y<this.model.axes.length;y++)if(this.model.axes[y].name.indexOf(":")>-1)for(n=this.model.axes[y].name.split(":").length>0?this.model.axes[y].name.split(":")[0]:"y",s=this.model.axes[y].name.split(":")[1].split(","),o=0;o<s.length;o++)t.isNullOrUndefined(n)||(-1==n.toLowerCase().indexOf("x")?a[parseInt(s[o])].yAxisName=this.model.axes[y].name:a[parseInt(s[o])].xAxisName=this.model.axes[y].name);if(this._trigger("beforeSeriesRender",r),t.isNullOrUndefined(this.model.beforeSeriesRender)||(a=r.series),this.model.enableMultiLevelLabels&&!t.isNullOrUndefined(i.multiLevelLabels)){for(this.model.primaryXAxis.majorTickLines={size:0},d=[],u=[],y=0;y<i.multiLevelLabels.length;y++)u.push(i.multiLevelLabels[y].split("~~"));for(y=i.multiLevelLabels[0].split("~~").length-1;y>=0;y--){for(c=[],P=0;P<i.multiLevelLabels.length;P++){if((p={}).name=i.multiLevelLabels[P].split("~~")[y].split("#")[0],this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode)p.rowSpan=parseInt(i.multiLevelLabels[P].split("~~")[y].split("#")[1]),p.colSpan=parseInt(i.multiLevelLabels[P].split("~~")[y].split("#")[2]),p.tag=i.multiLevelLabelTags[P].split("~~")[y];else{if(y==i.multiLevelLabels[0].split("~~").length-1)p.colSpan=1;else{for(m="",h=0,g=P;g<u.length;g++){for(f="",_=y;_>=0;_--)f+=""==f?u[g][_]:"$"+u[g][_];if(h+=""==m||m==f?1:0,m!=f&&""!=m)break;m=f}p.colSpan=h}if(0==parseInt(i.multiLevelLabels[P].split("~~")[y].split("#")[1])){for(C=0,b=y;b>=0&&(C++,!(parseInt(u[P][b].split("#")[1])>0));b--);p.rowSpan=C}else p.rowSpan=1;p.tag=t.isNullOrUndefined(i.multiLevelLabelTags[P])?"":i.multiLevelLabelTags[P].split("~~")[y]}c.push(p)}d.push(c)}if(v=[],this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode){for(P=0;P<d[0].length;P++)for(y=d.length-1;y>=0;y--)if(!t.isNullOrUndefined(d[y][P])&&d[y][P].rowSpan>1&&-1==v.indexOf(y+"-"+P)){C=d[y][P].rowSpan,S=1;do{delete d[y-S][P],S++}while(C>S);v.push(y+"-"+P)}}else for(P=0;P<d[0].length;P++)for(y=0;y<d.length;y++)if(!t.isNullOrUndefined(d[y][P])&&d[y][P].rowSpan>1&&-1==v.indexOf(y+"-"+P)){C=d[y][P].rowSpan,S=0;do{delete d[y+S][P],S++}while(C>S+1);d[y+S][P].rowSpan=C,v.push(y+S+"-"+P)}for(O=[],x=this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotRows)?JSON.parse(JSON.parse(this.getOlapReport()).rows).length:JSON.parse(this.getOlapReport()).PivotRows.length:this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode?this.model.dataSource.rows.length:0,y=0;y<d.length;y++)for(P=0;P<d[y].length;P++)t.isNullOrUndefined(d[y][P])||(N=P-.5,(M={}).visible=!0,M.text=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?d[y][P].tag.endsWith("2")?"+ "+d[y][P].name:d[y][P].tag.endsWith("1")?"- "+d[y][P].name:d[y][P].name:x==d.length&&0==y?d[y][P].name:0==y||d[y][P].rowSpan>1?"+ "+d[y][P].name:"- "+d[y][P].name,M.tag=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?d[y][P].tag:x==d.length&&0==y?d[y][P].name+"#0":0==y||d[y][P].rowSpan>1?d[y][P].name+"#1":d[y][P].name+"#2",M.start=N,M.end=N+d[y][P].colSpan,M.level=y,M.span=d[y][P].rowSpan>1,O.push(M),P+=d[y][P].colSpan-1);this.model.primaryXAxis.multiLevelLabels=O,this.model.zooming.enableScrollbar=!0}else i.chartLables.length>10&&""==this.model.zooming?this.model.zooming={enable:!0,type:"x,y",enableMouseWheel:!0}:i.chartLables.length<10&&""==this._initZooming&&(this.model.zooming=this._initZooming);if(this.model.crosshair.visible?this.model.commonSeriesOptions.tooltip.format="#point.x# : #point.y#":this.model.enableRTL?this.model.commonSeriesOptions.tooltip={visible:!0,template:"toolTipTemplate"}:this.model.commonSeriesOptions.tooltip.format=this._getLocalizedLabels("Measure")+" : "+i.measureNames+" <br/>"+this._getLocalizedLabels("Column")+" : #series.name# <br/>"+this._getLocalizedLabels("Row")+" : #point.x# <br/>"+this._getLocalizedLabels("Value")+" : #point.y#",this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(T="",null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?i.labelFormat.indexOf("#")>-1&&i.measureNames.indexOf("~")<0&&!(i.labelFormat.indexOf("$")>-1)?"#,#"==i.labelFormat?T="Number":i.labelFormat.indexOf("#,#")>-1&&i.labelFormat.split("#")[i.labelFormat.split("#").length-1].indexOf(")")>-1?i.labelFormat.indexOf(";")>-1?T="n"+("0"==(L=i.labelFormat.split(";")[0]).split("#")[L.split("#").length-1]?0:L.split("#")[L.split("#").length-1].split(".")[1].split("0").length-1):T="":T=e.isNumeric(i.labelFormat.split("#")[i.labelFormat.split("#").length-1])?"n"+("0"==i.labelFormat.split("#")[i.labelFormat.split("#").length-1]?0:i.labelFormat.split("#")[i.labelFormat.split("#").length-1].split(".")[1].split("0").length-1):"{value}"+i.labelFormat.split("##")[i.labelFormat.split("##").length-1]:T=i.labelFormat.toLowerCase().indexOf("percent")>-1&&i.measureNames.indexOf("~")<0?"{value}%":(i.labelFormat.toLowerCase().indexOf("currency")>-1||i.labelFormat.indexOf("$")>-1)&&i.measureNames.indexOf("~")<0?"Currency":"":T=this.model.primaryYAxis.labelFormat,this.model.primaryYAxis.labelFormat=T):1==this.model.dataSource.values[0].measures.length&&(t.isNullOrUndefined(this.model.dataSource.values[0].measures[0].format)||(this.model.primaryYAxis.labelFormat=null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?"decimal"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"n2":"number"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"Number":"percent"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"p2":"currency"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"Currency":"date"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"MM/dd/yyyy":"time"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"hh:mm:ss":"":this.model.primaryYAxis.labelFormat)):this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode?1==this.model.dataSource.values.length&&(t.isNullOrUndefined(this.model.dataSource.values[0].format)||(this.model.primaryYAxis.labelFormat=null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?"decimal"==this.model.dataSource.values[0].format.toLowerCase()?"n2":"number"==this.model.dataSource.values[0].format.toLowerCase()?"Number":"percentage"==this.model.dataSource.values[0].format.toLowerCase()?"p2":"currency"==this.model.dataSource.values[0].format.toLowerCase()?"Currency":"date"==this.model.dataSource.values[0].format.toLowerCase()?t.isNullOrUndefined(this.model.dataSource.values[0].formatString)?"dd/MMMM/yyyy":this.model.dataSource.values[0].formatString:"time"==this.model.dataSource.values[0].format.toLowerCase()?"hh:mm:ss":"":this.model.primaryYAxis.labelFormat)):(w=t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotCalculations)?JSON.parse(JSON.parse(this.getOlapReport()).values):JSON.parse(this.getOlapReport()).PivotCalculations,1==i.labelFormat.length&&1==w.length&&(this.model.primaryYAxis.labelFormat=null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?"#.##"==i.labelFormat[0].toLowerCase()?"n2":"###"==i.labelFormat[0].toLowerCase()?"Number":"p"==i.labelFormat[0].toLowerCase()?"p2":"c"==i.labelFormat[0].toLowerCase()?"Currency":"":this.model.primaryYAxis.labelFormat))),this.model.zooming.enableScrollbar){t.isNullOrUndefined(this.model.size.width)&&(this.model.size.width="800px"),t.isNullOrUndefined(this.model.size.height)&&(this.model.size.height="400px");var E=this.model.size.width.indexOf("%")>-1?this.element.width()*this.model.size.width.split("%")[0]/100:this.model.size.width.split("px")[0],A=this.model.size.height.indexOf("%")>-1?this.element.height()*this.model.size.height.split("%")[0]/100:this.model.size.height.split("px")[0],R="bar"==this.seriesType()||"stackingbar"==this.seriesType()?A/100*6:E/100*3;this.model.primaryXAxis.zoomFactor=R/(i.chartLables.length*i.seriesNames.length)}else this.model.primaryXAxis.zoomFactor=1;this.model.primaryXAxis.labelRotation=t.isNullOrUndefined(this.model.primaryXAxis.labelRotation)?270:this.model.primaryXAxis.labelRotation}else this.model.primaryXAxis.multiLevelLabels=[];var V=jQuery.extend(!0,{},this.model.primaryXAxis),U=jQuery.extend(!0,{},this.model.primaryYAxis);t.isNullOrUndefined(this._pivotClientObj)||(t.isNullOrUndefined(this._xTitle)?this.model.primaryXAxis.title.enable||(V.title.text=""):V.title.text=this._xTitle),t.isNullOrUndefined(this._pivotClientObj)||(t.isNullOrUndefined(this._yTitle)?this.model.primaryYAxis.title.enable||(U.title.text=""):U.title.text=this._yTitle),e("#"+this._id+"Container").ejChart({axes:this.model.axes,border:this.model.border,backGroundImageUrl:this.model.backGroundImageUrl,palette:this.model.palette,chartArea:this.model.chartArea,primaryXAxis:V,primaryYAxis:U,secondaryX:this.model.secondaryX,secondaryY:this.model.secondaryY,striplineDefault:this.model.striplineDefault,title:{text:this.titleText(),textAlignment:this.model.title.textAlignment,font:{color:this.model.title.color,fontFamily:this.model.title.fontFamily,fontWeight:this.model.title.fontWeight,opacity:this.model.title.opacity,size:this.model.title.size,fontStyle:this.model.title.fontStyle}},locale:this.locale(),lineCap:this.model.lineCap,lineJoin:this.model.lineJoin,legendAlignment:this.model.legendAlignment,legendPosition:this.model.legendPosition,legend:this.model.legend,animation:this.model.animation,crosshair:this.model.crosshair,commonSeriesOptions:{doughnutCoefficient:this.model.commonSeriesOptions.doughnutCoefficient,explodeOffset:this.model.commonSeriesOptions.explodeOffset,pyramidMode:this.model.commonSeriesOptions.pyramidMode,gapRatio:this.model.commonSeriesOptions.gapRatio,pieCoefficient:this.model.commonSeriesOptions.pieCoefficient,doughnutSize:this.model.commonSeriesOptions.doughnutSize,startAngle:this.model.commonSeriesOptions.startAngle,xAxisName:this.model.commonSeriesOptions.xAxisName,yAxisName:this.model.commonSeriesOptions.yAxisName,explodeAll:this.model.commonSeriesOptions.explodeAll,explodeIndex:this.model.commonSeriesOptions.explodeIndex,tooltipOptions:this.model.commonSeriesOptions.tooltipOptions,marker:this.model.commonSeriesOptions.marker||this.model.marker,font:this.model.commonSeriesOptions.font,type:this.seriesType(),enableAnimation:this.model.commonSeriesOptions.enableAnimation,style:this.model.commonSeriesOptions.style,explode:this.model.commonSeriesOptions.explode,labelPosition:this.model.commonSeriesOptions.labelPosition,tooltip:this.model.commonSeriesOptions.tooltip,zOrder:this.model.commonSeriesOptions.zOrder,drawType:this.model.commonSeriesOptions.drawType,isStacking:this.model.commonSeriesOptions.isStacking,enableSmartLabels:this.model.commonSeriesOptions.enableSmartLabels},seriesStyle:this.model.seriesStyle,pointStyle:this.model.pointStyle,textStyle:this.model.textStyle,initSeriesRender:this.model.initSeriesRender,theme:this.model.theme,canResize:this.model.isResponsive,rotation:this.model.rotation,enable3D:this.model.enable3D,zooming:this.model.zooming,margin:this.model.margin,elementSpacing:this.model.elementSpacing,seriesColors:this.model.seriesColors,seriesBorderColors:this.model.seriesBorderColors,pointColors:this.model.pointColors,pointBorderColors:this.model.pointBorderColors,series:a,size:this.model.size,load:this.model.enableMultiLevelLabels?this._onChartLoad:this.model.load,loaded:this.model.enableMultiLevelLabels?t.proxy(this._onChartLoaded,this):null,axesRangeCalculate:this.model.axesRangeCalculate,axesTitleRendering:this.model.axesTitleRendering,chartAreaBoundsCalculate:this.model.chartAreaBoundsCalculate,legendItemRendering:this.model.legendItemRendering,lengendBoundsCalculate:this.model.lengendBoundsCalculate,preRender:this.model.preRender,seriesRendering:this.model.seriesRendering,symbolRendering:this.model.symbolRendering,titleRendering:this.model.titleRendering,axesLabelsInitialize:this.model.axesLabelsInitialize,pointRegionMouseMove:this.model.pointRegionMouseMove,legendItemClick:this.model.legendItemClick,legendItemMouseMove:this.model.legendItemMouseMove,displayTextRendering:this.model.displayTextRendering,toolTipInitialize:this.model.toolTipInitialize,trackAxisToolTip:this.model.trackAxisToolTip,trackToolTip:this.model.trackToolTip,animationComplete:this.model.animationComplete,destroy:this.model.destroy,create:this.model.create,axesLabelRendering:t.proxy(this._labelRenders,this),multiLevelLabelClick:t.isNullOrUndefined(this._pivotClientObj)?t.proxy(this._multiLevelLabelClick,this):this._pivotClientObj.model.enableDeferUpdate?null:t.proxy(this._multiLevelLabelClick,this),pointRegionClick:t.isNullOrUndefined(this._pivotClientObj)?t.proxy(this._seriesClick,this):this._pivotClientObj.model.enableDeferUpdate?null:t.proxy(this._seriesClick,this)}),this.model.enableRTL&&null!=i&&(j=t.buildTag("div#toolTipTemplate.e-toolTip",t.buildTag("div.toolTipInfo",t.buildTag("div",i.measureNames+" : "+this._getLocalizedLabels("Measure")+" <br/>")[0].outerHTML+t.buildTag("div","#series.name#: "+this._getLocalizedLabels("Row")+" <br/>")[0].outerHTML+t.buildTag("div","#point.x# : "+this._getLocalizedLabels("Column")+" <br/>")[0].outerHTML+t.buildTag("div","#point.y# : "+this._getLocalizedLabels("Value"))[0].outerHTML).addClass("e-rtl")[0].outerHTML,{display:"none",width:"auto","min-width":"200px","font-size":"12px",padding:"2px 5px","background-color":"rgb(255, 255, 255)",border:"1px solid rgb(0, 0, 0)"})[0].outerHTML,e("#"+this._id).append(j)),e("#"+this._id+"progressContainer").hide(),this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&null!=i&&""!=i&&(this._labelCurrentTags.splice(0,this._labelCurrentTags.length),D=this,jQuery.each(i.labelTags,function(e,t){var i,a=t.split("::");i={name:a[2],state:a[a.length-1],tag:t},D._labelCurrentTags.push(i)}),t.isNullOrUndefined(D._selectedTagInfo)||jQuery.each(this._labelCurrentTags,function(e,t){if(t.tag.split("::")[0]==D._selectedTagInfo.split("::")[0]&&"drillup"==D._drillAction)return D._selectedTagInfo=D._labelCurrentTags[e].tag,!1})),I=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,t.isNullOrUndefined(I)||(I._isTimeOut=!1),null!=this._waitingPopup&&this._waitingPopup.hide(),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&this.model.commonSeriesOptions.tooltip.visible&&this.element.find(".e-toolTipImg").addClass("e-enabled"),t.isNullOrUndefined(this._pivotClientObj)||t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj.model.isResponsive||e("#"+this._id+"Container").width("100%")},_onChartLoad:function(e){for(var i,a=t.isNullOrUndefined(e.model.primaryXAxis.multiLevelLabels)?[]:e.model.primaryXAxis.multiLevelLabels,l=0;l<a.length;l++)if(a[l].span)for(a[l].border={type:"withouttopborder"},i=0;i<a[l].level;i++)a.push({start:a[l].start,end:a[l].end,visible:!0,text:" ",tag:a[l].tag,level:i,border:{type:"withouttopandbottomborder"}});return this.model.load},_onChartLoaded:function(){this.element.find("#"+this._id+"Container_svg_XAxisMultiLevelLabels_0").attr("cursor","pointer")},_setDrillParams:function(t,i){for(var a,l=this.getJSONRecords().chartLables[i.start+.5].split("~~"),r="",n=0;n<l.length&&(r+=""==r?l[n]:">#>"+l[n],t!=l[n]);n++);return a=r,"drilldown"==this._drillAction?this._drillParams.push(r):this._drillParams=e.map(this._drillParams,function(e){if(-1==e.indexOf(r))return e}),e(this.element).parents(".e-pivotclient").length>0&&(e(this.element).parents(".e-pivotclient").data("ejPivotClient")._drillParams=this._drillParams),a},_getChartDrillDown:function(i,a,l){var r,n,s,o,d,u,c,p,m,h,g,f,_,b=this.model.dataSource.providerName==t.olap.Providers.Mondrian;if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap){for("drillup"==this._drillAction&&((r=e.map(this.model.dataSource.rows,function(e,t){if(e.fieldName==a.hierarchyUniqueName)return{index:t,item:e}})).length>0&&!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[r[0].index])&&(n=0,e.each(this._labelCurrentTags.expandedMembers[r[0].index],function(e,t){i==t&&n++}),0==n&&this._labelCurrentTags.expandedMembers[r[0].index].push(i.split("&").join("&amp;")))),S=[],_=0;_<this.model.dataSource.rows.length;_++){if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers))for(d=0;d<this._labelCurrentTags.expandedMembers.length;d++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[d]))for(s=0;s<this._labelCurrentTags.expandedMembers[d].length;s++)this._labelCurrentTags.expandedMembers[d][s].indexOf(this.model.dataSource.rows[_].fieldName)>=0&&S.indexOf(this._labelCurrentTags.expandedMembers[d][s].replace("&amp;","&"))<0&&S.indexOf(this._labelCurrentTags.expandedMembers[d][s])<0&&S.push(this._labelCurrentTags.expandedMembers[d][s]);for(d=0;d<this._selectedSeriesInfo.length;d++)this._selectedSeriesInfo[d].indexOf(this.model.dataSource.rows[_].fieldName)>=0&&S.indexOf(this._selectedSeriesInfo[d])<0&&S.indexOf(this._selectedSeriesInfo[d].replace(/&/g,"&amp;"))<0&&S.push(this._selectedSeriesInfo[d].replace(/&/g,"&amp;"))}for(_=0;_<this._selectedSeriesInfo.length;_++)this._selectedSeriesInfo[_]=this._selectedSeriesInfo[_].replace(/&/g,"&amp;");if(o=S,"drillup"==this._drillAction){for(_=0;_<this._labelCurrentTags.expandedMembers.length;_++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[_]))for(d=0;d<this._labelCurrentTags.expandedMembers[_].length;d++)this.model.enableMultiLevelLabels&&""!=i?this._labelCurrentTags.expandedMembers[_][d]==i&&(S=[],jQuery.map(this._labelCurrentTags.expandedMembers[_],function(e){e==i&&(m=!0),m||S.push(e)}),this._labelCurrentTags.expandedMembers[_]=S):this._labelCurrentTags.expandedMembers[_][d].split("::")[2]==a&&(i=this._labelCurrentTags.expandedMembers[_][d],S=[],jQuery.map(this._labelCurrentTags.expandedMembers[_],function(e){e.split("::")[2]==a&&(m=!0),m||S.push(e)}),this._labelCurrentTags.expandedMembers[_]=S);a=t.olap._mdxParser._splitCellInfo(i)}else i=-1==i.indexOf("&amp")?i.replace(/&/g,"&amp;"):i;for(u=-1,_=0;_<this.model.dataSource.rows.length;_++)if(this.model.dataSource.rows[_].fieldName==a.hierarchyUniqueName){u=_;break}for(b&&"drillup"==this._drillAction&&!t.isNullOrUndefined(this._selectedSeriesInfo[u])&&(this._selectedSeriesInfo[u]=i),C=e.inArray(i,this._selectedSeriesInfo),S=[],_=0;_<=C;_++)S.push(this._selectedSeriesInfo[_]);var v=S,C=e.inArray(i,o),S=[];for(_=0;_<=C;_++)S.push(o[_]);if(o=S,c=e(this.element).parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient").data("ejPivotClient"):t.isNullOrUndefined(this._pivotClientObj)?this:this._pivotClientObj,"drilldown"==this._drillAction)t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&(this._labelCurrentTags.expandedMembers=[]),t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[u])&&(this._labelCurrentTags.expandedMembers[u]=[]),this._labelCurrentTags.expandedMembers[u].push(i),this.element.parents(".e-pivotclient").length>0&&(c=this.element.parents(".e-pivotclient").data("ejPivotClient"))._drillParams.push(e.map(o,function(e){return e.split("&amp;").join("&")}).join(">#>"));else if(this.element.parents(".e-pivotclient").length>0){c=this.element.parents(".e-pivotclient").data("ejPivotClient");var O=[],x="",y=[];for(e.each(o,function(e,t){(""==x||x.split("::")[0]!=t.split("::")[3])&&O.push(t),x=t}),e.each(O,function(e,t){e<u&&t.length>0&&y.push(t.split("&amp;").join("&"))}),c._drillParams=e.grep(c._drillParams,function(t){return u<1?-1==t.indexOf(i.split("&amp;").join("&")):!(t.indexOf(i.split("&amp;").join("&"))>-1&&e.map(t.split(">#>"),function(e){if(y.indexOf(e)>-1)return e}).length==y.length)}),m=!1,_=0;_<this._labelCurrentTags.expandedMembers.length;_++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[_])&&this._labelCurrentTags.expandedMembers[_].length>0){m=!0;break}if(c._drillParams.length>0&&this._drilledCellSet.length>0&&!m&&!t.isNullOrUndefined(c._drillParams[c._drillParams.length-1])){C=0;var P="",N="",M=!1;for(_=0;_<c._drillParams[c._drillParams.length-1].split(">#>").length;_++)-1==(N=c._drillParams[c._drillParams.length-1].split(">#>")[_]).indexOf("undefined")&&(C=""==P?0:N.split("::")[0].split(".")[0]+"."+N.split("::")[0].split(".")[1]==P.split("::")[0].split(".")[0]+"."+P.split("::")[0].split(".")[1]?C:C+1,e.each(this._drilledCellSet,function(t,i){(e.map(i[0].key.split("][").join("]>#>[").split(">#>"),function(e){if(y.indexOf(e)>-1)return e}).length!=y.length||0==y.length)&&e.each(i[0].key.split("][").join("]>#>[").split(">#>"),function(e,t){N.split("::")[0]+" !#rowheader"==t&&(M=!0)})}),M&&(N=N.split("&").join("&amp;"),t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[C])?this._labelCurrentTags.expandedMembers[C]=N:this._labelCurrentTags.expandedMembers[C].push(N),M=!1),P=N)}}"drilldown"==this._drillAction?t.olap._mdxParser.updateDrilledReport({uniqueName:i,seriesInfo:v,uniqueNameArray:o},"rowheader",c):t.olap._mdxParser.updateDrilledReport({uniqueName:i,seriesInfo:v,uniqueNameArray:o,action:"collapse"},"rowheader",c)}else{if(p="",""==this._drillAction&&this.model.enableMultiLevelLabels)return this._waitingPopup.hide(),!1;if("drilldown"==this._drillAction){if(this.model.enableMultiLevelLabels)p=this._setDrillParams(a,i),this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(this._selectedItem=a,this._generateData({JsonRecords:this._pivotEngine,PivotReport:this.getOlapReport()})):this._generateData(this._pivotEngine);else{for(t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&(this._labelCurrentTags.expandedMembers=[]),this._labelCurrentTags.expandedMembers.push(a),f=this._cloneEngine(this._pivotEngine),_=0;_<this._labelCurrentTags.expandedMembers.length;_++)this._cropData(f,this._labelCurrentTags.expandedMembers[_],0,!0);this._generateData(f)}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("chartDrillSuccess",{chartObj:this,drillAction:"drilldown",drilledMember:this.model.enableMultiLevelLabels?p:this._labelCurrentTags.expandedMembers.join(">#>"),event:l}),this._trigger("drillSuccess",{chartObj:this,drillAction:"drilldown",drilledMember:this.model.enableMultiLevelLabels?p:this._labelCurrentTags.expandedMembers.join(">#>"),event:l})}else{if(this.model.enableMultiLevelLabels)p=this._setDrillParams(a,i),this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(this._selectedItem=a,this._generateData({JsonRecords:this._pivotEngine,PivotReport:this.getOlapReport()})):this._generateData(this._pivotEngine);else{for(m=!1,S=[],jQuery.map(this._labelCurrentTags.expandedMembers,function(e){e==a&&(m=!0),m||S.push(e)}),this._labelCurrentTags.expandedMembers=S,p=0==this._labelCurrentTags.expandedMembers.length?a:this._labelCurrentTags.expandedMembers.join(">#>")+">#>"+a,h=this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode,(0==this._labelCurrentTags.expandedMembers.length||h)&&e(this.element).parents(".e-pivotclient").length>0&&((g=e(this.element).parents(".e-pivotclient").data("ejPivotClient"))._drillParams.length>0&&(g._drillParams=e.grep(g._drillParams,function(e){return e.indexOf(h?p:a)<0}),g._getDrilledMember())),f=this._cloneEngine(this._pivotEngine),_=0;_<this._labelCurrentTags.expandedMembers.length;_++)this._cropData(f,this._labelCurrentTags.expandedMembers[_],0,!0);this._generateData(f)}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("chartDrillSuccess",{chartObj:this,drillAction:"drillup",drilledMember:p,event:l}),this._trigger("drillSuccess",{chartObj:this,drillAction:"drillup",drilledMember:p,event:l})}}},_multiLevelLabelClick:function(a){var l,r,n,s,o,d;if(e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejWaitingPopup").show():t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)if(this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode){if(l=parseInt(a.data.multiLevelLabel.tag.split("::")[a.data.multiLevelLabel.tag.split("::").length-1]),a.data.multiLevelLabel.tag.startsWith("[Measures]")||0==l)return e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejWaitingPopup").hide():t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide(),!1;this._selectedTagInfo=a.data.multiLevelLabel.tag,this._drillAction=2==l?"drilldown":"drillup",this._startDrilldown=!0,r=JSON.stringify(this.model.customObject),n=this.getOlapReport(),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:n,customObject:r}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:n,clientReports:this._pivotClientObj.reports,customObject:r}),this.renderControlSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:n,clientReports:this._pivotClientObj.reports}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:n}),this.renderControlSuccess)}else{if(a.data.multiLevelLabel.tag.endsWith("0"))return t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide(),!1;var u=a.data.multiLevelLabel.tag.split("::").splice(0,a.data.multiLevelLabel.tag.split("::").length-1).join("::"),c=t.olap._mdxParser._splitCellInfo(u),p=this.getJSONRecords().labelTags[a.data.multiLevelLabel.start+.5].split("~~");for(this._selectedSeriesInfo=[],s=0;s<p.length;s++)this._selectedSeriesInfo.push(p[s].split("#")[p[s].split("#").length-1]);if(this._labelCurrentTags.collapsedMembers=e.grep(this._labelCurrentTags.collapsedMembers,function(e){return e!=a.data.multiLevelLabel.text.slice(2,a.data.multiLevelLabel.text.length)}),this._drillAction="2"==a.data.multiLevelLabel.tag.split("::")[a.data.multiLevelLabel.tag.split("::").length-1]?"drilldown":"1"==a.data.multiLevelLabel.tag.split("::")[a.data.multiLevelLabel.tag.split("::").length-1]?"drillup":"",!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers))for(o=0;o<this._labelCurrentTags.expandedMembers.length;o++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[o]))for(d=0;d<this._labelCurrentTags.expandedMembers[o].length;d++)if(this._labelCurrentTags.expandedMembers[o][d].indexOf(u.replace(/&/g,"&amp;"))>=0||this._labelCurrentTags.expandedMembers[o][d].indexOf(u)>=0){u=u.replace(/&/g,"&amp;");break}this._getChartDrillDown(u,c,a)}else c=a.data.multiLevelLabel.tag.split("#")[0],this._drillAction=a.data.multiLevelLabel.tag.endsWith("1")?"drilldown":a.data.multiLevelLabel.tag.endsWith("2")?"drillup":"",this._getChartDrillDown(a.data.multiLevelLabel,c,a)},_labelRenders:function(a){if(!t.isNullOrUndefined(this.model)&&this.model.enableMultiLevelLabels&&("bar"==this.seriesType()||"stackingbar"==this.seriesType()?"vertical"==a.data.axis.orientation.toLowerCase():"horizontal"==a.data.axis.orientation.toLowerCase()))a.data.label.Text="";else if((t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj._isExporting)&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("axesLabelRendering",a):this._pivotClientObj._trigger("axesLabelRendering",a),("horizontal"==a.data.axis.orientation.toLowerCase()&&a.data.label.Text!=i||("bar"==this.seriesType()||"stackingbar"==this.seriesType())&&"vertical"==a.data.axis.orientation.toLowerCase()&&a.data.label.Text!=i)&&this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)){var l=this.model.enableRTL?a.data.label.Text.toString().split("~~").reverse():a.data.label.Text.toString().split("~~");t.isNullOrUndefined(this.getJSONRecords())||e.each(e.extend([],this.getJSONRecords().chartLables,!0),function(e,t){if(t.toString().split("#").join("~~")==l.join("~~"))return a.data.label.Text=t.toString().split("~~").map(function(e){return e.split("#")[e.split("#").length-1]}).join("~~"),!1})}},_reSizeHandler:function(){if(!t.isNullOrUndefined(this.element)){var e=this.element.find("#"+this._id+"Container").height(this.element.height()).width(this.element.width()).data("ejChart");t.isNullOrUndefined(e)||e.redraw()}},_getLocalizedLabels:function(e){return t.isNullOrUndefined(t.PivotChart.Locale[this.locale()])||t.PivotChart.Locale[this.locale()][e]==i?t.PivotChart.Locale["en-US"][e]:t.PivotChart.Locale[this.locale()][e]},_onPreventPanelClose:function(i){e("body").find("#preventDiv").remove(),!e(".e-pivotgrid").data("ejWaitingPopup")||!t.isNullOrUndefined(i)&&(e(i.target).hasClass("pivotTree")||e(i.target).hasClass("pivotTreeContext")||e(i.target).hasClass("pivotTreeContextMenu"))||e(".e-pivotgrid").data("ejWaitingPopup").hide()},_seriesClick:function(a){var l,r,n,s,o,d,u,c,p,m,h;if(!this.model.enableMultiLevelLabels){this.element.find("#"+this._id+"ExpandMenu, .e-expandMenu, .e-dialog").remove();var g,f=[],_=this.element.position(),b=this,v=this;if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode)this._selectedTags=[],null!=a.data.region&&a.data.region!=i?(n=this.model.enableRTL?e.map(a.model.primaryXAxis.labels,function(e){return e.split("~~").reverse().join("~~")}):a.model.primaryXAxis.labels,g=n[a.data.region.Region.PointIndex],r=a.data.region.Region.PointIndex):null!=a.data.point.x&&a.data.point.x!=i&&""!=a.data.point.x&&(n=this.model.enableRTL?e.map(a.data.series.xAxis.labels,function(e){return e.split("~~").reverse().join("~~")}):a.data.series.xAxis.labels,g=n[a.data.point.X],r=a.data.point.X),this.model.enableMultiLevelLabels?l=a.model.primaryXAxis.labels[r].split("~~")[a.model.primaryXAxis.labels[r].split("~~").length-1]:e(e("#"+this._id+"Container_vml_XAxisLabels_0")[0]).children()[r]!=i?l=e(e("#"+this._id+"Container_vml_XAxisLabels_0")[0]).children()[r].innerHTML:e("#"+this._id+"Container_svg_XAxisLabels_0").children()[r]?l=e("#"+this._id+"Container_svg_XAxisLabels_0").children()[r].textContent:"bar"==this.seriesType()||"stackingbar"==this.seriesType()?e(e("#"+this._id+"Container_vml_YAxisLabels_0")[0]).children()[r]!=i?l=e(e("#"+this._id+"Container_vml_YAxisLabels_0")[0]).children()[r].innerHTML:e("#"+this._id+"Container_svg_YAxisLabels_0").children()[r]?l=e("#"+this._id+"Container_svg_YAxisLabels_0").children()[r].textContent:l=(s=a.model.primaryXAxis.labels[r].split("~~"))[s.length-1]:l=(s=a.model.primaryXAxis.labels[r].split("~~"))[s.length-1],l&&(e("#"+this._id).find("#"+this._id+"ExpandMenu, .e-expandMenu, .e-dialog").remove(),o=g.split("~~"),jQuery.each(o,function(t,i){jQuery.each(v._labelCurrentTags,function(t,a){if(e.trim(i)==a.name)return v._selectedTags.push(a),!1})}),jQuery.each(this._selectedTags,function(i,a){a.state>1&&(b.model.enableRTL?f.push(e(t.buildTag("li.e-menuList exp",a.name+" - "+v._getLocalizedLabels("Expand"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList exp",v._getLocalizedLabels("Expand")+" - "+a.name)[0]).attr("role","presentation")[0].outerHTML))}),jQuery.each(this._selectedTags,function(i,a){for(var l=0;l<g.split("~~").length-1;l++)g.split("~~")[l]==a.name&&1==a.state&&(b.model.enableRTL?f.push(e(t.buildTag("li.e-menuList clp",a.name+" - "+v._getLocalizedLabels("Collapse"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList clp",v._getLocalizedLabels("Collapse")+" - "+g.split("~~")[l])[0]).attr("role","presentation")[0].outerHTML))}));else{if(g=null!=a.data.region&&a.data.region!=i?this.getJSONRecords().chartLables[a.data.region.Region.PointIndex]:a.data.series.xAxis.labels[a.data.point.X],this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&(g=g.split("~~").map(function(e){return e.split("#")[e.split("#").length-1]}).join("~~")),!t.isNullOrUndefined(this._labelCurrentTags.collapsedMembers))if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)for(d=g.split("~~"),this.model.dataSource.values[0].axis==t.olap.AxisName.Row&&(u=e.map(this.model.dataSource.values[0].measures,function(e){return e.fieldName}),e.inArray(d[d.length-1],u)>=0&&d.splice(d.length-1,1)),this._selectedSeriesInfo=[],m=0;m<d.length;m++)c=d[m].split("#")[d[m].split("#").length-1],e(this.getJSONRecords().seriesTags).filter(function(e,t){return t.split("::")[2]==c}).length>0&&this._selectedSeriesInfo.push(e(this.getJSONRecords().seriesTags).filter(function(e,t){return t.split("::")[2]==c})[0]),e.inArray(c,this._labelCurrentTags.collapsedMembers)>=0&&(b.model.enableRTL?f.push(e(t.buildTag("li.e-menuList exp",c+" - "+this._getLocalizedLabels("Expand"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList exp",this._getLocalizedLabels("Expand")+" - "+c)[0]).attr("role","presentation")[0].outerHTML));else e.inArray(g,this._labelCurrentTags.collapsedMembers)>=0&&(b.model.enableRTL?f.push(e(t.buildTag("li.e-menuList exp",g+" - "+this._getLocalizedLabels("Expand"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList exp",this._getLocalizedLabels("Expand")+" - "+g)[0]).attr("role","presentation")[0].outerHTML));if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers))if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap){for(p=0;p<this._labelCurrentTags.expandedMembers.length;p++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[p]))for(m=0;m<this._labelCurrentTags.expandedMembers[p].length;m++)b.model.enableRTL?f.push(e(t.buildTag("li.e-menuList clp",this._labelCurrentTags.expandedMembers[p][m].split("::")[2]+" - "+this._getLocalizedLabels("Collapse"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList clp",this._getLocalizedLabels("Collapse")+" - "+this._labelCurrentTags.expandedMembers[p][m].split("::")[2])[0]).attr("role","presentation")[0].outerHTML)}else for(m=0;m<this._labelCurrentTags.expandedMembers.length;m++)b.model.enableRTL?f.push(e(t.buildTag("li.e-menuList clp",this._labelCurrentTags.expandedMembers[m]+" - "+this._getLocalizedLabels("Collapse"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList clp",this._getLocalizedLabels("Collapse")+" - "+this._labelCurrentTags.expandedMembers[m])[0]).attr("role","presentation")[0].outerHTML)}f.length>0&&(f.push(e(t.buildTag("li.e-menuList exit",this._getLocalizedLabels("Exit"))[0]).attr("role","presentation")[0].outerHTML),h=e(t.buildTag("div#"+this._id+"ExpandMenu.e-expandMenu",f)[0]).attr("role","presentation")[0].outerHTML,e(h).ejDialog({width:"auto",target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL}),e("#"+this._id+"ExpandMenu_wrapper").appendTo(this.element).css({left:a.data.location.x+8+_.left,top:a.data.location.y+8+_.top,"min-height":navigator.userAgent.toLowerCase().indexOf("webkit")>0?"initial":"auto"}),e("#"+this._id+"ExpandMenu").css({"min-height":navigator.userAgent.toLowerCase().indexOf("webkit")>0?"initial":"auto"})),this.element.find(".e-titlebar, .e-header").remove()}t.isNullOrUndefined(this._pivotClientObj)?this._trigger("pointRegionClick",a):this._pivotClientObj._trigger("pointRegionClick",a)},_getExportModel:function(){var i,a,l;if("msie"!=t.browserInfo().name||!(t.browserInfo().version<=8)){a=(i=e("#"+this._id+"Container").data("ejChart")).model.primaryXAxis.zoomFactor,i.model.primaryXAxis.zoomFactor=1,i.model.enableCanvasRendering=!0,i.redraw(),l=i.export().toDataURL("image/png"),i.model.primaryXAxis.zoomFactor=a,i.model.enableCanvasRendering=!1,i.redraw();var r=""!=e(this.element).css("background-color")?e(this.element).css("background-color"):"rgb(255, 255, 255)";return{args:JSON.stringify({fileName:"Export",chartdata:l.split(",")[1],bgColor:r,exportFormat:"xls",title:"",description:"PivotChart"})}}},exportPivotChart:function(i,a,l){var r,n,s,o,d,u,c,p={},m=null;if(r=t.isNullOrUndefined(l)||"excel"!=l.toLowerCase()?{url:"",fileName:"PivotChart",exportMode:t.PivotChart.ExportMode.ClientMode,title:"",description:"",exportType:i,controlName:this}:{url:"",fileName:"PivotChart",exportMode:t.PivotChart.ExportMode.ClientMode,title:"",description:"",exportType:i,controlName:this,exportChartAsImage:!0},this._trigger("beforeExport",r),"msie"!=t.browserInfo().name||!(t.browserInfo().version<=8)){(t.isNullOrUndefined(a)||""==a)&&(a="Sample");var h=e("#"+this._id+"Container").data("ejChart"),g={height:h.model.size.height,width:h.model.size.width},f=h.model.primaryXAxis.zoomFactor;h.model.primaryXAxis.zoomFactor=1,h.model.enableCanvasRendering=!0,h.model.size=m={height:t.isNullOrUndefined(r.height)?h.model.size.height:r.height,width:t.isNullOrUndefined(r.width)?h.model.size.width:r.width},h.redraw(),n=h.export().toDataURL("image/png"),h.model.primaryXAxis.zoomFactor=f,h.model.enableCanvasRendering=!1,h.model.size={height:g.height,width:g.width},h.redraw(),s=""!=e(this.element).css("background-color")?e(this.element).css("background-color"):"rgb(255, 255, 255)",t.isNullOrUndefined(r.exportChartAsImage)||r.exportChartAsImage||(h.model.size=m,p=(p=this._excelExport(h,g.height,g.width)).replace(new RegExp("<br/>","g"),"")),r.exportMode==t.PivotChart.ExportMode.ClientMode?(u={fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotChart":r.fileName:a,chartdata:n.split(",")[1],bgColor:s,exportFormat:l,title:r.title,description:r.description},t.isNullOrUndefined(r.exportChartAsImage)||r.exportChartAsImage||(u.chartModel=p),c={args:JSON.stringify(u)},!t.raiseWebFormsServerEvents||"excelExport"!=i&&"pdfExport"!=i&&"wordExport"!=i&&"imageExport"!=i||r.exportMode!=t.PivotChart.ExportMode.ClientMode||""!=e.trim(r.url)?this.doPostBack(""!=e.trim(r.url)?r.url:i,c):(o={model:this.model,originalEventType:i},d=c,t.raiseWebFormsServerEvents(i,o,d),setTimeout(function(){t.isOnWebForms=!0},1e3))):(u={exportOption:i,chartdata:n.split(",")[1],bgColor:s,title:r.title,description:r.description},t.isNullOrUndefined(r.exportChartAsImage)||r.exportChartAsImage||(u.chartModel=p),c={args:JSON.stringify(u)},this.doPostBack(""!=e.trim(r.url)?r.url:this.model.url+"/"+this.model.serviceMethodSettings.exportPivotChart,c))}},_excelExport:function(t,i,a){var l,r,n,s=e.extend(!0,{},t.model),o=(t.svgHeight,t.svgWidth,i),d=a;if(s.event=null,s.primaryXAxis.range=s.primaryXAxis.actualRange,s.primaryYAxis.range=s.primaryYAxis.actualRange,t._ignoreOnExport)for(l=s.series,r=0;r<l.length;r++)delete l[r].dataSource,delete l[r].query,l[r].fill="array"==jQuery.type(l[r].fill)?l[r].fill[0].color:l[r].fill;return s.size.height&&-1!=s.size.height.indexOf("%")&&(s.size.height=e(t.svgObject).height().toString()),s.size.width&&-1!=s.size.width.indexOf("%")&&(s.size.width=e(t.svgObject).width().toString()),n=JSON.stringify(s),s.size={width:d,height:o},n},doAjaxPost:function(a,l,r,n,s,o){var d,u,c,p,m=!0,h=this.model.enableXHRCredentials||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableXHRCredentials;r.XMLA==i?(d="application/json; charset=utf-8",u="json",c=e.proxy(n,this)):(d="text/xml",u="xml",r=r.XMLA,c=e.proxy(n,t.olap.base,o),m=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)),p={type:a,url:l,data:r,async:m,contentType:d,dataType:u,success:c,xhrFields:{withCredentials:h},complete:t.proxy(function(){var e={action:t.isNullOrUndefined(o)||t.isNullOrUndefined(o.action)?JSON.parse(r).action:o.action,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",e)},this),error:t.proxy(function(e){void 0!==this._waitingPopup&&null!=this._waitingPopup&&this._waitingPopup.hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide();var t={action:this._currentAction,customObject:this.model.customObject,element:this.element,Message:e};this._trigger("renderFailure",t),this.renderChartFromJSON("")},this)},h||delete p.xhrFields,e.ajax(p)},doPostBack:function(t,i){var a=e("<form>").attr({action:t,method:"POST",name:"export"}),l=function(t,i){e('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(a)};for(var r in i)l(r,i[r]);a.appendTo(document.body).submit().remove()}}),t.PivotChart.Locale=t.PivotChart.Locale||{},t.PivotChart.Locale["en-US"]={Measure:"Measure",Row:"Row",Column:"Column",Value:"Value",Expand:"Expand",Collapse:"Collapse",Exit:"Exit",ChartTypes:"Chart Types",TDCharts:"3D Charts",Tooltip:"Tooltip",Exporting:"Exporting",Line:"Line",Spline:"Spline",Column:"Column",Area:"Area",SplineArea:"Spline Area",StepLine:"Step Line",StepArea:"Step Area",Pie:"Pie",Bar:"Bar",StackingArea:"Stacking Area",StackingColumn:"Stacking Column",StackingBar:"Stacking Bar",Pyramid:"Pyramid",Funnel:"Funnel",Doughnut:"Doughnut",Scatter:"Scatter",Bubble:"Bubble",TreeMap:"TreeMap",ColumnTD:"Column 3D",PieTD:"Pie 3D",BarTD:"Bar 3D",StackingBarTD:"StackingBar 3D",StackingColumnTD:"StackingColumn 3D",Excel:"Excel",Word:"Word",Pdf:"PDF",PNG:"PNG",EMF:"EMF",GIF:"GIF",JPG:"JPG",BMP:"BMP",ZoomIn:"Zoom In",ZoomOut:"Zoom Out",Legend:"Legend",SmartLabels:"Smart Labels",Interactions:"Interactions",Zooming:"Zooming",Rotate45:"Rotate45",Rotate90:"Rotate90",Trim:"Trim",MultipleRows:"Multiple Rows",Wrap:"Wrap",Hide:"Hide",WrapByWord:"Wrap By word",CrossHair:"Cross Hair",TrackBall:"Track Ball",DisableTD:"Disable 3D Charts",None:"None",Exception:"Exception",OK:"OK"},t.PivotChart.ChartTypes={Line:"line",Spline:"spline",Column:"column",Area:"area",SplineArea:"splinearea",StepLine:"stepline",StepArea:"steparea",Pie:"pie",Bar:"bar",StackingArea:"stackingarea",StackingColumn:"stackingcolumn",StackingBar:"stackingbar",Pyramid:"pyramid",Funnel:"funnel",Doughnut:"doughnut",Scatter:"scatter",Bubble:"bubble",WaterFall:"waterfall"},t.PivotChart.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv",PNG:"png",JPG:"jpg",EMF:"emf",GIF:"gif",BMP:"bmp"},t.PivotChart.SymbolShapes={None:"none",LeftArrow:"leftarrow",RightArrow:"rightarrow",Circle:"circle",Cross:"cross",HorizLine:"horizline",VertLine:"vertline",Diamond:"diamond",Rectangle:"rectangle",Triangle:"triangle",InvertedTriangle:"invertedtriangle",Hexagon:"hexagon",Pentagon:"pentagon",Star:"star",Ellipse:"ellipse",Wedge:"wedge",Trapezoid:"trapezoid",UpArrow:"uparrow",DownArrow:"downarrow",Image:"image"},t.PivotChart.AnalysisMode={Olap:"olap",Pivot:"pivot"},t.PivotChart.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"},t.PivotChart.ExportMode={ClientMode:"clientmode",ServerMode:"servermode"}}(jQuery,Syncfusion)})},1057:function(e,t){e.exports="ej-pivotchart {\r\n    display: block;\r\n    height: 500px;\r\n    width: 100%; \r\n}\r\n.e-pivotchart{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},1332:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var l,r=arguments.length,n=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(n=(r<3?l(n):r>3?l(t,i,n):l(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_chartvalues(),this.size=e.size(),this.legend=e.legend(),this.load="loadTheme",this.commonSeriesOptions=e.commonSeriesOptions(),this.primaryYAxis=e.primaryYAxis(),this.type="column",this.zooming=e.zooming(),this.chartType=["Line","Spline","Column","Area","SplineArea","StepLine","StepArea","Pie","Bar","StackingArea","StackingColumn","StackingBar","Pyramid","Funnel","Doughnut","Scatter","Bubble"],this.value="Column"}return e.prototype.onTypeChange=function(e){var t=$(".e-pivotchart").data("ejPivotChart");t.model.type=e.text.toLowerCase(),t.model.commonSeriesOptions.type=e.text.toLowerCase(),jQuery.inArray(t.model.type,["line","spline","area","splinearea","stepline","steparea","stackingarea","scatter"])>-1?t.model.commonSeriesOptions.marker={shape:ej.PivotChart.SymbolShapes.Circle,size:{height:12,width:12},visible:!0,connectorLine:{height:30,type:"line"},border:{width:3,color:"white"}}:jQuery.inArray(t.model.type,["funnel","pyramid"])>-1?t.model.commonSeriesOptions.marker={dataLabel:{visible:!0,shape:"none",font:{color:"white",size:"12px",fontWeight:"lighter"}}}:t.model.commonSeriesOptions.marker={visible:!1},"pyramid"==t.model.type||"funnel"==t.model.type?t.model.legend.rowCount=1:t.model.legend.rowCount=2,jQuery.inArray(t.model.type,["pie","doughnut"])>-1?t.model.commonSeriesOptions.explode=!0:t.model.commonSeriesOptions.explode=!1;var i={JsonRecords:JSON.stringify(t.getJSONRecords()),OlapReport:t.getOlapReport()};$(".e-pivotchart").ejPivotChart("renderControlSuccess",i)},e=a([r.Component({selector:"ej-app",template:i(1831),styles:[i(2001)],providers:[n.PivotDataService]}),l("design:paramtypes",[n.PivotDataService])],e)}();t.ChartTypesComponent=s},1333:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var l,r=arguments.length,n=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(n=(r<3?l(n):r>3?l(t,i,n):l(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_chartvalues(),this.size=e.size(),this.legend=e.legend(),this.load="loadTheme",this.commonSeriesOptions=e.commonSeriesOptions(),this.primaryYAxis=e.primaryYAxis(),this.type="column",this.zooming=e.zooming(),this.exportOptions=["Excel","Word","PDF","PNG","EMF","GIF","JPG","BMP"],this.value="Excel",this.Export="Export"}return e.prototype.renderPivotChart=function(e){var t=$("#PivotChart1").data("ejPivotChart"),i=$("#rdbRelational").data("ejRadioButton");$(".e-pivotchart").remove();var a=ej.buildTag("div#PivotChart1","",{float:"left"})[0].outerHTML;$(a).appendTo(".cols-sample-area"),t.destroy();var l={data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"},{fieldName:"Date",fieldCaption:"Date"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"}],filters:[]};$("#PivotChart1").ejPivotChart({dataSource:i.model.checked?l:{data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]},enableAnimation:!0,isResponsive:!0,type:ej.PivotChart.ChartTypes.Column,tooltip:{visible:!0},size:{height:"460px",width:"100%"},legend:{visible:!0},load:"loadTheme"})},e.prototype.ExportBtnClick=function(e){var t=$("#PivotChart1").data("ejPivotChart"),i=$("#exportOptions").data("ejDropDownList").selectedTextValue.toLowerCase(),a=t.model.operationalMode;switch(t.model.operationalMode=ej.PivotChart.OperationalMode.ClientMode,i){case"excel":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/ExcelExport","sample");break;case"word":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/WordExport","sample");break;case"pdf":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/PDFExport","sample");break;case"png":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/ImageExport","sample",ej.PivotChart.ExportOptions.PNG);break;case"emf":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/ImageExport","sample",ej.PivotChart.ExportOptions.EMF);break;case"gif":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/ImageExport","sample",ej.PivotChart.ExportOptions.GIF);break;case"jpg":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/ImageExport","sample",ej.PivotChart.ExportOptions.JPG);break;case"bmp":t.exportPivotChart("//js.syncfusion.com/ejservices/api/PivotChart/Olap/ImageExport","sample",ej.PivotChart.ExportOptions.BMP)}t.model.operationalMode=a},e=a([r.Component({selector:"ej-app",template:i(1832),styles:[i(1057)],providers:[n.PivotDataService]}),l("design:paramtypes",[n.PivotDataService])],e)}();t.ExportingComponent=s},1334:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var l,r=arguments.length,n=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(n=(r<3?l(n):r>3?l(t,i,n):l(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_MultipleAxesvalues(),this.size=e.size(),this.legend=e.legend(),this.load="loadTheme",this.commonSeriesOptions=e.commonSeriesOptions(),this.primaryYAxis=e.primaryYAxisOlap(),this.primaryXAxis=e.primaryXAxis(),this.type="column",this.axes=e.axes()}return e.prototype.onBeforeRender=function(e){for(var t=0;t<e.series.length;t++)e.series[t].name.indexOf("Internet Sales Amount")>-1&&(e.series[t].yAxisName="yAxisConfig",e.series[t].type="spline",e.series[t].marker.visible=!0);return e},e=a([r.Component({selector:"ej-app",template:i(1833),styles:[i(2002)],providers:[n.PivotDataService]}),l("design:paramtypes",[n.PivotDataService])],e)}();t.MultipleAxesComponent=s},1335:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var l,r=arguments.length,n=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(n=(r<3?l(n):r>3?l(t,i,n):l(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_Olapvalues(),this.size=e.size(),this.legend=e.legend(),this.load="loadTheme",this.commonSeriesOptions=e.commonSeriesOptions(),this.primaryYAxis=e.primaryYAxisOlap(),this.primaryXAxis=e.primaryXAxis(),this.type="column",this.zooming=e.zooming()}return e=a([r.Component({selector:"ej-app",template:i(1834),styles:[i(2003)],providers:[n.PivotDataService]}),l("design:paramtypes",[n.PivotDataService])],e)}();t.OlapComponent=s},1336:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var l,r=arguments.length,n=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(n=(r<3?l(n):r>3?l(t,i,n):l(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),n=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_chartvalues(),this.size=e.size(),this.legend=e.legend(),this.load="loadTheme",this.commonSeriesOptions=e.commonSeriesOptions(),this.primaryYAxis=e.primaryYAxis(),this.type="column",this.zooming=e.zooming()}return e=a([r.Component({selector:"ej-app",template:i(1835),styles:[i(1057)],providers:[n.PivotDataService]}),l("design:paramtypes",[n.PivotDataService])],e)}();t.RelationalComponent=s},1498:function(e,t,i){"use strict";var a=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function a(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(a.prototype=i.prototype,new a)}}();Object.defineProperty(t,"__esModule",{value:!0}),i(1039);var l=i(12),r=i(5),n=function(e){function t(t,i,a,l){var n=e.call(this,"PivotChart",t,i,[],a,l)||this;return n.el=t,n.cdRef=i,n._ejIterableDiffers=a,n._ejkeyvaluediffers=l,n.load_output=new r.EventEmitter,n.afterServiceInvoke_output=new r.EventEmitter,n.beforeServiceInvoke_output=new r.EventEmitter,n.beforeSeriesRender_output=new r.EventEmitter,n.drillSuccess_output=new r.EventEmitter,n.renderComplete_output=new r.EventEmitter,n.renderFailure_output=new r.EventEmitter,n.renderSuccess_output=new r.EventEmitter,n.beforeExport_output=new r.EventEmitter,n}return a(t,e),t.decorators=[{type:r.Component,args:[{selector:"ej-pivotchart",template:""}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:r.ChangeDetectorRef},{type:r.IterableDiffers},{type:r.KeyValueDiffers}]},t.propDecorators={analysisMode_input:[{type:r.Input,args:["analysisMode"]}],cssClass_input:[{type:r.Input,args:["cssClass"]}],zooming_input:[{type:r.Input,args:["zooming"]}],commonSeriesOptions_input:[{type:r.Input,args:["commonSeriesOptions"]}],dataSource_input:[{type:r.Input,args:["dataSource"]}],customObject_input:[{type:r.Input,args:["customObject"]}],enable3D_input:[{type:r.Input,args:["enable3D"]}],enableRTL_input:[{type:r.Input,args:["enableRTL"]}],enableMultiLevelLabels_input:[{type:r.Input,args:["enableMultiLevelLabels"]}],isResponsive_input:[{type:r.Input,args:["isResponsive"]}],legend_input:[{type:r.Input,args:["legend"]}],locale_input:[{type:r.Input,args:["locale"]}],operationalMode_input:[{type:r.Input,args:["operationalMode"]}],axes_input:[{type:r.Input,args:["axes"]}],primaryXAxis_input:[{type:r.Input,args:["primaryXAxis"]}],primaryYAxis_input:[{type:r.Input,args:["primaryYAxis"]}],rotation_input:[{type:r.Input,args:["rotation"]}],enableContextMenu_input:[{type:r.Input,args:["enableContextMenu"]}],serviceMethodSettings_input:[{type:r.Input,args:["serviceMethodSettings"]}],size_input:[{type:r.Input,args:["size"]}],title_input:[{type:r.Input,args:["title"]}],url_input:[{type:r.Input,args:["url"]}],enableXHRCredentials_input:[{type:r.Input,args:["enableXHRCredentials"]}],zooming_enableScrollbar_input:[{type:r.Input,args:["zooming.enableScrollbar"]}],commonSeriesOptions_type_input:[{type:r.Input,args:["commonSeriesOptions.type"]}],dataSource_cube_input:[{type:r.Input,args:["dataSource.cube"]}],dataSource_sourceInfo_input:[{type:r.Input,args:["dataSource.sourceInfo"]}],dataSource_providerName_input:[{type:r.Input,args:["dataSource.providerName"]}],dataSource_data_input:[{type:r.Input,args:["dataSource.data"]}],dataSource_catalog_input:[{type:r.Input,args:["dataSource.catalog"]}],serviceMethodSettings_drillDown_input:[{type:r.Input,args:["serviceMethodSettings.drillDown"]}],serviceMethodSettings_exportPivotChart_input:[{type:r.Input,args:["serviceMethodSettings.exportPivotChart"]}],serviceMethodSettings_initialize_input:[{type:r.Input,args:["serviceMethodSettings.initialize"]}],serviceMethodSettings_paging_input:[{type:r.Input,args:["serviceMethodSettings.paging"]}],title_text_input:[{type:r.Input,args:["title.text"]}],dataSource_columns_input:[{type:r.Input,args:["dataSource.columns"]}],dataSource_rows_input:[{type:r.Input,args:["dataSource.rows"]}],dataSource_values_input:[{type:r.Input,args:["dataSource.values"]}],dataSource_filters_input:[{type:r.Input,args:["dataSource.filters"]}],options:[{type:r.Input,args:["options"]}],load_output:[{type:r.Output,args:["load"]}],afterServiceInvoke_output:[{type:r.Output,args:["afterServiceInvoke"]}],beforeServiceInvoke_output:[{type:r.Output,args:["beforeServiceInvoke"]}],beforeSeriesRender_output:[{type:r.Output,args:["beforeSeriesRender"]}],drillSuccess_output:[{type:r.Output,args:["drillSuccess"]}],renderComplete_output:[{type:r.Output,args:["renderComplete"]}],renderFailure_output:[{type:r.Output,args:["renderFailure"]}],renderSuccess_output:[{type:r.Output,args:["renderSuccess"]}],beforeExport_output:[{type:r.Output,args:["beforeExport"]}]},t}(l.EJComponents);t.PivotChartComponent=n,t.EJ_PIVOTCHART_COMPONENTS=[n]},1831:function(e,t){e.exports='<ej-pivotchart [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values"\r\n\t[commonSeriesOptions]="commonSeriesOptions" [size]="size" [primaryYAxis]="primaryYAxis" [legend]="legend">\r\n</ej-pivotchart>\r\n<div id="property-window" class="box wide" style="width: 350px">\r\n    <table>\r\n        <tr>\r\n            <td>\r\n                <div style="margin: 10px 10px 20px 0px"><b>Chart Type</b></div>\r\n            </td>\r\n            <td>\r\n                <input style="margin: -25px 0 0 100px;" id="selectChart" ej-dropdownlist  [dataSource]="chartType" [(value)]="value" (ejchange)= "onTypeChange($event)"/>\r\n            </td>\r\n        </tr>\r\n    </table> \r\n</div>'},1832:function(e,t){e.exports='<ej-pivotchart id="PivotChart1" [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values"\r\n\t[commonSeriesOptions]="commonSeriesOptions" [size]="size" [primaryYAxis]="primaryYAxis" [legend]="legend">\r\n</ej-pivotchart>\r\n<div id="property-window" class="box wide">\r\n    <div class="row">\r\n        <table width="300px">\r\n            <tr>\r\n                <td class="chkrad">\r\n                    Export Option :\r\n                </td>\r\n                <td class="chkrad" colspan="2">\r\n                    <input id="exportOptions" ej-dropdownlist  [dataSource]="exportOptions" [(value)]="value" />\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="row" style="margin:20px 0px 10px 20px">\r\n        <input style="margin: 28px 0 0 50px; float: left" id="export" ej-button size="normal" (click)="ExportBtnClick($event)" value="Export" text="Export" />\r\n    </div>\r\n</div>'},1833:function(e,t){e.exports='<ej-pivotchart [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [commonSeriesOptions]="commonSeriesOptions" [size]="size" [primaryXAxis]="primaryXAxis" [primaryYAxis]="primaryYAxis" [legend]="legend" [axes]="axes" (beforeSeriesRender)="onBeforeRender($event)">\r\n</ej-pivotchart>'},1834:function(e,t){e.exports='<ej-pivotchart [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values"  [commonSeriesOptions]="commonSeriesOptions" [size]="size" [primaryXAxis]="primaryXAxis" [primaryYAxis]="primaryYAxis" [legend]="legend" [zooming]="zooming" >\r\n</ej-pivotchart>'},1835:function(e,t){e.exports='<ej-pivotchart [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [commonSeriesOptions]="commonSeriesOptions" [size]="size" [primaryYAxis]="primaryYAxis" [legend]="legend" [zooming]="zooming">\r\n</ej-pivotchart>'},2001:function(e,t){e.exports="ej-pivotchart {\r\n    display: block;\r\n    height: 500px;\r\n    width: 100%; \r\n}\r\n.e-pivotchart{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},2002:function(e,t){e.exports="ej-pivotchart {\r\n    display: block;\r\n    height: 500px;\r\n    width: 100%; \r\n}\r\n.e-pivotchart{\r\n    position: inherit !important;\r\n}"},2003:function(e,t){e.exports="ej-pivotchart {\r\n    display: block;\r\n    height: 500px;\r\n    width: 100%; \r\n}\r\n.e-pivotchart{\r\n    position: inherit !important;\r\n}"},446:function(e,t,i){"use strict";var a=this&&this.__decorate||function(e,t,i,a){var l,r=arguments.length,n=r<3?t:null===a?a=Object.getOwnPropertyDescriptor(t,i):a;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,a);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(n=(r<3?l(n):r>3?l(t,i,n):l(t,i))||n);return r>3&&n&&Object.defineProperty(t,i,n),n};Object.defineProperty(t,"__esModule",{value:!0});var l=i(5),r=i(78),n=i(64),s=i(1498),o=i(413),d=i(1336),u=i(1335),c=i(1332),p=i(1334),m=i(1333);t.pivotchartAppRoutes=[{path:"relational",component:d.RelationalComponent,data:{name:"Relational",location:"app/components/pivotchart/relational.component"}},{path:"olap",component:u.OlapComponent,data:{name:"OLAP",location:"app/components/pivotchart/olap.component"}},{path:"chartTypes",component:c.ChartTypesComponent,data:{name:"Chart Types",location:"app/components/pivotchart/chartTypes.component"}},{path:"multipleAxes",component:p.MultipleAxesComponent,data:{name:"Multiple Axes",location:"app/components/pivotchart/multipleAxes.component"}},{path:"exporting",component:m.ExportingComponent,data:{name:"Exporting",location:"app/components/pivotchart/exporting.component"}},{path:"",redirectTo:"relational"}],t.PivotChartRouting=r.RouterModule.forChild(t.pivotchartAppRoutes);var h=function(){function e(){}return e=a([l.NgModule({imports:[t.PivotChartRouting,n.FormsModule,o.SharedModule],declarations:[d.RelationalComponent,u.OlapComponent,c.ChartTypesComponent,p.MultipleAxesComponent,m.ExportingComponent,s.EJ_PIVOTCHART_COMPONENTS]})],e)}();t.PivotChartModule=h}});