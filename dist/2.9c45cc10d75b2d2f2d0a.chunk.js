webpackJsonp([2],{1007:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype.pivot_data=function(){return[{Amount:100,Country:"Canada",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Alberta"},{Amount:200,Country:"Canada",Date:"FY 2006",Product:"Van",Quantity:3,State:"British Columbia"},{Amount:300,Country:"Canada",Date:"FY 2007",Product:"Car",Quantity:4,State:"Brunswick"},{Amount:150,Country:"Canada",Date:"FY 2008",Product:"Bike",Quantity:3,State:"Manitoba"},{Amount:200,Country:"Canada",Date:"FY 2006",Product:"Car",Quantity:4,State:"Ontario"},{Amount:100,Country:"Canada",Date:"FY 2007",Product:"Van",Quantity:1,State:"Quebec"},{Amount:200,Country:"France",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Charente-Maritime"},{Amount:250,Country:"France",Date:"FY 2006",Product:"Van",Quantity:4,State:"Essonne"},{Amount:300,Country:"France",Date:"FY 2007",Product:"Car",Quantity:3,State:"Garonne (Haute)"},{Amount:150,Country:"France",Date:"FY 2008",Product:"Van",Quantity:2,State:"Gers"},{Amount:200,Country:"Germany",Date:"FY 2006",Product:"Van",Quantity:3,State:"Bayern"},{Amount:250,Country:"Germany",Date:"FY 2007",Product:"Car",Quantity:3,State:"Brandenburg"},{Amount:150,Country:"Germany",Date:"FY 2008",Product:"Car",Quantity:4,State:"Hamburg"},{Amount:200,Country:"Germany",Date:"FY 2008",Product:"Bike",Quantity:4,State:"Hessen"},{Amount:150,Country:"Germany",Date:"FY 2007",Product:"Van",Quantity:3,State:"Nordrhein-Westfalen"},{Amount:100,Country:"Germany",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Saarland"},{Amount:150,Country:"United Kingdom",Date:"FY 2008",Product:"Bike",Quantity:5,State:"England"},{Amount:250,Country:"United States",Date:"FY 2007",Product:"Car",Quantity:4,State:"Alabama"},{Amount:200,Country:"United States",Date:"FY 2005",Product:"Van",Quantity:4,State:"California"},{Amount:100,Country:"United States",Date:"FY 2006",Product:"Bike",Quantity:2,State:"Colorado"},{Amount:150,Country:"United States",Date:"FY 2008",Product:"Car",Quantity:3,State:"New Mexico"},{Amount:200,Country:"United States",Date:"FY 2005",Product:"Bike",Quantity:4,State:"New York"},{Amount:250,Country:"United States",Date:"FY 2008",Product:"Car",Quantity:3,State:"North Carolina"},{Amount:300,Country:"United States",Date:"FY 2007",Product:"Van",Quantity:4,State:"South Carolina"}]},e.prototype.pivot_rows=function(){return[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}]},e.prototype.pivot_columns=function(){return[{fieldName:"Product",fieldCaption:"Product"}]},e.prototype.pivot_values=function(){return[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}]},e.prototype.pivot_chartvalues=function(){return[{fieldName:"Amount",fieldCaption:"Amount"}]},e.prototype.pivot_Olaprows=function(){return[{fieldName:"[Date].[Fiscal]"}]},e.prototype.pivot_namedsetrows=function(){return[{fieldName:"[Core Product Group]",isNamedSets:!0}]},e.prototype.pivot_gaugerows=function(){return[{fieldName:"[Date].[Fiscal]",filterItems:{filterType:"include",values:["[Date].[Fiscal].[Fiscal Year].&amp;[2004]"]}}]},e.prototype.pivot_gaugecolumns=function(){return[{fieldName:"[Customer].[Customer Geography]",filterItems:{filterType:"include",values:["[Customer].[Customer Geography].[Country].&amp;[Australia]"]}}]},e.prototype.pivot_Olapcolumns=function(){return[{fieldName:"[Customer].[Customer Geography]"}]},e.prototype.pivot_Olapvalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}]},e.prototype.pivot_MultipleAxesvalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"},{fieldName:"[Measures].[Customer Count]"}],axis:"columns"}]},e.prototype.pivot_gaugevalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"},{fieldName:"[Measures].[Internet Revenue Status]"},{fieldName:"[Measures].[Internet Revenue Trend]"},{fieldName:"[Measures].[Internet Revenue Goal]"}],axis:"columns"}]},e.prototype.pivot_Olapfilters=function(){return[]},e.prototype.pivot_cube=function(){return"Adventure Works"},e.prototype.pivot_datacube=function(){return"//bi.syncfusion.com/olap/msmdpump.dll"},e.prototype.pivot_catelog=function(){return"Adventure Works DW 2008 SE"},e.prototype.size=function(){return{height:"460px",width:"950px"}},e.prototype.primaryYAxis=function(){return{title:{text:"Amount"}}},e.prototype.primaryYAxisOlap=function(){return{title:{text:"Customer Count"}}},e.prototype.primaryXAxis=function(){return{title:{text:"Fiscal Year"},labelRotation:0}},e.prototype.legend=function(){return{visible:!0}},e.prototype.commonSeriesOptions=function(){return{enableAnimation:!0,type:ej.PivotChart.ChartTypes.Column,tooltip:{visible:!0}}},e.prototype.zooming=function(){return{enableScrollbar:!0}},e.prototype.axes=function(){return[{orientation:"vertical",rowIndex:0,majorGridLines:{visible:!1},axisLine:{visible:!0},name:"yAxisConfig",title:{text:"Internet Sales Amount"},opposedPosition:!0,labelFormat:"c"}]},e.prototype.scales=function(){return[{showRanges:!0,radius:150,showScaleBar:!0,size:1,border:{width:.5},showIndicators:!0,showLabels:!0,pointers:[{showBackNeedle:!0,backNeedleLength:20,length:120,width:7},{type:"marker",markerType:"diamond",distanceFromScale:5,placement:"center",backgroundColor:"#29A4D9",length:25,width:15}],ticks:[{type:"major",distanceFromScale:2,height:16,width:1,color:"#8c8c8c"},{type:"minor",height:6,width:1,distanceFromScale:2,color:"#8c8c8c"}],labels:[{color:"#8c8c8c"}],ranges:[{distanceFromScale:-5,backgroundColor:"#fc0606",border:{color:"#fc0606"}},{distanceFromScale:-5}],customLabels:[{position:{x:180,y:290},font:{size:"10px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"},{position:{x:180,y:320},font:{size:"10px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"},{position:{x:180,y:150},font:{size:"12px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"}]}]},e}();t.PivotDataService=l},1009:function(e,t,i){var l,a,r;
/*!
*  filename: ej.olap.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.olap.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(o){a=[i(4)],void 0===(r="function"==typeof(l=o)?l.apply(t,a):l)||(e.exports=r)}(function(){!function(e,t,i){t.olap=t.olap||{},t.olap.base={_initProperties:function(){this._columnHeaders=[],this._rowHeaders=[],this._valueCells=[],this.pivotEngine=[],this.olapCtrlObj=null,this._cBIndx=null,this._rBIndx=null,this._OlapDataSource,this._measureDt={},this._cTotIndexInfo=null,this._rTotIndexInfo=null,this._kpi=null,this._rowCount=0,this._colCount=0,this._isPaging=!1,this._indexRCell=0,this._indexCCell=0},_initControlProperties:function(e){e._drilledCellSet=e.model.enablePaging||e.model.enableVirtualScrolling?t.isNullOrUndefined(e._drilledCellSet)?[]:e._drilledCellSet:[],e.XMLACellSet=null,e._isMondrian=e.model.dataSource.providerName==t.olap.Providers.Mondrian,(t.isNullOrUndefined(e._fieldData)||!t.isNullOrUndefined(e._fieldData)&&t.isNullOrUndefined(e._fieldData.hierarchy))&&this._getFieldItemsInfo(e),this._currIndex={},this._isRowDrilled=!1,this._isColDrilled=!1,this._isNoSummary="nosummaries"==e.model.layout},getJSONData:function(i,l,a){var r,o,n;i.action&&("initialLoad"==i.action||"navPaging"==i.action)&&(this._initControlProperties(a),this._applyTrim(a)),"loadFieldElements"==i.action&&(a._baseSavedProperties=e.extend(!0,{},{drilledCellSet:a._drilledCellSet,XMLACellSet:a.XMLACellSet,columnHeaders:this._columnHeaders,rowHeaders:this._rowHeaders,valueCells:this._valueCells,pivotEngine:this.pivotEngine,olapCtrlObj:this.olapCtrlObj,cBIndx:this._cBIndx,rBIndx:this._rBIndx,OlapDataSource:this._OlapDataSource,measureDt:this._measureDt,cTotIndexInfo:this._cTotIndexInfo,rTotIndexInfo:this._rTotIndexInfo,kpi:this._kpi,rowCount:this._rowCount,colCount:this._colCount,isPaging:this._isPaging,indexRCell:this._indexRCell,indexCCell:this._indexCCell})),this._initProperties(),this.olapCtrlObj=a,this._OlapDataSource=l,l.data,a.model.enableGroupingBar&&"loadFieldElements"!=i.action&&a._createGroupingBar(l),this._isPaging=!(!this.olapCtrlObj.model.enablePaging&&!this.olapCtrlObj.model.enableVirtualScrolling||t.isNullOrUndefined(this._OlapDataSource.pagerOptions)||0==this._OlapDataSource.pagerOptions.categoricalPageSize||0==this._OlapDataSource.pagerOptions.seriesPageSize),r=l.MDXQuery?l.MDXQuery:this._getParsedMDX(l,l.cube,!(!i.action||"navPaging"==i.action||!this._isPaging||t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions))),n=this._getConnectionInfo(this.olapCtrlObj.model.dataSource.data),o=t.isNullOrUndefined(l.providerName)||l.providerName==t.olap.Providers.SSAS?'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+r+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+l.catalog+"</Catalog> <LocaleIdentifier>"+n.LCID+"</LocaleIdentifier> </PropertyList> </Properties></Execute> </Body> </Envelope>":'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+r+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+l.sourceInfo+"</DataSourceInfo><Catalog>"+l.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>","drilldown"!=i.action||this._isPaging?this.olapCtrlObj.doAjaxPost("POST",n.url,{XMLA:o},i.action&&"navPaging"!=i.action&&this._isPaging&&!t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)?this._generatePagingData:this._generateJSONData,null,i):this.olapCtrlObj.doAjaxPost("POST",n.url,{XMLA:o},this._onDemandExpand,null,i)},_getParsedMDX:function(e,l,a){var r,o,n,s,d,h;if(e!=i){if(r="",(d=e.providerName==t.olap.Providers.Mondrian)&&0==e.columns.length&&!("columns"==e.values[0].axis&&e.values[0].measures.length>0))return"";o=t.olap._mdxParser._getRowMDX(e),n=t.olap._mdxParser._getcolumnMDX(e),delete e._isCollapse,o=o.length>0?this._isPaging&&!a||d?"("+o+")":"NON EMPTY("+o+")":"",n=n.length>0?this._isPaging&&!a||d?"("+n+")":"NON EMPTY("+n+")":"",!this._isPaging||a||t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)||(o=(h=this._getPagingQuery(o,n)).rowQuery,n=h.columnQuery),s=t.olap._mdxParser._getSlicerMDX(e,this.olapCtrlObj),r="\nSelect \n"+(""==n?"{}":n)+"\ndimension properties MEMBER_TYPE,CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME  ON COLUMNS \n"+(""==o?"":","+o+"\ndimension properties MEMBER_TYPE,CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME  ON ROWS")+"\n "+t.olap._mdxParser._getIncludefilterQuery(e,l,this.olapCtrlObj)+s+"\n CELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE \n ",""==n&&r.replace(/NON EMPTY/g," "),r=this._getCalculatedItems(r)}return r},_getCalculatedItems:function(i){var l,a,r=this.olapCtrlObj.model.calculatedMembers;if(r&&r.length>0){for(l="\nWITH",a=0;a<r.length;a++){var o=(r[a].expression.indexOf("Measure")>-1?"[Measures].":r[a].hierarchyUniqueName+".")+"["+(r[a].caption||r[a].name)+"]",n=t.isNullOrUndefined(r[a].formatString)?t.isNullOrUndefined(r[a].format)?null:r[a].format:r[a].formatString;l+="\n MEMBER "+o+" as ("+r[a].expression+" ) "+(t.isNullOrUndefined(n)?"":', FORMAT_STRING ="'+e.trim(n)+'"')}return(l=l.replace(/\&/g,"&amp;"))+" "+i}return i},_getPagingQuery:function(e,t){var i=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj._categCurrentPage)&&this._colCount>0?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize):this.olapCtrlObj._categCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage),l=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj._seriesCurrentPage)&&this._rowCount>0?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize):this.olapCtrlObj._seriesCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage),a=e;return{rowQuery:""!=e?"SUBSET({"+(this.olapCtrlObj._isMondrian?"":"NONEMPTY")+"("+e+(this.olapCtrlObj._isMondrian||""==t?"":","+t)+")},"+((0==l?1:l)-1)*this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize+","+this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize+")":"",columnQuery:""!=t?"SUBSET({"+(this.olapCtrlObj._isMondrian?"":"NONEMPTY")+"("+t+(this.olapCtrlObj._isMondrian||""==a?"":","+a)+")},"+((0==i?1:i)-1)*this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize+","+this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize+")":""}},_getAxisElementsUName:function(e){for(var t="",i=0;i<e.length;i++)t+=""==t?"{"+e[i].uniqueName+"}":", {"+e[i].uniqueName+"}";return t},_generatePagingData:function(i,l){var a,r,o;if(e(l).find("Error").length>0)return t.Pivot._createErrorDialog(e(l).find("faultstring").text(),i.action,this.olapCtrlObj),!1;a=e(l).find("Axes, CellData"),this._rowCount=e(a.find("Axis[name|='Axis1']").find("Tuples")).length>0?e(a.find("Axis[name|='Axis1']").find("Tuples")[0]).children().length:0,this._colCount=e(a.find("Axis[name|='Axis0']").find("Tuples")).length>0?e(a.find("Axis[name|='Axis0']").find("Tuples")[0]).children().length:0,r=this._getParsedMDX(this.olapCtrlObj.model.dataSource,this.olapCtrlObj.model.dataSource.cube,!1),o=this._getConnectionInfo(this.olapCtrlObj.model.dataSource.data),this.olapCtrlObj._isMondrian&&(this._controlObj=this.olapCtrlObj),this.olapCtrlObj.doAjaxPost("POST",o.url,{XMLA:t.olap._mdxParser.getSoapMsg(r,this.olapCtrlObj.model.dataSource.data,this.olapCtrlObj.model.dataSource.catalog)},this._generateJSONData,null,i)},_generateJSONData:function(l,a){var r,o,n,s,d,h,u,c,p,m,g,f,_;if(this.olapCtrlObj.model.dataSource=this._OlapDataSource,this._isPaging&&"drilldown"==l.action&&this._onDemandExpand(l,a),r=[],o=[],e(a).find("Error").length>0)return t.Pivot._createErrorDialog(e(a).find("faultstring").text(),"Error",this.olapCtrlObj),!1;if(e(a).find("Axis[name|='SlicerAxis']").remove(),this.olapCtrlObj.XMLACellSet=e(a).find("Axes, CellData"),[],"onDemandDrill"==l&&(this.olapCtrlObj.XMLACellSet=a),n=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"),s=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple"),n.length>0){if(d=e(this.olapCtrlObj.XMLACellSet[1]).children(),this._rowHeaders=this._getHeaderCollection(s,"rowheader"),this._columnHeaders=this._getHeaderCollection(n,"colheader"),this._valueCells=this._getValueCells(d,n.length),this._indexRCell="rowheader"==this._measureDt.axis?t.sum(this._rowHeaders.maxLvlLen)+1:t.sum(this._rowHeaders.maxLvlLen),this._indexCCell="colheader"==this._measureDt.axis?t.sum(this._columnHeaders.maxLvlLen)+1:t.sum(this._columnHeaders.maxLvlLen),this._rowHeaders.headers.length>0&&0==t.sum(this._rowHeaders.maxLvlLen)&&(this._indexRCell=this._rowHeaders.headers[0].length),this._columnHeaders.headers.length>0&&0==t.sum(this._columnHeaders.maxLvlLen)&&(this._indexCCell=this._columnHeaders.headers[0].length),this._isPaging)for(g=0;g<this._rowHeaders.headers.length;g++)for(_=0;_<this._columnHeaders.headers.length;_++)t.isNullOrUndefined(this._valueCells[g])?(this._valueCells[g]=[],this._valueCells[g][_]={FormatString:"#,#",Value:""}):t.isNullOrUndefined(this._valueCells[g][_])&&(this._valueCells[g][_]={FormatString:"#,#",Value:""});for(this._populateEngine(this._rowHeaders.headers,this._columnHeaders.headers,this._valueCells),e(this.olapCtrlObj).find(".e-pivotGridTable").remove(),this.olapCtrlObj._measureDt=this._measureDt,h=this._rowHeaders.headers.length+this._indexCCell,u=this._columnHeaders.headers.length+this._indexRCell,this.pivotEngine.length>1&&(h=this.pivotEngine.length),g=0;g<h;g++)for(_=0;_<u;_++)r[_]==i&&(r[_]=[]),this.pivotEngine[g]!=i&&this.pivotEngine[g][_]!=i?(r[_][g]={Index:_+","+g,CSS:""==this.pivotEngine[g][_].CSS?"none":this.pivotEngine[g][_].CSS==i?"value":this.pivotEngine[g][_].CSS,Value:this.pivotEngine[g][_].Value,State:this.pivotEngine[g][_].ChildCount>0?2:this.pivotEngine[g][_].ChildCount<0?1:0,RowSpan:this.pivotEngine[g][_].RowSpan!=i?this.pivotEngine[g][_].RowSpan:1,ColSpan:this.pivotEngine[g][_].ColSpan!=i?this.pivotEngine[g][_].ColSpan:1,Info:this.pivotEngine[g][_].UName+"::"+this.pivotEngine[g][_].LName+"::"+this.pivotEngine[g][_].Value+"::"+this.pivotEngine[g][_].PUName,Span:"Block"==this.pivotEngine[g][_].Span?"Block":"None",Expander:1},this.pivotEngine[g][_].kpiInfo&&(r[_][g].kpi=this.pivotEngine[g][_].kpi,r[_][g].kpiInfo=this.pivotEngine[g][_].kpiInfo),this.pivotEngine[g][_].ActualValue&&(r[_][g].ActualValue=this.pivotEngine[g][_].ActualValue,r[_][g].Format=this.pivotEngine[g][_].FormatString)):this.pivotEngine[g]!=i&&(c="none",g<this._indexCCell&&_<this._indexRCell&&(c="rowheader"),r[_][g]={Index:_+","+g,CSS:c,Value:"",State:0,RowSpan:1,ColSpan:1,Info:"",Span:"Block",Expander:0});for(g=0;g<u;g++)for(_=0;_<h;_++)r[g]!=i&&r[g][_]!=i&&o.push(r[g][_]);for(p=0,m=0;m<o.length&&0==parseInt(o[m].Index.split(",")[0]);m++)p++}if(this.olapCtrlObj._isExporting&&this.olapCtrlObj.model.enableCompleteDataExport){for(_=0;_<this._indexRCell;_++)for(f="",g=this._indexCCell;g<r[0].length;g++)""!=r[_][g].Info&&(f==r[_][g].Info?r[_][g].Span="Block":f=r[_][g].Info);for(g=0;g<this._indexCCell;g++)for(f="",_=this._indexRCell;_<r.length;_++)""!=r[_][g].Info&&(f==r[_][g].Info?r[_][g].Span="Block":f=r[_][g].Info);this.olapCtrlObj._fullExportedData={jsonObj:o,tranposeEngine:r,rowCount:p},this.olapCtrlObj._drilledCellSet=this.olapCtrlObj._baseSavedProperties.drilledCellSet,this.olapCtrlObj.XMLACellSet=this.olapCtrlObj._baseSavedProperties.XMLACellSet,this._columnHeaders=this.olapCtrlObj._baseSavedProperties.columnHeaders,this._rowHeaders=this.olapCtrlObj._baseSavedProperties.rowHeaders,this._valueCells=this.olapCtrlObj._baseSavedProperties.valueCells,this.pivotEngine=this.olapCtrlObj._baseSavedProperties.pivotEngine,this.olapCtrlObj=this.olapCtrlObj._baseSavedProperties.olapCtrlObj,this._cBIndx=this.olapCtrlObj._baseSavedProperties.cBIndx,this._rBIndx=this.olapCtrlObj._baseSavedProperties.rBIndx,this._OlapDataSource=this.olapCtrlObj._baseSavedProperties.OlapDataSource,this._measureDt=this.olapCtrlObj._baseSavedProperties.measureDt,this._cTotIndexInfo=this.olapCtrlObj._baseSavedProperties.cTotIndexInfo,this._rTotIndexInfo=this.olapCtrlObj._baseSavedProperties.rTotIndexInfo,this._kpi=this.olapCtrlObj._baseSavedProperties.kpi,this._rowCount=this.olapCtrlObj._baseSavedProperties.rowCount,this._colCount=this.olapCtrlObj._baseSavedProperties.colCount,this._isPaging=this.olapCtrlObj._baseSavedProperties.isPaging,this._indexRCell=this.olapCtrlObj._baseSavedProperties.indexRCell,this._indexCCell=this.olapCtrlObj._baseSavedProperties.indexCCell,this.olapCtrlObj._baseSavedProperties={}}else this.olapCtrlObj._pivotRecords={records:o,rowCount:p},"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotGrid"!=this.olapCtrlObj.pluginName?"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotChart"!=this.olapCtrlObj.pluginName&&"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotGauge"!=this.olapCtrlObj.pluginName&&"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotTreeMap"!=this.olapCtrlObj.pluginName?(this._renderPager(l),this.olapCtrlObj.generateJSON({baseObj:this,tranposeEngine:r,jsonObj:o})):(this.olapCtrlObj.generateJSON({baseObj:this},r),this._isPaging&&this._renderPager(l)):this._renderPivotGrid(l,o),this._columnHeaders=this._rowHeaders=this._valueCells=this.pivotEngine=[],this._cBIndx=this._rBIndx=null,this._measureDt={axis:"",posision:null},this._cTotIndexInfo=this._rTotIndexInfo=null},_renderPager:function(e){var i,l,a,r;this._isPaging&&("navPaging"!=e.action&&(t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)?this.olapCtrlObj.model.enablePaging&&(a={CategoricalCurrentPage:1,CategoricalPageSize:1,SeriesCurrentPage:1,SeriesPageSize:1},r={Column:1,Row:1},this.olapCtrlObj._pagerObj.initPagerProperties(r,a),this.olapCtrlObj._pagerObj.element.css("opacity","0.5"),this.olapCtrlObj._pagerObj.element.find(".e-pagerTextBox").attr("disabled","disabled"),this.olapCtrlObj._pagerObj._unwireEvents()):(i=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj._categCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize):this.olapCtrlObj._categCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage),l=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj._seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize):this.olapCtrlObj._seriesCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage),i=0==i?1:i,l=0==l?1:l,this._colCount=0==this._colCount?1:this._colCount,this._rowCount=0==this._rowCount?1:this._rowCount,this.olapCtrlObj.model.enablePaging?(a={CategoricalCurrentPage:i,CategoricalPageSize:this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:l,SeriesPageSize:this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize},r={Column:this._colCount,Row:this._rowCount},this.olapCtrlObj._pagerObj.element.css("opacity","1"),this.olapCtrlObj._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),this.olapCtrlObj._pagerObj._unwireEvents(),this.olapCtrlObj._pagerObj._wireEvents(),this.olapCtrlObj._pagerObj.initPagerProperties(r,a)):this.olapCtrlObj.model.enableVirtualScrolling&&(this.olapCtrlObj._categPageCount=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize),this.olapCtrlObj._seriesPageCount=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)),this.olapCtrlObj._categCurrentPage=i,this.olapCtrlObj._seriesCurrentPage=l,t.isNullOrUndefined(this.olapCtrlObj._pivotGrid)||(this.olapCtrlObj._pivotGrid._categCurrentPage=i,this.olapCtrlObj._pivotGrid._seriesCurrentPage=l,this.olapCtrlObj._pivotGrid._categPageCount=this.olapCtrlObj._categPageCount,this.olapCtrlObj._pivotGrid._seriesPageCount=this.olapCtrlObj._seriesPageCount))),t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)||(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage=this.olapCtrlObj._categCurrentPage,this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage=this.olapCtrlObj._seriesCurrentPage))},_renderPivotGrid:function(e,i){this.olapCtrlObj._dataModel="XMLA",this.olapCtrlObj.setJSONRecords(JSON.stringify(i)),this.olapCtrlObj.setOlapReport(this.olapCtrlObj.model.dataSource),this._renderPager(e),this.olapCtrlObj.model.enableGroupingBar&&this.olapCtrlObj._createGroupingBar(this.olapCtrlObj.model.dataSource),null!=this.olapCtrlObj.model.layout&&this.olapCtrlObj.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.olapCtrlObj.excelLikeLayout(i):this.olapCtrlObj.renderControlFromJSON(i),e.action&&("initialLoad"==e.action||"navPaging"==e.action)&&(this.olapCtrlObj._trigger("renderSuccess",this.olapCtrlObj),this.olapCtrlObj._fieldData={hierarchy:this.olapCtrlObj._fieldData.hierarchy,measures:this.olapCtrlObj._fieldData.measures})},_onDemandExpand:function(t,i){var l,a,r,o,n,s,d,h="",u=this.olapCtrlObj.XMLACellSet,c=e(this.olapCtrlObj.XMLACellSet).find("Axis[name='Axis0'] Tuple").length,p=e(this.olapCtrlObj.XMLACellSet).find("Axis[name='Axis1'] Tuple").length;p=p||1,e(i).find("CellData Cell").length,e(this.olapCtrlObj.XMLACellSet[1]).children().length,t.cellInfo.previousElements.split(">#>");var m=e(i).find("Axis[name|='Axis0']").find("Tuple"),g=e(i).find("Axis[name|='Axis1']").find("Tuple"),f=m.length;a=g.length,e(i).find("Axis[name='SlicerAxis']").remove();var _,v,b=t.cellInfo.itemPosition,C=0,S=!1,O="";for(v="rowheader"==t.cellInfo.axis?g[0]:m[0],h=_=e(v).find("Member:nth-child("+(b+1)+") PARENT_UNIQUE_NAME").text(),o=b+1;o>0;o--)u=e(u).find("Tuple Member:nth-child("+o+") UName:contains('"+_+"')").parents("tuple"),O=(_=e(v).find("Member:nth-child("+(o-1)+") UName").text())+O;if(h=O+h,r=u.index()+1,h=t.cellInfo.previousElements.split(">#>").join().replace(/,/g,""),l=t.cellInfo.preRepItm.split(">#>").join().replace(/,/g,""),this.olapCtrlObj._drilledCellSet&&(C=this.olapCtrlObj._drilledCellSet.length),h=h+" !#"+t.cellInfo.axis,this.olapCtrlObj._drilledCellSet[0]&&C)for(n=0;n<C;n++){for(s=this.olapCtrlObj._drilledCellSet[n].length,t.cellInfo.parentUniqueName,d=0;d<s;d++){if(t.cellInfo.previousElements.startsWith(this.olapCtrlObj._drilledCellSet[n][d].key)){this.olapCtrlObj._drilledCellSet[n].push({key:h,repItms:l}),S=!0;break}if(this.olapCtrlObj._drilledCellSet[n][d].key.startsWith(t.cellInfo.previousElements)){this.olapCtrlObj._drilledCellSet[n].splice(d,0,{key:h,repItms:l}),S=!0;break}}if(S)break}else this.olapCtrlObj._drilledCellSet[0]=[],this.olapCtrlObj._drilledCellSet[0][0]={key:h,repItms:l},S=!0;S||(this.olapCtrlObj._drilledCellSet[C]=[],this.olapCtrlObj._drilledCellSet[C].push({key:h,repItms:l})),this._isPaging||("rowheader"==t.cellInfo.axis?(e(i).find("Axis[name|='Axis1']").find("Tuple"),this._insertCellSet("rowheader",u,g,m,a,c,f,r,i)):(e(i).find("Axis[name|='Axis1']").find("Tuple"),this._insertCellSet("colheader",u,m,g,p,c,f,r,i)),this._generateJSONData("onDemandDrill",this.olapCtrlObj.XMLACellSet))},_insertCellSet:function(t,i,l,a,r,o,n,s,d){var h,u,c,p,m,g=e(e(d).find("CellData Cell")[0]).clone();e(g).find("FmtValue").text(""),i.length>1?e(i[0]).after(l):e(i).after(l),u=o,"rowheader"==t?h=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"):(h=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple"),u=n);var f=0,_=e(h).filter(function(t,i){if(a[f]&&e(i).find("UName").text()==e(a[f]).find("UName").text())return f++,!0}),v=0,b=!1;for(c=0;c<r;c++){var C,S="",O=0,y=0;for(C="rowheader"==t?(s+c)*u:c*(o+u)+s,p=0;p<u;p++)"rowheader"==t&&e(_[O]).index()==p||"colheader"==t&&e(_[v]).index()==c||!h.length?(m="rowheader"==t?c*n:v*n,S=e(e(d).find("CellData Cell")[m+O]).clone(),e(this.olapCtrlObj.XMLACellSet).find("CellData Cell:nth-child("+(C+y)+")").after(S),O++,b=!0):e(this.olapCtrlObj.XMLACellSet).find("CellData Cell:nth-child("+(C+y)+")").after(e(g).clone()),y++;"colheader"==t&&(b&&v++,b=!1)}this._setCellOrdinal(this.olapCtrlObj.XMLACellSet[1])},_clearDrilledCellSet:function(){for(var t,i=e.extend([],this.olapCtrlObj._drilledCellSet),l="",a=0;a<i.length;a++)(l=i[a][0].key.split("!#")).length&&(t=this._getDrilledMemeber({item:{previousElements:l[0]}})),t.length&&this._onDemandCollapse({drilledMembers:t,action:""},l[1])},_onDemandCollapse:function(i,l){e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"),e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple");try{this.olapCtrlObj.model.dataSource=t.olap._mdxParser._clearCollapsedItems(l,i.drilledMembers[i.drilledMembers.length-1],this.olapCtrlObj.model.dataSource),i.drilledMembers=i.drilledMembers.splice(0,i.drilledMembers.length-1)}catch(e){this.olapCtrlObj._ogridWaitingPopup.hide()}i.drilledMembers.length?this._onDemandCollapse({drilledMembers:i.drilledMembers,action:i.action},l):"collapse"==i.action&&(this.olapCtrlObj.model.dataSource._isCollapse=!0,delete this._currIndex.axis,this.getJSONData({action:"onDemandCollapse"},this.olapCtrlObj.model.dataSource,this.olapCtrlObj))},_removeCellSets:function(t,i,l,a,r,o){for(var n,s,d,h,u,c,p,m=t.length,g=r[0],f=0;f<i.length;f++)if(e(i[f]).find("UName").text()==e(g).find("UName").text()){p=i[f];break}if(n=m,s=e(p).index())if("rowheader"==o){for(c=l.length;n>0;)e(e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple")[s]).remove(),n--;for(u=ext=s;u<ext+m;u++)d=e(e(this.olapCtrlObj.XMLACellSet[1]).children()).splice(s*c,c),e(d).remove()}else{for(c=i.length,h=l.length;n>0;)e(e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple")[s]).remove(),n--;for(u=0;u<h;u++)d=e(e(this.olapCtrlObj.XMLACellSet[1]).children()).splice(c*u-u*m+s,m),e(d).remove()}this._setCellOrdinal(this.olapCtrlObj.XMLACellSet[1])},_getDrilledMemeber:function(t){for(var i,l,a=[],r=t.item.previousElements.split(">#>").join().replace(/,/g,""),o=this.olapCtrlObj._drilledCellSet,n=(a=e.map(this.olapCtrlObj._drilledCellSet,function(t){return a=e.map(t,function(e){if(e.key.startsWith(r))return e})}),0);n<o.length;n++)for(i=0,l=o[n];o[n]&&i<o[n].length;i++)l[i]&&l[i].key.startsWith(r)&&(l.splice(i,1),i--,l.length||(o.splice(n,1),n--));return a},_getHeaderCollection:function(t,l){var a,r,o,n,s,d,h,u,c,p,m,g,f=[],_="",v=[],b=null,C={},S={},O=this;if(a=e(t).filter(function(t,i){var a,n,s,d=e(i).find("Member"),h=!("4"==e(d[0]).find("MEMBER_TYPE").text())&&-1!=e(d[0]).find("LName").text().indexOf("[(All)]"),u=h?1:0,c=0;for(b=null,h?(o=0,_="total"):(_="",o=d.length),a=1,-1!=e(d[0]).find("LName").text().toLowerCase().indexOf("[measures]")&&(a=0);a<d.length;a++)n=!1,"colheader"==l&&O._OlapDataSource.columns[a]?(O._OlapDataSource.columns[a].hasAllMember||null!=O._OlapDataSource.columns[a].expression)&&(n=!0):"rowheader"==l&&O._OlapDataSource.rows[a]&&(O._OlapDataSource.rows[a].hasAllMember||null!=O._OlapDataSource.rows[a].expression)&&(n=!0),-1!=e(d[a]).find("LName").text().toLowerCase().indexOf("[measures]")||n?(c=h,S.axis=l,S.posision=a,4==parseInt(e(d[a]).find("MEMBER_TYPE").text())&&(-1!=(s=e(d[a]).find("UName").text().toLowerCase()).indexOf("trend]")?(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[a]).find("UName").text(),"trend"))&&(b="trend",S.isKpiExist=!0)):-1!=s.indexOf("status]")?(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[a]).find("UName").text(),"status"))&&(b="status",S.isKpiExist=!0)):-1!=s.indexOf("goal]")&&(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[a]).find("UName").text()+"::"+e(d[a]).find("Caption").text(),"goal"))&&(b="goal",S.isKpiExist=!0)))):c=-1!=e(d[a]).find("LName").text().indexOf("[(All)]"),(0==h&&1==c||1==h&&0==c)&&(u++,o=a,_="total"),h=c;return r=t,u<2&&f.push({selIndx:r,totLvl:o,type:_,kpi:b,kpiInfo:C}),u<2}).map(function(t,a){for(var r,o,n,s,d=e(a).find("Member"),h=[],u=0;u<d.length;u++)r=!1,o=parseInt(e(d[u]).find("LNum").text()),"colheader"==l&&O._OlapDataSource.columns[u]?O._OlapDataSource.columns[u].hasAllMember||null!=O._OlapDataSource.columns[u].expression?o+=1:r=null!=O._OlapDataSource.columns[u].expression:"rowheader"==l&&O._OlapDataSource.rows[u]&&(O._OlapDataSource.rows[u].hasAllMember||null!=O._OlapDataSource.rows[u].expression?o+=1:r=null!=O._OlapDataSource.rows[u].expression),n=e(d[u]).find("PARENT_UNIQUE_NAME").length?e(d[u]).find("PARENT_UNIQUE_NAME").text():"",h.push({CSS:l,Value:""==e(d[u]).find("Caption").text()?"(Blank)":e(d[u]).find("Caption").text(),ColSpan:1,RowSpan:1,HUName:e(d[u]).attr("Hierarchy"),LName:e(d[u]).find("LName").text(),UName:e(d[u]).find("UName").text(),ChildCount:parseInt(e(d[u]).find("CHILDREN_CARDINALITY").text()),PUName:n,isCalcMem:r,LNum:o,MemberType:parseInt(e(d[u]).find("MEMBER_TYPE").text())}),(-1!=e(d[u]).find("LName").text().toLowerCase().indexOf("[measures]")||r)&&f[t].kpi&&(h[h.length-1].kpiInfo=f[t].kpiInfo,h[h.length-1].kpi=f[t].kpi),v[u]==i?v[u]=o:v[u]<o&&(v[u]=o);return(s=[])[0]=h,s}),"colheader"==l?this._cTotIndexInfo=f:this._rTotIndexInfo=f,a={headers:a,indxInfo:f,maxLvlLen:v},e.isEmptyObject(S)||(this._measureDt=e.extend({},S)),1,l.indexOf(this._OlapDataSource.values[0].axis.substring(0,3))>-1&&(this._measureDt.measureCount=this._OlapDataSource.values[0].measures.length),!this._OlapDataSource._enableBasicEngine&&!this._isPaging){var y={headers:[],indxInfo:[]},P=f.length,w=y.length,N=[],x=[];try{for(c=0;c<P;c++)c<P&&"total"==a.indxInfo[c].type&&(y.indxInfo.push(a.indxInfo.splice(c,1)[0]),y.headers.push(a.headers.splice(c,1)[0]),P--,c--);var T=a.headers.length>0?a.headers[0].length:0,M=0,L=0;for(this._measureDt.posision==T-1&&this._measureDt.axis==l&&(L=1),P=a.headers.length,c=0;c<=P;c++){var D=null,I=null,j=null,F=null;for(D=(F=this._updateMemberVariables(a.headers,D,I,j,c)).prev,I=F.next,j=F.cur,F=null,H=T-2-L;H>=0;H--)if(n=this._comparePrevMembers(a.headers,P,c,H,T,-2),c==P||c>0&&(D&&D[H].UName!=j[H].UName||D[H].UName==j[H].UName&&n))if(j&&D[H].UName==j[H].PUName)c-=s=this._removeSubtotalMembers(a,c,H),P-=s,D=(F=this._updateMemberVariables(a.headers,D,I,j,c)).prev,I=F.next,j=F.cur,F=null;else{var R,E=D,k=(w=0,0),A=0;for(D&&(A=D[H].LNum),j&&(k=j[H].LNum),d=!1,h=k;h<=A;h++){for(w=(R=this._getSummaryHeaders(E,y,H,d,L)).headers.length;R.headers.length>0;)a.headers.splice(c,0,R.headers.pop()),a.indxInfo.splice(c,0,R.indexInfo.pop());d=!0,c+=w,P+=w,E=a.headers[c-1]}}if(c==P&&y.headers.length>0){for(u=0;y.headers.length>0;)a.headers.splice(c,0,y.headers.pop()),a.indxInfo.splice(c,0,y.indxInfo.pop()),P++,u++;c+=u}}var H=0,U="";for(N={headers:[],indxInfo:[]},H=T-1-L,P=a.headers.length,c=0;c<P;c++)if(D=this._findPreviousMember(a.headers,c-1,H),c>0&&a.headers[c-1][H].UName!=a.headers[c][H].UName&&H==T-1-L&&v[H]>1){if(c>0&&a.headers[c]!=i&&0!=a.headers[c-1][H].LNum&&a.headers[c-1][H].UName==a.headers[c][H].PUName)for(p=D;p<0;p++)a.indxInfo[c+p].lnum=a.headers[c+p][H].LNum,a.indxInfo[c+p].type="total",N.indxInfo.push(a.indxInfo.splice(c+p,1)[0]),N.headers.push(a.headers.splice(c+p,1)[0]),c+1==P?U=a.headers[c][H].PUName:(c--,P--);0!=c&&a.headers[c]!=i&&a.headers[c-1][H].LNum>a.headers[c][H].LNum&&(m=[],P=(g=this._insertSummaryHeaders(a,N,m,c,H,T,M,U,!1,x)).itmCnt,c=g.hCnt,M=g.insCnt,x[H]=g.subPos)}}catch(e){this.olapCtrlObj._waitingPopup.hide()}}return"rowheader"==l?this._rBIndx=f:this._cBIndx=f,a},_insertSummaryHeaders:function(t,l,a,r,o,n,s,d,h,u){a=[];var c,p,m,g,f,_,v,b="";s=0;for(t.headers[r-1]&&(d=t.headers[r-1][o].PUName),m=t.headers.length,c=t.headers[r][o].LNum,p=t.headers[r-1][o].LNum,g=this._comparePrevMembers(t.headers,m,r,o,n,s),f=c;f<p;f++){for(e.grep(l.headers,function(e,l){(d==e[o].UName||t.headers[r+1+s]!=i&&t.headers[r][o].UName!=t.headers[r+1+s][o].UName&&t.headers[r][o].PUName==e[o].UName&&g)&&(b=e[o].PUName,a.push(l))}),d=b,g&&(a.reverse(),g=!1);a.length>0;){for(_=a.length-1,v=a[a.length-1],t.headers.splice(r,0,l.headers.splice(a[a.length-1],1)[0]),t.indxInfo.splice(r,0,l.indxInfo.splice(a[a.length-1],1)[0]);_>=0;)v<a[_]&&a[_]--,_--;a.pop(),m++,s++,h&&u[o]++}s>0&&(r+=s,s=0)}return{itmCnt:m,hCnt:r,insCnt:s,subPos:u[o]}},_comparePrevMembers:function(e,t,i,l,a,r){var o,n=!1;if(l>0&&i<t&&i+1+r>=0&&i+1+r<t)for(o=l-1;o>=0;o--)e[i][o].UName!=e[i+1+r][o].UName&&(n=!0);return n},_updateMemberVariables:function(e,t,i,l,a){return e[a]&&(l=e[a]),i=e[a+1]?e[a+1]:null,{cur:l,prev:e[a-1]?e[a-1]:null,next:i}},_removeSubtotalMembers:function(e,t,i){for(var l=t-1,a=e.headers[l][i].UName;e.headers[l]&&e.headers[l][i].UName==a;)e.indxInfo.splice(l,1),e.headers.splice(l,1),l--;return t-(l+1)},_getSummaryHeaders:function(t,i,l,a){var r,o=i.headers,n=t,s=l,d=[],h=[],u=i.indxInfo;return r=e.grep(o,function(e,t){for(var i=!1,l=s;l>=0&&(e[l].UName==n[l].UName||a&&l==s&&e[l].UName==n[l].PUName);l--)0==l&&(i=!0,h.push(u[t]));return i}),i.headers=e.grep(o,function(e,t){for(var i=!0,l=s;l>=0&&(e[l].UName==n[l].UName||a&&l==s&&e[l].UName==n[l].PUName);l--)0==l&&(i=!1);return i&&d.push(u[t]),i}),i.indxInfo=d,{headers:r,indexInfo:h}},_drillOrderHeaderCollection:function(t,i,l){var a=i,r=l,o=this;return e(t).map(function(t,i){var l,n,s,d,h=e(a[i.selIndx]).find("Member"),u=[];for(u[0]=[],l=0;l<h.length;l++)n=parseInt(e(h[l]).find("LNum").text()),"colheader"==r&&o._OlapDataSource.columns[l]?o._OlapDataSource.columns[l].hasAllMember&&(n+=1):"rowheader"==r&&o._OlapDataSource.rows[l]&&o._OlapDataSource.rows[l].hasAllMember&&(n+=1),s=e(h[l]).find("PARENT_UNIQUE_NAME").length?e(h[l]).find("PARENT_UNIQUE_NAME").text():"",u[0].push({CSS:r,Value:e(h[l]).find("Caption").text(),ColSpan:1,RowSpan:1,HUName:e(h[l]).attr("Hierarchy"),LName:e(h[l]).find("LName").text(),UName:e(h[l]).find("UName").text(),ChildCount:parseInt(e(h[l]).find("CHILDREN_CARDINALITY").text()),PUName:s,LNum:n,MemberType:parseInt(e(h[l]).find("MEMBER_TYPE").text())}),d=u[0][u[0].length-1],i.kpiInfo&&d.UName.toLowerCase().indexOf("[measures]")>-1&&4==d.MemberType&&(u[0][u[0].length-1].kpiInfo=i.kpiInfo),i.kpi&&d.UName.toLowerCase().indexOf("[measures]")>-1&&4==d.MemberType&&(u[0][u[0].length-1].kpi=i.kpi);return u})},_loadKpi:function(e,t,i){i={action:"loadFieldElements"};var l=this._getConnectionInfo(e.data),a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_KPIS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog></PropertyList></Properties></Discover></Body></Envelope>";this.olapCtrlObj.doAjaxPost("POST",l.url,{XMLA:a},this._loadKpiSuccess,null,i)},_loadKpiSuccess:function(e,t){this._kpi=t},_isKpi:function(t,i){var l=e(this._kpi).find("row:contains("+t.split("::")[0]+")"),a={};return!!l.length&&("trend"==i?(a.Graphic=e(l).find("KPI_TREND_GRAPHIC").text(),a.Value=e(l).find("KPI_NAME").text()):"status"==i?(a.Graphic=e(l).find("KPI_STATUS_GRAPHIC").text(),a.Value=e(l).find("KPI_NAME").text()):"goal"==i&&(a.Caption=t.split("::")[1],a.Value=e(l).find("KPI_NAME").text()),a)},_getValueCells:function(i,l){var a,r,o,n,s,d=this._columnHeaders.headers.length,h=this._rowHeaders.headers.length?this._rowHeaders.headers.length:1,u=0,c=0;if(this._valueCells[u]=[],this._fillAllValueCells(),i=e(this.olapCtrlObj.XMLACellSet[1]).children(),this._OlapDataSource._enableBasicEngine||this._isPaging)for(o=0;o<i.length;o++)c<d&&(this._valueCells[u][c]={ActualValue:e(i[o]).find("Value").text(),Value:e(i[o]).find("FmtValue")[0]?e(i[o]).find("FmtValue").text():"",FormatString:e(i[o]).find("FormatString")[0]?e(i[o]).find("FormatString").text():"",kpi:!t.isNullOrUndefined(this._cBIndx[c])&&this._cBIndx[c].kpi?this._cBIndx[c].kpi:!t.isNullOrUndefined(this._rBIndx[u])&&this._rBIndx[u].kpi?this._rBIndx[u].kpi:""},c++),c==d&&u+1<h&&(c=0,u++,this._valueCells[u]=[]);else for(a=0;a<h;a++)for(r=this._rBIndx.length?this._rBIndx[a].selIndx:0,o=0;o<d;o++)i&&(n=e(i[r*l+this._cBIndx[o].selIndx]),s="",(this._columnHeaders.indxInfo[o]&&"total"==this._columnHeaders.indxInfo[o].type||this._rowHeaders.indxInfo[a]&&"total"==this._rowHeaders.indxInfo[a].type)&&(s="summary"),c<d&&(this._valueCells[a][o]={ActualValue:e(n).find("Value").text(),Value:e(n).find("FmtValue")[0]?this._getFormatedValue(e(n),e(n).find("FormatString")[0]):"",FormatString:e(n).find("FormatString")[0]?e(n).find("FormatString").text():"",kpi:this._cBIndx[o].kpi?this._cBIndx[o].kpi:this._rBIndx[a]?this._rBIndx[a].kpi:"",summary:s,Span:this._isNoSummary&&"summary"==s?"Block":"None"},c++),c==d&&u+1<h&&(c=0,u++,this._valueCells[u]=[]));return this._valueCells},_fillAllValueCells:function(i){var l,a,r,o,n;i=e(this.olapCtrlObj.XMLACellSet[1]).children();if(!t.isNullOrUndefined(i))for(l=!e(i[0]).clone(),e(l).find("FmtValue").text(""),i,a=0;a<i.length;a++)if(r=parseInt(e(i[a]).attr("CellOrdinal")),i[a+1]&&(o=parseInt(e(i[a+1]).attr("CellOrdinal"))),r+1<o)for(n=r+1;n<o;n++)e(i[a]).after(e(l).clone().attr("CellOrdinal",n)[0]);return i},_setCellOrdinal:function(t){for(var i=e(t).find("Cell"),l=0;l<i.length;l++)e(i[l]).attr("CellOrdinal",l)},_getFormatedValue:function(i,l){var a;if(("en-US"==this.olapCtrlObj.model.locale||!e.isNumeric(parseFloat(e(i).find("Value").text())))&&e(i).length>0)a=e(i).find("FmtValue").text();else switch(l=e(l).length>0?e(l).text().toLowerCase():t.isNullOrUndefined(l)?"":l.length>0?l:"",a=e(i).length>0?parseFloat(i.find("Value").text()):i,l){case"decimal":a=parseFloat(t.widgetBase.formatting("{0:D2}",a,this.olapCtrlObj.model.locale));break;case"percent":a=t.widgetBase.formatting("{0:P0}",a,this.olapCtrlObj.model.locale);break;case"number":a=t.widgetBase.formatting("{0:N}",a,this.olapCtrlObj.model.locale);break;case"currency":a=t.widgetBase.formatting("{0:C2}",a,this.olapCtrlObj.model.locale);break;case"date":a=new Date(864e5*(Number(a)-2)+new Date("01/01/1900").getTime()),this._isDateTime(a)&&(a=t.widgetBase.formatting("{0:MM/dd/yyyy}",a,this.olapCtrlObj.model.locale));break;case"scientific":a=Number(a).toExponential(2).replace("e","E");break;case"accounting":a=this._toAccounting(a,"{0:C2}",this.olapCtrlObj.model.locale);break;case"time":a=new Date(864e5*(Number(a)-2)+new Date("01/01/1900").getTime()),this._isDateTime(a)&&(a=t.widgetBase.formatting("{0:h:mm:ss tt}",a,this.olapCtrlObj.model.locale));break;case"fraction":a="numerator"in(a=this._toFraction(a))?a.integer+" "+a.numerator+"/"+a.denominator:a.integer;break;default:a=e(i).find("FmtValue").text()}return a},_isDateTime:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},_toAccounting:function(e,i,l){var a,r,o,n,s=t.preferredCulture(l).numberFormat.currency.symbol;return val=t.widgetBase.formatting(i,e,this.olapCtrlObj.model.locale),o=val.replace(s,""),!(n=val.indexOf(s))||e<0&&1===n?(a=s,r=Number(e)?o:"-"):(a=Number(e)?o:"-",r=s),a+"   "+r},_toFraction:function(e){if(this._isNumber(e)){var t=e.toString(),i=t.split(".")[0],l=t.split(".")[1];if(!l)return{integer:e};var a=(+l).toString(),r=this._getPlaceValue(l,a),o=this._getGCD(a,r);return{integer:i,numerator:Number(a)/o,denominator:Number(r)/o}}return null},_isNumber:function(e){return e-parseFloat(e)>=0},_getGCD:function(e,t){return e=Number(e),(t=Number(t))?this._getGCD(t,e%t):e},_getPlaceValue:function(e,t){var i=e.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},_populateEngine:function(l,a,r){var o,n,s,d,h,u=l.length,c=a.length,p=u?l[0].length:u,m=c?a[0].length:c,g=[],f=r.length,_=r[0].length;try{this.pivotEngine=[];var v,b=[],C=[],S=[],O=!1;for(d=0;d<c;d++)for(this.pivotEngine[d+m]==i&&(this.pivotEngine[d+m]=[]),0==d&&(this.pivotEngine[0]=[],this.pivotEngine[0][0]={CSS:"none",Value:"",ColSpan:this._indexCCell?this._indexCCell:1,RowSpan:this._indexRCell?this._indexRCell:1,HUName:"",LName:"",UName:"",LNum:""}),o=0;o<m;o++)O=!1,this._OlapDataSource.columns&&this._OlapDataSource.columns[o]&&this._OlapDataSource.columns[o].isNamedSets&&(O=!0),this._pivotEngineSpanCalculation("colheader",a,l,this._columnHeaders.maxLvlLen,r,o,d,C,b,this._cTotIndexInfo,O,S);for(v=this.pivotEngine.slice(),this.pivotEngine=[],d=0;d<v.length;d++)if(v[d])for(o=0;o<v[d].length;o++)v[d][o]&&(this.pivotEngine[o]==i&&(this.pivotEngine[o]=[]),this.pivotEngine[o][d]={CSS:v[d][o].CSS,ColSpan:v[d][o].RowSpan,HUName:v[d][o].HUName,LName:v[d][o].LName,LNum:v[d][o].LNum,RowSpan:v[d][o].ColSpan,UName:v[d][o].UName,PUName:v[d][o].PUName,Value:v[d][o].Value,ChildCount:v[d][o].ChildCount,MemberType:v[d][o].MemberType,Span:"Block"==v[d][o].Span?"Block":"None"},v[d][o].kpiInfo&&(this.pivotEngine[o][d].kpiInfo=v[d][o].kpiInfo,this.pivotEngine[o][d].kpi=v[d][o].kpi));var y=[],P=[];S=[];for(d=0;d<u;d++)for(this.pivotEngine[d+this._indexCCell]==i&&(this.pivotEngine[d+this._indexCCell]=[]),o=0;o<p;o++)O=!1,this._OlapDataSource.rows&&this._OlapDataSource.rows[o]&&this._OlapDataSource.rows[o].isNamedSets&&(O=!0),this._pivotEngineSpanCalculation("rowheader",l,a,this._rowHeaders.maxLvlLen,r,o,d,P,y,this._rTotIndexInfo,O,S);for(g=e.extend(!0,[],this.pivotEngine),p="rowheader"==this._measureDt.axis?this._indexRCell+1:this._indexRCell,m=this._indexCCell?this._indexCCell:m,d=0;d<f;d++)for(this.pivotEngine[d+m]!=i&&(p=this.pivotEngine[d+m].length),o=0;o<_;o++)t.isNullOrUndefined(r[d][o])||(this.pivotEngine[d+m]==i&&(this.pivotEngine[d+m]=[]),n=this._setClassName(r[d][o]),r[d][o].CSS=n,n.indexOf("kpiiconvalue")>-1&&("ejPivotGrid"==this.olapCtrlObj.pluginName||"ejPivotClient"==this.olapCtrlObj.pluginName)?r[d][o].Value="":n.indexOf("kpiiconvalue")>-1&&(r[d][o].Value=parseInt(r[d][o].Value)),this.pivotEngine[d+this._indexCCell][o+this._indexRCell]=r[d][o]);if(e.grep(this.pivotEngine,function(e){return e}),this._isPaging){for(t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName)||"collapse"!=this.olapCtrlObj._pagingSavedObjects.curDrilledItem.action?t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index)?t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName)||(e.each(this.olapCtrlObj._pagingSavedObjects.savedHdrEngine,function(i,l){e.each(l,function(e,l){if(!t.isNullOrUndefined(l)&&l.UName==t.olap.base.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName.split("::")[0].split("amp;").join(""))return t.olap.base.olapCtrlObj._pagingSavedObjects.drillEngine.push(t.olap.base.olapCtrlObj._pagingSavedObjects.savedHdrEngine[i][e]),!1})}),this.olapCtrlObj._pagingSavedObjects.drillEngine[this.olapCtrlObj._pagingSavedObjects.drillEngine.length-1].ChildCount=-1):(this.olapCtrlObj._pagingSavedObjects.drillEngine.push(this.olapCtrlObj._pagingSavedObjects.savedHdrEngine[parseInt(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index.split(",")[1])][parseInt(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index.split(",")[0])]),this.olapCtrlObj._pagingSavedObjects.drillEngine[this.olapCtrlObj._pagingSavedObjects.drillEngine.length-1].ChildCount=-1):e.each(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e,i){if(i.UName==t.olap.base.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName.split("::")[0].split("amp;").join(""))return t.olap.base.olapCtrlObj._pagingSavedObjects.drillEngine.splice(e,1),!1}),e.map(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(i){var l=0,a=e.map(t.olap.base.olapCtrlObj.model.dataSource.columns,function(e,a){return t.olap.base.olapCtrlObj._isMondrian?(l=e.fieldName.replace(/\]/g,"").replace(/\[/g,"")==i.HUName.replace(/\[/g," ").replace(/\[/g,"")?a:l,e.fieldName.replace(/\]/g,"").replace(/\[/g,"")==i.HUName.replace(/\[/g," ").replace(/\[/g,"")):(l=e.fieldName==i.HUName?a:l,e.fieldName==i.HUName)});i.CSS=a[l]?"colheader":"rowheader"}),this.olapCtrlObj._pagingSavedObjects.curDrilledItem={},d=this.pivotEngine[0][0].RowSpan-2;d>=0;d--){for("empty",o=1;o<this.pivotEngine[this.pivotEngine[0][0].RowSpan-1].length;o++)t.isNullOrUndefined(this.pivotEngine[d])&&(this.pivotEngine[d]=[]),t.isNullOrUndefined(this.pivotEngine[d+1])||!t.isNullOrUndefined(this.pivotEngine[d][o])||t.isNullOrUndefined(this.pivotEngine[d+1][o])||(this.pivotEngine[d][o]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==t.olap.base.pivotEngine[d+1][o].PUName})[0],t.isNullOrUndefined(this.pivotEngine[d][o])||(this.pivotEngine[d][o].ColSpan=t.isNullOrUndefined(this.pivotEngine[d][o-1])||this.pivotEngine[d][o-1].UName!=this.pivotEngine[d][o].UName?1:this.pivotEngine[d][o-1].ColSpan+1,this.pivotEngine[d][o].RowSpan=1,this.pivotEngine[d][o].UName));for(s=1,o=this.pivotEngine[this.pivotEngine[0][0].RowSpan-1].length-2;o>0;o--)t.isNullOrUndefined(this.pivotEngine[d])||t.isNullOrUndefined(this.pivotEngine[d][o])||t.isNullOrUndefined(this.pivotEngine[d][o+1])||this.pivotEngine[d][o+1].UName!=this.pivotEngine[d][o].UName?t.isNullOrUndefined(this.pivotEngine[d])||t.isNullOrUndefined(this.pivotEngine[d][o+1])||(this.pivotEngine[d][o+1].ColSpan=1==s?this.pivotEngine[d][o+1].ColSpan:s,s=1):(this.pivotEngine[d][o].ColSpan,this.pivotEngine[d][o+1].ColSpan,s++)}for(d=this.pivotEngine[0][0].RowSpan;d<this.pivotEngine.length;d++)for(h="empty",o=this.pivotEngine[0][0].ColSpan-1;o>=0;o--)t.isNullOrUndefined(this.pivotEngine[d][o])?t.isNullOrUndefined(this.pivotEngine[d-1][o])||this.pivotEngine[d-1][o].UName!=h?(this.pivotEngine[d][o]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==h})[0],t.isNullOrUndefined(this.pivotEngine[d][o])||(this.pivotEngine[d][o].RowSpan=1,this.pivotEngine[d][o].ColSpan=1,h=this.pivotEngine[d][o].PUName)):(this.pivotEngine[d][o]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==h})[0],t.isNullOrUndefined(this.pivotEngine[d][o])||(this.pivotEngine[d][o].RowSpan=this.pivotEngine[d-1][o].RowSpan+1,this.pivotEngine[d][o].ColSpan=1,h=this.pivotEngine[d][o].PUName)):h=this.pivotEngine[d][o].PUName;this.olapCtrlObj._pagingSavedObjects.savedHdrEngine=g}}catch(e){this.olapCtrlObj._waitingPopup.hide()}},_pivotEngineSpanCalculation:function(t,l,a,r,o,n,s,d,h,u,c,p){var m,g,f,_,v,b,C,S,O,y,P,w=l.length,N="",x=a.length,T=w?l[0].length:w,M=x?a[0].length:x;o.length,o[0].length;"rowheader"==t?(M=this._indexCCell?this._indexCCell:M,N="row"):(M=this._indexRCell?this._indexRCell:M,N="col"),g=0,c&&(l[s][n].ChildCount=0),this._measureDt.axis==t&&this._measureDt.posision==T-1&&(g=1),d[n]||(d[n]=[]),this._isNoSummary&&!p[n]&&(p[n]=[]),this.pivotEngine[s+M]||(this.pivotEngine[s+M]=[]),h[n]=s;var L=r[n]?r[n]:1,D=0,I=0;for(f=0;f<n;f++)r[f]&&(D+=r[f]-1,I+=r[f]);if(!this._OlapDataSource._enableBasicEngine||this._OlapDataSource._checkSummaryHeaders)for(_=1;_<=L;_++){var j,F=!1,R=l[s][n].LNum;if(d[n][_]==i&&(d[n][_]=0),this._isNoSummary&&p[n][_]==i&&(p[n][_]=0),l[s-1]&&d[n][R]&&(0!=l[s][n].LNum&&l[s-1][n].PUName==l[s][n].UName||n+g==T-1&&l[s-1][n].LNum<l[s][n].LNum)&&(v=d[n][R],this._isNoSummary&&(v+=p[n][R],p[n][R]=0),this.pivotEngine[s+M-v][n+R-1+D]=l[s][n],n+g!=T-1&&(this.pivotEngine[s+M][n+R-1+D]=e.extend({},l[s][n]),this._isNoSummary&&(this.pivotEngine[s+M][n+R-1+D].Span="Block")),this._isNoSummary&&(this.pivotEngine[s+M-v][n+R-1+D].RowSpan=0),c||(this.pivotEngine[s+M-v][n+R-1+D].ChildCount=-1),this.pivotEngine[s+M-v][n+R-1+D].ColSpan=1,this.pivotEngine[s+M-v][n+R-1+D].RowSpan+=d[n][R],this._drilledJSONData(s+M-v,s+M,n+R-1+D,l[s][n]),d[n][R]=0,n+g==T-1&&l[s-1][n].LNum>l[s][n].LNum)){for(b=r[n]-R,C=this._findNextMember(l,s,n),S=0;S<C;S++)this.pivotEngine[s+M+S]||(this.pivotEngine[s+M+S]=[]),this.pivotEngine[s+M+S][n+D+R]={CSS:"summary "+N,Value:"Total",ColSpan:b,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"};this._isNoSummary||(this.pivotEngine[s+M-v][n+R-1+D].RowSpan+=C-1)}if(l[s][n].LNum>_&&(!this._isNoSummary||"total"!=u[s].type)?d[n][_]++:l[s][n].LNum>_&&this._isNoSummary&&"total"==u[s].type&&p[n][_]++,j=s+M,_==l[s][n].LNum&&0==s&&l[s][n].LNum>1)this.pivotEngine[j]||(this.pivotEngine[j]=[]),this.pivotEngine[j][n+_-1+D]=l[s][n],(!(l[s+1]!=i&&l[s][n].LNum<l[s+1][n].LNum)||n+g==T-1&&l[s+1]&&l[s][n].LNum<l[s+1][n].LNum)&&(this.pivotEngine[j][n+_-1+D].ColSpan+=r[n]-this.pivotEngine[j][n+_-1+D].LNum);else if(0!=s&&l[s][n].LNum>1&&_==l[s][n].LNum&&l[s-1][n].UName!=l[s][n].UName&&l[s-1][n].PUName!=l[s][n].UName)this.pivotEngine[j]==i&&(this.pivotEngine[j]=[]),this.pivotEngine[j][n+_-1+D]=l[s][n],(!(l[s+1]!=i&&l[s][n].LNum<l[s+1][n].LNum)||n+g==T-1&&l[s+1]&&l[s][n].LNum<l[s+1][n].LNum)&&(this.pivotEngine[j][n+_-1+D].ColSpan+=r[n]-this.pivotEngine[j][n+_-1+D].LNum);else if(0!=s&&_==l[s][n].LNum&&l[s-1][n].UName==l[s][n].UName)this._isNoSummary&&"total"==u[s].type?this._isNoSummary&&"total"==u[s].type&&p[n][_]++:d[n][_]++,this.pivotEngine[s+M][n+_-1+D]=l[s][n],this._isNoSummary&&"total"==u[s].type&&(this.pivotEngine[s+M][n+_-1+D].Span="Block"),(l[s+1]!=i&&l[s+1][n].UName!=l[s][n].UName||s+1==w&&d[n][_]>0)&&(O=d[n][_],y=l[s][n].LNum,this._isNoSummary&&(O+=p[n][_],p[n][_]=0),O&&this.pivotEngine[s+M-O][n+y-1+D]!=i&&this.pivotEngine[s+M-O][n+y-1+D].Value!=i&&(this.pivotEngine[s+M-O][n+y-1+D].RowSpan+=d[n][_],this._drilledJSONData(s+M-O,s+M,n+y-1+D,l[s][n])),d[n][_]=0);else if(l[s][n].LNum<2&&(_==l[s][n].LNum||0==l[s][n].LNum)||l[s][n].LNum<_&&l[s-1]&&l[s][n].LNum<l[s-1][n].LNum&&"total"==u[s].type&&this._measureDt.axis==t)if(_-1,l[s-1]&&l[s-1][n].UName==l[s][n].UName&&l[s][n].LName.toLowerCase().indexOf("[measures]")>-1&&(this.pivotEngine[s+M][n+_-1+D]=e.extend({},l[s][n]),this._measureDt.measureCount>1&&t==this._measureDt.axis||this._isNoSummary&&"total"==u[s].type?this._measureDt.measureCount>1&&t==this._measureDt.axis||!this._isNoSummary||"total"!=u[s].type||p[n][_]++:d[n][_]++,this._isNoSummary&&"total"==u[s].type&&(this.pivotEngine[s+M][n+_-1+D].Span="Block")),-1!=l[s][n].UName.indexOf("Measures")&&this._isPaging||"total"==u[s].type)if("total"==u[s].type&&-1==l[s][n].LName.toLowerCase().indexOf("[measures]")&&l[s][n].LNum!=_&&0!=r[n]){if((l[s][n-1]&&-1==l[s][n-1].LName.toLowerCase().indexOf("[measures]")||this._measureDt.axis!=t)&&(n>u[s].totLvl||n==T-1&&_>u[s].totLvl&&0!=u[s].totLvl||0==u[s].totLvl&&_-1>u[s].totLvl))break;for(var E=1,k=1,A=0;l[s-k][n]&&0==l[s-k][n].LNum&&!l[s][n].LName.toLowerCase().indexOf("[measures]")>-1;)l[s][n-1]&&l[s-k+1][n-1].UName!=l[s-k][n-1].UName&&A++,k++;0==l[s][n].LNum&&!l[s][n].LName.toLowerCase().indexOf("[measures]")>-1&&(P=0,0,s>0&&n>0&&l[s][n].LName.indexOf("(All)")>-1&&l[s][n-1]&&r[n-1]>1&&(P=this._findPreviousMember(l,s,n-1)),0!=s&&l[s][n-1]&&r[n-1]>1&&l[s+P]&&l[s][n-1].LNum<l[s+P][n-1].LNum&&(A=r[n-1]-l[s][n-1].LNum),"rowheader"==t?(E=this._indexRCell-I+A,this._indexRCell-E):"colheader"==t&&(E=this._indexCCell-I+A,this._indexCCell-E),(1!=r.length&&n==T-1||r.length>1&&n<T-1)&&(F=!0),this._measureDt.axis==t&&(E-=1),1,0!=s&&l[s][n-1]&&l[s][n-1].LNum+1,1,P=s+M,this.pivotEngine[s+M][n+_-1+D-A]={CSS:"summary "+N,Value:"Total",ColSpan:E,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"})}else-1!=l[s][n].LName.toLowerCase().indexOf("[measures]")?(l[s-1]&&l[s-1][n].UName==l[s][n].UName||(this.pivotEngine[s+M][n+_-1+D]=e.extend({},l[s][n]),this._isNoSummary&&"total"==u[s].type&&(this.pivotEngine[s+M][n+_-1+D].Span="Block")),(l[s-1]&&l[s-1][n].UName!=l[s][n].UName||s+1==w)&&(m=d[n][_],this._isNoSummary&&(m+=p[n][_],p[n][_]=0),m&&this.pivotEngine[s+M-m][n+_-1+D]!=i&&(this.pivotEngine[s+M-m][n+_-1+D].RowSpan+=d[n][_],this._drilledJSONData(s+M-m,s+M,n+_-1+D,l[s][n])),d[n][_]=0)):"total"==u[s].type&&1==l.length&&(this.pivotEngine[s+M][n+_-1+D]={CSS:"summary "+N,Value:"Total",ColSpan:1,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"});else l[s-1]&&l[s-1][n].UName==l[s][n].UName||(this.pivotEngine[s+M][n+_-1+D]=l[s][n],m=d[n][_],this._isNoSummary&&(m+=p[n][_],p[n][_]=0),m&&this.pivotEngine[s+M-m][n+_-1+D]!=i&&(this.pivotEngine[s+M-m][n+_-1+D].RowSpan+=d[n][_],this._drilledJSONData(s+M-m,s+M,n+_-1+D,l[s][n])),d[n][_]=0),0==!l[s][n].LNum&&(!(l[s+1]!=i&&l[s][n].LNum<l[s+1][n].LNum)||n+g==T-1&&l[s+1]&&l[s][n].LNum<l[s+1][n].LNum)&&this.pivotEngine[s+M][n+_-1+D]&&(this.pivotEngine[s+M][n+_-1+D].ColSpan+=r[n]-this.pivotEngine[s+M][n+_-1+D].LNum);if(F)break}else this.pivotEngine[s+M][n]=l[s][n]},_findNextMember:function(e,t,i){for(var l=0;e[t+l]&&e[t][i].UName==e[t+l][i].UName;)l++;return l},_findPreviousMember:function(e,t,i){for(var l=-1;e[t+l]&&e[t][i].UName==e[t+l][i].UName;)l--;return l},_drilledJSONData:function(t,i,l,a){for(var r=t+1;r<i;r++)this.pivotEngine[r][l]=e.extend({},a),this._isNoSummary&&(this.pivotEngine[r][l].Span="Block")},_setClassName:function(e){var t=parseInt(e.Value),i="value";if(e.kpi)if("trend"==e.kpi)switch(t){case-1:i="value kpiiconvalue kpidownarrow";break;case 0:i="value kpiiconvalue kpirightarrow";break;case 1:i="value kpiiconvalue kpiuparrow"}else if("status"==e.kpi)switch(t){case-1:i="value kpiiconvalue kpidiamond";break;case 0:i="value kpiiconvalue kpitriangle";break;case 1:i="value kpiiconvalue kpicircle"}return e.summary+" "+i},_getFieldItemsInfo:function(e){var t=this._getConnectionInfo(e.model.dataSource.data),i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_HIERARCHIES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+t.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>";e.doAjaxPost("POST",t.url,{XMLA:i},this._getHierarchyInfo,null,{pvtGridObj:e,action:"loadFieldElements"})},_getHierarchyInfo:function(t,i){for(var l,a,r=[],o=t.pvtGridObj,n=this._getConnectionInfo(o.model.dataSource.data),s=0;s<e(i).find("row").length;s++)l=e(e(i).find("row")[s]),r.push({pid:l.find("DIMENSION_UNIQUE_NAME").text(),id:l.find("HIERARCHY_UNIQUE_NAME").text(),name:l.find("HIERARCHY_CAPTION").text(),tag:l.find("HIERARCHY_UNIQUE_NAME").text(),hasAllMember:0==l.children("ALL_MEMBER").length});o._fieldData={hierarchy:r,hierarchySuccess:i,measures:[]},n.LCID.indexOf("1033")>=0&&!o.model.enableDrillThrough||(a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASURES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+o.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+o.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+o.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+n.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>",o.doAjaxPost("POST",n.url,{XMLA:a},this._getMeasureInfo,null,{pvtGridObj:o,action:"loadFieldElements"}))},_getMeasureInfo:function(t,i){for(var l=[],a=0;a<e(i).find("row").length;a++){var r=e(e(i).find("row")[a]),o=r.children("MEASUREGROUP_NAME").text(),n=r.find("MEASURE_UNIQUE_NAME").text();l.push({id:n,pid:o,name:r.children("MEASURE_CAPTION").text(),tag:n})}t.pvtGridObj._fieldData.measures=l,t.pvtGridObj._fieldData.measureSuccess=i},_getConnectionInfo:function(t){var i={url:"",LCID:"1033"};return""!=t&&e.map(t.split(";"),function(e){e.toLowerCase().indexOf("locale")<0&&0==i.url.length?i.url=e:e.toLowerCase().indexOf("locale")>=0&&(i.LCID=e.replace(/ /g,"").split("=")[1])}),i},_applyTrim:function(l){var a=[],r=l.model.dataSource,o=this;l._fieldData&&l._fieldData.measures&&l._fieldData.hierarchy?(e.merge(a,l._fieldData.hierarchy),e.merge(a,l._fieldData.measures)):!l._fieldData||!l._fieldData.hierarchy||l._fieldData.hierarchy,r.rows=e.map(r.rows,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),r.columns=e.map(r.columns,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),r.filters=e.map(r.filters,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),r.values=r.values.length>0&&r.values[0].measures!=i?r.values:[{measures:[],axis:"columns"}],r.values[0].measures=e.map(r.values[0].measures,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),l.model.dataSource=r},_getCaption:function(l,a){var r=l.fieldName,o=[];return t.isNullOrUndefined(l.fieldCaption)&&(a.length>0?(o=e.map(a,function(t){if(t.tag!=i&&t.tag.toLowerCase()==e.trim(r.toLowerCase()))return t}),r.toLowerCase().indexOf("[measures]")>=0&&0==o.length&&r.split(".[").length>0?l.fieldCaption=r.split(".[")[1].replace(/]/g,""):o.length>0&&(l.hasAllMember=!!o[0].hasAllMember,l.fieldCaption=o[0].name)):0==o.length&&(l.fieldCaption=r)),l},clearDrilledItems:function(l,a,r){var o=a.action;return l.rows=e.grep(l.rows,function(e){return e.filterItems!=i&&"filtering"!=o&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=o&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),l.columns=e.grep(l.columns,function(e){return e.filterItems!=i&&"filtering"!=o&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=o&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),l.filters=e.grep(l.filters,function(e){return e.filterItems!=i&&"filtering"!=o&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=o&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),"filtering"!=o&&(r._currentReportItems=e.map(r._currentReportItems,function(e){if(!t.isNullOrUndefined(e.dataSrc)){if(e.dataSrc.cube!=l.cube)return e;if(e.dataSrc.reportName!=l.reportName)return e}}),t.isNullOrUndefined(r._schemaData)||r._schemaData.element.find(".filter").remove(),r._savedReportItems=e.extend(!0,[],r._currentReportItems)),t.olap.base._clearDrilledCellSet(),l}},t.olap._mdxParser={_getRowMDX:function(l){var a,r,o=e(l)[0].rows,n="",s="",d=[],h=!1,u=!1,c=l._isCollapse,p=l.values.length>0&&l.values[0].measures!=i&&l.values[0].axis==t.olap.AxisName.Row;if(t.isNullOrUndefined(l.providerName)||l.providerName==t.olap.Providers.SSAS){if(o.length>0){for(u=!t.isNullOrUndefined(o[0].drillCellInfo),a=0;a<o.length;a++){var m=!(t.isNullOrUndefined(o[a].isNamedSets)||!o[a].isNamedSets),g="",f="";o[a].fieldName==i||m?m&&(n=a>0?n+"*{"+o[a].fieldName+"}":"{"+o[a].fieldName+"}"):(g=this._getDimensionQuery(o[a],l,"rows",a,!1),d.push(g.replace(/["'\(\)]/g,"").replace(/["'\{\}]/g,"").replace(/\levels0/g,"levels(0)")),t.olap.base._isPaging&&u&&(f=this._getDimensionQuery(o[a],l,"rows",a,!0)),o[a].sortOrder&&o[a].sortOrder!=t.olap.SortOrder.None?(r=o[a].sortOrder==t.olap.SortOrder.Ascending?"asc":"desc",h=!0,n=n+(a>0?"*":"")+"{ORDER({HIERARCHIZE({"+(t.olap.base._isPaging&&u?f:g)+"})},"+o[a].fieldName+".CurrentMember.MEMBER_CAPTION,"+r+")}"):n=n+(a>0?"*":"")+"{HIERARCHIZE({({"+(t.olap.base._isPaging&&u?f:g)+"})})}")}t.olap.base._isPaging&&this._updateOlapReport(e(l)[0].rows,n,"rows",d),c&&(h=c),n=(h?" ":" HIERARCHIZE ")+"( {"+(t.olap.base._isPaging?n:this._updateOlapReport(e(l)[0].rows,n,"rows",d))+"})",c&&(n="HIERARCHIZE("+n+")")}p&&(s=t.olap._mdxParser._getMeasuresQuery(l),n=""!=n?(t.olap.base._isPaging?n.slice(0,-1):n)+(""!=n&&""!=s?t.olap.base._isPaging?"*":",":"")+s:(t.olap.base._isPaging&&""!=s?"(":"")+s),t.olap.base._isPaging&&(n=""!=n?""==s?("}"!=n[n.length-1]?n.slice(0,-1):n)+this._getDrilledSection(l,e.extend(!0,{},o),"row",s)+")":n+this._getDrilledSection(l,e.extend(!0,{},o),"row",s)+")":"")}else n=this._generateAxisMDXOnMondrian(l,o,p);return n},_generateAxisMDXOnMondrian:function(e,i,l){for(var a,r,o="",n=0;n<i.length;n++)a=t.olap.base._isPaging?"({"+i[n].fieldName+".children})":"DrillDownLevel({"+i[n].fieldName+"})",!t.isNullOrUndefined(i[n].drilledItems)&&i[n].drilledItems.length>0&&(a=this._getDrilledMDXOnMondrian(i[n].drilledItems,a)),!t.isNullOrUndefined(i[n].filterItems)&&!t.isNullOrUndefined(i[n].filterItems.values)&&i[n].filterItems.values.length>0&&(a="({{hierarchize(Union(Intersect((Except("+("Descendants("+i[n].fieldName+","+e._maxLevel+", SELF_AND_BEFORE)")+","+(r="{"+i[n].filterItems.values.join()+"}")+")),"+a+"),Except("+a+","+r+")))}})"),o+=(""==o?"":"*")+a;return l&&(o+=(""==o?"":"*")+t.olap._mdxParser._getMeasuresQuery(e)),o},_getDrilledMDXOnMondrian:function(e,i){for(var l=0;l<e.length;l++)i=t.olap.base._isPaging?"Except(DrillDownMember("+i+", {"+e[l].join()+"}),{"+e[l].join()+"})":"(DrillDownMember("+i+", {"+e[l].join()+"}))";return i},_getcolumnMDX:function(l){var a,r,o=e(l)[0].columns,n="",s="",d=[],h=!1,u=!1,c=l._isCollapse,p=l.values.length>0&&l.values[0].measures!=i&&l.values[0].axis==t.olap.AxisName.Column;if(t.isNullOrUndefined(l.providerName)||l.providerName==t.olap.Providers.SSAS){if(o.length>0){for(u=!t.isNullOrUndefined(o[0].drillCellInfo),a=0;a<o.length;a++){var m=!(!t.isNullOrUndefined(o[a].isNamedSets)&&o[a].isNamedSets),g=(h=!1,""),f="";o[a].fieldName!=i&&m?(g=this._getDimensionQuery(o[a],l,"columns",a,!1),d.push(g.replace(/["'\(\)]/g,"").replace(/["'\{\}]/g,"")),t.olap.base._isPaging&&u&&(f=this._getDimensionQuery(o[a],l,"columns",a,!0)),o[a].sortOrder&&o[a].sortOrder!=t.olap.SortOrder.None?(r=o[a].sortOrder==t.olap.SortOrder.Ascending?"asc":"desc",h=!0,n=n+(a>0?"*":"")+"{ ORDER ({HIERARCHIZE ({"+(t.olap.base._isPaging&&u?f:g)+"})},"+o[a].fieldName+".CurrentMember.MEMBER_CAPTION,"+r+")}"):n=n+(a>0?"*":"")+"{"+(t.olap.base._isPaging&&u?f:g)+"}"):n=a>0?n+"*{"+o[a].fieldName+"}":"{"+o[a].fieldName+"}"}t.olap.base._isPaging&&u&&this._updateOlapReport(e(l)[0].columns,n,"columns",d),c&&(h=c),n=(h?" ":" HIERARCHIZE ")+"( {"+(t.olap.base._isPaging?n:this._updateOlapReport(o,n,"columns",d))+"})",c&&(n="HIERARCHIZE("+n+")")}p&&(s=t.olap._mdxParser._getMeasuresQuery(l),n=""!=n?(t.olap.base._isPaging?n.slice(0,-1):n)+(""!=n&&""!=s?t.olap.base._isPaging?"*":",":"")+s:(t.olap.base._isPaging&&""!=s?"(":"")+s),t.olap.base._isPaging&&(n=""!=n?""==s?("}"!=n[n.length-1]?n.slice(0,-1):n)+this._getDrilledSection(l,e.extend(!0,{},o),"column",s)+")":n+this._getDrilledSection(l,e.extend(!0,{},o),"column",s)+")":"")}else n=this._generateAxisMDXOnMondrian(l,o,p);return n},_getDrilledSection:function(i,l,a,r){var o="";l=l;return e.each(l,function(i,l){t.isNullOrUndefined(l.drilledItems)||e.each(l.drilledItems,function(t,l){var a="",n="";e.each(l,function(e,t){a=""==a?"{"+t+"}":a+"*{"+t+"}",t=e==i?t.replace(".children",""):t,n=""==n?"{"+t+"}":n+"*{"+t+"}"}),""!=r&&(a=a+"*"+r,n=n+"*"+r),o=""==o?"+{"+a+"}-{"+n+"}":o+"+{"+a+"}-{"+n+"}"})}),o},_getSortedMembers:function(i){var l,a=i.fieldName;return i.sortOrder&&i.sortOrder!=t.olap.SortOrder.None?(l="ascending"==i.sortOrder?"asc":"desc",e.map(i.drilledItems,function(t){return e.map(t,function(e){return e.indexOf(a)>=0&&(e="order ( "+e+" , "+a+".CurrentMember.MEMBER_CAPTION,"+l+")"),e})})):i.drilledItems},_getAvailCount:function(i,l,a){var r=0;return e.each(i.split("--"),function(e,i){i=i.replace(a[e],""),l.split("--").length>0&&!t.isNullOrUndefined(l.split("--")[e])&&(r+=i.indexOf(l.split("--")[e])>-1&&!((i+"$").indexOf(l.split("--")[e])>-1)||l.split("--")[e].indexOf(i)>-1&&!(l.split("--")[e].indexOf(i+"$")>-1)?1:0)}),r},_updateTmpItems:function(i,l,a,r){var o=e.map(l.split("--"),function(e,i){return t.isNullOrUndefined(a.split("--")[i])||e.replace(r[i],"")!=a.split("--")[i].replace(r[i],"")||-1!=e.indexOf(r[i])?e:a.split("--")[i]}).join("--");-1==i.indexOf(o)&&i.push(o)},_updateExpandCollection:function(i,l,a){return e.each(l,function(r,o){e.each(l,function(l,r){var n,s,d;o!=r&&(n=0,e.each(r.split("--"),function(e,i){i=i.replace(a[e],""),t.isNullOrUndefined(o.split("--")[e])||(n+=r.split(a[e]).join("").indexOf(o.split("--")[e].replace(a[e],""))>-1||o.split("--")[e].replace(a[e],"").indexOf(i)>-1?1:0)}),n==r.split("--").length&&t.olap._mdxParser._updateTmpItems(i,o,r,a),n==o.split("--").length&&t.olap._mdxParser._updateTmpItems(i,r,o,a),s=[],d=0,e.each(r.split("--"),function(e,i){var l=o.split("--").length>e?o.split("--")[e]:"";t.isNullOrUndefined(l)||""==l||(i!=l&&i.indexOf("$")>-1&&(i.indexOf(l)>-1||l.indexOf(i)>-1)&&o.split("--").length-1>e?(s.push(i),d++):s.push(l))}),d>0&&i.push(s.concat(e.map(o.split("--"),function(e,t){if(t>=s.length)return e})).join("--")))})}),i},_updateDrillQuery:function(i,l,a,r){var o,n,s,d=t.olap.base._isRowDrilled||t.olap.base._isColDrilled,h=e.map(i,function(i){var l=e.map(t.olap.base.olapCtrlObj._prevDrillElements,function(e){if(e.indexOf(i.fieldName)>-1)return e}).join("$");if(""!=l)return l}).join("--"),u=e.map(r,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),c=e.map(i,function(e){return!t.isNullOrUndefined(e.hasAllMember)&&e.hasAllMember?".levels(0).AllMembers":".children"});d||""==h||(t.isNullOrUndefined(i[h.split("--").length-1]._prevDimElements)||-1!=i[h.split("--").length-1]._prevDimElements.indexOf(h+c[h.split("--").length-1])?i[h.split("--").length-1]._prevDimElements=i[h.split("--").length-1]._prevDimElements.filter(function(e){if(t.olap._mdxParser._getAvailCount(e,h,c)!=h.split("--").length)return e}):i[h.split("--").length-1]._prevDimElements.push(h+c[h.split("--").length-1]+"!#collapse")),i=e.map(i,function(i){return t.isNullOrUndefined(i._prevDimElements)?i:(i._prevDimElements=e.map(i._prevDimElements,function(i){var l=-1!=i.indexOf("!#collapse");return d?i.indexOf("!#collapse")>-1?(i=i.replace("!#collapse",""),t.olap._mdxParser._getAvailCount(i,h,c)!=h.split("--").length?i:void 0):i:""!=h?(i=i.replace("!#collapse",""),t.olap._mdxParser._getAvailCount(i,h,c)==h.split("--").length?e.map(i.split("--"),function(e,t){return t==h.split("--").length-1&&-1==e.indexOf(c[t])?h.split("--")[h.split("--").length-1]+"":e}).join("--")+(l?"!#collapse":""):i+(l?"!#collapse":"")):i}),""!=h&&(i._prevDimElements=e.map(i._prevDimElements,function(e){if(!(e.indexOf("!#collapse")>-1&&i._prevDimElements.filter(function(e){if(-1==e.indexOf("!#collapse"))return e}).indexOf(e.replace("!#collapse",""))>-1||-1==e.indexOf("!#collapse")&&i._prevDimElements.map(function(e){if(e.indexOf("!#collapse")>-1)return e.replace("!#collapse","")}).indexOf(e)>-1))return e})),i)});var p=e.map(i,function(e){if(!t.isNullOrUndefined(e._prevDimElements))return e._prevDimElements}).filter(function(e){if(-1==e.indexOf("!#collapse"))return e}),m=e.map(i,function(e){if(!t.isNullOrUndefined(e._prevDimElements))return e._prevDimElements}).filter(function(e){if(e.indexOf("!#collapse")>-1)return e}).map(function(e){return e.replace("!#collapse","")}),g=0==h.length?i.length:h.split("--").length,f=[];return d&&(p=e.map(p,function(e){if(t.olap._mdxParser._getAvailCount(e,h,c)==h.split("--").length)return e})),o=t.olap._mdxParser._updateExpandCollection([],p,c),n=t.olap._mdxParser._updateExpandCollection([],o,c),p=p.concat(o.concat(n)),o=[],e.each(p,function(t,i){e.each(m,function(t,l){var a=[],r=0;i.split("--").length>l.split("--").length&&(e.each(l.split("--"),function(e,t){var l=i.split("--")[e];(t.replace(c[e],"").indexOf(l.replace(c[e],""))>-1||l.replace(c[e],"").indexOf(t.replace(c[e],""))>-1)&&(a.push(t),r++)}),l.split("--").length==r&&r<i.split("--").length&&-1==o.indexOf(a.concat(e.map(i.split("--"),function(e,t){if(t>=a.length)return e})).join("--"))&&-1==m.indexOf(a.concat(e.map(i.split("--"),function(e,t){if(t>=a.length)return e})).join("--"))&&o.push(a.concat(e.map(i.split("--"),function(e,t){if(t>=a.length)return e})).join("--")))})}),m=m.concat(o),p=e.map(p,function(i){var l=d?g:i.split("--").length;return e.map(i.split("--"),function(e,i){return i<l-1?!t.isNullOrUndefined(h.split("--")[i])&&(h.split("--")[i].indexOf(e.replace(c[i],"")>-1)||e.replace(c[i],"").indexOf(h.split("--")[i])>-1)&&d?u[i].split("&amp;").join("&"):e.split("$")[e.split("$").length-1]:i==l-1?d?u[i].split("&amp;").join("&"):e.replace(c[i],"").split("$")[e.split("$").length-1]+c[i]:e.split("$")[e.split("$").length-1]}).join("--")}).sort(function(e,t){return e.split("--").length-t.split("--").length}),p=e.map(p,function(t){var i=[];return(i=t.split("--").length<u.length?[t.split("&").join("&amp;").split("--").concat(e.map(u,function(e,i){if(t.split("--").length-1<i)return e}))]:[t.split("&").join("&amp;").split("--")]).join()!=u.join()?i:void 0}),m=e.map(m,function(t){return t.split("--").length<u.length?[t.split("&").join("&amp;").split("--").map(function(e){return e.split("$")[e.split("$").length-1]}).concat(e.map(u,function(e,i){if(t.split("--").length-1<i)return e}))]:[t.split("&").join("&amp;").split("--").map(function(e){return e.split("$")[e.split("$").length-1]})]}),f=[],e.each(e.map(p,function(e){return e.join("--")}),function(e,t){(0==f.length||-1==f.indexOf(t))&&f.push(t)}),s={expandCollection:p=e.map(f,function(e){return[e.split("--")]}),collapseCollection:m},p.length>0&&i.length>1&&r[r.length-1].indexOf(".children")<0&&(l=this._getDrillQuery(s,l,i)),l},_updateOlapReport:function(l,a,r,o){var n,s,d,h=this;return"rows"==r?(n=e.map(l,function(e,t){if(l[t].drilledItems!=i)return h._getSortedMembers(e,l)}),t.olap.base._isRowDrilled&&"rows"==t.olap.base._currIndex.axis&&l[t.olap.base._currIndex.Index]!=i&&l[t.olap.base._currIndex.Index].drilledItems!=i?(d=e.map(o,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),l[t.olap.base._currIndex.Index].drilledItems.push(d),t.olap.base._isRowDrilled=!1):n.length>0&&(t.olap.base._currIndex.axis==i||"columns"==t.olap.base._currIndex.axis&&!t.olap.base._isRowDrilled)&&(a=this._getDrillQuery(n,a,l)),t.isNullOrUndefined(t.olap.base._currIndex.axis)||"rows"!=t.olap.base._currIndex.axis||(t.olap.base._currIndex={})):(s=e.map(l,function(e,t){if(l[t].drilledItems!=i)return h._getSortedMembers(e,l)}),t.olap.base._isColDrilled&&"columns"==t.olap.base._currIndex.axis&&l[t.olap.base._currIndex.Index]!=i&&l[t.olap.base._currIndex.Index].drilledItems!=i?(d=e.map(o,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),l[t.olap.base._currIndex.Index].drilledItems.push(d),t.olap.base._isColDrilled=!1):s.length>0&&(t.olap.base._currIndex.axis==i||"rows"==t.olap.base._currIndex.axis&&!t.olap.base._isColDrilled)&&(a=this._getDrillQuery(s,a,l)),t.isNullOrUndefined(t.olap.base._currIndex.axis)||"columns"!=t.olap.base._currIndex.axis||(t.olap.base._currIndex={})),a},_getDrillQuery:function(l,a,r){for(var o,n,s,d="",h=l,u=0;u<h.length;u++)if(h[u][h[u].length-1].toLowerCase().indexOf(".children")>=0||h[u][h[u].length-1].toLowerCase().indexOf("drilldownlevel")>=0||h[u][h[u].length-1].toLowerCase().indexOf("members")>=0||(h[u][h[u].length-1]=h[u][h[u].length-1]+".children"),h[u].length!=r.length){for(o=e.map(r,function(l){if(l.fieldName!=i&&l.fieldName!=h[u][[h[u].length-1]].split(".").splice(0,2).join("."))return{uniqueName:t.olap.base._isPaging?"("+e.trim(l.fieldName)+").children":"DrillDownLevel("+e.trim(l.fieldName)+")",fieldName:e.trim(l.fieldName)}}),n=0;n<o.length;n++)s=this._getItemPosition(r,o[n].fieldName)[0],h[u].toString().indexOf(o[n].fieldName)>=0||h[u].splice(s,0,o[n].uniqueName);d=d+""+(u>0?",":"")+"\n ("+h[u]+")"}else d=d+""+(u>0?",":"")+"\n ("+h[u].toString()+")\n";return"("+a+"),"+d},_createDrillThroughQuery:function(i,l){var a,r;if(l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)l._waitingPopup.show(),a=e(l.element).hasClass("e-pivotclient")?l.element.find(".e-pivotgrid").data("ejPivotGrid"):l,l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.drillThroughDataTable,JSON.stringify({currentReport:e(l.element).parents(".e-pivotclient").length>0?l.currentReport:JSON.parse(a.getOlapReport()).Report,layout:e(l.element).hasClass("e-pivotclient")?l.model.gridLayout:l.model.layout,cellPos:"",selector:i}),function(e){this._trigger("drillThrough",{element:e.element,data:e})}),l._waitingPopup.hide();else{var o=l.measureGrp,n="",s="DRILLTHROUGH Select("+l._colHeader.join()+","+l._rowHeader.join()+") on 0 from ["+l.model.dataSource.cube+"]";e.map(l._fieldData.measures,function(e){e.pid==o&&(n+=""==n?"["+o+"]."+e.id.split(".")[1]:",["+o+"]."+e.id.split(".")[1])}),s=s.replace(/&/g,"&amp;"),r=l._getConnectionInfo(l.model.dataSource.data),pData='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+s+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+l.model.dataSource.catalog+"</Catalog> </PropertyList> </Properties></Execute> </Body> </Envelope>",l.doAjaxPost("POST",r.url,{XMLA:pData},t.Pivot._generateDrillData,null,{pvtGridObj:l,action:"loadFieldElements"})}},_getDimensionQuery:function(l,a,r,o,n){var s="";return l.drillCellInfo==i||n?s=t.isNullOrUndefined(l.expression)?t.isNullOrUndefined(l.hasAllMember)||!l.hasAllMember?t.olap.base._isPaging?"(("+e.trim(l.fieldName)+").children)":"DrillDownlevel(("+e.trim(l.fieldName)+"))":"(("+e.trim(l.fieldName)+").levels(0).AllMembers)":"("+l.hierarchyUniqueName+".["+(l.fieldCaption||l.fieldName)+"])":(s="{("+l.drillCellInfo.uniqueName+")}",delete l.drillCellInfo),s},_updateReport:function(i,l,a,r){var o,n,s,d={};r._isMondrian?(o=l.preRepItm.split(">#>"),n=(s=l.itemPosition)?l.previousElements.split(o[s-1])[1].split("][").length:l.previousElements.split("][").length,a.drilledItems&&(a.drilledItems.length<=n-1&&(a.drilledItems[n-1]=[]),l.action&&"collapse"==l.action?a.drilledItems[n-1]=e.grep(a.drilledItems[n-1],function(e){return e!=o[s]}):a.drilledItems[n-1].push(o[s])),d={action:"mondrianDrilldown"}):(a.drillCellInfo=e.extend({},l),a.drillCellInfo.uniqueName="("+e.trim(a.drillCellInfo.uniqueName)+".children)",d={action:"drilldown",cellInfo:l}),t.olap.base.getJSONData(d,r.model.dataSource,r)},_splitCellInfo:function(e){var i,l=t.olap.base.olapCtrlObj._isMondrian?1:2;return e&&(i={hierarchyUniqueName:e.split("::")[1].split(".").splice(0,l).join("."),uniqueName:e.split("::")[0],levelUniqueName:e.split("::")[1],leveName:e.split("::")[2],parentUniqueName:e.split("::")[3]}),i},updateDrilledReport:function(l,a,r){var o,n,s,d,h;t.olap.base._isPaging&&!t.isNullOrUndefined(r._pagingSavedObjects.curDrilledItem)&&(r._pagingSavedObjects.curDrilledItem=l);t.olap._mdxParser;var u,c,p,m=null,g="",f="";if((u=this._splitCellInfo(l.uniqueName)).targetUName=l.uniqueName,u.previousElements="",(c="rowheader"==a?r.model.dataSource.rows:"colheader"==a?r.model.dataSource.columns:null).length>0){if(m=(p=e.map(c,function(t,l){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(u.hierarchyUniqueName).toLowerCase()?{report:t,index:l}:t.hierarchyUniqueName!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(u.hierarchyUniqueName).toLowerCase()?{report:t,index:l}:void 0}))[0].report,u.itemPosition=p[0].index,!t.isNullOrUndefined(r._pivotRecords)||t.isNullOrUndefined(r._pivotClientObj)||t.isNullOrUndefined(r._pivotClientObj._pivotRecords)||(r._pivotRecords=r._pivotClientObj._pivotRecords),o=e.map(r._pivotRecords.records,function(e){if(e.Info.replace(/&/g,"&amp;")==l.uniqueName)return e.Index}),m.drilledItems!=i?m.drilledItems:m.drilledItems=[],t.olap.base._currIndex={axis:"rowheader"==a?"rows":"columns",Index:p[0].index},"ejPivotChart"==r.pluginName||"ejPivotTreeMap"==r.pluginName||t.isNullOrUndefined(l.index)){for(u.cellIndex=o.length>0?"":l.index,u.axis=v=a,"rowheader"!=a?t.olap.base._isColDrilled=l.action==i||"collapse"!=l.action:t.olap.base._isRowDrilled=l.action==i||"collapse"!=l.action,n=0;n<r.model.dataSource.rows.length&&l.seriesInfo[n]!=l.uniqueName;n++)r.model.dataSource.rows[n].drillCellInfo=this._splitCellInfo(l.seriesInfo[n]);for(u.previousElements="",u.preRepItm="",n=0;n<l.uniqueNameArray.length;n++)u.previousElements+=this._splitCellInfo(l.uniqueNameArray[n]).uniqueName;for(n=0;n<l.seriesInfo.length;n++)u.preRepItm+=""==u.preRepItm?this._splitCellInfo(l.seriesInfo[n]).uniqueName:">#>"+this._splitCellInfo(l.seriesInfo[n]).uniqueName}else{u.cellIndex=l.index;var _=u.hierarchyUniqueName,v="",b=(g="",""),C=u.cellIndex.split(",")[0],S=u.cellIndex.split(",")[1];if("rowheader"==a)for(v="rowheader",t.olap.base._isRowDrilled=l.action==i||"collapse"!=l.action,n=parseInt(C);n>=0;n--)!r._pivotRecords.records[parseInt(n*r._pivotRecords.rowCount+parseInt(C))].Info.indexOf(_)>=0&&(b=r._pivotRecords.records[parseInt(n*r._pivotRecords.rowCount+parseInt(S))].Info,(s=this._splitCellInfo(b))&&(g=s.uniqueName+g),""==b||b.indexOf(_)>=0||((d=this._splitCellInfo(b)).uniqueName=d.uniqueName.replace(/&/g,"&amp;"),f=d.uniqueName+">#>"+f,currReport=e.map(c,function(t,l){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:t.hierarchyUniqueName!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:void 0}),"collapse"!=l.action&&(r.model.dataSource.rows[currReport[0]].drillCellInfo=d),_=d.hierarchyUniqueName));else for(v="colheader",t.olap.base._isColDrilled=l.action==i||"collapse"!=l.action,n=parseInt(S);n>=0;n--)!r._pivotRecords.records[parseInt(C*r._pivotRecords.rowCount+parseInt(n))].Info.indexOf(_)>=0&&(b=r._pivotRecords.records[parseInt(C*r._pivotRecords.rowCount+parseInt(n))].Info,(s=this._splitCellInfo(b))&&(g=s.uniqueName+(r._isMondrian?"":">#>")+g),""==b||b.indexOf(_)>=0||((d=this._splitCellInfo(b)).uniqueName=d.uniqueName.replace(/&/g,"&amp;"),f=d.uniqueName+(r._isMondrian?">#>":"")+f,currReport=e.map(c,function(t,l){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:t.expression!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:void 0}),"collapse"!=l.action&&(r.model.dataSource.columns[currReport[0]].drillCellInfo=d),_=d.hierarchyUniqueName));f+=u.uniqueName,u.previousElements=g.replace(/&amp;/g,"&"),u.preRepItm=f.replace(/&amp;/g,"&"),u.axis=v}if(u.previousElements=u.previousElements.replace(/&amp;/g,"&"),u.preRepItm=u.preRepItm.replace(/&amp;/g,"&"),l.action)if(l.action){if(r._isMondrian)return u.action="collapse",void t.olap._mdxParser._updateReport(m.drilledItems,u,m,r);if(t.isNullOrUndefined(u)||t.isNullOrUndefined(u.previousElements)||""==u.previousElements||(t.olap.base.olapCtrlObj._prevDrillElements=u.previousElements.split("][").join("]>#>[").split(">#>")),(h=t.olap.base._getDrilledMemeber({item:u})).length&&!t.olap.base._isPaging)t.olap.base._onDemandCollapse({drilledMembers:h,action:l.action},v);else{for(;0!=h.length;)t.olap.base.olapCtrlObj.model.dataSource=t.olap._mdxParser._clearCollapsedItems(v,h[h.length-1],t.olap.base.olapCtrlObj.model.dataSource),h=h.splice(0,h.length-1);t.olap.base.getJSONData(l,t.olap.base.olapCtrlObj.model.dataSource,t.olap.base.olapCtrlObj)}}else e(l.drilledMember).clone(!0),t.olap.base._onDemandExpand({action:"drilldown",cellInfo:u,isExist:!0},l.drilledMember);else h=t.olap.base._getDrilledMemeber({item:u}),t.olap._mdxParser._updateReport(m.drilledItems,u,m,r)}},_clearCollapsedItems:function(t,l,a){return"rowheader"==t?a.rows=e.map(a.rows,function(t){return t.drilledItems!=i&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(l.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t}):"colheader"==t&&(a.columns=e.map(a.columns,function(t){return t.drilledItems!=i&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(l.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t})),a},_getSlicerMDX:function(t,l){for(var a=e(t)[0].filters,r="",o=this,n=l._fieldData,s=e.merge(e.merge([],t.columns),t.rows),d=0;d<a.length;d++)e.grep(s,function(e){var t=o._getDimensionUniqueName(e.fieldName,n),i=o._getDimensionUniqueName(a[d].fieldName,n);return t==i&&!(l._isMondrian&&""==i&&""==t)}).length>0||(a[d].fieldName!=i&&a[d].filterItems==i?r=r+(""!=r?"*":"")+"{"+this._getDimensionQuery(a[d])+"}":a[d].filterItems!=i&&(r=r+(""!=r?"*":"")+"{"+a[d].filterItems.values.toString()+"}"));return""!=r?"where ("+r.replace(/DrillDownlevel/g,"")+")":""},_getDimensionUniqueName:function(t,i){var l,a=i.hierarchy;return a?(l=e.map(a,function(e){if(e.id.toLowerCase()==t.toLowerCase())return e.pid})).length>0?l[0]:"":t.split(".")[0]},_getMeasuresQuery:function(t){var l,a,r,o=e(t)[0].values,n=[];return o.length>0&&(null!=(r=(a=jQuery.map(o,function(e,t){if(e.measures!=i)return{measureElements:e.measures,Index:t,axisName:e.axis}})).length>0?e.map(a[0].measureElements,function(e){return e.fieldName}):null)&&n.push({values:r,Index:a[0].Index}),o.axis),""!=(l=e.map(n,function(e){return e.values.toString()}))[0]?"{"+l+"}":""},_getIncludefilterQuery:function(t,l,a){var r,o,n,s="FROM ["+l+"]",d="FROM ( SELECT (",h=a._fieldData,u=[],c="COLUMNS";if(a._isMondrian)return s;for(r=e.map(e(t.rows),function(e){if(e.filterItems!=i)return[e.filterItems.values]}),o=e.map(e(t.columns),function(e){if(e.filterItems!=i)return[e.filterItems.values]}),n=0;n<t.filters.length;n++){var p=t.filters,m=this,g=!1;e.map(t.columns,function(e){m._getDimensionUniqueName(e.fieldName,h)==m._getDimensionUniqueName(p[n].fieldName,h)&&p[n].filterItems!=i&&(o.push(p[n].filterItems.values),g=!0)}),g||e.map(t.rows,function(e){m._getDimensionUniqueName(e.fieldName,h)==m._getDimensionUniqueName(p[n].fieldName,h)&&p[n].filterItems!=i&&r.push(p[n].filterItems.values)})}if(t.enableAdvancedFilter){for(n=0;n<=t.columns.length-1;n++)t.columns[n].advancedFilter&&e.merge(u,this._getAdvancedFilterQuery(t.columns[n],d,c));for(n=0;n<=t.rows.length-1;n++)t.rows[n].advancedFilter&&e.merge(u,this._getAdvancedFilterQuery(t.rows[n],d,c))}for(n=0;n<=o.length-1;n++)d=0==n?d+"{"+o[n].toString()+"}":d+",{"+o[n].toString()+"}";for(o.length>0&&(d=r.length>0?d+" ) on COLUMNS ,(":d+" ) on COLUMNS "),n=0;n<=r.length-1;n++)d=n>0?d+",{"+r[n].toString()+"}":d+"{"+r[n].toString()+"}";return d=o.length>0&&r.length>0?d+=") on ROWS ":0==o.length&&r.length>0?d+") on COLUMNS ":d,u.length>0&&(u=(o.length>0||r.length>0?d:"")+" "+u.join(" ")+" "+s+Array(u.length+1+o.length+r.length).join(")")),s=0==o.length&&0==r.length?s:d+s+")",u.length>0?u:s},_getAdvancedFilterQuery:function(i,l,a){var r=[],o=this;return e.map(i.advancedFilter,function(l){t.isNullOrUndefined(l.labelFilterOperator)&&l.labelFilterOperator==t.olap.LabelFilterOptions.None&&t.isNullOrUndefined(l.valueFilterOperator)&&l.valueFilterOperator==t.olap.ValueFilterOptions.None||r.push("FROM (SELECT Filter("+e.trim(l.name)+".AllMembers, "+o._getAdvancedFilterCondtions(i.fieldName,l.advancedFilterType==t.olap.AdvancedFilterType.LabelFilter||t.isNullOrUndefined(l.advancedFilterType)?l.labelFilterOperator:l.valueFilterOperator,l.values,l.advancedFilterType,l.measure)+")) on "+a)}),r},_getAdvancedFilterCondtions:function(e,i,l,a,r){var o="";a=t.isNullOrUndefined(a)?"label":a;switch(i.toLowerCase()){case"equals":o="("+("value"!=a?e+'.CurrentMember.member_caption ="'+l[0]+'"':r+" = "+l[0]);break;case"notequals":o="("+("value"!=a?e+'.CurrentMember.member_caption &lt;&gt;"'+l[0]+'"':r+" &lt;&gt;"+l[0]);break;case"contains":o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+l[0]+'")&gt;0';break;case"notcontains":o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+l[0]+'")=0';break;case"beginswith":o="( Left ("+e+".CurrentMember.member_caption,"+l[0].length+')="'+l[0]+'"';break;case"notbeginswith":o="( Left ("+e+".CurrentMember.member_caption,"+l[0].length+')&lt;&gt;"'+l[0]+'"';break;case"endswith":o="( Right ("+e+".CurrentMember.member_caption,"+l[0].length+')="'+l[0]+'"';break;case"notendswith":o="( Right ("+e+".CurrentMember.member_caption,"+l[0].length+')&lt;&gt;"'+l[0]+'"';break;case"greaterthan":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;"'+l[0]+'"':r+" &gt;"+l[0]);break;case"greaterthanorequalto":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;="'+l[0]+'"':r+" &gt;="+l[0]);break;case"lessthan":o="("+("value"!=a?e+'.CurrentMember.member_caption &lt;"'+l[0]+'"':r+" &lt;"+l[0]);break;case"lessthanorequalto":o="("+("value"!=a?e+'.CurrentMember.member_caption &lt;="'+l[0]+'"':r+" &lt;="+l[0]);break;case"between":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;="'+l[0]+'"AND '+e+'.CurrentMember.member_caption &lt;="'+l[1]+'"':r+" &gt;="+l[0]+" AND "+r+"&lt;="+l[1]);break;case"notbetween":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;="'+l[0]+'"OR '+e+'.CurrentMember.member_caption &lt;="'+l[1]+'"':r+" &gt;="+l[0]+" OR "+r+"&lt;="+l[1]);break;default:o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+l[0]+'")&gt;0'}return o},_getItemPosition:function(t,l){return e.map(t,function(t,a){if(t.fieldName!=i&&e.trim(t.fieldName)==e.trim(l))return a})},getAllMember:function(i,l,a){if(!t.isNullOrUndefined(a)){var r="select {"+l+"} dimension properties CHILDREN_CARDINALITY on 0 from ["+e.trim(i.cube)+"]",o=t.olap._mdxParser.getSoapMsg(r,i.data,i.catalog),n=t.olap.base._getConnectionInfo(i.data);a.doAjaxPost("POST",n.url,{XMLA:o},a._generateAllMember,null,{action:"loadFieldElements"})}},getMembers:function(i,l,a){var r=t.Pivot.getReportItemByFieldName(l,i).item;t.olap.base.olapCtrlObj._isMondrian&&(t.isNullOrUndefined(a.model.pivotControl)||(this._controlObj=a.model.pivotControl));var o="select {"+(r&&r.hasAllMember?l+".levels(0).AllMembers":l+".children")+"}dimension properties CHILDREN_CARDINALITY, MEMBER_TYPE on 0 from ["+e.trim(i.cube)+"]",n=t.olap._mdxParser.getSoapMsg(o,i.data,i.catalog),s=t.olap.base._getConnectionInfo(i.data);a.doAjaxPost("POST",s.url,{XMLA:n},a._generateMembers,null,{action:"fetchMembers"})},getChildren:function(e,i,l){var a,r,o="select {"+i+".children} dimension properties CHILDREN_CARDINALITY on 0 from ["+e.cube+"]",n=l.model.pivotControl;!t.isNullOrUndefined(n)&&t.olap.base.olapCtrlObj._isMondrian&&(this._controlObj=l.model.pivotControl),a=t.olap._mdxParser.getSoapMsg(o,e.data,e.catalog),r=t.olap.base._getConnectionInfo(e.data),l.doAjaxPost("POST",r.url,{XMLA:a},t.Pivot.generateChildMembers,null,{action:"nodeExpand",currentNode:i})},getSoapMsg:function(e,i,l){var a,r=t.olap.base._getConnectionInfo(i);return!t.isNullOrUndefined(this._controlObj)||!t.isNullOrUndefined(t.olap.base.olapCtrlObj)&&t.olap.base.olapCtrlObj._isMondrian?(a='<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+e+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+(t.isNullOrUndefined(this._controlObj)?t.olap.base.olapCtrlObj.model.dataSource.sourceInfo:this._controlObj.model.dataSource.sourceInfo)+"</DataSourceInfo><Catalog>"+l+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>",delete this._controlObj):a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+e+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+l+"</Catalog> <LocaleIdentifier>"+r.LCID+"</LocaleIdentifier></PropertyList> </Properties> </Execute> </Body> </Envelope>",a}},t.olap.SortOrder={None:"none",Ascending:"ascending",Descending:"descending"},t.olap.Providers={SSAS:"ssas",Mondrian:"mondrian"},t.olap.AdvancedFilterType={LabelFilter:"label",ValueFilter:"value"},t.olap.ValueFilterOptions={None:"none",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.olap.LabelFilterOptions={None:"none",BeginsWith:"beginswith",NotBeginsWith:"notbeginswith",EndsWith:"endswith",NotEndsWith:"notendswith",Contains:"contains",NotContains:"notcontains",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.olap.AxisName={Row:"rows",Column:"columns"}}(jQuery,Syncfusion)})},1010:function(e,t,l){var a,r,o;
/*!
*  filename: ej.pivot.common.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivot.common.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(i){r=[l(4)],void 0===(o="function"==typeof(a=i)?a.apply(t,r):a)||(e.exports=o)}(function(){ej.Pivot=ej.Pivot||{},function(e,t,l){t.Pivot={addReportItem:function(e,i){var l,a;if(i.isMeasuresDropped)""!=i.droppedClass?e.values[0].axis="row"==i.droppedClass?"rows":"column"==i.droppedClass?"columns":e.values[0].axis:e.values[0].measures=[];else{for(a in l=this.removeReportItem(e,i.droppedFieldName,i.isMeasuresDropped),t.isNullOrUndefined(l)&&(l={fieldName:i.droppedFieldName,fieldCaption:i.droppedFieldCaption,format:i.droppedFieldFormat,formatString:i.droppedFieldFormatString,showSubTotal:i.droppedFieldShowSubTotal,expression:i.droppedExpression,hierarchyUniqueName:i.droppedHierarchyUniqueName,summaryType:i.summaryType}),l)("format"==a||"formatString"==a)&&(t.isNullOrUndefined(l[a])||""==l[a])&&delete l[a];switch(i.droppedClass){case"row":""!=i.droppedPosition.toString()?e.rows.splice(i.droppedPosition,0,l):e.rows.push(l);break;case"column":""!=i.droppedPosition.toString()?e.columns.splice(i.droppedPosition,0,l):e.columns.push(l);break;case"value":""==e.cube?""!=i.droppedPosition.toString()?e.values.splice(i.droppedPosition,0,l):e.values.push(l):""!=i.droppedPosition.toString()?e.values[0].measures.splice(i.droppedPosition,0,l):e.values[0].measures.push(l);break;case"filter":""!=i.droppedPosition.toString()?e.filters.splice(i.droppedPosition,0,l):e.filters.push(l)}}},removeReportItem:function(i,l,a){var r,o=""==i.cube?t.Pivot.AnalysisMode.Pivot:t.Pivot.AnalysisMode.Olap,n=e.grep(i.columns,function(e){return e.fieldName==l});return a?i.values[0].measures=[]:n.length>0?i.columns=e.grep(i.columns,function(e){return e.fieldName!=l}):(n=e.grep(i.rows,function(e){return e.fieldName==l})).length>0?i.rows=e.grep(i.rows,function(e){return e.fieldName!=l}):(r=o==t.Pivot.AnalysisMode.Olap?i.values[0].measures:i.values,(n=e.grep(r,function(e){return e.fieldName==l})).length>0?i.values=o==t.Pivot.AnalysisMode.Olap?[{measures:e.grep(r,function(e){return e.fieldName!=l}),axis:i.values[0].axis}]:e.grep(r,function(e){return e.fieldName!=l}):(n=e.grep(i.filters,function(e){return e.fieldName==l})).length>0&&(i.filters=e.grep(i.filters,function(e){return e.fieldName!=l}))),n[0]},getReportItemByFieldName:function(i,l){var a,r="columns",o=e.grep(l.columns,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()});return 0==o.length&&(o=e.grep(l.rows,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="rows"),0==o.length&&(a=""==l.cube?l.values:l.values.length>0&&!t.isNullOrUndefined(l.values[0].measures)?l.values[0].measures:[],o=e.grep(a,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="values"),0==o.length&&(o=e.grep(l.filters,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="filters"),{item:o[0],axis:r}},getReportItemByFieldCaption:function(i,l){var a,r="columns",o=e.grep(l.columns,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()});return 0==o.length&&(o=e.grep(l.rows,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="rows"),0==o.length&&(a=""==l.cube?l.values:l.values.length>0&&!t.isNullOrUndefined(l.values[0].measures)?l.values[0].measures:[],o=e.grep(a,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="values"),0==o.length&&(o=e.grep(l.filters,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="filters"),{item:o[0],axis:r}},closePreventPanel:function(i){var l="close"!=i.type?i:this;l.element.find("[id^='preventDiv']").remove(),t.isNullOrUndefined(l.model.pivotControl)?l._currentReportItems=e.extend(!0,[],l._savedReportItems):(l.model.pivotControl.element.find("[id^='preventDiv']").remove(),l.model.pivotControl._currentReportItems=e.extend(!0,[],l.model.pivotControl._savedReportItems)),t.isNullOrUndefined(l._waitingPopup)||l._waitingPopup.hide(),t.isNullOrUndefined(l.model.pivotControl)||t.isNullOrUndefined(l.model.pivotControl._waitingPopup)||l.model.pivotControl._waitingPopup.hide()},openPreventPanel:function(i){var l=t.buildTag("div#preventDiv.errorDlg").css({width:e("body").width()+"px",height:e("body").height()+"px",position:"absolute",top:e("body").offset().top+"px",left:e("body").offset().left+"px","z-index":10})[0].outerHTML;e("#"+i._id).append(l)},_createErrorDialog:function(i,l,a){var r,o;if(t.Pivot.closePreventPanel(a),a._errorDialog=l,t.Pivot.openPreventPanel(a),0==a.element.find(".e-errorDialog:visible").length&&(r=t.isNullOrUndefined(i.Exception)?t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent action:",i)[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn",a._getLocalizedLabels("OK"),{margin:"20px 0 10px 165px"}).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML)[0].outerHTML).attr("title",l)[0].outerHTML:t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent action:",i.Exception.Message)[0].outerHTML+t.buildTag("br")[0].outerHTML+t.buildTag("div."+a._id+"stackTraceContent","Stack Trace :"+i.Exception.StackTraceString)[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn",a._getLocalizedLabels("OK"),{margin:"20px 0 10px 165px"}).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML)[0].outerHTML).attr("title",l)[0].outerHTML,a.element.append(r),a.element.find(".e-errorDialog").ejDialog({target:"#"+a._id,enableResize:!1,enableRTL:a.model.enableRTL,width:"400px",close:t.proxy(t.Pivot.closePreventPanel,a)}),o=a.element.find(".e-errorDialog").data("ejDialog"),e("#"+o._id+"_wrapper").css({left:"50%",top:"50%"}),a.element.find(".errOKBtn").ejButton({type:t.ButtonType.Button,width:"50px"}).on(t.eventType.click,function(){"nodeCheck"!=a._errorDialog||t.isNullOrUndefined(a._schemaData)||t.isNullOrUndefined(a._schemaData._selectedTreeNode)||a._schemaData._tableTreeObj.uncheckNode(a._schemaData._selectedTreeNode),a.element.find("#preventDiv").remove(),(a._errorDialog==a._getLocalizedLabels("Success")||a._errorDialog==a._getLocalizedLabels("Warning")||a._errorDialog==a._getLocalizedLabels("Exception")||a._errorDialog==a._getLocalizedLabels("Error"))&&a.element.children("#ErrorDialog_wrapper").remove()}),a.element.find(".e-dialog .e-close").attr("title","Close"),t.isNullOrUndefined(e("#"+a._id).data("ejWaitingPopup"))||e("#"+a._id).data("ejWaitingPopup").hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide(),!t.isNullOrUndefined(i.Exception))){var n="Show more";e("."+a._id+"stackTraceContent").each(function(){var i=e(this).html();if(i.length>50){a._id;var l=i.substr(0,50),r=i.substr(50,i.length-50),o=l+t.buildTag("span."+a._id+"moreellipses","...")[0].outerHTML+t.buildTag("span."+a._id+"morecontent",t.buildTag("span",r).css("display","none")[0].outerHTML+t.buildTag("a."+a._id+"morelink",n).css("display","block")[0].outerHTML)[0].outerHTML;e(this).html(o)}}),e("."+a._id+"morelink").click(function(){return e(this).hasClass("less")?(e(this).removeClass("less"),e(this).html(n)):(e(this).addClass("less"),e(this).html("Show less")),e(this).parent().prev().toggle("slow",function(){}),e(this).prev().toggle("slow",function(){}),!1})}},_updateValueSortingIndex:function(i,a){if(i.SortColIndex!=l)t.PivotAnalysis._valueSorting=JSON.parse(i.SortColIndex)[0],t.PivotAnalysis._sort=a.model.valueSortSettings.sortOrder;else{i=i[0]!=l?i:i.d!=l?i.d:i;var r=e.map(i,function(e){if(null!=e)var t=e.Key;if(null!=t&&t!=l&&"SortColIndex"==t)return e});r.length>0?(i.splice(e.map(i,function(e,t){if("SortColIndex"==e.Key)return t}),1),t.PivotAnalysis._valueSorting=JSON.parse(r[0].Value),t.PivotAnalysis._sort=a.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null}},_memberSortBtnClick:function(i){var a,r,o,n,s,d,h,u=this.element.hasClass("e-pivotclient")&&"servermode"==this.model.operationalMode&&"olap"==this.model.analysisMode,c="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this,p="ejPivotGrid"==this.pluginName&&c.model.analysisMode==t.Pivot.AnalysisMode.Olap&&c.model.operationalMode==t.Pivot.OperationalMode.ServerMode,m=e(i.target).parents(".e-memberEditorDiv").find(".e-editorTreeView"),g=this._sortType=e(i.target).hasClass("e-memberAscendingIcon")?"ascending":"descending",f=[],_=jQuery.extend(!0,[],this._memberTreeObj._dataSource);if(this.element.find(".e-memberDrillPager").is(":visible")&&(a=this.model.memberEditorPageSize==l?this.model.pivotControl.model.memberEditorPageSize:this.model.memberEditorPageSize,f=t.Pivot._getParentsTreeList(this,this._drilledNode,this._editorTreeData).concat(t.DataManager(this._editorDrillTreeData[this._drilledNode]).executeLocal(t.Query().sortBy("name",this._sortType).page(this._memberDrillPageSettings.currentMemberDrillPage,a)))),!t.isNullOrUndefined(m)&&m.length>0){if(t.Pivot.updateTreeView(this),r=(this.model.enableMemberEditorPaging||!t.isNullOrUndefined(this.model.pivotControl)&&this.model.pivotControl.model.enableMemberEditorPaging)&&!this._isSearchApplied?this._editorTreeData:m.data("ejTreeView").model.fields.dataSource,o=u||"All"!=r[0].id&&"(All)_0"!=r[0].id?r:r.slice(1),f.length>0&&(o=f),o.length>1&&"SearchFilterSelection"==o[0].id&&(o=o.slice(1)),n=u?[]:r.length>1&&("All"==r[0].id||"(All)_0"==r[0].id)?r.splice(0,1):[],s=t.DataManager(o).executeLocal(t.Query().sortBy("name",g)),!t.isNullOrUndefined(n)&&n.length>0&&(s.splice(0,0,n[0]),r.splice(0,0,n[0])),(this.model.enableMemberEditorPaging||!t.isNullOrUndefined(this.model.pivotControl)&&this.model.pivotControl.model.enableMemberEditorPaging)&&0==f.length&&(s=t.DataManager(s).executeLocal(t.Query().page(this._memberPageSettings.currentMemeberPage,(this.model.memberEditorPageSize||this.model.pivotControl.model.memberEditorPageSize)+(1==this._memberPageSettings.currentMemeberPage?1:0)))),c.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&s.length>0&&"All"!=s[0].id&&"(All)_0"!=s[0].id&&!t.isNullOrUndefined(n)&&n.length>0&&s.splice(0,0,n[0]),n={},m.data("ejTreeView").model.fields.dataSource.length>1&&"SearchFilterSelection"==m.data("ejTreeView").model.fields.dataSource[1].id&&"SearchFilterSelection"!=s[1].id&&s.splice(1,0,{id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:this._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),u&&this._isSearchApplied&&s.splice(0,0,{id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:this._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),t.isNullOrUndefined(m)||m.ejTreeView({fields:{dataSource:jQuery.extend(!0,[],s)}}),f.length>0&&!t.isNullOrUndefined(_)&&(this._memberTreeObj._dataSource=_),p)for(d=this.element.find(".e-editorTreeView").find("li"),h=0;h<d.length;h++)t.isNullOrUndefined(e(d[h]).attr("id"))||e(d[h]).attr("data-tag",t.DataManager(m.data("ejTreeView").model.fields.dataSource).executeLocal(t.Query().where("id","equal",e(d[h]).attr("id")))[0].tag);t.Pivot._separateAllMember(this)}},_contextMenuOpen:function(i,l){var a,r,o,n;if(t.Pivot.openPreventPanel(l),l._selectedMember=e(i.target),"ejPivotGrid"==l.pluginName?(a=l.model.analysisMode==t.Pivot.AnalysisMode.Olap?"olap":"pivot",o=e("#pivotTree").data("ejMenu")):(t.isNullOrUndefined(l.model.pivotControl)||(a=l.model.pivotControl.model.analysisMode==t.Pivot.AnalysisMode.Olap?"olap":"pivot"),o=e("#"+l._id+"_pivotTreeContextMenu").data("ejMenu")),a==t.Pivot.AnalysisMode.Olap){if(t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))&&e(i.target).hasClass("e-pivotButton")&&e(i.target).children(".e-pvtBtn:eq(0)").length>0)return o.disable(),l._selectedMember=e(i.target).children(".e-pvtBtn:eq(0)"),!1;!t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))&&e(i.target).parent().attr("data-tag").split(":")[1].toLowerCase().startsWith("[measures]")?o.disable():t.isNullOrUndefined(l._selectedMember.parent().attr("data-tag"))||"measures"!=l._selectedMember.parent().attr("data-tag").split(":")[1].toLowerCase()?t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))?o.disable():(o.disableItem(l._getLocalizedLabels("AddToValues")),e(i.target.parentElement).find(".e-namedSetCDB").length>0?o.disableItem(l._getLocalizedLabels("AddToFilter")):o.enableItem(l._getLocalizedLabels("AddToFilter")),o.enableItem(l._getLocalizedLabels("AddToRow")),o.enableItem(l._getLocalizedLabels("AddToColumn"))):(o.disableItem(l._getLocalizedLabels("AddToValues")),o.disableItem(l._getLocalizedLabels("AddToFilter")),o.enableItem(l._getLocalizedLabels("AddToRow")),o.enableItem(l._getLocalizedLabels("AddToColumn")))}else a==t.Pivot.AnalysisMode.Pivot&&(r=i.target.textContent,e(i.target).hasClass("e-btn")?(o.enable(),"ejPivotGrid"==l.pluginName&&(o.disableItem(l._getLocalizedLabels("CalculatedField")),"values"==e(i.target).parents(".e-pivotButton").attr("data-tag").split(":")[0].toLowerCase()&&(l.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&e.grep(l.model.dataSource.values,function(e){return e.fieldCaption==r&&1==e.isCalculatedField}).length>0?o.disable():l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&e.grep(JSON.parse(l.getOlapReport()).PivotCalculations,function(e){return e.FieldHeader==r&&8==e.CalculationType}).length>0&&o.disable(),o.enableItem(l._getLocalizedLabels("CalculatedField"))))):e("#pivotTree").length>0?(o=e("#pivotTree").data("ejMenu")).disable():o.disable());n=l.model.pivotControl,t.isNullOrUndefined(n)||n.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||0==e(i.target).parents(".e-schemaValue").length&&o.disableItem(l._getLocalizedLabels("SummarizeValueBy"))},_searchTreeNodes:function(i){var l,a,r,o,n,s,d=e(i.target).hasClass("searchTreeView")?this.element.find(".searchTreeView").data("ejMaskEdit"):this.element.find(".searchEditorTreeView").data("ejMaskEdit"),h=e(i.target).hasClass("searchTreeView")?this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-schemaFieldTree").data("ejTreeView"):this.element.find(".e-cubeTreeView").data("ejTreeView"):this.element.find(".e-editorTreeView").data("ejTreeView"),u={id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),hasChildren:!1,checkedStatus:!0,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"},c=h.element,p=c.find("li[data-isItemSearch='true']"),m=t.isNullOrUndefined(d.get_StrippedValue())?"":d.get_StrippedValue().toLowerCase();if(p.length>0&&e(p).each(function(e,t){t.removeAttribute("data-isItemSearch")}),m.length>0){var g=[],f=[],_=c.find("ul>li>div>a");for(l=0;l<_.length;l++)-1!=e(_[l]).text().toLowerCase().indexOf(m)||"(All)_0"==e(e(_[l]).closest("li")).attr("id")||"All"==e(e(_[l]).closest("li")).attr("id")||"SearchFilterSelection"==e(e(_[l]).closest("li")).attr("id")?g.push(_[l]):f.push(_[l]);for((a=c.find(g).closest("li").css("display","block")).length>0&&(this._isOptionSearch=!0,e(a).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&i.setAttribute("data-isItemSearch",!0)}),c.hasClass("e-editorTreeView")&&(!c.find("li span.e-searchfilterselection").length>0?("(All)_0"==c.find("li:first").attr("id")||"All"==c.find("li:first").attr("id")?(a.length>1&&h.insertAfter(u,c.find("li:first")),(this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl.model.analysisMode:this.model.analysisMode)==t.Pivot.AnalysisMode.Pivot&&c.find("li span.e-searchfilterselection").closest("li").css("padding","0")):h.insertBefore(u,c.find("li:first")),c.find("li span.e-searchfilterselection").closest("li").attr("data-tag",u.tag)):c.find("li span.e-searchfilterselection").length>0&&!this._isSelectSearchFilter&&h.uncheckNode(c.find("li span.e-searchfilterselection").closest("li")))),c.find(f).closest("li").css("display","none"),s=0;s<a.length;s++)(o=(r=e(a[s])).parents("ul").closest("li").css("display","block")).length>0&&(h.expandNode(o),-1!=h.model.expandedNodes.indexOf(e(h._liList).index(o))||t.isNullOrUndefined(window._temp)||window._temp.push(o)),(n=r.children("ul")).length>0&&0==n.children("li:visible").length&&(r.children("ul").children("li").css("display","block"),h.expandNode(a[s]),-1!=h.model.expandedNodes.indexOf(e(h._liList).index(a[s]))||t.isNullOrUndefined(window._temp)||window._temp.push(a[s]))}else{c.find("ul>li").css("display","block"),c.find("li span.e-searchfilterselection").closest("li").length>0&&h.removeNode(c.find("#SearchFilterSelection")),e(c.find("ul>li")).each(function(e,t){t.removeAttribute("data-isItemSearch")}),this._isOptionSearch=!1;var v=e(c).find("ul>li"),b=0,C=0;if("(All)_0"==e(e(v)[0]).attr("id")||"All"==e(e(v)[0]).attr("id")){for(s=1;s<e(v).length;s++)e(e(v)[s]).find("span.e-checkmark").length>0?b++:C++;b>0&&C>0?e(c.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-checkmark").addClass("e-stop"):b>0&&0==C?e(c.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-stop").addClass("e-checkmark"):e(c.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-checkmark").removeClass("e-stop")}if(!t.isNullOrUndefined(window._temp))for(s=0;s<window._temp.length;s++)h._collpaseNode(window._temp[s]);window._temp=[],e(i.target).hasClass("searchTreeView")&&h.collapseAll()}},_updateSearchFilterSelection:function(i,l,a){var r,o,n={},s={};"SearchFilterSelection"==i.id&&(r=e(l).find("li:not([data-isItemSearch='true'])"),"nodeCheck"==i.type?(a._isSelectSearchFilter=!0,a._isOptionSearch?r.length>0&&e(r).each(function(i,r){"SearchFilterSelection"!=e(r).attr("id")&&!t.isNullOrUndefined(a._currentFilterList[e(r).attr("id")])&&a._currentFilterList[e(r).attr("id")].checkedStatus&&e(l).ejTreeView("checkNode",e(r))}):r.length>0&&(a.model.enableMemberEditorPaging&&(n=a._currentFilterList,e(n).each(function(e,t){s[t.id]=t})),e(a._editorTreeData).each(function(i,l){for(var o=0;o<r.length;o++){if(r[o].id==l.id){l.checkedStatus=e(r[o]).find(".checked").length>0;break}t.isNullOrUndefined(a._currentFilterList)||(l.checkedStatus=a.model.enableMemberEditorPaging&&!t.isNullOrUndefined(s)?s[e(l).attr("id")].checkedStatus:a._currentFilterList[e(l).attr("id")].checkedStatus)}}),o=!0,e(a._editorTreeData).each(function(e,t){if(t.checkedStatus)return o=!1,!1}),o&&a._editorTreeData.length>0?(a._dialogOKBtnObj.disable(),a.element.find(".e-dialogOKBtn").attr("disabled","disabled")):(a._dialogOKBtnObj.enable(),a.element.find(".e-dialogOKBtn").removeAttr("disabled")))):"nodeUncheck"==i.type&&(a._isSelectSearchFilter=!1,a._isOptionSearch?r.length>0&&e(r).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&e(l).ejTreeView("uncheckNode",e(i))}):r.length>0&&(e(a._editorTreeData).each(function(t,i){for(var l=0;l<r.length;l++){if(r[l].id==i.id){i.checkedStatus=e(r[l]).find(".checked").length>0;break}i.checkedStatus=!1}}),o=!0,e(a._editorTreeData).each(function(e,t){if(t.checkedStatus)return o=!1,!1}),o&&a._editorTreeData.length>0?(a._dialogOKBtnObj.disable(),a.element.find(".e-dialogOKBtn").attr("disabled","disabled")):(a._dialogOKBtnObj.enable(),a.element.find(".e-dialogOKBtn").removeAttr("disabled")))))},editorTreeNavigatee:function(i,l){var a,r;if(e(i.target).parents(".e-memberPager").length>0){if(r=l._memberPageSettings.currentMemeberPage,!e(i.target).hasClass("e-pageDisabled")){if(e(i.target).hasClass("e-nextPage"))l._memberPageSettings.startPage+=l.model.memberEditorPageSize,l._memberPageSettings.currentMemeberPage+=1,l._memberPageSettings.endPage+=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))l._memberPageSettings.currentMemeberPage-=1,l._memberPageSettings.startPage=Math.abs(l._memberPageSettings.startPage-(l._memberPageSettings.currentMemeberPage,l.model.memberEditorPageSize)),l._memberPageSettings.endPage-=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))l._memberPageSettings.currentMemeberPage=1,l._memberPageSettings.endPage=l.model.memberEditorPageSize,l._memberPageSettings.startPage=0;else if(e(i.target).hasClass("e-lastPage"))l._memberPageSettings.currentMemeberPage=parseInt(e.trim(l.element.find(".e-memberPageCount").text().split("/")[1])),l._memberPageSettings.endPage=l._memberPageSettings.currentMemeberPage*l.model.memberEditorPageSize,l._memberPageSettings.startPage=l._memberPageSettings.endPage-l.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(l.element.find(".e-memberPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return l.element.find(".e-memberCurrentPage").val(r),!1;l._memberPageSettings.currentMemeberPage=parseInt(e(i.target).val()),l._memberPageSettings.endPage=l._memberPageSettings.currentMemeberPage*l.model.memberEditorPageSize,l._memberPageSettings.startPage=1==l._memberPageSettings.currentMemeberPage||0==l._memberPageSettings.currentMemeberPage?0:l._memberPageSettings.endPage-l.model.memberEditorPageSize}l._waitingPopup.show(),l.element.hasClass("e-pivotclient")&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(l.model.enableMemberEditorSorting&&(l._editorTreeData=t.DataManager(l._editorTreeData).executeLocal(t.Query().sortBy("name",l._sortType))),this.editorTreePageInfoSuccess(l._editorTreeData,l)):("ejPivotSchemaDesigner"!=l.pluginName?l._isMemberPageFilter=!0:l.model.pivotControl._isMemberPageFilter=!0,t.Pivot.updateTreeView(l),a=t.DataManager(l._editorTreeData).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType).where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0")).page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize)),l._memberPageSettings.currentMemeberPage>1?l.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberPageSettings.currentMemeberPage==parseInt(e.trim(l.element.find(".e-memberPageCount").text().split("/")[1]))?l.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),l.element.find(".e-memberCurrentPage").val(l._memberPageSettings.currentMemeberPage),l.element.find(".e-nextPageDiv .e-pageDisabled").css("opacity","0.5"),l.element.find(".e-nextPageDiv .e-pageEnabled").css("opacity","1"),t.Pivot._createSearchTreeview(a,l),l._waitingPopup.hide())}}else if(e(i.target).parents(".e-memberSearchPager").length>0){if(r=l._memberSearchPageSettings.currentMemberSearchPage,!e(i.target).hasClass("e-pageDisabled")){if(e(i.target).hasClass("e-nextPage"))l._memberSearchPageSettings.startSearchPage+=l.model.memberEditorPageSize,l._memberSearchPageSettings.currentMemberSearchPage+=1,l._memberSearchPageSettings.endSearchPage+=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))l._memberSearchPageSettings.currentMemberSearchPage-=1,l._memberSearchPageSettings.startSearchPage=Math.abs(l._memberSearchPageSettings.startSearchPage-(l._memberSearchPageSettings.currentMemberSearchPage,l.model.memberEditorPageSize)),l._memberSearchPageSettings.endSearchPage-=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))l._memberSearchPageSettings.currentMemberSearchPage=1,l._memberSearchPageSettings.endSearchPage=l.model.memberEditorPageSize,l._memberSearchPageSettings.startSearchPage=0;else if(e(i.target).hasClass("e-lastPage"))l._memberSearchPageSettings.currentMemberSearchPage=parseInt(e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1])),l._memberSearchPageSettings.endSearchPage=l._memberSearchPageSettings.currentMemberSearchPage*l.model.memberEditorPageSize,l._memberSearchPageSettings.startSearchPage=l._memberSearchPageSettings.endSearchPage-l.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return l.element.find(".e-memberCurrentSearchPage").val(r),!1;l._memberSearchPageSettings.currentMemberSearchPage=parseInt(e(i.target).val()),l._memberSearchPageSettings.endSearchPage=l._memberSearchPageSettings.currentMemberSearchPage*l.model.memberEditorPageSize,l._memberSearchPageSettings.startSearchPage=1==l._memberSearchPageSettings.currentMemberSearchPage||0==l._memberSearchPageSettings.currentMemberSearchPage?0:l._memberSearchPageSettings.endSearchPage-l.model.memberEditorPageSize}l._waitingPopup.show(),l.element.hasClass("e-pivotclient")&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._editorTreeSearchPageInfoSuccess(l._editorSearchTreeData,l):("ejPivotSchemaDesigner"!=l.pluginName?l._isMemberPageFilter=!0:l.model.pivotControl._isMemberPageFilter=!0,this._editorTreeSearchPageInfoSuccess(l._editorSearchTreeData,l))}}else if(e(i.target).parents(".e-memberDrillPager").length>0&&(r=l._memberDrillPageSettings.currentMemberDrillPage,!e(i.target).hasClass("e-pageDisabled"))){if(e(i.target).hasClass("e-nextPage"))l._memberDrillPageSettings.startDrillPage+=l.model.memberEditorPageSize,l._memberDrillPageSettings.currentMemberDrillPage+=1,l._memberDrillPageSettings.endDrillPage+=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))l._memberDrillPageSettings.currentMemberDrillPage-=1,l._memberDrillPageSettings.startDrillPage=Math.abs(l._memberDrillPageSettings.startDrillPage-(l._memberDrillPageSettings.currentMemberDrillPage,l.model.memberEditorPageSize)),l._memberDrillPageSettings.endDrillPage-=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))l._memberDrillPageSettings.currentMemberDrillPage=1,l._memberDrillPageSettings.endDrillPage=l.model.memberEditorPageSize,l._memberDrillPageSettings.startDrillPage=0;else if(e(i.target).hasClass("e-lastPage"))l._memberDrillPageSettings.currentMemberDrillPage=parseInt(e.trim(l.element.find(".e-memberDrillPageCount").text().split("/")[1])),l._memberDrillPageSettings.endDrillPage=l._memberDrillPageSettings.currentMemberDrillPage*l.model.memberEditorPageSize,l._memberDrillPageSettings.startDrillPage=l._memberDrillPageSettings.endDrillPage-l.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(l.element.find(".e-memberDrillPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return l.element.find(".e-memberCurrentDrillPage").val(r),!1;l._memberDrillPageSettings.currentMemberDrillPage=parseInt(e(i.target).val()),l._memberDrillPageSettings.endDrillPage=l._memberDrillPageSettings.currentMemberDrillPage*l.model.memberEditorPageSize,l._memberDrillPageSettings.startDrillPage=1==l._memberDrillPageSettings.currentMemberDrillPage||0==l._memberDrillPageSettings.currentMemberDrillPage?0:l._memberDrillPageSettings.endDrillPage-l.model.memberEditorPageSize}l._waitingPopup.show(),this._editorTreeDrillPageInfoSuccess(l._memberTreeObj._dataSource.slice(),l)}},editorTreePageInfoSuccess:function(i,a){setTimeout(function(){var r,o;a._memberPageSettings.currentMemeberPage>1?a.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberPageSettings.currentMemeberPage==parseInt(e.trim(a.element.find(".e-memberPageCount").text().split("/")[1]))?a.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),a.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(r=i[0]!=l?i[0].Value:i.d!=l?i.d[0].Value:i.EditorTreeInfo,(o=e.parseJSON(r)).splice(-1,1)),a.element.find(".e-memberCurrentPage").val(a._memberPageSettings.currentMemeberPage),a._appendTreeViewData(a.model.operationalMode==t.Pivot.OperationalMode.ClientMode?o:t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)),a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0),a._waitingPopup.hide()},0)},_editorTreeDrillPageInfoSuccess:function(i,a){setTimeout(function(){var r,o,n;a._memberDrillPageSettings.currentMemberDrillPage>1?a.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberDrillPageSettings.currentMemberDrillPage==parseInt(e.trim(a.element.find(".e-memberDrillPageCount").text().split("/")[1]))?a.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),a.element.find(".e-memberCurrentDrillPage").val(a._memberDrillPageSettings.currentMemberDrillPage),o=0,i.length>0&&i[0].length>0&&"All"==i[0][0].id&&i[0].splice(0,1),e.each(i,function(e,t){if(1!=t.length||!t[0].expanded)return!1;o=e}),n=a.model.enableMemberEditorSorting&&a._sortType?t.DataManager(t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",i[o][0].id).sortBy("name",a._sortType))).executeLocal(t.Query().where("pid","notequal",l).page(a._memberDrillPageSettings.currentMemberDrillPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)):t.DataManager(t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",i[o][0].id))).executeLocal(t.Query().where("pid","notequal",l).page(a._memberDrillPageSettings.currentMemberDrillPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)),a._editorDrillTreePageSettings[i[o][0].id]=e.extend(!0,{},a._memberDrillPageSettings),a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0?(r=t.Pivot._getParentsTreeList(a,i[o][0].id,a._editorTreeData).concat(n),"ejPivotClient"!=a.pluginName?t.Pivot._createSearchTreeview(r,a):a._appendTreeViewData(r,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0)):"ejPivotClient"!=a.pluginName?t.Pivot._createSearchTreeview(n,a):a._appendTreeViewData(n,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0),a._waitingPopup.hide()},0)},_editorTreeSearchPageInfoSuccess:function(i,l){setTimeout(function(){var a,r="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize;for(l._memberSearchPageSettings.currentMemberSearchPage>1?l.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberSearchPageSettings.currentMemberSearchPage==parseInt(e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1]))?l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),i=t.DataManager(i).executeLocal(t.Query().where(t.Predicate("id","notequal","(All)_0").and("id","notequal","All"))).slice((l._memberSearchPageSettings.currentMemberSearchPage-1)*r,(l._memberSearchPageSettings.currentMemberSearchPage-1)*r+r),a=0;a<i.length;a++)t.isNullOrUndefined(i[a].pid)||(i[a].parentId=i[a].pid);for(a=0;a<i.length;a++)t.Pivot._appendParentNodes(i,i[a],l);l.element.find(".e-memberCurrentSearchPage").val(l._memberSearchPageSettings.currentMemberSearchPage),i.splice(0,0,{id:"SearchFilterSelection",name:l._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:l._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),"ejPivotClient"==l.pluginName&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l._appendTreeViewData(i,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):t.Pivot._createSearchTreeview(i,l),l._waitingPopup.hide(),l._parentNodeCollection={},l._parentSearchNodeCollection={}},0)},_drillEditorTreeNode:function(i,a,r){var o,n;a._waitingPopup.show(),o=i.childNodes,a._isEditorDrillPaging&&!a._isEditorCollapseDrillPaging?a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0&&(a._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0},t.isNullOrUndefined(i.parentNode.id)||(a._editorDrillTreeData[i.parentNode.id]=o.slice(),a._editorDrillTreePageSettings[i.parentNode.id]=e.extend(!0,{},a._memberDrillPageSettings)),this._refreshDrillEditorPager(i,a,r)):a._isEditorCollapseDrillPaging&&(a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0&&(a._isEditorCollapseDrillPaging=!1,a._memberDrillPageSettings=t.isNullOrUndefined(i.parentNode.id)?i.drillPageSettings:i.drillPageSettings[i.parentNode.id]),this._refreshDrillEditorPager(i,a,r)),a._drilledNode=i.parentNode.id,n=t.isNullOrUndefined(i.parentNode.id)?i.parentNode.concat(i.childNodes):this._getParentsTreeList(a,i.parentNode.id,a._editorTreeData).concat(t.DataManager(o).executeLocal(t.Query().where("pid","notequal",l).page(a._memberDrillPageSettings.currentMemberDrillPage,r))),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(n,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):t.Pivot._createSearchTreeview(n,a),a._waitingPopup.hide()},_refreshDrillEditorPager:function(t,i,l){i.element.find(".e-memberPager,.e-memberSearchPager").css("display","none"),i.element.find(".e-memberDrillPager").css("display","block");var a=t.childNodes.length/l;a!=Math.round(a)&&(a=parseInt(a)+1),i._memberDrillPageSettings.currentMemberDrillPage==a&&i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").addClass("disabled"),i.element.find(".e-memberDrillPageCount").html("/ "+a),i.element.find(".e-memberCurrentDrillPage").val(i._memberDrillPageSettings.currentMemberDrillPage),i._memberDrillPageSettings.currentMemberDrillPage>1?i.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):i.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),i._memberDrillPageSettings.currentMemberDrillPage==parseInt(e.trim(i.element.find(".e-memberDrillPageCount").text().split("/")[1]))?i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),t.childNodes=t.childNodes.slice((i._memberDrillPageSettings.currentMemberDrillPage-1)*l,i._memberDrillPageSettings.currentMemberDrillPage*l)},_getParentsTreeList:function(e,i,l){var a,r=[];do{parentNodes=t.DataManager(l).executeLocal(t.Query().where("id","equal",i)),a=!t.isNullOrUndefined(parentNodes)&&parentNodes.length>0&&!t.isNullOrUndefined(parentNodes[0].pid),r.push(new t.Predicate("id","equal",i)),i=a?parentNodes[0].pid:null}while(!t.isNullOrUndefined(i));return t.DataManager(l).executeLocal(t.Query().where(t.Predicate.or(r)))},_onNodeCollapse:function(i){var a,r=t.isNullOrUndefined(i.olapCtrlObj)?this:i.olapCtrlObj,o=!1,n={memberEditorPageSize:"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl.model.memberEditorPageSize:r.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl.model.enableMemberEditorPaging:r.model.enableMemberEditorPaging};if(jQuery.each(r._editorTreeData,function(e,l){l.id==i.id?(t.isNullOrUndefined(l.pid)||(i.parentId=l.pid),l.expanded=!1):l.pid==i.id&&(t.isNullOrUndefined(r._editorDrillTreeData[l.id])||(o=!0))}),n.enableMemberEditorPaging&&(o||!t.isNullOrUndefined(r._editorDrillTreeData[i.id])||""==i.parentId)){r.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),r._lastSavedTree=[],r._isEditorDrillPaging=!1,r.element.find(".e-memberPager").length>0?(r.element.find(".e-memberPager").css("display","block"),r.element.find(".e-memberDrillPager,.e-memberSearchPager").css("display","none")):r.element.find(".e-memberDrillPager, .e-memberSearchPager").css("display","none");var s=[],d=i.parentId,h=!1,u=!1,c="";if(!t.isNullOrUndefined(d)&&""!=d){do{parentNodes=t.DataManager(r._editorTreeData).executeLocal(t.Query().where("id","equal",d)),h=!!(h||n.memberEditorPageSize<=t.DataManager(r._editorTreeData).executeLocal(t.Query().where("pid","equal",d)).length),s.push(new t.Predicate(h?"id":"pid","equal",d)),!u&&h&&n.memberEditorPageSize<t.DataManager(r._editorTreeData).executeLocal(t.Query().where("pid","equal",d)).length&&(u=!0,c=d),d=parentNodes[0].pid}while(!t.isNullOrUndefined(d));h?s.push(new t.Predicate("id","equal",i.parentId)):s.push(new t.Predicate("pid","equal",l))}h?(t.Pivot._makeAncestorsExpandable(r,i.parentId),r._isEditorCollapseDrillPaging=!0,(a={drillPageSettings:t.isNullOrUndefined(r._editorDrillTreePageSettings[c])&&"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl._editorDrillTreePageSettings[c]:r._editorDrillTreePageSettings[c],parentNode:t.DataManager(e.extend(!0,[],r._editorTreeData)).executeLocal(t.Query().where(t.Predicate.or(s))),childNodes:t.DataManager(e.extend(!0,[],r._editorTreeData)).executeLocal(t.Query().where("pid","equal",c))}).parentNode=e.grep(a.parentNode,function(t){var i=!1;return e.each(a.childNodes,function(e,l){l.id==t.id&&(l.expanded=!0,i=!0)}),!i}),t.Pivot._drillEditorTreeNode(a,r,n.memberEditorPageSize)):(r.model.enableMemberEditorSorting&&(r._editorTreeData=t.DataManager(r._editorTreeData).executeLocal(t.Query().sortBy("name",r._sortType))),0==s.length&&s.push(new t.Predicate("pid","equal",l)),r.element.find(".e-memberPager").length>0?"ejPivotClient"!=r.pluginName?t.Pivot._createSearchTreeview(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(s)).page(r._memberPageSettings.currentMemeberPage,n.memberEditorPageSize)),r):r._appendTreeViewData(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(s)).page(r._memberPageSettings.currentMemeberPage,n.memberEditorPageSize)),r.element.find(".pvtBtn").parent("[data-tag='Slicers:"+r._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):"ejPivotClient"!=r.pluginName?t.Pivot._createSearchTreeview(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(s))),r):r._appendTreeViewData(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(s))),r.element.find(".pvtBtn").parent("[data-tag='Slicers:"+r._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0))}},_searchEditorTreeNodes:function(i,a){if(t.isNullOrUndefined(window.event)?0!=i.which&&13!=i.which:0!=window.event.which&&13!=window.event.which){t.isNullOrUndefined(a._waitingPopup.element)||a._waitingPopup.show();var r=this;setTimeout(function(){var i,o,n,s,d,h={memberEditorPageSize:"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableMemberEditorPaging:a.model.enableMemberEditorPaging},u="";if("ejPivotClient"!=a.pluginName||t.isNullOrUndefined(a._pivotSchemaDesigner)){if(t.isNullOrUndefined(a.element.find(".searchEditorTreeView"))||0==a.element.find(".searchEditorTreeView").length)return!1;u=t.isNullOrUndefined(e.trim(a.element.find(".searchEditorTreeView").val()))?"":e.trim(a.element.find(".searchEditorTreeView").val()).toLowerCase()}else{if(t.isNullOrUndefined(a._pivotSchemaDesigner.element.find(".searchEditorTreeView"))||0==a._pivotSchemaDesigner.element.find(".searchEditorTreeView").length)return!1;u=t.isNullOrUndefined(e.trim(a._pivotSchemaDesigner.element.find(".searchEditorTreeView").val()))?"":e.trim(a._pivotSchemaDesigner.element.find(".searchEditorTreeView").val()).toLowerCase()}if(""!=u){var c=jQuery.extend(!0,[],t.DataManager(a._editorTreeData).executeLocal(t.Query().where("name","contains",u,!0).sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType))),p=e.extend(!0,[],c.slice(0,h.memberEditorPageSize+1)),m=h.enableMemberEditorPaging?p:c;for(i=0;i<m.length;i++)t.isNullOrUndefined(m[i].pid)||(m[i].parentId=m[i].pid);for(i=0;i<m.length;i++)r._appendParentNodes(m,m[i],a);a._isSearchApplied=!0,c.length>0?(a._isSelectSearchFilter=a.model.enableCheckStateOnSearch,h.enableMemberEditorPaging&&(a.element.find(".e-memberSearchPager").find(".e-nextPageDiv").length>0||a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0)&&(a._memberSearchPageSettings.currentMemberSearchPage=1,a._memberSearchPageSettings.startSearchPage=0,a._memberSearchPageSettings.endSearchPage=0,a.element.find(".e-memberPager,.e-memberDrillPager").css("display","none"),a._editorSearchTreeData=c.slice(),(o=t.DataManager(c).executeLocal(t.Query().where(t.Predicate("id","notequal","(All)_0").and("id","notequal","All"))).length/h.memberEditorPageSize)!=Math.round(o)&&(o=parseInt(o)+1),o>1&&a.element.find(".e-memberSearchPager").css("display","block"),a._memberSearchPageSettings.currentMemberSearchPage==o&&a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").addClass("disabled"),a.element.find(".e-memberSearchPageCount").html("/ "+o),a.element.find(".e-memberCurrentSearchPage").val(a._memberSearchPageSettings.currentMemberSearchPage),a._memberSearchPageSettings.currentMemberSearchPage>1?a.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberSearchPageSettings.currentMemberSearchPage==parseInt(e.trim(a.element.find(".e-memberSearchPageCount").text().split("/")[1]))?a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"))):(a.element.find(".e-memberPager,.e-memberSearchPager,.e-memberDrillPager").css("display","none"),a.element.find(".e-dialogFooter").css("margin-top","5px")),m.length>0&&("All"==m[0].id&&m.splice(0,1),m.splice(0,0,{id:"SearchFilterSelection",name:a._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:a._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"})),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(m,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):r._createSearchTreeview(m,a)}else a._isSearchApplied=!1,a._isSelectSearchFilter=a.model.enableCheckStateOnSearch,n=!t.isNullOrUndefined(a._lastSavedTree)&&e.grep(a._lastSavedTree,function(e){return e.pid}).length>0,h.enableMemberEditorPaging&&a.element.find(".e-memberSearchPager").find(".e-nextPageDiv").length>0&&(a._editorSearchTreeData=[],""!=a.element.find(".e-memberPageCount").text()&&a.element.find(".e-memberPager").css("display","block"),a.element.find(".e-memberSearchPager").css("display","none")),n&&""!=a.element.find(".e-memberDrillPageCount").text()&&(a.element.find(".e-memberDrillPager").css("display","block"),a.element.find(".e-memberPager").css("display","none")),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(h.enableMemberEditorPaging?n?t.DataManager(a._lastSavedTree).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(a._memberPageSettings.currentMemeberPage,h.memberEditorPageSize).sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):a._editorTreeData,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):r._createSearchTreeview(h.enableMemberEditorPaging?n?t.DataManager(a._lastSavedTree).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):t.DataManager(a._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0")).page(a._memberPageSettings.currentMemeberPage,h.memberEditorPageSize).sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):a._editorTreeData,a);s={id:"SearchFilterSelection",type:a._isSelectSearchFilter?"nodeCheck":"nodeUncheck"},d=a.element.find(".e-editorTreeView"),t.Pivot._updateSearchFilterSelection(s,d,a),a._waitingPopup.hide(),a._parentNodeCollection={},a._parentSearchNodeCollection={}},0)}},_createSearchTreeview:function(i,l){"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging;var a,r,o="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableAdvancedFilter:l.model.enableAdvancedFilter,n="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorSorting:l.model.enableMemberEditorSorting,s=l.element.find(".e-pvtBtn").parent("[data-tag='Slicers:"+(l._selectedFieldName||l._dialogHead)+"']").length>0,d=("ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.analysisMode:l.model.analysisMode,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.operationalMode:l.model.operationalMode);for(!l._isSearchApplied&&0==l._editorSearchTreeData.length&&i.length>0&&(l._lastSavedTree=i),i.length>0&&(i=t.DataManager(i).executeLocal(t.Query().where(t.Predicate("id","notequal","All").and("id","notequal","(All)_0")))).splice(0,0,{id:"All",name:o&&!s?"(Select All)":d==t.Pivot.OperationalMode.ServerMode?"(All)":"All",checkedStatus:l._isAllMemberChecked,_isAllMemberChecked:l._isAllMemberChecked}),l.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:l.model.enableRTL,beforeDelete:function(e){if(!t.isNullOrUndefined(e.event)&&"keydown"==e.event.type&&"delete"==e.event.originalEvent.key.toLowerCase())return!1},height:n?"200px":"245px",fields:{id:"id",text:"name",isChecked:"checkedStatus",parentId:"pid",expanded:"expanded",hasChild:"hasChildren",dataSource:t.Pivot._showEditorLinkPanel(i,l,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl:l)}}),a=l.element.find(".e-editorTreeView").find("li"),r=0;r<a.length;r++)t.isNullOrUndefined(e(a[r]).attr("id"))||e(a[r]).attr("data-tag",t.DataManager(i).executeLocal(t.Query().where("id","equal",e(a[r]).attr("id")))[0].tag);l._memberTreeObj=l.element.find(".e-editorTreeView").data("ejTreeView"),l._memberTreeObj.model.nodeCheck=t.proxy(l._nodeCheckChanges,l),l._memberTreeObj.model.nodeUncheck=t.proxy(l._nodeCheckChanges,l),"ejPivotGrid"==l.pluginName?l.model.operationalMode==t.Pivot.OperationalMode.ClientMode?l._memberTreeObj.model.beforeExpand=t.proxy(l._beforeNodeExpand,l):l._memberTreeObj.model.nodeClick=t.proxy(l._nodeExpand,l):(l.model.pivotControl.model.operationalMode==t.Pivot.OperationalMode.ClientMode?l._memberTreeObj.model.beforeExpand=t.proxy(l._beforeNodeExpand,l):l._memberTreeObj.model.nodeClick=t.proxy(l._nodeExpand,l),l._memberTreeObj.model.beforeCollapse=t.proxy(t.Pivot._onNodeCollapse,l)),t.isNullOrUndefined(l.element.find(".e-dialog .e-text:visible").first())||(l.element.find(".e-dialog .e-text:visible").length>0?(l.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").addClass("e-hoverCell"),l.element.find(".e-dialog button").removeClass("e-hoverCell")):l.element.find(".e-dialog button:visible").first().attr("tabindex","-1").addClass("e-hoverCell")),0==l._memberTreeObj.element.find(".e-plus").length&&0==l._memberTreeObj.element.find(".e-minus").length&&l._memberTreeObj.element.find(".e-item").css("padding","0px"),l.model.enableMemberEditorSorting&&this._separateAllMember(l)},_separateAllMember:function(e){var i=e.element.hasClass("e-pivotclient")&&"servermode"==e.model.operationalMode&&"olap"==e.model.analysisMode,l="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.enableAdvancedFilter:e.model.enableAdvancedFilter,a="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.enableRTL:e.model.enableRTL,r="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.analysisMode:e.model.analysisMode,o=i?"":t.buildTag("div.e-checkAllBox",t.buildTag("input#allElement.allMember","",{float:a?"right":"left"},{name:"row",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.e-allElementLabel",l?"(Select All)":"All",{"margin-left":"5px"})[0].outerHTML,{width:"100px",float:a?"right":"left"})[0].outerHTML,n=t.buildTag("div.memberSortDiv",t.buildTag("div.e-icon e-memberAscendingIcon",{margin:"5px"})[0].outerHTML+t.buildTag("div.e-icon e-memberDescendingIcon")[0].outerHTML,{height:"35px","margin-left":"5px",float:a?"left":"right"})[0].outerHTML,s=t.buildTag("div.memberSortingDiv",o+n,{height:"20px",margin:"ejPivotSchemaDesigner"==e.pluginName?a?r==t.Pivot.AnalysisMode.Pivot?"10px 15px 0px 21px":"10px 31px 0px 12px":r==t.Pivot.AnalysisMode.Pivot?"10px 0px 0px 8px":"10px 0px 0px 20px":a?r==t.Pivot.AnalysisMode.Pivot?"10px 15px 0px 20px":"10px 28px 0px 20px":r==t.Pivot.AnalysisMode.Pivot?"10px 0px 0px 20px":"10px 0px 0px 29px"});l&&e.element.find(".e-editorTreeView").css("margin-top","10px"),e.element.find(".memberSortingDiv, .e-separateDiv").remove(),r==t.Pivot.AnalysisMode.Pivot&&e.element.find(".e-editorTreeView").addClass("e-treeViewUl"),i||e.element.find(".e-editorTreeView").before(s),("All"==e.element.find(".e-editorTreeView li:first").attr("id")||"(All)_0"==e.element.find(".e-editorTreeView li:first").attr("id"))&&e.element.find(".e-editorTreeView li:first").css("display","none"),i?(e.element.find(".memberSortDiv, .e-separateDiv").remove(),e.element.find(".e-checkOptions").after(t.buildTag("div.e-separateDiv",{margin:"0px 5px"})[0].outerHTML),e.element.find(".e-checkOptions").append(n),l&&e.element.find(".e-editorTreeView").height(235)):(e.element.find(".memberSortingDiv").after(t.buildTag("div.e-separateDiv",{})[0].outerHTML),e.element.find(".allMember").ejCheckBox({size:"small",width:"40px",checked:"disabled"!=e.element.find(".e-dialogOKBtn").attr("disabled"),change:t.proxy(e._nodeCheckChanges,e)})),"ascending"==e._sortType?e.element.find(".e-memberAscendingIcon").addClass("e-selectedSort"):"descending"==e._sortType&&e.element.find(".e-memberDescendingIcon").addClass("e-selectedSort")},_checkChanges:function(e){var t="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this;e.isChecked?t._nodeCheckChanges(e):e.isChecked||t._nodeUnCheckChanges(e)},_fetchMemberPageSuccess:function(i){var a,r="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this;i[0]!=l&&i.length>0?(a=i[0].Value,null!=i[1]&&i[1]!=l&&(this.model.customObject=i[1].Value)):i.d!=l&&i.d.length>0?(a=i.d[0].Value,null!=i.d[1]&&i.d[1]!=l&&(this.model.customObject=i.d[1].Value)):i!=l&&i.length>0?(a=i.EditorTreeInfo,null!=i&&i.customObject!=l&&(this.model.customObject=i.customObject)):i!=l&&(a=i.EditorTreeInfo,null!=i&&i.customObject!=l&&(this.model.customObject=i.customObject)),this._memberPageSettings.endPage="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl.model.memberEditorPageSize:this.model.memberEditorPageSize,this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1,filteredData=JSON.parse(a),this._editorTreeData=e.extend(!0,[],filteredData),r.model.enableAdvancedFilter&&(this._editorTreeData=e.map(this._editorTreeData,function(e){if(t.isNullOrUndefined(e.levels))return e})),("ejPivotSchemaDesigner"==this.pluginName&&this.model.pivotControl&&this.model.pivotControl.model.enableAdvancedFilter&&this.model.pivotControl.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.pivotControl.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||"ejPivotGrid"==this.pluginName&&this.model.enableAdvancedFilter&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this._memberPagingAvdData=filteredData.splice(filteredData.length-1,1)),this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0"))).length,filteredData=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(this._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl.model.memberEditorPageSize+1:this.model.memberEditorPageSize+1)),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(filteredData)})},_memberPageNodeUncheck:function(i,l){var a,r="",o=null,n="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging;e(i.currentElement).parent().parent().hasClass("e-editorTreeView")&&!l._isSearchApplied&&n?(r=t.DataManager(l._editorTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(o=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0])):(r=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(o=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0])),t.isNullOrUndefined(r)||(r.checkedStatus=!1,t.isNullOrUndefined(r.pid)||(a=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",r.pid).where("checkedStatus","equal",!0)),t.isNullOrUndefined(a)||0!=a.length||t.Pivot._unSelectParentTreeNode(r,l)),a=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",r.id)),!t.isNullOrUndefined(a)&&a.length>0&&t.Pivot._unSelectChildTreeNode(r,l)),t.isNullOrUndefined(o)||(o.checkedStatus=!1,t.isNullOrUndefined(o.pid)||(a=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",o.pid).where("checkedStatus","equal",!0)),t.isNullOrUndefined(a)||0!=a.length||t.Pivot._unSelectParentTreeNode(o,l)),a=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",r.id)),!t.isNullOrUndefined(a)&&a.length>0&&t.Pivot._unSelectChildTreeNode(o,l))},_memberPageNodeCheck:function(i,l){var a,r,o="",n=null,s="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging;if(e(i.currentElement).parent().parent().hasClass("e-editorTreeView")&&!l._isSearchApplied&&s?(o=t.DataManager(l._editorTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(n=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0])):(o=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(n=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0])),!t.isNullOrUndefined(o)&&(o.checkedStatus=!0,t.isNullOrUndefined(o.pid)||t.Pivot._selectParentTreeNode(o,l),!t.isNullOrUndefined(o.id)&&(a=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",o.id)),!t.isNullOrUndefined(a)&&a.length>0)))for(r=0;r<a.length;r++)a[r].checkedStatus=!0,(a[r].expanded||a[r].isChildMerged)&&t.Pivot._selectChildTreeNode(a[r],l);if(!t.isNullOrUndefined(n)&&(n.checkedStatus=!0,t.isNullOrUndefined(n.pid)||t.Pivot._selectParentTreeNode(n,l),!t.isNullOrUndefined(n.id)&&(a=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",n.id)),!t.isNullOrUndefined(a)&&a.length>0)))for(r=0;r<a.length;r++)a[r].checkedStatus=!0,t.Pivot._selectChildTreeNode(a[r],l)},_appendParentNodes:function(e,i,l){var a,r;t.isNullOrUndefined(i.pid)||(t.isNullOrUndefined(l._parentNodeCollection[i.pid])?(a=jQuery.extend(!0,[],t.DataManager(l._editorTreeData).executeLocal(t.Query().where("id","equal",i.pid))),l._parentNodeCollection[i.pid]=a):a=l._parentNodeCollection[i.pid],!t.isNullOrUndefined(a)&&a.length>0&&(t.isNullOrUndefined(l._parentSearchNodeCollection[a[0].id])?(r=jQuery.extend(!0,[],t.DataManager(e).executeLocal(t.Query().where("id","equal",a[0].id))),l._parentSearchNodeCollection[a[0].id]=a):r=l._parentSearchNodeCollection[a[0].id]),t.isNullOrUndefined(r)||(0==r.length?(a[0].expanded=!0,e.push(a[0]),t.isNullOrUndefined(a[0].pid)||this._appendParentNodes(e,a[0],l)):r[0].expanded=!0))},_selectParentTreeNode:function(e,i){var l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("id","equal",e.pid));!t.isNullOrUndefined(l)&&l.length>0&&(l[0].checkedStatus=!0,this._selectParentTreeNode(l[0],i))},_selectChildTreeNode:function(e,i){var l,a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id));if(!t.isNullOrUndefined(a)&&a.length>0)for(l=0;l<a.length;l++)a[l].checkedStatus=!0,(a[l].expanded||a[l].isChildMerged)&&this._selectChildTreeNode(a[l],i)},_unSelectChildTreeNode:function(e,i){var l,a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id));if(!t.isNullOrUndefined(a)&&a.length>0)for(l=0;l<a.length;l++)a[l].checkedStatus=!1,(a[l].expanded||a[l].isChildMerged)&&this._unSelectChildTreeNode(a[l],i)},_unSelectParentTreeNode:function(e,i){var l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("id","equal",e.pid));!t.isNullOrUndefined(l)&&l.length>0&&(l[0].checkedStatus=!1,0==t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",l[0].pid).where("checkedStatus","equal",!0)).length&&this._unSelectParentTreeNode(l[0],i))},_getSelectedTreeState:function(e,i){var a,r,o,n,s,d;if(e){for(s=[],a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",l)),d=0;d<a.length;d++){if(r=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",a[d].id)),o={caption:a[d].name,parentId:t.isNullOrUndefined(a[d].pid)?"None":a[d].pid,id:a[d].id,checked:a[d].checkedStatus,expanded:r.length>0,childNodes:[],tag:a[d].tag},r.length>0)for(n=0;n<r.length;n++)o.childNodes.push(this._getEditorSlicerInfo(r[n],i));s.push(o)}return JSON.stringify(s)}for(s="",d=0;d<i._editorTreeData.length;d++)1==i._editorTreeData[d].checkedStatus&&(s+="::"+i._editorTreeData[d].id+"||"+i._editorTreeData[d].tag);return s},_getUnSelectedTreeState:function(e){for(var t="",i=0;i<e._editorTreeData.length;i++)0==e._editorTreeData[i].checkedStatus&&(t+="::"+e._editorTreeData[i].id+"||"+e._editorTreeData[i].tag);return t},_getEditorSlicerInfo:function(e,i){var l,a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id)),r={caption:e.name,parentId:t.isNullOrUndefined(e.pid)?"None":e.pid,id:e.id,checked:e.checkedStatus,expanded:a.length>0,childNodes:[],tag:e.tag};if(a.length>0)for(l=0;l<a.length;l++)r.childNodes.push(this._getEditorSlicerInfo(a[l],i));return r},_editorLinkPanelClick:function(){this.element.find(".e-dialog").hide(),t.Pivot._createErrorDialog(this._getLocalizedLabels("EditorLinkPanelAlert").split("1000").join(this.model.maxNodeLimitInMemberEditor),this._getLocalizedLabels("Warning"),this)},_showEditorLinkPanel:function(i,l,a){var r,o;if(!a.model.enableMemberEditorPaging&&(a.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||l._isSearchApplied||(l._editorTreeData=i),i.length>a.model.maxNodeLimitInMemberEditor+(l._isSearchApplied?1:0))){var n=[],s={},d={},h=!1;for(r=0;r<i.length;r++)t.isNullOrUndefined(s[i[r].pid])?(t.isNullOrUndefined(i[r].pid)||(o=e.grep(i,function(e){if(e.id==i[r].pid)return e})).length>0&&(d[i[r].pid]=!!o[0].expanded),s[i[r].pid]=1):s[i[r].pid]++,s[i[r].pid]<=a.model.maxNodeLimitInMemberEditor+(l._isSearchApplied&&t.isNullOrUndefined(i[r].pid)?1:0)?n.push(i[r]):(t.isNullOrUndefined(d[i[r].pid])||d[i[r].pid])&&(h=!0);i=n,h&&l.element.find("div.e-linkOuterPanel").css("display","block")}return i},createErrorDialog:function(i){var l,a;t.Pivot.openPreventPanel(i),0==i.element.find(".e-errorDialog").length?(a=t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent",i._getLocalizedLabels("AlertMsg"))[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn","OK")[0].outerHTML)[0].outerHTML).attr("title",i._getLocalizedLabels("Warning"))[0].outerHTML,i.element.append(a),i.element.find(".e-errorDialog").ejDialog({target:"#"+i._id,enableResize:!1,enableRTL:i.model.enableRTL,width:"400px"}),l=i.element.find(".e-errorDialog").data("ejDialog"),e("#"+l._id+"_wrapper").css({left:"50%",top:"50%"}),i.element.find(".errOKBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(t.Pivot.errOKBtnClick,i)}),i.element.find(".e-dialog .e-close").attr("title",i._getLocalizedLabels("Close"))):(l=i.element.find(".e-errorDialog").data("ejDialog")).open()},errOKBtnClick:function(){this.element.find("#preventDiv").remove(),this.element.find(".e-errorDialog").data("ejDialog")._ejDialog.find("div.e-dialog-icon").trigger("click")},doAjaxPost:function(i,a,r,o,n,s){var d,h,u,c=!0;r.XMLA==l?(d="application/json; charset=utf-8",h="json",u=e.proxy(o,this)):(d="text/xml",h="xml",r=r.XMLA,u=e.proxy(o,t.olap.base,s),c=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)&&(!t.isNullOrUndefined(s)&&"loadFieldElements"!=s.action)),e.ajax({type:i,url:a,contentType:d,async:c,dataType:h,data:r,success:u,complete:t.proxy(function(t){e.proxy(t,this);this._currentAction,this.element},this),error:t.proxy(function(e){void 0!==this._ogridWaitingPopup&&null!=this._ogridWaitingPopup&&this._ogridWaitingPopup.hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide();var t={action:""!=this._drillAction?this._drillAction:"initialize",customObject:"",element:this.element,Message:e};this._trigger("renderFailure",t),this.renderControlFromJSON(""),"XMLA"==this._dataModel&&this._createErrorDialog(e.statusText,this._getLocalizedLabels("Error")),e.statusText},this)})},getCubeList:function(t,i){for(var l,a=[],r=0;r<e(i).find("row").length;r++)l=e(e(i).find("row")[r]),a.push({name:e(l).children("CUBE_NAME").text()});t.pvtCtrldObj.setCubeList(a)},generateTreeViewData:function(e){var t={catalog:e.model.pivotControl.model.dataSource.catalog,cube:e.model.pivotControl.model.dataSource.cube,url:e.model.pivotControl.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(t,this.loadDimensionElements,{schemaData:e,action:"loadFieldElements"})},loadDimensionElements:function(i,a){var r,o=i.schemaData.model.pivotControl,n={},s=(t.olap.base._getConnectionInfo(o.model.dataSource.data),{}),d=o.model.dataSource.providerName==t.olap.Providers.Mondrian;for(s={catalog:o.model.dataSource.catalog,cube:o.model.dataSource.cube,url:o.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},o.schemaTreeView=[],o.reportItemNames=[],r=0;r<e(a).find("row").length;r++){var h=e(e(a).find("row")[r]),u=h.find("DIMENSION_UNIQUE_NAME").text(),c=h.find("DIMENSION_CAPTION").text();u.toLowerCase().indexOf("[measure")>=0?n={hasChildren:!0,isSelected:!1,id:u,name:c,spriteCssClass:"[measures]"==u.toLowerCase()?"e-folderCDB e-icon":"e-dimensionCDB e-icon",tag:u}:!e(e(a).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&o.schemaTreeView.push({hasChildren:!0,isSelected:!1,id:d?u+"~#^Dim":u,name:c,spriteCssClass:"e-dimensionCDB e-icon",tag:u,defaultHierarchy:e(e(a).find("row")[r]).children("DEFAULT_HIERARCHY").text()})}o.schemaTreeView.splice(0,0,n),!o.model.enableDrillThrough||i.schemaData!=l&&i.schemaData.model.olap.showNamedSets?(s.request="MDSCHEMA_SETS",t.Pivot._getTreeData(s,t.Pivot.loadNamedSetElements,i)):(s.request="MDSCHEMA_HIERARCHIES",(t.isNullOrUndefined(o._fieldData)||!t.isNullOrUndefined(o._fieldData)&&t.isNullOrUndefined(o._fieldData.hierarchy))&&this._getFieldItemsInfo(o),o._fieldData.hierarchySuccess==l?t.Pivot._getTreeData(s,o.loadHierarchyElements,i):t.Pivot.loadHierarchyElements(i,o._fieldData.hierarchySuccess))},loadNamedSetElements:function(i,a){var r,o,n,s=i.schemaData.model.pivotControl,d={catalog:s.model.dataSource.catalog,cube:s.model.dataSource.cube,url:s.model.dataSource.data,request:"MDSCHEMA_HIERARCHIES"},h=(a=s.model.dataSource,[]);for(r=e.map(a.rows,function(e){if(e.fieldName!=l)return e.fieldName}),e.merge(r,e.map(a.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(r,e.map(a.filters,function(e){if(e.fieldName!=l)return e.fieldName})),o=0;o<e(a).find("row").length;o++)n=e(e(a).find("row")[o]),e.inArray(n.find("DIMENSIONS").text().split(".")[0],h)>=0||(s.schemaTreeView.push({hasChildren:!0,isSelected:!1,pid:n.find("DIMENSIONS").text().split(".")[0],id:n.find("SET_DISPLAY_FOLDER").text()+"_"+n.find("DIMENSIONS").text().split(".")[0],name:n.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"e-folderCDB e-icon namedSets"}),h.push(n.find("DIMENSIONS").text().split(".")[0])),s.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray("["+e.trim(n.children("SET_NAME").text())+"]",r)>=0,pid:n.find("SET_DISPLAY_FOLDER").text()+"_"+n.find("DIMENSIONS").text().split(".")[0],id:"["+e.trim(n.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:n.children("SET_CAPTION").text(),spriteCssClass:"e-namedSetCDB e-icon",tag:n.find("EXPRESSION").text()});t.isNullOrUndefined(s._fieldData)||s._fieldData.hierarchySuccess==l?t.Pivot._getTreeData(d,t.Pivot.loadHierarchyElements,i):t.Pivot.loadHierarchyElements(i,s._fieldData.hierarchySuccess)},loadHierarchyElements:function(i,a){var r,o,n=i.schemaData.model.pivotControl,s={catalog:n.model.dataSource.catalog,cube:n.model.dataSource.cube,url:n.model.dataSource.data,request:"MDSCHEMA_LEVELS"},d=n.model.dataSource,h=n.model.dataSource.providerName==t.olap.Providers.Mondrian;for(r=e.map(d.rows,function(e){if(e.fieldName!=l)return e.fieldName}),e.merge(r,e.map(d.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(r,e.map(d.filters,function(e){if(e.fieldName!=l)return e.fieldName})),o=0;o<e(a).find("row").length;o++){var u=e(e(a).find("row")[o]),c=u.find("DIMENSION_UNIQUE_NAME").text(),p=u.find("HIERARCHY_UNIQUE_NAME").text();e(n.schemaTreeView).filter(function(e,t){return t.tag==c}).map(function(e,t){return t}).length>0&&(c!=p||h)&&n.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray(p,r)>=0,pid:c+(h?"~#^Dim":""),id:p,name:u.find("HIERARCHY_CAPTION").text(),spriteCssClass:"2"!=u.find("HIERARCHY_ORIGIN").text()&&"6"!=u.find("HIERARCHY_ORIGIN").text()?"e-hierarchyCDB e-icon":"e-attributeCDB e-icon",tag:p})}t.Pivot._getTreeData(s,t.Pivot.loadLevelElements,i)},loadLevelElements:function(i,l){var a,r=i.schemaData.model.pivotControl,o=e.map(e(l).find("row"),function(t){if("1"!=parseInt(e(t).children("LEVEL_TYPE").text())&&"[measures]"!=e(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase())return{hasChildren:!1,isChecked:!1,id:e(t).find("LEVEL_UNIQUE_NAME").text(),pid:e(t).find("HIERARCHY_UNIQUE_NAME").text(),name:e(t).find("LEVEL_CAPTION").text(),tag:e(t).find("LEVEL_UNIQUE_NAME").text(),spriteCssClass:"e-level"+parseInt(e(t).children("LEVEL_NUMBER").text())+" e-icon"}});e.merge(r.schemaTreeView,o),(!r.model.enableDrillThrough||r._fieldData.measureSuccess)&&(t.isNullOrUndefined(r._fieldData)||!r._fieldData.measureSuccess?(a={catalog:r.model.dataSource.catalog,cube:r.model.dataSource.cube,url:r.model.dataSource.data,request:"MDSCHEMA_MEASURES"},t.Pivot._getTreeData(a,t.Pivot.loadMeasureElements,i)):t.Pivot.loadMeasureElements(i,r._fieldData.measureSuccess))},loadMeasureGroups:function(i,l){t.isNullOrUndefined(i.pivotControl._fieldData)&&(i.pivotControl._fieldData={}),i.pivotControl._fieldData.measuresGroups=e(l).find("row")},loadMeasureElements:function(i,a){var r,o,n,s,d=i.schemaData.model.pivotControl,h={catalog:d.model.dataSource.catalog,cube:d.model.dataSource.cube,url:d.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},u=[];r=e.map(d.model.dataSource.values,function(e){if(e.measures!=l)return e.measures}),d.reportItemNames=e.map(r,function(e){if(e.fieldName!=l)return e.fieldName}),"en-US"!=d.model.locale&&(h={catalog:d.model.dataSource.catalog,cube:d.model.dataSource.cube,url:d.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.Pivot._getTreeData(h,t.Pivot.loadMeasureGroups,{pivotControl:d,action:"loadFieldElements"}));var c,p,m,g=[],f=[],_=[],v=[],b=[];if("ejPivotClient"==d.pluginName&&(d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Ascending||d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Descending)&&d.model.sortCubeMeasures!=t.PivotAnalysis.SortOrder.None){for(sortType=d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Ascending?"ascending":"descending",n=0;n<e(a).find("row").length;n++)f.push({name:e(a).find("row:eq("+n+") MEASURE_CAPTION").text()});for(p=t.DataManager(f).executeLocal(t.Query().sortBy("name",sortType)),e.each(p,function(t,i){for(var l=0;l<e(a).find("row").length;l++)i.name==e(a).find("row:eq("+l+") MEASURE_CAPTION").text()&&_.push(e(a).find("row:eq("+l+")"))}),n=0;n<_.length;n++)e.inArray(e(_[n]).children("MEASUREGROUP_NAME").text(),g)>=0||(g.push(e(_[n]).children("MEASUREGROUP_NAME").text()),v.push({name:e(_[n]).children("MEASUREGROUP_NAME").text()}));c=t.DataManager(v).executeLocal(t.Query().sortBy("name",sortType)),e.each(c,function(t,i){for(var l=0;l<_.length;l++)i.name==e(_[l]).children("MEASUREGROUP_NAME").text()&&b.push(e(_[l]))}),m=b}else m=e(a).find("row");for(n=0;n<m.length;n++){var C=e(m[n]),S=C.children("MEASUREGROUP_NAME").text(),O=C.find("MEASURE_UNIQUE_NAME").text();e.inArray(S,u)>=0||("en-US"!=d.model.locale?o=(s=e.map(d._fieldData.measuresGroups,function(t){if(e(t).children("MEASUREGROUP_NAME").text()==S)return e(t).children("MEASUREGROUP_CAPTION").text()})).length>0?s[0]:S:o=S,""!=S&&d.schemaTreeView.push({hasChildren:!0,isChecked:!1,pid:"[Measures]",id:S,name:o,spriteCssClass:"e-measureGroupCDB e-icon",tag:S}),u.push(S)),d.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray(O,d.reportItemNames)>=0,id:O,pid:""==S?"[Measures]":S,name:C.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:O}),e.inArray(O,d.reportItemNames)>=0&&d.reportItemNames.splice(d.reportItemNames.indexOf(O),1)}t.isNullOrUndefined(i.schemaData)||!i.schemaData.model.olap.showKpi&&!d.model.enableKPI?t.isNullOrUndefined(i.schemaData)||i.schemaData._createTreeView(this,d.schemaTreeView):(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"kpiCDB e-folderCDB e-icon",tag:""},d.schemaTreeView.splice(1,0,treeNodeElement),h.request="MDSCHEMA_KPIS",t.Pivot._getTreeData(h,t.Pivot.loadKPIElements,i))},loadKPIElements:function(t,i){for(var l=t.schemaData.model.pivotControl,a=this.reportItemNames,r=[],o=0;o<e(i).find("row").length;o++){var n=e(e(i).find("row")[o]),s=n.children("KPI_CAPTION").text(),d=n.children("KPI_goal").text(),h=n.children("KPI_STATUS").text(),u=n.children("KPI_TREND").text(),c=n.find("KPI_VALUE").text();e.inArray(n.children("KPI_NAME").text(),r)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:s,name:s,spriteCssClass:"e-measureGroupCDB e-icon",tag:s},l.schemaTreeView.push(treeNodeElement),r.push(s)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(d,a)>=0,id:d,pid:s,name:l.model.enableKPI?"Goal":l._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:d},l.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(h,a)>=0,id:h,pid:s,name:l.model.enableKPI?"Status":l._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:h},l.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(u,a)>=0,id:u,pid:s,name:l.model.enableKPI?"Trend":l._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:u},l.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(c,a)>=0,id:c,pid:s,name:l.model.enableKPI?"Value":l._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:c},l.schemaTreeView.push(treeNodeElement)}t.schemaData._createTreeView(this,l.schemaTreeView),delete l.reportItemNames,delete l.schemaTreeView},_createCalcMemberDialog:function(i,a){var r,o,n,s,d,h,u,c;a=t.isNullOrUndefined(a.model)?this:a;r=i.length>1&&i[0]!=l?JSON.parse(i[0].Value):i.d!=l?JSON.parse(i.d[0].Value):JSON.parse(i.CubeTreeInfo),null!=a.model.afterServiceInvoke&&a._trigger("afterServiceInvoke",{action:"fetchCalcMemberTreeView",element:a.element,customObject:a.model.customObject}),t.Pivot.openPreventPanel(a),a.element.find(".e-calcMemberDialog",".e-clientDialog",".e-dialog").remove();var p=t.buildTag("div.e-cubeBrowserCalcMember",t.buildTag("div#"+a._id+"_cubeTreeViewCalcMember.e-cubeTreeViewCalcMember")[0].outerHTML,{})[0].outerHTML,m=t.buildTag("label.lblCaption",a._getLocalizedLabels("Caption"),{})[0].outerHTML+t.buildTag("input#"+a._id+"_captionFieldCM.captionFieldCM","",{}).attr("aria-label",a._getLocalizedLabels("Caption"))[0].outerHTML,g=t.buildTag("label.lblexpression",a._getLocalizedLabels("Expression"),{})[0].outerHTML+t.buildTag("textarea#"+a._id+"_expressionFieldCM.e-textarea e-droppable expressionFieldCM"+(a.model.enableRTL?" e-rtl":""),"",{}).attr("aria-label",a._getLocalizedLabels("Expression"))[0].outerHTML,f=t.buildTag("label.lblmemberType",a._getLocalizedLabels("MemberType"),{})[0].outerHTML+t.buildTag("input#"+a._id+"_memberTypeFieldCM.memberTypeFieldCM","",{}).attr("aria-label",a._getLocalizedLabels("MemberType"))[0].outerHTML+t.buildTag("input#"+a._id+"_dimensionFieldCM.dimensionFieldCM","",{}).attr("aria-label","dimension")[0].outerHTML,_=t.buildTag("label.lblformat",a._getLocalizedLabels("FormatString"),{})[0].outerHTML+t.buildTag("input#"+a._id+"_formatFieldCM.formatFieldCM","",{}).attr("aria-label",a._getLocalizedLabels("FormatString"))[0].outerHTML+t.buildTag("input#"+a._id+"_customFormatFieldCM.customFormatFieldCM","",{}).attr("aria-label","custom format")[0].outerHTML,v=t.buildTag("div.e-calcMemberFieldPanel",m+g+f+_,{})[0].outerHTML,b=t.buildTag("button#"+a._id+"_btnOk.e-btnCalcMemberOk",a._getLocalizedLabels("OK"),{},{name:a._getLocalizedLabels("OK")}).attr("aria-label",a._getLocalizedLabels("OK")).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,C=t.buildTag("button#"+a._id+"_btnCancel.btnCalcMemberCancel",a._getLocalizedLabels("Cancel"),{},{name:a._getLocalizedLabels("Cancel")}).attr("aria-label",a._getLocalizedLabels("Cancel")).attr("title",a._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,S=t.buildTag("div.e-calcMemberFooter",b+C,{})[0].outerHTML;for(a._calcMemberDialog=t.buildTag("div#"+a._id+"_calcMemberDialog",p+v+S,{})[0].outerHTML,e(a._calcMemberDialog).appendTo("#"+a._id),e("#"+a._id+"_calcMemberDialog").ejDialog({width:"auto",title:a._getLocalizedLabels("CalculatedMember"),cssClass:a.model.cssClass+" e-calcMemberDialog",enableModal:!1,target:"#"+a._id,enableRTL:a.model.enableRTL,enableResize:!1,close:t.proxy(function(){t.Pivot.closePreventPanel(a)},a),beforeOpen:t.proxy(function(){a.element.find(".e-calcMemberDialog .e-dialog").css("display","block")},a)}),a._calcMemberDialog=a.element.find("#"+a._id+"_calcMemberDialog").data("ejDialog"),e("#"+a._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80px",enableRTL:a.model.enableRTL,click:t.proxy(function(){a._calcMemberDialog.close(),a._selectedCalcMember=null,t.Pivot.closePreventPanel(a)},a)}),e("#"+a._id+"_btnOk").ejButton({type:t.ButtonType.Button,width:"80px",enableRTL:a.model.enableRTL,click:t.proxy(function(){var i,l,r,o,n,s,d;if(""!=e.trim(a.element.find("#"+a._id+"_captionFieldCM").val())&&""!=e.trim(a.element.find("#"+a._id+"_expressionFieldCM").val()))if("Custom"!=a.element.find("#"+a._id+"_formatFieldCM").val()||""!=e.trim(a.element.find("#"+a._id+"_customFormatFieldCM").val())){if(t.isNullOrUndefined(a._selectedCalcMember))for(i=0;i<a._calcMembers.length;i++)if(e.trim(a.element.find("#"+a._id+"_captionFieldCM").val()).toLowerCase()==a._calcMembers[i].name.toLowerCase()){if(!confirm(a._getLocalizedLabels("Confirm")))return;a._selectedCalcMember=e.trim(a.element.find("#"+a._id+"_captionFieldCM").val())}if(a._calcMemberDialog.close(),t.Pivot.closePreventPanel(a),l="",t.isNullOrUndefined(a._selectedCalcMember)||(n=t.DataManager(a._calcMembers).executeLocal(t.Query().where("name","equal",a._selectedCalcMember,!0)),!t.isNullOrUndefined(n)&&n.length>0&&(l=n[0].tag)),a._waitingPopup.show(),r={action:"calculatedMember",olapReport:a.currentReport,clientReports:a.reports,caption:a.currentCubeName+"%"+e.trim(a.element.find("#"+a._id+"_captionFieldCM").val()),expression:e.trim(a.element.find("#"+a._id+"_expressionFieldCM").val()),memberType:a.element.find("#"+a._id+"_memberTypeFieldCM").val(),dimension:a.element.find("#"+a._id+"_dimensionFieldCM").val(),formatString:"Custom"==a.element.find("#"+a._id+"_formatFieldCM").val()?e.trim(a.element.find("#"+a._id+"_customFormatFieldCM").val()):a.element.find("#"+a._id+"_formatFieldCM").val(),uniqueName:l,customObject:a.model.customObject},a.model.operationalMode==t.Pivot.OperationalMode.ServerMode)a.doAjaxPost("POST",a.model.url+"/"+a.model.serviceMethodSettings.calculatedMember,JSON.stringify(r),a._calcMemberDroppedSuccess);else{r.caption=r.caption.replace("%",""),o="",o=r.memberType.toLowerCase().indexOf("measure")>-1?"[Measures].["+e.trim(r.caption)+"]":e(jQuery("[id*='["+r.dimension+"]']")[0]).attr("data-defaulthierarchy")+".["+e.trim(r.caption)+"]",n={caption:r.caption,expression:r.expression,tag:o,hierarchyUniqueName:"["+e.trim(r.dimension)+"].["+e.trim(r.dimension)+"]",memberType:r.memberType,formatString:r.formatString?r.formatString:r.format?r.format:null},-1==r.memberType.toLowerCase().indexOf("measure")&&null!=a._selectedCalcMember&&(t.Pivot.getReportItemByFieldName(this._schemaData._selectedFieldName,this.model.dataSource).item.hierarchyUniqueName=n.hierarchyUniqueName),a._selectedCalcMember=null;var h={id:r.caption,pid:"_0",name:r.caption,hasChildren:!1,spriteCssClass:"e-calcMemberCDB e-icon",tag:o,expression:r.expression,formatString:null,nodeType:0,hierarchyUniqueName:"Measure"==r.memberType?"":n.hierarchyUniqueName},u=!1,c=n.caption;a.model.calculatedMembers=e.grep(a.model.calculatedMembers,function(e){return e.caption==c&&(u=!0,e.caption=n.caption,e.expression=n.expression,e.hierarchyUniqueName=n.hierarchyUniqueName,e.memberType=r.memberType,e.formatString=r.formatString),e}),"_0"!=(s=a.element.find(".e-schemaFieldTree").data("ejTreeView").model.fields).dataSource[0].id&&s.dataSource.splice(0,0,{id:"_0",name:"Calculated Members",hasChildren:!0,spriteCssClass:"e-calcMemberGroupCDB e-icon",tag:""}),u?(d=this._schemaData._selectedFieldName,s.dataSource=e.grep(s.dataSource,function(e){return e.id==d&&(e.expression=n.expression,e.hierarchyUniqueName=n.hierarchyUniqueName,e.expression=n.expression,e.memberType=n.memberType,e.formatString=n.formatString),e})):a.model.calculatedMembers.push(n),u?a.refreshControl():s.dataSource.push(h),t.Pivot._refreshFieldList(a)}}else t.Pivot._createErrorDialog(a._getLocalizedLabels("EmptyFormat"),a._getLocalizedLabels("Warning"),a);else t.Pivot._createErrorDialog(a._getLocalizedLabels("EmptyField"),a._getLocalizedLabels("Warning"),a)},a)}),a.element.find("#"+a._id+"_cubeTreeViewCalcMember").ejTreeView({fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:r},allowDragAndDrop:!0,enableRTL:a.model.enableRTL,allowDropChild:!1,allowDropSibling:!1,dragAndDropAcrossControl:!0,cssClass:"calcMemberTreeViewDragedNode",nodeDropped:t.proxy(function(t){null!=t.target&&t.target.attr("id")==a._id+"_expressionFieldCM"&&a.element.find("#"+a._id+"_expressionFieldCM").val(a.element.find("#"+a._id+"_expressionFieldCM").val()+e(t.droppedElement).attr("data-tag"))},a),beforeExpand:t.proxy(t.Pivot._getMemberChildNodes,a)}),a.element.find("#"+a._id+"_captionFieldCM").ejMaskEdit({name:"inputbox",inputMode:t.InputMode.Text,watermarkText:"",maskFormat:"",textAlign:a.model.enableRTL?"right":"left",width:"100%"}),a.element.find("#"+a._id+"_customFormatFieldCM").ejMaskEdit({name:"inputbox",inputMode:t.InputMode.Text,watermarkText:"",maskFormat:"",textAlign:a.model.enableRTL?"right":"left",width:"100%",cssClass:"e-calcMemberCustomFormat"}),a.element.find(".e-calcMemberCustomFormat").css("visibility","hidden"),a.element.find("#"+a._id+"_memberTypeFieldCM").ejDropDownList({dataSource:[{text:"Measure",value:"Measure"},{text:"Dimension",value:"Dimension"}],enableRTL:a.model.enableRTL,width:"100%",selectedIndex:0,change:t.proxy(function(e){"Dimension"==e.text?a.element.find(".e-calcMemberDimensionField").css("visibility","visible"):a.element.find(".e-calcMemberDimensionField").css("visibility","hidden")},a)}),o=t.DataManager(r).executeLocal(t.Query().where("spriteCssClass","contains","e-dimensionCDB")),n=[],c=0;c<o.length;c++)n.push({text:o[c].name,value:o[c].name});for(a.element.find("#"+a._id+"_dimensionFieldCM").ejDropDownList({dataSource:n,selectedIndex:0,width:"100%",enableRTL:a.model.enableRTL,cssClass:"e-calcMemberDimensionField"}),a.element.find(".e-calcMemberDimensionField").css("visibility","hidden"),a.element.find("#"+a._id+"_formatFieldCM").ejDropDownList({dataSource:[{text:"Standard",value:"Standard"},{text:"Currency",value:"Currency"},{text:"Percent",value:"Percent"},{text:"Custom",value:"Custom"}],enableRTL:a.model.enableRTL,selectedIndex:0,width:"100%",enableRTL:a.model.enableRTL,change:t.proxy(function(e){"Custom"==e.text?a.element.find(".e-calcMemberCustomFormat").css("visibility","visible"):a.element.find(".e-calcMemberCustomFormat").css("visibility","hidden")},a)}),s=a.element.find(".e-cubeTreeViewCalcMember").find("li"),c=0;c<s.length;c++)t.isNullOrUndefined(e(s[c]).attr("id"))||e(s[c]).attr("data-tag",t.DataManager(r).executeLocal(t.Query().where("id","equal",e(s[c]).attr("id")))[0].tag);for(d=a.element.find(".e-cubeTreeViewCalcMember .e-folderCDB"),c=0;c<d.length;c++)e(d[c].parentElement).removeClass("e-draggable");if(a.element.find(".e-cubeTreeViewCalcMember .calcMemberGroupCDB").length>0&&a.element.find(".e-cubeTreeViewCalcMember .calcMemberGroupCDB").parent().removeClass("e-draggable"),a._calcMemberTreeObj=a.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView"),!t.isNullOrUndefined(a._selectedCalcMember)&&(h={},(h=a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.DataManager(a._calcMembers).executeLocal(t.Query().where("name","equal",a._selectedCalcMember)):t.DataManager(a.model.calculatedMembers).executeLocal(t.Query().where("caption","equal",a._selectedCalcMember))).length>0)){if(u=0,u=a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?h[0].nodeType:h.length>0&&h[0].memberType&&("dimension"==h[0].memberType||"Dimension"==h[0].memberType)?1:0,a.element.find("#"+a._id+"_captionFieldCM").val(h[0].caption||h[0].name),a.element.find("#"+a._id+"_expressionFieldCM").val(h[0].expression),a.element.find("#"+a._id+"_memberTypeFieldCM").data("ejDropDownList").selectItemsByIndices(u),1==u){var O=(a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?h[0].tag:h[0].hierarchyUniqueName).split(".")[0].replace(/\[/g,"").replace(/\]/g,""),y=a.element.find("#"+a._id+"_dimensionFieldCM").data("ejDropDownList").model.dataSource;for(c=0;c<y.length;c++)y[c].value==O&&a.element.find("#"+a._id+"_dimensionFieldCM").data("ejDropDownList").selectItemsByIndices(c)}t.isNullOrUndefined(h[0].formatString)||("Standard"==h[0].formatString?a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(0):"Currency"==h[0].formatString?a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(1):"Percent"==h[0].formatString?a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(2):(a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(3),a.element.find("#"+a._id+"_customFormatFieldCM").val(h[0].formatString)))}a._waitingPopup.hide()},_refreshFieldList:function(i){var l,a,r,o,n,s=i.element.find(".e-schemaFieldTree").data("ejTreeView");for(s.refresh(),l=s.model.fields.dataSource,a=i.element.find(".e-schemaFieldTree li"),r=0;r<e(a).length;r++)o=e(e(a)[r]).attr("id"),(n=e.map(l,function(e){if(e.id==o)return{tag:e.tag,expression:e.expression,defaultHierarchy:e.defaultHierarchy}})).length>0&&""!=n[0]&&(e(e(a)[r]).attr("data-tag",n[0].tag),t.isNullOrUndefined(n[0].expression)||e(e(a)[r]).attr("expression",n[0].expression),t.isNullOrUndefined(n[0].defaultHierarchy)||e(e(a)[r]).attr("data-defaultHierarchy",n[0].defaultHierarchy))},_getMemberChildNodes:function(i){var l,a,r;if((e(i.currentElement).find("a > span")[0].className.indexOf("level")>-1||e(i.currentElement).find("a > span")[0].className.indexOf("member")>-1)&&(l=t.DataManager(this._calcMemberTreeObj.dataSource()).executeLocal(t.Query().where("pid","equal",e(i.currentElement).attr("id")).where("name","equal","(Blank)")),!t.isNullOrUndefined(l)&&l.length>0))if(this._calcMemberTreeObj.hideNode(l[0].id),this.pNode=i.currentElement,this._waitingPopup.show(),a=e(i.currentElement).find("a > span")[0].className.indexOf("level")>-1?"level":"member",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var o=this.model.dataSource,n=this.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView"),s=e.map(n.model.fields.dataSource,function(t){if(t.id==e(i.currentElement).attr("id"))return t});if(e(i.currentElement).children("ul").children().length>1)this._waitingPopup&&this._waitingPopup.hide();else{s.length>0&&(this._calcExpanded=s[0]);var d="select {"+e(i.currentElement).attr("data-tag")+".members}dimension properties CHILDREN_CARDINALITY, MEMBER_TYPE on 0 from ["+e.trim(o.cube)+"]",h=t.olap._mdxParser.getSoapMsg(d,o.data,o.catalog),u=t.olap.base._getConnectionInfo(o.data);this.doAjaxPost("POST",u.url,{XMLA:h},t.proxy(this._generateCalculatedMember,this),null,{action:"fetchMembers"})}}else null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"fetchMemberChildNodes",element:this.element,customObject:this.model.customObject}),r=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMemberTreeNodes,JSON.stringify({action:"fetchMemberChildNodes",dimensionName:e(i.currentElement).attr("data-tag")+":"+a+":"+e(i.currentElement).attr("id"),olapReport:this.currentReport,customObject:r}),t.proxy(t.Pivot._fetchMemberSuccess,this))},_fetchMemberSuccess:function(a){var r,o,n;for(r=a.length>1&&a[0]!=l?JSON.parse(a[0].Value):a.d!=l?JSON.parse(a.d[0].Value):JSON.parse(a.MemberChildNodes),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"fetchMemberChildNodes",element:this.element,customObject:this.model.customObject}),this._calcMemberTreeObj.model.beforeExpand=null,this._calcMemberTreeObj.addNode(r,e(this.pNode)),o=t.DataManager(this._calcMemberTreeObj.dataSource()).executeLocal(t.Query().where("pid","equal",e(this.pNode).attr("id")).where("name","equal","(Blank)")),!t.isNullOrUndefined(o)&&o.length>0&&this._calcMemberTreeObj.removeNode(o[0].id),e.each(e(this.pNode).children().find("li"),function(e,t){t.setAttribute("data-tag",r[e].tag)}),n=e(this.pNode).children().find("li"),i=0;i<n.length;i++)1==r[i].hasChildren&&(this._calcMemberTreeObj.addNode({id:r[i].id+"_Blank_"+i,name:"(Blank)",parentId:r[i].id},n[i]),this.element.find("#"+r[i].id).find("> div > div:first").removeClass("e-process"),this._calcMemberTreeObj.collapseNode(this.element.find("#"+r[i].id)));this._calcMemberTreeObj.model.beforeExpand=t.proxy(t.Pivot._getMemberChildNodes,this),this._waitingPopup.hide()},_drillThroughCellClick:function(l,a){var r,o,n,s,d,h,u;if(a._waitingPopup.show(),n=e(l.currentTarget.parentElement).attr("data-p"),a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)(o=e(a.element).parents(".e-pivotclient").length>0||e(a.element).parents(".e-maximumView").length>0?a._pivotClientObj:a).doAjaxPost("POST",o.model.url+"/"+o.model.serviceMethodSettings.drillThroughDataTable,JSON.stringify({currentReport:JSON.parse(a.getOlapReport()).Report,layout:a.model.layout,cellPos:n,selector:"",customObject:JSON.stringify(o.model.customObject)}),function(e){o._trigger("drillThrough",{element:a.element,data:e})});else{for(s=e("#"+a._id).find("tbody").find("tr:first").find("th").length,i=0;i<s;i++)-1!=(d=-1!=a.getJSONRecords()[parseInt(i*a._rowCount+parseInt(n.split(",")[1]))].Info.indexOf("Measures")||a.getJSONRecords()[parseInt(i*a._rowCount+parseInt(n.split(",")[1]))].RowSpan<=1?a.getJSONRecords()[parseInt(i*a._rowCount+parseInt(n.split(",")[1]))].Info.split("::")[0]:"").indexOf("Measures")&&(r=d),""!=d&&(a._rowHeader[i]=d);for(h=e("#"+a._id).find("tbody").find('[data-p="'+parseInt(n.split(",")[0])+","+parseInt(n.split(",")[1])+'"]').closest("tbody").prev().children("tr").length,i=0;i<h;i++)-1!=(u=-1!=a.getJSONRecords()[parseInt(parseInt(n.split(",")[0])*a._rowCount+i)].Info.indexOf("Measures")||a.getJSONRecords()[parseInt(parseInt(n.split(",")[0])*a._rowCount+i)].ColSpan<=1?a.getJSONRecords()[parseInt(parseInt(n.split(",")[0])*a._rowCount+i)].Info.split("::")[0]:"").indexOf("Measures")&&(r=u),""!=u&&(a._colHeader[i]=u);for((t.isNullOrUndefined(a._fieldData)||!t.isNullOrUndefined(a._fieldData)&&t.isNullOrUndefined(a._fieldData.hierarchy))&&a._getFieldItemsInfo(a),j=0;j<a._fieldData.measures.length;j++)r==a._fieldData.measures[j].id&&(a.measureGrp=a._fieldData.measures[j].pid);a._rowHeader=e.grep(a._rowHeader,function(e){return 0==e||e}),a._colHeader=e.grep(a._colHeader,function(e){return 0==e||e}),a._createDrillThroughQuery("",a)}},openHierarchySelector:function(e,i){var l,a,r;e.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._createDrillThroughDialog(e,i):(e._waitingPopup.show(),a=(l=e.target.className.indexOf("e-pivotclient")>=0?e._pivotGrid:e)._getConnectionInfo(e.model.dataSource.data),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASUREGROUP_DIMENSIONS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.model.dataSource.cube+"</CUBE_NAME><MEASUREGROUP_NAME>"+l.measureGrp+"</MEASUREGROUP_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>",this.doAjaxPost("POST",a.url,{XMLA:r},l._loadDimensionElements,null,{pvtGridObj:l,action:"loadMeasureElements"}))},_createDrillThroughDialog:function(i,l){var a,r,o,n;i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&l.shift(),i.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove();var s=t.buildTag("label#",i._getLocalizedLabels("SelectHierarchy"))[0].outerHTML,d="<div class=e-cubeTable style='width:200px; overflow:auto'><div valign=\"bottom\">"+this._createHierarchyBrowser()+"</div></div>",h=t.buildTag("div#dropDlg.dropDlg",'<table class="e-outerTable"><tr><td>'+d+"</td><td>"+s+"<br><textarea id='hrSel' style='width:270px; height:300px; resize:none; margin:0px 5px 0 5px'></textarea></br><br></td></tr></table>")[0].outerHTML+"</br>",u=t.buildTag("div",t.buildTag("button#btnOK.dialogBtnOK",i._getLocalizedLabels("OK")).attr("title",i._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML+t.buildTag("button#btnCancel.dialogBtnCancel",i._getLocalizedLabels("Cancel")).attr("title",i._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,{float:"right",margin:"-5px 0 6px"})[0].outerHTML,c=t.buildTag("div#clientDialog.e-clientDialog",h+u,{opacity:"1"}).attr("title","Hierarchy Selector")[0].outerHTML;for(e(c).appendTo("#"+i._id),e("#btnOK, #btnCancel").ejButton(),e("#btnOK, #btnCancel").css({margin:"0 20px 20px 0",width:"50px"}),i.element.find(".e-clientDialog").ejDialog({width:550,target:"#"+i._id,enableResize:!1,enableRTL:i.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,i)}),i.element.find(".cubeTreeViewHierarchy").ejTreeView({showCheckbox:!0,fields:{id:"id",parentId:"pid",text:"name",isChecked:"isSelected",spriteCssClass:"spriteCssClass",dataSource:i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.isNullOrUndefined(l.d)?e.parseJSON(l):e.parseJSON(l.d):l},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:!!i.model.enableRTL,beforeDelete:function(){return!1},dragAndDropAcrossControl:!0,nodeDropped:t.proxy(this._hierarchyNodeDropped,i)}),i._tableTreeObj=i.element.find(".cubeTreeViewHierarchy").data("ejTreeView"),i._tableTreeObj.element.find(".e-ul").css({width:"100%",height:"100%"}),i._tableTreeObj.element.find(".e-chkbox-wrap").remove(),a=i._tableTreeObj.element.find("li"),r=0;r<a.length;r++)o=i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.isNullOrUndefined(l.d)?e.parseJSON(l)[r].tag:e.parseJSON(l.d)[r].tag:l[r].tag,a[r].setAttribute("data-tag",o);i._tableTreeObj&&i._tableTreeObj.element.find("li").mouseover(t.proxy(function(t){e(t.target).parent().find(".e-measureGroupCDB, .e-dimensionCDB, .e-folderCDB").length>0&&e(t.target).css("cursor","default")},i)),n=i,e("#btnOK").click(function(){var i=e("#hrSel").val();e(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog, .drilltableDialog").remove(),n._waitingPopup.show(),t.olap._mdxParser._createDrillThroughQuery(i,n),n._waitingPopup.hide()}),e("#btnCancel").click(function(){e(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),n._waitingPopup.hide()}),i.model.enableRTL&&(e(".e-dialog").addClass("e-rtl"),e(".dialogBtnCancel").css("margin","0 -70px 0 0"))},_createHierarchyBrowser:function(){return t.buildTag("div.cubeBrowserHierarchy",t.buildTag("div.cubeTreeViewHierarchy")[0].outerHTML,{width:"200px",height:"300px",overflow:"auto"})[0].outerHTML},_hierarchyNodeDropped:function(i){var l,a,r;if("hrSel"==i.dropTarget[0].id&&(l=e(e(i.droppedElement).children()[0]).find(".e-dimensionCDB").length>0?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement).find("li:first").attr("data-tag"):e(i.droppedElement).find("li:first")[0].id:0==e(i.droppedElement).find("li:first").length?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement.parent().parent()).attr("data-tag"):e(i.droppedElement.parent().parent())[0].id:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement).attr("data-tag"):i.droppedElementData.id,!t.isNullOrUndefined(l))){for(l=l.replace("[","[$"),a=0;a<e("#hrSel").val().split(",").length;a++)if(l==e("#hrSel").val().split(",")[a])return!1;0!=(r=this.element.find("#hrSel").val()).length?(r=r+","+l,this.element.find("#hrSel").val(r)):this.element.find("#hrSel").val(l)}},_generateDrillData:function(t,i){for(var l=e(i).find("row").children(),a=e.map(l,function(e){var t=e.textContent;return'"'+e.tagName.replace(/_x005B_/g,"[").replace(/_x0020_/g," ").replace(/_x005D_/g,"]").replace(/_x0024_/g,"$").replace("].[","]-[")+'":"'+t+'"'}),r=a[0],o="",n=0;n<a.length;n++)a[n]!=r?o+=","+a[n]:o+=""==o?"[{"+a[n]:"}, {"+a[n];o+="}]",e(t.pvtGridObj.element).parents(".e-pivotclient").length>0?e(t.pvtGridObj.element).parents(".e-pivotclient").data("ejPivotClient")._trigger("drillThrough",{element:t.pvtGridObj.element,data:o}):t.pvtGridObj._trigger("drillThrough",{element:t.pvtGridObj.element,data:o})},_getFilterStateMember:function(i,l,a,r,o){if("include"==a.filterItems.filterType)if(1==a.filterItems.values.length)if(t.isNullOrUndefined(r._fieldSelectedMembers[a.fieldName.toLowerCase()])&&i){var n="select {"+a.filterItems.values[0]+"}dimension properties CHILDREN_CARDINALITY on 0 from ["+e.trim(r.model.dataSource.cube)+"]",s=t.olap._mdxParser.getSoapMsg(n,r.model.dataSource.data,r.model.dataSource.catalog),d=t.olap.base._getConnectionInfo(r.model.dataSource.data);this.doAjaxPost("POST",d.url,{XMLA:s},t.proxy(this._getInitialSlicerName,this),null,{controlObject:r,action:"fetchMembers"}),o=r._slicerName}else i||(o=a.filterItems.values[0]);else o=r._getLocalizedLabels("MultipleItems");else o=l.length-(-1==a.filterItems.values.indexOf("All")?a.filterItems.values.length:a.filterItems.values.length-1)==1?l.filter(function(e){if(-1==a.filterItems.values.indexOf(e))return e}):r._getLocalizedLabels("MultipleItems");return o},_getFilterState:function(i,a,r,o){var n,s,d="";if(o.model.operationalMode==t.Pivot.OperationalMode.ClientMode)i?(t.isNullOrUndefined(t.olap.base.olapCtrlObj)&&(t.olap.base.olapCtrlObj=o),("All"==o._fieldSelectedMembers[r.fieldName.toLowerCase()]||t.isNullOrUndefined(o._fieldSelectedMembers[r.fieldName.toLowerCase()]))&&t.olap._mdxParser.getAllMember(o.model.dataSource,r.fieldName,o),d="All"==o._fieldSelectedMembers[r.fieldName.toLowerCase()]||t.isNullOrUndefined(o._fieldSelectedMembers[r.fieldName.toLowerCase()])?o._allMember:o._fieldSelectedMembers[r.fieldName.toLowerCase()],d=this._getFilterStateMember(i,a,r,o,d)):d=this._getFilterStateMember(i,a,r,o,d);else if(o.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if((n=t.isNullOrUndefined(o._tempFilterData)?[]:e.map(o._tempFilterData,function(e){return e[r.DimensionName]})).length>0&&o._fieldMembers[r.DimensionName])d=o._fieldMembers[r.DimensionName].length-n.length==1?o._fieldMembers[r.DimensionName].filter(function(e){if(-1==n.indexOf(e))return e}):o._getLocalizedLabels("MultipleItems");else if(t.isNullOrUndefined(o._clientReportCollection))d=o._getLocalizedLabels("All");else for(s=0;s<o._clientReportCollection.length;s++){if(!t.isNullOrUndefined(o._clientReportCollection[s]._fieldSelectedMembers)&&(""==o._currentRecordName&&o.element.find("#reportList")!=l&&o.element.find("#reportList")[0].value==o._clientReportCollection[s].name||""!=o._currentRecordName&&o._currentReportName==o._clientReportCollection[s].name)){o._fieldSelectedMembers[r.Tag]=o._clientReportCollection[s]._fieldSelectedMembers[r.DimensionName],d="All"==o._fieldSelectedMembers[r.Tag]||o._fieldSelectedMembers[r.Tag]==l?o._getLocalizedLabels("All"):o._fieldSelectedMembers[r.Tag];break}d=o._getLocalizedLabels("All")}else d=("All"==o._fieldSelectedMembers[r.Tag]?r.AllMember:o._fieldSelectedMembers[r.Tag])||r.AllMember;return d},_getInitialSlicerName:function(t,i){t.controlObject._slicerName=e(e(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},_getTreeViewItems:function(t){for(var i,l=t.element.find(".e-editorTreeView"),a=[],r=e(l).find(":input.nodecheckbox"),o=0;o<r.length;o++)i=e(r[o]).parents("li:eq(0)"),a.push({Id:i[0].id,name:e(i[0]).find("a:eq(0)").text()});return a},_getEditorMember:function(i,l,a){var r,o,n,s=a?l._schemaData._editorTreeData:l._editorTreeData,d=[];if(l.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if(0==s.length){var h=this._getTreeViewItems(a?l._schemaData:l,s),u=e.extend(!0,[],a?l._schemaData._memberTreeObj.dataSource():l._memberTreeObj.dataSource()),c=e.map(h,function(i){if("All"!=i.Id)return e.map(u,function(e){i.Id==e.id&&((i=e).name=t.isNullOrUndefined(i.parentId)?i.name+"_1":i.name)}),i}),p=e.map(c,function(t){return e.map(c,function(e){t.parentId==e.id&&(t.name=t.name+"_"+(Number(e.name.split("_")[e.name.split("_").length-1])+1))}),t});e.map(p,function(e){var t=e.name.split("_")[e.name.split("_").length-2],i=Number(e.name.split("_")[e.name.split("_").length-1]),l=e.checkedStatus;d.push({name:t,checked:l,level:Number(i)})})}else e.map(s,function(e){d.push({name:e.name,id:e.id,pid:e.pid,checked:e.checkedStatus,level:e.level})});return this._updateEditorMembers(i,d,l,s)}if(l.model.analysisMode==t.Pivot.AnalysisMode.Olap)return r=a?l._schemaData.element.find(".e-editorTreeView"):l.element.find(".e-editorTreeView"),p=s.length>0?s:e(r).find(":input.nodecheckbox"),s.length>0?e.map(p,function(e){d.push({name:e.name,id:e.id,pid:e.pid,checked:e.checkedStatus,level:Number(e.id.split("_")[e.id.split("_").length-1])})}):e.map(p,function(t){if("All"!=e(t).parents("li:eq(0)").attr("id")){var i=e(t).parent().siblings("a").text(),l=t.value.split("_")[t.value.split("_").length-1],a=!(!t.checked&&"mixed"!=e(t.parentElement).attr("aria-checked"));d.push({name:i,checked:a,level:Number(l)})}}),this._updateEditorMembers(i,d,l,s);for(o=[],n=1;n<i.length;n++)o.push(e(i[n].parentElement).siblings("a").text());return o},_updateEditorMembers:function(i,l,a,r){var o,n,s,d,h,u;if(l.length>0&&"All"==l[0].name&&l.splice(0,1),!t.isNullOrUndefined(a._fieldMembers[i]))if(0==r.length){var c=[],p=0,m="",g=a._fieldMembers[i];for(o=0;o<l.length;o++)if(t.isNullOrUndefined(g[o+p])||l[o].level==g[o+p].level)c.push(l[o]);else if(t.isNullOrUndefined(g[o+p])||l[o].level<g[o+p].level){s=o;do{l[o-1].checked&&c.push(g[s]),p++,s++}while(l[o].level<g[s].level);o--}else if(t.isNullOrUndefined(g[o+p])||l[o].level>g[o+p].level){n=g[o+p].level,s=o;do{c.push(l[s]),p--,o=++s-1}while(l[s].level>n)}a._fieldMembers[i]=c}else d=e.extend(!0,[],a._fieldMembers[i]),h=[],e.each(l,function(e,t){for(var i=!1,l=0;l<d.length;l++)if(t.id==d[l].id){d.splice(l,1,t),i=!0;break}i||h.push(t)}),a._fieldMembers[i]=d.concat(h);a._fieldMembers[i]=t.isNullOrUndefined(a._fieldMembers[i])?l:a._fieldMembers[i];var f=1,_="",v="",b=[];do{if(u=e.map(a._fieldMembers[i],function(e){if(e.level==f)return e}),b=e.map(u,function(e){if(e.checked)return e}),u.length==b.length)m=1==f?"All":_,u.length>1&&(v="All"),f++;else if(1==b.length)_=m="All"==v?"multiple":b[0].name,f++;else if(b.length>1&&u.length>b.length){m="multiple";break}}while(b.length>0&&"All"!=m&&"multiple"!=m&&e.map(a._fieldMembers[i],function(e){if(e.level==f)return e}).length>0);return m},_getTreeData:function(e,i,l){var a=t.olap.base._getConnectionInfo(e.url),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME>"+("loadcubelist"==l.action?"":"<CUBE_NAME>"+e.cube+"</CUBE_NAME>")+"</RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog><LocaleIdentifier>"+a.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>";l.action="loadFieldElements",this.doAjaxPost("POST",a.url,{XMLA:r},i,null,l)},updateTreeView:function(i){var l,a,r,o,n,s,d=i.element.find(".e-editorTreeView").find("li"),h=d.length,u=i._memberTreeObj.dataSource(),c=u.length;if(i.element.find(".e-editorTreeView").parents("#"+i._id+"_ClientDialog").find(".e-editorPara").text()==i._getLocalizedLabels("KPIs"))for(n=0;n<h;n++)for(l=e(d[n]).find("span:first").attr("aria-checked"),s=0;s<c;s++)d[n].id!=u[s].id||"mixed"!=l&&"true"!=l?d[n].id==u[s].id&&"false"==l&&(t.isNullOrUndefined(u[s].parentId)?u[s].checkedStatus=!1:e(d[n].parentElement).parent().attr("id")==u[s].parentId&&(u[s].checkedStatus=!1)):t.isNullOrUndefined(u[s].parentId)?u[s].checkedStatus=!0:e(d[n].parentElement).parent().attr("id")==u[s].parentId&&(u[s].checkedStatus=!0);else for(n=0;n<h;n++)for(l=e(d[n]).find("span:first").attr("aria-checked"),s=0;s<c;s++){if(d[n].id==u[s].id&&("mixed"==l||"true"==l)){u[s].checkedStatus=!0;break}if(d[n].id==u[s].id&&"false"==l){u[s].checkedStatus=!1;break}}for(n=0;n<u.length;n++)if(a=!1,1==u[n].checkedStatus){for(s=0;s<u.length;s++)if(u[s].hasOwnProperty("parentId")&&u[s].parentId==u[n].id&&1==u[s].checkedStatus){a=!0;break}if(!a)for(r=0;r<u.length;r++)u[r].hasOwnProperty("parentId")&&u[r].parentId==u[n].id&&(u[r].checkedStatus=!0)}else if(0==u[n].checkedStatus)for(o=0;o<u.length;o++)u[o].hasOwnProperty("parentId")&&u[o].parentId==u[n].id&&(u[o].checkedStatus=!1);for(n=0;n<h;n++)if(null==e(d[n]).attr("data-tag"))for(s=0;s<c;s++)if(e(d[n]).attr("id")==u[s].id){e(d[n]).attr("data-tag",u[s].tag);break}return i._memberTreeObj},getNodesState:function(e){for(var t="",i="",l="ejTreeView"==e.pluginName?e.dataSource():e,a=0;a<l.length;a++)1==l[a].checkedStatus?t+="::"+l[a].id+"||"+l[a].tag+"||"+(l[a].parentId||l[a].pid)+"||"+l[a].name:i+="::"+(l[a].parentId||l[a].pid)+"||"+l[a].tag+"||"+l[a].name;return{selectedNodes:t,unSelectedNodes:i}},removeParentSelectedNodes:function(t){for(var i,a=e.extend([],t),r=0;r<t.length;r++)for(i=0;i<a.length;i++)a[i].Id==t[r].parentId&&a.splice(i,1);return e.map(a,function(e){if(""!=e.tag&&e.tag!=l)return e.tag.replace(/\&/g,"&amp;")})},getChildNodes:function(i,a,r,o,n){var s,d,h,u=i.targetElement,c=(o.cube,o.catalog,o.data,n._generateChildMembers,e(i.currentElement).find("li").length),p=!1,m={memberEditorPageSize:"ejPivotSchemaDesigner"==n.pluginName?n.model.pivotControl.model.memberEditorPageSize:n.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==n.pluginName?n.model.pivotControl.model.enableMemberEditorPaging:n.model.enableMemberEditorPaging};if(m.enableMemberEditorPaging){for(s=0;s<n._memberTreeObj.dataSource().length;s++)if(n._memberTreeObj.dataSource()[s].parentId==i.id||n._memberTreeObj.dataSource()[s].pid==i.id)return i.isChildLoaded=!0,void t.Pivot.closePreventPanel(n)}else n._isSearchApplied=!1;if(jQuery.each(n._editorTreeData,function(e,t){if(t.id==i.id)return t.expanded=!0,t.isChildMerged=!0,!1}),0==c){var g=t.buildTag("span.nodeExpand e-load e-icon")[0].outerHTML,f=e(u).parents("li:eq(0)").attr("id");e.map(r,function(i){var r,o,s,d;i.fieldName!=a||t.isNullOrUndefined(i.filterItems)||(r=i.filterItems,(t.isNullOrUndefined(n.model.pivotControl)?n.model.enableMemberEditorPaging:n.model.pivotControl.model.enableMemberEditorPaging)?(r=e.map(r,function(e){if(e.pid!=l&&e.pid==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"))return p=!0,e})).length>0&&1==p&&(o=t.Pivot._generateChildWithAncestors(n,e(u).parents("li:eq(0)"),m.enableMemberEditorPaging,m.memberEditorPageSize),m.enableMemberEditorPaging&&(r.length>=m.memberEditorPageSize||o.lstChildren.length>=m.memberEditorPageSize)?(n._isEditorDrillPaging=!0,n.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),n._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(n,e(u).parents("li:eq(0)")[0].id),s=o.allLvlLst.length>1&&o.lstChildren.length>=m.memberEditorPageSize?t.Pivot._getParentsTreeList(n,o.lstParents[0].id,n._editorTreeData):e.grep(n._editorTreeData,function(t){return t.id==e(u).parents("li:eq(0)")[0].id})[0],d={childNodes:o.allLvlLst.length>1&&o.lstChildren.length>=m.memberEditorPageSize?o.lstChildren:r,parentNode:s},t.Pivot._drillEditorTreeNode(d,n,m.memberEditorPageSize)):(e(u).parents("li:eq(0)").find(".nodeExpand").remove(),e(u).parents("li:eq(0)").removeClass("e-load"),e.each(r,function(e,t){delete t.parentId}),n._onDemandNodeExpand=!1,n._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(r,n,"ejPivotSchemaDesigner"==n.pluginName?n.model.pivotControl:n),e(u).parents("li:eq(0)")),n._onDemandNodeExpand=!1,n._memberTreeObj.model.nodeCheck=t.proxy(n._nodeCheckChanges,n),n._memberTreeObj.model.nodeUncheck=t.proxy(n._nodeCheckChanges,n),e.each(e(u).parents("li:eq(0)").find("li"),function(e,i){t.isNullOrUndefined(r[e])||i.setAttribute("data-tag",r[e].tag)}))):e.map(r,function(e){(e.parentId!=l&&e.parentId==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-")||e.pid!=l&&e.pid==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"))&&(p=!0)}))});i.isChildLoaded=!!p,p?jQuery.grep(n._editorTreeData,function(e){if(e.pid==i.id)return e}).length>10&&n.element.find("a.e-linkPanel").css("display","block"):(e(u).parents("li:eq(0)").prepend(g),e(u).parents("li:eq(0)").attr("data-tag")==l&&((d=e.map(r,function(e){if(e.fieldName==a)return e})[0])&&e.map(d.filterItems,function(t){t.id==e(u).parents("li:eq(0)").attr("id")&&e(u).parents("li:eq(0)").attr("data-tag",t.tag)})),h=e(u).parents("li:eq(0)").attr("data-tag").replace(/\&/g,"&amp;"),t.olap._mdxParser.getChildren(o,h,n))}},_getFilterParams:function(e,i,l){var a,r,o,n="";if("schemaValue"!=e){if(a="",!t.isNullOrUndefined(i))for(r=0;r<i.length;r++)if(!t.isNullOrUndefined(i[r][l]))for(o=0;o<i[r][l].length;o++)a+="##"+i[r][l][o];""!=a&&(n=e+"::"+l+"::FILTERED"+a)}return n},generateChildMembers:function(i,l){var a,r,o,n,s,d,h=e(l).find("Axis:eq(0) Tuple"),u=[],c=this;t.isNullOrUndefined(c.olapCtrlObj)||(c=c.olapCtrlObj);var p={memberEditorPageSize:"ejPivotSchemaDesigner"==c.pluginName?c.model.pivotControl.model.memberEditorPageSize:c.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==c.pluginName?c.model.pivotControl.model.enableMemberEditorPaging:c.model.enableMemberEditorPaging},m={currentReportItems:"ejPivotSchemaDesigner"==c.pluginName?c.model.pivotControl._currentReportItems:c._currentReportItems,savedReportItems:"ejPivotSchemaDesigner"==c.pluginName?c.model.pivotControl._savedReportItems:c._savedReportItems},g=c.element.find("[data-tag='"+i.currentNode.replace(/&amp;/g,"&")+"']");for(r=0;r<h.length;r++){var f=e(e(l).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[0]).text(),_=""==e(e(l).find("Axis:eq(0) Tuple:eq("+r+")").children()).find("Caption").text()?"(Blank)":e(e(l).find("Axis:eq(0) Tuple:eq("+r+")").children()).find("Caption").text(),v={hasChildren:"0"!=e(h[r]).find("CHILDREN_CARDINALITY").text(),checkedStatus:"true"==e(e(g).find("input.nodecheckbox")[0]).parent().attr("aria-checked"),id:f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_"),name:_,tag:f,level:parseInt(e(h[r]).find("LNum").text())};u.push(v)}u.length>0&&c.model.enableMemberEditorSorting&&null!=c._sortType&&(u=t.DataManager(u).executeLocal(t.Query().sortBy("name",c._sortType))),a=e(g).parents("li").length>1?e(g).parents("li").first():e(g).parents("li"),e(e(a).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1}),c._memberTreeObj=c.element.find(".e-editorTreeView").data("ejTreeView"),u.length>0&&(o="ejPivotGrid"==c.pluginName?c._selectedField:c._selectedFieldName,e.map(m.currentReportItems,function(i){i.fieldName!=o||t.isNullOrUndefined(i.filterItems)||(e.each(u,function(t,i){i.pid=e(g).attr("id")}),e.merge(i.filterItems,u),c._editorTreeData=i.filterItems)}),0==m.currentReportItems.length&&c._editorTreeData.concat(u)),g.find(".nodeExpand").remove(),g.find(".e-load").removeClass("e-load"),jQuery.each(c._editorTreeData,function(e,t){if(t.id==g[0].id)return t.expanded=!0,!1}),p.enableMemberEditorPaging?(n=t.Pivot._generateChildWithAncestors(c,g,p.enableMemberEditorPaging,p.memberEditorPageSize),u.length>=p.memberEditorPageSize||n.lstChildren.length>=p.memberEditorPageSize?(c._isEditorDrillPaging=!0,c.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),c._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(c,g[0].id),s=n.allLvlLst.length>1&&n.lstChildren.length>=p.memberEditorPageSize?t.Pivot._getParentsTreeList(c,n.lstParents[0].id,c._editorTreeData):e.grep(c._editorTreeData,function(e){return e.id==g[0].id})[0],d={childNodes:n.allLvlLst.length>1&&n.lstChildren.length>=p.memberEditorPageSize?n.lstChildren:u,parentNode:s},t.Pivot._drillEditorTreeNode(d,c,p.memberEditorPageSize)):c._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(u,c,"ejPivotSchemaDesigner"==c.pluginName?c.model.pivotControl:c),e(g))):c._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(u,c,"ejPivotSchemaDesigner"==c.pluginName?c.model.pivotControl:c),e(g)),e.each(g.find("li"),function(e,i){t.isNullOrUndefined(u[e])||i.setAttribute("data-tag",u[e].tag)}),m.savedReportItems=e.extend(!0,[],m.currentReportItems)},_generateChildWithAncestors:function(i,l,a,r){var o,n,s=[],d=[e.grep(i._editorTreeData,function(e){return e.id==l[0].id})[0]],h=[];if(a){jQuery.each(i._editorTreeData,function(e,t){if(t.id==l[0].id)return t.expanded=!0,!1}),s.push(d[0]);do{for(o=[],h=[],n=0;n<d.length&&(e.each(i._editorTreeData,function(e,i){t.isNullOrUndefined(i.pid)||i.pid!=d[n].id||(i.expanded&&(o.push(i),s.push(i)),h.push(i))}),!(h.length>=r));n++)h=[];if(d=o.length>0&&h.length<r?o:d,h.length>=r)break}while(o.length>0)}return{allLvlLst:s,lstParents:d,lstChildren:h}},_makeAncestorsExpandable:function(e,i){var l=t.DataManager(e._editorTreeData).executeLocal(t.Query().where("id","equal",i));l.length>0&&(l[0].expanded=!0,i=l[0].pid),!t.isNullOrUndefined(i)&&l.length>0&&this._makeAncestorsExpandable(e,i)},_jsonToEngine:function(e){for(var i,l=e,a=[],r=0;r<l.length;r++)i=parseInt(l[r].Index.split(",")[0]),t.isNullOrUndefined(a[i])?(a[i]=[],a[i].push(l[r])):a[i].push(l[r]);return a},_cropJson:function(i,l){var a,r,o,n,s,d,h,u,c=0,p=0,m=1;if(r=(a=i.model.operationalMode==t.Pivot.OperationalMode.ServerMode?{columns:JSON.parse(i.getOlapReport()).PivotColumns,rows:JSON.parse(i.getOlapReport()).PivotRows,values:JSON.parse(i.getOlapReport()).PivotCalculations}:{columns:i.model.dataSource.columns,rows:i.model.dataSource.rows,values:i.model.dataSource.values}).columns.length+(a.values.length>0&&"rows"!=a.values[0].axis?1:0),o=a.rows.length+(a.values.length>0&&"rows"==a.values[0].axis?1:0),r=0==r?1:r,o=0==o?1:o,""==i._drillAction&&i.model.enableCollapseByDefault){if(f=e.extend(!0,[],t.Pivot._jsonToEngine(l)),r+o>2){for(;p<f[0].length;)if(a.rows.length>1&&-1==f[0][p].CSS.indexOf("summary")&&p+m>r||0==a.columns.length&&0==a.values.length&&-1==f[0][p].CSS.indexOf("summary")||p>0&&m<a.columns.length){for(n=0;n<f.length;n++)f[n].splice(p,1);m++}else p++;for(m=1;c<f.length;)a.columns.length>1&&-1==f[c][0].CSS.indexOf("summary")&&c+m>o||0==a.rows.length&&0==a.values.length&&-1==f[c][0].CSS.indexOf("summary")||c>0&&m<a.rows.length?(f.splice(c,1),m++):c+=f[c][0].CSS.indexOf("summary")>-1?f[c][0].ColSpan:1}for((f=e.map(f,function(t){return[e.map(t,function(e){return("summary rstot"==e.CSS||"summary cstot"==e.CSS||"summary stot"==e.CSS)&&(e.State=2,e.Value=e.Value.replace("Total","")),e})]}))[0][0].ColSpan="none"==f[0][0].CSS&&a.values.length>0&&"rows"==a.values[0].axis&&a.rows.length>0?2:1,f[0][0].RowSpan="none"==f[0][0].CSS&&a.values.length>0&&"rows"!=a.values[0].axis&&a.columns.length>0?2:1,r=a.values.length>0&&"rows"==a.values[0].axis?a.values.length:1,o=a.values.length>0&&"rows"!=a.values[0].axis?a.values.length:1,c=0;c<f[0].length;c++)f[0][c].CSS.indexOf("summary")>-1&&(f[0][c].RowSpan=r,f[0][c].ColSpan=1);for(c=0;c<f.length;c++)f[c][0].CSS.indexOf("summary")>-1&&(f[c][0].ColSpan=o,f[c][0].RowSpan=1);return e.map(f,function(e){return e})}if(i.model.enableCollapseByDefault||""!=i._drillAction){var g=0,f=e.extend(!0,[],t.Pivot._jsonToEngine(i._croppedJson)),_=e.extend(!0,[],t.Pivot._jsonToEngine(i._compJson)),v=e.extend(!0,[],i._compJson),b=""==i._drillParams.currRow?"column":"row";for(s=0;s<i._compJson.length&&0==parseInt(i._compJson[s].Index.split(",")[0]);s++)g++;return d=t.Pivot._getDrillRange(a,b,i,g,v),h=t.Pivot._sliceJson(a,b,r,o,i,v,d.startPos,d.endPos,g,f),"drilldown"==i._drillAction&&(u=t.Pivot._mergeJson(a,i,b,r,o,v,_,f,h,d.startPos,d.endPos,g)),e.map("drilldown"==i._drillAction?u:h,function(e){return e})}return l},_getEnginePos:function(i,l,a){var r=e.map(t.isNullOrUndefined(a[parseInt(i.split(",")[0])])?a[parseInt(l.split(",")[0])]:a[parseInt(i.split(",")[0])],function(e,t){if(e.Index==e.Index.split(",")[0]+","+l.split(",")[1])return t})[0];return{colPos:e.map(a,function(t,i){var a=!1;return e.each(t,function(e,t){t.Index==l&&(a=!0)}),a?i:void 0})[0],rowPos:r}},_mergeJson:function(i,l,a,r,o,n,s,d,h,u,c,p){var m,g,f,_,v,b,C=t.Pivot._getIndices(a,n,l,d,u,c,p),S=C.columnIndices,O=C.rowIndices,y=C.rowSpan,P=C.colSpan,w=t.Pivot._getEnginePos(u,c,d),N=w.colPos,x=w.rowPos,T=[];if("row"==a){if(t.isNullOrUndefined(d[parseInt(u.split(",")[0])+1])){m=parseInt(u.split(",")[0])+1;do{T=e.map(s[m],function(e){if(O.indexOf(parseInt(e.Index.split(",")[1]))>-1)return e.Span="Block",e}),d[m]=T,m++}while(m<P&&!l.model.enableCollapseByDefault)}}else if(parseInt(d[0][parseInt(u.split(",")[1])+1].Index.split(",")[1])!=parseInt(u.split(",")[1])+1)for(b=0;b<s.length;b++){m=parseInt(u.split(",")[1])+1;do{g=s[b][m],S.indexOf(parseInt(g.Index.split(",")[0]))>-1&&(g.Span="Block",d[b].splice(m,0,g)),m++}while(m<y&&!l.model.enableCollapseByDefault)}if("row"==a){for(v=0,b=0;b<d.length;b++)if(!t.isNullOrUndefined(d[b])){f=x,_=0;do{f==x&&d[b].splice(f,1,h[v][_]),f++,_++,d[b].splice(f,0,h[v][_])}while(t.isNullOrUndefined(h[v][_])||parseInt(h[v][_].Index.split(",")[1])<parseInt(c.split(",")[1]));v++}}else for(v=h.length-1,b=N;b>=o;b--)t.isNullOrUndefined(h[v])||d.splice(b,1,h[v]),v--;return t.Pivot._drillSpanCalculation(d,l)},_getIndices:function(i,l,a,r,o,n,s){var d,h=e.map(r,function(e){if(!t.isNullOrUndefined(e))return parseInt(e[0].Index.split(",")[0])}),u=e.map(r[0],function(e){if(!t.isNullOrUndefined(e))return parseInt(e.Index.split(",")[1])});if(a.model.enableCollapseByDefault)"row"==i?h.push(parseInt(o.split(",")[0])+1):u.push(parseInt(o.split(",")[1])+1);else{var c=l[parseInt(n.split(",")[0])*s+parseInt(n.split(",")[1])],p=parseInt(c.Index.split(",")[0]),m=parseInt(c.Index.split(",")[1]),g=c.ColSpan,f=c.RowSpan;if("row"==i)for(d=p+1;d<g;d++)-1==h.indexOf(d)&&h.push(d);else for(d=m+1;d<f;d++)-1==u.indexOf(d)&&u.push(d)}return{columnIndices:h,rowIndices:u,colSpan:g,rowSpan:f}},_sliceJson:function(i,l,a,r,o,n,s,d,h,u){var c,p,m,g,f,_,v,b,C,S,O,y,P=[],w=i.values.length>0&&"rows"!=i.values[0].axis?1:0;if("drilldown"==o._drillAction){var N="row"==l?"0,"+parseInt(s.split(",")[1]):parseInt(s.split(",")[0])+",0",x="row"==l?"0,"+parseInt(d.split(",")[1]):parseInt(d.split(",")[0])+",0",T=t.Pivot._getIndices(l,n,o,u,s,d,h),M=T.columnIndices,L=T.rowIndices,D=parseInt(N.split(",")[0])*h+h,I=0;N="row"==l?N:parseInt(N.split(",")[0])*h+",0";do{for(c="row"==l?parseInt(N.split(",")[1]):parseInt(N.split(",")[0]),I="row"==l?0:I;!t.isNullOrUndefined(n[c])&&("column"!=l||D>c);)("row"==l?M.indexOf(parseInt(n[c].Index.split(",")[0]))>-1:L.indexOf(parseInt(n[c].Index.split(",")[1]))>-1)&&(t.isNullOrUndefined(P[I])&&(P[I]=[]),P[I].push(n[c]),"row"==l&&I++),c+="row"==l?h:1;"column"==l&&(D+=h,I++),N="row"==l?"0,"+(parseInt(N.split(",")[1])+1):parseInt(N.split(",")[0])+h+",0"}while(N!=("row"==l?"0,"+(parseInt(x.split(",")[1])+1):(parseInt(x.split(",")[0])+1)*h+",0"));if(("row"==l?r-1>parseInt(o._drillParams.currPos.split(",")[0])+1:a-w-1>parseInt(o._drillParams.currPos.split(",")[1])+1)&&o.model.enableCollapseByDefault){k="row"==l?0:parseInt(o._drillParams.currPos.split(",")[1])+1,j="row"==l?parseInt(o._drillParams.currPos.split(",")[0])+1:0;do{if(p=!1,!(t.isNullOrUndefined(P[j])||t.isNullOrUndefined(P[j][k])||-1!=P["row"==l?j-1:j]["row"==l?k:k-1].CSS.indexOf("summary")||"rowheader"!=P[j][k].CSS&&"colheader"!=P[j][k].CSS&&"none"!=P[j][k].CSS&&""!=P[j][k].Value))if("row"==l)for(y=0;y<P.length;y++)t.isNullOrUndefined(P[y])||(P[y].splice(k,1),p=!0);else delete P[j],p=!0;"row"==l?k=p?k:k+1:j+=1}while("row"==l?k<P[0].length:j<P.length)}var j=parseInt(o._drillParams.currPos.split(",")[0])+("row"==l?1:0),F="",R=0,E=0,k=parseInt(o._drillParams.currPos.split(",")[1])+1;if(o.model.enableCollapseByDefault)do{if("row"==l?j==parseInt(o._drillParams.currPos.split(",")[0])+1:k==parseInt(o._drillParams.currPos.split(",")[1])+1){for(y="row"==l?P[j].length-1:P.length-1;y>=0;y--)if(("column"!=l||!t.isNullOrUndefined(P[y]))&&(b="row"==l?P[j][y]:P[y][k]).CSS.indexOf("summary")>-1){b.State=2,b.Expander=1;var A=j,H=k,U=0;if("row"==l){do{U++,A++}while(!t.isNullOrUndefined(u[A])&&("none"==u[A][0].CSS||""==u[A][0].Value));b.ColSpan=U}else{do{U++,H++}while(!t.isNullOrUndefined(u[0][H])&&("none"==u[0][H].CSS||""==u[0][H].Value));b.RowSpan=U}b.Value=b.Value.replace(" Total","")}}else for(m="","column"==l&&(m=e.map(P,function(e,i){if(!t.isNullOrUndefined(e))return i})[0]),y="row"==l?P[j].length-1:P.length-1;y>=0;y--)"column"==l&&t.isNullOrUndefined(P[y])||(g=(b="row"==l?P[j][y]:P[y][k]).Value.replace(" Total",""),F=""==F&&""!=b.Value.replace(" Total","")?b.Value.replace(" Total",""):""!=b.Value.replace(" Total","")&&F!=b.Value.replace(" Total","")?b.Value.replace(" Total",""):F,""!=g&&g!=F||0==y||m==y?(b.CSS="row"==l?"rowheader":"colheader",b.State=1,b.Expander=1,b.Value=F,"row"==l?b.RowSpan=j>parseInt(o._drillParams.currPos.split(",")[0])-1?R:b.RowSpan:b.ColSpan=k>parseInt(o._drillParams.currPos.split(",")[1])-1?E:b.ColSpan,R=1,E=1):(b.CSS.indexOf("summary")>-1&&("row"==l?b.ColSpan=parseInt(o._drillParams.currPos.split(",")[0])+2-j:b.RowSpan=parseInt(o._drillParams.currPos.split(",")[1])+2-k),R++,E++));"row"==l?j--:k--}while("row"==l?j>=0:k>=0)}else{var z=t.Pivot._getEnginePos(s,d,u);j=z.colPos,k=z.rowPos;if("row"==l){for(f=0,e.each(u[0],function(e,t){if(parseInt(t.Index.split(",")[1])==parseInt(s.split(",")[1]))return f=e,!1}),y=parseInt(s.split(",")[1]);y<parseInt(d.split(",")[1]);y++)for(_=0;_<u.length;_++)if(!t.isNullOrUndefined(u[_])){for(v="",b="",H=f;H<u[_].length;H++)if(parseInt(u[_][H].Index.split(",")[1])==y){b=u[_][H],v=H,u[_].splice(H,1);break}t.isNullOrUndefined(u[_][v])||"none"!=u[_][v].CSS&&""!=u[_][v].Value&&("rowheader"!=u[_][v].CSS||0!=u[_][v].Expander)||"rowheader"!=b.CSS||(u[_][v].CSS="rowheader",u[_][v].Value=b.Value,u[_][v].State=b.State,u[_][v].Expander=b.Expander)}}else for(C=[],y=parseInt(s.split(",")[0]);y<parseInt(d.split(",")[0]);y++)if(C=0!=C.length||t.isNullOrUndefined(u[y])?C:u[y],delete u[y],parseInt(d.split(",")[0])-y==1){S=0;do{("none"==u[y+1][S].CSS||""==u[y+1][S].Value||"colheader"==u[y+1][S].CSS&&0==u[y+1][S].Expander)&&(u[y+1][S].CSS=C[S].CSS,u[y+1][S].Value=C[S].Value,u[y+1][S].State=C[S].State,u[y+1][S].Expander=C[S].Expander),S++}while(S<=parseInt(d.split(",")[1]))}if(0==(O="row"==l?e.map(u[parseInt(d.split(",")[0])+1],function(e){if("rowheader"==e.CSS||e.CSS.indexOf("summary")>-1)return e}).length:e.map(u,function(e){if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(e[k+1])&&("colheader"==e[k+1].CSS||e[k+1].CSS.indexOf("summary")>-1))return e}).length))if("row"==l){j=parseInt(d.split(",")[0])+1;do{delete u[j],j++}while(!t.isNullOrUndefined(u[j])&&("none"==u[j][0].CSS||""==u[j][0].Value))}else{k=parseInt(d.split(",")[1])+1;do{for(y=0;y<u.length;y++)t.isNullOrUndefined(u[y])||(u[y]=e.map(u[y],function(e){if(parseInt(e.Index.split(",")[1])!=k)return e}));k++}while(k<u[0][0].RowSpan-(i.values.length>0&&"rows"!=i.values[0].axis?1:0))}if(j=(z=t.Pivot._getEnginePos(s,d,u)).colPos,k=z.rowPos,"row"==l){for(y=0;y<u[parseInt(d.split(",")[0])].length;y++)if(u[parseInt(d.split(",")[0])][y].Index==d){u[parseInt(d.split(",")[0])][y].Value=u[parseInt(d.split(",")[0])][y].Value.replace(" Total",""),u[parseInt(d.split(",")[0])][y].State=2,u[parseInt(d.split(",")[0])][y].ColSpan=0==O?u[parseInt(d.split(",")[0])][y].ColSpan-1:u[parseInt(d.split(",")[0])][y].ColSpan;break}}else u[j][k].Value=u[j][k].Value.replace(" Total",""),u[j][k].State=2,u[j][k].RowSpan=0==O?u[j][k].RowSpan-1:u[j][k].RowSpan;P=t.Pivot._drillSpanCalculation(u,o)}return P},_getDrillRange:function(i,l,a,r,o){var n,s,d=0,h=0,u="",c="",p=r,m="row"==l?a._drillParams.currRow.split(">#>"):a._drillParams.currCol.split(">#>");do{if((n="row"==l?parseInt((d-1)/r):h)+1==m.length){if((!("none"!=o[d].CSS&&""!=o[d].Value||t.isNullOrUndefined(o["row"==l?d-r:d-1])||"string"!=typeof o["row"==l?d-r:d-1].Value||o["row"==l?d-r:d-1].Value.replace(" Total","")!=e.trim(m[n<1?0:n-1]))||"string"==typeof o[d].Value&&""!=o[d].Value&&o[d].Value.replace(" Total","")!=e.trim(m[n]))&&""!=u){for(s="row"==l?d-1:d-r;!t.isNullOrUndefined(o[s])&&"summary rstot"!=o[s].CSS&&"summary cstot"!=o[s].CSS&&"summary stot"!=o[s].CSS;)s="row"==l?s-1:s-r;t.isNullOrUndefined(o[s])||(c=o[s].Index);break}"string"==typeof o[d].Value&&o[d].Value.replace(" Total","")==e.trim(m[n])&&(u=""==u?o[d].Index:u)}else o[d].Value.replace(" Total","")==e.trim(m[n])&&(d="row"==l?p*(n+1)+(d-1):d-p+1);h=(d="row"==l?d+1:d+r)%r,"column"==l&&d>o.length&&(d=++h)}while(o.length>d&&""==c);return"drillup"==a._drillAction&&a.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&("column"==l&&i.values.length>0&&"row"!=i.values[0].axis?c=parseInt(c.split(",")[0])-(i.values.length-1)+","+c.split(",")[1]:"row"==l&&i.values.length>0&&"row"==i.values[0].axis&&(c=c.split(",")[0]+","+(parseInt(c.split(",")[1])-(i.values.length-1)))),{startPos:u,endPos:c}},_drillSpanCalculation:function(i,l){for(var a,r,o,n,s,d=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotCalculations:l.getOlapReport().values,h=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotColumns:l.getOlapReport().columns,u=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotRows:l.getOlapReport().rows,c=[],p=[],m=e.map(i,function(e){if(!t.isNullOrUndefined(e))return e[0]}).length,g=0;g<i[0].length;g++){for(P=0,a=0,s=0;s<i.length;s++)t.isNullOrUndefined(i[s])||t.isNullOrUndefined(i[s][g])||(P++,i[s][g].ColSpan>m-P+1&&(i[s][g].ColSpan=m-P+1),"none"!=i[s][g].CSS&&""!=i[s][g].Value&&a++);0==a&&c.push(g)}for(g=0;g<i.length;g++)t.isNullOrUndefined(i[g])||(r=e.map(i[g],function(e,t){if(-1==c.indexOf(t))return e.RowSpan>=i[g].length-t&&(e.RowSpan=i[g].length-t),"summary value"==e.CSS&&(e.RowSpan=1,e.ColSpan=1),e}),p[g]=r);i=p;var f=h.length+(d.length>0&&"rows"!=d[0].axis?d.length:0),_=u.length+(d.length>0&&"rows"==d[0].axis?d.length:0),v=-1;do{v++}while(!(t.isNullOrUndefined(i[0])||t.isNullOrUndefined(i[0][v])||"none"!=i[0][v].CSS&&""!=i[0][v].Value));i[0][0].RowSpan=v>f?f:v,v=d.length>0&&"rows"!=d[0].axis?v-1:v,o=-1,n=0;do{o++}while(!t.isNullOrUndefined(i[o])&&("none"==i[o][0].CSS||""==i[o][0].Value));for(i[0][0].ColSpan=o>_?_:o,g=0;g<i[0].length;g++)for(P=d.length>0&&"rows"==d[0].axis?1:0,s=0;s<i[0][0].ColSpan;s++)t.isNullOrUndefined(i[s][g])||(P++,(0!=g||0!=s)&&i[s][g].ColSpan>i[0][0].ColSpan-P+1&&i[0][0].ColSpan-P+1>0&&(i[s][g].ColSpan=i[0][0].ColSpan-P+1));for(g=i[0][0].ColSpan-1;g<i.length;g++)if(P=d.length>0&&"rows"!=d[0].axis?1:0,!t.isNullOrUndefined(i[g]))for(s=0;s<i[0][0].RowSpan;s++)P++,(0!=g||0!=s)&&i[g][s].RowSpan>i[0][0].RowSpan-P+1&&i[0][0].RowSpan-P+1>0&&(i[g][s].RowSpan=i[0][0].RowSpan-P+1);if(!t.isNullOrUndefined(u)&&u.length>1){o=d.length>0&&"rows"==d[0].axis?o-1:o;do{i[n]=e.map(i[n],function(e){return e.CSS.indexOf("summary")>-1&&(e.ColSpan=o-n),e});var b=0,C=!1,S="";for(g=i[n].length-1;g>=i[0][0].RowSpan;g--)"summary rstot"==i[n][g].CSS||"summary stot"==i[n][g].CSS?(t.isNullOrUndefined(i[n][g+1])||"rowheader"!=i[n][g+1].CSS||(i[n][g+1].RowSpan=b),b=0,C=!0,S=""):i[0][0].RowSpan-g==0?i[n][g].RowSpan=C||S==i[n][g].Value?b+1:i[n][g].RowSpan:(S=i[n][g].Value,b++);n++}while(o>n+(d.length>0&&"rows"==d[0].axis?1:0))}if(!t.isNullOrUndefined(h)&&h.length>1){n=0;do{for(g=0;g<i.length;g++)!t.isNullOrUndefined(i[g])&&i[g][n].CSS.indexOf("summary")>-1&&(i[g][n].RowSpan=v-n);var O=0,y=(C=!1,""),P=(S="",e.grep(i,function(e,i){if(!t.isNullOrUndefined(e)&&"none"!=e[0].CSS&&""!=e[0].Value)return y=""==y?i:y,e}).length);for(g=i.length-1;g>=y;g--)P-=t.isNullOrUndefined(i[g])||"none"==i[g][0].CSS||""==i[g][0].Value?0:1,t.isNullOrUndefined(i[g])||"summary cstot"!=i[g][n].CSS&&"summary stot"!=i[g][n].CSS?0!=P||t.isNullOrUndefined(i[g])?t.isNullOrUndefined(i[g])||(S=i[g][n].Value,O++):i[g][n].ColSpan=C||S==i[g][n].Value?O+1:i[g][n].ColSpan:(t.isNullOrUndefined(i[g+1])||t.isNullOrUndefined(i[g+1][n])||"rowheader"!=i[g+1][n].CSS&&"colheader"!=i[g+1][n].CSS||(i[g+1][n].ColSpan=O),O=0,C=!0,S="");n++}while(v>n+(d.length>0&&"rows"!=d[0].axis?1:0))}return i},_calculatePagingSpan:function(i,l){var a,r;if(null!=i&&""!=i&&i.length>0){for(l._rowCount=0,a=jQuery.extend(!0,[],i),l._compJson=""==l._drillAction?jQuery.extend(!0,[],a):l._compJson,l._croppedJson=t.Pivot._cropJson(l,a),a=e.extend(!0,[],l._croppedJson),r=0;r<a.length&&0==parseInt(a[r].Index.split(",")[0]);r++)l._rowCount++;var o=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotRows.length:l.getOlapReport().rows.length,n=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotColumns.length:l.getOlapReport().columns.length,s=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotCalculations.length:l.getOlapReport().values.length;a.length,l._rowCount;for(r=(0==a[0].RowSpan?0:a[0].RowSpan-1)+l.model.dataSource.pagerOptions.seriesPageSize;r<a.length&&r<l._rowCount;r+=l.model.dataSource.pagerOptions.seriesPageSize){if(a[r].CSS.indexOf("summary")>-1||a[r].CSS.indexOf("rowheader")>-1&&0==a[r].Expander&&null!=a[r+l._rowCount]&&a[r+l._rowCount].CSS.indexOf("value")>-1)continue;o>1&&t.Pivot._calculateRowPagingSpan(r,a,1,o,l)}for(r=((0==a[0].ColSpan?0:a[0].ColSpan-1)+l.model.dataSource.pagerOptions.categoricalPageSize)*l._rowCount;r<a.length;r+=l.model.dataSource.pagerOptions.categoricalPageSize*l._rowCount){if(a[r].CSS.indexOf("summary")>-1&&s<=1)continue;if(1==l.model.dataSource.pagerOptions.categoricalPageSize&&(a[r].CSS.indexOf("stot")>-1&&null!=a[r+l._rowCount]&&a[r+l._rowCount].CSS.indexOf("gtot")>-1||a[r].CSS.indexOf("gtot")>-1&&null==a[r+l._rowCount]))continue;t.Pivot._calculateColumnPagingSpan(r,a,1,n,s,l)}l._relPagingRecords=jQuery.extend(!0,[],a),l._rowCount=0}},_generatePagingRecords:function(i){var l,a,r,o,n;if(null!=i._relPagingRecords&&i._relPagingRecords.length>0){for(l=e.extend(!0,[],i._relPagingRecords),i._rowCount=0,m=0;m<l.length&&0==parseInt(l[m].Index.split(",")[0]);m++)i._rowCount++;var s=l.length/i._rowCount,d=0==l[0].RowSpan?0:l[0].RowSpan-1,h=0==l[0].ColSpan?0:l[0].ColSpan-1,u=Math.ceil((s-(h+1))/i.model.dataSource.pagerOptions.categoricalPageSize),c=Math.ceil((i._rowCount-(d+1))/i.model.dataSource.pagerOptions.seriesPageSize);i.model.dataSource.pagerOptions.categoricalCurrentPage=i.model.dataSource.pagerOptions.categoricalCurrentPage>u?u:i.model.dataSource.pagerOptions.categoricalCurrentPage,i.model.dataSource.pagerOptions.seriesCurrentPage=i.model.dataSource.pagerOptions.seriesCurrentPage>c?c:i.model.dataSource.pagerOptions.seriesCurrentPage,i._seriesPageCount=i.model.enablePaging?i._rowCount-(d+1):c,i._categPageCount=i.model.enablePaging?s-(h+1):u,i._categCurrentPage=i.model.dataSource.pagerOptions.categoricalCurrentPage,i._seriesCurrentPage=i.model.dataSource.pagerOptions.seriesCurrentPage;var p,m,g,f,_,v,b,C,S,O,y=[],P=d+1+i.model.dataSource.pagerOptions.seriesPageSize,w=h+1+i.model.dataSource.pagerOptions.categoricalPageSize;for(p=m=g=f=_=v=b=C=S=O=0,o=0;o<d+1;o++){for(n=0;n<h+1;n++)null!=l[m]&&(y[f]=l[m],m+=i._rowCount,f+=P);m=++p,f=++g}for(_=m=d+(0==i.model.dataSource.pagerOptions.seriesCurrentPage||1==i.model.dataSource.pagerOptions.seriesCurrentPage?0:(i.model.dataSource.pagerOptions.seriesCurrentPage-1)*i.model.dataSource.pagerOptions.seriesPageSize)+1,v=f=d+1,o=0;o<i.model.dataSource.pagerOptions.seriesPageSize;o++){for(n=0;n<h+1;n++)null!=l[m]&&(y[f]=l[m],m+=i._rowCount,f+=P);if(f=++v,(m=++_)>i._rowCount-1)break}for(b=m=(h+1)*i._rowCount+(0==i.model.dataSource.pagerOptions.categoricalCurrentPage||1==i.model.dataSource.pagerOptions.categoricalCurrentPage?0:(i.model.dataSource.pagerOptions.categoricalCurrentPage-1)*i.model.dataSource.pagerOptions.categoricalPageSize*i._rowCount),C=f=(h+1)*P,o=0;o<d+1;o++){for(n=0;n<i.model.dataSource.pagerOptions.categoricalPageSize;n++)null!=l[m]&&(y[f]=l[m],m+=i._rowCount,f+=P);if(f=++C,null==l[m=++b])break}for(S=m=(h+1)*i._rowCount+(0==i.model.dataSource.pagerOptions.categoricalCurrentPage||1==i.model.dataSource.pagerOptions.categoricalCurrentPage?0:(i.model.dataSource.pagerOptions.categoricalCurrentPage-1)*i.model.dataSource.pagerOptions.categoricalPageSize*i._rowCount)+d+(0==i.model.dataSource.pagerOptions.seriesCurrentPage||1==i.model.dataSource.pagerOptions.seriesCurrentPage?0:(i.model.dataSource.pagerOptions.seriesCurrentPage-1)*i.model.dataSource.pagerOptions.seriesPageSize)+1,O=f=(h+1)*P+d+1,a=0,o=0;o<i.model.dataSource.pagerOptions.seriesPageSize;o++){for(n=0;n<i.model.dataSource.pagerOptions.categoricalPageSize;n++)null!=l[m]&&(y[f]=l[m],a=parseInt(l[m].Index.split(",")[1]),m+=i._rowCount,f+=P);if(f=++O,null==l[m=++S]||a>parseInt(l[m].Index.split(",")[1]))break}for(i._rowCount=0,y=y.filter(function(e){return null!=e}),P=0,m=0;m<y.length&&0==parseInt(y[m].Index.split(",")[0]);m++)P++;for(w=y.length/P,o=0;o<w;o++)for(n=0;n<P;n++)t.isNullOrUndefined(y[o*P+n])||(y[o*P+n].Index=o+","+n);for(r=t.Pivot._drillSpanCalculation(t.Pivot._jsonToEngine(y),i),o=0;o<r.length;o++)for(n=0;n<r[o].length;n++)r[o][n].Index=o+","+n;return e.map(r,function(e){return e})}},_calculateRowPagingSpan:function(e,i,l,a,r){var o,n;if(i[e].CSS.indexOf("summary")>-1||i[e].CSS.indexOf("rowheader")>-1&&0==i[e].Expander&&l<a&&null!=i[e+r._rowCount]&&i[e+r._rowCount].CSS.indexOf("value")>-1)return!1;if(1==i[e].Expander&&i[e].RowSpan>1)i[e+1].RowSpan=i[e].RowSpan-1,i[e].RowSpan=1,i[e+1].Expander=i[e].Expander,i[e+1].State=i[e].State,i[e+1].Value=i[e].Value,i[e+1].CSS=i[e].CSS,-1==i[e+r._rowCount].CSS.indexOf("value")&&l<a-1&&t.Pivot._calculateRowPagingSpan(e+r._rowCount,i,l+1,a,r);else if(0==i[e].Expander&&null!=i[e+r._rowCount]&&l<a&&-1==i[e+r._rowCount].CSS.indexOf("value"))for(o=1,n=e-1;n>=0;n--)if(o++,1==i[n].Expander){i[n].RowSpan!=o&&(i[e+1].RowSpan=i[n].RowSpan-o,i[n].RowSpan=o,i[e+1].Expander=i[n].Expander,i[e+1].State=i[n].State,i[e+1].Value=i[n].Value,i[e+1].CSS=i[n].CSS,-1==i[e+r._rowCount].CSS.indexOf("value")&&l<a-1&&t.Pivot._calculateRowPagingSpan(e+r._rowCount,i,l+1,a,r));break}},_calculateColumnPagingSpan:function(e,i,l,a,r,o){var n,s;if(i[e].CSS.indexOf("summary")>-1&&r<=1)return!1;if(null!=i[e+o._rowCount]&&(1==i[e].Expander&&i[e].ColSpan>1||i[e].CSS.indexOf("summary")>-1&&i[e].ColSpan>1||l==a&&r>1&&i[e].ColSpan>1))i[e+o._rowCount].ColSpan=i[e].ColSpan-1,i[e].ColSpan=1,i[e+o._rowCount].Expander=i[e].Expander,i[e+o._rowCount].RowSpan=i[e].RowSpan,i[e+o._rowCount].State=i[e].State,i[e+o._rowCount].Value=i[e].Value,i[e+o._rowCount].CSS=i[e].CSS,l<a&&-1==i[e].CSS.indexOf("summary")&&t.Pivot._calculateColumnPagingSpan(e+1,i,l+1,a,r,o);else if(0==i[e].Expander&&null!=i[e+o._rowCount]&&1!=i[e+o._rowCount].Expander)for(n=1,s=e-o._rowCount;s>=0;s-=o._rowCount)if(n++,1==i[s].Expander||i[s].CSS.indexOf("summary")>-1&&i[s].ColSpan>1||l==a&&r>1&&i[s].ColSpan>1){i[s].ColSpan!=n&&(i[e+o._rowCount].ColSpan=i[s].ColSpan-n,i[s].ColSpan=n,i[e+o._rowCount].RowSpan=i[s].RowSpan,i[e+o._rowCount].Expander=i[s].Expander,i[e+o._rowCount].State=i[s].State,i[e+o._rowCount].Value=i[s].Value,i[e+o._rowCount].CSS=i[s].CSS,l<a&&-1==i[s].CSS.indexOf("summary")&&t.Pivot._calculateColumnPagingSpan(e+1,i,l+1,a,r,o));break}},createAdvanceFilterTag:function(i,l){var a,r,o,n,s,d,h,u,c,p,m="",g=(t.buildTag("li.e-separator").css("margin-left","29px")[0].outerHTML,l.element.hasClass("e-pivotschemadesigner")?l.model.pivotControl.model.operationalMode:l.model.operationalMode),f=l.element.hasClass("e-pivotschemadesigner")?l.model.pivotControl.model.analysisMode:l.model.analysisMode;if("filterTag"==i.action)m=[{id:"ascOrder",text:l._getLocalizedLabels("SortAtoZ"),parentId:null,spriteCssClass:"e-ascImage e-icon"},{id:"descOrder",text:l._getLocalizedLabels("SortZtoA"),parentId:null,spriteCssClass:"e-descImage e-icon"},{id:"clearSorting",text:l._getLocalizedLabels("ClearSorting"),parentId:null,spriteCssClass:"e-clrSort e-icon"},{id:"sep1",parentId:null,text:"",spriteCssClass:"e-seperator"},{id:"clearAllFilters",text:l._getLocalizedLabels("ClearFilterFrom"),parentId:null,spriteCssClass:"e-clrFilter e-icon"},{id:"labelFilterBtn",text:l._getLocalizedLabels("LabelFilters"),parentId:null},{id:"valueFilterBtn",text:l._getLocalizedLabels("ValueFilters"),parentId:null},{id:"labelClearFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("ClearFilter"),spriteCssClass:"e-clrFilter e-icon"},{id:"sep2",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"equals_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("Equals"),spriteCssClass:"sprite"},{id:"notequals_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotEquals")+"...",spriteCssClass:"sprite"},{id:"sep3",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"beginswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("BeginsWith")+"...",spriteCssClass:"sprite"},{id:"notbeginswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotBeginsWith")+"...",spriteCssClass:"sprite"},{id:"endswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("EndsWith")+"...",spriteCssClass:"sprite"},{id:"notendswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotEndsWith")+"...",spriteCssClass:"sprite"},{id:"sep4",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"contains",parentId:"labelFilterBtn",text:l._getLocalizedLabels("Contains")+"...",spriteCssClass:"sprite"},{id:"notcontains",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotContains")+"...",spriteCssClass:"sprite"},{id:"sep5",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"greaterthan_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("GreaterThan")+"...",spriteCssClass:"sprite"},{id:"greaterthanorequalto_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("GreaterThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"lessthan_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("LessThan")+"...",spriteCssClass:"sprite"},{id:"lessthanorequalto_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("LessThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"valueClearFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("ClearFilter"),spriteCssClass:"e-clrFilter e-icon"},{id:"sep6",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"equals_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("Equals"),spriteCssClass:"equals"},{id:"notequals_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("DoesNotEquals")+"...",spriteCssClass:"sprite"},{id:"sep7",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"greaterthan_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("GreaterThan")+"...",spriteCssClass:"sprite"},{id:"greaterthanorequalto_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("GreaterThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"lessthan_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("LessThan")+"...",spriteCssClass:"sprite"},{id:"lessthanorequalto_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("LessThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"sep8",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"between",parentId:"valueFilterBtn",text:l._getLocalizedLabels("Between")+"...",spriteCssClass:"sprite"},{id:"notbetween",parentId:"valueFilterBtn",text:l._getLocalizedLabels("NotBetween")+"...",spriteCssClass:"sprite"},{id:"topCount",parentId:"valueFilterBtn",text:l._getLocalizedLabels("Top10")+"...",spriteCssClass:"sprite"}],(g==t.Pivot.OperationalMode.ClientMode||g==t.Pivot.OperationalMode.ServerMode&&f==t.Pivot.AnalysisMode.Pivot)&&m.splice(m.length-1,2);else if("clearFilter"==i.action)m=t.buildTag("div.clearSorting",t.buildTag("span.e-clrSort","",{padding:"0px 10px 0px 4px"}).addClass("e-icon").attr("aria-label","clear sort")[0].outerHTML+t.buildTag("span.clearSortText","Clear Sorting",{padding:"5px 0px"})[0].outerHTML)[0].outerHTML+t.buildTag("div.separator",{padding:"5px 0px"})[0].outerHTML+t.buildTag("div.clearAllFilters",t.buildTag("span.e-clrFilter","",{padding:"0px 10px 0px 4px"}).addClass("e-icon").attr("aria-label"," clear filter")[0].outerHTML+t.buildTag("span.clearFltrText",'Clear Filter From"'+i.selectedLevel.text+'"',{padding:"5px 0px"})[0].outerHTML)[0].outerHTML;else if("sort"==i.action)m=t.buildTag("div#sortDiv.sortDiv",t.buildTag("li#ascOrder.e-ascOrder",t.buildTag("span.e-ascImage").addClass("e-icon").attr("aria-label","ascending")[0].outerHTML+l._getLocalizedLabels("Sort")+" A to Z")[0].outerHTML+t.buildTag("li#descOrder.e-descOrder",t.buildTag("span.e-descImage").addClass("e-icon").attr("aria-label","descending")[0].outerHTML+l._getLocalizedLabels("Sort")+" Z to A")[0].outerHTML)[0].outerHTML;else if("labelFilterDlg"==i.action||"valueFilterDlg"==i.action){if(a="",r=[],"labelFilterDlg"==i.action)a=t.buildTag("table.labelfilter",t.buildTag("tr",t.buildTag("td",l._getLocalizedLabels("LabelFilterLabel")).attr("colspan","2")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'  style='width:220px'/>")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1'  value='"+(i.filterInfo.length>0?g==t.Pivot.OperationalMode.ClientMode?i.filterInfo[0].values[0]:i.filterInfo[0].value1:"")+"' style='display:inline; width:160px; height:19px; margin-left:7px;' class='e-filterValues'/></br>")[0].outerHTML)[0].outerHTML)[0].outerHTML,r=[{value:"equals",option:l._getLocalizedLabels("Equals").toLowerCase()},{value:"not equals",option:l._getLocalizedLabels("DoesNotEquals").toLowerCase()},{value:"begins with",option:l._getLocalizedLabels("BeginsWith").toLowerCase()},{value:"not begins with",option:l._getLocalizedLabels("DoesNotBeginsWith").toLowerCase()},{value:"ends with",option:l._getLocalizedLabels("EndsWith").toLowerCase()},{value:"not ends with",option:l._getLocalizedLabels("DoesNotEndsWith").toLowerCase()},{value:"contains",option:l._getLocalizedLabels("Contains").toLowerCase()},{value:"not contains",option:l._getLocalizedLabels("DoesNotContains").toLowerCase()},{value:"greater than",option:l._getLocalizedLabels("IsGreaterThan").toLowerCase()},{value:"greater than or equal to",option:l._getLocalizedLabels("IsGreaterThanOrEqualTo").toLowerCase()},{value:"less than",option:l._getLocalizedLabels("IsLessThan").toLowerCase()},{value:"less than or equal to",option:l._getLocalizedLabels("IsLessThanOrEqualTo").toLowerCase()}];else{if(o=[],s="between"==e(i.selectedArgs.element).attr("id")||"notbetween"==e(i.selectedArgs.element).attr("id")||"between"==i.selectedArgs.value||"not between"==i.selectedArgs.value?"4":"3",l.element.find(".e-cubeTreeView ").length>0)o=e.map(l.element.find(".e-cubeTreeView [data-tag*='[Measures]'] "),function(t){return{option:e(t).text(),value:e(t).attr("data-tag")}});else for(d=l.element.hasClass("e-pivotschemadesigner")?l.element.find(".e-schemaValue .e-pivotButton"):l.element.find(".groupingBarPivot .values .e-pivotButton"),d=l._schemaData&&0==d.length?e(l._schemaData.element.find(".e-schemaValue .e-pivotButton")):d,h=0;h<d.length;h++)o.push({option:e(d[h]).text(),value:e(d[h]).attr("data-tag").split(":")[1]});n=e(i.selectedArgs.element).hasClass("topCount")?t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions' />").attr("width","80px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterValue1' class='e-filterValues' />").attr("width","50px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML:t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'/>").attr("width","180px")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1' value='"+(i.filterInfo.length>0?g==t.Pivot.OperationalMode.ClientMode?i.filterInfo[0].values[0]:i.filterInfo[0].value1:"")+"' style='display:inline; width:190px; height:19px;' class='e-filterValues'/>"+("4"==s?"<span>"+l._getLocalizedLabels("and")+" </span><input type='text' id='filterValue2' value='"+(i.filterInfo.length>0?g!=t.Pivot.OperationalMode.ClientMode||t.isNullOrUndefined(i.filterInfo[0].values[1])?g!=t.Pivot.OperationalMode.ServerMode||t.isNullOrUndefined(i.filterInfo[0].value2)?"":i.filterInfo[0].value2:i.filterInfo[0].values[1]:"")+"' style='display:inline; width:190px; height:19px;' class='e-filterValues'/> </br>":"</br>"))[0].outerHTML,a=t.buildTag("table.valuefilter",t.buildTag("tr",t.buildTag("td",l._getLocalizedLabels("ValueFilterLabel")).attr("colspan","Between"==i.text?"4":"3")[0].outerHTML)[0].outerHTML+t.buildTag("tr",n)[0].outerHTML)[0].outerHTML,r=[{value:"equals",option:l._getLocalizedLabels("Equals").toLowerCase()},{value:"not equals",option:l._getLocalizedLabels("DoesNotEquals").toLowerCase()},{value:"greater than",option:l._getLocalizedLabels("IsGreaterThan").toLowerCase()},{value:"greater than or equal to",option:l._getLocalizedLabels("IsGreaterThanOrEqualTo").toLowerCase()},{value:"less than",option:l._getLocalizedLabels("IsLessThan").toLowerCase()},{value:"less than or equal to",option:l._getLocalizedLabels("IsLessThanOrEqualTo").toLowerCase()},{value:"between",option:l._getLocalizedLabels("Between").toLowerCase()},{value:"not between",option:l._getLocalizedLabels("NotBetween").toLowerCase()}]}u=t.buildTag("div",t.buildTag("button#filterDlgOKBtn.e-dialogOKBtn",l._getLocalizedLabels("OK")).attr("title",l._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML+t.buildTag("button#filterDlgCancelBtn.e-dialogCancelBtn",l._getLocalizedLabels("Cancel")).attr("title",l._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,{float:l.model.enableRTL?"left":"right",margin:"8px 0 6px"})[0].outerHTML,l.element.find(".e-dialog").remove(),e(t.buildTag("div#filterDialog.filterDialog",a+u,{opacity:"1"})).appendTo("#"+l._id),l.element.find(".filterDialog").ejDialog({enableRTL:l.model.enableRTL,enableResize:!1,cssClass:"e-labelValueFilterDlg",width:"auto",content:"#"+l._id,close:t.proxy(t.Pivot.closePreventPanel,l)}),"valueFilterDlg"==i.action&&(l.element.find(".filterMeasures").ejDropDownList({dataSource:o,width:"180px",height:"25px",fields:{text:"option",value:"value"},create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),l._measureDDL=l.element.find(".filterMeasures").data("ejDropDownList"),""!=(c=i.filterInfo.length>0&&!t.isNullOrUndefined(i.filterInfo[0].measure)?i.filterInfo[0].measure:o.length>0?o[0].value:"")&&l._measureDDL.selectItemByValue(c)),"topCount"==e(i.selectedArgs.element).attr("id")?(l.element.find("#filterOptions").ejDropDownList({dataSource:[{option:"Top",value:"topCount"},{option:"Bottom",value:"BottomCount"}],fields:{text:"option",value:"value"},value:i.filterInfo.length>0?i.filterInfo[0].operator:"topCount",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),l.element.find("#filterValue1").ejNumericTextbox({value:i.filterInfo.length>0?parseInt(i.filterInfo[0].value1):5,minValue:1})):(p=e(i.selectedArgs.element).parent().children('li:not([id^="sep"])').index(i.selectedArgs.element),l.element.find(".filterOptions").ejDropDownList({dataSource:r,width:"180px",height:"25px",fields:{value:"value",text:"option"},selectedIndices:[p-1],change:t.proxy(l._filterOptionChanged,l),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),0==e(i.selectedArgs.element).length&&l.element.find(".filterOptions").data("ejDropDownList").selectItemByValue(i.selectedArgs.selectedValue)),l.element.find("#filterDlgOKBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(l._filterElementOkBtnClick,l)}),l.element.find("#filterDlgCancelBtn").ejButton({type:t.ButtonType.Button,click:function(){e(".e-dialog").hide(),t.Pivot.closePreventPanel(l)}}),l.element.find(".e-titlebar").prepend(t.buildTag("div",("valueFilterDlg"==i.action?l._getLocalizedLabels("ValueFilters")+"(":l._getLocalizedLabels("LabelFilters")+"(")+(-1==l._selectedLevelUniqueName.indexOf(".")?l._selectedLevelUniqueName:l._selectedLevelUniqueName.indexOf(".")<0?l._selectedLevelUniqueName:l._selectedLevelUniqueName.split(".")[2].replace(/\[/g,"").replace(/\]/g,""))+")",{display:"inline"}))}return m}},t.Pivot.SortOrder={None:"none",Ascending:"ascending",Descending:"descending"},t.Pivot.AdvancedFilterType={LabelFilter:"label",ValueFilter:"value"},t.Pivot.ValueFilterOptions={None:"none",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.Pivot.LabelFilterOptions={None:"none",BeginsWith:"beginswith",NotBeginsWith:"notbeginswith",EndsWith:"endswith",NotEndsWith:"notendswith",Contains:"contains",NotContains:"notcontains",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.Pivot.AnalysisMode={Olap:"olap",Pivot:"pivot"},t.Pivot.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"}}(jQuery,Syncfusion)})},1011:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
*  filename: ej.pivotanalysis.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotanalysis.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e){__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=e)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(function(){!function($,ej,undefined){ej.PivotAnalysis={_initProperties:function(){this._colkeyvalues=[],this._rowKeyValues=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._gridMatrix=null,this._rowTotCalc=[],this._colTotCalc=[],this._transposeEngine=[],this._tRowCnt=0,this._tColCnt=0,this._cellType="",this._valueFilterArray=ej.isNullOrUndefined(this._valueFilterArray)?[]:this._valueFilterArray,this._currentFilterVal={},this._fieldMembers={},this._summaryTypes=[],this._editCellsInfo=[],this._locale="en-US",this._valueSorting=ej.isNullOrUndefined(this._valueSorting)?null:this._valueSorting,this._sort=ej.isNullOrUndefined(this._sort)?null:this._sort,this._isPaging=!1,this._colHdrLen=1,this._rowHdrLen=1,this._rowMembers={},this._colMembers={},this._calcMembers={}},setFieldCaptions:function(e){$.each(e.rows,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.columns,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.filters,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.values,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)})},getTreeViewData:function(e){var t,i,l,a,r,o,n=[],s=[];if(null!=e.data)for(l=0;l<e.data.length;l++)jQuery.each(e.data[l],function(e){-1==jQuery.inArray(e,n)&&n.push(e)});for(jQuery.each(e.values,function(e,t){1==t.isCalculatedField&&-1==jQuery.inArray(t.fieldName,n)&&n.push(t.fieldName)}),t=[e.rows,e.columns,e.filters,e.values],i=[].concat.apply([],t),l=0;l<n.length;l++){for(a=0;a<i.length;a++)(n[l].caption==undefined||""==n[l].caption)&&i[a].fieldName==n[l]&&(n[l]={name:i[a].fieldName,caption:i[a].fieldCaption,format:i[a].format,formatString:i[a].formatString,showSubTotal:!!ej.isNullOrUndefined(i[a].showSubTotal)||i[a].showSubTotal});(n[l].caption==undefined||""==n[l].caption)&&(n[l]={name:n[l].name||n[l],caption:n[l].name||n[l]})}for(r=0;r<n.length;r++)o=$.grep(e.rows,function(e){return e.fieldName==n[r].name}).length>0||$.grep(e.columns,function(e){return e.fieldName==n[r].name}).length>0||$.grep(e.values,function(e){return e.fieldName==n[r].name}).length>0||$.grep(e.filters,function(e){return e.fieldName==n[r].name}).length>0,s.push({id:n[r].name,name:n[r].name,caption:n[r].caption,format:n[r].format,formatString:n[r].formatString,showSubTotal:!!ej.isNullOrUndefined(n[r].showSubTotal)||n[r].showSubTotal,isSelected:o,spriteCssClass:""});return s},pivotEnginePopulate:function(model){var dataSource=model.dataSource,currentObj=this,isLiteral=!1,rowFilters,lit,formatSt,uV,fields,vC,list,cnt,nC,outputString,rC,cC,isFiltered,cCnt,rCnt,temp,value,val,j,k,formula,oldValue,newValue,i;this._initProperties(),model.dataSource.enableAdvancedFilter&&0==this._valueFilterArray.length&&(this._valueFilterArray=$.grep(dataSource.columns,function(e){if(e.advancedFilter&&e.advancedFilter.length>0&&e.advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter)return e.advancedFilter}),rowFilters=$.grep(dataSource.rows,function(e){if(e.advancedFilter&&e.advancedFilter.length>0&&e.advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter)return e.advancedFilter}),rowFilters.length>0&&$.merge(this._valueFilterArray,rowFilters)),this._locale=model.locale;var colAxis=dataSource.columns,rowAxis=dataSource.rows,filters=dataSource.filters,calcValues=dataSource.values,colLen,jsonObj=[],pivotFieldList=[],rowLen;for(lit=0;dataSource.values.length>lit;lit++)if(formatSt="",dataSource.values[lit].format&&(formatSt=dataSource.values[lit].format.toLowerCase()),"string"==formatSt||"text"==formatSt||"literal"==formatSt){isLiteral=!0;break}if(this._editCellsInfo=[],!ej.isNullOrUndefined(model.editCellsInfo)){var rowHeaders=model.editCellsInfo.rowHeader,colHeaders=model.editCellsInfo.columnHeader,values=model.editCellsInfo.JSONRecords;if(!ej.isNullOrUndefined(values)){for(uV=0;uV<values.length;uV++)fields={},rowAxis.length>0&&(fields.row=rowHeaders[uV].toString().split("#").splice(0,rowAxis.length).join(">#>")),colAxis.length>0&&(fields.column=colHeaders[uV].toString().split("#").splice(0,colAxis.length).join(">#>")),fields.value=colHeaders[uV].toString().split("#")[colHeaders[uV].toString().split("#").length-1]+"#"+values[uV].Value,this._editCellsInfo.push(fields);for(vC=0;vC<calcValues.length;vC++)$.each(this._editCellsInfo,function(e,t){calcValues[vC].fieldName==t.value.split("#")[0]&&(ej.PivotAnalysis._editCellsInfo[e].value=vC+"#"+t.value.split("#")[1])})}}for(i=0;i<calcValues.length;i++)this._summaryTypes.push(null!=calcValues[i].summaryType&&calcValues[i].summaryType!=undefined?calcValues[i].summaryType:ej.PivotAnalysis.SummaryType.Sum);if(null!=dataSource.data)for(cnt=0;cnt<dataSource.data.length;cnt++){list=jQuery.extend(!0,{},dataSource.data[cnt]);var table={keys:[],uniqueName:"",value:null},row={keys:[],uniqueName:"",value:null},col={keys:[],uniqueName:"",value:null},values={keys:[],uniqueName:"",value:null},isExcluded=!1;for(i=0;i<filters.length;i++)if(val=this._getReflectedValue(list,filters[i].fieldName,null,null),this._fieldMembers[filters[i].fieldName]==undefined||null==this._fieldMembers[filters[i].fieldName]?this._fieldMembers[filters[i].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[filters[i].fieldName])&&this._fieldMembers[filters[i].fieldName].push(val),null!=filters[i].filterItems&&filters[i].filterItems!=undefined&&((filters[i].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==filters[i].filterItems.filterType)&&$.inArray(val,filters[i].filterItems.values)>=0||filters[i].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,filters[i].filterItems.values)<0)){isExcluded=!0;break}for(nC=0;nC<calcValues.length;nC++)val="",calcValues[nC]!=undefined&&null!=calcValues[nC]&&(list[calcValues[nC].fieldName]=model.dataSource.isFormattedValues?this._getNumber($(list).prop(calcValues[nC].fieldName),calcValues[nC].formatString):list[calcValues[nC].fieldName],val=this._getReflectedValue(list,calcValues[nC].fieldName,calcValues[nC].format,calcValues[nC].formatString),this._fieldMembers[calcValues[nC].fieldName]==undefined||null==this._fieldMembers[calcValues[nC].fieldName]?this._fieldMembers[calcValues[nC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[calcValues[nC].fieldName])&&this._fieldMembers[calcValues[nC].fieldName].push(val)),outputString=null!=val?val.toString().replace(/([AMPME~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,-.\/? ])+/g,""):"0",outputString=outputString.replace(ej.globalize.preferredCulture(this._locale).numberFormat.currency.symbol,""),$.isNumeric(outputString)||"date"==calcValues[nC].format?values.keys.push(null!=val?val:null):(values.keys.push(1),isLiteral&&(""==values.uniqueName&&(values.uniqueName=[]),ej.isNullOrUndefined(calcValues[nC].format)||"string"!=calcValues[nC].format.toLowerCase()&&"literal"!=calcValues[nC].format.toLowerCase()&&"text"!=calcValues[nC].format.toLowerCase()?values.uniqueName.push(" "):values.uniqueName.push(val)));for(rC=0;rC<rowAxis.length;rC++){if(val="",rowAxis[rC]!=undefined&&null!=rowAxis[rC])if(val=this._getReflectedValue(list,rowAxis[rC].fieldName,ej.isNullOrUndefined(rowAxis[rC].format)?null:rowAxis[rC].format,ej.isNullOrUndefined(rowAxis[rC].format)||ej.isNullOrUndefined(rowAxis[rC].formatString)?null:rowAxis[rC].formatString),this._fieldMembers[rowAxis[rC].fieldName]==undefined||null==this._fieldMembers[rowAxis[rC].fieldName]?this._fieldMembers[rowAxis[rC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[rowAxis[rC].fieldName])&&this._fieldMembers[rowAxis[rC].fieldName].push(val),dataSource.enableAdvancedFilter&&!ej.isNullOrUndefined(rowAxis[rC].advancedFilter)&&rowAxis[rC].advancedFilter.length&&rowAxis[rC].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.LabelFilter){if(isFiltered=this._applyLabelFilter(rowAxis[rC].advancedFilter,val),isFiltered){isExcluded=!0;break}}else if(null!=rowAxis[rC].filterItems&&rowAxis[rC].filterItems!=undefined&&((rowAxis[rC].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==rowAxis[rC].filterItems.filterType)&&$.inArray(val,rowAxis[rC].filterItems.values)>=0||rowAxis[rC].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,rowAxis[rC].filterItems.values)<0)){isExcluded=!0;break}null!=val&&val.toString().replace(/^\s+|\s+$/gm,"")||(val="(blank)"),row.keys.push(val),row.uniqueName+=""==row.uniqueName?val:">#>"+val,table.keys.push(val),table.uniqueName+=""==table.uniqueName?val:">#>"+val}for(cC=0;cC<colAxis.length;cC++){if(val="",colAxis[cC]!=undefined&&null!=colAxis[cC])if(val=this._getReflectedValue(list,colAxis[cC].fieldName,ej.isNullOrUndefined(colAxis[cC].format)?null:colAxis[cC].format,ej.isNullOrUndefined(colAxis[cC].format)||ej.isNullOrUndefined(colAxis[cC].formatString)?null:colAxis[cC].formatString),this._fieldMembers[colAxis[cC].fieldName]==undefined||null==this._fieldMembers[colAxis[cC].fieldName]?this._fieldMembers[colAxis[cC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[colAxis[cC].fieldName])&&this._fieldMembers[colAxis[cC].fieldName].push(val),dataSource.enableAdvancedFilter&&!ej.isNullOrUndefined(colAxis[cC].advancedFilter)&&colAxis[cC].advancedFilter.length&&colAxis[cC].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.LabelFilter){if(isFiltered=this._applyLabelFilter(colAxis[cC].advancedFilter,val),isFiltered){isExcluded=!0;break}}else if(null!=colAxis[cC].filterItems&&colAxis[cC].filterItems!=undefined&&((colAxis[cC].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==colAxis[cC].filterItems.filterType)&&$.inArray(val,colAxis[cC].filterItems.values)>=0||colAxis[cC].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,colAxis[cC].filterItems.values)<0)){isExcluded=!0;break}null!=val&&val.toString().replace(/^\s+|\s+$/gm,"")||(val="(blank)"),col.keys.push(val),col.uniqueName+=""==col.uniqueName?val:">#>"+val,table.keys.push(val),table.uniqueName+=""==table.uniqueName?val:">#>"+val}if(!isExcluded)if(this._isMemberExist("row",row,$.extend(!0,{},values),dataSource),this._isMemberExist("column",col,$.extend(!0,{},values),dataSource),!model.enablePaging&&!model.enableVirtualScrolling||0==row.keys.length&&0==col.keys.length)this._isMemberExist("calc",table,$.extend(!0,{},values),dataSource);else if(row.keys.length>0&&col.keys.length>0)for(rCnt=0;rCnt<row.keys.length;rCnt++)for(cCnt=0;cCnt<col.keys.length;cCnt++)row.keys.length==rCnt+1&&col.keys.length==cCnt+1?this._isMemberExist("calc",{keys:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)),uniqueName:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)),uniqueName:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)).join(">#>"),value:null},$.extend(!0,{},values),dataSource);else if(0==row.keys.length)for(cCnt=0;cCnt<col.keys.length;cCnt++)col.keys.length==cCnt+1?this._isMemberExist("calc",{keys:col.keys.slice(0,cCnt+1),uniqueName:col.keys.slice(0,cCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:col.keys.slice(0,cCnt+1),uniqueName:col.keys.slice(0,cCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource);else for(rCnt=0;rCnt<row.keys.length;rCnt++)row.keys.length==rCnt+1?this._isMemberExist("calc",{keys:row.keys.slice(0,rCnt+1),uniqueName:row.keys.slice(0,rCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:row.keys.slice(0,rCnt+1),uniqueName:row.keys.slice(0,rCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource)}for(i=0;i<calcValues.length;i++)if(temp=$.grep(calcValues,function(e){return 1==e.isCalculatedField}),calcValues[i].isCalculatedField&&temp.length!=calcValues.length)for(j=0;j<this._tableKeysCalcValues.length;j++){for(formula=calcValues[i].formula.replace(/\s/g,""),k=0;k<calcValues.length;k++)1!=calcValues[k].isCalculatedField&&(value=ej.globalize.parseFloat(null==this._tableKeysCalcValues[j].value.keys[k]?"0":"date"==calcValues[k].format?this._dateToInt(this._tableKeysCalcValues[j].value.keys[k].toString()).toString():"time"==calcValues[k].format?this._dateToInt(new Date("1900",this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[0],this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[1],this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[2].split(" ")[0]).toString()).toString():this._tableKeysCalcValues[j].value.keys[k].toString(),this._locale),formula=formula.replace(new RegExp(calcValues[k].fieldName,"g"),"percentage"==calcValues[k].format&&0!=value?value<0?"("+value/100+")":value:value<0?"("+value+")":value));formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",calcValues[i].format,calcValues[i].formatString):null==dataSource.values[i].format?0:"0",newValue=null==dataSource.values[i].format?0:"0",this._tableKeysCalcValues[j].value.keys[i]=this._getSummaryValue(oldValue,newValue,1,this._summaryTypes[i],dataSource.values[i].format,dataSource.values[i].formatString)}else if(calcValues[i].isCalculatedField)for(val={keys:[],uniqueName:"",value:null},j=0;j<this._tableKeysCalcValues.length;j++){for(k=0;k<calcValues.length&&calcValues[k].isCalculatedField;k++)formula=calcValues[k].formula.replace(/\s/g,""),formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",calcValues[k].format,calcValues[k].formatString):null==dataSource.values[k].format?0:"0",newValue=null==dataSource.values[k].format?0:"0",val.keys.push(this._getSummaryValue(oldValue,newValue,1,"sum",dataSource.values[k].format,dataSource.values[k].formatString));this._tableKeysCalcValues[j].value=val,val={keys:[],uniqueName:"",value:null}}if(rowAxis.length>0&&(this._rowKeysCalcValues=this._sortHeaders(this._rowKeysCalcValues,rowAxis,0)),colAxis.length>0&&(this._colKeysCalcValues=this._sortHeaders(this._colKeysCalcValues,colAxis,0)),this._colkeyvalues=$.extend([],this._colKeysCalcValues),this._rowKeyValues=$.extend([],this._rowKeysCalcValues),colAxis.length>0&&this._insertTotalHeader(colAxis,this._colKeysCalcValues),rowAxis.length>0)this._insertTotalHeader(rowAxis,this._rowKeysCalcValues);else if(calcValues.length>0)if(this._rowKeysCalcValues.length>0)this._rowKeysCalcValues[0].keys[0]="Grand Total";else{for(this._rowKeysCalcValues.push({keys:[""],value:{keys:[]}}),i=0;i<calcValues.length;i++)this._rowKeysCalcValues[0].value.keys.push();this._rowKeysCalcValues[0].keys[0]="Grand Total"}return this._fillEngine(model)},_fillEngine:function(e){var t,i,l,a,r,o,n,s,d;(e.enablePaging||e.enableVirtualScrolling)&&(this._isPaging=!0,this._colHdrLen=1,this._rowHdrLen=1,this._controlObj._colKeysCalcValues=$.extend(!0,[],this._colKeysCalcValues),this._controlObj._rowKeysCalcValues=$.extend(!0,[],this._rowKeysCalcValues),this._controlObj._tableKeysCalcValues=$.extend(!0,[],this._tableKeysCalcValues),this._cropHeaders(),this._applyPaging());var h=e.dataSource,u=[],c=h.columns,p=h.rows,m=(h.filters,h.values);for(this._tRowCnt=0,this._tColCnt=0,this._currentFilterVal=this._valueFilterArray.length>0?this._valueFilterArray[0]:{},this._calculateValues(h),l=0;l<this._valueFilterArray.length;l++)this._advancedFilterInfo.length>0&&(this,this._rowKeysCalcValues=this._filterKeyValues(this._rowKeyValues),this._colKeysCalcValues=this._filterKeyValues(this._colkeyvalues),this._gridMatrix=null,this._colkeyvalues=$.extend([],this._colKeysCalcValues),this._rowKeyValues=$.extend([],this._rowKeysCalcValues),c.length>0&&this._insertTotalHeader(c,this._colKeysCalcValues),p.length>0?this._insertTotalHeader(p,this._rowKeysCalcValues):m.length>0&&(this._rowKeysCalcValues[0].keys[0]="Grand Total"),this._tRowCnt=0,this._tColCnt=0,this._currentFilterVal=this._valueFilterArray.length!=l+1?this._valueFilterArray[l+1]:{},this._calculateValues(h));if(t=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType,this._colTotCalc=[],this._rowTotCalc=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._transposeEngineCreation(),!ej.isNullOrUndefined(e.valueSortSettings)&&!ej.isNullOrUndefined(e.valueSortSettings.sortOrder)&&"none"!=e.valueSortSettings.sortOrder&&e.dataSource.values.length>0&&(!ej.isNullOrUndefined(this._valueSorting)||!ej.isNullOrUndefined(e.valueSortSettings.headerText)&&""!=e.valueSortSettings.headerText))if(i=0,e.valueSortSettings.headerDelimiters=e.valueSortSettings.headerDelimiters==undefined?"##":e.valueSortSettings.headerDelimiters,ej.isNullOrUndefined(this._valueSorting)){for(l=0;l<this._transposeEngine.length;l++){for(a=0;a<e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length;a++)ej.isNullOrUndefined(this._transposeEngine[l][a])||this._transposeEngine[l][a].Value!=e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters)[a]||i++;if(i==e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length){this._valueSorting=l;break}i=0}this._sort=ej.isNullOrUndefined(e.valueSortSettings)||ej.isNullOrUndefined(e.valueSortSettings.sortOrder)?this._sort:e.valueSortSettings.sortOrder,e.dataSource.columns.length+1!=e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length||ej.isNullOrUndefined(this._valueSorting)||this._applyValueSorting(e)}else this._applyValueSorting(e);for(r=0;r<this._tColCnt-1;r++){if(r<(o=0==p.length?1:this._isPaging?this._rowHdrLen:p.length))for(0==(n=(t?1:this._isPaging?this._colHdrLen:c.length)+(h.values.length>0?1:0))&&o>0&&(n=1),s=0;s<n;s++)this._gridMatrix.length>0&&u.push({Index:r+","+s,CSS:"none",Value:"",State:0,ColSpan:0==r&&0==s?o:1,RowSpan:0==r&&0==s?(t?1:this._isPaging?this._colHdrLen:c.length)+(h.values.length>0?1:0):1,Info:"",Span:"None",Expander:0});for(d=0;d<this._tRowCnt-1;d++)this._transposeEngine[r]==undefined||this._transposeEngine[r][d]==undefined||d<(t?1:this._isPaging?this._colHdrLen:c.length)+(h.values.length>0?1:0)&&r<o||u.push(this._transposeEngine[r][d])}return this._gridMatrix=[],h.rows[0]==undefined&&(h.rows.length=0),{json:u,pivotEngine:this._transposeEngine}},_cropHeaders:function(){var e,t,i,l,a=this._controlObj._drillHeaders.row,r=this._controlObj._drillHeaders.column,o=[],n=2,s=this._controlObj.model.enableCollapseByDefault,d=this._controlObj.model.dataSource.rows.length,h=this._controlObj.model.dataSource.columns.length;do{if(t=2==n?$.extend(!0,[],this._rowKeysCalcValues):$.extend(!0,[],this._colKeysCalcValues),s||(2==n?a.length>0:r.length>0)){for(i=0,e="",l=t.length-1;l>=0;l--)if(!ej.isNullOrUndefined(t[l])){ej.isNullOrUndefined(t[l].cellType)||ej.isNullOrUndefined(t[l].uniqueName)||(-1==t[l].uniqueName.indexOf(">#>")?t[l].uniqueName==e:-1!=t[l].uniqueName.indexOf(e))||(e="",i=t[l].level),s&&0==t[l].level&&""==e&&(i=0),(s?t[l].level!=i:""!=e)||ej.isNullOrUndefined(t[l].cellType)||ej.isNullOrUndefined(t[l].uniqueName)||!(2==n?a.indexOf(t[l].uniqueName)>-1:r.indexOf(t[l].uniqueName)>-1)||(e=t[l].uniqueName,i++);var u=e==t[l].uniqueName,c="RGTot"==t[l].cellType,p=t[l].level==i;(s?u||c||p||(2==n?i>d-2:i>h-2):""==e||ej.isNullOrUndefined(t[l].uniqueName)||u)&&((s?p:u)&&!ej.isNullOrUndefined(t[l].keys)&&t[l].keys.length>0&&!c&&""!=t[l].uniqueName&&(t[l].keys[t[l].keys.length-1]=t[l].keys[t[l].keys.length-1].replace(" Total","").replace("%####%",""),t[l].expander=2),o.push(t[l]))}2==n?this._rowKeysCalcValues=$.extend(!0,[],o.reverse()):this._colKeysCalcValues=$.extend(!0,[],o.reverse())}o=[],n--}while(n>0)},_applyPaging:function(){var e,t=[];this._controlObj._seriesPageCount=this._controlObj.model.enablePaging?this._rowKeysCalcValues.length:Math.ceil(this._rowKeysCalcValues.length/this._controlObj.model.dataSource.pagerOptions.seriesPageSize),this._controlObj._categPageCount=this._controlObj.model.enablePaging?this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1):Math.ceil(this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)/this._controlObj.model.dataSource.pagerOptions.categoricalPageSize),this._controlObj._categPageCount=0==this._controlObj._categPageCount?1:this._controlObj._categPageCount,this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage*this._controlObj.model.dataSource.pagerOptions.seriesPageSize>this._rowKeysCalcValues.length?Math.ceil(this._rowKeysCalcValues.length/this._controlObj.model.dataSource.pagerOptions.seriesPageSize):this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage,this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage=this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize>this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)?Math.ceil(this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)/this._controlObj.model.dataSource.pagerOptions.categoricalPageSize):this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage,this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage=0==this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage?1:this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage,this._controlObj._seriesCurrentPage=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage,this._controlObj._categCurrentPage=this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage;var i=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage*this._controlObj.model.dataSource.pagerOptions.seriesPageSize-this._controlObj.model.dataSource.pagerOptions.seriesPageSize,l=Math.ceil((this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize-this._controlObj.model.dataSource.pagerOptions.categoricalPageSize)/(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)),a=i+this._controlObj.model.dataSource.pagerOptions.seriesPageSize,r=Math.ceil(this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize/(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1));l=(this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage-1)*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize%this._controlObj.model.dataSource.values.length>0?l-1:l;for(e=i;e<a;e++)t.push(this._rowKeysCalcValues[e]);for(t=this._spanCalculation(t),this._rowKeysCalcValues=$.extend(!0,[],t),t=[],e=l;e<r;e++)t.push(this._colKeysCalcValues[e]);t=this._spanCalculation(t),this._colKeysCalcValues=$.extend(!0,[],t)},_spanCalculation:function(e){for(var t,i,l,a,r=0;r<e.length;r++)if(e.length>0&&!ej.isNullOrUndefined(e[r])&&!ej.isNullOrUndefined(e[r].uniqueName)){for(t=e[r].uniqueName.split(">#>"),[],e[r].keys[e[r].level]=e[r].keys[0],e[r].span=ej.isNullOrUndefined(e[r].span)?[]:e[r].span,i=ej.isNullOrUndefined(e[r].level)?e[r].span.length>0?e[r].span.length-2:e[r].keys.length-2:e[r].level-1;i>=0;i--){l=r+1,e[r].keys[i]=t[i],e[r].span[i]=1;do{if(!(!ej.isNullOrUndefined(e[l])&&e[l].uniqueName.split(">#>").indexOf(t[i])>-1&&e[l].uniqueName.split(">#>").indexOf(t[i])<e[l].uniqueName.split(">#>").length-1))break;e[r].span[i]++,l++}while(l<e.length)}ej.isNullOrUndefined(e[r].span)||0!=e[r].span.length||delete e[r].span}return a=e.length,$.map(e,function(e,t){if(!ej.isNullOrUndefined(e)&&!ej.isNullOrUndefined(e.span))for(var i=0;i<e.span.length;i++)e.span[i]=e.span[i]>a-t?a-t:e.span[i];return e})},_applyValueSorting:function(e){for(var t,i,l,a,r,o,n,s,d,h,u=[],c=[],p=0,m=0,g="",f=0;f<this._transposeEngine.length;f++)for(u[p]=[],ej.isNullOrUndefined(c[m])&&(c[m]=[]),h=0;h<this._transposeEngine[f].length&&this._valueSorting==Number(this._transposeEngine[f][h].Index.split(",")[0]);h++)("colheader"==this._transposeEngine[f][h].CSS||"calc"==$.trim(this._transposeEngine[f][h].CSS)||"colheader calc"==this._transposeEngine[f][h].CSS||"summary cstot"==this._transposeEngine[f][h].CSS||"summary cstot calc"==this._transposeEngine[f][h].CSS||"summary cgtot"==this._transposeEngine[f][h].CSS||"summary cgtot calc"==this._transposeEngine[f][h].CSS)&&(g=""==g?this._transposeEngine[f][h].Value:g+e.valueSortSettings.headerDelimiters+this._transposeEngine[f][h].Value),"value"==this._transposeEngine[e.dataSource.rows.length][h].CSS&&(u[p].push(this._transposeEngine[f][h]),m=0),"summary value"==this._transposeEngine[e.dataSource.rows.length][h].CSS&&(c[m].push(this._transposeEngine[f][h]),u[p].length>0&&(u[p+=1]=[]),"summary rgtot"!=this._transposeEngine[0][h].CSS&&c[m].length>0&&m++,ej.isNullOrUndefined(c[m])&&(c[m]=[]));for(e.valueSortSettings.headerText=g,e.valueSortSettings.sortOrder=this._sort,p=0;p<u.length;p++)for(f=0;f<u[p].length;f++)for(h=f;h<u[p].length;h++)("descending"==this._sort?this._getNumber(u[p][f].Value)<this._getNumber(u[p][h].Value):this._getNumber(u[p][f].Value)>this._getNumber(u[p][h].Value))&&(l=u[p][h],u[p][h]=u[p][f],u[p][f]=l);for(p=0;p<u.length;p++)0==u[p].length&&u.splice(p,1);for(t=[],f=0;f<this._tRowCnt-1;f++)t[f]={index:0,level:-1};var _=0,v=[],b=[];for(p=c.length-2;p>=0;p--){for(i=0,h=0;h<c[p].length;h++)for(f=h;f<c[p].length;f++)("descending"==this._sort?this._getNumber(c[p][h].Value)<this._getNumber(c[p][f].Value):this._getNumber(c[p][h].Value)>this._getNumber(c[p][f].Value))&&(l=c[p][f],c[p][f]=c[p][h],c[p][h]=l);if(0==_)for(h=0;h<c[p].length;h++)t[i=0==i?this._transposeEngine[_][Number(c[p][h].Index.split(",")[1])].MCnt+e.dataSource.columns.length+1:this._transposeEngine[_][Number(c[p][h].Index.split(",")[1])].MCnt+i+1]={index:Number(c[p][h].Index.split(",")[1]),level:_},v[h]==undefined&&(v[h]={}),v[h].end=Number(c[p][h].Index.split(",")[1]),v[h].start=Number(c[p][h].Index.split(",")[1])-this._transposeEngine[_][Number(c[p][h].Index.split(",")[1])].MCnt;else{for(a=[],r=0,s=0;s<v.length;s++){for(a=[],h=0;h<c[p].length;h++)Number(c[p][h].Index.split(",")[1])>v[s].start&&Number(c[p][h].Index.split(",")[1])<v[s].end&&a.push(c[p][h]);for(h=0;h<a.length;h++)t[i=0==i?this._transposeEngine[_][Number(a[h].Index.split(",")[1])].MCnt+e.dataSource.columns.length+1:this._transposeEngine[_][Number(a[h].Index.split(",")[1])].MCnt+i+1]={index:Number(a[h].Index.split(",")[1]),level:_},b[r]==undefined&&(b[r]={}),b[r].end=Number(a[h].Index.split(",")[1]),b[r].start=Number(a[h].Index.split(",")[1])-this._transposeEngine[_][Number(a[h].Index.split(",")[1])].MCnt,r++;for(;i<this._tRowCnt-2&&t[i].level>t[i+1].level;)i++;i--}v=jQuery.extend(!0,[],b)}_++}if(1==c.length&&c[0].length>0)for(o=e.dataSource.columns.length+1,f=0;f<u[0].length;f++)t[o]={index:Number(u[0][f].Index.split(",")[1])},o++;for(n=e.dataSource.columns.length+1,s=0;s<v.length;s++)for(p=0;p<u.length;p++)if(Number(u[p][0].Index.split(",")[1])>=v[s].start&&Number(u[p][0].Index.split(",")[1])<=v[s].end){for(h=0,f=v[s].start;f<v[s].end;f++)t[n]={index:Number(u[p][h].Index.split(",")[1])},h++,n++;for(n++;0!=t[n].index&&n<=t.length;)n++}for(d=[],f=0;f<e.dataSource.columns.length+1;f++)t[f]={index:f};for(f=0;f<t.length-1;f++)d.push(this._gridMatrix[t[f].index]);for(d.push(this._gridMatrix[f]),f=0;f<this._gridMatrix.length&&this._gridMatrix[f]!=undefined&&d[f]!=undefined;f++)for(h=0;h<this._gridMatrix[f].length&&this._gridMatrix[f][h]!=undefined;h++)this._gridMatrix[f][h]!=undefined&&d[f][h]!=undefined&&(d[f][h].Index=this._gridMatrix[f][h].Index);for(h=0;h<e.dataSource.rows.length-1;h++){var C=e.dataSource.columns.length+1,S=0,O=(p=0,!1);for(f=e.dataSource.columns.length+(e.dataSource.values.length>0?1:0);f<d.length;f++)if(d[f]!=undefined&&d[f][h]!=undefined&&"rowheader"==d[f][h].CSS&&d[f][h].RowSpan!=undefined&&(O=!0,S=S>d[f][h].RowSpan?S:d[f][h].RowSpan),d[f]!=undefined&&d[f][h]!=undefined&&"summary rstot"==d[f][h].CSS&&O&&!ej.isNullOrUndefined(d[C])){for(O=!1;d[C]==undefined||d[C][h]==undefined;)C++;d[C][h].RowSpan=S,S=0,0,C=f+1,p++}}this._gridMatrix=d,this._transposeEngineCreation()},_transposeEngineCreation:function(){var e,t,i;for(this._tColCnt=this._isPaging&&this._gridMatrix.length>0?!ej.isNullOrUndefined(this._gridMatrix[0])&&this._gridMatrix[0].length>0?this._gridMatrix[0].length+1:this._gridMatrix[this._gridMatrix.length-1].length+1:this._tColCnt,e=0;e<this._tRowCnt-1;e++)for(t=0;t<this._tColCnt-1;t++)this._transposeEngine[t]==undefined&&(this._transposeEngine[t]=[]),this._gridMatrix[e]!=undefined&&this._gridMatrix[e][t]!=undefined?(i="string"==typeof this._gridMatrix[e][t]||"number"==typeof this._gridMatrix[e][t]||"object"==typeof this._gridMatrix[e][t]?0==this._gridMatrix[e][t].Value?this._gridMatrix[e][t].Value:this._gridMatrix[e][t].Value==undefined?"":ej.isNullOrUndefined(this._gridMatrix[e][t].valueText)?this._gridMatrix[e][t].Value:this._gridMatrix[e][t].valueText:"",this._transposeEngine[t][e]={Index:t+","+e,CSS:this._gridMatrix[e][t].CSS,Value:"string"==typeof i&&i.indexOf("%####%")>-1?i.replace("%####%",""):i,State:this._gridMatrix[e][t].State,RowSpan:this._gridMatrix[e][t].RowSpan!=undefined?this._gridMatrix[e][t].RowSpan:1,ColSpan:this._gridMatrix[e][t].ColSpan!=undefined?this._gridMatrix[e][t].ColSpan:1,Info:this._gridMatrix[e][t].Info,Span:"None",Expander:this._gridMatrix[e][t].Expander,MCnt:this._gridMatrix[e][t].MCnt!=undefined?this._gridMatrix[e][t].MCnt:1}):this._gridMatrix[e]!=undefined&&(this._transposeEngine[t][e]={Index:t+","+e,CSS:"none",Value:"",State:0,RowSpan:1,ColSpan:1,Info:"",Span:"None",Expander:0})},_filterKeyValues:function(e){var t=this;return $.grep(e,function(e){for(var i=!1,l=0;l<(!ej.isNullOrUndefined(e.uniqueName)&&e.uniqueName.split(">#>").length)&&(i=$.inArray(e.uniqueName.split(">#>")[l],t._advancedFilterInfo)>-1||i,!(i=$.inArray(e.uniqueName,t._advancedFilterInfo)>-1||i));l++);if(!i)return e})},_getFilteredIndex:function(e,t,i,l){return $.map(t,function(t,a){if(e.length>0&&l[i].keys.length>0&&e[l[i].keys.length-1].advancedFilter&&e[l[i].keys.length-1].advancedFilter.length>0&&(e[l[i].keys.length-1].advancedFilter[0].measure==t.fieldName||e[l[i].keys.length-1].advancedFilter[0].name==t.fieldName))return a})[0]},_applyValueFilter:function(e,t){var i,l,a=!1;if(e.length>0&&!ej.isNullOrUndefined(t))switch(t=this._isNumber(t)?t:ej.parseFloat(t,this._locale),i=e[0].valueFilterOperator,l=e[0].values,i.toLowerCase()){case"equals":a=!(t==JSON.parse(e[0].values[0]));break;case"notequals":a=!(t!=JSON.parse(e[0].values[0]));break;case"greaterthan":a=!(t>JSON.parse(e[0].values[0]));break;case"greaterthanorequalto":a=!(t>=JSON.parse(e[0].values[0]));break;case"lessthan":a=!(t<JSON.parse(e[0].values[0]));break;case"lessthanorequalto":a=!(t<=JSON.parse(e[0].values[0]));break;case"between":a=!(t>JSON.parse(l[0])&&t<JSON.parse(l[1]));break;case"notbetween":a=!!(t>JSON.parse(l[0])&&t<JSON.parse(l[1]));break;default:a=!(t==JSON.parse(e[0].values[0]))}return a},_applyLabelFilter:function(e,t){if(e.length>0){var i=e[0].labelFilterOperator,l=e[0].values,a=!1;switch(t=ej.isNullOrUndefined(t)?"":t.toString(),i.toLowerCase()){case"equals":a=!(t.toLowerCase()==l[0].toLowerCase());break;case"notequals":a=t.toLowerCase()==l[0].toLowerCase();break;case"contains":a=!(t.toLowerCase().indexOf(l[0].toLowerCase())>-1);break;case"notcontains":a=t.toLowerCase().indexOf(l[0].toLowerCase())>-1;break;case"beginswith":a=!(0==t.toLowerCase().indexOf(l[0].toLowerCase()));break;case"notbeginswith":a=0==t.toLowerCase().indexOf(l[0].toLowerCase());break;case"endswith":a=ej.isNullOrUndefined(t.toLowerCase().match(l[0].toLowerCase()+"$"));break;case"notendswith":a=!ej.isNullOrUndefined(t.toLowerCase().match(l[0].toLowerCase()+"$"));break;case"greaterthan":a=!(t.toLowerCase()>l[0].toLowerCase());break;case"greaterthanorequalto":a=!(t.toLowerCase()>=l[0].toLowerCase());break;case"lessthan":a=!(t.toLowerCase()<l[0].toLowerCase());break;case"lessthanorequalto":a=!(t.toLowerCase()<=l[0].toLowerCase());break;case"between":a=!(t.toLowerCase()>l[0].toLowerCase()||t.toLowerCase()<l[1].toLowerCase());break;case"notbetween":a=!!(t.toLowerCase()>l[0].toLowerCase()||t.toLowerCase()<l[1].toLowerCase());break;default:a=!(t.toLowerCase().indexOf(l[0].toLowerCase())>-1)}return a}},getMembers:function(e,t){var i,l,a;if(ej.isNullOrUndefined(t))return ej.isNullOrUndefined(this._fieldMembers)?[]:ej.isNullOrUndefined(this._fieldMembers[e])?[]:this._fieldMembers[e];for(i={},l=0;l<t.length;l++)a=t[l],$.each(a,function(e,t){ej.isNullOrUndefined(i[e])?i[e]=[t]:i[e].indexOf(t)<0&&i[e].push(t)});return i[e]},_powerFunction:function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},_calculatedFieldSummaryValue:function(index,calValue,dataSource){var formula,i,value,oldValue,newValue;if(1==dataSource.values[index].isCalculatedField){for(formula=dataSource.values[index].formula.replace(/\s/g,""),i=0;i<dataSource.values.length;i++)1!=dataSource.values[i].isCalculatedField&&(value=ej.globalize.parseFloat(null==calValue[i]?"0":"date"==dataSource.values[i].format?this._dateToInt(calValue[i].toString()).toString():"time"==dataSource.values[i].format?this._dateToInt(new Date("1900",calValue[i].toString().split(":")[0],calValue[i].toString().split(":")[1],calValue[i].toString().split(":")[2].split(" ")[0]).toString()).toString():calValue[i].toString(),this._locale),formula=formula.replace(new RegExp(dataSource.values[i].fieldName,"g"),"percentage"==dataSource.values[i].format&&0!=value?value<0?"("+value/100+")":value:value<0?"("+value+")":value));return formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",dataSource.values[index].format,dataSource.values[index].formatString):null==dataSource.values[index].format?0:"0",newValue=null==dataSource.values[index].format?0:"0",this._getSummaryValue(oldValue,newValue,1,"count"==this._summaryTypes[index]?"sum":this._summaryTypes[index],dataSource.values[index].format,dataSource.values[index].formatString)}},_sortHeaders:function(e,t,i){for(var l,a=[],r=[],o=0,n=t[i].sortOrder!=ej.PivotAnalysis.SortOrder.None?ej.isNullOrUndefined(t[i].format)?ej.DataManager(e).executeLocal(ej.Query().sortBy("keys."+i,null!=t[i].sortOrder&&t[i].sortOrder==ej.PivotAnalysis.SortOrder.Descending?ej.sortOrder.Descending:ej.sortOrder.Ascending,!1)):this._getSortedHeaders(e,t,i):e;o<n.length;)l=n[o].keys[i],(a=$.grep(n,function(e){return e.keys[i]==l})).length>1&&i+1<n[o].keys.length&&(a=this._sortHeaders(a,t,i+1)),r=r.concat(a),o+=a.length;return r},_getSortedHeaders:function(e,t,i){return t[i].sortOrder==ej.PivotAnalysis.SortOrder.Descending?e.sort(function(e,l){return ej.PivotAnalysis._formatToInt(l.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)-ej.PivotAnalysis._formatToInt(e.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)}):e.sort(function(e,l){return ej.PivotAnalysis._formatToInt(e.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)-ej.PivotAnalysis._formatToInt(l.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)})},_isValidTime:function(e){var t=e.indexOf(":")>-1?e.split(":"):[];return 3==t.length&&(t[3]=t[2].indexOf(" ")>-1?t[2].split(" ")[1]:"AM",t[2]=t[2].indexOf(" ")>-1?t[2].split(" ")[0]:t[2],!(!(Number(t[0])>-1&&Number(t[0])<13&&Number(t[1])>-1&&Number(t[1])<61&&jQuery.isNumeric(t[2]))||"AM"!=t[3]&&"PM"!=t[3]))},_getNumber:function(e,t){return ej.isNullOrUndefined(e)||(jQuery.isNumeric(e.toString().replace(/[,.]/g,""))?(e=e.toString().replace(/[,]/g,","==ej.preferredCulture(this._locale).numberFormat[","]?"":"~").replace(/[.]/g,"."==ej.preferredCulture(this._locale).numberFormat["."]?".":""),e=Number(e.toString().replace(/[~]/g,"."))):e=this._isValidTime(e)?this._formatToInt(e,"time",t):ej.isNullOrUndefined(ej.parseDate(e,t==undefined?"MM/dd/yyyy":t))?-1!=e.indexOf("/")&&2==e.split("/")?this._formatToInt(e,"fraction",undefined):$.trim(e).indexOf("%")==$.trim(e).length-1?Number(e.replace(/[^\d.-]/g,""))/100:/[a-zA-Z]/.test(e)?1:Number(e.replace(/[^\d.-]/g,"")):this._formatToInt(e,"date",t)),e},_setFormat:function(e,t,i){switch(t){case"percentage":var l=jQuery.isNumeric(e)?1:100;e="string"==typeof e?$.trim(e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",",".").replace(ej.preferredCulture(this._locale).numberFormat.percent.symbol,"")):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:P}",""==e?0:e/l,this._locale);break;case"decimal":case"number":e="string"==typeof e?e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:N}",e,this._locale);break;case"currency":e="string"==typeof e?$.trim(e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",",".").replace(ej.preferredCulture(this._locale).numberFormat.currency.symbol,"")):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:C2}",""==e?0:e,this._locale);break;case"date":jQuery.isNumeric(e)?(e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale))):"Invalid Date"!=new Date(e)?(e=new Date(e),e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale)):(e=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime()),e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale));break;case"scientific":e="string"==typeof e?e.split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e=jQuery.isNumeric(e)?e:0,e=Number(e).toExponential(2).replace("e","E");break;case"accounting":e=this._toAccounting(e,i||"{0:C2}",this._locale);break;case"time":jQuery.isNumeric(e)?(e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale))):this._isValidTime(e)?e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale):(e=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime()),e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale));break;case"fraction":e="string"==typeof e?e.split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e="numerator"in(e=jQuery.isNumeric(e)?this._toFraction(e):this._toFraction(0))?e.integer+" "+e.numerator+"/"+e.denominator:e.integer}return e},_getReflectedValue:function(e,t,i,l){var a=$(e).prop(t);return null==a?a:(jQuery.isNumeric(a)||"Invalid Date"!=new Date(a)||(i=l=null),this._setFormat(a,i,l))},_formatToInt:function(value,format,formatString){var time;switch(format){case"date":value=null!=ej.parseDate(value.toString(),formatString==undefined?"MM/dd/yyyy":formatString,this._locale)?this._dateToInt(ej.parseDate(value,formatString==undefined?"MM/dd/yyyy":formatString,this._locale)):value;break;case"percentage":value=0!=value?ej.globalize.parseFloat(value.toString(),this._locale)/100:Number(value);break;case"currency":case"accounting":value=0!=value?ej.globalize.parseFloat(ej.globalize.format(value.toString(),"c",this._locale),this._locale):Number(value);break;case"decimal":case"number":value=0!=value?ej.globalize.parseFloat(value.toString(),this._locale):Number(value);break;case"scientific":value=0!=value||0==value?parseFloat(value):Number(value);break;case"time":this._isNumber(value)||(time=value.toString().split(":"),time=new Date("1900",time[0],time[1],time[2].split(" ")[0]).toString(),value=this._dateToInt(time));break;case"fraction":var temp1=parseFloat(value.toString().split(" ")[0]),temp2=eval(value.toString().split(" ")[1])!=undefined?parseFloat(eval(value.toString().split(" ")[1])):parseFloat(0),value=0!=value?temp1+temp2:Number(value)}return value},_isDateTime:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},_toAccounting:function(e,t,i){var l,a,r,o,n=ej.preferredCulture(i).numberFormat,s=n.currency.symbol;return val=ej.widgetBase.formatting(t,e,i),val=val.indexOf(" ")>-1?val.split(" ").join(""):val,r=val.replace(s,""),o=jQuery.isNumeric(r.toString().split(n[","]).join("").replace(",","."))?val.indexOf(s):0,r=jQuery.isNumeric(r.toString().split(",").join(""))?r:"0.00",!o||Number(r)<0&&1===o?(l=s,a=r):(l=r,a=s),l+"   "+a},_toFraction:function(e){if(this._isNumber(e)){var t=e.toString(),i=t.split(".")[0],l=t.split(".")[1];if(!l)return{integer:e};var a=(+l).toString(),r=this._getPlaceValue(l,a),o=this._getGCD(a,r);return{integer:i,numerator:Number(a)/o,denominator:Number(r)/o}}return null},_isNumber:function(e){return e-parseFloat(e)>=0},_getGCD:function(e,t){return e=Number(e),(t=Number(t))?this._getGCD(t,e%t):e},_getPlaceValue:function(e,t){var i=e.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},_cellEdit:function(e,t,i,l){return $.each(this._editCellsInfo,function(a,r){if(e==(ej.isNullOrUndefined(r.row)&&ej.isNullOrUndefined(r.column)?"":ej.isNullOrUndefined(r.row)?r.column:ej.isNullOrUndefined(r.column)?r.row:r.row+">#>"+r.column)&&i==parseInt(r.value.split("#")[0]))return t=ej.PivotAnalysis._setFormat(ej.isNullOrUndefined(l.format)?jQuery.isNumeric(r.value.split("#")[1].toString().split(",").join(""))?parseFloat(r.value.split("#")[1].toString().split(",").join("")):0:r.value.split("#")[1],l.format,l.formatString),!1}),t},_isMemberExist:function(e,t,i,l){var a,r,o,n,s,d;switch(e){case"row":if(r=!1,(o=0==this._rowKeysCalcValues.length?0:this._rowMembers[t.uniqueName])>-1&&(r=!0,a=o),0==this._rowKeysCalcValues.length&&(this._rowKeysCalcValues.push(t),this._rowMembers[t.uniqueName]=this._rowKeysCalcValues.length-1),r)for(n=0;n<i.keys.length;n++){if(null==this._rowKeysCalcValues[a].value){this._rowKeysCalcValues[a].value=i;break}this._rowKeysCalcValues[a].value.keys[n]+=i.keys[n]}else this._rowKeysCalcValues.push(t),this._rowMembers[t.uniqueName]=this._rowKeysCalcValues.length-1;break;case"column":if(r=!1,(o=0==this._colKeysCalcValues.length?0:this._colMembers[t.uniqueName])>-1&&(r=!0,a=o),0==this._colKeysCalcValues.length&&(l.columns.length>0||l.values.length>0)&&(this._colKeysCalcValues.push(t),this._colMembers[t.uniqueName]=this._colKeysCalcValues.length-1),r)for(n=0;n<i.keys.length;n++){if(null==this._colKeysCalcValues[a].value){this._colKeysCalcValues[a].value=i;break}this._colKeysCalcValues[a].value.keys[n]+=i.keys[n]}else(l.columns.length>0||l.values.length>0)&&(this._colKeysCalcValues.push(t),this._colMembers[t.uniqueName]=this._colKeysCalcValues.length-1);break;case"calc":if(r=!1,(o=0==this._tableKeysCalcValues.length?0:this._calcMembers[t.uniqueName])>-1&&(r=!0,a=o),0==this._tableKeysCalcValues.length&&(this._tableKeysCalcValues.push(t),this._calcMembers[t.uniqueName]=this._tableKeysCalcValues.length-1),r)for(n=0;n<i.keys.length;n++){if(null==this._tableKeysCalcValues[a].value){for(this._tableKeysCalcValues[a].value=i,this._tableKeysCalcValues[a].value.count=1,d=0;d<i.keys.length;d++)this._summaryTypes[d]==ej.PivotAnalysis.SummaryType.Count&&(this._tableKeysCalcValues[a].value.keys[d]=this._tableKeysCalcValues[a].value.count);break}s=l.values[n],this._tableKeysCalcValues[a].value.uniqueName[n]==i.uniqueName[n]&&(ej.isNullOrUndefined(s.formatString)||"single-entry"!=s.formatString.toLowerCase())||(this._tableKeysCalcValues[a].value.uniqueName[n]=" "),0==n&&this._tableKeysCalcValues[a].value.count++,1!=l.values[n].isCalculatedField&&(this._tableKeysCalcValues[a].value.keys[n]=this._getSummaryValue(this._tableKeysCalcValues[a].value.keys[n],i.keys[n],this._tableKeysCalcValues[a].value.count,this._summaryTypes[n],l.values[n].format,l.values[n].formatString))}else for(this._tableKeysCalcValues.push(t),this._calcMembers[t.uniqueName]=this._tableKeysCalcValues.length-1,this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value=i,d=0;d<i.keys.length;d++)this._summaryTypes[d]==ej.PivotAnalysis.SummaryType.Count&&(this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value.keys[d]=1),this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value.count=1}},_getSummaryValue:function(e,t,i,l,a,r){if(t=ej.isNullOrUndefined(t)?null:0==t?0:t,e=ej.isNullOrUndefined(e)?null:0==e?0:e,!ej.isNullOrUndefined(t)&&!ej.isNullOrUndefined(e)){switch(e=this._formatToInt(e,a,r),t=this._formatToInt(t,a,r),l){case ej.PivotAnalysis.SummaryType.Sum:e+=t;break;case ej.PivotAnalysis.SummaryType.Average:e=(e*(i-1)+t)/i,Math.floor(e)!=e&&(e=Number(e.toFixed(2)));break;case ej.PivotAnalysis.SummaryType.Min:e=1==i?t:Math.min(e,t);break;case ej.PivotAnalysis.SummaryType.Max:e=1==i?t:Math.max(e,t);break;case ej.PivotAnalysis.SummaryType.Count:e=i}switch(a){case"percentage":e=ej.widgetBase.formatting(r||"{0:P}",e,this._locale);break;case"decimal":case"number":e=ej.widgetBase.formatting(r||"{0:N}",e,this._locale);break;case"date":e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:"+(r==undefined?"MM/dd/yyyy":r)+"}",e,this._locale));break;case"currency":e=ej.widgetBase.formatting(r||"{0:C2}",e,this._locale);break;case"scientific":e=e.toExponential(2).replace("e","E");break;case"accounting":e=this._toAccounting(e,r||"{0:C2}",this._locale);break;case"time":e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale));break;case"fraction":e="numerator"in(e=this._toFraction(e))?e.integer+" "+e.numerator+"/"+e.denominator:e.integer}}return e},_dateToInt:function(e){var t=new Date("01/01/1900");return((this._isDateTime(e)?e:new Date(e)).getTime()-t.getTime())/864e5+2},_insertTotalHeader:function(e,t){var i,l,a,r,o;if(e.length<=1)t.push({cellType:"RGTot",keys:["Grand Total"],tot:"sub"});else{for(i=-1,l=e.length-2;l>=0;l--)if(i++,(a=t.length)>0){r=t[0].uniqueName.split(">#>"),t[0].keys[i],r=r.slice(0,l+1).join(">#>");var n="",s=0,d="";for(o=1;o<=a;o++)t[o]!=undefined?(n=(n=t[o].uniqueName.split(">#>")).slice(0,l+1).join(">#>"),d=t[o].keys[l+1]):n=undefined,n!=undefined&&-1==n.indexOf("%####%")?r!=undefined&&n!=r&&(t.splice(o,0,{keys:[r.split(">#>")[l]+" Total%####%"],cellType:"SubTot",uniqueName:r,level:l,mSpan:o-s}),t[s].span==undefined&&(t[s].span=[]),t[s].span[l]=o-s,a++,r=n,s=++o,d):r!=undefined&&(t.splice(o,0,{keys:[r.split(">#>")[l]+" Total%####%"],cellType:"SubTot:",uniqueName:r,level:l,mSpan:o-s}),t[s].span==undefined&&(t[s].span=[]),t[s].span[l]=o-s,a++,r=n,s=++o,d)}t.push({cellType:"RGTot",keys:["Grand Total"]})}},_isPreviousLevelEqual:function(e,t,i,l){for(var a=l-1;a>=0;a--)return e[t].keys[a]!=e[i].keys[a]},_calculateValues:function(e){var t,i,l=this._rowKeysCalcValues.length+(e.values.length>0?1:0),a=0==this._colKeysCalcValues.length?1:this._colKeysCalcValues.length*(0==e.values.length?1:e.values.length)+1-(this._isPaging&&e.values.length>0&&e.pagerOptions.categoricalPageSize<e.values.length*this._colKeysCalcValues.length?e.values.length-(e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length==0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize:e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length):0);this._isPaging&&(0==e.columns.length?ej.PivotAnalysis._colHdrLen=0:$.each(this._colKeysCalcValues,function(e,t){!ej.isNullOrUndefined(t)&&t.keys.length>ej.PivotAnalysis._colHdrLen&&(ej.PivotAnalysis._colHdrLen=t.keys.length)}),0==e.rows.length?ej.PivotAnalysis._rowHdrLen=0:$.each(this._rowKeysCalcValues,function(e,t){!ej.isNullOrUndefined(t)&&t.keys.length>ej.PivotAnalysis._rowHdrLen&&(ej.PivotAnalysis._rowHdrLen=t.keys.length)})),this._gridMatrix=new Array(l+(this._isPaging?this._rowHdrLen:e.rows.length)+1),this._populateRowHeaders(e,l+(this._isPaging?this._rowHdrLen:e.rows.length)+1,0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length),t=(this._isPaging?this._colHdrLen:e.columns.length)+1,i=(this._isPaging&&e.pagerOptions.categoricalPageSize+1<a?e.pagerOptions.categoricalPageSize+1:a)+(0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length),this._populateColumnHeaders(e,t,i),this._advancedFilterInfo=[],e.values.length>0&&this._populateCalcTable(e),this._tRowCnt=l+t,this._tColCnt=i},_populateRowHeaders:function(e,t,i){var l,a,r,o,n;if(0!=this._rowKeysCalcValues.length){for(l=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1+(e.values.length>0?1:0):(this._isPaging?this._colHdrLen:e.columns.length)+(e.values.length>0?1:0),this._gridMatrix=[],"",a=0;a<this._rowKeysCalcValues.length;a++){this._rowKeysCalcValues[a];var s=0,d=0,h=0,u=0;if(this._rowKeysCalcValues[a].keys!=undefined&&0!=this._rowKeysCalcValues[a].keys.length)for(this._gridMatrix[l]=new Array(i),u=this._rowKeysCalcValues[a].keys.length,r=0;r<u;r++)this._rowKeysCalcValues[a].cellType!=undefined&&ej.isNullOrUndefined(this._rowKeysCalcValues[a].span)?this._rowKeysCalcValues[a].cellType.indexOf("SubTot")>-1?(d=0==s?this._rowKeysCalcValues[a].level+s:s,h=i-this._rowKeysCalcValues[a].level,this._cellType="summary rstot"):(this._cellType="summary rgtot",d=s,h=this._isPaging?this._rowHdrLen:e.rows.length):(this._cellType="rowheader",d=s,h=1),o=u>1&&u-r>1?1:ej.isNullOrUndefined(this._rowKeysCalcValues[a].expander)?0:2,n=$.extend(!0,[],this._rowKeysCalcValues[a].keys),this._gridMatrix[l][d]={Index:d+","+l,CSS:this._cellType,Value:this._rowKeysCalcValues[a].keys[r],State:o,RowSpan:this._rowKeysCalcValues[a].span!=undefined?this._rowKeysCalcValues[a].span[r]:1,ColSpan:h,Info:n.splice(0,r+1).join(">#>"),Span:"None",Expander:this._rowKeysCalcValues[a].span!=undefined?this._rowKeysCalcValues[a].span[r]!=undefined?1:ej.isNullOrUndefined(this._rowKeysCalcValues[a].expander)?0:1:ej.isNullOrUndefined(this._rowKeysCalcValues[a].expander)?0:2,MCnt:this._rowKeysCalcValues[a].mSpan!=undefined&&ej.isNullOrUndefined(this._rowKeysCalcValues[a].span)?this._rowKeysCalcValues[a].mSpan:0},this._rowKeysCalcValues[a].level-r==1&&delete this._rowKeysCalcValues[a].span,s++;l++}this._cellType=""}},_populateColumnHeaders:function(e,t){var i,l,a,r,o,n,s;if(0!=this._colKeysCalcValues.length){var d,h,u,c,p,m,g=d=0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length,f=0==e.values.length?1:e.values.length,_=h=0,v=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1:this._isPaging?this._colHdrLen:e.columns.length;for(i=0;i<this._colKeysCalcValues.length;i++){for(_=0,u=0,c=0,0,p=f,m=0,this._isPaging&&e.values.length>0&&(m=(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length,0==i?p=(p=(1==e.pagerOptions.categoricalCurrentPage&&e.values.length>e.pagerOptions.categoricalPageSize?e.pagerOptions.categoricalPageSize:e.values.length)-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length)<1?e.values.length:e.values.length>e.pagerOptions.categoricalPageSize&&p>e.pagerOptions.categoricalPageSize?e.pagerOptions.categoricalPageSize:p:this._colKeysCalcValues.length-i==1?p=(p=e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length)<1||e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?e.values.length:p:p=e.values.length),this._colKeysCalcValues[i].keys,this._gridMatrix[_]==undefined&&(this._gridMatrix[_]=[]),h=this._colKeysCalcValues[i].keys.length,l=0;l<h;l++){for(this._gridMatrix[_]==undefined&&(this._gridMatrix[_]=[]),this._colKeysCalcValues[i].cellType!=undefined&&ej.isNullOrUndefined(this._colKeysCalcValues[i].span)?this._colKeysCalcValues[i].cellType.indexOf("SubTot")>-1?(u=0==_?this._colKeysCalcValues[i].level+_:_,c=t-this._colKeysCalcValues[i].level-1,this._cellType="summary cstot"):(u=_,c=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1:this._isPaging?this._colHdrLen:e.columns.length,this._cellType="summary cgtot"):(u=_,c=1,this._cellType="colheader"),a=h>1&&h-l>1?1:ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:2,n=0;n<p;n++)r=$.extend(!0,[],this._colKeysCalcValues[i].keys),this._gridMatrix[u][f*i+n+d-(i>0?m:0)]={Index:g+","+u,CSS:this._cellType,Value:this._colKeysCalcValues[i].keys[l],State:a,ColSpan:n>0?1:this._isPaging&&0==i&&!ej.isNullOrUndefined(this._colKeysCalcValues[i].span)&&this._colKeysCalcValues[i].span[l]>=this._colKeysCalcValues.length?e.pagerOptions.categoricalPageSize:(this._colKeysCalcValues[i].span!=undefined?this._colKeysCalcValues[i].span[l]==undefined?1:this._colKeysCalcValues[i].span[l]:1)*(this._colKeysCalcValues.length-i==1?p:f)-(0==i?m:0),RowSpan:c,Info:r.splice(0,l+1).join(">#>"),Span:"None",Expander:n>0?ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:1:this._colKeysCalcValues[i].span!=undefined&&this._colKeysCalcValues[i].span[l]!=undefined?1:ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:1};this._colKeysCalcValues[i].level-l==1&&delete this._colKeysCalcValues[i].span,_++}if(e.values.length>0)for(n=0;n<p;n++)this._gridMatrix[v]==undefined&&(this._gridMatrix[v]=[]),o=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length+n:n,this._gridMatrix[v][f*i+n+d-(i>0?m:0)]={Index:f*i+n+d-(i>0?m:0)+","+_,CSS:this._cellType+" calc",Value:e.values[o].fieldCaption==undefined?e.values[o].fieldName:e.values[o].fieldCaption,State:0,ColSpan:1,RowSpan:1,Info:"",Span:"None",Expander:0};g++}if(this._cellType="",this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length>0&&t>1)for(n=0;n<t;n++)for(s=0;s<this._gridMatrix[n].length;s++)!ej.isNullOrUndefined(this._gridMatrix[n][s])&&this._gridMatrix[n][s].ColSpan>this._gridMatrix[n].length-s&&(this._gridMatrix[n][s].ColSpan=this._gridMatrix[n].length-s)}},_populateCalcTable:function(e){var t,i,l,a,r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C=[],S=null,O=e.values.length,y=this;this._rowTotCalc=[],this._rowTotCalc=[];var P,w=0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length,N=!1,x=0,T=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?2:(this._isPaging?this._colHdrLen:e.columns.length)+1,M=T,L=!1,D={};for($.grep(y._tableKeysCalcValues,function(e){D[e.uniqueName]=e}),t=$.grep(this._tableKeysCalcValues,function(e){if(ej.isNullOrUndefined(e.cellType))return e}),$.grep(this._tableKeysCalcValues,function(e){if(!ej.isNullOrUndefined(e.cellType))return e}),f=0;f<this._rowKeysCalcValues.length;f++){for(this._colTotCalc=[],P=w,N=!0,this._gridMatrix[f+T]==undefined&&(this._gridMatrix[f+T]=[]),this._rowTotCalc[x]=[],i=0;i<this._colKeysCalcValues.length;i++){if(C=[],S=null,this._cellType="value",_=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,v=(v=this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length-i==1&&i>0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length:O)<1||this._isPaging&&e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?O:v,e.columns.length>0&&e.rows.length>0)if(!y._isPaging||"RGTot"!=y._rowKeysCalcValues[f].cellType&&"RGTot"!=y._colKeysCalcValues[i].cellType){if(l=y._rowKeysCalcValues[f].uniqueName+">#>"+y._colKeysCalcValues[i].uniqueName,a=D[l]){for(s=0;s<a.value.keys.length;s++)C.push(a.value.keys[s]);""!=a.value.uniqueName&&(S=a.value.uniqueName)}}else r=0,$.grep(t,function(t){if("RGTot"==y._rowKeysCalcValues[f].cellType&&"RGTot"==y._colKeysCalcValues[i].cellType||("RGTot"==y._rowKeysCalcValues[f].cellType?t.uniqueName.indexOf(y._colKeysCalcValues[i].uniqueName)>-1:t.uniqueName.indexOf(y._rowKeysCalcValues[f].uniqueName)>-1))for(r++,s=0;s<t.value.keys.length;s++)ej.isNullOrUndefined(C[s])?C.push(t.value.keys[s]):C[s]=e.values[s].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(s,C,e):ej.PivotAnalysis._getSummaryValue(C[s],t.value.keys[s],r,"count"==ej.PivotAnalysis._summaryTypes[s]?"sum":ej.PivotAnalysis._summaryTypes[s],e.values[s].format,e.values[s].formatString)});else 0==e.rows.length?y._isPaging?(r=0,$.grep(t,function(t){if("RGTot"==y._colKeysCalcValues[i].cellType||t.uniqueName.indexOf(y._colKeysCalcValues[i].uniqueName)>-1)for(r++,s=0;s<t.value.keys.length;s++)ej.isNullOrUndefined(C[s])?C.push(t.value.keys[s]):C[s]=e.values[s].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(s,C,e):ej.PivotAnalysis._getSummaryValue(C[s],t.value.keys[s],r,"count"==ej.PivotAnalysis._summaryTypes[s]?"sum":ej.PivotAnalysis._summaryTypes[s],e.values[s].format,e.values[s].formatString)})):$.grep(y._tableKeysCalcValues,function(e){if(e.uniqueName==y._colKeysCalcValues[i].uniqueName){for(s=0;s<e.value.keys.length;s++)C.push(e.value.keys[s]);""!=e.value.uniqueName&&(S=e.value.uniqueName)}}):y._isPaging?(r=0,$.grep(t,function(t){if("RGTot"==y._rowKeysCalcValues[f].cellType||t.uniqueName.indexOf(y._rowKeysCalcValues[f].uniqueName)>-1)for(r++,s=0;s<t.value.keys.length;s++)ej.isNullOrUndefined(C[s])?C.push(t.value.keys[s]):C[s]=e.values[s].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(s,C,e):ej.PivotAnalysis._getSummaryValue(C[s],t.value.keys[s],r,"count"==ej.PivotAnalysis._summaryTypes[s]?"sum":ej.PivotAnalysis._summaryTypes[s],e.values[s].format,e.values[s].formatString)})):$.grep(y._tableKeysCalcValues,function(e){if(e.uniqueName==y._rowKeysCalcValues[f].uniqueName){for(s=0;s<e.value.keys.length;s++)C.push(e.value.keys[s]);""!=e.value.uniqueName&&(S=e.value.uniqueName)}});if(this._editCellsInfo.length>0)for(b=0;b<e.values.length;b++)C[b]=ej.PivotAnalysis._cellEdit(e.columns.length>0&&e.rows.length>0?this._rowKeysCalcValues[f].uniqueName+">#>"+this._colKeysCalcValues[i].uniqueName:0==e.rows.length?this._colKeysCalcValues[i].uniqueName:this._rowKeysCalcValues[f].uniqueName,C[b],b,e.values[b]);if(this._colKeysCalcValues[i].cellType!=undefined&&(this._colKeysCalcValues[i].cellType.indexOf("SubTot")>-1||this._colKeysCalcValues[i].cellType.indexOf("RGTot")>-1)){if(!this._isPaging){for(C=[],S=null,s=0;s<O;s++)for(d=0,r=0,o=P;o<=i*O+w;o++)this._gridMatrix[f+T]!=undefined&&this._gridMatrix[f+T][P+d*O+s]!=undefined&&this._gridMatrix[f+T][P+d*O+s].Value!=undefined&&(C[s]==undefined&&(C[s]=0),r++,C[s]=e.values[s].isCalculatedField?this._calculatedFieldSummaryValue(s,C,e):this._getSummaryValue(C[s],this._gridMatrix[f+T][P+d*O+s].Value,r,"count"==this._summaryTypes[s]?"sum":this._summaryTypes[s],e.values[s].format,e.values[s].formatString)),d++;0,P=(i+1)*O+w,ej.isNullOrUndefined(C)||this._colTotCalc.push({uniqueName:this._colKeysCalcValues[i].uniqueName,level:this._colKeysCalcValues[i].level,value:C}),this._colKeysCalcValues[i-1]!=undefined&&this._colKeysCalcValues[i-1].cellType!=undefined&&this._colKeysCalcValues[i-1].cellType.indexOf("SubTot")>-1&&-1==this._colKeysCalcValues[i-1].cellType.indexOf("RGTot")&&($(this._colTotCalc).filter(function(e,t){return t!=undefined&&t.uniqueName!=undefined&&y._colKeysCalcValues[i].uniqueName!=undefined&&t.level!=undefined&&y._colKeysCalcValues[i].level!=undefined&&0===t.uniqueName.indexOf(y._colKeysCalcValues[i].uniqueName)&&y._colKeysCalcValues[i].level+1==t.level}).map(function(t,i){for(var l=0;l<i.value.length;l++)C[l]=ej.isNullOrUndefined(C[l])?0:C[l],i.value[l]=ej.isNullOrUndefined(i.value[l])?0:i.value[l],e.values[l].isCalculatedField?C[l]=ej.PivotAnalysis._calculatedFieldSummaryValue(l,C,e):C[l]+=i.value[l];return C}),ej.isNullOrUndefined(C)||this._colTotCalc.push({uniqueName:this._colKeysCalcValues[i].uniqueName,level:this._colKeysCalcValues[i].level,value:C}))}this._cellType="summary value"}if(this._colKeysCalcValues[i].cellType!=undefined&&this._colKeysCalcValues[i].cellType.indexOf("RGTot")>-1&&0==C&&(this._isPaging||(C=[],S=null,r=0,$(this._colTotCalc).filter(function(e,t){return t!=undefined&&t!=undefined&&t.level!=undefined&&0==t.level}).map(function(t,i){for(var l=0;l<i.value.length;l++)C[l]=ej.isNullOrUndefined(C[l])?0:C[l],i.value[l]=ej.isNullOrUndefined(i.value[l])?0:i.value[l],r++,C[l]=e.values[l].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(l,C,e):ej.PivotAnalysis._getSummaryValue(C[l],i.value[l],r,"count"==y._summaryTypes[l]?"sum":y._summaryTypes[l],e.values[l].format,e.values[l].formatString);return C})),this._cellType="summary value"),this._rowKeysCalcValues[f].cellType!=undefined&&(this._rowKeysCalcValues[f].cellType.indexOf("SubTot")>-1||this._rowKeysCalcValues[f].cellType.indexOf("RGTot")>-1)){if(!this._isPaging){for(C=[],S=null,this._rowKeysCalcValues[f].uniqueName,this._rowKeysCalcValues[f-1]!=undefined&&this._rowKeysCalcValues[f-1].cellType!=undefined&&this._rowKeysCalcValues[f-1].cellType.indexOf("SubTot")>-1&&-1==this._rowKeysCalcValues[f].cellType.indexOf("RGTot")&&(r=0,$(this._rowTotCalc).filter(function(e,t){return t[0]!=undefined&&t[0].uniqueName!=undefined&&y._rowKeysCalcValues[f].uniqueName!=undefined&&t[0].level!=undefined&&y._rowKeysCalcValues[f].level!=undefined&&0===t[0].uniqueName.indexOf(y._rowKeysCalcValues[f].uniqueName)&&y._rowKeysCalcValues[f].level+1==t[0].level}).map(function(t,l){if(l[w+i].length>0){r++;for(var a=0;a<l[w+i].length;a++)C[a]=ej.isNullOrUndefined(C[a])?0:C[a],l[w+i][a]=ej.isNullOrUndefined(l[w+i][a])?0:l[w+i][a],C[a]=e.values[a].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(a,C,e):ej.PivotAnalysis._getSummaryValue(C[a],l[w+i][a],r,"count"==y._summaryTypes[a]?"sum":y._summaryTypes[a],e.values[a].format)}return C})),this._rowKeysCalcValues[f].cellType!=undefined&&this._rowKeysCalcValues[f].cellType.indexOf("RGTot")>-1&&(r=0,$(this._rowTotCalc).filter(function(e,t){return t!=undefined&&t[0]!=undefined&&t[0].level!=undefined&&0==t[0].level}).map(function(t,l){if(l[w+i].length>0){r++;for(var a=0;a<l[w+i].length;a++)C[a]=ej.isNullOrUndefined(C[a])?0:C[a],l[w+i][a]=ej.isNullOrUndefined(l[w+i][a])?0:l[w+i][a],C[a]=e.values[a].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(a,C,e):ej.PivotAnalysis._getSummaryValue(C[a],l[w+i][a],r,"count"==y._summaryTypes[a]?"sum":y._summaryTypes[a],e.values[a].format,e.values[a].formatString)}return C})),r=1,o=M;o<=f+T;o++){for(n=!1,s=0;s<O;s++)d=0,this._gridMatrix[o]!=undefined&&this._gridMatrix[o][w+i*O+s]!=undefined&&this._gridMatrix[o][w+i*O+s].Value!=undefined&&(C[s]==undefined&&(C[s]=0),n=!0,C[s]=e.values[s].isCalculatedField?this._calculatedFieldSummaryValue(s,C,e):this._getSummaryValue(C[s],this._gridMatrix[o][w+i*O+s].Value,r,"count"==this._summaryTypes[s]?"sum":this._summaryTypes[s],e.values[s].format,e.values[s].formatString)),d++;n&&r++}0,L=!0,N&&(this._rowTotCalc[x][0]={uniqueName:this._rowKeysCalcValues[f].uniqueName,level:this._rowKeysCalcValues[f].level},N=!1),this._rowTotCalc[x][w+i]=C}this._cellType="summary value"}if(e.enableAdvancedFilter){var I=0,j=this._currentFilterVal.fieldName?ej.Pivot.getReportItemByFieldName(this._currentFilterVal.fieldName,e):null;null!=j&&"rows"==j.axis&&(I=this._getFilteredIndex(e.rows,e.values,f,this._rowKeysCalcValues)),ej.isNullOrUndefined(I)||null==j||"rows"==j.axis||(I=this._getFilteredIndex(e.columns,e.values,i,this._colKeysCalcValues)),ej.isNullOrUndefined(I)||(h=this._rowKeysCalcValues[f].keys.length>0&&e.rows.length>0&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter.length>0&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter?1:null,u=!(!j||null==j||null==h||e.rows[this._rowKeysCalcValues[f].keys.length-1].fieldName!=j.item.fieldName)&&this._applyValueFilter(e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter,C[I]),this._colKeysCalcValues[i].keys.indexOf("Grand Total")>=0&&u&&this._rowKeysCalcValues[f].uniqueName?this._advancedFilterInfo.push(this._rowKeysCalcValues[f].uniqueName):0==e.columns.length&&u&&this._rowKeysCalcValues[f].uniqueName&&this._advancedFilterInfo.push(this._rowKeysCalcValues[f].uniqueName),c=this._colKeysCalcValues[i].keys.length>0&&e.columns.length>0&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter.length>0&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter?1:null,p=null!=j&&null!=c&&e.columns[this._colKeysCalcValues[i].keys.length-1].fieldName==j.item.fieldName&&this._applyValueFilter(e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter,C[I]),this._colKeysCalcValues[i].uniqueName&&"string"===jQuery.type(this._rowKeysCalcValues[f].keys[0])&&this._rowKeysCalcValues[f].keys[0].indexOf("Grand Total")>-1&&p&&this._advancedFilterInfo.push(this._colKeysCalcValues[i].uniqueName))}for(m=this._isPaging&&e.values.length>0?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,b=_;b<v;b++)C!=undefined&&C.length!=undefined?(g=null,null!=S&&""!=S[b]&&" "!=S[b]&&(g=S[b]),this._gridMatrix[T+f][O*i+b+w-m]={Index:O*i+b+w-m+","+T+f,CSS:this._cellType,Value:C[b],valueText:g,State:0,ColSpan:1,RowSpan:1,Info:"",Span:"None",Expander:0}):this._gridMatrix[T+f][O*i+b+w-m]=0}L&&(x++,M=f+T+1,L=!1)}for(f=0;f<this._rowKeysCalcValues.length;f++)for(i=0;i<this._colKeysCalcValues.length;i++)for(_=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,v=(v=this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length-i==1&&i>0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length:O)<1||this._isPaging&&e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?O:v,b=_;b<v;b++)e.values[b].isCalculatedField&&null==this._gridMatrix[T+f][O*i+b+w-m].Value&&(this._gridMatrix[T+f][O*i+b+w-m].Value=this._calculatedFieldSummaryValue(b,[],e));return this._gridMatrix}},ej.PivotAnalysis.SortOrder={Ascending:"ascending",Descending:"descending",None:"none"},ej.PivotAnalysis.FilterType={Exclude:"exclude",Include:"include"},ej.PivotAnalysis.SummaryType={Sum:"sum",Average:"average",Count:"count",Min:"min",Max:"max"}}(jQuery,Syncfusion)})},1014:function(e,t){e.exports="ej-pivotgrid {\r\n    display: block;\r\n    height: 450px;\r\n    width: 100%; \r\n    overflow: auto;\r\n}\r\n\r\n.e-pivotgrid{\r\n    position: inherit !important;\r\n}"},1022:function(e,t,l){var a,r,o;
/*!
*  filename: ej.pivotgrid.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotgrid.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(i){r=[l(4),l(21),l(65),l(47),l(66),l(415),l(1011),l(96),l(1009),l(1010)],void 0===(o="function"==typeof(a=i)?a.apply(t,r):a)||(e.exports=o)}(function(){!function(e,t,l){t.olap=t.olap||{},t.widget("ejPivotGrid","ej.PivotGrid",{_rootCSS:"e-pivotgrid",element:null,model:null,_requiresID:!0,validTags:["div","span"],defaults:{url:"",cssClass:"",jsonRecords:"",currentReport:"",layout:"normal",analysisMode:"olap",operationalMode:"clientmode",filterType:"filterType",enablePivotFieldList:!0,enableGroupingBar:!1,enableDeferUpdate:!1,enableJSONRendering:!1,enableVirtualScrolling:!1,enablePaging:!1,enableColumnResizing:!1,resizeColumnsToFit:!0,enableContextMenu:!1,enableCellContext:!1,enableRTL:!1,enableDefaultValue:!1,enableToolTip:!0,enableToolTipAnimation:!0,enableCellSelection:!1,enableConditionalFormatting:!1,enableCellEditing:!1,enableColumnGrandTotal:!0,enableRowGrandTotal:!0,enableGrandTotal:!0,enableCollapseByDefault:!1,enableCellDoubleClick:!1,enableCellClick:!1,enableDrillThrough:!1,isResponsive:!1,enableAdvancedFilter:!1,showUniqueNameOnPivotButton:!1,enableMemberEditorPaging:!1,enableMemberEditorSorting:!1,enableXHRCredentials:!1,enableCompleteDataExport:!1,enableCheckStateOnSearch:!0,editCellsInfo:{},hyperlinkSettings:{enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1},headerSettings:{showRowItems:!1,showColumnItems:!1},frozenHeaderSettings:{enableFrozenRowHeaders:!1,enableFrozenColumnHeaders:!1,enableFrozenHeaders:!1,scrollerSize:18},valueSortSettings:{headerText:"",headerDelimiters:"##",sortOrder:t.PivotAnalysis.SortOrder.None},conditionalFormatSettings:[],serviceMethodSettings:{initialize:"InitializeGrid",drillDown:"DrillGrid",exportPivotGrid:"Export",paging:"Paging",fetchMembers:"FetchMembers",nodeStateModified:"NodeStateModified",nodeDropped:"NodeDropped",filtering:"Filtering",sorting:"Sorting",valueSorting:"ValueSorting",deferUpdate:"DeferUpdate",memberExpand:"MemberExpanded",writeBack:"WriteBack",cellEditing:"CellEditing",saveReport:"SaveReport",loadReport:"LoadReportFromDB",calculatedField:"CalculatedField",drillThroughHierarchies:"DrillThroughHierarchies",drillThroughDataTable:"DrillThroughDataTable",removeButton:"RemoveButton"},customObject:{},locale:"en-US",dataSource:{data:null,sourceInfo:"",providerName:"ssas",enableAdvancedFilter:!1,isFormattedValues:!1,reportName:"Default",columns:[],cube:"",catalog:"",rows:[],values:[],filters:[],pagerOptions:{categoricalPageSize:0,seriesPageSize:0,categoricalCurrentPage:0,seriesCurrentPage:0}},pivotTableFieldListID:"",collapsedMembers:null,cellSelection:null,valueCellHyperlinkClick:null,rowHeaderHyperlinkClick:null,columnHeaderHyperlinkClick:null,summaryCellHyperlinkClick:null,beforeServiceInvoke:null,afterServiceInvoke:null,drillThrough:null,drillSuccess:null,cellContext:null,load:null,renderComplete:null,renderFailure:null,renderSuccess:null,cellDoubleClick:null,cellClick:null,applyFieldCaption:null,beforeExport:null,beforePivotEnginePopulate:null,pivotEnginePopulated:null,saveReport:null,loadReport:null,cellEdit:null,memberEditorPageSize:100,maxNodeLimitInMemberEditor:1e3},dataTypes:{dataSource:{data:"data",columns:"array",rows:"array",values:"array",filters:"array"},serviceMethodSettings:{initialize:"enum",drillDown:"enum",exportPivotGrid:"enum",paging:"enum",fetchMembers:"enum",nodeStateModified:"enum",nodeDropped:"enum",filtering:"enum",sorting:"enum",deferUpdate:"enum",memberExpand:"enum",writeBack:"enum",cellEditing:"enum",saveReport:"enum",loadReport:"enum",calculatedField:"enum",drillThroughHierarchies:"enum",drillThroughDataTable:"enum",removeButton:"enum"},customObject:"data"},observables:["layout","enableCellContext","hyperlinkSettings.enableValueCellHyperlink","hyperlinkSettings.enableRowHeaderHyperlink","hyperlinkSettings.enableColumnHeaderHyperlink","hyperlinkSettings.enableSummaryCellHyperlink"],layout:t.util.valueFunction("layout"),enableCellContext:t.util.valueFunction("enableCellContext"),enableValueCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableValueCellHyperlink"),enableRowHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableRowHeaderHyperlink"),enableColumnHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableColumnHeaderHyperlink"),enableSummaryCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableSummaryCellHyperlink"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(e){this._olapReport=e},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=e.parseJSON(t)},_init:function(){this._initPrivateProperties(),this._load()},_destroy:function(){e(this.element).next().length>0&&"e-pGridTooltip"==e(this.element).next()[0].className&&e(this.element).next().remove(),this.element.empty().removeClass("e-pivotgrid"+this.model.cssClass).removeAttr("tabindex"),this._waitingPopup!=l&&this._waitingPopup.destroy(),""==this.element.attr("class")&&this.element.removeAttr("class")},_getExportModel:function(){var i="ExportControl",l={rowCellColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".rowheader").css("color"),rowCellBGColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".rowheader").css("background-color"),columnCellColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".colheader").css("color"),columnCellBGColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".colheader").css("background-color"),valueCellColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("color"))?"rgb(51, 51, 51)":this._cFormat.length<=0?this.element.find(".value").css("color"):"rgb(51, 51, 51)",valueCellBGColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("background-color"))?"rgb(255, 255, 255)":this._cFormat.length<=0?this.element.find(".value").css("background-color"):"rgb(255, 255, 255)",summaryCellColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("color"))?"rgb(51, 51, 51)":this.element.find(".summary").css("color"),summaryCellBGColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")},a=(e.extend(!0,{},this.model),"PivotGrid"),r=(t.PivotGrid.ExportMode.JSON,this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?".xls":".xlsx"),o="",n="",s=!0,d=!1;return{args:{pGridData:null!=this.exportRecords&&""!=this.exportRecords?this.exportRecords:null,rowCount:null!=this._excelLikeJSONRecords?this._excelRowCount:this._rowCount,columnCount:null!=this._excelLikeJSONRecords?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):null!=this.getJSONRecords()?Math.floor(this.getJSONRecords().length/this._rowCount):0,fileFormat:r+(".xls"==r||".xlsx"==r?"~"+d:""),fileName:t.isNullOrUndefined(i)?t.isNullOrUndefined(a)?"PivotGrid":a:i,colorSettings:l,Formatting:this._cFormat,title:o,description:n,language:this.model.locale,multiControlExport:!0,exportWithStyle:s,customObject:JSON.stringify(this.model.customObject)}}},_initPrivateProperties:function(){this._id=this.element.attr("id"),this._olapReport="",this._JSONRecords=null,this._excelLikeJSONRecords=null,this._drillCaption="",this._drillAction="",this._startDrilldown=!1,this._pagerObj=null,this._seriesPageCount=null,this._categPageCount=null,this._seriesCurrentPage=1,this._categCurrentPage=1,this._drillHeaders={row:[],column:[]},this._collapsedRowHeaders=[],this._isDragging=!1,this._droppedClass="",this._dataModel="",this._ascdes="",this._filterUpdate=[],this._pivotRow=[],this._pivotColumn=[],this._pivotCalculation=[],this._pivotFilter=[],this._pivotTableFields=[],this._schemaData=null,this._waitingPopup=null,this._oriX=null,this._oriY=null,this._sortType="",this._startPosCell=null,this._startCellPosition=null,this._maxViewLoading=null,this._list=[],this._formatEdit=!1,this._formatName=[],this._formatName.push(this._getLocalizedLabels("AddNew")),this._rowCount=0,this._excelRowCount=0,this._dialogTitle="",this._selectedField="",this._selectedAxis="",this._isUpdateRequired=!1,this._isMembersFiltered=!1,this._selectedCell=null,this._onholdKey="",this._primaryCellPos="",this._prevDrillElements=[],this._currentReportItems=[],this._savedReportItems=[],this._rowHeader=[],this._colHeader=[],this._cellInfo=[],this._editorFlag=!0,this._isSubTotalHide=!1,this._isSubTotalhidden=!1,this._dimension,this._calculatedField=[],this._isFormatApply=!1,this._cFormat=[],this._curFocus={cell:null,tab:null,tree:null,cformat:null,grp:null,selection:null,filter:null,field:null,formula:null},this._index={index:0,grp:1,cell:1,dialog:1,paging:1,cformat:1,filter:0,field:0,formula:0},this._dataSet=[],this._currentCell=-1,this._target=null,this._orgX=null,this._orgY=null,this._expand=!1,this._excelFilterInfo=[],this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}},this._isSchemaInitialize=!0,this._fieldMembers={},this._fieldSelectedMembers={},this._allMember="",this._selectedMeasure="",this._selectedFormat="",this._dialogName="",this._pivotClientObj=null,this._memberPageSettings={currentMemeberPage:1,startPage:0,endPage:0},this._memberSearchPageSettings={currentMemberSearchPage:1,startSearchPage:0,endSearchPage:0},this._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0},this._isAllMemberChecked=!0,this._editorTreeData=[],this._editorSearchTreeData=[],this._editorDrillTreeData={},this._editorDrillTreePageSettings={},this._lastSavedTree=[],this._onDemandNodeExpand=!0,this._isSearchApplied=!1,this._isEditorDrillPaging=!1,this._isEditorCollapseDrillPaging=!1,this._isSchemaClick=!1,this._memberPagingAvdData=[],this._table="",this._drillParams={currRow:"",currCol:"",currPos:""},this._croppedJson=[],this._compJson=[],this._isNavigation=!1,this._isOptionSearch=!1,this._isSelectSearchFilter=!0,this._currentFilterList={},this._rawData=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._isExporting=!1,this._fullExportedData={},this._pivotEngine=null,this._isXMLImport=!1,this._isFilterBtnClick=!1,this._parentNodeCollection={},this._parentSearchNodeCollection={},this._initialSlicerName=""},_load:function(){var i,l,a={element:this.element,customObject:this.model.customObject};if((this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&(this.model.dataSource.enableAdvancedFilter=this.model.enableAdvancedFilter=!0),this.model.enableCellEditing&&this.model.enableCellSelection&&(this.model.enableCellSelection=!1),this._trigger("load",a),this.element.addClass(this.model.cssClass),e(this.element).parents(".e-pivotclient").length>0?(this._pivotClientObj=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+this._pivotClientObj._id+"_maxView")[0]&&e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}),t.isNullOrUndefined(this._waitingPopup)&&!t.isNullOrUndefined(this._pivotClientObj._waitingPopup)&&(this._waitingPopup=this._pivotClientObj._waitingPopup),this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)&&(this.element.ejWaitingPopup({showOnInit:!0}),this._waitingPopup=this.element.data("ejWaitingPopup")),this._waitingPopup.show(),this.model.enableJSONRendering)this.setJSONRecords(this.model.jsonRecords),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON();else if(t.isNullOrUndefined(this.model.dataSource.data)&&""==this.model.url&&!t.isNullOrUndefined(this._pivotClientObj))this.renderControlFromJSON(),this._waitingPopup.hide();else if(null==this.model.dataSource.data&&""!=this.model.url||null!=this.model.dataSource.data&&""!=this.model.url&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)this.model.operationalMode=t.Pivot.OperationalMode.ServerMode,t.isNullOrUndefined(this.model.beforeServiceInvoke)||this._trigger("beforeServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),i=JSON.stringify(this.model.customObject),this.model.enableVirtualScrolling&&(this.model.layout=t.PivotGrid.Layout.NoSummaries),null!=this.element[0]&&this.element.parents().find(".e-controlPanel").length>0&&""!=this.layout()&&this.layout()!=t.PivotGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",currentReport:this.model.currentReport,gridLayout:this.layout(),customObject:i}),this._renderControlSuccess):null!=this.element[0]&&this.element.parents().find(".e-controlPanel").length>0?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick||this.model.enableCellClick||this.model.enableDrillThrough?"initializeGrid:getDataSet":"initializeGrid",currentReport:this.model.currentReport,customObject:i}),this._renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick||this.model.enableCellClick||this.model.enableDrillThrough?this.model.enableCollapseByDefault&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"initializeGrid:getDataSet:collapseByDefault":"initializeGrid:getDataSet":this.model.enableCollapseByDefault&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"initializeGrid:collapseByDefault":"initializeGrid",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:i}),this._renderControlSuccess);else if(this.model.operationalMode=t.Pivot.OperationalMode.ClientMode,""!=this.model.dataSource.cube)this.model.analysisMode=t.Pivot.AnalysisMode.Olap,this._trigger("beforePivotEnginePopulate",{pivotGridObj:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this);else if(null!=this.model.dataSource.data){for(!1,l=0;l<this.model.dataSource.rows.length;l++)this._applyGrouping("rows",l)&&l--;for(l=0;l<this.model.dataSource.columns.length;l++)this._applyGrouping("columns",l)&&l--;for(l=0;l<this.model.dataSource.values.length;l++)this._applyGrouping("values",l)&&l--;for(l=0;l<this.model.dataSource.filters.length;l++)this._applyGrouping("filters",l)&&l--;this.model.analysisMode=t.Pivot.AnalysisMode.Pivot,t.PivotAnalysis.setFieldCaptions(this.model.dataSource),this._populatePivotGrid()}},_formatChange:function(e,t,i){var l,a=t.split(i);return a[0].indexOf("M")>-1&&a[1].indexOf("d")>-1||a[1].indexOf("M")>-1&&a[2].indexOf("d")>-1?e:a[1].indexOf("M")>-1&&a[0].indexOf("d")>-1?(l=e.split(i))[1]+i+l[0]+i+l[2]:a[2].indexOf("M")>-1&&a[0].indexOf("d")>-1?(l=e.split(i))[2]+i+l[0]+i+l[1]:a[2].indexOf("M")>-1&&a[1].indexOf("d")>-1?(l=e.split(i))[2]+i+l[1]+i+l[0]:a[0].indexOf("M")>-1&&a[2].indexOf("d")>-1?(l=e.split(i))[0]+i+l[2]+i+l[1]:void 0},_applyGrouping:function(e,i){var a,r;this._rawData=this.model.dataSource.data;var o=this.model.dataSource.data,n=-1,s=!1;for(n=-1,a=0;"date"==this.model.dataSource[e][i].format&&this.model.dataSource[e][i].formatString!=l&&this.model.dataSource[e][i].delimiter!=l&&this.model.dataSource[e][i].groupByDate!=l&&a<this.model.dataSource[e][i].groupByDate.interval.length;a++){var d=this.model.dataSource[e][i].groupByDate.interval[a].indexOf("MM")>-1&&-1==this.model.dataSource[e][i].groupByDate.interval[a].indexOf("dd")?this._getLocalizedLabels("Months"):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("dd")>-1?this._getLocalizedLabels("Days"):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("qq")>-1?this._getLocalizedLabels("Quarters"):this._getLocalizedLabels("Years"),h=this.model.dataSource[e][i].formatString,u=this.model.dataSource[e][i].delimiter,c={fieldName:d+" ("+this.model.dataSource[e][i].fieldName+")",fieldCaption:d+" ("+this.model.dataSource[e][i].fieldName+")"};for(this.model.dataSource[e].push(c),r=0;r<o.length;r++)o[r][c.fieldName]=this.model.dataSource[e][i].groupByDate.interval[a].indexOf("MM")>-1&&-1==this.model.dataSource[e][i].groupByDate.interval[a].indexOf("DD")?t.PivotAnalysis._setFormat(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,u),this.model.dataSource[e][i].format,this.model.dataSource[e][i].groupByDate.interval[a]):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("dd")>-1?t.PivotAnalysis._setFormat(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,u),this.model.dataSource[e][i].format,this.model.dataSource[e][i].groupByDate.interval[a]):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("qq")>-1?("qq"==this.model.dataSource[e][i].groupByDate.interval[a]?this._getLocalizedLabels("Qtr")+" "+u:this._getLocalizedLabels("Quarter")+" "+u)+this._getQuarter(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,u)):t.PivotAnalysis._setFormat(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,u),this.model.dataSource[e][i].format,this.model.dataSource[e][i].groupByDate.interval[a]);n=i}return-1!=n&&(this.model.dataSource[e].splice(i,1),s=!0),s},_getQuarter:function(e){if(jQuery.isNumeric(e))t=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime());else if("Invalid Date"!=new Date(e))var t=new Date(e);else t=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime());return Math.floor((t.getMonth()+3)/3)},refreshControl:function(){t.Pivot.openPreventPanel(this),this._trigger("beforePivotEnginePopulate",{pivotObject:this}),this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._controlObj=this,this._pivotEngine=t.PivotAnalysis.pivotEnginePopulate(this.model),this.setJSONRecords(JSON.stringify(this._pivotEngine.json)),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this._pivotEngine.json):this.renderControlFromJSON(this._pivotEngine.json),this._trigger("renderSuccess",this)):t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)},_setCaptions:function(){e.each(this.model.dataSource.rows,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)}),e.each(this.model.dataSource.columns,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)}),e.each(this.model.dataSource.filters,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)}),e.each(this.model.dataSource.values,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)})},refreshFieldCaption:function(e,t,i){var l;if(i.indexOf("row")>=0)for(l=0;l<this.model.dataSource.rows.length;l++)e==this.model.dataSource.rows[l].fieldName&&(this.model.dataSource.rows[l].fieldCaption=t);else if(i.indexOf("calc")>=0)for(l=0;l<this.model.dataSource.values.length;l++)e==this.model.dataSource.values[l].fieldName&&(this.model.dataSource.values[l].fieldCaption=t);else if(i.indexOf("col")>=0)for(l=0;l<this.model.dataSource.columns.length;l++)e==this.model.dataSource.columns[l].fieldName&&(this.model.dataSource.columns[l].fieldCaption=t);else for(l=0;l<this.model.dataSource.filters.length;l++)e==this.model.dataSource.filters[l].fieldName&&(this.model.dataSource.filters[l].fieldCaption=t);for(l=0;l<this._pivotTableFields.length;l++)e==this._pivotTableFields[l].name&&(this._pivotTableFields[l].caption=t)},refreshPivotGrid:function(){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this.getOlapReport()&&(this.model.dataSource.rows&&(this.model.dataSource.rows=this.getOlapReport().rows),this.model.dataSource.columns&&(this.model.dataSource.columns=this.getOlapReport().columns),this.model.dataSource.filters&&(this.model.dataSource.filters=this.getOlapReport().filters),this.model.dataSource.values&&(this.model.dataSource.values=this.getOlapReport().values)),this.model.editCellsInfo={},this._populatePivotGrid()):(this._trigger("beforePivotEnginePopulate",{olapObject:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)):this._load()},_populatePivotGrid:function(){var i,l,a,r,o;for(this._trigger("beforePivotEnginePopulate",{pivotObject:this}),i=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,l=e.grep(this.model.dataSource.values,function(e){return 1==e.isCalculatedField}),this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField}),a=0;a<l.length;a++)r=l[a].formula,0==e.grep(this._calculatedField,function(e){return e.name==l[a].fieldName}).length&&(r=r.replace(/\s+|\s+$/gm,""),r=(r=this._parenthesisAsterisk(r)).replace(/[-+/^%*]/g,function(e){return" "+e+" "}),this._calculatedField.push({name:l[a].fieldName,formula:r,format:l[a].format,formatString:l[a].formatString})),l[a].formula=r,this.model.dataSource.values.push(l[a]);t.PivotAnalysis._controlObj=this,o=t.PivotAnalysis.pivotEnginePopulate(this.model),this.setJSONRecords(JSON.stringify(o.json)),this.setOlapReport(this.model.dataSource),this._createGroupingBar(this.model.dataSource),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(o.json):this.renderControlFromJSON(),t.isNullOrUndefined(i)||(i._isTimeOut=!1),this._waitingPopup.hide(),this._trigger("renderSuccess",this),t.isNullOrUndefined(this._pivotClientObj)||void 0===this._pivotClientObj._pivotSchemaDesigner||(this._schemaData=this._pivotClientObj._pivotSchemaDesigner),null!=this._schemaData&&(t.isNullOrUndefined(this._schemaData._waitingPopup)?this._waitingPopup.hide():this._schemaData._waitingPopup.hide(),this._calculatedField.length>0&&this._schemaCalculatedField())},_setFirst:!1,_setModel:function(i){for(var l in i)switch(l){case"OlapReport":case"JsonData":this.setOlapReport(i[l]);break;case"RefreshOlapGrid":this.element.renderControlFromJSON(i[l]);break;case"layout":this.layout(t.util.getVal(i[l])),this._load();break;case"customObject":this.model.customObject=i[l];break;case"enableCellContext":this.enableCellContext(t.util.getVal(i[l])),this._load();break;case"enableDefaultValue":this.model.enableDefaultValue=i[l];break;case"hyperlinkSettings":!t.isNullOrUndefined(t.util.getVal(i[l]).enableValueCellHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableValueCellHyperlink)?this.enableValueCellHyperlink(i[l].enableValueCellHyperlink()):t.isNullOrUndefined(i[l].enableValueCellHyperlink)||this.enableValueCellHyperlink(i[l].enableValueCellHyperlink),!t.isNullOrUndefined(t.util.getVal(i[l]).enableRowHeaderHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableRowHeaderHyperlink)?this.enableRowHeaderHyperlink(i[l].enableRowHeaderHyperlink()):t.isNullOrUndefined(i[l].enableRowHeaderHyperlink)||this.enableRowHeaderHyperlink(i[l].enableRowHeaderHyperlink),!t.isNullOrUndefined(t.util.getVal(i[l]).enableColumnHeaderHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableColumnHeaderHyperlink)?this.enableColumnHeaderHyperlink(i[l].enableColumnHeaderHyperlink()):t.isNullOrUndefined(i[l].enableColumnHeaderHyperlink)||this.enableColumnHeaderHyperlink(i[l].enableColumnHeaderHyperlink),!t.isNullOrUndefined(t.util.getVal(i[l]).enableSummaryCellHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableSummaryCellHyperlink)?this.enableSummaryCellHyperlink(i[l].enableSummaryCellHyperlink()):t.isNullOrUndefined(i[l].enableSummaryCellHyperlink)||this.enableSummaryCellHyperlink(i[l].enableSummaryCellHyperlink),this._load();break;case"operationalMode":this.model.operationalMode=i[l];break;case"analysisMode":this.model.analysisMode=i[l];break;case"locale":this.locale(t.util.getVal(i[l])),this._load();break;case"dataSource":this.model.dataSource=e.extend({},this.model.dataSource,i[l]),this.refreshControl(),this._schemaData&&this._schemaData._load();break;case"enableGroupingBar":case"enableDeferUpdate":this.model.enableGroupingBar=i[l],this._load();break;case"enableJSONRendering":this.model.enableJSONRendering=i[l],this._load();break;case"enableVirtualScrolling":this.model.enableVirtualScrolling=i[l],this._load();break;case"enablePaging":this.model.enablePaging=i[l],this._load();break;case"enableColumnResizing":this.model.enableColumnResizing=i[l],this._load();break;case"resizeColumnsToFit":this.model.resizeColumnsToFit=i[l],this.renderControlFromJSON();break;case"enableContextMenu":this.model.enableContextMenu=i[l],this._load();break;case"enableRTL":this.model.enableRTL=i[l],this._load();break;case"enableToolTip":this.model.enableToolTip=i[l];break;case"enableToolTipAnimation":this.model.enableToolTipAnimation=i[l];break;case"enableCellSelection":this.model.enableCellSelection=i[l],this._load();break;case"enableConditionalFormatting":this.model.enableConditionalFormatting=i[l],this._load();break;case"enableCellEditing":this.model.enableCellEditing=i[l],this._load();break;case"enableColumnGrandTotal":this.model.enableColumnGrandTotal=i[l],this._load();break;case"enableRowGrandTotal":this.model.enableRowGrandTotal=i[l],this._load();break;case"enableGrandTotal":this.model.enableGrandTotal=i[l],this._load();break;case"enableCollapseByDefault":this.model.enableCollapseByDefault=i[l],this._load();break;case"enableCellDoubleClick":this.model.enableCellDoubleClick=i[l],this._load();break;case"enableDrillThrough":this.model.enableDrillThrough=i[l],this._load();break;case"isResponsive":this.model.isResponsive=i[l],this._load();break;case"enableAdvancedFilter":this.model.enableAdvancedFilter=i[l],this._load();break;case"showUniqueNameOnPivotButton":this.model.showUniqueNameOnPivotButton=i[l],this._load();break;case"enableMemberEditorPaging":this.model.enableMemberEditorPaging=i[l],this._load();break;case"frozenHeaderSettings":this.model.frozenHeaderSettings=e.extend({},this.model.frozenHeaderSettings,i[l]),this.refreshControl();break;case"valueSortSettings":this.model.valueSortSettings=e.extend({},this.model.valueSortSettings,i[l]),this.refreshControl()}},_wireEvents:function(){this.model.enableCellDoubleClick&&this._on(this.element,"dblclick",".value, .summary",this._cellRangeInfo),this.model.enableCellClick&&this._on(this.element,"click",".value, .summary",this._cellRangeInfo),this._on(this.element,"mouseover",".value,.rowheader,.colheader,.summary",t.proxy(function(i){var l,a,r;e(i.target).hasClass("cellValue")||e(i.target).children().hasClass("cellValue")||(l=e(i.target).contents().filter(function(){return 3==this.nodeType}),t.isNullOrUndefined(l.text())||""==e.trim(l.text())||(r=(a=e(i.target).find(".valueSorting").length>0)?e(i.target).find(".valueSorting"):"",e(i.target).find(".valueSorting").remove(),e(i.target).contents().filter(function(){return 3==this.nodeType}).remove(),e(i.target).append("<span class='cellValue'>"+l.text()+"</span>"),a&&(e(i.target).hasClass("colheader")||e(i.target).hasClass("summary"))&&e(i.target).hasClass("calc")&&!e(i.target).hasClass("rowheader")&&e(i.target).append(r)))})),this._on(this.element,"contextmenu",".value,.rowheader,.colheader,.summary",t.proxy(function(i){var l;if(this.model.enableContextMenu&&t.isNullOrUndefined(this._pivotClientObj)&&!this.model.enableCellContext){i.preventDefault();var a,r,o="",n="";r=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?"<li><a>"+this._getLocalizedLabels("Layouts")+"</a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"</a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"</a><li></ul></li>":this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?"<li><a>"+this._getLocalizedLabels("Layouts")+"</a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"</a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"</a><li><li id='noSummariesLayout'><a>"+this._getLocalizedLabels("NoSummaries")+"</a><li></ul></li>":"<li><a>"+this._getLocalizedLabels("Layouts")+"</a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"</a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"</a><li><li id='noSummariesLayout'><a>"+this._getLocalizedLabels("NoSummaries")+"</a><li><li id='normalTopSummaryLayout'><a>"+this._getLocalizedLabels("NormalTopSummary")+"</a><li></ul></li>",a=this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode?t.buildTag("li.e-advancedFiltering",t.buildTag("a",this._getLocalizedLabels("AdvancedFiltering"))[0].outerHTML)[0].outerHTML:"",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(n=t.buildTag("li.e-collapseByDefault",t.buildTag("a",this._getLocalizedLabels("CollapseByDefault"))[0].outerHTML)[0].outerHTML),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(o=t.buildTag("li.e-numberFormatting",t.buildTag("a",this._getLocalizedLabels("NumberFormatting"))[0].outerHTML)[0].outerHTML);var s="<li><a>"+this._getLocalizedLabels("HyperLink")+"</a><ul><li id='rowHeader'><a>"+this._getLocalizedLabels("EnableRowHeaderHyperlink")+"</a></li><li id='columnHeader'><a>"+this._getLocalizedLabels("EnableColumnHeaderHyperlink")+"</a></li><li id='valueCell'><a>"+this._getLocalizedLabels("EnableValueCellHyperlink")+"</a></li><li id='summaryCell'><a>"+this._getLocalizedLabels("EnableSummaryCellHyperlink")+"</a></li></ul></li>",d="<li><a>"+this._getLocalizedLabels("Exporting")+"</a><ul><li id='excel'><a>"+this._getLocalizedLabels("Excel")+"</a></li><li id='word'><a>"+this._getLocalizedLabels("Word")+"</a></li><li id='pdf'><a>"+this._getLocalizedLabels("PDF")+"</a></li><li id='csv'><a>"+this._getLocalizedLabels("CSV")+"</a></li></ul></li>",h="<li class='e-separator'><a>"+this._getLocalizedLabels("FrozenHeader")+"</a><ul><li id='row'><a>"+this._getLocalizedLabels("Row")+"</a></li><li id='column'><a>"+this._getLocalizedLabels("Column")+"</a></li></ul></li>",u=t.buildTag("ul#"+this._id+"contextMenu.e-pivotGridContextMenu",t.buildTag("li.e-cellSelect",t.buildTag("a",this._getLocalizedLabels("CellSelection"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-columnResize",t.buildTag("a",this._getLocalizedLabels("ColumnResize"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-toolTip",t.buildTag("a",this._getLocalizedLabels("ToolTip"))[0].outerHTML)[0].outerHTML+n+a+t.buildTag("li.groupingBar",t.buildTag("a",this._getLocalizedLabels("GroupingBar"))[0].outerHTML)[0].outerHTML+("pivot"==this.model.analysisMode?t.buildTag("li.e-cellEditing",t.buildTag("a",this._getLocalizedLabels("CellEditing"))[0].outerHTML)[0].outerHTML:"")+t.buildTag("li.e-drillThrough",t.buildTag("a",this._getLocalizedLabels("DrillThrough"))[0].outerHTML)[0].outerHTML+t.buildTag("li.rtl",t.buildTag("a",this._getLocalizedLabels("RTL"))[0].outerHTML)[0].outerHTML+r+s+d+h+t.buildTag("li.e-summaryCustomize",t.buildTag("a",this._getLocalizedLabels("SummaryCustomization"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-conditionalFormat",t.buildTag("a",this._getLocalizedLabels("ConditionalFormatting"),{})[0].outerHTML)[0].outerHTML+("pivot"==this.model.analysisMode?t.buildTag("li.e-calculatedField",t.buildTag("a",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML+o+(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?t.buildTag("li.e-summaryTypes",t.buildTag("a",this._getLocalizedLabels("SummaryTypes"),{})[0].outerHTML)[0].outerHTML:""):""))[0].outerHTML;e("#"+this._id).append(u),e("li.rtl").addClass("e-separator"),l=this.element.find(".e-pivotGridTable"),this.element.find("#"+this._id+"contextMenu").ejMenu({width:"200px",menuType:t.MenuType.ContextMenu,contextMenuTarget:l,enableRTL:this.model.enableRTL,click:t.proxy(this._contextMenuClick,this)}),this._stateMaintenance()}})),this._on(e(document),"keydown",this._keyDownPress),this._on(e(document),"keyup",this._keyUpPress),this._on(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this.model.enableCellSelection&&(this._on(this.element,"mousedown touchstart",".value",this._initCellSelection),this._on(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection)),1==this.enableCellContext()&&(document.addEventListener?(document.removeEventListener("contextmenu",this._cellContext,!1),document.addEventListener("contextmenu",this._cellContext,!1)):(document.detachEvent("oncontextmenu",this._cellContext),document.attachEvent("oncontextmenu",this._cellContext))),this._on(this.element,"mouseover",".e-pivotButton",t.proxy(function(e){this._isDragging&&(this.element.append(t.buildTag("span.e-dropIndicator e-dropIndicatorActive")[0].outerHTML),e.target.className.indexOf("e-pivotButton")>=0?this.element.find(".e-dropIndicator").css("top",e.target.getBoundingClientRect().top-20).css("left",e.target.getBoundingClientRect().left-3):this.element.find(".e-dropIndicator").css("top",e.target.parentElement.getBoundingClientRect().top-20).css("left",e.target.parentElement.getBoundingClientRect().left-3))},this)),this._on(this.element,"mouseleave",".e-pivotButton",t.proxy(function(){this._isDragging&&this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorActive")},this)),this._on(this.element,"click","#preventDiv",t.proxy(function(){this.element.find(".e-dialog.e-advancedFilterDlg:visible").length>0&&(this.element.find(".e-dialog.e-advancedFilterDlg").hide(),this.element.find("#preventDiv").remove())},this)),this.model.enableCellEditing&&this._on(this.element,"mousedown",".value",this._initCellEditing),this.drillDownHandler=e.proxy(this._drillDown,this),this.addHyperlinkHandler=e.proxy(this._addHyperlink,this),this.removeHyperlinkHandler=e.proxy(this._removeHyperlink,this),this.model.enableCellSelection&&(e(document).on("click",this._clearSelection),e(document).on("keyup",this._endCellSelection),e(document).on("keydown",this._startCellSelection)),this._on(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.addHyperlinkHandler),this._on(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.removeHyperlinkHandler),this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",function(i){if(-1!=i.target.className.indexOf("hyperlink")){var l=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i.target.parentElement).attr("data-i"):e(i.target.parentElement).attr("data-p"),a=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))].Info:this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._excelRowCount+parseInt(l.split(",")[1]))].Info,r={cellValue:i.target.innerHTML,cellPosition:l,cellType:i.target.parentElement.className.split(" ")[0],uniqueName:a.split("::")[0],args:i,rawdata:a};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&i.target.parentElement.className.indexOf("summary")>=0||i.target.parentElement.className.indexOf("summary value")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("value")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("rowheader")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("colheader")>=0&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r})),i.target.parentElement.className.indexOf("value")>=0&&this.model.enableDrillThrough&&(this._rowHeader=[],this._colHeader=[],this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.Pivot._drillThroughCellClick(i,this):this._cellRangeInfo(i))}}),this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?".rowheader, .colheader, .summary":".rowheader, .colheader",function(i){var l,a,r,o,n,s,d,h;if(this.model.enableCellSelection&&(!e(i.target).hasClass("cellValue")||!e(i.target).hasClass("hyperlinkHeaderCell")))if(l=e(i.target).hasClass("cellValue")?i.target.parentElement:i.target,i.shiftKey){if(window.getSelection().removeAllRanges(),e(this.element).find(".e-selected").removeClass("e-selected"),a=e(this._selectedCell).attr("data-p"),r=e(l).attr("data-p"),(e(l).hasClass("rowheader")||"rowheader"==e(l).attr("role"))&&(e(this._selectedCell).hasClass("rowheader")||"rowheader"==e(this._selectedCell).attr("role")))for(s=Math.min(a.split(",")[1],r.split(",")[1]);s<=Math.max(a.split(",")[1],r.split(",")[1]);s++)this.element.find("[data-p='"+a.split(",")[0]+","+s+"']").addClass("e-selected");if((e(l).hasClass("colheader")||"columnheader"==e(l).attr("role"))&&(e(this._selectedCell).hasClass("colheader")||"columnheader"==e(this._selectedCell).attr("role")))for(s=Math.min(a.split(",")[0],r.split(",")[0]);s<=Math.max(a.split(",")[0],r.split(",")[0]);s++)this.element.find("[data-p='"+s+","+a.split(",")[1]+"']").addClass("e-selected");if((o=e(this.element).find(".e-selected")).length>0){for(n=[],s=0;s<o.length;s++)d=e(o[s]).attr("data-p"),(h=this.getJSONRecords()[parseInt(parseInt(d.split(",")[0])*this._rowCount+parseInt(d.split(",")[1]))]).Value=e.trim(e(o[s]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(h.Field=this._getFieldName(o[s])),n.push(h);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:n}):this._pivotClientObj._trigger("cellSelection",n)}}else i.ctrlKey||e(this.element).find(".e-selected").removeClass("e-selected"),(e(l).hasClass("colheader")||e(l).hasClass("rowheader")||"rowheader"==e(l).attr("role")||"columnheader"==e(l).attr("role"))&&(i.ctrlKey?e(l).toggleClass("e-selected"):e(l).addClass("e-selected"),this._selectedCell=l,this._primaryCellPos=e(l).attr("data-p"),(h=this.getJSONRecords()[parseInt(parseInt(this._primaryCellPos.split(",")[0])*this._rowCount+parseInt(this._primaryCellPos.split(",")[1]))]).Value=e.trim(e(l).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(h.Field=this._getFieldName(l)),i.ctrlKey||(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:[h]}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:[h]})))}),t.isNullOrUndefined(this._pivotClientObj)?this._on(this.element,"click","table .e-expand,table .e-collapse",t.proxy(this._drillDown,this)):this._pivotClientObj.model.enableDeferUpdate||this._on(this.element,"click","table .e-expand,table .e-collapse",t.proxy(this._drillDown,this)),this._on(this.element,"mouseover",".colheader, .rowheader, .e-expand, .e-collapse",function(t){if(t.target.className.indexOf("e-expand")>-1&&!e(t.target).hasClass("header-hover-expand"))e(t.target).addClass("header-hover-expand");else if(t.target.className.indexOf("e-collapse")>-1&&!e(t.target).hasClass("header-hover-collapse"))e(t.target).addClass("header-hover-collapse");else if((t.target.className.indexOf("e-expand")<0||t.target.className.indexOf("e-collapse")<0)&&e(t.target).children("span").length>0){var i=e(t.target).children("span")[0];!e(i).hasClass("header-hover-expand")&&i.className.indexOf("e-expand")>-1?e(i).addClass("header-hover-expand"):!e(i).hasClass("header-hover-collapse")&&i.className.indexOf("e-collapse")>-1&&e(i).addClass("header-hover-collapse")}}),this._on(this.element,"mouseleave",".colheader, .rowheader, .e-expand, .e-collapse",function(){this.element.find(".e-expand, .e-collapse").removeClass("header-hover-expand header-hover-collapse")}),this.model.enableToolTip&&(this._on(this.element,"mouseover",".value",this._applyToolTip),this._on(this.element,"mouseleave",".value",function(){this.model.enableToolTipAnimation?e("#"+this._id+"_gridTooltip").hide("slow"):e("#"+this._id+"_gridTooltip").hide()})),this.model.enableDrillThrough&&e.proxy(this._addHyperlink,this),this._on(this.element,"click",".filter",t.proxy(this._filterBtnClick,this)),this._on(this.element,"click",".e-sorting",t.proxy(this._sortBtnClick,this)),this._on(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this)),this._on(this.element,"click",".e-removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this)),this._on(this.element,"click",".e-ascOrder, .e-descOrder",t.proxy(this._sortField,this)),this._on(this.element,"mouseover",".e-pvtBtn",function(t){e(t.target.parentElement).addClass("e-btn e-select")}),this._on(this.element,"mouseleave",".e-pvtBtn",function(t){e(t.target.parentElement).removeClass("e-btn e-select"),e(t.target).removeClass("e-hoverBtn")}),this._on(this.element,"mouseover",".e-pivotButton",function(t){t.target.title=t.target.textContent,e(t.target).find("button").addClass("e-hoverBtn")}),this._on(this.element,"mouseleave",".e-pivotButton",function(t){e(t.target).find("button").removeClass("e-hoverBtn")}),this._on(this.element,"mouseover",".filter,.e-sorting,.e-removeBtn",function(t){e(t.target.parentElement).find("button").addClass("e-hoverBtn")}),this._on(this.element,"mouseleave",".filter,.e-sorting,.e-removeBtn",function(t){e(t.target.parentElement).find("button").removeClass("e-hoverBtn")}),this._on(this.element,"mouseleave",".value,.rowheader,.colheader,.summary",t.proxy(function(t){var i,l,a=e(t.target).find(".cellValue").contents().filter(function(){return 3==this.nodeType});0!=a.text()&&(l=(i=e(t.target).find(".valueSorting").length>0)?e(t.target).find(".valueSorting"):"",e(t.target).find(".valueSorting").remove(),e(t.target).find(".cellValue").remove(),e(t.target).append(a.text()),i&&(e(t.target).hasClass("colheader")||e(t.target).hasClass("summary"))&&e(t.target).hasClass("calc")&&!e(t.target).hasClass("rowheader")&&e(t.target).append(l))})),this._on(this.element,"click",".e-close",t.proxy(function(){this.element.find("#preventDiv").remove()})),this._on(this.element,"click",".e-dialogOkBtn",t.proxy(this._dialogOKBtnClick,this)),(this.model.enableContextMenu||e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen)&&(this._on(this.element,"click",".e-cellSelect",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-columnResize",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-excelLikeLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-advancedFiltering",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-toolTip",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-collapseByDefault",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".rtl",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-calculatedField",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-cellEditing",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-conditionalFormat",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryCustomize",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryTypes",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-numberFormatting",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-rowHeaderHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-colHeaderHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-valueCellHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryCellHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-rowFreeze",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-colFreeze",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-excel",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-word",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-pdf",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".csv",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-normalLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-normalTopSummaryLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-noSummariesLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-drillThrough",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".groupingBar",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-frozenHeaders",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-exporting",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-hyperlinkOptions",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-layouts",t.proxy(this._createMenuIcons,this)),e(document).click(function(t){-1==t.target.className.indexOf("e-hyperlinkOptions")&&e(".e-hyperLinkDialog").remove(),-1==t.target.className.indexOf("e-exporting")&&e(".e-exportDialog").remove(),-1==t.target.className.indexOf("e-frozenHeaders")&&e(".e-frozenDialog").remove(),-1==t.target.className.indexOf("e-layouts")&&e(".e-layoutsDialog").remove()})),this._on(this.element,"click",".e-dialogCancelBtn",t.proxy(function(){this.element.find(".e-dialog, .e-clientDialog").hide(),e("#preventDiv").remove()})),this.model.enableColumnResizing&&(this._on(this.element,"mousemove",t.proxy(function(e){this._colResizing(e)})),this._on(this.element,"mousedown","thead,.pivotGridFrozenTable,.pivotGridColValueTable",t.proxy(function(e){this._startColResizing(e)})),this._on(this.element,"mouseup",".e-reSizeColbg",t.proxy(function(e){this._endColResizing(e)}))),this._on(this.element,"click",".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage",t.proxy(this._navigateTreeData,this)),this._on(this.element,"click",".e-searchEditorTree",t.proxy(function(e){t.Pivot._searchEditorTreeNodes(e,this)},this)),this._on(this.element,"click",".colheader,.cstot,.cgtot,.calc,.stot,.gtot",t.proxy(function(i){var l,a,r,o,n,s;if(e(i.target).hasClass("e-collapse")||e(i.target).hasClass("e-expand"))return!1;if(!t.isNullOrUndefined(this.model.valueSortSettings)&&!t.isNullOrUndefined(this.model.valueSortSettings.sortOrder)&&"none"!=this.model.valueSortSettings.sortOrder&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.values.length>0||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0)){if(l=this.model.valueSortSettings.sortOrder,(a=e(i.target).hasClass("cellValue")||e(i.target).hasClass("valueSorting")||e(i.target).hasClass("e-expand")||e(i.target).hasClass("e-collapse")?e(i.target).parent():e(i.target)).hasClass("calc")||(a=e(this.element).find("[data-p='"+(Number(a.attr("data-p").split(",")[0])+Number(a.attr("colspan"))-1)+","+(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns.length:JSON.parse(this.getOlapReport()).PivotColumns.length)+"']")[0]),l=e(a).find(".valueSorting").length>0?e(a).find(".valueSorting").hasClass("descending")?"ascending":"descending":l,this.element.find(".valueSorting").remove(),0!=e(a).find(".valueSorting").length||e(a).hasClass("rowheader")?e(a).find(".valueSorting").removeClass("ascending").removeClass("descending").addClass(l):(r=t.buildTag("span.valueSorting e-icon "+l).css("margin-left","5px").attr("role","button").attr("aria-label","sort")[0].outerHTML,e(a).append(r)),o=JSON.stringify(this.model.customObject),t.PivotAnalysis._valueSorting=Number(e(a).attr("data-p").split(",")[0]),t.PivotAnalysis._sort=l,this._waitingPopup=t.isNullOrUndefined(this._pivotClientObj)?this.element.data("ejWaitingPopup"):this._pivotClientObj.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)this.refreshControl(),t.isNullOrUndefined(this._pivotClientObj)||"gridOnly"==this._pivotClientObj.displayMode()||(this._pivotClientObj._pivotChart._labelCurrentTags.expandedMembers=null,this._pivotClientObj._pivotChart.setPivotEngine(this._pivotEngine.pivotEngine),this._pivotClientObj._pivotChart._generateData(this._pivotEngine.pivotEngine),this._pivotEngine=null);else{for(n="",s=0;s<this.getJSONRecords().length;s++)Number(this.getJSONRecords()[s].Index.split(",")[0])==t.PivotAnalysis._valueSorting&&Number(this.getJSONRecords()[s].Index.split(",")[1])<JSON.parse(this.getOlapReport()).PivotColumns.length+1&&(n=""==n?-1==this.getJSONRecords()[s].Value.indexOf(".")?this.getJSONRecords()[s].Value:this.getJSONRecords()[s].Value.split(".")[1]:n+this.model.valueSortSettings.headerDelimiters+(-1==this.getJSONRecords()[s].Value.indexOf(".")?this.getJSONRecords()[s].Value:this.getJSONRecords()[s].Value.split(".")[1]));this.model.valueSortSettings.index=t.PivotAnalysis._valueSorting,this.model.valueSortSettings.headerText=n,this.model.valueSortSettings.sortOrder=l,t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.valueSorting,JSON.stringify({action:"valueSorting",valueSorting:JSON.stringify(this.model.valueSortSettings),currentReport:JSON.parse(this.getOlapReport()).Report,customObject:o}),this._renderControlSuccess):this._pivotClientObj.doAjaxPost("POST",this._pivotClientObj.model.url+"/"+this._pivotClientObj.model.serviceMethodSettings.valueSorting,JSON.stringify({action:"valueSorting",valueSorting:JSON.stringify(this.model.valueSortSettings),currentReport:JSON.parse(this._pivotClientObj.getOlapReport()).Report,customObject:o}),this._pivotClientObj._renderControlSuccess),delete this.model.valueSortSettings.index}t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.model.valueSortSettings=this.model.valueSortSettings)}}))},_navigateTreeData:function(e){t.Pivot.editorTreeNavigatee(e,this)},_stateMaintenance:function(){var i=t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label",this._getLocalizedLabels("EnabledState"))[0].outerHTML;this.model.dataSource.enableAdvancedFilter&&(this.element.parents(".e-pivotclient").length>0?e(".e-advancedFiltering").addClass("e-enabled"):e(".e-advancedFiltering a:eq(0)").append(i)),this.model.enableDrillThrough&&(e(".e-drillThrough a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellEditing"))),this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableDrillThrough&&(this.element.find(".e-drillThrough").addClass("e-enabled"),this.element.find(".toolBar").ejToolbar("disableItemByID","cellEditing")),!this.model.enableToolTip||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||(this.element.parents(".e-pivotclient").length>0?e(".e-toolTip").addClass("e-enabled"):e(".e-toolTip a:eq(0)").append(i)),this.model.enableCellSelection&&(e(".e-cellSelect a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellEditing"))),this.model.enableColumnResizing&&(this.element.parents(".e-pivotclient").length>0?(e(".e-columnResize").addClass("e-enabled"),e(".toolBar").ejToolbar("disableItemByID","collapseByDefault")):(e(".e-columnResize a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CollapseByDefault")))),this.model.enableGroupingBar&&e(".groupingBar a:eq(0)").append(i),this.model.enableRTL&&(this.element.parents(".e-pivotclient").length>0?e(".rtl").addClass("e-enabled"):e(".rtl a:eq(0)").append(i)),this.model.enableCollapseByDefault&&(this.element.parents(".e-pivotclient").length>0?(e(".toolBar").ejToolbar("disableItemByID","columnResize"),e(".e-collapseByDefault").addClass("e-enabled")):(e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("ColumnResize")),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("FrozenHeader")),e(".e-collapseByDefault a:eq(0)").append(i))),this.model.enableCellEditing&&(this.element.parents(".e-pivotclient").length>0?(this.element.find(".e-cellEditing").addClass("e-enabled"),this.element.find(".toolBar").ejToolbar("disableItemByID","drillThrough")):e(".e-cellEditing a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("DrillThrough")),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellSelection"))),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&e("li#row a:eq(0)").append(i),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&e("li#column a:eq(0)").append(i),this.model.hyperlinkSettings.enableRowHeaderHyperlink&&e("li#rowHeader a:eq(0)").append(i),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&e("li#columnHeader a:eq(0)").append(i),this.model.hyperlinkSettings.enableValueCellHyperlink&&e("li#valueCell a:eq(0)").append(i),this.model.hyperlinkSettings.enableSummaryCellHyperlink&&e("li#summaryCell a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.Normal&&e("li#normalLayout a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.NoSummaries&&e("li#noSummariesLayout a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout&&e("li#excelLikeLayout a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.NormalTopSummary&&e("li#normalTopSummaryLayout a:eq(0)").append(i),(this.model.layout==t.PivotGrid.Layout.NormalTopSummary||this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout||this.model.layout==t.PivotGrid.Layout.NoSummaries||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.element.parents(".e-pivotclient").length>0?e(".toolBar").ejToolbar("disableItemByID","summaryCustomize"):e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("SummaryCustomization")))},_contextMenuClick:function(i){var a,r;t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label","")[0].outerHTML,this.element.parents(".e-pivotclient").length>0?e(i.target):e(i.element);(e(i.element).hasClass("e-numberFormatting")||e(i.target).hasClass("e-numberFormatting"))&&this._createMenuDialog(i),(e(i.element).hasClass("e-cellSelect")||e(i.target).hasClass("e-cellSelect"))&&(this.model.enableCellSelection=!this.model.enableCellSelection,this.model.enableCellEditing=!1,this.renderControlFromJSON()),(e(i.element).hasClass("e-columnResize")||e(i.target).hasClass("e-columnResize"))&&!this.model.enableCollapseByDefault&&(this.model.enableColumnResizing=!this.model.enableColumnResizing,this.renderControlFromJSON()),(e(i.element).hasClass("e-toolTip")||e(i.target).hasClass("e-toolTip"))&&(this.model.enableToolTip=!this.model.enableToolTip,this.renderControlFromJSON()),!e(i.element).hasClass("e-collapseByDefault")&&!e(i.target).hasClass("e-collapseByDefault")||this.model.enableColumnResizing||this.model.enableFrozenColumnHeaders||this.model.enableFrozenRowHeaders||(this.model.enableCollapseByDefault?this.model.enableCollapseByDefault=!1:(this.model.enableCollapseByDefault=!0,this.model.collapsedMembers=null),this.renderControlFromJSON()),(e(i.element).hasClass("rtl")||e(i.target).hasClass("rtl"))&&(this.model.enableRTL=!this.model.enableRTL,this.renderControlFromJSON()),(e(i.element).hasClass("e-calculatedField")||e(i.target).hasClass("e-calculatedField"))&&this._createCalculatedField(),(e(i.element).hasClass("e-cellEditing")||e(i.target).hasClass("e-cellEditing"))&&(this.model.enableCellEditing=!this.model.enableCellEditing,this.model.enableDrillThrough=!1,this.model.enableCellSelection=!1,this.renderControlFromJSON()),(e(i.element).hasClass("e-drillThrough")||e(i.target).hasClass("e-drillThrough"))&&(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(dialogTitle="Cube Configuration",dialogContent="<p>Please configure cube!</p>",a=t.buildTag("div#clientDialog.e-clientDialog",{opacity:"1"}).attr("title",dialogTitle)[0].outerHTML,e(a).appendTo("#"+this._id),e(dialogContent).appendTo(this.element.find(".e-clientDialog")),this.element.find(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:200,target:"#"+this._id,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)})):this.element.parents(".e-pivotclient").length>0?(this._pivotClientObj.model.enableDrillThrough=!this._pivotClientObj.model.enableDrillThrough,this.model.enableDrillThrough=this._pivotClientObj.model.enableDrillThrough,this.model.enableCellEditing=!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this.renderControlFromJSON():this._pivotClientObj._load()):(this.model.enableDrillThrough=!this.model.enableDrillThrough,this.model.enableCellEditing=!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this.renderControlFromJSON():this._load())),(e(i.element).hasClass("e-summaryCustomize")||e(i.target).hasClass("e-summaryCustomize"))&&this._createMenuDialog(i),(e(i.element).hasClass("e-conditionalFormat")||e(i.target).hasClass("e-conditionalFormat"))&&(this.element.parents(".e-pivotclient").length>0&&"clientmode"==this._pivotClientObj.model.operationalMode&&this.setOlapReport(this._pivotClientObj.model.dataSource),this.model.enableConditionalFormatting=!0,this.openConditionalFormattingDialog(),t.Pivot.closePreventPanel(this)),(e(i.element).hasClass("e-summaryTypes")||e(i.target).hasClass("e-summaryTypes"))&&this._createMenuDialog(i),(e(i.element).hasClass("e-advancedFiltering")||e(i.target).hasClass("e-advancedFiltering"))&&(this.model.dataSource.enableAdvancedFilter=!this.model.dataSource.enableAdvancedFilter,this.renderControlFromJSON()),e(i.element).hasClass("groupingBar")&&(this.model.enableGroupingBar=!this.model.enableGroupingBar,this.renderControlFromJSON()),("undefined"!=i.element&&i.parentText==this._getLocalizedLabels("Layouts")||e(i.target).parents().hasClass("e-layoutsDialog"))&&(("normalLayout"==i.ID||e(i.target).hasClass("e-normalLayout"))&&(this.model.layout=t.PivotGrid.Layout.Normal,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="normal")),("excelLikeLayout"==i.ID||e(i.target).hasClass("e-excelLikeLayout"))&&(this.model.layout=t.PivotGrid.Layout.ExcelLikeLayout,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="excellikelayout")),("noSummariesLayout"==i.ID||e(i.target).hasClass("e-noSummariesLayout"))&&(this.model.layout=t.PivotGrid.Layout.NoSummaries,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="nosummaries")),("normalTopSummaryLayout"==i.ID||e(i.target).hasClass("e-normalTopSummaryLayout"))&&(this.model.layout=t.PivotGrid.Layout.NormalTopSummary,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="normaltopsummary")),"excelLikeLayout"==i.ID||e(i.target).hasClass("e-excelLikeLayout")?this.excelLikeLayout(this.getJSONRecords()):(this._excelLikeJSONRecords=null,this.refreshPivotGrid())),("undefined"!=i.element&&i.parentText==this._getLocalizedLabels("HyperLink")||e(i.target).parents().hasClass("e-hyperLinkDialog"))&&(("rowHeader"==i.ID||e(i.target).hasClass("e-rowHeaderHyperLink"))&&(this.model.hyperlinkSettings.enableRowHeaderHyperlink=!this.model.hyperlinkSettings.enableRowHeaderHyperlink),("columnHeader"==i.ID||e(i.target).hasClass("e-colHeaderHyperLink"))&&(this.model.hyperlinkSettings.enableColumnHeaderHyperlink=!this.model.hyperlinkSettings.enableColumnHeaderHyperlink),("valueCell"==i.ID||e(i.target).hasClass("e-valueCellHyperLink"))&&(this.model.hyperlinkSettings.enableValueCellHyperlink=!this.model.hyperlinkSettings.enableValueCellHyperlink),("summaryCell"==i.ID||e(i.target).hasClass("e-summaryCellHyperLink"))&&(this.model.hyperlinkSettings.enableSummaryCellHyperlink=!this.model.hyperlinkSettings.enableSummaryCellHyperlink),this.renderControlFromJSON()),(i.element!=l&&i.parentText==this._getLocalizedLabels("Exporting")||e(i.target).parents().hasClass("e-exportDialog"))&&(r=this.element.parents(".e-pivotclient").length>0?e(i.target).attr("class").split(" ")[0]:i.ID,this.element.parents(".e-pivotclient").length>0&&!t.isNullOrUndefined(this._pivotClientObj)&&(this.model.beforeExport=this._pivotClientObj.model.beforeExport),this.exportPivotGrid(r,"Sample")),(i.element!=l&&i.parentText==this._getLocalizedLabels("FrozenHeader")||e(i.target).parents().hasClass("e-frozenDialog"))&&(("row"==i.ID||e(i.target).hasClass("e-rowFreeze"))&&(this.model.frozenHeaderSettings.enableFrozenRowHeaders=!this.model.frozenHeaderSettings.enableFrozenRowHeaders),("column"==i.ID||e(i.target).hasClass("e-colFreeze"))&&(this.model.frozenHeaderSettings.enableFrozenColumnHeaders=!this.model.frozenHeaderSettings.enableFrozenColumnHeaders),this.renderControlFromJSON()),this._unWireEvents(),this._wireEvents()},_createMenuIcons:function(i){var l,a,r,o;e(i.target).hasClass("e-exporting")&&(l=t.buildTag("div.e-exportDialog#exportDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-excel e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("Excel"),title:this._getLocalizedLabels("Excel"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-word e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("Word"),title:this._getLocalizedLabels("Word"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pdf e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("PDF"),title:this._getLocalizedLabels("PDF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.csv e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("CSV"),title:this._getLocalizedLabels("CSV"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,0==this.element.find("div .e-exportDialog").length&&(e(l).appendTo(this.element),e(".e-exportDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"))),e(i.target).hasClass("e-hyperlinkOptions")&&(a=t.buildTag("div.e-hyperLinkDialog#hyperLinkTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rowHeaderHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableRowHeaderHyperlink"),title:this._getLocalizedLabels("EnableRowHeaderHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-colHeaderHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableColumnHeaderHyperlink"),title:this._getLocalizedLabels("EnableColumnHeaderHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-valueCellHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableValueCellHyperlink"),title:this._getLocalizedLabels("EnableValueCellHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-summaryCellHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableSummaryCellHyperlink"),title:this._getLocalizedLabels("EnableSummaryCellHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-hyperLinkDialog").length&&(e(a).appendTo(this.element),e(a).css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.hyperlinkSettings.enableRowHeaderHyperlink&&this.element.find(".e-rowHeaderHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this.element.find(".e-colHeaderHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableValueCellHyperlink&&this.element.find(".e-valueCellHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableSummaryCellHyperlink&&this.element.find(".e-summaryCellHyperLink").addClass("e-enabled"))),e(i.target).hasClass("e-frozenHeaders")&&(r=t.buildTag("div.e-frozenDialog#frozenDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rowFreeze e-frozenHeaderIcons").attr({"aria-label":this._getLocalizedLabels("Row"),title:this._getLocalizedLabels("Row"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-colFreeze e-frozenHeaderIcons").attr({"aria-label":this._getLocalizedLabels("Column"),title:this._getLocalizedLabels("Column"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,0==this.element.find("div.e-frozenDialog").length&&(e(r).appendTo(this.element),e(".e-frozenDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find(".e-rowFreeze").addClass("e-enabled"),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.element.find(".e-colFreeze").addClass("e-enabled"),this.model.frozenHeaderSettings.enableFrozenHeaders&&this.element.find(".bothFreeze").addClass("e-enabled"))),e(i.target).hasClass("e-layouts")&&(o=t.buildTag("div.e-layoutsDialog#layoutsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-normalLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NormalLayout"),title:this._getLocalizedLabels("NormalLayout"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-excelLikeLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("ExcelLikeLayout"),title:this._getLocalizedLabels("ExcelLikeLayout"),tabindex:0})[0].outerHTML)[0].outerHTML+(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.buildTag("td",t.buildTag("div.e-noSummariesLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NoSummaries"),title:this._getLocalizedLabels("NoSummaries"),tabindex:0})[0].outerHTML)[0].outerHTML:"")+(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.buildTag("td",t.buildTag("div.e-normalTopSummaryLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NormalTopSummary"),title:this._getLocalizedLabels("NormalTopSummary"),tabindex:0})[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,0==this.element.find("div .e-layoutsDialog").length&&(e(o).appendTo(this.element),e(".e-layoutsDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.layout==t.PivotGrid.Layout.Normal&&this.element.find(".e-normalLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout&&this.element.find(".e-excelLikeLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.NoSummaries&&this.element.find(".e-noSummariesLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.NormalTopSummary&&this.element.find(".e-normalTopSummaryLayout").addClass("e-enabled")))},_createMenuDialog:function(i){var a,r,o,n,s,d,h,u,c,p,m;if(this._dialogName=t.isNullOrUndefined(i.target)?e(i.element).attr("class").split(" ")[0]:e(i.target).attr("class").split(" ")[0],t.Pivot.openPreventPanel(this),this.element.find(".e-dialog").remove(),a=t.buildTag("div#clientDialog.e-clientDialog",{opacity:"1"})[0].outerHTML,r=currentTag=dialogContent="",e(i.target).hasClass("e-numberFormatting")||e(i.element).hasClass("e-numberFormatting")){for(r=this._getLocalizedLabels("NumberFormatting"),currentTag="Number Formatting",o=t.buildTag("label",this._getLocalizedLabels("Measures"))[0].outerHTML,_="<select id='measureOption'>",h=0;h<this.model.dataSource.values.length;h++)_+="<option>"+this.model.dataSource.values[h].fieldName+"</option>";_+="</select>",n=t.buildTag("label",this._getLocalizedLabels("NumberFormats"))[0].outerHTML,s="<div class='summarTypes'><select id='numberFormatOption'><option value='Decimal'>Decimal</option><option value='Currency'>Currency</option><option value='Percentage'>Percentage</option><option value='Number'>Number</option><option value='Date'>Date</option><option value='Time'>Time</option><option value='Scientific'>Scientific</option><option value='Fraction'>Fraction</option></select></div>",dialogContent=t.buildTag("div#reportDlg.e-reportDlg","<table><tr><td>"+o+"</td><td>"+_+"</td></tr><tr><td>"+n+"</td><td>"+s+"</td></tr></table>")[0].outerHTML}if(e(i.target).hasClass("e-summaryCustomize")||e(i.element).hasClass("e-summaryCustomize")){r=this._getLocalizedLabels("SummaryCustomization");var g=t.buildTag("label",this._getLocalizedLabels("HideGrandTotal"))[0].outerHTML,f=t.buildTag("label",this._getLocalizedLabels("HideSubTotal"))[0].outerHTML,_="<div class='measures'><select id='hideSubTotal'>";if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(h=0;h<this.model.dataSource.columns.length;h++)_+="<option>"+this.model.dataSource.columns[h].fieldCaption+"</option>";for(h=0;h<this.model.dataSource.rows.length;h++)_+="<option>"+this.model.dataSource.rows[h].fieldCaption+"</option>"}else if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(d=e(this.element).parents(".e-pivotclient").length>0?this._pivotClientObj.getOlapReport():this.getOlapReport(),h=0;h<JSON.parse(d).PivotRows.length;h++)_+="<option>"+JSON.parse(d).PivotRows[h].FieldName+"</option>";for(h=0;h<JSON.parse(d).PivotColumns.length;h++)_+="<option>"+JSON.parse(d).PivotColumns[h].FieldName+"</option>"}_+="</div>";var v=t.buildTag("input#rowSumCheckBox.rowSumCheckBox","",{},{name:"row",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.rowGrndlabel",this._getLocalizedLabels("Row"))[0].outerHTML+"<br/>",b=t.buildTag("input#colSumCheckBox.colSumCheckBox","",{},{name:"column",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.colGrndlabel",this._getLocalizedLabels("Column"))[0].outerHTML+"<br/>",C=t.buildTag("input#bothSumCheckBox.bothSumCheckBox","",{},{name:"both",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.bothGrndlabel",this._getLocalizedLabels("Both"))[0].outerHTML+"<br/>";dialogContent="pivot"==this.model.analysisMode?t.buildTag("div#customizeDlg.customizeDlg","<table><tr><td style='vertical-align:top'>"+g+"</td><td>"+v+b+C+"</td></tr><tr><td>"+f+"</td><td>"+_+"</td></tr></table>")[0].outerHTML:t.buildTag("div#customizeDlg.customizeDlg","<table><tr><td>"+g+"</td><td>"+v+b+C+"</td></tr></table>")[0].outerHTML}if(e(i.target).hasClass("e-summaryTypes")||e(i.element).hasClass("e-summaryTypes")){if(r=this._getLocalizedLabels("SummaryTypes"),g=t.buildTag("label",this._getLocalizedLabels("Measures"))[0].outerHTML,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(_="<div class='measures'><select id='drillMeasure'>",h=0;h<this.model.dataSource.values.length;h++)_+="<option>"+this.model.dataSource.values[h].fieldCaption+"</option>";_+="</div>"}f=t.buildTag("label",this._getLocalizedLabels("SummaryType"))[0].outerHTML,u=t.buildTag("input#drillSum").attr("type","text")[0].outerHTML,dialogContent=t.buildTag("div#summaryDlg.#summaryDlg","<table><tr><td>"+g+"</td><td>"+_+"</td></tr><tr><td>"+f+"</td><td>"+u+"</td></tr></table>")[0].outerHTML}c=t.buildTag("div#EditorDiv.e-editorDiv","",{"margin-left":"5px"})[0].outerHTML,dialogContent+=c,p="<button id=OKBtn class='e-dialogOkBtn'>"+this._getLocalizedLabels("OK")+"</button>",m="<button id=CancelBtn class='e-dialogCancelBtn'>"+this._getLocalizedLabels("Cancel")+"</button>",dialogFooter=t.buildTag("div.e-dialogFooter",p+m,{float:this.model.enableRTL?"left":"right",margin:"20px 0px 6px"})[0].outerHTML,e(a).appendTo("#preventDiv"),e(dialogContent+dialogFooter).appendTo(".e-clientDialog"),e(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:"auto",target:"#"+this._id,enableResize:!1,close:t.Pivot.closePreventPanel(this)}),e(".e-titlebar").prepend(t.buildTag("div",r,{display:"inline"})[0].outerHTML)[0],e(".e-dialogOkBtn, .e-dialogCancelBtn").ejButton({width:"67px",enableRTL:this.model.enableRTL,type:t.ButtonType.Button}),e(".e-dialogOkBtn, .e-dialogCancelBtn").css({"margin-left":"10px"}),""==this._selectedFormat&&""==this._selectedMeasure&&(e("#numberFormatOption").ejDropDownList({enableRTL:this.model.enableRTL,selectedIndex:0,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#measureOption").ejDropDownList({enableRTL:this.model.enableRTL,selectedIndex:0,showCheckbox:!0,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}})),""!=this._selectedMeasure&&""!=this._selectedFormat&&(e("#numberFormatOption").ejDropDownList({enableRTL:this.model.enableRTL,text:this._selectedFormat,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#measureOption").ejDropDownList({enableRTL:this.model.enableRTL,text:this._selectedMeasure,showCheckbox:!0,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}})),e("#categoricalInput").ejMaskEdit({name:"mask",inputMode:t.InputMode.Text,watermarkText:"Column Page Size"}),e("#seriesInput").ejMaskEdit({name:"mask",inputMode:t.InputMode.Text,watermarkText:"Row Page Size"}),e("#rowSumCheckBox,#colSumCheckBox,#bothSumCheckBox").ejCheckBox({size:"small",showRoundedCorner:!0}),this.rowCheckBox=e("#rowSumCheckBox").data("ejCheckBox"),this.colCheckBox=e("#colSumCheckBox").data("ejCheckBox"),this.bothCheckBox=e("#bothSumCheckBox").data("ejCheckBox"),(e(i.target).hasClass("e-summaryCustomize")||e(i.element).hasClass("e-summaryCustomize"))&&(0==this.rowGrand&&this.rowCheckBox.setModel({checked:"checked"}),0==this.colGrand&&this.colCheckBox.setModel({checked:"checked"}),0==this.bothGrand&&this.bothCheckBox.setModel({checked:"checked"}),e("#hideSubTotal").ejDropDownList({showCheckbox:!0,enableRTL:this.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.dropmeasure=e("#hideSubTotal").data("ejDropDownList"),this.selval!=l&&this.dropmeasure.setModel({value:this.selval})),(e(i.target).hasClass("e-summaryTypes")||e(i.element).hasClass("e-summaryTypes"))&&(e("#_summaryOK,#_summaryCancel").ejButton({enableRTL:this.model.enableRTL}),e("#drillMeasure").ejDropDownList({selectedIndices:[0],enableRTL:this.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#drillSum").ejDropDownList({dataSource:[{option:"Sum",value:this._getLocalizedLabels("Sum")},{option:"Average",value:this._getLocalizedLabels("Average")},{option:"Count",value:this._getLocalizedLabels("Count")},{option:"Min",value:this._getLocalizedLabels("Min")},{option:"Max",value:this._getLocalizedLabels("Max")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),drilmes=e("#drillMeasure").data("ejDropDownList"),drilsum=e("#drillSum").data("ejDropDownList"),this.drilsumval!=l&&drilmes.setModel({value:this.drilsumval}),null!=this.sumtyp&&drilsum.setModel({value:this.sumtyp}))},_dialogOKBtnClick:function(){var i,a,r,o,n,s,d,h,u,c;if("e-numberFormatting"==this._dialogName){for(this._selectedFormat=e("#numberFormatOption").ejDropDownList("getSelectedValue"),this._selectedMeasure=e("#measureOption").ejDropDownList("getSelectedValue"),i=this._selectedMeasure.split(","),this.element.find(".e-dialog").remove(),t.Pivot.closePreventPanel(this),u=0;u<this.model.dataSource.values.length;u++)for(a=0;a<i.length;a++)this.model.dataSource.values[u].fieldName==i[a]&&(this.model.dataSource.values[u].format=this._selectedFormat.toLowerCase());t.isNullOrUndefined(this._pivotClientObj)||"pivot"!=this._pivotClientObj.model.analysisMode||"clientmode"!=this._pivotClientObj.model.operationalMode||(this.model.collapsedMembers=null),this._populatePivotGrid()}if("e-summaryCustomize"==this._dialogName&&(pGridObj=this,t.isNullOrUndefined(this._pivotClientObj)||"pivot"!=this._pivotClientObj.model.analysisMode||"clientmode"!=this._pivotClientObj.model.operationalMode||(pGridObj.model.collapsedMembers=null),pGridObj.rowCheckBox.model.checked?(pGridObj.model.enableColumnGrandTotal=pGridObj.model.enableGrandTotal=!0,pGridObj.model.enableRowGrandTotal=pGridObj.rowGrand=!1):pGridObj.model.enableRowGrandTotal=pGridObj.rowGrand=!0,pGridObj.colCheckBox.model.checked?(pGridObj.model.enableRowGrandTotal=pGridObj.model.enableGrandTotal=!0,pGridObj.model.enableColumnGrandTotal=pGridObj.colGrand=!1):pGridObj.model.enableColumnGrandTotal=pGridObj.colGrand=!0,pGridObj.bothCheckBox.model.checked||pGridObj.colCheckBox.model.checked&&pGridObj.rowCheckBox.model.checked?(pGridObj.model.enableRowGrandTotal=pGridObj.model.enableColumnGrandTotal=!0,pGridObj.model.enableGrandTotal=pGridObj.bothGrand=!1):pGridObj.model.enableGrandTotal=pGridObj.bothGrand=!0,null!=e("#hideSubTotal").ejDropDownList("getSelectedValue")&&"pivot"==this.model.analysisMode&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(pGridObj.selval=e("#hideSubTotal").ejDropDownList("getSelectedValue"),r=e("#hideSubTotal").ejDropDownList("getSelectedValue").split(","),pGridObj.model.dataSource.rows.length>0&&e.each(pGridObj.model.dataSource.rows,function(e,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),pGridObj.model.dataSource.columns.length>0&&e.each(pGridObj.model.dataSource.columns,function(e,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),e.each(r,function(t,i){pGridObj.model.dataSource.rows.length>0&&e.each(pGridObj.model.dataSource.rows,function(e,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)}),pGridObj.model.dataSource.columns.length>0&&e.each(pGridObj.model.dataSource.columns,function(e,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)})}),pGridObj._populatePivotGrid()):"pivot"==this.model.analysisMode&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(pGridObj.selval=e("#hideSubTotal").ejDropDownList("getSelectedValue"),r=e("#hideSubTotal").ejDropDownList("getSelectedValue").split(","),(o=e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()):JSON.parse(pGridObj.getOlapReport())).PivotRows.length>0&&e.each(o.PivotRows,function(e,t){t.FieldName.length>0&&(t.showSubTotal=!0)}),o.PivotColumns.length>0&&e.each(o.PivotColumns,function(e,t){t.FieldName.length>0&&(t.showSubTotal=!0)}),e.each(r,function(t,i){o.PivotRows.length>0&&e.each(o.PivotRows,function(e,t){t.FieldName.length>0&&t.FieldName==i&&(t.showSubTotal=!1)}),o.PivotColumns.length>0&&e.each(o.PivotColumns,function(e,t){t.FieldName.length>0&&t.FieldName==i&&(t.showSubTotal=!1)})}),n={JsonRecords:JSON.stringify(pGridObj.getJSONRecords()),PivotReport:JSON.stringify(o)},pGridObj._renderControlSuccess(n)):pGridObj._load(),t.Pivot.closePreventPanel(this)),"e-summaryTypes"==this._dialogName){if(e("#drillSum").val()!=l&&(this.drilsumval=e("#drillMeasure").ejDropDownList("getSelectedValue"),null!=(s=this.sumtyp=e("#drillSum").val())&&(d=s.toLowerCase()),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)){for(h=e("#drillMeasure").ejDropDownList("getSelectedValue").split(",").length,u=0;u<h;u++)c=e("#drillMeasure").ejDropDownList("getSelectedValue").split(",")[u],e.grep(this.model.dataSource.values,function(e){return e.fieldName==c})[0].summaryType=d;t.isNullOrUndefined(this._pivotClientObj)||"pivot"!=this._pivotClientObj.model.analysisMode||"clientmode"!=this._pivotClientObj.model.operationalMode||(this.model.collapsedMembers=null),this._populatePivotGrid()}t.Pivot.closePreventPanel(this)}},_keyUpPress:function(t){if(16===t.which&&this.model.enableCellSelection&&(this._completeCellSelection(t),e("#"+this._id).find(".value").removeClass("e-hoverCell"),this._startPosCell=null,this._startCellPosition=null),13===t.which&&this.model.enableCellEditing&&!this.model.enableCellSelection&&e("#"+this._id).find(".value.e-hoverCell").length){e("#"+this._id).find(".value.e-hoverCell").trigger("mouseover"),this._startCellPosition=e(e("#"+this._id).find(".value.e-hoverCell")).attr("data-p");var i={target:e("#"+this._id).find(".value.e-hoverCell > span")[0]};this._completeCellEditing(i),t.preventDefault(),e("#"+this._id).find(".value.e-hoverCell .curInput").focus(),e("#"+this._id).find(".value").removeClass("e-hoverCell")}},_keyDownPress:function(i){var l,a,r,o,n,s,d;if(e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&(("Pager_CategCurrentPage"==document.activeElement.id||"Pager_SeriesCurrentPage"==document.activeElement.id)&&(35===i.which?(i.preventDefault(),"Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveLast").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveLast").last().trigger("click")):36==i.which&&(i.preventDefault(),"Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .moveFirst").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .moveFirst").last().trigger("click")),39===i.which?"Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveNext").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveNext").last().trigger("click"):37===i.which&&("Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-movePrevious").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-movePrevious").last().trigger("click"))),i.stopImmediatePropagation()),27!==i.which||t.isNullOrUndefined(this._curFocus.grp)&&(t.isNullOrUndefined(this._curFocus.tab)||!this._curFocus.tab.hasClass("e-pivotButton"))?27===i.which&&(this._index.dialog=0):(this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-pivotButton")&&(d=this._curFocus.tab.attr("data-tag"),s=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(d=this._curFocus.grp.attr("data-tag"),s=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),s.mouseover().addClass("e-hoverCell").focus(),this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._index.field=0),70===i.which&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".filter").click():this._curFocus.grp.find(".filter").click()),83===i.which&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".e-sorting").click(),d=this._curFocus.tab.attr("data-tag"),s=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(this._curFocus.grp.find(".e-sorting").click(),d=this._curFocus.grp.attr("data-tag"),s=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),s.mouseover().addClass("e-hoverCell").focus()),(46===i.which||82===i.which&&i.ctrlKey)&&(46!=i.which&&i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".e-removeBtn").click():this._curFocus.grp.find(".e-removeBtn").click()),i.shiftKey&&t.isNullOrUndefined(this._startPosCell)&&(this._startCellPosition=i.target.getAttribute("data-p"),this._startPosCell=i.target.getAttribute("data-p")),39===i.which&&e("#"+this._id).find(".e-dialog .e-hoverCell").length>0?e("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-plus").click():37===i.which&&e("#"+this._id).find(".e-dialog .e-hoverCell").length>0&&e("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-minus").click(),(40===i.which||39===i.which||38===i.which||37===i.which)&&i.shiftKey&&this.model.enableCellSelection){if(e("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),l=e(i.target),"40"==i.which)for(h=l.attr("data-p"),u=parseInt(h.split(",")[1])+Number(l.attr("rowspan"));t.isNullOrUndefined(c)&&u<this._rowCount;)a=e(e("#"+this._id)).find("[data-p='"+h.split(",")[0]+","+u+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),this._curFocus.selection=e(c),u++;else if("38"==i.which)for(h=l.attr("data-p"),u=parseInt(h.split(",")[1])-1;t.isNullOrUndefined(c)&&u>=0;)a=e(e("#"+this._id)).find("[data-p='"+h.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(a)&&(a=e(e("#"+this._id)).find("[data-p='"+(parseInt(h.split(",")[0])-1)+","+u+"']")[0]),!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),this._curFocus.selection=e(c),u--;else if("39"==i.which)for(h=l.attr("data-p"),u=parseInt(h.split(",")[0])+Number(l.attr("colspan"));t.isNullOrUndefined(c)&&u<Math.ceil(this.getJSONRecords().length/this._rowCount);)a=e(e("#"+this._id)).find("[data-p='"+u+","+h.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),this._curFocus.selection=e(c),u++;else if("37"==i.which){for(var h=l.attr("data-p"),u=parseInt(h.split(",")[0])-1,c=e(e("#"+this._id)).find("[data-p='"+(parseInt(h.split(",")[0])-1)+","+h.split(",")[1]+"']")[0];t.isNullOrUndefined(c)&&u>=0;)a=e(e("#"+this._id)).find("[data-p='"+u+","+h.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),u--;this._curFocus.selection=e(c)}if(this._curFocus.selection.attr("tabindex","-1").focus().addClass("e-hoverCell"),Number(this._startCellPosition.split(",")[0])<=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])<=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u<=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u++)for(p=Number(this._startCellPosition.split(",")[1]);p<=Number(this._curFocus.selection.attr("data-p").split(",")[1]);p++)e("#"+this._id).find("[data-p='"+u+","+p+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+u+","+p+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])>=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])>=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u>=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u--)for(p=Number(this._startCellPosition.split(",")[1]);p>=Number(this._curFocus.selection.attr("data-p").split(",")[1]);p--)e("#"+this._id).find("[data-p='"+u+","+p+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+u+","+p+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])<=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])>=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u<=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u++)for(p=Number(this._startCellPosition.split(",")[1]);p>=Number(this._curFocus.selection.attr("data-p").split(",")[1]);p--)e("#"+this._id).find("[data-p='"+u+","+p+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+u+","+p+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])>=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])<=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(u=Number(this._startCellPosition.split(",")[0]);u>=Number(this._curFocus.selection.attr("data-p").split(",")[0]);u--)for(p=Number(this._startCellPosition.split(",")[1]);p<=Number(this._curFocus.selection.attr("data-p").split(",")[1]);p++)e("#"+this._id).find("[data-p='"+u+","+p+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+u+","+p+"']").addClass("e-hoverCell")}else if((40===i.which||38===i.which||37===i.which||39===i.which)&&e("#"+this._id).find(".e-calcFormulaDiv:visible").length>0)i.preventDefault(),r=e("#"+this._id).find(".e-calcFormulaDiv td:visible"),t.isNullOrUndefined(this._curFocus.formula)?(this._index.formula=39==i.which?0:37==i.which?r.length-1:0,this._curFocus.formula=r.eq(this._index.formula).addClass("e-hoverCell").mouseover()):(this._curFocus.formula.removeClass("e-hoverCell").mouseleave(),39===i.which?this._index.formula=this._index.formula+1>r.length-1?0:this._index.formula+1:37===i.which?this._index.formula=this._index.formula-1<0?r.length-1:this._index.formula-1:40===i.which?this._index.formula=this._index.formula+4>r.length-1?(this._index.formula+4)%10:this._index.formula+4:38===i.which&&(this._index.formula=this._index.formula-4<0?this._index.formula- -16:this._index.formula-4),this._curFocus.formula=r.eq(this._index.formula).addClass("e-hoverCell").mouseover());else if((40===i.keyCode||38===i.which)&&e("#"+this._id).find(".e-dialog:visible").length>0&&!t.isNullOrUndefined(e("#"+this._id).find(".e-dialog .e-text"))&&e(".e-dialog .e-text").hasClass("e-hoverCell"))e("#"+this._id).find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),i.preventDefault(),r=e("#"+this._id).find(".e-dialog .e-text:visible"),t.isNullOrUndefined(this._curFocus.filter)?(this._index.filter=40==i.which?1:38==i.which?r.length-1:0,this._curFocus.filter=r.eq(this._index.filter).attr("tabindex","-1")):(this._curFocus.filter.attr("tabindex","0").removeClass("e-hoverCell"),40===i.which?this._index.filter=this._index.filter+1>r.length-1?0:this._index.filter+1:38===i.which&&(this._index.filter=this._index.filter-1<0?r.length-1:this._index.filter-1),this._curFocus.filter=r.eq(this._index.filter).attr("tabindex","-1")),this._curFocus.filter.focus().addClass("e-hoverCell"),e(".e-node-focus").removeClass("e-node-focus");else if((40===i.which||38===i.which||37===i.which||39===i.which)&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-pivotButton")&&!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!e("#"+this._id).find(".e-dialog:visible").length>0)i.preventDefault(),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().attr("tabindex","0").removeClass("e-hoverCell"),r=e("#"+this._id).find(".e-pivotButton"),t.isNullOrUndefined(this._curFocus.grp)?40===i.which||39===i.which?this._curFocus.grp=r.eq(1).attr("tabindex","-1"):(38===i.which||37===i.which)&&(this._curFocus.grp=r.eq(r.length-1).attr("tabindex","-1")):(this._curFocus.grp.attr("tabindex","0").removeClass("e-hoverCell").mouseleave(),40===i.which||39===i.which?this._index.grp=this._index.grp+1>r.length-1?0:this._index.grp+1:(38===i.which||37===i.which)&&(this._index.grp=this._index.grp-1<0?r.length-1:this._index.grp-1),this._curFocus.grp=r.eq(this._index.grp)),this._curFocus.grp.addClass("e-hoverCell").mouseover().focus();else if(40!==i.which&&38!==i.which&&37!==i.which&&39!==i.which||!(!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0)||"columnheader"!=document.activeElement.getAttribute("role")&&"rowheader"!=document.activeElement.getAttribute("role")&&"gridcell"!=document.activeElement.getAttribute("role"))40==i.which&&e(".e-list").hasClass("e-hoverCell")&&e("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell");else{if(t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),t.isNullOrUndefined(this._curFocus.cell)||(this._curFocus.cell.attr("tabindex","0").removeClass("e-hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this._curFocus.cell.find("span").mouseleave()),this._index.menu=0,this._curFocus.cmenu=null,l=e(i.target),"40"==i.which)for(h=l.attr("data-p"),u=parseInt(h.split(",")[1])+Number(l.attr("rowspan"));t.isNullOrUndefined(c)&&u<=this._rowCount;){if(a=e("#"+this._id).find("[data-p='"+h.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+k+","+u+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),t.isNullOrUndefined(c)||(this._curFocus.cell=e(c)),u++}else if("38"==i.which){h=l.attr("data-p"),u=parseInt(h.split(",")[1])-1;for(var p=parseInt(h.split(",")[0]);t.isNullOrUndefined(c)&&u>=0;){if(a=e("#"+this._id).find("[data-p='"+h.split(",")[0]+","+u+"']")[0],t.isNullOrUndefined(a)&&("gridcell"==l.attr("role")||l.hasClass("summary")&&l.hasClass("calc")))for(k=parseInt(h.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+p+","+k+"']")[0]);if(t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+k+","+u+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),t.isNullOrUndefined(c)||e(c).hasClass("e-grpRow")||(this._curFocus.cell=e(c)),u--,p--}}else if("39"==i.which)for(h=l.attr("data-p"),u=parseInt(h.split(",")[0])+Number(l.attr("colspan"));t.isNullOrUndefined(c)&&u<=Math.ceil((Number(e("#"+this._id).find(".e-pivotGridTable td:last").attr("data-p").split(",")[0])+1)*(Number(e("#"+this._id).find(".e-pivotGridTable td:last").attr("data-p").split(",")[1])+1)/this._rowCount);){if(a=e("#"+this._id).find("[data-p='"+u+","+h.split(",")[1]+"']")[0],t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+u+","+k+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),t.isNullOrUndefined(c)||(this._curFocus.cell=e(c)),u++}else if("37"==i.which){for(h=l.attr("data-p"),u=parseInt(h.split(",")[0])-1,c=e("#"+this._id).find("[data-p='"+(parseInt(h.split(",")[0])-1)+","+h.split(",")[1]+"']")[0],p=parseInt(h.split(",")[1]);t.isNullOrUndefined(c)&&u>=0;){if(a=e("#"+this._id).find("[data-p='"+u+","+h.split(",")[1]+"']")[0],t.isNullOrUndefined(a)&&"gridcell"==l.attr("role"))for(k=parseInt(h.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+k+","+p+"']")[0]);if(t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+u+","+k+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(c=a),u--,p--}t.isNullOrUndefined(c)||e(c).hasClass("e-grpRow")||(this._curFocus.cell=e(c))}t.isNullOrUndefined(this._curFocus.cell)||(e(".e-hoverCell").removeClass("e-hoverCell"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.cell.mouseover(),this._curFocus.cell.find("span").mouseover()))}if(9===i.which&&e("#"+this._id).find(".colheader.e-hoverCell")&&(this._curFocus.cell=e("#"+this._id).find(".colheader.e-hoverCell")),(9===i.which&&i.shiftKey||9===i.which)&&e("#"+this._id).find("#"+this._id+"_clientDlg_wrapper :visible").length>0?(i.preventDefault(),r=e("#"+this._id+"_editCon_hidden").hasClass("e-disable")||"disabled"==e("#"+this._id+"_conTo").attr("disabled")?"disabled"!=e("#"+this._id+"_conTo").attr("disabled")?e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):e("#"+this._id+"_editCon_hidden").hasClass("e-disable")?e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"),t.isNullOrUndefined(this._curFocus.cformat)?(this._index.cformat=1,this._curFocus.cformat=r.eq(this._index.cformat).attr("tabindex","-1")):(this._curFocus.cformat.attr("tabindex","0").removeClass("e-hoverCell"),9===i.which&&i.shiftKey?this._index.cformat=this._index.cformat-1<0?r.length-1:this._index.cformat-1:9===i.which&&(this._index.cformat=this._index.cformat+1>r.length-1?0:this._index.cformat+1),this._curFocus.cformat=r.eq(this._index.cformat).attr("tabindex","-1")),this._curFocus.cformat.focus().addClass("e-hoverCell")):(9===i.which&&i.shiftKey||9===i.which)&&e("#"+this._id).find(".e-dlgCalculatedField:visible").length>0?(i.preventDefault(),e("#"+this._id).find(".e-calcFormulaDiv:visible").length>0&&e("#"+this._id).find(".e-calcFormulaDiv").css("display","none"),(o=[]).push(e("#"+this._id).find("#"+this._id+"_calculateFieldName:visible")),o.push(e("#"+this._id).find("#"+this._id+"_calculateFieldList_dropdown:visible")),o.push(e("#"+this._id).find(".calculatorFields:visible")),o.push(e("#"+this._id).find(".editFormula:visible")),o.push(e("#"+this._id).find("#"+this._id+"_fieldCollection_container:visible")),e("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])").length>0&&o.push(e("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])")),o.push(e("#"+this._id).find("#"+this._id+"_btnAdd:visible")),o.push(e("#"+this._id).find("#"+this._id+"_btnDelete:visible")),o.push(e("#"+this._id).find("#"+this._id+"_btnOk:visible")),o.push(e("#"+this._id).find("#"+this._id+"_btnCancel:visible")),t.isNullOrUndefined(this._curFocus.field)?(this._index.field=o.length>5?6:0,this._curFocus.field=o[this._index.field].attr("tabindex","-1")):(this._curFocus.field.attr("tabindex","0").removeClass("e-hoverCell").blur(),9===i.which&&i.shiftKey?this._index.field=this._index.field-1<0?o.length-1:this._index.field-1:9===i.which&&(this._index.field=this._index.field+1>o.length-1?0:this._index.field+1),this._curFocus.field=o[this._index.field].attr("tabindex","-1")),this._curFocus.field.focus().addClass("e-hoverCell")):(9===i.which&&i.shiftKey||9===i.which)&&e("#"+this._id).find(".e-dialog:visible").length>0?(i.preventDefault(),e("#"+this._id).find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),this._curFocus.filter=null,this._index.filter=0,o=e("#"+this._id).find(".e-dialogOKBtn:visible:not([aria-disabled='true']),.e-dialogCancelBtn:visible,.e-close:visible,#GroupLabelDrop_wrapper:visible,.filterElementTag:visible,.e-dialog .e-text:visible:first,.filterValues:visible,#filterMeasures_wrapper:visible,#filterOptions_wrapper:visible,#filterValue1:visible,#filterValue2:visible,.searchEditorTreeView"),t.isNullOrUndefined(this._curFocus.tree)?(this._index.dialog=this.model.dataSource.enableAdvancedFilter?1:2,this._curFocus.tree=o.eq(this._index.dialog).attr("tabindex","-1").focus()):(this._curFocus.tree.attr("tabindex","0").removeClass("e-hoverCell"),9===i.which&&i.shiftKey?this._index.dialog=this._index.dialog-1<0?o.length-1:this._index.dialog-1:9===i.which&&(this._index.dialog=this._index.dialog+1>o.length-1?0:this._index.dialog+1),this._curFocus.tree=o.eq(this._index.dialog).attr("tabindex","-1").focus()),this._curFocus.tree.hasClass("filterElementTag")?this._curFocus.tree.find(".e-list:first:visible").addClass("e-hoverCell"):this._curFocus.tree.addClass("e-hoverCell")):(9===i.which&&i.shiftKey||9===i.which)&&!e(".e-dialog:visible").length>0&&t.isNullOrUndefined(this._pivotClientObj)&&(i.preventDefault(),e("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._schemaData)||e("#"+this._schemaData._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)||this._curFocus.grp.mouseleave(),this._index.field=0,this._index.grp=1,this._index.cell=1,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,t.isNullOrUndefined(this._schemaData)||t.isNullOrUndefined(this._schemaData._curFocus)||(this._schemaData._curFocus.tree=null,this._schemaData._curFocus.node=null,this._schemaData._curFocus.button=null),this._curFocus.field=null,this._curFocus.cell=null,this._curFocus.grp=null,this._curFocus.tree=null,this._curFocus.cmenu=null,this._curFocus.cformat=null,this._curFocus.selection=null,o=[],this.model.enableGroupingBar&&e("#"+this._id).find(".e-pivotButton:visible").first().length>0&&o.push(e("#"+this._id).find(".e-pivotButton:visible").first()),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&e("[role='columnheader']:visible:not([p='0,0'])").first().length>0?o.push(e("[role='columnheader']:visible:not([p='0,0'])").first()):e("#"+this._id).find("[role='columnheader']:visible").first().length>0&&o.push(e("[role='columnheader']:not('.e-grpRow'):visible:first")),!t.isNullOrUndefined(this._schemaData)&&e("#"+this._schemaData._id).find(".e-text:visible").first().length>0&&o.push(e("#"+this._schemaData._id).find(".e-text:visible").first()),!t.isNullOrUndefined(this._schemaData)&&e("#"+this._schemaData._id).find(".e-pvtBtn:visible").first().length>0&&o.push(e("#"+this._schemaData._id).find(".e-pvtBtn:visible").first()),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&e("#Pager_CategCurrentPage:visible").length>0&&o.push(e("#Pager_CategCurrentPage:visible")),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&e("#Pager_SeriesCurrentPage:visible").length>0&&o.push(e("#Pager_SeriesCurrentPage:visible")),t.isNullOrUndefined(this._curFocus.tab)?this._curFocus.tab=o[0].attr("tabindex","-1"):(this._curFocus.tab.attr("tabindex","0").removeClass("e-hoverCell"),this._curFocus.tab.hasClass("e-active")&&this._curFocus.tab.removeClass("e-active"),t.isNullOrUndefined(this._schemaData)||(e("#"+this._schemaData._id).find(".e-active").removeClass("e-active"),e("#"+this._schemaData._id).find(".e-node-hover").removeClass("e-node-hover"),e("#"+this._schemaData._id).find(".e-node-focus").removeClass("e-node-focus")),this._curFocus.tab.hasClass("e-node-hover")&&this._curFocus.tab.removeClass("e-node-hover"),this._curFocus.tab.mouseleave(),9===i.which&&i.shiftKey?this._index.index=this._index.index-1<0?o.length-1:this._index.index-1:9===i.which&&(this._index.index=this._index.index+1>o.length-1?0:this._index.index+1),this._curFocus.tab=o[this._index.index].attr("tabindex","-1")),this._curFocus.tab.focus().addClass("e-hoverCell").mouseover(),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.tab.mouseover(),this._curFocus.tab.find("span").mouseover()),e(".e-node-focus").removeClass("e-node-focus"),i.stopImmediatePropagation()),93===i.which&&!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&this.model.enableGroupingBar&&(!t.isNullOrUndefined(this._curFocus.grp)||!t.isNullOrUndefined(this._curFocus.tab))&&(i.preventDefault(),document.activeElement.className.startsWith("e-pivotButton")&&(t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(n={x:e(this._curFocus.tab).offset().left+e(this._curFocus.tab).outerWidth(),y:e(this._curFocus.tab).offset().top+e(this._curFocus.tab).outerHeight()},this._curFocus.tab.find("button").trigger({type:"mouseup",which:3,clientX:n.x,clientY:n.y,pageX:n.x,pageY:n.y})):(n={x:e(this._curFocus.grp).offset().left+e(this._curFocus.grp).outerWidth(),y:e(this._curFocus.grp).offset().top+e(this._curFocus.grp).outerHeight()},this._curFocus.grp.find("button").trigger({type:"mouseup",which:3,clientX:n.x,clientY:n.y,pageX:n.x,pageY:n.y})))),13===i.which&&this.model.hyperlinkSettings.enableColumnHeaderHyperlink)t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".cellValue").click():this._curFocus.cell.find(".cellValue").click();else if(13==i.which&&!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!e(".e-waitpopup-pane:visible").length>0){if(e("#"+this._id).find(".e-dialog:visible").length>0){if(e(i.target).hasClass("e-memberCurrentPage")||e(i.target).hasClass("e-memberCurrentSearchPage")||e(i.target).hasClass("e-memberCurrentDrillPage"))return void t.Pivot.editorTreeNavigatee(i,this);if(e(i.target).hasClass("searchEditorTreeView"))return void t.Pivot._searchEditorTreeNodes(i,this)}e("#"+this._id).find(".e-dialog .e-hoverCell").length>0&&e("#"+this._id).find(".e-dialog .e-hoverCell").hasClass("e-text")?e("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-chkbox-small").click():document.activeElement.className.startsWith("e-pivotGridTable")||"rowheader"==document.activeElement.getAttribute("role")||"columnheader"==document.activeElement.getAttribute("role")?t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".e-expand").length>0?this._curFocus.tab.find(".e-expand").click():this._curFocus.tab.find(".e-collapse").length>0&&this._curFocus.tab.find(".e-collapse").click(),this._curFocus.tab=e("#"+this._id).find("[role='"+this._curFocus.tab.attr("role")+"']:contains('"+this._curFocus.tab.text()+"'):visible").first(),this._curFocus.tab.attr("tabindex","-1").focus().addClass("e-hoverCell")):this._curFocus.cell.find(".e-expand,.e-collapse").length>0?(this._curFocus.cell.find(".e-expand,.e-collapse").click(),this._curFocus.cell.removeClass("e-hoverCell").attr("tabindex","0"),this._curFocus.cell=e("#"+this._id).find("[role='"+this._curFocus.cell.attr("role")+"']:contains('"+this._curFocus.cell.text()+"'):visible").first(),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell")):(this._curFocus.cell.click(),this._curFocus.cell.removeClass("e-hoverCell").attr("tabindex","0"),this._curFocus.cell=e("#"+this._id).find("[data-p='"+this._curFocus.cell.attr("data-p")+"']"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell")):t.isNullOrUndefined(this._curFocus.tree)&&t.isNullOrUndefined(this._curFocus.formula)&&(t.isNullOrUndefined(this._curFocus.field)||!this._curFocus.field.hasClass("editFormula"))||e("#"+this._id).find(".e-dialog .e-hoverCell:visible").length>0&&(e("#"+this._id).find(".e-dialog .e-hoverCell:visible").click(),this._index.tree=1),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.attr("tabindex","-1").focus()}79==i.keyCode&&e("#"+this._id).find(".e-dialog").length>0&&i.ctrlKey&&(i.preventDefault(),e("#"+this._id).find(".e-dialogOKBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(d=this._curFocus.tab.attr("data-tag"),s=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(d=this._curFocus.grp.attr("data-tag"),s=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),t.isNullOrUndefined(s)||s.mouseover().addClass("e-hoverCell").focus()),67==i.keyCode&&e("#"+this._id).find(".e-dialog:visible").length>0&&i.ctrlKey&&(i.preventDefault(),e("#"+this._id).find(".e-dialogCancelBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(d=this._curFocus.tab.attr("data-tag"),s=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(d=this._curFocus.grp.attr("data-tag"),s=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),t.isNullOrUndefined(s)||s.mouseover().addClass("e-hoverCell").focus())},_unWireEvents:function(){this._off(this.element,"mousedown",".value",this._initCellEditing),this._off(this.element,"click",".colheader,.cstot,.cgtot,.calc,.stot,.gtot"),this._off(e(document),"keydown",this._keyDownPress),this._off(e(document),"keyup",this._keyUpPress),this._off(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this._off(this.element,"click","#preventDiv"),this._off(this.element,"click","table .e-expand,table .e-collapse"),this._off(this.element,"dblclick",".value, .summary"),this._off(this.element,"click",".value, .summary"),this._off(this.element,"mouseover",".colheader, .rowheader, .e-expand, .e-collapse"),this._off(this.element,"mouseleave",".colheader, .rowheader, .e-expand, .e-collapse"),this._off(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.addHyperlinkHandler),this._off(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.removeHyperlinkHandler),this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary"),this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue"),this._off(this.element,"mouseover",".value"),this._off(this.element,"mouseleave",".value"),this._off(this.element,"mousedown touchstart",".value"),this._off(this.element,"mouseup touchend",".value"),this._off(this.element,"click",".filter"),this._off(this.element,"click",".e-sorting"),this._off(this.element,"click",".e-removeBtn"),this._off(this.element,"mouseover",".e-pvtBtn"),this._off(this.element,"mouseleave",".e-pvtBtn"),e(document).off("keyup",this._endCellSelection),e(document).off("keydown",this._startCellSelection),e(document).off("click",this._clearSelection),this._off(this.element,"click",".calculatedFieldPopup .menuItem "),this._off(this.element,"contextmenu",".values .e-pivotButton"),this._off(this.element,"click",".filter",t.proxy(this._filterBtnClick,this)),this._off(this.element,"click",".e-sorting",t.proxy(this._sortBtnClick,this)),this._off(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this)),this._off(this.element,"click",".e-removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this)),this._off(this.element,"click",".e-ascOrder, .e-descOrder"),this._off(this.element,"click",".clearAllFilters, .clearSorting"),this._off(this.element,"contextmenu"),this._off(this.element,"click",".e-dialogOkBtn"),this._off(this.element,"click",".e-cellSelect"),this._off(this.element,"click",".e-columnResize"),this._off(this.element,"click",".e-excelLikeLayout"),this._off(this.element,"click",".e-advancedFiltering"),this._off(this.element,"click",".e-toolTip"),this._off(this.element,"click",".e-collapseByDefault"),this._off(this.element,"click",".rtl"),this._off(this.element,"click",".e-calculatedField"),this._off(this.element,"click",".e-cellEditing"),this._off(this.element,"click",".groupingBar"),this._off(this.element,"click",".e-conditionalFormat"),this._off(this.element,"click",".e-summaryCustomize"),this._off(this.element,"click",".e-summaryTypes"),this._off(this.element,"click",".e-numberFormatting"),this._off(this.element,"click",".e-rowHeaderHyperLink"),this._off(this.element,"click",".e-colHeaderHyperLink"),this._off(this.element,"click",".e-valueCellHyperLink"),this._off(this.element,"click",".e-summaryCellHyperLink"),this._off(this.element,"click",".e-rowFreeze"),this._off(this.element,"click",".e-colFreeze"),this._off(this.element,"click",".bothFreeze"),this._off(this.element,"click",".e-excel"),this._off(this.element,"click",".e-word"),this._off(this.element,"click",".e-pdf"),this._off(this.element,"click",".csv"),this._off(this.element,"click",".e-frozenHeaders"),this._off(this.element,"click",".e-exporting"),this._off(this.element,"click",".e-layouts"),this._off(this.element,"click",".e-hyperlinkOptions"),this._off(this.element,"click",".e-normalLayout"),this._off(this.element,"click",".e-normalTopSummaryLayout"),this._off(this.element,"click",".e-noSummariesLayout"),this._off(this.element,"click",".e-drillThrough"),this._off(this.element,"mousedown touchstart",".value",this._initCellSelection),this._off(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection),this._off(this.element,"click",".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage"),this._off(this.element,"click",".e-searchEditorTree")},_getFieldName:function(i){var l;if(e(i).hasClass("colheader")||"columnheader"==e(i).attr("role")){var a=parseInt(e(i).attr("data-p").split(",")[1]),r=t.isNullOrUndefined(this.model.dataSource.data)||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-fullScreenView").length>0)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns,o=i.textContent.replace("expanded","");return a<r.length?this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?r[a].fieldName:r[a].FieldName:o}if(e(i).hasClass("rowheader")||"rowheader"==e(i).attr("role"))return l=parseInt(e(i).attr("data-p").split(",")[0]),t.isNullOrUndefined(this.model.dataSource.data)||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this.element.parents(".e-pivotclient").length>0||this.element.parents(".e-fullScreenView").length>0)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows[l].FieldName:JSON.parse(this.getOlapReport()).PivotRows[l].FieldName:t.isNullOrUndefined(this.model.dataSource.rows)?"":this.model.dataSource.rows[l].fieldName},_colResizing:function(t){var i,l;if(this.model.enableColumnResizing)if(this._expand){var a=t.clientX,r=t.clientY,o=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").first()[0].getBoundingClientRect();o.left+document.documentElement.scrollLeft+o.width<a||a<o.left+document.documentElement.scrollLeft?this.element.find(".e-reSizeColbg").remove():-1!=this._currentCell&&this.element.find(".e-reSizeColbg").css({left:a,top:this._tableY})}else{if(this.element.find(".e-reSizeColbg").is(":visible"))return;if("columnheader"==e(t.target).attr("role")){var n=this.resCell=t.target,s=n.getBoundingClientRect();a=t.clientX,r=t.clientY;i=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(".pivotGridFrozenTable,.pivotGridColValueTable").width()+e(".pivotGridFrozenTable,.pivotGridColValueTable").find("tr").offset().left:e(this.element).find("thead").width()+e(this.element).find("thead tr").offset().left,(a>=s.left+document.documentElement.scrollLeft+n.offsetWidth-5||a<=s.left+3)&&a<i&&a>=s.left&&r<=s.top+document.documentElement.scrollTop+t.target.offsetHeight?(a>s.left+3?(l=e(t.target).find("span"),this._currentCell=t.target):(l=e(t.target).prevAll("th:visible:first").find("span"),this._currentCell=e(t.target).prev()),l.length&&e(t.target).parents(".e-pivotGridTable tr").css("cursor","col-resize")):(e(t.target).parent("tr").css("cursor","pointer"),this._currentCell=null)}else this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable tr").css("cursor","pointer"),this._currentCell=null}},_startColResizing:function(t){var i,a,r,o,n;if("col-resize"==e(t.target).closest("tr").css("cursor")&&(i=t.clientX,a=t.clientY,this._target=t.target,this._orgX=i,i+=document.documentElement.scrollLeft,2!=t.button))if(e(this._target).parent("tr").find("[role='columnheader']"),null!=this._currentCell&&(r=e(this._currentCell)[0].getBoundingClientRect()),o=this._tableY=(r==l?0:r.top)+document.documentElement.scrollTop,"col-resize"==e(this._target).closest("tr").css("cursor")){var s=e(document.createElement("div")),d=this.model.enableGroupingBar?this.element.height()-this.element.find(".groupingBarPivot").height():this.model.enableVirtualScrolling?this.element.height()-this.element.find(".e-hScrollPanel").parent().height():this.element.height(),h=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").find("tr[role='row']"),u=e(this._target).parent("tr")[0]==l?0:e(this._target).parent("tr")[0].rowIndex;for(n=0;n<u;n++)d-=e(h[n]).height();s.addClass("e-reSizeColbg").appendTo(this.element).attr("unselectable","on").css("visibility","hidden"),s.css({visibility:"visible",height:d+"px",cursor:"col-resize",left:i,top:o,position:"fixed"}),this._orgX=i,this._orgY=a,this._expand=!0}else this._currentCell=null},_endColResizing:function(i){var l,a,r,o,n,s,d,h,u,c,p,m;if(this._expand&&(l=i.clientX,i.clientY),this.element.find(".e-reSizeColbg").remove(),l+=document.documentElement.scrollLeft,a=e(this._target).parents("thead,.pivotGridFrozenTable,.pivotGridColValueTable"),null!=this._currentCell&&this._expand){r=30,this._expand=!1;var g=this._currentCell,f=e(g)[0].offsetWidth,_=l-this._orgX,v=(this.model.frozenHeaderSettings.enableFrozenHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&"none"==this._JSONRecords[0].CSS;if(parseInt(_)+parseInt(f)>r&&0!=_){for(a.css("cursor","default"),n=0;n<2;n++)if(s=0==n?e(g):e(g).next(),d=0==n?parseInt(e(g).attr("colspan")):parseInt(e(g).next().attr("colspan")),s.length){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if(this.element.find(".e-pivotGridTable").find("[role='columnheader']").find(".e-expand").length>1||this.element.find(".e-pivotGridTable").find("[role='columnheader']").find(".e-collapse").length>1)if(v)o=parseInt(this.element.find(".pivotGridFrozenTable thead tr:last").find("[data-p^='"+s.attr("data-p").split(",")[0]+"']").index());else if(this.model.enableAdvancedFilter){for(h=0,u=0;u<parseInt(s.attr("data-p").split(",")[0]);u++)"none"==this.element.find(".e-pivotGridTable thead tr:last th:eq("+u+")").css("display")&&h++;o=parseInt(s.attr("data-p").split(",")[0])-(h+(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._JSONRecords[0].ColSpan-1:0))}else o=parseInt(this.element.find(".e-pivotGridTable thead tr:last").find("[data-p^='"+s.attr("data-p").split(",")[0]+"']").index())+(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?1:this._JSONRecords[0].ColSpan);else o=v?parseInt(s.attr("data-p").split(",")[0])-this._JSONRecords[0].ColSpan:this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?t.isNullOrUndefined(s.attr("data-i"))?parseInt(s.attr("data-p").split(",")[0]):parseInt(s.attr("data-i").split(",")[0]):parseInt(s.attr("data-p").split(",")[0]);else o=v?parseInt(s.attr("data-p").split(",")[0])-this._JSONRecords[0].ColSpan:this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?parseInt(s.attr("data-i").split(",")[0]):parseInt(s.attr("data-p").split(",")[0]);c=Math.round(_/d),p=this.element.find("col:eq("+o+")").width()+(0==n?c:-c),this._setWidthColResize(o,d,p)}this.element.find("tr").css("cursor","default")}}this.model.enableGroupingBar&&(this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this.element.find(".groupingBarPivot").css({overflow:"hidden"})),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(m=this.element.find(".e-scroller").data("ejScroller"),t.isNullOrUndefined(m)||m.refresh()),!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders&&((m=this.element.find(".e-scroller").data("ejScroller")).model.enableTouchScroll=!1),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find("#coltable").width()<this.element.find(".valScrollArea").width()&&this.element.find("#coltable").width(this.element.find(".valScrollArea").width()),this._target=null,this.element.find(".e-reSizeColbg").remove(),this._expand=!1,this._currentCell=null},_setWidthColResize:function(e,t,i){for(var l=i>30?i:30,a=e;a<e+t;a++)this.element.find("colgroup").find("col:eq("+a+")").outerWidth(l)},_resizeColumnsWidth:function(){var i,l,a,r,o,n;if(!(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||t.isNullOrUndefined(this._JSONRecords))){if(this.model.enableAdvancedFilter||this.element.find(".e-pivotGridTable").find("colgroup").remove(),i=e("<colgroup></colgroup>"),(this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode||t.isNullOrUndefined(this.model.dataSource.columns)||0!=this.model.dataSource.columns.length&&1!=this.model.dataSource.columns.length)&&(this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode||t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotColumns)||0!=JSON.parse(this.getOlapReport()).PivotColumns.length&&1!=JSON.parse(this.getOlapReport()).PivotColumns.length))for(n=0;n<this._JSONRecords.length/this._rowCount&&!t.isNullOrUndefined(this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[n]);n++)r="<col style='width:"+this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[n].offsetWidth/Number(e(this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[n]).attr("colspan"))+"px'></col>",i.append(r);else for(n=0;n<this.element.find(".e-pivotGridTable thead tr:first th").length;n++)for(l=0;l<Number(this.element.find(".e-pivotGridTable thead tr:first th:eq("+n+")").attr("colspan"));l++)a=this.element.find(".e-pivotGridTable thead tr:first th:eq("+n+")"),r="<col style='width:"+(t.isNullOrUndefined(a.offsetWidth)?a.outerWidth():a.offsetWidth)/Number(a.attr("colspan"))+"px'></col>",i.append(r);if(this.model.enableAdvancedFilter&&this.element.find(".e-pivotGridTable").find("colgroup").remove(),this.element.find(".e-pivotGridTable").prepend(i),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&this.element.find(".e-pivotGridTable").css("width","100%"),this.model.enableGroupingBar){if(o=this.element.find(".groupingBarPivot .values").width()>this.element.find(".e-grpRow .e-rows").width()?this.element.find(".groupingBarPivot .values").width():this.element.find(".e-grpRow .e-rows").width(),this._JSONRecords.length>0&&this._JSONRecords[0].ColSpan>=1&&!this.model.resizeColumnsToFit)for(n=0;n<this._JSONRecords[0].ColSpan;n++)this.element.find("colgroup col:eq("+n+")").css("width",o/this._JSONRecords[0].ColSpan);this.element.find(".groupingBarPivot .values").width()<this.element.find(".e-grpRow .e-rows").width()&&this.element.find(".groupingBarPivot .values").css("width",this.element.find(".e-grpRow .e-rows").width()),this.element.find(".e-grpRow").length>0&&this.element.find("colgroup col:eq(0)").width()<140&&this.element.find("colgroup col:eq(0)").css("min-width","140px"),this.element.find(".values").width(this.element.find(".e-grpRow").length>0?this.model.enableDeferUpdate&&0==this.element.find(".colheader").length?this.element.find(".e-grpRow").width():this.element.find(".e-grpRow").width()+4:140),this._createFields(null,this.element.find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())}}},_direction:function(e){return this.model.enableRTL&&!t.isNullOrUndefined(e)&&e.toString().indexOf("-")>-1?e.split("-").reverse().join("-"):e},_clearSelection:function(t){0==e(t.target).parents(".e-pivotGridTable").length&&e(this.element).find(".e-selected").removeClass("e-selected")},_startCellSelection:function(i){var l,a;if("Control"!=this._onholdKey&&!t.isNullOrUndefined(this._selectedCell))if(i.preventDefault(),""==this._onholdKey&&(this._onholdKey="16"==i.which.toString()?"Shift":"17"==i.which.toString()?"Control":""),"40"==i.which){for(r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[1])+this._selectedCell.rowSpan;t.isNullOrUndefined(n)&&o<this._rowCount;)a=e(this.element).find("[data-p='"+r.split(",")[0]+","+o+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(n=a),o++;t.isNullOrUndefined(n)||this._selectCells("Down",n)}else if("38"==i.which){for(r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[1])-1;t.isNullOrUndefined(n)&&o>=0;)a=e(this.element).find("[data-p='"+r.split(",")[0]+","+o+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(n=a),o--;if(t.isNullOrUndefined(n)&&"Shift"!=this._onholdKey&&(e(this._selectedCell).hasClass("colheader")||"columnheader"==e(this._selectedCell).attr("role")))for(column=parseInt(r.split(",")[0])-1;column>0&&t.isNullOrUndefined(n);column--)for(row=parseInt(r.split(",")[1]-1);row>=0&&t.isNullOrUndefined(n);row--)a=e(this.element).find("[data-p='"+column+","+row+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(n=a);t.isNullOrUndefined(n)||this._selectCells("Up",n)}else if("39"==i.which){for(r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[0])+this._selectedCell.colSpan;t.isNullOrUndefined(n)&&o<Math.ceil(this.getJSONRecords().length/this._rowCount);)a=e(this.element).find("[data-p='"+o+","+r.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(n=a),o++;t.isNullOrUndefined(n)||this._selectCells("Right",n)}else if("37"==i.which){for(var r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[0])-1,n=e(this.element).find("[data-p='"+(parseInt(r.split(",")[0])-1)+","+r.split(",")[1]+"']")[0];t.isNullOrUndefined(n)&&o>=0;)a=e(this.element).find("[data-p='"+o+","+r.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(n=a),o--;if(t.isNullOrUndefined(n)&&"Shift"!=this._onholdKey&&(e(this._selectedCell).hasClass("rowheader")||"rowheader"==e(this._selectedCell).attr("role")))for(l=parseInt(r.split(",")[1])-1;t.isNullOrUndefined(n)&&l>0;)a=e(this.element).find("[data-p='"+parseInt(r.split(",")[0]-1)+","+l+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role"))&&(n=a),l--;t.isNullOrUndefined(n)||this._selectCells("Left",n)}},_endCellSelection:function(i){var l,a,r,o,n;if(!t.isNullOrUndefined(this._selectedCell)&&(i.preventDefault(),(16==i.which||17==i.which)&&(this._onholdKey="",(l=e(this.element).find(".e-selected")).length>0))){for(a=[],r=0;r<l.length;r++)o=e(l[r]).attr("data-p"),(n=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))]).Value=e.trim(e(l[r]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(n.Field=this._getFieldName(l[r])),a.push(n);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:a}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:a})}},_selectCells:function(i,l){var a,r,o,n,s,d,h;if("Shift"==this._onholdKey)(("Up"==i||"Down"==i)&&(e(l).hasClass("rowheader")||"rowheader"==e(l).attr("role"))||("Right"==i||"Left"==i)&&(e(l).hasClass("colheader")||"columnheader"==e(l).attr("role")))&&(a="Up"==i||"Down"==i?1:0,("Up"==i||"Left"==i)&&parseInt(e(l).attr("data-p").split(",")[a])>=parseInt(this._primaryCellPos.split(",")[a])||("Right"==i||"Down"==i)&&parseInt(e(l).attr("data-p").split(",")[a])<=parseInt(this._primaryCellPos.split(",")[a])?e(this._selectedCell).removeClass("e-selected"):"0,0"!=e(l).attr("data-p")&&e(l).addClass("selected"));else if("0,0"!=e(l).attr("data-p")&&(this.element.find(".e-selected").removeClass("e-selected"),e(l).addClass("e-selected"),this._primaryCellPos=e(l).attr("data-p"),(r=e(this.element).find(".e-selected")).length>0)){for(o=[],n=0;n<r.length;n++)s=e(r[n]).attr("data-p"),(d=this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))]).Value=e.trim(e(r[n]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(d.Field=this._getFieldName(r[n])),o.push(d);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:o}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:o})}h="Up"==i||"Down"==i?!e(this._selectedCell).hasClass("colheader")&&"columnheader"!=e(this._selectedCell).attr("role"):!e(this._selectedCell).hasClass("rowheader")&&"rowheader"!=e(this._selectedCell).attr("role"),"0,0"!=e(l).attr("data-p")&&("Shift"!=this._onholdKey||h)&&(this._selectedCell=l)},_sortBtnClick:function(i){var l,a,r,o,n,s,d,h;if(t.PivotAnalysis._valueSorting=null,t.isNullOrUndefined(this.model.valueSortSettings)||(this.model.valueSortSettings.headerText=""),this._isUpdateRequired=!0,e(i.delegateTarget).attr("id")==this._id&&(e(i.target).toggleClass("descending"),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".e-pivotButton[data-tag='"+e(i.target).parent().attr("data-tag")+"']").find(".e-sorting").toggleClass("descending")),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)l=e(i.target).siblings(".e-pvtBtn").attr("data-fieldName"),t.Pivot.getReportItemByFieldName(l,this.model.dataSource).item.sortOrder=i.target.className.indexOf("descending")>=0?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending,this.refreshControl();else{for(a=this._ascdes.split("##"),r=0,o=0;o<a.length;o++)a[o]==e(e(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")?r=1:e(i.target).parents().hasClass("e-pivotschemadesigner")&&a[o]==e(e(i.target).siblings(".e-pvtBtn")).text()&&(r=1);n=i.target.className,new RegExp("descending").test(n)?0==r&&(this._ascdes+=e(i.target).parents().hasClass("e-pivotschemadesigner")?e(e(i.target).siblings(".e-pvtBtn")).text()+"##":e(e(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")+"##"):1==r&&(this._ascdes=this._ascdes.replace(e(e(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")+"##","")),d=JSON.stringify(this.model.customObject);try{s=JSON.parse(this.getOlapReport()).Report}catch(e){s=this.getOlapReport()}null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject}),d=JSON.stringify(this.model.customObject),h=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:s,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:d}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.enableDeferUpdate?this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,h,this._sortingSuccess)}},calculateCellWidths:function(){var t,i,l,a,r={rowHeight:0,columnWidths:[]};if(t=null!=this._excelLikeJSONRecords?this._excelLikeJSONRecords.length/this._excelRowCount:null!=this.getJSONRecords()?this.getJSONRecords().length/this._rowCount:0,i=1,l=!1,t>0)for(r.rowHeight=this.element.find("tbody tr:visible").length>0?this.element.find("tbody tr:visible")[0].getBoundingClientRect().height:0,a=0;a<t&&i<=t;a++)e(null!=this._excelLikeJSONRecords?this.element.find("th[data-i^="+a+"]:visible"):this.element.find("th[data-p^="+a+"]:visible")).each(function(){if(e(this).length>0&&e(this).attr("colspan")==i&&(null!=e(this).attr("data-i")?e(this).attr("data-i").split(",")[0]==a:e(this).attr("data-p").split(",")[0]==a))return r.columnWidths.push(this.getBoundingClientRect().width),a+=i-1,i=1,l=!0,!1;l=!1}),l||i==t?i=1:(a--,i++);return r},_deferUpdate:function(){var e,i,l,a,r;if(!this._isUpdateRequired)return!1;this._isUpdateRequired=!1;try{e=JSON.parse(this.getOlapReport()).Report}catch(t){e=this.getOlapReport()}for(i="",l=0;l<this._filterUpdate.length;l++)i+=this._filterUpdate[l]+"%%";a=JSON.stringify(this.model.customObject),r=JSON.stringify({action:"deferUpdate",sortedHeaders:this._ascdes,gridLayout:this.layout(),filterParams:i,currentReport:e,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:a}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.deferUpdate,r,this._renderControlSuccess),this._filterUpdate=[],this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()},_dialogBtnClick:function(i){var a,r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C,S,O,y;if(this.element.find(".e-dialog, .e-clientDialog").hide(),"cancel"==i.model.text.toLowerCase()||!this._isMembersFiltered)return t.Pivot.closePreventPanel(this),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),!1;if(this._savedReportItems=e.extend(!0,[],this._currentReportItems),this.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").length>0&&this.element.find(".e-editorTreeView").ejTreeView("removeNode",this.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").closest("li")),this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)if(a=[],r=[],this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)t.PivotAnalysis._valueSorting=null,this.model.enableMemberEditorPaging||this._editorTreeData.length>0?(jQuery.each(this._editorTreeData,function(e,t){"All"!=t.id&&t.checkedStatus&&a.push(t.name)}),jQuery.each(this._editorTreeData,function(e,t){t.checkedStatus||r.push(t.name="(blank)"==t.name?"":t.name)})):(jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:checked"),function(e,t){"All"!=t.value&&a.push(t.value)}),jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:not(:checked)"),function(t,i){r.push(i.value="(blank)"==i.value?"":e(i).parents("li").find("a").text())})),this._pivotFilterItems(a,r),(c=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item)&&(c.advancedFilter=[]),this.model.editCellsInfo={},this._populatePivotGrid();else{if(n=this.model.dataSource.providerName==t.olap.Providers.Mondrian,this._waitingPopup.show(),s=this._selectedField.toLocaleLowerCase(),this._currentReportItems=e.grep(this._currentReportItems,function(e){if(e["data-fieldName"]!=l&&e["data-fieldName"].toLocaleLowerCase()!=s)return e}),this._memberTreeObj=t.Pivot.updateTreeView(this),d=t.Pivot.getNodesState(this.model.enableMemberEditorPaging||this._editorTreeData.length>0?this._editorTreeData:this._memberTreeObj),null!=this._schemaData&&(this._schemaData._memberTreeObj=this._memberTreeObj),o=this.model.enableMemberEditorPaging||this._editorTreeData.length>0?e.extend(!0,[],this._editorTreeData):this._memberTreeObj.dataSource(),n){for(h=2,u=0;u<o.length;u++)!t.isNullOrUndefined(o[u].level)&&o[u].level>h&&(h=o[u].level);this.model.dataSource._maxLevel=h}if(this._currentReportItems.push({filterItems:o,fieldName:this._selectedField,pageSettings:this._memberCount}),this.model.enableGroupingBar){var P=t.Pivot._getEditorMember(s,this,!1),w="selectedNodes",N="include";this._fieldSelectedMembers[s]=0==e.map(this._fieldMembers[s],function(e){if(!e.checked)return e}).length?"All":"All"!=P&&"multiple"!=P?P:this._getLocalizedLabels("MultipleItems")}n&&(w="unSelectedNodes",N="exclude"),a=e.map(d[w].split("::"),function(e){return{Id:e.split("||")[0],tag:e.split("||")[1],parentId:e.split("||")[2]}}),c=t.Pivot.getReportItemByFieldName(s,this.model.dataSource).item,t.isNullOrUndefined(c)||(""!=d.unSelectedNodes?(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this),c.advancedFilter=[],c.filterItems={filterType:N,values:this._removeSelectedNodes(a)},this.element.find(".e-pivotButton:contains('"+this._selectedField+"') .filter").addClass("filtered"),null!=this._schemaData&&0==this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] .filter").length&&(this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] div:first .e-text").after(t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").addClass("filtered"))):(delete c.filterItems,null!=this._schemaData&&(this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))),this.getJSONData({action:"filtering"},this.model.dataSource,this)}else{"",p="",p=this.element.find(".e-editorTreeView :input.nodecheckbox");var x=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._getUnSelectedNodes()+"FILTERED"+this._getSelectedNodes(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?"Slicers"==this._curFilteredAxis:"Filter"==this._curFilteredAxis):this.model.enableMemberEditorPaging||this._editorTreeData.length>0?this._editorTreeData:this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),T=!1,M=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.enableMemberEditorPaging||this._editorTreeData.length>0?t.Pivot._getUnSelectedTreeState(this)+"FILTERED"+t.Pivot._getSelectedTreeState(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?"Slicers"==this._curFilteredAxis:"Filter"==this._curFilteredAxis,this):x:this._curFilteredAxis+"::"+this._curFilteredText+"::FILTERED",L=this._curFilteredText,D=[],I={};if(m=this.model.enableMemberEditorPaging||this._editorTreeData.length>0?""!=t.Pivot._getUnSelectedTreeState(this):""!=this._getUnSelectedNodes(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(this.model.enableGroupingBar&&t.isNullOrUndefined(this._fieldMembers[L])&&(this._fieldMembers[L]=this._editorTreeData.length>0?e.map(this._editorTreeData,function(e){if("(All)_0"!=e.id)return e.key||e.name}):t.Pivot._getEditorMember(p,this,!1)),this._removeFilterTag(this._curFilteredText),x.length>0&&"(All)_0"==x[0].id&&x.splice(0,1),f=0;f<x.length;f++)this.model.enableMemberEditorPaging||0!=this._editorTreeData.length?0==x[f].checkedStatus&&D.push(x[f].key||x[f].name):D.push(e(x[f].parentElement).siblings("a").text());for(I[L]=D,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),f=0;f<this._tempFilterData.length;f++)t.isNullOrUndefined(this._tempFilterData[f][L])||(this._tempFilterData[f][L]=D,T=!0);if(T||this._tempFilterData.push(I),null!=this._schemaData&&(this._schemaData._tempFilterData=this._tempFilterData),t.isNullOrUndefined(this._curFilteredAxis)||""!=this._curFilteredAxis)for(f=0;f<x.length;f++)this.model.enableMemberEditorPaging||0!=this._editorTreeData.length?0==x[f].checkedStatus&&(M+="##"+(x[f].key||x[f].name)):M+="##"+e(x[f].parentElement).siblings("a").text()}else{for(this.model.enableGroupingBar&&(P=t.Pivot._getEditorMember(L.split(":")[1],this,!1),this._fieldSelectedMembers[L.split(":")[1]]=0==e.map(this._fieldMembers[L.split(":")[1]],function(e){if(!e.checked)return e}).length?"All":"All"!=P&&"multiple"!=P?P:this._getLocalizedLabels("MultipleItems")),I[this._curFilteredText.split(":")[1]]=M,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),f=0;f<this._tempFilterData.length;f++)t.isNullOrUndefined(this._tempFilterData[f][this._curFilteredText.split(":")[1]])||(this._tempFilterData[f]=I,T=!0);T||this._tempFilterData.push(I)}if("excel"==this.model.layout?this.element.find(".e-schemaFieldTree li:contains('"+this._curFilteredText+"')"):this.element.find("."+this._curFilteredAxis+" .e-pivotButton:contains("+this._curFilteredText+") .filterBtn"),g=this._curFilteredText,this.model.layout==t.PivotGrid.Layout.Normal&&null!=this._schemaData){for(f=0;f<this._schemaData.element.find(".e-fieldTable").find("li").length;f++)this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredText.split(":")[1]==e(this._schemaData.element.find(".e-fieldTable").find("li")[f]).attr("data-tag").replace(/\]/g,"").replace(/\[/g,"")&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".e-fieldTable").find("li")[f],g=this._curFilteredText.split(":")[1].split(".")[1]):this._curFilteredText==this._schemaData.element.find(".e-fieldTable").find("li")[f].id&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".e-fieldTable").find("li")[f],g=this._curFilteredText);if(e(this._schemaData._selectedTreeNode).parents("li:eq(0)").children().children("span").hasClass("e-hierarchyCDB")&&(this._schemaData._selectedTreeNode=e(e(this._schemaData._selectedTreeNode).parents("li:eq(0)"))),m&&e(this._schemaData._selectedTreeNode).find(".filter").length<=0?(_=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,e(e(this._schemaData._selectedTreeNode).find(".e-text")[0]).after(_),this._schemaData.element.find(".e-pvtBtn:contains('"+g+"')").parent().find(".filter").addClass("filtered")):m||(e(this._schemaData._selectedTreeNode).find(".filter").remove(),this._schemaData.element.find(".e-pvtBtn:contains('"+g+"')").parent().find(".filter").removeClass("filtered")),""==this._curFilteredAxis)return!1}try{v=JSON.parse(this.getOlapReport()).Report}catch(e){v=this.getOlapReport()}if(this.model.enableAdvancedFilter&&this._selectedLevelUniqueName&&3==this._selectedLevelUniqueName.split("].").length&&((b=this._getAdvancedFilterInfo(this._selectedLevelUniqueName.split("].").slice(0,2).join(".").replace(/\[/g,""))).length>0&&this._removeFilterTag(b[0].levelUniqueName)),"KPI"==this._dialogHead&&(M=x),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),C=JSON.stringify(this.model.customObject),S=this.model.customObject!={}&&""!=M?JSON.stringify({action:"filtering",filterParams:M,sortedHeaders:this._ascdes,currentReport:v,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:C,gridLayout:this.model.layout}):this.model.customObject!={}?JSON.stringify({action:"filtering",currentReport:v,customObject:C,gridLayout:this.model.layout}):""!=M?JSON.stringify({action:"filtering",filterParams:M,sortedHeaders:this._ascdes,currentReport:v,gridLayout:this.model.layout}):JSON.stringify({action:"filtering"}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(e(this._schemaData.element).width()).height(e(this._schemaData.element).height()).css({top:e(this._schemaData.element).offset().top,left:e(this._schemaData.element).offset().left}),this.model.enableDeferUpdate){if(this._filterUpdate.push(M),e.each(this.element.find(".e-pivotButton .filter"),function(t,i){e(i).removeClass("filtered")}),!t.isNullOrUndefined(this._tempFilterData))for(O=0;O<this._tempFilterData.length;O++)for(y in this._tempFilterData[O])this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?y==L.split(":")[1]&&this._tempFilterData[O][L.split(":")[1]].split("FILTERED::")[0].length>0&&this.element.find(".e-pivotButton[data-tag='"+L+"']").find("span.filter").addClass("filtered"):y==L&&this._tempFilterData[O][L].length>0&&this.element.find("#pivotButton"+L).next().addClass("filtered");t.Pivot.closePreventPanel(this),this.model.enableGroupingBar&&this._refreshGroupingBar(this),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")}else this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,S,this._filterElementSuccess)}t.isNullOrUndefined(this._schemaData)||this._schemaData._refreshPivotButtons()},_refreshGroupingBar:function(){this._createGroupingBar(JSON.parse(this.getOlapReport())),this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())},_removeSelectedNodes:function(t){for(var i,a=e.extend([],t),r=0;r<t.length;r++)for(i=0;i<a.length;i++)a[i].Id==t[r].parentId&&a.splice(i,1);return e.map(a,function(e){if(""!=e.tag&&e.tag!=l)return e.tag.replace(/\&/g,"&amp;")})},_pivotFilterItems:function(i,l){var a,r,o=this.model.dataSource["Slicers"==this._selectedAxis?"filters":this._selectedAxis.toLowerCase()],n=t.PivotAnalysis.getMembers(this._selectedField);jQuery.each(n,function(e,t){null!=t&&t.toString().replace(/^\s+|\s+$/gm,"")||jQuery.each(l,function(e,i){i.toString().replace(/^\s+|\s+$/gm,"")||(l[e]=t)})});var s=this._selectedField,d=(this._dialogTitle,e.grep(o,function(e){return e.fieldName==s}));for(a=0;a<d.length;a++)d[a].filterItems=i.length==n.length?null:{filterType:t.PivotAnalysis.FilterType.Exclude,values:l};null!=this._schemaData&&(l.length>0&&this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").length<=0?(r=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".e-text").after(r),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").addClass("filtered")):0==l.length&&(this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").remove(),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))},_getUnSelectedNodes:function(){var i,l,a=this.element.find(".e-editorTreeView")[0],r="",o=e(a).find(":input.nodecheckbox:not(:checked)");if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)for(i=0;i<o.length;i++)e(o[i].parentElement).find("span:nth-child(1)").attr("class").indexOf("e-chk-act")>-1||"mixed"==e(o[i].parentElement).attr("aria-checked")||(r+="::"+(l=e(o[i]).parents("li:eq(0)"))[0].id+"||"+e(l).attr("data-tag")+("KPI"==this._dialogHead?"~&"+e(e(o[i]).parents("ul:eq(1) li")[1]).attr("data-tag"):""));return r},_getSelectedNodes:function(i){var l,a,r,o,n;if(i){for(this.element.find(".e-editorTreeView").length>0?s=this.element.find(".e-editorTreeView")[0].childNodes[0]:t.isNullOrUndefined(this._schemaData)||(s=this._memberTreeObj.element[0].childNodes[0]),d=[],h=e(s).children(),o=0;o<h.length;o++){if(n=h[o],l={caption:e(n.firstChild).find("a").text(),parentId:n.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":e(n).parents()[1].id,id:n.id,checked:e(n).find(":input.nodecheckbox")[0].checked||e(n).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:e(n.firstChild).find(".e-minus").length>0,childNodes:[],tag:e(n).attr("data-tag")},e(n).find("ul:first").children().length>0)for(a=e(n).find("ul:first").children(),r=0;r<a.length;r++)l.childNodes.push(this._getNodeInfo(a[r]));d.push(l)}return JSON.stringify(d)}var s=this.element.find(".e-editorTreeView")[0],d="",h=e(s).find(":input.nodecheckbox");for(o=0;o<h.length;o++)(h[o].checked||"mixed"==e(h[o].parentElement).attr("aria-checked"))&&(d+="::"+(n=e(h[o]).parents("li:eq(0)"))[0].id+"||"+e(n).attr("data-tag")+("KPI"==this._dialogHead?"~&"+e(e(h[o]).parents("ul:eq(1) li")[1]).attr("data-tag"):""));return d},_getNodeInfo:function(t){var i,l,a={caption:e(t.firstChild).find("a").text(),parentId:t.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":e(t).parents()[1].id,id:t.id,checked:e(t).find(":input.nodecheckbox")[0].checked||e(t).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:e(t.firstChild).find(".e-minus").length>0,childNodes:[],tag:e(t).attr("data-tag")};if(e(t).find("ul:first").children().length>0)for(i=e(t).find("ul:first").children(),l=0;l<i.length;l++)a.childNodes.push(this._getNodeInfo(i[l]));return a},_getLevelInfo:function(t,i){var l=e.map(e(i).find("row"),function(i){if("1"!=parseInt(e(i).children("LEVEL_TYPE").text())&&"[measures]"!=e(i).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase()&&e(i).find("HIERARCHY_UNIQUE_NAME").text()==t.hierarchy)return{value:e(i).find("LEVEL_UNIQUE_NAME").text(),text:e(i).find("LEVEL_CAPTION").text()}});this.olapCtrlObj._currentReportItems.push({fieldName:t.hierarchy,dropdownData:l})},_sortField:function(i){var l,a,r,o,n;if(this.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)return l=this._selectedField,this._ascdes=this._ascdes+l+"##","descOrder"!=e(i.element).attr("id")&&(this._ascdes=e.grep(this._ascdes.split("##"),function(e){return e!=l}).join("##")),this._applySorting(),!1;t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item.sortOrder="descOrder"==e(i.element).attr("id")?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending,this.refreshControl()}else{if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._waitingPopup&&this._waitingPopup.show();try{a=JSON.parse(this.getOlapReport()).Report}catch(e){a=this.getOlapReport()}r=!1,this._excelFilterInfo.length>0&&(this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]",o=this._selectedLevelUniqueName,n=this._selectedField,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(l){return(l.hierarchyUniqueName==n||t.isNullOrUndefined(n)||t.isNullOrUndefined(l.hierarchyUniqueName))&&l.levelUniqueName==o&&(r=!0,0==e(i.element).find(".e-clrSort").length?l.sortOrder=e(i.element).attr("id"):delete l.sortOrder),l})),r||this._excelFilterInfo.push({hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:e(i.element).attr("id")}),this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]";var s=this._selectedField+"--"+e(i.element).attr("id"),d=JSON.stringify(this.model.customObject),h=JSON.stringify({action:"labelSorting",filterParams:s,currentReport:a,customObject:d,gridLayout:this.model.layout});return this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,h,this._filterElementSuccess),!1}t.olap.base._clearDrilledCellSet(),("descOrder"==e(i.element).attr("id")||"ascOrder"==e(i.element).attr("id"))&&(t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item.sortOrder="descOrder"==e(i.element).attr("id")?t.olap.SortOrder.Descending:t.olap.SortOrder.Ascending,this._waitingPopup.show(),t.olap.base.getJSONData({action:"sorting"},this.model.dataSource,this))}},_applySorting:function(){var e,i,l=JSON.stringify(this.model.customObject);try{e=JSON.parse(this.getOlapReport()).Report}catch(t){e=this.getOlapReport()}null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject}),l=JSON.stringify(this.model.customObject),i=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:e,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:l}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.enableDeferUpdate?t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,i,this._sortingSuccess)},_createDialog:function(i,l){var a,r,o,n,s,d,h,u,c,p,m,g,f,_,v=this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter,b=!1;v&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this._selectedField=this._curFilteredText,"Slicers"!=this._curFilteredAxis&&(b=this._getAdvancedFilterInfo(this._curFilteredText).length>0),v=!this.element.find(".e-pivotButton button[data-fieldName='"+this._curFilteredText+"']").parents("div:eq(0)").hasClass("e-drag")):v=!(!v||this.element.find(".e-pivotButton[data-tag='"+this._curFilteredText+"']").parents("div:eq(0)").hasClass("e-drag")):v=!(!v||"filters"==t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).axis)),this.element.find(".e-dialog, .e-clientDialog").remove(),this._isOptionSearch=!1,this._currentFilterList={},this._editorSearchTreeData=[],this._isEditorDrillPaging=!1,this._lastSavedTree=[],this._isSearchApplied=!1;var C,S,O,y=this._selectedField,P="",w="";e(document).height();v&&((r=JSON.parse(l))[0].name="(Select All)",this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?(C=this.model.enableMemberEditorPaging?this._memberPagingAvdData:r.splice(r.length-1,1),C=JSON.parse(C[0].levels)):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?0==(C=e.map(this._currentReportItems,function(e){if(e.fieldName==y)return e.dropdownData})).length&&(o=this._getConnectionInfo(this.model.dataSource.data),n='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_LEVELS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+this.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+this.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+this.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+o.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>",this.doAjaxPost("POST",o.url,{XMLA:n},this._getLevelInfo,null,{pvtGridObj:this,action:"loadFieldElements",hierarchy:this._selectedField}),C=e.map(this._currentReportItems,function(e){if(e.fieldName==y)return e.dropdownData})):C=[{value:this._selectedField,text:this._selectedField}],l=JSON.stringify(r),P=t.buildTag("div.e-ddlGroupWrap",this._getLocalizedLabels("SelectField")+t.buildTag("input#GroupLabelDrop.groupLabelDrop").attr("type","text")[0].outerHTML,{})[0].outerHTML,w=t.buildTag("ul.e-filterElementTag")[0].outerHTML,s=t.Pivot.createAdvanceFilterTag({action:"filterTag"},this)),S=t.buildTag("div.e-memberSearchEditorDiv",t.buildTag("input#searchEditorTreeView.searchEditorTreeView").attr("type","text")[0].outerHTML+(this.model.enableMemberEditorPaging&&e.parseJSON(l).length>=this.model.memberEditorPageSize?t.buildTag("span.e-icon e-searchEditorTree",{})[0].outerHTML:""),{padding:v?"5px 5px 0px 9px":"0px"})[0].outerHTML;var N=t.buildTag("div#EditorDiv.e-editorDiv",P+t.buildTag("div",w+S+t.buildTag("div.e-memberEditorDiv",t.buildTag("div#editorTreeView.e-editorTreeView",{"margin-top":this.model.enableAdvancedFilter?"10px":"2px"})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML+(!t.isNullOrUndefined(l)&&this.model.enableMemberEditorPaging&&(e.parseJSON(l).length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage)?"":"</br>"),x=t.buildTag("div",t.buildTag("button#OKBtn.e-dialogOKBtn",this._getLocalizedLabels("OK")).attr({title:this._getLocalizedLabels("OK"),tabindex:0})[0].outerHTML+t.buildTag("button#CancelBtn.e-dialogCancelBtn",this._getLocalizedLabels("Cancel")).attr({title:this._getLocalizedLabels("Cancel"),tabindex:0})[0].outerHTML,{float:"right",margin:(v?"-9px 5px 11px ":"-13px 0px 7px ")+"  0px"})[0].outerHTML,T=t.buildTag("div.e-memberPager",t.buildTag("div#"+this._id+"_NextpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentPage#memberCurrentPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberPageCount#memberPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML)[0].outerHTML,M=t.buildTag("div.e-memberSearchPager",t.buildTag("div#"+this._id+"_NextSearchpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentSearchPage#memberCurrentSearchPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberSearchPageCount#memberSearchPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML,L=t.buildTag("div.e-memberDrillPager",t.buildTag("div#"+this._id+"_NextDrillpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentDrillPage#memberCurrentDrillPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberDrillPageCount#memberDrillPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML;for(O=t.buildTag("div.e-linkOuterPanel",t.buildTag("span.e-infoImg e-icon","",{}).css({float:"left","margin-top":"4px","font-size":"16px"})[0].outerHTML+t.buildTag("a.e-linkPanel",this._getLocalizedLabels("NotAllItemsShowing")).css({display:"inline-block","margin-left":"3px","margin-top":"2px"})[0].outerHTML,{}).css({display:"none","margin-top":"-16px","margin-left":v?"8px":"0px"})[0].outerHTML,d=t.buildTag("div#clientDialog.e-clientDialog",N+(!t.isNullOrUndefined(l)&&this.model.enableMemberEditorPaging?e.parseJSON(l).length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage?L+M+T:L+M:O)+x,{opacity:"1"}).attr("title",i)[0].outerHTML,l=JSON.parse(l),f=0;f<l.length;f++)null!=l[f].name&&l[f].name.toString().replace(/^\s+|\s+$/gm,"")||(l[f].name="(blank)",l[f].id="(blank)"),t.isNullOrUndefined(l[f].id)||"string"!=typeof l[f].id||(l[f].id=l[f].id.replace(/ /g,"_"));if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?!t.isNullOrUndefined(this._fieldMembers):!t.isNullOrUndefined(this._tempFilterData)){if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(f=0;f<Object.keys(this._fieldMembers).length;f++)t.isNullOrUndefined(this._fieldMembers[this._curFilteredText.split(":")[1]])||(h=e.map(this._fieldMembers[this._curFilteredText.split(":")[1]],function(e){if(!e.checked)return e.name}));else for(f=0;f<this._tempFilterData.length;f++)t.isNullOrUndefined(this._tempFilterData[f][i])||(h=this._tempFilterData[f][i]);if(!t.isNullOrUndefined(h))for(f=0;f<h.length;f++)for(u=0;u<l.length;u++)h[f]==l[u].name&&(l[u].checkedStatus=!1)}for(e(d).appendTo("#"+this._id),this.model.enableMemberEditorPaging&&(l.length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage)&&(this.element.find(".e-prevPage, .e-firstPage").addClass("e-pageDisabled"),this.element.find(".e-nextPage, .e-lastPage").addClass("e-pageEnabled"),(c=this._memberCount/this.model.memberEditorPageSize)!=Math.round(c)&&(c=parseInt(c)+1),this.element.find(".e-memberPageCount").html("/ "+c),this.element.find(".e-memberCurrentPage").val(this._memberPageSettings.currentMemeberPage),this._memberPageSettings.currentMemeberPage>1?this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),this._memberPageSettings.currentMemeberPage==parseInt(e.trim(this.element.find(".e-memberPageCount").text().split("/")[1]))?this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),this.element.find(".e-nextPageDiv .e-pageDisabled").css("opacity","0.5")),this.element.find("#searchEditorTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search")+" "+i,maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(function(e){t.Pivot._searchEditorTreeNodes(e,this)},this)}),this.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:this.model.enableRTL,beforeDelete:function(e){if(!t.isNullOrUndefined(e.event)&&"keydown"==e.event.type&&"delete"==e.event.originalEvent.key.toLowerCase())return!1},height:this.model.enableMemberEditorSorting?"200px":v?"inherit":"245px",fields:{id:"id",text:"name",parentId:"pid",expanded:"expanded",isChecked:"checkedStatus",hasChild:"hasChildren",dataSource:t.Pivot._showEditorLinkPanel(l,this,this)}}),v&&(a=this.element.find("[data-tag*='"+(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._selectedField:this._curFilteredText)+"']").offset(),this.element.find(".e-filterElementTag").ejMenu({fields:{dataSource:s,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"},menuType:t.MenuType.NormalMenu,enableRTL:this.model.enableRTL,width:"100%",orientation:t.Orientation.Vertical,click:t.proxy(this._filterElementClick,this)}),this.element.find(".groupLabelDrop").ejDropDownList({width:"99%",enableRTL:this.model.enableRTL,dataSource:C,fields:{id:"id",text:"text",value:"value"},change:t.proxy(this._groupLabelChange,this),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),(p=this.element.find(".groupLabelDrop").data("ejDropDownList")).selectItemByText(p.model.dataSource[0].text),this.element.find(".e-memberEditorDiv").addClass("advancedFilter")),f=0;f<this._editorTreeData.length;f++)null!=this._editorTreeData[f].name&&this._editorTreeData[f].name.toString().replace(/^\s+|\s+$/gm,"")||(this._editorTreeData[f].name="(blank)",this._editorTreeData[f].id="(blank)"),t.isNullOrUndefined(this._editorTreeData[f].id)||"string"!=typeof this._editorTreeData[f].id||(this._editorTreeData[f].id=this._editorTreeData[f].id.replace(/ /g,"_"));for(b&&(this.element.find(".e-editorTreeView").data("ejTreeView").checkAll(),this._editorTreeData=e.map(this._editorTreeData,function(e){return e.checkedStatus=!0,e}),this._editorDrillTreeData=e.map(this._editorTreeData,function(e){return e.checkedStatus=!0,e}),this._editorSearchTreeData=e.map(this._editorTreeData,function(e){return e.checkedStatus=!0,e})),m=this,this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)?this._currentFilterList=JSON.parse(JSON.stringify(this._editorTreeData)):!this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)&&e(l).each(function(e,t){m._currentFilterList[t.id]=t}),e.grep(l,function(e){if(1==e.hasChildren)return e}).length>0||this.element.find(".e-memberEditorDiv").addClass("noChildNode"),g=this.element.find(".e-editorTreeView").find("li"),f=0;f<g.length;f++)g[f].setAttribute("data-tag",l[f].tag);this.element.find(".e-dialogOKBtn, .e-dialogCancelBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(this._dialogBtnClick,this)}),this._dialogOKBtnObj=this.element.find(".e-dialogOKBtn").data("ejButton"),this._memberTreeObj=this.element.find(".e-editorTreeView").data("ejTreeView");var D=this.element.find(".e-editorTreeView li:gt(0)"),I=e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image");e(D).find(":input.nodecheckbox:not(:checked)").length>0&&e(I).removeClass("e-checkmark").addClass("e-stop"),this.model.enableMemberEditorPaging&&(this._isAllMemberChecked||(this._dialogOKBtnObj.disable(),this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),e(I).removeClass("e-checkmark").removeClass("e-stop").addClass("e-chk-inact"))),this.element.find(".e-clientDialog").ejDialog({width:v?"auto":265,target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,this)}),this.element.find("#clientDialog_wrapper").css("top",this.element[0].offsetTop+20),this.element.find(".e-clientDialog").next(".e-scrollbar").hide(),v&&(this.element.find("#clientDialog_wrapper").addClass("e-advancedFilterDlg"),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.element.find("#clientDialog_wrapper").addClass("advancedFilterDlgOSM"),(_=e(".cols-sample-area").position())&&_.left>0?this.element.find("#clientDialog_wrapper").css({left:a.left+50-_.left,top:a.top}):t.isNullOrUndefined(a)||this.element.find("#clientDialog_wrapper").css({left:a.left+50,top:a.top}),this.element.find(".e-clientDialog").css({padding:"0px","min-width":"265px"}).parents().find(".e-titlebar").remove()),this.model.enableMemberEditorSorting&&(this._sortType="",t.Pivot._separateAllMember(this),this.model.enableRTL&&this.element.find(".memberSortDiv, .e-insideDiv").addClass("e-rtl")),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this._memberTreeObj.model.beforeExpand=t.proxy(this._beforeNodeExpand,this):this._memberTreeObj.model.nodeClick=t.proxy(this._nodeExpand,this)),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._memberTreeObj.model.beforeCollapse=t.proxy(t.Pivot._onNodeCollapse,this)),0==this._memberTreeObj.element.find(".e-plus").length&&this._memberTreeObj.element.find(".e-item").css("padding","0px"),this._isMembersFiltered=!1,this._unWireEvents(),this._wireEvents(),this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close")),this.element.find(".e-dialog .e-close").click(function(){var i=e(this).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i._schemaData)||i._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")})},_clearSorting:function(i){var a,r,o;if("disabled"==e(i.target).parent().attr("disabled"))return!1;if(t.Pivot.closePreventPanel(this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._sortField(i):((h=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item).sortOrder=t.PivotAnalysis.SortOrder.None,this.refreshControl());else{if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._waitingPopup&&this._waitingPopup.show(),this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]",this._excelFilterInfo.length>0&&(a=this._selectedLevelUniqueName,r=this._selectedField,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){return(e.hierarchyUniqueName==r||t.isNullOrUndefined(r)||t.isNullOrUndefined(e.hierarchyUniqueName))&&e.levelUniqueName==a&&delete e.sortOrder,e}));try{o=JSON.parse(this.getOlapReport()).Report}catch(e){o=this.getOlapReport()}var n=this._selectedField+"--"+e(i.element).attr("id"),s=JSON.stringify(this.model.customObject),d=JSON.stringify({action:"labelSorting",filterParams:n,currentReport:o,customObject:s,gridLayout:this.model.layout});return this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,d,this._filterElementSuccess),!1}var h,u=this.model.dataSource,c=this._selectedField.toLowerCase();0==(h=e.map(u.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==c)return e})).length&&(h=e.map(u.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==c)return e})),h.length>0&&delete h[0].sortOrder,this.model.dataSource=u,this.element.find(".e-dialog").remove(),this.element.find("#preventDiv").remove(),null!=this._schemaData&&this._schemaData.element.find(".e-dialog").remove(),this._waitingPopup.show(),this.getJSONData({action:"clearSorting"},this.model.dataSource,this)}},_clearAllFilters:function(i){var a,r,o,n,s,d,h,u,c;if("disabled"==e(i.target).parent().attr("disabled"))return!1;if(t.Pivot.closePreventPanel(this),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var p=this.model.dataSource,m=this._selectedField.toLowerCase(),g=e.map(p.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==m)return e});0==g.length&&(g=e.map(p.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==m)return e})),g.length>0&&(null!=(a=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):null==this._schemaData?null:this._schemaData.element.find(".groupLabelDrop").data("ejDropDownList"))?(g[0].advancedFilter&&(g[0].advancedFilter=e.map(g[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLowerCase()!=a.getSelectedValue().toLowerCase())return e})),null!=this._schemaData&&(g[0].advancedFilter&&0==g[0].advancedFilter.length&&this._schemaData._tableTreeObj.element.find("li[data-tag ='"+g[0].fileName+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[data-tag='"+a.getSelectedValue()+"'] div:eq(0) .filter").remove())):delete g[0].advancedFilter,delete g[0].filterItems),this._currentReportItems=e.grep(this._currentReportItems,function(e){if(e["data-fieldName"]!=l&&e["data-fieldName"].toLocaleLowerCase()!=m)return e}),this.model.dataSource=p,this.element.find(".e-dialog").remove(),this.element.find("#preventDiv").remove(),null!=this._schemaData&&(this._schemaData._tableTreeObj.element.find("li[data-tag ='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-dialog").remove()),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._valueFilterArray=e.grep(t.PivotAnalysis._valueFilterArray,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()!=m)return e}),this.refreshControl()):this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)}else{try{r=JSON.parse(this.getOlapReport()).Report}catch(e){r=this.getOlapReport()}if(this._removeFilterTag(this._curFilteredText),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)d=this._curFilteredAxis+"::"+this._curFilteredText+"## Clear Filter",h=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[h])return e}),u=JSON.stringify(this.model.customObject),c=JSON.stringify({action:"labelfiltering",filterParams:d,sortedHeaders:this._ascdes,currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:u,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,c,this._filterElementSuccess);else{if(!t.isNullOrUndefined(this._tempFilterData))for(o=0;o<this._tempFilterData.length;o++)for(n in this._tempFilterData[o])n==this._curFilteredText.split(":")[1]&&""!=this._tempFilterData[o][this._curFilteredText.split(":")[1]]&&(this._tempFilterData.splice(o,1),delete this._fieldMembers[this._curFilteredText.split(":")[1]]);s=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:s}),d=this._selectedLevelUniqueName+"--Clear Filter",h=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[h])return e}),u=JSON.stringify(this.model.customObject),c=JSON.stringify({action:"labelfiltering",filterParams:d,sortedHeaders:this._ascdes,currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:u,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,c,this._filterElementSuccess)}}},_removeFilterTag:function(i){var l,a=[],r=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot;return(i&&i.indexOf("].")>=0||r)&&(l=i.split("].").length>2||r?"levelUniqueName":"hierarchyUniqueName",this._excelFilterInfo.length>0&&(levelName=this._selectedLevelUniqueName,hierarchyName=this._selectedFieldName,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){if(e[l]!=i)return e;a=e.sortOrder}))),a},_groupLabelChange:function(i){var l,a,r,o,n,s=this.element.find(".e-filterElementTag").data("ejMenu");if(s.disableItemByID("labelClearFilter"),s.disableItemByID("valueClearFilter"),s.disableItemByID("clearAllFilters"),s.disableItemByID("clearSorting"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var d,h=this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl:this,u=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):[],c=h._getAdvancedFiltervalue(h._selectedField,u.getSelectedValue()),p=t.Pivot.getReportItemByFieldName(h._selectedField,h.model.dataSource).item,m=t.buildTag("span.e-filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,g=t.buildTag("span.e-activeFilter").addClass("e-icon")[0].outerHTML,f=t.Pivot.getReportItemByFieldName(h._selectedField,h.model.dataSource).item;f&&f.sortOrder&&f.sortOrder!=t.Pivot.SortOrder.None&&(d=f&&f.sortOrder==t.Pivot.SortOrder.Descending?"desc":"asc",t.isNullOrUndefined(d)||"asc"==d?this.element.find(".e-clientDialog .ascImage").addClass("e-selectedSort"):this.element.find(".e-clientDialog .e-descImage").addClass("e-selectedSort"),s.enableItemByID("clearSorting")),this.element.find(".e-filterState,.e-activeFilter").remove(),o=this.element.find("#clearAllFilters a").children().clone(),this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+i.text+'"').append(o),c.length>0?(c[0].advancedFilterType==t.Pivot.AdvancedFilterType.LabelFilter?(this.element.find("#labelFilterBtn a:eq(0)").append(m),this.element.find("#labelFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),l="equals"==c[0].labelFilterOperator||"notequals"==c[0].labelFilterOperator||"lessthanorequalto"==c[0].labelFilterOperator||"greaterthanorequalto"==c[0].labelFilterOperator||"greaterthan"==c[0].labelFilterOperator||"lessthan"==c[0].labelFilterOperator?"_labelFilter":"",this.element.find("#labelFilterBtn li#"+c[0].labelFilterOperator+l+" a").append(g),s.enableItemByID("labelClearFilter")):(this.element.find("#valueFilterBtn a:eq(0)").append(m),this.element.find("#valueFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),a="equals"==c[0].valueFilterOperator||"notequals"==c[0].valueFilterOperator||"lessthanorequalto"==c[0].valueFilterOperator||"greaterthanorequalto"==c[0].valueFilterOperator||"greaterthan"==c[0].valueFilterOperator||"lessthan"==c[0].valueFilterOperator?"_valueFilter":"",this.element.find("#valueFilterBtn li#"+c[0].valueFilterOperator+a+" a").append(g),s.enableItemByID("valueClearFilter")),s.enableItemByID("clearAllFilters")):p&&p.filterItems&&(this.element.find(".e-memberEditorDiv").before(m),this.element.find(".e-filterState").addClass("memberFilter").css("visibility","hidden"),s.enableItemByID("clearAllFilters"))}else{var _,v=this._selectedLevelUniqueName=i.selectedValue,b=(m=t.buildTag("span.e-filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,[]);this._excelFilterInfo.length>0&&(v=this._selectedLevelUniqueName,r=this._selectedFieldName,b=e.map(this._excelFilterInfo,function(e){if(e.hierarchyUniqueName==r&&e.levelUniqueName==v)return{action:e.action,operator:e.operator,value1:e.value1,sortInfo:e.sortOrder}})),o=this.element.find("#clearAllFilters a").children().clone(),this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+i.text+'"').append(o),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?e.grep(this._ascdes.split("##"),function(e){if(e==v)return e}).length>0?(this.element.find(".e-descImage").addClass("e-selectedSort"),s.enableItemByID("clearSorting")):this.element.find(".ascImage").addClass("e-selectedSort"):b.length>0&&(t.isNullOrUndefined(b[0].sortInfo)||!t.isNullOrUndefined(b[0].sortInfo)&&0==b[0].sortInfo.length)||0==b.length||b[0].sortInfo.length>0&&(this.element.find("#"+b[0].sortInfo+" span:eq(0)").addClass("e-selectedSort"),s.enableItemByID("clearSorting")),this.element.find(".e-filterElementTag .e-activeFilter,.e-filterIndicator").remove(),b.length>0&&!t.isNullOrUndefined(b[0].operator)?(s.enableItemByID("clearAllFilters"),n="","valuefiltering"==b[0].action?(n="valueFilterBtn",s.enableItemByID("valueClearFilter"),_="equals"==b[0].operator||"not equals"==b[0].operator||"less than or equal to"==b[0].operator||"greater than or equal to"==b[0].operator||"greater than"==b[0].operator||"less than"==b[0].operator?"_valueFilter":""):(n="labelFilterBtn",s.enableItemByID("labelClearFilter"),_="equals"==b[0].operator||"not equals"==b[0].operator||"less than or equal to"==b[0].operator||"greater than or equal to"==b[0].operator||"greater than"==b[0].operator||"less than"==b[0].operator?"_labelFilter":""),this.element.find("#"+n+" a:eq(0)").append(m),"BottomCount"==b[0].operator.replace(/ /g,"")?this.element.find("#"+n+" li#"+b[0].operator.replace(/ /g,"").replace("Bottom","top")+" a").append(e(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML)):this.element.find("#"+n+" li#"+b[0].operator.replace(/ /g,"")+_+" a").append(e(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML))):""!=this._getUnSelectedNodes()&&(this.element.find(".e-memberEditorDiv").before("<div class='e-filterState e-icon' style='margin-top:5px;position:absolute;visibility:hidden' />"),s.enableItemByID("clearAllFilters"))}},_getAdvancedFiltervalue:function(i,a){var r=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,o=[];return r&&r.advancedFilter&&(o=e.map(r.advancedFilter,function(e){if(e.name!=l&&e.name.toLocaleLowerCase()==a.toLowerCase())return e})),o},_filterElementClick:function(i,a){var r,o,n,s,d,h;if("labelFilterBtn"==i.ID||"valueFilterBtn"==i.ID)return!1;if(r=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):a.element.find(".groupLabelDrop").data("ejDropDownList"),this._selectedLevelUniqueName=r.getSelectedValue(),"clearAllFilters"==i.ID||"valueClearFilter"==i.ID&&"pivot"==this.model.analysisMode&&"servermode"==this.model.operationalMode){if(this._clearAllFilters(i),"valueClearFilter"==i.ID&&"pivot"==this.model.analysisMode&&"servermode"==this.model.operationalMode)return!1}else"clearSorting"==i.ID?this._clearSorting(i):("ascOrder"==i.ID||"descOrder"==i.ID)&&this._sortField(i);if(this.element.find(".e-dialog, .e-filterDialog, #preventDiv").remove(),null!=this._schemaData&&this._schemaData.element.find(".e-dialog").remove(),!e(i.element).parent().hasClass("e-filterElementTag")&&"ascOrder"!=i.ID&&"descOrder"!=i.ID&&"clearSorting"!=i.ID&&"clearAllFilters"!=i.ID)if(o=this._selectedField,this._filterAction=t.isNullOrUndefined(i.element)?t.isNullOrUndefined(i.parentId)&&(t.isNullOrUndefined(i.menuId)||""==i.menuId)?"valueFilterBtn"==e(i.selectedItem).attr("id")?"valueFiltering":"labelFilterBtn"==e(i.selectedItem).attr("id")?"labelFiltering":"":"valueFilterBtn"==i.parentId?"valueFiltering":"labelFilterBtn"==i.menuId?"labelFiltering":"":0==e(i.element).parents("#valueFilterBtn").length?"labelFiltering":"valueFiltering",e.trim(i.text)==e.trim(this._getLocalizedLabels("ClearFilter"))){if(this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode){t.Pivot.closePreventPanel(this);var u,c=this._selectedLevelUniqueName.toLowerCase(),p=[];return 0==(u=e.map(this.model.dataSource.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})).length&&(u=e.map(this.model.dataSource.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})),t.PivotAnalysis._valueFilterArray=e.grep(t.PivotAnalysis._valueFilterArray,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()!=o.toLowerCase())return e}),u.length>0&&(u[0].advancedFilter&&(p=e.map(u[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLowerCase()!=c)return e})),u[0].advancedFilter=p,this._schemaData&&(0==u[0].advancedFilter.length&&this._schemaData._tableTreeObj.element.find("li[data-tag ='"+o+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedLevelUniqueName+"'] div:eq(0) .filter").remove())),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.refreshControl():this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this),!1}this._removeFilterTag(this._selectedLevelUniqueName);try{n=JSON.parse(this.getOlapReport()).Report}catch(e){n=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)g=JSON.stringify(this.model.customObject),f=JSON.stringify({action:this._filterAction.toLowerCase(),filterParams:this._selectedLevelUniqueName+"--Clear Filter",currentReport:n,customObject:g,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,f,this._filterElementSuccess);else{s=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[s])return e});var m=this._curFilteredAxis+"::"+this._curFilteredText+"## Clear Filter",g=JSON.stringify(this.model.customObject),f=JSON.stringify({action:this._filterAction.toLowerCase(),filterParams:m,sortedHeaders:this._ascdes,currentReport:n,customObject:g,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,f,this._filterElementSuccess)}}else this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(h=[],d=this._selectedLevelUniqueName,this._excelFilterInfo.length>0&&"true"!=e(i.element).siblings("li:eq(0)").attr("disable")&&((h=e.map(this._excelFilterInfo,function(e){if(e.levelUniqueName==d&&!t.isNullOrUndefined(e.operator))return{value1:e.value1,value2:e.value2,operator:e.operator,measure:e.measure}})).length>0&&i.ID.replace("_valueFilter","").replace("_labelFilter","")!=h[0].operator.replace(/ /g,"")&&(h=[])),t.Pivot.createAdvanceFilterTag({action:"labelFiltering"==this._filterAction?"labelFilterDlg":"valueFilterDlg",selectedArgs:i,filterInfo:h},this)):(0==(u=e.map(this.model.dataSource.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})).length&&(u=e.map(this.model.dataSource.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})),h=[],u[0].advancedFilter&&(h=e.map(u[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLowerCase()!=c)return e})),t.Pivot.createAdvanceFilterTag({action:"labelFiltering"==this._filterAction?"labelFilterDlg":"valueFilterDlg",selectedArgs:i,filterInfo:h},this))},_filterOptionChanged:function(i){var l,a=this._getAdvancedFiltervalue(this._selectedField,this._selectedLevelUniqueName);a=a.length>0?"label"==a[0].advancedFilterType&&i.value.replace(/ /g,"")==a[0].labelFilterOperator?a[0].values:"value"==a[0].advancedFilterType&&i.value.replace(/ /g,"")==a[0].valueFilterOperator?a[0].values:[""]:[""],l=this.element.find(".filterValuesTd")[0],i.value.toLowerCase().indexOf("between")>=0&&e(l).html("<input type='text' id='filterValue1' class='e-filterValues' value='"+a[0]+"' style='display:inline'/> <span>"+this._getLocalizedLabels("and")+"</span> <input type='text' id='filterValue2' value='"+(t.isNullOrUndefined(a[1])?"":a[1])+"' class='e-filterValues' style='display:inline' /> </br>"),i.value.toLowerCase().indexOf("between")<0&&e(l).html("<input type='text' id='filterValue1' class='e-filterValues' value='"+a[0]+"' style='display:inline'/>")},_filterElementOkBtnClick:function(){var i,a,r,o,n,s;t.Pivot.closePreventPanel(this);var d=this.element.find(".filterOptions")[0].value,h=[this.element.find("#filterValue1")[0].value],u=[],c=this._selectedField;if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){h[0].value;var p,m,g=this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:"",f=this._filterAction.toLowerCase();if(m=this._selectedLevelUniqueName+"--"+d+"--"+h[0],this.element.find(".filterMeasures").length>0&&(this.element.find("#filterValue2").length>0&&(m=m+","+g),m=m+"--"+(p=this.element.find(".filterMeasures").data("ejDropDownList").model.value),f="valuefiltering",null==p))return;try{i=JSON.parse(this.getOlapReport()).Report}catch(e){i=this.getOlapReport()}if(v=JSON.stringify(this.model.customObject),b=JSON.stringify({action:f,filterParams:m,currentReport:i,customObject:v,gridLayout:this.model.layout}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(e(this._schemaData.element).width()).height(e(this._schemaData.element).height()).css({top:e(this._schemaData.element).offset().top,left:e(this._schemaData.element).offset().left}),""!=(a=this._curFilteredText.indexOf(":")>-1?this._curFilteredText.split(":")[1]:"")&&this._tempFilterData&&(this._tempFilterData=e.grep(this._tempFilterData,function(e){if(t.isNullOrUndefined(e[a]))return e})),r=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({action:f,hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,operator:d,measure:p,value1:h[0],value2:g,sortOrder:r}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap)this.model.enableDeferUpdate||this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,b,this._filterElementSuccess);else if("labelFiltering"==this._filterAction){o=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[o])return e});var _=this._curFilteredAxis+"::"+this._curFilteredText+"##"+d+"::"+h[0],v=JSON.stringify(this.model.customObject),b=JSON.stringify({action:f,filterParams:_,sortedHeaders:this._ascdes,currentReport:i,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:v,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,b,this._filterElementSuccess)}else{o=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[o])return e}),this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList"),p=this._measureDDL.getSelectedValue();_=this._curFilteredText+"::"+d+"::"+p+"::"+h[0]+"::"+(this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:""),v=JSON.stringify(this.model.customObject),b=JSON.stringify({action:f,filterParams:_,sortedHeaders:this._ascdes,currentReport:i,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:v,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,b,this._filterElementSuccess)}return!1}if("valueFiltering"==this._filterAction){if(this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList"),p=this._measureDDL.getSelectedValue(),isNaN(parseFloat(h[0]))||!isFinite(h[0])||""==p)return;this.element.find("#filterValue2")[0]!=l&&h.push(this.element.find("#filterValue2")[0].value)}if(this.element.find(".e-dialog").remove(),this._schemaData){var C=t.buildTag("span.filter").addClass("e-icon")[0].outerHTML,S=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedLevelUniqueName+"'] div:eq(0)"),O=this._schemaData._tableTreeObj.element.find("li[data-tag ='"+c+"'] div:eq(0)");0==S.find(".filter").length&&S.append(C),0===O.find(".filter").length&&O.append(C)}n=this._selectedLevelUniqueName.toLowerCase(),0==(s=e.map(this.model.dataSource.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLocaleLowerCase()==c.toLowerCase())return e})).length&&(s=e.map(this.model.dataSource.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLocaleLowerCase()==c.toLowerCase())return e})),s.length>0&&(delete s[0].filterItems,s[0].advancedFilter&&(u=e.map(s[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLocaleLowerCase()!=n)return e})),"labelfiltering"==this._filterAction.toLowerCase()?u.push({name:this._selectedLevelUniqueName,labelFilterOperator:d.replace(/ /g,""),advancedFilterType:t.Pivot.AdvancedFilterType.LabelFilter,values:h}):u.push({name:this._selectedLevelUniqueName,valueFilterOperator:d.replace(/ /g,""),advancedFilterType:t.Pivot.AdvancedFilterType.ValueFilter,values:h,measure:p}),this._currentReportItems=e.grep(this._currentReportItems,function(e){if(e["data-fieldName"]!=c)return e}),s[0].advancedFilter=u,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this))),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._valueSorting=null,t.PivotAnalysis._valueFilterArray=e.grep(t.PivotAnalysis._valueFilterArray,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()!=c.toLowerCase())return e}),"valueFiltering"==this._filterAction&&t.PivotAnalysis._valueFilterArray.push(s[0]),this.refreshControl()):this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)},_nodeCheckChanges:function(i){var a,r,o,n,s;if(this._onDemandNodeExpand){this._isMembersFiltered=!0;var d=this,h=this.element.find(".e-editorTreeView"),u=null,c=!t.isNullOrUndefined(i.model.id)&&"allelement"==i.model.id.toLowerCase()&&!i.isChecked||!t.isNullOrUndefined(i.id)&&("(all)_0"==i.id.toLowerCase()||"all"==i.id.toLowerCase())&&!t.isNullOrUndefined(i.type)&&"nodeUncheck"==i.type,p=!t.isNullOrUndefined(i.model.id)&&"allelement"==i.model.id.toLowerCase()&&i.isChecked||!t.isNullOrUndefined(i.id)&&("(all)_0"==i.id.toLowerCase()||"all"==i.id.toLowerCase())&&!t.isNullOrUndefined(i.type)&&"nodeCheck"==i.type;if(c){if(this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this._isOptionSearch?(u=e(h).find("li[data-isItemSearch='true']")).length>0&&e(u).each(function(t,i){e(h).ejTreeView("uncheckNode",e(i))}):this.model.enableMemberEditorPaging&&e(h).find("li span.e-searchfilterselection").length>0?(e(h).ejTreeView("unCheckAll"),this._isSelectSearchFilter?e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):e(h).ejTreeView("unCheckAll"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),e(h).find("li").length>0&&!e(h).find("li").find("span.e-checkmark").length>0?this._dialogOKBtnObj.disable():e(h).find("li").length>0&&1==e(h).find("li").find("span.e-checkmark").length&&e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0&&this._dialogOKBtnObj.disable(),this.model.enableMemberEditorPaging||this._editorTreeData.length>0){if(this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),this._isAllMemberChecked=!1,this._editorSearchTreeData.length>0)for(s=0;s<this._editorSearchTreeData.length;s++)e(this._editorTreeData).each(function(e,t){if(d._editorSearchTreeData[s].id==t.id)return d._editorSearchTreeData[s].checkedStatus=!1,t.checkedStatus=!1,!1});else e(this._editorTreeData).each(function(e,t){t.checkedStatus=!1});e(this._editorTreeData).each(function(e,t){if(t.checkedStatus)return d._dialogOKBtnObj.enable(),d.element.find(".e-dialogOKBtn").removeAttr("disabled"),!1})}}else if(p){if(this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this._isOptionSearch?(u=e(h).find("li[data-isItemSearch='true']")).length>0&&e(u).each(function(t,i){e(h).ejTreeView("checkNode",e(i))}):this.model.enableMemberEditorPaging&&e(h).find("li span.e-searchfilterselection").length>0?(e(h).ejTreeView("checkAll"),this._isSelectSearchFilter?e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):e(h).ejTreeView("checkAll"),e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),e(h).find("li").length>0&&e(h).find("li").find("span.e-checkmark").length>0&&this._dialogOKBtnObj.enable(),this.model.enableMemberEditorPaging||this._editorTreeData.length>0)if(this.element.find(".e-dialogOKBtn").removeAttr("disabled"),this._isAllMemberChecked=!0,this._editorSearchTreeData.length>0)for(s=0;s<this._editorSearchTreeData.length;s++)e(this._editorTreeData).each(function(e,t){if(d._editorSearchTreeData[s].id==t.id)return d._editorSearchTreeData[s].checkedStatus=!0,t.checkedStatus=!0,!1});else e(this._editorTreeData).each(function(e,t){t.checkedStatus=!0})}else if("searchfilterselection"==i.id.toLowerCase())t.Pivot._updateSearchFilterSelection(i,h,d);else if((t.isNullOrUndefined(i.model.id)||"allelement"!=i.model.id.toLowerCase())&&(t.isNullOrUndefined(i.id)||"(all)_0"!=i.id.toLowerCase()&&"all"==i.id.toLowerCase())||!this.model.enableMemberEditorPaging&&!this._editorTreeData){if(!t.isNullOrUndefined(i.model.id)&&"allelement"==i.model.id.toLowerCase()||!t.isNullOrUndefined(i.id)&&("(all)_0"==i.id.toLowerCase()||"all"!=i.id.toLowerCase()))if(r=this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),o=e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),"KPI"==this._dialogHead){for(p=!0,n=this.element.find(".e-editorTreeView ul:eq(0)"),s=0;s<n.children("li").length;s++)if("false"==n.children("li:eq("+s+")").find(".e-check-small").attr("aria-checked")){p=!1;break}p?this._dialogOKBtnObj.enable():(o.removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable())}else 0==r.length||1==r.length&&0==r[0].id[r[0].id.length-1]?(e(o).parent().removeClass("e-chk-inact").removeClass("e-chk-ind").addClass("e-chk-act"),o.removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark")):"nodeCheck"==i.type&&1==r.length&&0==r[0].id[r[0].id.length-1]?(o.removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark")):r.length>0&&(o.removeClass("e-checkmark").addClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop")),this._dialogOKBtnObj.enable(),"nodeUncheck"==i.type&&(r.length+1==this._memberTreeObj.element.find("li").length?(o.removeClass("e-checkmark").removeClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable()):this._isOptionSearch&&e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0&&1==this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:checked").length&&(o.removeClass("e-checkmark").removeClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable()))}else"nodeUncheck"==i.type?(this._isMembersFiltered=!0,a="",t.Pivot._memberPageNodeUncheck(i,this),a=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l).where("checkedStatus","equal",!0)),!t.isNullOrUndefined(a)&&a.length>0&&("All"==a[0].id||"(All)_0"==a[0].id)&&a.splice(0,1),o=e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),t.isNullOrUndefined(a)||0!=a.length?(e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),e(this._editorTreeData).each(function(t,i){if(i.checkedStatus)return this._isAllMemberChecked=!1,e(d._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop"),!1})):(this._dialogOKBtnObj.disable(),this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),this._isAllMemberChecked=!1,o.removeClass("e-stop").removeClass("e-checkmark").addClass("e-chk-inact"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").addClass("e-chk-inact"))):"nodeCheck"==i.type&&(this._isMembersFiltered=!0,t.Pivot._memberPageNodeCheck(i,this),this.element.find(".e-dialogOKBtn").data("ejButton").enable(),this.element.find(".e-dialogOKBtn").removeAttr("disabled"),this._isAllMemberChecked=!0,e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),e(this._editorTreeData).each(function(t,i){if(!i.checkedStatus)return this._isAllMemberChecked=!1,e(d._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop"),!1}))}},_fetchMemberSuccess:function(i){i[0]!=l&&i.length>0?(this._currentMembers=i[0].Value,null!=i[1]&&i[1]!=l&&(this.model.customObject=i[1].Value)):i.d!=l&&i.d.length>0?(this._currentMembers=i.d[0].Value,null!=i.d[1]&&i.d[1]!=l&&(this.model.customObject=i.d[1].Value)):i!=l&&i.length>0?(this._currentMembers=i.EditorTreeInfo,null!=i&&i!=l&&(this.model.customObject=i.customObject)):i!=l&&(this._currentMembers=i.EditorTreeInfo),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&!this.model.enableMemberEditorPaging&&(0==this._editorTreeData.length||this._isFilterBtnClick)&&(this._editorTreeData=JSON.parse(this._currentMembers),this.model.enableAdvancedFilter&&(this._editorTreeData=e.map(this._editorTreeData,function(e){if(t.isNullOrUndefined(e.levels))return e}))),this._savedReportItems=e.extend(!0,[],this._currentReportItems),this._isFilterBtnClick=!1,this._createDialog(this._dialogHead,this._currentMembers),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject}),this.model.dataSource.enableAdvancedFilter?this.element.find(".e-dialog #GroupLabelDrop_wrapper:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"):t.isNullOrUndefined(this.element.find(".e-dialog .e-text:visible").first())||this.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"),this._waitingPopup.hide()},_filterElementSuccess:function(e){e[0]!=l?null!=e[2]&&e[2]!=l&&(this.model.customObject=e[2].Value):e.d!=l?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):null!=e.customObject&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),this._renderControlSuccess(e)},_sortingSuccess:function(e){e[0]!=l?e[2]!=l&&e.length>0&&(this.model.customObject=e[2].Value):e.d!=l&&e.d.length>0?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):e!=l&&e.length>0&&null!=e.customObject&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject}),this._renderControlSuccess(e)},_nodeExpand:function(i){var a,r,o,n,s,d,h,u,c,p,m=t.isNullOrUndefined(i.event)?i.targetElement:i.event.originalEvent!=l&&i.event.originalEvent.target!=l?i.event.originalEvent.target:i.event.target,g="";if(this._isSchemaClick=!!i._isSchemaClick,m!=l&&m.className!=l&&""!=m.className&&m.className.indexOf("e-minus")>-1)return i.olapCtrlObj=i._isSchemaClick?this._schemaData:this,void t.Pivot._onNodeCollapse(i);if(jQuery.each(this._isSchemaClick?this._schemaData._editorTreeData:this._editorTreeData,function(e,t){if(t.id==i.id)return t.expanded=!0,t.isChildMerged=!0,!1}),a=e(m).parents("li").first().children().find("li").length,r=i._isSchemaClick?this._schemaData._memberTreeObj.dataSource():this._memberTreeObj.dataSource(),this.model.enableMemberEditorPaging)for(o=0;o<r.length;o++)if(r[o].parentId==i.id||r[o].pid==i.id)return i.isChildLoaded=!0,void t.Pivot.closePreventPanel(this);if(!t.isNullOrUndefined(this)&&this.model.enableMemberEditorPaging&&t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i.id)).length>0&&m!=l&&m.className!=l&&""!=m.className&&m.className.indexOf("e-plus")>-1&&0==a)return i.isChildLoaded=!0,t.Pivot.closePreventPanel(this),this.pNode=m,void this._fetchChildNodeSuccess({ChildNodes:JSON.stringify(t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i.id))),customObject:this.model.customObject});if(m!=l&&m.className!=l&&""!=m.className&&m.className.indexOf("e-plus")>-1&&0==a){e(m).removeClass("e-plus").addClass("e-load"),n=e(m).parent().find("input.e-checkbox").prop("checked"),d=e(m).parents("li").first().attr("data-tag"),this.pNode=m;try{s=JSON.parse(this.model.pivotControl!=l?this.model.pivotControl.getOlapReport():this.getOlapReport()).Report}catch(e){s=this.model.pivotControl!=l?this.model.pivotControl.getOlapReport():this.getOlapReport()}for(h=this.element.find(".e-pivotButton"),c=0;c<h.length>0;c++)e(h[c]).attr("data-tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&e(h[c]).attr("data-tag").split(":")[1].length==(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?0:this._schemaData._curFilteredText.length:this._curFilteredText.length)?g=e(h[c]).attr("data-tag"):e(h[c]).attr("data-tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&(u=e(h[c]).attr("data-tag"));g=""==g?t.isNullOrUndefined(u)?t.isNullOrUndefined(this._curFilteredText)?this._schemaData._curFilteredText:this._curFilteredText:u.split(":")[1]:g.split(":")[1],null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject}),p=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.memberExpand,JSON.stringify({action:"memberExpanded",checkedStatus:n,parentNode:e(m).parents("li")[0].id,tag:d,cubeName:JSON.parse(this._olapReport).CurrentCube+"##"+g,currentReport:s,customObject:p}),this._fetchChildNodeSuccess)}},_fetchChildNodeSuccess:function(i){var a,r,o,n,s,d;i.length>1&&i[0]!=l?(a=JSON.parse(i[0].Value),null!=i[1]&&i[1]!=l&&(this.model.customObject=i[1].Value)):i.d!=l?(a=JSON.parse(i.d[0].Value),null!=i.d[1]&&i.d[1]!=l&&(this.model.customObject=i.d[1].Value)):(a=JSON.parse(i.ChildNodes),null!=i.customObject&&i.customObject!=l&&(this.model.customObject=i.customObject)),r=e(this.pNode).parents("li").length>1?e(this.pNode).parents("li").first():e(this.pNode).parents("li"),e(e(r).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1}),o=this._isSchemaClick?this._schemaData:this,this.model.enableMemberEditorPaging?(n=t.Pivot._generateChildWithAncestors(o,r,this.model.enableMemberEditorPaging,this.model.memberEditorPageSize),a.length>=this.model.memberEditorPageSize||n.lstChildren.length>=this.model.memberEditorPageSize?(o.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),o._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(o,r[0].id),o._isEditorDrillPaging=!0,s=n.allLvlLst.length>1&&n.lstChildren.length>=this.model.memberEditorPageSize?t.Pivot._getParentsTreeList(o,n.lstParents[0].id,o._editorTreeData):e.grep(o._editorTreeData,function(e){return e.id==r[0].id})[0],d={childNodes:n.allLvlLst.length>1&&n.lstChildren.length>=this.model.memberEditorPageSize?n.lstChildren:a,parentNode:s},t.Pivot._drillEditorTreeNode(d,o,this.model.memberEditorPageSize)):t.isNullOrUndefined(this._memberTreeObj)||!this._editorFlag||this._isSchemaClick?t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this._schemaData,this),r):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this,this),r)):(t.isNullOrUndefined(this._memberTreeObj)||!this._editorFlag||this._isSchemaClick?t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this._schemaData,this),r):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this,this),r),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&e.merge(o._editorTreeData,e.extend(!0,[],a))),a.length>0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.enableMemberEditorPaging&&!t.DataManager(o._editorTreeData).executeLocal(t.Query().where("pid","equal",a[0].pid)).length>0&&e.merge(o._editorTreeData,e.extend(!0,[],a)),e.each(e(r).children().find("li"),function(e,t){t.setAttribute("data-tag",a[e].tag)}),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject}),t.isNullOrUndefined(this._schemaData)||this.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")},_beforeNodeExpand:function(e){t.Pivot.getChildNodes(e,this._selectedField,this._currentReportItems,this.model.dataSource,this)},_generateAllMember:function(t,i){this.olapCtrlObj._allMember=e(e(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},_generateMembers:function(i,a){var r,o,n,s,d=e(a).find("Axis:eq(0) Tuple"),h=[],u={};for(h.push({id:"All",name:"All",checkedStatus:!0,tag:""}),r=0;r<d.length;r++)o=e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[0]).text(),n=e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[1]).text(),u={hasChildren:"0"!=e(d[r]).find("CHILDREN_CARDINALITY").text(),checkedStatus:!0,id:o.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_"),name:n,tag:o,level:parseInt(e(d[r]).find("LNum").text())},h.push(u);t.isNullOrUndefined(this.olapCtrlObj)||(this.olapCtrlObj._waitingPopup.hide(),this.olapCtrlObj._editorTreeData=h,this.olapCtrlObj._currentReportItems.push({filterItems:h,fieldName:this.olapCtrlObj._selectedField,dataSrc:this.olapCtrlObj.model.dataSource,pageSettings:this.olapCtrlObj._memberCount}),this.olapCtrlObj.model.enableMemberEditorPaging?(this.olapCtrlObj._memberCount=t.DataManager(this.olapCtrlObj._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All"))).length,s=t.DataManager(this.olapCtrlObj._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(this.olapCtrlObj._memberPageSettings.currentMemeberPage,this.olapCtrlObj.model.memberEditorPageSize+1)),this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(s)})):this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(h)}))},_filterBtnClick:function(i){var a,r,o,n;if(this._editorFlag=!0,t.Pivot.openPreventPanel(this),this._isAllMemberChecked=!0,this.model.operationalMode==t.Pivot.OperationalMode.ClientMode)if(this.model.enableMemberEditorPaging&&(this._memberPageSettings.endPage=this.model.memberEditorPageSize,this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var s,d=this._selectedField=e(i.currentTarget.parentNode).attr("data-tag").split(":")[1],h=[];this._dialogHead=e(i.target).siblings(".e-pvtBtn").attr("data-fieldCaption"),h=e.map(this._currentReportItems,function(i){if(i.fieldName==d&&(s=i.pageSettings,!t.isNullOrUndefined(i.filterItems)))return e.map(i.filterItems,function(e){return e.expanded&&(e.expanded=!1),e})}),this.model.enableMemberEditorPaging&&s&&s&&(this._memberCount=s),h.length>0?(this._editorTreeData=h,this.model.enableMemberEditorPaging&&(this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All"))).length,h=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize+1))),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(h)})):(this._waitingPopup.show(),t.olap._mdxParser.getMembers(this.model.dataSource,d,this))}else this._selectedField=e(i.target).siblings(".e-pvtBtn").attr("data-fieldName"),this._dialogHead=e(i.target).siblings(".e-pvtBtn").attr("data-fieldCaption"),this._selectedAxis=e(i.target).siblings(".e-pvtBtn").attr("data-axis"),a=this._getTreeViewData(this._selectedField,this._selectedAxis),this.model.enableMemberEditorPaging?(h=a,this._editorTreeData=h,this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("id","notequal","All")).length,h=t.DataManager(this._editorTreeData).executeLocal(t.Query().page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize+1)),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(h)})):this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(a)});else{this._isFilterBtnClick=!0,this._curFilteredAxis=i.target.parentElement.getAttribute("data-tag").split(":")[0],this._curFilteredText=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.getAttribute("data-tag"):e(e(i.target).siblings()[1]).attr("data-fieldName"),this._dialogTitle=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.getAttribute("data-tag"):e(e(i.target).siblings()[1]).attr("data-fieldName"),this._dialogHead=e(e(i.target).siblings("button")).attr("data-fieldCaption");try{r=JSON.parse(this.getOlapReport()).Report}catch(e){r=this.getOlapReport()}this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(e(this._schemaData.element).width()).height(e(this._schemaData.element).height()).css({top:e(this._schemaData.element).offset().top,left:e(this._schemaData.element).offset().left}),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject}),o=JSON.stringify(this.model.customObject),n=JSON.stringify({action:"fetchMembers",headerTag:this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.enableAdvancedFilter?this._dialogTitle+"##"+this.model.enableAdvancedFilter:this._dialogTitle,sortedHeaders:this._ascdes,currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:o}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMembers,n,this.model.enableMemberEditorPaging?t.Pivot._fetchMemberPageSuccess:this._fetchMemberSuccess)}},_getTreeViewData:function(i){var a,r=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,o=t.PivotAnalysis.getMembers(i),n=[{id:"All",name:"All",checkedStatus:!0}];if(null!=r.filterItems&&r.filterItems!=l)for(a=0;a<o.length;a++)n.push({id:o[a],name:o[a],checkedStatus:r.filterItems.filterType==t.PivotAnalysis.FilterType.Include?e.inArray(o[a],r.filterItems.values)>=0:e.inArray(o[a],r.filterItems.values)<0});else for(a=0;a<o.length;a++)n.push({id:o[a],name:o[a],checkedStatus:!0});return n},_applyToolTip:function(i){var a,r,o,n,s,d,h,u,c;if(this.model.enableToolTip){var p,m,g,f="",_=e(i.target).hasClass("cellValue")?i.target.parentElement:i.target;if(0==e(_).find("input").length&&!e(_).hasClass("curInput")&&!t.isNullOrUndefined(e(_).attr("role"))){if(null==(g=this.element.find(".summary[role!='gridcell'][data-p$=',"+e(_).attr("data-p").split(",")[1]+"'] , .rowheader[role!='gridcell'][data-p$=',"+e(_).attr("data-p").split(",")[1]+"']").last().attr("data-p"))&&(g=e(_).parent("tr").find(".summary,.rowheader").attr("data-p")),null!=g)if(0==g[0]&&null!=parseInt(g.split(",")[0]))g==this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Index&&(m=this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Value);else for(;g[0]>=0;)g==this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Index&&(p=this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Value,g=parseInt(g.split(",")[0])-1+","+parseInt(g.split(",")[1])),m=m?""!=p?p+"-"+m:m:p;var v=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,b=this.element.find(v?".pivotGridFrozenTable ":'tr:has("[role=columnheader]")').length-1,C=e(_).attr("data-p");for(C!=l&&C==this.getJSONRecords()[parseInt(parseInt(C.split(",")[0])*this._rowCount+parseInt(C.split(",")[1]))].Index&&(a=parseInt(C.split(",")[0])),r=0;r<=b;r++)o=a+","+r,null!=a&&o==this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Index&&(-1==(p=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))]).CSS.indexOf("value")&&(""==f?f=p.Value:""!=p.Value&&(f=f+"-"+p.Value)));e("#"+this._id+"_gridTooltip").remove(),this.element.find("span#celval").remove(),n=t.isNullOrUndefined(this._pivotClientObj)?_.getBoundingClientRect():e(_).position(),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(s=this.element.find(".e-scroller").data("ejScroller"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(n.left=n.left+this.element.find(".rowhead").width()-s.model.scrollLeft,n.top=n.top-s.model.scrollTop)),e("#"+this._id).append('<div id="'+this._id+'_gridTooltip" class="e-pGridTooltip" role=\'tooltip\'></div>'),e(_).find("span.cellValue").attr("aria-label","row- "+m+": column- "+f),d=e(_).find("span.cellValue:not('#celval')").text(),this.model.enableRTL?(e("#"+this._id+"_gridTooltip").append('<p id="value" class="e-tooltipText">'+(d||this._getLocalizedLabels("NoValue"))+":"+this._getLocalizedLabels("ToolTipValue")+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="row" class="e-tooltipText">'+(m==l||1==this._rowCount?this._getLocalizedLabels("NoValue"):this._direction(m))+":"+this._getLocalizedLabels("ToolTipRow")+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="column" class="e-tooltipText">'+(f==l||""==f?this._getLocalizedLabels("NoValue"):this._direction(f))+":"+this._getLocalizedLabels("ToolTipColumn")+"</p>")):(e("#"+this._id+"_gridTooltip").append('<p id="value" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipValue")+": "+(d||this._getLocalizedLabels("NoValue"))+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="row" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipRow")+": "+(m==l||1==this._rowCount?this._getLocalizedLabels("NoValue"):m)+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="column" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipColumn")+": "+(f==l||""==f?this._getLocalizedLabels("NoValue"):f)+"</p>")),h=0,h=t.isNullOrUndefined(this._pivotClientObj)?e("#"+this._id).parent().position().left+e("#"+this._id).parent().width():e("#"+this._id).parent().position().left+this._pivotClientObj.element.find(".e-gridContainer").width();var S=n.left+e("#"+this._id+"_gridTooltip").width(),O=0,y=0;t.isNullOrUndefined(this._pivotClientObj)?(O=(n.left>0?n.left:0)+(h-S<0?h-S-20:5),y=e(this.element).height()-n.top<100?n.top-e("#"+this._id+"_gridTooltip").outerHeight()-2:n.top+40,(c=(u=e(i.target).hasClass("cellValue")?i.target.parentElement:i.target).getBoundingClientRect().width/u.offsetWidth)>1&&(y=e(u).position().top/c,y=e(this.element).height()-y*c<100*c?y-e("#"+this._id+"_gridTooltip").outerHeight():y+40)):(O=(n.left>0?n.left:0)+(h-S<50?h-S-40:5)+this._pivotClientObj.element.find(".e-gridContainer").scrollLeft(),y=(this._pivotClientObj.element.find(".e-gridContainer").height()-n.top<150?n.top-e("#"+this._id+"_gridTooltip").outerHeight()-2:n.top+40)+this._pivotClientObj.element.find(".e-gridContainer").scrollTop()),!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableRTL&&(O=e("#"+this._pivotClientObj._id+"_PivotGrid").parent().hasClass("e-maximumView")?n.left:O-(e("#"+this._pivotClientObj._id+"_PivotGrid").position().left+this._pivotClientObj.element.find(".e-gridContainer").scrollLeft())),e("#"+this._id+"_gridTooltip").css({left:O,top:y}),this.model.enableToolTipAnimation?e("#"+this._id+"_gridTooltip").show("fast"):e("#"+this._id+"_gridTooltip").show(),t.isNullOrUndefined(this._pivotClientObj)||"tile"!=this._pivotClientObj.controlPlacement()||e("#"+this._id+"_gridTooltip").css("position","absolute")}}},_applyVScrolling:function(){var i,l,a,r,o,n,s,d,h,u,c=!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling,p=c?this._pivotClientObj.element.find(".e-pivotgrid"):e(this.element).find(".virtualScrollGrid"),m=c?this._pivotClientObj:this,g=c&&!t.isNullOrUndefined(this._pivotClientObj._pivotGrid)?this._pivotClientObj._pivotGrid:this,f=c&&this.model.isResponsive;g._seriesPageCount>1&&(l=function(){return Math.round(m.element.find(".e-vScrollPanel").offset().top)+1},(a=e(m.element).find(".e-vScrollPanel")).height(c?this._pivotClientObj.model.isResponsive?parseInt(this._pivotClientObj.element.find(".e-controlPanel").height()):"tile"==this._pivotClientObj.controlPlacement()?parseInt(this._pivotClientObj.element.find(".e-gridContainer").parents("table:eq(0)").height()):parseInt(this._pivotClientObj.element.find(".e-gridContainer").height()):e(p).height()),a.html(t.buildTag("div.e-vScrollThumb")[0].outerHTML),(r=a.find(".e-vScrollThumb")).height(Math.max(Math.ceil((c?this._pivotClientObj.model.isResponsive?parseInt(this._pivotClientObj.element.find(".e-controlPanel").height()):parseInt(this._pivotClientObj.element.find(".e-gridContainer").height()):e(p).height())/g._seriesPageCount),15)),o=a.height()-r.height()-2,r.offset({top:l()+(g._seriesCurrentPage-1)*(o/(g._seriesPageCount-1))}),e(".e-vScrollPanel").on("mousewheel DOMMouseScroll",function(t){var a,n;e("body").on("mousewheel DOMMouseScroll",function(e){return e.preventDefault(),e.stopPropagation(),!1}),initThumbPos=(f?r.offset().top:r.position().top)-l(),a=g._seriesCurrentPage,movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?t.target.offsetParent.offsetTop+10:-t.target.offsetParent.offsetTop-10,m.element.find(".e-seriesPageIndicator").removeClass("inActive").css({top:r.position().top,left:r.position().left+20}),a=g._seriesCurrentPage,window.navigator.userAgent.indexOf("MSIE ")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges(),movedDistance>0&&initThumbPos+movedDistance<=o||movedDistance<0&&initThumbPos+movedDistance>=0?n=initThumbPos+movedDistance+l():initThumbPos+movedDistance>o?n=l()+o:initThumbPos+movedDistance<0&&(n=l()),r.offset({top:n}),(a=0==Math.ceil(((f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount))?1:Math.ceil(((f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount)))>g._seriesPageCount&&(a=g._seriesPageCount),(movedDistance>0?g._seriesCurrentPage>a:g._seriesCurrentPage<a)&&(a=g._seriesCurrentPage),m.element.find(".e-seriesPageIndicator").css({top:r.position().top}),m.element.find(".series_CurrentPage").html(a),a!=g._seriesCurrentPage&&(g._seriesCurrentPage=a,clearTimeout(i),i=setTimeout(function(){c?g._pivotClientObj.refreshPagedPivotClient("series",g._seriesCurrentPage):g.refreshPagedPivotGrid("series",g._seriesCurrentPage)},250))}),e(r).on("mousedown touchstart",function(t){var i,a,n,s;e(this).addClass("dragging"),i=t.pageY-l(),a=(f?r.offset().top:r.position().top)-l(),m.element.find(".e-seriesPageIndicator").removeClass("inActive").css({top:r.position().top,left:r.position().left+20}),n=t.pageY-l()-i,s=g._seriesCurrentPage,e(document).on("mousemove touchmove",function(t){window.navigator.userAgent.indexOf("Trident")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges();var d=t.pageY-l()-i;0!=d&&(d>0&&a+d<=o?r.offset({top:a+d+l()}):d<0&&a+d>=0?r.offset({top:a+d+l()}):a+d>o?r.offset({top:l()+o}):a+d<0&&r.offset({top:l()}),s=0==Math.floor((Math.round(f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount))?1:Math.floor((Math.round(f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount)),(n<d?s<g._seriesCurrentPage:s>g._seriesCurrentPage)&&(s=g._seriesCurrentPage)),m.element.find(".e-seriesPageIndicator").css({top:r.position().top}),m.element.find(".series_CurrentPage").html(s),m.element.find(".e-vScrollThumb").attr("title",m.element.find(".e-seriesPageIndicator").text())}),e(document).on("mouseup touchend",function(){e(document).off("selectstart"),e(this).off("mousemove touchmove").off("mouseup touchend"),e(r).removeClass("dragging"),s!=g._seriesCurrentPage?(g._seriesCurrentPage=s,c?g._pivotClientObj.refreshPagedPivotClient("series",g._seriesCurrentPage):g.refreshPagedPivotGrid("series",g._seriesCurrentPage)):m.element.find(".e-seriesPageIndicator").addClass("inActive")})})),g._categPageCount>1&&(n=function(){return Math.round(m.element.find(".e-hScrollPanel").offset().left)+1},this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.element.find(".childsplit").length>0&&this._pivotClientObj.element.find(".childsplit").data("ejSplitter").refresh(),(s=e(m.element).find(".e-hScrollPanel")).width(c?this._pivotClientObj.model.enableSplitter?parseInt(this._pivotClientObj.element.find(".controlPanelTD").width()):parseInt(this._pivotClientObj.element.find(".e-controlPanel").width()):e(p).width()),s.html(t.buildTag("div.e-hScrollThumb")[0].outerHTML),(d=s.find(".e-hScrollThumb")).width(Math.max(Math.ceil((c?this._pivotClientObj.model.enableSplitter?parseInt(this._pivotClientObj.element.find(".controlPanelTD").width()):parseInt(this._pivotClientObj.element.find(".e-controlPanel").width()):e(p).width())/g._categPageCount),15)),h=s.width()-d.width()-2,this.model.enableRTL?d.css({right:(g._categCurrentPage-1)*(h/(g._categPageCount-1))}):d.offset({left:n()+(g._categCurrentPage-1)*(h/(g._categPageCount-1))}),e(".e-hScrollPanel").on("mousewheel DOMMouseScroll",function(t){var l;e("body").on("mousewheel DOMMouseScroll",function(e){return e.preventDefault(),e.stopPropagation(),!1}),initThumbPos=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-n()):(f?d.offset().left:d.position().left)-n(),currentPage=g._categCurrentPage,movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?c?t.target.offsetParent.children[1].offsetLeft+10:t.target.offsetParent.offsetLeft+10:c?-t.target.offsetParent.children[1].offsetLeft-10:-t.target.offsetParent.offsetLeft-10,movedDistance=m.model.enableRTL?-movedDistance:movedDistance,m.element.find(".e-categPageIndicator").removeClass("inActive").css({left:d.position().left,top:d.position().top+20}),window.navigator.userAgent.indexOf("MSIE ")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges(),m.model.enableRTL?movedDistance>0&&initThumbPos+movedDistance<=h||movedDistance<0&&initThumbPos+movedDistance>=0?l=initThumbPos+movedDistance:initThumbPos+movedDistance>h?l=h:initThumbPos+movedDistance<0&&(l=0):movedDistance>0&&initThumbPos+movedDistance<=h||movedDistance<0&&initThumbPos+movedDistance>=0?l=initThumbPos+movedDistance+n():initThumbPos+movedDistance>h?l=n()+h:initThumbPos+movedDistance<0&&(l=n()),m.model.enableRTL?d.css("right",l):d.offset({left:l}),currentPage=m.model.enableRTL?0==Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-n()))/(h/g._categPageCount))?1:Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-n()))/(h/g._categPageCount)):0==Math.floor((Math.round(f?d.offset().left:d.position().left)-n())/(h/g._categPageCount))?1:Math.floor((Math.round(f?d.offset().left:d.position().left)-n())/(h/g._categPageCount)),currentPage=currentPage>g._categPageCount?g._categPageCount:currentPage<1?1:currentPage,(movedDistance>0?g._categCurrentPage>currentPage:g._categCurrentPage<currentPage)&&(currentPage=g._categCurrentPage),m.element.find(".e-categPageIndicator").css({left:d.position().left}),m.element.find(".categ_CurrentPage").html(currentPage),currentPage!=g._categCurrentPage&&(g._categCurrentPage=currentPage,clearTimeout(i),i=setTimeout(function(){c?g._pivotClientObj.refreshPagedPivotClient("categ",g._categCurrentPage):g.refreshPagedPivotGrid("categ",g._categCurrentPage)},250))}),e(d).on("mousedown touchstart",function(t){var i,l,a,r;e(this).addClass("dragging"),i=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-(t.pageX-n()):t.pageX-n(),l=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-n()):(f?d.offset().left:d.position().left)-n(),m.element.find(".e-categPageIndicator").removeClass("inActive").css({left:d.position().left,top:d.position().top+20}),a=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-(t.pageX-n())-i:t.pageX-n()-i,r=g._categCurrentPage,e(document).on("mousemove touchmove",function(t){window.navigator.userAgent.indexOf("Trident")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges();var o=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-(t.pageX-n())-i:t.pageX-n()-i;0!=o&&(o>0&&l+o<=h?m.model.enableRTL?d.css({right:l+o}):d.offset({left:l+o+n()}):o<0&&l+o>=0?m.model.enableRTL?d.css({right:l+o}):d.offset({left:l+o+n()}):l+o>h?m.model.enableRTL?d.css({right:h}):d.offset({left:n()+h}):l+o<0&&(m.model.enableRTL?d.css({right:"0px"}):d.offset({left:n()})),r=(r=m.model.enableRTL?0==Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-n()))/(h/g._categPageCount))?1:Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-n()))/(h/g._categPageCount)):0==Math.floor((Math.round(f?d.offset().left:d.position().left)-n())/(h/g._categPageCount))?1:Math.floor((Math.round(f?d.offset().left:d.position().left)-n())/(h/g._categPageCount)))>g._categPageCount?g._categPageCount:r<1?1:r,(a<o?r<g._categCurrentPage:r>g._categCurrentPage)&&(r=g._categCurrentPage)),m.element.find(".e-categPageIndicator").css({left:d.position().left}),m.element.find(".categ_CurrentPage").html(r),m.element.find(".e-hScrollThumb").attr("title",m.element.find(".e-categPageIndicator").text())}),e(document).on("mouseup touchend",function(){e(document).off("selectstart"),e(this).off("mousemove touchmove").off("mouseup touchend"),e(d).removeClass("dragging"),r!=g._categCurrentPage?(g._categCurrentPage=r,c?g._pivotClientObj.refreshPagedPivotClient("categ",g._categCurrentPage):g.refreshPagedPivotGrid("categ",g._categCurrentPage)):m.element.find(".e-categPageIndicator").addClass("inActive")})})),c&&(g._categPageCount<=1&&(u=this._pivotClientObj.element.find(".e-outerTable").height()-58,this._pivotClientObj.element.find(".e-gridContainer").height(u),this._pivotClientObj.element.find(".e-chartContainer").height(u)),g._seriesPageCount<=1&&(u=this._pivotClientObj.element.find("ul.clientTab").width()-2,this._pivotClientObj.element.find(".e-gridContainer").width(u),this._pivotClientObj.element.find(".e-chartContainer").width(u)),this._pivotClientObj.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._pivotClientObj.element.find(".e-hScrollThumb").length>0?this._pivotClientObj.element.find(".e-gridContainer,.e-chartContainer").height(this._pivotClientObj.element.find(".e-controlPanel").height()-(this._pivotClientObj.element.find("ul.clientTab").height()+23)):this._pivotClientObj.element.find(".e-gridContainer,.e-chartContainer").height(this._pivotClientObj.element.find(".e-controlPanel").height()-this._pivotClientObj.element.find("ul.clientTab").height()-2),this._pivotClientObj.element.find(".e-vScrollPanel").css("margin-left","7px"))),e("body").off("mousewheel DOMMouseScroll")},_getLocalizedLabels:function(e){return t.isNullOrUndefined(t.PivotGrid.Locale[this.locale()])||t.PivotGrid.Locale[this.locale()][e]==l?t.PivotGrid.Locale["en-US"][e]:t.PivotGrid.Locale[this.locale()][e]},_drillDown:function(i){var l,a,r,o,n,s,d,h,u,c,p,m,g,f,_,v;if(this._drillCaption=e(i.target).parent().find(".cellValue").text(),d=i.target.className,this._startDrilldown=!0,l=this,a=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,d=d.split(" "),e(i.target).hasClass("e-expand")?this._drillAction="drilldown":e(i.target).hasClass("e-collapse")&&(this._drillAction="drillup"),r=e(e(i.target).parent()).hasClass("rowheader")||"rowheader"==e(e(i.target).parent()).attr("role")?"rowheader":"colheader",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){t.isNullOrUndefined(a)?this._waitingPopup.show():(a._isTimeOut=!0,setTimeout(function(){a._isTimeOut&&l._waitingPopup.show()},800));for(var b,C=e(i.target).parent().attr("data-p"),S=(b=this.getJSONRecords()[parseInt(parseInt(C.split(",")[0])*this._rowCount+parseInt(C.split(",")[1]))].Info).replace(/&/g,"&amp;"),O=parseInt(C.split(",")[0]),y=parseInt(C.split(",")[1]);O>0;){for(O--,o=this.getJSONRecords()[O*this._rowCount+y].Info,n=y;""==o&&n>0;)n--,o=this.getJSONRecords()[O*this._rowCount+n].Info;b=o+">#>"+b}return"ejPivotClient"==(s=this.element.parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient").data("ejPivotClient"):t.isNullOrUndefined(this._pivotClientObj)?this:this._pivotClientObj).pluginName&&"rowheader"==r&&s.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(s._drillInfo=b,s.setChartDrillParams(b,this._drillAction)),s._pivotRecords={records:this.getJSONRecords(),rowCount:this._rowCount},e(i.target).hasClass("e-collapse")?this.updateDrilledReport({uniqueName:S,index:C,action:"collapse"},r,s):this.updateDrilledReport({uniqueName:S,index:C},r,s),!1}if(this.element.find(".e-dialog").remove(),!this.model.enableDeferUpdate){this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this._off(this.element,"click",".e-expand, .e-collapse"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".colheader, .rowheader, .value").removeClass("e-droppable"),d=i.target.className,h=e(i.target).parent(),this._startDrilldown=!0,"e-expand"==(d=d.split(" "))[0]?this._drillAction="drilldown":"e-collapse"==d[0]&&(this._drillAction="drillup"),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject}),u=JSON.stringify(this.model.customObject),c=e(i.target).parent().attr("data-p"),this._drillCaption=e(i.target).parent().find(".cellValue").text(),t.isNullOrUndefined(l._pivotClientObj)||t.isNullOrUndefined(l._pivotClientObj._waitingPopup)?t.isNullOrUndefined(a)?this._waitingPopup.show():(a._isTimeOut=!0,setTimeout(function(){a._isTimeOut&&l._waitingPopup.show()},800)):(l._pivotClientObj._isTimeOut=!0,setTimeout(function(){l._pivotClientObj._isTimeOut&&(e("#"+l._pivotClientObj._id+"_maxView")[0]?(e("#"+l._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}),l._maxViewLoading=e("#"+l._pivotClientObj._id+"_maxView").data("ejWaitingPopup")):l._pivotClientObj._waitingPopup.show())},800)),p="relational"==this.model.analysisMode?this._drillHeaders.join("||"):this.getJSONRecords()[parseInt(parseInt(c.split(",")[0])*this._rowCount+parseInt(c.split(",")[1]))].Info;try{v=e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this._pivotClientObj.getOlapReport()).Report:this._pivotClientObj.currentReport:JSON.parse(this.getOlapReport()).Report}catch(i){v=e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._pivotClientObj.getOlapReport():this._pivotClientObj.currentReport:this.getOlapReport()}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){m=null,!t.isNullOrUndefined(this.model.valueSortSettings)&&this.element.find(".valueSorting").length>0&&!t.isNullOrUndefined(t.PivotAnalysis._valueSorting)&&(m=this.element.find(".valueSorting").parent());var P=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableAdvancedFilter||(e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-fullScreenView").length>0)&&this._pivotClientObj.model.enableAdvancedFilter)?e(this.element).find(".e-pivotGridTable").detach():this._table,w=this._getFieldName(e(i.target).parent()[0]),N=e(e(i.target).parent()).hasClass("rowheader")||"rowheader"==e(e(i.target).parent()).attr("role")?"rowheader":e(e(i.target).parent()).hasClass("colheader")||"columnheader"==e(e(i.target).parent()).attr("role")?"columnheader":"";this.model.enablePaging||this.model.enableVirtualScrolling||(e(i.target).hasClass("e-collapse")?(t.isNullOrUndefined(this.model.collapsedMembers)&&(this.model.collapsedMembers={}),t.isNullOrUndefined(this.model.collapsedMembers[w])?this.model.collapsedMembers[w]=[e(e(i.target).parent()[0]).text().trim()]:this.model.collapsedMembers[w].push(e(e(i.target).parent()[0]).text().trim())):e(i.target).hasClass("e-expand")&&(this.model.collapsedMembers[w]=e.grep(this.model.collapsedMembers[w],function(t){return t!=e(e(i.target).parent()[0]).text().trim()})),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableAdvancedFilter||(e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-fullScreenView").length>0)&&this._pivotClientObj.model.enableAdvancedFilter)?(this._collapseMember(P,i.target),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?this.element.find("#"+this._id+"Toolbar").append(P):this.element.append(P)):(this._collapseMember(P,P.find("[data-p='"+c+"']").children("span")[0]),this._cropHtml(P),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&!this.model.isResponsive&&this.element.find(".e-pivotGridTable").removeAttr("style"),this._mergeHtml(N,c,P,this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(this.element).find(".e-pivotGridTable"):e(this.element).find("table")),(this.model.resizeColumnsToFit||!this.model.enableColumnResizing)&&(this.model.enableColumnResizing||this.model.resizeColumnsToFit)||this.element.find(".e-pivotGridTable").css("width","100%")),this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this._applyFrozenHeaderWidth(this._JSONRecords,this._drillAction,h):(this.model.enableColumnResizing&&this.model.resizeColumnsToFit||this.model.enableColumnResizing&&!this.model.resizeColumnsToFit)&&this._resizeColumnsWidth(),this._hideGrandTotal(P),this.model.enableGroupingBar&&(g=e("#"+this._id).find(".e-pivotGridTable").width(),this.element.find(".groupingBarPivot .e-drag").width(g-5),f=e("#"+this._id).find(".e-pivotGridTable").find("th").width(),this.element.find(".groupingBarPivot .values").width(f-2),this.element.find(".groupingBarPivot .columns").width(g-f),this.element.find(".groupingBarPivot .valueColumn").width(g)),this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),t.isNullOrUndefined(a)?t.isNullOrUndefined(l._pivotClientObj)||(l._pivotClientObj._isTimeOut=!1):a._isTimeOut=!1,this._waitingPopup.hide());O=parseInt(c.split(",")[0]),y=parseInt(c.split(",")[1]);if(""==this._drillCaption&&(this._drillCaption=e.trim(e(i.target).parent(":not(span)").text().replace("expanded","").replace("collapsed",""))),b=this._drillCaption,b=e.trim(this._getMemberInfo(b,y,O,N)),_=this.model.operationalMode==t.Pivot.OperationalMode.ClientMode,"rowheader"==N?(this.model.enablePaging||this.model.enableVirtualScrolling)&&("drillup"==this._drillAction?this.model.enableCollapseByDefault?this._drillHeaders.row=this._drillHeaders.row.filter(function(e){if(e!=(_?b:b.split(">#>").join(".")))return e}):this._drillHeaders.row.push(_?b:b.split(">#>").join(".")):this.model.enableCollapseByDefault?this._drillHeaders.row.push(_?b:b.split(">#>").join(".")):this._drillHeaders.row=this._drillHeaders.row.filter(function(e){if(e!=(_?b:b.split(">#>").join(".")))return e})):(this.model.enablePaging||this.model.enableVirtualScrolling)&&(b.startsWith(">#>")&&(b=b.substring(3,b.length)),"drillup"==this._drillAction?this.model.enableCollapseByDefault?this._drillHeaders.column=this._drillHeaders.column.filter(function(e){if(e!=(_?b:b.split(">#>").join(".")))return e}):this._drillHeaders.column.push(_?b:b.split(">#>").join(".")):this.model.enableCollapseByDefault?this._drillHeaders.column.push(_?b:b.split(">#>").join(".")):this._drillHeaders.column=this._drillHeaders.column.filter(function(e){if(e!=(_?b:b.split(">#>").join(".")))return e}),b=""),this.model.enableVirtualScrolling||this.model.enablePaging)if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){try{v=JSON.parse(this.getOlapReport()).Report}catch(e){v=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",drillHeaders:JSON.stringify(this._drillHeaders),currentReport:v,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}else this._refPaging();this.model.valueSortSettings&&this._refreshValueSortIcons(m),t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("gridDrillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:b,fieldName:w,axis:r,cellPosition:c}),this._trigger("drillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:b,fieldName:w,axis:r,cellPosition:c}),this.model.enableGroupingBar&&this._createFields("drilldown",e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this._unWireEvents(),this._wireEvents(),this._drillAction=""}else""!=this.layout()||"normal"!=this.layout()?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:c,currentReport:v,headerInfo:p,layout:this.layout(),customObject:u}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:c,currentReport:v,clientReports:this._pivotClientObj.reports,headerInfo:p,layout:this.layout(),customObject:u}),this._drillDownSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:c,currentReport:v,headerInfo:p,customObject:u}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:c,currentReport:v,clientReports:this._pivotClientObj.reports,headerInfo:p,customObject:u}),this._drillDownSuccess)}},_getMemberInfo:function(e,i,l,a){if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this.model.paging||this.model.enableVirtualScrolling))e=this.getJSONRecords()[this._rowCount*l+i].Info;else for(;"rowheader"==a?l>0:i>0;){"rowheader"==a?l--:i--;for(var r=this.getJSONRecords()[this._rowCount*l+i].Value,o=i;""==r&&("rowheader"==a?o>0:l>0);)"rowheader"==a?o--:l--,r=this.getJSONRecords()[this._rowCount*l+o].Value;e=r+">#>"+e}return e},_collapseMember:function(i,a){var r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C,S,O,y,P,w,N,x;if(!this.model.enablePaging&&!this.model.enableVirtualScrolling){var T=e(a).parent()[0],M=e(T).attr("data-p"),L=e(a).attr("data-tag")!=l?parseInt(e(a).attr("data-tag"))+T.rowSpan:T.rowSpan,D=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(e(T).attr("vfcolspan"))?parseInt(e(T).attr("vfcolspan")):e(a).attr("data-tag")!=l?parseInt(e(a).attr("data-tag"))+T.colSpan:T.colSpan,I=e(a).closest("tr")[0],j=null,F=null,R="false",E=0;if(T.className.indexOf("rowheader")>=0||T.className.indexOf("summary")>=0&&"rowheader"==e(T).attr("role")){if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout){var k="0,0"==this.getJSONRecords()[1].Index?1:0,A=(L=this.getJSONRecords()[parseInt(M.split(",")[0])*this._rowCount+parseInt(M.split(",")[1])+k].RowSpan,I);for(e(a).attr("class").indexOf("e-expand")>-1&&e(I).removeAttr("data-tag"),c=0;c<L;c++)e(a).attr("class")&&e(a).attr("class").indexOf("e-collapse")>-1&&(e(e(I).next()).attr("data-tag")==l&&e(e(I).next()).attr("data-tag",M),e(e(I).next()).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&e(i).find(".pivotGridValueTable  td[data-i$=',"+e(e(I).next()).find("td").attr("data-i").split(",")[1]+"']").css("display","none")),e(a).attr("class").indexOf("e-expand")>-1&&(e(e(I).next()).attr("data-tag")==l||e(e(I).next()).attr("data-tag")==M)&&(e(e(I).next()).css("display","table-row"),e(e(I).next()).removeAttr("data-tag"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&e(I).parents().find(".pivotGridValueTable td[data-i$=',"+e(e(I).next()).find("td").attr("data-i").split(",")[1]+"']").css("display","")),I=e(I).next();var H=this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders?"td":"th",U=this.model.enableRTL?"margin-right":"margin-left",z=e(A).find(H+" span:not(.cellValue)").css(U);return e(A).find(H+" span:not(.cellValue)").remove(),void e(A).find(H).prepend(e(a).attr("class").indexOf("e-collapse")>-1?'<span style="'+U+":"+z+'" class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':'<span style="'+U+":"+z+'" class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>')}var V,B=!e(T).index()>0,G=V=!1;if(e(a).attr("class")&&e(a).attr("class").indexOf("collapse")>-1){for(c=0;c<L;c++){if(j=e(I).next(),B)e(I).find(".stot,.rstot").length>=1&&1==c&&e(e(I).find(".stot,.rstot")).find(".e-expand").length>=1&&(V=!0),(e(e(I).find(".stot,.rstot")).find(".e-expand").length>=1||"none"==e(I).css("display"))&&(G=!0),e(I).css("display","none"),e(I).attr("data-tag",e(I).attr("data-tag")!=l?parseInt(e(I).attr("data-tag"))+1:1),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(e(i).find(".pivotGridValueTable tr:eq("+e(I).index()+")").css("display","none"),e(i).find(".pivotGridValueTable tr:eq("+e(I).index()+")").attr("data-tag",e(I).attr("data-tag")!=l?parseInt(e(I).attr("data-tag"))+1:1));else{if(n=T,this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)for(P=e(T).prevAll().length;P<e(i).find("[data-p$=',"+e(T).attr("data-p").split(",")[1]+"'] ").length;P++)e(n).css("display","none").attr("data-hc",e(n).attr("data-hc")==l?1:parseInt(e(n).attr("data-hc"))+1),n=e(e(i).find("[data-p$=',"+e(n).attr("data-p").split(",")[1]+"'] ")[P+1]);else for(P=0;P<=e(T).nextAll().length;P++)e(n).css("display","none").attr("data-hc",e(n).attr("data-hc")==l?1:parseInt(e(n).attr("data-hc"))+1),n=e(n).next();!1,R="true"}I=j,B=!0}for(r="true"==R?T.rowSpan-1:T.rowSpan,"none"!=e(I).css("display")&&V&&(o=e(a).attr("subTag")!=l?-1==parseInt(e(a).attr("subTag"))?T.rowSpan+1:parseInt(e(a).attr("subTag"))+T.rowSpan:T.rowSpan),"none"==e(I).css("display")&&(e(I).css("display",""),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&e(i).find('td.value[data-p$=",'+parseInt(e(I).children().eq(0).attr("data-p").split(",")[1])+'"]').parent().css("display",""),G=!0,r-=1),G&&t.isNullOrUndefined(o)&&(o=e(a).attr("subTag")!=l?-1==parseInt(e(a).attr("subTag"))?T.rowSpan:parseInt(e(a).attr("subTag"))+T.rowSpan:T.rowSpan),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&e(i).find(".pivotGridValueTable").length>0?(e(I).find("td").text(e(I).find("td").text().replace(" Total","")),e(I).find("td span:not(.cellValue)").remove(),e(I).find("td").prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+L+":"+R+'">&nbsp;</span>')):(e(I).find("th").text(e(I).find("th").text().replace(" Total","")),e(I).find("th span:not(.cellValue)").remove(),e(I).find("th").prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+L+":"+R+(t.isNullOrUndefined(o)?"":"true"==e(a).attr("isChildSubNode")?'" subTag="'+o+":"+R+'" isChildSubNode="true':'" subTag="'+o+":"+R)+'">&nbsp;</span>')),d=e(I).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),c=0;c<d.length;c++)parseInt(e(d[c]).attr("data-p").split(",")[0])<parseInt(M.split(",")[0])&&parseInt(e(d[c]).attr("data-p").split(",")[1])+d[c].rowSpan+(e(d[c]).find("span").attr("data-tag")!=l?parseInt(e(d[c]).find("span").attr("data-tag")):0)>=parseInt(M.split(",")[1])+L&&(d[c].rowSpan-=r,e(d[c]).find("span").attr("data-tag")==l&&e(d[c]).find("span").attr("isChildSubNode",!0),e(d[c]).find("span").attr("data-tag",e(d[c]).find("span").attr("data-tag")!=l?parseInt(e(d[c]).find("span").attr("data-tag"))+r:r),e(d[c]).find("span").attr("subTag",e(d[c]).find("span").attr("subTag")!=l?parseInt(e(d[c]).find("span").attr("subTag"))+r:r))}else if(e(a).attr("class")&&e(a).attr("class").indexOf("e-expand")>-1){var J=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,q=this._isSubTotalhidden=!1,K=0;for(c=parseInt(e(a).attr("data-tag").split(":")[0]);c>=0;c--)F=e(I).prev(),e(I).attr("data-tag")==l||parseInt(e(I).attr("data-tag"))<=1?(this._hideSubTotal(e(I),K,e(a)),this._isSubTotalHide?(q=!0,this._isSubTotalHide=!1,e(I).css("display","none"),J&&e(i).find(".pivotGridValueTable tr:eq("+e(I).index()+")").css("display","none")):(e(I).css("display","table-row"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&0==e(I).find("td[data-hc]").length&&e(i).find(".pivotGridValueTable tr:eq("+e(I).index()+")").css("display","table-row"))):E++,K=0==K?1:K,e(I).attr("data-tag")!=l&&(0==parseInt(e(I).attr("data-tag")-1)?e(I).removeAttr("data-tag"):e(I).attr("data-tag",parseInt(e(I).attr("data-tag"))-1)),I=F;if("true"==e(a).attr("data-tag").split(":")[1]){for(n=e(i).find((J?".pivotGridRowTable ":"th")+"[data-p='"+parseInt(e(T).attr("data-p").split(",")[0])+","+(parseInt(e(T).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"'], td[data-p='"+parseInt(e(T).attr("data-p").split(",")[0])+","+(parseInt(e(T).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"']"),s=e(n).nextAll().length,J&&(s=e.merge(e(n).nextAll(),e(i).find(".pivotGridValueTable tr:eq("+e(n).parent().index()+") td")).length),P=0;P<=s;P++)e(n).attr("data-hc")==l||parseInt(e(n).attr("data-hc"))<=1?(e(n).removeAttr("data-hc"),e(n).attr("data-hc")==l&&e(n).css("display","")):e(n).attr("data-hc",parseInt(e(n).attr("data-hc"))-1),n=J?e.merge(e(n).nextAll(),e(i).find(".pivotGridValueTable tr:eq("+e(n).parent().index()+") td"))[0]:e(n).next();if(J)for(I=e(a).closest("tr")[0],c=parseInt(e(a).attr("data-tag").split(":")[0]);c>=0;c--)0==e(I).find("td[data-hc]").length&&e(i).find(".pivotGridValueTable tr:eq("+e(I).index()+")").css("display","table-row"),I=e(I).prev()}for(d=e(e(a).closest("tr")[0]).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),h=e(a).attr("subTag")!=l&&q?"true"==e(a).attr("subTag").split(":")[1]?parseInt(e(a).attr("subTag").split(":")[0])-1:parseInt(e(a).attr("subTag").split(":")[0]):("true"==e(a).attr("data-tag").split(":")[1]?parseInt(e(a).attr("data-tag").split(":")[0])-1:parseInt(e(a).attr("data-tag").split(":")[0]))-E,u=e(i).find("th[data-p='"+parseInt(e(T).attr("data-p").split(",")[0])+","+(parseInt(e(T).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"'], td[data-p='"+parseInt(e(T).attr("data-p").split(",")[0])+","+(parseInt(e(T).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"']"),q&&(h=parseInt(e(u).attr("rowspan")),h=e(a).attr("subTag")!=l?"true"==e(a).attr("subTag").split(":")[1]?h-1:h:"true"==e(a).attr("data-tag").split(":")[1]?h-1:h,h=e(a).attr("subTag")!=l?-1==parseInt(e(a).attr("subTag").split(":")[0])?h:this._isSubTotalhidden?h-1:h:h-1),c=0;c<d.length;c++)parseInt(e(d[c]).attr("data-p").split(",")[0])<parseInt(M.split(",")[0])&&parseInt(e(d[c]).attr("data-p").split(",")[1])+d[c].rowSpan+(e(d[c]).find("span").attr("data-tag")!=l?parseInt(e(d[c]).find("span").attr("data-tag")):0)>=parseInt(M.split(",")[1])&&(q&&(this._isSubTotalhidden=q=!1,"true"==e(a).attr("isChildSubNode")&&e(a).removeAttr("isChildSubNode")),d[c].rowSpan+=h,e(d[c]).find("span").attr("data-tag")!=l&&e(d[c]).find("span").attr("data-tag",parseInt(e(d[c]).find("span").attr("data-tag"))-h),0==parseInt(e(d[c]).find("span").attr("data-tag"))&&e(d[c]).find("span").removeAttr("data-tag"),e(d[c]).find("span").attr("subTag")!=l&&e(d[c]).find("span").attr("subTag",parseInt(e(d[c]).find("span").attr("subTag"))-h),0==parseInt(e(d[c]).find("span").attr("subTag"))&&e(d[c]).find("span").removeAttr("subTag"));e(T).find(".cellValue").length>0?e(T).find(".cellValue").text(e.trim(e(T).find(".cellValue").text())+" Total"):e(T).text(e.trim(e(T).text())+" Total"),e(T).find(".e-expand").remove(),e(T).prepend("<span style='margin-left:10px'></span>")}}if(T.className.indexOf("colheader")>=0||T.className.indexOf("summary")>=0&&"columnheader"==e(T).attr("role"))if(p=parseInt(M.split(",")[0]),e(i).find("tr"),e(a).attr("class")&&e(a).attr("class").indexOf("e-collapse")>-1){if(m=T.colSpan,"none"==e(T).next().css("display")){var Q=e(T).next().attr("data-p"),$=parseInt(Q.split(",")[0]),W=(e(i).find("tr"),parseInt(e(T).next().attr("colspan")));if(e(T).next().attr("class").indexOf("stot","cstot")>-1)for(N=0;N<W;N++){for(g=e(I).nextAll().find("th[data-p^='"+(N+$)+",']"),b=0;b<e(g).length;b++)e(g[b]).css("display","");if(e(g[b]).attr("data-hc")==l||parseInt(e(g[b]).attr("data-hc"))<1)for(e(i).find("td[data-p^='"+(N+$)+",']").css("display",""),y=0;y<e(i).find("td[data-p^='"+(N+$)+",']").length;y++)(e(e(i).find("td[data-p^='"+(N+$)+",']")[y]).attr("data-hc")!=l||e(e(i).find("td[data-p^='"+(N+$)+",']")[y]).attr("data-hc")>-1)&&e(e(i).find("td[data-p^='"+(N+$)+",']")[y]).css("display","none")}e(T).next().css("display",""),m=T.colSpan-W}for(N=0;N<D;N++)if(0!=(g=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(I).nextAll().find("td[data-p^='"+(N+p)+",']"):e(I).nextAll().find("th[data-p^='"+(N+p)+",']")).length){for(b=0;b<e(g).length;b++)e(g[b]).attr("data-hc",e(g[b]).attr("data-hc")!=l?parseInt(e(g[b]).attr("data-hc"))+1:1).css("display","none");(e(g[b]).attr("data-hc")==l||parseInt(e(g[b]).attr("data-hc"))<1)&&(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(e(i).find(".pivotGridValueTable td[data-p^='"+(N+p)+",']").css("display","none"),e(i).find(".pivotGridValueTable td[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(N+p)+",']").attr("data-ch",1)):(e(i).find("td[data-p^='"+(N+p)+",']").css("display","none"),e(i).find("th[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(N+p)+",']").attr("data-ch",1)))}for(e(T).attr("data-hc",1).css("display","none"),e(T).next().text(e(T).next().text().replace(" Total","")),e(T).next().find("span:not(.cellValue)").remove(),e(T).next().prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+D+'">&nbsp;</span>'),ee=e(I).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),N=0;N<ee.length;N++)x=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(e(ee[N]).attr("vfcolspan"))?parseInt(e(ee[N]).attr("vfcolspan")):ee[N].colSpan,parseInt(e(ee[N]).attr("data-p").split(",")[1])<parseInt(M.split(",")[1])&&parseInt(e(ee[N]).attr("data-p").split(",")[0])<=parseInt(M.split(",")[0])&&parseInt(e(ee[N]).attr("data-p").split(",")[0])+x+(e(ee[N]).find("span").attr("data-tag")!=l?parseInt(e(ee[N]).find("span").attr("data-tag")):0)>=parseInt(M.split(",")[0])+D&&(ee[N].colSpan-=m,e(ee[N]).find("span").attr("data-tag",e(ee[N]).find("span").attr("data-tag")!=l?parseInt(e(ee[N]).find("span").attr("data-tag"))+m:m))}else if(e(a).attr("class")&&e(a).attr("class").indexOf("e-expand")>-1){var X,Y=0;q=X=this._isSubTotalhidden=!1,K=0,W=parseInt(e(T).attr("colspan"));if(this._hideSubTotal(e(I),K,e(a)),this._isSubTotalHide){X=q=!0,this._isSubTotalHide=!1;Q=e(T).attr("data-p"),$=parseInt(Q.split(",")[0]),e(i).find("tr");if(e(T).attr("class").indexOf("stot","cstot")>-1)for(N=0;N<W;N++){for(v=e(I).nextAll().find("th[data-p^='"+(N+$)+",']"),b=0;b<e(v).length;b++)e(v[b]).css("display","none");(e(v[b]).attr("data-hc")==l||parseInt(e(v[b]).attr("data-hc"))<1)&&e(i).find("td[data-p^='"+(N+$)+",']").css("display","none")}e(T).css("display","none")}for(m=D-(W-1),N=1;N<m;N++){for(g=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(I).nextAll().find("td[data-p^='"+(p-N)+",']"):e(I).nextAll().find("th[data-p^='"+(p-N)+",']"),b=0;b<e(g).length;b++){for(X=!1,f=0;f<e(g[b]).length;f++)(e(e(g[b])[f]).hasClass("stot")||e(e(g[b])[f]).hasClass("cstot"))&&!e(e(g[b])[f]).hasClass("calc")&&this._hideSubTotal(e(e(g[b])[f]),K,e(a));if(this._isSubTotalHide){X=!0,this._isSubTotalHide=!1;Q=e(g[b]).attr("data-p"),$=parseInt(Q.split(",")[0]),e(i).find("tr"),W=parseInt(e(g[b]).attr("colspan"));if(e(g[b]).attr("class").indexOf("stot","cstot")>-1&&!(e(g[b]).find(".e-expand").length>0))for(_=0;_<W;_++){for(v=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(I).nextAll().find("td[data-p^='"+(_+$)+",']"):e(I).nextAll().find("th[data-p^='"+(_+$)+",']"),b=0;b<e(v).length;b++)e(v[b]).css("display","none");e(v[b]).attr("data-hc")==l||parseInt(e(v[b]).attr("data-hc"))<1?e(i).find("td[data-p^='"+(_+$)+",']").css("display","none"):Y++}e(g[b]).css("display","none")}e(g[b]).attr("data-hc")==l||1==parseInt(e(g[b]).attr("data-hc"))?(e(g[b]).css("display",""),e(g[b]).removeAttr("data-hc")):parseInt(e(g[b]).attr("data-hc"))-1==0?e(g[b]).removeAttr("data-hc"):e(g[b]).attr("data-hc",parseInt(e(g[b]).attr("data-hc"))-1)}if(K=0==K?1:K,!X)if(e(g).last().attr("data-hc")==l){if(J=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,e(i).find("td[data-p^='"+(p-N)+",']").css("display",""),C=[],J){for(S=e(i).find("[data-p^='0,']:not(.summary)").parent(),O="",y=0;y<S.length;y++)O=O+(0!=y?" , ":"")+"  .pivotGridValueTable td:eq("+e(S[y]).index()+")";C=e(i).find(O)}else C=e(i).find("[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(p-N)+",']");for(e(C).removeAttr("data-ch"),P=0;P<=e(C).length;P++)e(C[P]).attr("data-hc")!=l&&e(C[P]).css("display","none")}else Y++}e(T).prev().removeAttr("data-hc").css("display","");parseInt(e(T).prev().attr("colspan"));var Z=parseInt(e(a).attr("data-tag"))-Y,ee=e(I).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)");for(q&&(q=!1,w=e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this._pivotClientObj.getOlapReport():this.getOlapReport(),Z=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?parseInt(e(T).prev().attr("colSpan"))-this.model.dataSource.values.length:parseInt(e(T).prev().attr("colSpan"))-JSON.parse(w).PivotCalculations.length),N=0;N<ee.length;N++)x=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(e(ee[N]).attr("vfcolspan"))?parseInt(e(ee[N]).attr("vfcolspan")):ee[N].colSpan,parseInt(e(ee[N]).attr("data-p").split(",")[1])<parseInt(M.split(",")[1])&&parseInt(e(ee[N]).attr("data-p").split(",")[0])<parseInt(M.split(",")[0])&&parseInt(e(ee[N]).attr("data-p").split(",")[0])+ee[N].colSpan+(e(ee[N]).find("span").attr("data-tag")!=l?parseInt(e(ee[N]).find("span").attr("data-tag")):0)>=parseInt(M.split(",")[0])&&(ee[N].colSpan+=Z,e(ee[N]).find("span").attr("data-tag")!=l&&e(ee[N]).find("span").attr("data-tag",parseInt(e(ee[N]).find("span").attr("data-tag"))-Z),0==parseInt(e(ee[N]).find("span").attr("data-tag"))&&e(ee[N]).find("span").removeAttr("data-tag"));e(T).find(".cellValue").length>0?e(T).find(".cellValue").text(e.trim(e(T).find(".cellValue").text())+" Total"):e(T).text(e.trim(e(T).text())+" Total"),e(T).find(".e-expand").remove(),e(T).prepend("<span style='margin-left:10px'></span>")}}},_generateTreeViewData:function(){var e={catalog:this.model.dataSource.catalog,cube:this.model.dataSource.cube,url:this.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(e,this._loadDimensionElements,{pvtGridObj:this,action:"loadFieldElements"})},_dimensionsDetails:function(t,i){t.pvtGridObj._dimension=e(i).find("row")},_loadDimensionElements:function(t,i){var a,r,o,n,s,d,h;t.pvtGridObj._waitingPopup.show();var u,c={},p={},m=t.pvtGridObj._getConnectionInfo(t.pvtGridObj.model.dataSource.data);for(t.pvtGridObj.schemaTreeView=[],t.pvtGridObj.reportItemNames=[],a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_DIMENSIONS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+t.pvtGridObj.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+t.pvtGridObj.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+t.pvtGridObj.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+m.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>",t.pvtGridObj.doAjaxPost("POST",m.url,{XMLA:a},t.pvtGridObj._dimensionsDetails,null,{pvtGridObj:t.pvtGridObj,action:"loadFieldElements"}),r=t.pvtGridObj._dimension,o=0;o<e(i).find("row").length;o++){if(s=(n=e(e(i).find("row")[o])).find("DIMENSION_UNIQUE_NAME").text(),t.pvtGridObj.model.enableDrillThrough)for(d=0;d<r.length;d++)s==e(r[d]).find("DIMENSION_UNIQUE_NAME").text()&&(u=e(r[d]).find("DIMENSION_CAPTION").text());else u=n.find("DIMENSION_CAPTION").text();"[measures]"==s.toLowerCase()?p={hasChildren:!0,isSelected:!1,id:s,name:u,spriteCssClass:"[measures]"==s.toLowerCase()?"e-folderCDB e-icon":"e-dimensionCDB e-icon",tag:s}:!e(e(i).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&(c={hasChildren:!0,isSelected:!1,id:s,name:u,spriteCssClass:"e-dimensionCDB e-icon",tag:s},t.pvtGridObj.schemaTreeView.push(c))}t.pvtGridObj.schemaTreeView.splice(0,0,p),h={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},!t.pvtGridObj.model.enableDrillThrough||t.pvtGridObj._schemaData!=l&&t.pvtGridObj._schemaData.model.olap.showNamedSets?(h.request="MDSCHEMA_SETS",t.pvtGridObj._getTreeData(h,t.pvtGridObj._loadNamedSetElements,t)):(h.request="MDSCHEMA_HIERARCHIES",t.pvtGridObj._fieldData.hierarchySuccess==l?t.pvtGridObj._getTreeData(h,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess))},_loadNamedSetElements:function(t,i){var a,r;t.pvtGridObj._waitingPopup.show();var o={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},n=t.pvtGridObj.model.dataSource,s=e.map(n.rows,function(e){if(e.fieldName!=l)return e.fieldName});for(e.merge(s,e.map(n.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(s,e.map(n.filters,function(e){if(e.fieldName!=l)return e.fieldName})),measureGroupItems=[],a=0;a<e(i).find("row").length;a++)r=e(e(i).find("row")[a]),e.inArray(r.find("DIMENSIONS").text().split(".")[0],measureGroupItems)>=0||(treeNodeElement={hasChildren:!0,isSelected:!1,pid:r.find("DIMENSIONS").text().split(".")[0],id:r.find("SET_DISPLAY_FOLDER").text()+"_"+r.find("DIMENSIONS").text().split(".")[0],name:r.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"e-folderCDB e-icon namedSets"},t.pvtGridObj.schemaTreeView.push(treeNodeElement),measureGroupItems.push(r.find("DIMENSIONS").text().split(".")[0])),treeNodeElement={hasChildren:!0,isSelected:e.inArray("["+e.trim(r.children("SET_NAME").text())+"]",s)>=0,pid:r.find("SET_DISPLAY_FOLDER").text()+"_"+r.find("DIMENSIONS").text().split(".")[0],id:"["+e.trim(r.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:r.children("SET_CAPTION").text(),spriteCssClass:"e-namedSetCDB e-icon",tag:r.find("EXPRESSION").text()},t.pvtGridObj.schemaTreeView.push(treeNodeElement);o.request="MDSCHEMA_HIERARCHIES",t.pvtGridObj._fieldData.hierarchySuccess==l?t.pvtGridObj._getTreeData(o,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess)},_loadHierarchyElements:function(t,i){var a,r;t.pvtGridObj._waitingPopup.show();var o={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},n=t.pvtGridObj.model.dataSource,s=e.map(n.rows,function(e){if(e.fieldName!=l)return e.fieldName});for(e.merge(s,e.map(n.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(s,e.map(n.filters,function(e){if(e.fieldName!=l)return e.fieldName})),a={},"",r=0;r<e(i).find("row").length;r++){var d=e(e(i).find("row")[r]),h=d.find("DIMENSION_UNIQUE_NAME").text(),u=d.find("HIERARCHY_UNIQUE_NAME").text();e(t.pvtGridObj.schemaTreeView).filter(function(e,t){return t.tag==h}).map(function(e,t){return t}).length>0&&h!=u&&(a={hasChildren:!0,isSelected:e.inArray(u,s)>=0,pid:h,id:u,name:d.find("HIERARCHY_CAPTION").text(),spriteCssClass:"2"!=d.find("HIERARCHY_ORIGIN").text()&&"6"!=d.find("HIERARCHY_ORIGIN").text()?"e-hierarchyCDB e-icon":"e-attributeCDB e-icon",tag:u},t.pvtGridObj.schemaTreeView.push(a))}o.request="MDSCHEMA_LEVELS",t.pvtGridObj._getTreeData(o,t.pvtGridObj._loadLevelElements,t)},_loadLevelElements:function(i,l){var a;i.pvtGridObj._waitingPopup.show(),a=e.map(e(l).find("row"),function(t){if("1"!=parseInt(e(t).children("LEVEL_TYPE").text())&&"[measures]"!=e(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase())return treeNodeElement={hasChildren:!1,isChecked:!1,id:e(t).find("LEVEL_UNIQUE_NAME").text(),pid:e(t).find("HIERARCHY_UNIQUE_NAME").text(),name:e(t).find("LEVEL_CAPTION").text(),spriteCssClass:"level"+parseInt(e(t).children("LEVEL_NUMBER").text())+" e-icon",tag:e(t).find("LEVEL_UNIQUE_NAME").text()}}),e.merge(i.pvtGridObj.schemaTreeView,a),!i.pvtGridObj.model.enableDrillThrough&&i.pvtGridObj._fieldData.measureSuccess?i.pvtGridObj._fieldData.measureSuccess?i.pvtGridObj._loadMeasureElements(i,i.pvtGridObj._fieldData.measureSuccess):(l={catalog:i.pvtGridObj.model.dataSource.catalog,cube:i.pvtGridObj.model.dataSource.cube,url:i.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASURES"},i.pvtGridObj._getTreeData(l,i.pvtGridObj._loadMeasureElements,i)):t.Pivot._createDrillThroughDialog(i.pvtGridObj,i.pvtGridObj.schemaTreeView)},_loadMeasureGroups:function(t,i){t.pvtGridObj._fieldData.measuresGroups=e(i).find("row")},_loadMeasureElements:function(t,i){var a,r,o,n,s={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},d=t.pvtGridObj.model.dataSource,h=e.map(d.values,function(e){if(e.measures!=l)return e.measures});for(this.reportItemNames=e.map(h,function(e){if(e.fieldName!=l)return e.fieldName}),a=[],"","en-US"!=t.pvtGridObj.model.locale&&(s={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.pvtGridObj._getTreeData(s,this._loadMeasureGroups,{pvtGridObj:this,action:"loadFieldElements"})),o=0;o<e(i).find("row").length;o++){var u=e(e(i).find("row")[o]),c=u.children("MEASUREGROUP_NAME").text(),p=u.find("MEASURE_UNIQUE_NAME").text();e.inArray(c,a)>=0||("en-US"!=t.pvtGridObj.model.locale?r=(n=e.map(t.pvtGridObj._fieldData.measuresGroups,function(t){if(e(t).children("MEASUREGROUP_NAME").text()==c)return e(t).children("MEASUREGROUP_CAPTION").text()})).length>0?n[0]:c:r=c,treeNodeElement={hasChildren:!0,isChecked:!1,pid:"[Measures]",id:c,name:r,spriteCssClass:"e-measureGroupCDB e-icon",tag:c},t.pvtGridObj.schemaTreeView.push(treeNodeElement),a.push(c)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(p,this.reportItemNames)>=0,id:p,pid:c,name:u.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:p},t.pvtGridObj.schemaTreeView.push(treeNodeElement),e.inArray(p,t.pvtGridObj.reportItemNames)>=0&&t.pvtGridObj.reportItemNames.splice(t.pvtGridObj.reportItemNames.indexOf(p),1)}t.pvtGridObj._schemaData.model.olap.showKpi?(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"KPICDB e-folderCDB e-icon",tag:""},t.pvtGridObj.schemaTreeView.splice(1,0,treeNodeElement),s.request="MDSCHEMA_KPIS",t.pvtGridObj._getTreeData(s,t.pvtGridObj._loadKPIElements,t)):t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView)},_loadKPIElements:function(t,i){t.pvtGridObj.model.dataSource;for(var l=this.reportItemNames,a=[],r=0;r<e(i).find("row").length;r++){var o=e(e(i).find("row")[r]),n=o.children("KPI_CAPTION").text(),s=o.children("KPI_goal").text(),d=o.children("KPI_STATUS").text(),h=o.children("KPI_TREND").text(),u=o.find("KPI_VALUE").text();e.inArray(o.children("KPI_NAME").text(),a)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:n,name:n,spriteCssClass:"e-measureGroupCDB e-icon",tag:n},t.pvtGridObj.schemaTreeView.push(treeNodeElement),a.push(n)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(s,l)>=0,id:s,pid:n,name:t.pvtGridObj._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:s},t.pvtGridObj.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(d,l)>=0,id:d,pid:n,name:t.pvtGridObj._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:d},t.pvtGridObj.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(h,l)>=0,id:h,pid:n,name:t.pvtGridObj._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:h},t.pvtGridObj.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(u,l)>=0,id:u,pid:n,name:t.pvtGridObj._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:u},t.pvtGridObj.schemaTreeView.push(treeNodeElement)}t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView),delete t.pvtGridObj.reportItemNames,delete t.pvtGridObj.schemaTreeView},_getTreeData:function(e,i,l){var a=t.olap.base._getConnectionInfo(e.url),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog><LocaleIdentifier>"+a.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>";this.doAjaxPost("POST",a.url,{XMLA:r},i,null,l)},_addHyperlink:function(i){if(e(".hyperlinkValueCell")[0]&&e(e(".hyperlinkValueCell")[0]).removeClass("hyperlinkValueCell"),e(".hyperlinkHeaderCell")[0]&&e(e(".hyperlinkHeaderCell")[0]).removeClass("hyperlinkHeaderCell"),""==e(i.target).text()||null==e(i.target).text())return!1;var l;"value"==i.target.parentElement.className.replace(/^\s+/,"").split(" ")[0]&&(this.enableValueCellHyperlink()||(t.isNullOrUndefined(this._pivotClientObj)?this.model.enableDrillThrough:this._pivotClientObj.model.enableDrillThrough))?e(i.target).addClass("hyperlinkValueCell"):e(i.target.parentElement).hasClass("summary value")&&this.enableSummaryCellHyperlink()?e(i.target).addClass("hyperlinkValueCell"):"rowheader"==i.target.parentElement.className.split(" ")[0]||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"rowheader"==e(i.target.parentElement).attr("role")?this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||0!=e(this.element).parents(".e-pivotclient").length?this.enableRowHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell"):e(i.target.parentElement).hasClass("rgtot")||(l=e(i.target.parentElement).attr("data-p").split(",")[0],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotRows[l])&&JSON.parse(this.getOlapReport()).PivotRows[l].EnableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.rows.length>0&&!t.isNullOrUndefined(this.model.dataSource.rows[l].enableHyperlink)&&this.model.dataSource.rows[l].enableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.enableRowHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell")):("colheader"==i.target.parentElement.className.split(" ")[0]||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"columnheader"==e(i.target.parentElement).attr("role"))&&(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||0!=e(this.element).parents(".e-pivotclient").length?this.enableColumnHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell"):e(i.target.parentElement).hasClass("calc")||e(i.target.parentElement).hasClass("cgtot")||e(i.target.parentElement).hasClass("gtot")||(l=e(i.target.parentElement).attr("data-p").split(",")[1],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotColumns[l])&&JSON.parse(this.getOlapReport()).PivotColumns[l].EnableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&!t.isNullOrUndefined(this.model.dataSource.columns[l].enableHyperlink)&&this.model.dataSource.columns[l].enableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.enableColumnHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell")))},_removeHyperlink:function(t){e(t.target).removeClass("hyperlinkValueCell").removeClass("hyperlinkHeaderCell")},_cellContext:function(i){var l=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),a=(e(i.target).hasClass("cellValue")?e(i.target).parent()[0]:i.target)||(e(i.srcElement).hasClass("cellValue")?e(i.srcElement).parent()[0]:i.srcElement);if(!t.isNullOrUndefined(l)&&1==l.enableCellContext()&&e(a).parents("#"+l._id)[0]&&(r=e(a).attr("data-p"))){var r=null!=l._excelLikeJSONRecords&&l.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(a).attr("data-i"):e(a).attr("data-p"),o=null!=l._excelLikeJSONRecords&&l.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?l._excelLikeJSONRecords[parseInt(parseInt(r.split(",")[0])*l._excelRowCount+parseInt(r.split(",")[1]))].Info:l.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*l._rowCount+parseInt(r.split(",")[1]))].Info,n={cellValue:a.innerHTML,cellPosition:r,cellType:""!=a.className.split(" ")[0]?a.className.split(" ")[0]:a.className.split(" ")[1],role:e(a).attr("role"),uniqueName:o.split("::")[0],args:i,rawdata:o};""!=n.cellType&&(t.isNullOrUndefined(l._pivotClientObj)?l._trigger("cellContext",{args:n}):l._pivotClientObj._trigger("cellContext",{args:n})),i.target?i.preventDefault():window.event.returnValue=!1}},_initCellSelection:function(i){var l,a;e("#"+this._id+" td,th").removeClass("e-highlighted"),this._on(this.element,"mouseup touchend",".value",this._completeCellSelection),this._oriX=i.pageX,this._oriY=i.pageY,l=i.target||window.event.srcElement,e(l).hasClass("cellValue")&&(l=l.parentElement),e(".value").addClass("selection"),e("#"+this._id).append(t.buildTag("div.e-cellSelection#"+this._id+"_cellSelection","",{})),this._startCellPosition=e(l)[0].attributes.getNamedItem("data-p").value,null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(a=this._excelLikeJSONRecords[0*this._rowCount+parseInt(e(l)[0].attributes.getNamedItem("data-i").value.split(",")[1])].Index,this._startCellPosition=this.getJSONRecords()[parseInt(e(l)[0].attributes.getNamedItem("data-p").value.split(",")[0])*this._rowCount+parseInt(a.split(",")[1])].Index),this._on(this.element,"mousemove touchmove",".value, .e-cellSelection",this._cellSelection)},_headerClickCellSelection:function(i){var l,a,r,o=e(i.target).attr("class").indexOf("colheader")&&-1==e(i.target).attr("class").indexOf("rowheader")?-1!=e(i.target).attr("class").indexOf("cellValue")?e(i.target).parent():null:e(i.target);if(null!=o){var n,s,d;for(e("#"+this._id+" td,th").removeClass("e-highlighted"),d="columnheader"==(n=o.attr("role"))?o.attr("data-p").split(",")[0]:o.attr("data-p").split(",")[1],s="columnheader"==n?o.attr("colspan"):o.attr("rowspan"),null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(l=parseInt(o.attr("data-p").split(",")[0])*this._rowCount+parseInt(o.attr("data-p").split(",")[1]),s="columnheader"==n?this._excelLikeJSONRecords[parseInt(o.attr("data-i").split(",")[0])*this._rowCount+parseInt(o.attr("data-i").split(",")[1])].ColSpan:this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&null!=this.getJSONRecords()[l+this._rowCount]&&-1==this.getJSONRecords()[l+this._rowCount].CSS.indexOf("value")?this.getJSONRecords()[l].RowSpan+1:this.getJSONRecords()[l].RowSpan),a=0;a<s;a++)"columnheader"==n?(e("#"+this._id+" [data-p^='"+(parseInt(a)+parseInt(d))+",']").addClass("e-highlighted"),e("#"+this._id+" [data-p^='"+(parseInt(a)+parseInt(d))+",'][role='columnheader']").each(function(t,i){(parseInt(i.attributes["data-p"].value.split(",")[1])<=parseInt(o.attr("data-p").split(",")[1])||parseInt(i.attributes.colspan.value)>parseInt(o.attr("colspan")))&&e(i).removeClass("e-highlighted")})):(e("#"+this._id+" [data-p$=',"+(parseInt(a)+parseInt(d))+"']").addClass("e-highlighted"),e("#"+this._id+" [data-p$=',"+(parseInt(a)+parseInt(d))+"'][role='rowheader']").each(function(t,i){(parseInt(i.attributes["data-p"].value.split(",")[0])<=parseInt(o.attr("data-p").split(",")[0])||parseInt(i.attributes.rowspan.value)>parseInt(o.attr("rowspan")))&&e(i).removeClass("e-highlighted")}));this._startCellPosition="columnheader"==n?e("#"+this._id+" [data-p^='"+(0+parseInt(d))+",'].value").eq(0).attr("data-p"):e("#"+this._id+" [data-p$=',"+(0+parseInt(d))+"'].value").eq(0).attr("data-p"),null==this._excelLikeJSONRecords||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(this._startCellPosition="columnheader"==n?e("#"+this._id+" [data-p^='"+(0+parseInt(d))+",'].value:not(.summary)").eq(0).attr("data-p"):e("#"+this._id+" [data-p$=',"+(0+parseInt(d))+"'].value:not(.summary)").eq(0).attr("data-p")),r="columnheader"==n?e("#"+this._id+" [data-p^='"+(parseInt(s)-1+parseInt(d))+",']").eq(e("#"+this._id+" [data-p^='"+(parseInt(s)-1+parseInt(d))+",']").length-1):e("#"+this._id+" [data-p$=',"+(parseInt(s)-1+parseInt(d))+"']").eq(e("#"+this._id+" [data-p$=',"+(parseInt(s)-1+parseInt(d))+"']").length-1),this._completeCellSelection(r)}},_cellSelection:function(i){e("#"+this._id+"_gridTooltip").hide();var l=e(i.target).parents(".e-pivotclient").length>0,a=i.pageX-this.element.offset().left-(this._oriX-this.element.offset().left),r=i.pageY-this.element.offset().top-(this._oriY-this.element.offset().top),o=this._oriX-this.element.offset().left,n=this._oriY-this.element.offset().top+3;a<0&&(o-=(a=Math.abs(a))-5),r<0&&(n-=(r=Math.abs(r))-12),i.pageX<this._oriX?e("#"+this._id+"_cellSelection").css({left:l?o:i.pageX+2,width:l?a:this._oriX-i.pageX}):e("#"+this._id+"_cellSelection").css({left:l?o:this._oriX-6,width:l?a:i.pageX-this._oriX}),i.pageY<this._oriY?e("#"+this._id+"_cellSelection").css({top:l?n:i.pageY,height:l?r:this._oriY-i.pageY-7}):e("#"+this._id+"_cellSelection").css({top:l?n:this._oriY+7,height:l?r:i.pageY-this._oriY-11}),e(".e-pivotGridTable").mouseleave(function(i){var l=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i.toElement)||t.isNullOrUndefined(i.toElement.classList)||"e-pivotgrid"!=i.toElement.classList[0]||(e("#"+l._id+"_cellSelection").remove(),e(".value").removeClass("selection"),l._off(l.element,"mouseup mouseend",".value"))})},_completeCellSelection:function(i){var a,r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C,S,O,y=[],P=[],w=[];if(this._off(this.element,"mousemove touchmove",".value"),e(".value").removeClass("selection"),a=e(i).hasClass("value")?i:i.target||window.event.srcElement,e(a).hasClass("cellValue")&&(a=a.parentElement),null==e(a)[0].attributes.getNamedItem("data-p"))return!1;for(r=e(a)[0].attributes.getNamedItem("data-p").value,null==this._excelLikeJSONRecords||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||e(i).hasClass("value")||(s=this._excelLikeJSONRecords[0*this._rowCount+parseInt(e(a)[0].attributes.getNamedItem("i").value.split(",")[1])].Index,r=this.getJSONRecords()[parseInt(e(a)[0].attributes.getNamedItem("data-p").value.split(",")[0])*this._rowCount+parseInt(s.split(",")[1])].Index),d=0,h=parseInt(this._startCellPosition.split(",")[1])<parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]);h<=(parseInt(this._startCellPosition.split(",")[1])>parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]));h++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("td[data-p*=',"+h+"']").parent().is(":visible"))for(u=parseInt(this._startCellPosition.split(",")[0])<parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]);u<=(parseInt(this._startCellPosition.split(",")[0])>parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]));u++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("[data-p*='"+u+",']").last("th").is(":Visible")){y[d]=this.getJSONRecords()[u*this._rowCount+h];var N,x,T,M="",L=0,D=0;if((o=this.element.find(".summary[role!='gridcell'][data-p$=',"+h+"'] , .rowheader[role!='gridcell'][data-p$=',"+h+"']").last().attr("data-p"))==l&&(o=e("#"+this._id).find("tbody").find('[data-p="'+u+","+h+'"]').parent("tr").find(".summary").first().attr("data-p")),x=o,null!=o){for(;o[0]>=0;)o==this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Index&&(N=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(N=e("#"+this._id).find("td[data-p*='"+u+","+h+"']").prevAll("th").children(".e-expand").length>0?N.replace(this._getLocalizedLabels("Total"),""):N),o=parseInt(o.split(",")[0])-1+","+parseInt(o.split(",")[1])),M&&""!=N?M=N+"##"+M:""!=N&&(M=N);P[d]=M}for(c="",T=m=this.element.find('tr:has(".colheader")').length-1,(n=y[d].Index)!=l&&n==this.getJSONRecords()[parseInt(parseInt(n.split(",")[0])*this._rowCount+parseInt(n.split(",")[1]))].Index&&(g=parseInt(n.split(",")[0])),f=0;f<=m;f++){if(null!=g&&g+","+f==this.getJSONRecords()[parseInt(parseInt(g)*this._rowCount+f)].Index){if(p=this.getJSONRecords()[parseInt(parseInt(g)*this._rowCount+f)].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(_=g;_>=0;_--)if(e("#"+this._id).find("th[data-p*='"+_+","+f+"']").length>0){p=e("#"+this._id).find("th[data-p*='"+_+","+f+"']").find(".e-expand").length>0?p.replace(this._getLocalizedLabels("Total"),""):p;break}""==c?c=p:""!=p&&(c=c+"##"+p)}w[d]=c}d++}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap){for(v=this.getJSONRecords()[parseInt(parseInt(x.split(",")[0])*this._rowCount+parseInt(x.split(",")[1]))].Info;v[0]>=0;)((N=this.getJSONRecords()[parseInt(parseInt(v.split(",")[0])*this._rowCount+parseInt(v.split(",")[1]))].Info).split("::")[0].indexOf("Measures")>0||N.split("::")[0].indexOf("MEASURES")>0)&&L++,o=parseInt(o.split(",")[0])-1+","+parseInt(o.split(",")[1]);if(b=parseInt(n.split(",")[0]),0==L)for(C=0;C<=T;C++)null!=b&&(S=this.getJSONRecords()[parseInt(parseInt(b)*this._rowCount+C)].Info),(S.split("::")[0].indexOf("Measures")>0||S.split("::")[0].indexOf("MEASURES")>0)&&D++}else this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotCalculations.length:this.model.dataSource.values.length;O={JSONRecords:y,rowHeader:P,columnHeader:w,measureCount:L>0?"Row:"+L:"Column:"+D},t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",O):this._pivotClientObj._trigger("cellSelection",O),y=P=w=[],e("#"+this._id+"_cellSelection").remove(),this._on(this.element,"mousemove touchmove",".value",this._applyToolTip),this._off(this.element,"mouseup touchend",".value")},exportPivotGrid:function(i,a){var r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C;if(this._rowCount=t.isNullOrUndefined(this._rowLength)?this._rowCount:this._rowLength,this._isExporting=!0,{},r="excel"==i.toLowerCase()||"excelexport"==i.toLowerCase()?{url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?".xls":".xlsx",title:"",description:"",exportType:i,controlName:this,exportWithStyle:!0,exportValueAsNumber:!1}:{url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:"word"==i.toLowerCase()?".docx":".pdf",title:"",description:"",exportType:i,controlName:this,exportWithStyle:!0},this._trigger("beforeExport",r),o={rowCellColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".rowheader").css("color"),rowCellBGColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".rowheader").css("background-color"),columnCellColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".colheader").css("color"),columnCellBGColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".colheader").css("background-color"),valueCellColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("color"))?"rgb(51, 51, 51)":this._cFormat.length<=0?this.element.find(".value").css("color"):"rgb(51, 51, 51)",valueCellBGColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("background-color"))?"rgb(255, 255, 255)":this._cFormat.length<=0?this.element.find(".value").css("background-color"):"rgb(255, 255, 255)",summaryCellColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("color"))?"rgb(51, 51, 51)":this.element.find(".summary").css("color"),summaryCellBGColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("background-color"))?"rgb(255, 255, 255)":"rgba(0, 0, 0, 0)"==this.element.find(".summary").css("background-color")?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")},this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode||r.exportMode==t.PivotGrid.ExportMode.JSON){if(C={},this.model.enableCompleteDataExport&&(this.model.enablePaging||this.model.enableVirtualScrolling)){if(n={paging:this.model.enablePaging,vScrolling:this.model.enableVirtualScrolling},s=0,this.model.enablePaging=this.model.enableVirtualScrolling=!1,this._isExporting=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(this._fullExportedData.jsonObj=t.PivotAnalysis.pivotEnginePopulate(this.model).json,this._fullExportedData.rowCount=0,p=0;p<this._fullExportedData.jsonObj.length&&0==parseInt(this._fullExportedData.jsonObj[p].Index.split(",")[0]);p++)this._fullExportedData.rowCount++;else t.olap.base.getJSONData({action:"loadFieldElements"},this.model.dataSource,this);else{try{b=JSON.parse(this.getOlapReport()).Report}catch(e){b=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"export",currentReport:b,gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),function(e){if(this._fullExportedData.jsonObj=t.isNullOrUndefined(e[0])?t.isNullOrUndefined(e.d)?JSON.parse(e.JsonRecords):JSON.parse(e.d[0]):JSON.parse(e[0]),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){this._fullExportedData.rowCount=0;for(var i=0;i<this._fullExportedData.jsonObj.length&&0==parseInt(this._fullExportedData.jsonObj[i].Index.split(",")[0]);i++)this._fullExportedData.rowCount++}else this._fullExportedData.rowCount=t.isNullOrUndefined(e[1])?t.isNullOrUndefined(e.d)?JSON.parse(e.RowCount):JSON.parse(e.d[1]):JSON.parse(e[1])})}this.exportRecords=this._fullExportedData.jsonObj,s=this._fullExportedData.rowCount,C={args:JSON.stringify({pGridData:null!=this.exportRecords&&""!=this.exportRecords?this.exportRecords:null,rowCount:s,columnCount:null!=this.exportRecords?Math.floor(this.exportRecords.length/s):0,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})},this.model.enablePaging=n.paging,this.model.enableVirtualScrolling=n.vScrolling,this._isExporting=!1}else{var S,O,y,P=0,w=!1,N=!1,x=0,T=0,M=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap,L=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap,D=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode,I=e.extend(!0,[],this.exportRecords),F=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotRows.length>1;if(!(this.model.enableColumnGrandTotal&&this.model.enableGrandTotal&&this.model.enableRowGrandTotal||this.model.enableColumnGrandTotal&&this.model.enableGrandTotal)){if(!M||D)for(p=0;p<I.length;p++)("summary cgtot"==I[p].CSS||"summary gtot"==I[p].CSS&&0==I[p].Index.split(",")[1])&&I.splice(p);if(M)for(p=0;p<I.length;p++)0==I[p].Index.split(",")[1]&&"summary col"==I[p].CSS&&I.splice(p);T=this._rowCount}if(!(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode!=t.PivotGrid.OperationalMode.ClientMode||this.model.enableRowGrandTotal&&this.model.enableGrandTotal||F)){for(d=this._rowCount-1,p=0;p<I.length;p++)I[p].Index.split(",")[1]==d&&(I=I.slice(0,p).concat(I.slice(p+1,I.length)));T=this._rowCount-1}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(JSON.parse(this.getOlapReport()).PivotRows.length>1||JSON.parse(this.getOlapReport()).PivotColumns.length>1)){if(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)for(p=0;p<I.length;p++)0==I[p].Index.split(",")[1]&&"summary"==I[p].CSS&&I.splice(p);if(!this.model.enableRowGrandTotal||!this.model.enableGrandTotal)for(S=this.exportRecords.length/this._rowCount,p=0;p<I.length;p++)if(0==I[p].Index.split(",")[0]&&"summary"==I[p].CSS){for(h=p,u=this._rowCount-h,g=0;g<I.length;g++)I=I.slice(0,h).slice(0,this._rowCount+x).concat(I.slice(this._rowCount+P,I.length)),x=h-1,h=h+this.element.find("tr").length-u,P=x+1;break}T=u!=l?this.element.find("tr").length-u:this.element.find("tr").length}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(L?(O=this.model.dataSource.rows,y=this.model.dataSource.columns):null!=this.getOlapReport()&&(O=JSON.parse(this.getOlapReport()).PivotRows,y=JSON.parse(this.getOlapReport()).PivotColumns),0==T&&(T=this._rowCount),S=I.length/T,O.length>1&&"excellikelayout"!=this.layout())for(m=0;m<O.length;m++)if(0==O[m].showSubTotal)for(w=!0,p=0;p<I.length;p++)if(I[p].Index.split(",")[0]==m&&"summary rstot"==I[p].CSS||"summary stot"==I[p].CSS)for(c=I[p].Index.split(",")[1],g=0;g<I.length;g++)I[g].Index.split(",")[1]==c&&(I=I.slice(0,g).concat(I.slice(g+1,I.length)),p=0);if(O.length>1&&1==w)for(T=I.length/S,S=I.length/T,m=0;m<S-1;m++)for(g=I[0].RowSpan;g<I.length;g++)if(I[g].Index.split(",")[0]==m&&("rowheader"==I[g].CSS||"summary rstot"==I[g].CSS||"summary stot"==I[g].CSS||"none"==I[g].CSS)&&1==I[g].Expander){var R=I[g].Index.split(",")[1],E=I[g].Index.split(",")[0],k=0;for(j=0;j<I[g].RowSpan;j++)parseInt(R)+I[g].RowSpan>I[g+j].Index.split(",")[1]&&E==I[g+j].Index.split(",")[0]&&k++;I[g].RowSpan=k}if(y.length>1&&"excellikelayout"!=this.layout())for(L&&(valuedata=this.model.dataSource.values),D&&(valuedata=JSON.parse(this.getOlapReport()).PivotCalculations),m=0;m<y.length;m++)if(0==y[m].showSubTotal)for(N=!0,p=0;p<I.length;p++)(I[p].Index.split(",")[1]==m&&"summary cstot"==I[p].CSS||"summary stot"==I[p].CSS)&&(I=I.slice(0,p-m).slice(0,p+T*valuedata.length-m).concat(I.slice(p+T*valuedata.length-m,I.length)));if(y.length>1&&1==N)for(S=I.length/T,m=0;m<I.length;m++)for(g=I[0].ColSpan;g<I.length;g++)if(I[g].Index.split(",")[0]==m&&("colheader"==I[g].CSS||"summary cstot"==I[g].CSS||"summary stot"==I[g].CSS||"none"==I[g].CSS)&&1==I[g].Expander){R=I[g].Index.split(",")[1],E=I[g].Index.split(",")[0];var A=0;for(j=0;j<I.length;j++)g+j<I.length&&parseInt(E)+I[g].ColSpan>I[g+j].Index.split(",")[0]&&R==I[g+j].Index.split(",")[1]&&(A++,j+=T-1);I[g].ColSpan=A}}f=I.length,C=0!=T?F?{args:JSON.stringify({pGridData:null!=I&&""!=I?I:null,rowCount:T,columnCount:JSON.parse(this.getOlapReport()).PivotRows.length>1&&!this.model.enableGrandTotal?f/T:this.model.enableColumnGrandTotal?t.isNullOrUndefined(S)?f/T:S:f/T,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}:{args:JSON.stringify({pGridData:null!=I&&""!=I?I:null,rowCount:T,columnCount:f/T,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}:{args:JSON.stringify({pGridData:null!=this.exportRecords&&""!=this.exportRecords?this.exportRecords:null,rowCount:null!=this._excelLikeJSONRecords?this._excelRowCount:this._rowCount,columnCount:null!=this._excelLikeJSONRecords?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):null==this.getJSONRecords()||t.isNullOrUndefined(this._rowLength)?Math.floor(this.getJSONRecords().length/this._rowCount):f/this._rowLength,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}}!t.raiseWebFormsServerEvents||"excelExport"!=i&&"wordExport"!=i&&"pdfExport"!=i&&"csvExport"!=i||r.exportMode!=t.PivotGrid.ExportMode.JSON||""!=e.trim(r.url)?this.doPostBack(""!=e.trim(r.url)?r.url:i,C):(_={model:this.model,originalEventType:i},v=C,t.raiseWebFormsServerEvents(i,_,v),setTimeout(function(){t.isOnWebForms=!0},1e3))}else{try{b=JSON.parse(this.getOlapReport()).Report}catch(e){b=this.getOlapReport()}C={args:JSON.stringify({exportOption:i,fileFormat:r.fileFormat,currentReport:b,layout:this.layout(),colorSettings:o!=l?JSON.stringify(o):"",customObject:JSON.stringify(this.model.customObject),title:r.title,description:r.description,completeDataExport:this.model.enableCompleteDataExport,exportWithStyle:r.exportWithStyle})},this.doPostBack(""!=e.trim(r.url)?r.url:this.model.url+"/"+this.model.serviceMethodSettings.exportPivotGrid,C)}this._isExporting=!1},_createCalculatedField:function(){var i,l;t.Pivot.openPreventPanel(this),this.element.find(".calculatedFieldPopup",".e-clientDialog",".e-dialog").remove();var a=this._getLocalizedLabels("CalculatedField"),r=t.buildTag("label#"+this._id+"_lblCalFieldName",this._getLocalizedLabels("Name"))[0].outerHTML,o=t.buildTag("span.fieldDropDown",t.buildTag("input#"+this._id+"_calculateFieldList","",{},{type:"text"})[0].outerHTML+t.buildTag("input#"+this._id+"_calculateFieldName.calculateFieldName","",{"margin-left":this.model.enableRTL?"86px":"2px",outline:"none"},{type:"text"})[0].outerHTML,{})[0].outerHTML,n=t.buildTag("button#"+this._id+"_btnAdd",this._getLocalizedLabels("Add"),{},{name:this._getLocalizedLabels("Add")})[0].outerHTML,s=t.buildTag("label#"+this._id+"_lblCalFieldFormula",this._getLocalizedLabels("Formula"))[0].outerHTML,d=t.buildTag("input.calculatedFieldFormula#"+this._id+"_calculatedFieldFormula","",{width:"192px",height:"27px"},{type:"text",disabled:"disabled"})[0].outerHTML,h=t.buildTag("button#"+this._id+"_btnDelete",this._getLocalizedLabels("Delete"),{"margin-top":"-2px"},{name:this._getLocalizedLabels("Delete")})[0].outerHTML,u=t.buildTag("label#"+this._id+"_pivotGridValueFields",this._getLocalizedLabels("Fields"))[0].outerHTML,c=t.buildTag("ul#"+this._id+"_fieldCollection","")[0].outerHTML,p=t.buildTag("button.calculatorFields","",{"margin-left":this.model.enableRTL?"0px":"10px","margin-right":this.model.enableRTL?"10px":"0px"})[0].outerHTML,m=t.buildTag("span.editFormula e-icon e-cancel","",{padding:"3px","margin-left":"-54px","margin-right":this.model.enableRTL?"-54px":"0px",position:"relative"}).attr("aria-label","cancel")[0].outerHTML,g=t.buildTag("span",t.buildTag("button#"+this._id+"_btnInsert",this._getLocalizedLabels("InsertField"),{},{name:this._getLocalizedLabels("InsertField")})[0].outerHTML,{"margin-right":"150px","margin-left":"150px"})[0].outerHTML,f=t.buildTag("button#"+this._id+"_btnOk",this._getLocalizedLabels("OK"),{"margin-left":"10px"},{name:this._getLocalizedLabels("OK")})[0].outerHTML,_=t.buildTag("button#"+this._id+"_btnCancel",this._getLocalizedLabels("Cancel"),{"margin-left":this.model.enableRTL?"0px":"10px"},{name:this._getLocalizedLabels("Cancel")})[0].outerHTML,v=t.buildTag("div",f+_,{float:this.model.enableRTL?"left":"right","margin-bottom":"15px","margin-top":"4px"})[0].outerHTML,b=t.buildTag("div.e-calcFormulaDiv",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td","+")[0].outerHTML+t.buildTag("td","-")[0].outerHTML+t.buildTag("td","*")[0].outerHTML+t.buildTag("td","/")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","7")[0].outerHTML+t.buildTag("td","8")[0].outerHTML+t.buildTag("td","9")[0].outerHTML+t.buildTag("td","%")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","4")[0].outerHTML+t.buildTag("td","5")[0].outerHTML+t.buildTag("td","6")[0].outerHTML+t.buildTag("td","^")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","1")[0].outerHTML+t.buildTag("td","2")[0].outerHTML+t.buildTag("td","3")[0].outerHTML+t.buildTag("td","(")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",".")[0].outerHTML+t.buildTag("td","0")[0].outerHTML+t.buildTag("td","C")[0].outerHTML+t.buildTag("td",")")[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{display:"none"})[0].outerHTML,C=t.buildTag("div#calculatedField.e-dlgCalculatedField",'<table class="outerTable"><tr><td>'+r+"</td><td>"+o+"</td><td>"+n+"</td></tr><tr><td>"+s+"</td><td>"+d+p+m+"</td><td>"+h+'</td></tr></table><p class="borderLine"></p><table class="e-fieldTable"><tr><td>'+u+"</td></tr><tr><td>"+c+"</td></tr><tr><td>"+g+"</td></tr></table>")[0].outerHTML,S=t.buildTag("div#clientDialog.e-clientDialog",C+v+b,{opacity:"1"}).attr("title",a)[0].outerHTML;e(S).appendTo("#"+this._id),this.element.find(".e-clientDialog").ejDialog({width:"auto",target:"#"+this._id,enableRTL:this.model.enableRTL,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)}),e("#"+this._id+"_btnAdd,#"+this._id+"_btnDelete,#"+this._id+"_btnOk,#"+this._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80",enableRTL:this.model.enableRTL}),e("#"+this._id+"_btnInsert").ejButton({type:t.ButtonType.Button,enabled:!1,width:"100",enableRTL:this.model.enableRTL}),e(".calculatorFields").ejButton({type:t.ButtonType.Button,contentType:"imageonly",prefixIcon:"e-icon e-sigma",htmlAttributes:{title:"Click Me"},enableRTL:this.model.enableRTL}),e("#"+this._id+"_calculateFieldList").ejDropDownList({width:"230px",enableRTL:this.model.enableRTL,dataSource:this._calculatedField,fields:{text:"name",value:"name"},select:t.proxy(this._calculatedFieldListChange,this),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),i=[],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(JSON.parse(this.getOlapReport()).PivotCalculations).each(function(){8!=this.CalculationType&&"Formula"!=this.CalculationType&&i.push({fields:this.FieldName})}):e(e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField})).each(function(){i.push({fields:this.fieldName})}),l=e("#"+this._id+"_btnInsert").data("ejButton"),0==this._calculatedField.length&&(e("#"+this._id+"_btnOk").ejButton("disable"),e("#"+this._id+"_btnOk").attr("disabled","disabled")),e("#"+this._id+"_fieldCollection").ejListBox({dataSource:i,enableRTL:this.model.enableRTL,select:function(){l.enable()},height:"130",width:"400"}),l.disable(),this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close")),e(".calculatorFields").click(function(){e("div.e-calcFormulaDiv").removeAttr("style")}),e(".editFormula").click(function(){var t=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=e("#"+t._id+"_calculatedFieldFormula").val().lastIndexOf(" ");""!==e("#"+t._id+"_calculatedFieldFormula").val()&&i>0?i+1==e("#"+t._id+"_calculatedFieldFormula").val().length?e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val().substring(0,i-2)):e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val().substring(0,i)+" "):e("#"+t._id+"_calculatedFieldFormula").val("")}),null!=this.model.pivotEnginePopulated&&this._trigger("pivotEnginePopulated",{JSONRecords:jsonObj}),e(document).click(function(t){e(t.target).hasClass("calculatorFields")||e(t.target).hasClass("e-sigma")||e(t.target).parents(".e-calcFormulaDiv").length>0||e("div.e-calcFormulaDiv").css("display","none")}),e("div.e-calcFormulaDiv").on("click","td",function(){var t=e(this).parents(".e-pivotgrid").data("ejPivotGrid");"C"==this.textContent?e("#"+t._id+"_calculatedFieldFormula").val(""):e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val()+("+-/%^*".indexOf(this.textContent)>-1?" "+this.textContent+" ":this.textContent))}),e("#"+this._id+"_btnInsert").click(function(){var t=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=e("#"+t._id+"_fieldCollection").data("ejListBox");e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val()+i.value())}),e("#"+this._id+"_btnAdd").click(function(){var i,l,a,r,o=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),n=e("#"+o._id+"_calculatedFieldFormula").val().split(" "),s=-1;if(""!=e("#"+o._id+"_calculateFieldName").val()&&""!=e("#"+o._id+"_calculatedFieldFormula").val()){for(r=0;r<n.length;r++){if((s="+-/%^*".indexOf(n[r])>-1?r:-1)>-1&&n.length>0&&(""==n[0]||"."==n[0]||""==n[n.length-1]||"."==n[n.length-1]||""==n[s+1]||"."==n[s+1]))return void t.Pivot._createErrorDialog(o._getLocalizedLabels("NotValid"),o._getLocalizedLabels("Warning"),o);if(n[r].indexOf("(")==n[r].length-1||0==n[r].indexOf(")")||e("#"+o._id+"_calculatedFieldFormula").val().replace(/[^\(_]/g,"").length!=e("#"+o._id+"_calculatedFieldFormula").val().replace(/[^\)_]/g,"").length)return void t.Pivot._createErrorDialog(o._getLocalizedLabels("NotValid"),o._getLocalizedLabels("Warning"),o)}for(i=[],o.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(JSON.parse(o.getOlapReport()).PivotCalculations).each(function(){8!=this.CalculationType&&"Formula"!=this.CalculationType&&i.push({fields:this.FieldName})}):e(o.model.dataSource.values).each(function(){i.push({fields:this.fieldName})}),n=e("#"+o._id+"_calculatedFieldFormula").val().replace(/\(|\)/g," ").split(" "),r=0;r<n.length;r++){for(l=!1,a=0;a<i.length;a++)if(n[r].indexOf(i[a].fields)>-1&&n[r]!=i[a].fields)l=!0;else if(n[r]==i[a].fields){l=!1;break}if(l)return void t.Pivot._createErrorDialog(o._getLocalizedLabels("NotPresent"),o._getLocalizedLabels("Warning"),o)}for(r=0;r<o._calculatedField.length;r++)if(o._calculatedField[r].name==e("#"+o._id+"_calculateFieldName").val())return confirm(o._getLocalizedLabels("Confirm"))?(o._calculatedField[r].formula=e("#"+o._id+"_calculatedFieldFormula").val(),e("#"+o._id+"_calculatedFieldFormula").val(""),e("#"+o._id+"_calculateFieldName").val(""),void e("#"+o._id+"_calculateFieldList").ejDropDownList({dataSource:o._calculatedField,fields:{text:"name",value:"name"},enableRTL:o.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}})):void 0;o._calculatedField.push({name:e("#"+o._id+"_calculateFieldName").val(),formula:e("#"+o._id+"_calculatedFieldFormula").val()}),e("#"+o._id+"_calculatedFieldFormula").val(""),e("#"+o._id+"_calculateFieldName").val(""),e("#"+o._id+"_calculateFieldList").ejDropDownList({dataSource:o._calculatedField,fields:{text:"name",value:"name"},enableRTL:o.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),o._calculatedField.length>0&&(e("#"+o._id+"_btnOk").ejButton("enable"),e("#"+o._id+"_btnOk").removeAttr("disabled"))}else t.Pivot._createErrorDialog(o._getLocalizedLabels("EmptyField"),o._getLocalizedLabels("Warning"),o)}),e("#"+this._id+"_btnDelete").click(function(){var i,l,a,r,o,n,s,d=e(this).parents(".e-pivotgrid").data("ejPivotGrid");if(0!=d._calculatedField.length){for(i=hederTag=e("#"+d._id+"_calculateFieldName").val(),o=0;o<d._calculatedField.length;o++)if(d._calculatedField[o].name==e("#"+d._id+"_calculateFieldName").val()){if(d.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)d.model.dataSource.values=e.grep(d.model.dataSource.values,function(e){return e.fieldCaption!=d._calculatedField[o].name}),d._calculatedField.splice(o,1),d._populatePivotGrid();else{for(d._calculatedField.splice(o,1),o=0;o<d._pivotTableFields.length;o++)d._pivotTableFields[o].name==i&&(d._pivotTableFields[o].isSelected=!1,headerTag=d._pivotTableFields[o],d._pivotTableFields.splice(o,1));try{l=JSON.parse(d.getOlapReport()).Report}catch(e){l=d.getOlapReport()}r="schemaRow::"+headerTag.id+"::FILTERED",null==d._schemaData&&(null!=d.model.beforeServiceInvoke&&d.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&d._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:d.element,customObject:d.model.customObject}),n=JSON.stringify(d.model.customObject),a=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(headerTag),dropAxis:"schemaValue::",sortedHeaders:d._ascdes,filterParams:r,currentReport:l,valueSorting:JSON.stringify(d.model.valueSortSettings),customObject:n}),d.model.enableDeferUpdate?d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.nodeStateModified,a.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),d._nodeStateModifiedSuccess):d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.nodeStateModified,a,d._nodeStateModifiedSuccess))}null!=d._schemaData&&(s=d._schemaData._tableTreeObj.element.find("li[id='"+i+"']"),d._schemaData._tableTreeObj.uncheckNode(s),d._schemaData._tableTreeObj.model.beforeDelete=null,d._schemaData._tableTreeObj.removeNode(s),d._schemaData._tableTreeObj.model.beforeDelete=function(){return!1})}else if(o==d._calculatedField.length-1)return void t.Pivot._createErrorDialog(d._getLocalizedLabels("CalculatedFieldNameNotFound"),d._getLocalizedLabels("Warning"),d)}else t.Pivot._createErrorDialog(d._getLocalizedLabels("CalculatedFieldNameNotFound"),d._getLocalizedLabels("Warning"),d)}),e("#"+this._id+"_btnOk").click(function(){var i,l,a,r,o,n,s,d=e(this).parents(".e-pivotgrid").data("ejPivotGrid");for(d.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(d.model.dataSource.values=e.grep(d.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField})),i=0;i<d._calculatedField.length;i++){for(l=d._calculatedField[i].formula.replace(/\(|\)/g," ").replace(/[-+*/^%]/g," ").split(" "),a=0;a<l.length;a++)if(!e.isNumeric(l[a])&&""!=l[a].replace(/\s+|\s+$/gm,"")&&0==(d.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.grep(JSON.parse(d.getOlapReport()).PivotCalculations,function(e){return e.FieldName==l[a]}).length:e.grep(d.model.dataSource.values,function(e){return e.fieldName==l[a]}).length))return void t.Pivot._createErrorDialog(d._getLocalizedLabels("NotPresent"),d._getLocalizedLabels("Warning"),d);r=d._calculatedField[i].formula.replace(/\s+|\s+$/gm,""),r=d._parenthesisAsterisk(r),d.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&0==e.grep(d.model.dataSource.values,function(e){return e.fieldName==d._calculatedField[i].name&&(e.formula=d._calculatedField[i].formula),e.fieldName==d._calculatedField[i].name}).length&&(d.model.dataSource.values.push({fieldName:d._calculatedField[i].name,fieldCaption:d._calculatedField[i].name,isCalculatedField:!0,formula:r,format:d._calculatedField[i].format,formatString:d._calculatedField[i].formatString}),null!=d._schemaData&&d._schemaData._tableTreeObj.element.find("li[id='"+d._calculatedField[i].name+"']").find(".e-chk-inact").length>0&&d._schemaData._tableTreeObj.checkNode(d._calculatedField[i].name))}if(d.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(d),d.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode)d._populatePivotGrid();else{t.isNullOrUndefined(d._waitingPopup)||d._waitingPopup.show();try{o=JSON.parse(d.getOlapReport()).Report}catch(e){o=d.getOlapReport()}null!=d.model.beforeServiceInvoke&&d._trigger("beforeServiceInvoke",{action:"calculatedField",element:d.element,customObject:d.model.customObject}),n=JSON.stringify(d.model.customObject),s=JSON.stringify({action:"calculatedField",headerTag:JSON.stringify(d._calculatedField),currentReport:o,valueSorting:JSON.stringify(d.model.valueSortSettings),customObject:n}),d.model.enableDeferUpdate?(t.isNullOrUndefined(d._waitingPopup)||d._waitingPopup.hide(),d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.calculatedField,s.replace("calculatedField","calculatedFieldDeferUpdate"),null==d._schemaData?d._renderControlSuccess:d._schemaCalculatedField)):d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.calculatedField,s,null==d._schemaData?d._renderControlSuccess:d._schemaCalculatedField)}}),e("#"+this._id+"_btnCancel").click(function(){var i=e(this).parents(".e-pivotgrid").data("ejPivotGrid");i.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(i)}),this._curFocus.field=this.element.find(".e-dialog .calculateFieldName").attr("tabindex","-1")},_schemaCalculatedField:function(i){var l,a,r;for(this._schemaData._tableTreeObj.model.nodeCheck=null,this._schemaData._tableTreeObj.model.nodeUncheck=null,r=0;r<this._calculatedField.length;r++)l=this._schemaData.element.find(".e-schemaFieldTree").data("ejTreeView"),0==this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").length?(a=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?{id:this._calculatedField[r].name,name:this._calculatedField[r].name,caption:this._calculatedField[r].name,isSelected:!0,spriteCssClass:""}:{id:this._calculatedField[r].name,name:this._calculatedField[r].name,isSelected:!0,calculationType:8,formula:this._calculatedField[r].formula,summaryType:6,format:null,allowRunTimeGroupByField:"false",pivotType:"PivotComputationInfo",spriteCssClass:""},this._pivotTableFields.push(a),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._pivotTableFields=t.PivotAnalysis.getTreeViewData(this.model.dataSource)),this._schemaData._setTableFields(this._pivotTableFields),l.addNode(a),this._schemaData._tableTreeObj.element.find(".e-item").css("padding","0px")):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&null!=this._schemaData&&this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").find(".e-chk-inact").length>0?this._schemaData._tableTreeObj.checkNode(this._calculatedField[r].name):this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").removeClass("filter").find(".treeDrop , .filter").remove();if(this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),this._schemaData._tableTreeObj.model.nodeCheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this._schemaData._tableTreeObj.model.nodeUncheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableDeferUpdate?(this._isUpdateRequired=!0,this._deferUpdateSuccess(i)):this._renderControlSuccess(i)),e(this._schemaData.element.find(".e-schemaValue .e-pivotButton")).each(function(){e(this).remove()}),t.isNullOrUndefined(this._pivotClientObj)||void 0===this._pivotClientObj._pivotSchemaDesigner)if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(report=JSON.parse(this.getOlapReport()),r=0;r<report.PivotCalculations.length;r++)this._schemaData._createPivotButton({fieldName:report.PivotCalculations[r].FieldName,fieldCaption:report.PivotCalculations[r].FieldHeader},"value","","","");else for(r=0;r<this.model.dataSource.values.length;r++)this._schemaData._createPivotButton({fieldName:this.model.dataSource.values[r].fieldName,fieldCaption:this.model.dataSource.values[r].fieldCaption},"value","","","");else this._schemaData._refreshPivotButtons();this._schemaData._setPivotBtnWidth()},_calculatedFieldListChange:function(t){e("#"+this._id+"_calculateFieldName").val(t.selectedText);for(var i=0;i<this._calculatedField.length;i++)this._calculatedField[i].name==t.selectedText&&e("#"+this._id+"_calculatedFieldFormula").val(this._calculatedField[i].formula)},_parenthesisAsterisk:function(e){for(var t=1;t<e.length-1;t++)"("==e[t]&&-1=="+-/%^*(".indexOf(e[t-1])&&(e=e.substring(0,t)+"*"+e.substring(t),t--),")"==e[t]&&-1=="+-/%^*)".indexOf(e[t+1])&&(e=e.substring(0,t+1)+"*"+e.substring(t+1),t--);return e},_calcFieldNodeDrop:function(t){for(var i=e.grep(this.model.dataSource.values,function(e){return 1==e.isCalculatedField&&e.formula.indexOf(t.fieldName)>-1}),l=0;l<i.length;l++)this._schemaData._tableTreeObj.uncheckNode(i[l].fieldName)},_schemaButtonCreate:function(){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){e(this._schemaData.element.find(".e-schemaValue .e-pivotButton")).each(function(){e(this).remove()}),report=JSON.parse(this.getOlapReport());for(var i=0;i<report.PivotCalculations.length;i++)this._schemaData._createPivotButton({fieldName:report.PivotCalculations[i].FieldName,fieldCaption:report.PivotCalculations[i].FieldHeader},"value","","","")}this._schemaData._setPivotBtnWidth()},_calculatedFieldNodeRemove:function(i){for(var l=e.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(e){return 8==e.CalculationType&&e.Formula.indexOf(i.id)>-1}),a=0;a<l.length;a++)this._schemaData._tableTreeObj.model.nodeUncheck=null,this._schemaData._tableTreeObj.uncheckNode(l[a].FieldName),this._schemaData._tableTreeObj.element.find("li[id='"+l[a].FieldName+"']").removeClass("filter").find(".treeDrop").remove(),this._schemaData._tableTreeObj.model.nodeUncheck=t.proxy(this._schemaData._checkedStateModified,this._schemaData)},createConditionalDialog:function(){this.openConditionalFormattingDialog()},openConditionalFormattingDialog:function(){var i,a,r,o,n,s,d,h;if(!this.model.enableConditionalFormatting)return!1;t.Pivot.openPreventPanel(this),this.element.find(".e-dialog").remove(),i=t.buildTag("div#"+this._id+"_clientDlg.clientDialog",{opacity:"1"})[0].outerHTML,r=this._getLocalizedLabels("ConditionalFormatting");var u=t.buildTag("label#"+this._id+"_conLbl.e-conditionLbl",this._getLocalizedLabels("Condition"))[0].outerHTML,c=t.buildTag("input#"+this._id+"_conType.conditionType","",{},{type:"text",tabindex:0,accesskey:"f"})[0].outerHTML,p=t.buildTag("label#"+this._id+"_editcond.e-editcondition",this._getLocalizedLabels("FormatName"))[0].outerHTML,m=t.buildTag("label#"+this._id+"_value1.value1",this._getLocalizedLabels("Value1"))[0].outerHTML,g=t.buildTag("label#"+this._id+"_value2.e-value2",this._getLocalizedLabels("Value2"))[0].outerHTML,f=t.buildTag("label#"+this._id+"_backcolorLbl.backcolorLbl",this._getLocalizedLabels("Backcolor"))[0].outerHTML,_=t.buildTag("label#"+this._id+"_bordercolorLbl.bordercolorLbl",this._getLocalizedLabels("Bordercolor"))[0].outerHTML,v=t.buildTag("label#"+this._id+"_borderrangeLbl.e-borderrangeLbl",this._getLocalizedLabels("Borderrange"))[0].outerHTML,b=t.buildTag("label#"+this._id+"_borderstyleLbl.e-borderstyleLbl",this._getLocalizedLabels("Borderstyle"))[0].outerHTML,C=t.buildTag("label#"+this._id+"_fStyleLbl.fStyleLbl",this._getLocalizedLabels("Fontstyle"))[0].outerHTML,S=t.buildTag("label#"+this._id+"_fSizeLbl.e-fSizeLbl",this._getLocalizedLabels("Fontsize"))[0].outerHTML,O=t.buildTag("label#"+this._id+"_fontcolorLbl.fontcolorLbl",this._getLocalizedLabels("Fontcolor"))[0].outerHTML,y=t.buildTag("label#"+this._id+"_fValueLbl.fValueLbl",this._getLocalizedLabels("Measures"))[0].outerHTML,P=t.buildTag("input#"+this._id+"_editCon.editconditionDropDown","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,w=t.buildTag("input#"+this._id+"_editConText.editconditionText","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,N=t.buildTag("button#"+this._id+"_editBtn",this._getLocalizedLabels("Edit"),{},{name:this._getLocalizedLabels("Edit")}).attr("title",this._getLocalizedLabels("Edit")).attr("role","button").attr("aria-label","edit")[0].outerHTML,x=t.buildTag("button#"+this._id+"_removeBtn.e-dialogremoveBtn e-icon","",{},{name:this._getLocalizedLabels("Remove")}).attr("title",this._getLocalizedLabels("RemoveFormat")).attr("role","button").attr("aria-label","remove")[0].outerHTML,T=t.buildTag("input#"+this._id+"_conFrom.e-conditionFrom"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:2})[0].outerHTML,M=t.buildTag("input#"+this._id+"_conTo.e-conditionTo"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:3})[0].outerHTML,L=t.buildTag("input#"+this._id+"_backcolor.backcolor","",{},{type:"text",tabindex:4,accesskey:"d"})[0].outerHTML,D=t.buildTag("input#"+this._id+"_bordercolor.bordercolor","",{},{type:"text",tabindex:5,accesskey:"c"})[0].outerHTML,I=t.buildTag("input#"+this._id+"_borderrange.borderrange","",{},{type:"text",tabindex:6,accesskey:"r"})[0].outerHTML,j=t.buildTag("input#"+this._id+"_borderstyle.borderstyle","",{},{type:"text",tabindex:7,accesskey:"s"})[0].outerHTML,F=t.buildTag("input#"+this._id+"_fStyle.fStyle","",{},{type:"text",tabindex:8,accesskey:"o"})[0].outerHTML,R=t.buildTag("input#"+this._id+"_fSize.fSize","",{},{type:"text",tabindex:9,accesskey:"l"})[0].outerHTML,E=t.buildTag("input#"+this._id+"_fontcolor.fontcolor","",{},{type:"text",tabindex:10,accesskey:"b"})[0].outerHTML,k=t.buildTag("input#"+this._id+"_fValue.fValue","",{},{type:"text",tabindex:11,accesskey:"v"})[0].outerHTML;a=t.buildTag("div#"+this._id+"_conditionDlg.e-conditionDlg","<table class='conditionformatTbl'><tr><td>"+u+"</td><td>"+c+"</td><td>"+p+"</td><td>"+(this.model.conditionalFormatSettings.length>0?P:w)+"</td><td>"+N+"</td><td>"+x+"</td></tr><tr><td>"+m+"</td><td>"+T+"</td><td>"+g+"</td><td>"+M+"</td></tr><tr><td>"+C+"</td><td>"+F+"</td><td>"+v+"</td><td>"+I+"</td></tr><tr><td>"+O+"</td><td>"+E+"</td><td>"+b+"</td><td>"+j+"</td></tr><tr><td>"+f+"</td><td>"+L+"</td><td>"+S+"</td><td>"+R+"</td></tr><tr><td>"+_+"</td><td>"+D+"</td><td>"+y+"</td><td>"+k+"</td></tr></table>")[0].outerHTML;var A=t.buildTag("button#"+this._id+"_OKBtn.e-dialogOKBtn","",{},{name:this._getLocalizedLabels("OK")}).attr("title",this._getLocalizedLabels("OK"))[0].outerHTML,H=t.buildTag("button#"+this._id+"_CancelBtn.e-dialogCancelBtn","",{},{name:this._getLocalizedLabels("Cancel")}).attr("title",this._getLocalizedLabels("Cancel"))[0].outerHTML,U=t.buildTag("div",A+H,{float:this.model.enableRTL?"left":"right",margin:"20px 0px 6px"})[0].outerHTML;e("#"+this._id).after(i),e("#"+this._id+"_clientDlg").append(a+U),s=e(this.element).parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient")[0].id:this._id,e("#"+this._id+"_clientDlg").ejDialog({width:"auto",target:"#"+s,enableResize:!1,enableRTL:this.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,this)}),e(".e-titlebar").prepend(t.buildTag("div",r,{display:"inline"})[0].outerHTML)[0],e("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,#"+this._id+"_removeBtn,#"+this._id+"_editBtn").ejButton({type:t.ButtonType.Button}),e("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn").css({margin:"0 0 0 10px",width:"67px"}),e("#"+this._id+"_removeBtn").css({margin:this.model.enableRTL?"0px":"0 0 0 10px",width:"38px",height:"29px"}),e("#"+this._id+"_editBtn").css({margin:"0 0 0 10px",width:"70px",height:"29px"}),e("#"+this._id+"_conFrom,#"+this._id+"_conTo").css({width:"196px",height:"26px"}),e("#"+this._id+"_conditionDlg").css({margin:"13px 0 0 0"}),e("#"+this._id+"_editcond,#"+this._id+"_value2,#"+this._id+"_fValueLbl,#"+this._id+"_borderrangeLbl,#"+this._id+"_borderstyleLbl,#"+this._id+"_fSizeLbl").css({margin:"0 0 0 15px"}),e("#"+this._id+"_editConText").length>0&&(this._formatEdit=!0),e("#"+this._id+"_editConText").ejMaskEdit({inputMode:t.InputMode.Text,width:"200px",height:"26px"}),e("#"+this._id+"_conTo").attr("disabled","disabled"),this.removeBtn=e("#"+this._id+"_removeBtn").data("ejButton"),o=e("#"+this._id+"_OKBtn").data("ejButton"),n=e("#"+this._id+"_CancelBtn").data("ejButton"),N=e("#"+this._id+"_editBtn").data("ejButton"),this.removeBtn.setModel({enabled:!1}),o.setModel({text:this._getLocalizedLabels("OK")}),n.setModel({text:this._getLocalizedLabels("Cancel")}),e("#"+this._id+"_conType").ejDropDownList({change:"_activeConditionChange",dataSource:[{option:"Less Than",value:this._getLocalizedLabels("LessThan")},{option:"Less Than Or Equal To",value:this._getLocalizedLabels("LessThanOrEqualTo")},{option:"Greater Than",value:this._getLocalizedLabels("GreaterThan")},{option:"Greater Than Or Equal To",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"Equals",value:this._getLocalizedLabels("Equals")},{option:"Not Equals",value:this._getLocalizedLabels("NotEquals")},{option:"Between",value:this._getLocalizedLabels("Between")},{option:"Not Between",value:this._getLocalizedLabels("NotBetween")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_editCon").ejDropDownList({change:"_editConditionChange",dataSource:this._formatName,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_fontcolor").ejColorPicker({enableRTL:this.model.enableRTL}),e("#"+this._id+"_backcolor").ejColorPicker({enableRTL:this.model.enableRTL}),e("#"+this._id+"_bordercolor").ejColorPicker({enableRTL:this.model.enableRTL}),e("#"+this._id+"_borderrange").ejDropDownList({dataSource:["1","2","3","4","5","6","7","8","9"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_borderstyle").ejDropDownList({dataSource:[{option:"Solid",value:this._getLocalizedLabels("Solid")},{option:"Dashed",value:this._getLocalizedLabels("Dashed")},{option:"Dotted",value:this._getLocalizedLabels("Dotted")},{option:"Double",value:this._getLocalizedLabels("Double")},{option:"Groove",value:this._getLocalizedLabels("Groove")},{option:"Inset",value:this._getLocalizedLabels("Inset")},{option:"Outset",value:this._getLocalizedLabels("Outset")},{option:"Ridge",value:this._getLocalizedLabels("Ridge")},{option:"None",value:this._getLocalizedLabels("None")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_fStyle").ejDropDownList({dataSource:[{option:"Algerian",value:this._getLocalizedLabels("Algerian")},{option:"Arial",value:this._getLocalizedLabels("Arial")},{option:"Bodoni MT",value:this._getLocalizedLabels("BodoniMT")},{option:"Britannic Bold",value:this._getLocalizedLabels("BritannicBold")},{option:"Cambria",value:this._getLocalizedLabels("Cambria")},{option:"Calibri",value:this._getLocalizedLabels("Calibri")},{option:"Courier New",value:this._getLocalizedLabels("CourierNew")},{option:"DejaVu Sans",value:this._getLocalizedLabels("DejaVuSans")},{option:"Forte",value:this._getLocalizedLabels("Forte")},{option:"Gerogia",value:this._getLocalizedLabels("Gerogia")},{option:"Impact",value:this._getLocalizedLabels("Impact")},{option:"Segoe UI",value:this._getLocalizedLabels("SegoeUI")},{option:"Tahoma",value:this._getLocalizedLabels("Tahoma")},{option:"Times New Roman",value:this._getLocalizedLabels("TimesNewRoman")},{option:"Verdana",value:this._getLocalizedLabels("Verdana")},{option:"None",value:this._getLocalizedLabels("None")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_fSize").ejDropDownList({dataSource:["12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}});var z,V=[],B=[];if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){if(e(this.element).parents(".e-pivotclient").length>0)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(d=0;d<this._JSONRecords.length;d++)this._JSONRecords[d].Info.indexOf("Measures")>-1&&-1==e.inArray(this._JSONRecords[d].Value,B)&&B.push(this._JSONRecords[d].Value);else B=JSON.parse(this._pivotClientObj.getOlapReport()).PivotCalculations;else B=JSON.parse(this.getOlapReport()).PivotCalculations;z="FieldHeader"}else if(z="fieldCaption",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)B=this.model.dataSource.values;else for(d=0;d<this.model.dataSource.values.length;d++)B=this.model.dataSource.values[d].measures;for(V=B.length>0?["All"]:V,h=0;h<B.length;h++)e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?V.push(B[h]):V.push(B[h][z]);return V=V.length>0?V:["No Measure"],e("#"+this._id+"_fValue").ejDropDownList({dataSource:V,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_conType").ejDropDownList("option","change",t.proxy(this._activeConditionChange,this)),e("#"+this._id+"_editCon").ejDropDownList("option","change",t.proxy(this._editConditionChange,this)),this.isNewFormat=!0,this.ddlEditCondition=e("#"+this._id+"_editCon").data("ejDropDownList"),this.ddlConditionType=e("#"+this._id+"_conType").data("ejDropDownList"),this.ddlFont=e("#"+this._id+"_fStyle").data("ejDropDownList"),this.ddlFontSize=e("#"+this._id+"_fSize").data("ejDropDownList"),this.ddlFontColor=e("#"+this._id+"_fontcolor").data("ejColorPicker"),this.ddlBackColor=e("#"+this._id+"_backcolor").data("ejColorPicker"),this.ddlBorderColor=e("#"+this._id+"_bordercolor").data("ejColorPicker"),this.ddlBorderStyle=e("#"+this._id+"_borderstyle").data("ejDropDownList"),this.ddlBorderWidth=e("#"+this._id+"_borderrange").data("ejDropDownList"),this.ddlFieldValue=e("#"+this._id+"_fValue").data("ejDropDownList"),this.element.find("#"+this._id+"_conFrom,#"+this._id+"_conTo").keypress(function(t){return 8==t.which||0==t.which||!(t.which<45||45==t.which&&(""!=t.target.value||t.target.value.indexOf("-")>-1)||t.which>58)&&((46!=t.which||-1==e(this).val().indexOf("."))&&47!=t.which&&void 0)}),e("#"+this._id+"_OKBtn").click(function(){var i,a,r=null,o=!1;if(r=e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):e(this).parents(".e-pivotgrid").data("ejPivotGrid"),!t.isNullOrUndefined(r.ddlEditCondition))for(i=0;i<r.ddlEditCondition.model.dataSource.length;i++)r.ddlEditCondition.model.dataSource[i]==e("#"+r._id+"_editConText").val()&&i!=r.ddlEditCondition.selectedIndexValue&&(o=!0);this.ddlEditCondition=e("#"+r._id+"_editCon").data("ejDropDownList"),a=e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").data("ejPivotClient"):r,""==e("#"+r._id+"_editConText").val()?t.Pivot._createErrorDialog(r._getLocalizedLabels("EnterFormatName"),r._getLocalizedLabels("Warning"),a):r._formatEdit&&e("#"+r._id+"_editConText").val()!=l&&-1!=e.inArray(e("#"+r._id+"_editConText").val(),r._formatName)||!t.isNullOrUndefined(e("#"+r._id+"_editConText").val())&&o?t.Pivot._createErrorDialog(r._getLocalizedLabels("DuplicateFormatName"),r._getLocalizedLabels("Warning"),a):""==e("#"+r._id+"_conFrom").val()?t.Pivot._createErrorDialog(r._getLocalizedLabels("EnterOperand1"),r._getLocalizedLabels("Warning"),a):e("#"+r._id+"_conTo").attr("disabled")||""!=e("#"+r._id+"_conTo").val()?e("#"+r._id+"_fValue").attr("disabled")&&"No Measure"==e("#"+r._id+"_fValue").val()?t.Pivot._createErrorDialog(r._getLocalizedLabels("NoMeasure"),r._getLocalizedLabels("Warning"),a):(r._applyFormatting(),t.Pivot.closePreventPanel(r)):t.Pivot._createErrorDialog(r._getLocalizedLabels("EnterOperand2"),r._getLocalizedLabels("Warning"),a)}),this.ddlEditCondition!=l&&(this.ddlEditCondition.getListData().length>1?e("#"+this._id+"_editCon").ejDropDownList("enable"):(e("#"+this._id+"_editCon").ejDropDownList("disable"),e("#"+this._id+"_editcond").css("color","#cbcbcb"))),1==this.ddlFieldValue.getListData().length&&"No Measure"==this.ddlFieldValue._selectedValue?(e("#"+this._id+"_fValue").ejDropDownList("disable"),e("#"+this._id+"_fValueLbl").css("color","#cbcbcb")):e("#"+this._id+"_fValue").ejDropDownList("enable"),this.model.conditionalFormatSettings.length>0&&(this.ddlEditCondition.selectItemByValue(this.model.conditionalFormatSettings[this.model.conditionalFormatSettings.length-1].name),this._editConditionChange()),e("#"+this._id+"_removeBtn").click(function(){var t,i,l=null;(l=e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):e(this).parents(".e-pivotgrid").data("ejPivotGrid")).removeBtn.option("enabled")&&(1==(t=confirm(l._getLocalizedLabels("ConditionalFormattingConformMsg")))&&(i=l.ddlEditCondition._selectedIndices[0],l._removeCellFormatting(i,t),e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-dialog, .clientDialog").remove():l.element.find(".e-dialog, .clientDialog").remove()))}),e("#"+this._id+"_CancelBtn").click(function(){var i=null;e(this).parents(".e-pivotclient").length>0?(i=e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"),e(this).parents(".e-pivotclient").find(".e-dialog, .e-clientDialog").remove()):i=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),i.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(i)}),e("#"+this._id+"_editBtn").click(function(){(e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):e(this).parents(".e-pivotgrid").data("ejPivotGrid"))._editBtnAdd()}),!1},_editBtnAdd:function(){var i,a;0==e("#"+this._id+"_editConText").length&&(this._formatEdit=!0,i=t.buildTag("input#"+this._id+"_editConText.editconditionText","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,e(e(".editconditionDropDown").parents("td")[0]).before("<td>"+i+"</td>"),e(e(".editconditionDropDown").parents("td")[0]).css("display","none"),a=this.ddlEditCondition!=l&&this.ddlEditCondition.selectedTextValue!=l&&this.ddlEditCondition.selectedTextValue!=this._getLocalizedLabels("AddNew")?this.ddlEditCondition.selectedTextValue:"",this._formatEdit=this.ddlEditCondition!=l&&this.ddlEditCondition.selectedTextValue!=l&&this.ddlEditCondition.selectedTextValue==this._getLocalizedLabels("AddNew"),e("#"+this._id+"_editConText").ejMaskEdit({inputMode:t.InputMode.Text,value:a,width:"200px",height:"26px"}))},_activeConditionChange:function(t){"Between"==t.selectedValue||"Not Between"==t.selectedValue?e("#"+this._id+"_conTo").removeAttr("disabled"):(e("#"+this._id+"_conTo").attr("disabled","disabled"),e("#"+this._id+"_conTo").val(""))},_editConditionChange:function(){if(this.ddlEditCondition._selectedIndices[0]>0){var t=this.ddlEditCondition._selectedIndices[0]-1,i=this._cFormat[t].split(",");this.ddlConditionType.selectItemByValue(i[1]),e("#"+this._id+"_conFrom").val(i[9]),"undefined"!=i[9]&&"undefined"!=i[10]&&e("#"+this._id+"_conTo").val(i[10]),e("#"+this._id+"_fontcolor").ejColorPicker({value:i[2]}),e("#"+this._id+"_backcolor").ejColorPicker({value:i[3]}),e("#"+this._id+"_bordercolor").ejColorPicker({value:i[4]}),this.ddlBorderStyle.selectItemByValue(i[8]),this.ddlBorderWidth.selectItemByValue(i[5]),this.ddlFont.selectItemByValue(i[6]),this.ddlFontSize.selectItemByValue(i[7]),this.ddlFieldValue.selectItemByValue(i[11]),this.removeBtn.option("enabled",!0),this._conditionTypeChange()}else this._editBtnAdd(),this.removeBtn.option("enabled",!1),this._clearWindow()},_clearWindow:function(){e("#"+this._id+"_clientDlg").find("#"+this._id+"_conFrom,#"+this._id+"_conTo").val(""),e("#"+this._id+"_conTo").disabled=!0},_conditionTypeChange:function(){e("#"+this._id+"_conTo").disabled=!(4==this.ddlConditionType._selectedIndices[0]||5==this.ddlConditionType._selectedIndices[0])},_removeCellFormatting:function(e,t){for(var i,l=e,a=0;a<this._cFormat.length&&e;a++)for(t&&(a=e-1,e=0),i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS=this._JSONRecords[i].CSS.replace(" "+this._cFormat[a].split(",")[0].replace(/ /g,""),"");t?(this._cFormat.splice(l-1,1),this._list.splice(l-1,1),this.model.conditionalFormatSettings.splice(l-1,1),this._formatName.splice(l,1)):(this._cFormat=[],this._list=[],this.model.conditionalFormatSettings=[],this._formatName=[this._getLocalizedLabels("AddNew")]),this.renderControlFromJSON()},_applyStyle:function(i,l,a,r,o,n,s,d,h){var u,c,p=l.CSS,m="rows"==i?l.Index.split(",")[1]:"columns"==i?l.Index.split(",")[0]:null;h=h.replace(/ /g,""),(l.Value==a||"All"==a)&&-1==e.inArray(Number(m),r)&&r.push(Number(m)),c=1==e.isNumeric(l.Value)?l.Value:e.isNumeric(t.globalize.parseFloat(t.globalize.format(l.Value,"c",this.model.locale),this.model.locale))?t.globalize.parseFloat(t.globalize.format(l.Value,"c",this.model.locale),this.model.locale):l.Value.replace(/[^\d.\-]/g,""),u=-1!=e.inArray(Number(m),r),this._getResult(Number(o),Number(n),c,s)&&!t.isNullOrUndefined(c)&&e.isNumeric(c)&&u&&-1!=l.CSS.indexOf("value")&&(l.CSS=p+" "+h)},_refreshCellFormatting:function(e){for(var t,i,l,a=this._getAxis(),r=0;r<this._cFormat.length;r++)for(t=[],i=this._cFormat[r].split(","),l=0;l<e.length;l++)-1===e[l].CSS.indexOf(i[0].replace(/ /g,""))&&this._applyStyle(a,e[l],i[11],t,i[9],i[10],i[1],l,this._cFormat[r].split(",")[0].replace(/ /g,""));return e},_createDynamicRule:function(e,t,i,l,a,r,o,n){var s="color: "+e+"!important;background-color: "+t+" !important;border:"+i+" "+l+"px "+a+" !important;font:"+r+"px "+o+" !important;";(function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet})().insertRule("."+n.replace(/ /g,"")+"{"+s+"}",0)},_getMDXAxis:function(){for(var e="",i=0;i<this._JSONRecords.length;i++)if(!t.isNullOrUndefined(this._JSONRecords[i].Info)&&this._JSONRecords[i].Info.toLowerCase().indexOf("measures")>-1){e=this._JSONRecords[i].CSS.indexOf("colheader")>-1?"columns":this._JSONRecords[i].CSS.indexOf("rowheader")>-1?"rows":"";break}return e},_getAxis:function(){var i,a,r;if(e(this.element).parents(".e-pivotclient").length>0&&("undefined"!=typeof pivotGridObj&&this.element.hasClass("e-pivotgrid")&&(pivotGridObj=this),this._pivotClientObj.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.setOlapReport(e(this.element).parents(".e-pivotclient").data("ejPivotClient").model.dataSource)),this.getOlapReport())if(i=null,a="",this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(this.getOlapReport()!=l&&""!=this.getOlapReport()&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0&&(i=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader),r=0;r<this._JSONRecords.length;r++)if(this._JSONRecords[r].Value==i){a=this._JSONRecords[r].CSS.indexOf("colheader")>-1?"columns":this._JSONRecords[r].CSS.indexOf("rowheader")>-1?"rows":"";break}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)a="columns";else for(r=0;r<this.getOlapReport().values.length;r++)a=this.getOlapReport().values[r].axis;return""==a&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(a=this._getMDXAxis()),a},_applyCodeBehindFormatting:function(i){var l,a,r,o,n,s,d,h;if(this._isFormatApply=!0,a=this._getAxis(),!t.isNullOrUndefined(this.model.conditionalFormatSettings))for(r=0;r<this.model.conditionalFormatSettings.length;r++)if(o=[],o=this.model.conditionalFormatSettings[r].measures.split(","),-1==e.inArray(this.model.conditionalFormatSettings[r].name,this._formatName)){for(this.model.conditionalFormatSettings[r].className=this._id+"_"+this.model.conditionalFormatSettings[r].name.trim().toLowerCase(),n=0;n<o.length;n++)for(s=[],l=o[n],d=0;d<i.length;d++)this._applyStyle(a,i[d],l,s,t.isNullOrUndefined(this.model.conditionalFormatSettings[r].value.split(",")[0])?"":this.model.conditionalFormatSettings[r].value.split(",")[0],t.isNullOrUndefined(this.model.conditionalFormatSettings[r].value.split(",")[1])?"":this.model.conditionalFormatSettings[r].value.split(",")[1],this.model.conditionalFormatSettings[r].condition,d,this.model.conditionalFormatSettings[r].className);h=this.model.conditionalFormatSettings[r].className+","+this.model.conditionalFormatSettings[r].condition+","+this.model.conditionalFormatSettings[r].style.color+","+this.model.conditionalFormatSettings[r].style.backgroundcolor+","+this.model.conditionalFormatSettings[r].style.bordercolor+","+this.model.conditionalFormatSettings[r].style.borderwidth+","+this.model.conditionalFormatSettings[r].style.fontstyle+","+this.model.conditionalFormatSettings[r].style.fontsize+","+this.model.conditionalFormatSettings[r].style.borderstyle+","+this.model.conditionalFormatSettings[r].value.split(",")[0]+","+this.model.conditionalFormatSettings[r].value.split(",")[1]+","+l,this._cFormat.push(h),this._list.push(this.model.conditionalFormatSettings[r].className),this._formatName.push(this.model.conditionalFormatSettings[r].name),this._createDynamicRule(this.model.conditionalFormatSettings[r].style.color,this.model.conditionalFormatSettings[r].style.backgroundcolor,this.model.conditionalFormatSettings[r].style.borderstyle,this.model.conditionalFormatSettings[r].style.borderwidth,this.model.conditionalFormatSettings[r].style.bordercolor,this.model.conditionalFormatSettings[r].style.fontsize,this.model.conditionalFormatSettings[r].style.fontstyle,this.model.conditionalFormatSettings[r].className)}return this._JSONRecords=i,i},_applyFormatting:function(){var i,a;this._isFormatApply=!0;var r,o,n,s,d,h,u,c,p,m,g,f,_=[],v=e("#"+this._id+"_editConText").val();if(t.isNullOrUndefined(e("#"+this._id+"_conFrom").val())||(this._formatValue1=e("#"+this._id+"_conFrom").val(),this._formatValue2=e("#"+this._id+"_conTo").val(),this.ddlConditionType._selectedValue,h=this.ddlFontColor.model.value,u=this.ddlBackColor.model.value,c=this.ddlBorderColor.model.value,p=this.ddlBorderWidth._selectedValue,m=this.ddlFont._selectedValue,g=this.ddlFontSize._selectedValue,f=this.ddlBorderStyle._selectedValue),s=this.ddlFieldValue._selectedValue!=l?this.ddlFieldValue._selectedValue:"",e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(a=0;a<this._JSONRecords.length&&(this._JSONRecords[a].Info.indexOf("Measures")>-1&&(d="colheader"==this._JSONRecords[a].CSS?"columns":"rowheader"==this._JSONRecords[a].CSS?"rows":""),""==d);a++);else for(field=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader,a=0;a<this._JSONRecords.length;a++)if(this._JSONRecords[a].Value==field){d="colheader calc"==this._JSONRecords[a].CSS?"columns":"rowheader"==this._JSONRecords[a].CSS?"rows":"";break}}else d=this._getAxis();if(this._formatEdit)r=(o=this._id+"_"+v.trim().toLowerCase())+","+this.ddlConditionType._selectedValue+","+h+","+u+","+c+","+p+","+m+","+g+","+f+","+this._formatValue1+","+this._formatValue2+","+s,this._cFormat.push(r),this._list.push(o),this._formatName.push(v),i={name:v,style:{fontcolor:h,backgroundcolor:u,bordercolor:c,borderstyle:f,borderwidth:p,fontsize:g,fontstyle:m},condition:this.ddlConditionType._selectedValue,value:this._formatValue1+","+this._formatValue2,measures:s,className:o},this.model.conditionalFormatSettings.push(i);else for(v=""!=v&&v!=l?v:this.ddlEditCondition._selectedValue,n=this.ddlEditCondition._selectedIndices[0]-1,this._formatName[n+1]=v,o=this.model.conditionalFormatSettings[n].className,this._cFormat[n]=o+","+this.ddlConditionType._selectedValue+","+h+","+u+","+c+","+p+","+m+","+g+","+f+","+this._formatValue1+","+this._formatValue2+","+s,i={name:v,style:{fontcolor:h,backgroundcolor:u,bordercolor:c,borderstyle:f,borderwidth:p,fontsize:g,fontstyle:m},condition:this.ddlConditionType._selectedValue,value:this._formatValue1+","+this._formatValue2,measures:s,className:o},this.model.conditionalFormatSettings[n]=i,a=0;a<this._JSONRecords.length;a++)this._JSONRecords[a].CSS=this._JSONRecords[a].CSS.replace(" "+o,"");for(a=0;a<this._JSONRecords.length;a++)this._applyStyle(d,this._JSONRecords[a],s,_,this._formatValue1,this._formatValue2,this.ddlConditionType._selectedValue,a,o);this._createDynamicRule(h,u,f,p,c,g,m,o),this.renderControlFromJSON(),e(this.element).parents(".e-pivotclient").length>0&&e(this.element).parents(".e-pivotclient").find(".e-dialog, .e-clientDialog").remove(),this.element.find(".e-dialog, .e-clientDialog").remove(),this._formatEdit=!1},_getResult:function(e,t,i,l){switch(l){case"Less Than":return i<e;case"Less Than Or Equal To":if(i<=e)return i;break;case"Greater Than":return i>e;case"Greater Than Or Equal To":if(i>=e)return i;break;case"Equals":if(i==e)return i;break;case"Not Equals":return i!=e;case"Between":return e<t&&i>e&&i<t||e>t&&i<e&&i>t||i==e&&i==t;case"Not Between":return!(e<t&&i>e&&i<t||e>t&&i<e&&i>t||i==e&&i==t)}},_appendCssClassName:function(e){var i,l,a,r,o,n,s,d,h,u,c=!0,p=l=i=!1,m=!1,g=a=-1;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(r="FieldHeader",o="CssClass",n=JSON.parse(this.getOlapReport()).PivotRows,s=JSON.parse(this.getOlapReport()).PivotColumns,d=JSON.parse(this.getOlapReport()).PivotCalculations):(r="fieldCaption",o="cssClass",n=this.model.dataSource.rows,s=this.model.dataSource.columns,d=this.model.dataSource.values),u=0;u<n.length&&!p;u++)t.isNullOrUndefined(n[u].cssClass)||(p=!0);for(u=0;u<s.length&&!l;u++)t.isNullOrUndefined(s[u].cssClass)||(l=!0);for(u=0;u<d.length&&!i;u++)t.isNullOrUndefined(d[u].cssClass)||(i=!0);for(h=0;h<e.length&&(p||l||i);h++){for(u=0;u<n.length&&c&&p;u++)t.isNullOrUndefined(n[u][o])||Number(e[h].Index.split(",")[0])!=u||-1!=e[h].CSS.indexOf("none")||-1!=e[h].CSS.indexOf(n[u][o])||(e[h].CSS=e[h].CSS+" "+n[u][o]),c&&e[h].CSS.indexOf("colheader")>-1&&(c=!1);for(u=0;u<s.length&&l;u++)t.isNullOrUndefined(s[u][o])||Number(e[h].Index.split(",")[1])!=u||-1!=e[h].CSS.indexOf("none")||-1!=e[h].CSS.indexOf(s[u][o])||(e[h].CSS=e[h].CSS+" "+s[u][o]);for(u=0;u<d.length&&i;u++)m&&(e[h].CSS.indexOf("colheader")>-1||e[h].CSS.indexOf("cgtot")>-1||e[h].CSS.indexOf("cstot")>-1||e[h].CSS.indexOf("gtot")>-1||e[h].CSS.indexOf("stot")>-1)&&-1==e[h].CSS.indexOf("calc")&&(m=!1),d[u][r]==e[h].Value&&(m=!0,g=e[h].Index.split(",")[0],a=u),!t.isNullOrUndefined(d[u][o])&&m&&g==e[h].Index.split(",")[0]&&a==u&&-1==e[h].CSS.indexOf(d[u][o])&&(e[h].CSS=e[h].CSS+" "+d[u][o])}}return e},_updateReportSettings:function(i){var l=e.map(i,function(e){var t=e.Key;if("JsonRecords"==t||"PivotRecords"==t)return e}),a=e.map(i,function(e){var t=e.Key;if("PivotReport"==t||"OlapReport"==t)return e}),r=e.map(i,function(e){if("SortColIndex"==e.Key)return e});this.setJSONRecords(l.length>0?l[0].Value:null),this.setOlapReport(a[0].Value),r.length>0?(t.PivotAnalysis._valueSorting=JSON.parse(r[0].Value),t.PivotAnalysis._sort=this.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null},_updatePageSettings:function(t,i){var l=e.map(t,function(e){if("PageSettings"==e.Key)return e}),a=e.map(t,function(e){if("HeaderCounts"==e.Key)return e});l.length>0&&null!=i._pagerObj&&(i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(JSON.parse(a[0].Value),JSON.parse(l[0].Value)))},_removeCells:function(i){var a,r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C,S,O,y,P=[],w=[];if(i[0]!=l&&i.length>0?(a=e.map(i,function(e){if("FilteredColumnHeaders"==e.Key)return e}),r=e.map(i,function(e){if("FilteredRowHeaders"==e.Key)return e}),a.length>0&&(P=JSON.parse(a[0].Value)),r.length>0&&(w=JSON.parse(r[0].Value))):i.d!=l?(a=e.map(i.d,function(e){if("FilteredColumnHeaders"==e.Key)return e}),r=e.map(i.d,function(e){if("FilteredRowHeaders"==e.Key)return e}),a.length>0&&(P=JSON.parse(a[0].Value)),r.length>0&&(w=JSON.parse(r[0].Value))):(i.FilteredColumnHeaders&&(P=JSON.parse(i.FilteredColumnHeaders)),i.FilteredRowHeaders&&(w=JSON.parse(i.FilteredRowHeaders))),P.length>0){for(T=P,f=0;f<T.length;f++)for(_=T[f].From;_<=T[f].To;_++)for(c=T[f].Level;c<this._rowCount;c++)this.element.find(".e-pivotGridTable  [data-p='"+_+","+c+"']").remove();for(o=(r=this.element.find(".e-pivotGridTable thead").children()).length-2;o>=0;o--)for(n=e(r[o]).find("th.colheader:visible"),s=0;s<=n.length-1;s++){for(d=e(n[s]).attr("colSpan"),c=0;c<=parseInt(e(n[s]).attr("colSpan"))-1;c++)h=parseInt(e(n[s]).attr("data-p").split(",")[0])+c,u=this.element.find(".e-pivotGridTable  [data-p='"+h+","+(o+1)+"']:visible"),e(u).length>0?d=parseInt(d)+(e(u).attr("colspan")?parseInt(e(u).attr("colspan"))-1:0):d--;if(0==d&&e(n[s]).nextAll(".summary.stot:eq(0)").length>0){var N=e(n[s]).nextAll(".summary.stot:eq(0)").attr("data-p").split(",")[0],x=[],T=[];for(c=0;c<this._rowCount;c++){if(p="[data-p='"+parseInt(N)+","+c+"'] ",T.push(p),this._JSONRecords[parseInt(N)*this._rowCount+c].ColSpan>1&&this.element.find(".e-pivotGridTable [data-p='"+parseInt(N)+","+c+"']:visible").length>0)for(m=1;m<=this._JSONRecords[parseInt(N)*this._rowCount+c].ColSpan-1;m++)x.push(parseInt(N)+m);for(hc=0;hc<x.length;hc++)p+=", [data-p='"+x[hc]+","+c+"'] ";this.element.find(".e-pivotGridTable "+p).remove()}}t.isNullOrUndefined(e(n[s]).attr("vfColSpan"))&&e(n[s]).attr("vfColSpan",e(n[s]).attr("colSpan")),e(n[s]).attr("colSpan",d)}this.element.find(".colheader[colspan='0']:not(.gtot,.calc)").remove()}if(w.length>0){for(T=w,g=parseInt(this.element.find(".e-pivotGridTable td:eq(0)").attr("data-p").split(",")[0])-2,f=0;f<T.length;f++)for(_=T[f].From;_<=T[f].To;_++)this.element.find(".e-pivotGridTable tr:eq("+_+") th:last").css("display","none"),this.element.find(".e-pivotGridTable tr:eq("+_+") td").css("display","none");for(y=g;y>=0;y--)for(v=this.element.find(".e-pivotGridTable tbody").find(" .rowheader[data-p^='"+y+",'] :visible"),b=this.element.find(".e-pivotGridTable th.rowheader").parent(),C=0;C<=v.length;C++){var M=e(v[C]).parent(),L=parseInt(M.attr("rowSpan")),D=M.attr("data-p");if(D){var I=parseInt(D.split(",")[1]),j=(parseInt(D.split(",")[0]),0);for(S=I;S<=I+L;S++)(O=b.children(" [data-p='"+(y+1)+","+S+"']")).length>0&&!O.is(":visible")&&(j=j+parseInt(O.attr("rowSpan"))+(O.next("th.rowheader").length>0||parseInt(O.attr("rowSpan"))>1?1:0));j==L&&M.css("display","none")}}for(y=0;y<e(this.element.find(".summary.stot")).length;y++)""==e(this.element.find(".summary.stot")[y]).nextAll().text()&&(e(this.element.find(".summary.stot")[y]).css("display","none"),e(this.element.find(".summary.stot")[y]).nextAll().css("display","none"))}this.model.enableGroupingBar&&this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())},saveXMLReport:function(e,t){var i={clientReports:JSON.parse(this.getOlapReport()).Report,fileName:e};this.doPostBack(t,i)},_reportModelUpdate:function(i){t.isNullOrUndefined(i)||(this.model.enableGrandTotal=i.ShowGrandTotals,this.model.enableCollapseByDefault=i.enableCollapseByDefault,i.ShowSubTotals||(e.each(i.PivotRows,function(e,t){t.showSubTotal=!1}),e.each(i.PivotColumns,function(e,t){t.showSubTotal=!1})),this.setOlapReport(JSON.stringify(i)),this.model.enableColumnResizing=i.AllowResizeColumns,this.model.resizeColumnsToFit=i.ResizePivotGridToFit,this.model.enableCellSelection=i.AllowSelection,this.model.enableDeferUpdate=i.DeferLayoutUpdate,this.model.frozenHeaderSettings.enableFrozenHeaders=i.FreezeHeaders,this.model.enableGroupingBar=i.ShowGroupingBar,this.model.enablePivotFieldList=i.ShowFieldList,this.model.collapsedMembers={},this.model._isXMLImport=!1)},_renderControlSuccess:function(i){var a,r,o,n,s,d,h,u,c,p,m;try{if(i[0]!=l&&i.length>0?(this._updateReportSettings(i),null!=i[2]&&i[2]!=l&&("PageSettings"==i[2].Key&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[3].Value).Column/JSON.parse(i[2].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[3].Value).Row/JSON.parse(i[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[2].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i[2].Value).SeriesPageSize):null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&null!=this._pagerObj&&this._pagerObj.initPagerProperties(JSON.parse(i[3].Value),JSON.parse(i[2].Value)),t.isNullOrUndefined(i[4])||("DataSet"==i[4].Key?(this._dataSet=i[4].Value,t.isNullOrUndefined(i[5])||(this.model.customObject=i[5].Value)):this.model.customObject=i[4].Value))),t.isNullOrUndefined(i[2])||("DataSet"==i[2].Key?(this._dataSet=i[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i[3].Value)):this.model.customObject=i[2].Value),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._updatePageSettings(i,this._pivotClientObj)):i.d!=l&&i.d.length>0?(this._updateReportSettings(i.d),null!=i.d[2]&&i.d[2]!=l?"PageSettings"==i.d[2].Key&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[3].Value).Column/JSON.parse(i.d[2].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[3].Value).Row/JSON.parse(i.d[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[2].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[2].Value).SeriesCurrentPage):null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this._pagerObj.initPagerProperties(JSON.parse(i.d[3].Value),JSON.parse(i.d[2].Value)),t.isNullOrUndefined(i.d[4])||("DataSet"==i.d[4].Key?(this._dataSet=i.d[4].Value,t.isNullOrUndefined(i.d[5])||(this.model.customObject=i.d[5].Value)):this.model.customObject=i.d[4].Value),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._updatePageSettings(i.d,this._pivotClientObj)):t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||2!=i.d.length||(this._pivotClientObj._pagerObj.element.css("opacity","0.5"),this._pivotClientObj._pagerObj.element.find(".e-pagerTextBox").attr("disabled","disabled"),this._pivotClientObj._pagerObj._unwireEvents()),t.isNullOrUndefined(i[2])||"PageSettings"==i.d[2].Key||("DataSet"==i.d[2].Key?(this._dataSet=i.d[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i.d[3].Value)):this.model.customObject=i.d[2].Value)):!t.isNullOrUndefined(i)&&t.isNullOrUndefined(i.d)&&(i.SortColIndex!=l?(t.PivotAnalysis._valueSorting=JSON.parse(i.SortColIndex)[0],t.PivotAnalysis._sort=this.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null,i.PivotRecords!=l?(this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),i.HeaderCounts!=l&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling)?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):i.HeaderCounts!=l&&null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l?this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)):i.HeaderCounts==l||t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))):i.JsonRecords!=l&&1==this.model.enableJSONRendering?(this.setJSONRecords(JSON.stringify(i.JsonRecords)),this.setOlapReport(JSON.stringify(i.PivotReport)),null!=i.DataSet&&(this._dataSet=i.DataSet)):i.JsonRecords!=l?(this.setJSONRecords(i.JsonRecords),this.setOlapReport(i.PivotReport),null!=i.DataSet&&(this._dataSet=i.DataSet)):i.JsonRecords==l&&(this.setJSONRecords(null),i.PivotReport&&this.setOlapReport(i.PivotReport),i.OlapReport&&this.setOlapReport(i.OlapReport)),i.isXMLLoad!=l&&(this.model._isXMLImport=i.isXMLLoad),null!=i.customObject&&i.customObject!=l&&(this.model.customObject=i.customObject)),t.isNullOrUndefined(this.getJSONRecords())&&!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enablePaging&&(a={CategoricalCurrentPage:1,CategoricalPageSize:1,SeriesCurrentPage:1,SeriesPageSize:1},r={Column:1,Row:1},this._pivotClientObj._pagerObj.initPagerProperties(r,a)),(this.model.enableVirtualScrolling||null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l)&&this.layout("nosummaries"),this.getOlapReport()!=l&&""!=this.getOlapReport()&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)try{t.isNullOrUndefined(JSON.parse(this.getOlapReport()).DataModel)||(this.model.analysisMode="Olap"==JSON.parse(this.getOlapReport()).DataModel?t.Pivot.AnalysisMode.Olap:t.Pivot.AnalysisMode.Pivot),!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PagerOptions)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.enablePaging||this.model.enableVirtualScrolling)&&(this._categPageCount=this.model.enablePaging?JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageCount:Math.ceil(JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageCount/JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageSize),this._seriesPageCount=this.model.enablePaging?JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageCount:Math.ceil(JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageCount/JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageSize),this.model.dataSource.pagerOptions.categoricalPageSize=JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageSize,this.model.dataSource.pagerOptions.seriesPageSize=JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageSize,this.model.dataSource.pagerOptions.categoricalCurrentPage=JSON.parse(this.getOlapReport()).PagerOptions.CategoricalCurrentPage,this.model.dataSource.pagerOptions.seriesCurrentPage=JSON.parse(this.getOlapReport()).PagerOptions.SeriesCurrentPage),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&null!=this._pagerObj&&(o=this,n=setInterval(function(){clearInterval(n);var e={CategoricalCurrentPage:o.model.dataSource.pagerOptions.categoricalCurrentPage,CategoricalPageSize:o.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:o.model.dataSource.pagerOptions.seriesCurrentPage,SeriesPageSize:o.model.dataSource.pagerOptions.seriesPageSize},t={Column:o._categPageCount,Row:o._seriesPageCount};o._pagerObj.element.css("opacity","1"),o._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),o._pagerObj._unwireEvents(),o._pagerObj._wireEvents(),o._pagerObj.initPagerProperties(t,e)},10))}catch(e){}if(i.isXMLLoad!=l&&i.isXMLLoad&&this._reportModelUpdate(t.isNullOrUndefined(this.getOlapReport())?null:JSON.parse(this.getOlapReport())),1==this.model.enableGroupingBar&&(u=JSON.parse(this.getOlapReport()),s=t.isNullOrUndefined(u.ItemsProperties)?[]:JSON.parse(u.ItemsProperties),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(d=u.PivotRows.concat(u.PivotColumns,u.PivotCalculations,u.Filters),h=e.grep(s,function(t){return e.grep(d,function(e){t.id==(e.FieldHeader||e.DimensionHeader)&&(t.id=e.FieldName||e.DimensionName)}),t}),this._pivotTableFields=h):this._pivotTableFields=s,this._createGroupingBar(u)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(u=JSON.parse(this.getOlapReport()),c=0;c<u.PivotCalculations.length;c++)(8==u.PivotCalculations[c].CalculationType||"Formula"==u.PivotCalculations[c].CalculationType)&&0==e.grep(this._calculatedField,function(e){return e.name==u.PivotCalculations[c].FieldName}).length&&this._calculatedField.push({name:u.PivotCalculations[c].FieldName,formula:u.PivotCalculations[c].Formula});null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),null!=this.getJSONRecords()&&this.getJSONRecords().length>0?this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&0==this.model.enableVirtualScrolling&&null==e(".e-pivotpager")[0]?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords()):this.renderControlFromJSON(""),p=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,t.isNullOrUndefined(p)||(p._isTimeOut=!1),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup?this._waitingPopup.hide():e("#"+this._pivotClientObj._id+"_maxView")[0]&&this._maxViewLoading?this._maxViewLoading.hide():this._pivotClientObj._waitingPopup.hide(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&null!=this._schemaData&&this._schemaButtonCreate(),m={action:"initialize",customObject:this.model.customObject,element:this.element},this._trigger("renderSuccess",m),t.isNullOrUndefined(i.Exception)||t.Pivot._createErrorDialog(i,"Exception",this),this.model.enableAdvancedFilter&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._removeCells(i)}catch(e){}},_hideGrandTotal:function(i){var a,r,o,n,s,d,h,u,c,p,m,g,f,_,v=i.find(".pivotGridFrozenTable");if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.enableRowGrandTotal&&this.model.enableGrandTotal||((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders)&&i.find(".valueCell tr:last,.rowhead tr:last").hide(),i.find("tbody").children().length>0&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?i.find("tr:last .gtot").parent().hide():i.find("tr:last .rgtot").parent().hide())),!(i.find("tr:first th.summary").attr("data-p")==l&&i.find(".pivotGridFrozenTable tr:first td.summary").attr("data-p")==l||this.model.enableColumnGrandTotal&&this.model.enableGrandTotal||this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot))for(a=[],a=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?v.find(".gtot[role^='columnheader']"):v.find(".cgtot[role^='columnheader']"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i.find("th.gtot[role^='columnheader']"):i.find("th.cgtot[role^='columnheader']"),r=0;r<a.length;r++)i.find('[data-p^="'+parseInt(e(a[r]).attr("data-p").split(",")[0])+',"]').hide(),i.find('[data-p^="'+parseInt(e(a[r]).attr("data-p").split(",")[0])+',"]').hide()}else if(o=!0,n=0,this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.analysisMode==t.Pivot.AnalysisMode.Olap){if((!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&((d=e(i).find("thead tr").length||e(i).find(".pivotGridFrozenTable tr").length)>1||1==d&&e(i).find("th.summary[data-p$=',"+n+"']").length>0)){for(;o;)(s=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(i).find("td.summary[data-p$=',"+n+"']"):e(i).find("th.summary[data-p$=',"+n+"']")).length&&(o=!1),n++;for(m=0;m<s.length;m++){var b=n,C=s[m],S=e(C).attr("data-p"),O=parseInt(S.split(",")[1])-1,y=e(C).attr("colspan");e(i).find("thead tr").length,e(i).find("tbody tr").length;for(h=0;h<parseInt(y);h++)e(i).find(" [data-p^='"+(parseInt(S.split(",")[0])+h)+",']").css("display","none");for(u=0;u<d;u++)this.model.frozenHeaderSettings.enableFrozenHeaders?1==e(v).find("tr:eq("+u+") td").length&&(c=e(v).find(" tr:eq("+u+") td").attr("colspan"),e(v).find(" tr:eq("+u+") td").attr("colspan",parseInt(c)-parseInt(y))):1==e(i).find("thead tr:eq("+u+") th").length&&(c=e(i).find("thead tr:eq("+u+") th").attr("colspan"),e(i).find("thead tr:eq("+u+") th").attr("colspan",parseInt(c)-parseInt(y)));if(O>=0)for(f=e(i).find(" [data-p^='"+S.split(",")[0]+","+O+"']")[0];b>1;){if(t.isNullOrUndefined(f))for(O=parseInt(S.split(",")[1])-1;O>=0;O--){if(_=e(i).find("[data-p='"+S.split(",")[0]+","+O+"']")[0],t.isNullOrUndefined(_))for(k=parseInt(S.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(_)&&(_=e(i).find("[data-p='"+k+","+O+"']")[0]);!t.isNullOrUndefined(_)&&"none"!=e(_).css("display")&&"none"!=e(e(_).parents("tr")[0]).css("display")&&(e(_).hasClass("rowheader")||"rowheader"==e(_).attr("role")||e(_).hasClass("colheader")||"columnheader"==e(_).attr("role")||e(_).hasClass("value")||"gridcell"==e(_).attr("role"))&&(f=_),set_spn=parseInt(e(_).attr("colspan"))-parseInt(y),e(_).attr("colspan",set_spn)}t.isNullOrUndefined(_)||b--}}}if(o=!0,n=0,s="",!this.model.enableRowGrandTotal||!this.model.enableGrandTotal){if(p=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,(d=e(i).find("tbody tr").length)>1||1==d&&"summary"==e(i).find(p?"":"th[data-p^='"+n+",']"))for(d=e(i).find("tbody tr").length;o;)(s=p?e(i).find("td.summary[data-p^='"+n+",']"):e(i).find("th.summary[data-p^='"+n+",']")).length&&(o=!1),n++;if(d>0)for(m=0;m<s.length;m++){b=n,C=s[m],S=e(C).attr("data-p"),O=parseInt(S.split(",")[0])-1;var P=e(C).attr("rowspan"),w=e(C).parent();for(g=0;g<C.rowSpan;g++)e(w).css("display","none"),p&&e(i).find(".pivotGridValueTable tr:eq("+e(w).index()+")").css("display","none"),w=e(w).next();if(O>=0)for(f=e(i).find(" [data-p^='"+O+","+S.split(",")[1]+"']")[0];b>1;){if(t.isNullOrUndefined(f))for(O=parseInt(S.split(",")[0])-1;O>=0;O--){if(_=e(i).find("[data-p='"+O+","+S.split(",")[1]+"']")[0],t.isNullOrUndefined(_))for(k=parseInt(S.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(_)&&(_=e(i).find("[data-p='"+O+","+k+"']")[0]);!t.isNullOrUndefined(_)&&"none"!=e(_).css("display")&&"none"!=e(e(_).parents("tr")[0]).css("display")&&(e(_).hasClass("rowheader")||"rowheader"==e(_).attr("role")||e(_).hasClass("colheader")||"columnheader"==e(_).attr("role")||e(_).hasClass("value")||"gridcell"==e(_).attr("role"))&&(f=_),set_spn=parseInt(e(_).attr("rowspan"))-parseInt(P),e(_).attr("rowspan",set_spn)}t.isNullOrUndefined(_)||b--}}}}},_hideSubTotal:function(i,a,r){var o,n,s,d,h,u,c,p,m,g;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){var f,_={},v=!1,b={},C=!1,S=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows:JSON.parse(this.getOlapReport()).PivotRows,O=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns,y=i[0].querySelectorAll("tbody th.rowheader"),P=i[0].querySelectorAll("thead th, tbody td");for(s=0;s<S.length;s++)0==S[s].showSubTotal&&(v=!0);if(1==v)for(u=0;u<y.length;u++)_[e(y[u]).attr("data-p")]=y[u];for(s=0;s<O.length;s++)0==O[s].showSubTotal&&(C=!0);if(1==C)for(u=0;u<P.length;u++)b[e(P[u]).attr("data-p")]=P[u]}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(S=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows:JSON.parse(this.getOlapReport()).PivotRows,O=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns,!t.isNullOrUndefined(S))for(s=0;s<S.length;s++)if(0==S[s].showSubTotal)if(o=s.toString(),"row"==e(i).attr("role")&&e(i).parent().is("tbody")){if(0==e(i).find(".stot,.rstot").length||this._isSubTotalhidden&&e(i).find(".stot,.rstot").find(".e-expand").length>=1||e(i).find(".stot,.rstot").attr("data-p").split(",")[0]==o&&1==a&&e(i).find(".stot,.rstot").find(".e-expand").length>=1)break;if(e(i).find(".stot,.rstot").attr("data-p").split(",")[0]==o){e(r).parent().attr("data-p").split(",")[0]==o&&(this._isSubTotalhidden=!0),this._isSubTotalHide=!0;break}}else if(e(i).find("tbody").length>0&&(f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?i.find('.summary.rstot[data-p^="'+s+',"]'):i.find('.summary.stot[data-p^="'+s+',"]')).length>0)for(n=0;n<f.length;n++){var w=e(f[n]).closest("tr"),N=e(w).find(".stot,.rstot").attr("data-p"),x=parseInt(N.split(",")[0])-1,T=parseInt(e(w).find(".stot,.rstot").attr("rowspan"));for(e(w).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders)&&e(i).find(".valueCell td[data-p$=',"+N.split(",")[1]+"']").closest("tr").css("display","none"),F=parseInt(N.split(",")[1]);x>=0;){for(g=null;t.isNullOrUndefined(g)&&F>=0;){if(g=_[x+","+F],!t.isNullOrUndefined(g)&&"none"!=e(e(g).closest("tr")[0]).css("display")&&e(g).hasClass("rowheader")&&"rowheader"==e(g).attr("role")&&parseInt(e(g).attr("data-p").split(",")[0])<parseInt(N.split(",")[0])&&parseInt(e(g).attr("data-p").split(",")[1])+g.rowSpan+(e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag")):0)>=parseInt(N.split(",")[1])+T){g.rowSpan-=1,e(g).find("span").attr("data-tag",e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag"))+1:1);break}F--}x--}}if(!t.isNullOrUndefined(O))for(s=0;s<O.length;s++)if(0==O[s].showSubTotal)if(d=s.toString(),(e(i).hasClass("stot")||e(i).hasClass("cstot"))&&"columnheader"==e(i).attr("role")){if(this._isSubTotalhidden&&e(i).find(".stot,.cstot").find(".e-expand").length>=1||e(i).attr("data-p").split(",")[1]==d&&1==a&&e(i).find(".e-expand").length>=1)break;if(e(i).attr("data-p").split(",")[1]==d){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if("row"==e(i).attr("role")&&((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&e(i).parent().is("tbody")||e(i).parent().is("thead"))){if(0==e(i).find(".stot,.cstot").length||this._isSubTotalhidden&&e(i).find(".stot,.cstot").find(".e-expand").length>=1||e(i).find(".stot,.cstot").attr("data-p").split(",")[1]==d&&1==a&&e(i).find(".stot,.cstot").find(".e-expand").length>=1)break;if(e(i).find(".stot,.cstot").attr("data-p").split(",")[1]==d){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if((e(i).find("thead").length>0||e(i).find(".colhead").length>0)&&(f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?i.find('td.summary.cstot[data-p$=",'+s+'"]'):i.find('th.summary.cstot[data-p$=",'+s+'"]'):this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders?i.find('td.summary.stot[data-p$=",'+s+'"]'):i.find('th.summary.stot[data-p$=",'+s+'"]')).length>0)for(h=f,u=0;u<h.length;u++){var M=e(h[u]),L=e(i),D=(N=e(h[u]).attr("data-p"),e(h[u]).closest("tr")[0]),I=parseInt(N.split(",")[0]),j=(T=parseInt(e(h[u]).attr("rowspan")),parseInt(e(h[u]).attr("colspan"))),F=parseInt(N.split(",")[1])-1;for(c=0;c<j;c++){for(p=e(D).nextAll().find("[data-p^='"+(c+I)+",']"),m=0;m<e(p).length;m++)e(p[m]).css("display","none");(e(p[m]).attr("data-hc")==l||parseInt(e(p[m]).attr("data-hc"))<1)&&(e(L).find("[data-p^='"+(c+I)+",']").css("display","none"),e(L).find("[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(c+I)+",']").attr("data-ch",1))}for(e(M).css("display","none"),x=parseInt(N.split(",")[0]);F>=0;){for(g=null;t.isNullOrUndefined(g)&&x>=0;){if(g=b[x+","+F],!t.isNullOrUndefined(g)&&"none"!=e(e(g).closest("tr")[0]).css("display")&&e(g).hasClass("colheader")&&"columnheader"==e(g).attr("role")&&parseInt(e(g).attr("data-p").split(",")[1])<parseInt(N.split(",")[1])&&parseInt(e(g).attr("data-p").split(",")[0])<=parseInt(N.split(",")[0])&&parseInt(e(g).attr("data-p").split(",")[0])+g.colSpan+(e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag")):0)>=parseInt(N.split(",")[0])+j){g.colSpan-=j,e(g).find("span").attr("data-tag",e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag"))+j:j);break}x--}F--}}}},_filterReport:function(e){for(var i,l=0;l<e.Filters.length;l++)if(e.PivotColumns.length>=1)for(i=0;i<e.PivotColumns.length;i++)0==e.Filters.length||t.isNullOrUndefined(e.Filters[l])||e.Filters[l].Tag!=e.PivotColumns[i].FieldName||(e.Filters.splice(l,1),l=-1);for(l=0;l<e.Filters.length;l++)if(e.PivotRows.length>=1)for(i=0;i<e.PivotRows.length;i++)0==e.Filters.length||t.isNullOrUndefined(e.Filters[l])||e.Filters[l].Tag!=e.PivotRows[i].FieldName||(e.Filters.splice(l,1),l=-1);for(l=0;l<e.Filters.length;l++)if(e.PivotCalculations.length>=1)for(i=0;i<e.PivotCalculations.length;i++)0==e.Filters.length||t.isNullOrUndefined(e.Filters[l])||e.Filters[l].Tag!=e.PivotCalculations[i].FieldName||(e.Filters.splice(l,1),l=-1);return e},_createGroupingBar:function(e){var i;this._pivotFilter=this._getLocalizedLabels("DragFieldHere"),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(e=this._filterReport(e),i=this._createPivotButtons(null!=this._pivotFilter&&e.Filters.length>1&&e.Filters[0].Tag==e.Filters[1].Tag?e.Filters.slice(1):e.Filters,"filter")):i=this._createPivotButtons(null!=this._pivotFilter&&e.filters.length>0?e.filters:"","filter"),this._pivotFilter=i,this._pivotRow=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotRows:e.rows,"row"),this._pivotColumn=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotColumns:e.columns,"column"),this._pivotCalculation=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotCalculations:e.values,"values"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&e.values.length>0&&e.values[0].measures&&("columns"==e.values[0].axis&&e.values[0].measures.length>0?this._pivotColumn=this._pivotColumn+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"column"):"rows"==e.values[0].axis&&e.values[0].measures.length>0&&(this._pivotRow=this._pivotRow+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"row")))},_contextOpen:function(e){t.Pivot._contextMenuOpen(e,this)},_pivotContextClick:function(i){var l,a;if(i.text!=this._getLocalizedLabels("CalculatedField"))if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var r=i.text==this._getLocalizedLabels("AddToColumn")?"column":i.text==this._getLocalizedLabels("AddToRow")?"row":i.text==this._getLocalizedLabels("AddToValues")?"value":i.text==this._getLocalizedLabels("AddToFilter")?"filter":"",o=e(this._selectedMember).attr("data-fieldName"),n={droppedFieldName:o,droppedFieldCaption:e(this._selectedMember).text(),droppedClass:r,droppedPosition:"",isMeasuresDropped:0==o.toLocaleLowerCase().indexOf("measures")};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&"values"!=r&&(this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField||1==e.isCalculatedField&&-1==e.formula.indexOf(n.droppedFieldName)})),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this)),t.Pivot.addReportItem(this.model.dataSource,n),this.refreshControl(),t.isNullOrUndefined(this._schemaData)||this._schemaData._refreshPivotButtons()}else l=i.text==this._getLocalizedLabels("AddToColumn")?this.element.find(".columns"):i.text==this._getLocalizedLabels("AddToRow")?0==this.element.find(".e-grpRow").length?this.element.find(".emptyRows").addClass("e-grpRow"):this.element.find(".e-grpRow"):i.text==this._getLocalizedLabels("AddToValues")?this.element.find(".values"):i.text==this._getLocalizedLabels("AddToFilter")?this.element.find(".e-drag"):"",a={element:this._selectedMember,target:l,cancel:!1},this._pvtBtnDropped(a);else this._createCalculatedField()},_getAdvancedFilterInfo:function(i){var l=[];return this._excelFilterInfo.length>0&&(i,l=e.grep(this._excelFilterInfo,function(e){try{if(e.levelUniqueName.replace(/]/g,"").replace(/\[/g,"").indexOf(i)>-1&&!t.isNullOrUndefined(e.operator))return e}catch(e){}})),l},_createPivotButtons:function(i,a){var r,o,n,s,d,h,u,c,p,m,g=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode;if(!t.isNullOrUndefined(i)){var f="",_="column"==a?"Columns":"row"==a?"Rows":"filter"==a?"Slicers":"Values",v="";if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)for("values"==(_="column"==a?"Columns":"row"==a?"Rows":"filter"==a?"filters":"values")&&g&&(i=e.map(i,function(e){return e.measures})),s=0;s<i.length;s++){v=i[s].fieldCaption;var b=g?"":t.PivotAnalysis.getMembers(i[s].fieldName),C=t.Pivot.getReportItemByFieldName(i[s].fieldName,this.model.dataSource),S=null!=i[s].filterItems&&i[s].filterItems.values.length>0||!t.isNullOrUndefined(i[s].advancedFilter)&&i[s].advancedFilter.length>0&&C.item&&"filters"!=C.axis?"filtered":"";"filter"==a&&("filtered"==S?v=t.Pivot._getFilterState(g,b,i[s],this):g?(t.olap._mdxParser.getAllMember(this.model.dataSource,i[s].fieldName,this),v=this._allMember):v=this._getLocalizedLabels("All")),r=g?"":i[s].sortOrder==t.PivotAnalysis.SortOrder.Descending?"descending":"",o=(i[s].fieldName||i[s]).replace(/[\(\)\[\]{}'"]/g,"").replace(/[\W]/g,"_"),f+=t.buildTag("span.e-pivotButton",t.buildTag("button.e-pvtBtn#pivotButton_"+o,(this.model.showUniqueNameOnPivotButton&&"values"!=a?i[s].fieldName.replace(/\[/g,"").replace(/\]/g,""):i[s].fieldCaption==l?i[s].fieldName:i[s].fieldCaption||i[s])+("filter"==a?" ("+v+")":""),{},{"data-fieldName":i[s].fieldName,"data-fieldCaption":i[s].fieldCaption,"data-axis":_})[0].outerHTML+(!g||"measures"!=i[s].fieldName.toLowerCase()&&(t.isNullOrUndefined(i[s].isNamedSet)||i[s].isNamedSet)?t.buildTag("span.filter e-icon "+S).attr("role","button").attr("aria-label","filter")[0].outerHTML:"")+(g?" ":t.buildTag("span.e-sorting e-icon "+r).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML)+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",_+":"+i[s].fieldName||i[s])[0].outerHTML}else for("Values"==_&&"values"==a&&(n=this.element.find(".e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?this.element.find(".e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").parent()[0].className.split(" ")[0]:"e-schemaColumn",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(_="e-schemaColumn"==n||"columns"==n?"Columns":"Rows")),s=0;s<i.length;s++){for(d=this._ascdes.split("##"),h=0,r="",S="",u=0;u<d.length;u++)(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&d[u]==i[s].Tag||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&d[u]==i[s])&&(h=1);if(1==h&&(r="descending"),!t.isNullOrUndefined(this._tempFilterData))for(u=0;u<this._tempFilterData.length;u++)for(c in this._tempFilterData[u])this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?c==(i[s].FieldName||i[s].DimensionName)&&""!=this._tempFilterData[u][i[s].FieldName||i[s].DimensionName]&&(S="filtered"):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&c==(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i[s].Tag:i[s])&&0!=this._tempFilterData[u][i[s].Tag].indexOf("FILTERED")&&(S="filtered");this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(i[s].FieldHeader="Measures"==i[s].FieldHeader?this._getLocalizedLabels("Measures"):i[s].FieldHeader,S="filter"!=a&&this.model.enableAdvancedFilter&&this._getAdvancedFilterInfo(i[s].Tag).length>0?"filtered":S,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(p=t.isNullOrUndefined(this._tempFilterData)?[]:e.map(this._tempFilterData,function(e){return e[i[s].DimensionName]}),"filter"==a&&(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableAdvancedFilter&&this._getAdvancedFilterInfo(i[s].Tag).length>0&&(S="filtered"),v=p.length>0&&S&&this._fieldMembers[i[s].DimensionName]?this._fieldMembers[i[s].DimensionName].length-p.length==1?this._fieldMembers[i[s].DimensionName].filter(function(e){if(-1==p.indexOf(e))return e}):this._getLocalizedLabels("MultipleItems"):this._getLocalizedLabels("All"))):"filter"==a&&(v=("All"==this._fieldSelectedMembers[i[s].Tag]?i[s].AllMember:this._fieldSelectedMembers[i[s].Tag])||i[s].AllMember),m="Measures"==i[s].FieldHeader||"Measures"==i[s].Tag||i[s].Tag.indexOf("::NAMEDSET")>-1?"":t.buildTag("span.filter e-icon "+S).attr("role","button").attr("aria-label","filter")[0].outerHTML,f+=t.buildTag("span.e-pivotButton",t.buildTag("span.e-dropIndicator")[0].outerHTML+t.buildTag("button.e-pvtBtn#pivotButton"+i[s].FieldHeader||i[s].FieldName||i[s].Name||i[s].DimensionHeader||i[s].DimensionName,(this.model.showUniqueNameOnPivotButton&&"values"!=a?i[s].Tag:i[s].FieldHeader||i[s].FieldName||i[s].Name||i[s].DimensionHeader||i[s].DimensionName)+("filter"==a?" ("+v+")":""),{},this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?{"data-fieldName":i[s].FieldName||i[s].DimensionName||i[s].FieldHeader||i[s].DimensionHeader,"data-fieldCaption":i[s].FieldHeader||i[s].DimensionHeader||i[s].FieldName||i[s].DimensionName}:{"data-fieldCaption":i[s].FieldHeader})[0].outerHTML+m+t.buildTag("span.e-sorting e-icon "+r).attr("role","button").attr("aria-label","sort")[0].outerHTML+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",_+":"+i[s].Tag)[0].outerHTML):f+=t.buildTag("span.e-pivotButton",t.buildTag("span.e-dropIndicator")[0].outerHTML+t.buildTag("button.e-pvtBtn#pivotButton"+i[s],i[s])[0].outerHTML+t.buildTag("span.filter e-icon "+S).attr("role","button").attr("aria-label","filter")[0].outerHTML+t.buildTag("span.e-sorting e-icon "+r).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",_+":"+i[s])[0].outerHTML}return f}},_createFields:function(){var i,l,a,r,o,n,s,d,h,u,c,p,m,g;if(this.element.find(".groupingBarPivot").remove(),this.model.enableVirtualScrolling&&this.element.find(".virtualScrollGrid").length>0?this.element.find(".virtualScrollGrid").prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML):this.element.prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.valueColumn",t.buildTag("span.values").attr("aria-label","values")[0].outerHTML+t.buildTag("span.columns").attr("aria-label","column")[0].outerHTML,{width:"100%"})),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.e-drag",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("DragFieldHere"),{width:"100%"}).attr("aria-label","filter")[0].outerHTML),""!=this._pivotFilter&&null!=this._pivotFilter&&this.element.find(".e-drag").text("").attr("aria-label","filter"),this.element.find(".e-drag").append(this._pivotFilter),this.element.find(".values").append(this._pivotCalculation),this.element.find(".columns").append(this._pivotColumn),0==this.element.find(".values .e-pivotButton").length&&this.element.find(".values").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ValueArea")),0==this.element.find(".columns .e-pivotButton").length&&this.element.find(".columns").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ColumnArea")),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&0==this.element.find(".e-rows").length&&!t.isNullOrUndefined(this.getJSONRecords())&&this.getJSONRecords().length>0&&"colheader"==this.getJSONRecords()[0].CSS?(this.element.find(".e-pivotGridTable thead tr:first").prepend(t.buildTag("th.e-grpRow",t.buildTag("div.e-rows",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))[0].outerHTML,{},{rowspan:this.element.find("thead tr").length})[0].outerHTML),this.element.find(".e-pivotGridTable tbody tr:first").prepend(t.buildTag("td.rowheader",this._getLocalizedLabels("Total"))[0].outerHTML)):0==this.element.find(".e-rows .e-pivotButton").length&&(this.element.find(".e-rows").text("").children("span").remove(),this.element.find(".e-rows").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))),(0==this.element.find(".rowheader").length&&0==this.element.find(".colheader").length&&0==this.element.find(".values .e-pivotButton").length||0==this.element.find(".e-pivotGridTable th").length)&&(i=t.buildTag("div.emptyRows",t.buildTag("span.e-rows",""!=this._pivotRow?this._pivotRow:this._getLocalizedLabels("RowArea"),{width:"5px"})[0].outerHTML,{width:140})[0].outerHTML,0==this.element.find(".e-rows").length&&this.element.find(".groupingBarPivot").append(i),this.model.enableDeferUpdate&&""!=this._pivotRow&&(this.element.find(".e-rows").text(""),this.element.find(".e-rows").append(this._pivotRow)),(null==this.getJSONRecords()||0==this.getJSONRecords().length)&&this.element.find(".groupingBarPivot").addClass("emptyPivotGrid"),this.element.find(".emptyRows,.e-rows").ejDroppable({})),this.element.find(".values").find(".filter").remove(),this.element.find(".values").find(".e-sorting").remove(),this.element.find(".e-drag").find(".e-sorting").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".e-pivotButton").find(".e-sorting").remove(),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.element.find(".e-rows").width(this.element.find(".pivotGridRowTable").width()),this._setGroupingBarFrozenRowBtnWidth()),this.element.find(".e-pivotButton .e-pvtBtn").ejButton({size:"normal",type:t.ButtonType.Button}).ejDraggable({handle:"button",clone:!0,cursorAt:{left:-5,top:-5},dragStart:t.proxy(function(){this._isDragging=!0},this),dragStop:t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._clientPvtBtnDropped:this._pvtBtnDropped,this),helper:t.proxy(function(t){return e(t.element).parent().addClass("dragHover"),e(t.element).addClass("dragHover"),t.sender.target.className.indexOf("e-btn")>-1&&e(t.sender.target).clone().addClass("dragClone").appendTo(this.element)},this)}),t.browserInfo().name.indexOf("moz")>-1&&(this.element.find(".columns .e-btn, .e-rows .e-btn").addClass("e-pvtBtnIndent"),this.element.find(".columns .e-sorting,.e-rows .e-sorting").addClass("e-pvtBtnSort")),this.element.find(".e-drag, .values, .columns, .e-grpRow, .e-rows").ejDroppable({}),this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length>0)this.element.find(".groupingBarPivot").width(this.element.find(".e-pivotGridTable").width());else if(0==this.element.find(".columns .e-pivotButton").length||0==this.element.find(".values .e-pivotButton").length&&1==this.element.find(".columns .e-pivotButton").length)this.element.find(".groupingBarPivot").width(300);else{for(l=0,p=0;p<e(this.element.find(".columns .e-pivotButton")).length;p++)l=Math.max(e(this.element.find(".columns .e-pivotButton")[p]).width(),l);l<140&&this.element.find(".columns").css("min-width",l+"px"),a=l*e(this.element.find(".columns .e-pivotButton")).length+this.element.find(".values").width()+10,this.element.find(".groupingBarPivot").width(a)}for((this.element.find(".e-rows").width()>140||this.model.enableDeferUpdate&&this.element.find(".e-rows").width()<this.element.find(".e-grpRow").width()&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this.enableDeferUpdate?this.element.find(".e-rows").width(0==this.element.find(".colheader").length?this.element.find(".e-grpRow").width()-140:this.element.find(".e-grpRow").width()):this.model.isResponsive||this.element.find(".e-rows").width(this.model.enableDeferUpdate?this.element.find(".e-grpRow").width()-8:this.element.find(".e-grpRow").width())),(this.element.find(".e-pivotGridTable thead").length>0||this.model.enableDeferUpdate&&0==this.element.find(".e-pivotGridTable thead").length&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.model.isResponsive&&0==this.element.find(".values .e-pivotButton").length&&0==this.element.find(".columns .e-pivotButton").length?this.element.find(".values").width(140):this.element.find(".values").width(this.element.find(".e-grpRow").length>0?this.model.enableDeferUpdate&&0==this.element.find(".colheader").length?this.element.find(".e-grpRow").width():this.element.find(".e-grpRow").width()+3:140),this.model.enableDeferUpdate&&0==this.element.find(".colheader").length&&0!=this.element.find(".e-pivotGridTable .rowheader").length&&((c=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width())<140&&this.element.find(".groupingBarPivot").width(this.element.find(".groupingBarPivot").width()+140)),this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length>0||this.model.enableDeferUpdate&&0==this.element.find(".columns .e-pivotButton").length||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(b=this.element.find(".e-pivotGridTable").width()-this.element.find(".values").width()-4,0==this.element.find(".e-pivotGridTable").find("thead th:eq(2), tbody td:eq(1)").length?(this.element.find(".columns").css("min-width",b>=30&&0==this.element.find(".e-pivotGridTable .colheader").length&&0==this.element.find(".columns .e-pivotButton").length?140:b).width(b>=30&&0==this.element.find(".e-pivotGridTable .colheader").length&&0==this.element.find(".columns .e-pivotButton").length?82:b),this.element.find(".values").height(b>=30&&0==this.element.find(".e-pivotGridTable .colheader").length&&0==this.element.find(".columns .e-pivotButton").length?this.element.find(".columns").height():this.element.find(".values").height()),(0==this.element.find(".columns .e-pivotButton").length||this.model.enableDeferUpdate&&0==this.element.find(".e-pivotGridTable .colheader").length)&&(0==this.element.find(".columns .e-pivotButton").length&&(b=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-5,this.element.find(".columns").width(b),b<140&&(1==e(".groupingBarPivot .values .e-pivotButton").length||0==e(".groupingBarPivot .values .e-pivotButton").length&&this.model.enableDeferUpdate)&&this.element.find(".columns").css("min-width",b+"px")),this.element.find(".columns").addClass("e-widthSetter"))):b<140?e(".columns .e-pivotButton").length<2?this.element.find(".columns").css("min-width",b).addClass("e-widthSetter"):(this.element.find(".columns").width(b).css("min-width",b),this.element.find(".values").height(this.element.find(".columns").height())):this.element.find(".columns").width(b)):0!=this.element.find(".e-pivotGridTable").find("thead th:eq(1)").length||this.model.enableDeferUpdate||(0==this.element.find(".columns .e-pivotButton").length&&this.element.find(".columns").addClass("e-widthSetter"),r=this.element.find(".columns .e-pivotButton").length<1?1:this.element.find(".columns .e-pivotButton").length,this.element.find(".columns").css("min-width",(this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-7)/r))),null!=this.model.dataSource.data&&""==this.model.url&&(o=0,e(".columns .e-pivotButton").each(function(){o+=parseInt(e(this).width()+10)}),e(".valueColumn").height()>30&&0==this.element.find(".values button").length&&this.element.find(".columns").width()<o&&(f=this.element.find(".columns .e-pivotButton").length,_=(this.element.find(".valueColumn").width()-this.element.find(".values").width())/(0==f?1:f)-70,this.element.find(".columns .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"}))),this.element.find(".columns").height()>47?(_=this.model.isResponsive?this.element.find(".columns").width()/this.element.find(".columns .e-pivotButton").length-5:this.element.find(".columns").width()/2-60,this.element.find(".columns .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})):this.element.find(".columns .e-pivotButton").width()>this.element.find(".columns").width()&&(_=this.element.find(".columns").width()-(this.element.find(".columns .e-pivotButton").width()-this.element.find(".columns .e-pivotButton .e-pvtBtn").width()+40),this.element.find(".columns .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})),this.element.find(".e-drag").height()>47?(_=this.element.find(".groupingBarPivot").width()/4-35,this.element.find(".e-drag .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})):this.element.find(".e-drag .e-pivotButton").width()>this.element.find(".e-drag").width()&&(_=this.element.find(".e-drag").width()-(this.element.find(".e-drag .e-pivotButton").width()-this.element.find(".e-drag .e-pivotButton .e-pvtBtn").width()+40),this.element.find(".e-drag .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})),this.element.find(".values").height()>47?(_=this.model.isResponsive?this.element.find(".values").width()/this.element.find(".values .e-pivotButton").length-5:this.element.find(".values").width()/2-40,this.element.find(".values .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})):(this.element.find(".values .e-pivotButton").width()>this.element.find(".values").width()||!this.model.enableDeferUpdate&&0==this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length&&this.element.find(".values .e-pivotButton").length>0)&&(_=this.element.find(".values").width()-(this.element.find(".values .e-pivotButton").width()-this.element.find(".values .e-pivotButton .e-pvtBtn").width()+20),this.element.find(".values .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})),n=0,p=0;p<this.element.find(".e-rows .e-pivotButton").length;p++)n+=this.element.find(".e-rows .e-pivotButton:eq("+p+")").width();if(n-20>this.element.find(".e-rows").width()||this.element.find(".colfreeze").length-20>0&&n>this.element.find(".colfreeze").width()||this.element.find(".e-rows").parent(".emptyRows").length>0&&this.element.find(".e-rows").parent(".emptyRows").width()<n){var f,_=0,v=this.element.find(".colfreeze").length>0?".colfreeze":".e-rows";_=this.element.find(v).parent().height()/(this.element.find(v+" .e-pivotButton").eq(0).height()*(f=this.element.find(v+" .e-pivotButton").length))>=1?"auto":this.element.find(v).width()/2-40,this.element.find(".e-rows .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})}if((this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(0==this.element.find(".values .e-pvtBtn").length||0==this.element.find(".columns .e-pvtBtn").length)&&(this.element.find(".e-rows").width()>this.element.find(".values").width()||this.element.find(".e-rows").width()>this.element.find(".columns").width())&&140==this.element.find(".emptyRows").width()||this.model.enableDeferUpdate&&this.element.find(".values .e-pvtBtn").length<=1&&this.element.find(".columns .e-pvtBtn").length<=1)&&(s=this.element.find(".e-rows").width(),d=this.element.find(".values").width()+this.element.find(".columns").width(),this.element.find(".values").css({"min-width":s,width:s}),h=this.element.find(".values").width(),this.element.find(".columns").css({"min-width":d-h,width:d-h}),this.element.find(".columns .e-pvtBtn,.values .e-pvtBtn").width("auto").css({"text-overflow":"ellipsis"}),this.element.find(".emptyRows").width(s)),this.model.enableDeferUpdate&&0!=this.element.find(".columns .e-pivotButton").length&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(u=0,c=0,p=0;this.element.find(".columns .e-pivotButton").length>p;p++)u=this.element.find(".columns .e-pivotButton:eq("+p+")").width()+u+7;if(u>=(c=this.element.find(".e-pivotGridFrozenTable").width())){var b;_=(b=0==(this.element.find(".e-pivotGridTable .colheader").length>0?1:0)?140:c)/(this.model.enableDeferUpdate?this.element.find(".columns .e-pivotButton").length:3)-15;this.model.enableDeferUpdate?this.element.find(".columns .e-pvtBtn").width(30).css({"text-overflow":"ellipsis"}):this.element.find(".columns .e-pvtBtn").width(_).css({"text-overflow":"ellipsis"})}}(this.element.find(".values").height()>this.element.find(".columns").height()||this.element.find(".columns").height()>this.element.find(".values").height())&&(this.element.find(".values").height()>this.element.find(".columns").height()?this.element.find(".columns").height(this.element.find(".values").height()):this.element.find(".values").height(this.element.find(".columns").height())),this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),this.element.find(".summary").removeClass("e-droppable"),this.model.enableGroupingBar&&(m=this.element.find(".e-pvtBtn"),g=t.buildTag("ul.pivotTree#pivotTree",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li.e-calculatedFieldMenuItem",t.buildTag("a.menuItem",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML:" ")+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToFilter"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToRow"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToColumn"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToValues"))[0].outerHTML)[0].outerHTML)[0].outerHTML,e(this.element).append(g),e("#pivotTree").ejMenu({menuType:t.MenuType.ContextMenu,enableRTL:this.model.enableRTL,openOnClick:!1,contextMenuTarget:m,click:t.proxy(this._pivotContextClick,this),beforeOpen:t.proxy(this._contextOpen,this),close:t.proxy(t.Pivot.closePreventPanel,this)}))},_clientPvtBtnDropped:function(i){var l,a,r,o,n;t.PivotAnalysis._valueSorting=null,this._isDragging=!1,t.Pivot.openPreventPanel(this),i.element.removeClass("dragHover").css("background-color","inherit"),i.element.parent().removeClass("dragHover"),this.element.find(".dragClone").remove(),this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorHover"),this.element.find(".dragClone,.e-dropIndicator").remove();var s=e(i.target).hasClass("columns")||e(i.target).parents(".columns").length>0?"column":e(i.target).hasClass("e-grpRow")||e(i.target).parents(".e-grpRow").length>0||e(i.target).hasClass("e-rows")?"row":e(i.target).hasClass("values")||e(i.target).parents(".values").length>0?"value":e(i.target).hasClass("e-drag")||e(i.target).parents(".e-drag").length>0?"filter":"",d=i.element.text(),h=e(i.element).attr("data-fieldName");if(""!=s&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(h.toLowerCase().indexOf("[measures]")>=0&&"value"!=s||h==this._getLocalizedLabels("Measures")&&"row"!=s&&"column"!=s||h.toLowerCase().indexOf("[measures]")<0&&"value"==s))t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Warning"),this);else{if(""==s&&this._schemaData)if("measures"==d.toLowerCase()&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(l=0;this.model.dataSource.values[0].measures.length>0;)selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this.model.dataSource.values[0].measures[l].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else this._schemaData&&(a=this._schemaData._tableTreeObj.element.find("li:contains('"+d+"')"),this._schemaData._tableTreeObj.uncheckNode(a));if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&""!=s&&"value"!=s&&e.grep(this._calculatedField,function(e){return e.name==h}).length>0)return t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this),void this.element.find(".dragClone,.e-dropIndicator").remove();var u=""==s?"":this._setSplitBtnTargetPos(i.event,s,"drop"),c=""==s?"":this._setSplitBtnTargetPos(i,s,"original"),p=e(i.element).hasClass("columns")||e(i.element).parents(".columns").length>0?"column":e(i.element).hasClass("e-grpRow")||e(i.element).parents(".e-grpRow").length>0||e(i.element).hasClass("e-rows")?"row":e(i.element).hasClass("values")||e(i.element).parents(".values").length>0?"value":e(i.element).hasClass("e-drag")||e(i.element).parents(".e-drag").length>0?"filter":"";""!=s&&s.toLowerCase()==p.toLowerCase()&&u>c&&(u-=1),r={droppedFieldName:h,droppedFieldCaption:d,droppedClass:s,droppedPosition:u,isMeasuresDropped:0==h.toLocaleLowerCase().indexOf("measures")},this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&"value"!=s?this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField||1==e.isCalculatedField&&-1==e.formula.indexOf(r.droppedFieldName)}):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this._fieldMembers={},this._fieldSelectedMembers={},this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this)),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.Pivot.addReportItem(this.model.dataSource,r),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(o=e.grep(this.model.dataSource.values,function(e){return 1==e.isCalculatedField}),this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField}),e.merge(this.model.dataSource.values,o)),(this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&"filter"==s&&((n=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item)&&n.advancedFilter&&(n.advancedFilter=[])),this.refreshControl(),t.isNullOrUndefined(this._schemaData)||(null==t.Pivot.getReportItemByFieldName(h,this.model.dataSource).item&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._schemaData._tableTreeObj.element.find("li[data-tag='"+h+"']").removeClass("filter").find(".treeDrop,.filter").remove(),this._schemaData._refreshPivotButtons())}},_pvtBtnDropped:function(i){var l,a,r,o,n,s,d,h,u,c,p;t.Pivot.openPreventPanel(this),e(i.element).parent().removeClass("dragHover"),e(i.element).removeClass("dragHover"),this._isUpdateRequired=!0,l="",this._isDragging=!1,this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorHover");var m,g,f=null,_="",v="",b=!1;if(a="e-grpRow"==(a=t.isNullOrUndefined(i.target.className)?e(i.target).hasClass("columns")?"columns":e(i.target).hasClass("e-grpRow")?"e-rows":e(i.target).hasClass("values")?"values":e(i.target).hasClass("e-drag")?"e-drag":"":i.target.className.indexOf("e-droppable")>=0?i.target.className.split(" ")[0]:"")?"e-rows":a,g=e(i.element).parent().find(".filtered").length>0,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(e(i.target).hasClass("e-pvtBtn")&&this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&(a=e(i.target).attr("data-axis").toLowerCase()),m=t.isNullOrUndefined(i.element.attr("data-fieldCaption"))?i.element.text():i.element.attr("data-fieldCaption"),b=e(i.element).parent().find(".descending").length>0,""==a&&("BUTTON"==i.target.tagName||"SPAN"==i.target.tagName)&&(a=i.target.parentNode.parentElement.className.split(" ")[0]),r=0;r<this._pivotTableFields.length;r++)this._pivotTableFields[r].name==m&&(this._pivotTableFields[r].isSelected=!0,v=this._pivotTableFields[r]);else t.isNullOrUndefined(i.target.className)?(f=e(i.target),_=e(i.target).hasClass("columns")?"Categorical":e(i.target).hasClass("e-grpRow")?"Series":e(i.target).hasClass("e-drag")?"Slicer":"",a=e(i.target).hasClass("columns")?"columns":e(i.target).hasClass("e-grpRow")?"e-rows":e(i.target).hasClass("values")?"values":e(i.target).hasClass("e-drag")?"e-drag":""):(_="columns"==(f=i.target.className.indexOf("e-pvtBtn")>-1?e(i.target).parents(".e-droppable")[0]:i.target.className.indexOf("e-droppable")?i.target:"td"==i.target[0].tagName.toLowerCase()?i.target.children(":last")[0]:i.target).className.split(" ")[0]?"Categorical":"e-rows"==f.className.split(" ")[0]||"e-grpRow"==f.className.split(" ")[0]?"Series":"filters"==f.className.split(" ")[0]?"Slicer":"",a=f.className.split(" ")[0]),""==_&&(i.element.parent().attr("data-tag").indexOf("[Measures]")>-1||i.element.parent().attr("data-tag").indexOf("KPI")>-1)&&(_=this.element.find(".e-schemaRow .e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?"Series":"Categorical"),t.isNullOrUndefined(i.element.parent())||(l=i.element.parents(".values").length>0?"values":i.element.parents(".e-drag").length>0?"e-drag":i.element.parents(".e-grpRow").length>0?"e-rows":i.element.parents(".columns").length>0?"columns":""),v=e(i.element.parent()[0]).attr("data-tag"),a="e-grpRow"==a?"e-rows":a,_="e-grpRow"==_?"Series":_,m=i.element.text();if(this.element.find(".dragClone").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(("MEASURES"==v.split(":")[1].toLocaleUpperCase()||"KPI"==v.split(":")[1].toLocaleUpperCase())&&("columns"!=a||"e-rows"!=a)&&("e-drag"==a||"values"==a)||v.toUpperCase().indexOf("[MEASURES]")>-1&&"values"!=a&&("e-rows"==a||"columns"==a||"e-drag"==a)||(-1==v.toUpperCase().indexOf("[MEASURES]")||-1==v.toUpperCase().indexOf("KPI"))&&"values"==a&&a!=l))return t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Error"),this),this.element.find(".dragClone,.e-dropIndicator").remove(),i.element.parent().removeAttr("style"),i.element.css("background-color","inherit"),!1;if("e-rows"==a||"columns"==a||"values"==a||"e-drag"==a){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"values"!=a&&(e.grep(this._calculatedField,function(e){return e.name==m}).length>0||e.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(e){return e.FieldHeader==m&&8==e.CalculationType}).length>0))return t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this),i.element.parent().removeAttr("style"),void i.element.css("background-color","inherit");o=this._setSplitBtnTargetPos(i,a,"drop"),n=this._setSplitBtnTargetPos(i,a,"original"),"e-drag"==a&&this.element.find(".e-drag").text("").attr("aria-label","filter");try{s=JSON.parse(this.getOlapReport()).Report}catch(e){s=this.getOlapReport()}if(e(i.element.parent()).remove(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)O=i.element.parents(".e-pivotButton").attr("data-tag").split(":")[0],this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),e.isNumeric(o)&&a==O.toLowerCase()&&o>n&&(o-=1),a="e-rows"==a?"schemaRow":"columns"==a?"schemaColumn":"e-drag"==a?"schemaFilter":"values"==a?"schemaValue":"",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(this.model.enableAdvancedFilter&&"schemaFilter"==a&&!t.isNullOrUndefined(this._curFilteredText)&&this._curFilteredText.indexOf(":")>-1&&((u=this._getAdvancedFilterInfo(this._curFilteredText.split(":")[1])).length>0&&this._removeFilterTag(u[0].levelUniqueName)),_="schemaFilter"==a?"Slicer":_,d=JSON.parse(this._olapReport).CurrentCube+"--"+v+"--"+_+"--"+o,null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),h=JSON.stringify({action:"nodeDropped",dropType:"SplitButton",nodeInfo:d,currentReport:s,gridLayout:this.model.layout,customObject:c}),this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h,this._pvtBtnDroppedSuccess)):(this._calculatedField.length>0&&"schemaValue"!=a&&null!=this._schemaData&&this._calculatedFieldNodeRemove(v),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),p=t.Pivot._getFilterParams(a,this._tempFilterData,m),h=JSON.stringify({action:"nodeDropped",dropAxis:a+"::"+o,headerTag:JSON.stringify(v),sortedHeaders:this._ascdes,filterParams:p,currentReport:s,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:c}),this._renderControlSuccess,this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h,this._pvtBtnDroppedSuccess));else{if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"values"!=a&&e.grep(this._calculatedField,function(e){return e.name==m}).length>0)return t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this),this.model.editCellsInfo={},void this._populatePivotGrid();var C=this._getDroppedItem(m),S={fieldName:C[0].fieldName,fieldCaption:C[0].fieldCaption},O=i.element.parents(".e-pivotButton").attr("data-tag").split(":")[0];this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&C.length>0&&"e-drag"==a&&(C[0].advancedFilter=[]),e.isNumeric(o)?a==O.toLowerCase()&&o>n?"e-rows"==a?this.model.dataSource.rows.splice(o-1,0,C[0]):"columns"==a?this.model.dataSource.columns.splice(o-1,0,C[0]):"values"==a?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(o-1,0,C[0]):this.model.dataSource.values.splice(o,0,C[0]):this.model.dataSource.filters.splice(o,0,C[0]):"e-rows"==a?this.model.dataSource.rows.splice(o,0,C[0]):"columns"==a?this.model.dataSource.columns.splice(o,0,C[0]):"values"==a?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(o,0,C[0]):this.model.dataSource.values.splice(o,0,C[0]):this.model.dataSource.filters.splice(o,0,C[0]):"e-rows"==a?this.model.dataSource.rows.push(C[0]):"columns"==a?this.model.dataSource.columns.push(C[0]):"values"==a?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.push(C[0]):this.model.dataSource.values.push(C[0]):this.model.dataSource.filters.push(C[0]),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&"values"!=a&&(null!=this._schemaData&&this._calcFieldNodeDrop(C[0]),this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField||1==e.isCalculatedField&&-1==e.formula.indexOf(C[0].fieldName)})),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this)),null!=this._schemaData&&(a==O&&o>n&&(o-=1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData.element.find("button[data-fieldName='"+m+"']").remove():this._schemaData.element.find("#pivotButton"+m).parent().remove(),this._schemaData._createPivotButton(S,"e-rows"==a?"row":"columns"==a?"column":"e-drag"==a?"filter":"values"==a?"value":"",g,b,o)),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.getJSONData({action:"pvtBtnDropped"},this.model.dataSource,this)):(this.model.editCellsInfo={},this._populatePivotGrid())}}else this._removePvtBtn(i);t.isNullOrUndefined(this._schemaData)||this._schemaData._setPivotBtnWidth()},_getDroppedItem1:function(i){this.model.analysisMode,t.Pivot.AnalysisMode.Olap;var l,a=e.grep(this.model.dataSource.columns,function(e){return e.fieldName==i});return a.length>0?this.model.dataSource.columns=e.grep(this.model.dataSource.columns,function(e){return e.fieldName!=i}):(a=e.grep(this.model.dataSource.rows,function(e){return e.fieldName==i})).length>0?this.model.dataSource.rows=e.grep(this.model.dataSource.rows,function(e){return e.fieldName!=i}):(l=this.model.dataSource.values,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(l=this.model.dataSource.values[0].measures),(a=e.grep(l,function(e){return e.fieldName==i})).length>0?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures=e.grep(l,function(e){return e.fieldName!=i}):this.model.dataSource.values=e.grep(l,function(e){return e.fieldName!=i}):(a=e.grep(this.model.dataSource.filters,function(e){return e.fieldName==i})).length>0&&(this.model.dataSource.filters=e.grep(this.model.dataSource.filters,function(e){return e.fieldName!=i}))),a},_clearCollapsedItems:function(t,i,a){return"rowheader"==t?a.rows=e.map(a.rows,function(t){return t.drilledItems!=l&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t}):"colheader"==t&&(a.columns=e.map(a.columns,function(t){return t.drilledItems!=l&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t})),a},_setSplitBtnTargetPos:function(t,i,l){var a,r,o,n="";for(r="drop"==l?e(t.target).parents(".e-pivotButton"):e(t.element).parents(".e-pivotButton"),i="column"==i?"columns":"row"==i?"e-rows":"filter"==i?"e-drag":"value"==i?"values":i,a=this.element.find("."+i).children(".e-pivotButton"),o=0;o<a.length;o++)e(a[o]).attr("data-tag")==e(r).attr("data-tag")&&(n=o);return n},_pvtBtnDroppedSuccess:function(e){!t.isNullOrUndefined(e[0])&&e.length>0?null!=e[2]&&e[2]!=l&&(this.model.customObject=e[2].Value):!t.isNullOrUndefined(e.d)&&e.d.length>0?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):t.isNullOrUndefined(e)||t.isNullOrUndefined(e.OlapReport)||null!=e&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),this.model.enableDeferUpdate?this._deferUpdateSuccess(e):this._renderControlSuccess(e),null!=this._schemaData&&this._schemaData._refreshPivotButtons()},_deferUpdateSuccess:function(i){if(t.isNullOrUndefined(i.PivotReport)&&t.isNullOrUndefined(i.OlapReport)?(this.setOlapReport(i.d[0].Value),null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.d[2].Value),JSON.parse(i.d[1].Value))):(t.isNullOrUndefined(i.PivotReport)?this.setOlapReport(i.OlapReport):this.setOlapReport(i.PivotReport),i.HeaderCounts!=l&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),this.model.enableGroupingBar){var a=JSON.parse(this.getOlapReport());this._pivotTableFields=JSON.parse(a.ItemsProperties),this._createGroupingBar(a),this.element.find(".e-grpRow .e-rows").text(""),this.element.find(".e-grpRow .e-rows").children().remove(),this.element.find(".e-grpRow .e-rows").append(this._pivotRow),this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())}this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&null!=this._schemaData&&this._schemaButtonCreate(),t.Pivot.closePreventPanel(this)},_clientRemovePvtBtn:function(i){t.PivotAnalysis._valueSorting=null,t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();var l=e(e(i.target).siblings()[0]).attr("data-fieldName");delete this._fieldMembers[l.toLowerCase()],delete this._fieldSelectedMembers[l.toLowerCase()],this._calculatedField.length>0&&e.grep(this.model.dataSource.values,function(e){return e.fieldName==l}).length>0?this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return(null==e.isCalculatedField||0==e.isCalculatedField||-1==e.formula.indexOf(l))&&e.fieldName!=l}):t.Pivot.removeReportItem(this.model.dataSource,l,0==l.toLocaleLowerCase().indexOf("measures")),this.refreshControl(),t.isNullOrUndefined(this._schemaData)||(this._schemaData._tableTreeObj.element.find("li[data-tag='"+l+"']").removeClass("filter").find(".treeDrop,.filter").remove(),this._schemaData.refreshControl())},_removePvtBtn:function(i){var l,a,r,o,n,s,d,h;if(this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if("click"==i.type){var u=e(e(i.target).siblings()[0]).attr("data-fieldName"),c="",p="";e(e(i.target).siblings()[0]).text()}else{u=i.element.attr("data-fieldName"),c="",p="";i.element.text()}for(o=0;o<this.element.find(".e-pivotButton").length;o++)(p=e(this.element.find(".e-pivotButton")[o]).find("button").attr("data-fieldName"))==u&&(c=e(this.element.find(".e-pivotButton")[o]));if(e(c).remove(),null!=this._schemaData){if(d=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData._tableTreeObj.element.find("li [data-tag='"+u+"']"):this._schemaData._tableTreeObj.element.find("li[id='"+u+"']"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&0==d.length&&"measures"==u.toLowerCase()){for(this._schemaData.element.find("div[data-tag='"+c.attr("data-tag")+"']").remove(),o=0;o<this.model.dataSource.values[0].measures.length;o++)this._schemaData._nodeCheck=!0,selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this.model.dataSource.values[0].measures[o].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode),this.element.find("div[data-tag='values:"+this.model.dataSource.values[0].measures[o].fieldName+"']").remove(),this._schemaData.element.find("div[data-tag='values:"+this.model.dataSource.values[0].measures[o].fieldName+"']").remove();this.model.dataSource.values[0].measures=[],t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.getJSONData({action:"removeBtn"},this.model.dataSource,this)}this._schemaData._tableTreeObj.uncheckNode(d)}else this.model.dataSource.columns=e.grep(this.model.dataSource.columns,function(e){return e.fieldName!=u}),this.model.dataSource.rows=e.grep(this.model.dataSource.rows,function(e){return e.fieldName!=u}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?"measures"==c.attr("data-tag").split(":")[1].toLowerCase()?this.model.dataSource.values[0].measures=[]:this._getItemPosition(this.model.dataSource.values[0].measures,c.attr("data-tag").split(":")[1]).length>0&&this.model.dataSource.values[0].measures.splice(this._getItemPosition(this.model.dataSource.values[0].measures,c.attr("data-tag").split(":")[1])[0],1):this.model.dataSource.values=this._calculatedField.length>0?e.grep(this.model.dataSource.values,function(e){return(null==e.isCalculatedField||0==e.isCalculatedField||-1==e.formula.indexOf(u))&&e.fieldName!=u}):e.grep(this.model.dataSource.values,function(e){return e.fieldName!=u}),this.model.dataSource.filters=e.grep(this.model.dataSource.filters,function(e){return e.fieldName!=u}),this.model.analysisMode!=t.Pivot.AnalysisMode.Olap&&this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode?(this.model.editCellsInfo={},this._populatePivotGrid()):(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"removeButton"},this),this.getJSONData({action:"removeButton"},this.model.dataSource,this))}else{if("click"==i.type?(u=e(e(i.target).siblings("button")).attr("data-fieldCaption"),g=e(e(i.target).siblings("button")).parent().attr("data-tag")):(u=i.element.attr("data-fieldCaption"),g=i.element.parent().attr("data-tag")),!t.isNullOrUndefined(this._tempFilterData)&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(l=0;l<this._tempFilterData.length;l++)for(a in this._tempFilterData[l])a==g.split(":")[1]&&""!=this._tempFilterData[l][g.split(":")[1]]&&this._tempFilterData.splice(l,1);delete this._fieldMembers[g.split(":")[g.split(":").length-1]],delete this._fieldSelectedMembers[g.split(":")[g.split(":").length-1]];var m="",g=(c="",""),f=(p="","");for(c=this.element.find(".e-pivotButton:contains("+u+")"),o=0;o<this._pivotTableFields.length;o++)this._pivotTableFields[o].name==u&&(this._pivotTableFields[o].isSelected=!1,g=this._pivotTableFields[o]);try{f=JSON.parse(this.getOlapReport()).Report}catch(e){f=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(g=e(c).attr("data-tag"),r=e(c).parents().hasClass("values")&&-1==g.indexOf("[Measures]"),"[Measures]"==(p=g.indexOf("[Measures]")>-1||g.indexOf("KPI")>-1||r||g.indexOf("[")>-1?g.split(":")[1]:this._getNodeUniqueName(g))||"KPI"==p||r){if(g=r?g+":KPI":g,c.remove(),!t.isNullOrUndefined(this._schemaData))for(this._schemaData.element.find(".e-pivotButton:contains("+u+")").remove(),o=0;o<this._schemaData.model.pivotCalculations.length&&(g.indexOf("Measures")>-1||g.indexOf("KPI")>-1||e(c).parents().hasClass("values")&&-1==g.indexOf("[Measures]"));o++)p=this._schemaData.model.pivotCalculations[o].Tag,this._schemaData._isMeasureBtnRemove=!0,selectedTreeNode=this._getNodeByUniqueName(p),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);this._waitingPopup.show(),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"removeButton",element:this.element,customObject:this.model.customObject}),h=JSON.stringify(this.model.customObject),s=JSON.stringify({action:"removeButton",headerInfo:g,currentReport:f,gridLayout:this.model.layout,customObject:h}),!t.isNullOrUndefined(this._schemaData)&&(g.indexOf("[Measures]")<0||g.indexOf("KPI")<0)&&(g.indexOf("Measures")>=0||g.indexOf("KPI")>=0)&&this._schemaData.element.find(".e-schemaValue .e-pivotButton").remove(),this.model.enableDeferUpdate&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this._removeButtonDeferUpdate=!0,this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,s.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess),this.element.find(".schemaNoClick").removeClass("freeze"),this._waitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,s,this._pvtBtnDroppedSuccess)}else if(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)){if(h=JSON.stringify(this.model.customObject),s=JSON.stringify({action:"removeButton",headerInfo:g,currentReport:f,gridLayout:this.model.layout,customObject:h}),t.isNullOrUndefined(g))return!1;this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,s.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,s,this._pvtBtnDroppedSuccess)}else selectedTreeNode=this._getNodeByUniqueName(p),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else m="schemaRow::"+g.id+"::FILTERED",n=""!=this._droppedClass?this._droppedClass:"PivotItem"==g.pivotType?"e-schemaRow":"e-schemaValue",this._droppedClass="",e(c).remove(),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),null!=this._schemaData?(d=this._schemaData._tableTreeObj.element.find("li:contains('"+u+"')"),this._schemaData._tableTreeObj.uncheckNode(d)):(null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),h=JSON.stringify(this.model.customObject),s=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(g),dropAxis:n+"::",sortedHeaders:this._ascdes,filterParams:m,currentReport:f,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:h}),this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeStateModified,s.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),this._nodeStateModifiedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeStateModified,s,this._nodeStateModifiedSuccess))}},_getNodeUniqueName:function(e){for(var t="",i=0;i<e.split(":")[1].split(".").length;i++)""!=t&&(t+="."),t+="["+e.split(":")[1].split(".")[i]+"]";return t},_getNodeByUniqueName:function(t){for(var i=null,l=0;l<e(this._schemaData._tableTreeObj.element.find("li")).length;l++)e(this._schemaData._tableTreeObj.element.find("li")[l]).attr("data-tag").toLowerCase()==t.toLowerCase()&&(i=e(this._schemaData._tableTreeObj.element.find("li")[l]));return i},_nodeStateModifiedSuccess:function(e){e[0]!=l?null!=e[2]&&e[2]!=l&&(this.model.customObject=e[2].Value):e.d!=l?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):null!=e.customObject&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),this.model.enableDeferUpdate?this._deferUpdateSuccess(e):this._renderControlSuccess(e)},_drillDownSuccess:function(i){if(i[0]!=l)this.setJSONRecords(i[0].Value),this.setOlapReport(i[1].Value),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i[1].Value).Report,i[2].Value!=l&&"undefined"!=i[2].Value&&(this._pivotClientObj.reports=i[2].Value)),null!=i[3]&&i[3]!=l&&"PageSettings"==i[3].Key&&(this.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[4].Value).Column/JSON.parse(i[3].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[4].Value).Row/JSON.parse(i[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[3].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i[3].Value).SeriesPageSize):null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l?this._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)):t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)),null!=i[5]&&i[5]!=l&&(this.model.customObject=i[5].Value)),null!=i[3]&&i[3]!=l&&"PageSettings"!=i[3].Key&&(this.model.customObject=i[3].Value);else if(i.d!=l)this.setJSONRecords(i.d[0].Value),this.setOlapReport(i.d[1].Value),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i.d[1].Value).Report,i.d[2].Value!=l&&"undefined"!=i.d[2].Value&&(this._pivotClientObj.reports=i.d[2].Value),this._updatePageSettings(i.d,this._pivotClientObj)),null!=i.d[3]&&i.d[3]!=l&&"PageSettings"==i.d[3].Key&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[4].Value).Column/JSON.parse(i.d[3].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[4].Value).Row/JSON.parse(i.d[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[3].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[3].Value).SeriesCurrentPage):null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l?this._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)):t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)),null!=i.d[5]&&i.d[5]!=l&&(this.model.customObject=i.d[5].Value)),null!=i.d[3]&&i.d[3]!=l&&"PageSettings"!=i.d[3].Key&&(this.model.customObject=i.d[3].Value);else{if(t.isNullOrUndefined(i.PivotRecords))return(t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup)&&t.isNullOrUndefined(this._pivotClientObj)?t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.hide()):(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._waitingPopup.hide()),!1;this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i.OlapReport).Report,i.ClientReports!=l&&"undefined"!=i.ClientReports&&(this._pivotClientObj.reports=i.ClientReports),i.PageSettings!=l&&null!=i.PageSettings&&null!=this._pivotClientObj._pagerObj&&this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),i.PageSettings!=l&&null!=i.PageSettings&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),null!=i.customObject&&i.customObject!=l&&(this.model.customObject=i.customObject)}null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject}),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&0==this.model.enableVirtualScrolling&&null==e(".e-pivotpager")[0]?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords());try{this.model.currentReport=JSON.parse(this.getOlapReport()).Report}catch(e){this.model.currentReport=this.getOlapReport()}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("gridDrillSuccess",this.element),this._trigger("drillSuccess",this.element),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup?t.isNullOrUndefined(this._pivotClientObj)?t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.hide()):((!this._pivotClientObj||this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._startDrilldown)&&"gridOnly"!=this._pivotClientObj.model.displaySettings.mode||(this._pivotClientObj._isTimeOut=!1),this._pivotClientObj._waitingPopup.hide()):e("#"+this._pivotClientObj._id+"_maxView")[0]&&this._maxViewLoading?(this._maxViewLoading.hide(),this._pivotClientObj._waitingPopup.hide()):"gridOnly"==this._pivotClientObj.model.displaySettings.mode&&this._pivotClientObj._waitingPopup.hide(),t.isNullOrUndefined(this._pivotClientObj)?this._waitingPopup.hide():(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._pivotGrid._startDrilldown=!1);var a={action:this._drillAction,customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",a)},saveReport:function(e,i,l){var a,r,o;"local"==i.toLowerCase()?this._trigger("saveReport",{report:this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource:this.getOlapReport()}):(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(r=JSON.stringify(this.model.dataSource),a="clientMode"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(r=JSON.parse(this.getOlapReport()).Report,a="serverMode"),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"saveReport",element:this.element,customObject:this.model.customObject}),o=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:e,clientReports:r,operationalMode:a,customObject:o})))},loadReport:function(e,i,l){var a,r,o,n;if(this._waitingPopup.show(),"local"==i.toLowerCase())if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode}),this.refreshPivotGrid();else{this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode});try{o=JSON.parse(this.getOlapReport()).Report}catch(e){o=this.getOlapReport()}null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject}),n=JSON.stringify(this.model.customObject),a=JSON.stringify({action:"loadReport",gridLayout:this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.layout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:e,operationalMode:"serverMode",clientReports:o,customObject:n}),this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.loadReport,a,this._loadReportSuccess)}else null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject}),n=JSON.stringify(this.model.customObject),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(r="clientMode",this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.loadReport,JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:e,operationalMode:r,customObject:n}),this._loadReportSuccess)):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(r="serverMode",a=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?JSON.stringify({action:"loadReport",reportName:e,gridLayout:this.model.layout,enablePivotFieldList:this.model.enablePivotFieldList,operationalMode:r,customObject:n}):JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:e,operationalMode:r,customObject:n}),this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.loadReport,a,this._loadReportSuccess))},_loadReportSuccess:function(e){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(e.d!=l&&e.d.length>0?this.setOlapReport(JSON.parse(e.d[0].Value)):this.setOlapReport(JSON.parse(e.report)),this.model.dataSource=this.getOlapReport(),this.refreshPivotGrid(),this._unWireEvents(),this._wireEvents()):this._renderControlSuccess(e),!t.isNullOrUndefined(this._schemaData)&&this.model.enablePivotFieldList&&this._schemaData._load()},doAjaxPost:function(i,a,r,o,n,s){var d,h,u,c,p,m;t.isNullOrUndefined(r.XMLA)&&"cellEditing"!=JSON.parse(r).action&&(this.model.editCellsInfo={}),c=!0,p=this.model.enableXHRCredentials||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableXHRCredentials,r.XMLA==l?(d="application/json; charset=utf-8",h="json",u=e.proxy(o,this),c=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9||"export"==JSON.parse(r).action)):(d="text/xml",h="xml",r=r.XMLA,u=e.proxy(o,t.olap.base,s),c=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)&&(!t.isNullOrUndefined(s)&&"loadFieldElements"!=s.action)),m={type:i,url:a,contentType:d,async:c,dataType:h,data:r,success:u,xhrFields:{withCredentials:p},complete:t.proxy(function(i){if(e.proxy(i,this),null!=this.model){var l={action:t.isNullOrUndefined(s)||t.isNullOrUndefined(s.action)?JSON.parse(r).action:s.action,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",l)}},this),error:t.proxy(function(e){void 0!==this._waitingPopup&&null!=this._waitingPopup&&this._waitingPopup.hide(),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup||this._pivotClientObj._waitingPopup.hide();var i={action:""!=this._drillAction?this._drillAction:"initialize",customObject:this.model.customObject,element:this.element,Message:e};this._trigger("renderFailure",i),this.renderControlFromJSON(""),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&t.Pivot._createErrorDialog(e.statusText,this._getLocalizedLabels("Error"),this),e.statusText},this)},p||delete m.xhrFields,e.ajax(m)},doPostBack:function(t,i){var l=e("<form>").attr({action:t,method:"POST",name:"export"}),a=function(t,i){e('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(l)};for(var r in i)a(r,i[r]);l.appendTo(document.body).submit().remove()},_import:function(e){if(window.FormData&&this._isObject(e)){var t,i=new FormData;for(t in e)"async"!=t&&i.append(t,e[t]);return i}return e},_isObject:function(e){return"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)},refreshPagedPivotGrid:function(e,i){var l;if(this._isUpdateRequired=!0,t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.show()),e=-1!=e.indexOf("categ")?"categorical":"series",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this._isNavigation=!0,"categorical"==e?this.model.dataSource.pagerOptions.categoricalCurrentPage=parseInt(i):this.model.dataSource.pagerOptions.seriesCurrentPage=parseInt(i),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){try{l=JSON.parse(this.getOlapReport()).Report}catch(e){l=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",axis:e,pageNo:i,drillHeaders:JSON.stringify(this._drillHeaders),currentReport:l,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}else this._refPaging();return!1}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)"categorical"==e?this._categCurrentPage=parseInt(i):this._seriesCurrentPage=parseInt(i),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else{try{l=JSON.parse(this.getOlapReport()).Report}catch(e){l=this.getOlapReport()}this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"pagingDeferUpdate",pagingInfo:e+":"+i,currentReport:l,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._deferUpdateSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:e+":"+i,currentReport:l,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}},_refPaging:function(){t.PivotAnalysis._controlObj=this,t.PivotAnalysis._colKeysCalcValues=e.extend(!0,[],this._colKeysCalcValues),t.PivotAnalysis._rowKeysCalcValues=e.extend(!0,[],this._rowKeysCalcValues),t.PivotAnalysis._tableKeysCalcValues=e.extend(!0,[],this._tableKeysCalcValues);var i=t.PivotAnalysis._fillEngine(this.model);this.setJSONRecords(JSON.stringify(i.json)),this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource),this.renderControlFromJSON(i.json)},excelLikeLayout:function(i){var l,a,r,o,n,s,d,h,u,c,p,m,g;for(this._excelRowCount=0,p=0;p<i.length&&0==parseInt(i[p].Index.split(",")[0]);p++)this._excelRowCount++;this._rowCount=this._excelRowCount;var f=jQuery.extend(!0,[],i),_=[],v=[],b=null,C=0;if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(l=e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._pivotClientObj.getOlapReport():this.getOlapReport()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&0==this.model.dataSource.rows.length&&null!=this.model.dataSource.data||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&""!==l&&0==JSON.parse(l).PivotRows.length))return this._excelLikeJSONRecords=null,this._isExporting||this.renderControlFromJSON(),void(this._excelRowCount=0);if(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&null!=f&&""!=f){for(a=null,u="colheader"!=f[0].CSS?f[0].ColSpan*this._excelRowCount:0;u<f.length&&(f[u].Info.toLowerCase().indexOf("[measure")>-1&&(a=parseInt(f[u].Index.split(",")[1])),!(f[u].CSS.indexOf("value")>-1));u++)r=parseInt(f[u].Index.split(",")[1]);for(null!=a&&a!=r&&0!=a&&this._columnExcelLikeLayout(f,a,r),o=f.length/this._excelRowCount,n=0;n<o&&n<f.length;n++)for(s=0;s<=r&&s<f.length;s++)if("colheader"==f[p=n*this._excelRowCount+s].CSS&&"Block"!=f[p].Span&&(-1==f[p].Info.toLowerCase().indexOf("[measure")||f[p].Info.toLowerCase().indexOf("[measure")>-1&&null!=a&&0==a)&&f[p].ColSpan>1){for(m=p;m<p+f[p].RowSpan;m++){for(g=m+this._excelRowCount;g<m+f[p].ColSpan*this._excelRowCount;g+=this._excelRowCount)f[g].Span="Block";m!=p&&(f[m].Span="Block")}if(h=null,f[d=p+(f[p].RowSpan-1)+(f[p].ColSpan-1)*this._excelRowCount+1].CSS.indexOf("summary")>-1&&f[d].Value==this._getLocalizedLabels("Total")&&-1==f[d-this._excelRowCount].CSS.indexOf("summary"))h=d;else if(f[d].CSS.indexOf("summary")>-1&&f[d-this._excelRowCount].CSS.indexOf("e-summary")>-1)for(m=d-this._excelRowCount;m>=0&&m<f.length;m-=this._excelRowCount)if(f[m].ColSpan>1||-1==f[m-this._excelRowCount].CSS.indexOf("e-summary")&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){h=m;break}null!=h&&(f[h].ColSpan=this.model.operationalMode!=t.PivotGrid.OperationalMode.ClientMode?f[h].ColSpan:parseInt(f[d].Index.split(",")[0])-parseInt(f[h].Index.split(",")[0])+1,f[p].ColSpan=f[p].ColSpan-f[h].ColSpan,f[p+f[p].ColSpan*this._excelRowCount]=e.extend(!0,{},f[h]),f[p+f[p].ColSpan*this._excelRowCount].RowSpan=f[h].RowSpan+f[p].RowSpan,f[p+f[p].ColSpan*this._excelRowCount].Value=f[p].Value+" Total")}}if(null!=f&&""!=f&&"colheader"!=f[0].CSS&&(this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode)){if("0,0"==f[0].Index&&"colheader"!=f[0].CSS)for(C=f[0].ColSpan,0==f[0].RowSpan&&(f[0].RowSpan=1),m=0;m<f[0].RowSpan&&m<f.length;m++)_.push(f[m]),f[m].Level=1,f[m].Span="Block";for(u=f[0].RowSpan;u<f.length&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.dataSource.rows.length>0;u+=this._excelRowCount)if(f[u].Info.toLowerCase().indexOf("[measure")>-1){b=parseInt(f[u].Index.split(",")[0]);break}for(p=0;p<f.length&&p<this._excelRowCount;p++)if("rowheader"==f[p].CSS&&0==parseInt(f[p].Index.split(",")[0])&&"Block"!=f[p].Span){for(f[p].Level=1,null!=f[p+this._excelRowCount]&&-1==f[p+this._excelRowCount].CSS.indexOf("value")&&(f[p].itemIndex=f[p+f[p].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),_.push(f[p]),null!=b&&0==b&&f[p].Info.toLowerCase().indexOf("[measure")>-1&&v.push(f[p]),m=p+1;m<p+f[p].RowSpan;m++)(-1==f[m].Info.toLowerCase().indexOf("[measure")||null!=b&&b!=C-1)&&(f[m].Span="Block");this._rowExcelLikeLayout(p,f,_,2,b,v,C)}else("summary rgtot"==f[p].CSS||"summary gtot"==f[p].CSS||"summary calc gtot"==f[p].CSS||"colheader"==f[p].CSS&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||("summary"==f[p].CSS&&f[p].Value.indexOf(this._getLocalizedLabels("Total"))>-1||"summary row"==f[p].CSS)&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot)&&0==parseInt(f[p].Index.split(",")[0])&&(null!=b&&b==C-1&&(f[p].Value+=" "+f[p+this._excelRowCount*parseInt(f[p].ColSpan)].Value),f[p].Value=f[p].Value==this._getLocalizedLabels("Total")?this._getLocalizedLabels("GrandTotal"):f[p].Value,_.push(f[p]),f[p].Level=1);if(null!=b&&0==b){for(p=0;p<v.length;p++)_.push(e.extend(!0,{},v[p])),_[_.length-1].CSS="summary",_[_.length-1].Value=this._getLocalizedLabels("Total")+" "+_[_.length-1].Value;v.splice(0,v.length)}var S,O=_.length,y=0,P=!1;for(p=0;p<O;p++){for(y+=p,S=null!=_[p].itemIndex?_[p].itemIndex:_[p].Index,c=parseInt(S.split(",")[0])*this._excelRowCount+parseInt(S.split(",")[1]);c<f.length;c+=this._excelRowCount)(f[c].CSS.indexOf("value")>-1||f[c].CSS.indexOf("colheader")>-1||f[c].CSS.indexOf("calc")>-1||f[c].CSS.indexOf("cstot")>-1||f[c].CSS.indexOf("cgtot")>-1||f[c].CSS.indexOf("none")>-1)&&parseInt(f[c].Index.split(",")[0])>=C&&(P=!0),P&&(_[y+=this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?parseInt(O):this._excelRowCount]=e.extend(!0,{},f[c]));y=0,P=!1}for(p=0;p<O;p++)null!=_[p]&&(_[p].Span="none",isNaN(_[p].Level)&&(_[p].Level=1),"0,0"==_[p].Index&&"colheader"!=_[p].CSS&&0==p||(_[p].RowSpan=1),_[p].ColSpan=null!=b&&b==C-1&&"rowheader"==_[p].CSS&&-1==_[p].Info.toLowerCase().indexOf("[measure")?_.length/O:null!=b&&0==b&&_[p].Info.toLowerCase().indexOf("[measure")>-1&&"rowheader"==_[p].CSS?_.length/O:null!=b&&b!=C-1&&0!=b&&(_[p].Info.toLowerCase().indexOf("[measure")>-1||"rowheader"==_[p].CSS&&parseInt(_[p].Index.split(",")[0])<b)?_.length/O:1);this._excelRowCount=O}for(null!=f&&0==_.length&&(_=f),m=0;m<_.length/this._excelRowCount;m++)for(g=0;g<this._excelRowCount;g++)_[m*this._excelRowCount+g].i=m+","+g,_[m*this._excelRowCount+g].Span="none";this._excelLikeJSONRecords=_,this._isExporting||this.renderControlFromJSON()},_rowExcelLikeLayout:function(e,i,l,a,r,o,n){for(var s,d,h,u=!1,c=e+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?i[e].ColSpan*this._excelRowCount:this._excelRowCount),p=0;p<i[e].RowSpan&&c<i.length&&-1==i[c].CSS.indexOf("value");c++,p++){if(null!=r&&r!=n-1&&0!=r&&i[c].Info.toLowerCase().indexOf("[measure")>-1&&"Block"!=i[c].Span&&(u=!0),s=null!=r&&r==n-1?"summary row"==i[c].CSS&&("summary row"==i[c+this._excelRowCount].CSS||"none"==i[c+this._excelRowCount].CSS||i[c+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1):null!=r&&r!=n-1&&0!=r&&("summary"==i[c].CSS&&("summary"==i[c+this._excelRowCount].CSS||"none"==i[c+this._excelRowCount].CSS||i[c+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1||parseInt(i[c].Index.split(",")[0])-1<=r)),("rowheader"==i[c].CSS||"none"==i[c].CSS||s)&&"Block"!=i[c].Span){for(h=c+1;h<c+i[c].RowSpan;h++)(-1==i[h].Info.toLowerCase().indexOf("[measure")||null!=r&&r!=n-1)&&(i[h].Span="Block");if(i[c].Level=a,"none"!=i[c].CSS)if(null!=i[c+this._excelRowCount]&&-1==i[c+this._excelRowCount].CSS.indexOf("value")&&(i[c].itemIndex=i[c+i[c].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),s){for(d=c-i[e].ColSpan*this._excelRowCount;d>=0&&d<i.length;d--)if(""!=i[d].Value){i[c].Value=i[d].Value,i[c].Level=i[e].Level;break}null!=r&&r!=n-1&&0!=r&&parseInt(i[c].Index.split(",")[0])-1==r?o.push(i[c]):(i[c].Value+=" "+i[c+this._excelRowCount*parseInt(i[c].ColSpan)].Value,l.push(i[c]))}else l.push(i[c]);i[c].Span="Block","summary row"!=i[c].CSS&&"summary"!=i[c].CSS&&this._rowExcelLikeLayout(c,i,l,a+1,r,o,n)}if(u&&p+1==i[e].RowSpan){for(u=!1,h=0;h<o.length;h++)o[h].Value=i[e].Value+" "+o[h].Value,l.push(o[h]);o.splice(0,o.length)}}},_columnExcelLikeLayout:function(t,i,l){for(var a,r,o,n,s,d,h,u,c,p,m=t.length/this._excelRowCount,g=0;g<m&&g<t.length;g++)for(a=0;a<=l&&a<t.length;a++)if("colheader"==t[r=g*this._excelRowCount+a].CSS&&"Block"!=t[r].Span&&-1==t[r].Info.toLowerCase().indexOf("[measure")&&t[r].ColSpan>1){for(s=r;s<r+t[r].RowSpan;s++){for(u=s+this._excelRowCount;u<s+t[r].ColSpan*this._excelRowCount;u+=this._excelRowCount)t[u].Span="Block";s!=r&&(t[s].Span="Block")}if(t[o=r+(t[r].RowSpan-1)+(t[r].ColSpan-1)*this._excelRowCount+1].Info.toLowerCase().indexOf("[measure")>-1&&JSON.parse(this.getOlapReport()).PivotCalculations.length>1&&null!=i&&i!=l&&0!=i){for(n=[],s=r+t[r].RowSpan;s<=o;s+=(t[s].ColSpan+1)*this._excelRowCount)if(t[d=s+(t[s].RowSpan-1)+(t[s].ColSpan-1)*this._excelRowCount+1].CSS.indexOf("summary")>-1){for(t[d-1].RowSpan=t[d-1].RowSpan+t[d].RowSpan,h=parseInt(t[d].Index.split(",")[0])*this._excelRowCount,u=0;u<this._excelRowCount;u++)t.splice(parseInt(t[o].Index.split(",")[0])*this._excelRowCount+this._excelRowCount+u+n.length*this._excelRowCount,0,e.extend(!0,{},t[h+u]));n.push(h),t[s].ColSpan=t[s].ColSpan-1}for(c=n.length-1;c>=0;c--)t.splice(parseInt(t[n[c]].Index.split(",")[0])*this._excelRowCount,this._excelRowCount);n.length>0&&(t[r].ColSpan=t[r].ColSpan-n.length,t[p=r+t[r].ColSpan*this._excelRowCount].ColSpan=n.length,t[p].RowSpan=t[r].RowSpan,t[p].Value=t[r].Value+" Total",t[p].CSS="summary",t[p].Span="none",t[p].State=0)}else t[o].Info.toLowerCase().indexOf("[measure")>-1&&t[o+1].CSS.indexOf("summary")>-1&&1==JSON.parse(this.getOlapReport()).PivotCalculations.length&&null!=i&&i!=l&&0!=i&&(t[r].ColSpan=t[r].ColSpan-1,t[r+t[r].ColSpan*this._excelRowCount]=e.extend(!0,{},t[o+1]),t[o+1].Value="",t[r+t[r].ColSpan*this._excelRowCount].Value=t[r].Value+" Total",t[r+t[r].ColSpan*this._excelRowCount].RowSpan=t[r].RowSpan)}},_getColumnIndices:function(t,i,l,a){var r="rows"==t?i.Index.split(",")[1]:"columns"==t?i.Index.split(",")[0]:null;return i.Value==l&&(-1==e.inArray(Number(r),a)&&a.push(Number(r))),a},_getParentPosition:function(i,l,a){var r="",o="",n="";for(l=this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||e.isNumeric(l)?l:parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]);o==r&&!t.isNullOrUndefined(this.getJSONRecords()[l]);)o=this.getJSONRecords()[l].Value,(""==r&&""!=o||r==o+" Total"||r+" Total"==o)&&(r=o),"columnheader"==i&&"start"==a?l-=this._rowCount:"rowheader"==i&&"end"==a&&l++,n=o==r?this.getJSONRecords()[l].Index:n,"columnheader"==i&&"end"==a?l+=this._rowCount:"rowheader"==i&&"start"==a&&l--,o=""==o?r:o;return n},_updateRowCells:function(i,l,a,r,o,n){var s,d,h,u,c,p;n&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&l.find("tbody:eq(2) tr:empty").remove();do{if(this.model.enableRTL&&e(e(i).find(".summary,.rowheader,.colheader")).css("text-align","right"),s=e(i).next().children().first().attr("data-p"),d=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?"data-i":"data-p",t.isNullOrUndefined(s))s=e(i).children().first().attr("data-p"),a.find("[data-p='"+s+"']").length>0&&this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout?""!=r&&a.find("[data-p='"+r+"']").parent().length>0?(e(i).clone().insertBefore(a.find("[data-p='"+r+"']").parent()),a.find("[data-p='"+r+"']").parent().remove()):e(i).clone().insertAfter(a.find("[data-p='"+s+"']").parent()):n?(p=l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent(),e(p).eq(1).clone().insertAfter(a.find("tr:last")),e(p).eq(0).clone().insertAfter(a.find(".rowhead tr:last"))):e(i).clone().insertAfter(a.find("tr:last")),a.find("[data-p='"+e(i).children().first().attr("data-p")+"']").parent().last().prev().find("[data-p='"+e(i).children().first().attr("data-p")+"']").parent().remove();else if(n||this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i).children().length>0&&a.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent().remove():a.find("[data-p='"+e(i).children().first().attr("data-p")+"']:not('.e-grpRow')").parent().remove(),""!=r&&a.find("[data-p='"+r+"']").parent().length>0)if(n||e(i).clone().insertBefore(a.find("[data-p='"+r+"']").parent()),n){if(e(i).children().length>0){h=0;do{u=a.find("["+d+"$=',"+parseInt(r.split(",")[1])+"']").parent().eq(h),p=l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent().eq(h).clone(),e(u).length>0?e(p).insertBefore(e(u)):e(p).insertAfter(a.find("["+d+"$=',"+parseInt(l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent().eq(h).prev().children().first().attr(d).split(",")[1])+"']").parent().eq(h)),h++}while(h<2);this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout&&a.find("["+d+"$=',"+parseInt(r.split(",")[1])+"']").parent().remove()}}else this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout&&a.find("[data-p='"+r+"']").parent().remove();else if(n){if(0==a.find("["+d+"$=',"+parseInt(s.split(",")[1])+"']").parent().length){c=e(i).next();do{s=e(c).next().children().length>0?e(c).next().children().first().attr(d):s,c=e(c).next()}while(0==a.find("["+d+"$=',"+parseInt(s.split(",")[1])+"']").parent().length&&e(c).children().length>0)}e(i).children().length>0&&(u=a.find("["+d+"$=',"+parseInt(s.split(",")[1])+"']").parent(),p=l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent(),e(u).length>0?(e(p).eq(0).clone().insertBefore(e(u).eq(0)),e(p).eq(1).clone().insertBefore(e(u).eq(1))):(e(p).eq(1).clone().insertAfter(a.find("tr:last")),e(p).eq(0).clone().insertAfter(a.find(".rowhead tr:last"))))}else if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout)e(i).clone().insertAfter(a.find("tr:last"));else{if(0==a.find("[data-p='"+s+"']").parent().length){c=e(i).next();do{s=e(c).next().children().first().attr("data-p"),c=e(c).next()}while(0==a.find("[data-p='"+s+"']").parent().length&&e(c).children().length>0)}a.find("[data-p='"+s+"']").parent().length>0?e(i).clone().insertBefore(a.find("[data-p='"+s+"']").parent()):e(i).clone().insertAfter(a.find("tr:last"))}i=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i).next():e(i).prev()}while(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i).length>0&&0==e(i).children("[data-p='"+r+"']").length:0==e(i).next().children("[data-p='"+o+"']").length&&e(i).length>0&&e(i).next().children().length>0&&parseInt(e(i).next().children().first().attr("data-p").split(",")[1])>parseInt(o.split(",")[1]))},_getAdjacentRowPos:function(t,i,l){var a,r=[],o=l;do{a=i+","+l,r=e(t.find("[data-p='"+a+"']")),--l<0&&(i-=1,o=l=o+1)}while(0==r.length&&i>-1);return a},_mergeHtml:function(i,l,a,r){var o,n,s,d,h,u,c,p=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,m=a.find("[data-p='"+l+"']").children("span")[0];if("rowheader"==i){var g=parseInt(l.split(",")[1]),f="",_="";if(f=this._getParentPosition(i,this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?l:g,"start"),_=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._getParentPosition(i,l,"end"):_,_=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&0==r.find("[data-p='"+_+"']").parent().length?"drilldown"==this._drillAction?r.find("[data-p='"+l+"']").parent().next().children().first().attr("data-p"):a.find("[data-p='"+l+"']").parent().next().children().first().attr("data-p"):_,"drilldown"==this._drillAction){if(t.isNullOrUndefined(m)){for(o=(parseInt(l.split(",")[0])+1)*this._rowCount+parseInt(l.split(",")[1])-1,_=l;!t.isNullOrUndefined(this._JSONRecords[o])&&this._JSONRecords[o].CSS.indexOf("summary")>-1&&0==e(a.find("[data-p='"+this._JSONRecords[o].Index+"']")).length;)o=o+this._rowCount-1;l=this._JSONRecords[o].Index,l=e(a.find("[data-p='"+l+"']")).length>0?l:this._getAdjacentRowPos(a,parseInt(l.split(",")[0]),parseInt(l.split(",")[1]))}v=e(a.find("[data-p='"+l+"']").children("span")[0]).closest("tr")[0],this._updateRowCells(v,a,r,_,f,p)}else{var v=e(r.find("[data-p='"+l+"']").closest("tr")[0]),b=parseInt(r.find("[data-p='"+l+"']").attr("rowSpan")),C=0,S=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?"data-i":"data-p";do{n=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(v).children().first().attr("data-i"):e(v).children().first().attr("data-p"),v=e(v).next(),p||this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?r.find("["+S+"$=',"+parseInt(n.split(",")[1])+"']").parent().remove():r.find("[data-p='"+n+"']:not('.e-grpRow')").parent().remove(),C++}while(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(v).children().first().attr("data-p")!=_:C<b);v=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?a.find("[data-p='"+l+"']").parent():a.find("[data-p='"+e(v).children().first().attr("data-p")+"']").parent().length>0?a.find("[data-p='"+e(v).children().first().attr("data-p")+"']").parent():p?e(a).find(".rowhead tr:last"):e(a).find("tr:last"),this._updateRowCells(v,a,r,_,f,p)}}else{var O=parseInt(l.split(",")[0])*this._rowCount;f="",_="";f=this._getParentPosition(i,O,"start"),s=!1,this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns.length>0&&e.each(JSON.parse(this.getOlapReport()).PivotColumns,function(e,t){if(0==t.showSubTotal)return s=!0,!1}):this.model.dataSource.columns.length>0&&e.each(this.model.dataSource.columns,function(e,t){if(0==t.showSubTotal)return s=!0,!1}),("drillup"==this._drillAction||s)&&(_=this._getParentPosition(i,O,"end"),l=_);var y=p?e(a).find(".pivotGridFrozenTable,.pivotGridValueTable").find("tr:not(.hdrTr)"):e(a).find("tr:not(.hdrTr)"),P=p?e(r).find(".pivotGridFrozenTable,.pivotGridValueTable").find("tr:not(.hdrTr)"):e(r).find("tr:not(.hdrTr)");for(this.model.enableRTL&&e(y).find(".summary,.rowheader,.colheader").css("text-align","right"),d=0;d<y.length;d++)h=e(y[d]).children().filter(function(){return e(this).attr("data-p").split(",")[0]>parseInt(f.split(",")[0])&&e(this).attr("data-p").split(",")[0]<=parseInt(l.split(",")[0])}),u=e(P[d]).children().filter(function(){return e(this).attr("data-p").split(",")[0]>parseInt(f.split(",")[0])&&e(this).attr("data-p").split(",")[0]<=parseInt(l.split(",")[0])}),0==e(P[d]).children().length?e(P[d]).append(h):e(P[d]).find("").eq(0).prev().length>0?(c=u.eq(0).prev(),u.remove(),h.insertAfter(c)):(u.remove(),e(P[d]).children(".colheader,.rowheader,.summary,.value").eq(0).length>0?h.eq(0).prev().length>0?h.insertAfter(e(P[d]).find('[data-p="'+h.eq(0).prev().attr("data-p")+'"]')):h.insertBefore(e(P[d]).children(".colheader,.rowheader,.summary,.value").eq(0)):e(P[d]).append(h))}},_cropHtml:function(t){return this._table=e(t).clone(),e(e(t)).find('[style*="display: none"]').remove(),t},renderControlFromJSON:function(){var i,l,a,r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C,S,O,y,P,w,N,x,T,M,L,D,I,j,F,R;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this.model.enablePaging||this.model.enableVirtualScrolling)&&0==this._isNavigation&&(i=this,l=setInterval(function(){if(null!=i._pagerObj){clearInterval(l);var e={CategoricalCurrentPage:i.model.dataSource.pagerOptions.categoricalCurrentPage,CategoricalPageSize:i.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:i.model.dataSource.pagerOptions.seriesCurrentPage,SeriesPageSize:i.model.dataSource.pagerOptions.seriesPageSize},t={Column:i._categPageCount,Row:i._seriesPageCount};i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(t,e)}},10)),this._isNavigation=!1,a=null,!t.isNullOrUndefined(this.model.valueSortSettings)&&this.element.find(".valueSorting").length>0&&!t.isNullOrUndefined(t.PivotAnalysis._valueSorting)&&(a=this.element.find(".valueSorting").parent()),r=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords:this.getJSONRecords(),!this.model.enableJSONRendering&&!this.model.enableDefaultValue&&!t.isNullOrUndefined(r)&&r.length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?0==JSON.parse(this.getOlapReport()).PivotCalculations.length&&t.isNullOrUndefined(JSON.parse(this.getOlapReport()).CalculatedMeasure):0==this.model.dataSource.values.length||0==this.model.dataSource.values[0].measures.length)&&(r=e.map(r,function(e){return e.CSS.indexOf("value")>-1&&(e.Value=""),e}),this.setJSONRecords(JSON.stringify(r))),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&0==this.model.dataSource.values.length&&0==this.model.dataSource.rows.length&&(r=r.filter(function(e){return e.Index=Number(e.Index.split(",")[0])-1+","+e.Index.split(",")[1],-1!=e.Index.split(",")[0]?e:void 0})),t.isNullOrUndefined(r)||(r=this._appendCssClassName(r)),this.model.enableConditionalFormatting&&this._isFormatApply&&!t.isNullOrUndefined(r)&&r.length>0&&(r=this._refreshCellFormatting(r)),this.model.enableConditionalFormatting&&!this._isFormatApply&&!t.isNullOrUndefined(r)&&r.length>0&&(r=this._applyCodeBehindFormatting(r)),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(o=e("<div id="+this._id+"Toolbar style='width:"+this._pivotClientObj._gridWidth+";height:"+this._pivotClientObj._gridHeight+";overflow:auto;margin-top:5px;margin-left:5px'></div>")),null!=r&&""!=r)for(g=0;g<r.length;g++)"Total"==r[g].Value&&(r[g].Value=this._getLocalizedLabels("Total")),"Grand Total"==r[g].Value&&(r[g].Value=this._getLocalizedLabels("GrandTotal"));if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this._applyLocale(r),n=e("<table class=\"e-pivotGridTable\" role='grid'  aria-readonly='true'></table>"),this.model.isResponsive&&n.addClass("e-table"),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&n.addClass("e-column-resizeToContent"),(!this.model.enableColumnResizing||this.model.resizeColumnsToFit)&&(this.model.enableColumnResizing||this.model.resizeColumnsToFit)||n.addClass("e-column-resizeToSize"),null!=r&&""!=r||this.model.enableGroupingBar){if(null!=r&&""!=r){for(h=this._rowCount,this._rowCount=0,this,C=0;C<r.length&&0==parseInt(r[C].Index.split(",")[0]);C++)this._rowCount++;if(this._rowCount=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelRowCount:this._rowCount,this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var E,k,A,H,U,z,V,B,G,J,q=this._rowCount,K=!1,Q=!1,$=!1,W=!1,X=e.extend(!0,[],r),Y=t.isNullOrUndefined(this._pivotClientObj)?this.model.subTotalSettings:this._pivotClientObj.model.subTotalSettings,Z=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotRows:this.model.dataSource.rows,ee=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns;if(!t.isNullOrUndefined(Y))for(y=0;y<Y.length;y++){for(P=0;P<Z.length;P++)Y[y].name==(t.isNullOrUndefined(Z[P].Tag)?Z[P].fieldName:Z[P].Tag)&&($=!0);for(P=0;P<ee.length;P++)Y[y].name==(t.isNullOrUndefined(ee[P].Tag)?ee[P].fieldName:ee[P].Tag)&&(W=!0)}if(u=t.isNullOrUndefined(this._pivotClientObj)?this.layout():this._pivotClientObj.gridLayout(),!t.isNullOrUndefined(Y)&&1==$)for(0==(c=X.filter(function(e){return"rowheader"==e.CSS&&1!=e.RowSpan&&1==e.State}))&&(c=X.filter(function(e){return"rowheader"==e.CSS&&1!=e.RowSpan})),g=0;g<Y.length;g++)for(y=0;y<Y[g].levels.length;y++)if(1==Y[g].levels[y].showSubTotal&&"excellikelayout"!=u)for(P=0;P<c.length;P++)if(Y[g].levels[y].name==c[P].Info.split(".&")[0])for(A=c[P].Index.split(",")[0],H=c[P].ColSpan,U=c[P].Index.split(",")[1],f=0;f<X.length;f++)if(("summary"==X[f].CSS||"summary row"==X[f].CSS)&&!t.isNullOrUndefined(X[f].Value)&&!t.isNullOrUndefined(X[f+1])&&X[f].Index.split(",")[0]==X[f+1].Index.split(",")[0]&&X[f].Index.split(",")[0]==(parseInt(A)+H).toString()&&parseInt(U)<=parseInt(X[f].Index.split(",")[1])){if(K=!0,z=X[f].Index.split(",")[1],V=X[f],B=X[f].RowSpan,X.splice(e.inArray(V,X),1),(G=B)>1)for(;1!=G;)V=X[f],X.splice(e.inArray(V,X),1),G--;for(_=0;_<X.length;_++)if(X[_].Index.split(",")[1]==z&&(V=X[_],G=B,X.splice(e.inArray(V,X),1),G>1))for(;1!=G;)V=X[_],X.splice(e.inArray(V,X),1),G--;q-=B;break}if(!t.isNullOrUndefined(Y)&&1==W)for(0==(p=X.filter(function(e){return"colheader"==e.CSS&&1!=e.ColSpan&&1==e.State}))&&(p=X.filter(function(e){return"colheader"==e.CSS&&1!=e.ColSpan})),m=(X.length/this._rowCount-1).toString(),g=0;g<Y.length;g++)for(y=0;y<Y[g].levels.length;y++)if(1==Y[g].levels[y].showSubTotal&&"excellikelayout"!=u)for(P=0;P<p.length;P++)if(Y[g].levels[y].name==p[P].Info.split(".&")[0])for(z=p[P].Index.split(",")[1],B=p[P].RowSpan,U=p[P].Index.split(",")[0],ColSpan=parseInt(p[P].ColSpan)-1,f=0;f<X.length;f++)if(("summary"==X[f].CSS||"summary col"==X[f].CSS)&&parseInt(X[f].Index.split(",")[0])!=m&&parseInt(X[f].Index.split(",")[1])==parseInt(z)+B&&parseInt(X[f].Index.split(",")[0])<=parseInt(U)+ColSpan&&parseInt(U)<=parseInt(X[f].Index.split(",")[0])){for(Q=!0,A=X[f].Index.split(",")[0],V=X[f],H=X[f].ColSpan,Index=f,X.splice(e.inArray(V,X),1),_=0;_<X.length;_++)X[_].Index.split(",")[0]==A&&(V=X[_],colSpancount=(H-1)*q,X.splice(e.inArray(V,X),1),_-=1);if(colSpancount>q)for(;colSpancount>0;)V=X[f-1],X.splice(e.inArray(V,X),1),colSpancount--;f--}if(q!=this._rowCount&&1==K)for(v=X[0].RowSpan;v<X.length;v++)if(("rowheader"==X[v].CSS||"summary"==X[v].CSS||"summary row"==X[v].CSS)&&1!=X[v].RowSpan&&!t.isNullOrUndefined(X[v].State)){for(z=X[v].Index.split(",")[1],J=X[v].Index.split(",")[0],B=0,P=0;P<X[v].RowSpan;P++)parseInt(z)+X[v].RowSpan>X[v+P].Index.split(",")[1]&&J==X[v+P].Index.split(",")[0]&&B++;X[v].RowSpan=B}if(1==Q)for(v=0;v<X.length;v++)if(("colheader"==X[v].CSS||"summary"==X[v].CSS||"summary col"==X[v].CSS)&&1!=X[v].ColSpan&&!t.isNullOrUndefined(X[v].State)){for(z=X[v].Index.split(",")[1],J=X[v].Index.split(",")[0],H=0,P=0;P<X.length;P++)v+P<X.length&&parseInt(J)+X[v].ColSpan>parseInt(X[v+P].Index.split(",")[0])&&z==X[v+P].Index.split(",")[1]&&(H++,P+=q-1);X[v].ColSpan=H}}1==K||1==Q?(E=X,k=t.isNullOrUndefined(q)?this._rowCount:q,this._rowLength=t.isNullOrUndefined(q)?this._rowCount:q):(E=r,k=this._rowCount);var te=e("<thead></thead>"),ie=e("<tbody></tbody>"),le=!0,ae=0;for("none"==E[0].CSS?ae=e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&0==JSON.parse(this._pivotClientObj.getOlapReport()).PivotCalculations.length&&0==JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows.length?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns.length-1:E[0].RowSpan-1:(jQuery.each(E,function(e){return ae+=E[e].RowSpan,"colheader"==E[e].CSS}),ae-=2),re=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,b=!1,C=0;C<E.length;C++)if(C<k)if(le){for(le=!(C>=ae),S="<tr role='row'>",this.model.enableGroupingBar&&"0,0"==E[C].Index&&E[C].CSS.indexOf("colheader")>-1&&(S=S+"<"+(re?"td":"th")+" class='e-grpRow' data-p='-1,-1' colspan= 1 rowspan="+(k-1)+"> <div class=e-rows>"+this._getLocalizedLabels("DragFieldHere")+"</div></th>",b=!0),O=C;O<E.length;O+=k)if("Block"!=E[O].Span)if(S="0,0"==E[O].Index&&-1==E[O].CSS.indexOf("colheader")&&this.model.enableGroupingBar?S+"<"+(re?"td":"th")+" class=e-grpRow data-p="+E[O].Index+" colspan="+E[O].ColSpan+" rowspan="+E[O].RowSpan+" role='columnheader' aria-label='row'"+(null==E[O].i?"":"data-i="+E[O].i)+">"+(0==E[O].State?'<span style="margin-left: 0px"></span>':2==E[O].State?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==E[O].State?'<span class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+E[O].Value+t.buildTag("div.e-rows",this._pivotRow,{})[0].outerHTML+"</th>":S+"<"+(re?"td":"th")+("none"==E[O].CSS?"":' class="'+E[O].CSS)+("none"==E[O].CSS?" data-p="+E[O].Index:'" data-p='+E[O].Index)+" colspan="+E[O].ColSpan+" rowspan="+E[O].RowSpan+" role='columnheader'"+(null==E[O].i?"":"data-i="+E[O].i)+">"+(0==E[O].State?'<span style="margin-left: 10px"></span>':2==E[O].State?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==E[O].State?'<span class="e-collapse e-icon" aria-label=\'expanded\' title=" '+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+E[O].Value+"</th>",E[O].RowSpan>1&&E[O].ColSpan<=1)for(y=O+1;y<O+E[O].RowSpan;y++)t.isNullOrUndefined(E[y])||(E[y].Span="Block");else if(E[O].ColSpan>1&&E[O].RowSpan<=1)for(y=O+k;y<O+E[O].ColSpan*k;y+=k)t.isNullOrUndefined(E[y])||(E[y].Span="Block");else if(E[O].ColSpan>1&&E[O].RowSpan>1)for(y=O;y<O+E[O].RowSpan;y++){for(P=y+k;P<y+E[O].ColSpan*k;P+=k)t.isNullOrUndefined(E[P])||(E[P].Span="Block");y!=O&&(t.isNullOrUndefined(E[y])||(E[y].Span="Block"))}""!=e(S+="</tr>").text()&&e(te).append(S)}else{for(S="<tr role='row'>",0==parseInt(E[C].Index.split(",")[0])&&parseInt(E[C].Index.split(",")[1])==k-1&&b&&(S=S+"<td class='rowheader' data-p='-1,-2' colspan=1 rowspan=1>"+(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout?this._getLocalizedLabels("GrandTotal"):this._getLocalizedLabels("Total"))+"</td>"),O=C;O<E.length;O+=k)if("Block"!=E[O].Span)if(S=E[O].CSS.indexOf("rowheader")>-1||"summary"==E[O].CSS||E[O].CSS.indexOf("summary rstot")>-1||E[O].CSS.indexOf("summary stot")>-1||"summary row"==E[O].CSS||E[O].CSS.indexOf("summary rgtot")>-1?"excellikelayout"==this.layout().toLowerCase()?S+"<"+(re?"td":"th")+("none"==E[O].CSS?"":' class="'+E[O].CSS)+'" data-p='+E[O].Index+" colspan="+E[O].ColSpan+" rowspan="+E[O].RowSpan+" role='rowheader'"+(null==E[O].i?"":"data-i="+E[O].i)+">"+(2==E[O].State?'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+10*E[O].Level+'px" class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==E[O].State?'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+10*E[O].Level+'px" class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+(null!=this._excelLikeJSONRecords&&"summary row"==E[O].CSS?10*E[O].Level:10*(1==E[O].Level?1:E[O].Level+2))+'px">&nbsp;</span>')+E[O].Value+"</th>":S+"<"+(re?"td":"th")+("none"==E[O].CSS?"":' class="'+E[O].CSS)+'" data-p='+E[O].Index+" colspan="+E[O].ColSpan+" rowspan="+E[O].RowSpan+" role='rowheader'>"+(0==E[O].State?'<span style="margin-left: 10px"></span>':2==E[O].State?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==E[O].State?'<span class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+E[O].Value+"</th>":S+"<td"+("none"==E[O].CSS?"":' class="'+E[O].CSS)+'" data-p='+E[O].Index+" colspan="+E[O].ColSpan+" rowspan="+E[O].RowSpan+" role='gridcell'"+(null==E[O].i?"":"data-i="+E[O].i)+">"+(2==E[O].State?'<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==E[O].State?'<span class="e-collapse e-icon" title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+E[O].Value+"</td>",E[O].RowSpan>1&&E[O].ColSpan<=1)for(y=O+1;y<O+E[O].RowSpan;y++)t.isNullOrUndefined(E[y])||(E[y].Span="Block");else if(E[O].ColSpan>1&&E[O].RowSpan<=1)for(y=O+k;y<O+E[O].ColSpan*k;y+=k)t.isNullOrUndefined(E[y])||(E[y].Span="Block");else if(E[O].ColSpan>1&&E[O].RowSpan>1)for(y=O;y<O+E[O].RowSpan;y++){for(P=y+k;P<y+E[O].ColSpan*k;P+=k)t.isNullOrUndefined(E[P])||(E[P].Span="Block");y!=O&&(t.isNullOrUndefined(E[y])||(E[y].Span="Block"))}""!=e(S+="</tr>").text()&&e(ie).append(S)}re?this._renderFrozenGridTable(n,te,ie):(e(n).append(te),e(n).append(ie))}}else s=t.buildTag("tr",t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML),d=t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML,e(n).append(s),e(n).append(d),this._rowCount=0;if(this._unWireEvents(),this._wireEvents(),w=!1,this._pivotClientObj&&"olap"==this._pivotClientObj.model.analysisMode&&"clientmode"==this._pivotClientObj.model.operationalMode&&(w=this._pivotClientObj.model.enableVirtualScrolling||this._pivotClientObj.model.enablePaging),this.model.enableVirtualScrolling||w||!(e(n).find("tr:last > td").length>0)||""!=e(n).find("tr:last").find("td").text()||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||null!=this._pagerObj||e(n).find("tr:last").hide(),this.model.enablePaging||this.model.enableVirtualScrolling||(this._hideGrandTotal(n),this._hideSubTotal(n)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.enableCollapseByDefault||!t.isNullOrUndefined(this.model.collapsedMembers))&&!t.isNullOrUndefined(E))if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableCollapseByDefault){var re=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,oe=t.isNullOrUndefined(this.model.dataSource.data)||t.isNullOrUndefined(this.model.dataSource.rows)?e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows.length:JSON.parse(this.getOlapReport()).PivotRows.length:this.model.dataSource.rows.length,ne=t.isNullOrUndefined(this.model.dataSource.data)||t.isNullOrUndefined(this.model.dataSource.columns)?e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns.length:JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length;for(this.model.collapsedMembers={},T=oe;T>=0;T--)for(N=re?e(n).find(".pivotGridRowTable [data-p^='"+T+",']:has('span.e-collapse')[class^='rowheader']"):e(n).find("th[data-p^='"+T+",']:has('span.e-collapse')[class^='rowheader']"),L=this._getFieldName(N[0]),this.model.collapsedMembers[L]=[],D=0;D<N.length;D++)this.model.collapsedMembers[L].push(e(N[D]).clone().children().remove().end().text()),this._collapseMember(n,e(N[D]).find(".e-collapse"));for(M=ne;M>=0;M--)for(x=e(n).find((re?".pivotGridFrozenTable ":"th")+"[data-p$=',"+M+"']:has('span.e-collapse')[class$='colheader']"),L=this._getFieldName(x[0]),this.model.collapsedMembers[L]=[],D=0;D<x.length;D++)this.model.collapsedMembers[L].push(e(N[D]).clone().children().remove().end().text()),this._collapseMember(n,e(x[D]).find(".e-collapse"))}else t.isNullOrUndefined(this.model.collapsedMembers)||(I=this,e.each(this.model.collapsedMembers,function(i,l){var a,r,o,s,d,h,u,c;l=l;if(I.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(d=0;d<I.model.dataSource.rows.length;d++)I.model.dataSource.rows[d].fieldName==i&&(a=d,r="row");for(d=0;d<I.model.dataSource.columns.length;d++)I.model.dataSource.columns[d].fieldName==i&&(a=d,r="column");if(!t.isNullOrUndefined(a))if("row"==r)for(d=I.model.dataSource.columns.length+1;d<I._rowCount;d+=t.isNullOrUndefined(h)?1:h.rowSpan){for(h=e(n).find("tBody th[data-p='"+a+","+d+"']")[0],u=!1,c=0;c<l.length;c++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[c].toString())){u=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("rowheader")||"rowheader"==e(h).attr("role"))&&u&&e(h).find(".e-collapse").length>0&&I._collapseMember(n,e(h).find(".e-collapse"))}else if("column"==r)for(d=I.model.dataSource.rows.length;d<Math.ceil(I.getJSONRecords().length/I._rowCount);d+=t.isNullOrUndefined(h)?1:h.colSpan){for(h=e(n).find("thead th[data-p='"+d+","+a+"']")[0],u=!1,c=0;c<l.length;c++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[c].toString())){u=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("colheader")||"columnheader"==e(h).attr("role"))&&u&&e(h).find(".e-collapse").length>0&&I._collapseMember(n,e(h).find(".e-collapse"))}}else{for(o=JSON.parse(I.getOlapReport()).PivotRows,s=JSON.parse(I.getOlapReport()).PivotColumns,d=0;d<o.length;d++)o[d].FieldName==i&&(a=d,r="row");for(d=0;d<s.length;d++)s[d].FieldName==i&&(a=d,r="column");if(!t.isNullOrUndefined(a))if("row"==r)for(d=s.length+1;d<I._rowCount;d+=t.isNullOrUndefined(h)?1:h.rowSpan){for(h=e(n).find("tBody th[data-p='"+a+","+d+"']")[0],u=!1,c=0;c<l.length;c++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[c].toString())){u=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("rowheader")||"rowheader"==e(h).attr("role"))&&u&&e(h).find(".e-collapse").length>0&&I._collapseMember(n,e(h).find(".e-collapse"))}else if("column"==r)for(d=o.length;d<Math.ceil(I.getJSONRecords().length/I._rowCount);d+=t.isNullOrUndefined(h)?1:h.colSpan){for(h=e(n).find("thead th[data-p='"+d+","+a+"']")[0],u=!1,c=0;c<l.length;c++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[c].toString())){u=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("colheader")||"columnheader"==e(h).attr("role"))&&u&&e(h).find(".e-collapse").length>0&&I._collapseMember(n,e(h).find(".e-collapse"))}}}));if(this.element.html(""),this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enablePaging||this.model.enableVirtualScrolling||(this.model.enableAdvancedFilter||e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableAdvancedFilter)&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(n=this._cropHtml(n)),this.model.enableGroupingBar?(this.element.append(n),(null==this._JSONRecords||0==this._JSONRecords.length)&&this.element.append(t.buildTag("span",this._getLocalizedLabels("NoRecordsToDisplay"),{display:"inline-block",padding:"10px 0px 0px 0px","font-family":"Segoe UI"})[0].outerHTML),this.model.enableRTL&&this.element.addClass("e-rtl"),this._createFields(n,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())):e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?(e(o).append(n),this.element.append(e(o))):this.element.append(n),(this.model.enableColumnResizing&&this.model.resizeColumnsToFit||this.model.enableColumnResizing&&!this.model.resizeColumnsToFit)&&this._resizeColumnsWidth(),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this._applyFrozenHeaderWidth(E),this.element.find(".e-pivotGridTable").width("auto")),this.model.enableVirtualScrolling&&t.isNullOrUndefined(this._pivotClientObj)&&(this._createVirtualPivotGrid(n),this.model.enableGroupingBar&&this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this.model.enableRTL&&this.element.addClass("e-rtl"),this._applyVScrolling()),t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj.model.enableVirtualScrolling||this._pivotClientObj.model.enablePaging||(this._pivotClientObj.element.find(".e-categPageIndicator, .e-seriesPageIndicator , .e-vScrollThumb, .e-hScrollThumb").remove(),j=t.buildTag("div.e-seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage")+" : ")[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML,this._seriesPageCount>1?(12!=this._pivotClientObj.element.find(".e-vScrollPanel").width()&&this._pivotClientObj.element.width(this._pivotClientObj.element.width()+12),this._pivotClientObj.element.find(".e-vScrollPanel").width(12),this._pivotClientObj.element.find(".virtualScrolling").append(j),this._pivotClientObj.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&this._pivotClientObj.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartAndGrid?this._pivotClientObj.element.find(".virtualScrolling").css("padding-top","10px"):this._pivotClientObj.element.find(".virtualScrolling").css("padding-left","2px")):12==this._pivotClientObj.element.find(".e-vScrollPanel").width()&&(this._pivotClientObj.element.width(this._pivotClientObj.element.width()-12),this._pivotClientObj.element.find(".e-vScrollPanel").width(0)),F=t.buildTag("div.e-categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage")+" : ")[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML,this._categPageCount>1?(12!=this._pivotClientObj.element.find(".e-hScrollPanel").height()&&this._pivotClientObj.element.find(".e-hScrollPanel").height(12),this._pivotClientObj.controlPlacement()==t.PivotClient.ControlPlacement.title&&this._pivotClientObj.element.find(".hsVirtualScrolling").css("margin-top","3px"),this._pivotClientObj.element.find(".hsVirtualScrolling").append(F)):12==this._pivotClientObj.element.find(".e-hScrollPanel").height()&&(this._pivotClientObj.model.isResponsive?this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height(this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height()-6):this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height(150),this._pivotClientObj.model.enableSplitter||this._pivotClientObj.element.find(".e-cubeBrowser").height(this._pivotClientObj.element.find(".e-cubeBrowser").height()-20),this._pivotClientObj.element.find(".e-hScrollPanel").height(0)),this._applyVScrolling(),this._pivotClientObj.element.find(".e-chartContainer").length>0&&this._pivotClientObj.element.find(".e-gridContainer").height(this._pivotClientObj.element.find(".e-chartContainer").height()+5),this._pivotClientObj.model.enableSplitter&&(t.isNullOrUndefined(this._pivotClientObj.element.find(".e-childsplit").data("ejSplitter"))||this._pivotClientObj.element.find(".e-childsplit").data("ejSplitter").refresh(),t.isNullOrUndefined(this._pivotClientObj.element.find(".e-serverchildsplit").data("ejSplitter"))||this._pivotClientObj.element.find(".e-serverchildsplit").data("ejSplitter").refresh())),this.model.enableColumnResizing?this.element.addClass("e-column-resize"):this.element.removeClass("e-column-resize"),this.model.enableRTL?(this.element.addClass("e-rtl"),this.element.find(".groupingBarPivot").addClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .groupingBarPivot, .e-grpRow").css("text-align","right")):(this.element.removeClass("e-rtl"),this.element.find(".groupingBarPivot").removeClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .e-grpRow, .groupingBarPivot ").css("text-align","left")),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen){e("#"+this._id).prepend("<div class='toolBar' style='height:40px,width:"+this.element.find("#PivotGridToolbar").width()+"px'></div>");var se,de="",he=t.buildTag("li#frozenHeaders.e-frozenHeaders e-icon","",{}).attr("aria-label",this._getLocalizedLabels("FrozenHeader")).attr({title:this._getLocalizedLabels("FrozenHeader"),tabindex:0})[0].outerHTML;t.buildTag("li.e-cellSelect e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CellSelection")).attr({title:this._getLocalizedLabels("CellSelection"),tabindex:0})[0].outerHTML;this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(de=t.buildTag("li#collapseByDefault.e-collapseByDefault e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CollapseByDefault")).attr({title:this._getLocalizedLabels("CollapseByDefault"),tabindex:0})[0].outerHTML),se=t.buildTag("li.e-numberFormatting e-icon","",{}).attr("aria-label",this._getLocalizedLabels("NumberFormatting")).attr({title:this._getLocalizedLabels("NumberFormatting"),tabindex:0})[0].outerHTML,t.buildTag("li.e-calculatedField e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CalculatedField")).attr({title:this._getLocalizedLabels("CalculatedField"),tabindex:0})[0].outerHTML,R=t.buildTag("ul",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li#cellEditing.e-cellEditing e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CellEditing")).attr({title:this._getLocalizedLabels("CellEditing"),tabindex:0})[0].outerHTML:" ")+t.buildTag("li#drillThrough.e-drillThrough e-icon","",{}).attr("aria-label",this._getLocalizedLabels("DrillThrough")).attr({title:this._getLocalizedLabels("DrillThrough"),tabindex:0})[0].outerHTML+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode?t.buildTag("li.e-advancedFiltering e-icon","",{}).attr("aria-label",this._getLocalizedLabels("AdvancedFiltering")).attr({title:this._getLocalizedLabels("AdvancedFiltering"),tabindex:0})[0].outerHTML:"")+t.buildTag("li#columnResize.e-columnResize e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ColumnResize")).attr({title:this._getLocalizedLabels("ColumnResize"),tabindex:0})[0].outerHTML+t.buildTag("li.e-toolTip e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ToolTip")).attr({title:this._getLocalizedLabels("ToolTip"),tabindex:0})[0].outerHTML+(this._pivotClientObj.displayMode()==t.PivotClient.DisplayMode.GridOnly?de:"")+t.buildTag("li.rtl e-icon","",{}).attr("aria-label",this._getLocalizedLabels("RTL")).attr({title:this._getLocalizedLabels("RTL"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("ul",t.buildTag("li.e-hyperlinkOptions e-icon","",{}).attr("aria-label",this._getLocalizedLabels("HyperLink")).attr({title:this._getLocalizedLabels("HyperLink"),tabindex:0})[0].outerHTML+t.buildTag("li.e-layouts e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Layouts")).attr({title:this._getLocalizedLabels("Layouts"),tabindex:0})[0].outerHTML+he+t.buildTag("li.e-exporting e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Exporting")).attr({title:this._getLocalizedLabels("Exporting"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("ul",t.buildTag("li#summaryCustomize.e-summaryCustomize e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SummaryCustomization")).attr({title:this._getLocalizedLabels("SummaryCustomization"),tabindex:0})[0].outerHTML+t.buildTag("li.e-conditionalFormat e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ConditionalFormatting")).attr({title:this._getLocalizedLabels("ConditionalFormatting"),tabindex:0})[0].outerHTML+("pivot"==this._pivotClientObj.model.analysisMode&&"clientmode"==this._pivotClientObj.model.operationalMode?t.buildTag("li.e-summaryTypes e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SummaryTypes")).attr({title:this._getLocalizedLabels("SummaryTypes"),tabindex:0})[0].outerHTML+se:""))[0].outerHTML,e(".toolBar").append(R),e(".toolBar").ejToolbar({enableRTL:this.model.enableRTL,height:"35px",enableSeparator:!0})}this._stateMaintenance(),""!=e.trim(this.model.pivotTableFieldListID)&&this._isSchemaInitialize&&this.model.enablePivotFieldList&&this._renderPivotSchemaDesigner(),this.model._isXMLImport&&""!=e.trim(this.model.pivotTableFieldListID)&&(this.model.enablePivotFieldList?(e("#"+this.model.pivotTableFieldListID).css("display",""),this._renderPivotSchemaDesigner()):e("#"+this.model.pivotTableFieldListID).css("display","none"),this.model._isXMLImport=!1),null!=this._schemaData&&this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),this.exportRecords=1==K||1==Q?E:r,t.Pivot.closePreventPanel(this),this._schemaData&&t.Pivot.closePreventPanel(this._schemaData),null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(this._rowCount=h),this.model.valueSortSettings&&this._refreshValueSortIcons(a),this.model.enableGroupingBar&&this.element.find(".e-pivotGridTable").width()>0&&(!(0==this.element.find(".values .e-pvtBtn, .columns .e-pvtBtn").length&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)&&this.element.find("tbody .value").length>0&&this.element.find("thead tr").length>0&&this.element.find(".groupingBarPivot").width(this.element.find(".e-pivotGridTable").width()),this.model.enableColumnResizing&&(this.element.find(".groupingBarPivot").css({overflow:"hidden"}),this.element.find(".e-pivotGridTable").width()+1==this.element.width()&&this.element.find(".groupingBarPivot").css({width:"100%"}))),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._applyFrozenHeaderWidth(this._JSONRecords),this._applyHeaders()},_refreshValueSortIcons:function(i){var l,a;t.isNullOrUndefined(this.model.valueSortSettings.headerText)||""==this.model.valueSortSettings.headerText||t.isNullOrUndefined(t.PivotAnalysis._valueSorting)?t.isNullOrUndefined(i)||0!=e(i).find(".rowheader").length||this.element.find("[data-p='"+Number(e(i).attr("data-p").split(",")[0])+","+Number(e(i).attr("data-p").split(",")[1])+"']").html(i.html()):(l=this.element.find("[data-p='"+Number(t.PivotAnalysis._valueSorting)+","+Number(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length)+"']"),0!=e(l).find(".valueSorting").length||e(l).hasClass("rowheader")||(a=t.buildTag("span.valueSorting e-icon "+t.PivotAnalysis._sort).css("margin-left","5px").attr("role","button").attr("aria-label","sort")[0].outerHTML,e(l).append(a)))},_applyHeaders:function(){var i,l,a,r,o,n;if(null!=this._JSONRecords){var s=[],d=[],h={},u=[],c=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode;if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap||!this.model.headerSettings.showColumnItems&&!this.model.headerSettings.showRowItems||this.model.enableGroupingBar){if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.headerSettings.showColumnItems||this.model.headerSettings.showRowItems)&&"excellikelayout"!=this.model.layout&&!this.model.enableGroupingBar&&(c&&JSON.parse(this.getOlapReport()).PivotCalculations.length||!c&&this.model.dataSource.values[0].measures.length)&&("columns"==this._getAxis()||"rows"==this._getAxis())){for(i=0,l=-1,o=0;o<Number(this.element.find(".value:first").attr("data-p").split(",")[1])-1;o++)d[o]="";for(o=0;o<this._JSONRecords.length;o++)if(""!=this._JSONRecords[o].Info&&this._JSONRecords[o].Info.split("::")[1].indexOf("Measures")>-1&&"colheader"==this._JSONRecords[o].CSS){l=Number(this._JSONRecords[o].Index.split(",")[1]);break}for(o=0;o<this._JSONRecords.length;o++)"value"!=this._JSONRecords[o].CSS&&" value"!=this._JSONRecords[o].CSS&&("rowheader"==this._JSONRecords[o].CSS&&""!=this._JSONRecords[o].Info&&-1==e.inArray(e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text(),s)&&-1==e.inArray(this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,""),s)&&-1===this._JSONRecords[o].Info.indexOf("Measure")&&(e(this.element).parents(".e-pivotclient").length>0?s.push(e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text()):s.push(this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,"")),this.element.find("[data-p*='"+this._JSONRecords[o].Index.split(",")[0]+",'] .collapse").parent().not(".colheader").length>0?u.push(e(this.element.find("[data-p*='"+this._JSONRecords[o].Index.split(",")[0]+",'] .collapse").parent().not(".colheader")[0]).width()):u.push(this.element.find("[data-p='"+this._JSONRecords[o].Index.split(",")[0]+","+this._JSONRecords[o].Index.split(",")[1]+"']").width()),o+=this._rowCount-o%this._rowCount),"colheader"==this._JSONRecords[o].CSS&&""!=this._JSONRecords[o].Info&&(-1==e.inArray(e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text(),d)||-1==e.inArray(this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,""),d))&&-1===this._JSONRecords[o].Info.indexOf("Measure")&&(i=-1!=l?l>Number(this._JSONRecords[o].Index.split(",")[1])?0:1:0,d[Number(this._JSONRecords[o].Index.split(",")[1])-i]=e(this.element).parents(".e-pivotclient").length>0?e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text():this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,"")));h={rows:s,columns:d}}}else if(c&&(JSON.parse(this.getOlapReport()).PivotRows.length>0||JSON.parse(this.getOlapReport()).PivotColumns.length>0)&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0||!c&&(this.model.dataSource.rows.length>0||this.model.dataSource.columns.length>0)&&this.model.dataSource.values.length>0){for(o=0;o<(c?JSON.parse(this.getOlapReport()).PivotRows.length:this.model.dataSource.rows.length);o++)s.push(c?JSON.parse(this.getOlapReport()).PivotRows[o].FieldHeader:this.model.dataSource.rows[o].fieldCaption);for(o=0;o<(c?JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length);o++)d.push(c?JSON.parse(this.getOlapReport()).PivotColumns[o].FieldHeader:this.model.dataSource.columns[o].fieldCaption);h={rows:s,columns:d}}if(!e.isEmptyObject(h)&&(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&h.rows.length>0||"pivot"==this.model.analysisMode)){for(this.element.find(".e-pivotGridTable")&&(a=this.element.find(".e-pivotGridTable").find("tbody>tr:eq(0)"),t.isNullOrUndefined(a)||jQuery.each(e(a).find("th"),function(t,i){e(i).hasClass("rowheader")&&u.push(e(i).width())})),r=e("<table></table>").css({width:this.element.find(".colfreeze").length>0?this.element.find(".colfreeze").width()+10:this.element.find("[p='0,0']").width()+10,height:this.element.find(".colfreeze").length>0?this.element.find(".colfreeze").height()+10:this.element.find("[p='0,0']").height()+10}).attr({id:"hdrSec"}),o=0;o<h.columns.length+1;o++)if(s=e("<tr></tr>").attr({class:"hdrTr"}).appendTo(r),h.rows.length>0)for(n=0;n<h.rows.length;n++)e('<td class="e-headerItem"></td>').css("width",n==h.rows.length-1&&o<h.columns.length?u[h.rows.length-1]:u[n]).text(n==h.rows.length-1&&o<h.columns.length&&this.model.headerSettings.showColumnItems?this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?h.columns[o].split(".")[h.columns[o].split(".").length-1]:h.columns[o]:o==h.columns.length&&this.model.headerSettings.showRowItems?this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?h.rows[n].split(".")[h.rows[n].split(".").length-1]:h.rows[n]:"").attr("title",n==h.rows.length-1&&o<h.columns.length&&this.model.headerSettings.showColumnItems?h.columns[o]:o==h.columns.length&&this.model.headerSettings.showRowItems?h.rows[n]:"").appendTo(s);else this.model.headerSettings.showColumnItems&&e('<td class="e-headerItem"></td>').css("width",u[0]).text(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?h.columns[o].split(".")[h.columns[o].split(".").length-1]:h.columns[o]).attr("title",h.columns[o]).appendTo(s);this.element.find(".colfreeze").length>0?(this.element.find(".colfreeze").css("visibility","visible").html(""),r.appendTo(this.element.find(".colfreeze"))):(this.element.find("[data-p='0,0']").css({padding:"0px"}).html(""),r.appendTo(this.element.find("[data-p='0,0']")))}}},_applyLocale:function(i){var a,r,o,n,s,d,h;if(0!=this.model.dataSource.values.length){for(a=!1,o=0;o<this.model.dataSource.values[0].measures.length;o++)if(this.model.dataSource.values[0].measures[o].format){a=!0;break}if(a)for(r=this._getAxis(),o=0;o<this.model.dataSource.values[0].measures.length;o++){var u,c=[],p=[],m=this.model.dataSource.values[0].measures[o].format;for(n=0;n<i.length;n++)p=this._getColumnIndices(r,i[n],this.model.dataSource.values[0].measures[o].fieldCaption,c);for(s=0;s<p.length;s++)for(d=0;d<i.length;d++)("rows"==r?i[d].Index.split(",")[1]:"columns"==r?i[d].Index.split(",")[0]:null)==p[s]&&""!=i[d].Value&&(u=(u=i[d].Value.replace(/[\s,%]/g,"")).replace(t.preferredCulture(this.model.locale).numberFormat.currency.symbol,""),e.isNumeric(u)&&m!=l&&(h=t.olap.base._getFormatedValue(u,m),i[d].Value=h))}}},_renderPivotSchemaDesigner:function(){var i,l,a;e("#"+this.model.pivotTableFieldListID).length>0&&(null!=(i=e("#"+this.model.pivotTableFieldListID).data("ejPivotSchemaDesigner"))?(i.model.pivotControl=this,i.model.enableWrapper=!0,i._load(),this._waitingPopup&&this._waitingPopup.hide(),this._isSchemaInitialize=!1):(l=this,a=setInterval(function(){var i=e("#"+l.model.pivotTableFieldListID).data("ejPivotSchemaDesigner");null!=i&&(clearInterval(a),i.model.pivotControl=l,i.model.enableWrapper=!0,i._load(),l._waitingPopup&&l._waitingPopup.hide(),l._isSchemaInitialize=!1,t.isNullOrUndefined(i.model.pivotControl)||i.model.pivotControl.element.find(".colheader, .rowheader, .value").addClass("e-droppable"))},10)))},_renderFrozenGridTable:function(i,l,a){var r,o,n,s,d,h,u,c,p,m=e("<table class=\"pivotGridFrozenTable\" style='height:47px' ></table>"),g=e('<table class="pivotGridRowTable" ></table>');r=e('<table class="pivotGridValueTable" ></table>'),o=e("<thead></thead>"),n=e("<tbody></tbody>"),s=e("<tbody></tbody>"),d="<tr role='row'>",h=e("<div class='rowhead' style='position: relative; float: left;display: inline-block'>"),e(o).append(e(l).children()),u=a.children().clone(),c=a.children().clone(),e(c).find(".value").remove(),e(n).append(e(c)),e(g).append(n),e(h).append(g),e(u).find(".rowheader, .summary:not(.summary.value)").remove(),e(s).append(e(u));var f=e(t.buildTag("div.colhead").css({position:"relative",overflow:"hidden"})[0].outerHTML),_=e(t.buildTag("div.colmovable")[0].outerHTML),v=e(t.buildTag("div.colfreeze").css({float:"left",height:"100%",visibility:this.model.enableGroupingBar?"visible":"hidden"})[0].outerHTML);e(f).append(e(m).append(o)),0==e(d).children().length&&(d=e("<tr role='row'></tr>")),e(d).length>0&&(e(_).append(f),e(v).append(e("<table id='colfretable' style='height:100%'></table>").append(d)));var b=e(t.buildTag("div#rowvaluecontent.valScrollArea")[0].outerHTML),C=e(t.buildTag("div.valueCell").css({position:"relative"})[0].outerHTML),S=e(t.buildTag("div.rowHeaderArea")[0].outerHTML);e(C).append(e(r).append(s)),!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(e(i).append("<tr><td style='padding:0px'></td></tr><tr><td style='padding:0px'></td></tr>"),e(i).find("tr:first td:eq(0)").append(e("<div id='headerContent' class='headerContent'></div>")),e(e(i).find("tr:last td:eq(0)")).append(e(b)),e(i).find(".headerContent").append(_),e(i).find(".headerContent .colhead").prepend(v),e(i).find(".headerContent .colhead").append("<div class='headerTable'/>"),e(i).find(".pivotGridFrozenTable").appendTo(e(i).find(".headerTable")),e(i).find(".valScrollArea").append(e(S)),e(i).find(".rowHeaderArea").append(h,C)):this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(e(i).append("<tr ><td style='padding:0px;border-right:0px' ></td><td style='padding:0px;'></td></tr>"),e(i).find("tr:first td:eq(0)").append(e("<div id='headerContent' class='headerContent' style='position:relative'></div>")),e(i).find(".headerContent").append(v,h),e(i).find("tr td:last").append(e(b)),e(i).find(".valScrollArea").append(e(S)),e(i).find(".rowHeaderArea").append(_,C)):(e(i).append("<tr><td style='padding:0px'></td><td style='padding:0px;'></td></tr><tr><td style='padding:0px'></td><td style='padding:0px' class='valueArea'></td></tr>"),e(i).find("tr:first td:eq(0)").append(v),e(i).find("tr:first").children("td:eq(1)").append(_),e(i).find("tr:last td:eq(0)").append(e(S)),e(i).find(".rowHeaderArea").append(h),e(i).find(".valueArea").append(e(b)),e(i).find(".valScrollArea").append(C)),this.model.enableGroupingBar?e(i).find(".e-grpRow").length>0&&(e(i).find(".e-grpRow").appendTo(e(i).find(".colfreeze table tr:eq(0)")),e(i).find(".e-grpRow").removeAttr("colspan").removeAttr("rowspan")):(e(i).find("[data-p='0,0']").length>0||e(i).find("[data-p='-1,-1']").length>0)&&(this.model.enablePaging||this.model.enableVirtualScrolling?e(i).find(".rowheader").length>0||e(i).find(".rstot").length>0||e(i).find(".rgtot").length>0:e(i).find(".rowheader").length>0)&&(p=e(i).find("[data-p='-1,-1']").length>0?"-1,-1":"0,0",e(i).find("[data-p='"+p+"']").appendTo(e(i).find(".colfreeze table tr:eq(0)")),e(i).find("[data-p='"+p+"']").removeAttr("colspan").removeAttr("rowspan"))},_applyFrozenHeaderWidth:function(i){var l,a,r,o,n;if((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&!t.isNullOrUndefined(i)&&i.length>0){(l=this.element.find(".e-scroller").data("ejScroller"))&&(l.destroy(),e(this.element).css("overflow",""),this.element.find(".pivotGridRowTable, .pivotGridValueTable , .pivotGridFrozenTable").removeAttr("style")),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.element.find(".pivotGridValueTable,.pivotGridFrozenTable").addClass("rowFrozenTable"):this.element.find(".pivotGridValueTable,.pivotGridFrozenTable").removeClass("rowFrozenTable"),this.element.find(".pivotGridFrozenTable colgroup, .pivotGridValueTable colgroup").remove();var s=e("<colgroup></colgroup>"),d=this.element.find(".pivotGridFrozenTable"),h=this.element.find(".pivotGridRowTable tr:visible").index(),u=this.element.find(".pivotGridValueTable tr:eq("+h+") td");for(a=0;a<u.length;a++)r=e(u[a]).attr("data-p").split(",")[0],o=d.find("[data-p^='"+r+",']"),o=t.isNullOrUndefined(o.last().attr("colSpan"))||"1"==o.last().attr("colSpan")?e(o).last():o[o.length-2],e(u[a]).is(":visible")&&s.append("<col style='width:"+Math.max(e(o).outerWidth(),e(u[a]).outerWidth())+"px'>");this.element.find(".pivotGridFrozenTable, .pivotGridValueTable").prepend(s),this.model.enableColumnGrandTotal||this.element.find(".pivotGridValueTable tr:visible:eq(0) td:visible").length==e(s).children().length||(n=parseInt(this.element.find(".pivotGridFrozenTable tr:first td:last").attr("colspan")),this.element.find(".pivotGridFrozenTable colgroup col").slice(-n).remove(),this.element.find(".pivotGridValueTable colgroup col").slice(-n).remove()),this._refreshScroller()}},_refreshScroller:function(){var i,l=t.isNullOrUndefined(this.model.frozenHeaderSettings.scrollerSize)?18:this.model.frozenHeaderSettings.scrollerSize,a=!t.isNullOrUndefined(this._pivotClientObj)&&e("#"+this._pivotClientObj._id+"_PivotGridToolbar").length>0,r=a?e("#"+this._pivotClientObj._id+"_PivotGridToolbar"):[];if(this.element.find(".values").width()>this.element.find(".pivotGridRowTable").width()&&this.element.find(".pivotGridRowTable").width(this.element.find(".values").width()),this.element.find(".pivotGridValueTable .value:visible").length>0){if(this.element.find(".pivotGridFrozenTable").height(this.element.find(".colfreeze").height()),!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders){if(this._removeFrozenBorders(),this.element.find(".headerContent").width(this.element.width()),this.element.find(".colfreeze").css({width:this.element.find(".pivotGridRowTable").width(),float:this.model.enableRTL?"right":"left"}),this.element.find(".pivotGridFrozenTable").height()>this.element.find(".colfreeze").height()?this.element.find(".colfreeze").height(this.element.find(".pivotGridFrozenTable").height()):this.element.find(".pivotGridFrozenTable").height(this.element.find(".colfreeze").height()),this.element.find(".valueCell").css({display:"inline-block",width:this.element.width()-this.element.find(".pivotGridRowTable").width()}),this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").css({width:"100%","table-layout":"fixed"}),this.element.find(".headerContent").css({position:"relative",overflow:"hidden"}),this.element.find(".colmovable").css({display:"inline",position:"relative",overflow:"hidden"}),this.element.find(".headerContent").height(this.element.find(".headerTable").height()),p=0,c=0,this.element.find(".pivotGridValueTable").height()>0){var o=this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0,n=this.element.find(".headerContent").height(),s=n+this.element.find(".valueCell").height()+o,d=this.element.height(),h=this.element.find(".e-pivotGridTable").width(),u=this.element.find(".pivotGridValueTable").width()+this.element.find(".pivotGridRowTable").width();a&&(e(r).css("overflow","hidden"),d=e(r).height(),u=this.element.find(".pivotGridValueTable").width()+this.element.find(".pivotGridRowTable").width(),h=e(r).width()),p=(d>s?s:d)-n-o,c=h>u?u:h,a&&(this.element.find(".valueCell").width(e(r).width()-this.element.find(".pivotGridRowTable").width()-5),(c=this.element.find(r).width()-3)<0&&(c=200))}this.element.find("#rowvaluecontent").ejScroller({scroll:this._applyScroll,scrollerSize:l,width:c,height:p,targetControl:this,enableRTL:this.model.enableRTL}),this.model.enableRTL&&this.element.find(".rowhead").css({float:this.model.enableRTL?"right":"left"}),this.element.find(".e-vscrollbar").length>0&&(this.element.find(".valueCell").width(this.element.find(".valueCell").width()-l),this.element.find(".headerContent").width(this.element.find(".headerContent").width()-(a?28.5:18))),this.element.find(".headerTable").css({display:"inline-block",width:this.element.find(".valueCell").width()}),this.model.enableGroupingBar&&(this.element.find(" .groupingBarPivot").width("100%"),i=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(i),this.element.find(".rowhead").width()<this.element.find(".colfreeze").width()&&(this.element.find(".colfreeze").width(this.element.find(".rowhead").width()),this.element.find(".columns").width("auto")),this.element.find(".columns").css({height:"auto",width:"calc(100% -  "+this.element.find(".values").width()+")"}))}else if(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders){if(this._removeFrozenBorders(a),o=this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0,this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").css({width:"100%","table-layout":"fixed"}),this.element.find(".colfreeze").height(this.element.find(".pivotGridFrozenTable").height()),this.element.find(".colhead").css("overflow","visible"),p=0,c=0,this.element.find(".pivotGridValueTable").height()>0){s=this.element.height(),a&&(s=e(r).height()-5);d=this.element.find(".rowHeaderArea").height(),u=this.element.width()-this.element.find(".headerContent").width();c=(h=this.element.find(".pivotGridValueTable").width())>u?u:h,p=(d>s?s:d)-o,a&&c<0&&(c=200)}this.element.find(".pivotGridRowTable").css({width:"100%","table-layout":"fixed"}),this.element.find("#rowvaluecontent").ejScroller({scrollerSize:l,scroll:this._applyScroll,width:c,height:p,targetControl:this,enableRTL:this.model.enableRTL}),this.element.find(".headerContent").css({height:this.element.find("#rowvaluecontent").height(),overflow:"hidden","border-right":"0px"}),this.element.find(".rowhead").css("padding-bottom",this.element.find("#rowvaluecontent .e-hscrollbar").length>0?l:"0px"),this.model.enableGroupingBar&&(this.element.find(" .groupingBarPivot,.colfreeze").width("100%"),i=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(i),this.element.find(".columns").width(this.element.find(".valueColumn").width()-this.element.find(".values").width()-5),this.element.find(".columns").css("height","auto"))}else{this._removeFrozenBorders(),this.element.find(".rowhead").css({overflow:"hidden",width:this.element.find(".pivotGridRowTable").width()}),s=this.element.height()-(this.element.find(".colhead").outerHeight()+(this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0)),a&&(s=e(r).outerHeight()-(this.element.find(".colhead").outerHeight()+(this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0))),d=this.element.find(".pivotGridValueTable").height(),this.element.find(".rowhead").height(d>s?s:d),this.element.find(".colfreeze").width(this.element.find(".pivotGridRowTable").width()),this.element.find(".pivotGridFrozenTable, .pivotGridValueTable").css({width:"100%","table-layout":"fixed"});u=this.element.width()-this.element.find(".pivotGridRowTable").width()-3;var c=(h=this.element.find(".pivotGridValueTable").width())>u?u:h,p=this.element.find(".rowhead").height()+(h>u?l:0);a&&(this.element.find(".rowhead").height(this.element.find(".rowhead").height()-10),this.element.find(".rowhead, .colfreeze").width(this.element.find(".pivotGridRowTable").width()-5),p=this.element.find(".rowhead").height(),c<0&&(c=200)),this.element.find("#rowvaluecontent").ejScroller({scroll:this._applyScroll,width:c,height:p,targetControl:this,scrollerSize:l,enableRTL:this.model.enableRTL}),a&&this.element.find(".rowhead, .pivotGridRowTable").width("100%"),this.element.find(".colmovable").width(this.element.find(".valueCell").width()),this.element.find("#rowvaluecontent .e-hscrollbar").length>0?(this.element.find(".rowhead").css("margin-bottom",l),this.element.find(".rowhead").addClass("frozenBorderBtmClr")):(this.element.find(".rowhead").css("margin-bottom","0px"),this.element.find(".rowhead").removeClass("frozenBorderBtmClr")),this.element.find(".colhead , .colfreeze").height(this.element.find(".pivotGridFrozenTable").height()),this.element.find(".e-rows").height()>this.element.find(".colfreeze").height()&&this.element.find(".colmovable .colhead .pivotGridFrozenTable thead tr,.colfreeze").height(this.element.find(".e-rows").height()+15),this.element.find(".pivotGridFrozenTable").height("100%"),this.element.find(".rowhead").height(this.element.find(".valueCell").height()),0!=this.element.find(".e-scroller .e-hscroll").length||this.model.enableVirtualScrolling||this.element.find(".e-scroller").height("auto"),this.model.enableGroupingBar&&(i=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(i),this._refreshGroupingBarLayout())}this.element.find(".rowhead").scrollTop(0),this.element.find(".groupingBarPivot ").width(this.element.find(".e-pivotGridTable").width())}else e(this.element).css("overflow","auto"),this.element.find(".headerTable").css("display","inline-block"),this.element.find(".valScrollArea").css("height","100%")},_removeFrozenBorders:function(t){var l,a,r,o=this.model.enableRTL,n=this.element;if(t&&(l=t?e("#"+this._pivotClientObj._id+"_PivotGridToolbar"):[],e(l).css("overflow","hidden"),l.width()<this.element.find(".pivotGridRowTable").width()&&e(l).css("overflow","auto"),l.height()<this.element.find(".e-pivotGridTable").height()&&e(l).css("overflow","auto")),this.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders){for(n.find(".colhead").css({"border-right":"1px solid rgb(200, 200, 200)"}),n.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-collapse":"collapse","border-spacing":"0"}),n.find(".pivotGridRowTable tr td:last-child").css({"border-collapse":"collapse","border-spacing":"0"}),n.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-collapse":"collapse","border-spacing":"0"}),n.find(".pivotGridFrozenTable,  .pivotGridFrozenTable tr:nth-child(1) td").css({"border-collapse":"collapse"," border-spacing":"0","border-top":"0px"}),n.find(".colfretable .e-grpRow").css({"border-top":"0px"}),n.find(".pivotGridValueTable tr:visible:eq(0) td, .pivotGridRowTable tr:visible:eq(0) td").css("border-top","0px"),o?(n.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-right":"0px"}),n.find(".pivotGridRowTable tr td:last-child").css({"border-left":"0px"}),n.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-right":"0px"}),n.find(".colfretable .e-grpRow").css({"border-right":"0px","border-left":"0px"})):(n.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-left":"0px"}),n.find(".pivotGridRowTable tr td:last-child").css({"border-right":"0px"}),n.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-left":"0px"}),n.find(".colfretable .e-grpRow").css({"border-left":"0px","border-right":"0px"})),a=n.find(".pivotGridValueTable tr").length,i=0;i<a;i++)o?(n.find(".pivotGridValueTable tr:eq("+i+") td:visible:eq(0)").css("border-right","0px"),n.find(".pivotGridValueTable tr:eq("+i+") td:visible:last").css("border-left","0px")):(n.find(".pivotGridValueTable tr:eq("+i+") td:visible:eq(0)").css("border-left","0px"),n.find(".pivotGridValueTable tr:eq("+i+") td:visible:last").css("border-right","0px"));for(n.find(".pivotGridFrozenTable td").css("border-bottom","0px"),r=this.element.find(".pivotGridFrozenTable tr").length,i=0;i<r;i++)o?(n.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:eq(0)").css("border-right","0px"),n.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:last").css("border-left","0px")):(n.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:eq(0)").css("border-left","0px"),n.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:last").css("border-right","0px"));n.find(".pivotGridRowTable tr:visible:last td").css("border-bottom","0"),n.find(".pivotGridValueTable tr:visible:last td").css("border-bottom","0")}else this.element.find(".pivotGridFrozenTable tr:first td").css("border-top","0px"),this.element.find(".pivotGridRowTable tr td:first-child").css(this.model.enableRTL?"border-right":"border-left","0px"),this.element.find(".pivotGridRowTable tr td:last-child").css(this.model.enableRTL?"border-left":"border-right","0px"),this.element.find(".pivotGridFrozenTable tr:last td").css("border-bottom","0px"),!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders?(this.element.find(".pivotGridFrozenTable tr td:first-child").css(this.model.enableRTL?"border-right":"border-left","0px"),this.element.find(".pivotGridValueTable tr:last td").css("border-bottom","0px"),this.element.find(".pivotGridValueTable tr td:visible:eq(0)").attr("p")&&this.element.find(".pivotGridValueTable tr td[p^='"+this.element.find(".pivotGridValueTable tr td:visible:eq(0)").attr("p").split(",")[0]+",']").css(this.model.enableRTL?"border-right":"border-left","0")):this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&(this.element.find(".pivotGridRowTable  tr:eq(0) td").css("border-top","0px"),this.element.find(".pivotGridValueTable tr:eq(0) td").css("border-top","0px"))},_applyScroll:function(){this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.targetControl.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders?(this.isVScroll()&&this.model.targetControl.element.find(".rowhead").scrollTop(this.model.scrollTop),this.isHScroll()&&this.model.targetControl.element.find(".colhead").scrollLeft(this.model.scrollLeft)):!this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.isHScroll()&&this.model.targetControl.element.find(".colhead").scrollLeft(this.model.scrollLeft):this.isVScroll()&&this.model.targetControl.element.find(".headerContent").scrollTop(this.model.scrollTop)},_setGroupingBarFrozenRowBtnWidth:function(){var t,i;(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders&&(!this.model.frozenHeaderSettings.enableFrozenRowHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders))&&this.element.find(".pivotGridRowTable").outerWidth()>=this.element.find(".e-grpRow").outerWidth()&&this.element.find(".pivotGridRowTable").css("min-width",this.element.find(".e-grpRow").outerWidth()),this.element.find(".e-grpRow .e-removeBtn, .e-grpRow .filter, .e-grpRow .e-sorting ").css("position","inherit"),this.element.find(".colfreeze .e-pivotButton").width("auto");var l=this.element.find(".pivotGridRowTable").width(),a=this.element.find(".colfreeze .e-pivotButton"),r=l/a.length;if(l<r&&(r=l-40),this.element.find(".e-rows").width()>l){a.length;var o=0,n=0;e.each(this.element.find(".e-rows .e-pivotButton"),function(t,i){o+=e(i).width()}),e.each(this.element.find(".e-rows .e-pivotButton .e-pvtBtn"),function(t,i){n+=e(i).width()}),r-(t=(o-n)/a.length)<40&&(r=t+40)*a.length,this.element.find(".e-rows .e-pivotButton").width(r-20),this.element.find(".e-rows .e-pvtBtn").css({width:r-10-t,"text-overflow":"ellipsis"}),this.element.find(".e-rows").css({"white-space":"nowrap"}),i=this.element.find(".colfreeze .e-pivotButton:eq(0)").outerWidth()*a.length+30,this.element.find(".pivotGridRowTable,.rowhead,.colfreeze table,.valueColumn span.values").width(i)}},_refreshGroupingBarLayout:function(){this.element.find(".e-pivotGridTable .value").length>0||this.element.find(".e-pivotGridTable .colheader").length>0?this.element.find(".groupingBarPivot ").width(this.element.find(".e-pivotGridTable").width()):this.element.find(".pivotGridRowTable").length>0?this.element.find(".groupingBarPivot ").width(this.element.find(".pivotGridRowTable").width()+140):this.element.find(".groupingBarPivot ").width(330);var e=this.element.find(".pivotGridRowTable").width();this.element.find(".e-grpRow ,.values").width(e),this.element.find(".columns").css({height:"auto",width:this.element.find(".valueColumn").width()-this.element.find(".values").width()-1}),this._setGroupingBarFrozenRowBtnWidth()},_cellRangeInfo:function(i){var l,a,r,o,n,s,d=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),h=e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-maximumView").length>0;h&&this._pivotClientObj.model.enableDrillThrough&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(this._dataSet=this._pivotClientObj.dataSet),e(i.target).hasClass("cellValue")&&(i.target=i.target.parentElement);e("thead tr").length;var u=[],c=0,p=e.grep(this.getJSONRecords(),function(t){return(t.CSS.indexOf("colheader")>-1||t.CSS.indexOf("summary cstot")>-1||t.CSS.indexOf(" calc")>-1)&&-1==t.CSS.indexOf("colheader calc")&&t.Index.split(",")[0]==e(i.target).attr("data-p").split(",")[0]}),m=e.grep(this.getJSONRecords(),function(t){return(t.CSS.indexOf("rowheader")>-1||t.CSS.indexOf("summary rstot")>-1)&&t.Index.split(",")[1]==e(i.target).attr("data-p").split(",")[1]});if(1==m.length&&1==p.length&&(m[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||p[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||p[0].CSS.indexOf(" calc")>-1))if([],(p[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||p[0].CSS.indexOf(" calc")>-1)&&m[0].Value.toString().indexOf("Grand")>=0)for(n=0;n<this.model.dataSource.data.length;n++)u[n]=this.model.dataSource.data[n];else for(m[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0?l=p[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?p[0].Value.replace(" "+this._getLocalizedLabels("Total"),""):p[0].Value:(p[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0||p[0].CSS.indexOf(" calc")>-1)&&(l=m[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?m[0].Value.replace(" "+this._getLocalizedLabels("Total"),""):m[0].Value),n=0;n<d.model.dataSource.data.length;n++)e.each(d.model.dataSource.data[n],function(e,t){t==l&&(u[c]=d.model.dataSource.data[n],c++)});else if(m.length>=1&&p.length>=1&&(m[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0||p[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0)){for(m[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?(l=p,a=m):p[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0&&(l=m,a=p),_=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.model.dataSource.data:this._dataSet.length>0?JSON.parse(this._dataSet):[],r=l.length-1;r>=0;r--){for(o=[],n=0;n<_.length;n++)e.each(_[n],function(e,t){t==l[r].Value&&o.push(_[n])});_=o}if(u=o,a[0].Value.toString().indexOf("Grand")<=0)for(o=[],n=0;n<_.length;n++)e.each(_[n],function(e,t){t==a[0].Value.replace(" Total","")&&(u=[],o.push(_[n]))});u=0==u.length?o:u}else{var g=m,f=p,_=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.model.dataSource.data:this._dataSet.length>0?JSON.parse(this._dataSet):[];for(r=g.length-1;r>=0;r--){for(o=[],n=0;n<_.length;n++)e.each(_[n],function(e,t){(t==g[r].Key||t==g[r].Value)&&o.push(_[n])});_=o}for(r=f.length-1;r>=0;r--)if(-1==f[r].CSS.indexOf("calc")){for(o=[],n=0;n<_.length;n++)e.each(_[n],function(e,t){(t==f[r].Key||t==f[r].Value)&&o.push(_[n])});_=o}u=0==u.length?o:u}s={selectedData:u||[],element:this.element,customObject:this.model.customObject},this.model.enableCellDoubleClick&&null!=this.model.enableCellDoubleClick&&"dblclick"==i.type&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellDoubleClick",s):this._pivotClientObj._trigger("cellDoubleClick",s)),this.model.enableCellClick&&null!=this.model.enableCellClick&&"click"==i.type&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellClick",s):this._pivotClientObj._trigger("cellClick",s)),(this.model.enableDrillThrough||h&&this._pivotClientObj.model.enableDrillThrough)&&u.length>0&&(h&&this._pivotClientObj.model.enableDrillThrough?this._pivotClientObj:this)._trigger("drillThrough",s)},_initCellEditing:function(i){var l;"INPUT"==i.target.tagName||e(i.target).hasClass("summary")||e(i.target).parent().hasClass("summary")?this._off(this.element,"mouseup",".value",this._completeCellEditing):(this._on(this.element,"mouseup",".value",this._completeCellEditing),this._oriX=i.pageX,this._oriY=i.pageY,l=i.target||window.event.srcElement,e(l).hasClass("cellValue")&&(l=e(l).parent()[0]),e(".value").addClass("selection"),e("#"+this._id).append(t.buildTag("div.e-cellSelection#"+this._id+"_cellSelection","",{})),this._startCellPosition=e(l)[0].attributes.getNamedItem("data-p").value,this._on(this.element,"mousemove",".value, .e-cellSelection",this._cellSelection))},_completeCellEditing:function(i){var a,r,o,n,s,d,h,u,c,p,m,g,f,_,v,b,C=[];if("INPUT"!=i.target.tagName){if(this._off(this.element,"mousemove",".value"),e(".value").removeClass("selection"),a=i.target||window.event.srcElement,e(a).hasClass("cellValue")&&(a=e(a).parent()[0]),r=e(a)[0].attributes.getNamedItem("data-p").value,s=0,this.element.find(".curInput").length>0)return 0==e(a).find(".curInput").length&&this._updateTableCell(),e("#"+this._id+"_cellSelection").remove(),this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip),this._off(this.element,"mouseup",".value"),!1;for(d=parseInt(this._startCellPosition.split(",")[1])<parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]);d<=(parseInt(this._startCellPosition.split(",")[1])>parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]));d++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("td[data-p*=',"+d+"']").parent().is(":visible"))for(h=parseInt(this._startCellPosition.split(",")[0])<parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]);h<=(parseInt(this._startCellPosition.split(",")[0])>parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]));h++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("[data-p*='"+h+",']").last("th").is(":Visible")||!this.model.enableGrandTotal||!this.model.enableRowGrandTotal){C[s]=this.getJSONRecords()[h*this._rowCount+d],this.element.find("[data-p='"+h+","+d+"']").hasClass("summary")||(this.element.find("[data-p='"+h+","+d+"'] span.cellValue").length>0?(u=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?""!=this.element.find("[data-p='"+h+","+d+"'] span.cellValue").text()?this.element.find("[data-p='"+h+","+d+"'] span.cellValue").text():this.element.find(".curInput").val():this.element.find("[data-p='"+h+","+d+"'] span.cellValue").text(),this.element.find("[data-p='"+h+","+d+"'] span.cellValue").html("<input type='text' class='curInput' value='"+u+"' />")):this.element.find("[data-p='"+h+","+d+"']").children().length>0?this.element.find("[data-p='"+h+","+d+"']").append("<input type='text' class='curInput' value='' />"):(u=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?""!=this.element.find("[data-p='"+h+","+d+"']").text()?this.element.find("[data-p='"+h+","+d+"']").text():this.element.find(".curInput").val():this.element.find("[data-p='"+h+","+d+"']").text(),this.element.find("[data-p='"+h+","+d+"']").html("<input type='text' class='curInput' value='"+u+"' />")));var S,O="",y=0;if((o=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.element.find(".summary[role!='gridcell'][data-p$=',"+e(a).attr("data-p").split(",")[1]+"'] , .rowheader[role!='gridcell'][data-p$=',"+e(a).attr("data-p").split(",")[1]+"']").last().attr("data-p"):this.element.find(".summary[role!='gridcell'][data-p$=',"+d+"'] , .rowheader[role!='gridcell'][data-p$=',"+d+"']").last().attr("data-p"))==l&&(o=e("#"+this._id).find("tbody").find('[data-p="'+h+","+d+'"]').parent("tr").find(".summary").first().attr("data-p")),o,null!=o){for(;o[0]>=0;)o==this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Index&&(S=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Value,o=parseInt(o.split(",")[0])-1+","+parseInt(o.split(",")[1])),O&&""!=S?O=S+"#"+O:""!=S&&(O=S);if(this._rowHeader[s]=O,(m=this._rowHeader[s].toString().split("#")).length>1){for(f=0;f<m.length-1;f++)for(g=0;g<m[f].split(".").length;g++)if(m[f].split(".")[g]==m[f+1].split(".")[g]&&m[f].split(".")[g+1]==m[f+1].split(".")[g+1]){m.splice(f,1);break}for(this._rowHeader[s]="",f=0;f<m.length;f++)this._rowHeader[s]+=""==this._rowHeader[s]?m[f]:"#"+m[f]}}var P,w="",N=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,x=this.element.find((N?".pivotGridFrozenTable ":"")+'tr:has(".colheader")').length-1;for(x,(n=C[s].Index)!=l&&n==this.getJSONRecords()[parseInt(parseInt(n.split(",")[0])*this._rowCount+parseInt(n.split(",")[1]))].Index&&(c=parseInt(n.split(",")[0])),p=0;p<=x;p++)null!=c&&c+","+p==this.getJSONRecords()[parseInt(parseInt(c)*this._rowCount+p)].Index&&(P=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(c)*this._rowCount+p)].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(c)*this._rowCount+p)].Value,""==w?w=P:""!=P&&(w=w+"#"+P)),this._colHeader[s]=w;if((m=this._colHeader[s].split("#")).length>1){for(f=0;f<m.length-1;f++)for(g=0;g<m[f].split(".").length;g++)if(m[f].split(".")[g]==m[f+1].split(".")[g]&&m[f].split(".")[g+1]==m[f+1].split(".")[g+1]){m.splice(f,1);break}for(this._colHeader[s]="",f=0;f<m.length;f++)this._colHeader[s]+=""==this._colHeader[s]?m[f]:"#"+m[f]}s++}for(this._originalValue="",this._cellInfo=C,_=0;_<this.element.find(".curInput").length;_++)v=this.element.find(".curInput")[_],this._originalValue+=""==this._originalValue?v.value:"#"+v.value;b={JSONRecords:C,rowHeader:this._rowHeader,columnHeader:this._colHeader,measureCount:y>0?"Row:"+y:"Column:0"},t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",b):this._pivotClientObj._trigger("cellSelection",b),C=[],e("#"+this._id+"_cellSelection").remove(),this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip),this._off(this.element,"mouseup",".value")}this.element.find(".curInput").keypress(function(i){if(13==i.which){var l=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(l)||l._updateTableCell()}})},_updateTableCell:function(){var i,l,a,r,o,n,s,d="",h="",u=this.element.find(".curInput");e.each(u,function(e,t){d+=0==e?t.value:"#"+t.value});var c=[],p=this._rowHeader,m=this._colHeader;for(i=(h=d.split("#")).length-1;i>=0;i--)h[i]==this._originalValue.split("#")[i]?(p.splice(i,1),m.splice(i,1),h.splice(i,1),this._cellInfo.splice(i,1)):(c.push(this._originalValue.split("#")[i]),t.isNullOrUndefined(this._cellInfo[i])||(this._cellInfo[i].Value=h[i]=""==h[i]?"":h[i]));for(c=c.reverse(),d="",s=0;s<h.length;s++)d+=""==d?h[s]:"#"+h[s];if(0==d.length){for(s=u.length-1;s>=0;s--)e(u[s]).closest("td").text(this.element.find(".curInput")[s].value);return!1}if(this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)try{l=JSON.parse(this.getOlapReport()).Report}catch(e){l=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){(t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)||0==this.model.editCellsInfo.JSONRecords.length)&&(this.model.editCellsInfo={JSONRecords:[],rowHeader:[],columnHeader:[]});var g=this.model.editCellsInfo.rowHeader,f=this.model.editCellsInfo.columnHeader,_=this.model.editCellsInfo.JSONRecords,v=this._cellInfo;for(a=0;a<v.length;a++){for(r=0,o=0;o<_.length;o++)if(g[o]==p[a]&&f[o]==m[a]){_[o].Value=v[a].Value,r++;break}0==r&&(g.push(p[a]),f.push(m[a]),_.push(v[a]))}if(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}):this._pivotClientObj._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){d="";var b="",C="";for(e.each(this.model.editCellsInfo.JSONRecords,function(e,t){d=""==d?t.Value:d+":"+t.Value,b=""==b?t.Index:b+":"+t.Index,C=""==C?f[e].toString().split("#")[f[e].toString().split("#").length-1]:C+":"+f[e].toString().split("#")[f[e].toString().split("#").length-1]}),n=JSON.stringify({action:"cellEditing",index:b,valueHeaders:C,summaryValues:d,currentReport:l,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.cellEditing,n,this._renderControlSuccess),s=u.length-1;s>=0;s--)e(u[s]).closest("td").text(e(u[s]).val())}else this._populatePivotGrid();else{for(s=u.length-1;s>=0;s--)e(u[s]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[s])?"":this._originalValue.split("#")[s]);this._waitingPopup.hide()}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"writeBack",element:this.element}),this.model.editCellsInfo.JSONRecords=this._cellInfo,this.model.editCellsInfo.rowHeader=p,this.model.editCellsInfo.columnHeader=m,t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}):this._pivotClientObj._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),d="",!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0&&e.each(this.model.editCellsInfo.JSONRecords,function(e,t){d=""==d?t.Value:d+":"+t.Value}),n=JSON.stringify({action:"writeBack",value:d,rowUniqueName:JSON.stringify(this.model.editCellsInfo.rowHeader),columnUniqueName:JSON.stringify(this.model.editCellsInfo.columnHeader),currentReport:l,customObject:JSON.stringify(this.model.customObject)}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.writeBack,n,this._renderControlSuccess);else{for(s=u.length-1;s>=0;s--)e(u[s]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[s])?"":this._originalValue.split("#")[s]);this._waitingPopup.hide()}this._rowHeader=[],this._colHeader=[]},_createVirtualPivotGrid:function(e){var i,l,a=this._seriesPageCount>1?t.buildTag("div.e-vScrollPanel")[0].outerHTML:"",r=this._categPageCount>1?t.buildTag("div.e-hScrollPanel")[0].outerHTML:"",o=t.buildTag("td.virtualScrollGrid",e[0].outerHTML)[0],n=t.buildTag("td.virtualScrollElement",a),s=t.buildTag("td.virtualScrollElement",r),d=t.buildTag("tr.virtualScrollElement",o.outerHTML+n[0].outerHTML),h=t.buildTag("tr.virtualScrollElement",s[0].outerHTML+t.buildTag("td.virtualScrollElement")[0].outerHTML),u=t.buildTag("tbody.oGridOuterDiv.virtualScrollElement",d[0].outerHTML+h[0].outerHTML);this.element.html(t.buildTag("table.virtualScrollElement",u[0].outerHTML)),i=t.buildTag("div.e-seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage"))[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML,this._seriesPageCount>1&&this.element.append(i),l=t.buildTag("div.e-categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage"))[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML,this._categPageCount>1&&this.element.append(l)}}),t.PivotGrid.Layout={Normal:"normal",NormalTopSummary:"normaltopsummary",NoSummaries:"nosummaries",ExcelLikeLayout:"excellikelayout"},t.PivotGrid.Locale=t.PivotGrid.Locale||{},t.PivotGrid.Locale["en-US"]={Sort:"Sort",Search:"Search",SelectField:"Select field",LabelFilterLabel:"Show the items for which the label",ValueFilterLabel:"Show the items for which",ClearSorting:"Clear Sorting",ClearFilterFrom:"Clear Filter From",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",and:"and",LabelFilters:"Label Filters  ",BeginsWith:"Begins With",DoesNotBeginsWith:"Does Not Begin With",EndsWith:"Ends With",NotEndsWith:"Not Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",ValueFilters:"Value Filters",ClearFilter:"Clear Filter",Equals:"Equals",DoesNotEquals:"Does Not Equal",NotEquals:"Not Equals",GreaterThan:"Greater Than",IsGreaterThan:"Is Greater Than",IsGreaterThanOrEqualTo:"Is Greater Than Or Equal To",IsLessThan:"Is Less Than",IsLessThanOrEqualTo:"Is Less Than Or Equal To",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Top10:"Top Count",AddToFilter:"Add to Filter",AddToRow:"Add to Row",AddToColumn:"Add to Column",AddToValues:"Add to Values",Warning:"Warning",Error:"Error",GroupingBarAlertMsg:"The field you are moving cannot be placed in that area of the report",Measures:"Measures",Expand:"Expand",Collapse:"Collapse",ToolTipRow:"Row",ToolTipColumn:"Column",ToolTipValue:"Value",NoValue:"No value",SeriesPage:"Series Page",CategoricalPage:"Categorical Page",DragFieldHere:"Drag field here",ColumnArea:"Drop column here",RowArea:"Drop row here",ValueArea:"Drop values here",Close:"Close",OK:"OK",Cancel:"Cancel",Remove:"Remove",Goal:"Goal",Status:"Status",Trend:"Trend",Value:"Value",ConditionalFormattingErrorMsg:"The given value is not matched",ConditionalFormattingConformMsg:"Are you sure you want to remove the selected format?",EnterOperand1:"Enter Operand1",EnterOperand2:"Enter Operand2",ConditionalFormatting:"Conditional Formatting",Condition:"Conditional Type",Value1:"Value1",Value2:"Value2",Editcondtion:"Edit Condition",AddNew:"Add New",Format:"Format",Fontcolor:"Font Color",Backcolor:"Back Color",Borderrange:"Border Range",Borderstyle:"Border Style",Fontsize:"Font Size",Fontstyle:"Font Style",Bordercolor:"Border Color",NoMeasure:"Please add any measure",Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted",Double:"Double",Groove:"Groove",Inset:"Inset",Outset:"Outset",Ridge:"Ridge",None:"None",Algerian:"Algerian",Arial:"Arial",BodoniMT:"Bodoni MT",BritannicBold:"Britannic Bold",Cambria:"Cambria",Calibri:"Calibri",CourierNew:"Courier New",DejaVuSans:"DejaVu Sans",Forte:"Forte",Gerogia:"Gerogia",Impact:"Impact",SegoeUI:"Segoe UI",Tahoma:"Tahoma",TimesNewRoman:"Times New Roman",Verdana:"Verdana",CubeDimensionBrowser:"Cube Dimension Browser",SelectHierarchy:"Select Hierarchy",CalculatedField:"Calculated Field",Name:"Name:",Add:"Add",Formula:"Formula:",Delete:"Delete",Fields:"Fields:",MultipleItems:"Multiple items",All:"All",CalculatedFieldNameNotFound:"Given CalculatedField name is not found",InsertField:"Insert Field",EmptyField:"Please enter Calculated field name or formula",NotValid:"Given formula is not valid",NotPresent:"Value field used in any of the Calculated Field formula is not present in the PivotGrid",Confirm:"Calculated field with the same name already exists. Do you want to Replace ?",CalcValue:"Calculated field can be inserted only in value area field",NoRecordsToDisplay:"No records to display.",NumberFormatting:"Number Formatting",FrozenHeaders:"Frozen Headers",CellSelection:"Cell Selection",CellContext:"Cell Context",ColumnResize:"Column Resize",Layouts:"Layouts",ExcelLikeLayout:"Excel Like Layout",NormalLayout:"Normal Layout",NormalTopSummary:"NormalTopSummary Layout",NoSummaries:"NoSummaries Layout",FrozenHeader:"Frozen Header",AdvancedFiltering:"Advanced Filtering",Amount:"Amount",Quantity:"Quantity",Measures:"Measures",NumberFormats:"Number Formats",Exporting:"Exporting",FileName:"File Name",ToolTip:"Tool Tip",RTL:"RTL",CollapseByDefault:"Collapse By Default",EnableDisablePaging:"Enable / Disable Paging",PagingOptions:"Paging Options",CategoricalPageSize:"Categorical Page Size",SeriesPageSize:"Series Page Size",HyperLink:"HyperLink",CellEditing:"Cell Editing",GroupingBar:"Grouping Bar",SummaryCustomization:"Summary Customization",SummaryTypes:"Summary Types",SummaryType:"Summary Type",EnableRowHeaderHyperlink:"Enable RowHeaderHyperLink",EnableColumnHeaderHyperlink:"Enable ColumnHeaderHyperLink",EnableValueCellHyperlink:"Enable ValueCellHyperLink",EnableSummaryCellHyperlink:"Enable SummaryCellHyperLink",HideGrandTotal:"Hide GrandTotal",HideSubTotal:"Hide SubTotal",Row:"Row",Column:"Column",Both:"Both",Sum:"Sum",Average:"Average",Count:"Count",Min:"Min",Max:"Max",Excel:"Excel",Word:"Word",PDF:"PDF",CSV:"CSV",Total:"Total",GrandTotal:"Grand Total",DrillThrough:"Drill Through",EnabledState:"Enabled State",Months:"Months",Days:"Days",Quarters:"Quarters",Years:"Years",Qtr:"Qtr",Quarter:"Quarter",AddCurrentSelectionToFilter:"Add current selection to filter",FormatName:"Format Name",RemoveFormat:"Remove Format",Edit:"Edit",DuplicateFormatName:"Duplicate Format Name",EnterFormatName:"Enter Format Name",NotAllItemsShowing:"Not all child nodes are shown",EditorLinkPanelAlert:"The members have more than 1000 items under one or more parent. Only the first 1000 items are displayed under each parent.",Exception:"Exception"},t.PivotGrid.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv"},t.PivotGrid.ConditionalOptions={Equals:"Equals",NotEquals:"Not Equals",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between"},t.PivotGrid.AnalysisMode={Olap:"olap",Relational:"relational"},t.PivotGrid.ExportMode={JSON:"json",PivotEngine:"pivotengine"},t.PivotGrid.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"},t.olap.base&&e.extend(t.PivotGrid.prototype,t.olap.base),t.olap._mdxParser&&e.extend(t.PivotGrid.prototype,t.olap._mdxParser)}(jQuery,Syncfusion)})},1033:function(e,t){e.exports="ej-pivotgrid {\r\n    display: block;\r\n    height: 350px;\r\n    width: 100%; \r\n    overflow: auto;\r\n}\r\n.e-pivotgrid{\r\n    position: inherit !important;\r\n}"},1348:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.Reset="Reset"}return e.prototype.onReset=function(e){$(".e-pivotgrid").data("ejPivotGrid").refreshPivotGrid()},e=l([r.Component({selector:"ej-app",template:i(1847),styles:[i(2010)],encapsulation:r.ViewEncapsulation.None,providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.CellEdiitngComponent=n},1349:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.Apply="Apply",this.Reset="Reset"}return e.prototype.onConFormat=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid");t.model.enableConditionalFormatting&&t.openConditionalFormattingDialog()},e.prototype.onReset=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid");t._removeCellFormatting(!0,!1),t._list=["Add New"]},e=l([r.Component({selector:"ej-app",template:i(1848),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.ConditionalFormattingComponent=n},1350:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.layout="excellikelayout"}return e.prototype.onChange=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid"),i=$("#rdbRelational").data("ejRadioButton"),l=$("#rdbOlap").data("ejRadioButton");$(t.element).html(""),t.model.operationalMode="clientmode";var a={data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}],filters:[]};t.model.dataSource=i.model.checked?a:l.model.checked?{data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]}:a,t.model.url="",t._excelLikeJSONRecords=null,t._currentReportItems=[],t._load()},e=l([r.Component({selector:"ej-app",template:i(1849),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.ExcelLikeComponent=n},1351:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.Export="Export",this.exportOptions=["Excel","Word","PDF","CSV"],this.value="Excel"}return e.prototype.onChange=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid"),i=$("#rdbRelational").data("ejRadioButton"),l=$("#rdbOlap").data("ejRadioButton");$(t.element).html(""),t.model.operationalMode="clientmode";var a={data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}],filters:[]};t.model.dataSource=i.model.checked?a:l.model.checked?{data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]}:a,t.model.url="",t._load()},e.prototype.ExportBtnClick=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid"),i=$("#exportOptions").data("ejDropDownList").selectedTextValue.toLowerCase();"excel"==i?t.exportPivotGrid("//js.syncfusion.com/ejservices/api/PivotGrid/Olap/ExcelExport","fileName"):"word"==i?t.exportPivotGrid("//js.syncfusion.com/ejservices/api/PivotGrid/Olap/WordExport","fileName"):"pdf"==i?t.exportPivotGrid("//js.syncfusion.com/ejservices/api/PivotGrid/Olap/PDFExport","fileName"):t.exportPivotGrid("//js.syncfusion.com/ejservices/api/PivotGrid/Olap/CSVExport","fileName")},e=l([r.Component({selector:"ej-app",template:i(1850),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.ExportingComponent=n},1352:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.hyperLink={enableValueCellHyperlink:!0,enableRowHeaderHyperlink:!0,enableColumnHeaderHyperlink:!0,enableSummaryCellHyperlink:!0}}return e.prototype.valueCellClick=function(){alert("Value Cell Clicked")},e.prototype.summaryCellClick=function(){alert("Sumary Cell Clicked")},e.prototype.rowCellClick=function(){alert("Row Header Cell Clicked")},e.prototype.columnCellClick=function(){alert("Column Header Cell Clicked")},e=l([r.Component({selector:"ej-app",template:i(1851),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.HyperLinkComponent=n},1353:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_gaugevalues(),this.filters=e.pivot_Olapfilters()}return e=l([r.Component({selector:"ej-app",template:i(1852),styles:[i(1033)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.KPIComponent=n},1354:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_namedsetrows(),this.values=e.pivot_Olapvalues(),this.filters=e.pivot_Olapfilters()}return e=l([r.Component({selector:"ej-app",template:i(1853),styles:[i(1033)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.NamedSetsComponent=n},1355:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_chartvalues(),this.numberFormat=["Decimal","Currency","Percentage","Number","Date","Time","Scientific","Accounting","Fraction"],this.value="Decimal"}return e.prototype.onNumberFormatChange=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid");if(t.model.dataSource&&t.model.dataSource.values)for(var i=0;i<t.model.dataSource.values.length;i++)t.model.dataSource.values[i].format=e.text.toLowerCase();t._populatePivotGrid()},e=l([r.Component({selector:"ej-app",template:i(1854),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.NumberFormatComponent=n},1356:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_Olapvalues(),this.filters=e.pivot_Olapfilters()}return e=l([r.Component({selector:"ej-app",template:i(1855),styles:[i(1033)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.OlapComponent=n},1357:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values()}return e=l([r.Component({selector:"ej-app",template:i(1856),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.RelationalComponent=n},1358:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.Export="Export",this.dataValue=["Date","Product","State","Country"],this.watermarkText="Hide SubTotals"}return e.prototype.renderPivotGrid=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid"),i=$("#rdbRelational").data("ejRadioButton"),l=$("#rdbOlap").data("ejRadioButton"),a=$("#dataValue").data("ejDropDownList"),r=$("#hiderowgdtot").data("ejRadioButton"),o=$("#hidecolumngdtot").data("ejRadioButton"),n={data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}],filters:[]};a.unCheckAll(),$(t.element).html(""),i.model.checked?$(".sourcefield").css("display",""):$(".sourcefield").css("display","none"),t.model.dataSource=i.model.checked?n:l.model.checked?{data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]}:n,t.model.enableGroupingBar=!0,r.model.checked?(t.model.enableColumnGrandTotal=t.model.enableGrandTotal=!0,t.model.enableRowGrandTotal=!1):o.model.checked?(t.model.enableRowGrandTotal=t.model.enableGrandTotal=!0,t.model.enableColumnGrandTotal=!1):(t.model.enableRowGrandTotal=t.model.enableColumnGrandTotal=!0,t.model.enableGrandTotal=!1),t._currentReportItems=[],t._load()},e.prototype.onChange=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid"),i=$("#rdbRelational").data("ejRadioButton"),l=e.text.split(",");i.model.checked&&(t.model.dataSource&&t.model.dataSource.rows&&t.model.dataSource.rows.length>0&&$.each(t.model.dataSource.rows,function(e,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),t.model.dataSource&&t.model.dataSource.columns&&t.model.dataSource.columns.length>0&&$.each(t.model.dataSource.columns,function(e,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),$.each(l,function(e,i){t.model.dataSource&&t.model.dataSource.rows&&t.model.dataSource.rows.length>0&&$.each(t.model.dataSource.rows,function(e,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)}),t.model.dataSource&&t.model.dataSource.columns&&t.model.dataSource.columns.length>0&&$.each(t.model.dataSource.columns,function(e,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)})}),t._populatePivotGrid())},e=l([r.Component({selector:"ej-app",template:i(1857),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.SummaryCustomizatioComponent=n},1359:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_chartvalues(),this.summaryType=["Sum","Average","Count","Min","Max"],this.value="Sum"}return e.prototype.onSummaryTypeChange=function(e){var t=$(".e-pivotgrid").data("ejPivotGrid");if(t.model.dataSource&&t.model.dataSource.values){for(var i=0;i<t.model.dataSource.values.length;i++)t.model.dataSource.values[i].summaryType=e.text.toLowerCase();t._populatePivotGrid()}},e=l([r.Component({selector:"ej-app",template:i(1858),styles:[i(1014)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.SummaryTypeComponent=n},1360:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),n=function(){function e(e){this.pivotdataservice=e,this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values()}return e.prototype.onChange=function(e){var t=$("#rdbRelational").data("ejRadioButton"),i=$("#rdbOlap").data("ejRadioButton"),l={data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}],filters:[]};$(".e-pivotgrid").remove(),$(".e-pivotschemadesigner").remove();var a=ej.buildTag("div#PivotGrid","",{height:"500px",width:"55%",overflow:"auto",float:"left",display:"block","padding-right":"15px"})[0].outerHTML,r=ej.buildTag("div#PivotSchemaDesigner","",{height:"500px",float:"right",display:"block","margin-top":"20px"})[0].outerHTML;$(a).appendTo(".control"),$(r).appendTo(".control"),$("#PivotGrid").ejPivotGrid({dataSource:t.model.checked?l:i.model.checked?{data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]}:l,pivotTableFieldListID:"PivotSchemaDesigner",enableGroupingBar:!0}),i.model.checked?$("#PivotSchemaDesigner").ejPivotSchemaDesigner({olap:{showKPI:!1,showNamedSets:!0}}):$("#PivotSchemaDesigner").ejPivotSchemaDesigner()},e=l([r.Component({selector:"ej-app",template:i(1859),styles:[i(2011)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.UIComponent=n},1501:function(e,t,i){"use strict";var l=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function l(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}();Object.defineProperty(t,"__esModule",{value:!0}),i(1022);var a=i(12),r=i(5),o=function(e){function t(t,i,l,a){var o=e.call(this,"PivotGrid",t,i,[],l,a)||this;return o.el=t,o.cdRef=i,o._ejIterableDiffers=l,o._ejkeyvaluediffers=a,o.afterServiceInvoke_output=new r.EventEmitter,o.beforeServiceInvoke_output=new r.EventEmitter,o.beforePivotEnginePopulate_output=new r.EventEmitter,o.cellClick_output=new r.EventEmitter,o.cellDoubleClick_output=new r.EventEmitter,o.cellContext_output=new r.EventEmitter,o.cellSelection_output=new r.EventEmitter,o.columnHeaderHyperlinkClick_output=new r.EventEmitter,o.drillSuccess_output=new r.EventEmitter,o.drillThrough_output=new r.EventEmitter,o.load_output=new r.EventEmitter,o.renderComplete_output=new r.EventEmitter,o.renderFailure_output=new r.EventEmitter,o.renderSuccess_output=new r.EventEmitter,o.rowHeaderHyperlinkClick_output=new r.EventEmitter,o.summaryCellHyperlinkClick_output=new r.EventEmitter,o.valueCellHyperlinkClick_output=new r.EventEmitter,o.saveReport_output=new r.EventEmitter,o.loadReport_output=new r.EventEmitter,o.beforeExport_output=new r.EventEmitter,o.cellEdit_output=new r.EventEmitter,o}return l(t,e),t.decorators=[{type:r.Component,args:[{selector:"ej-pivotgrid",template:""}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:r.ChangeDetectorRef},{type:r.IterableDiffers},{type:r.KeyValueDiffers}]},t.propDecorators={analysisMode_input:[{type:r.Input,args:["analysisMode"]}],cssClass_input:[{type:r.Input,args:["cssClass"]}],pivotTableFieldListID_input:[{type:r.Input,args:["pivotTableFieldListID"]}],dataSource_input:[{type:r.Input,args:["dataSource"]}],valueSortSettings_input:[{type:r.Input,args:["valueSortSettings"]}],frozenHeaderSettings_input:[{type:r.Input,args:["frozenHeaderSettings"]}],headerSettings_input:[{type:r.Input,args:["headerSettings"]}],showUniqueNameOnPivotButton_input:[{type:r.Input,args:["showUniqueNameOnPivotButton"]}],customObject_input:[{type:r.Input,args:["customObject"]}],collapsedMembers_input:[{type:r.Input,args:["collapsedMembers"]}],enableCellContext_input:[{type:r.Input,args:["enableCellContext"]}],enableCellSelection_input:[{type:r.Input,args:["enableCellSelection"]}],enableDrillThrough_input:[{type:r.Input,args:["enableDrillThrough"]}],enableCellClick_input:[{type:r.Input,args:["enableCellClick"]}],enableCellDoubleClick_input:[{type:r.Input,args:["enableCellDoubleClick"]}],enableCellEditing_input:[{type:r.Input,args:["enableCellEditing"]}],enableCollapseByDefault_input:[{type:r.Input,args:["enableCollapseByDefault"]}],enableColumnGrandTotal_input:[{type:r.Input,args:["enableColumnGrandTotal"]}],enableConditionalFormatting_input:[{type:r.Input,args:["enableConditionalFormatting"]}],enableAdvancedFilter_input:[{type:r.Input,args:["enableAdvancedFilter"]}],enableDeferUpdate_input:[{type:r.Input,args:["enableDeferUpdate"]}],enableGroupingBar_input:[{type:r.Input,args:["enableGroupingBar"]}],maxNodeLimitInMemberEditor_input:[{type:r.Input,args:["maxNodeLimitInMemberEditor"]}],enableMemberEditorPaging_input:[{type:r.Input,args:["enableMemberEditorPaging"]}],memberEditorPageSize_input:[{type:r.Input,args:["memberEditorPageSize"]}],enableMemberEditorSorting_input:[{type:r.Input,args:["enableMemberEditorSorting"]}],enableGrandTotal_input:[{type:r.Input,args:["enableGrandTotal"]}],enableJSONRendering_input:[{type:r.Input,args:["enableJSONRendering"]}],enablePivotFieldList_input:[{type:r.Input,args:["enablePivotFieldList"]}],enableRowGrandTotal_input:[{type:r.Input,args:["enableRowGrandTotal"]}],enableRTL_input:[{type:r.Input,args:["enableRTL"]}],enableToolTip_input:[{type:r.Input,args:["enableToolTip"]}],enableToolTipAnimation_input:[{type:r.Input,args:["enableToolTipAnimation"]}],enableColumnResizing_input:[{type:r.Input,args:["enableColumnResizing"]}],resizeColumnsToFit_input:[{type:r.Input,args:["resizeColumnsToFit"]}],enableContextMenu_input:[{type:r.Input,args:["enableContextMenu"]}],enableVirtualScrolling_input:[{type:r.Input,args:["enableVirtualScrolling"]}],enablePaging_input:[{type:r.Input,args:["enablePaging"]}],hyperlinkSettings_input:[{type:r.Input,args:["hyperlinkSettings"]}],isResponsive_input:[{type:r.Input,args:["isResponsive"]}],jsonRecords_input:[{type:r.Input,args:["jsonRecords"]}],layout_input:[{type:r.Input,args:["layout"]}],locale_input:[{type:r.Input,args:["locale"]}],operationalMode_input:[{type:r.Input,args:["operationalMode"]}],serviceMethodSettings_input:[{type:r.Input,args:["serviceMethodSettings"]}],url_input:[{type:r.Input,args:["url"]}],enableCompleteDataExport_input:[{type:r.Input,args:["enableCompleteDataExport"]}],enableXHRCredentials_input:[{type:r.Input,args:["enableXHRCredentials"]}],dataSource_cube_input:[{type:r.Input,args:["dataSource.cube"]}],dataSource_sourceInfo_input:[{type:r.Input,args:["dataSource.sourceInfo"]}],dataSource_providerName_input:[{type:r.Input,args:["dataSource.providerName"]}],dataSource_data_input:[{type:r.Input,args:["dataSource.data"]}],dataSource_catalog_input:[{type:r.Input,args:["dataSource.catalog"]}],dataSource_enableAdvancedFilter_input:[{type:r.Input,args:["dataSource.enableAdvancedFilter"]}],dataSource_reportName_input:[{type:r.Input,args:["dataSource.reportName"]}],dataSource_pagerOptions_input:[{type:r.Input,args:["dataSource.pagerOptions"]}],dataSource_pagerOptions_categoricalPageSize_input:[{type:r.Input,args:["dataSource.pagerOptions.categoricalPageSize"]}],dataSource_pagerOptions_seriesPageSize_input:[{type:r.Input,args:["dataSource.pagerOptions.seriesPageSize"]}],dataSource_pagerOptions_categoricalCurrentPage_input:[{type:r.Input,args:["dataSource.pagerOptions.categoricalCurrentPage"]}],dataSource_pagerOptions_seriesCurrentPage_input:[{type:r.Input,args:["dataSource.pagerOptions.seriesCurrentPage"]}],valueSortSettings_headerText_input:[{type:r.Input,args:["valueSortSettings.headerText"]}],valueSortSettings_headerDelimiters_input:[{type:r.Input,args:["valueSortSettings.headerDelimiters"]}],valueSortSettings_sortOrder_input:[{type:r.Input,args:["valueSortSettings.sortOrder"]}],frozenHeaderSettings_enableFrozenRowHeaders_input:[{type:r.Input,args:["frozenHeaderSettings.enableFrozenRowHeaders"]}],frozenHeaderSettings_enableFrozenColumnHeaders_input:[{type:r.Input,args:["frozenHeaderSettings.enableFrozenColumnHeaders"]}],frozenHeaderSettings_enableFrozenHeaders_input:[{type:r.Input,args:["frozenHeaderSettings.enableFrozenHeaders"]}],frozenHeaderSettings_scrollerSize_input:[{type:r.Input,args:["frozenHeaderSettings.scrollerSize"]}],headerSettings_showRowItems_input:[{type:r.Input,args:["headerSettings.showRowItems"]}],headerSettings_showColumnItems_input:[{type:r.Input,args:["headerSettings.showColumnItems"]}],hyperlinkSettings_enableColumnHeaderHyperlink_input:[{type:r.Input,args:["hyperlinkSettings.enableColumnHeaderHyperlink"]}],hyperlinkSettings_enableRowHeaderHyperlink_input:[{type:r.Input,args:["hyperlinkSettings.enableRowHeaderHyperlink"]}],hyperlinkSettings_enableSummaryCellHyperlink_input:[{type:r.Input,args:["hyperlinkSettings.enableSummaryCellHyperlink"]}],hyperlinkSettings_enableValueCellHyperlink_input:[{type:r.Input,args:["hyperlinkSettings.enableValueCellHyperlink"]}],serviceMethodSettings_drillDown_input:[{type:r.Input,args:["serviceMethodSettings.drillDown"]}],serviceMethodSettings_exportPivotGrid_input:[{type:r.Input,args:["serviceMethodSettings.exportPivotGrid"]}],serviceMethodSettings_deferUpdate_input:[{type:r.Input,args:["serviceMethodSettings.deferUpdate"]}],serviceMethodSettings_fetchMembers_input:[{type:r.Input,args:["serviceMethodSettings.fetchMembers"]}],serviceMethodSettings_filtering_input:[{type:r.Input,args:["serviceMethodSettings.filtering"]}],serviceMethodSettings_initialize_input:[{type:r.Input,args:["serviceMethodSettings.initialize"]}],serviceMethodSettings_nodeDropped_input:[{type:r.Input,args:["serviceMethodSettings.nodeDropped"]}],serviceMethodSettings_nodeStateModified_input:[{type:r.Input,args:["serviceMethodSettings.nodeStateModified"]}],serviceMethodSettings_paging_input:[{type:r.Input,args:["serviceMethodSettings.paging"]}],serviceMethodSettings_sorting_input:[{type:r.Input,args:["serviceMethodSettings.sorting"]}],serviceMethodSettings_memberExpand_input:[{type:r.Input,args:["serviceMethodSettings.memberExpand"]}],serviceMethodSettings_cellEditing_input:[{type:r.Input,args:["serviceMethodSettings.cellEditing"]}],serviceMethodSettings_saveReport_input:[{type:r.Input,args:["serviceMethodSettings.saveReport"]}],serviceMethodSettings_loadReport_input:[{type:r.Input,args:["serviceMethodSettings.loadReport"]}],serviceMethodSettings_calculatedField_input:[{type:r.Input,args:["serviceMethodSettings.calculatedField"]}],serviceMethodSettings_drillThroughHierarchies_input:[{type:r.Input,args:["serviceMethodSettings.drillThroughHierarchies"]}],serviceMethodSettings_drillThroughDataTable_input:[{type:r.Input,args:["serviceMethodSettings.drillThroughDataTable"]}],serviceMethodSettings_valueSorting_input:[{type:r.Input,args:["serviceMethodSettings.valueSorting"]}],serviceMethodSettings_removeButton_input:[{type:r.Input,args:["serviceMethodSettings.removeButton"]}],serviceMethodSettings_writeBack_input:[{type:r.Input,args:["serviceMethodSettings.writeBack"]}],dataSource_columns_input:[{type:r.Input,args:["dataSource.columns"]}],dataSource_rows_input:[{type:r.Input,args:["dataSource.rows"]}],dataSource_values_input:[{type:r.Input,args:["dataSource.values"]}],dataSource_filters_input:[{type:r.Input,args:["dataSource.filters"]}],options:[{type:r.Input,args:["options"]}],afterServiceInvoke_output:[{type:r.Output,args:["afterServiceInvoke"]}],beforeServiceInvoke_output:[{type:r.Output,args:["beforeServiceInvoke"]}],beforePivotEnginePopulate_output:[{type:r.Output,args:["beforePivotEnginePopulate"]}],cellClick_output:[{type:r.Output,args:["cellClick"]}],cellDoubleClick_output:[{type:r.Output,args:["cellDoubleClick"]}],cellContext_output:[{type:r.Output,args:["cellContext"]}],cellSelection_output:[{type:r.Output,args:["cellSelection"]}],columnHeaderHyperlinkClick_output:[{type:r.Output,args:["columnHeaderHyperlinkClick"]}],drillSuccess_output:[{type:r.Output,args:["drillSuccess"]}],drillThrough_output:[{type:r.Output,args:["drillThrough"]}],load_output:[{type:r.Output,args:["load"]}],renderComplete_output:[{type:r.Output,args:["renderComplete"]}],renderFailure_output:[{type:r.Output,args:["renderFailure"]}],renderSuccess_output:[{type:r.Output,args:["renderSuccess"]}],rowHeaderHyperlinkClick_output:[{type:r.Output,args:["rowHeaderHyperlinkClick"]}],summaryCellHyperlinkClick_output:[{type:r.Output,args:["summaryCellHyperlinkClick"]}],valueCellHyperlinkClick_output:[{type:r.Output,args:["valueCellHyperlinkClick"]}],saveReport_output:[{type:r.Output,args:["saveReport"]}],loadReport_output:[{type:r.Output,args:["loadReport"]}],beforeExport_output:[{type:r.Output,args:["beforeExport"]}],cellEdit_output:[{type:r.Output,args:["cellEdit"]}]},t}(a.EJComponents);t.PivotGridComponent=o,t.EJ_PIVOTGRID_COMPONENTS=[o]},1847:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [isResponsive]="true" [enableCellEditing]="true" >\r\n</ej-pivotgrid>\r\n\r\n<div id="property-window" class="box wide" style="width: 300px">\r\n    <table>\r\n        <tr>\r\n            <td>\r\n                <div style="margin: 10px 10px 20px 0px"><b>Cell Editing</b></div>\r\n            </td>\r\n            <td>\r\n                <input id="reset" ej-button size="normal" (click)="onReset($event)" value="Reset" text="Reset" />\r\n            </td>\r\n        </tr>\r\n    </table> \r\n</div>'},1848:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [isResponsive]="true" [enableConditionalFormatting]="true" >\r\n</ej-pivotgrid>\r\n\r\n<div id="property-window" class="box wide" style="width: 300px">\r\n\t<div style="margin: 10px 10px 20px 0px"><b>Apply Formatting</b>\r\n    </div>\r\n    <input id="conFormat" ej-button size="normal" (click)="onConFormat($event)" value="Apply" text="Apply" />\r\n    <input id="reset" ej-button size="normal" (click)="onReset($event)" value="Reset" text="Reset" />\r\n</div>'},1849:function(e,t){e.exports='<ej-pivotgrid id="PivotGrid1" [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [enableGroupingBar]="true" [layout]="layout" >\r\n</ej-pivotgrid>\r\n<div id="property-window" class="box wide" style="width: 600px">\r\n\t<table width="500px">\r\n        <tr>\r\n            <td> Data Source </td>\r\n            <td>\r\n                <input id="rdbRelational" type="radio" ej-radiobutton name="radio1" [checked]="true" value="relational" (ejchange)="onChange($event)" /> Relatioanl</td>\r\n            <td>\r\n                <input id="rdbOlap" ej-radiobutton type="radio" name="radio1" value="olap" (ejchange)="onChange($event)" /> OLAP</td>\r\n        </tr>\r\n    </table>\r\n</div>'},1850:function(e,t){e.exports='<ej-pivotgrid id="PivotGrid1" [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values">\r\n</ej-pivotgrid>\r\n<div id="property-window" class="box wide" style="width: 350px">\r\n    <div class="row" style="margin-top: 20px">\r\n        <table width="300px">\r\n            <tr>\r\n                <td> Data Source </td>\r\n                <td>\r\n                    <input id="rdbRelational" type="radio" ej-radiobutton name="radio1" [checked]="true" value="relational" (ejchange)="onChange($event)" /> Relatioanl</td>\r\n                <td>\r\n                    <input id="rdbOlap" ej-radiobutton type="radio" name="radio1" value="olap" (ejchange)="onChange($event)" /> OLAP</td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="row" style="margin-top: 20px">\r\n        <table width="300px">\r\n            <tr>\r\n                <td class="chkrad">\r\n                    Export Option\r\n                </td>\r\n                <td class="chkrad" colspan="2">\r\n                    <input id="exportOptions" ej-dropdownlist  [dataSource]="exportOptions" [(value)]="value" />\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="row" style="margin:20px 0px 10px 90px">\r\n        <input style="float: left" id="export" ej-button size="normal" (click)="ExportBtnClick($event)" value="Export" text="Export" />\r\n    </div>\r\n</div>'},1851:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" \r\n    [hyperlinkSettings] = "hyperLink" (rowHeaderHyperlinkClick)="rowCellClick($event)" (summaryCellHyperlinkClick)="summaryCellClick($event)"\r\n    (valueCellHyperlinkClick)="valueCellClick($event)" (columnHeaderHyperlinkClick)="columnCellClick($event)" >\r\n</ej-pivotgrid>'},1852:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values">\r\n</ej-pivotgrid>'},1853:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values">\r\n</ej-pivotgrid>'},1854:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [isResponsive]="true">\r\n</ej-pivotgrid>\r\n\r\n<div id="property-window" class="box wide" style="width: 300px">\r\n    <table>\r\n        <tr>\r\n            <td>\r\n                <div style="margin: 10px 10px 20px 0px"><b>Amount</b></div>\r\n            </td>\r\n            <td>\r\n                <input style="margin: -25px 0 0 100px;" id="Amount" ej-dropdownlist  [dataSource]="numberFormat" [(value)]="value" (ejchange)= "onNumberFormatChange($event)"/>\r\n            </td>\r\n        </tr>\r\n    </table>    \r\n</div>'},1855:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values">\r\n</ej-pivotgrid>'},1856:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values">\r\n</ej-pivotgrid>'},1857:function(e,t){e.exports='<ej-pivotgrid id="PivotGrid1" [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [enableGroupingBar]="true" [enableRowGrandTotal]="false" >\r\n</ej-pivotgrid>\r\n<div id="property-window" class="box wide" style="width: 650px">\r\n    <div class="row" style="margin-top: 20px">\r\n        <table width="500px">\r\n            <tr>\r\n                <td class="col-md-3" style="width:150px"> Data Source </td>\r\n                <td class="col-md-3" style="width:120px">\r\n                    <input id="rdbRelational" type="radio" ej-radiobutton name="radio1" [checked]="true" value="relational" (ejchange)="renderPivotGrid($event)" /> Relational</td>\r\n                <td class="col-md-3" style="width:120px">\r\n                    <input id="rdbOlap" ej-radiobutton type="radio" name="radio1" value="olap" (ejchange)="renderPivotGrid($event)" /> OLAP</td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n    <div class="row" style="margin-top: 20px">\r\n        <div class="col-md-3" style="width:192px"> Hide GrandTotal: </div>\r\n        <div class="col-md-3" style="width:155px">\r\n            <input id="hiderowgdtot" type="radio" ej-radiobutton name="radio2" [checked]="true" value="relational" (ejchange)="renderPivotGrid($event)" /> Row\r\n        </div>\r\n        <div class="col-md-3" style="width:120px">\r\n            <input id="hidecolumngdtot" ej-radiobutton type="radio" name="radio2" value="olap" (ejchange)="renderPivotGrid($event)" /> Column\r\n        </div>\r\n        <div class="col-md-3" style="width:80px">\r\n            <input id="hidegdtot" ej-radiobutton type="radio" name="radio2" value="olap" (ejchange)="renderPivotGrid($event)" /> Both\r\n        </div>\r\n    </div>\r\n    <div class="row sourcefield" style="margin-top: 20px">\r\n        <table width="500px">\r\n            <tr>\r\n                <td class="chkrad" class="col-md-3" style="width:210px">\r\n                   Hide SubTotal:\r\n                </td>\r\n                <td class="chkrad" colspan="2">\r\n                    <input id="dataValue" ej-dropdownlist  [dataSource]="dataValue" (ejchange)="onChange($event)" showCheckbox="true" [watermarkText]= "watermarkText" />\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'},1858:function(e,t){e.exports='<ej-pivotgrid [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [isResponsive]="true">\r\n</ej-pivotgrid>\r\n\r\n<div id="property-window" class="box wide" style="width: 300px">\r\n    <table>\r\n        <tr>\r\n            <td>\r\n                <div style="margin: 10px 10px 20px 0px"><b>Amount</b></div>\r\n            </td>\r\n            <td>\r\n                <input style="margin: -25px 0 0 100px;" id="selectAmount" ej-dropdownlist  [dataSource]="summaryType" [(value)]="value" (ejchange)= "onSummaryTypeChange($event)"/>\r\n            </td>\r\n        </tr>\r\n    </table>    \r\n</div>'},1859:function(e,t){e.exports='<div class="control" style="height:600px">\r\n    <ej-pivotgrid id="PivotGrid1" [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" pivotTableFieldListID="PivotSchemaDesigner1" [enableGroupingBar]="true" >\r\n    </ej-pivotgrid>\r\n    <ej-pivotschemadesigner id="PivotSchemaDesigner1"></ej-pivotschemadesigner>\r\n</div>\r\n<div id="property-window" class="box wide" style="width: 600px">\r\n\t<table width="500px">\r\n        <tr>\r\n            <td> Data Source </td>\r\n            <td>\r\n                <input id="rdbRelational" type="radio" ej-radiobutton name="radio1" [checked]="true" value="relational" (ejchange)="onChange($event)" /> Relational</td>\r\n            <td>\r\n                <input id="rdbOlap" ej-radiobutton type="radio" name="radio1" value="olap" (ejchange)="onChange($event)" /> OLAP</td>\r\n        </tr>\r\n    </table>\r\n</div>'},2010:function(e,t){e.exports="ej-pivotgrid {\r\n    display: block;\r\n    height: 450px;\r\n    width: 100%; \r\n    overflow: auto;\r\n}\r\n\r\n.e-pivotgrid{\r\n    position: inherit !important;\r\n}\r\n\r\n.col-md-10 {\r\n    position: static !important;\r\n}\r\n\r\n.outlet {\r\n    position: static !important;\r\n}"},2011:function(e,t){e.exports="#PivotGrid1 {\r\n    position: relative !important;\r\n    float:left;\r\n    width:500px;\r\n    height: 500px;\r\n    overflow:auto;\r\n}\r\n#PivotSchemaDesigner1 {\r\n    width: 40% !important;\r\n    float:right;\r\n    height: 500px !important;\r\n}"},449:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var n=e.length-1;n>=0;n--)(a=e[n])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:!0});var a=i(5),r=i(78),o=i(64),n=i(1501),s=i(413),d=i(1357),h=i(1356),u=i(1359),c=i(1355),p=i(1348),m=i(1353),g=i(1354),f=i(1360),_=i(1352),v=i(1349),b=i(1350),C=i(1351),S=i(1358);t.pivotgridAppRoutes=[{path:"relational",component:d.RelationalComponent,data:{name:"Relational",location:"app/components/pivotgrid/relational.component"}},{path:"summaryType",component:u.SummaryTypeComponent,data:{name:"Summary Types",location:"app/components/pivotgrid/summaryType.component"}},{path:"numberFormat",component:c.NumberFormatComponent,data:{name:"Number Format",location:"app/components/pivotgrid/numberFormat.component"}},{path:"cellEditing",component:p.CellEdiitngComponent,data:{name:"Cell Editing",location:"app/components/pivotgrid/cellEditing.component"}},{path:"olap",component:h.OlapComponent,data:{name:"OLAP",location:"app/components/pivotgrid/olap.component"}},{path:"kpi",component:m.KPIComponent,data:{name:"KPI",location:"app/components/pivotgrid/kpi.component"}},{path:"namedSets",component:g.NamedSetsComponent,data:{name:"Named Sets",location:"app/components/pivotgrid/namedSets.component"}},{path:"ui",component:f.UIComponent,data:{name:"User Interaction",location:"app/components/pivotgrid/ui.component"}},{path:"hyperlink",component:_.HyperLinkComponent,data:{name:"Hyperlink",location:"app/components/pivotgrid/hyperlink.component"}},{path:"conditionalFormatting",component:v.ConditionalFormattingComponent,data:{name:"Conditional Formatting",location:"app/components/pivotgrid/conditionalFormatting.component"}},{path:"summaryCustomization",component:S.SummaryCustomizatioComponent,data:{name:"Summary Customization",location:"app/components/pivotgrid/summaryCustomization.component"}},{path:"exporting",component:C.ExportingComponent,data:{name:"Exporting",location:"app/components/pivotgrid/exporting.component"}},{path:"excellayout",component:b.ExcelLikeComponent,data:{name:"Excel-like Layout",location:"app/components/pivotgrid/excellayout.component"}},{path:"",redirectTo:"relational"}],t.PivotGridRouting=r.RouterModule.forChild(t.pivotgridAppRoutes);var O=function(){function e(){}return e=l([a.NgModule({imports:[t.PivotGridRouting,o.FormsModule,s.SharedModule],declarations:[d.RelationalComponent,h.OlapComponent,u.SummaryTypeComponent,c.NumberFormatComponent,p.CellEdiitngComponent,m.KPIComponent,g.NamedSetsComponent,f.UIComponent,_.HyperLinkComponent,v.ConditionalFormattingComponent,S.SummaryCustomizatioComponent,C.ExportingComponent,b.ExcelLikeComponent,n.EJ_PIVOTGRID_COMPONENTS]})],e)}();t.PivotGridModule=O}});