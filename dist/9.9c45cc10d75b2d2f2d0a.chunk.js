webpackJsonp([9],{1007:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(){}return e.prototype.pivot_data=function(){return[{Amount:100,Country:"Canada",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Alberta"},{Amount:200,Country:"Canada",Date:"FY 2006",Product:"Van",Quantity:3,State:"British Columbia"},{Amount:300,Country:"Canada",Date:"FY 2007",Product:"Car",Quantity:4,State:"Brunswick"},{Amount:150,Country:"Canada",Date:"FY 2008",Product:"Bike",Quantity:3,State:"Manitoba"},{Amount:200,Country:"Canada",Date:"FY 2006",Product:"Car",Quantity:4,State:"Ontario"},{Amount:100,Country:"Canada",Date:"FY 2007",Product:"Van",Quantity:1,State:"Quebec"},{Amount:200,Country:"France",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Charente-Maritime"},{Amount:250,Country:"France",Date:"FY 2006",Product:"Van",Quantity:4,State:"Essonne"},{Amount:300,Country:"France",Date:"FY 2007",Product:"Car",Quantity:3,State:"Garonne (Haute)"},{Amount:150,Country:"France",Date:"FY 2008",Product:"Van",Quantity:2,State:"Gers"},{Amount:200,Country:"Germany",Date:"FY 2006",Product:"Van",Quantity:3,State:"Bayern"},{Amount:250,Country:"Germany",Date:"FY 2007",Product:"Car",Quantity:3,State:"Brandenburg"},{Amount:150,Country:"Germany",Date:"FY 2008",Product:"Car",Quantity:4,State:"Hamburg"},{Amount:200,Country:"Germany",Date:"FY 2008",Product:"Bike",Quantity:4,State:"Hessen"},{Amount:150,Country:"Germany",Date:"FY 2007",Product:"Van",Quantity:3,State:"Nordrhein-Westfalen"},{Amount:100,Country:"Germany",Date:"FY 2005",Product:"Bike",Quantity:2,State:"Saarland"},{Amount:150,Country:"United Kingdom",Date:"FY 2008",Product:"Bike",Quantity:5,State:"England"},{Amount:250,Country:"United States",Date:"FY 2007",Product:"Car",Quantity:4,State:"Alabama"},{Amount:200,Country:"United States",Date:"FY 2005",Product:"Van",Quantity:4,State:"California"},{Amount:100,Country:"United States",Date:"FY 2006",Product:"Bike",Quantity:2,State:"Colorado"},{Amount:150,Country:"United States",Date:"FY 2008",Product:"Car",Quantity:3,State:"New Mexico"},{Amount:200,Country:"United States",Date:"FY 2005",Product:"Bike",Quantity:4,State:"New York"},{Amount:250,Country:"United States",Date:"FY 2008",Product:"Car",Quantity:3,State:"North Carolina"},{Amount:300,Country:"United States",Date:"FY 2007",Product:"Van",Quantity:4,State:"South Carolina"}]},e.prototype.pivot_rows=function(){return[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}]},e.prototype.pivot_columns=function(){return[{fieldName:"Product",fieldCaption:"Product"}]},e.prototype.pivot_values=function(){return[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}]},e.prototype.pivot_chartvalues=function(){return[{fieldName:"Amount",fieldCaption:"Amount"}]},e.prototype.pivot_Olaprows=function(){return[{fieldName:"[Date].[Fiscal]"}]},e.prototype.pivot_namedsetrows=function(){return[{fieldName:"[Core Product Group]",isNamedSets:!0}]},e.prototype.pivot_gaugerows=function(){return[{fieldName:"[Date].[Fiscal]",filterItems:{filterType:"include",values:["[Date].[Fiscal].[Fiscal Year].&amp;[2004]"]}}]},e.prototype.pivot_gaugecolumns=function(){return[{fieldName:"[Customer].[Customer Geography]",filterItems:{filterType:"include",values:["[Customer].[Customer Geography].[Country].&amp;[Australia]"]}}]},e.prototype.pivot_Olapcolumns=function(){return[{fieldName:"[Customer].[Customer Geography]"}]},e.prototype.pivot_Olapvalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}]},e.prototype.pivot_MultipleAxesvalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"},{fieldName:"[Measures].[Customer Count]"}],axis:"columns"}]},e.prototype.pivot_gaugevalues=function(){return[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"},{fieldName:"[Measures].[Internet Revenue Status]"},{fieldName:"[Measures].[Internet Revenue Trend]"},{fieldName:"[Measures].[Internet Revenue Goal]"}],axis:"columns"}]},e.prototype.pivot_Olapfilters=function(){return[]},e.prototype.pivot_cube=function(){return"Adventure Works"},e.prototype.pivot_datacube=function(){return"//bi.syncfusion.com/olap/msmdpump.dll"},e.prototype.pivot_catelog=function(){return"Adventure Works DW 2008 SE"},e.prototype.size=function(){return{height:"460px",width:"950px"}},e.prototype.primaryYAxis=function(){return{title:{text:"Amount"}}},e.prototype.primaryYAxisOlap=function(){return{title:{text:"Customer Count"}}},e.prototype.primaryXAxis=function(){return{title:{text:"Fiscal Year"},labelRotation:0}},e.prototype.legend=function(){return{visible:!0}},e.prototype.commonSeriesOptions=function(){return{enableAnimation:!0,type:ej.PivotChart.ChartTypes.Column,tooltip:{visible:!0}}},e.prototype.zooming=function(){return{enableScrollbar:!0}},e.prototype.axes=function(){return[{orientation:"vertical",rowIndex:0,majorGridLines:{visible:!1},axisLine:{visible:!0},name:"yAxisConfig",title:{text:"Internet Sales Amount"},opposedPosition:!0,labelFormat:"c"}]},e.prototype.scales=function(){return[{showRanges:!0,radius:150,showScaleBar:!0,size:1,border:{width:.5},showIndicators:!0,showLabels:!0,pointers:[{showBackNeedle:!0,backNeedleLength:20,length:120,width:7},{type:"marker",markerType:"diamond",distanceFromScale:5,placement:"center",backgroundColor:"#29A4D9",length:25,width:15}],ticks:[{type:"major",distanceFromScale:2,height:16,width:1,color:"#8c8c8c"},{type:"minor",height:6,width:1,distanceFromScale:2,color:"#8c8c8c"}],labels:[{color:"#8c8c8c"}],ranges:[{distanceFromScale:-5,backgroundColor:"#fc0606",border:{color:"#fc0606"}},{distanceFromScale:-5}],customLabels:[{position:{x:180,y:290},font:{size:"10px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"},{position:{x:180,y:320},font:{size:"10px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"},{position:{x:180,y:150},font:{size:"12px",fontFamily:"Segoe UI",fontStyle:"Normal"},color:"#666666"}]}]},e}();t.PivotDataService=l},1009:function(e,t,i){var l,a,r;
/*!
*  filename: ej.olap.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.olap.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(o){a=[i(4)],void 0===(r="function"==typeof(l=o)?l.apply(t,a):l)||(e.exports=r)}(function(){!function(e,t,i){t.olap=t.olap||{},t.olap.base={_initProperties:function(){this._columnHeaders=[],this._rowHeaders=[],this._valueCells=[],this.pivotEngine=[],this.olapCtrlObj=null,this._cBIndx=null,this._rBIndx=null,this._OlapDataSource,this._measureDt={},this._cTotIndexInfo=null,this._rTotIndexInfo=null,this._kpi=null,this._rowCount=0,this._colCount=0,this._isPaging=!1,this._indexRCell=0,this._indexCCell=0},_initControlProperties:function(e){e._drilledCellSet=e.model.enablePaging||e.model.enableVirtualScrolling?t.isNullOrUndefined(e._drilledCellSet)?[]:e._drilledCellSet:[],e.XMLACellSet=null,e._isMondrian=e.model.dataSource.providerName==t.olap.Providers.Mondrian,(t.isNullOrUndefined(e._fieldData)||!t.isNullOrUndefined(e._fieldData)&&t.isNullOrUndefined(e._fieldData.hierarchy))&&this._getFieldItemsInfo(e),this._currIndex={},this._isRowDrilled=!1,this._isColDrilled=!1,this._isNoSummary="nosummaries"==e.model.layout},getJSONData:function(i,l,a){var r,o,s;i.action&&("initialLoad"==i.action||"navPaging"==i.action)&&(this._initControlProperties(a),this._applyTrim(a)),"loadFieldElements"==i.action&&(a._baseSavedProperties=e.extend(!0,{},{drilledCellSet:a._drilledCellSet,XMLACellSet:a.XMLACellSet,columnHeaders:this._columnHeaders,rowHeaders:this._rowHeaders,valueCells:this._valueCells,pivotEngine:this.pivotEngine,olapCtrlObj:this.olapCtrlObj,cBIndx:this._cBIndx,rBIndx:this._rBIndx,OlapDataSource:this._OlapDataSource,measureDt:this._measureDt,cTotIndexInfo:this._cTotIndexInfo,rTotIndexInfo:this._rTotIndexInfo,kpi:this._kpi,rowCount:this._rowCount,colCount:this._colCount,isPaging:this._isPaging,indexRCell:this._indexRCell,indexCCell:this._indexCCell})),this._initProperties(),this.olapCtrlObj=a,this._OlapDataSource=l,l.data,a.model.enableGroupingBar&&"loadFieldElements"!=i.action&&a._createGroupingBar(l),this._isPaging=!(!this.olapCtrlObj.model.enablePaging&&!this.olapCtrlObj.model.enableVirtualScrolling||t.isNullOrUndefined(this._OlapDataSource.pagerOptions)||0==this._OlapDataSource.pagerOptions.categoricalPageSize||0==this._OlapDataSource.pagerOptions.seriesPageSize),r=l.MDXQuery?l.MDXQuery:this._getParsedMDX(l,l.cube,!(!i.action||"navPaging"==i.action||!this._isPaging||t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions))),s=this._getConnectionInfo(this.olapCtrlObj.model.dataSource.data),o=t.isNullOrUndefined(l.providerName)||l.providerName==t.olap.Providers.SSAS?'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+r+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+l.catalog+"</Catalog> <LocaleIdentifier>"+s.LCID+"</LocaleIdentifier> </PropertyList> </Properties></Execute> </Body> </Envelope>":'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+r+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+l.sourceInfo+"</DataSourceInfo><Catalog>"+l.catalog+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>","drilldown"!=i.action||this._isPaging?this.olapCtrlObj.doAjaxPost("POST",s.url,{XMLA:o},i.action&&"navPaging"!=i.action&&this._isPaging&&!t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)?this._generatePagingData:this._generateJSONData,null,i):this.olapCtrlObj.doAjaxPost("POST",s.url,{XMLA:o},this._onDemandExpand,null,i)},_getParsedMDX:function(e,l,a){var r,o,s,n,d,h;if(e!=i){if(r="",(d=e.providerName==t.olap.Providers.Mondrian)&&0==e.columns.length&&!("columns"==e.values[0].axis&&e.values[0].measures.length>0))return"";o=t.olap._mdxParser._getRowMDX(e),s=t.olap._mdxParser._getcolumnMDX(e),delete e._isCollapse,o=o.length>0?this._isPaging&&!a||d?"("+o+")":"NON EMPTY("+o+")":"",s=s.length>0?this._isPaging&&!a||d?"("+s+")":"NON EMPTY("+s+")":"",!this._isPaging||a||t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)||(o=(h=this._getPagingQuery(o,s)).rowQuery,s=h.columnQuery),n=t.olap._mdxParser._getSlicerMDX(e,this.olapCtrlObj),r="\nSelect \n"+(""==s?"{}":s)+"\ndimension properties MEMBER_TYPE,CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME  ON COLUMNS \n"+(""==o?"":","+o+"\ndimension properties MEMBER_TYPE,CHILDREN_CARDINALITY, PARENT_UNIQUE_NAME  ON ROWS")+"\n "+t.olap._mdxParser._getIncludefilterQuery(e,l,this.olapCtrlObj)+n+"\n CELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE \n ",""==s&&r.replace(/NON EMPTY/g," "),r=this._getCalculatedItems(r)}return r},_getCalculatedItems:function(i){var l,a,r=this.olapCtrlObj.model.calculatedMembers;if(r&&r.length>0){for(l="\nWITH",a=0;a<r.length;a++){var o=(r[a].expression.indexOf("Measure")>-1?"[Measures].":r[a].hierarchyUniqueName+".")+"["+(r[a].caption||r[a].name)+"]",s=t.isNullOrUndefined(r[a].formatString)?t.isNullOrUndefined(r[a].format)?null:r[a].format:r[a].formatString;l+="\n MEMBER "+o+" as ("+r[a].expression+" ) "+(t.isNullOrUndefined(s)?"":', FORMAT_STRING ="'+e.trim(s)+'"')}return(l=l.replace(/\&/g,"&amp;"))+" "+i}return i},_getPagingQuery:function(e,t){var i=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj._categCurrentPage)&&this._colCount>0?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize):this.olapCtrlObj._categCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage),l=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj._seriesCurrentPage)&&this._rowCount>0?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize):this.olapCtrlObj._seriesCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage),a=e;return{rowQuery:""!=e?"SUBSET({"+(this.olapCtrlObj._isMondrian?"":"NONEMPTY")+"("+e+(this.olapCtrlObj._isMondrian||""==t?"":","+t)+")},"+((0==l?1:l)-1)*this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize+","+this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize+")":"",columnQuery:""!=t?"SUBSET({"+(this.olapCtrlObj._isMondrian?"":"NONEMPTY")+"("+t+(this.olapCtrlObj._isMondrian||""==a?"":","+a)+")},"+((0==i?1:i)-1)*this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize+","+this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize+")":""}},_getAxisElementsUName:function(e){for(var t="",i=0;i<e.length;i++)t+=""==t?"{"+e[i].uniqueName+"}":", {"+e[i].uniqueName+"}";return t},_generatePagingData:function(i,l){var a,r,o;if(e(l).find("Error").length>0)return t.Pivot._createErrorDialog(e(l).find("faultstring").text(),i.action,this.olapCtrlObj),!1;a=e(l).find("Axes, CellData"),this._rowCount=e(a.find("Axis[name|='Axis1']").find("Tuples")).length>0?e(a.find("Axis[name|='Axis1']").find("Tuples")[0]).children().length:0,this._colCount=e(a.find("Axis[name|='Axis0']").find("Tuples")).length>0?e(a.find("Axis[name|='Axis0']").find("Tuples")[0]).children().length:0,r=this._getParsedMDX(this.olapCtrlObj.model.dataSource,this.olapCtrlObj.model.dataSource.cube,!1),o=this._getConnectionInfo(this.olapCtrlObj.model.dataSource.data),this.olapCtrlObj._isMondrian&&(this._controlObj=this.olapCtrlObj),this.olapCtrlObj.doAjaxPost("POST",o.url,{XMLA:t.olap._mdxParser.getSoapMsg(r,this.olapCtrlObj.model.dataSource.data,this.olapCtrlObj.model.dataSource.catalog)},this._generateJSONData,null,i)},_generateJSONData:function(l,a){var r,o,s,n,d,h,c,p,u,m,g,f,b;if(this.olapCtrlObj.model.dataSource=this._OlapDataSource,this._isPaging&&"drilldown"==l.action&&this._onDemandExpand(l,a),r=[],o=[],e(a).find("Error").length>0)return t.Pivot._createErrorDialog(e(a).find("faultstring").text(),"Error",this.olapCtrlObj),!1;if(e(a).find("Axis[name|='SlicerAxis']").remove(),this.olapCtrlObj.XMLACellSet=e(a).find("Axes, CellData"),[],"onDemandDrill"==l&&(this.olapCtrlObj.XMLACellSet=a),s=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"),n=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple"),s.length>0){if(d=e(this.olapCtrlObj.XMLACellSet[1]).children(),this._rowHeaders=this._getHeaderCollection(n,"rowheader"),this._columnHeaders=this._getHeaderCollection(s,"colheader"),this._valueCells=this._getValueCells(d,s.length),this._indexRCell="rowheader"==this._measureDt.axis?t.sum(this._rowHeaders.maxLvlLen)+1:t.sum(this._rowHeaders.maxLvlLen),this._indexCCell="colheader"==this._measureDt.axis?t.sum(this._columnHeaders.maxLvlLen)+1:t.sum(this._columnHeaders.maxLvlLen),this._rowHeaders.headers.length>0&&0==t.sum(this._rowHeaders.maxLvlLen)&&(this._indexRCell=this._rowHeaders.headers[0].length),this._columnHeaders.headers.length>0&&0==t.sum(this._columnHeaders.maxLvlLen)&&(this._indexCCell=this._columnHeaders.headers[0].length),this._isPaging)for(g=0;g<this._rowHeaders.headers.length;g++)for(b=0;b<this._columnHeaders.headers.length;b++)t.isNullOrUndefined(this._valueCells[g])?(this._valueCells[g]=[],this._valueCells[g][b]={FormatString:"#,#",Value:""}):t.isNullOrUndefined(this._valueCells[g][b])&&(this._valueCells[g][b]={FormatString:"#,#",Value:""});for(this._populateEngine(this._rowHeaders.headers,this._columnHeaders.headers,this._valueCells),e(this.olapCtrlObj).find(".e-pivotGridTable").remove(),this.olapCtrlObj._measureDt=this._measureDt,h=this._rowHeaders.headers.length+this._indexCCell,c=this._columnHeaders.headers.length+this._indexRCell,this.pivotEngine.length>1&&(h=this.pivotEngine.length),g=0;g<h;g++)for(b=0;b<c;b++)r[b]==i&&(r[b]=[]),this.pivotEngine[g]!=i&&this.pivotEngine[g][b]!=i?(r[b][g]={Index:b+","+g,CSS:""==this.pivotEngine[g][b].CSS?"none":this.pivotEngine[g][b].CSS==i?"value":this.pivotEngine[g][b].CSS,Value:this.pivotEngine[g][b].Value,State:this.pivotEngine[g][b].ChildCount>0?2:this.pivotEngine[g][b].ChildCount<0?1:0,RowSpan:this.pivotEngine[g][b].RowSpan!=i?this.pivotEngine[g][b].RowSpan:1,ColSpan:this.pivotEngine[g][b].ColSpan!=i?this.pivotEngine[g][b].ColSpan:1,Info:this.pivotEngine[g][b].UName+"::"+this.pivotEngine[g][b].LName+"::"+this.pivotEngine[g][b].Value+"::"+this.pivotEngine[g][b].PUName,Span:"Block"==this.pivotEngine[g][b].Span?"Block":"None",Expander:1},this.pivotEngine[g][b].kpiInfo&&(r[b][g].kpi=this.pivotEngine[g][b].kpi,r[b][g].kpiInfo=this.pivotEngine[g][b].kpiInfo),this.pivotEngine[g][b].ActualValue&&(r[b][g].ActualValue=this.pivotEngine[g][b].ActualValue,r[b][g].Format=this.pivotEngine[g][b].FormatString)):this.pivotEngine[g]!=i&&(p="none",g<this._indexCCell&&b<this._indexRCell&&(p="rowheader"),r[b][g]={Index:b+","+g,CSS:p,Value:"",State:0,RowSpan:1,ColSpan:1,Info:"",Span:"Block",Expander:0});for(g=0;g<c;g++)for(b=0;b<h;b++)r[g]!=i&&r[g][b]!=i&&o.push(r[g][b]);for(u=0,m=0;m<o.length&&0==parseInt(o[m].Index.split(",")[0]);m++)u++}if(this.olapCtrlObj._isExporting&&this.olapCtrlObj.model.enableCompleteDataExport){for(b=0;b<this._indexRCell;b++)for(f="",g=this._indexCCell;g<r[0].length;g++)""!=r[b][g].Info&&(f==r[b][g].Info?r[b][g].Span="Block":f=r[b][g].Info);for(g=0;g<this._indexCCell;g++)for(f="",b=this._indexRCell;b<r.length;b++)""!=r[b][g].Info&&(f==r[b][g].Info?r[b][g].Span="Block":f=r[b][g].Info);this.olapCtrlObj._fullExportedData={jsonObj:o,tranposeEngine:r,rowCount:u},this.olapCtrlObj._drilledCellSet=this.olapCtrlObj._baseSavedProperties.drilledCellSet,this.olapCtrlObj.XMLACellSet=this.olapCtrlObj._baseSavedProperties.XMLACellSet,this._columnHeaders=this.olapCtrlObj._baseSavedProperties.columnHeaders,this._rowHeaders=this.olapCtrlObj._baseSavedProperties.rowHeaders,this._valueCells=this.olapCtrlObj._baseSavedProperties.valueCells,this.pivotEngine=this.olapCtrlObj._baseSavedProperties.pivotEngine,this.olapCtrlObj=this.olapCtrlObj._baseSavedProperties.olapCtrlObj,this._cBIndx=this.olapCtrlObj._baseSavedProperties.cBIndx,this._rBIndx=this.olapCtrlObj._baseSavedProperties.rBIndx,this._OlapDataSource=this.olapCtrlObj._baseSavedProperties.OlapDataSource,this._measureDt=this.olapCtrlObj._baseSavedProperties.measureDt,this._cTotIndexInfo=this.olapCtrlObj._baseSavedProperties.cTotIndexInfo,this._rTotIndexInfo=this.olapCtrlObj._baseSavedProperties.rTotIndexInfo,this._kpi=this.olapCtrlObj._baseSavedProperties.kpi,this._rowCount=this.olapCtrlObj._baseSavedProperties.rowCount,this._colCount=this.olapCtrlObj._baseSavedProperties.colCount,this._isPaging=this.olapCtrlObj._baseSavedProperties.isPaging,this._indexRCell=this.olapCtrlObj._baseSavedProperties.indexRCell,this._indexCCell=this.olapCtrlObj._baseSavedProperties.indexCCell,this.olapCtrlObj._baseSavedProperties={}}else this.olapCtrlObj._pivotRecords={records:o,rowCount:u},"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotGrid"!=this.olapCtrlObj.pluginName?"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotChart"!=this.olapCtrlObj.pluginName&&"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotGauge"!=this.olapCtrlObj.pluginName&&"string"==typeof this.olapCtrlObj.model.dataSource.data&&"ejPivotTreeMap"!=this.olapCtrlObj.pluginName?(this._renderPager(l),this.olapCtrlObj.generateJSON({baseObj:this,tranposeEngine:r,jsonObj:o})):(this.olapCtrlObj.generateJSON({baseObj:this},r),this._isPaging&&this._renderPager(l)):this._renderPivotGrid(l,o),this._columnHeaders=this._rowHeaders=this._valueCells=this.pivotEngine=[],this._cBIndx=this._rBIndx=null,this._measureDt={axis:"",posision:null},this._cTotIndexInfo=this._rTotIndexInfo=null},_renderPager:function(e){var i,l,a,r;this._isPaging&&("navPaging"!=e.action&&(t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)?this.olapCtrlObj.model.enablePaging&&(a={CategoricalCurrentPage:1,CategoricalPageSize:1,SeriesCurrentPage:1,SeriesPageSize:1},r={Column:1,Row:1},this.olapCtrlObj._pagerObj.initPagerProperties(r,a),this.olapCtrlObj._pagerObj.element.css("opacity","0.5"),this.olapCtrlObj._pagerObj.element.find(".e-pagerTextBox").attr("disabled","disabled"),this.olapCtrlObj._pagerObj._unwireEvents()):(i=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize)<parseInt(this.olapCtrlObj._categCurrentPage)?Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize):this.olapCtrlObj._categCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage),l=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)||0==parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)<parseInt(this.olapCtrlObj._seriesCurrentPage)?Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize):this.olapCtrlObj._seriesCurrentPage:parseInt(this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage),i=0==i?1:i,l=0==l?1:l,this._colCount=0==this._colCount?1:this._colCount,this._rowCount=0==this._rowCount?1:this._rowCount,this.olapCtrlObj.model.enablePaging?(a={CategoricalCurrentPage:i,CategoricalPageSize:this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:l,SeriesPageSize:this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize},r={Column:this._colCount,Row:this._rowCount},this.olapCtrlObj._pagerObj.element.css("opacity","1"),this.olapCtrlObj._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),this.olapCtrlObj._pagerObj._unwireEvents(),this.olapCtrlObj._pagerObj._wireEvents(),this.olapCtrlObj._pagerObj.initPagerProperties(r,a)):this.olapCtrlObj.model.enableVirtualScrolling&&(this.olapCtrlObj._categPageCount=Math.ceil(this._colCount/this.olapCtrlObj.model.dataSource.pagerOptions.categoricalPageSize),this.olapCtrlObj._seriesPageCount=Math.ceil(this._rowCount/this.olapCtrlObj.model.dataSource.pagerOptions.seriesPageSize)),this.olapCtrlObj._categCurrentPage=i,this.olapCtrlObj._seriesCurrentPage=l,t.isNullOrUndefined(this.olapCtrlObj._pivotGrid)||(this.olapCtrlObj._pivotGrid._categCurrentPage=i,this.olapCtrlObj._pivotGrid._seriesCurrentPage=l,this.olapCtrlObj._pivotGrid._categPageCount=this.olapCtrlObj._categPageCount,this.olapCtrlObj._pivotGrid._seriesPageCount=this.olapCtrlObj._seriesPageCount))),t.isNullOrUndefined(this.olapCtrlObj.model.dataSource.pagerOptions)||(this.olapCtrlObj.model.dataSource.pagerOptions.categoricalCurrentPage=this.olapCtrlObj._categCurrentPage,this.olapCtrlObj.model.dataSource.pagerOptions.seriesCurrentPage=this.olapCtrlObj._seriesCurrentPage))},_renderPivotGrid:function(e,i){this.olapCtrlObj._dataModel="XMLA",this.olapCtrlObj.setJSONRecords(JSON.stringify(i)),this.olapCtrlObj.setOlapReport(this.olapCtrlObj.model.dataSource),this._renderPager(e),this.olapCtrlObj.model.enableGroupingBar&&this.olapCtrlObj._createGroupingBar(this.olapCtrlObj.model.dataSource),null!=this.olapCtrlObj.model.layout&&this.olapCtrlObj.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.olapCtrlObj.excelLikeLayout(i):this.olapCtrlObj.renderControlFromJSON(i),e.action&&("initialLoad"==e.action||"navPaging"==e.action)&&(this.olapCtrlObj._trigger("renderSuccess",this.olapCtrlObj),this.olapCtrlObj._fieldData={hierarchy:this.olapCtrlObj._fieldData.hierarchy,measures:this.olapCtrlObj._fieldData.measures})},_onDemandExpand:function(t,i){var l,a,r,o,s,n,d,h="",c=this.olapCtrlObj.XMLACellSet,p=e(this.olapCtrlObj.XMLACellSet).find("Axis[name='Axis0'] Tuple").length,u=e(this.olapCtrlObj.XMLACellSet).find("Axis[name='Axis1'] Tuple").length;u=u||1,e(i).find("CellData Cell").length,e(this.olapCtrlObj.XMLACellSet[1]).children().length,t.cellInfo.previousElements.split(">#>");var m=e(i).find("Axis[name|='Axis0']").find("Tuple"),g=e(i).find("Axis[name|='Axis1']").find("Tuple"),f=m.length;a=g.length,e(i).find("Axis[name='SlicerAxis']").remove();var b,_,v=t.cellInfo.itemPosition,C=0,S=!1,O="";for(_="rowheader"==t.cellInfo.axis?g[0]:m[0],h=b=e(_).find("Member:nth-child("+(v+1)+") PARENT_UNIQUE_NAME").text(),o=v+1;o>0;o--)c=e(c).find("Tuple Member:nth-child("+o+") UName:contains('"+b+"')").parents("tuple"),O=(b=e(_).find("Member:nth-child("+(o-1)+") UName").text())+O;if(h=O+h,r=c.index()+1,h=t.cellInfo.previousElements.split(">#>").join().replace(/,/g,""),l=t.cellInfo.preRepItm.split(">#>").join().replace(/,/g,""),this.olapCtrlObj._drilledCellSet&&(C=this.olapCtrlObj._drilledCellSet.length),h=h+" !#"+t.cellInfo.axis,this.olapCtrlObj._drilledCellSet[0]&&C)for(s=0;s<C;s++){for(n=this.olapCtrlObj._drilledCellSet[s].length,t.cellInfo.parentUniqueName,d=0;d<n;d++){if(t.cellInfo.previousElements.startsWith(this.olapCtrlObj._drilledCellSet[s][d].key)){this.olapCtrlObj._drilledCellSet[s].push({key:h,repItms:l}),S=!0;break}if(this.olapCtrlObj._drilledCellSet[s][d].key.startsWith(t.cellInfo.previousElements)){this.olapCtrlObj._drilledCellSet[s].splice(d,0,{key:h,repItms:l}),S=!0;break}}if(S)break}else this.olapCtrlObj._drilledCellSet[0]=[],this.olapCtrlObj._drilledCellSet[0][0]={key:h,repItms:l},S=!0;S||(this.olapCtrlObj._drilledCellSet[C]=[],this.olapCtrlObj._drilledCellSet[C].push({key:h,repItms:l})),this._isPaging||("rowheader"==t.cellInfo.axis?(e(i).find("Axis[name|='Axis1']").find("Tuple"),this._insertCellSet("rowheader",c,g,m,a,p,f,r,i)):(e(i).find("Axis[name|='Axis1']").find("Tuple"),this._insertCellSet("colheader",c,m,g,u,p,f,r,i)),this._generateJSONData("onDemandDrill",this.olapCtrlObj.XMLACellSet))},_insertCellSet:function(t,i,l,a,r,o,s,n,d){var h,c,p,u,m,g=e(e(d).find("CellData Cell")[0]).clone();e(g).find("FmtValue").text(""),i.length>1?e(i[0]).after(l):e(i).after(l),c=o,"rowheader"==t?h=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"):(h=e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple"),c=s);var f=0,b=e(h).filter(function(t,i){if(a[f]&&e(i).find("UName").text()==e(a[f]).find("UName").text())return f++,!0}),_=0,v=!1;for(p=0;p<r;p++){var C,S="",O=0,T=0;for(C="rowheader"==t?(n+p)*c:p*(o+c)+n,u=0;u<c;u++)"rowheader"==t&&e(b[O]).index()==u||"colheader"==t&&e(b[_]).index()==p||!h.length?(m="rowheader"==t?p*s:_*s,S=e(e(d).find("CellData Cell")[m+O]).clone(),e(this.olapCtrlObj.XMLACellSet).find("CellData Cell:nth-child("+(C+T)+")").after(S),O++,v=!0):e(this.olapCtrlObj.XMLACellSet).find("CellData Cell:nth-child("+(C+T)+")").after(e(g).clone()),T++;"colheader"==t&&(v&&_++,v=!1)}this._setCellOrdinal(this.olapCtrlObj.XMLACellSet[1])},_clearDrilledCellSet:function(){for(var t,i=e.extend([],this.olapCtrlObj._drilledCellSet),l="",a=0;a<i.length;a++)(l=i[a][0].key.split("!#")).length&&(t=this._getDrilledMemeber({item:{previousElements:l[0]}})),t.length&&this._onDemandCollapse({drilledMembers:t,action:""},l[1])},_onDemandCollapse:function(i,l){e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple"),e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple");try{this.olapCtrlObj.model.dataSource=t.olap._mdxParser._clearCollapsedItems(l,i.drilledMembers[i.drilledMembers.length-1],this.olapCtrlObj.model.dataSource),i.drilledMembers=i.drilledMembers.splice(0,i.drilledMembers.length-1)}catch(e){this.olapCtrlObj._ogridWaitingPopup.hide()}i.drilledMembers.length?this._onDemandCollapse({drilledMembers:i.drilledMembers,action:i.action},l):"collapse"==i.action&&(this.olapCtrlObj.model.dataSource._isCollapse=!0,delete this._currIndex.axis,this.getJSONData({action:"onDemandCollapse"},this.olapCtrlObj.model.dataSource,this.olapCtrlObj))},_removeCellSets:function(t,i,l,a,r,o){for(var s,n,d,h,c,p,u,m=t.length,g=r[0],f=0;f<i.length;f++)if(e(i[f]).find("UName").text()==e(g).find("UName").text()){u=i[f];break}if(s=m,n=e(u).index())if("rowheader"==o){for(p=l.length;s>0;)e(e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis1']").find("Tuple")[n]).remove(),s--;for(c=ext=n;c<ext+m;c++)d=e(e(this.olapCtrlObj.XMLACellSet[1]).children()).splice(n*p,p),e(d).remove()}else{for(p=i.length,h=l.length;s>0;)e(e(this.olapCtrlObj.XMLACellSet).find("Axis[name|='Axis0']").find("Tuple")[n]).remove(),s--;for(c=0;c<h;c++)d=e(e(this.olapCtrlObj.XMLACellSet[1]).children()).splice(p*c-c*m+n,m),e(d).remove()}this._setCellOrdinal(this.olapCtrlObj.XMLACellSet[1])},_getDrilledMemeber:function(t){for(var i,l,a=[],r=t.item.previousElements.split(">#>").join().replace(/,/g,""),o=this.olapCtrlObj._drilledCellSet,s=(a=e.map(this.olapCtrlObj._drilledCellSet,function(t){return a=e.map(t,function(e){if(e.key.startsWith(r))return e})}),0);s<o.length;s++)for(i=0,l=o[s];o[s]&&i<o[s].length;i++)l[i]&&l[i].key.startsWith(r)&&(l.splice(i,1),i--,l.length||(o.splice(s,1),s--));return a},_getHeaderCollection:function(t,l){var a,r,o,s,n,d,h,c,p,u,m,g,f=[],b="",_=[],v=null,C={},S={},O=this;if(a=e(t).filter(function(t,i){var a,s,n,d=e(i).find("Member"),h=!("4"==e(d[0]).find("MEMBER_TYPE").text())&&-1!=e(d[0]).find("LName").text().indexOf("[(All)]"),c=h?1:0,p=0;for(v=null,h?(o=0,b="total"):(b="",o=d.length),a=1,-1!=e(d[0]).find("LName").text().toLowerCase().indexOf("[measures]")&&(a=0);a<d.length;a++)s=!1,"colheader"==l&&O._OlapDataSource.columns[a]?(O._OlapDataSource.columns[a].hasAllMember||null!=O._OlapDataSource.columns[a].expression)&&(s=!0):"rowheader"==l&&O._OlapDataSource.rows[a]&&(O._OlapDataSource.rows[a].hasAllMember||null!=O._OlapDataSource.rows[a].expression)&&(s=!0),-1!=e(d[a]).find("LName").text().toLowerCase().indexOf("[measures]")||s?(p=h,S.axis=l,S.posision=a,4==parseInt(e(d[a]).find("MEMBER_TYPE").text())&&(-1!=(n=e(d[a]).find("UName").text().toLowerCase()).indexOf("trend]")?(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[a]).find("UName").text(),"trend"))&&(v="trend",S.isKpiExist=!0)):-1!=n.indexOf("status]")?(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[a]).find("UName").text(),"status"))&&(v="status",S.isKpiExist=!0)):-1!=n.indexOf("goal]")&&(O._kpi||O._loadKpi(O.olapCtrlObj.model.dataSource,this._loadKpiSuccess,""),(C=O._isKpi(e(d[a]).find("UName").text()+"::"+e(d[a]).find("Caption").text(),"goal"))&&(v="goal",S.isKpiExist=!0)))):p=-1!=e(d[a]).find("LName").text().indexOf("[(All)]"),(0==h&&1==p||1==h&&0==p)&&(c++,o=a,b="total"),h=p;return r=t,c<2&&f.push({selIndx:r,totLvl:o,type:b,kpi:v,kpiInfo:C}),c<2}).map(function(t,a){for(var r,o,s,n,d=e(a).find("Member"),h=[],c=0;c<d.length;c++)r=!1,o=parseInt(e(d[c]).find("LNum").text()),"colheader"==l&&O._OlapDataSource.columns[c]?O._OlapDataSource.columns[c].hasAllMember||null!=O._OlapDataSource.columns[c].expression?o+=1:r=null!=O._OlapDataSource.columns[c].expression:"rowheader"==l&&O._OlapDataSource.rows[c]&&(O._OlapDataSource.rows[c].hasAllMember||null!=O._OlapDataSource.rows[c].expression?o+=1:r=null!=O._OlapDataSource.rows[c].expression),s=e(d[c]).find("PARENT_UNIQUE_NAME").length?e(d[c]).find("PARENT_UNIQUE_NAME").text():"",h.push({CSS:l,Value:""==e(d[c]).find("Caption").text()?"(Blank)":e(d[c]).find("Caption").text(),ColSpan:1,RowSpan:1,HUName:e(d[c]).attr("Hierarchy"),LName:e(d[c]).find("LName").text(),UName:e(d[c]).find("UName").text(),ChildCount:parseInt(e(d[c]).find("CHILDREN_CARDINALITY").text()),PUName:s,isCalcMem:r,LNum:o,MemberType:parseInt(e(d[c]).find("MEMBER_TYPE").text())}),(-1!=e(d[c]).find("LName").text().toLowerCase().indexOf("[measures]")||r)&&f[t].kpi&&(h[h.length-1].kpiInfo=f[t].kpiInfo,h[h.length-1].kpi=f[t].kpi),_[c]==i?_[c]=o:_[c]<o&&(_[c]=o);return(n=[])[0]=h,n}),"colheader"==l?this._cTotIndexInfo=f:this._rTotIndexInfo=f,a={headers:a,indxInfo:f,maxLvlLen:_},e.isEmptyObject(S)||(this._measureDt=e.extend({},S)),1,l.indexOf(this._OlapDataSource.values[0].axis.substring(0,3))>-1&&(this._measureDt.measureCount=this._OlapDataSource.values[0].measures.length),!this._OlapDataSource._enableBasicEngine&&!this._isPaging){var T={headers:[],indxInfo:[]},y=f.length,x=T.length,M=[],P=[];try{for(p=0;p<y;p++)p<y&&"total"==a.indxInfo[p].type&&(T.indxInfo.push(a.indxInfo.splice(p,1)[0]),T.headers.push(a.headers.splice(p,1)[0]),y--,p--);var w=a.headers.length>0?a.headers[0].length:0,L=0,N=0;for(this._measureDt.posision==w-1&&this._measureDt.axis==l&&(N=1),y=a.headers.length,p=0;p<=y;p++){var D=null,R=null,j=null,I=null;for(D=(I=this._updateMemberVariables(a.headers,D,R,j,p)).prev,R=I.next,j=I.cur,I=null,H=w-2-N;H>=0;H--)if(s=this._comparePrevMembers(a.headers,y,p,H,w,-2),p==y||p>0&&(D&&D[H].UName!=j[H].UName||D[H].UName==j[H].UName&&s))if(j&&D[H].UName==j[H].PUName)p-=n=this._removeSubtotalMembers(a,p,H),y-=n,D=(I=this._updateMemberVariables(a.headers,D,R,j,p)).prev,R=I.next,j=I.cur,I=null;else{var F,A=D,E=(x=0,0),k=0;for(D&&(k=D[H].LNum),j&&(E=j[H].LNum),d=!1,h=E;h<=k;h++){for(x=(F=this._getSummaryHeaders(A,T,H,d,N)).headers.length;F.headers.length>0;)a.headers.splice(p,0,F.headers.pop()),a.indxInfo.splice(p,0,F.indexInfo.pop());d=!0,p+=x,y+=x,A=a.headers[p-1]}}if(p==y&&T.headers.length>0){for(c=0;T.headers.length>0;)a.headers.splice(p,0,T.headers.pop()),a.indxInfo.splice(p,0,T.indxInfo.pop()),y++,c++;p+=c}}var H=0,V="";for(M={headers:[],indxInfo:[]},H=w-1-N,y=a.headers.length,p=0;p<y;p++)if(D=this._findPreviousMember(a.headers,p-1,H),p>0&&a.headers[p-1][H].UName!=a.headers[p][H].UName&&H==w-1-N&&_[H]>1){if(p>0&&a.headers[p]!=i&&0!=a.headers[p-1][H].LNum&&a.headers[p-1][H].UName==a.headers[p][H].PUName)for(u=D;u<0;u++)a.indxInfo[p+u].lnum=a.headers[p+u][H].LNum,a.indxInfo[p+u].type="total",M.indxInfo.push(a.indxInfo.splice(p+u,1)[0]),M.headers.push(a.headers.splice(p+u,1)[0]),p+1==y?V=a.headers[p][H].PUName:(p--,y--);0!=p&&a.headers[p]!=i&&a.headers[p-1][H].LNum>a.headers[p][H].LNum&&(m=[],y=(g=this._insertSummaryHeaders(a,M,m,p,H,w,L,V,!1,P)).itmCnt,p=g.hCnt,L=g.insCnt,P[H]=g.subPos)}}catch(e){this.olapCtrlObj._waitingPopup.hide()}}return"rowheader"==l?this._rBIndx=f:this._cBIndx=f,a},_insertSummaryHeaders:function(t,l,a,r,o,s,n,d,h,c){a=[];var p,u,m,g,f,b,_,v="";n=0;for(t.headers[r-1]&&(d=t.headers[r-1][o].PUName),m=t.headers.length,p=t.headers[r][o].LNum,u=t.headers[r-1][o].LNum,g=this._comparePrevMembers(t.headers,m,r,o,s,n),f=p;f<u;f++){for(e.grep(l.headers,function(e,l){(d==e[o].UName||t.headers[r+1+n]!=i&&t.headers[r][o].UName!=t.headers[r+1+n][o].UName&&t.headers[r][o].PUName==e[o].UName&&g)&&(v=e[o].PUName,a.push(l))}),d=v,g&&(a.reverse(),g=!1);a.length>0;){for(b=a.length-1,_=a[a.length-1],t.headers.splice(r,0,l.headers.splice(a[a.length-1],1)[0]),t.indxInfo.splice(r,0,l.indxInfo.splice(a[a.length-1],1)[0]);b>=0;)_<a[b]&&a[b]--,b--;a.pop(),m++,n++,h&&c[o]++}n>0&&(r+=n,n=0)}return{itmCnt:m,hCnt:r,insCnt:n,subPos:c[o]}},_comparePrevMembers:function(e,t,i,l,a,r){var o,s=!1;if(l>0&&i<t&&i+1+r>=0&&i+1+r<t)for(o=l-1;o>=0;o--)e[i][o].UName!=e[i+1+r][o].UName&&(s=!0);return s},_updateMemberVariables:function(e,t,i,l,a){return e[a]&&(l=e[a]),i=e[a+1]?e[a+1]:null,{cur:l,prev:e[a-1]?e[a-1]:null,next:i}},_removeSubtotalMembers:function(e,t,i){for(var l=t-1,a=e.headers[l][i].UName;e.headers[l]&&e.headers[l][i].UName==a;)e.indxInfo.splice(l,1),e.headers.splice(l,1),l--;return t-(l+1)},_getSummaryHeaders:function(t,i,l,a){var r,o=i.headers,s=t,n=l,d=[],h=[],c=i.indxInfo;return r=e.grep(o,function(e,t){for(var i=!1,l=n;l>=0&&(e[l].UName==s[l].UName||a&&l==n&&e[l].UName==s[l].PUName);l--)0==l&&(i=!0,h.push(c[t]));return i}),i.headers=e.grep(o,function(e,t){for(var i=!0,l=n;l>=0&&(e[l].UName==s[l].UName||a&&l==n&&e[l].UName==s[l].PUName);l--)0==l&&(i=!1);return i&&d.push(c[t]),i}),i.indxInfo=d,{headers:r,indexInfo:h}},_drillOrderHeaderCollection:function(t,i,l){var a=i,r=l,o=this;return e(t).map(function(t,i){var l,s,n,d,h=e(a[i.selIndx]).find("Member"),c=[];for(c[0]=[],l=0;l<h.length;l++)s=parseInt(e(h[l]).find("LNum").text()),"colheader"==r&&o._OlapDataSource.columns[l]?o._OlapDataSource.columns[l].hasAllMember&&(s+=1):"rowheader"==r&&o._OlapDataSource.rows[l]&&o._OlapDataSource.rows[l].hasAllMember&&(s+=1),n=e(h[l]).find("PARENT_UNIQUE_NAME").length?e(h[l]).find("PARENT_UNIQUE_NAME").text():"",c[0].push({CSS:r,Value:e(h[l]).find("Caption").text(),ColSpan:1,RowSpan:1,HUName:e(h[l]).attr("Hierarchy"),LName:e(h[l]).find("LName").text(),UName:e(h[l]).find("UName").text(),ChildCount:parseInt(e(h[l]).find("CHILDREN_CARDINALITY").text()),PUName:n,LNum:s,MemberType:parseInt(e(h[l]).find("MEMBER_TYPE").text())}),d=c[0][c[0].length-1],i.kpiInfo&&d.UName.toLowerCase().indexOf("[measures]")>-1&&4==d.MemberType&&(c[0][c[0].length-1].kpiInfo=i.kpiInfo),i.kpi&&d.UName.toLowerCase().indexOf("[measures]")>-1&&4==d.MemberType&&(c[0][c[0].length-1].kpi=i.kpi);return c})},_loadKpi:function(e,t,i){i={action:"loadFieldElements"};var l=this._getConnectionInfo(e.data),a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_KPIS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog></PropertyList></Properties></Discover></Body></Envelope>";this.olapCtrlObj.doAjaxPost("POST",l.url,{XMLA:a},this._loadKpiSuccess,null,i)},_loadKpiSuccess:function(e,t){this._kpi=t},_isKpi:function(t,i){var l=e(this._kpi).find("row:contains("+t.split("::")[0]+")"),a={};return!!l.length&&("trend"==i?(a.Graphic=e(l).find("KPI_TREND_GRAPHIC").text(),a.Value=e(l).find("KPI_NAME").text()):"status"==i?(a.Graphic=e(l).find("KPI_STATUS_GRAPHIC").text(),a.Value=e(l).find("KPI_NAME").text()):"goal"==i&&(a.Caption=t.split("::")[1],a.Value=e(l).find("KPI_NAME").text()),a)},_getValueCells:function(i,l){var a,r,o,s,n,d=this._columnHeaders.headers.length,h=this._rowHeaders.headers.length?this._rowHeaders.headers.length:1,c=0,p=0;if(this._valueCells[c]=[],this._fillAllValueCells(),i=e(this.olapCtrlObj.XMLACellSet[1]).children(),this._OlapDataSource._enableBasicEngine||this._isPaging)for(o=0;o<i.length;o++)p<d&&(this._valueCells[c][p]={ActualValue:e(i[o]).find("Value").text(),Value:e(i[o]).find("FmtValue")[0]?e(i[o]).find("FmtValue").text():"",FormatString:e(i[o]).find("FormatString")[0]?e(i[o]).find("FormatString").text():"",kpi:!t.isNullOrUndefined(this._cBIndx[p])&&this._cBIndx[p].kpi?this._cBIndx[p].kpi:!t.isNullOrUndefined(this._rBIndx[c])&&this._rBIndx[c].kpi?this._rBIndx[c].kpi:""},p++),p==d&&c+1<h&&(p=0,c++,this._valueCells[c]=[]);else for(a=0;a<h;a++)for(r=this._rBIndx.length?this._rBIndx[a].selIndx:0,o=0;o<d;o++)i&&(s=e(i[r*l+this._cBIndx[o].selIndx]),n="",(this._columnHeaders.indxInfo[o]&&"total"==this._columnHeaders.indxInfo[o].type||this._rowHeaders.indxInfo[a]&&"total"==this._rowHeaders.indxInfo[a].type)&&(n="summary"),p<d&&(this._valueCells[a][o]={ActualValue:e(s).find("Value").text(),Value:e(s).find("FmtValue")[0]?this._getFormatedValue(e(s),e(s).find("FormatString")[0]):"",FormatString:e(s).find("FormatString")[0]?e(s).find("FormatString").text():"",kpi:this._cBIndx[o].kpi?this._cBIndx[o].kpi:this._rBIndx[a]?this._rBIndx[a].kpi:"",summary:n,Span:this._isNoSummary&&"summary"==n?"Block":"None"},p++),p==d&&c+1<h&&(p=0,c++,this._valueCells[c]=[]));return this._valueCells},_fillAllValueCells:function(i){var l,a,r,o,s;i=e(this.olapCtrlObj.XMLACellSet[1]).children();if(!t.isNullOrUndefined(i))for(l=!e(i[0]).clone(),e(l).find("FmtValue").text(""),i,a=0;a<i.length;a++)if(r=parseInt(e(i[a]).attr("CellOrdinal")),i[a+1]&&(o=parseInt(e(i[a+1]).attr("CellOrdinal"))),r+1<o)for(s=r+1;s<o;s++)e(i[a]).after(e(l).clone().attr("CellOrdinal",s)[0]);return i},_setCellOrdinal:function(t){for(var i=e(t).find("Cell"),l=0;l<i.length;l++)e(i[l]).attr("CellOrdinal",l)},_getFormatedValue:function(i,l){var a;if(("en-US"==this.olapCtrlObj.model.locale||!e.isNumeric(parseFloat(e(i).find("Value").text())))&&e(i).length>0)a=e(i).find("FmtValue").text();else switch(l=e(l).length>0?e(l).text().toLowerCase():t.isNullOrUndefined(l)?"":l.length>0?l:"",a=e(i).length>0?parseFloat(i.find("Value").text()):i,l){case"decimal":a=parseFloat(t.widgetBase.formatting("{0:D2}",a,this.olapCtrlObj.model.locale));break;case"percent":a=t.widgetBase.formatting("{0:P0}",a,this.olapCtrlObj.model.locale);break;case"number":a=t.widgetBase.formatting("{0:N}",a,this.olapCtrlObj.model.locale);break;case"currency":a=t.widgetBase.formatting("{0:C2}",a,this.olapCtrlObj.model.locale);break;case"date":a=new Date(864e5*(Number(a)-2)+new Date("01/01/1900").getTime()),this._isDateTime(a)&&(a=t.widgetBase.formatting("{0:MM/dd/yyyy}",a,this.olapCtrlObj.model.locale));break;case"scientific":a=Number(a).toExponential(2).replace("e","E");break;case"accounting":a=this._toAccounting(a,"{0:C2}",this.olapCtrlObj.model.locale);break;case"time":a=new Date(864e5*(Number(a)-2)+new Date("01/01/1900").getTime()),this._isDateTime(a)&&(a=t.widgetBase.formatting("{0:h:mm:ss tt}",a,this.olapCtrlObj.model.locale));break;case"fraction":a="numerator"in(a=this._toFraction(a))?a.integer+" "+a.numerator+"/"+a.denominator:a.integer;break;default:a=e(i).find("FmtValue").text()}return a},_isDateTime:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},_toAccounting:function(e,i,l){var a,r,o,s,n=t.preferredCulture(l).numberFormat.currency.symbol;return val=t.widgetBase.formatting(i,e,this.olapCtrlObj.model.locale),o=val.replace(n,""),!(s=val.indexOf(n))||e<0&&1===s?(a=n,r=Number(e)?o:"-"):(a=Number(e)?o:"-",r=n),a+"   "+r},_toFraction:function(e){if(this._isNumber(e)){var t=e.toString(),i=t.split(".")[0],l=t.split(".")[1];if(!l)return{integer:e};var a=(+l).toString(),r=this._getPlaceValue(l,a),o=this._getGCD(a,r);return{integer:i,numerator:Number(a)/o,denominator:Number(r)/o}}return null},_isNumber:function(e){return e-parseFloat(e)>=0},_getGCD:function(e,t){return e=Number(e),(t=Number(t))?this._getGCD(t,e%t):e},_getPlaceValue:function(e,t){var i=e.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},_populateEngine:function(l,a,r){var o,s,n,d,h,c=l.length,p=a.length,u=c?l[0].length:c,m=p?a[0].length:p,g=[],f=r.length,b=r[0].length;try{this.pivotEngine=[];var _,v=[],C=[],S=[],O=!1;for(d=0;d<p;d++)for(this.pivotEngine[d+m]==i&&(this.pivotEngine[d+m]=[]),0==d&&(this.pivotEngine[0]=[],this.pivotEngine[0][0]={CSS:"none",Value:"",ColSpan:this._indexCCell?this._indexCCell:1,RowSpan:this._indexRCell?this._indexRCell:1,HUName:"",LName:"",UName:"",LNum:""}),o=0;o<m;o++)O=!1,this._OlapDataSource.columns&&this._OlapDataSource.columns[o]&&this._OlapDataSource.columns[o].isNamedSets&&(O=!0),this._pivotEngineSpanCalculation("colheader",a,l,this._columnHeaders.maxLvlLen,r,o,d,C,v,this._cTotIndexInfo,O,S);for(_=this.pivotEngine.slice(),this.pivotEngine=[],d=0;d<_.length;d++)if(_[d])for(o=0;o<_[d].length;o++)_[d][o]&&(this.pivotEngine[o]==i&&(this.pivotEngine[o]=[]),this.pivotEngine[o][d]={CSS:_[d][o].CSS,ColSpan:_[d][o].RowSpan,HUName:_[d][o].HUName,LName:_[d][o].LName,LNum:_[d][o].LNum,RowSpan:_[d][o].ColSpan,UName:_[d][o].UName,PUName:_[d][o].PUName,Value:_[d][o].Value,ChildCount:_[d][o].ChildCount,MemberType:_[d][o].MemberType,Span:"Block"==_[d][o].Span?"Block":"None"},_[d][o].kpiInfo&&(this.pivotEngine[o][d].kpiInfo=_[d][o].kpiInfo,this.pivotEngine[o][d].kpi=_[d][o].kpi));var T=[],y=[];S=[];for(d=0;d<c;d++)for(this.pivotEngine[d+this._indexCCell]==i&&(this.pivotEngine[d+this._indexCCell]=[]),o=0;o<u;o++)O=!1,this._OlapDataSource.rows&&this._OlapDataSource.rows[o]&&this._OlapDataSource.rows[o].isNamedSets&&(O=!0),this._pivotEngineSpanCalculation("rowheader",l,a,this._rowHeaders.maxLvlLen,r,o,d,y,T,this._rTotIndexInfo,O,S);for(g=e.extend(!0,[],this.pivotEngine),u="rowheader"==this._measureDt.axis?this._indexRCell+1:this._indexRCell,m=this._indexCCell?this._indexCCell:m,d=0;d<f;d++)for(this.pivotEngine[d+m]!=i&&(u=this.pivotEngine[d+m].length),o=0;o<b;o++)t.isNullOrUndefined(r[d][o])||(this.pivotEngine[d+m]==i&&(this.pivotEngine[d+m]=[]),s=this._setClassName(r[d][o]),r[d][o].CSS=s,s.indexOf("kpiiconvalue")>-1&&("ejPivotGrid"==this.olapCtrlObj.pluginName||"ejPivotClient"==this.olapCtrlObj.pluginName)?r[d][o].Value="":s.indexOf("kpiiconvalue")>-1&&(r[d][o].Value=parseInt(r[d][o].Value)),this.pivotEngine[d+this._indexCCell][o+this._indexRCell]=r[d][o]);if(e.grep(this.pivotEngine,function(e){return e}),this._isPaging){for(t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName)||"collapse"!=this.olapCtrlObj._pagingSavedObjects.curDrilledItem.action?t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index)?t.isNullOrUndefined(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName)||(e.each(this.olapCtrlObj._pagingSavedObjects.savedHdrEngine,function(i,l){e.each(l,function(e,l){if(!t.isNullOrUndefined(l)&&l.UName==t.olap.base.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName.split("::")[0].split("amp;").join(""))return t.olap.base.olapCtrlObj._pagingSavedObjects.drillEngine.push(t.olap.base.olapCtrlObj._pagingSavedObjects.savedHdrEngine[i][e]),!1})}),this.olapCtrlObj._pagingSavedObjects.drillEngine[this.olapCtrlObj._pagingSavedObjects.drillEngine.length-1].ChildCount=-1):(this.olapCtrlObj._pagingSavedObjects.drillEngine.push(this.olapCtrlObj._pagingSavedObjects.savedHdrEngine[parseInt(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index.split(",")[1])][parseInt(this.olapCtrlObj._pagingSavedObjects.curDrilledItem.index.split(",")[0])]),this.olapCtrlObj._pagingSavedObjects.drillEngine[this.olapCtrlObj._pagingSavedObjects.drillEngine.length-1].ChildCount=-1):e.each(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e,i){if(i.UName==t.olap.base.olapCtrlObj._pagingSavedObjects.curDrilledItem.uniqueName.split("::")[0].split("amp;").join(""))return t.olap.base.olapCtrlObj._pagingSavedObjects.drillEngine.splice(e,1),!1}),e.map(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(i){var l=0,a=e.map(t.olap.base.olapCtrlObj.model.dataSource.columns,function(e,a){return t.olap.base.olapCtrlObj._isMondrian?(l=e.fieldName.replace(/\]/g,"").replace(/\[/g,"")==i.HUName.replace(/\[/g," ").replace(/\[/g,"")?a:l,e.fieldName.replace(/\]/g,"").replace(/\[/g,"")==i.HUName.replace(/\[/g," ").replace(/\[/g,"")):(l=e.fieldName==i.HUName?a:l,e.fieldName==i.HUName)});i.CSS=a[l]?"colheader":"rowheader"}),this.olapCtrlObj._pagingSavedObjects.curDrilledItem={},d=this.pivotEngine[0][0].RowSpan-2;d>=0;d--){for("empty",o=1;o<this.pivotEngine[this.pivotEngine[0][0].RowSpan-1].length;o++)t.isNullOrUndefined(this.pivotEngine[d])&&(this.pivotEngine[d]=[]),t.isNullOrUndefined(this.pivotEngine[d+1])||!t.isNullOrUndefined(this.pivotEngine[d][o])||t.isNullOrUndefined(this.pivotEngine[d+1][o])||(this.pivotEngine[d][o]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==t.olap.base.pivotEngine[d+1][o].PUName})[0],t.isNullOrUndefined(this.pivotEngine[d][o])||(this.pivotEngine[d][o].ColSpan=t.isNullOrUndefined(this.pivotEngine[d][o-1])||this.pivotEngine[d][o-1].UName!=this.pivotEngine[d][o].UName?1:this.pivotEngine[d][o-1].ColSpan+1,this.pivotEngine[d][o].RowSpan=1,this.pivotEngine[d][o].UName));for(n=1,o=this.pivotEngine[this.pivotEngine[0][0].RowSpan-1].length-2;o>0;o--)t.isNullOrUndefined(this.pivotEngine[d])||t.isNullOrUndefined(this.pivotEngine[d][o])||t.isNullOrUndefined(this.pivotEngine[d][o+1])||this.pivotEngine[d][o+1].UName!=this.pivotEngine[d][o].UName?t.isNullOrUndefined(this.pivotEngine[d])||t.isNullOrUndefined(this.pivotEngine[d][o+1])||(this.pivotEngine[d][o+1].ColSpan=1==n?this.pivotEngine[d][o+1].ColSpan:n,n=1):(this.pivotEngine[d][o].ColSpan,this.pivotEngine[d][o+1].ColSpan,n++)}for(d=this.pivotEngine[0][0].RowSpan;d<this.pivotEngine.length;d++)for(h="empty",o=this.pivotEngine[0][0].ColSpan-1;o>=0;o--)t.isNullOrUndefined(this.pivotEngine[d][o])?t.isNullOrUndefined(this.pivotEngine[d-1][o])||this.pivotEngine[d-1][o].UName!=h?(this.pivotEngine[d][o]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==h})[0],t.isNullOrUndefined(this.pivotEngine[d][o])||(this.pivotEngine[d][o].RowSpan=1,this.pivotEngine[d][o].ColSpan=1,h=this.pivotEngine[d][o].PUName)):(this.pivotEngine[d][o]=e.grep(this.olapCtrlObj._pagingSavedObjects.drillEngine,function(e){return e.UName==h})[0],t.isNullOrUndefined(this.pivotEngine[d][o])||(this.pivotEngine[d][o].RowSpan=this.pivotEngine[d-1][o].RowSpan+1,this.pivotEngine[d][o].ColSpan=1,h=this.pivotEngine[d][o].PUName)):h=this.pivotEngine[d][o].PUName;this.olapCtrlObj._pagingSavedObjects.savedHdrEngine=g}}catch(e){this.olapCtrlObj._waitingPopup.hide()}},_pivotEngineSpanCalculation:function(t,l,a,r,o,s,n,d,h,c,p,u){var m,g,f,b,_,v,C,S,O,T,y,x=l.length,M="",P=a.length,w=x?l[0].length:x,L=P?a[0].length:P;o.length,o[0].length;"rowheader"==t?(L=this._indexCCell?this._indexCCell:L,M="row"):(L=this._indexRCell?this._indexRCell:L,M="col"),g=0,p&&(l[n][s].ChildCount=0),this._measureDt.axis==t&&this._measureDt.posision==w-1&&(g=1),d[s]||(d[s]=[]),this._isNoSummary&&!u[s]&&(u[s]=[]),this.pivotEngine[n+L]||(this.pivotEngine[n+L]=[]),h[s]=n;var N=r[s]?r[s]:1,D=0,R=0;for(f=0;f<s;f++)r[f]&&(D+=r[f]-1,R+=r[f]);if(!this._OlapDataSource._enableBasicEngine||this._OlapDataSource._checkSummaryHeaders)for(b=1;b<=N;b++){var j,I=!1,F=l[n][s].LNum;if(d[s][b]==i&&(d[s][b]=0),this._isNoSummary&&u[s][b]==i&&(u[s][b]=0),l[n-1]&&d[s][F]&&(0!=l[n][s].LNum&&l[n-1][s].PUName==l[n][s].UName||s+g==w-1&&l[n-1][s].LNum<l[n][s].LNum)&&(_=d[s][F],this._isNoSummary&&(_+=u[s][F],u[s][F]=0),this.pivotEngine[n+L-_][s+F-1+D]=l[n][s],s+g!=w-1&&(this.pivotEngine[n+L][s+F-1+D]=e.extend({},l[n][s]),this._isNoSummary&&(this.pivotEngine[n+L][s+F-1+D].Span="Block")),this._isNoSummary&&(this.pivotEngine[n+L-_][s+F-1+D].RowSpan=0),p||(this.pivotEngine[n+L-_][s+F-1+D].ChildCount=-1),this.pivotEngine[n+L-_][s+F-1+D].ColSpan=1,this.pivotEngine[n+L-_][s+F-1+D].RowSpan+=d[s][F],this._drilledJSONData(n+L-_,n+L,s+F-1+D,l[n][s]),d[s][F]=0,s+g==w-1&&l[n-1][s].LNum>l[n][s].LNum)){for(v=r[s]-F,C=this._findNextMember(l,n,s),S=0;S<C;S++)this.pivotEngine[n+L+S]||(this.pivotEngine[n+L+S]=[]),this.pivotEngine[n+L+S][s+D+F]={CSS:"summary "+M,Value:"Total",ColSpan:v,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"};this._isNoSummary||(this.pivotEngine[n+L-_][s+F-1+D].RowSpan+=C-1)}if(l[n][s].LNum>b&&(!this._isNoSummary||"total"!=c[n].type)?d[s][b]++:l[n][s].LNum>b&&this._isNoSummary&&"total"==c[n].type&&u[s][b]++,j=n+L,b==l[n][s].LNum&&0==n&&l[n][s].LNum>1)this.pivotEngine[j]||(this.pivotEngine[j]=[]),this.pivotEngine[j][s+b-1+D]=l[n][s],(!(l[n+1]!=i&&l[n][s].LNum<l[n+1][s].LNum)||s+g==w-1&&l[n+1]&&l[n][s].LNum<l[n+1][s].LNum)&&(this.pivotEngine[j][s+b-1+D].ColSpan+=r[s]-this.pivotEngine[j][s+b-1+D].LNum);else if(0!=n&&l[n][s].LNum>1&&b==l[n][s].LNum&&l[n-1][s].UName!=l[n][s].UName&&l[n-1][s].PUName!=l[n][s].UName)this.pivotEngine[j]==i&&(this.pivotEngine[j]=[]),this.pivotEngine[j][s+b-1+D]=l[n][s],(!(l[n+1]!=i&&l[n][s].LNum<l[n+1][s].LNum)||s+g==w-1&&l[n+1]&&l[n][s].LNum<l[n+1][s].LNum)&&(this.pivotEngine[j][s+b-1+D].ColSpan+=r[s]-this.pivotEngine[j][s+b-1+D].LNum);else if(0!=n&&b==l[n][s].LNum&&l[n-1][s].UName==l[n][s].UName)this._isNoSummary&&"total"==c[n].type?this._isNoSummary&&"total"==c[n].type&&u[s][b]++:d[s][b]++,this.pivotEngine[n+L][s+b-1+D]=l[n][s],this._isNoSummary&&"total"==c[n].type&&(this.pivotEngine[n+L][s+b-1+D].Span="Block"),(l[n+1]!=i&&l[n+1][s].UName!=l[n][s].UName||n+1==x&&d[s][b]>0)&&(O=d[s][b],T=l[n][s].LNum,this._isNoSummary&&(O+=u[s][b],u[s][b]=0),O&&this.pivotEngine[n+L-O][s+T-1+D]!=i&&this.pivotEngine[n+L-O][s+T-1+D].Value!=i&&(this.pivotEngine[n+L-O][s+T-1+D].RowSpan+=d[s][b],this._drilledJSONData(n+L-O,n+L,s+T-1+D,l[n][s])),d[s][b]=0);else if(l[n][s].LNum<2&&(b==l[n][s].LNum||0==l[n][s].LNum)||l[n][s].LNum<b&&l[n-1]&&l[n][s].LNum<l[n-1][s].LNum&&"total"==c[n].type&&this._measureDt.axis==t)if(b-1,l[n-1]&&l[n-1][s].UName==l[n][s].UName&&l[n][s].LName.toLowerCase().indexOf("[measures]")>-1&&(this.pivotEngine[n+L][s+b-1+D]=e.extend({},l[n][s]),this._measureDt.measureCount>1&&t==this._measureDt.axis||this._isNoSummary&&"total"==c[n].type?this._measureDt.measureCount>1&&t==this._measureDt.axis||!this._isNoSummary||"total"!=c[n].type||u[s][b]++:d[s][b]++,this._isNoSummary&&"total"==c[n].type&&(this.pivotEngine[n+L][s+b-1+D].Span="Block")),-1!=l[n][s].UName.indexOf("Measures")&&this._isPaging||"total"==c[n].type)if("total"==c[n].type&&-1==l[n][s].LName.toLowerCase().indexOf("[measures]")&&l[n][s].LNum!=b&&0!=r[s]){if((l[n][s-1]&&-1==l[n][s-1].LName.toLowerCase().indexOf("[measures]")||this._measureDt.axis!=t)&&(s>c[n].totLvl||s==w-1&&b>c[n].totLvl&&0!=c[n].totLvl||0==c[n].totLvl&&b-1>c[n].totLvl))break;for(var A=1,E=1,k=0;l[n-E][s]&&0==l[n-E][s].LNum&&!l[n][s].LName.toLowerCase().indexOf("[measures]")>-1;)l[n][s-1]&&l[n-E+1][s-1].UName!=l[n-E][s-1].UName&&k++,E++;0==l[n][s].LNum&&!l[n][s].LName.toLowerCase().indexOf("[measures]")>-1&&(y=0,0,n>0&&s>0&&l[n][s].LName.indexOf("(All)")>-1&&l[n][s-1]&&r[s-1]>1&&(y=this._findPreviousMember(l,n,s-1)),0!=n&&l[n][s-1]&&r[s-1]>1&&l[n+y]&&l[n][s-1].LNum<l[n+y][s-1].LNum&&(k=r[s-1]-l[n][s-1].LNum),"rowheader"==t?(A=this._indexRCell-R+k,this._indexRCell-A):"colheader"==t&&(A=this._indexCCell-R+k,this._indexCCell-A),(1!=r.length&&s==w-1||r.length>1&&s<w-1)&&(I=!0),this._measureDt.axis==t&&(A-=1),1,0!=n&&l[n][s-1]&&l[n][s-1].LNum+1,1,y=n+L,this.pivotEngine[n+L][s+b-1+D-k]={CSS:"summary "+M,Value:"Total",ColSpan:A,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"})}else-1!=l[n][s].LName.toLowerCase().indexOf("[measures]")?(l[n-1]&&l[n-1][s].UName==l[n][s].UName||(this.pivotEngine[n+L][s+b-1+D]=e.extend({},l[n][s]),this._isNoSummary&&"total"==c[n].type&&(this.pivotEngine[n+L][s+b-1+D].Span="Block")),(l[n-1]&&l[n-1][s].UName!=l[n][s].UName||n+1==x)&&(m=d[s][b],this._isNoSummary&&(m+=u[s][b],u[s][b]=0),m&&this.pivotEngine[n+L-m][s+b-1+D]!=i&&(this.pivotEngine[n+L-m][s+b-1+D].RowSpan+=d[s][b],this._drilledJSONData(n+L-m,n+L,s+b-1+D,l[n][s])),d[s][b]=0)):"total"==c[n].type&&1==l.length&&(this.pivotEngine[n+L][s+b-1+D]={CSS:"summary "+M,Value:"Total",ColSpan:1,RowSpan:1,HUName:"",LName:"",UName:"",LNum:"",MemberType:"",ChildCount:"",Span:this._isNoSummary?"Block":"None"});else l[n-1]&&l[n-1][s].UName==l[n][s].UName||(this.pivotEngine[n+L][s+b-1+D]=l[n][s],m=d[s][b],this._isNoSummary&&(m+=u[s][b],u[s][b]=0),m&&this.pivotEngine[n+L-m][s+b-1+D]!=i&&(this.pivotEngine[n+L-m][s+b-1+D].RowSpan+=d[s][b],this._drilledJSONData(n+L-m,n+L,s+b-1+D,l[n][s])),d[s][b]=0),0==!l[n][s].LNum&&(!(l[n+1]!=i&&l[n][s].LNum<l[n+1][s].LNum)||s+g==w-1&&l[n+1]&&l[n][s].LNum<l[n+1][s].LNum)&&this.pivotEngine[n+L][s+b-1+D]&&(this.pivotEngine[n+L][s+b-1+D].ColSpan+=r[s]-this.pivotEngine[n+L][s+b-1+D].LNum);if(I)break}else this.pivotEngine[n+L][s]=l[n][s]},_findNextMember:function(e,t,i){for(var l=0;e[t+l]&&e[t][i].UName==e[t+l][i].UName;)l++;return l},_findPreviousMember:function(e,t,i){for(var l=-1;e[t+l]&&e[t][i].UName==e[t+l][i].UName;)l--;return l},_drilledJSONData:function(t,i,l,a){for(var r=t+1;r<i;r++)this.pivotEngine[r][l]=e.extend({},a),this._isNoSummary&&(this.pivotEngine[r][l].Span="Block")},_setClassName:function(e){var t=parseInt(e.Value),i="value";if(e.kpi)if("trend"==e.kpi)switch(t){case-1:i="value kpiiconvalue kpidownarrow";break;case 0:i="value kpiiconvalue kpirightarrow";break;case 1:i="value kpiiconvalue kpiuparrow"}else if("status"==e.kpi)switch(t){case-1:i="value kpiiconvalue kpidiamond";break;case 0:i="value kpiiconvalue kpitriangle";break;case 1:i="value kpiiconvalue kpicircle"}return e.summary+" "+i},_getFieldItemsInfo:function(e){var t=this._getConnectionInfo(e.model.dataSource.data),i='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_HIERARCHIES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+t.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>";e.doAjaxPost("POST",t.url,{XMLA:i},this._getHierarchyInfo,null,{pvtGridObj:e,action:"loadFieldElements"})},_getHierarchyInfo:function(t,i){for(var l,a,r=[],o=t.pvtGridObj,s=this._getConnectionInfo(o.model.dataSource.data),n=0;n<e(i).find("row").length;n++)l=e(e(i).find("row")[n]),r.push({pid:l.find("DIMENSION_UNIQUE_NAME").text(),id:l.find("HIERARCHY_UNIQUE_NAME").text(),name:l.find("HIERARCHY_CAPTION").text(),tag:l.find("HIERARCHY_UNIQUE_NAME").text(),hasAllMember:0==l.children("ALL_MEMBER").length});o._fieldData={hierarchy:r,hierarchySuccess:i,measures:[]},s.LCID.indexOf("1033")>=0&&!o.model.enableDrillThrough||(a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASURES</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+o.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+o.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+o.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+s.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>",o.doAjaxPost("POST",s.url,{XMLA:a},this._getMeasureInfo,null,{pvtGridObj:o,action:"loadFieldElements"}))},_getMeasureInfo:function(t,i){for(var l=[],a=0;a<e(i).find("row").length;a++){var r=e(e(i).find("row")[a]),o=r.children("MEASUREGROUP_NAME").text(),s=r.find("MEASURE_UNIQUE_NAME").text();l.push({id:s,pid:o,name:r.children("MEASURE_CAPTION").text(),tag:s})}t.pvtGridObj._fieldData.measures=l,t.pvtGridObj._fieldData.measureSuccess=i},_getConnectionInfo:function(t){var i={url:"",LCID:"1033"};return""!=t&&e.map(t.split(";"),function(e){e.toLowerCase().indexOf("locale")<0&&0==i.url.length?i.url=e:e.toLowerCase().indexOf("locale")>=0&&(i.LCID=e.replace(/ /g,"").split("=")[1])}),i},_applyTrim:function(l){var a=[],r=l.model.dataSource,o=this;l._fieldData&&l._fieldData.measures&&l._fieldData.hierarchy?(e.merge(a,l._fieldData.hierarchy),e.merge(a,l._fieldData.measures)):!l._fieldData||!l._fieldData.hierarchy||l._fieldData.hierarchy,r.rows=e.map(r.rows,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),r.columns=e.map(r.columns,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),r.filters=e.map(r.filters,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),r.values=r.values.length>0&&r.values[0].measures!=i?r.values:[{measures:[],axis:"columns"}],r.values[0].measures=e.map(r.values[0].measures,function(l){if(!t.isNullOrUndefined(l)&&l.fieldName!=i)return l.fieldName=e.trim(l.fieldName),o._getCaption(l,a)}),l.model.dataSource=r},_getCaption:function(l,a){var r=l.fieldName,o=[];return t.isNullOrUndefined(l.fieldCaption)&&(a.length>0?(o=e.map(a,function(t){if(t.tag!=i&&t.tag.toLowerCase()==e.trim(r.toLowerCase()))return t}),r.toLowerCase().indexOf("[measures]")>=0&&0==o.length&&r.split(".[").length>0?l.fieldCaption=r.split(".[")[1].replace(/]/g,""):o.length>0&&(l.hasAllMember=!!o[0].hasAllMember,l.fieldCaption=o[0].name)):0==o.length&&(l.fieldCaption=r)),l},clearDrilledItems:function(l,a,r){var o=a.action;return l.rows=e.grep(l.rows,function(e){return e.filterItems!=i&&"filtering"!=o&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=o&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),l.columns=e.grep(l.columns,function(e){return e.filterItems!=i&&"filtering"!=o&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=o&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),l.filters=e.grep(l.filters,function(e){return e.filterItems!=i&&"filtering"!=o&&delete e.filterItems,e.filterItems!=i&&"advancedFilter"!=o&&delete e.advancedFilter,e.drilledItems!=i&&delete e.drilledItems,e._prevDimElements!=i&&delete e._prevDimElements,e}),"filtering"!=o&&(r._currentReportItems=e.map(r._currentReportItems,function(e){if(!t.isNullOrUndefined(e.dataSrc)){if(e.dataSrc.cube!=l.cube)return e;if(e.dataSrc.reportName!=l.reportName)return e}}),t.isNullOrUndefined(r._schemaData)||r._schemaData.element.find(".filter").remove(),r._savedReportItems=e.extend(!0,[],r._currentReportItems)),t.olap.base._clearDrilledCellSet(),l}},t.olap._mdxParser={_getRowMDX:function(l){var a,r,o=e(l)[0].rows,s="",n="",d=[],h=!1,c=!1,p=l._isCollapse,u=l.values.length>0&&l.values[0].measures!=i&&l.values[0].axis==t.olap.AxisName.Row;if(t.isNullOrUndefined(l.providerName)||l.providerName==t.olap.Providers.SSAS){if(o.length>0){for(c=!t.isNullOrUndefined(o[0].drillCellInfo),a=0;a<o.length;a++){var m=!(t.isNullOrUndefined(o[a].isNamedSets)||!o[a].isNamedSets),g="",f="";o[a].fieldName==i||m?m&&(s=a>0?s+"*{"+o[a].fieldName+"}":"{"+o[a].fieldName+"}"):(g=this._getDimensionQuery(o[a],l,"rows",a,!1),d.push(g.replace(/["'\(\)]/g,"").replace(/["'\{\}]/g,"").replace(/\levels0/g,"levels(0)")),t.olap.base._isPaging&&c&&(f=this._getDimensionQuery(o[a],l,"rows",a,!0)),o[a].sortOrder&&o[a].sortOrder!=t.olap.SortOrder.None?(r=o[a].sortOrder==t.olap.SortOrder.Ascending?"asc":"desc",h=!0,s=s+(a>0?"*":"")+"{ORDER({HIERARCHIZE({"+(t.olap.base._isPaging&&c?f:g)+"})},"+o[a].fieldName+".CurrentMember.MEMBER_CAPTION,"+r+")}"):s=s+(a>0?"*":"")+"{HIERARCHIZE({({"+(t.olap.base._isPaging&&c?f:g)+"})})}")}t.olap.base._isPaging&&this._updateOlapReport(e(l)[0].rows,s,"rows",d),p&&(h=p),s=(h?" ":" HIERARCHIZE ")+"( {"+(t.olap.base._isPaging?s:this._updateOlapReport(e(l)[0].rows,s,"rows",d))+"})",p&&(s="HIERARCHIZE("+s+")")}u&&(n=t.olap._mdxParser._getMeasuresQuery(l),s=""!=s?(t.olap.base._isPaging?s.slice(0,-1):s)+(""!=s&&""!=n?t.olap.base._isPaging?"*":",":"")+n:(t.olap.base._isPaging&&""!=n?"(":"")+n),t.olap.base._isPaging&&(s=""!=s?""==n?("}"!=s[s.length-1]?s.slice(0,-1):s)+this._getDrilledSection(l,e.extend(!0,{},o),"row",n)+")":s+this._getDrilledSection(l,e.extend(!0,{},o),"row",n)+")":"")}else s=this._generateAxisMDXOnMondrian(l,o,u);return s},_generateAxisMDXOnMondrian:function(e,i,l){for(var a,r,o="",s=0;s<i.length;s++)a=t.olap.base._isPaging?"({"+i[s].fieldName+".children})":"DrillDownLevel({"+i[s].fieldName+"})",!t.isNullOrUndefined(i[s].drilledItems)&&i[s].drilledItems.length>0&&(a=this._getDrilledMDXOnMondrian(i[s].drilledItems,a)),!t.isNullOrUndefined(i[s].filterItems)&&!t.isNullOrUndefined(i[s].filterItems.values)&&i[s].filterItems.values.length>0&&(a="({{hierarchize(Union(Intersect((Except("+("Descendants("+i[s].fieldName+","+e._maxLevel+", SELF_AND_BEFORE)")+","+(r="{"+i[s].filterItems.values.join()+"}")+")),"+a+"),Except("+a+","+r+")))}})"),o+=(""==o?"":"*")+a;return l&&(o+=(""==o?"":"*")+t.olap._mdxParser._getMeasuresQuery(e)),o},_getDrilledMDXOnMondrian:function(e,i){for(var l=0;l<e.length;l++)i=t.olap.base._isPaging?"Except(DrillDownMember("+i+", {"+e[l].join()+"}),{"+e[l].join()+"})":"(DrillDownMember("+i+", {"+e[l].join()+"}))";return i},_getcolumnMDX:function(l){var a,r,o=e(l)[0].columns,s="",n="",d=[],h=!1,c=!1,p=l._isCollapse,u=l.values.length>0&&l.values[0].measures!=i&&l.values[0].axis==t.olap.AxisName.Column;if(t.isNullOrUndefined(l.providerName)||l.providerName==t.olap.Providers.SSAS){if(o.length>0){for(c=!t.isNullOrUndefined(o[0].drillCellInfo),a=0;a<o.length;a++){var m=!(!t.isNullOrUndefined(o[a].isNamedSets)&&o[a].isNamedSets),g=(h=!1,""),f="";o[a].fieldName!=i&&m?(g=this._getDimensionQuery(o[a],l,"columns",a,!1),d.push(g.replace(/["'\(\)]/g,"").replace(/["'\{\}]/g,"")),t.olap.base._isPaging&&c&&(f=this._getDimensionQuery(o[a],l,"columns",a,!0)),o[a].sortOrder&&o[a].sortOrder!=t.olap.SortOrder.None?(r=o[a].sortOrder==t.olap.SortOrder.Ascending?"asc":"desc",h=!0,s=s+(a>0?"*":"")+"{ ORDER ({HIERARCHIZE ({"+(t.olap.base._isPaging&&c?f:g)+"})},"+o[a].fieldName+".CurrentMember.MEMBER_CAPTION,"+r+")}"):s=s+(a>0?"*":"")+"{"+(t.olap.base._isPaging&&c?f:g)+"}"):s=a>0?s+"*{"+o[a].fieldName+"}":"{"+o[a].fieldName+"}"}t.olap.base._isPaging&&c&&this._updateOlapReport(e(l)[0].columns,s,"columns",d),p&&(h=p),s=(h?" ":" HIERARCHIZE ")+"( {"+(t.olap.base._isPaging?s:this._updateOlapReport(o,s,"columns",d))+"})",p&&(s="HIERARCHIZE("+s+")")}u&&(n=t.olap._mdxParser._getMeasuresQuery(l),s=""!=s?(t.olap.base._isPaging?s.slice(0,-1):s)+(""!=s&&""!=n?t.olap.base._isPaging?"*":",":"")+n:(t.olap.base._isPaging&&""!=n?"(":"")+n),t.olap.base._isPaging&&(s=""!=s?""==n?("}"!=s[s.length-1]?s.slice(0,-1):s)+this._getDrilledSection(l,e.extend(!0,{},o),"column",n)+")":s+this._getDrilledSection(l,e.extend(!0,{},o),"column",n)+")":"")}else s=this._generateAxisMDXOnMondrian(l,o,u);return s},_getDrilledSection:function(i,l,a,r){var o="";l=l;return e.each(l,function(i,l){t.isNullOrUndefined(l.drilledItems)||e.each(l.drilledItems,function(t,l){var a="",s="";e.each(l,function(e,t){a=""==a?"{"+t+"}":a+"*{"+t+"}",t=e==i?t.replace(".children",""):t,s=""==s?"{"+t+"}":s+"*{"+t+"}"}),""!=r&&(a=a+"*"+r,s=s+"*"+r),o=""==o?"+{"+a+"}-{"+s+"}":o+"+{"+a+"}-{"+s+"}"})}),o},_getSortedMembers:function(i){var l,a=i.fieldName;return i.sortOrder&&i.sortOrder!=t.olap.SortOrder.None?(l="ascending"==i.sortOrder?"asc":"desc",e.map(i.drilledItems,function(t){return e.map(t,function(e){return e.indexOf(a)>=0&&(e="order ( "+e+" , "+a+".CurrentMember.MEMBER_CAPTION,"+l+")"),e})})):i.drilledItems},_getAvailCount:function(i,l,a){var r=0;return e.each(i.split("--"),function(e,i){i=i.replace(a[e],""),l.split("--").length>0&&!t.isNullOrUndefined(l.split("--")[e])&&(r+=i.indexOf(l.split("--")[e])>-1&&!((i+"$").indexOf(l.split("--")[e])>-1)||l.split("--")[e].indexOf(i)>-1&&!(l.split("--")[e].indexOf(i+"$")>-1)?1:0)}),r},_updateTmpItems:function(i,l,a,r){var o=e.map(l.split("--"),function(e,i){return t.isNullOrUndefined(a.split("--")[i])||e.replace(r[i],"")!=a.split("--")[i].replace(r[i],"")||-1!=e.indexOf(r[i])?e:a.split("--")[i]}).join("--");-1==i.indexOf(o)&&i.push(o)},_updateExpandCollection:function(i,l,a){return e.each(l,function(r,o){e.each(l,function(l,r){var s,n,d;o!=r&&(s=0,e.each(r.split("--"),function(e,i){i=i.replace(a[e],""),t.isNullOrUndefined(o.split("--")[e])||(s+=r.split(a[e]).join("").indexOf(o.split("--")[e].replace(a[e],""))>-1||o.split("--")[e].replace(a[e],"").indexOf(i)>-1?1:0)}),s==r.split("--").length&&t.olap._mdxParser._updateTmpItems(i,o,r,a),s==o.split("--").length&&t.olap._mdxParser._updateTmpItems(i,r,o,a),n=[],d=0,e.each(r.split("--"),function(e,i){var l=o.split("--").length>e?o.split("--")[e]:"";t.isNullOrUndefined(l)||""==l||(i!=l&&i.indexOf("$")>-1&&(i.indexOf(l)>-1||l.indexOf(i)>-1)&&o.split("--").length-1>e?(n.push(i),d++):n.push(l))}),d>0&&i.push(n.concat(e.map(o.split("--"),function(e,t){if(t>=n.length)return e})).join("--")))})}),i},_updateDrillQuery:function(i,l,a,r){var o,s,n,d=t.olap.base._isRowDrilled||t.olap.base._isColDrilled,h=e.map(i,function(i){var l=e.map(t.olap.base.olapCtrlObj._prevDrillElements,function(e){if(e.indexOf(i.fieldName)>-1)return e}).join("$");if(""!=l)return l}).join("--"),c=e.map(r,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),p=e.map(i,function(e){return!t.isNullOrUndefined(e.hasAllMember)&&e.hasAllMember?".levels(0).AllMembers":".children"});d||""==h||(t.isNullOrUndefined(i[h.split("--").length-1]._prevDimElements)||-1!=i[h.split("--").length-1]._prevDimElements.indexOf(h+p[h.split("--").length-1])?i[h.split("--").length-1]._prevDimElements=i[h.split("--").length-1]._prevDimElements.filter(function(e){if(t.olap._mdxParser._getAvailCount(e,h,p)!=h.split("--").length)return e}):i[h.split("--").length-1]._prevDimElements.push(h+p[h.split("--").length-1]+"!#collapse")),i=e.map(i,function(i){return t.isNullOrUndefined(i._prevDimElements)?i:(i._prevDimElements=e.map(i._prevDimElements,function(i){var l=-1!=i.indexOf("!#collapse");return d?i.indexOf("!#collapse")>-1?(i=i.replace("!#collapse",""),t.olap._mdxParser._getAvailCount(i,h,p)!=h.split("--").length?i:void 0):i:""!=h?(i=i.replace("!#collapse",""),t.olap._mdxParser._getAvailCount(i,h,p)==h.split("--").length?e.map(i.split("--"),function(e,t){return t==h.split("--").length-1&&-1==e.indexOf(p[t])?h.split("--")[h.split("--").length-1]+"":e}).join("--")+(l?"!#collapse":""):i+(l?"!#collapse":"")):i}),""!=h&&(i._prevDimElements=e.map(i._prevDimElements,function(e){if(!(e.indexOf("!#collapse")>-1&&i._prevDimElements.filter(function(e){if(-1==e.indexOf("!#collapse"))return e}).indexOf(e.replace("!#collapse",""))>-1||-1==e.indexOf("!#collapse")&&i._prevDimElements.map(function(e){if(e.indexOf("!#collapse")>-1)return e.replace("!#collapse","")}).indexOf(e)>-1))return e})),i)});var u=e.map(i,function(e){if(!t.isNullOrUndefined(e._prevDimElements))return e._prevDimElements}).filter(function(e){if(-1==e.indexOf("!#collapse"))return e}),m=e.map(i,function(e){if(!t.isNullOrUndefined(e._prevDimElements))return e._prevDimElements}).filter(function(e){if(e.indexOf("!#collapse")>-1)return e}).map(function(e){return e.replace("!#collapse","")}),g=0==h.length?i.length:h.split("--").length,f=[];return d&&(u=e.map(u,function(e){if(t.olap._mdxParser._getAvailCount(e,h,p)==h.split("--").length)return e})),o=t.olap._mdxParser._updateExpandCollection([],u,p),s=t.olap._mdxParser._updateExpandCollection([],o,p),u=u.concat(o.concat(s)),o=[],e.each(u,function(t,i){e.each(m,function(t,l){var a=[],r=0;i.split("--").length>l.split("--").length&&(e.each(l.split("--"),function(e,t){var l=i.split("--")[e];(t.replace(p[e],"").indexOf(l.replace(p[e],""))>-1||l.replace(p[e],"").indexOf(t.replace(p[e],""))>-1)&&(a.push(t),r++)}),l.split("--").length==r&&r<i.split("--").length&&-1==o.indexOf(a.concat(e.map(i.split("--"),function(e,t){if(t>=a.length)return e})).join("--"))&&-1==m.indexOf(a.concat(e.map(i.split("--"),function(e,t){if(t>=a.length)return e})).join("--"))&&o.push(a.concat(e.map(i.split("--"),function(e,t){if(t>=a.length)return e})).join("--")))})}),m=m.concat(o),u=e.map(u,function(i){var l=d?g:i.split("--").length;return e.map(i.split("--"),function(e,i){return i<l-1?!t.isNullOrUndefined(h.split("--")[i])&&(h.split("--")[i].indexOf(e.replace(p[i],"")>-1)||e.replace(p[i],"").indexOf(h.split("--")[i])>-1)&&d?c[i].split("&amp;").join("&"):e.split("$")[e.split("$").length-1]:i==l-1?d?c[i].split("&amp;").join("&"):e.replace(p[i],"").split("$")[e.split("$").length-1]+p[i]:e.split("$")[e.split("$").length-1]}).join("--")}).sort(function(e,t){return e.split("--").length-t.split("--").length}),u=e.map(u,function(t){var i=[];return(i=t.split("--").length<c.length?[t.split("&").join("&amp;").split("--").concat(e.map(c,function(e,i){if(t.split("--").length-1<i)return e}))]:[t.split("&").join("&amp;").split("--")]).join()!=c.join()?i:void 0}),m=e.map(m,function(t){return t.split("--").length<c.length?[t.split("&").join("&amp;").split("--").map(function(e){return e.split("$")[e.split("$").length-1]}).concat(e.map(c,function(e,i){if(t.split("--").length-1<i)return e}))]:[t.split("&").join("&amp;").split("--").map(function(e){return e.split("$")[e.split("$").length-1]})]}),f=[],e.each(e.map(u,function(e){return e.join("--")}),function(e,t){(0==f.length||-1==f.indexOf(t))&&f.push(t)}),n={expandCollection:u=e.map(f,function(e){return[e.split("--")]}),collapseCollection:m},u.length>0&&i.length>1&&r[r.length-1].indexOf(".children")<0&&(l=this._getDrillQuery(n,l,i)),l},_updateOlapReport:function(l,a,r,o){var s,n,d,h=this;return"rows"==r?(s=e.map(l,function(e,t){if(l[t].drilledItems!=i)return h._getSortedMembers(e,l)}),t.olap.base._isRowDrilled&&"rows"==t.olap.base._currIndex.axis&&l[t.olap.base._currIndex.Index]!=i&&l[t.olap.base._currIndex.Index].drilledItems!=i?(d=e.map(o,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),l[t.olap.base._currIndex.Index].drilledItems.push(d),t.olap.base._isRowDrilled=!1):s.length>0&&(t.olap.base._currIndex.axis==i||"columns"==t.olap.base._currIndex.axis&&!t.olap.base._isRowDrilled)&&(a=this._getDrillQuery(s,a,l)),t.isNullOrUndefined(t.olap.base._currIndex.axis)||"rows"!=t.olap.base._currIndex.axis||(t.olap.base._currIndex={})):(n=e.map(l,function(e,t){if(l[t].drilledItems!=i)return h._getSortedMembers(e,l)}),t.olap.base._isColDrilled&&"columns"==t.olap.base._currIndex.axis&&l[t.olap.base._currIndex.Index]!=i&&l[t.olap.base._currIndex.Index].drilledItems!=i?(d=e.map(o,function(e){return e.indexOf("DrillDownlevel")>=0&&(e=e.replace("DrillDownlevel","DrillDownlevel(")+")"),e}),l[t.olap.base._currIndex.Index].drilledItems.push(d),t.olap.base._isColDrilled=!1):n.length>0&&(t.olap.base._currIndex.axis==i||"rows"==t.olap.base._currIndex.axis&&!t.olap.base._isColDrilled)&&(a=this._getDrillQuery(n,a,l)),t.isNullOrUndefined(t.olap.base._currIndex.axis)||"columns"!=t.olap.base._currIndex.axis||(t.olap.base._currIndex={})),a},_getDrillQuery:function(l,a,r){for(var o,s,n,d="",h=l,c=0;c<h.length;c++)if(h[c][h[c].length-1].toLowerCase().indexOf(".children")>=0||h[c][h[c].length-1].toLowerCase().indexOf("drilldownlevel")>=0||h[c][h[c].length-1].toLowerCase().indexOf("members")>=0||(h[c][h[c].length-1]=h[c][h[c].length-1]+".children"),h[c].length!=r.length){for(o=e.map(r,function(l){if(l.fieldName!=i&&l.fieldName!=h[c][[h[c].length-1]].split(".").splice(0,2).join("."))return{uniqueName:t.olap.base._isPaging?"("+e.trim(l.fieldName)+").children":"DrillDownLevel("+e.trim(l.fieldName)+")",fieldName:e.trim(l.fieldName)}}),s=0;s<o.length;s++)n=this._getItemPosition(r,o[s].fieldName)[0],h[c].toString().indexOf(o[s].fieldName)>=0||h[c].splice(n,0,o[s].uniqueName);d=d+""+(c>0?",":"")+"\n ("+h[c]+")"}else d=d+""+(c>0?",":"")+"\n ("+h[c].toString()+")\n";return"("+a+"),"+d},_createDrillThroughQuery:function(i,l){var a,r;if(l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)l._waitingPopup.show(),a=e(l.element).hasClass("e-pivotclient")?l.element.find(".e-pivotgrid").data("ejPivotGrid"):l,l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.drillThroughDataTable,JSON.stringify({currentReport:e(l.element).parents(".e-pivotclient").length>0?l.currentReport:JSON.parse(a.getOlapReport()).Report,layout:e(l.element).hasClass("e-pivotclient")?l.model.gridLayout:l.model.layout,cellPos:"",selector:i}),function(e){this._trigger("drillThrough",{element:e.element,data:e})}),l._waitingPopup.hide();else{var o=l.measureGrp,s="",n="DRILLTHROUGH Select("+l._colHeader.join()+","+l._rowHeader.join()+") on 0 from ["+l.model.dataSource.cube+"]";e.map(l._fieldData.measures,function(e){e.pid==o&&(s+=""==s?"["+o+"]."+e.id.split(".")[1]:",["+o+"]."+e.id.split(".")[1])}),n=n.replace(/&/g,"&amp;"),r=l._getConnectionInfo(l.model.dataSource.data),pData='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+n+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+l.model.dataSource.catalog+"</Catalog> </PropertyList> </Properties></Execute> </Body> </Envelope>",l.doAjaxPost("POST",r.url,{XMLA:pData},t.Pivot._generateDrillData,null,{pvtGridObj:l,action:"loadFieldElements"})}},_getDimensionQuery:function(l,a,r,o,s){var n="";return l.drillCellInfo==i||s?n=t.isNullOrUndefined(l.expression)?t.isNullOrUndefined(l.hasAllMember)||!l.hasAllMember?t.olap.base._isPaging?"(("+e.trim(l.fieldName)+").children)":"DrillDownlevel(("+e.trim(l.fieldName)+"))":"(("+e.trim(l.fieldName)+").levels(0).AllMembers)":"("+l.hierarchyUniqueName+".["+(l.fieldCaption||l.fieldName)+"])":(n="{("+l.drillCellInfo.uniqueName+")}",delete l.drillCellInfo),n},_updateReport:function(i,l,a,r){var o,s,n,d={};r._isMondrian?(o=l.preRepItm.split(">#>"),s=(n=l.itemPosition)?l.previousElements.split(o[n-1])[1].split("][").length:l.previousElements.split("][").length,a.drilledItems&&(a.drilledItems.length<=s-1&&(a.drilledItems[s-1]=[]),l.action&&"collapse"==l.action?a.drilledItems[s-1]=e.grep(a.drilledItems[s-1],function(e){return e!=o[n]}):a.drilledItems[s-1].push(o[n])),d={action:"mondrianDrilldown"}):(a.drillCellInfo=e.extend({},l),a.drillCellInfo.uniqueName="("+e.trim(a.drillCellInfo.uniqueName)+".children)",d={action:"drilldown",cellInfo:l}),t.olap.base.getJSONData(d,r.model.dataSource,r)},_splitCellInfo:function(e){var i,l=t.olap.base.olapCtrlObj._isMondrian?1:2;return e&&(i={hierarchyUniqueName:e.split("::")[1].split(".").splice(0,l).join("."),uniqueName:e.split("::")[0],levelUniqueName:e.split("::")[1],leveName:e.split("::")[2],parentUniqueName:e.split("::")[3]}),i},updateDrilledReport:function(l,a,r){var o,s,n,d,h;t.olap.base._isPaging&&!t.isNullOrUndefined(r._pagingSavedObjects.curDrilledItem)&&(r._pagingSavedObjects.curDrilledItem=l);t.olap._mdxParser;var c,p,u,m=null,g="",f="";if((c=this._splitCellInfo(l.uniqueName)).targetUName=l.uniqueName,c.previousElements="",(p="rowheader"==a?r.model.dataSource.rows:"colheader"==a?r.model.dataSource.columns:null).length>0){if(m=(u=e.map(p,function(t,l){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(c.hierarchyUniqueName).toLowerCase()?{report:t,index:l}:t.hierarchyUniqueName!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(c.hierarchyUniqueName).toLowerCase()?{report:t,index:l}:void 0}))[0].report,c.itemPosition=u[0].index,!t.isNullOrUndefined(r._pivotRecords)||t.isNullOrUndefined(r._pivotClientObj)||t.isNullOrUndefined(r._pivotClientObj._pivotRecords)||(r._pivotRecords=r._pivotClientObj._pivotRecords),o=e.map(r._pivotRecords.records,function(e){if(e.Info.replace(/&/g,"&amp;")==l.uniqueName)return e.Index}),m.drilledItems!=i?m.drilledItems:m.drilledItems=[],t.olap.base._currIndex={axis:"rowheader"==a?"rows":"columns",Index:u[0].index},"ejPivotChart"==r.pluginName||"ejPivotTreeMap"==r.pluginName||t.isNullOrUndefined(l.index)){for(c.cellIndex=o.length>0?"":l.index,c.axis=_=a,"rowheader"!=a?t.olap.base._isColDrilled=l.action==i||"collapse"!=l.action:t.olap.base._isRowDrilled=l.action==i||"collapse"!=l.action,s=0;s<r.model.dataSource.rows.length&&l.seriesInfo[s]!=l.uniqueName;s++)r.model.dataSource.rows[s].drillCellInfo=this._splitCellInfo(l.seriesInfo[s]);for(c.previousElements="",c.preRepItm="",s=0;s<l.uniqueNameArray.length;s++)c.previousElements+=this._splitCellInfo(l.uniqueNameArray[s]).uniqueName;for(s=0;s<l.seriesInfo.length;s++)c.preRepItm+=""==c.preRepItm?this._splitCellInfo(l.seriesInfo[s]).uniqueName:">#>"+this._splitCellInfo(l.seriesInfo[s]).uniqueName}else{c.cellIndex=l.index;var b=c.hierarchyUniqueName,_="",v=(g="",""),C=c.cellIndex.split(",")[0],S=c.cellIndex.split(",")[1];if("rowheader"==a)for(_="rowheader",t.olap.base._isRowDrilled=l.action==i||"collapse"!=l.action,s=parseInt(C);s>=0;s--)!r._pivotRecords.records[parseInt(s*r._pivotRecords.rowCount+parseInt(C))].Info.indexOf(b)>=0&&(v=r._pivotRecords.records[parseInt(s*r._pivotRecords.rowCount+parseInt(S))].Info,(n=this._splitCellInfo(v))&&(g=n.uniqueName+g),""==v||v.indexOf(b)>=0||((d=this._splitCellInfo(v)).uniqueName=d.uniqueName.replace(/&/g,"&amp;"),f=d.uniqueName+">#>"+f,currReport=e.map(p,function(t,l){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:t.hierarchyUniqueName!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:void 0}),"collapse"!=l.action&&(r.model.dataSource.rows[currReport[0]].drillCellInfo=d),b=d.hierarchyUniqueName));else for(_="colheader",t.olap.base._isColDrilled=l.action==i||"collapse"!=l.action,s=parseInt(S);s>=0;s--)!r._pivotRecords.records[parseInt(C*r._pivotRecords.rowCount+parseInt(s))].Info.indexOf(b)>=0&&(v=r._pivotRecords.records[parseInt(C*r._pivotRecords.rowCount+parseInt(s))].Info,(n=this._splitCellInfo(v))&&(g=n.uniqueName+(r._isMondrian?"":">#>")+g),""==v||v.indexOf(b)>=0||((d=this._splitCellInfo(v)).uniqueName=d.uniqueName.replace(/&/g,"&amp;"),f=d.uniqueName+(r._isMondrian?">#>":"")+f,currReport=e.map(p,function(t,l){return t.fieldName!=i&&e.trim(t.fieldName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:t.expression!=i&&e.trim(t.hierarchyUniqueName).toLowerCase()==e.trim(d.hierarchyUniqueName).toLowerCase()?l:void 0}),"collapse"!=l.action&&(r.model.dataSource.columns[currReport[0]].drillCellInfo=d),b=d.hierarchyUniqueName));f+=c.uniqueName,c.previousElements=g.replace(/&amp;/g,"&"),c.preRepItm=f.replace(/&amp;/g,"&"),c.axis=_}if(c.previousElements=c.previousElements.replace(/&amp;/g,"&"),c.preRepItm=c.preRepItm.replace(/&amp;/g,"&"),l.action)if(l.action){if(r._isMondrian)return c.action="collapse",void t.olap._mdxParser._updateReport(m.drilledItems,c,m,r);if(t.isNullOrUndefined(c)||t.isNullOrUndefined(c.previousElements)||""==c.previousElements||(t.olap.base.olapCtrlObj._prevDrillElements=c.previousElements.split("][").join("]>#>[").split(">#>")),(h=t.olap.base._getDrilledMemeber({item:c})).length&&!t.olap.base._isPaging)t.olap.base._onDemandCollapse({drilledMembers:h,action:l.action},_);else{for(;0!=h.length;)t.olap.base.olapCtrlObj.model.dataSource=t.olap._mdxParser._clearCollapsedItems(_,h[h.length-1],t.olap.base.olapCtrlObj.model.dataSource),h=h.splice(0,h.length-1);t.olap.base.getJSONData(l,t.olap.base.olapCtrlObj.model.dataSource,t.olap.base.olapCtrlObj)}}else e(l.drilledMember).clone(!0),t.olap.base._onDemandExpand({action:"drilldown",cellInfo:c,isExist:!0},l.drilledMember);else h=t.olap.base._getDrilledMemeber({item:c}),t.olap._mdxParser._updateReport(m.drilledItems,c,m,r)}},_clearCollapsedItems:function(t,l,a){return"rowheader"==t?a.rows=e.map(a.rows,function(t){return t.drilledItems!=i&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(l.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t}):"colheader"==t&&(a.columns=e.map(a.columns,function(t){return t.drilledItems!=i&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(l.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t})),a},_getSlicerMDX:function(t,l){for(var a=e(t)[0].filters,r="",o=this,s=l._fieldData,n=e.merge(e.merge([],t.columns),t.rows),d=0;d<a.length;d++)e.grep(n,function(e){var t=o._getDimensionUniqueName(e.fieldName,s),i=o._getDimensionUniqueName(a[d].fieldName,s);return t==i&&!(l._isMondrian&&""==i&&""==t)}).length>0||(a[d].fieldName!=i&&a[d].filterItems==i?r=r+(""!=r?"*":"")+"{"+this._getDimensionQuery(a[d])+"}":a[d].filterItems!=i&&(r=r+(""!=r?"*":"")+"{"+a[d].filterItems.values.toString()+"}"));return""!=r?"where ("+r.replace(/DrillDownlevel/g,"")+")":""},_getDimensionUniqueName:function(t,i){var l,a=i.hierarchy;return a?(l=e.map(a,function(e){if(e.id.toLowerCase()==t.toLowerCase())return e.pid})).length>0?l[0]:"":t.split(".")[0]},_getMeasuresQuery:function(t){var l,a,r,o=e(t)[0].values,s=[];return o.length>0&&(null!=(r=(a=jQuery.map(o,function(e,t){if(e.measures!=i)return{measureElements:e.measures,Index:t,axisName:e.axis}})).length>0?e.map(a[0].measureElements,function(e){return e.fieldName}):null)&&s.push({values:r,Index:a[0].Index}),o.axis),""!=(l=e.map(s,function(e){return e.values.toString()}))[0]?"{"+l+"}":""},_getIncludefilterQuery:function(t,l,a){var r,o,s,n="FROM ["+l+"]",d="FROM ( SELECT (",h=a._fieldData,c=[],p="COLUMNS";if(a._isMondrian)return n;for(r=e.map(e(t.rows),function(e){if(e.filterItems!=i)return[e.filterItems.values]}),o=e.map(e(t.columns),function(e){if(e.filterItems!=i)return[e.filterItems.values]}),s=0;s<t.filters.length;s++){var u=t.filters,m=this,g=!1;e.map(t.columns,function(e){m._getDimensionUniqueName(e.fieldName,h)==m._getDimensionUniqueName(u[s].fieldName,h)&&u[s].filterItems!=i&&(o.push(u[s].filterItems.values),g=!0)}),g||e.map(t.rows,function(e){m._getDimensionUniqueName(e.fieldName,h)==m._getDimensionUniqueName(u[s].fieldName,h)&&u[s].filterItems!=i&&r.push(u[s].filterItems.values)})}if(t.enableAdvancedFilter){for(s=0;s<=t.columns.length-1;s++)t.columns[s].advancedFilter&&e.merge(c,this._getAdvancedFilterQuery(t.columns[s],d,p));for(s=0;s<=t.rows.length-1;s++)t.rows[s].advancedFilter&&e.merge(c,this._getAdvancedFilterQuery(t.rows[s],d,p))}for(s=0;s<=o.length-1;s++)d=0==s?d+"{"+o[s].toString()+"}":d+",{"+o[s].toString()+"}";for(o.length>0&&(d=r.length>0?d+" ) on COLUMNS ,(":d+" ) on COLUMNS "),s=0;s<=r.length-1;s++)d=s>0?d+",{"+r[s].toString()+"}":d+"{"+r[s].toString()+"}";return d=o.length>0&&r.length>0?d+=") on ROWS ":0==o.length&&r.length>0?d+") on COLUMNS ":d,c.length>0&&(c=(o.length>0||r.length>0?d:"")+" "+c.join(" ")+" "+n+Array(c.length+1+o.length+r.length).join(")")),n=0==o.length&&0==r.length?n:d+n+")",c.length>0?c:n},_getAdvancedFilterQuery:function(i,l,a){var r=[],o=this;return e.map(i.advancedFilter,function(l){t.isNullOrUndefined(l.labelFilterOperator)&&l.labelFilterOperator==t.olap.LabelFilterOptions.None&&t.isNullOrUndefined(l.valueFilterOperator)&&l.valueFilterOperator==t.olap.ValueFilterOptions.None||r.push("FROM (SELECT Filter("+e.trim(l.name)+".AllMembers, "+o._getAdvancedFilterCondtions(i.fieldName,l.advancedFilterType==t.olap.AdvancedFilterType.LabelFilter||t.isNullOrUndefined(l.advancedFilterType)?l.labelFilterOperator:l.valueFilterOperator,l.values,l.advancedFilterType,l.measure)+")) on "+a)}),r},_getAdvancedFilterCondtions:function(e,i,l,a,r){var o="";a=t.isNullOrUndefined(a)?"label":a;switch(i.toLowerCase()){case"equals":o="("+("value"!=a?e+'.CurrentMember.member_caption ="'+l[0]+'"':r+" = "+l[0]);break;case"notequals":o="("+("value"!=a?e+'.CurrentMember.member_caption &lt;&gt;"'+l[0]+'"':r+" &lt;&gt;"+l[0]);break;case"contains":o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+l[0]+'")&gt;0';break;case"notcontains":o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+l[0]+'")=0';break;case"beginswith":o="( Left ("+e+".CurrentMember.member_caption,"+l[0].length+')="'+l[0]+'"';break;case"notbeginswith":o="( Left ("+e+".CurrentMember.member_caption,"+l[0].length+')&lt;&gt;"'+l[0]+'"';break;case"endswith":o="( Right ("+e+".CurrentMember.member_caption,"+l[0].length+')="'+l[0]+'"';break;case"notendswith":o="( Right ("+e+".CurrentMember.member_caption,"+l[0].length+')&lt;&gt;"'+l[0]+'"';break;case"greaterthan":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;"'+l[0]+'"':r+" &gt;"+l[0]);break;case"greaterthanorequalto":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;="'+l[0]+'"':r+" &gt;="+l[0]);break;case"lessthan":o="("+("value"!=a?e+'.CurrentMember.member_caption &lt;"'+l[0]+'"':r+" &lt;"+l[0]);break;case"lessthanorequalto":o="("+("value"!=a?e+'.CurrentMember.member_caption &lt;="'+l[0]+'"':r+" &lt;="+l[0]);break;case"between":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;="'+l[0]+'"AND '+e+'.CurrentMember.member_caption &lt;="'+l[1]+'"':r+" &gt;="+l[0]+" AND "+r+"&lt;="+l[1]);break;case"notbetween":o="("+("value"!=a?e+'.CurrentMember.member_caption &gt;="'+l[0]+'"OR '+e+'.CurrentMember.member_caption &lt;="'+l[1]+'"':r+" &gt;="+l[0]+" OR "+r+"&lt;="+l[1]);break;default:o="( InStr (1,"+e+'.CurrentMember.member_caption,"'+l[0]+'")&gt;0'}return o},_getItemPosition:function(t,l){return e.map(t,function(t,a){if(t.fieldName!=i&&e.trim(t.fieldName)==e.trim(l))return a})},getAllMember:function(i,l,a){if(!t.isNullOrUndefined(a)){var r="select {"+l+"} dimension properties CHILDREN_CARDINALITY on 0 from ["+e.trim(i.cube)+"]",o=t.olap._mdxParser.getSoapMsg(r,i.data,i.catalog),s=t.olap.base._getConnectionInfo(i.data);a.doAjaxPost("POST",s.url,{XMLA:o},a._generateAllMember,null,{action:"loadFieldElements"})}},getMembers:function(i,l,a){var r=t.Pivot.getReportItemByFieldName(l,i).item;t.olap.base.olapCtrlObj._isMondrian&&(t.isNullOrUndefined(a.model.pivotControl)||(this._controlObj=a.model.pivotControl));var o="select {"+(r&&r.hasAllMember?l+".levels(0).AllMembers":l+".children")+"}dimension properties CHILDREN_CARDINALITY, MEMBER_TYPE on 0 from ["+e.trim(i.cube)+"]",s=t.olap._mdxParser.getSoapMsg(o,i.data,i.catalog),n=t.olap.base._getConnectionInfo(i.data);a.doAjaxPost("POST",n.url,{XMLA:s},a._generateMembers,null,{action:"fetchMembers"})},getChildren:function(e,i,l){var a,r,o="select {"+i+".children} dimension properties CHILDREN_CARDINALITY on 0 from ["+e.cube+"]",s=l.model.pivotControl;!t.isNullOrUndefined(s)&&t.olap.base.olapCtrlObj._isMondrian&&(this._controlObj=l.model.pivotControl),a=t.olap._mdxParser.getSoapMsg(o,e.data,e.catalog),r=t.olap.base._getConnectionInfo(e.data),l.doAjaxPost("POST",r.url,{XMLA:a},t.Pivot.generateChildMembers,null,{action:"nodeExpand",currentNode:i})},getSoapMsg:function(e,i,l){var a,r=t.olap.base._getConnectionInfo(i);return!t.isNullOrUndefined(this._controlObj)||!t.isNullOrUndefined(t.olap.base.olapCtrlObj)&&t.olap.base.olapCtrlObj._isMondrian?(a='<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+e+"]]></Statement></Command><Properties><PropertyList><DataSourceInfo>"+(t.isNullOrUndefined(this._controlObj)?t.olap.base.olapCtrlObj.model.dataSource.sourceInfo:this._controlObj.model.dataSource.sourceInfo)+"</DataSourceInfo><Catalog>"+l+"</Catalog><AxisFormat>TupleFormat</AxisFormat><Content>Data</Content><Format>Multidimensional</Format></PropertyList></Properties></Execute></SOAP-ENV:Body></SOAP-ENV:Envelope>",delete this._controlObj):a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header></Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+e+" </Statement> </Command> <Properties> <PropertyList> <Catalog>"+l+"</Catalog> <LocaleIdentifier>"+r.LCID+"</LocaleIdentifier></PropertyList> </Properties> </Execute> </Body> </Envelope>",a}},t.olap.SortOrder={None:"none",Ascending:"ascending",Descending:"descending"},t.olap.Providers={SSAS:"ssas",Mondrian:"mondrian"},t.olap.AdvancedFilterType={LabelFilter:"label",ValueFilter:"value"},t.olap.ValueFilterOptions={None:"none",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.olap.LabelFilterOptions={None:"none",BeginsWith:"beginswith",NotBeginsWith:"notbeginswith",EndsWith:"endswith",NotEndsWith:"notendswith",Contains:"contains",NotContains:"notcontains",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.olap.AxisName={Row:"rows",Column:"columns"}}(jQuery,Syncfusion)})},1010:function(e,t,l){var a,r,o;
/*!
*  filename: ej.pivot.common.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivot.common.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(i){r=[l(4)],void 0===(o="function"==typeof(a=i)?a.apply(t,r):a)||(e.exports=o)}(function(){ej.Pivot=ej.Pivot||{},function(e,t,l){t.Pivot={addReportItem:function(e,i){var l,a;if(i.isMeasuresDropped)""!=i.droppedClass?e.values[0].axis="row"==i.droppedClass?"rows":"column"==i.droppedClass?"columns":e.values[0].axis:e.values[0].measures=[];else{for(a in l=this.removeReportItem(e,i.droppedFieldName,i.isMeasuresDropped),t.isNullOrUndefined(l)&&(l={fieldName:i.droppedFieldName,fieldCaption:i.droppedFieldCaption,format:i.droppedFieldFormat,formatString:i.droppedFieldFormatString,showSubTotal:i.droppedFieldShowSubTotal,expression:i.droppedExpression,hierarchyUniqueName:i.droppedHierarchyUniqueName,summaryType:i.summaryType}),l)("format"==a||"formatString"==a)&&(t.isNullOrUndefined(l[a])||""==l[a])&&delete l[a];switch(i.droppedClass){case"row":""!=i.droppedPosition.toString()?e.rows.splice(i.droppedPosition,0,l):e.rows.push(l);break;case"column":""!=i.droppedPosition.toString()?e.columns.splice(i.droppedPosition,0,l):e.columns.push(l);break;case"value":""==e.cube?""!=i.droppedPosition.toString()?e.values.splice(i.droppedPosition,0,l):e.values.push(l):""!=i.droppedPosition.toString()?e.values[0].measures.splice(i.droppedPosition,0,l):e.values[0].measures.push(l);break;case"filter":""!=i.droppedPosition.toString()?e.filters.splice(i.droppedPosition,0,l):e.filters.push(l)}}},removeReportItem:function(i,l,a){var r,o=""==i.cube?t.Pivot.AnalysisMode.Pivot:t.Pivot.AnalysisMode.Olap,s=e.grep(i.columns,function(e){return e.fieldName==l});return a?i.values[0].measures=[]:s.length>0?i.columns=e.grep(i.columns,function(e){return e.fieldName!=l}):(s=e.grep(i.rows,function(e){return e.fieldName==l})).length>0?i.rows=e.grep(i.rows,function(e){return e.fieldName!=l}):(r=o==t.Pivot.AnalysisMode.Olap?i.values[0].measures:i.values,(s=e.grep(r,function(e){return e.fieldName==l})).length>0?i.values=o==t.Pivot.AnalysisMode.Olap?[{measures:e.grep(r,function(e){return e.fieldName!=l}),axis:i.values[0].axis}]:e.grep(r,function(e){return e.fieldName!=l}):(s=e.grep(i.filters,function(e){return e.fieldName==l})).length>0&&(i.filters=e.grep(i.filters,function(e){return e.fieldName!=l}))),s[0]},getReportItemByFieldName:function(i,l){var a,r="columns",o=e.grep(l.columns,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()});return 0==o.length&&(o=e.grep(l.rows,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="rows"),0==o.length&&(a=""==l.cube?l.values:l.values.length>0&&!t.isNullOrUndefined(l.values[0].measures)?l.values[0].measures:[],o=e.grep(a,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="values"),0==o.length&&(o=e.grep(l.filters,function(e){return e.fieldName.toLowerCase()==i.toLowerCase()}),r="filters"),{item:o[0],axis:r}},getReportItemByFieldCaption:function(i,l){var a,r="columns",o=e.grep(l.columns,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()});return 0==o.length&&(o=e.grep(l.rows,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="rows"),0==o.length&&(a=""==l.cube?l.values:l.values.length>0&&!t.isNullOrUndefined(l.values[0].measures)?l.values[0].measures:[],o=e.grep(a,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="values"),0==o.length&&(o=e.grep(l.filters,function(e){return e.fieldCaption.toLowerCase()==i.toLowerCase()}),r="filters"),{item:o[0],axis:r}},closePreventPanel:function(i){var l="close"!=i.type?i:this;l.element.find("[id^='preventDiv']").remove(),t.isNullOrUndefined(l.model.pivotControl)?l._currentReportItems=e.extend(!0,[],l._savedReportItems):(l.model.pivotControl.element.find("[id^='preventDiv']").remove(),l.model.pivotControl._currentReportItems=e.extend(!0,[],l.model.pivotControl._savedReportItems)),t.isNullOrUndefined(l._waitingPopup)||l._waitingPopup.hide(),t.isNullOrUndefined(l.model.pivotControl)||t.isNullOrUndefined(l.model.pivotControl._waitingPopup)||l.model.pivotControl._waitingPopup.hide()},openPreventPanel:function(i){var l=t.buildTag("div#preventDiv.errorDlg").css({width:e("body").width()+"px",height:e("body").height()+"px",position:"absolute",top:e("body").offset().top+"px",left:e("body").offset().left+"px","z-index":10})[0].outerHTML;e("#"+i._id).append(l)},_createErrorDialog:function(i,l,a){var r,o;if(t.Pivot.closePreventPanel(a),a._errorDialog=l,t.Pivot.openPreventPanel(a),0==a.element.find(".e-errorDialog:visible").length&&(r=t.isNullOrUndefined(i.Exception)?t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent action:",i)[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn",a._getLocalizedLabels("OK"),{margin:"20px 0 10px 165px"}).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML)[0].outerHTML).attr("title",l)[0].outerHTML:t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent action:",i.Exception.Message)[0].outerHTML+t.buildTag("br")[0].outerHTML+t.buildTag("div."+a._id+"stackTraceContent","Stack Trace :"+i.Exception.StackTraceString)[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn",a._getLocalizedLabels("OK"),{margin:"20px 0 10px 165px"}).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML)[0].outerHTML).attr("title",l)[0].outerHTML,a.element.append(r),a.element.find(".e-errorDialog").ejDialog({target:"#"+a._id,enableResize:!1,enableRTL:a.model.enableRTL,width:"400px",close:t.proxy(t.Pivot.closePreventPanel,a)}),o=a.element.find(".e-errorDialog").data("ejDialog"),e("#"+o._id+"_wrapper").css({left:"50%",top:"50%"}),a.element.find(".errOKBtn").ejButton({type:t.ButtonType.Button,width:"50px"}).on(t.eventType.click,function(){"nodeCheck"!=a._errorDialog||t.isNullOrUndefined(a._schemaData)||t.isNullOrUndefined(a._schemaData._selectedTreeNode)||a._schemaData._tableTreeObj.uncheckNode(a._schemaData._selectedTreeNode),a.element.find("#preventDiv").remove(),(a._errorDialog==a._getLocalizedLabels("Success")||a._errorDialog==a._getLocalizedLabels("Warning")||a._errorDialog==a._getLocalizedLabels("Exception")||a._errorDialog==a._getLocalizedLabels("Error"))&&a.element.children("#ErrorDialog_wrapper").remove()}),a.element.find(".e-dialog .e-close").attr("title","Close"),t.isNullOrUndefined(e("#"+a._id).data("ejWaitingPopup"))||e("#"+a._id).data("ejWaitingPopup").hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide(),!t.isNullOrUndefined(i.Exception))){var s="Show more";e("."+a._id+"stackTraceContent").each(function(){var i=e(this).html();if(i.length>50){a._id;var l=i.substr(0,50),r=i.substr(50,i.length-50),o=l+t.buildTag("span."+a._id+"moreellipses","...")[0].outerHTML+t.buildTag("span."+a._id+"morecontent",t.buildTag("span",r).css("display","none")[0].outerHTML+t.buildTag("a."+a._id+"morelink",s).css("display","block")[0].outerHTML)[0].outerHTML;e(this).html(o)}}),e("."+a._id+"morelink").click(function(){return e(this).hasClass("less")?(e(this).removeClass("less"),e(this).html(s)):(e(this).addClass("less"),e(this).html("Show less")),e(this).parent().prev().toggle("slow",function(){}),e(this).prev().toggle("slow",function(){}),!1})}},_updateValueSortingIndex:function(i,a){if(i.SortColIndex!=l)t.PivotAnalysis._valueSorting=JSON.parse(i.SortColIndex)[0],t.PivotAnalysis._sort=a.model.valueSortSettings.sortOrder;else{i=i[0]!=l?i:i.d!=l?i.d:i;var r=e.map(i,function(e){if(null!=e)var t=e.Key;if(null!=t&&t!=l&&"SortColIndex"==t)return e});r.length>0?(i.splice(e.map(i,function(e,t){if("SortColIndex"==e.Key)return t}),1),t.PivotAnalysis._valueSorting=JSON.parse(r[0].Value),t.PivotAnalysis._sort=a.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null}},_memberSortBtnClick:function(i){var a,r,o,s,n,d,h,c=this.element.hasClass("e-pivotclient")&&"servermode"==this.model.operationalMode&&"olap"==this.model.analysisMode,p="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this,u="ejPivotGrid"==this.pluginName&&p.model.analysisMode==t.Pivot.AnalysisMode.Olap&&p.model.operationalMode==t.Pivot.OperationalMode.ServerMode,m=e(i.target).parents(".e-memberEditorDiv").find(".e-editorTreeView"),g=this._sortType=e(i.target).hasClass("e-memberAscendingIcon")?"ascending":"descending",f=[],b=jQuery.extend(!0,[],this._memberTreeObj._dataSource);if(this.element.find(".e-memberDrillPager").is(":visible")&&(a=this.model.memberEditorPageSize==l?this.model.pivotControl.model.memberEditorPageSize:this.model.memberEditorPageSize,f=t.Pivot._getParentsTreeList(this,this._drilledNode,this._editorTreeData).concat(t.DataManager(this._editorDrillTreeData[this._drilledNode]).executeLocal(t.Query().sortBy("name",this._sortType).page(this._memberDrillPageSettings.currentMemberDrillPage,a)))),!t.isNullOrUndefined(m)&&m.length>0){if(t.Pivot.updateTreeView(this),r=(this.model.enableMemberEditorPaging||!t.isNullOrUndefined(this.model.pivotControl)&&this.model.pivotControl.model.enableMemberEditorPaging)&&!this._isSearchApplied?this._editorTreeData:m.data("ejTreeView").model.fields.dataSource,o=c||"All"!=r[0].id&&"(All)_0"!=r[0].id?r:r.slice(1),f.length>0&&(o=f),o.length>1&&"SearchFilterSelection"==o[0].id&&(o=o.slice(1)),s=c?[]:r.length>1&&("All"==r[0].id||"(All)_0"==r[0].id)?r.splice(0,1):[],n=t.DataManager(o).executeLocal(t.Query().sortBy("name",g)),!t.isNullOrUndefined(s)&&s.length>0&&(n.splice(0,0,s[0]),r.splice(0,0,s[0])),(this.model.enableMemberEditorPaging||!t.isNullOrUndefined(this.model.pivotControl)&&this.model.pivotControl.model.enableMemberEditorPaging)&&0==f.length&&(n=t.DataManager(n).executeLocal(t.Query().page(this._memberPageSettings.currentMemeberPage,(this.model.memberEditorPageSize||this.model.pivotControl.model.memberEditorPageSize)+(1==this._memberPageSettings.currentMemeberPage?1:0)))),p.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&n.length>0&&"All"!=n[0].id&&"(All)_0"!=n[0].id&&!t.isNullOrUndefined(s)&&s.length>0&&n.splice(0,0,s[0]),s={},m.data("ejTreeView").model.fields.dataSource.length>1&&"SearchFilterSelection"==m.data("ejTreeView").model.fields.dataSource[1].id&&"SearchFilterSelection"!=n[1].id&&n.splice(1,0,{id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:this._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),c&&this._isSearchApplied&&n.splice(0,0,{id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:this._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),t.isNullOrUndefined(m)||m.ejTreeView({fields:{dataSource:jQuery.extend(!0,[],n)}}),f.length>0&&!t.isNullOrUndefined(b)&&(this._memberTreeObj._dataSource=b),u)for(d=this.element.find(".e-editorTreeView").find("li"),h=0;h<d.length;h++)t.isNullOrUndefined(e(d[h]).attr("id"))||e(d[h]).attr("data-tag",t.DataManager(m.data("ejTreeView").model.fields.dataSource).executeLocal(t.Query().where("id","equal",e(d[h]).attr("id")))[0].tag);t.Pivot._separateAllMember(this)}},_contextMenuOpen:function(i,l){var a,r,o,s;if(t.Pivot.openPreventPanel(l),l._selectedMember=e(i.target),"ejPivotGrid"==l.pluginName?(a=l.model.analysisMode==t.Pivot.AnalysisMode.Olap?"olap":"pivot",o=e("#pivotTree").data("ejMenu")):(t.isNullOrUndefined(l.model.pivotControl)||(a=l.model.pivotControl.model.analysisMode==t.Pivot.AnalysisMode.Olap?"olap":"pivot"),o=e("#"+l._id+"_pivotTreeContextMenu").data("ejMenu")),a==t.Pivot.AnalysisMode.Olap){if(t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))&&e(i.target).hasClass("e-pivotButton")&&e(i.target).children(".e-pvtBtn:eq(0)").length>0)return o.disable(),l._selectedMember=e(i.target).children(".e-pvtBtn:eq(0)"),!1;!t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))&&e(i.target).parent().attr("data-tag").split(":")[1].toLowerCase().startsWith("[measures]")?o.disable():t.isNullOrUndefined(l._selectedMember.parent().attr("data-tag"))||"measures"!=l._selectedMember.parent().attr("data-tag").split(":")[1].toLowerCase()?t.isNullOrUndefined(e(i.target).parent().attr("data-tag"))?o.disable():(o.disableItem(l._getLocalizedLabels("AddToValues")),e(i.target.parentElement).find(".e-namedSetCDB").length>0?o.disableItem(l._getLocalizedLabels("AddToFilter")):o.enableItem(l._getLocalizedLabels("AddToFilter")),o.enableItem(l._getLocalizedLabels("AddToRow")),o.enableItem(l._getLocalizedLabels("AddToColumn"))):(o.disableItem(l._getLocalizedLabels("AddToValues")),o.disableItem(l._getLocalizedLabels("AddToFilter")),o.enableItem(l._getLocalizedLabels("AddToRow")),o.enableItem(l._getLocalizedLabels("AddToColumn")))}else a==t.Pivot.AnalysisMode.Pivot&&(r=i.target.textContent,e(i.target).hasClass("e-btn")?(o.enable(),"ejPivotGrid"==l.pluginName&&(o.disableItem(l._getLocalizedLabels("CalculatedField")),"values"==e(i.target).parents(".e-pivotButton").attr("data-tag").split(":")[0].toLowerCase()&&(l.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&e.grep(l.model.dataSource.values,function(e){return e.fieldCaption==r&&1==e.isCalculatedField}).length>0?o.disable():l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&e.grep(JSON.parse(l.getOlapReport()).PivotCalculations,function(e){return e.FieldHeader==r&&8==e.CalculationType}).length>0&&o.disable(),o.enableItem(l._getLocalizedLabels("CalculatedField"))))):e("#pivotTree").length>0?(o=e("#pivotTree").data("ejMenu")).disable():o.disable());s=l.model.pivotControl,t.isNullOrUndefined(s)||s.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||0==e(i.target).parents(".e-schemaValue").length&&o.disableItem(l._getLocalizedLabels("SummarizeValueBy"))},_searchTreeNodes:function(i){var l,a,r,o,s,n,d=e(i.target).hasClass("searchTreeView")?this.element.find(".searchTreeView").data("ejMaskEdit"):this.element.find(".searchEditorTreeView").data("ejMaskEdit"),h=e(i.target).hasClass("searchTreeView")?this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-schemaFieldTree").data("ejTreeView"):this.element.find(".e-cubeTreeView").data("ejTreeView"):this.element.find(".e-editorTreeView").data("ejTreeView"),c={id:"SearchFilterSelection",name:this._getLocalizedLabels("AddCurrentSelectionToFilter"),hasChildren:!1,checkedStatus:!0,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"},p=h.element,u=p.find("li[data-isItemSearch='true']"),m=t.isNullOrUndefined(d.get_StrippedValue())?"":d.get_StrippedValue().toLowerCase();if(u.length>0&&e(u).each(function(e,t){t.removeAttribute("data-isItemSearch")}),m.length>0){var g=[],f=[],b=p.find("ul>li>div>a");for(l=0;l<b.length;l++)-1!=e(b[l]).text().toLowerCase().indexOf(m)||"(All)_0"==e(e(b[l]).closest("li")).attr("id")||"All"==e(e(b[l]).closest("li")).attr("id")||"SearchFilterSelection"==e(e(b[l]).closest("li")).attr("id")?g.push(b[l]):f.push(b[l]);for((a=p.find(g).closest("li").css("display","block")).length>0&&(this._isOptionSearch=!0,e(a).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&i.setAttribute("data-isItemSearch",!0)}),p.hasClass("e-editorTreeView")&&(!p.find("li span.e-searchfilterselection").length>0?("(All)_0"==p.find("li:first").attr("id")||"All"==p.find("li:first").attr("id")?(a.length>1&&h.insertAfter(c,p.find("li:first")),(this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl.model.analysisMode:this.model.analysisMode)==t.Pivot.AnalysisMode.Pivot&&p.find("li span.e-searchfilterselection").closest("li").css("padding","0")):h.insertBefore(c,p.find("li:first")),p.find("li span.e-searchfilterselection").closest("li").attr("data-tag",c.tag)):p.find("li span.e-searchfilterselection").length>0&&!this._isSelectSearchFilter&&h.uncheckNode(p.find("li span.e-searchfilterselection").closest("li")))),p.find(f).closest("li").css("display","none"),n=0;n<a.length;n++)(o=(r=e(a[n])).parents("ul").closest("li").css("display","block")).length>0&&(h.expandNode(o),-1!=h.model.expandedNodes.indexOf(e(h._liList).index(o))||t.isNullOrUndefined(window._temp)||window._temp.push(o)),(s=r.children("ul")).length>0&&0==s.children("li:visible").length&&(r.children("ul").children("li").css("display","block"),h.expandNode(a[n]),-1!=h.model.expandedNodes.indexOf(e(h._liList).index(a[n]))||t.isNullOrUndefined(window._temp)||window._temp.push(a[n]))}else{p.find("ul>li").css("display","block"),p.find("li span.e-searchfilterselection").closest("li").length>0&&h.removeNode(p.find("#SearchFilterSelection")),e(p.find("ul>li")).each(function(e,t){t.removeAttribute("data-isItemSearch")}),this._isOptionSearch=!1;var _=e(p).find("ul>li"),v=0,C=0;if("(All)_0"==e(e(_)[0]).attr("id")||"All"==e(e(_)[0]).attr("id")){for(n=1;n<e(_).length;n++)e(e(_)[n]).find("span.e-checkmark").length>0?v++:C++;v>0&&C>0?e(p.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-checkmark").addClass("e-stop"):v>0&&0==C?e(p.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-stop").addClass("e-checkmark"):e(p.find("ul>li")[0]).find("div .e-chkbox-small > span > span:eq(0)").removeClass("e-checkmark").removeClass("e-stop")}if(!t.isNullOrUndefined(window._temp))for(n=0;n<window._temp.length;n++)h._collpaseNode(window._temp[n]);window._temp=[],e(i.target).hasClass("searchTreeView")&&h.collapseAll()}},_updateSearchFilterSelection:function(i,l,a){var r,o,s={},n={};"SearchFilterSelection"==i.id&&(r=e(l).find("li:not([data-isItemSearch='true'])"),"nodeCheck"==i.type?(a._isSelectSearchFilter=!0,a._isOptionSearch?r.length>0&&e(r).each(function(i,r){"SearchFilterSelection"!=e(r).attr("id")&&!t.isNullOrUndefined(a._currentFilterList[e(r).attr("id")])&&a._currentFilterList[e(r).attr("id")].checkedStatus&&e(l).ejTreeView("checkNode",e(r))}):r.length>0&&(a.model.enableMemberEditorPaging&&(s=a._currentFilterList,e(s).each(function(e,t){n[t.id]=t})),e(a._editorTreeData).each(function(i,l){for(var o=0;o<r.length;o++){if(r[o].id==l.id){l.checkedStatus=e(r[o]).find(".checked").length>0;break}t.isNullOrUndefined(a._currentFilterList)||(l.checkedStatus=a.model.enableMemberEditorPaging&&!t.isNullOrUndefined(n)?n[e(l).attr("id")].checkedStatus:a._currentFilterList[e(l).attr("id")].checkedStatus)}}),o=!0,e(a._editorTreeData).each(function(e,t){if(t.checkedStatus)return o=!1,!1}),o&&a._editorTreeData.length>0?(a._dialogOKBtnObj.disable(),a.element.find(".e-dialogOKBtn").attr("disabled","disabled")):(a._dialogOKBtnObj.enable(),a.element.find(".e-dialogOKBtn").removeAttr("disabled")))):"nodeUncheck"==i.type&&(a._isSelectSearchFilter=!1,a._isOptionSearch?r.length>0&&e(r).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&e(l).ejTreeView("uncheckNode",e(i))}):r.length>0&&(e(a._editorTreeData).each(function(t,i){for(var l=0;l<r.length;l++){if(r[l].id==i.id){i.checkedStatus=e(r[l]).find(".checked").length>0;break}i.checkedStatus=!1}}),o=!0,e(a._editorTreeData).each(function(e,t){if(t.checkedStatus)return o=!1,!1}),o&&a._editorTreeData.length>0?(a._dialogOKBtnObj.disable(),a.element.find(".e-dialogOKBtn").attr("disabled","disabled")):(a._dialogOKBtnObj.enable(),a.element.find(".e-dialogOKBtn").removeAttr("disabled")))))},editorTreeNavigatee:function(i,l){var a,r;if(e(i.target).parents(".e-memberPager").length>0){if(r=l._memberPageSettings.currentMemeberPage,!e(i.target).hasClass("e-pageDisabled")){if(e(i.target).hasClass("e-nextPage"))l._memberPageSettings.startPage+=l.model.memberEditorPageSize,l._memberPageSettings.currentMemeberPage+=1,l._memberPageSettings.endPage+=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))l._memberPageSettings.currentMemeberPage-=1,l._memberPageSettings.startPage=Math.abs(l._memberPageSettings.startPage-(l._memberPageSettings.currentMemeberPage,l.model.memberEditorPageSize)),l._memberPageSettings.endPage-=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))l._memberPageSettings.currentMemeberPage=1,l._memberPageSettings.endPage=l.model.memberEditorPageSize,l._memberPageSettings.startPage=0;else if(e(i.target).hasClass("e-lastPage"))l._memberPageSettings.currentMemeberPage=parseInt(e.trim(l.element.find(".e-memberPageCount").text().split("/")[1])),l._memberPageSettings.endPage=l._memberPageSettings.currentMemeberPage*l.model.memberEditorPageSize,l._memberPageSettings.startPage=l._memberPageSettings.endPage-l.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(l.element.find(".e-memberPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return l.element.find(".e-memberCurrentPage").val(r),!1;l._memberPageSettings.currentMemeberPage=parseInt(e(i.target).val()),l._memberPageSettings.endPage=l._memberPageSettings.currentMemeberPage*l.model.memberEditorPageSize,l._memberPageSettings.startPage=1==l._memberPageSettings.currentMemeberPage||0==l._memberPageSettings.currentMemeberPage?0:l._memberPageSettings.endPage-l.model.memberEditorPageSize}l._waitingPopup.show(),l.element.hasClass("e-pivotclient")&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(l.model.enableMemberEditorSorting&&(l._editorTreeData=t.DataManager(l._editorTreeData).executeLocal(t.Query().sortBy("name",l._sortType))),this.editorTreePageInfoSuccess(l._editorTreeData,l)):("ejPivotSchemaDesigner"!=l.pluginName?l._isMemberPageFilter=!0:l.model.pivotControl._isMemberPageFilter=!0,t.Pivot.updateTreeView(l),a=t.DataManager(l._editorTreeData).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(l._sortType)?"":l._sortType).where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0")).page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize)),l._memberPageSettings.currentMemeberPage>1?l.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberPageSettings.currentMemeberPage==parseInt(e.trim(l.element.find(".e-memberPageCount").text().split("/")[1]))?l.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),l.element.find(".e-memberCurrentPage").val(l._memberPageSettings.currentMemeberPage),l.element.find(".e-nextPageDiv .e-pageDisabled").css("opacity","0.5"),l.element.find(".e-nextPageDiv .e-pageEnabled").css("opacity","1"),t.Pivot._createSearchTreeview(a,l),l._waitingPopup.hide())}}else if(e(i.target).parents(".e-memberSearchPager").length>0){if(r=l._memberSearchPageSettings.currentMemberSearchPage,!e(i.target).hasClass("e-pageDisabled")){if(e(i.target).hasClass("e-nextPage"))l._memberSearchPageSettings.startSearchPage+=l.model.memberEditorPageSize,l._memberSearchPageSettings.currentMemberSearchPage+=1,l._memberSearchPageSettings.endSearchPage+=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))l._memberSearchPageSettings.currentMemberSearchPage-=1,l._memberSearchPageSettings.startSearchPage=Math.abs(l._memberSearchPageSettings.startSearchPage-(l._memberSearchPageSettings.currentMemberSearchPage,l.model.memberEditorPageSize)),l._memberSearchPageSettings.endSearchPage-=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))l._memberSearchPageSettings.currentMemberSearchPage=1,l._memberSearchPageSettings.endSearchPage=l.model.memberEditorPageSize,l._memberSearchPageSettings.startSearchPage=0;else if(e(i.target).hasClass("e-lastPage"))l._memberSearchPageSettings.currentMemberSearchPage=parseInt(e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1])),l._memberSearchPageSettings.endSearchPage=l._memberSearchPageSettings.currentMemberSearchPage*l.model.memberEditorPageSize,l._memberSearchPageSettings.startSearchPage=l._memberSearchPageSettings.endSearchPage-l.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return l.element.find(".e-memberCurrentSearchPage").val(r),!1;l._memberSearchPageSettings.currentMemberSearchPage=parseInt(e(i.target).val()),l._memberSearchPageSettings.endSearchPage=l._memberSearchPageSettings.currentMemberSearchPage*l.model.memberEditorPageSize,l._memberSearchPageSettings.startSearchPage=1==l._memberSearchPageSettings.currentMemberSearchPage||0==l._memberSearchPageSettings.currentMemberSearchPage?0:l._memberSearchPageSettings.endSearchPage-l.model.memberEditorPageSize}l._waitingPopup.show(),l.element.hasClass("e-pivotclient")&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._editorTreeSearchPageInfoSuccess(l._editorSearchTreeData,l):("ejPivotSchemaDesigner"!=l.pluginName?l._isMemberPageFilter=!0:l.model.pivotControl._isMemberPageFilter=!0,this._editorTreeSearchPageInfoSuccess(l._editorSearchTreeData,l))}}else if(e(i.target).parents(".e-memberDrillPager").length>0&&(r=l._memberDrillPageSettings.currentMemberDrillPage,!e(i.target).hasClass("e-pageDisabled"))){if(e(i.target).hasClass("e-nextPage"))l._memberDrillPageSettings.startDrillPage+=l.model.memberEditorPageSize,l._memberDrillPageSettings.currentMemberDrillPage+=1,l._memberDrillPageSettings.endDrillPage+=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-prevPage"))l._memberDrillPageSettings.currentMemberDrillPage-=1,l._memberDrillPageSettings.startDrillPage=Math.abs(l._memberDrillPageSettings.startDrillPage-(l._memberDrillPageSettings.currentMemberDrillPage,l.model.memberEditorPageSize)),l._memberDrillPageSettings.endDrillPage-=l.model.memberEditorPageSize;else if(e(i.target).hasClass("e-firstPage"))l._memberDrillPageSettings.currentMemberDrillPage=1,l._memberDrillPageSettings.endDrillPage=l.model.memberEditorPageSize,l._memberDrillPageSettings.startDrillPage=0;else if(e(i.target).hasClass("e-lastPage"))l._memberDrillPageSettings.currentMemberDrillPage=parseInt(e.trim(l.element.find(".e-memberDrillPageCount").text().split("/")[1])),l._memberDrillPageSettings.endDrillPage=l._memberDrillPageSettings.currentMemberDrillPage*l.model.memberEditorPageSize,l._memberDrillPageSettings.startDrillPage=l._memberDrillPageSettings.endDrillPage-l.model.memberEditorPageSize;else{if(parseInt(e(i.target).val())>e.trim(l.element.find(".e-memberDrillPageCount").text().split("/")[1])||0==parseInt(e(i.target).val()))return l.element.find(".e-memberCurrentDrillPage").val(r),!1;l._memberDrillPageSettings.currentMemberDrillPage=parseInt(e(i.target).val()),l._memberDrillPageSettings.endDrillPage=l._memberDrillPageSettings.currentMemberDrillPage*l.model.memberEditorPageSize,l._memberDrillPageSettings.startDrillPage=1==l._memberDrillPageSettings.currentMemberDrillPage||0==l._memberDrillPageSettings.currentMemberDrillPage?0:l._memberDrillPageSettings.endDrillPage-l.model.memberEditorPageSize}l._waitingPopup.show(),this._editorTreeDrillPageInfoSuccess(l._memberTreeObj._dataSource.slice(),l)}},editorTreePageInfoSuccess:function(i,a){setTimeout(function(){var r,o;a._memberPageSettings.currentMemeberPage>1?a.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberPageSettings.currentMemeberPage==parseInt(e.trim(a.element.find(".e-memberPageCount").text().split("/")[1]))?a.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),a.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(r=i[0]!=l?i[0].Value:i.d!=l?i.d[0].Value:i.EditorTreeInfo,(o=e.parseJSON(r)).splice(-1,1)),a.element.find(".e-memberCurrentPage").val(a._memberPageSettings.currentMemeberPage),a._appendTreeViewData(a.model.operationalMode==t.Pivot.OperationalMode.ClientMode?o:t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(a._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)),a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0),a._waitingPopup.hide()},0)},_editorTreeDrillPageInfoSuccess:function(i,a){setTimeout(function(){var r,o,s;a._memberDrillPageSettings.currentMemberDrillPage>1?a.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberDrillPageSettings.currentMemberDrillPage==parseInt(e.trim(a.element.find(".e-memberDrillPageCount").text().split("/")[1]))?a.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),a.element.find(".e-memberCurrentDrillPage").val(a._memberDrillPageSettings.currentMemberDrillPage),o=0,i.length>0&&i[0].length>0&&"All"==i[0][0].id&&i[0].splice(0,1),e.each(i,function(e,t){if(1!=t.length||!t[0].expanded)return!1;o=e}),s=a.model.enableMemberEditorSorting&&a._sortType?t.DataManager(t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",i[o][0].id).sortBy("name",a._sortType))).executeLocal(t.Query().where("pid","notequal",l).page(a._memberDrillPageSettings.currentMemberDrillPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)):t.DataManager(t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",i[o][0].id))).executeLocal(t.Query().where("pid","notequal",l).page(a._memberDrillPageSettings.currentMemberDrillPage,"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize)),a._editorDrillTreePageSettings[i[o][0].id]=e.extend(!0,{},a._memberDrillPageSettings),a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0?(r=t.Pivot._getParentsTreeList(a,i[o][0].id,a._editorTreeData).concat(s),"ejPivotClient"!=a.pluginName?t.Pivot._createSearchTreeview(r,a):a._appendTreeViewData(r,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0)):"ejPivotClient"!=a.pluginName?t.Pivot._createSearchTreeview(s,a):a._appendTreeViewData(s,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0),a._waitingPopup.hide()},0)},_editorTreeSearchPageInfoSuccess:function(i,l){setTimeout(function(){var a,r="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize:l.model.memberEditorPageSize;for(l._memberSearchPageSettings.currentMemberSearchPage>1?l.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):l.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),l._memberSearchPageSettings.currentMemberSearchPage==parseInt(e.trim(l.element.find(".e-memberSearchPageCount").text().split("/")[1]))?l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):l.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),i=t.DataManager(i).executeLocal(t.Query().where(t.Predicate("id","notequal","(All)_0").and("id","notequal","All"))).slice((l._memberSearchPageSettings.currentMemberSearchPage-1)*r,(l._memberSearchPageSettings.currentMemberSearchPage-1)*r+r),a=0;a<i.length;a++)t.isNullOrUndefined(i[a].pid)||(i[a].parentId=i[a].pid);for(a=0;a<i.length;a++)t.Pivot._appendParentNodes(i,i[a],l);l.element.find(".e-memberCurrentSearchPage").val(l._memberSearchPageSettings.currentMemberSearchPage),i.splice(0,0,{id:"SearchFilterSelection",name:l._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:l._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"}),"ejPivotClient"==l.pluginName&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l._appendTreeViewData(i,l.element.find(".pvtBtn").parent("[data-tag='Slicers:"+l._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):t.Pivot._createSearchTreeview(i,l),l._waitingPopup.hide(),l._parentNodeCollection={},l._parentSearchNodeCollection={}},0)},_drillEditorTreeNode:function(i,a,r){var o,s;a._waitingPopup.show(),o=i.childNodes,a._isEditorDrillPaging&&!a._isEditorCollapseDrillPaging?a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0&&(a._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0},t.isNullOrUndefined(i.parentNode.id)||(a._editorDrillTreeData[i.parentNode.id]=o.slice(),a._editorDrillTreePageSettings[i.parentNode.id]=e.extend(!0,{},a._memberDrillPageSettings)),this._refreshDrillEditorPager(i,a,r)):a._isEditorCollapseDrillPaging&&(a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0&&(a._isEditorCollapseDrillPaging=!1,a._memberDrillPageSettings=t.isNullOrUndefined(i.parentNode.id)?i.drillPageSettings:i.drillPageSettings[i.parentNode.id]),this._refreshDrillEditorPager(i,a,r)),a._drilledNode=i.parentNode.id,s=t.isNullOrUndefined(i.parentNode.id)?i.parentNode.concat(i.childNodes):this._getParentsTreeList(a,i.parentNode.id,a._editorTreeData).concat(t.DataManager(o).executeLocal(t.Query().where("pid","notequal",l).page(a._memberDrillPageSettings.currentMemberDrillPage,r))),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(s,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):t.Pivot._createSearchTreeview(s,a),a._waitingPopup.hide()},_refreshDrillEditorPager:function(t,i,l){i.element.find(".e-memberPager,.e-memberSearchPager").css("display","none"),i.element.find(".e-memberDrillPager").css("display","block");var a=t.childNodes.length/l;a!=Math.round(a)&&(a=parseInt(a)+1),i._memberDrillPageSettings.currentMemberDrillPage==a&&i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").addClass("disabled"),i.element.find(".e-memberDrillPageCount").html("/ "+a),i.element.find(".e-memberCurrentDrillPage").val(i._memberDrillPageSettings.currentMemberDrillPage),i._memberDrillPageSettings.currentMemberDrillPage>1?i.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):i.element.find(".e-memberDrillPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),i._memberDrillPageSettings.currentMemberDrillPage==parseInt(e.trim(i.element.find(".e-memberDrillPageCount").text().split("/")[1]))?i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):i.element.find(".e-memberDrillPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),t.childNodes=t.childNodes.slice((i._memberDrillPageSettings.currentMemberDrillPage-1)*l,i._memberDrillPageSettings.currentMemberDrillPage*l)},_getParentsTreeList:function(e,i,l){var a,r=[];do{parentNodes=t.DataManager(l).executeLocal(t.Query().where("id","equal",i)),a=!t.isNullOrUndefined(parentNodes)&&parentNodes.length>0&&!t.isNullOrUndefined(parentNodes[0].pid),r.push(new t.Predicate("id","equal",i)),i=a?parentNodes[0].pid:null}while(!t.isNullOrUndefined(i));return t.DataManager(l).executeLocal(t.Query().where(t.Predicate.or(r)))},_onNodeCollapse:function(i){var a,r=t.isNullOrUndefined(i.olapCtrlObj)?this:i.olapCtrlObj,o=!1,s={memberEditorPageSize:"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl.model.memberEditorPageSize:r.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl.model.enableMemberEditorPaging:r.model.enableMemberEditorPaging};if(jQuery.each(r._editorTreeData,function(e,l){l.id==i.id?(t.isNullOrUndefined(l.pid)||(i.parentId=l.pid),l.expanded=!1):l.pid==i.id&&(t.isNullOrUndefined(r._editorDrillTreeData[l.id])||(o=!0))}),s.enableMemberEditorPaging&&(o||!t.isNullOrUndefined(r._editorDrillTreeData[i.id])||""==i.parentId)){r.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),r._lastSavedTree=[],r._isEditorDrillPaging=!1,r.element.find(".e-memberPager").length>0?(r.element.find(".e-memberPager").css("display","block"),r.element.find(".e-memberDrillPager,.e-memberSearchPager").css("display","none")):r.element.find(".e-memberDrillPager, .e-memberSearchPager").css("display","none");var n=[],d=i.parentId,h=!1,c=!1,p="";if(!t.isNullOrUndefined(d)&&""!=d){do{parentNodes=t.DataManager(r._editorTreeData).executeLocal(t.Query().where("id","equal",d)),h=!!(h||s.memberEditorPageSize<=t.DataManager(r._editorTreeData).executeLocal(t.Query().where("pid","equal",d)).length),n.push(new t.Predicate(h?"id":"pid","equal",d)),!c&&h&&s.memberEditorPageSize<t.DataManager(r._editorTreeData).executeLocal(t.Query().where("pid","equal",d)).length&&(c=!0,p=d),d=parentNodes[0].pid}while(!t.isNullOrUndefined(d));h?n.push(new t.Predicate("id","equal",i.parentId)):n.push(new t.Predicate("pid","equal",l))}h?(t.Pivot._makeAncestorsExpandable(r,i.parentId),r._isEditorCollapseDrillPaging=!0,(a={drillPageSettings:t.isNullOrUndefined(r._editorDrillTreePageSettings[p])&&"ejPivotSchemaDesigner"==r.pluginName?r.model.pivotControl._editorDrillTreePageSettings[p]:r._editorDrillTreePageSettings[p],parentNode:t.DataManager(e.extend(!0,[],r._editorTreeData)).executeLocal(t.Query().where(t.Predicate.or(n))),childNodes:t.DataManager(e.extend(!0,[],r._editorTreeData)).executeLocal(t.Query().where("pid","equal",p))}).parentNode=e.grep(a.parentNode,function(t){var i=!1;return e.each(a.childNodes,function(e,l){l.id==t.id&&(l.expanded=!0,i=!0)}),!i}),t.Pivot._drillEditorTreeNode(a,r,s.memberEditorPageSize)):(r.model.enableMemberEditorSorting&&(r._editorTreeData=t.DataManager(r._editorTreeData).executeLocal(t.Query().sortBy("name",r._sortType))),0==n.length&&n.push(new t.Predicate("pid","equal",l)),r.element.find(".e-memberPager").length>0?"ejPivotClient"!=r.pluginName?t.Pivot._createSearchTreeview(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(n)).page(r._memberPageSettings.currentMemeberPage,s.memberEditorPageSize)),r):r._appendTreeViewData(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(n)).page(r._memberPageSettings.currentMemeberPage,s.memberEditorPageSize)),r.element.find(".pvtBtn").parent("[data-tag='Slicers:"+r._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):"ejPivotClient"!=r.pluginName?t.Pivot._createSearchTreeview(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(n))),r):r._appendTreeViewData(t.DataManager(r._editorTreeData).executeLocal(t.Query().where(t.Predicate.or(n))),r.element.find(".pvtBtn").parent("[data-tag='Slicers:"+r._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0))}},_searchEditorTreeNodes:function(i,a){if(t.isNullOrUndefined(window.event)?0!=i.which&&13!=i.which:0!=window.event.which&&13!=window.event.which){t.isNullOrUndefined(a._waitingPopup.element)||a._waitingPopup.show();var r=this;setTimeout(function(){var i,o,s,n,d,h={memberEditorPageSize:"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.memberEditorPageSize:a.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==a.pluginName?a.model.pivotControl.model.enableMemberEditorPaging:a.model.enableMemberEditorPaging},c="";if("ejPivotClient"!=a.pluginName||t.isNullOrUndefined(a._pivotSchemaDesigner)){if(t.isNullOrUndefined(a.element.find(".searchEditorTreeView"))||0==a.element.find(".searchEditorTreeView").length)return!1;c=t.isNullOrUndefined(e.trim(a.element.find(".searchEditorTreeView").val()))?"":e.trim(a.element.find(".searchEditorTreeView").val()).toLowerCase()}else{if(t.isNullOrUndefined(a._pivotSchemaDesigner.element.find(".searchEditorTreeView"))||0==a._pivotSchemaDesigner.element.find(".searchEditorTreeView").length)return!1;c=t.isNullOrUndefined(e.trim(a._pivotSchemaDesigner.element.find(".searchEditorTreeView").val()))?"":e.trim(a._pivotSchemaDesigner.element.find(".searchEditorTreeView").val()).toLowerCase()}if(""!=c){var p=jQuery.extend(!0,[],t.DataManager(a._editorTreeData).executeLocal(t.Query().where("name","contains",c,!0).sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType))),u=e.extend(!0,[],p.slice(0,h.memberEditorPageSize+1)),m=h.enableMemberEditorPaging?u:p;for(i=0;i<m.length;i++)t.isNullOrUndefined(m[i].pid)||(m[i].parentId=m[i].pid);for(i=0;i<m.length;i++)r._appendParentNodes(m,m[i],a);a._isSearchApplied=!0,p.length>0?(a._isSelectSearchFilter=a.model.enableCheckStateOnSearch,h.enableMemberEditorPaging&&(a.element.find(".e-memberSearchPager").find(".e-nextPageDiv").length>0||a.element.find(".e-memberDrillPager").find(".e-nextPageDiv").length>0)&&(a._memberSearchPageSettings.currentMemberSearchPage=1,a._memberSearchPageSettings.startSearchPage=0,a._memberSearchPageSettings.endSearchPage=0,a.element.find(".e-memberPager,.e-memberDrillPager").css("display","none"),a._editorSearchTreeData=p.slice(),(o=t.DataManager(p).executeLocal(t.Query().where(t.Predicate("id","notequal","(All)_0").and("id","notequal","All"))).length/h.memberEditorPageSize)!=Math.round(o)&&(o=parseInt(o)+1),o>1&&a.element.find(".e-memberSearchPager").css("display","block"),a._memberSearchPageSettings.currentMemberSearchPage==o&&a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").addClass("disabled"),a.element.find(".e-memberSearchPageCount").html("/ "+o),a.element.find(".e-memberCurrentSearchPage").val(a._memberSearchPageSettings.currentMemberSearchPage),a._memberSearchPageSettings.currentMemberSearchPage>1?a.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):a.element.find(".e-memberSearchPager").find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),a._memberSearchPageSettings.currentMemberSearchPage==parseInt(e.trim(a.element.find(".e-memberSearchPageCount").text().split("/")[1]))?a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):a.element.find(".e-memberSearchPager").find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"))):(a.element.find(".e-memberPager,.e-memberSearchPager,.e-memberDrillPager").css("display","none"),a.element.find(".e-dialogFooter").css("margin-top","5px")),m.length>0&&("All"==m[0].id&&m.splice(0,1),m.splice(0,0,{id:"SearchFilterSelection",name:a._getLocalizedLabels("AddCurrentSelectionToFilter"),checkedStatus:a._isSelectSearchFilter,tag:"SearchFilterSelection",spriteCssClass:"e-searchfilterselection",uniqueName:"Add current selection to filter"})),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(m,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):r._createSearchTreeview(m,a)}else a._isSearchApplied=!1,a._isSelectSearchFilter=a.model.enableCheckStateOnSearch,s=!t.isNullOrUndefined(a._lastSavedTree)&&e.grep(a._lastSavedTree,function(e){return e.pid}).length>0,h.enableMemberEditorPaging&&a.element.find(".e-memberSearchPager").find(".e-nextPageDiv").length>0&&(a._editorSearchTreeData=[],""!=a.element.find(".e-memberPageCount").text()&&a.element.find(".e-memberPager").css("display","block"),a.element.find(".e-memberSearchPager").css("display","none")),s&&""!=a.element.find(".e-memberDrillPageCount").text()&&(a.element.find(".e-memberDrillPager").css("display","block"),a.element.find(".e-memberPager").css("display","none")),"ejPivotClient"==a.pluginName&&a.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a._appendTreeViewData(h.enableMemberEditorPaging?s?t.DataManager(a._lastSavedTree).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):t.DataManager(a._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(a._memberPageSettings.currentMemeberPage,h.memberEditorPageSize).sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):a._editorTreeData,a.element.find(".pvtBtn").parent("[data-tag='Slicers:"+a._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0):r._createSearchTreeview(h.enableMemberEditorPaging?s?t.DataManager(a._lastSavedTree).executeLocal(t.Query().sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):t.DataManager(a._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0")).page(a._memberPageSettings.currentMemeberPage,h.memberEditorPageSize).sortBy("name",t.isNullOrUndefined(a._sortType)?"":a._sortType)):a._editorTreeData,a);n={id:"SearchFilterSelection",type:a._isSelectSearchFilter?"nodeCheck":"nodeUncheck"},d=a.element.find(".e-editorTreeView"),t.Pivot._updateSearchFilterSelection(n,d,a),a._waitingPopup.hide(),a._parentNodeCollection={},a._parentSearchNodeCollection={}},0)}},_createSearchTreeview:function(i,l){"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging;var a,r,o="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableAdvancedFilter:l.model.enableAdvancedFilter,s="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorSorting:l.model.enableMemberEditorSorting,n=l.element.find(".e-pvtBtn").parent("[data-tag='Slicers:"+(l._selectedFieldName||l._dialogHead)+"']").length>0,d=("ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.analysisMode:l.model.analysisMode,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.operationalMode:l.model.operationalMode);for(!l._isSearchApplied&&0==l._editorSearchTreeData.length&&i.length>0&&(l._lastSavedTree=i),i.length>0&&(i=t.DataManager(i).executeLocal(t.Query().where(t.Predicate("id","notequal","All").and("id","notequal","(All)_0")))).splice(0,0,{id:"All",name:o&&!n?"(Select All)":d==t.Pivot.OperationalMode.ServerMode?"(All)":"All",checkedStatus:l._isAllMemberChecked,_isAllMemberChecked:l._isAllMemberChecked}),l.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:l.model.enableRTL,beforeDelete:function(e){if(!t.isNullOrUndefined(e.event)&&"keydown"==e.event.type&&"delete"==e.event.originalEvent.key.toLowerCase())return!1},height:s?"200px":"245px",fields:{id:"id",text:"name",isChecked:"checkedStatus",parentId:"pid",expanded:"expanded",hasChild:"hasChildren",dataSource:t.Pivot._showEditorLinkPanel(i,l,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl:l)}}),a=l.element.find(".e-editorTreeView").find("li"),r=0;r<a.length;r++)t.isNullOrUndefined(e(a[r]).attr("id"))||e(a[r]).attr("data-tag",t.DataManager(i).executeLocal(t.Query().where("id","equal",e(a[r]).attr("id")))[0].tag);l._memberTreeObj=l.element.find(".e-editorTreeView").data("ejTreeView"),l._memberTreeObj.model.nodeCheck=t.proxy(l._nodeCheckChanges,l),l._memberTreeObj.model.nodeUncheck=t.proxy(l._nodeCheckChanges,l),"ejPivotGrid"==l.pluginName?l.model.operationalMode==t.Pivot.OperationalMode.ClientMode?l._memberTreeObj.model.beforeExpand=t.proxy(l._beforeNodeExpand,l):l._memberTreeObj.model.nodeClick=t.proxy(l._nodeExpand,l):(l.model.pivotControl.model.operationalMode==t.Pivot.OperationalMode.ClientMode?l._memberTreeObj.model.beforeExpand=t.proxy(l._beforeNodeExpand,l):l._memberTreeObj.model.nodeClick=t.proxy(l._nodeExpand,l),l._memberTreeObj.model.beforeCollapse=t.proxy(t.Pivot._onNodeCollapse,l)),t.isNullOrUndefined(l.element.find(".e-dialog .e-text:visible").first())||(l.element.find(".e-dialog .e-text:visible").length>0?(l.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").addClass("e-hoverCell"),l.element.find(".e-dialog button").removeClass("e-hoverCell")):l.element.find(".e-dialog button:visible").first().attr("tabindex","-1").addClass("e-hoverCell")),0==l._memberTreeObj.element.find(".e-plus").length&&0==l._memberTreeObj.element.find(".e-minus").length&&l._memberTreeObj.element.find(".e-item").css("padding","0px"),l.model.enableMemberEditorSorting&&this._separateAllMember(l)},_separateAllMember:function(e){var i=e.element.hasClass("e-pivotclient")&&"servermode"==e.model.operationalMode&&"olap"==e.model.analysisMode,l="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.enableAdvancedFilter:e.model.enableAdvancedFilter,a="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.enableRTL:e.model.enableRTL,r="ejPivotSchemaDesigner"==e.pluginName?e.model.pivotControl.model.analysisMode:e.model.analysisMode,o=i?"":t.buildTag("div.e-checkAllBox",t.buildTag("input#allElement.allMember","",{float:a?"right":"left"},{name:"row",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.e-allElementLabel",l?"(Select All)":"All",{"margin-left":"5px"})[0].outerHTML,{width:"100px",float:a?"right":"left"})[0].outerHTML,s=t.buildTag("div.memberSortDiv",t.buildTag("div.e-icon e-memberAscendingIcon",{margin:"5px"})[0].outerHTML+t.buildTag("div.e-icon e-memberDescendingIcon")[0].outerHTML,{height:"35px","margin-left":"5px",float:a?"left":"right"})[0].outerHTML,n=t.buildTag("div.memberSortingDiv",o+s,{height:"20px",margin:"ejPivotSchemaDesigner"==e.pluginName?a?r==t.Pivot.AnalysisMode.Pivot?"10px 15px 0px 21px":"10px 31px 0px 12px":r==t.Pivot.AnalysisMode.Pivot?"10px 0px 0px 8px":"10px 0px 0px 20px":a?r==t.Pivot.AnalysisMode.Pivot?"10px 15px 0px 20px":"10px 28px 0px 20px":r==t.Pivot.AnalysisMode.Pivot?"10px 0px 0px 20px":"10px 0px 0px 29px"});l&&e.element.find(".e-editorTreeView").css("margin-top","10px"),e.element.find(".memberSortingDiv, .e-separateDiv").remove(),r==t.Pivot.AnalysisMode.Pivot&&e.element.find(".e-editorTreeView").addClass("e-treeViewUl"),i||e.element.find(".e-editorTreeView").before(n),("All"==e.element.find(".e-editorTreeView li:first").attr("id")||"(All)_0"==e.element.find(".e-editorTreeView li:first").attr("id"))&&e.element.find(".e-editorTreeView li:first").css("display","none"),i?(e.element.find(".memberSortDiv, .e-separateDiv").remove(),e.element.find(".e-checkOptions").after(t.buildTag("div.e-separateDiv",{margin:"0px 5px"})[0].outerHTML),e.element.find(".e-checkOptions").append(s),l&&e.element.find(".e-editorTreeView").height(235)):(e.element.find(".memberSortingDiv").after(t.buildTag("div.e-separateDiv",{})[0].outerHTML),e.element.find(".allMember").ejCheckBox({size:"small",width:"40px",checked:"disabled"!=e.element.find(".e-dialogOKBtn").attr("disabled"),change:t.proxy(e._nodeCheckChanges,e)})),"ascending"==e._sortType?e.element.find(".e-memberAscendingIcon").addClass("e-selectedSort"):"descending"==e._sortType&&e.element.find(".e-memberDescendingIcon").addClass("e-selectedSort")},_checkChanges:function(e){var t="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this;e.isChecked?t._nodeCheckChanges(e):e.isChecked||t._nodeUnCheckChanges(e)},_fetchMemberPageSuccess:function(i){var a,r="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl:this;i[0]!=l&&i.length>0?(a=i[0].Value,null!=i[1]&&i[1]!=l&&(this.model.customObject=i[1].Value)):i.d!=l&&i.d.length>0?(a=i.d[0].Value,null!=i.d[1]&&i.d[1]!=l&&(this.model.customObject=i.d[1].Value)):i!=l&&i.length>0?(a=i.EditorTreeInfo,null!=i&&i.customObject!=l&&(this.model.customObject=i.customObject)):i!=l&&(a=i.EditorTreeInfo,null!=i&&i.customObject!=l&&(this.model.customObject=i.customObject)),this._memberPageSettings.endPage="ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl.model.memberEditorPageSize:this.model.memberEditorPageSize,this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1,filteredData=JSON.parse(a),this._editorTreeData=e.extend(!0,[],filteredData),r.model.enableAdvancedFilter&&(this._editorTreeData=e.map(this._editorTreeData,function(e){if(t.isNullOrUndefined(e.levels))return e})),("ejPivotSchemaDesigner"==this.pluginName&&this.model.pivotControl&&this.model.pivotControl.model.enableAdvancedFilter&&this.model.pivotControl.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.pivotControl.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||"ejPivotGrid"==this.pluginName&&this.model.enableAdvancedFilter&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this._memberPagingAvdData=filteredData.splice(filteredData.length-1,1)),this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All").and("id","notequal","(All)_0"))).length,filteredData=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(this._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==this.pluginName?this.model.pivotControl.model.memberEditorPageSize+1:this.model.memberEditorPageSize+1)),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(filteredData)})},_memberPageNodeUncheck:function(i,l){var a,r="",o=null,s="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging;e(i.currentElement).parent().parent().hasClass("e-editorTreeView")&&!l._isSearchApplied&&s?(r=t.DataManager(l._editorTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(o=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0])):(r=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(o=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0])),t.isNullOrUndefined(r)||(r.checkedStatus=!1,t.isNullOrUndefined(r.pid)||(a=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",r.pid).where("checkedStatus","equal",!0)),t.isNullOrUndefined(a)||0!=a.length||t.Pivot._unSelectParentTreeNode(r,l)),a=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",r.id)),!t.isNullOrUndefined(a)&&a.length>0&&t.Pivot._unSelectChildTreeNode(r,l)),t.isNullOrUndefined(o)||(o.checkedStatus=!1,t.isNullOrUndefined(o.pid)||(a=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",o.pid).where("checkedStatus","equal",!0)),t.isNullOrUndefined(a)||0!=a.length||t.Pivot._unSelectParentTreeNode(o,l)),a=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",r.id)),!t.isNullOrUndefined(a)&&a.length>0&&t.Pivot._unSelectChildTreeNode(o,l))},_memberPageNodeCheck:function(i,l){var a,r,o="",s=null,n="ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.enableMemberEditorPaging:l.model.enableMemberEditorPaging;if(e(i.currentElement).parent().parent().hasClass("e-editorTreeView")&&!l._isSearchApplied&&n?(o=t.DataManager(l._editorTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(s=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().page(l._memberPageSettings.currentMemeberPage,"ejPivotSchemaDesigner"==l.pluginName?l.model.pivotControl.model.memberEditorPageSize+1:l.model.memberEditorPageSize+1).where("id","equal",i.currentElement.attr("id")))[0])):(o=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0],t.isNullOrUndefined(l._editorSearchTreeData)||(s=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("id","equal",i.currentElement.attr("id")))[0])),!t.isNullOrUndefined(o)&&(o.checkedStatus=!0,t.isNullOrUndefined(o.pid)||t.Pivot._selectParentTreeNode(o,l),!t.isNullOrUndefined(o.id)&&(a=t.DataManager(l._editorTreeData).executeLocal(t.Query().where("pid","equal",o.id)),!t.isNullOrUndefined(a)&&a.length>0)))for(r=0;r<a.length;r++)a[r].checkedStatus=!0,(a[r].expanded||a[r].isChildMerged)&&t.Pivot._selectChildTreeNode(a[r],l);if(!t.isNullOrUndefined(s)&&(s.checkedStatus=!0,t.isNullOrUndefined(s.pid)||t.Pivot._selectParentTreeNode(s,l),!t.isNullOrUndefined(s.id)&&(a=t.DataManager(l._editorSearchTreeData).executeLocal(t.Query().where("pid","equal",s.id)),!t.isNullOrUndefined(a)&&a.length>0)))for(r=0;r<a.length;r++)a[r].checkedStatus=!0,t.Pivot._selectChildTreeNode(a[r],l)},_appendParentNodes:function(e,i,l){var a,r;t.isNullOrUndefined(i.pid)||(t.isNullOrUndefined(l._parentNodeCollection[i.pid])?(a=jQuery.extend(!0,[],t.DataManager(l._editorTreeData).executeLocal(t.Query().where("id","equal",i.pid))),l._parentNodeCollection[i.pid]=a):a=l._parentNodeCollection[i.pid],!t.isNullOrUndefined(a)&&a.length>0&&(t.isNullOrUndefined(l._parentSearchNodeCollection[a[0].id])?(r=jQuery.extend(!0,[],t.DataManager(e).executeLocal(t.Query().where("id","equal",a[0].id))),l._parentSearchNodeCollection[a[0].id]=a):r=l._parentSearchNodeCollection[a[0].id]),t.isNullOrUndefined(r)||(0==r.length?(a[0].expanded=!0,e.push(a[0]),t.isNullOrUndefined(a[0].pid)||this._appendParentNodes(e,a[0],l)):r[0].expanded=!0))},_selectParentTreeNode:function(e,i){var l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("id","equal",e.pid));!t.isNullOrUndefined(l)&&l.length>0&&(l[0].checkedStatus=!0,this._selectParentTreeNode(l[0],i))},_selectChildTreeNode:function(e,i){var l,a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id));if(!t.isNullOrUndefined(a)&&a.length>0)for(l=0;l<a.length;l++)a[l].checkedStatus=!0,(a[l].expanded||a[l].isChildMerged)&&this._selectChildTreeNode(a[l],i)},_unSelectChildTreeNode:function(e,i){var l,a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id));if(!t.isNullOrUndefined(a)&&a.length>0)for(l=0;l<a.length;l++)a[l].checkedStatus=!1,(a[l].expanded||a[l].isChildMerged)&&this._unSelectChildTreeNode(a[l],i)},_unSelectParentTreeNode:function(e,i){var l=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("id","equal",e.pid));!t.isNullOrUndefined(l)&&l.length>0&&(l[0].checkedStatus=!1,0==t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",l[0].pid).where("checkedStatus","equal",!0)).length&&this._unSelectParentTreeNode(l[0],i))},_getSelectedTreeState:function(e,i){var a,r,o,s,n,d;if(e){for(n=[],a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",l)),d=0;d<a.length;d++){if(r=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",a[d].id)),o={caption:a[d].name,parentId:t.isNullOrUndefined(a[d].pid)?"None":a[d].pid,id:a[d].id,checked:a[d].checkedStatus,expanded:r.length>0,childNodes:[],tag:a[d].tag},r.length>0)for(s=0;s<r.length;s++)o.childNodes.push(this._getEditorSlicerInfo(r[s],i));n.push(o)}return JSON.stringify(n)}for(n="",d=0;d<i._editorTreeData.length;d++)1==i._editorTreeData[d].checkedStatus&&(n+="::"+i._editorTreeData[d].id+"||"+i._editorTreeData[d].tag);return n},_getUnSelectedTreeState:function(e){for(var t="",i=0;i<e._editorTreeData.length;i++)0==e._editorTreeData[i].checkedStatus&&(t+="::"+e._editorTreeData[i].id+"||"+e._editorTreeData[i].tag);return t},_getEditorSlicerInfo:function(e,i){var l,a=t.DataManager(i._editorTreeData).executeLocal(t.Query().where("pid","equal",e.id)),r={caption:e.name,parentId:t.isNullOrUndefined(e.pid)?"None":e.pid,id:e.id,checked:e.checkedStatus,expanded:a.length>0,childNodes:[],tag:e.tag};if(a.length>0)for(l=0;l<a.length;l++)r.childNodes.push(this._getEditorSlicerInfo(a[l],i));return r},_editorLinkPanelClick:function(){this.element.find(".e-dialog").hide(),t.Pivot._createErrorDialog(this._getLocalizedLabels("EditorLinkPanelAlert").split("1000").join(this.model.maxNodeLimitInMemberEditor),this._getLocalizedLabels("Warning"),this)},_showEditorLinkPanel:function(i,l,a){var r,o;if(!a.model.enableMemberEditorPaging&&(a.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||l._isSearchApplied||(l._editorTreeData=i),i.length>a.model.maxNodeLimitInMemberEditor+(l._isSearchApplied?1:0))){var s=[],n={},d={},h=!1;for(r=0;r<i.length;r++)t.isNullOrUndefined(n[i[r].pid])?(t.isNullOrUndefined(i[r].pid)||(o=e.grep(i,function(e){if(e.id==i[r].pid)return e})).length>0&&(d[i[r].pid]=!!o[0].expanded),n[i[r].pid]=1):n[i[r].pid]++,n[i[r].pid]<=a.model.maxNodeLimitInMemberEditor+(l._isSearchApplied&&t.isNullOrUndefined(i[r].pid)?1:0)?s.push(i[r]):(t.isNullOrUndefined(d[i[r].pid])||d[i[r].pid])&&(h=!0);i=s,h&&l.element.find("div.e-linkOuterPanel").css("display","block")}return i},createErrorDialog:function(i){var l,a;t.Pivot.openPreventPanel(i),0==i.element.find(".e-errorDialog").length?(a=t.buildTag("div.e-errorDialog#ErrorDialog",t.buildTag("div.warningImg")[0].outerHTML+t.buildTag("div.warningContent",i._getLocalizedLabels("AlertMsg"))[0].outerHTML+t.buildTag("div",t.buildTag("button#ErrOKBtn.errOKBtn","OK")[0].outerHTML)[0].outerHTML).attr("title",i._getLocalizedLabels("Warning"))[0].outerHTML,i.element.append(a),i.element.find(".e-errorDialog").ejDialog({target:"#"+i._id,enableResize:!1,enableRTL:i.model.enableRTL,width:"400px"}),l=i.element.find(".e-errorDialog").data("ejDialog"),e("#"+l._id+"_wrapper").css({left:"50%",top:"50%"}),i.element.find(".errOKBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(t.Pivot.errOKBtnClick,i)}),i.element.find(".e-dialog .e-close").attr("title",i._getLocalizedLabels("Close"))):(l=i.element.find(".e-errorDialog").data("ejDialog")).open()},errOKBtnClick:function(){this.element.find("#preventDiv").remove(),this.element.find(".e-errorDialog").data("ejDialog")._ejDialog.find("div.e-dialog-icon").trigger("click")},doAjaxPost:function(i,a,r,o,s,n){var d,h,c,p=!0;r.XMLA==l?(d="application/json; charset=utf-8",h="json",c=e.proxy(o,this)):(d="text/xml",h="xml",r=r.XMLA,c=e.proxy(o,t.olap.base,n),p=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)&&(!t.isNullOrUndefined(n)&&"loadFieldElements"!=n.action)),e.ajax({type:i,url:a,contentType:d,async:p,dataType:h,data:r,success:c,complete:t.proxy(function(t){e.proxy(t,this);this._currentAction,this.element},this),error:t.proxy(function(e){void 0!==this._ogridWaitingPopup&&null!=this._ogridWaitingPopup&&this._ogridWaitingPopup.hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide();var t={action:""!=this._drillAction?this._drillAction:"initialize",customObject:"",element:this.element,Message:e};this._trigger("renderFailure",t),this.renderControlFromJSON(""),"XMLA"==this._dataModel&&this._createErrorDialog(e.statusText,this._getLocalizedLabels("Error")),e.statusText},this)})},getCubeList:function(t,i){for(var l,a=[],r=0;r<e(i).find("row").length;r++)l=e(e(i).find("row")[r]),a.push({name:e(l).children("CUBE_NAME").text()});t.pvtCtrldObj.setCubeList(a)},generateTreeViewData:function(e){var t={catalog:e.model.pivotControl.model.dataSource.catalog,cube:e.model.pivotControl.model.dataSource.cube,url:e.model.pivotControl.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(t,this.loadDimensionElements,{schemaData:e,action:"loadFieldElements"})},loadDimensionElements:function(i,a){var r,o=i.schemaData.model.pivotControl,s={},n=(t.olap.base._getConnectionInfo(o.model.dataSource.data),{}),d=o.model.dataSource.providerName==t.olap.Providers.Mondrian;for(n={catalog:o.model.dataSource.catalog,cube:o.model.dataSource.cube,url:o.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},o.schemaTreeView=[],o.reportItemNames=[],r=0;r<e(a).find("row").length;r++){var h=e(e(a).find("row")[r]),c=h.find("DIMENSION_UNIQUE_NAME").text(),p=h.find("DIMENSION_CAPTION").text();c.toLowerCase().indexOf("[measure")>=0?s={hasChildren:!0,isSelected:!1,id:c,name:p,spriteCssClass:"[measures]"==c.toLowerCase()?"e-folderCDB e-icon":"e-dimensionCDB e-icon",tag:c}:!e(e(a).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&o.schemaTreeView.push({hasChildren:!0,isSelected:!1,id:d?c+"~#^Dim":c,name:p,spriteCssClass:"e-dimensionCDB e-icon",tag:c,defaultHierarchy:e(e(a).find("row")[r]).children("DEFAULT_HIERARCHY").text()})}o.schemaTreeView.splice(0,0,s),!o.model.enableDrillThrough||i.schemaData!=l&&i.schemaData.model.olap.showNamedSets?(n.request="MDSCHEMA_SETS",t.Pivot._getTreeData(n,t.Pivot.loadNamedSetElements,i)):(n.request="MDSCHEMA_HIERARCHIES",(t.isNullOrUndefined(o._fieldData)||!t.isNullOrUndefined(o._fieldData)&&t.isNullOrUndefined(o._fieldData.hierarchy))&&this._getFieldItemsInfo(o),o._fieldData.hierarchySuccess==l?t.Pivot._getTreeData(n,o.loadHierarchyElements,i):t.Pivot.loadHierarchyElements(i,o._fieldData.hierarchySuccess))},loadNamedSetElements:function(i,a){var r,o,s,n=i.schemaData.model.pivotControl,d={catalog:n.model.dataSource.catalog,cube:n.model.dataSource.cube,url:n.model.dataSource.data,request:"MDSCHEMA_HIERARCHIES"},h=(a=n.model.dataSource,[]);for(r=e.map(a.rows,function(e){if(e.fieldName!=l)return e.fieldName}),e.merge(r,e.map(a.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(r,e.map(a.filters,function(e){if(e.fieldName!=l)return e.fieldName})),o=0;o<e(a).find("row").length;o++)s=e(e(a).find("row")[o]),e.inArray(s.find("DIMENSIONS").text().split(".")[0],h)>=0||(n.schemaTreeView.push({hasChildren:!0,isSelected:!1,pid:s.find("DIMENSIONS").text().split(".")[0],id:s.find("SET_DISPLAY_FOLDER").text()+"_"+s.find("DIMENSIONS").text().split(".")[0],name:s.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"e-folderCDB e-icon namedSets"}),h.push(s.find("DIMENSIONS").text().split(".")[0])),n.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray("["+e.trim(s.children("SET_NAME").text())+"]",r)>=0,pid:s.find("SET_DISPLAY_FOLDER").text()+"_"+s.find("DIMENSIONS").text().split(".")[0],id:"["+e.trim(s.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:s.children("SET_CAPTION").text(),spriteCssClass:"e-namedSetCDB e-icon",tag:s.find("EXPRESSION").text()});t.isNullOrUndefined(n._fieldData)||n._fieldData.hierarchySuccess==l?t.Pivot._getTreeData(d,t.Pivot.loadHierarchyElements,i):t.Pivot.loadHierarchyElements(i,n._fieldData.hierarchySuccess)},loadHierarchyElements:function(i,a){var r,o,s=i.schemaData.model.pivotControl,n={catalog:s.model.dataSource.catalog,cube:s.model.dataSource.cube,url:s.model.dataSource.data,request:"MDSCHEMA_LEVELS"},d=s.model.dataSource,h=s.model.dataSource.providerName==t.olap.Providers.Mondrian;for(r=e.map(d.rows,function(e){if(e.fieldName!=l)return e.fieldName}),e.merge(r,e.map(d.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(r,e.map(d.filters,function(e){if(e.fieldName!=l)return e.fieldName})),o=0;o<e(a).find("row").length;o++){var c=e(e(a).find("row")[o]),p=c.find("DIMENSION_UNIQUE_NAME").text(),u=c.find("HIERARCHY_UNIQUE_NAME").text();e(s.schemaTreeView).filter(function(e,t){return t.tag==p}).map(function(e,t){return t}).length>0&&(p!=u||h)&&s.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray(u,r)>=0,pid:p+(h?"~#^Dim":""),id:u,name:c.find("HIERARCHY_CAPTION").text(),spriteCssClass:"2"!=c.find("HIERARCHY_ORIGIN").text()&&"6"!=c.find("HIERARCHY_ORIGIN").text()?"e-hierarchyCDB e-icon":"e-attributeCDB e-icon",tag:u})}t.Pivot._getTreeData(n,t.Pivot.loadLevelElements,i)},loadLevelElements:function(i,l){var a,r=i.schemaData.model.pivotControl,o=e.map(e(l).find("row"),function(t){if("1"!=parseInt(e(t).children("LEVEL_TYPE").text())&&"[measures]"!=e(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase())return{hasChildren:!1,isChecked:!1,id:e(t).find("LEVEL_UNIQUE_NAME").text(),pid:e(t).find("HIERARCHY_UNIQUE_NAME").text(),name:e(t).find("LEVEL_CAPTION").text(),tag:e(t).find("LEVEL_UNIQUE_NAME").text(),spriteCssClass:"e-level"+parseInt(e(t).children("LEVEL_NUMBER").text())+" e-icon"}});e.merge(r.schemaTreeView,o),(!r.model.enableDrillThrough||r._fieldData.measureSuccess)&&(t.isNullOrUndefined(r._fieldData)||!r._fieldData.measureSuccess?(a={catalog:r.model.dataSource.catalog,cube:r.model.dataSource.cube,url:r.model.dataSource.data,request:"MDSCHEMA_MEASURES"},t.Pivot._getTreeData(a,t.Pivot.loadMeasureElements,i)):t.Pivot.loadMeasureElements(i,r._fieldData.measureSuccess))},loadMeasureGroups:function(i,l){t.isNullOrUndefined(i.pivotControl._fieldData)&&(i.pivotControl._fieldData={}),i.pivotControl._fieldData.measuresGroups=e(l).find("row")},loadMeasureElements:function(i,a){var r,o,s,n,d=i.schemaData.model.pivotControl,h={catalog:d.model.dataSource.catalog,cube:d.model.dataSource.cube,url:d.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},c=[];r=e.map(d.model.dataSource.values,function(e){if(e.measures!=l)return e.measures}),d.reportItemNames=e.map(r,function(e){if(e.fieldName!=l)return e.fieldName}),"en-US"!=d.model.locale&&(h={catalog:d.model.dataSource.catalog,cube:d.model.dataSource.cube,url:d.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.Pivot._getTreeData(h,t.Pivot.loadMeasureGroups,{pivotControl:d,action:"loadFieldElements"}));var p,u,m,g=[],f=[],b=[],_=[],v=[];if("ejPivotClient"==d.pluginName&&(d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Ascending||d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Descending)&&d.model.sortCubeMeasures!=t.PivotAnalysis.SortOrder.None){for(sortType=d.model.sortCubeMeasures==t.PivotAnalysis.SortOrder.Ascending?"ascending":"descending",s=0;s<e(a).find("row").length;s++)f.push({name:e(a).find("row:eq("+s+") MEASURE_CAPTION").text()});for(u=t.DataManager(f).executeLocal(t.Query().sortBy("name",sortType)),e.each(u,function(t,i){for(var l=0;l<e(a).find("row").length;l++)i.name==e(a).find("row:eq("+l+") MEASURE_CAPTION").text()&&b.push(e(a).find("row:eq("+l+")"))}),s=0;s<b.length;s++)e.inArray(e(b[s]).children("MEASUREGROUP_NAME").text(),g)>=0||(g.push(e(b[s]).children("MEASUREGROUP_NAME").text()),_.push({name:e(b[s]).children("MEASUREGROUP_NAME").text()}));p=t.DataManager(_).executeLocal(t.Query().sortBy("name",sortType)),e.each(p,function(t,i){for(var l=0;l<b.length;l++)i.name==e(b[l]).children("MEASUREGROUP_NAME").text()&&v.push(e(b[l]))}),m=v}else m=e(a).find("row");for(s=0;s<m.length;s++){var C=e(m[s]),S=C.children("MEASUREGROUP_NAME").text(),O=C.find("MEASURE_UNIQUE_NAME").text();e.inArray(S,c)>=0||("en-US"!=d.model.locale?o=(n=e.map(d._fieldData.measuresGroups,function(t){if(e(t).children("MEASUREGROUP_NAME").text()==S)return e(t).children("MEASUREGROUP_CAPTION").text()})).length>0?n[0]:S:o=S,""!=S&&d.schemaTreeView.push({hasChildren:!0,isChecked:!1,pid:"[Measures]",id:S,name:o,spriteCssClass:"e-measureGroupCDB e-icon",tag:S}),c.push(S)),d.schemaTreeView.push({hasChildren:!0,isSelected:e.inArray(O,d.reportItemNames)>=0,id:O,pid:""==S?"[Measures]":S,name:C.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:O}),e.inArray(O,d.reportItemNames)>=0&&d.reportItemNames.splice(d.reportItemNames.indexOf(O),1)}t.isNullOrUndefined(i.schemaData)||!i.schemaData.model.olap.showKpi&&!d.model.enableKPI?t.isNullOrUndefined(i.schemaData)||i.schemaData._createTreeView(this,d.schemaTreeView):(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"kpiCDB e-folderCDB e-icon",tag:""},d.schemaTreeView.splice(1,0,treeNodeElement),h.request="MDSCHEMA_KPIS",t.Pivot._getTreeData(h,t.Pivot.loadKPIElements,i))},loadKPIElements:function(t,i){for(var l=t.schemaData.model.pivotControl,a=this.reportItemNames,r=[],o=0;o<e(i).find("row").length;o++){var s=e(e(i).find("row")[o]),n=s.children("KPI_CAPTION").text(),d=s.children("KPI_goal").text(),h=s.children("KPI_STATUS").text(),c=s.children("KPI_TREND").text(),p=s.find("KPI_VALUE").text();e.inArray(s.children("KPI_NAME").text(),r)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:n,name:n,spriteCssClass:"e-measureGroupCDB e-icon",tag:n},l.schemaTreeView.push(treeNodeElement),r.push(n)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(d,a)>=0,id:d,pid:n,name:l.model.enableKPI?"Goal":l._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:d},l.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(h,a)>=0,id:h,pid:n,name:l.model.enableKPI?"Status":l._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:h},l.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(c,a)>=0,id:c,pid:n,name:l.model.enableKPI?"Trend":l._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:c},l.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(p,a)>=0,id:p,pid:n,name:l.model.enableKPI?"Value":l._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:p},l.schemaTreeView.push(treeNodeElement)}t.schemaData._createTreeView(this,l.schemaTreeView),delete l.reportItemNames,delete l.schemaTreeView},_createCalcMemberDialog:function(i,a){var r,o,s,n,d,h,c,p;a=t.isNullOrUndefined(a.model)?this:a;r=i.length>1&&i[0]!=l?JSON.parse(i[0].Value):i.d!=l?JSON.parse(i.d[0].Value):JSON.parse(i.CubeTreeInfo),null!=a.model.afterServiceInvoke&&a._trigger("afterServiceInvoke",{action:"fetchCalcMemberTreeView",element:a.element,customObject:a.model.customObject}),t.Pivot.openPreventPanel(a),a.element.find(".e-calcMemberDialog",".e-clientDialog",".e-dialog").remove();var u=t.buildTag("div.e-cubeBrowserCalcMember",t.buildTag("div#"+a._id+"_cubeTreeViewCalcMember.e-cubeTreeViewCalcMember")[0].outerHTML,{})[0].outerHTML,m=t.buildTag("label.lblCaption",a._getLocalizedLabels("Caption"),{})[0].outerHTML+t.buildTag("input#"+a._id+"_captionFieldCM.captionFieldCM","",{}).attr("aria-label",a._getLocalizedLabels("Caption"))[0].outerHTML,g=t.buildTag("label.lblexpression",a._getLocalizedLabels("Expression"),{})[0].outerHTML+t.buildTag("textarea#"+a._id+"_expressionFieldCM.e-textarea e-droppable expressionFieldCM"+(a.model.enableRTL?" e-rtl":""),"",{}).attr("aria-label",a._getLocalizedLabels("Expression"))[0].outerHTML,f=t.buildTag("label.lblmemberType",a._getLocalizedLabels("MemberType"),{})[0].outerHTML+t.buildTag("input#"+a._id+"_memberTypeFieldCM.memberTypeFieldCM","",{}).attr("aria-label",a._getLocalizedLabels("MemberType"))[0].outerHTML+t.buildTag("input#"+a._id+"_dimensionFieldCM.dimensionFieldCM","",{}).attr("aria-label","dimension")[0].outerHTML,b=t.buildTag("label.lblformat",a._getLocalizedLabels("FormatString"),{})[0].outerHTML+t.buildTag("input#"+a._id+"_formatFieldCM.formatFieldCM","",{}).attr("aria-label",a._getLocalizedLabels("FormatString"))[0].outerHTML+t.buildTag("input#"+a._id+"_customFormatFieldCM.customFormatFieldCM","",{}).attr("aria-label","custom format")[0].outerHTML,_=t.buildTag("div.e-calcMemberFieldPanel",m+g+f+b,{})[0].outerHTML,v=t.buildTag("button#"+a._id+"_btnOk.e-btnCalcMemberOk",a._getLocalizedLabels("OK"),{},{name:a._getLocalizedLabels("OK")}).attr("aria-label",a._getLocalizedLabels("OK")).attr("title",a._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,C=t.buildTag("button#"+a._id+"_btnCancel.btnCalcMemberCancel",a._getLocalizedLabels("Cancel"),{},{name:a._getLocalizedLabels("Cancel")}).attr("aria-label",a._getLocalizedLabels("Cancel")).attr("title",a._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,S=t.buildTag("div.e-calcMemberFooter",v+C,{})[0].outerHTML;for(a._calcMemberDialog=t.buildTag("div#"+a._id+"_calcMemberDialog",u+_+S,{})[0].outerHTML,e(a._calcMemberDialog).appendTo("#"+a._id),e("#"+a._id+"_calcMemberDialog").ejDialog({width:"auto",title:a._getLocalizedLabels("CalculatedMember"),cssClass:a.model.cssClass+" e-calcMemberDialog",enableModal:!1,target:"#"+a._id,enableRTL:a.model.enableRTL,enableResize:!1,close:t.proxy(function(){t.Pivot.closePreventPanel(a)},a),beforeOpen:t.proxy(function(){a.element.find(".e-calcMemberDialog .e-dialog").css("display","block")},a)}),a._calcMemberDialog=a.element.find("#"+a._id+"_calcMemberDialog").data("ejDialog"),e("#"+a._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80px",enableRTL:a.model.enableRTL,click:t.proxy(function(){a._calcMemberDialog.close(),a._selectedCalcMember=null,t.Pivot.closePreventPanel(a)},a)}),e("#"+a._id+"_btnOk").ejButton({type:t.ButtonType.Button,width:"80px",enableRTL:a.model.enableRTL,click:t.proxy(function(){var i,l,r,o,s,n,d;if(""!=e.trim(a.element.find("#"+a._id+"_captionFieldCM").val())&&""!=e.trim(a.element.find("#"+a._id+"_expressionFieldCM").val()))if("Custom"!=a.element.find("#"+a._id+"_formatFieldCM").val()||""!=e.trim(a.element.find("#"+a._id+"_customFormatFieldCM").val())){if(t.isNullOrUndefined(a._selectedCalcMember))for(i=0;i<a._calcMembers.length;i++)if(e.trim(a.element.find("#"+a._id+"_captionFieldCM").val()).toLowerCase()==a._calcMembers[i].name.toLowerCase()){if(!confirm(a._getLocalizedLabels("Confirm")))return;a._selectedCalcMember=e.trim(a.element.find("#"+a._id+"_captionFieldCM").val())}if(a._calcMemberDialog.close(),t.Pivot.closePreventPanel(a),l="",t.isNullOrUndefined(a._selectedCalcMember)||(s=t.DataManager(a._calcMembers).executeLocal(t.Query().where("name","equal",a._selectedCalcMember,!0)),!t.isNullOrUndefined(s)&&s.length>0&&(l=s[0].tag)),a._waitingPopup.show(),r={action:"calculatedMember",olapReport:a.currentReport,clientReports:a.reports,caption:a.currentCubeName+"%"+e.trim(a.element.find("#"+a._id+"_captionFieldCM").val()),expression:e.trim(a.element.find("#"+a._id+"_expressionFieldCM").val()),memberType:a.element.find("#"+a._id+"_memberTypeFieldCM").val(),dimension:a.element.find("#"+a._id+"_dimensionFieldCM").val(),formatString:"Custom"==a.element.find("#"+a._id+"_formatFieldCM").val()?e.trim(a.element.find("#"+a._id+"_customFormatFieldCM").val()):a.element.find("#"+a._id+"_formatFieldCM").val(),uniqueName:l,customObject:a.model.customObject},a.model.operationalMode==t.Pivot.OperationalMode.ServerMode)a.doAjaxPost("POST",a.model.url+"/"+a.model.serviceMethodSettings.calculatedMember,JSON.stringify(r),a._calcMemberDroppedSuccess);else{r.caption=r.caption.replace("%",""),o="",o=r.memberType.toLowerCase().indexOf("measure")>-1?"[Measures].["+e.trim(r.caption)+"]":e(jQuery("[id*='["+r.dimension+"]']")[0]).attr("data-defaulthierarchy")+".["+e.trim(r.caption)+"]",s={caption:r.caption,expression:r.expression,tag:o,hierarchyUniqueName:"["+e.trim(r.dimension)+"].["+e.trim(r.dimension)+"]",memberType:r.memberType,formatString:r.formatString?r.formatString:r.format?r.format:null},-1==r.memberType.toLowerCase().indexOf("measure")&&null!=a._selectedCalcMember&&(t.Pivot.getReportItemByFieldName(this._schemaData._selectedFieldName,this.model.dataSource).item.hierarchyUniqueName=s.hierarchyUniqueName),a._selectedCalcMember=null;var h={id:r.caption,pid:"_0",name:r.caption,hasChildren:!1,spriteCssClass:"e-calcMemberCDB e-icon",tag:o,expression:r.expression,formatString:null,nodeType:0,hierarchyUniqueName:"Measure"==r.memberType?"":s.hierarchyUniqueName},c=!1,p=s.caption;a.model.calculatedMembers=e.grep(a.model.calculatedMembers,function(e){return e.caption==p&&(c=!0,e.caption=s.caption,e.expression=s.expression,e.hierarchyUniqueName=s.hierarchyUniqueName,e.memberType=r.memberType,e.formatString=r.formatString),e}),"_0"!=(n=a.element.find(".e-schemaFieldTree").data("ejTreeView").model.fields).dataSource[0].id&&n.dataSource.splice(0,0,{id:"_0",name:"Calculated Members",hasChildren:!0,spriteCssClass:"e-calcMemberGroupCDB e-icon",tag:""}),c?(d=this._schemaData._selectedFieldName,n.dataSource=e.grep(n.dataSource,function(e){return e.id==d&&(e.expression=s.expression,e.hierarchyUniqueName=s.hierarchyUniqueName,e.expression=s.expression,e.memberType=s.memberType,e.formatString=s.formatString),e})):a.model.calculatedMembers.push(s),c?a.refreshControl():n.dataSource.push(h),t.Pivot._refreshFieldList(a)}}else t.Pivot._createErrorDialog(a._getLocalizedLabels("EmptyFormat"),a._getLocalizedLabels("Warning"),a);else t.Pivot._createErrorDialog(a._getLocalizedLabels("EmptyField"),a._getLocalizedLabels("Warning"),a)},a)}),a.element.find("#"+a._id+"_cubeTreeViewCalcMember").ejTreeView({fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:r},allowDragAndDrop:!0,enableRTL:a.model.enableRTL,allowDropChild:!1,allowDropSibling:!1,dragAndDropAcrossControl:!0,cssClass:"calcMemberTreeViewDragedNode",nodeDropped:t.proxy(function(t){null!=t.target&&t.target.attr("id")==a._id+"_expressionFieldCM"&&a.element.find("#"+a._id+"_expressionFieldCM").val(a.element.find("#"+a._id+"_expressionFieldCM").val()+e(t.droppedElement).attr("data-tag"))},a),beforeExpand:t.proxy(t.Pivot._getMemberChildNodes,a)}),a.element.find("#"+a._id+"_captionFieldCM").ejMaskEdit({name:"inputbox",inputMode:t.InputMode.Text,watermarkText:"",maskFormat:"",textAlign:a.model.enableRTL?"right":"left",width:"100%"}),a.element.find("#"+a._id+"_customFormatFieldCM").ejMaskEdit({name:"inputbox",inputMode:t.InputMode.Text,watermarkText:"",maskFormat:"",textAlign:a.model.enableRTL?"right":"left",width:"100%",cssClass:"e-calcMemberCustomFormat"}),a.element.find(".e-calcMemberCustomFormat").css("visibility","hidden"),a.element.find("#"+a._id+"_memberTypeFieldCM").ejDropDownList({dataSource:[{text:"Measure",value:"Measure"},{text:"Dimension",value:"Dimension"}],enableRTL:a.model.enableRTL,width:"100%",selectedIndex:0,change:t.proxy(function(e){"Dimension"==e.text?a.element.find(".e-calcMemberDimensionField").css("visibility","visible"):a.element.find(".e-calcMemberDimensionField").css("visibility","hidden")},a)}),o=t.DataManager(r).executeLocal(t.Query().where("spriteCssClass","contains","e-dimensionCDB")),s=[],p=0;p<o.length;p++)s.push({text:o[p].name,value:o[p].name});for(a.element.find("#"+a._id+"_dimensionFieldCM").ejDropDownList({dataSource:s,selectedIndex:0,width:"100%",enableRTL:a.model.enableRTL,cssClass:"e-calcMemberDimensionField"}),a.element.find(".e-calcMemberDimensionField").css("visibility","hidden"),a.element.find("#"+a._id+"_formatFieldCM").ejDropDownList({dataSource:[{text:"Standard",value:"Standard"},{text:"Currency",value:"Currency"},{text:"Percent",value:"Percent"},{text:"Custom",value:"Custom"}],enableRTL:a.model.enableRTL,selectedIndex:0,width:"100%",enableRTL:a.model.enableRTL,change:t.proxy(function(e){"Custom"==e.text?a.element.find(".e-calcMemberCustomFormat").css("visibility","visible"):a.element.find(".e-calcMemberCustomFormat").css("visibility","hidden")},a)}),n=a.element.find(".e-cubeTreeViewCalcMember").find("li"),p=0;p<n.length;p++)t.isNullOrUndefined(e(n[p]).attr("id"))||e(n[p]).attr("data-tag",t.DataManager(r).executeLocal(t.Query().where("id","equal",e(n[p]).attr("id")))[0].tag);for(d=a.element.find(".e-cubeTreeViewCalcMember .e-folderCDB"),p=0;p<d.length;p++)e(d[p].parentElement).removeClass("e-draggable");if(a.element.find(".e-cubeTreeViewCalcMember .calcMemberGroupCDB").length>0&&a.element.find(".e-cubeTreeViewCalcMember .calcMemberGroupCDB").parent().removeClass("e-draggable"),a._calcMemberTreeObj=a.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView"),!t.isNullOrUndefined(a._selectedCalcMember)&&(h={},(h=a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.DataManager(a._calcMembers).executeLocal(t.Query().where("name","equal",a._selectedCalcMember)):t.DataManager(a.model.calculatedMembers).executeLocal(t.Query().where("caption","equal",a._selectedCalcMember))).length>0)){if(c=0,c=a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?h[0].nodeType:h.length>0&&h[0].memberType&&("dimension"==h[0].memberType||"Dimension"==h[0].memberType)?1:0,a.element.find("#"+a._id+"_captionFieldCM").val(h[0].caption||h[0].name),a.element.find("#"+a._id+"_expressionFieldCM").val(h[0].expression),a.element.find("#"+a._id+"_memberTypeFieldCM").data("ejDropDownList").selectItemsByIndices(c),1==c){var O=(a.model.operationalMode==t.Pivot.OperationalMode.ServerMode?h[0].tag:h[0].hierarchyUniqueName).split(".")[0].replace(/\[/g,"").replace(/\]/g,""),T=a.element.find("#"+a._id+"_dimensionFieldCM").data("ejDropDownList").model.dataSource;for(p=0;p<T.length;p++)T[p].value==O&&a.element.find("#"+a._id+"_dimensionFieldCM").data("ejDropDownList").selectItemsByIndices(p)}t.isNullOrUndefined(h[0].formatString)||("Standard"==h[0].formatString?a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(0):"Currency"==h[0].formatString?a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(1):"Percent"==h[0].formatString?a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(2):(a.element.find("#"+a._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(3),a.element.find("#"+a._id+"_customFormatFieldCM").val(h[0].formatString)))}a._waitingPopup.hide()},_refreshFieldList:function(i){var l,a,r,o,s,n=i.element.find(".e-schemaFieldTree").data("ejTreeView");for(n.refresh(),l=n.model.fields.dataSource,a=i.element.find(".e-schemaFieldTree li"),r=0;r<e(a).length;r++)o=e(e(a)[r]).attr("id"),(s=e.map(l,function(e){if(e.id==o)return{tag:e.tag,expression:e.expression,defaultHierarchy:e.defaultHierarchy}})).length>0&&""!=s[0]&&(e(e(a)[r]).attr("data-tag",s[0].tag),t.isNullOrUndefined(s[0].expression)||e(e(a)[r]).attr("expression",s[0].expression),t.isNullOrUndefined(s[0].defaultHierarchy)||e(e(a)[r]).attr("data-defaultHierarchy",s[0].defaultHierarchy))},_getMemberChildNodes:function(i){var l,a,r;if((e(i.currentElement).find("a > span")[0].className.indexOf("level")>-1||e(i.currentElement).find("a > span")[0].className.indexOf("member")>-1)&&(l=t.DataManager(this._calcMemberTreeObj.dataSource()).executeLocal(t.Query().where("pid","equal",e(i.currentElement).attr("id")).where("name","equal","(Blank)")),!t.isNullOrUndefined(l)&&l.length>0))if(this._calcMemberTreeObj.hideNode(l[0].id),this.pNode=i.currentElement,this._waitingPopup.show(),a=e(i.currentElement).find("a > span")[0].className.indexOf("level")>-1?"level":"member",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var o=this.model.dataSource,s=this.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView"),n=e.map(s.model.fields.dataSource,function(t){if(t.id==e(i.currentElement).attr("id"))return t});if(e(i.currentElement).children("ul").children().length>1)this._waitingPopup&&this._waitingPopup.hide();else{n.length>0&&(this._calcExpanded=n[0]);var d="select {"+e(i.currentElement).attr("data-tag")+".members}dimension properties CHILDREN_CARDINALITY, MEMBER_TYPE on 0 from ["+e.trim(o.cube)+"]",h=t.olap._mdxParser.getSoapMsg(d,o.data,o.catalog),c=t.olap.base._getConnectionInfo(o.data);this.doAjaxPost("POST",c.url,{XMLA:h},t.proxy(this._generateCalculatedMember,this),null,{action:"fetchMembers"})}}else null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"fetchMemberChildNodes",element:this.element,customObject:this.model.customObject}),r=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMemberTreeNodes,JSON.stringify({action:"fetchMemberChildNodes",dimensionName:e(i.currentElement).attr("data-tag")+":"+a+":"+e(i.currentElement).attr("id"),olapReport:this.currentReport,customObject:r}),t.proxy(t.Pivot._fetchMemberSuccess,this))},_fetchMemberSuccess:function(a){var r,o,s;for(r=a.length>1&&a[0]!=l?JSON.parse(a[0].Value):a.d!=l?JSON.parse(a.d[0].Value):JSON.parse(a.MemberChildNodes),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"fetchMemberChildNodes",element:this.element,customObject:this.model.customObject}),this._calcMemberTreeObj.model.beforeExpand=null,this._calcMemberTreeObj.addNode(r,e(this.pNode)),o=t.DataManager(this._calcMemberTreeObj.dataSource()).executeLocal(t.Query().where("pid","equal",e(this.pNode).attr("id")).where("name","equal","(Blank)")),!t.isNullOrUndefined(o)&&o.length>0&&this._calcMemberTreeObj.removeNode(o[0].id),e.each(e(this.pNode).children().find("li"),function(e,t){t.setAttribute("data-tag",r[e].tag)}),s=e(this.pNode).children().find("li"),i=0;i<s.length;i++)1==r[i].hasChildren&&(this._calcMemberTreeObj.addNode({id:r[i].id+"_Blank_"+i,name:"(Blank)",parentId:r[i].id},s[i]),this.element.find("#"+r[i].id).find("> div > div:first").removeClass("e-process"),this._calcMemberTreeObj.collapseNode(this.element.find("#"+r[i].id)));this._calcMemberTreeObj.model.beforeExpand=t.proxy(t.Pivot._getMemberChildNodes,this),this._waitingPopup.hide()},_drillThroughCellClick:function(l,a){var r,o,s,n,d,h,c;if(a._waitingPopup.show(),s=e(l.currentTarget.parentElement).attr("data-p"),a.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)(o=e(a.element).parents(".e-pivotclient").length>0||e(a.element).parents(".e-maximumView").length>0?a._pivotClientObj:a).doAjaxPost("POST",o.model.url+"/"+o.model.serviceMethodSettings.drillThroughDataTable,JSON.stringify({currentReport:JSON.parse(a.getOlapReport()).Report,layout:a.model.layout,cellPos:s,selector:"",customObject:JSON.stringify(o.model.customObject)}),function(e){o._trigger("drillThrough",{element:a.element,data:e})});else{for(n=e("#"+a._id).find("tbody").find("tr:first").find("th").length,i=0;i<n;i++)-1!=(d=-1!=a.getJSONRecords()[parseInt(i*a._rowCount+parseInt(s.split(",")[1]))].Info.indexOf("Measures")||a.getJSONRecords()[parseInt(i*a._rowCount+parseInt(s.split(",")[1]))].RowSpan<=1?a.getJSONRecords()[parseInt(i*a._rowCount+parseInt(s.split(",")[1]))].Info.split("::")[0]:"").indexOf("Measures")&&(r=d),""!=d&&(a._rowHeader[i]=d);for(h=e("#"+a._id).find("tbody").find('[data-p="'+parseInt(s.split(",")[0])+","+parseInt(s.split(",")[1])+'"]').closest("tbody").prev().children("tr").length,i=0;i<h;i++)-1!=(c=-1!=a.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*a._rowCount+i)].Info.indexOf("Measures")||a.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*a._rowCount+i)].ColSpan<=1?a.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*a._rowCount+i)].Info.split("::")[0]:"").indexOf("Measures")&&(r=c),""!=c&&(a._colHeader[i]=c);for((t.isNullOrUndefined(a._fieldData)||!t.isNullOrUndefined(a._fieldData)&&t.isNullOrUndefined(a._fieldData.hierarchy))&&a._getFieldItemsInfo(a),j=0;j<a._fieldData.measures.length;j++)r==a._fieldData.measures[j].id&&(a.measureGrp=a._fieldData.measures[j].pid);a._rowHeader=e.grep(a._rowHeader,function(e){return 0==e||e}),a._colHeader=e.grep(a._colHeader,function(e){return 0==e||e}),a._createDrillThroughQuery("",a)}},openHierarchySelector:function(e,i){var l,a,r;e.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._createDrillThroughDialog(e,i):(e._waitingPopup.show(),a=(l=e.target.className.indexOf("e-pivotclient")>=0?e._pivotGrid:e)._getConnectionInfo(e.model.dataSource.data),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_MEASUREGROUP_DIMENSIONS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+e.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.model.dataSource.cube+"</CUBE_NAME><MEASUREGROUP_NAME>"+l.measureGrp+"</MEASUREGROUP_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+a.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>",this.doAjaxPost("POST",a.url,{XMLA:r},l._loadDimensionElements,null,{pvtGridObj:l,action:"loadMeasureElements"}))},_createDrillThroughDialog:function(i,l){var a,r,o,s;i.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&l.shift(),i.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove();var n=t.buildTag("label#",i._getLocalizedLabels("SelectHierarchy"))[0].outerHTML,d="<div class=e-cubeTable style='width:200px; overflow:auto'><div valign=\"bottom\">"+this._createHierarchyBrowser()+"</div></div>",h=t.buildTag("div#dropDlg.dropDlg",'<table class="e-outerTable"><tr><td>'+d+"</td><td>"+n+"<br><textarea id='hrSel' style='width:270px; height:300px; resize:none; margin:0px 5px 0 5px'></textarea></br><br></td></tr></table>")[0].outerHTML+"</br>",c=t.buildTag("div",t.buildTag("button#btnOK.dialogBtnOK",i._getLocalizedLabels("OK")).attr("title",i._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML+t.buildTag("button#btnCancel.dialogBtnCancel",i._getLocalizedLabels("Cancel")).attr("title",i._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,{float:"right",margin:"-5px 0 6px"})[0].outerHTML,p=t.buildTag("div#clientDialog.e-clientDialog",h+c,{opacity:"1"}).attr("title","Hierarchy Selector")[0].outerHTML;for(e(p).appendTo("#"+i._id),e("#btnOK, #btnCancel").ejButton(),e("#btnOK, #btnCancel").css({margin:"0 20px 20px 0",width:"50px"}),i.element.find(".e-clientDialog").ejDialog({width:550,target:"#"+i._id,enableResize:!1,enableRTL:i.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,i)}),i.element.find(".cubeTreeViewHierarchy").ejTreeView({showCheckbox:!0,fields:{id:"id",parentId:"pid",text:"name",isChecked:"isSelected",spriteCssClass:"spriteCssClass",dataSource:i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.isNullOrUndefined(l.d)?e.parseJSON(l):e.parseJSON(l.d):l},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:!!i.model.enableRTL,beforeDelete:function(){return!1},dragAndDropAcrossControl:!0,nodeDropped:t.proxy(this._hierarchyNodeDropped,i)}),i._tableTreeObj=i.element.find(".cubeTreeViewHierarchy").data("ejTreeView"),i._tableTreeObj.element.find(".e-ul").css({width:"100%",height:"100%"}),i._tableTreeObj.element.find(".e-chkbox-wrap").remove(),a=i._tableTreeObj.element.find("li"),r=0;r<a.length;r++)o=i.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.isNullOrUndefined(l.d)?e.parseJSON(l)[r].tag:e.parseJSON(l.d)[r].tag:l[r].tag,a[r].setAttribute("data-tag",o);i._tableTreeObj&&i._tableTreeObj.element.find("li").mouseover(t.proxy(function(t){e(t.target).parent().find(".e-measureGroupCDB, .e-dimensionCDB, .e-folderCDB").length>0&&e(t.target).css("cursor","default")},i)),s=i,e("#btnOK").click(function(){var i=e("#hrSel").val();e(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog, .drilltableDialog").remove(),s._waitingPopup.show(),t.olap._mdxParser._createDrillThroughQuery(i,s),s._waitingPopup.hide()}),e("#btnCancel").click(function(){e(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),s._waitingPopup.hide()}),i.model.enableRTL&&(e(".e-dialog").addClass("e-rtl"),e(".dialogBtnCancel").css("margin","0 -70px 0 0"))},_createHierarchyBrowser:function(){return t.buildTag("div.cubeBrowserHierarchy",t.buildTag("div.cubeTreeViewHierarchy")[0].outerHTML,{width:"200px",height:"300px",overflow:"auto"})[0].outerHTML},_hierarchyNodeDropped:function(i){var l,a,r;if("hrSel"==i.dropTarget[0].id&&(l=e(e(i.droppedElement).children()[0]).find(".e-dimensionCDB").length>0?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement).find("li:first").attr("data-tag"):e(i.droppedElement).find("li:first")[0].id:0==e(i.droppedElement).find("li:first").length?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement.parent().parent()).attr("data-tag"):e(i.droppedElement.parent().parent())[0].id:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(i.droppedElement).attr("data-tag"):i.droppedElementData.id,!t.isNullOrUndefined(l))){for(l=l.replace("[","[$"),a=0;a<e("#hrSel").val().split(",").length;a++)if(l==e("#hrSel").val().split(",")[a])return!1;0!=(r=this.element.find("#hrSel").val()).length?(r=r+","+l,this.element.find("#hrSel").val(r)):this.element.find("#hrSel").val(l)}},_generateDrillData:function(t,i){for(var l=e(i).find("row").children(),a=e.map(l,function(e){var t=e.textContent;return'"'+e.tagName.replace(/_x005B_/g,"[").replace(/_x0020_/g," ").replace(/_x005D_/g,"]").replace(/_x0024_/g,"$").replace("].[","]-[")+'":"'+t+'"'}),r=a[0],o="",s=0;s<a.length;s++)a[s]!=r?o+=","+a[s]:o+=""==o?"[{"+a[s]:"}, {"+a[s];o+="}]",e(t.pvtGridObj.element).parents(".e-pivotclient").length>0?e(t.pvtGridObj.element).parents(".e-pivotclient").data("ejPivotClient")._trigger("drillThrough",{element:t.pvtGridObj.element,data:o}):t.pvtGridObj._trigger("drillThrough",{element:t.pvtGridObj.element,data:o})},_getFilterStateMember:function(i,l,a,r,o){if("include"==a.filterItems.filterType)if(1==a.filterItems.values.length)if(t.isNullOrUndefined(r._fieldSelectedMembers[a.fieldName.toLowerCase()])&&i){var s="select {"+a.filterItems.values[0]+"}dimension properties CHILDREN_CARDINALITY on 0 from ["+e.trim(r.model.dataSource.cube)+"]",n=t.olap._mdxParser.getSoapMsg(s,r.model.dataSource.data,r.model.dataSource.catalog),d=t.olap.base._getConnectionInfo(r.model.dataSource.data);this.doAjaxPost("POST",d.url,{XMLA:n},t.proxy(this._getInitialSlicerName,this),null,{controlObject:r,action:"fetchMembers"}),o=r._slicerName}else i||(o=a.filterItems.values[0]);else o=r._getLocalizedLabels("MultipleItems");else o=l.length-(-1==a.filterItems.values.indexOf("All")?a.filterItems.values.length:a.filterItems.values.length-1)==1?l.filter(function(e){if(-1==a.filterItems.values.indexOf(e))return e}):r._getLocalizedLabels("MultipleItems");return o},_getFilterState:function(i,a,r,o){var s,n,d="";if(o.model.operationalMode==t.Pivot.OperationalMode.ClientMode)i?(t.isNullOrUndefined(t.olap.base.olapCtrlObj)&&(t.olap.base.olapCtrlObj=o),("All"==o._fieldSelectedMembers[r.fieldName.toLowerCase()]||t.isNullOrUndefined(o._fieldSelectedMembers[r.fieldName.toLowerCase()]))&&t.olap._mdxParser.getAllMember(o.model.dataSource,r.fieldName,o),d="All"==o._fieldSelectedMembers[r.fieldName.toLowerCase()]||t.isNullOrUndefined(o._fieldSelectedMembers[r.fieldName.toLowerCase()])?o._allMember:o._fieldSelectedMembers[r.fieldName.toLowerCase()],d=this._getFilterStateMember(i,a,r,o,d)):d=this._getFilterStateMember(i,a,r,o,d);else if(o.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if((s=t.isNullOrUndefined(o._tempFilterData)?[]:e.map(o._tempFilterData,function(e){return e[r.DimensionName]})).length>0&&o._fieldMembers[r.DimensionName])d=o._fieldMembers[r.DimensionName].length-s.length==1?o._fieldMembers[r.DimensionName].filter(function(e){if(-1==s.indexOf(e))return e}):o._getLocalizedLabels("MultipleItems");else if(t.isNullOrUndefined(o._clientReportCollection))d=o._getLocalizedLabels("All");else for(n=0;n<o._clientReportCollection.length;n++){if(!t.isNullOrUndefined(o._clientReportCollection[n]._fieldSelectedMembers)&&(""==o._currentRecordName&&o.element.find("#reportList")!=l&&o.element.find("#reportList")[0].value==o._clientReportCollection[n].name||""!=o._currentRecordName&&o._currentReportName==o._clientReportCollection[n].name)){o._fieldSelectedMembers[r.Tag]=o._clientReportCollection[n]._fieldSelectedMembers[r.DimensionName],d="All"==o._fieldSelectedMembers[r.Tag]||o._fieldSelectedMembers[r.Tag]==l?o._getLocalizedLabels("All"):o._fieldSelectedMembers[r.Tag];break}d=o._getLocalizedLabels("All")}else d=("All"==o._fieldSelectedMembers[r.Tag]?r.AllMember:o._fieldSelectedMembers[r.Tag])||r.AllMember;return d},_getInitialSlicerName:function(t,i){t.controlObject._slicerName=e(e(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},_getTreeViewItems:function(t){for(var i,l=t.element.find(".e-editorTreeView"),a=[],r=e(l).find(":input.nodecheckbox"),o=0;o<r.length;o++)i=e(r[o]).parents("li:eq(0)"),a.push({Id:i[0].id,name:e(i[0]).find("a:eq(0)").text()});return a},_getEditorMember:function(i,l,a){var r,o,s,n=a?l._schemaData._editorTreeData:l._editorTreeData,d=[];if(l.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if(0==n.length){var h=this._getTreeViewItems(a?l._schemaData:l,n),c=e.extend(!0,[],a?l._schemaData._memberTreeObj.dataSource():l._memberTreeObj.dataSource()),p=e.map(h,function(i){if("All"!=i.Id)return e.map(c,function(e){i.Id==e.id&&((i=e).name=t.isNullOrUndefined(i.parentId)?i.name+"_1":i.name)}),i}),u=e.map(p,function(t){return e.map(p,function(e){t.parentId==e.id&&(t.name=t.name+"_"+(Number(e.name.split("_")[e.name.split("_").length-1])+1))}),t});e.map(u,function(e){var t=e.name.split("_")[e.name.split("_").length-2],i=Number(e.name.split("_")[e.name.split("_").length-1]),l=e.checkedStatus;d.push({name:t,checked:l,level:Number(i)})})}else e.map(n,function(e){d.push({name:e.name,id:e.id,pid:e.pid,checked:e.checkedStatus,level:e.level})});return this._updateEditorMembers(i,d,l,n)}if(l.model.analysisMode==t.Pivot.AnalysisMode.Olap)return r=a?l._schemaData.element.find(".e-editorTreeView"):l.element.find(".e-editorTreeView"),u=n.length>0?n:e(r).find(":input.nodecheckbox"),n.length>0?e.map(u,function(e){d.push({name:e.name,id:e.id,pid:e.pid,checked:e.checkedStatus,level:Number(e.id.split("_")[e.id.split("_").length-1])})}):e.map(u,function(t){if("All"!=e(t).parents("li:eq(0)").attr("id")){var i=e(t).parent().siblings("a").text(),l=t.value.split("_")[t.value.split("_").length-1],a=!(!t.checked&&"mixed"!=e(t.parentElement).attr("aria-checked"));d.push({name:i,checked:a,level:Number(l)})}}),this._updateEditorMembers(i,d,l,n);for(o=[],s=1;s<i.length;s++)o.push(e(i[s].parentElement).siblings("a").text());return o},_updateEditorMembers:function(i,l,a,r){var o,s,n,d,h,c;if(l.length>0&&"All"==l[0].name&&l.splice(0,1),!t.isNullOrUndefined(a._fieldMembers[i]))if(0==r.length){var p=[],u=0,m="",g=a._fieldMembers[i];for(o=0;o<l.length;o++)if(t.isNullOrUndefined(g[o+u])||l[o].level==g[o+u].level)p.push(l[o]);else if(t.isNullOrUndefined(g[o+u])||l[o].level<g[o+u].level){n=o;do{l[o-1].checked&&p.push(g[n]),u++,n++}while(l[o].level<g[n].level);o--}else if(t.isNullOrUndefined(g[o+u])||l[o].level>g[o+u].level){s=g[o+u].level,n=o;do{p.push(l[n]),u--,o=++n-1}while(l[n].level>s)}a._fieldMembers[i]=p}else d=e.extend(!0,[],a._fieldMembers[i]),h=[],e.each(l,function(e,t){for(var i=!1,l=0;l<d.length;l++)if(t.id==d[l].id){d.splice(l,1,t),i=!0;break}i||h.push(t)}),a._fieldMembers[i]=d.concat(h);a._fieldMembers[i]=t.isNullOrUndefined(a._fieldMembers[i])?l:a._fieldMembers[i];var f=1,b="",_="",v=[];do{if(c=e.map(a._fieldMembers[i],function(e){if(e.level==f)return e}),v=e.map(c,function(e){if(e.checked)return e}),c.length==v.length)m=1==f?"All":b,c.length>1&&(_="All"),f++;else if(1==v.length)b=m="All"==_?"multiple":v[0].name,f++;else if(v.length>1&&c.length>v.length){m="multiple";break}}while(v.length>0&&"All"!=m&&"multiple"!=m&&e.map(a._fieldMembers[i],function(e){if(e.level==f)return e}).length>0);return m},_getTreeData:function(e,i,l){var a=t.olap.base._getConnectionInfo(e.url),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME>"+("loadcubelist"==l.action?"":"<CUBE_NAME>"+e.cube+"</CUBE_NAME>")+"</RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog><LocaleIdentifier>"+a.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>";l.action="loadFieldElements",this.doAjaxPost("POST",a.url,{XMLA:r},i,null,l)},updateTreeView:function(i){var l,a,r,o,s,n,d=i.element.find(".e-editorTreeView").find("li"),h=d.length,c=i._memberTreeObj.dataSource(),p=c.length;if(i.element.find(".e-editorTreeView").parents("#"+i._id+"_ClientDialog").find(".e-editorPara").text()==i._getLocalizedLabels("KPIs"))for(s=0;s<h;s++)for(l=e(d[s]).find("span:first").attr("aria-checked"),n=0;n<p;n++)d[s].id!=c[n].id||"mixed"!=l&&"true"!=l?d[s].id==c[n].id&&"false"==l&&(t.isNullOrUndefined(c[n].parentId)?c[n].checkedStatus=!1:e(d[s].parentElement).parent().attr("id")==c[n].parentId&&(c[n].checkedStatus=!1)):t.isNullOrUndefined(c[n].parentId)?c[n].checkedStatus=!0:e(d[s].parentElement).parent().attr("id")==c[n].parentId&&(c[n].checkedStatus=!0);else for(s=0;s<h;s++)for(l=e(d[s]).find("span:first").attr("aria-checked"),n=0;n<p;n++){if(d[s].id==c[n].id&&("mixed"==l||"true"==l)){c[n].checkedStatus=!0;break}if(d[s].id==c[n].id&&"false"==l){c[n].checkedStatus=!1;break}}for(s=0;s<c.length;s++)if(a=!1,1==c[s].checkedStatus){for(n=0;n<c.length;n++)if(c[n].hasOwnProperty("parentId")&&c[n].parentId==c[s].id&&1==c[n].checkedStatus){a=!0;break}if(!a)for(r=0;r<c.length;r++)c[r].hasOwnProperty("parentId")&&c[r].parentId==c[s].id&&(c[r].checkedStatus=!0)}else if(0==c[s].checkedStatus)for(o=0;o<c.length;o++)c[o].hasOwnProperty("parentId")&&c[o].parentId==c[s].id&&(c[o].checkedStatus=!1);for(s=0;s<h;s++)if(null==e(d[s]).attr("data-tag"))for(n=0;n<p;n++)if(e(d[s]).attr("id")==c[n].id){e(d[s]).attr("data-tag",c[n].tag);break}return i._memberTreeObj},getNodesState:function(e){for(var t="",i="",l="ejTreeView"==e.pluginName?e.dataSource():e,a=0;a<l.length;a++)1==l[a].checkedStatus?t+="::"+l[a].id+"||"+l[a].tag+"||"+(l[a].parentId||l[a].pid)+"||"+l[a].name:i+="::"+(l[a].parentId||l[a].pid)+"||"+l[a].tag+"||"+l[a].name;return{selectedNodes:t,unSelectedNodes:i}},removeParentSelectedNodes:function(t){for(var i,a=e.extend([],t),r=0;r<t.length;r++)for(i=0;i<a.length;i++)a[i].Id==t[r].parentId&&a.splice(i,1);return e.map(a,function(e){if(""!=e.tag&&e.tag!=l)return e.tag.replace(/\&/g,"&amp;")})},getChildNodes:function(i,a,r,o,s){var n,d,h,c=i.targetElement,p=(o.cube,o.catalog,o.data,s._generateChildMembers,e(i.currentElement).find("li").length),u=!1,m={memberEditorPageSize:"ejPivotSchemaDesigner"==s.pluginName?s.model.pivotControl.model.memberEditorPageSize:s.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==s.pluginName?s.model.pivotControl.model.enableMemberEditorPaging:s.model.enableMemberEditorPaging};if(m.enableMemberEditorPaging){for(n=0;n<s._memberTreeObj.dataSource().length;n++)if(s._memberTreeObj.dataSource()[n].parentId==i.id||s._memberTreeObj.dataSource()[n].pid==i.id)return i.isChildLoaded=!0,void t.Pivot.closePreventPanel(s)}else s._isSearchApplied=!1;if(jQuery.each(s._editorTreeData,function(e,t){if(t.id==i.id)return t.expanded=!0,t.isChildMerged=!0,!1}),0==p){var g=t.buildTag("span.nodeExpand e-load e-icon")[0].outerHTML,f=e(c).parents("li:eq(0)").attr("id");e.map(r,function(i){var r,o,n,d;i.fieldName!=a||t.isNullOrUndefined(i.filterItems)||(r=i.filterItems,(t.isNullOrUndefined(s.model.pivotControl)?s.model.enableMemberEditorPaging:s.model.pivotControl.model.enableMemberEditorPaging)?(r=e.map(r,function(e){if(e.pid!=l&&e.pid==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"))return u=!0,e})).length>0&&1==u&&(o=t.Pivot._generateChildWithAncestors(s,e(c).parents("li:eq(0)"),m.enableMemberEditorPaging,m.memberEditorPageSize),m.enableMemberEditorPaging&&(r.length>=m.memberEditorPageSize||o.lstChildren.length>=m.memberEditorPageSize)?(s._isEditorDrillPaging=!0,s.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),s._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(s,e(c).parents("li:eq(0)")[0].id),n=o.allLvlLst.length>1&&o.lstChildren.length>=m.memberEditorPageSize?t.Pivot._getParentsTreeList(s,o.lstParents[0].id,s._editorTreeData):e.grep(s._editorTreeData,function(t){return t.id==e(c).parents("li:eq(0)")[0].id})[0],d={childNodes:o.allLvlLst.length>1&&o.lstChildren.length>=m.memberEditorPageSize?o.lstChildren:r,parentNode:n},t.Pivot._drillEditorTreeNode(d,s,m.memberEditorPageSize)):(e(c).parents("li:eq(0)").find(".nodeExpand").remove(),e(c).parents("li:eq(0)").removeClass("e-load"),e.each(r,function(e,t){delete t.parentId}),s._onDemandNodeExpand=!1,s._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(r,s,"ejPivotSchemaDesigner"==s.pluginName?s.model.pivotControl:s),e(c).parents("li:eq(0)")),s._onDemandNodeExpand=!1,s._memberTreeObj.model.nodeCheck=t.proxy(s._nodeCheckChanges,s),s._memberTreeObj.model.nodeUncheck=t.proxy(s._nodeCheckChanges,s),e.each(e(c).parents("li:eq(0)").find("li"),function(e,i){t.isNullOrUndefined(r[e])||i.setAttribute("data-tag",r[e].tag)}))):e.map(r,function(e){(e.parentId!=l&&e.parentId==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-")||e.pid!=l&&e.pid==f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-"))&&(u=!0)}))});i.isChildLoaded=!!u,u?jQuery.grep(s._editorTreeData,function(e){if(e.pid==i.id)return e}).length>10&&s.element.find("a.e-linkPanel").css("display","block"):(e(c).parents("li:eq(0)").prepend(g),e(c).parents("li:eq(0)").attr("data-tag")==l&&((d=e.map(r,function(e){if(e.fieldName==a)return e})[0])&&e.map(d.filterItems,function(t){t.id==e(c).parents("li:eq(0)").attr("id")&&e(c).parents("li:eq(0)").attr("data-tag",t.tag)})),h=e(c).parents("li:eq(0)").attr("data-tag").replace(/\&/g,"&amp;"),t.olap._mdxParser.getChildren(o,h,s))}},_getFilterParams:function(e,i,l){var a,r,o,s="";if("schemaValue"!=e){if(a="",!t.isNullOrUndefined(i))for(r=0;r<i.length;r++)if(!t.isNullOrUndefined(i[r][l]))for(o=0;o<i[r][l].length;o++)a+="##"+i[r][l][o];""!=a&&(s=e+"::"+l+"::FILTERED"+a)}return s},generateChildMembers:function(i,l){var a,r,o,s,n,d,h=e(l).find("Axis:eq(0) Tuple"),c=[],p=this;t.isNullOrUndefined(p.olapCtrlObj)||(p=p.olapCtrlObj);var u={memberEditorPageSize:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl.model.memberEditorPageSize:p.model.memberEditorPageSize,enableMemberEditorPaging:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl.model.enableMemberEditorPaging:p.model.enableMemberEditorPaging},m={currentReportItems:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl._currentReportItems:p._currentReportItems,savedReportItems:"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl._savedReportItems:p._savedReportItems},g=p.element.find("[data-tag='"+i.currentNode.replace(/&amp;/g,"&")+"']");for(r=0;r<h.length;r++){var f=e(e(l).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[0]).text(),b=""==e(e(l).find("Axis:eq(0) Tuple:eq("+r+")").children()).find("Caption").text()?"(Blank)":e(e(l).find("Axis:eq(0) Tuple:eq("+r+")").children()).find("Caption").text(),_={hasChildren:"0"!=e(h[r]).find("CHILDREN_CARDINALITY").text(),checkedStatus:"true"==e(e(g).find("input.nodecheckbox")[0]).parent().attr("aria-checked"),id:f.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_"),name:b,tag:f,level:parseInt(e(h[r]).find("LNum").text())};c.push(_)}c.length>0&&p.model.enableMemberEditorSorting&&null!=p._sortType&&(c=t.DataManager(c).executeLocal(t.Query().sortBy("name",p._sortType))),a=e(g).parents("li").length>1?e(g).parents("li").first():e(g).parents("li"),e(e(a).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1}),p._memberTreeObj=p.element.find(".e-editorTreeView").data("ejTreeView"),c.length>0&&(o="ejPivotGrid"==p.pluginName?p._selectedField:p._selectedFieldName,e.map(m.currentReportItems,function(i){i.fieldName!=o||t.isNullOrUndefined(i.filterItems)||(e.each(c,function(t,i){i.pid=e(g).attr("id")}),e.merge(i.filterItems,c),p._editorTreeData=i.filterItems)}),0==m.currentReportItems.length&&p._editorTreeData.concat(c)),g.find(".nodeExpand").remove(),g.find(".e-load").removeClass("e-load"),jQuery.each(p._editorTreeData,function(e,t){if(t.id==g[0].id)return t.expanded=!0,!1}),u.enableMemberEditorPaging?(s=t.Pivot._generateChildWithAncestors(p,g,u.enableMemberEditorPaging,u.memberEditorPageSize),c.length>=u.memberEditorPageSize||s.lstChildren.length>=u.memberEditorPageSize?(p._isEditorDrillPaging=!0,p.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),p._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(p,g[0].id),n=s.allLvlLst.length>1&&s.lstChildren.length>=u.memberEditorPageSize?t.Pivot._getParentsTreeList(p,s.lstParents[0].id,p._editorTreeData):e.grep(p._editorTreeData,function(e){return e.id==g[0].id})[0],d={childNodes:s.allLvlLst.length>1&&s.lstChildren.length>=u.memberEditorPageSize?s.lstChildren:c,parentNode:n},t.Pivot._drillEditorTreeNode(d,p,u.memberEditorPageSize)):p._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(c,p,"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl:p),e(g))):p._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(c,p,"ejPivotSchemaDesigner"==p.pluginName?p.model.pivotControl:p),e(g)),e.each(g.find("li"),function(e,i){t.isNullOrUndefined(c[e])||i.setAttribute("data-tag",c[e].tag)}),m.savedReportItems=e.extend(!0,[],m.currentReportItems)},_generateChildWithAncestors:function(i,l,a,r){var o,s,n=[],d=[e.grep(i._editorTreeData,function(e){return e.id==l[0].id})[0]],h=[];if(a){jQuery.each(i._editorTreeData,function(e,t){if(t.id==l[0].id)return t.expanded=!0,!1}),n.push(d[0]);do{for(o=[],h=[],s=0;s<d.length&&(e.each(i._editorTreeData,function(e,i){t.isNullOrUndefined(i.pid)||i.pid!=d[s].id||(i.expanded&&(o.push(i),n.push(i)),h.push(i))}),!(h.length>=r));s++)h=[];if(d=o.length>0&&h.length<r?o:d,h.length>=r)break}while(o.length>0)}return{allLvlLst:n,lstParents:d,lstChildren:h}},_makeAncestorsExpandable:function(e,i){var l=t.DataManager(e._editorTreeData).executeLocal(t.Query().where("id","equal",i));l.length>0&&(l[0].expanded=!0,i=l[0].pid),!t.isNullOrUndefined(i)&&l.length>0&&this._makeAncestorsExpandable(e,i)},_jsonToEngine:function(e){for(var i,l=e,a=[],r=0;r<l.length;r++)i=parseInt(l[r].Index.split(",")[0]),t.isNullOrUndefined(a[i])?(a[i]=[],a[i].push(l[r])):a[i].push(l[r]);return a},_cropJson:function(i,l){var a,r,o,s,n,d,h,c,p=0,u=0,m=1;if(r=(a=i.model.operationalMode==t.Pivot.OperationalMode.ServerMode?{columns:JSON.parse(i.getOlapReport()).PivotColumns,rows:JSON.parse(i.getOlapReport()).PivotRows,values:JSON.parse(i.getOlapReport()).PivotCalculations}:{columns:i.model.dataSource.columns,rows:i.model.dataSource.rows,values:i.model.dataSource.values}).columns.length+(a.values.length>0&&"rows"!=a.values[0].axis?1:0),o=a.rows.length+(a.values.length>0&&"rows"==a.values[0].axis?1:0),r=0==r?1:r,o=0==o?1:o,""==i._drillAction&&i.model.enableCollapseByDefault){if(f=e.extend(!0,[],t.Pivot._jsonToEngine(l)),r+o>2){for(;u<f[0].length;)if(a.rows.length>1&&-1==f[0][u].CSS.indexOf("summary")&&u+m>r||0==a.columns.length&&0==a.values.length&&-1==f[0][u].CSS.indexOf("summary")||u>0&&m<a.columns.length){for(s=0;s<f.length;s++)f[s].splice(u,1);m++}else u++;for(m=1;p<f.length;)a.columns.length>1&&-1==f[p][0].CSS.indexOf("summary")&&p+m>o||0==a.rows.length&&0==a.values.length&&-1==f[p][0].CSS.indexOf("summary")||p>0&&m<a.rows.length?(f.splice(p,1),m++):p+=f[p][0].CSS.indexOf("summary")>-1?f[p][0].ColSpan:1}for((f=e.map(f,function(t){return[e.map(t,function(e){return("summary rstot"==e.CSS||"summary cstot"==e.CSS||"summary stot"==e.CSS)&&(e.State=2,e.Value=e.Value.replace("Total","")),e})]}))[0][0].ColSpan="none"==f[0][0].CSS&&a.values.length>0&&"rows"==a.values[0].axis&&a.rows.length>0?2:1,f[0][0].RowSpan="none"==f[0][0].CSS&&a.values.length>0&&"rows"!=a.values[0].axis&&a.columns.length>0?2:1,r=a.values.length>0&&"rows"==a.values[0].axis?a.values.length:1,o=a.values.length>0&&"rows"!=a.values[0].axis?a.values.length:1,p=0;p<f[0].length;p++)f[0][p].CSS.indexOf("summary")>-1&&(f[0][p].RowSpan=r,f[0][p].ColSpan=1);for(p=0;p<f.length;p++)f[p][0].CSS.indexOf("summary")>-1&&(f[p][0].ColSpan=o,f[p][0].RowSpan=1);return e.map(f,function(e){return e})}if(i.model.enableCollapseByDefault||""!=i._drillAction){var g=0,f=e.extend(!0,[],t.Pivot._jsonToEngine(i._croppedJson)),b=e.extend(!0,[],t.Pivot._jsonToEngine(i._compJson)),_=e.extend(!0,[],i._compJson),v=""==i._drillParams.currRow?"column":"row";for(n=0;n<i._compJson.length&&0==parseInt(i._compJson[n].Index.split(",")[0]);n++)g++;return d=t.Pivot._getDrillRange(a,v,i,g,_),h=t.Pivot._sliceJson(a,v,r,o,i,_,d.startPos,d.endPos,g,f),"drilldown"==i._drillAction&&(c=t.Pivot._mergeJson(a,i,v,r,o,_,b,f,h,d.startPos,d.endPos,g)),e.map("drilldown"==i._drillAction?c:h,function(e){return e})}return l},_getEnginePos:function(i,l,a){var r=e.map(t.isNullOrUndefined(a[parseInt(i.split(",")[0])])?a[parseInt(l.split(",")[0])]:a[parseInt(i.split(",")[0])],function(e,t){if(e.Index==e.Index.split(",")[0]+","+l.split(",")[1])return t})[0];return{colPos:e.map(a,function(t,i){var a=!1;return e.each(t,function(e,t){t.Index==l&&(a=!0)}),a?i:void 0})[0],rowPos:r}},_mergeJson:function(i,l,a,r,o,s,n,d,h,c,p,u){var m,g,f,b,_,v,C=t.Pivot._getIndices(a,s,l,d,c,p,u),S=C.columnIndices,O=C.rowIndices,T=C.rowSpan,y=C.colSpan,x=t.Pivot._getEnginePos(c,p,d),M=x.colPos,P=x.rowPos,w=[];if("row"==a){if(t.isNullOrUndefined(d[parseInt(c.split(",")[0])+1])){m=parseInt(c.split(",")[0])+1;do{w=e.map(n[m],function(e){if(O.indexOf(parseInt(e.Index.split(",")[1]))>-1)return e.Span="Block",e}),d[m]=w,m++}while(m<y&&!l.model.enableCollapseByDefault)}}else if(parseInt(d[0][parseInt(c.split(",")[1])+1].Index.split(",")[1])!=parseInt(c.split(",")[1])+1)for(v=0;v<n.length;v++){m=parseInt(c.split(",")[1])+1;do{g=n[v][m],S.indexOf(parseInt(g.Index.split(",")[0]))>-1&&(g.Span="Block",d[v].splice(m,0,g)),m++}while(m<T&&!l.model.enableCollapseByDefault)}if("row"==a){for(_=0,v=0;v<d.length;v++)if(!t.isNullOrUndefined(d[v])){f=P,b=0;do{f==P&&d[v].splice(f,1,h[_][b]),f++,b++,d[v].splice(f,0,h[_][b])}while(t.isNullOrUndefined(h[_][b])||parseInt(h[_][b].Index.split(",")[1])<parseInt(p.split(",")[1]));_++}}else for(_=h.length-1,v=M;v>=o;v--)t.isNullOrUndefined(h[_])||d.splice(v,1,h[_]),_--;return t.Pivot._drillSpanCalculation(d,l)},_getIndices:function(i,l,a,r,o,s,n){var d,h=e.map(r,function(e){if(!t.isNullOrUndefined(e))return parseInt(e[0].Index.split(",")[0])}),c=e.map(r[0],function(e){if(!t.isNullOrUndefined(e))return parseInt(e.Index.split(",")[1])});if(a.model.enableCollapseByDefault)"row"==i?h.push(parseInt(o.split(",")[0])+1):c.push(parseInt(o.split(",")[1])+1);else{var p=l[parseInt(s.split(",")[0])*n+parseInt(s.split(",")[1])],u=parseInt(p.Index.split(",")[0]),m=parseInt(p.Index.split(",")[1]),g=p.ColSpan,f=p.RowSpan;if("row"==i)for(d=u+1;d<g;d++)-1==h.indexOf(d)&&h.push(d);else for(d=m+1;d<f;d++)-1==c.indexOf(d)&&c.push(d)}return{columnIndices:h,rowIndices:c,colSpan:g,rowSpan:f}},_sliceJson:function(i,l,a,r,o,s,n,d,h,c){var p,u,m,g,f,b,_,v,C,S,O,T,y=[],x=i.values.length>0&&"rows"!=i.values[0].axis?1:0;if("drilldown"==o._drillAction){var M="row"==l?"0,"+parseInt(n.split(",")[1]):parseInt(n.split(",")[0])+",0",P="row"==l?"0,"+parseInt(d.split(",")[1]):parseInt(d.split(",")[0])+",0",w=t.Pivot._getIndices(l,s,o,c,n,d,h),L=w.columnIndices,N=w.rowIndices,D=parseInt(M.split(",")[0])*h+h,R=0;M="row"==l?M:parseInt(M.split(",")[0])*h+",0";do{for(p="row"==l?parseInt(M.split(",")[1]):parseInt(M.split(",")[0]),R="row"==l?0:R;!t.isNullOrUndefined(s[p])&&("column"!=l||D>p);)("row"==l?L.indexOf(parseInt(s[p].Index.split(",")[0]))>-1:N.indexOf(parseInt(s[p].Index.split(",")[1]))>-1)&&(t.isNullOrUndefined(y[R])&&(y[R]=[]),y[R].push(s[p]),"row"==l&&R++),p+="row"==l?h:1;"column"==l&&(D+=h,R++),M="row"==l?"0,"+(parseInt(M.split(",")[1])+1):parseInt(M.split(",")[0])+h+",0"}while(M!=("row"==l?"0,"+(parseInt(P.split(",")[1])+1):(parseInt(P.split(",")[0])+1)*h+",0"));if(("row"==l?r-1>parseInt(o._drillParams.currPos.split(",")[0])+1:a-x-1>parseInt(o._drillParams.currPos.split(",")[1])+1)&&o.model.enableCollapseByDefault){E="row"==l?0:parseInt(o._drillParams.currPos.split(",")[1])+1,j="row"==l?parseInt(o._drillParams.currPos.split(",")[0])+1:0;do{if(u=!1,!(t.isNullOrUndefined(y[j])||t.isNullOrUndefined(y[j][E])||-1!=y["row"==l?j-1:j]["row"==l?E:E-1].CSS.indexOf("summary")||"rowheader"!=y[j][E].CSS&&"colheader"!=y[j][E].CSS&&"none"!=y[j][E].CSS&&""!=y[j][E].Value))if("row"==l)for(T=0;T<y.length;T++)t.isNullOrUndefined(y[T])||(y[T].splice(E,1),u=!0);else delete y[j],u=!0;"row"==l?E=u?E:E+1:j+=1}while("row"==l?E<y[0].length:j<y.length)}var j=parseInt(o._drillParams.currPos.split(",")[0])+("row"==l?1:0),I="",F=0,A=0,E=parseInt(o._drillParams.currPos.split(",")[1])+1;if(o.model.enableCollapseByDefault)do{if("row"==l?j==parseInt(o._drillParams.currPos.split(",")[0])+1:E==parseInt(o._drillParams.currPos.split(",")[1])+1){for(T="row"==l?y[j].length-1:y.length-1;T>=0;T--)if(("column"!=l||!t.isNullOrUndefined(y[T]))&&(v="row"==l?y[j][T]:y[T][E]).CSS.indexOf("summary")>-1){v.State=2,v.Expander=1;var k=j,H=E,V=0;if("row"==l){do{V++,k++}while(!t.isNullOrUndefined(c[k])&&("none"==c[k][0].CSS||""==c[k][0].Value));v.ColSpan=V}else{do{V++,H++}while(!t.isNullOrUndefined(c[0][H])&&("none"==c[0][H].CSS||""==c[0][H].Value));v.RowSpan=V}v.Value=v.Value.replace(" Total","")}}else for(m="","column"==l&&(m=e.map(y,function(e,i){if(!t.isNullOrUndefined(e))return i})[0]),T="row"==l?y[j].length-1:y.length-1;T>=0;T--)"column"==l&&t.isNullOrUndefined(y[T])||(g=(v="row"==l?y[j][T]:y[T][E]).Value.replace(" Total",""),I=""==I&&""!=v.Value.replace(" Total","")?v.Value.replace(" Total",""):""!=v.Value.replace(" Total","")&&I!=v.Value.replace(" Total","")?v.Value.replace(" Total",""):I,""!=g&&g!=I||0==T||m==T?(v.CSS="row"==l?"rowheader":"colheader",v.State=1,v.Expander=1,v.Value=I,"row"==l?v.RowSpan=j>parseInt(o._drillParams.currPos.split(",")[0])-1?F:v.RowSpan:v.ColSpan=E>parseInt(o._drillParams.currPos.split(",")[1])-1?A:v.ColSpan,F=1,A=1):(v.CSS.indexOf("summary")>-1&&("row"==l?v.ColSpan=parseInt(o._drillParams.currPos.split(",")[0])+2-j:v.RowSpan=parseInt(o._drillParams.currPos.split(",")[1])+2-E),F++,A++));"row"==l?j--:E--}while("row"==l?j>=0:E>=0)}else{var z=t.Pivot._getEnginePos(n,d,c);j=z.colPos,E=z.rowPos;if("row"==l){for(f=0,e.each(c[0],function(e,t){if(parseInt(t.Index.split(",")[1])==parseInt(n.split(",")[1]))return f=e,!1}),T=parseInt(n.split(",")[1]);T<parseInt(d.split(",")[1]);T++)for(b=0;b<c.length;b++)if(!t.isNullOrUndefined(c[b])){for(_="",v="",H=f;H<c[b].length;H++)if(parseInt(c[b][H].Index.split(",")[1])==T){v=c[b][H],_=H,c[b].splice(H,1);break}t.isNullOrUndefined(c[b][_])||"none"!=c[b][_].CSS&&""!=c[b][_].Value&&("rowheader"!=c[b][_].CSS||0!=c[b][_].Expander)||"rowheader"!=v.CSS||(c[b][_].CSS="rowheader",c[b][_].Value=v.Value,c[b][_].State=v.State,c[b][_].Expander=v.Expander)}}else for(C=[],T=parseInt(n.split(",")[0]);T<parseInt(d.split(",")[0]);T++)if(C=0!=C.length||t.isNullOrUndefined(c[T])?C:c[T],delete c[T],parseInt(d.split(",")[0])-T==1){S=0;do{("none"==c[T+1][S].CSS||""==c[T+1][S].Value||"colheader"==c[T+1][S].CSS&&0==c[T+1][S].Expander)&&(c[T+1][S].CSS=C[S].CSS,c[T+1][S].Value=C[S].Value,c[T+1][S].State=C[S].State,c[T+1][S].Expander=C[S].Expander),S++}while(S<=parseInt(d.split(",")[1]))}if(0==(O="row"==l?e.map(c[parseInt(d.split(",")[0])+1],function(e){if("rowheader"==e.CSS||e.CSS.indexOf("summary")>-1)return e}).length:e.map(c,function(e){if(!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(e[E+1])&&("colheader"==e[E+1].CSS||e[E+1].CSS.indexOf("summary")>-1))return e}).length))if("row"==l){j=parseInt(d.split(",")[0])+1;do{delete c[j],j++}while(!t.isNullOrUndefined(c[j])&&("none"==c[j][0].CSS||""==c[j][0].Value))}else{E=parseInt(d.split(",")[1])+1;do{for(T=0;T<c.length;T++)t.isNullOrUndefined(c[T])||(c[T]=e.map(c[T],function(e){if(parseInt(e.Index.split(",")[1])!=E)return e}));E++}while(E<c[0][0].RowSpan-(i.values.length>0&&"rows"!=i.values[0].axis?1:0))}if(j=(z=t.Pivot._getEnginePos(n,d,c)).colPos,E=z.rowPos,"row"==l){for(T=0;T<c[parseInt(d.split(",")[0])].length;T++)if(c[parseInt(d.split(",")[0])][T].Index==d){c[parseInt(d.split(",")[0])][T].Value=c[parseInt(d.split(",")[0])][T].Value.replace(" Total",""),c[parseInt(d.split(",")[0])][T].State=2,c[parseInt(d.split(",")[0])][T].ColSpan=0==O?c[parseInt(d.split(",")[0])][T].ColSpan-1:c[parseInt(d.split(",")[0])][T].ColSpan;break}}else c[j][E].Value=c[j][E].Value.replace(" Total",""),c[j][E].State=2,c[j][E].RowSpan=0==O?c[j][E].RowSpan-1:c[j][E].RowSpan;y=t.Pivot._drillSpanCalculation(c,o)}return y},_getDrillRange:function(i,l,a,r,o){var s,n,d=0,h=0,c="",p="",u=r,m="row"==l?a._drillParams.currRow.split(">#>"):a._drillParams.currCol.split(">#>");do{if((s="row"==l?parseInt((d-1)/r):h)+1==m.length){if((!("none"!=o[d].CSS&&""!=o[d].Value||t.isNullOrUndefined(o["row"==l?d-r:d-1])||"string"!=typeof o["row"==l?d-r:d-1].Value||o["row"==l?d-r:d-1].Value.replace(" Total","")!=e.trim(m[s<1?0:s-1]))||"string"==typeof o[d].Value&&""!=o[d].Value&&o[d].Value.replace(" Total","")!=e.trim(m[s]))&&""!=c){for(n="row"==l?d-1:d-r;!t.isNullOrUndefined(o[n])&&"summary rstot"!=o[n].CSS&&"summary cstot"!=o[n].CSS&&"summary stot"!=o[n].CSS;)n="row"==l?n-1:n-r;t.isNullOrUndefined(o[n])||(p=o[n].Index);break}"string"==typeof o[d].Value&&o[d].Value.replace(" Total","")==e.trim(m[s])&&(c=""==c?o[d].Index:c)}else o[d].Value.replace(" Total","")==e.trim(m[s])&&(d="row"==l?u*(s+1)+(d-1):d-u+1);h=(d="row"==l?d+1:d+r)%r,"column"==l&&d>o.length&&(d=++h)}while(o.length>d&&""==p);return"drillup"==a._drillAction&&a.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&("column"==l&&i.values.length>0&&"row"!=i.values[0].axis?p=parseInt(p.split(",")[0])-(i.values.length-1)+","+p.split(",")[1]:"row"==l&&i.values.length>0&&"row"==i.values[0].axis&&(p=p.split(",")[0]+","+(parseInt(p.split(",")[1])-(i.values.length-1)))),{startPos:c,endPos:p}},_drillSpanCalculation:function(i,l){for(var a,r,o,s,n,d=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotCalculations:l.getOlapReport().values,h=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotColumns:l.getOlapReport().columns,c=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotRows:l.getOlapReport().rows,p=[],u=[],m=e.map(i,function(e){if(!t.isNullOrUndefined(e))return e[0]}).length,g=0;g<i[0].length;g++){for(y=0,a=0,n=0;n<i.length;n++)t.isNullOrUndefined(i[n])||t.isNullOrUndefined(i[n][g])||(y++,i[n][g].ColSpan>m-y+1&&(i[n][g].ColSpan=m-y+1),"none"!=i[n][g].CSS&&""!=i[n][g].Value&&a++);0==a&&p.push(g)}for(g=0;g<i.length;g++)t.isNullOrUndefined(i[g])||(r=e.map(i[g],function(e,t){if(-1==p.indexOf(t))return e.RowSpan>=i[g].length-t&&(e.RowSpan=i[g].length-t),"summary value"==e.CSS&&(e.RowSpan=1,e.ColSpan=1),e}),u[g]=r);i=u;var f=h.length+(d.length>0&&"rows"!=d[0].axis?d.length:0),b=c.length+(d.length>0&&"rows"==d[0].axis?d.length:0),_=-1;do{_++}while(!(t.isNullOrUndefined(i[0])||t.isNullOrUndefined(i[0][_])||"none"!=i[0][_].CSS&&""!=i[0][_].Value));i[0][0].RowSpan=_>f?f:_,_=d.length>0&&"rows"!=d[0].axis?_-1:_,o=-1,s=0;do{o++}while(!t.isNullOrUndefined(i[o])&&("none"==i[o][0].CSS||""==i[o][0].Value));for(i[0][0].ColSpan=o>b?b:o,g=0;g<i[0].length;g++)for(y=d.length>0&&"rows"==d[0].axis?1:0,n=0;n<i[0][0].ColSpan;n++)t.isNullOrUndefined(i[n][g])||(y++,(0!=g||0!=n)&&i[n][g].ColSpan>i[0][0].ColSpan-y+1&&i[0][0].ColSpan-y+1>0&&(i[n][g].ColSpan=i[0][0].ColSpan-y+1));for(g=i[0][0].ColSpan-1;g<i.length;g++)if(y=d.length>0&&"rows"!=d[0].axis?1:0,!t.isNullOrUndefined(i[g]))for(n=0;n<i[0][0].RowSpan;n++)y++,(0!=g||0!=n)&&i[g][n].RowSpan>i[0][0].RowSpan-y+1&&i[0][0].RowSpan-y+1>0&&(i[g][n].RowSpan=i[0][0].RowSpan-y+1);if(!t.isNullOrUndefined(c)&&c.length>1){o=d.length>0&&"rows"==d[0].axis?o-1:o;do{i[s]=e.map(i[s],function(e){return e.CSS.indexOf("summary")>-1&&(e.ColSpan=o-s),e});var v=0,C=!1,S="";for(g=i[s].length-1;g>=i[0][0].RowSpan;g--)"summary rstot"==i[s][g].CSS||"summary stot"==i[s][g].CSS?(t.isNullOrUndefined(i[s][g+1])||"rowheader"!=i[s][g+1].CSS||(i[s][g+1].RowSpan=v),v=0,C=!0,S=""):i[0][0].RowSpan-g==0?i[s][g].RowSpan=C||S==i[s][g].Value?v+1:i[s][g].RowSpan:(S=i[s][g].Value,v++);s++}while(o>s+(d.length>0&&"rows"==d[0].axis?1:0))}if(!t.isNullOrUndefined(h)&&h.length>1){s=0;do{for(g=0;g<i.length;g++)!t.isNullOrUndefined(i[g])&&i[g][s].CSS.indexOf("summary")>-1&&(i[g][s].RowSpan=_-s);var O=0,T=(C=!1,""),y=(S="",e.grep(i,function(e,i){if(!t.isNullOrUndefined(e)&&"none"!=e[0].CSS&&""!=e[0].Value)return T=""==T?i:T,e}).length);for(g=i.length-1;g>=T;g--)y-=t.isNullOrUndefined(i[g])||"none"==i[g][0].CSS||""==i[g][0].Value?0:1,t.isNullOrUndefined(i[g])||"summary cstot"!=i[g][s].CSS&&"summary stot"!=i[g][s].CSS?0!=y||t.isNullOrUndefined(i[g])?t.isNullOrUndefined(i[g])||(S=i[g][s].Value,O++):i[g][s].ColSpan=C||S==i[g][s].Value?O+1:i[g][s].ColSpan:(t.isNullOrUndefined(i[g+1])||t.isNullOrUndefined(i[g+1][s])||"rowheader"!=i[g+1][s].CSS&&"colheader"!=i[g+1][s].CSS||(i[g+1][s].ColSpan=O),O=0,C=!0,S="");s++}while(_>s+(d.length>0&&"rows"!=d[0].axis?1:0))}return i},_calculatePagingSpan:function(i,l){var a,r;if(null!=i&&""!=i&&i.length>0){for(l._rowCount=0,a=jQuery.extend(!0,[],i),l._compJson=""==l._drillAction?jQuery.extend(!0,[],a):l._compJson,l._croppedJson=t.Pivot._cropJson(l,a),a=e.extend(!0,[],l._croppedJson),r=0;r<a.length&&0==parseInt(a[r].Index.split(",")[0]);r++)l._rowCount++;var o=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotRows.length:l.getOlapReport().rows.length,s=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotColumns.length:l.getOlapReport().columns.length,n=l.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(l.getOlapReport()).PivotCalculations.length:l.getOlapReport().values.length;a.length,l._rowCount;for(r=(0==a[0].RowSpan?0:a[0].RowSpan-1)+l.model.dataSource.pagerOptions.seriesPageSize;r<a.length&&r<l._rowCount;r+=l.model.dataSource.pagerOptions.seriesPageSize){if(a[r].CSS.indexOf("summary")>-1||a[r].CSS.indexOf("rowheader")>-1&&0==a[r].Expander&&null!=a[r+l._rowCount]&&a[r+l._rowCount].CSS.indexOf("value")>-1)continue;o>1&&t.Pivot._calculateRowPagingSpan(r,a,1,o,l)}for(r=((0==a[0].ColSpan?0:a[0].ColSpan-1)+l.model.dataSource.pagerOptions.categoricalPageSize)*l._rowCount;r<a.length;r+=l.model.dataSource.pagerOptions.categoricalPageSize*l._rowCount){if(a[r].CSS.indexOf("summary")>-1&&n<=1)continue;if(1==l.model.dataSource.pagerOptions.categoricalPageSize&&(a[r].CSS.indexOf("stot")>-1&&null!=a[r+l._rowCount]&&a[r+l._rowCount].CSS.indexOf("gtot")>-1||a[r].CSS.indexOf("gtot")>-1&&null==a[r+l._rowCount]))continue;t.Pivot._calculateColumnPagingSpan(r,a,1,s,n,l)}l._relPagingRecords=jQuery.extend(!0,[],a),l._rowCount=0}},_generatePagingRecords:function(i){var l,a,r,o,s;if(null!=i._relPagingRecords&&i._relPagingRecords.length>0){for(l=e.extend(!0,[],i._relPagingRecords),i._rowCount=0,m=0;m<l.length&&0==parseInt(l[m].Index.split(",")[0]);m++)i._rowCount++;var n=l.length/i._rowCount,d=0==l[0].RowSpan?0:l[0].RowSpan-1,h=0==l[0].ColSpan?0:l[0].ColSpan-1,c=Math.ceil((n-(h+1))/i.model.dataSource.pagerOptions.categoricalPageSize),p=Math.ceil((i._rowCount-(d+1))/i.model.dataSource.pagerOptions.seriesPageSize);i.model.dataSource.pagerOptions.categoricalCurrentPage=i.model.dataSource.pagerOptions.categoricalCurrentPage>c?c:i.model.dataSource.pagerOptions.categoricalCurrentPage,i.model.dataSource.pagerOptions.seriesCurrentPage=i.model.dataSource.pagerOptions.seriesCurrentPage>p?p:i.model.dataSource.pagerOptions.seriesCurrentPage,i._seriesPageCount=i.model.enablePaging?i._rowCount-(d+1):p,i._categPageCount=i.model.enablePaging?n-(h+1):c,i._categCurrentPage=i.model.dataSource.pagerOptions.categoricalCurrentPage,i._seriesCurrentPage=i.model.dataSource.pagerOptions.seriesCurrentPage;var u,m,g,f,b,_,v,C,S,O,T=[],y=d+1+i.model.dataSource.pagerOptions.seriesPageSize,x=h+1+i.model.dataSource.pagerOptions.categoricalPageSize;for(u=m=g=f=b=_=v=C=S=O=0,o=0;o<d+1;o++){for(s=0;s<h+1;s++)null!=l[m]&&(T[f]=l[m],m+=i._rowCount,f+=y);m=++u,f=++g}for(b=m=d+(0==i.model.dataSource.pagerOptions.seriesCurrentPage||1==i.model.dataSource.pagerOptions.seriesCurrentPage?0:(i.model.dataSource.pagerOptions.seriesCurrentPage-1)*i.model.dataSource.pagerOptions.seriesPageSize)+1,_=f=d+1,o=0;o<i.model.dataSource.pagerOptions.seriesPageSize;o++){for(s=0;s<h+1;s++)null!=l[m]&&(T[f]=l[m],m+=i._rowCount,f+=y);if(f=++_,(m=++b)>i._rowCount-1)break}for(v=m=(h+1)*i._rowCount+(0==i.model.dataSource.pagerOptions.categoricalCurrentPage||1==i.model.dataSource.pagerOptions.categoricalCurrentPage?0:(i.model.dataSource.pagerOptions.categoricalCurrentPage-1)*i.model.dataSource.pagerOptions.categoricalPageSize*i._rowCount),C=f=(h+1)*y,o=0;o<d+1;o++){for(s=0;s<i.model.dataSource.pagerOptions.categoricalPageSize;s++)null!=l[m]&&(T[f]=l[m],m+=i._rowCount,f+=y);if(f=++C,null==l[m=++v])break}for(S=m=(h+1)*i._rowCount+(0==i.model.dataSource.pagerOptions.categoricalCurrentPage||1==i.model.dataSource.pagerOptions.categoricalCurrentPage?0:(i.model.dataSource.pagerOptions.categoricalCurrentPage-1)*i.model.dataSource.pagerOptions.categoricalPageSize*i._rowCount)+d+(0==i.model.dataSource.pagerOptions.seriesCurrentPage||1==i.model.dataSource.pagerOptions.seriesCurrentPage?0:(i.model.dataSource.pagerOptions.seriesCurrentPage-1)*i.model.dataSource.pagerOptions.seriesPageSize)+1,O=f=(h+1)*y+d+1,a=0,o=0;o<i.model.dataSource.pagerOptions.seriesPageSize;o++){for(s=0;s<i.model.dataSource.pagerOptions.categoricalPageSize;s++)null!=l[m]&&(T[f]=l[m],a=parseInt(l[m].Index.split(",")[1]),m+=i._rowCount,f+=y);if(f=++O,null==l[m=++S]||a>parseInt(l[m].Index.split(",")[1]))break}for(i._rowCount=0,T=T.filter(function(e){return null!=e}),y=0,m=0;m<T.length&&0==parseInt(T[m].Index.split(",")[0]);m++)y++;for(x=T.length/y,o=0;o<x;o++)for(s=0;s<y;s++)t.isNullOrUndefined(T[o*y+s])||(T[o*y+s].Index=o+","+s);for(r=t.Pivot._drillSpanCalculation(t.Pivot._jsonToEngine(T),i),o=0;o<r.length;o++)for(s=0;s<r[o].length;s++)r[o][s].Index=o+","+s;return e.map(r,function(e){return e})}},_calculateRowPagingSpan:function(e,i,l,a,r){var o,s;if(i[e].CSS.indexOf("summary")>-1||i[e].CSS.indexOf("rowheader")>-1&&0==i[e].Expander&&l<a&&null!=i[e+r._rowCount]&&i[e+r._rowCount].CSS.indexOf("value")>-1)return!1;if(1==i[e].Expander&&i[e].RowSpan>1)i[e+1].RowSpan=i[e].RowSpan-1,i[e].RowSpan=1,i[e+1].Expander=i[e].Expander,i[e+1].State=i[e].State,i[e+1].Value=i[e].Value,i[e+1].CSS=i[e].CSS,-1==i[e+r._rowCount].CSS.indexOf("value")&&l<a-1&&t.Pivot._calculateRowPagingSpan(e+r._rowCount,i,l+1,a,r);else if(0==i[e].Expander&&null!=i[e+r._rowCount]&&l<a&&-1==i[e+r._rowCount].CSS.indexOf("value"))for(o=1,s=e-1;s>=0;s--)if(o++,1==i[s].Expander){i[s].RowSpan!=o&&(i[e+1].RowSpan=i[s].RowSpan-o,i[s].RowSpan=o,i[e+1].Expander=i[s].Expander,i[e+1].State=i[s].State,i[e+1].Value=i[s].Value,i[e+1].CSS=i[s].CSS,-1==i[e+r._rowCount].CSS.indexOf("value")&&l<a-1&&t.Pivot._calculateRowPagingSpan(e+r._rowCount,i,l+1,a,r));break}},_calculateColumnPagingSpan:function(e,i,l,a,r,o){var s,n;if(i[e].CSS.indexOf("summary")>-1&&r<=1)return!1;if(null!=i[e+o._rowCount]&&(1==i[e].Expander&&i[e].ColSpan>1||i[e].CSS.indexOf("summary")>-1&&i[e].ColSpan>1||l==a&&r>1&&i[e].ColSpan>1))i[e+o._rowCount].ColSpan=i[e].ColSpan-1,i[e].ColSpan=1,i[e+o._rowCount].Expander=i[e].Expander,i[e+o._rowCount].RowSpan=i[e].RowSpan,i[e+o._rowCount].State=i[e].State,i[e+o._rowCount].Value=i[e].Value,i[e+o._rowCount].CSS=i[e].CSS,l<a&&-1==i[e].CSS.indexOf("summary")&&t.Pivot._calculateColumnPagingSpan(e+1,i,l+1,a,r,o);else if(0==i[e].Expander&&null!=i[e+o._rowCount]&&1!=i[e+o._rowCount].Expander)for(s=1,n=e-o._rowCount;n>=0;n-=o._rowCount)if(s++,1==i[n].Expander||i[n].CSS.indexOf("summary")>-1&&i[n].ColSpan>1||l==a&&r>1&&i[n].ColSpan>1){i[n].ColSpan!=s&&(i[e+o._rowCount].ColSpan=i[n].ColSpan-s,i[n].ColSpan=s,i[e+o._rowCount].RowSpan=i[n].RowSpan,i[e+o._rowCount].Expander=i[n].Expander,i[e+o._rowCount].State=i[n].State,i[e+o._rowCount].Value=i[n].Value,i[e+o._rowCount].CSS=i[n].CSS,l<a&&-1==i[n].CSS.indexOf("summary")&&t.Pivot._calculateColumnPagingSpan(e+1,i,l+1,a,r,o));break}},createAdvanceFilterTag:function(i,l){var a,r,o,s,n,d,h,c,p,u,m="",g=(t.buildTag("li.e-separator").css("margin-left","29px")[0].outerHTML,l.element.hasClass("e-pivotschemadesigner")?l.model.pivotControl.model.operationalMode:l.model.operationalMode),f=l.element.hasClass("e-pivotschemadesigner")?l.model.pivotControl.model.analysisMode:l.model.analysisMode;if("filterTag"==i.action)m=[{id:"ascOrder",text:l._getLocalizedLabels("SortAtoZ"),parentId:null,spriteCssClass:"e-ascImage e-icon"},{id:"descOrder",text:l._getLocalizedLabels("SortZtoA"),parentId:null,spriteCssClass:"e-descImage e-icon"},{id:"clearSorting",text:l._getLocalizedLabels("ClearSorting"),parentId:null,spriteCssClass:"e-clrSort e-icon"},{id:"sep1",parentId:null,text:"",spriteCssClass:"e-seperator"},{id:"clearAllFilters",text:l._getLocalizedLabels("ClearFilterFrom"),parentId:null,spriteCssClass:"e-clrFilter e-icon"},{id:"labelFilterBtn",text:l._getLocalizedLabels("LabelFilters"),parentId:null},{id:"valueFilterBtn",text:l._getLocalizedLabels("ValueFilters"),parentId:null},{id:"labelClearFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("ClearFilter"),spriteCssClass:"e-clrFilter e-icon"},{id:"sep2",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"equals_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("Equals"),spriteCssClass:"sprite"},{id:"notequals_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotEquals")+"...",spriteCssClass:"sprite"},{id:"sep3",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"beginswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("BeginsWith")+"...",spriteCssClass:"sprite"},{id:"notbeginswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotBeginsWith")+"...",spriteCssClass:"sprite"},{id:"endswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("EndsWith")+"...",spriteCssClass:"sprite"},{id:"notendswith",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotEndsWith")+"...",spriteCssClass:"sprite"},{id:"sep4",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"contains",parentId:"labelFilterBtn",text:l._getLocalizedLabels("Contains")+"...",spriteCssClass:"sprite"},{id:"notcontains",parentId:"labelFilterBtn",text:l._getLocalizedLabels("DoesNotContains")+"...",spriteCssClass:"sprite"},{id:"sep5",parentId:"labelFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"greaterthan_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("GreaterThan")+"...",spriteCssClass:"sprite"},{id:"greaterthanorequalto_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("GreaterThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"lessthan_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("LessThan")+"...",spriteCssClass:"sprite"},{id:"lessthanorequalto_labelFilter",parentId:"labelFilterBtn",text:l._getLocalizedLabels("LessThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"valueClearFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("ClearFilter"),spriteCssClass:"e-clrFilter e-icon"},{id:"sep6",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"equals_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("Equals"),spriteCssClass:"equals"},{id:"notequals_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("DoesNotEquals")+"...",spriteCssClass:"sprite"},{id:"sep7",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"greaterthan_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("GreaterThan")+"...",spriteCssClass:"sprite"},{id:"greaterthanorequalto_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("GreaterThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"lessthan_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("LessThan")+"...",spriteCssClass:"sprite"},{id:"lessthanorequalto_valueFilter",parentId:"valueFilterBtn",text:l._getLocalizedLabels("LessThanOrEqualTo")+"...",spriteCssClass:"sprite"},{id:"sep8",parentId:"valueFilterBtn",text:"",spriteCssClass:"e-seperator"},{id:"between",parentId:"valueFilterBtn",text:l._getLocalizedLabels("Between")+"...",spriteCssClass:"sprite"},{id:"notbetween",parentId:"valueFilterBtn",text:l._getLocalizedLabels("NotBetween")+"...",spriteCssClass:"sprite"},{id:"topCount",parentId:"valueFilterBtn",text:l._getLocalizedLabels("Top10")+"...",spriteCssClass:"sprite"}],(g==t.Pivot.OperationalMode.ClientMode||g==t.Pivot.OperationalMode.ServerMode&&f==t.Pivot.AnalysisMode.Pivot)&&m.splice(m.length-1,2);else if("clearFilter"==i.action)m=t.buildTag("div.clearSorting",t.buildTag("span.e-clrSort","",{padding:"0px 10px 0px 4px"}).addClass("e-icon").attr("aria-label","clear sort")[0].outerHTML+t.buildTag("span.clearSortText","Clear Sorting",{padding:"5px 0px"})[0].outerHTML)[0].outerHTML+t.buildTag("div.separator",{padding:"5px 0px"})[0].outerHTML+t.buildTag("div.clearAllFilters",t.buildTag("span.e-clrFilter","",{padding:"0px 10px 0px 4px"}).addClass("e-icon").attr("aria-label"," clear filter")[0].outerHTML+t.buildTag("span.clearFltrText",'Clear Filter From"'+i.selectedLevel.text+'"',{padding:"5px 0px"})[0].outerHTML)[0].outerHTML;else if("sort"==i.action)m=t.buildTag("div#sortDiv.sortDiv",t.buildTag("li#ascOrder.e-ascOrder",t.buildTag("span.e-ascImage").addClass("e-icon").attr("aria-label","ascending")[0].outerHTML+l._getLocalizedLabels("Sort")+" A to Z")[0].outerHTML+t.buildTag("li#descOrder.e-descOrder",t.buildTag("span.e-descImage").addClass("e-icon").attr("aria-label","descending")[0].outerHTML+l._getLocalizedLabels("Sort")+" Z to A")[0].outerHTML)[0].outerHTML;else if("labelFilterDlg"==i.action||"valueFilterDlg"==i.action){if(a="",r=[],"labelFilterDlg"==i.action)a=t.buildTag("table.labelfilter",t.buildTag("tr",t.buildTag("td",l._getLocalizedLabels("LabelFilterLabel")).attr("colspan","2")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'  style='width:220px'/>")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1'  value='"+(i.filterInfo.length>0?g==t.Pivot.OperationalMode.ClientMode?i.filterInfo[0].values[0]:i.filterInfo[0].value1:"")+"' style='display:inline; width:160px; height:19px; margin-left:7px;' class='e-filterValues'/></br>")[0].outerHTML)[0].outerHTML)[0].outerHTML,r=[{value:"equals",option:l._getLocalizedLabels("Equals").toLowerCase()},{value:"not equals",option:l._getLocalizedLabels("DoesNotEquals").toLowerCase()},{value:"begins with",option:l._getLocalizedLabels("BeginsWith").toLowerCase()},{value:"not begins with",option:l._getLocalizedLabels("DoesNotBeginsWith").toLowerCase()},{value:"ends with",option:l._getLocalizedLabels("EndsWith").toLowerCase()},{value:"not ends with",option:l._getLocalizedLabels("DoesNotEndsWith").toLowerCase()},{value:"contains",option:l._getLocalizedLabels("Contains").toLowerCase()},{value:"not contains",option:l._getLocalizedLabels("DoesNotContains").toLowerCase()},{value:"greater than",option:l._getLocalizedLabels("IsGreaterThan").toLowerCase()},{value:"greater than or equal to",option:l._getLocalizedLabels("IsGreaterThanOrEqualTo").toLowerCase()},{value:"less than",option:l._getLocalizedLabels("IsLessThan").toLowerCase()},{value:"less than or equal to",option:l._getLocalizedLabels("IsLessThanOrEqualTo").toLowerCase()}];else{if(o=[],n="between"==e(i.selectedArgs.element).attr("id")||"notbetween"==e(i.selectedArgs.element).attr("id")||"between"==i.selectedArgs.value||"not between"==i.selectedArgs.value?"4":"3",l.element.find(".e-cubeTreeView ").length>0)o=e.map(l.element.find(".e-cubeTreeView [data-tag*='[Measures]'] "),function(t){return{option:e(t).text(),value:e(t).attr("data-tag")}});else for(d=l.element.hasClass("e-pivotschemadesigner")?l.element.find(".e-schemaValue .e-pivotButton"):l.element.find(".groupingBarPivot .values .e-pivotButton"),d=l._schemaData&&0==d.length?e(l._schemaData.element.find(".e-schemaValue .e-pivotButton")):d,h=0;h<d.length;h++)o.push({option:e(d[h]).text(),value:e(d[h]).attr("data-tag").split(":")[1]});s=e(i.selectedArgs.element).hasClass("topCount")?t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions' />").attr("width","80px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterValue1' class='e-filterValues' />").attr("width","50px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML:t.buildTag("td","<input type='text' id='filterMeasures' class='filterMeasures' />").attr("width","180px")[0].outerHTML+t.buildTag("td","<input type='text' id='filterOptions' class='filterOptions'/>").attr("width","180px")[0].outerHTML+t.buildTag("td.filterValuesTd","<input type='text' id='filterValue1' value='"+(i.filterInfo.length>0?g==t.Pivot.OperationalMode.ClientMode?i.filterInfo[0].values[0]:i.filterInfo[0].value1:"")+"' style='display:inline; width:190px; height:19px;' class='e-filterValues'/>"+("4"==n?"<span>"+l._getLocalizedLabels("and")+" </span><input type='text' id='filterValue2' value='"+(i.filterInfo.length>0?g!=t.Pivot.OperationalMode.ClientMode||t.isNullOrUndefined(i.filterInfo[0].values[1])?g!=t.Pivot.OperationalMode.ServerMode||t.isNullOrUndefined(i.filterInfo[0].value2)?"":i.filterInfo[0].value2:i.filterInfo[0].values[1]:"")+"' style='display:inline; width:190px; height:19px;' class='e-filterValues'/> </br>":"</br>"))[0].outerHTML,a=t.buildTag("table.valuefilter",t.buildTag("tr",t.buildTag("td",l._getLocalizedLabels("ValueFilterLabel")).attr("colspan","Between"==i.text?"4":"3")[0].outerHTML)[0].outerHTML+t.buildTag("tr",s)[0].outerHTML)[0].outerHTML,r=[{value:"equals",option:l._getLocalizedLabels("Equals").toLowerCase()},{value:"not equals",option:l._getLocalizedLabels("DoesNotEquals").toLowerCase()},{value:"greater than",option:l._getLocalizedLabels("IsGreaterThan").toLowerCase()},{value:"greater than or equal to",option:l._getLocalizedLabels("IsGreaterThanOrEqualTo").toLowerCase()},{value:"less than",option:l._getLocalizedLabels("IsLessThan").toLowerCase()},{value:"less than or equal to",option:l._getLocalizedLabels("IsLessThanOrEqualTo").toLowerCase()},{value:"between",option:l._getLocalizedLabels("Between").toLowerCase()},{value:"not between",option:l._getLocalizedLabels("NotBetween").toLowerCase()}]}c=t.buildTag("div",t.buildTag("button#filterDlgOKBtn.e-dialogOKBtn",l._getLocalizedLabels("OK")).attr("title",l._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))[0].outerHTML+t.buildTag("button#filterDlgCancelBtn.e-dialogCancelBtn",l._getLocalizedLabels("Cancel")).attr("title",l._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,""))[0].outerHTML,{float:l.model.enableRTL?"left":"right",margin:"8px 0 6px"})[0].outerHTML,l.element.find(".e-dialog").remove(),e(t.buildTag("div#filterDialog.filterDialog",a+c,{opacity:"1"})).appendTo("#"+l._id),l.element.find(".filterDialog").ejDialog({enableRTL:l.model.enableRTL,enableResize:!1,cssClass:"e-labelValueFilterDlg",width:"auto",content:"#"+l._id,close:t.proxy(t.Pivot.closePreventPanel,l)}),"valueFilterDlg"==i.action&&(l.element.find(".filterMeasures").ejDropDownList({dataSource:o,width:"180px",height:"25px",fields:{text:"option",value:"value"},create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),l._measureDDL=l.element.find(".filterMeasures").data("ejDropDownList"),""!=(p=i.filterInfo.length>0&&!t.isNullOrUndefined(i.filterInfo[0].measure)?i.filterInfo[0].measure:o.length>0?o[0].value:"")&&l._measureDDL.selectItemByValue(p)),"topCount"==e(i.selectedArgs.element).attr("id")?(l.element.find("#filterOptions").ejDropDownList({dataSource:[{option:"Top",value:"topCount"},{option:"Bottom",value:"BottomCount"}],fields:{text:"option",value:"value"},value:i.filterInfo.length>0?i.filterInfo[0].operator:"topCount",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),l.element.find("#filterValue1").ejNumericTextbox({value:i.filterInfo.length>0?parseInt(i.filterInfo[0].value1):5,minValue:1})):(u=e(i.selectedArgs.element).parent().children('li:not([id^="sep"])').index(i.selectedArgs.element),l.element.find(".filterOptions").ejDropDownList({dataSource:r,width:"180px",height:"25px",fields:{value:"value",text:"option"},selectedIndices:[u-1],change:t.proxy(l._filterOptionChanged,l),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),0==e(i.selectedArgs.element).length&&l.element.find(".filterOptions").data("ejDropDownList").selectItemByValue(i.selectedArgs.selectedValue)),l.element.find("#filterDlgOKBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(l._filterElementOkBtnClick,l)}),l.element.find("#filterDlgCancelBtn").ejButton({type:t.ButtonType.Button,click:function(){e(".e-dialog").hide(),t.Pivot.closePreventPanel(l)}}),l.element.find(".e-titlebar").prepend(t.buildTag("div",("valueFilterDlg"==i.action?l._getLocalizedLabels("ValueFilters")+"(":l._getLocalizedLabels("LabelFilters")+"(")+(-1==l._selectedLevelUniqueName.indexOf(".")?l._selectedLevelUniqueName:l._selectedLevelUniqueName.indexOf(".")<0?l._selectedLevelUniqueName:l._selectedLevelUniqueName.split(".")[2].replace(/\[/g,"").replace(/\]/g,""))+")",{display:"inline"}))}return m}},t.Pivot.SortOrder={None:"none",Ascending:"ascending",Descending:"descending"},t.Pivot.AdvancedFilterType={LabelFilter:"label",ValueFilter:"value"},t.Pivot.ValueFilterOptions={None:"none",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.Pivot.LabelFilterOptions={None:"none",BeginsWith:"beginswith",NotBeginsWith:"notbeginswith",EndsWith:"endswith",NotEndsWith:"notendswith",Contains:"contains",NotContains:"notcontains",Equals:"equals",NotEquals:"notequals",GreaterThan:"greaterthan",GreaterThanOrEqualTo:"greaterthanorequalto",LessThan:"lessthan",LessThanOrEqualTo:"lessthanorequalto",Between:"between",NotBetween:"notbetween"},t.Pivot.AnalysisMode={Olap:"olap",Pivot:"pivot"},t.Pivot.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"}}(jQuery,Syncfusion)})},1011:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__;
/*!
*  filename: ej.pivotanalysis.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotanalysis.base.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(e){__WEBPACK_AMD_DEFINE_ARRAY__=[__webpack_require__(4)],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=e)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(function(){!function($,ej,undefined){ej.PivotAnalysis={_initProperties:function(){this._colkeyvalues=[],this._rowKeyValues=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._gridMatrix=null,this._rowTotCalc=[],this._colTotCalc=[],this._transposeEngine=[],this._tRowCnt=0,this._tColCnt=0,this._cellType="",this._valueFilterArray=ej.isNullOrUndefined(this._valueFilterArray)?[]:this._valueFilterArray,this._currentFilterVal={},this._fieldMembers={},this._summaryTypes=[],this._editCellsInfo=[],this._locale="en-US",this._valueSorting=ej.isNullOrUndefined(this._valueSorting)?null:this._valueSorting,this._sort=ej.isNullOrUndefined(this._sort)?null:this._sort,this._isPaging=!1,this._colHdrLen=1,this._rowHdrLen=1,this._rowMembers={},this._colMembers={},this._calcMembers={}},setFieldCaptions:function(e){$.each(e.rows,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.columns,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.filters,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)}),$.each(e.values,function(e,t){ej.isNullOrUndefined(t.fieldCaption)&&(t.fieldCaption=t.fieldName)})},getTreeViewData:function(e){var t,i,l,a,r,o,s=[],n=[];if(null!=e.data)for(l=0;l<e.data.length;l++)jQuery.each(e.data[l],function(e){-1==jQuery.inArray(e,s)&&s.push(e)});for(jQuery.each(e.values,function(e,t){1==t.isCalculatedField&&-1==jQuery.inArray(t.fieldName,s)&&s.push(t.fieldName)}),t=[e.rows,e.columns,e.filters,e.values],i=[].concat.apply([],t),l=0;l<s.length;l++){for(a=0;a<i.length;a++)(s[l].caption==undefined||""==s[l].caption)&&i[a].fieldName==s[l]&&(s[l]={name:i[a].fieldName,caption:i[a].fieldCaption,format:i[a].format,formatString:i[a].formatString,showSubTotal:!!ej.isNullOrUndefined(i[a].showSubTotal)||i[a].showSubTotal});(s[l].caption==undefined||""==s[l].caption)&&(s[l]={name:s[l].name||s[l],caption:s[l].name||s[l]})}for(r=0;r<s.length;r++)o=$.grep(e.rows,function(e){return e.fieldName==s[r].name}).length>0||$.grep(e.columns,function(e){return e.fieldName==s[r].name}).length>0||$.grep(e.values,function(e){return e.fieldName==s[r].name}).length>0||$.grep(e.filters,function(e){return e.fieldName==s[r].name}).length>0,n.push({id:s[r].name,name:s[r].name,caption:s[r].caption,format:s[r].format,formatString:s[r].formatString,showSubTotal:!!ej.isNullOrUndefined(s[r].showSubTotal)||s[r].showSubTotal,isSelected:o,spriteCssClass:""});return n},pivotEnginePopulate:function(model){var dataSource=model.dataSource,currentObj=this,isLiteral=!1,rowFilters,lit,formatSt,uV,fields,vC,list,cnt,nC,outputString,rC,cC,isFiltered,cCnt,rCnt,temp,value,val,j,k,formula,oldValue,newValue,i;this._initProperties(),model.dataSource.enableAdvancedFilter&&0==this._valueFilterArray.length&&(this._valueFilterArray=$.grep(dataSource.columns,function(e){if(e.advancedFilter&&e.advancedFilter.length>0&&e.advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter)return e.advancedFilter}),rowFilters=$.grep(dataSource.rows,function(e){if(e.advancedFilter&&e.advancedFilter.length>0&&e.advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter)return e.advancedFilter}),rowFilters.length>0&&$.merge(this._valueFilterArray,rowFilters)),this._locale=model.locale;var colAxis=dataSource.columns,rowAxis=dataSource.rows,filters=dataSource.filters,calcValues=dataSource.values,colLen,jsonObj=[],pivotFieldList=[],rowLen;for(lit=0;dataSource.values.length>lit;lit++)if(formatSt="",dataSource.values[lit].format&&(formatSt=dataSource.values[lit].format.toLowerCase()),"string"==formatSt||"text"==formatSt||"literal"==formatSt){isLiteral=!0;break}if(this._editCellsInfo=[],!ej.isNullOrUndefined(model.editCellsInfo)){var rowHeaders=model.editCellsInfo.rowHeader,colHeaders=model.editCellsInfo.columnHeader,values=model.editCellsInfo.JSONRecords;if(!ej.isNullOrUndefined(values)){for(uV=0;uV<values.length;uV++)fields={},rowAxis.length>0&&(fields.row=rowHeaders[uV].toString().split("#").splice(0,rowAxis.length).join(">#>")),colAxis.length>0&&(fields.column=colHeaders[uV].toString().split("#").splice(0,colAxis.length).join(">#>")),fields.value=colHeaders[uV].toString().split("#")[colHeaders[uV].toString().split("#").length-1]+"#"+values[uV].Value,this._editCellsInfo.push(fields);for(vC=0;vC<calcValues.length;vC++)$.each(this._editCellsInfo,function(e,t){calcValues[vC].fieldName==t.value.split("#")[0]&&(ej.PivotAnalysis._editCellsInfo[e].value=vC+"#"+t.value.split("#")[1])})}}for(i=0;i<calcValues.length;i++)this._summaryTypes.push(null!=calcValues[i].summaryType&&calcValues[i].summaryType!=undefined?calcValues[i].summaryType:ej.PivotAnalysis.SummaryType.Sum);if(null!=dataSource.data)for(cnt=0;cnt<dataSource.data.length;cnt++){list=jQuery.extend(!0,{},dataSource.data[cnt]);var table={keys:[],uniqueName:"",value:null},row={keys:[],uniqueName:"",value:null},col={keys:[],uniqueName:"",value:null},values={keys:[],uniqueName:"",value:null},isExcluded=!1;for(i=0;i<filters.length;i++)if(val=this._getReflectedValue(list,filters[i].fieldName,null,null),this._fieldMembers[filters[i].fieldName]==undefined||null==this._fieldMembers[filters[i].fieldName]?this._fieldMembers[filters[i].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[filters[i].fieldName])&&this._fieldMembers[filters[i].fieldName].push(val),null!=filters[i].filterItems&&filters[i].filterItems!=undefined&&((filters[i].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==filters[i].filterItems.filterType)&&$.inArray(val,filters[i].filterItems.values)>=0||filters[i].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,filters[i].filterItems.values)<0)){isExcluded=!0;break}for(nC=0;nC<calcValues.length;nC++)val="",calcValues[nC]!=undefined&&null!=calcValues[nC]&&(list[calcValues[nC].fieldName]=model.dataSource.isFormattedValues?this._getNumber($(list).prop(calcValues[nC].fieldName),calcValues[nC].formatString):list[calcValues[nC].fieldName],val=this._getReflectedValue(list,calcValues[nC].fieldName,calcValues[nC].format,calcValues[nC].formatString),this._fieldMembers[calcValues[nC].fieldName]==undefined||null==this._fieldMembers[calcValues[nC].fieldName]?this._fieldMembers[calcValues[nC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[calcValues[nC].fieldName])&&this._fieldMembers[calcValues[nC].fieldName].push(val)),outputString=null!=val?val.toString().replace(/([AMPME~!@#$%^&*()_+=`{}\[\]\|\\:;'<>,-.\/? ])+/g,""):"0",outputString=outputString.replace(ej.globalize.preferredCulture(this._locale).numberFormat.currency.symbol,""),$.isNumeric(outputString)||"date"==calcValues[nC].format?values.keys.push(null!=val?val:null):(values.keys.push(1),isLiteral&&(""==values.uniqueName&&(values.uniqueName=[]),ej.isNullOrUndefined(calcValues[nC].format)||"string"!=calcValues[nC].format.toLowerCase()&&"literal"!=calcValues[nC].format.toLowerCase()&&"text"!=calcValues[nC].format.toLowerCase()?values.uniqueName.push(" "):values.uniqueName.push(val)));for(rC=0;rC<rowAxis.length;rC++){if(val="",rowAxis[rC]!=undefined&&null!=rowAxis[rC])if(val=this._getReflectedValue(list,rowAxis[rC].fieldName,ej.isNullOrUndefined(rowAxis[rC].format)?null:rowAxis[rC].format,ej.isNullOrUndefined(rowAxis[rC].format)||ej.isNullOrUndefined(rowAxis[rC].formatString)?null:rowAxis[rC].formatString),this._fieldMembers[rowAxis[rC].fieldName]==undefined||null==this._fieldMembers[rowAxis[rC].fieldName]?this._fieldMembers[rowAxis[rC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[rowAxis[rC].fieldName])&&this._fieldMembers[rowAxis[rC].fieldName].push(val),dataSource.enableAdvancedFilter&&!ej.isNullOrUndefined(rowAxis[rC].advancedFilter)&&rowAxis[rC].advancedFilter.length&&rowAxis[rC].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.LabelFilter){if(isFiltered=this._applyLabelFilter(rowAxis[rC].advancedFilter,val),isFiltered){isExcluded=!0;break}}else if(null!=rowAxis[rC].filterItems&&rowAxis[rC].filterItems!=undefined&&((rowAxis[rC].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==rowAxis[rC].filterItems.filterType)&&$.inArray(val,rowAxis[rC].filterItems.values)>=0||rowAxis[rC].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,rowAxis[rC].filterItems.values)<0)){isExcluded=!0;break}null!=val&&val.toString().replace(/^\s+|\s+$/gm,"")||(val="(blank)"),row.keys.push(val),row.uniqueName+=""==row.uniqueName?val:">#>"+val,table.keys.push(val),table.uniqueName+=""==table.uniqueName?val:">#>"+val}for(cC=0;cC<colAxis.length;cC++){if(val="",colAxis[cC]!=undefined&&null!=colAxis[cC])if(val=this._getReflectedValue(list,colAxis[cC].fieldName,ej.isNullOrUndefined(colAxis[cC].format)?null:colAxis[cC].format,ej.isNullOrUndefined(colAxis[cC].format)||ej.isNullOrUndefined(colAxis[cC].formatString)?null:colAxis[cC].formatString),this._fieldMembers[colAxis[cC].fieldName]==undefined||null==this._fieldMembers[colAxis[cC].fieldName]?this._fieldMembers[colAxis[cC].fieldName]=[val]:-1==$.inArray(val,this._fieldMembers[colAxis[cC].fieldName])&&this._fieldMembers[colAxis[cC].fieldName].push(val),dataSource.enableAdvancedFilter&&!ej.isNullOrUndefined(colAxis[cC].advancedFilter)&&colAxis[cC].advancedFilter.length&&colAxis[cC].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.LabelFilter){if(isFiltered=this._applyLabelFilter(colAxis[cC].advancedFilter,val),isFiltered){isExcluded=!0;break}}else if(null!=colAxis[cC].filterItems&&colAxis[cC].filterItems!=undefined&&((colAxis[cC].filterItems.filterType==ej.PivotAnalysis.FilterType.Exclude||null==colAxis[cC].filterItems.filterType)&&$.inArray(val,colAxis[cC].filterItems.values)>=0||colAxis[cC].filterItems.filterType==ej.PivotAnalysis.FilterType.Include&&$.inArray(val,colAxis[cC].filterItems.values)<0)){isExcluded=!0;break}null!=val&&val.toString().replace(/^\s+|\s+$/gm,"")||(val="(blank)"),col.keys.push(val),col.uniqueName+=""==col.uniqueName?val:">#>"+val,table.keys.push(val),table.uniqueName+=""==table.uniqueName?val:">#>"+val}if(!isExcluded)if(this._isMemberExist("row",row,$.extend(!0,{},values),dataSource),this._isMemberExist("column",col,$.extend(!0,{},values),dataSource),!model.enablePaging&&!model.enableVirtualScrolling||0==row.keys.length&&0==col.keys.length)this._isMemberExist("calc",table,$.extend(!0,{},values),dataSource);else if(row.keys.length>0&&col.keys.length>0)for(rCnt=0;rCnt<row.keys.length;rCnt++)for(cCnt=0;cCnt<col.keys.length;cCnt++)row.keys.length==rCnt+1&&col.keys.length==cCnt+1?this._isMemberExist("calc",{keys:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)),uniqueName:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)),uniqueName:row.keys.slice(0,rCnt+1).concat(col.keys.slice(0,cCnt+1)).join(">#>"),value:null},$.extend(!0,{},values),dataSource);else if(0==row.keys.length)for(cCnt=0;cCnt<col.keys.length;cCnt++)col.keys.length==cCnt+1?this._isMemberExist("calc",{keys:col.keys.slice(0,cCnt+1),uniqueName:col.keys.slice(0,cCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:col.keys.slice(0,cCnt+1),uniqueName:col.keys.slice(0,cCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource);else for(rCnt=0;rCnt<row.keys.length;rCnt++)row.keys.length==rCnt+1?this._isMemberExist("calc",{keys:row.keys.slice(0,rCnt+1),uniqueName:row.keys.slice(0,rCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource):this._isMemberExist("calc",{cellType:"SubTot",keys:row.keys.slice(0,rCnt+1),uniqueName:row.keys.slice(0,rCnt+1).join(">#>"),value:null},$.extend(!0,{},values),dataSource)}for(i=0;i<calcValues.length;i++)if(temp=$.grep(calcValues,function(e){return 1==e.isCalculatedField}),calcValues[i].isCalculatedField&&temp.length!=calcValues.length)for(j=0;j<this._tableKeysCalcValues.length;j++){for(formula=calcValues[i].formula.replace(/\s/g,""),k=0;k<calcValues.length;k++)1!=calcValues[k].isCalculatedField&&(value=ej.globalize.parseFloat(null==this._tableKeysCalcValues[j].value.keys[k]?"0":"date"==calcValues[k].format?this._dateToInt(this._tableKeysCalcValues[j].value.keys[k].toString()).toString():"time"==calcValues[k].format?this._dateToInt(new Date("1900",this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[0],this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[1],this._tableKeysCalcValues[j].value.keys[k].toString().split(":")[2].split(" ")[0]).toString()).toString():this._tableKeysCalcValues[j].value.keys[k].toString(),this._locale),formula=formula.replace(new RegExp(calcValues[k].fieldName,"g"),"percentage"==calcValues[k].format&&0!=value?value<0?"("+value/100+")":value:value<0?"("+value+")":value));formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",calcValues[i].format,calcValues[i].formatString):null==dataSource.values[i].format?0:"0",newValue=null==dataSource.values[i].format?0:"0",this._tableKeysCalcValues[j].value.keys[i]=this._getSummaryValue(oldValue,newValue,1,this._summaryTypes[i],dataSource.values[i].format,dataSource.values[i].formatString)}else if(calcValues[i].isCalculatedField)for(val={keys:[],uniqueName:"",value:null},j=0;j<this._tableKeysCalcValues.length;j++){for(k=0;k<calcValues.length&&calcValues[k].isCalculatedField;k++)formula=calcValues[k].formula.replace(/\s/g,""),formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",calcValues[k].format,calcValues[k].formatString):null==dataSource.values[k].format?0:"0",newValue=null==dataSource.values[k].format?0:"0",val.keys.push(this._getSummaryValue(oldValue,newValue,1,"sum",dataSource.values[k].format,dataSource.values[k].formatString));this._tableKeysCalcValues[j].value=val,val={keys:[],uniqueName:"",value:null}}if(rowAxis.length>0&&(this._rowKeysCalcValues=this._sortHeaders(this._rowKeysCalcValues,rowAxis,0)),colAxis.length>0&&(this._colKeysCalcValues=this._sortHeaders(this._colKeysCalcValues,colAxis,0)),this._colkeyvalues=$.extend([],this._colKeysCalcValues),this._rowKeyValues=$.extend([],this._rowKeysCalcValues),colAxis.length>0&&this._insertTotalHeader(colAxis,this._colKeysCalcValues),rowAxis.length>0)this._insertTotalHeader(rowAxis,this._rowKeysCalcValues);else if(calcValues.length>0)if(this._rowKeysCalcValues.length>0)this._rowKeysCalcValues[0].keys[0]="Grand Total";else{for(this._rowKeysCalcValues.push({keys:[""],value:{keys:[]}}),i=0;i<calcValues.length;i++)this._rowKeysCalcValues[0].value.keys.push();this._rowKeysCalcValues[0].keys[0]="Grand Total"}return this._fillEngine(model)},_fillEngine:function(e){var t,i,l,a,r,o,s,n,d;(e.enablePaging||e.enableVirtualScrolling)&&(this._isPaging=!0,this._colHdrLen=1,this._rowHdrLen=1,this._controlObj._colKeysCalcValues=$.extend(!0,[],this._colKeysCalcValues),this._controlObj._rowKeysCalcValues=$.extend(!0,[],this._rowKeysCalcValues),this._controlObj._tableKeysCalcValues=$.extend(!0,[],this._tableKeysCalcValues),this._cropHeaders(),this._applyPaging());var h=e.dataSource,c=[],p=h.columns,u=h.rows,m=(h.filters,h.values);for(this._tRowCnt=0,this._tColCnt=0,this._currentFilterVal=this._valueFilterArray.length>0?this._valueFilterArray[0]:{},this._calculateValues(h),l=0;l<this._valueFilterArray.length;l++)this._advancedFilterInfo.length>0&&(this,this._rowKeysCalcValues=this._filterKeyValues(this._rowKeyValues),this._colKeysCalcValues=this._filterKeyValues(this._colkeyvalues),this._gridMatrix=null,this._colkeyvalues=$.extend([],this._colKeysCalcValues),this._rowKeyValues=$.extend([],this._rowKeysCalcValues),p.length>0&&this._insertTotalHeader(p,this._colKeysCalcValues),u.length>0?this._insertTotalHeader(u,this._rowKeysCalcValues):m.length>0&&(this._rowKeysCalcValues[0].keys[0]="Grand Total"),this._tRowCnt=0,this._tColCnt=0,this._currentFilterVal=this._valueFilterArray.length!=l+1?this._valueFilterArray[l+1]:{},this._calculateValues(h));if(t=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType,this._colTotCalc=[],this._rowTotCalc=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._transposeEngineCreation(),!ej.isNullOrUndefined(e.valueSortSettings)&&!ej.isNullOrUndefined(e.valueSortSettings.sortOrder)&&"none"!=e.valueSortSettings.sortOrder&&e.dataSource.values.length>0&&(!ej.isNullOrUndefined(this._valueSorting)||!ej.isNullOrUndefined(e.valueSortSettings.headerText)&&""!=e.valueSortSettings.headerText))if(i=0,e.valueSortSettings.headerDelimiters=e.valueSortSettings.headerDelimiters==undefined?"##":e.valueSortSettings.headerDelimiters,ej.isNullOrUndefined(this._valueSorting)){for(l=0;l<this._transposeEngine.length;l++){for(a=0;a<e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length;a++)ej.isNullOrUndefined(this._transposeEngine[l][a])||this._transposeEngine[l][a].Value!=e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters)[a]||i++;if(i==e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length){this._valueSorting=l;break}i=0}this._sort=ej.isNullOrUndefined(e.valueSortSettings)||ej.isNullOrUndefined(e.valueSortSettings.sortOrder)?this._sort:e.valueSortSettings.sortOrder,e.dataSource.columns.length+1!=e.valueSortSettings.headerText.split(e.valueSortSettings.headerDelimiters).length||ej.isNullOrUndefined(this._valueSorting)||this._applyValueSorting(e)}else this._applyValueSorting(e);for(r=0;r<this._tColCnt-1;r++){if(r<(o=0==u.length?1:this._isPaging?this._rowHdrLen:u.length))for(0==(s=(t?1:this._isPaging?this._colHdrLen:p.length)+(h.values.length>0?1:0))&&o>0&&(s=1),n=0;n<s;n++)this._gridMatrix.length>0&&c.push({Index:r+","+n,CSS:"none",Value:"",State:0,ColSpan:0==r&&0==n?o:1,RowSpan:0==r&&0==n?(t?1:this._isPaging?this._colHdrLen:p.length)+(h.values.length>0?1:0):1,Info:"",Span:"None",Expander:0});for(d=0;d<this._tRowCnt-1;d++)this._transposeEngine[r]==undefined||this._transposeEngine[r][d]==undefined||d<(t?1:this._isPaging?this._colHdrLen:p.length)+(h.values.length>0?1:0)&&r<o||c.push(this._transposeEngine[r][d])}return this._gridMatrix=[],h.rows[0]==undefined&&(h.rows.length=0),{json:c,pivotEngine:this._transposeEngine}},_cropHeaders:function(){var e,t,i,l,a=this._controlObj._drillHeaders.row,r=this._controlObj._drillHeaders.column,o=[],s=2,n=this._controlObj.model.enableCollapseByDefault,d=this._controlObj.model.dataSource.rows.length,h=this._controlObj.model.dataSource.columns.length;do{if(t=2==s?$.extend(!0,[],this._rowKeysCalcValues):$.extend(!0,[],this._colKeysCalcValues),n||(2==s?a.length>0:r.length>0)){for(i=0,e="",l=t.length-1;l>=0;l--)if(!ej.isNullOrUndefined(t[l])){ej.isNullOrUndefined(t[l].cellType)||ej.isNullOrUndefined(t[l].uniqueName)||(-1==t[l].uniqueName.indexOf(">#>")?t[l].uniqueName==e:-1!=t[l].uniqueName.indexOf(e))||(e="",i=t[l].level),n&&0==t[l].level&&""==e&&(i=0),(n?t[l].level!=i:""!=e)||ej.isNullOrUndefined(t[l].cellType)||ej.isNullOrUndefined(t[l].uniqueName)||!(2==s?a.indexOf(t[l].uniqueName)>-1:r.indexOf(t[l].uniqueName)>-1)||(e=t[l].uniqueName,i++);var c=e==t[l].uniqueName,p="RGTot"==t[l].cellType,u=t[l].level==i;(n?c||p||u||(2==s?i>d-2:i>h-2):""==e||ej.isNullOrUndefined(t[l].uniqueName)||c)&&((n?u:c)&&!ej.isNullOrUndefined(t[l].keys)&&t[l].keys.length>0&&!p&&""!=t[l].uniqueName&&(t[l].keys[t[l].keys.length-1]=t[l].keys[t[l].keys.length-1].replace(" Total","").replace("%####%",""),t[l].expander=2),o.push(t[l]))}2==s?this._rowKeysCalcValues=$.extend(!0,[],o.reverse()):this._colKeysCalcValues=$.extend(!0,[],o.reverse())}o=[],s--}while(s>0)},_applyPaging:function(){var e,t=[];this._controlObj._seriesPageCount=this._controlObj.model.enablePaging?this._rowKeysCalcValues.length:Math.ceil(this._rowKeysCalcValues.length/this._controlObj.model.dataSource.pagerOptions.seriesPageSize),this._controlObj._categPageCount=this._controlObj.model.enablePaging?this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1):Math.ceil(this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)/this._controlObj.model.dataSource.pagerOptions.categoricalPageSize),this._controlObj._categPageCount=0==this._controlObj._categPageCount?1:this._controlObj._categPageCount,this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage*this._controlObj.model.dataSource.pagerOptions.seriesPageSize>this._rowKeysCalcValues.length?Math.ceil(this._rowKeysCalcValues.length/this._controlObj.model.dataSource.pagerOptions.seriesPageSize):this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage,this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage=this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize>this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)?Math.ceil(this._colKeysCalcValues.length*(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)/this._controlObj.model.dataSource.pagerOptions.categoricalPageSize):this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage,this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage=0==this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage?1:this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage,this._controlObj._seriesCurrentPage=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage,this._controlObj._categCurrentPage=this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage;var i=this._controlObj.model.dataSource.pagerOptions.seriesCurrentPage*this._controlObj.model.dataSource.pagerOptions.seriesPageSize-this._controlObj.model.dataSource.pagerOptions.seriesPageSize,l=Math.ceil((this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize-this._controlObj.model.dataSource.pagerOptions.categoricalPageSize)/(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1)),a=i+this._controlObj.model.dataSource.pagerOptions.seriesPageSize,r=Math.ceil(this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize/(this._controlObj.model.dataSource.values.length>0?this._controlObj.model.dataSource.values.length:1));l=(this._controlObj.model.dataSource.pagerOptions.categoricalCurrentPage-1)*this._controlObj.model.dataSource.pagerOptions.categoricalPageSize%this._controlObj.model.dataSource.values.length>0?l-1:l;for(e=i;e<a;e++)t.push(this._rowKeysCalcValues[e]);for(t=this._spanCalculation(t),this._rowKeysCalcValues=$.extend(!0,[],t),t=[],e=l;e<r;e++)t.push(this._colKeysCalcValues[e]);t=this._spanCalculation(t),this._colKeysCalcValues=$.extend(!0,[],t)},_spanCalculation:function(e){for(var t,i,l,a,r=0;r<e.length;r++)if(e.length>0&&!ej.isNullOrUndefined(e[r])&&!ej.isNullOrUndefined(e[r].uniqueName)){for(t=e[r].uniqueName.split(">#>"),[],e[r].keys[e[r].level]=e[r].keys[0],e[r].span=ej.isNullOrUndefined(e[r].span)?[]:e[r].span,i=ej.isNullOrUndefined(e[r].level)?e[r].span.length>0?e[r].span.length-2:e[r].keys.length-2:e[r].level-1;i>=0;i--){l=r+1,e[r].keys[i]=t[i],e[r].span[i]=1;do{if(!(!ej.isNullOrUndefined(e[l])&&e[l].uniqueName.split(">#>").indexOf(t[i])>-1&&e[l].uniqueName.split(">#>").indexOf(t[i])<e[l].uniqueName.split(">#>").length-1))break;e[r].span[i]++,l++}while(l<e.length)}ej.isNullOrUndefined(e[r].span)||0!=e[r].span.length||delete e[r].span}return a=e.length,$.map(e,function(e,t){if(!ej.isNullOrUndefined(e)&&!ej.isNullOrUndefined(e.span))for(var i=0;i<e.span.length;i++)e.span[i]=e.span[i]>a-t?a-t:e.span[i];return e})},_applyValueSorting:function(e){for(var t,i,l,a,r,o,s,n,d,h,c=[],p=[],u=0,m=0,g="",f=0;f<this._transposeEngine.length;f++)for(c[u]=[],ej.isNullOrUndefined(p[m])&&(p[m]=[]),h=0;h<this._transposeEngine[f].length&&this._valueSorting==Number(this._transposeEngine[f][h].Index.split(",")[0]);h++)("colheader"==this._transposeEngine[f][h].CSS||"calc"==$.trim(this._transposeEngine[f][h].CSS)||"colheader calc"==this._transposeEngine[f][h].CSS||"summary cstot"==this._transposeEngine[f][h].CSS||"summary cstot calc"==this._transposeEngine[f][h].CSS||"summary cgtot"==this._transposeEngine[f][h].CSS||"summary cgtot calc"==this._transposeEngine[f][h].CSS)&&(g=""==g?this._transposeEngine[f][h].Value:g+e.valueSortSettings.headerDelimiters+this._transposeEngine[f][h].Value),"value"==this._transposeEngine[e.dataSource.rows.length][h].CSS&&(c[u].push(this._transposeEngine[f][h]),m=0),"summary value"==this._transposeEngine[e.dataSource.rows.length][h].CSS&&(p[m].push(this._transposeEngine[f][h]),c[u].length>0&&(c[u+=1]=[]),"summary rgtot"!=this._transposeEngine[0][h].CSS&&p[m].length>0&&m++,ej.isNullOrUndefined(p[m])&&(p[m]=[]));for(e.valueSortSettings.headerText=g,e.valueSortSettings.sortOrder=this._sort,u=0;u<c.length;u++)for(f=0;f<c[u].length;f++)for(h=f;h<c[u].length;h++)("descending"==this._sort?this._getNumber(c[u][f].Value)<this._getNumber(c[u][h].Value):this._getNumber(c[u][f].Value)>this._getNumber(c[u][h].Value))&&(l=c[u][h],c[u][h]=c[u][f],c[u][f]=l);for(u=0;u<c.length;u++)0==c[u].length&&c.splice(u,1);for(t=[],f=0;f<this._tRowCnt-1;f++)t[f]={index:0,level:-1};var b=0,_=[],v=[];for(u=p.length-2;u>=0;u--){for(i=0,h=0;h<p[u].length;h++)for(f=h;f<p[u].length;f++)("descending"==this._sort?this._getNumber(p[u][h].Value)<this._getNumber(p[u][f].Value):this._getNumber(p[u][h].Value)>this._getNumber(p[u][f].Value))&&(l=p[u][f],p[u][f]=p[u][h],p[u][h]=l);if(0==b)for(h=0;h<p[u].length;h++)t[i=0==i?this._transposeEngine[b][Number(p[u][h].Index.split(",")[1])].MCnt+e.dataSource.columns.length+1:this._transposeEngine[b][Number(p[u][h].Index.split(",")[1])].MCnt+i+1]={index:Number(p[u][h].Index.split(",")[1]),level:b},_[h]==undefined&&(_[h]={}),_[h].end=Number(p[u][h].Index.split(",")[1]),_[h].start=Number(p[u][h].Index.split(",")[1])-this._transposeEngine[b][Number(p[u][h].Index.split(",")[1])].MCnt;else{for(a=[],r=0,n=0;n<_.length;n++){for(a=[],h=0;h<p[u].length;h++)Number(p[u][h].Index.split(",")[1])>_[n].start&&Number(p[u][h].Index.split(",")[1])<_[n].end&&a.push(p[u][h]);for(h=0;h<a.length;h++)t[i=0==i?this._transposeEngine[b][Number(a[h].Index.split(",")[1])].MCnt+e.dataSource.columns.length+1:this._transposeEngine[b][Number(a[h].Index.split(",")[1])].MCnt+i+1]={index:Number(a[h].Index.split(",")[1]),level:b},v[r]==undefined&&(v[r]={}),v[r].end=Number(a[h].Index.split(",")[1]),v[r].start=Number(a[h].Index.split(",")[1])-this._transposeEngine[b][Number(a[h].Index.split(",")[1])].MCnt,r++;for(;i<this._tRowCnt-2&&t[i].level>t[i+1].level;)i++;i--}_=jQuery.extend(!0,[],v)}b++}if(1==p.length&&p[0].length>0)for(o=e.dataSource.columns.length+1,f=0;f<c[0].length;f++)t[o]={index:Number(c[0][f].Index.split(",")[1])},o++;for(s=e.dataSource.columns.length+1,n=0;n<_.length;n++)for(u=0;u<c.length;u++)if(Number(c[u][0].Index.split(",")[1])>=_[n].start&&Number(c[u][0].Index.split(",")[1])<=_[n].end){for(h=0,f=_[n].start;f<_[n].end;f++)t[s]={index:Number(c[u][h].Index.split(",")[1])},h++,s++;for(s++;0!=t[s].index&&s<=t.length;)s++}for(d=[],f=0;f<e.dataSource.columns.length+1;f++)t[f]={index:f};for(f=0;f<t.length-1;f++)d.push(this._gridMatrix[t[f].index]);for(d.push(this._gridMatrix[f]),f=0;f<this._gridMatrix.length&&this._gridMatrix[f]!=undefined&&d[f]!=undefined;f++)for(h=0;h<this._gridMatrix[f].length&&this._gridMatrix[f][h]!=undefined;h++)this._gridMatrix[f][h]!=undefined&&d[f][h]!=undefined&&(d[f][h].Index=this._gridMatrix[f][h].Index);for(h=0;h<e.dataSource.rows.length-1;h++){var C=e.dataSource.columns.length+1,S=0,O=(u=0,!1);for(f=e.dataSource.columns.length+(e.dataSource.values.length>0?1:0);f<d.length;f++)if(d[f]!=undefined&&d[f][h]!=undefined&&"rowheader"==d[f][h].CSS&&d[f][h].RowSpan!=undefined&&(O=!0,S=S>d[f][h].RowSpan?S:d[f][h].RowSpan),d[f]!=undefined&&d[f][h]!=undefined&&"summary rstot"==d[f][h].CSS&&O&&!ej.isNullOrUndefined(d[C])){for(O=!1;d[C]==undefined||d[C][h]==undefined;)C++;d[C][h].RowSpan=S,S=0,0,C=f+1,u++}}this._gridMatrix=d,this._transposeEngineCreation()},_transposeEngineCreation:function(){var e,t,i;for(this._tColCnt=this._isPaging&&this._gridMatrix.length>0?!ej.isNullOrUndefined(this._gridMatrix[0])&&this._gridMatrix[0].length>0?this._gridMatrix[0].length+1:this._gridMatrix[this._gridMatrix.length-1].length+1:this._tColCnt,e=0;e<this._tRowCnt-1;e++)for(t=0;t<this._tColCnt-1;t++)this._transposeEngine[t]==undefined&&(this._transposeEngine[t]=[]),this._gridMatrix[e]!=undefined&&this._gridMatrix[e][t]!=undefined?(i="string"==typeof this._gridMatrix[e][t]||"number"==typeof this._gridMatrix[e][t]||"object"==typeof this._gridMatrix[e][t]?0==this._gridMatrix[e][t].Value?this._gridMatrix[e][t].Value:this._gridMatrix[e][t].Value==undefined?"":ej.isNullOrUndefined(this._gridMatrix[e][t].valueText)?this._gridMatrix[e][t].Value:this._gridMatrix[e][t].valueText:"",this._transposeEngine[t][e]={Index:t+","+e,CSS:this._gridMatrix[e][t].CSS,Value:"string"==typeof i&&i.indexOf("%####%")>-1?i.replace("%####%",""):i,State:this._gridMatrix[e][t].State,RowSpan:this._gridMatrix[e][t].RowSpan!=undefined?this._gridMatrix[e][t].RowSpan:1,ColSpan:this._gridMatrix[e][t].ColSpan!=undefined?this._gridMatrix[e][t].ColSpan:1,Info:this._gridMatrix[e][t].Info,Span:"None",Expander:this._gridMatrix[e][t].Expander,MCnt:this._gridMatrix[e][t].MCnt!=undefined?this._gridMatrix[e][t].MCnt:1}):this._gridMatrix[e]!=undefined&&(this._transposeEngine[t][e]={Index:t+","+e,CSS:"none",Value:"",State:0,RowSpan:1,ColSpan:1,Info:"",Span:"None",Expander:0})},_filterKeyValues:function(e){var t=this;return $.grep(e,function(e){for(var i=!1,l=0;l<(!ej.isNullOrUndefined(e.uniqueName)&&e.uniqueName.split(">#>").length)&&(i=$.inArray(e.uniqueName.split(">#>")[l],t._advancedFilterInfo)>-1||i,!(i=$.inArray(e.uniqueName,t._advancedFilterInfo)>-1||i));l++);if(!i)return e})},_getFilteredIndex:function(e,t,i,l){return $.map(t,function(t,a){if(e.length>0&&l[i].keys.length>0&&e[l[i].keys.length-1].advancedFilter&&e[l[i].keys.length-1].advancedFilter.length>0&&(e[l[i].keys.length-1].advancedFilter[0].measure==t.fieldName||e[l[i].keys.length-1].advancedFilter[0].name==t.fieldName))return a})[0]},_applyValueFilter:function(e,t){var i,l,a=!1;if(e.length>0&&!ej.isNullOrUndefined(t))switch(t=this._isNumber(t)?t:ej.parseFloat(t,this._locale),i=e[0].valueFilterOperator,l=e[0].values,i.toLowerCase()){case"equals":a=!(t==JSON.parse(e[0].values[0]));break;case"notequals":a=!(t!=JSON.parse(e[0].values[0]));break;case"greaterthan":a=!(t>JSON.parse(e[0].values[0]));break;case"greaterthanorequalto":a=!(t>=JSON.parse(e[0].values[0]));break;case"lessthan":a=!(t<JSON.parse(e[0].values[0]));break;case"lessthanorequalto":a=!(t<=JSON.parse(e[0].values[0]));break;case"between":a=!(t>JSON.parse(l[0])&&t<JSON.parse(l[1]));break;case"notbetween":a=!!(t>JSON.parse(l[0])&&t<JSON.parse(l[1]));break;default:a=!(t==JSON.parse(e[0].values[0]))}return a},_applyLabelFilter:function(e,t){if(e.length>0){var i=e[0].labelFilterOperator,l=e[0].values,a=!1;switch(t=ej.isNullOrUndefined(t)?"":t.toString(),i.toLowerCase()){case"equals":a=!(t.toLowerCase()==l[0].toLowerCase());break;case"notequals":a=t.toLowerCase()==l[0].toLowerCase();break;case"contains":a=!(t.toLowerCase().indexOf(l[0].toLowerCase())>-1);break;case"notcontains":a=t.toLowerCase().indexOf(l[0].toLowerCase())>-1;break;case"beginswith":a=!(0==t.toLowerCase().indexOf(l[0].toLowerCase()));break;case"notbeginswith":a=0==t.toLowerCase().indexOf(l[0].toLowerCase());break;case"endswith":a=ej.isNullOrUndefined(t.toLowerCase().match(l[0].toLowerCase()+"$"));break;case"notendswith":a=!ej.isNullOrUndefined(t.toLowerCase().match(l[0].toLowerCase()+"$"));break;case"greaterthan":a=!(t.toLowerCase()>l[0].toLowerCase());break;case"greaterthanorequalto":a=!(t.toLowerCase()>=l[0].toLowerCase());break;case"lessthan":a=!(t.toLowerCase()<l[0].toLowerCase());break;case"lessthanorequalto":a=!(t.toLowerCase()<=l[0].toLowerCase());break;case"between":a=!(t.toLowerCase()>l[0].toLowerCase()||t.toLowerCase()<l[1].toLowerCase());break;case"notbetween":a=!!(t.toLowerCase()>l[0].toLowerCase()||t.toLowerCase()<l[1].toLowerCase());break;default:a=!(t.toLowerCase().indexOf(l[0].toLowerCase())>-1)}return a}},getMembers:function(e,t){var i,l,a;if(ej.isNullOrUndefined(t))return ej.isNullOrUndefined(this._fieldMembers)?[]:ej.isNullOrUndefined(this._fieldMembers[e])?[]:this._fieldMembers[e];for(i={},l=0;l<t.length;l++)a=t[l],$.each(a,function(e,t){ej.isNullOrUndefined(i[e])?i[e]=[t]:i[e].indexOf(t)<0&&i[e].push(t)});return i[e]},_powerFunction:function(e){if(e.indexOf("^")>-1){for(var t=[];e.indexOf("(")>-1;)e=e.replace(/(\([^\(\)]*\))/g,function(e,i){return t.push(i),"~"+(t.length-1)});for(t.push(e),e="~"+(t.length-1);e.indexOf("~")>-1;)e=e.replace(new RegExp("~(\\d+)","g"),function(e,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return e},_calculatedFieldSummaryValue:function(index,calValue,dataSource){var formula,i,value,oldValue,newValue;if(1==dataSource.values[index].isCalculatedField){for(formula=dataSource.values[index].formula.replace(/\s/g,""),i=0;i<dataSource.values.length;i++)1!=dataSource.values[i].isCalculatedField&&(value=ej.globalize.parseFloat(null==calValue[i]?"0":"date"==dataSource.values[i].format?this._dateToInt(calValue[i].toString()).toString():"time"==dataSource.values[i].format?this._dateToInt(new Date("1900",calValue[i].toString().split(":")[0],calValue[i].toString().split(":")[1],calValue[i].toString().split(":")[2].split(" ")[0]).toString()).toString():calValue[i].toString(),this._locale),formula=formula.replace(new RegExp(dataSource.values[i].fieldName,"g"),"percentage"==dataSource.values[i].format&&0!=value?value<0?"("+value/100+")":value:value<0?"("+value+")":value));return formula.indexOf("^")>-1&&(formula=this._powerFunction(formula)),oldValue=!isNaN(eval(formula))&&isFinite(eval(formula))?this._getReflectedValue({calcField:eval(formula)},"calcField",dataSource.values[index].format,dataSource.values[index].formatString):null==dataSource.values[index].format?0:"0",newValue=null==dataSource.values[index].format?0:"0",this._getSummaryValue(oldValue,newValue,1,"count"==this._summaryTypes[index]?"sum":this._summaryTypes[index],dataSource.values[index].format,dataSource.values[index].formatString)}},_sortHeaders:function(e,t,i){for(var l,a=[],r=[],o=0,s=t[i].sortOrder!=ej.PivotAnalysis.SortOrder.None?ej.isNullOrUndefined(t[i].format)?ej.DataManager(e).executeLocal(ej.Query().sortBy("keys."+i,null!=t[i].sortOrder&&t[i].sortOrder==ej.PivotAnalysis.SortOrder.Descending?ej.sortOrder.Descending:ej.sortOrder.Ascending,!1)):this._getSortedHeaders(e,t,i):e;o<s.length;)l=s[o].keys[i],(a=$.grep(s,function(e){return e.keys[i]==l})).length>1&&i+1<s[o].keys.length&&(a=this._sortHeaders(a,t,i+1)),r=r.concat(a),o+=a.length;return r},_getSortedHeaders:function(e,t,i){return t[i].sortOrder==ej.PivotAnalysis.SortOrder.Descending?e.sort(function(e,l){return ej.PivotAnalysis._formatToInt(l.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)-ej.PivotAnalysis._formatToInt(e.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)}):e.sort(function(e,l){return ej.PivotAnalysis._formatToInt(e.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)-ej.PivotAnalysis._formatToInt(l.keys[i],ej.isNullOrUndefined(t[i].format)?null:t[i].format,ej.isNullOrUndefined(t[i].formatString)?null:t[i].formatString)})},_isValidTime:function(e){var t=e.indexOf(":")>-1?e.split(":"):[];return 3==t.length&&(t[3]=t[2].indexOf(" ")>-1?t[2].split(" ")[1]:"AM",t[2]=t[2].indexOf(" ")>-1?t[2].split(" ")[0]:t[2],!(!(Number(t[0])>-1&&Number(t[0])<13&&Number(t[1])>-1&&Number(t[1])<61&&jQuery.isNumeric(t[2]))||"AM"!=t[3]&&"PM"!=t[3]))},_getNumber:function(e,t){return ej.isNullOrUndefined(e)||(jQuery.isNumeric(e.toString().replace(/[,.]/g,""))?(e=e.toString().replace(/[,]/g,","==ej.preferredCulture(this._locale).numberFormat[","]?"":"~").replace(/[.]/g,"."==ej.preferredCulture(this._locale).numberFormat["."]?".":""),e=Number(e.toString().replace(/[~]/g,"."))):e=this._isValidTime(e)?this._formatToInt(e,"time",t):ej.isNullOrUndefined(ej.parseDate(e,t==undefined?"MM/dd/yyyy":t))?-1!=e.indexOf("/")&&2==e.split("/")?this._formatToInt(e,"fraction",undefined):$.trim(e).indexOf("%")==$.trim(e).length-1?Number(e.replace(/[^\d.-]/g,""))/100:/[a-zA-Z]/.test(e)?1:Number(e.replace(/[^\d.-]/g,"")):this._formatToInt(e,"date",t)),e},_setFormat:function(e,t,i){switch(t){case"percentage":var l=jQuery.isNumeric(e)?1:100;e="string"==typeof e?$.trim(e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",",".").replace(ej.preferredCulture(this._locale).numberFormat.percent.symbol,"")):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:P}",""==e?0:e/l,this._locale);break;case"decimal":case"number":e="string"==typeof e?e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:N}",e,this._locale);break;case"currency":e="string"==typeof e?$.trim(e.toString().split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",",".").replace(ej.preferredCulture(this._locale).numberFormat.currency.symbol,"")):e,e=jQuery.isNumeric(e)?e:0,e=ej.widgetBase.formatting(i||"{0:C2}",""==e?0:e,this._locale);break;case"date":jQuery.isNumeric(e)?(e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale))):"Invalid Date"!=new Date(e)?(e=new Date(e),e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale)):(e=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime()),e=ej.widgetBase.formatting("{0:"+(i==undefined?"MM/dd/yyyy":i)+"}",e,this._locale));break;case"scientific":e="string"==typeof e?e.split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e=jQuery.isNumeric(e)?e:0,e=Number(e).toExponential(2).replace("e","E");break;case"accounting":e=this._toAccounting(e,i||"{0:C2}",this._locale);break;case"time":jQuery.isNumeric(e)?(e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale))):this._isValidTime(e)?e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale):(e=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime()),e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale));break;case"fraction":e="string"==typeof e?e.split(ej.preferredCulture(this._locale).numberFormat[","]).join("").replace(",","."):e,e="numerator"in(e=jQuery.isNumeric(e)?this._toFraction(e):this._toFraction(0))?e.integer+" "+e.numerator+"/"+e.denominator:e.integer}return e},_getReflectedValue:function(e,t,i,l){var a=$(e).prop(t);return null==a?a:(jQuery.isNumeric(a)||"Invalid Date"!=new Date(a)||(i=l=null),this._setFormat(a,i,l))},_formatToInt:function(value,format,formatString){var time;switch(format){case"date":value=null!=ej.parseDate(value.toString(),formatString==undefined?"MM/dd/yyyy":formatString,this._locale)?this._dateToInt(ej.parseDate(value,formatString==undefined?"MM/dd/yyyy":formatString,this._locale)):value;break;case"percentage":value=0!=value?ej.globalize.parseFloat(value.toString(),this._locale)/100:Number(value);break;case"currency":case"accounting":value=0!=value?ej.globalize.parseFloat(ej.globalize.format(value.toString(),"c",this._locale),this._locale):Number(value);break;case"decimal":case"number":value=0!=value?ej.globalize.parseFloat(value.toString(),this._locale):Number(value);break;case"scientific":value=0!=value||0==value?parseFloat(value):Number(value);break;case"time":this._isNumber(value)||(time=value.toString().split(":"),time=new Date("1900",time[0],time[1],time[2].split(" ")[0]).toString(),value=this._dateToInt(time));break;case"fraction":var temp1=parseFloat(value.toString().split(" ")[0]),temp2=eval(value.toString().split(" ")[1])!=undefined?parseFloat(eval(value.toString().split(" ")[1])):parseFloat(0),value=0!=value?temp1+temp2:Number(value)}return value},_isDateTime:function(e){return"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e.valueOf())},_toAccounting:function(e,t,i){var l,a,r,o,s=ej.preferredCulture(i).numberFormat,n=s.currency.symbol;return val=ej.widgetBase.formatting(t,e,i),val=val.indexOf(" ")>-1?val.split(" ").join(""):val,r=val.replace(n,""),o=jQuery.isNumeric(r.toString().split(s[","]).join("").replace(",","."))?val.indexOf(n):0,r=jQuery.isNumeric(r.toString().split(",").join(""))?r:"0.00",!o||Number(r)<0&&1===o?(l=n,a=r):(l=r,a=n),l+"   "+a},_toFraction:function(e){if(this._isNumber(e)){var t=e.toString(),i=t.split(".")[0],l=t.split(".")[1];if(!l)return{integer:e};var a=(+l).toString(),r=this._getPlaceValue(l,a),o=this._getGCD(a,r);return{integer:i,numerator:Number(a)/o,denominator:Number(r)/o}}return null},_isNumber:function(e){return e-parseFloat(e)>=0},_getGCD:function(e,t){return e=Number(e),(t=Number(t))?this._getGCD(t,e%t):e},_getPlaceValue:function(e,t){var i=e.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},_cellEdit:function(e,t,i,l){return $.each(this._editCellsInfo,function(a,r){if(e==(ej.isNullOrUndefined(r.row)&&ej.isNullOrUndefined(r.column)?"":ej.isNullOrUndefined(r.row)?r.column:ej.isNullOrUndefined(r.column)?r.row:r.row+">#>"+r.column)&&i==parseInt(r.value.split("#")[0]))return t=ej.PivotAnalysis._setFormat(ej.isNullOrUndefined(l.format)?jQuery.isNumeric(r.value.split("#")[1].toString().split(",").join(""))?parseFloat(r.value.split("#")[1].toString().split(",").join("")):0:r.value.split("#")[1],l.format,l.formatString),!1}),t},_isMemberExist:function(e,t,i,l){var a,r,o,s,n,d;switch(e){case"row":if(r=!1,(o=0==this._rowKeysCalcValues.length?0:this._rowMembers[t.uniqueName])>-1&&(r=!0,a=o),0==this._rowKeysCalcValues.length&&(this._rowKeysCalcValues.push(t),this._rowMembers[t.uniqueName]=this._rowKeysCalcValues.length-1),r)for(s=0;s<i.keys.length;s++){if(null==this._rowKeysCalcValues[a].value){this._rowKeysCalcValues[a].value=i;break}this._rowKeysCalcValues[a].value.keys[s]+=i.keys[s]}else this._rowKeysCalcValues.push(t),this._rowMembers[t.uniqueName]=this._rowKeysCalcValues.length-1;break;case"column":if(r=!1,(o=0==this._colKeysCalcValues.length?0:this._colMembers[t.uniqueName])>-1&&(r=!0,a=o),0==this._colKeysCalcValues.length&&(l.columns.length>0||l.values.length>0)&&(this._colKeysCalcValues.push(t),this._colMembers[t.uniqueName]=this._colKeysCalcValues.length-1),r)for(s=0;s<i.keys.length;s++){if(null==this._colKeysCalcValues[a].value){this._colKeysCalcValues[a].value=i;break}this._colKeysCalcValues[a].value.keys[s]+=i.keys[s]}else(l.columns.length>0||l.values.length>0)&&(this._colKeysCalcValues.push(t),this._colMembers[t.uniqueName]=this._colKeysCalcValues.length-1);break;case"calc":if(r=!1,(o=0==this._tableKeysCalcValues.length?0:this._calcMembers[t.uniqueName])>-1&&(r=!0,a=o),0==this._tableKeysCalcValues.length&&(this._tableKeysCalcValues.push(t),this._calcMembers[t.uniqueName]=this._tableKeysCalcValues.length-1),r)for(s=0;s<i.keys.length;s++){if(null==this._tableKeysCalcValues[a].value){for(this._tableKeysCalcValues[a].value=i,this._tableKeysCalcValues[a].value.count=1,d=0;d<i.keys.length;d++)this._summaryTypes[d]==ej.PivotAnalysis.SummaryType.Count&&(this._tableKeysCalcValues[a].value.keys[d]=this._tableKeysCalcValues[a].value.count);break}n=l.values[s],this._tableKeysCalcValues[a].value.uniqueName[s]==i.uniqueName[s]&&(ej.isNullOrUndefined(n.formatString)||"single-entry"!=n.formatString.toLowerCase())||(this._tableKeysCalcValues[a].value.uniqueName[s]=" "),0==s&&this._tableKeysCalcValues[a].value.count++,1!=l.values[s].isCalculatedField&&(this._tableKeysCalcValues[a].value.keys[s]=this._getSummaryValue(this._tableKeysCalcValues[a].value.keys[s],i.keys[s],this._tableKeysCalcValues[a].value.count,this._summaryTypes[s],l.values[s].format,l.values[s].formatString))}else for(this._tableKeysCalcValues.push(t),this._calcMembers[t.uniqueName]=this._tableKeysCalcValues.length-1,this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value=i,d=0;d<i.keys.length;d++)this._summaryTypes[d]==ej.PivotAnalysis.SummaryType.Count&&(this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value.keys[d]=1),this._tableKeysCalcValues[this._tableKeysCalcValues.length-1].value.count=1}},_getSummaryValue:function(e,t,i,l,a,r){if(t=ej.isNullOrUndefined(t)?null:0==t?0:t,e=ej.isNullOrUndefined(e)?null:0==e?0:e,!ej.isNullOrUndefined(t)&&!ej.isNullOrUndefined(e)){switch(e=this._formatToInt(e,a,r),t=this._formatToInt(t,a,r),l){case ej.PivotAnalysis.SummaryType.Sum:e+=t;break;case ej.PivotAnalysis.SummaryType.Average:e=(e*(i-1)+t)/i,Math.floor(e)!=e&&(e=Number(e.toFixed(2)));break;case ej.PivotAnalysis.SummaryType.Min:e=1==i?t:Math.min(e,t);break;case ej.PivotAnalysis.SummaryType.Max:e=1==i?t:Math.max(e,t);break;case ej.PivotAnalysis.SummaryType.Count:e=i}switch(a){case"percentage":e=ej.widgetBase.formatting(r||"{0:P}",e,this._locale);break;case"decimal":case"number":e=ej.widgetBase.formatting(r||"{0:N}",e,this._locale);break;case"date":e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:"+(r==undefined?"MM/dd/yyyy":r)+"}",e,this._locale));break;case"currency":e=ej.widgetBase.formatting(r||"{0:C2}",e,this._locale);break;case"scientific":e=e.toExponential(2).replace("e","E");break;case"accounting":e=this._toAccounting(e,r||"{0:C2}",this._locale);break;case"time":e=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime()),this._isDateTime(e)&&(e=ej.widgetBase.formatting("{0:h:mm:ss tt}",e,this._locale));break;case"fraction":e="numerator"in(e=this._toFraction(e))?e.integer+" "+e.numerator+"/"+e.denominator:e.integer}}return e},_dateToInt:function(e){var t=new Date("01/01/1900");return((this._isDateTime(e)?e:new Date(e)).getTime()-t.getTime())/864e5+2},_insertTotalHeader:function(e,t){var i,l,a,r,o;if(e.length<=1)t.push({cellType:"RGTot",keys:["Grand Total"],tot:"sub"});else{for(i=-1,l=e.length-2;l>=0;l--)if(i++,(a=t.length)>0){r=t[0].uniqueName.split(">#>"),t[0].keys[i],r=r.slice(0,l+1).join(">#>");var s="",n=0,d="";for(o=1;o<=a;o++)t[o]!=undefined?(s=(s=t[o].uniqueName.split(">#>")).slice(0,l+1).join(">#>"),d=t[o].keys[l+1]):s=undefined,s!=undefined&&-1==s.indexOf("%####%")?r!=undefined&&s!=r&&(t.splice(o,0,{keys:[r.split(">#>")[l]+" Total%####%"],cellType:"SubTot",uniqueName:r,level:l,mSpan:o-n}),t[n].span==undefined&&(t[n].span=[]),t[n].span[l]=o-n,a++,r=s,n=++o,d):r!=undefined&&(t.splice(o,0,{keys:[r.split(">#>")[l]+" Total%####%"],cellType:"SubTot:",uniqueName:r,level:l,mSpan:o-n}),t[n].span==undefined&&(t[n].span=[]),t[n].span[l]=o-n,a++,r=s,n=++o,d)}t.push({cellType:"RGTot",keys:["Grand Total"]})}},_isPreviousLevelEqual:function(e,t,i,l){for(var a=l-1;a>=0;a--)return e[t].keys[a]!=e[i].keys[a]},_calculateValues:function(e){var t,i,l=this._rowKeysCalcValues.length+(e.values.length>0?1:0),a=0==this._colKeysCalcValues.length?1:this._colKeysCalcValues.length*(0==e.values.length?1:e.values.length)+1-(this._isPaging&&e.values.length>0&&e.pagerOptions.categoricalPageSize<e.values.length*this._colKeysCalcValues.length?e.values.length-(e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length==0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize:e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length):0);this._isPaging&&(0==e.columns.length?ej.PivotAnalysis._colHdrLen=0:$.each(this._colKeysCalcValues,function(e,t){!ej.isNullOrUndefined(t)&&t.keys.length>ej.PivotAnalysis._colHdrLen&&(ej.PivotAnalysis._colHdrLen=t.keys.length)}),0==e.rows.length?ej.PivotAnalysis._rowHdrLen=0:$.each(this._rowKeysCalcValues,function(e,t){!ej.isNullOrUndefined(t)&&t.keys.length>ej.PivotAnalysis._rowHdrLen&&(ej.PivotAnalysis._rowHdrLen=t.keys.length)})),this._gridMatrix=new Array(l+(this._isPaging?this._rowHdrLen:e.rows.length)+1),this._populateRowHeaders(e,l+(this._isPaging?this._rowHdrLen:e.rows.length)+1,0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length),t=(this._isPaging?this._colHdrLen:e.columns.length)+1,i=(this._isPaging&&e.pagerOptions.categoricalPageSize+1<a?e.pagerOptions.categoricalPageSize+1:a)+(0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length),this._populateColumnHeaders(e,t,i),this._advancedFilterInfo=[],e.values.length>0&&this._populateCalcTable(e),this._tRowCnt=l+t,this._tColCnt=i},_populateRowHeaders:function(e,t,i){var l,a,r,o,s;if(0!=this._rowKeysCalcValues.length){for(l=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1+(e.values.length>0?1:0):(this._isPaging?this._colHdrLen:e.columns.length)+(e.values.length>0?1:0),this._gridMatrix=[],"",a=0;a<this._rowKeysCalcValues.length;a++){this._rowKeysCalcValues[a];var n=0,d=0,h=0,c=0;if(this._rowKeysCalcValues[a].keys!=undefined&&0!=this._rowKeysCalcValues[a].keys.length)for(this._gridMatrix[l]=new Array(i),c=this._rowKeysCalcValues[a].keys.length,r=0;r<c;r++)this._rowKeysCalcValues[a].cellType!=undefined&&ej.isNullOrUndefined(this._rowKeysCalcValues[a].span)?this._rowKeysCalcValues[a].cellType.indexOf("SubTot")>-1?(d=0==n?this._rowKeysCalcValues[a].level+n:n,h=i-this._rowKeysCalcValues[a].level,this._cellType="summary rstot"):(this._cellType="summary rgtot",d=n,h=this._isPaging?this._rowHdrLen:e.rows.length):(this._cellType="rowheader",d=n,h=1),o=c>1&&c-r>1?1:ej.isNullOrUndefined(this._rowKeysCalcValues[a].expander)?0:2,s=$.extend(!0,[],this._rowKeysCalcValues[a].keys),this._gridMatrix[l][d]={Index:d+","+l,CSS:this._cellType,Value:this._rowKeysCalcValues[a].keys[r],State:o,RowSpan:this._rowKeysCalcValues[a].span!=undefined?this._rowKeysCalcValues[a].span[r]:1,ColSpan:h,Info:s.splice(0,r+1).join(">#>"),Span:"None",Expander:this._rowKeysCalcValues[a].span!=undefined?this._rowKeysCalcValues[a].span[r]!=undefined?1:ej.isNullOrUndefined(this._rowKeysCalcValues[a].expander)?0:1:ej.isNullOrUndefined(this._rowKeysCalcValues[a].expander)?0:2,MCnt:this._rowKeysCalcValues[a].mSpan!=undefined&&ej.isNullOrUndefined(this._rowKeysCalcValues[a].span)?this._rowKeysCalcValues[a].mSpan:0},this._rowKeysCalcValues[a].level-r==1&&delete this._rowKeysCalcValues[a].span,n++;l++}this._cellType=""}},_populateColumnHeaders:function(e,t){var i,l,a,r,o,s,n;if(0!=this._colKeysCalcValues.length){var d,h,c,p,u,m,g=d=0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length,f=0==e.values.length?1:e.values.length,b=h=0,_=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1:this._isPaging?this._colHdrLen:e.columns.length;for(i=0;i<this._colKeysCalcValues.length;i++){for(b=0,c=0,p=0,0,u=f,m=0,this._isPaging&&e.values.length>0&&(m=(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length,0==i?u=(u=(1==e.pagerOptions.categoricalCurrentPage&&e.values.length>e.pagerOptions.categoricalPageSize?e.pagerOptions.categoricalPageSize:e.values.length)-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length)<1?e.values.length:e.values.length>e.pagerOptions.categoricalPageSize&&u>e.pagerOptions.categoricalPageSize?e.pagerOptions.categoricalPageSize:u:this._colKeysCalcValues.length-i==1?u=(u=e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length)<1||e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?e.values.length:u:u=e.values.length),this._colKeysCalcValues[i].keys,this._gridMatrix[b]==undefined&&(this._gridMatrix[b]=[]),h=this._colKeysCalcValues[i].keys.length,l=0;l<h;l++){for(this._gridMatrix[b]==undefined&&(this._gridMatrix[b]=[]),this._colKeysCalcValues[i].cellType!=undefined&&ej.isNullOrUndefined(this._colKeysCalcValues[i].span)?this._colKeysCalcValues[i].cellType.indexOf("SubTot")>-1?(c=0==b?this._colKeysCalcValues[i].level+b:b,p=t-this._colKeysCalcValues[i].level-1,this._cellType="summary cstot"):(c=b,p=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?1:this._isPaging?this._colHdrLen:e.columns.length,this._cellType="summary cgtot"):(c=b,p=1,this._cellType="colheader"),a=h>1&&h-l>1?1:ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:2,s=0;s<u;s++)r=$.extend(!0,[],this._colKeysCalcValues[i].keys),this._gridMatrix[c][f*i+s+d-(i>0?m:0)]={Index:g+","+c,CSS:this._cellType,Value:this._colKeysCalcValues[i].keys[l],State:a,ColSpan:s>0?1:this._isPaging&&0==i&&!ej.isNullOrUndefined(this._colKeysCalcValues[i].span)&&this._colKeysCalcValues[i].span[l]>=this._colKeysCalcValues.length?e.pagerOptions.categoricalPageSize:(this._colKeysCalcValues[i].span!=undefined?this._colKeysCalcValues[i].span[l]==undefined?1:this._colKeysCalcValues[i].span[l]:1)*(this._colKeysCalcValues.length-i==1?u:f)-(0==i?m:0),RowSpan:p,Info:r.splice(0,l+1).join(">#>"),Span:"None",Expander:s>0?ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:1:this._colKeysCalcValues[i].span!=undefined&&this._colKeysCalcValues[i].span[l]!=undefined?1:ej.isNullOrUndefined(this._colKeysCalcValues[i].expander)?0:1};this._colKeysCalcValues[i].level-l==1&&delete this._colKeysCalcValues[i].span,b++}if(e.values.length>0)for(s=0;s<u;s++)this._gridMatrix[_]==undefined&&(this._gridMatrix[_]=[]),o=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length+s:s,this._gridMatrix[_][f*i+s+d-(i>0?m:0)]={Index:f*i+s+d-(i>0?m:0)+","+b,CSS:this._cellType+" calc",Value:e.values[o].fieldCaption==undefined?e.values[o].fieldName:e.values[o].fieldCaption,State:0,ColSpan:1,RowSpan:1,Info:"",Span:"None",Expander:0};g++}if(this._cellType="",this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length>0&&t>1)for(s=0;s<t;s++)for(n=0;n<this._gridMatrix[s].length;n++)!ej.isNullOrUndefined(this._gridMatrix[s][n])&&this._gridMatrix[s][n].ColSpan>this._gridMatrix[s].length-n&&(this._gridMatrix[s][n].ColSpan=this._gridMatrix[s].length-n)}},_populateCalcTable:function(e){var t,i,l,a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C=[],S=null,O=e.values.length,T=this;this._rowTotCalc=[],this._rowTotCalc=[];var y,x=0==e.rows.length?1:this._isPaging?this._rowHdrLen:e.rows.length,M=!1,P=0,w=1==this._colKeysCalcValues.length&&"RGTot"==this._colKeysCalcValues[0].cellType?2:(this._isPaging?this._colHdrLen:e.columns.length)+1,L=w,N=!1,D={};for($.grep(T._tableKeysCalcValues,function(e){D[e.uniqueName]=e}),t=$.grep(this._tableKeysCalcValues,function(e){if(ej.isNullOrUndefined(e.cellType))return e}),$.grep(this._tableKeysCalcValues,function(e){if(!ej.isNullOrUndefined(e.cellType))return e}),f=0;f<this._rowKeysCalcValues.length;f++){for(this._colTotCalc=[],y=x,M=!0,this._gridMatrix[f+w]==undefined&&(this._gridMatrix[f+w]=[]),this._rowTotCalc[P]=[],i=0;i<this._colKeysCalcValues.length;i++){if(C=[],S=null,this._cellType="value",b=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,_=(_=this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length-i==1&&i>0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length:O)<1||this._isPaging&&e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?O:_,e.columns.length>0&&e.rows.length>0)if(!T._isPaging||"RGTot"!=T._rowKeysCalcValues[f].cellType&&"RGTot"!=T._colKeysCalcValues[i].cellType){if(l=T._rowKeysCalcValues[f].uniqueName+">#>"+T._colKeysCalcValues[i].uniqueName,a=D[l]){for(n=0;n<a.value.keys.length;n++)C.push(a.value.keys[n]);""!=a.value.uniqueName&&(S=a.value.uniqueName)}}else r=0,$.grep(t,function(t){if("RGTot"==T._rowKeysCalcValues[f].cellType&&"RGTot"==T._colKeysCalcValues[i].cellType||("RGTot"==T._rowKeysCalcValues[f].cellType?t.uniqueName.indexOf(T._colKeysCalcValues[i].uniqueName)>-1:t.uniqueName.indexOf(T._rowKeysCalcValues[f].uniqueName)>-1))for(r++,n=0;n<t.value.keys.length;n++)ej.isNullOrUndefined(C[n])?C.push(t.value.keys[n]):C[n]=e.values[n].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(n,C,e):ej.PivotAnalysis._getSummaryValue(C[n],t.value.keys[n],r,"count"==ej.PivotAnalysis._summaryTypes[n]?"sum":ej.PivotAnalysis._summaryTypes[n],e.values[n].format,e.values[n].formatString)});else 0==e.rows.length?T._isPaging?(r=0,$.grep(t,function(t){if("RGTot"==T._colKeysCalcValues[i].cellType||t.uniqueName.indexOf(T._colKeysCalcValues[i].uniqueName)>-1)for(r++,n=0;n<t.value.keys.length;n++)ej.isNullOrUndefined(C[n])?C.push(t.value.keys[n]):C[n]=e.values[n].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(n,C,e):ej.PivotAnalysis._getSummaryValue(C[n],t.value.keys[n],r,"count"==ej.PivotAnalysis._summaryTypes[n]?"sum":ej.PivotAnalysis._summaryTypes[n],e.values[n].format,e.values[n].formatString)})):$.grep(T._tableKeysCalcValues,function(e){if(e.uniqueName==T._colKeysCalcValues[i].uniqueName){for(n=0;n<e.value.keys.length;n++)C.push(e.value.keys[n]);""!=e.value.uniqueName&&(S=e.value.uniqueName)}}):T._isPaging?(r=0,$.grep(t,function(t){if("RGTot"==T._rowKeysCalcValues[f].cellType||t.uniqueName.indexOf(T._rowKeysCalcValues[f].uniqueName)>-1)for(r++,n=0;n<t.value.keys.length;n++)ej.isNullOrUndefined(C[n])?C.push(t.value.keys[n]):C[n]=e.values[n].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(n,C,e):ej.PivotAnalysis._getSummaryValue(C[n],t.value.keys[n],r,"count"==ej.PivotAnalysis._summaryTypes[n]?"sum":ej.PivotAnalysis._summaryTypes[n],e.values[n].format,e.values[n].formatString)})):$.grep(T._tableKeysCalcValues,function(e){if(e.uniqueName==T._rowKeysCalcValues[f].uniqueName){for(n=0;n<e.value.keys.length;n++)C.push(e.value.keys[n]);""!=e.value.uniqueName&&(S=e.value.uniqueName)}});if(this._editCellsInfo.length>0)for(v=0;v<e.values.length;v++)C[v]=ej.PivotAnalysis._cellEdit(e.columns.length>0&&e.rows.length>0?this._rowKeysCalcValues[f].uniqueName+">#>"+this._colKeysCalcValues[i].uniqueName:0==e.rows.length?this._colKeysCalcValues[i].uniqueName:this._rowKeysCalcValues[f].uniqueName,C[v],v,e.values[v]);if(this._colKeysCalcValues[i].cellType!=undefined&&(this._colKeysCalcValues[i].cellType.indexOf("SubTot")>-1||this._colKeysCalcValues[i].cellType.indexOf("RGTot")>-1)){if(!this._isPaging){for(C=[],S=null,n=0;n<O;n++)for(d=0,r=0,o=y;o<=i*O+x;o++)this._gridMatrix[f+w]!=undefined&&this._gridMatrix[f+w][y+d*O+n]!=undefined&&this._gridMatrix[f+w][y+d*O+n].Value!=undefined&&(C[n]==undefined&&(C[n]=0),r++,C[n]=e.values[n].isCalculatedField?this._calculatedFieldSummaryValue(n,C,e):this._getSummaryValue(C[n],this._gridMatrix[f+w][y+d*O+n].Value,r,"count"==this._summaryTypes[n]?"sum":this._summaryTypes[n],e.values[n].format,e.values[n].formatString)),d++;0,y=(i+1)*O+x,ej.isNullOrUndefined(C)||this._colTotCalc.push({uniqueName:this._colKeysCalcValues[i].uniqueName,level:this._colKeysCalcValues[i].level,value:C}),this._colKeysCalcValues[i-1]!=undefined&&this._colKeysCalcValues[i-1].cellType!=undefined&&this._colKeysCalcValues[i-1].cellType.indexOf("SubTot")>-1&&-1==this._colKeysCalcValues[i-1].cellType.indexOf("RGTot")&&($(this._colTotCalc).filter(function(e,t){return t!=undefined&&t.uniqueName!=undefined&&T._colKeysCalcValues[i].uniqueName!=undefined&&t.level!=undefined&&T._colKeysCalcValues[i].level!=undefined&&0===t.uniqueName.indexOf(T._colKeysCalcValues[i].uniqueName)&&T._colKeysCalcValues[i].level+1==t.level}).map(function(t,i){for(var l=0;l<i.value.length;l++)C[l]=ej.isNullOrUndefined(C[l])?0:C[l],i.value[l]=ej.isNullOrUndefined(i.value[l])?0:i.value[l],e.values[l].isCalculatedField?C[l]=ej.PivotAnalysis._calculatedFieldSummaryValue(l,C,e):C[l]+=i.value[l];return C}),ej.isNullOrUndefined(C)||this._colTotCalc.push({uniqueName:this._colKeysCalcValues[i].uniqueName,level:this._colKeysCalcValues[i].level,value:C}))}this._cellType="summary value"}if(this._colKeysCalcValues[i].cellType!=undefined&&this._colKeysCalcValues[i].cellType.indexOf("RGTot")>-1&&0==C&&(this._isPaging||(C=[],S=null,r=0,$(this._colTotCalc).filter(function(e,t){return t!=undefined&&t!=undefined&&t.level!=undefined&&0==t.level}).map(function(t,i){for(var l=0;l<i.value.length;l++)C[l]=ej.isNullOrUndefined(C[l])?0:C[l],i.value[l]=ej.isNullOrUndefined(i.value[l])?0:i.value[l],r++,C[l]=e.values[l].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(l,C,e):ej.PivotAnalysis._getSummaryValue(C[l],i.value[l],r,"count"==T._summaryTypes[l]?"sum":T._summaryTypes[l],e.values[l].format,e.values[l].formatString);return C})),this._cellType="summary value"),this._rowKeysCalcValues[f].cellType!=undefined&&(this._rowKeysCalcValues[f].cellType.indexOf("SubTot")>-1||this._rowKeysCalcValues[f].cellType.indexOf("RGTot")>-1)){if(!this._isPaging){for(C=[],S=null,this._rowKeysCalcValues[f].uniqueName,this._rowKeysCalcValues[f-1]!=undefined&&this._rowKeysCalcValues[f-1].cellType!=undefined&&this._rowKeysCalcValues[f-1].cellType.indexOf("SubTot")>-1&&-1==this._rowKeysCalcValues[f].cellType.indexOf("RGTot")&&(r=0,$(this._rowTotCalc).filter(function(e,t){return t[0]!=undefined&&t[0].uniqueName!=undefined&&T._rowKeysCalcValues[f].uniqueName!=undefined&&t[0].level!=undefined&&T._rowKeysCalcValues[f].level!=undefined&&0===t[0].uniqueName.indexOf(T._rowKeysCalcValues[f].uniqueName)&&T._rowKeysCalcValues[f].level+1==t[0].level}).map(function(t,l){if(l[x+i].length>0){r++;for(var a=0;a<l[x+i].length;a++)C[a]=ej.isNullOrUndefined(C[a])?0:C[a],l[x+i][a]=ej.isNullOrUndefined(l[x+i][a])?0:l[x+i][a],C[a]=e.values[a].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(a,C,e):ej.PivotAnalysis._getSummaryValue(C[a],l[x+i][a],r,"count"==T._summaryTypes[a]?"sum":T._summaryTypes[a],e.values[a].format)}return C})),this._rowKeysCalcValues[f].cellType!=undefined&&this._rowKeysCalcValues[f].cellType.indexOf("RGTot")>-1&&(r=0,$(this._rowTotCalc).filter(function(e,t){return t!=undefined&&t[0]!=undefined&&t[0].level!=undefined&&0==t[0].level}).map(function(t,l){if(l[x+i].length>0){r++;for(var a=0;a<l[x+i].length;a++)C[a]=ej.isNullOrUndefined(C[a])?0:C[a],l[x+i][a]=ej.isNullOrUndefined(l[x+i][a])?0:l[x+i][a],C[a]=e.values[a].isCalculatedField?ej.PivotAnalysis._calculatedFieldSummaryValue(a,C,e):ej.PivotAnalysis._getSummaryValue(C[a],l[x+i][a],r,"count"==T._summaryTypes[a]?"sum":T._summaryTypes[a],e.values[a].format,e.values[a].formatString)}return C})),r=1,o=L;o<=f+w;o++){for(s=!1,n=0;n<O;n++)d=0,this._gridMatrix[o]!=undefined&&this._gridMatrix[o][x+i*O+n]!=undefined&&this._gridMatrix[o][x+i*O+n].Value!=undefined&&(C[n]==undefined&&(C[n]=0),s=!0,C[n]=e.values[n].isCalculatedField?this._calculatedFieldSummaryValue(n,C,e):this._getSummaryValue(C[n],this._gridMatrix[o][x+i*O+n].Value,r,"count"==this._summaryTypes[n]?"sum":this._summaryTypes[n],e.values[n].format,e.values[n].formatString)),d++;s&&r++}0,N=!0,M&&(this._rowTotCalc[P][0]={uniqueName:this._rowKeysCalcValues[f].uniqueName,level:this._rowKeysCalcValues[f].level},M=!1),this._rowTotCalc[P][x+i]=C}this._cellType="summary value"}if(e.enableAdvancedFilter){var R=0,j=this._currentFilterVal.fieldName?ej.Pivot.getReportItemByFieldName(this._currentFilterVal.fieldName,e):null;null!=j&&"rows"==j.axis&&(R=this._getFilteredIndex(e.rows,e.values,f,this._rowKeysCalcValues)),ej.isNullOrUndefined(R)||null==j||"rows"==j.axis||(R=this._getFilteredIndex(e.columns,e.values,i,this._colKeysCalcValues)),ej.isNullOrUndefined(R)||(h=this._rowKeysCalcValues[f].keys.length>0&&e.rows.length>0&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter.length>0&&e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter?1:null,c=!(!j||null==j||null==h||e.rows[this._rowKeysCalcValues[f].keys.length-1].fieldName!=j.item.fieldName)&&this._applyValueFilter(e.rows[this._rowKeysCalcValues[f].keys.length-1].advancedFilter,C[R]),this._colKeysCalcValues[i].keys.indexOf("Grand Total")>=0&&c&&this._rowKeysCalcValues[f].uniqueName?this._advancedFilterInfo.push(this._rowKeysCalcValues[f].uniqueName):0==e.columns.length&&c&&this._rowKeysCalcValues[f].uniqueName&&this._advancedFilterInfo.push(this._rowKeysCalcValues[f].uniqueName),p=this._colKeysCalcValues[i].keys.length>0&&e.columns.length>0&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter.length>0&&e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter[0].advancedFilterType==ej.Pivot.AdvancedFilterType.ValueFilter?1:null,u=null!=j&&null!=p&&e.columns[this._colKeysCalcValues[i].keys.length-1].fieldName==j.item.fieldName&&this._applyValueFilter(e.columns[this._colKeysCalcValues[i].keys.length-1].advancedFilter,C[R]),this._colKeysCalcValues[i].uniqueName&&"string"===jQuery.type(this._rowKeysCalcValues[f].keys[0])&&this._rowKeysCalcValues[f].keys[0].indexOf("Grand Total")>-1&&u&&this._advancedFilterInfo.push(this._colKeysCalcValues[i].uniqueName))}for(m=this._isPaging&&e.values.length>0?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,v=b;v<_;v++)C!=undefined&&C.length!=undefined?(g=null,null!=S&&""!=S[v]&&" "!=S[v]&&(g=S[v]),this._gridMatrix[w+f][O*i+v+x-m]={Index:O*i+v+x-m+","+w+f,CSS:this._cellType,Value:C[v],valueText:g,State:0,ColSpan:1,RowSpan:1,Info:"",Span:"None",Expander:0}):this._gridMatrix[w+f][O*i+v+x-m]=0}N&&(P++,L=f+w+1,N=!1)}for(f=0;f<this._rowKeysCalcValues.length;f++)for(i=0;i<this._colKeysCalcValues.length;i++)for(b=this._isPaging&&e.values.length>0&&0==i?(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length:0,_=(_=this._isPaging&&e.values.length>0&&this._colKeysCalcValues.length-i==1&&i>0?e.pagerOptions.categoricalCurrentPage*e.pagerOptions.categoricalPageSize%e.values.length:O)<1||this._isPaging&&e.pagerOptions.categoricalPageSize>=e.values.length*this._colKeysCalcValues.length-(e.pagerOptions.categoricalCurrentPage-1)*e.pagerOptions.categoricalPageSize%e.values.length?O:_,v=b;v<_;v++)e.values[v].isCalculatedField&&null==this._gridMatrix[w+f][O*i+v+x-m].Value&&(this._gridMatrix[w+f][O*i+v+x-m].Value=this._calculatedFieldSummaryValue(v,[],e));return this._gridMatrix}},ej.PivotAnalysis.SortOrder={Ascending:"ascending",Descending:"descending",None:"none"},ej.PivotAnalysis.FilterType={Exclude:"exclude",Include:"include"},ej.PivotAnalysis.SummaryType={Sum:"sum",Average:"average",Count:"count",Min:"min",Max:"max"}}(jQuery,Syncfusion)})},1022:function(e,t,l){var a,r,o;
/*!
*  filename: ej.pivotgrid.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotgrid.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(i){r=[l(4),l(21),l(65),l(47),l(66),l(415),l(1011),l(96),l(1009),l(1010)],void 0===(o="function"==typeof(a=i)?a.apply(t,r):a)||(e.exports=o)}(function(){!function(e,t,l){t.olap=t.olap||{},t.widget("ejPivotGrid","ej.PivotGrid",{_rootCSS:"e-pivotgrid",element:null,model:null,_requiresID:!0,validTags:["div","span"],defaults:{url:"",cssClass:"",jsonRecords:"",currentReport:"",layout:"normal",analysisMode:"olap",operationalMode:"clientmode",filterType:"filterType",enablePivotFieldList:!0,enableGroupingBar:!1,enableDeferUpdate:!1,enableJSONRendering:!1,enableVirtualScrolling:!1,enablePaging:!1,enableColumnResizing:!1,resizeColumnsToFit:!0,enableContextMenu:!1,enableCellContext:!1,enableRTL:!1,enableDefaultValue:!1,enableToolTip:!0,enableToolTipAnimation:!0,enableCellSelection:!1,enableConditionalFormatting:!1,enableCellEditing:!1,enableColumnGrandTotal:!0,enableRowGrandTotal:!0,enableGrandTotal:!0,enableCollapseByDefault:!1,enableCellDoubleClick:!1,enableCellClick:!1,enableDrillThrough:!1,isResponsive:!1,enableAdvancedFilter:!1,showUniqueNameOnPivotButton:!1,enableMemberEditorPaging:!1,enableMemberEditorSorting:!1,enableXHRCredentials:!1,enableCompleteDataExport:!1,enableCheckStateOnSearch:!0,editCellsInfo:{},hyperlinkSettings:{enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1},headerSettings:{showRowItems:!1,showColumnItems:!1},frozenHeaderSettings:{enableFrozenRowHeaders:!1,enableFrozenColumnHeaders:!1,enableFrozenHeaders:!1,scrollerSize:18},valueSortSettings:{headerText:"",headerDelimiters:"##",sortOrder:t.PivotAnalysis.SortOrder.None},conditionalFormatSettings:[],serviceMethodSettings:{initialize:"InitializeGrid",drillDown:"DrillGrid",exportPivotGrid:"Export",paging:"Paging",fetchMembers:"FetchMembers",nodeStateModified:"NodeStateModified",nodeDropped:"NodeDropped",filtering:"Filtering",sorting:"Sorting",valueSorting:"ValueSorting",deferUpdate:"DeferUpdate",memberExpand:"MemberExpanded",writeBack:"WriteBack",cellEditing:"CellEditing",saveReport:"SaveReport",loadReport:"LoadReportFromDB",calculatedField:"CalculatedField",drillThroughHierarchies:"DrillThroughHierarchies",drillThroughDataTable:"DrillThroughDataTable",removeButton:"RemoveButton"},customObject:{},locale:"en-US",dataSource:{data:null,sourceInfo:"",providerName:"ssas",enableAdvancedFilter:!1,isFormattedValues:!1,reportName:"Default",columns:[],cube:"",catalog:"",rows:[],values:[],filters:[],pagerOptions:{categoricalPageSize:0,seriesPageSize:0,categoricalCurrentPage:0,seriesCurrentPage:0}},pivotTableFieldListID:"",collapsedMembers:null,cellSelection:null,valueCellHyperlinkClick:null,rowHeaderHyperlinkClick:null,columnHeaderHyperlinkClick:null,summaryCellHyperlinkClick:null,beforeServiceInvoke:null,afterServiceInvoke:null,drillThrough:null,drillSuccess:null,cellContext:null,load:null,renderComplete:null,renderFailure:null,renderSuccess:null,cellDoubleClick:null,cellClick:null,applyFieldCaption:null,beforeExport:null,beforePivotEnginePopulate:null,pivotEnginePopulated:null,saveReport:null,loadReport:null,cellEdit:null,memberEditorPageSize:100,maxNodeLimitInMemberEditor:1e3},dataTypes:{dataSource:{data:"data",columns:"array",rows:"array",values:"array",filters:"array"},serviceMethodSettings:{initialize:"enum",drillDown:"enum",exportPivotGrid:"enum",paging:"enum",fetchMembers:"enum",nodeStateModified:"enum",nodeDropped:"enum",filtering:"enum",sorting:"enum",deferUpdate:"enum",memberExpand:"enum",writeBack:"enum",cellEditing:"enum",saveReport:"enum",loadReport:"enum",calculatedField:"enum",drillThroughHierarchies:"enum",drillThroughDataTable:"enum",removeButton:"enum"},customObject:"data"},observables:["layout","enableCellContext","hyperlinkSettings.enableValueCellHyperlink","hyperlinkSettings.enableRowHeaderHyperlink","hyperlinkSettings.enableColumnHeaderHyperlink","hyperlinkSettings.enableSummaryCellHyperlink"],layout:t.util.valueFunction("layout"),enableCellContext:t.util.valueFunction("enableCellContext"),enableValueCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableValueCellHyperlink"),enableRowHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableRowHeaderHyperlink"),enableColumnHeaderHyperlink:t.util.valueFunction("hyperlinkSettings.enableColumnHeaderHyperlink"),enableSummaryCellHyperlink:t.util.valueFunction("hyperlinkSettings.enableSummaryCellHyperlink"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(e){this._olapReport=e},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=e.parseJSON(t)},_init:function(){this._initPrivateProperties(),this._load()},_destroy:function(){e(this.element).next().length>0&&"e-pGridTooltip"==e(this.element).next()[0].className&&e(this.element).next().remove(),this.element.empty().removeClass("e-pivotgrid"+this.model.cssClass).removeAttr("tabindex"),this._waitingPopup!=l&&this._waitingPopup.destroy(),""==this.element.attr("class")&&this.element.removeAttr("class")},_getExportModel:function(){var i="ExportControl",l={rowCellColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".rowheader").css("color"),rowCellBGColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".rowheader").css("background-color"),columnCellColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".colheader").css("color"),columnCellBGColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".colheader").css("background-color"),valueCellColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("color"))?"rgb(51, 51, 51)":this._cFormat.length<=0?this.element.find(".value").css("color"):"rgb(51, 51, 51)",valueCellBGColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("background-color"))?"rgb(255, 255, 255)":this._cFormat.length<=0?this.element.find(".value").css("background-color"):"rgb(255, 255, 255)",summaryCellColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("color"))?"rgb(51, 51, 51)":this.element.find(".summary").css("color"),summaryCellBGColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")},a=(e.extend(!0,{},this.model),"PivotGrid"),r=(t.PivotGrid.ExportMode.JSON,this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?".xls":".xlsx"),o="",s="",n=!0,d=!1;return{args:{pGridData:null!=this.exportRecords&&""!=this.exportRecords?this.exportRecords:null,rowCount:null!=this._excelLikeJSONRecords?this._excelRowCount:this._rowCount,columnCount:null!=this._excelLikeJSONRecords?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):null!=this.getJSONRecords()?Math.floor(this.getJSONRecords().length/this._rowCount):0,fileFormat:r+(".xls"==r||".xlsx"==r?"~"+d:""),fileName:t.isNullOrUndefined(i)?t.isNullOrUndefined(a)?"PivotGrid":a:i,colorSettings:l,Formatting:this._cFormat,title:o,description:s,language:this.model.locale,multiControlExport:!0,exportWithStyle:n,customObject:JSON.stringify(this.model.customObject)}}},_initPrivateProperties:function(){this._id=this.element.attr("id"),this._olapReport="",this._JSONRecords=null,this._excelLikeJSONRecords=null,this._drillCaption="",this._drillAction="",this._startDrilldown=!1,this._pagerObj=null,this._seriesPageCount=null,this._categPageCount=null,this._seriesCurrentPage=1,this._categCurrentPage=1,this._drillHeaders={row:[],column:[]},this._collapsedRowHeaders=[],this._isDragging=!1,this._droppedClass="",this._dataModel="",this._ascdes="",this._filterUpdate=[],this._pivotRow=[],this._pivotColumn=[],this._pivotCalculation=[],this._pivotFilter=[],this._pivotTableFields=[],this._schemaData=null,this._waitingPopup=null,this._oriX=null,this._oriY=null,this._sortType="",this._startPosCell=null,this._startCellPosition=null,this._maxViewLoading=null,this._list=[],this._formatEdit=!1,this._formatName=[],this._formatName.push(this._getLocalizedLabels("AddNew")),this._rowCount=0,this._excelRowCount=0,this._dialogTitle="",this._selectedField="",this._selectedAxis="",this._isUpdateRequired=!1,this._isMembersFiltered=!1,this._selectedCell=null,this._onholdKey="",this._primaryCellPos="",this._prevDrillElements=[],this._currentReportItems=[],this._savedReportItems=[],this._rowHeader=[],this._colHeader=[],this._cellInfo=[],this._editorFlag=!0,this._isSubTotalHide=!1,this._isSubTotalhidden=!1,this._dimension,this._calculatedField=[],this._isFormatApply=!1,this._cFormat=[],this._curFocus={cell:null,tab:null,tree:null,cformat:null,grp:null,selection:null,filter:null,field:null,formula:null},this._index={index:0,grp:1,cell:1,dialog:1,paging:1,cformat:1,filter:0,field:0,formula:0},this._dataSet=[],this._currentCell=-1,this._target=null,this._orgX=null,this._orgY=null,this._expand=!1,this._excelFilterInfo=[],this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}},this._isSchemaInitialize=!0,this._fieldMembers={},this._fieldSelectedMembers={},this._allMember="",this._selectedMeasure="",this._selectedFormat="",this._dialogName="",this._pivotClientObj=null,this._memberPageSettings={currentMemeberPage:1,startPage:0,endPage:0},this._memberSearchPageSettings={currentMemberSearchPage:1,startSearchPage:0,endSearchPage:0},this._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0},this._isAllMemberChecked=!0,this._editorTreeData=[],this._editorSearchTreeData=[],this._editorDrillTreeData={},this._editorDrillTreePageSettings={},this._lastSavedTree=[],this._onDemandNodeExpand=!0,this._isSearchApplied=!1,this._isEditorDrillPaging=!1,this._isEditorCollapseDrillPaging=!1,this._isSchemaClick=!1,this._memberPagingAvdData=[],this._table="",this._drillParams={currRow:"",currCol:"",currPos:""},this._croppedJson=[],this._compJson=[],this._isNavigation=!1,this._isOptionSearch=!1,this._isSelectSearchFilter=!0,this._currentFilterList={},this._rawData=[],this._colKeysCalcValues=[],this._rowKeysCalcValues=[],this._tableKeysCalcValues=[],this._isExporting=!1,this._fullExportedData={},this._pivotEngine=null,this._isXMLImport=!1,this._isFilterBtnClick=!1,this._parentNodeCollection={},this._parentSearchNodeCollection={},this._initialSlicerName=""},_load:function(){var i,l,a={element:this.element,customObject:this.model.customObject};if((this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&(this.model.dataSource.enableAdvancedFilter=this.model.enableAdvancedFilter=!0),this.model.enableCellEditing&&this.model.enableCellSelection&&(this.model.enableCellSelection=!1),this._trigger("load",a),this.element.addClass(this.model.cssClass),e(this.element).parents(".e-pivotclient").length>0?(this._pivotClientObj=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+this._pivotClientObj._id+"_maxView")[0]&&e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}),t.isNullOrUndefined(this._waitingPopup)&&!t.isNullOrUndefined(this._pivotClientObj._waitingPopup)&&(this._waitingPopup=this._pivotClientObj._waitingPopup),this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)&&(this.element.ejWaitingPopup({showOnInit:!0}),this._waitingPopup=this.element.data("ejWaitingPopup")),this._waitingPopup.show(),this.model.enableJSONRendering)this.setJSONRecords(this.model.jsonRecords),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON();else if(t.isNullOrUndefined(this.model.dataSource.data)&&""==this.model.url&&!t.isNullOrUndefined(this._pivotClientObj))this.renderControlFromJSON(),this._waitingPopup.hide();else if(null==this.model.dataSource.data&&""!=this.model.url||null!=this.model.dataSource.data&&""!=this.model.url&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)this.model.operationalMode=t.Pivot.OperationalMode.ServerMode,t.isNullOrUndefined(this.model.beforeServiceInvoke)||this._trigger("beforeServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),i=JSON.stringify(this.model.customObject),this.model.enableVirtualScrolling&&(this.model.layout=t.PivotGrid.Layout.NoSummaries),null!=this.element[0]&&this.element.parents().find(".e-controlPanel").length>0&&""!=this.layout()&&this.layout()!=t.PivotGrid.Layout.Normal?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initializeGrid",currentReport:this.model.currentReport,gridLayout:this.layout(),customObject:i}),this._renderControlSuccess):null!=this.element[0]&&this.element.parents().find(".e-controlPanel").length>0?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick||this.model.enableCellClick||this.model.enableDrillThrough?"initializeGrid:getDataSet":"initializeGrid",currentReport:this.model.currentReport,customObject:i}),this._renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableCellDoubleClick||this.model.enableCellClick||this.model.enableDrillThrough?this.model.enableCollapseByDefault&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"initializeGrid:getDataSet:collapseByDefault":"initializeGrid:getDataSet":this.model.enableCollapseByDefault&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"initializeGrid:collapseByDefault":"initializeGrid",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:i}),this._renderControlSuccess);else if(this.model.operationalMode=t.Pivot.OperationalMode.ClientMode,""!=this.model.dataSource.cube)this.model.analysisMode=t.Pivot.AnalysisMode.Olap,this._trigger("beforePivotEnginePopulate",{pivotGridObj:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this);else if(null!=this.model.dataSource.data){for(!1,l=0;l<this.model.dataSource.rows.length;l++)this._applyGrouping("rows",l)&&l--;for(l=0;l<this.model.dataSource.columns.length;l++)this._applyGrouping("columns",l)&&l--;for(l=0;l<this.model.dataSource.values.length;l++)this._applyGrouping("values",l)&&l--;for(l=0;l<this.model.dataSource.filters.length;l++)this._applyGrouping("filters",l)&&l--;this.model.analysisMode=t.Pivot.AnalysisMode.Pivot,t.PivotAnalysis.setFieldCaptions(this.model.dataSource),this._populatePivotGrid()}},_formatChange:function(e,t,i){var l,a=t.split(i);return a[0].indexOf("M")>-1&&a[1].indexOf("d")>-1||a[1].indexOf("M")>-1&&a[2].indexOf("d")>-1?e:a[1].indexOf("M")>-1&&a[0].indexOf("d")>-1?(l=e.split(i))[1]+i+l[0]+i+l[2]:a[2].indexOf("M")>-1&&a[0].indexOf("d")>-1?(l=e.split(i))[2]+i+l[0]+i+l[1]:a[2].indexOf("M")>-1&&a[1].indexOf("d")>-1?(l=e.split(i))[2]+i+l[1]+i+l[0]:a[0].indexOf("M")>-1&&a[2].indexOf("d")>-1?(l=e.split(i))[0]+i+l[2]+i+l[1]:void 0},_applyGrouping:function(e,i){var a,r;this._rawData=this.model.dataSource.data;var o=this.model.dataSource.data,s=-1,n=!1;for(s=-1,a=0;"date"==this.model.dataSource[e][i].format&&this.model.dataSource[e][i].formatString!=l&&this.model.dataSource[e][i].delimiter!=l&&this.model.dataSource[e][i].groupByDate!=l&&a<this.model.dataSource[e][i].groupByDate.interval.length;a++){var d=this.model.dataSource[e][i].groupByDate.interval[a].indexOf("MM")>-1&&-1==this.model.dataSource[e][i].groupByDate.interval[a].indexOf("dd")?this._getLocalizedLabels("Months"):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("dd")>-1?this._getLocalizedLabels("Days"):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("qq")>-1?this._getLocalizedLabels("Quarters"):this._getLocalizedLabels("Years"),h=this.model.dataSource[e][i].formatString,c=this.model.dataSource[e][i].delimiter,p={fieldName:d+" ("+this.model.dataSource[e][i].fieldName+")",fieldCaption:d+" ("+this.model.dataSource[e][i].fieldName+")"};for(this.model.dataSource[e].push(p),r=0;r<o.length;r++)o[r][p.fieldName]=this.model.dataSource[e][i].groupByDate.interval[a].indexOf("MM")>-1&&-1==this.model.dataSource[e][i].groupByDate.interval[a].indexOf("DD")?t.PivotAnalysis._setFormat(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,c),this.model.dataSource[e][i].format,this.model.dataSource[e][i].groupByDate.interval[a]):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("dd")>-1?t.PivotAnalysis._setFormat(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,c),this.model.dataSource[e][i].format,this.model.dataSource[e][i].groupByDate.interval[a]):this.model.dataSource[e][i].groupByDate.interval[a].indexOf("qq")>-1?("qq"==this.model.dataSource[e][i].groupByDate.interval[a]?this._getLocalizedLabels("Qtr")+" "+c:this._getLocalizedLabels("Quarter")+" "+c)+this._getQuarter(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,c)):t.PivotAnalysis._setFormat(this._formatChange(o[r][this.model.dataSource[e][i].fieldName],h,c),this.model.dataSource[e][i].format,this.model.dataSource[e][i].groupByDate.interval[a]);s=i}return-1!=s&&(this.model.dataSource[e].splice(i,1),n=!0),n},_getQuarter:function(e){if(jQuery.isNumeric(e))t=new Date(864e5*(Number(e)-2)+new Date("01/01/1900").getTime());else if("Invalid Date"!=new Date(e))var t=new Date(e);else t=new Date(864e5*(Number(0)-2)+new Date("01/01/1900").getTime());return Math.floor((t.getMonth()+3)/3)},refreshControl:function(){t.Pivot.openPreventPanel(this),this._trigger("beforePivotEnginePopulate",{pivotObject:this}),this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._controlObj=this,this._pivotEngine=t.PivotAnalysis.pivotEnginePopulate(this.model),this.setJSONRecords(JSON.stringify(this._pivotEngine.json)),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(this._pivotEngine.json):this.renderControlFromJSON(this._pivotEngine.json),this._trigger("renderSuccess",this)):t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)},_setCaptions:function(){e.each(this.model.dataSource.rows,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)}),e.each(this.model.dataSource.columns,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)}),e.each(this.model.dataSource.filters,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)}),e.each(this.model.dataSource.values,function(e,i){t.isNullOrUndefined(i.fieldCaption)&&(i.fieldCaption=i.fieldName)})},refreshFieldCaption:function(e,t,i){var l;if(i.indexOf("row")>=0)for(l=0;l<this.model.dataSource.rows.length;l++)e==this.model.dataSource.rows[l].fieldName&&(this.model.dataSource.rows[l].fieldCaption=t);else if(i.indexOf("calc")>=0)for(l=0;l<this.model.dataSource.values.length;l++)e==this.model.dataSource.values[l].fieldName&&(this.model.dataSource.values[l].fieldCaption=t);else if(i.indexOf("col")>=0)for(l=0;l<this.model.dataSource.columns.length;l++)e==this.model.dataSource.columns[l].fieldName&&(this.model.dataSource.columns[l].fieldCaption=t);else for(l=0;l<this.model.dataSource.filters.length;l++)e==this.model.dataSource.filters[l].fieldName&&(this.model.dataSource.filters[l].fieldCaption=t);for(l=0;l<this._pivotTableFields.length;l++)e==this._pivotTableFields[l].name&&(this._pivotTableFields[l].caption=t)},refreshPivotGrid:function(){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this.getOlapReport()&&(this.model.dataSource.rows&&(this.model.dataSource.rows=this.getOlapReport().rows),this.model.dataSource.columns&&(this.model.dataSource.columns=this.getOlapReport().columns),this.model.dataSource.filters&&(this.model.dataSource.filters=this.getOlapReport().filters),this.model.dataSource.values&&(this.model.dataSource.values=this.getOlapReport().values)),this.model.editCellsInfo={},this._populatePivotGrid()):(this._trigger("beforePivotEnginePopulate",{olapObject:this}),t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)):this._load()},_populatePivotGrid:function(){var i,l,a,r,o;for(this._trigger("beforePivotEnginePopulate",{pivotObject:this}),i=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,l=e.grep(this.model.dataSource.values,function(e){return 1==e.isCalculatedField}),this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField}),a=0;a<l.length;a++)r=l[a].formula,0==e.grep(this._calculatedField,function(e){return e.name==l[a].fieldName}).length&&(r=r.replace(/\s+|\s+$/gm,""),r=(r=this._parenthesisAsterisk(r)).replace(/[-+/^%*]/g,function(e){return" "+e+" "}),this._calculatedField.push({name:l[a].fieldName,formula:r,format:l[a].format,formatString:l[a].formatString})),l[a].formula=r,this.model.dataSource.values.push(l[a]);t.PivotAnalysis._controlObj=this,o=t.PivotAnalysis.pivotEnginePopulate(this.model),this.setJSONRecords(JSON.stringify(o.json)),this.setOlapReport(this.model.dataSource),this._createGroupingBar(this.model.dataSource),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this.excelLikeLayout(o.json):this.renderControlFromJSON(),t.isNullOrUndefined(i)||(i._isTimeOut=!1),this._waitingPopup.hide(),this._trigger("renderSuccess",this),t.isNullOrUndefined(this._pivotClientObj)||void 0===this._pivotClientObj._pivotSchemaDesigner||(this._schemaData=this._pivotClientObj._pivotSchemaDesigner),null!=this._schemaData&&(t.isNullOrUndefined(this._schemaData._waitingPopup)?this._waitingPopup.hide():this._schemaData._waitingPopup.hide(),this._calculatedField.length>0&&this._schemaCalculatedField())},_setFirst:!1,_setModel:function(i){for(var l in i)switch(l){case"OlapReport":case"JsonData":this.setOlapReport(i[l]);break;case"RefreshOlapGrid":this.element.renderControlFromJSON(i[l]);break;case"layout":this.layout(t.util.getVal(i[l])),this._load();break;case"customObject":this.model.customObject=i[l];break;case"enableCellContext":this.enableCellContext(t.util.getVal(i[l])),this._load();break;case"enableDefaultValue":this.model.enableDefaultValue=i[l];break;case"hyperlinkSettings":!t.isNullOrUndefined(t.util.getVal(i[l]).enableValueCellHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableValueCellHyperlink)?this.enableValueCellHyperlink(i[l].enableValueCellHyperlink()):t.isNullOrUndefined(i[l].enableValueCellHyperlink)||this.enableValueCellHyperlink(i[l].enableValueCellHyperlink),!t.isNullOrUndefined(t.util.getVal(i[l]).enableRowHeaderHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableRowHeaderHyperlink)?this.enableRowHeaderHyperlink(i[l].enableRowHeaderHyperlink()):t.isNullOrUndefined(i[l].enableRowHeaderHyperlink)||this.enableRowHeaderHyperlink(i[l].enableRowHeaderHyperlink),!t.isNullOrUndefined(t.util.getVal(i[l]).enableColumnHeaderHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableColumnHeaderHyperlink)?this.enableColumnHeaderHyperlink(i[l].enableColumnHeaderHyperlink()):t.isNullOrUndefined(i[l].enableColumnHeaderHyperlink)||this.enableColumnHeaderHyperlink(i[l].enableColumnHeaderHyperlink),!t.isNullOrUndefined(t.util.getVal(i[l]).enableSummaryCellHyperlink)&&e.isFunction(t.util.getVal(i[l]).enableSummaryCellHyperlink)?this.enableSummaryCellHyperlink(i[l].enableSummaryCellHyperlink()):t.isNullOrUndefined(i[l].enableSummaryCellHyperlink)||this.enableSummaryCellHyperlink(i[l].enableSummaryCellHyperlink),this._load();break;case"operationalMode":this.model.operationalMode=i[l];break;case"analysisMode":this.model.analysisMode=i[l];break;case"locale":this.locale(t.util.getVal(i[l])),this._load();break;case"dataSource":this.model.dataSource=e.extend({},this.model.dataSource,i[l]),this.refreshControl(),this._schemaData&&this._schemaData._load();break;case"enableGroupingBar":case"enableDeferUpdate":this.model.enableGroupingBar=i[l],this._load();break;case"enableJSONRendering":this.model.enableJSONRendering=i[l],this._load();break;case"enableVirtualScrolling":this.model.enableVirtualScrolling=i[l],this._load();break;case"enablePaging":this.model.enablePaging=i[l],this._load();break;case"enableColumnResizing":this.model.enableColumnResizing=i[l],this._load();break;case"resizeColumnsToFit":this.model.resizeColumnsToFit=i[l],this.renderControlFromJSON();break;case"enableContextMenu":this.model.enableContextMenu=i[l],this._load();break;case"enableRTL":this.model.enableRTL=i[l],this._load();break;case"enableToolTip":this.model.enableToolTip=i[l];break;case"enableToolTipAnimation":this.model.enableToolTipAnimation=i[l];break;case"enableCellSelection":this.model.enableCellSelection=i[l],this._load();break;case"enableConditionalFormatting":this.model.enableConditionalFormatting=i[l],this._load();break;case"enableCellEditing":this.model.enableCellEditing=i[l],this._load();break;case"enableColumnGrandTotal":this.model.enableColumnGrandTotal=i[l],this._load();break;case"enableRowGrandTotal":this.model.enableRowGrandTotal=i[l],this._load();break;case"enableGrandTotal":this.model.enableGrandTotal=i[l],this._load();break;case"enableCollapseByDefault":this.model.enableCollapseByDefault=i[l],this._load();break;case"enableCellDoubleClick":this.model.enableCellDoubleClick=i[l],this._load();break;case"enableDrillThrough":this.model.enableDrillThrough=i[l],this._load();break;case"isResponsive":this.model.isResponsive=i[l],this._load();break;case"enableAdvancedFilter":this.model.enableAdvancedFilter=i[l],this._load();break;case"showUniqueNameOnPivotButton":this.model.showUniqueNameOnPivotButton=i[l],this._load();break;case"enableMemberEditorPaging":this.model.enableMemberEditorPaging=i[l],this._load();break;case"frozenHeaderSettings":this.model.frozenHeaderSettings=e.extend({},this.model.frozenHeaderSettings,i[l]),this.refreshControl();break;case"valueSortSettings":this.model.valueSortSettings=e.extend({},this.model.valueSortSettings,i[l]),this.refreshControl()}},_wireEvents:function(){this.model.enableCellDoubleClick&&this._on(this.element,"dblclick",".value, .summary",this._cellRangeInfo),this.model.enableCellClick&&this._on(this.element,"click",".value, .summary",this._cellRangeInfo),this._on(this.element,"mouseover",".value,.rowheader,.colheader,.summary",t.proxy(function(i){var l,a,r;e(i.target).hasClass("cellValue")||e(i.target).children().hasClass("cellValue")||(l=e(i.target).contents().filter(function(){return 3==this.nodeType}),t.isNullOrUndefined(l.text())||""==e.trim(l.text())||(r=(a=e(i.target).find(".valueSorting").length>0)?e(i.target).find(".valueSorting"):"",e(i.target).find(".valueSorting").remove(),e(i.target).contents().filter(function(){return 3==this.nodeType}).remove(),e(i.target).append("<span class='cellValue'>"+l.text()+"</span>"),a&&(e(i.target).hasClass("colheader")||e(i.target).hasClass("summary"))&&e(i.target).hasClass("calc")&&!e(i.target).hasClass("rowheader")&&e(i.target).append(r)))})),this._on(this.element,"contextmenu",".value,.rowheader,.colheader,.summary",t.proxy(function(i){var l;if(this.model.enableContextMenu&&t.isNullOrUndefined(this._pivotClientObj)&&!this.model.enableCellContext){i.preventDefault();var a,r,o="",s="";r=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?"<li><a>"+this._getLocalizedLabels("Layouts")+"</a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"</a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"</a><li></ul></li>":this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?"<li><a>"+this._getLocalizedLabels("Layouts")+"</a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"</a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"</a><li><li id='noSummariesLayout'><a>"+this._getLocalizedLabels("NoSummaries")+"</a><li></ul></li>":"<li><a>"+this._getLocalizedLabels("Layouts")+"</a><ul><li id='normalLayout'><a>"+this._getLocalizedLabels("NormalLayout")+"</a><li><li id='excelLikeLayout'><a>"+this._getLocalizedLabels("ExcelLikeLayout")+"</a><li><li id='noSummariesLayout'><a>"+this._getLocalizedLabels("NoSummaries")+"</a><li><li id='normalTopSummaryLayout'><a>"+this._getLocalizedLabels("NormalTopSummary")+"</a><li></ul></li>",a=this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode?t.buildTag("li.e-advancedFiltering",t.buildTag("a",this._getLocalizedLabels("AdvancedFiltering"))[0].outerHTML)[0].outerHTML:"",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(s=t.buildTag("li.e-collapseByDefault",t.buildTag("a",this._getLocalizedLabels("CollapseByDefault"))[0].outerHTML)[0].outerHTML),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(o=t.buildTag("li.e-numberFormatting",t.buildTag("a",this._getLocalizedLabels("NumberFormatting"))[0].outerHTML)[0].outerHTML);var n="<li><a>"+this._getLocalizedLabels("HyperLink")+"</a><ul><li id='rowHeader'><a>"+this._getLocalizedLabels("EnableRowHeaderHyperlink")+"</a></li><li id='columnHeader'><a>"+this._getLocalizedLabels("EnableColumnHeaderHyperlink")+"</a></li><li id='valueCell'><a>"+this._getLocalizedLabels("EnableValueCellHyperlink")+"</a></li><li id='summaryCell'><a>"+this._getLocalizedLabels("EnableSummaryCellHyperlink")+"</a></li></ul></li>",d="<li><a>"+this._getLocalizedLabels("Exporting")+"</a><ul><li id='excel'><a>"+this._getLocalizedLabels("Excel")+"</a></li><li id='word'><a>"+this._getLocalizedLabels("Word")+"</a></li><li id='pdf'><a>"+this._getLocalizedLabels("PDF")+"</a></li><li id='csv'><a>"+this._getLocalizedLabels("CSV")+"</a></li></ul></li>",h="<li class='e-separator'><a>"+this._getLocalizedLabels("FrozenHeader")+"</a><ul><li id='row'><a>"+this._getLocalizedLabels("Row")+"</a></li><li id='column'><a>"+this._getLocalizedLabels("Column")+"</a></li></ul></li>",c=t.buildTag("ul#"+this._id+"contextMenu.e-pivotGridContextMenu",t.buildTag("li.e-cellSelect",t.buildTag("a",this._getLocalizedLabels("CellSelection"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-columnResize",t.buildTag("a",this._getLocalizedLabels("ColumnResize"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-toolTip",t.buildTag("a",this._getLocalizedLabels("ToolTip"))[0].outerHTML)[0].outerHTML+s+a+t.buildTag("li.groupingBar",t.buildTag("a",this._getLocalizedLabels("GroupingBar"))[0].outerHTML)[0].outerHTML+("pivot"==this.model.analysisMode?t.buildTag("li.e-cellEditing",t.buildTag("a",this._getLocalizedLabels("CellEditing"))[0].outerHTML)[0].outerHTML:"")+t.buildTag("li.e-drillThrough",t.buildTag("a",this._getLocalizedLabels("DrillThrough"))[0].outerHTML)[0].outerHTML+t.buildTag("li.rtl",t.buildTag("a",this._getLocalizedLabels("RTL"))[0].outerHTML)[0].outerHTML+r+n+d+h+t.buildTag("li.e-summaryCustomize",t.buildTag("a",this._getLocalizedLabels("SummaryCustomization"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-conditionalFormat",t.buildTag("a",this._getLocalizedLabels("ConditionalFormatting"),{})[0].outerHTML)[0].outerHTML+("pivot"==this.model.analysisMode?t.buildTag("li.e-calculatedField",t.buildTag("a",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML+o+(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?t.buildTag("li.e-summaryTypes",t.buildTag("a",this._getLocalizedLabels("SummaryTypes"),{})[0].outerHTML)[0].outerHTML:""):""))[0].outerHTML;e("#"+this._id).append(c),e("li.rtl").addClass("e-separator"),l=this.element.find(".e-pivotGridTable"),this.element.find("#"+this._id+"contextMenu").ejMenu({width:"200px",menuType:t.MenuType.ContextMenu,contextMenuTarget:l,enableRTL:this.model.enableRTL,click:t.proxy(this._contextMenuClick,this)}),this._stateMaintenance()}})),this._on(e(document),"keydown",this._keyDownPress),this._on(e(document),"keyup",this._keyUpPress),this._on(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this.model.enableCellSelection&&(this._on(this.element,"mousedown touchstart",".value",this._initCellSelection),this._on(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection)),1==this.enableCellContext()&&(document.addEventListener?(document.removeEventListener("contextmenu",this._cellContext,!1),document.addEventListener("contextmenu",this._cellContext,!1)):(document.detachEvent("oncontextmenu",this._cellContext),document.attachEvent("oncontextmenu",this._cellContext))),this._on(this.element,"mouseover",".e-pivotButton",t.proxy(function(e){this._isDragging&&(this.element.append(t.buildTag("span.e-dropIndicator e-dropIndicatorActive")[0].outerHTML),e.target.className.indexOf("e-pivotButton")>=0?this.element.find(".e-dropIndicator").css("top",e.target.getBoundingClientRect().top-20).css("left",e.target.getBoundingClientRect().left-3):this.element.find(".e-dropIndicator").css("top",e.target.parentElement.getBoundingClientRect().top-20).css("left",e.target.parentElement.getBoundingClientRect().left-3))},this)),this._on(this.element,"mouseleave",".e-pivotButton",t.proxy(function(){this._isDragging&&this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorActive")},this)),this._on(this.element,"click","#preventDiv",t.proxy(function(){this.element.find(".e-dialog.e-advancedFilterDlg:visible").length>0&&(this.element.find(".e-dialog.e-advancedFilterDlg").hide(),this.element.find("#preventDiv").remove())},this)),this.model.enableCellEditing&&this._on(this.element,"mousedown",".value",this._initCellEditing),this.drillDownHandler=e.proxy(this._drillDown,this),this.addHyperlinkHandler=e.proxy(this._addHyperlink,this),this.removeHyperlinkHandler=e.proxy(this._removeHyperlink,this),this.model.enableCellSelection&&(e(document).on("click",this._clearSelection),e(document).on("keyup",this._endCellSelection),e(document).on("keydown",this._startCellSelection)),this._on(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.addHyperlinkHandler),this._on(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",this.removeHyperlinkHandler),this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue",function(i){if(-1!=i.target.className.indexOf("hyperlink")){var l=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i.target.parentElement).attr("data-i"):e(i.target.parentElement).attr("data-p"),a=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords[parseInt(parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]))].Info:this.getJSONRecords()[parseInt(parseInt(l.split(",")[0])*this._excelRowCount+parseInt(l.split(",")[1]))].Info,r={cellValue:i.target.innerHTML,cellPosition:l,cellType:i.target.parentElement.className.split(" ")[0],uniqueName:a.split("::")[0],args:i,rawdata:a};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&i.target.parentElement.className.indexOf("summary")>=0||i.target.parentElement.className.indexOf("summary value")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("summaryCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("value")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("valueCellHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("rowheader")>=0?t.isNullOrUndefined(this._pivotClientObj)?this._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("rowHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):i.target.parentElement.className.indexOf("colheader")>=0&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r}):this._pivotClientObj._trigger("columnHeaderHyperlinkClick",{element:this.element,customObject:this.model.customObject,args:r})),i.target.parentElement.className.indexOf("value")>=0&&this.model.enableDrillThrough&&(this._rowHeader=[],this._colHeader=[],this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.Pivot._drillThroughCellClick(i,this):this._cellRangeInfo(i))}}),this._on(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?".rowheader, .colheader, .summary":".rowheader, .colheader",function(i){var l,a,r,o,s,n,d,h;if(this.model.enableCellSelection&&(!e(i.target).hasClass("cellValue")||!e(i.target).hasClass("hyperlinkHeaderCell")))if(l=e(i.target).hasClass("cellValue")?i.target.parentElement:i.target,i.shiftKey){if(window.getSelection().removeAllRanges(),e(this.element).find(".e-selected").removeClass("e-selected"),a=e(this._selectedCell).attr("data-p"),r=e(l).attr("data-p"),(e(l).hasClass("rowheader")||"rowheader"==e(l).attr("role"))&&(e(this._selectedCell).hasClass("rowheader")||"rowheader"==e(this._selectedCell).attr("role")))for(n=Math.min(a.split(",")[1],r.split(",")[1]);n<=Math.max(a.split(",")[1],r.split(",")[1]);n++)this.element.find("[data-p='"+a.split(",")[0]+","+n+"']").addClass("e-selected");if((e(l).hasClass("colheader")||"columnheader"==e(l).attr("role"))&&(e(this._selectedCell).hasClass("colheader")||"columnheader"==e(this._selectedCell).attr("role")))for(n=Math.min(a.split(",")[0],r.split(",")[0]);n<=Math.max(a.split(",")[0],r.split(",")[0]);n++)this.element.find("[data-p='"+n+","+a.split(",")[1]+"']").addClass("e-selected");if((o=e(this.element).find(".e-selected")).length>0){for(s=[],n=0;n<o.length;n++)d=e(o[n]).attr("data-p"),(h=this.getJSONRecords()[parseInt(parseInt(d.split(",")[0])*this._rowCount+parseInt(d.split(",")[1]))]).Value=e.trim(e(o[n]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(h.Field=this._getFieldName(o[n])),s.push(h);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:s}):this._pivotClientObj._trigger("cellSelection",s)}}else i.ctrlKey||e(this.element).find(".e-selected").removeClass("e-selected"),(e(l).hasClass("colheader")||e(l).hasClass("rowheader")||"rowheader"==e(l).attr("role")||"columnheader"==e(l).attr("role"))&&(i.ctrlKey?e(l).toggleClass("e-selected"):e(l).addClass("e-selected"),this._selectedCell=l,this._primaryCellPos=e(l).attr("data-p"),(h=this.getJSONRecords()[parseInt(parseInt(this._primaryCellPos.split(",")[0])*this._rowCount+parseInt(this._primaryCellPos.split(",")[1]))]).Value=e.trim(e(l).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(h.Field=this._getFieldName(l)),i.ctrlKey||(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:[h]}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:[h]})))}),t.isNullOrUndefined(this._pivotClientObj)?this._on(this.element,"click","table .e-expand,table .e-collapse",t.proxy(this._drillDown,this)):this._pivotClientObj.model.enableDeferUpdate||this._on(this.element,"click","table .e-expand,table .e-collapse",t.proxy(this._drillDown,this)),this._on(this.element,"mouseover",".colheader, .rowheader, .e-expand, .e-collapse",function(t){if(t.target.className.indexOf("e-expand")>-1&&!e(t.target).hasClass("header-hover-expand"))e(t.target).addClass("header-hover-expand");else if(t.target.className.indexOf("e-collapse")>-1&&!e(t.target).hasClass("header-hover-collapse"))e(t.target).addClass("header-hover-collapse");else if((t.target.className.indexOf("e-expand")<0||t.target.className.indexOf("e-collapse")<0)&&e(t.target).children("span").length>0){var i=e(t.target).children("span")[0];!e(i).hasClass("header-hover-expand")&&i.className.indexOf("e-expand")>-1?e(i).addClass("header-hover-expand"):!e(i).hasClass("header-hover-collapse")&&i.className.indexOf("e-collapse")>-1&&e(i).addClass("header-hover-collapse")}}),this._on(this.element,"mouseleave",".colheader, .rowheader, .e-expand, .e-collapse",function(){this.element.find(".e-expand, .e-collapse").removeClass("header-hover-expand header-hover-collapse")}),this.model.enableToolTip&&(this._on(this.element,"mouseover",".value",this._applyToolTip),this._on(this.element,"mouseleave",".value",function(){this.model.enableToolTipAnimation?e("#"+this._id+"_gridTooltip").hide("slow"):e("#"+this._id+"_gridTooltip").hide()})),this.model.enableDrillThrough&&e.proxy(this._addHyperlink,this),this._on(this.element,"click",".filter",t.proxy(this._filterBtnClick,this)),this._on(this.element,"click",".e-sorting",t.proxy(this._sortBtnClick,this)),this._on(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this)),this._on(this.element,"click",".e-removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this)),this._on(this.element,"click",".e-ascOrder, .e-descOrder",t.proxy(this._sortField,this)),this._on(this.element,"mouseover",".e-pvtBtn",function(t){e(t.target.parentElement).addClass("e-btn e-select")}),this._on(this.element,"mouseleave",".e-pvtBtn",function(t){e(t.target.parentElement).removeClass("e-btn e-select"),e(t.target).removeClass("e-hoverBtn")}),this._on(this.element,"mouseover",".e-pivotButton",function(t){t.target.title=t.target.textContent,e(t.target).find("button").addClass("e-hoverBtn")}),this._on(this.element,"mouseleave",".e-pivotButton",function(t){e(t.target).find("button").removeClass("e-hoverBtn")}),this._on(this.element,"mouseover",".filter,.e-sorting,.e-removeBtn",function(t){e(t.target.parentElement).find("button").addClass("e-hoverBtn")}),this._on(this.element,"mouseleave",".filter,.e-sorting,.e-removeBtn",function(t){e(t.target.parentElement).find("button").removeClass("e-hoverBtn")}),this._on(this.element,"mouseleave",".value,.rowheader,.colheader,.summary",t.proxy(function(t){var i,l,a=e(t.target).find(".cellValue").contents().filter(function(){return 3==this.nodeType});0!=a.text()&&(l=(i=e(t.target).find(".valueSorting").length>0)?e(t.target).find(".valueSorting"):"",e(t.target).find(".valueSorting").remove(),e(t.target).find(".cellValue").remove(),e(t.target).append(a.text()),i&&(e(t.target).hasClass("colheader")||e(t.target).hasClass("summary"))&&e(t.target).hasClass("calc")&&!e(t.target).hasClass("rowheader")&&e(t.target).append(l))})),this._on(this.element,"click",".e-close",t.proxy(function(){this.element.find("#preventDiv").remove()})),this._on(this.element,"click",".e-dialogOkBtn",t.proxy(this._dialogOKBtnClick,this)),(this.model.enableContextMenu||e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen)&&(this._on(this.element,"click",".e-cellSelect",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-columnResize",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-excelLikeLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-advancedFiltering",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-toolTip",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-collapseByDefault",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".rtl",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-calculatedField",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-cellEditing",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-conditionalFormat",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryCustomize",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryTypes",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-numberFormatting",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-rowHeaderHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-colHeaderHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-valueCellHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-summaryCellHyperLink",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-rowFreeze",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-colFreeze",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-excel",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-word",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-pdf",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".csv",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-normalLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-normalTopSummaryLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-noSummariesLayout",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-drillThrough",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".groupingBar",t.proxy(this._contextMenuClick,this)),this._on(this.element,"click",".e-frozenHeaders",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-exporting",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-hyperlinkOptions",t.proxy(this._createMenuIcons,this)),this._on(this.element,"click",".e-layouts",t.proxy(this._createMenuIcons,this)),e(document).click(function(t){-1==t.target.className.indexOf("e-hyperlinkOptions")&&e(".e-hyperLinkDialog").remove(),-1==t.target.className.indexOf("e-exporting")&&e(".e-exportDialog").remove(),-1==t.target.className.indexOf("e-frozenHeaders")&&e(".e-frozenDialog").remove(),-1==t.target.className.indexOf("e-layouts")&&e(".e-layoutsDialog").remove()})),this._on(this.element,"click",".e-dialogCancelBtn",t.proxy(function(){this.element.find(".e-dialog, .e-clientDialog").hide(),e("#preventDiv").remove()})),this.model.enableColumnResizing&&(this._on(this.element,"mousemove",t.proxy(function(e){this._colResizing(e)})),this._on(this.element,"mousedown","thead,.pivotGridFrozenTable,.pivotGridColValueTable",t.proxy(function(e){this._startColResizing(e)})),this._on(this.element,"mouseup",".e-reSizeColbg",t.proxy(function(e){this._endColResizing(e)}))),this._on(this.element,"click",".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage",t.proxy(this._navigateTreeData,this)),this._on(this.element,"click",".e-searchEditorTree",t.proxy(function(e){t.Pivot._searchEditorTreeNodes(e,this)},this)),this._on(this.element,"click",".colheader,.cstot,.cgtot,.calc,.stot,.gtot",t.proxy(function(i){var l,a,r,o,s,n;if(e(i.target).hasClass("e-collapse")||e(i.target).hasClass("e-expand"))return!1;if(!t.isNullOrUndefined(this.model.valueSortSettings)&&!t.isNullOrUndefined(this.model.valueSortSettings.sortOrder)&&"none"!=this.model.valueSortSettings.sortOrder&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.values.length>0||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0)){if(l=this.model.valueSortSettings.sortOrder,(a=e(i.target).hasClass("cellValue")||e(i.target).hasClass("valueSorting")||e(i.target).hasClass("e-expand")||e(i.target).hasClass("e-collapse")?e(i.target).parent():e(i.target)).hasClass("calc")||(a=e(this.element).find("[data-p='"+(Number(a.attr("data-p").split(",")[0])+Number(a.attr("colspan"))-1)+","+(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns.length:JSON.parse(this.getOlapReport()).PivotColumns.length)+"']")[0]),l=e(a).find(".valueSorting").length>0?e(a).find(".valueSorting").hasClass("descending")?"ascending":"descending":l,this.element.find(".valueSorting").remove(),0!=e(a).find(".valueSorting").length||e(a).hasClass("rowheader")?e(a).find(".valueSorting").removeClass("ascending").removeClass("descending").addClass(l):(r=t.buildTag("span.valueSorting e-icon "+l).css("margin-left","5px").attr("role","button").attr("aria-label","sort")[0].outerHTML,e(a).append(r)),o=JSON.stringify(this.model.customObject),t.PivotAnalysis._valueSorting=Number(e(a).attr("data-p").split(",")[0]),t.PivotAnalysis._sort=l,this._waitingPopup=t.isNullOrUndefined(this._pivotClientObj)?this.element.data("ejWaitingPopup"):this._pivotClientObj.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)this.refreshControl(),t.isNullOrUndefined(this._pivotClientObj)||"gridOnly"==this._pivotClientObj.displayMode()||(this._pivotClientObj._pivotChart._labelCurrentTags.expandedMembers=null,this._pivotClientObj._pivotChart.setPivotEngine(this._pivotEngine.pivotEngine),this._pivotClientObj._pivotChart._generateData(this._pivotEngine.pivotEngine),this._pivotEngine=null);else{for(s="",n=0;n<this.getJSONRecords().length;n++)Number(this.getJSONRecords()[n].Index.split(",")[0])==t.PivotAnalysis._valueSorting&&Number(this.getJSONRecords()[n].Index.split(",")[1])<JSON.parse(this.getOlapReport()).PivotColumns.length+1&&(s=""==s?-1==this.getJSONRecords()[n].Value.indexOf(".")?this.getJSONRecords()[n].Value:this.getJSONRecords()[n].Value.split(".")[1]:s+this.model.valueSortSettings.headerDelimiters+(-1==this.getJSONRecords()[n].Value.indexOf(".")?this.getJSONRecords()[n].Value:this.getJSONRecords()[n].Value.split(".")[1]));this.model.valueSortSettings.index=t.PivotAnalysis._valueSorting,this.model.valueSortSettings.headerText=s,this.model.valueSortSettings.sortOrder=l,t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.valueSorting,JSON.stringify({action:"valueSorting",valueSorting:JSON.stringify(this.model.valueSortSettings),currentReport:JSON.parse(this.getOlapReport()).Report,customObject:o}),this._renderControlSuccess):this._pivotClientObj.doAjaxPost("POST",this._pivotClientObj.model.url+"/"+this._pivotClientObj.model.serviceMethodSettings.valueSorting,JSON.stringify({action:"valueSorting",valueSorting:JSON.stringify(this.model.valueSortSettings),currentReport:JSON.parse(this._pivotClientObj.getOlapReport()).Report,customObject:o}),this._pivotClientObj._renderControlSuccess),delete this.model.valueSortSettings.index}t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.model.valueSortSettings=this.model.valueSortSettings)}}))},_navigateTreeData:function(e){t.Pivot.editorTreeNavigatee(e,this)},_stateMaintenance:function(){var i=t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label",this._getLocalizedLabels("EnabledState"))[0].outerHTML;this.model.dataSource.enableAdvancedFilter&&(this.element.parents(".e-pivotclient").length>0?e(".e-advancedFiltering").addClass("e-enabled"):e(".e-advancedFiltering a:eq(0)").append(i)),this.model.enableDrillThrough&&(e(".e-drillThrough a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellEditing"))),this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableDrillThrough&&(this.element.find(".e-drillThrough").addClass("e-enabled"),this.element.find(".toolBar").ejToolbar("disableItemByID","cellEditing")),!this.model.enableToolTip||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||(this.element.parents(".e-pivotclient").length>0?e(".e-toolTip").addClass("e-enabled"):e(".e-toolTip a:eq(0)").append(i)),this.model.enableCellSelection&&(e(".e-cellSelect a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellEditing"))),this.model.enableColumnResizing&&(this.element.parents(".e-pivotclient").length>0?(e(".e-columnResize").addClass("e-enabled"),e(".toolBar").ejToolbar("disableItemByID","collapseByDefault")):(e(".e-columnResize a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CollapseByDefault")))),this.model.enableGroupingBar&&e(".groupingBar a:eq(0)").append(i),this.model.enableRTL&&(this.element.parents(".e-pivotclient").length>0?e(".rtl").addClass("e-enabled"):e(".rtl a:eq(0)").append(i)),this.model.enableCollapseByDefault&&(this.element.parents(".e-pivotclient").length>0?(e(".toolBar").ejToolbar("disableItemByID","columnResize"),e(".e-collapseByDefault").addClass("e-enabled")):(e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("ColumnResize")),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("FrozenHeader")),e(".e-collapseByDefault a:eq(0)").append(i))),this.model.enableCellEditing&&(this.element.parents(".e-pivotclient").length>0?(this.element.find(".e-cellEditing").addClass("e-enabled"),this.element.find(".toolBar").ejToolbar("disableItemByID","drillThrough")):e(".e-cellEditing a:eq(0)").append(i),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("DrillThrough")),e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("CellSelection"))),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&e("li#row a:eq(0)").append(i),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&e("li#column a:eq(0)").append(i),this.model.hyperlinkSettings.enableRowHeaderHyperlink&&e("li#rowHeader a:eq(0)").append(i),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&e("li#columnHeader a:eq(0)").append(i),this.model.hyperlinkSettings.enableValueCellHyperlink&&e("li#valueCell a:eq(0)").append(i),this.model.hyperlinkSettings.enableSummaryCellHyperlink&&e("li#summaryCell a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.Normal&&e("li#normalLayout a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.NoSummaries&&e("li#noSummariesLayout a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout&&e("li#excelLikeLayout a:eq(0)").append(i),this.model.layout==t.PivotGrid.Layout.NormalTopSummary&&e("li#normalTopSummaryLayout a:eq(0)").append(i),(this.model.layout==t.PivotGrid.Layout.NormalTopSummary||this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout||this.model.layout==t.PivotGrid.Layout.NoSummaries||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.element.parents(".e-pivotclient").length>0?e(".toolBar").ejToolbar("disableItemByID","summaryCustomize"):e("#"+this._id+"contextMenu").ejMenu("disableItem",this._getLocalizedLabels("SummaryCustomization")))},_contextMenuClick:function(i){var a,r;t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label","")[0].outerHTML,this.element.parents(".e-pivotclient").length>0?e(i.target):e(i.element);(e(i.element).hasClass("e-numberFormatting")||e(i.target).hasClass("e-numberFormatting"))&&this._createMenuDialog(i),(e(i.element).hasClass("e-cellSelect")||e(i.target).hasClass("e-cellSelect"))&&(this.model.enableCellSelection=!this.model.enableCellSelection,this.model.enableCellEditing=!1,this.renderControlFromJSON()),(e(i.element).hasClass("e-columnResize")||e(i.target).hasClass("e-columnResize"))&&!this.model.enableCollapseByDefault&&(this.model.enableColumnResizing=!this.model.enableColumnResizing,this.renderControlFromJSON()),(e(i.element).hasClass("e-toolTip")||e(i.target).hasClass("e-toolTip"))&&(this.model.enableToolTip=!this.model.enableToolTip,this.renderControlFromJSON()),!e(i.element).hasClass("e-collapseByDefault")&&!e(i.target).hasClass("e-collapseByDefault")||this.model.enableColumnResizing||this.model.enableFrozenColumnHeaders||this.model.enableFrozenRowHeaders||(this.model.enableCollapseByDefault?this.model.enableCollapseByDefault=!1:(this.model.enableCollapseByDefault=!0,this.model.collapsedMembers=null),this.renderControlFromJSON()),(e(i.element).hasClass("rtl")||e(i.target).hasClass("rtl"))&&(this.model.enableRTL=!this.model.enableRTL,this.renderControlFromJSON()),(e(i.element).hasClass("e-calculatedField")||e(i.target).hasClass("e-calculatedField"))&&this._createCalculatedField(),(e(i.element).hasClass("e-cellEditing")||e(i.target).hasClass("e-cellEditing"))&&(this.model.enableCellEditing=!this.model.enableCellEditing,this.model.enableDrillThrough=!1,this.model.enableCellSelection=!1,this.renderControlFromJSON()),(e(i.element).hasClass("e-drillThrough")||e(i.target).hasClass("e-drillThrough"))&&(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(dialogTitle="Cube Configuration",dialogContent="<p>Please configure cube!</p>",a=t.buildTag("div#clientDialog.e-clientDialog",{opacity:"1"}).attr("title",dialogTitle)[0].outerHTML,e(a).appendTo("#"+this._id),e(dialogContent).appendTo(this.element.find(".e-clientDialog")),this.element.find(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:200,target:"#"+this._id,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)})):this.element.parents(".e-pivotclient").length>0?(this._pivotClientObj.model.enableDrillThrough=!this._pivotClientObj.model.enableDrillThrough,this.model.enableDrillThrough=this._pivotClientObj.model.enableDrillThrough,this.model.enableCellEditing=!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this.renderControlFromJSON():this._pivotClientObj._load()):(this.model.enableDrillThrough=!this.model.enableDrillThrough,this.model.enableCellEditing=!1,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this.renderControlFromJSON():this._load())),(e(i.element).hasClass("e-summaryCustomize")||e(i.target).hasClass("e-summaryCustomize"))&&this._createMenuDialog(i),(e(i.element).hasClass("e-conditionalFormat")||e(i.target).hasClass("e-conditionalFormat"))&&(this.element.parents(".e-pivotclient").length>0&&"clientmode"==this._pivotClientObj.model.operationalMode&&this.setOlapReport(this._pivotClientObj.model.dataSource),this.model.enableConditionalFormatting=!0,this.openConditionalFormattingDialog(),t.Pivot.closePreventPanel(this)),(e(i.element).hasClass("e-summaryTypes")||e(i.target).hasClass("e-summaryTypes"))&&this._createMenuDialog(i),(e(i.element).hasClass("e-advancedFiltering")||e(i.target).hasClass("e-advancedFiltering"))&&(this.model.dataSource.enableAdvancedFilter=!this.model.dataSource.enableAdvancedFilter,this.renderControlFromJSON()),e(i.element).hasClass("groupingBar")&&(this.model.enableGroupingBar=!this.model.enableGroupingBar,this.renderControlFromJSON()),("undefined"!=i.element&&i.parentText==this._getLocalizedLabels("Layouts")||e(i.target).parents().hasClass("e-layoutsDialog"))&&(("normalLayout"==i.ID||e(i.target).hasClass("e-normalLayout"))&&(this.model.layout=t.PivotGrid.Layout.Normal,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="normal")),("excelLikeLayout"==i.ID||e(i.target).hasClass("e-excelLikeLayout"))&&(this.model.layout=t.PivotGrid.Layout.ExcelLikeLayout,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="excellikelayout")),("noSummariesLayout"==i.ID||e(i.target).hasClass("e-noSummariesLayout"))&&(this.model.layout=t.PivotGrid.Layout.NoSummaries,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="nosummaries")),("normalTopSummaryLayout"==i.ID||e(i.target).hasClass("e-normalTopSummaryLayout"))&&(this.model.layout=t.PivotGrid.Layout.NormalTopSummary,this.element.parents(".e-pivotclient").length>0&&(this._pivotClientObj.model.gridLayout="normaltopsummary")),"excelLikeLayout"==i.ID||e(i.target).hasClass("e-excelLikeLayout")?this.excelLikeLayout(this.getJSONRecords()):(this._excelLikeJSONRecords=null,this.refreshPivotGrid())),("undefined"!=i.element&&i.parentText==this._getLocalizedLabels("HyperLink")||e(i.target).parents().hasClass("e-hyperLinkDialog"))&&(("rowHeader"==i.ID||e(i.target).hasClass("e-rowHeaderHyperLink"))&&(this.model.hyperlinkSettings.enableRowHeaderHyperlink=!this.model.hyperlinkSettings.enableRowHeaderHyperlink),("columnHeader"==i.ID||e(i.target).hasClass("e-colHeaderHyperLink"))&&(this.model.hyperlinkSettings.enableColumnHeaderHyperlink=!this.model.hyperlinkSettings.enableColumnHeaderHyperlink),("valueCell"==i.ID||e(i.target).hasClass("e-valueCellHyperLink"))&&(this.model.hyperlinkSettings.enableValueCellHyperlink=!this.model.hyperlinkSettings.enableValueCellHyperlink),("summaryCell"==i.ID||e(i.target).hasClass("e-summaryCellHyperLink"))&&(this.model.hyperlinkSettings.enableSummaryCellHyperlink=!this.model.hyperlinkSettings.enableSummaryCellHyperlink),this.renderControlFromJSON()),(i.element!=l&&i.parentText==this._getLocalizedLabels("Exporting")||e(i.target).parents().hasClass("e-exportDialog"))&&(r=this.element.parents(".e-pivotclient").length>0?e(i.target).attr("class").split(" ")[0]:i.ID,this.element.parents(".e-pivotclient").length>0&&!t.isNullOrUndefined(this._pivotClientObj)&&(this.model.beforeExport=this._pivotClientObj.model.beforeExport),this.exportPivotGrid(r,"Sample")),(i.element!=l&&i.parentText==this._getLocalizedLabels("FrozenHeader")||e(i.target).parents().hasClass("e-frozenDialog"))&&(("row"==i.ID||e(i.target).hasClass("e-rowFreeze"))&&(this.model.frozenHeaderSettings.enableFrozenRowHeaders=!this.model.frozenHeaderSettings.enableFrozenRowHeaders),("column"==i.ID||e(i.target).hasClass("e-colFreeze"))&&(this.model.frozenHeaderSettings.enableFrozenColumnHeaders=!this.model.frozenHeaderSettings.enableFrozenColumnHeaders),this.renderControlFromJSON()),this._unWireEvents(),this._wireEvents()},_createMenuIcons:function(i){var l,a,r,o;e(i.target).hasClass("e-exporting")&&(l=t.buildTag("div.e-exportDialog#exportDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-excel e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("Excel"),title:this._getLocalizedLabels("Excel"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-word e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("Word"),title:this._getLocalizedLabels("Word"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pdf e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("PDF"),title:this._getLocalizedLabels("PDF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.csv e-exportingIcons").attr({"aria-label":this._getLocalizedLabels("CSV"),title:this._getLocalizedLabels("CSV"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,0==this.element.find("div .e-exportDialog").length&&(e(l).appendTo(this.element),e(".e-exportDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"))),e(i.target).hasClass("e-hyperlinkOptions")&&(a=t.buildTag("div.e-hyperLinkDialog#hyperLinkTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rowHeaderHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableRowHeaderHyperlink"),title:this._getLocalizedLabels("EnableRowHeaderHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-colHeaderHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableColumnHeaderHyperlink"),title:this._getLocalizedLabels("EnableColumnHeaderHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-valueCellHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableValueCellHyperlink"),title:this._getLocalizedLabels("EnableValueCellHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-summaryCellHyperLink e-hyperLinkIcons").attr({"aria-label":this._getLocalizedLabels("EnableSummaryCellHyperlink"),title:this._getLocalizedLabels("EnableSummaryCellHyperlink"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-hyperLinkDialog").length&&(e(a).appendTo(this.element),e(a).css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.hyperlinkSettings.enableRowHeaderHyperlink&&this.element.find(".e-rowHeaderHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this.element.find(".e-colHeaderHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableValueCellHyperlink&&this.element.find(".e-valueCellHyperLink").addClass("e-enabled"),this.model.hyperlinkSettings.enableSummaryCellHyperlink&&this.element.find(".e-summaryCellHyperLink").addClass("e-enabled"))),e(i.target).hasClass("e-frozenHeaders")&&(r=t.buildTag("div.e-frozenDialog#frozenDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rowFreeze e-frozenHeaderIcons").attr({"aria-label":this._getLocalizedLabels("Row"),title:this._getLocalizedLabels("Row"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-colFreeze e-frozenHeaderIcons").attr({"aria-label":this._getLocalizedLabels("Column"),title:this._getLocalizedLabels("Column"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,0==this.element.find("div.e-frozenDialog").length&&(e(r).appendTo(this.element),e(".e-frozenDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find(".e-rowFreeze").addClass("e-enabled"),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.element.find(".e-colFreeze").addClass("e-enabled"),this.model.frozenHeaderSettings.enableFrozenHeaders&&this.element.find(".bothFreeze").addClass("e-enabled"))),e(i.target).hasClass("e-layouts")&&(o=t.buildTag("div.e-layoutsDialog#layoutsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-normalLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NormalLayout"),title:this._getLocalizedLabels("NormalLayout"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-excelLikeLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("ExcelLikeLayout"),title:this._getLocalizedLabels("ExcelLikeLayout"),tabindex:0})[0].outerHTML)[0].outerHTML+(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.buildTag("td",t.buildTag("div.e-noSummariesLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NoSummaries"),title:this._getLocalizedLabels("NoSummaries"),tabindex:0})[0].outerHTML)[0].outerHTML:"")+(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.buildTag("td",t.buildTag("div.e-normalTopSummaryLayout e-layoutIcons").attr({"aria-label":this._getLocalizedLabels("NormalTopSummary"),title:this._getLocalizedLabels("NormalTopSummary"),tabindex:0})[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,0==this.element.find("div .e-layoutsDialog").length&&(e(o).appendTo(this.element),e(".e-layoutsDialog").css("left",i.target.offsetLeft+20+"px").css("top",i.target.offsetTop+15+"px"),this.model.layout==t.PivotGrid.Layout.Normal&&this.element.find(".e-normalLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout&&this.element.find(".e-excelLikeLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.NoSummaries&&this.element.find(".e-noSummariesLayout").addClass("e-enabled"),this.model.layout==t.PivotGrid.Layout.NormalTopSummary&&this.element.find(".e-normalTopSummaryLayout").addClass("e-enabled")))},_createMenuDialog:function(i){var a,r,o,s,n,d,h,c,p,u,m;if(this._dialogName=t.isNullOrUndefined(i.target)?e(i.element).attr("class").split(" ")[0]:e(i.target).attr("class").split(" ")[0],t.Pivot.openPreventPanel(this),this.element.find(".e-dialog").remove(),a=t.buildTag("div#clientDialog.e-clientDialog",{opacity:"1"})[0].outerHTML,r=currentTag=dialogContent="",e(i.target).hasClass("e-numberFormatting")||e(i.element).hasClass("e-numberFormatting")){for(r=this._getLocalizedLabels("NumberFormatting"),currentTag="Number Formatting",o=t.buildTag("label",this._getLocalizedLabels("Measures"))[0].outerHTML,b="<select id='measureOption'>",h=0;h<this.model.dataSource.values.length;h++)b+="<option>"+this.model.dataSource.values[h].fieldName+"</option>";b+="</select>",s=t.buildTag("label",this._getLocalizedLabels("NumberFormats"))[0].outerHTML,n="<div class='summarTypes'><select id='numberFormatOption'><option value='Decimal'>Decimal</option><option value='Currency'>Currency</option><option value='Percentage'>Percentage</option><option value='Number'>Number</option><option value='Date'>Date</option><option value='Time'>Time</option><option value='Scientific'>Scientific</option><option value='Fraction'>Fraction</option></select></div>",dialogContent=t.buildTag("div#reportDlg.e-reportDlg","<table><tr><td>"+o+"</td><td>"+b+"</td></tr><tr><td>"+s+"</td><td>"+n+"</td></tr></table>")[0].outerHTML}if(e(i.target).hasClass("e-summaryCustomize")||e(i.element).hasClass("e-summaryCustomize")){r=this._getLocalizedLabels("SummaryCustomization");var g=t.buildTag("label",this._getLocalizedLabels("HideGrandTotal"))[0].outerHTML,f=t.buildTag("label",this._getLocalizedLabels("HideSubTotal"))[0].outerHTML,b="<div class='measures'><select id='hideSubTotal'>";if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(h=0;h<this.model.dataSource.columns.length;h++)b+="<option>"+this.model.dataSource.columns[h].fieldCaption+"</option>";for(h=0;h<this.model.dataSource.rows.length;h++)b+="<option>"+this.model.dataSource.rows[h].fieldCaption+"</option>"}else if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(d=e(this.element).parents(".e-pivotclient").length>0?this._pivotClientObj.getOlapReport():this.getOlapReport(),h=0;h<JSON.parse(d).PivotRows.length;h++)b+="<option>"+JSON.parse(d).PivotRows[h].FieldName+"</option>";for(h=0;h<JSON.parse(d).PivotColumns.length;h++)b+="<option>"+JSON.parse(d).PivotColumns[h].FieldName+"</option>"}b+="</div>";var _=t.buildTag("input#rowSumCheckBox.rowSumCheckBox","",{},{name:"row",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.rowGrndlabel",this._getLocalizedLabels("Row"))[0].outerHTML+"<br/>",v=t.buildTag("input#colSumCheckBox.colSumCheckBox","",{},{name:"column",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.colGrndlabel",this._getLocalizedLabels("Column"))[0].outerHTML+"<br/>",C=t.buildTag("input#bothSumCheckBox.bothSumCheckBox","",{},{name:"both",type:"checkbox",tabindex:0})[0].outerHTML+" "+t.buildTag("label.bothGrndlabel",this._getLocalizedLabels("Both"))[0].outerHTML+"<br/>";dialogContent="pivot"==this.model.analysisMode?t.buildTag("div#customizeDlg.customizeDlg","<table><tr><td style='vertical-align:top'>"+g+"</td><td>"+_+v+C+"</td></tr><tr><td>"+f+"</td><td>"+b+"</td></tr></table>")[0].outerHTML:t.buildTag("div#customizeDlg.customizeDlg","<table><tr><td>"+g+"</td><td>"+_+v+C+"</td></tr></table>")[0].outerHTML}if(e(i.target).hasClass("e-summaryTypes")||e(i.element).hasClass("e-summaryTypes")){if(r=this._getLocalizedLabels("SummaryTypes"),g=t.buildTag("label",this._getLocalizedLabels("Measures"))[0].outerHTML,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(b="<div class='measures'><select id='drillMeasure'>",h=0;h<this.model.dataSource.values.length;h++)b+="<option>"+this.model.dataSource.values[h].fieldCaption+"</option>";b+="</div>"}f=t.buildTag("label",this._getLocalizedLabels("SummaryType"))[0].outerHTML,c=t.buildTag("input#drillSum").attr("type","text")[0].outerHTML,dialogContent=t.buildTag("div#summaryDlg.#summaryDlg","<table><tr><td>"+g+"</td><td>"+b+"</td></tr><tr><td>"+f+"</td><td>"+c+"</td></tr></table>")[0].outerHTML}p=t.buildTag("div#EditorDiv.e-editorDiv","",{"margin-left":"5px"})[0].outerHTML,dialogContent+=p,u="<button id=OKBtn class='e-dialogOkBtn'>"+this._getLocalizedLabels("OK")+"</button>",m="<button id=CancelBtn class='e-dialogCancelBtn'>"+this._getLocalizedLabels("Cancel")+"</button>",dialogFooter=t.buildTag("div.e-dialogFooter",u+m,{float:this.model.enableRTL?"left":"right",margin:"20px 0px 6px"})[0].outerHTML,e(a).appendTo("#preventDiv"),e(dialogContent+dialogFooter).appendTo(".e-clientDialog"),e(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:"auto",target:"#"+this._id,enableResize:!1,close:t.Pivot.closePreventPanel(this)}),e(".e-titlebar").prepend(t.buildTag("div",r,{display:"inline"})[0].outerHTML)[0],e(".e-dialogOkBtn, .e-dialogCancelBtn").ejButton({width:"67px",enableRTL:this.model.enableRTL,type:t.ButtonType.Button}),e(".e-dialogOkBtn, .e-dialogCancelBtn").css({"margin-left":"10px"}),""==this._selectedFormat&&""==this._selectedMeasure&&(e("#numberFormatOption").ejDropDownList({enableRTL:this.model.enableRTL,selectedIndex:0,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#measureOption").ejDropDownList({enableRTL:this.model.enableRTL,selectedIndex:0,showCheckbox:!0,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}})),""!=this._selectedMeasure&&""!=this._selectedFormat&&(e("#numberFormatOption").ejDropDownList({enableRTL:this.model.enableRTL,text:this._selectedFormat,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#measureOption").ejDropDownList({enableRTL:this.model.enableRTL,text:this._selectedMeasure,showCheckbox:!0,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}})),e("#categoricalInput").ejMaskEdit({name:"mask",inputMode:t.InputMode.Text,watermarkText:"Column Page Size"}),e("#seriesInput").ejMaskEdit({name:"mask",inputMode:t.InputMode.Text,watermarkText:"Row Page Size"}),e("#rowSumCheckBox,#colSumCheckBox,#bothSumCheckBox").ejCheckBox({size:"small",showRoundedCorner:!0}),this.rowCheckBox=e("#rowSumCheckBox").data("ejCheckBox"),this.colCheckBox=e("#colSumCheckBox").data("ejCheckBox"),this.bothCheckBox=e("#bothSumCheckBox").data("ejCheckBox"),(e(i.target).hasClass("e-summaryCustomize")||e(i.element).hasClass("e-summaryCustomize"))&&(0==this.rowGrand&&this.rowCheckBox.setModel({checked:"checked"}),0==this.colGrand&&this.colCheckBox.setModel({checked:"checked"}),0==this.bothGrand&&this.bothCheckBox.setModel({checked:"checked"}),e("#hideSubTotal").ejDropDownList({showCheckbox:!0,enableRTL:this.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.dropmeasure=e("#hideSubTotal").data("ejDropDownList"),this.selval!=l&&this.dropmeasure.setModel({value:this.selval})),(e(i.target).hasClass("e-summaryTypes")||e(i.element).hasClass("e-summaryTypes"))&&(e("#_summaryOK,#_summaryCancel").ejButton({enableRTL:this.model.enableRTL}),e("#drillMeasure").ejDropDownList({selectedIndices:[0],enableRTL:this.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#drillSum").ejDropDownList({dataSource:[{option:"Sum",value:this._getLocalizedLabels("Sum")},{option:"Average",value:this._getLocalizedLabels("Average")},{option:"Count",value:this._getLocalizedLabels("Count")},{option:"Min",value:this._getLocalizedLabels("Min")},{option:"Max",value:this._getLocalizedLabels("Max")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),drilmes=e("#drillMeasure").data("ejDropDownList"),drilsum=e("#drillSum").data("ejDropDownList"),this.drilsumval!=l&&drilmes.setModel({value:this.drilsumval}),null!=this.sumtyp&&drilsum.setModel({value:this.sumtyp}))},_dialogOKBtnClick:function(){var i,a,r,o,s,n,d,h,c,p;if("e-numberFormatting"==this._dialogName){for(this._selectedFormat=e("#numberFormatOption").ejDropDownList("getSelectedValue"),this._selectedMeasure=e("#measureOption").ejDropDownList("getSelectedValue"),i=this._selectedMeasure.split(","),this.element.find(".e-dialog").remove(),t.Pivot.closePreventPanel(this),c=0;c<this.model.dataSource.values.length;c++)for(a=0;a<i.length;a++)this.model.dataSource.values[c].fieldName==i[a]&&(this.model.dataSource.values[c].format=this._selectedFormat.toLowerCase());t.isNullOrUndefined(this._pivotClientObj)||"pivot"!=this._pivotClientObj.model.analysisMode||"clientmode"!=this._pivotClientObj.model.operationalMode||(this.model.collapsedMembers=null),this._populatePivotGrid()}if("e-summaryCustomize"==this._dialogName&&(pGridObj=this,t.isNullOrUndefined(this._pivotClientObj)||"pivot"!=this._pivotClientObj.model.analysisMode||"clientmode"!=this._pivotClientObj.model.operationalMode||(pGridObj.model.collapsedMembers=null),pGridObj.rowCheckBox.model.checked?(pGridObj.model.enableColumnGrandTotal=pGridObj.model.enableGrandTotal=!0,pGridObj.model.enableRowGrandTotal=pGridObj.rowGrand=!1):pGridObj.model.enableRowGrandTotal=pGridObj.rowGrand=!0,pGridObj.colCheckBox.model.checked?(pGridObj.model.enableRowGrandTotal=pGridObj.model.enableGrandTotal=!0,pGridObj.model.enableColumnGrandTotal=pGridObj.colGrand=!1):pGridObj.model.enableColumnGrandTotal=pGridObj.colGrand=!0,pGridObj.bothCheckBox.model.checked||pGridObj.colCheckBox.model.checked&&pGridObj.rowCheckBox.model.checked?(pGridObj.model.enableRowGrandTotal=pGridObj.model.enableColumnGrandTotal=!0,pGridObj.model.enableGrandTotal=pGridObj.bothGrand=!1):pGridObj.model.enableGrandTotal=pGridObj.bothGrand=!0,null!=e("#hideSubTotal").ejDropDownList("getSelectedValue")&&"pivot"==this.model.analysisMode&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(pGridObj.selval=e("#hideSubTotal").ejDropDownList("getSelectedValue"),r=e("#hideSubTotal").ejDropDownList("getSelectedValue").split(","),pGridObj.model.dataSource.rows.length>0&&e.each(pGridObj.model.dataSource.rows,function(e,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),pGridObj.model.dataSource.columns.length>0&&e.each(pGridObj.model.dataSource.columns,function(e,t){t.fieldName.length>0&&(t.showSubTotal=!0)}),e.each(r,function(t,i){pGridObj.model.dataSource.rows.length>0&&e.each(pGridObj.model.dataSource.rows,function(e,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)}),pGridObj.model.dataSource.columns.length>0&&e.each(pGridObj.model.dataSource.columns,function(e,t){t.fieldName.length>0&&t.fieldName==i&&(t.showSubTotal=!1)})}),pGridObj._populatePivotGrid()):"pivot"==this.model.analysisMode&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(pGridObj.selval=e("#hideSubTotal").ejDropDownList("getSelectedValue"),r=e("#hideSubTotal").ejDropDownList("getSelectedValue").split(","),(o=e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()):JSON.parse(pGridObj.getOlapReport())).PivotRows.length>0&&e.each(o.PivotRows,function(e,t){t.FieldName.length>0&&(t.showSubTotal=!0)}),o.PivotColumns.length>0&&e.each(o.PivotColumns,function(e,t){t.FieldName.length>0&&(t.showSubTotal=!0)}),e.each(r,function(t,i){o.PivotRows.length>0&&e.each(o.PivotRows,function(e,t){t.FieldName.length>0&&t.FieldName==i&&(t.showSubTotal=!1)}),o.PivotColumns.length>0&&e.each(o.PivotColumns,function(e,t){t.FieldName.length>0&&t.FieldName==i&&(t.showSubTotal=!1)})}),s={JsonRecords:JSON.stringify(pGridObj.getJSONRecords()),PivotReport:JSON.stringify(o)},pGridObj._renderControlSuccess(s)):pGridObj._load(),t.Pivot.closePreventPanel(this)),"e-summaryTypes"==this._dialogName){if(e("#drillSum").val()!=l&&(this.drilsumval=e("#drillMeasure").ejDropDownList("getSelectedValue"),null!=(n=this.sumtyp=e("#drillSum").val())&&(d=n.toLowerCase()),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)){for(h=e("#drillMeasure").ejDropDownList("getSelectedValue").split(",").length,c=0;c<h;c++)p=e("#drillMeasure").ejDropDownList("getSelectedValue").split(",")[c],e.grep(this.model.dataSource.values,function(e){return e.fieldName==p})[0].summaryType=d;t.isNullOrUndefined(this._pivotClientObj)||"pivot"!=this._pivotClientObj.model.analysisMode||"clientmode"!=this._pivotClientObj.model.operationalMode||(this.model.collapsedMembers=null),this._populatePivotGrid()}t.Pivot.closePreventPanel(this)}},_keyUpPress:function(t){if(16===t.which&&this.model.enableCellSelection&&(this._completeCellSelection(t),e("#"+this._id).find(".value").removeClass("e-hoverCell"),this._startPosCell=null,this._startCellPosition=null),13===t.which&&this.model.enableCellEditing&&!this.model.enableCellSelection&&e("#"+this._id).find(".value.e-hoverCell").length){e("#"+this._id).find(".value.e-hoverCell").trigger("mouseover"),this._startCellPosition=e(e("#"+this._id).find(".value.e-hoverCell")).attr("data-p");var i={target:e("#"+this._id).find(".value.e-hoverCell > span")[0]};this._completeCellEditing(i),t.preventDefault(),e("#"+this._id).find(".value.e-hoverCell .curInput").focus(),e("#"+this._id).find(".value").removeClass("e-hoverCell")}},_keyDownPress:function(i){var l,a,r,o,s,n,d;if(e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&(("Pager_CategCurrentPage"==document.activeElement.id||"Pager_SeriesCurrentPage"==document.activeElement.id)&&(35===i.which?(i.preventDefault(),"Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveLast").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveLast").last().trigger("click")):36==i.which&&(i.preventDefault(),"Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .moveFirst").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .moveFirst").last().trigger("click")),39===i.which?"Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveNext").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-moveNext").last().trigger("click"):37===i.which&&("Pager_CategCurrentPage"==document.activeElement.id?e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-movePrevious").first().trigger("click"):"Pager_SeriesCurrentPage"==document.activeElement.id&&e(".e-pivotpager[data-targetcontrolid='"+this._id+"'] .e-movePrevious").last().trigger("click"))),i.stopImmediatePropagation()),27!==i.which||t.isNullOrUndefined(this._curFocus.grp)&&(t.isNullOrUndefined(this._curFocus.tab)||!this._curFocus.tab.hasClass("e-pivotButton"))?27===i.which&&(this._index.dialog=0):(this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-pivotButton")&&(d=this._curFocus.tab.attr("data-tag"),n=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(d=this._curFocus.grp.attr("data-tag"),n=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),n.mouseover().addClass("e-hoverCell").focus(),this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._index.field=0),70===i.which&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".filter").click():this._curFocus.grp.find(".filter").click()),83===i.which&&i.ctrlKey&&(i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".e-sorting").click(),d=this._curFocus.tab.attr("data-tag"),n=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(this._curFocus.grp.find(".e-sorting").click(),d=this._curFocus.grp.attr("data-tag"),n=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),n.mouseover().addClass("e-hoverCell").focus()),(46===i.which||82===i.which&&i.ctrlKey)&&(46!=i.which&&i.preventDefault(),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".e-removeBtn").click():this._curFocus.grp.find(".e-removeBtn").click()),i.shiftKey&&t.isNullOrUndefined(this._startPosCell)&&(this._startCellPosition=i.target.getAttribute("data-p"),this._startPosCell=i.target.getAttribute("data-p")),39===i.which&&e("#"+this._id).find(".e-dialog .e-hoverCell").length>0?e("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-plus").click():37===i.which&&e("#"+this._id).find(".e-dialog .e-hoverCell").length>0&&e("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-minus").click(),(40===i.which||39===i.which||38===i.which||37===i.which)&&i.shiftKey&&this.model.enableCellSelection){if(e("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),l=e(i.target),"40"==i.which)for(h=l.attr("data-p"),c=parseInt(h.split(",")[1])+Number(l.attr("rowspan"));t.isNullOrUndefined(p)&&c<this._rowCount;)a=e(e("#"+this._id)).find("[data-p='"+h.split(",")[0]+","+c+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),this._curFocus.selection=e(p),c++;else if("38"==i.which)for(h=l.attr("data-p"),c=parseInt(h.split(",")[1])-1;t.isNullOrUndefined(p)&&c>=0;)a=e(e("#"+this._id)).find("[data-p='"+h.split(",")[0]+","+c+"']")[0],t.isNullOrUndefined(a)&&(a=e(e("#"+this._id)).find("[data-p='"+(parseInt(h.split(",")[0])-1)+","+c+"']")[0]),!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),this._curFocus.selection=e(p),c--;else if("39"==i.which)for(h=l.attr("data-p"),c=parseInt(h.split(",")[0])+Number(l.attr("colspan"));t.isNullOrUndefined(p)&&c<Math.ceil(this.getJSONRecords().length/this._rowCount);)a=e(e("#"+this._id)).find("[data-p='"+c+","+h.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),this._curFocus.selection=e(p),c++;else if("37"==i.which){for(var h=l.attr("data-p"),c=parseInt(h.split(",")[0])-1,p=e(e("#"+this._id)).find("[data-p='"+(parseInt(h.split(",")[0])-1)+","+h.split(",")[1]+"']")[0];t.isNullOrUndefined(p)&&c>=0;)a=e(e("#"+this._id)).find("[data-p='"+c+","+h.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),c--;this._curFocus.selection=e(p)}if(this._curFocus.selection.attr("tabindex","-1").focus().addClass("e-hoverCell"),Number(this._startCellPosition.split(",")[0])<=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])<=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(c=Number(this._startCellPosition.split(",")[0]);c<=Number(this._curFocus.selection.attr("data-p").split(",")[0]);c++)for(u=Number(this._startCellPosition.split(",")[1]);u<=Number(this._curFocus.selection.attr("data-p").split(",")[1]);u++)e("#"+this._id).find("[data-p='"+c+","+u+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+c+","+u+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])>=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])>=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(c=Number(this._startCellPosition.split(",")[0]);c>=Number(this._curFocus.selection.attr("data-p").split(",")[0]);c--)for(u=Number(this._startCellPosition.split(",")[1]);u>=Number(this._curFocus.selection.attr("data-p").split(",")[1]);u--)e("#"+this._id).find("[data-p='"+c+","+u+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+c+","+u+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])<=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])>=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(c=Number(this._startCellPosition.split(",")[0]);c<=Number(this._curFocus.selection.attr("data-p").split(",")[0]);c++)for(u=Number(this._startCellPosition.split(",")[1]);u>=Number(this._curFocus.selection.attr("data-p").split(",")[1]);u--)e("#"+this._id).find("[data-p='"+c+","+u+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+c+","+u+"']").addClass("e-hoverCell");else if(Number(this._startCellPosition.split(",")[0])>=Number(this._curFocus.selection.attr("data-p").split(",")[0])&&Number(this._startCellPosition.split(",")[1])<=Number(this._curFocus.selection.attr("data-p").split(",")[1]))for(c=Number(this._startCellPosition.split(",")[0]);c>=Number(this._curFocus.selection.attr("data-p").split(",")[0]);c--)for(u=Number(this._startCellPosition.split(",")[1]);u<=Number(this._curFocus.selection.attr("data-p").split(",")[1]);u++)e("#"+this._id).find("[data-p='"+c+","+u+"']").hasClass("value")&&e("#"+this._id).find("[data-p='"+c+","+u+"']").addClass("e-hoverCell")}else if((40===i.which||38===i.which||37===i.which||39===i.which)&&e("#"+this._id).find(".e-calcFormulaDiv:visible").length>0)i.preventDefault(),r=e("#"+this._id).find(".e-calcFormulaDiv td:visible"),t.isNullOrUndefined(this._curFocus.formula)?(this._index.formula=39==i.which?0:37==i.which?r.length-1:0,this._curFocus.formula=r.eq(this._index.formula).addClass("e-hoverCell").mouseover()):(this._curFocus.formula.removeClass("e-hoverCell").mouseleave(),39===i.which?this._index.formula=this._index.formula+1>r.length-1?0:this._index.formula+1:37===i.which?this._index.formula=this._index.formula-1<0?r.length-1:this._index.formula-1:40===i.which?this._index.formula=this._index.formula+4>r.length-1?(this._index.formula+4)%10:this._index.formula+4:38===i.which&&(this._index.formula=this._index.formula-4<0?this._index.formula- -16:this._index.formula-4),this._curFocus.formula=r.eq(this._index.formula).addClass("e-hoverCell").mouseover());else if((40===i.keyCode||38===i.which)&&e("#"+this._id).find(".e-dialog:visible").length>0&&!t.isNullOrUndefined(e("#"+this._id).find(".e-dialog .e-text"))&&e(".e-dialog .e-text").hasClass("e-hoverCell"))e("#"+this._id).find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),i.preventDefault(),r=e("#"+this._id).find(".e-dialog .e-text:visible"),t.isNullOrUndefined(this._curFocus.filter)?(this._index.filter=40==i.which?1:38==i.which?r.length-1:0,this._curFocus.filter=r.eq(this._index.filter).attr("tabindex","-1")):(this._curFocus.filter.attr("tabindex","0").removeClass("e-hoverCell"),40===i.which?this._index.filter=this._index.filter+1>r.length-1?0:this._index.filter+1:38===i.which&&(this._index.filter=this._index.filter-1<0?r.length-1:this._index.filter-1),this._curFocus.filter=r.eq(this._index.filter).attr("tabindex","-1")),this._curFocus.filter.focus().addClass("e-hoverCell"),e(".e-node-focus").removeClass("e-node-focus");else if((40===i.which||38===i.which||37===i.which||39===i.which)&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-pivotButton")&&!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!e("#"+this._id).find(".e-dialog:visible").length>0)i.preventDefault(),t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().attr("tabindex","0").removeClass("e-hoverCell"),r=e("#"+this._id).find(".e-pivotButton"),t.isNullOrUndefined(this._curFocus.grp)?40===i.which||39===i.which?this._curFocus.grp=r.eq(1).attr("tabindex","-1"):(38===i.which||37===i.which)&&(this._curFocus.grp=r.eq(r.length-1).attr("tabindex","-1")):(this._curFocus.grp.attr("tabindex","0").removeClass("e-hoverCell").mouseleave(),40===i.which||39===i.which?this._index.grp=this._index.grp+1>r.length-1?0:this._index.grp+1:(38===i.which||37===i.which)&&(this._index.grp=this._index.grp-1<0?r.length-1:this._index.grp-1),this._curFocus.grp=r.eq(this._index.grp)),this._curFocus.grp.addClass("e-hoverCell").mouseover().focus();else if(40!==i.which&&38!==i.which&&37!==i.which&&39!==i.which||!(!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0)||"columnheader"!=document.activeElement.getAttribute("role")&&"rowheader"!=document.activeElement.getAttribute("role")&&"gridcell"!=document.activeElement.getAttribute("role"))40==i.which&&e(".e-list").hasClass("e-hoverCell")&&e("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell");else{if(t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","0"),t.isNullOrUndefined(this._curFocus.cell)||(this._curFocus.cell.attr("tabindex","0").removeClass("e-hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&this._curFocus.cell.find("span").mouseleave()),this._index.menu=0,this._curFocus.cmenu=null,l=e(i.target),"40"==i.which)for(h=l.attr("data-p"),c=parseInt(h.split(",")[1])+Number(l.attr("rowspan"));t.isNullOrUndefined(p)&&c<=this._rowCount;){if(a=e("#"+this._id).find("[data-p='"+h.split(",")[0]+","+c+"']")[0],t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+k+","+c+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),t.isNullOrUndefined(p)||(this._curFocus.cell=e(p)),c++}else if("38"==i.which){h=l.attr("data-p"),c=parseInt(h.split(",")[1])-1;for(var u=parseInt(h.split(",")[0]);t.isNullOrUndefined(p)&&c>=0;){if(a=e("#"+this._id).find("[data-p='"+h.split(",")[0]+","+c+"']")[0],t.isNullOrUndefined(a)&&("gridcell"==l.attr("role")||l.hasClass("summary")&&l.hasClass("calc")))for(k=parseInt(h.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+u+","+k+"']")[0]);if(t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+k+","+c+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),t.isNullOrUndefined(p)||e(p).hasClass("e-grpRow")||(this._curFocus.cell=e(p)),c--,u--}}else if("39"==i.which)for(h=l.attr("data-p"),c=parseInt(h.split(",")[0])+Number(l.attr("colspan"));t.isNullOrUndefined(p)&&c<=Math.ceil((Number(e("#"+this._id).find(".e-pivotGridTable td:last").attr("data-p").split(",")[0])+1)*(Number(e("#"+this._id).find(".e-pivotGridTable td:last").attr("data-p").split(",")[1])+1)/this._rowCount);){if(a=e("#"+this._id).find("[data-p='"+c+","+h.split(",")[1]+"']")[0],t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+c+","+k+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),t.isNullOrUndefined(p)||(this._curFocus.cell=e(p)),c++}else if("37"==i.which){for(h=l.attr("data-p"),c=parseInt(h.split(",")[0])-1,p=e("#"+this._id).find("[data-p='"+(parseInt(h.split(",")[0])-1)+","+h.split(",")[1]+"']")[0],u=parseInt(h.split(",")[1]);t.isNullOrUndefined(p)&&c>=0;){if(a=e("#"+this._id).find("[data-p='"+c+","+h.split(",")[1]+"']")[0],t.isNullOrUndefined(a)&&"gridcell"==l.attr("role"))for(k=parseInt(h.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+k+","+u+"']")[0]);if(t.isNullOrUndefined(a))for(k=parseInt(h.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(a)&&(a=e("#"+this._id).find("[data-p='"+c+","+k+"']")[0]);!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role")||e(a).hasClass("value")||"gridcell"==e(a).attr("role"))&&(p=a),c--,u--}t.isNullOrUndefined(p)||e(p).hasClass("e-grpRow")||(this._curFocus.cell=e(p))}t.isNullOrUndefined(this._curFocus.cell)||(e(".e-hoverCell").removeClass("e-hoverCell"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell"),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.cell.mouseover(),this._curFocus.cell.find("span").mouseover()))}if(9===i.which&&e("#"+this._id).find(".colheader.e-hoverCell")&&(this._curFocus.cell=e("#"+this._id).find(".colheader.e-hoverCell")),(9===i.which&&i.shiftKey||9===i.which)&&e("#"+this._id).find("#"+this._id+"_clientDlg_wrapper :visible").length>0?(i.preventDefault(),r=e("#"+this._id+"_editCon_hidden").hasClass("e-disable")||"disabled"==e("#"+this._id+"_conTo").attr("disabled")?"disabled"!=e("#"+this._id+"_conTo").attr("disabled")?e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):e("#"+this._id+"_editCon_hidden").hasClass("e-disable")?e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"):e("#"+this._id).find("#"+this._id+"_conType_wrapper,#"+this._id+"_editCon_wrapper,#"+this._id+"_removeBtn,#"+this._id+"_conFrom,#"+this._id+"_conTo,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_borderrange_wrapper,#"+this._id+"_conFrom,#"+this._id+"_fontcolor_wrapper,#"+this._id+"_backcolor_wrapper,#"+this._id+"_bordercolor_wrapper,#"+this._id+"_borderstyle_wrapper,#"+this._id+"_fStyle_wrapper,#"+this._id+"_fSize_wrapper,#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,.e-dialog .e-close"),t.isNullOrUndefined(this._curFocus.cformat)?(this._index.cformat=1,this._curFocus.cformat=r.eq(this._index.cformat).attr("tabindex","-1")):(this._curFocus.cformat.attr("tabindex","0").removeClass("e-hoverCell"),9===i.which&&i.shiftKey?this._index.cformat=this._index.cformat-1<0?r.length-1:this._index.cformat-1:9===i.which&&(this._index.cformat=this._index.cformat+1>r.length-1?0:this._index.cformat+1),this._curFocus.cformat=r.eq(this._index.cformat).attr("tabindex","-1")),this._curFocus.cformat.focus().addClass("e-hoverCell")):(9===i.which&&i.shiftKey||9===i.which)&&e("#"+this._id).find(".e-dlgCalculatedField:visible").length>0?(i.preventDefault(),e("#"+this._id).find(".e-calcFormulaDiv:visible").length>0&&e("#"+this._id).find(".e-calcFormulaDiv").css("display","none"),(o=[]).push(e("#"+this._id).find("#"+this._id+"_calculateFieldName:visible")),o.push(e("#"+this._id).find("#"+this._id+"_calculateFieldList_dropdown:visible")),o.push(e("#"+this._id).find(".calculatorFields:visible")),o.push(e("#"+this._id).find(".editFormula:visible")),o.push(e("#"+this._id).find("#"+this._id+"_fieldCollection_container:visible")),e("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])").length>0&&o.push(e("#"+this._id).find("#"+this._id+"_btnInsert:visible:not([aria-disabled='true'])")),o.push(e("#"+this._id).find("#"+this._id+"_btnAdd:visible")),o.push(e("#"+this._id).find("#"+this._id+"_btnDelete:visible")),o.push(e("#"+this._id).find("#"+this._id+"_btnOk:visible")),o.push(e("#"+this._id).find("#"+this._id+"_btnCancel:visible")),t.isNullOrUndefined(this._curFocus.field)?(this._index.field=o.length>5?6:0,this._curFocus.field=o[this._index.field].attr("tabindex","-1")):(this._curFocus.field.attr("tabindex","0").removeClass("e-hoverCell").blur(),9===i.which&&i.shiftKey?this._index.field=this._index.field-1<0?o.length-1:this._index.field-1:9===i.which&&(this._index.field=this._index.field+1>o.length-1?0:this._index.field+1),this._curFocus.field=o[this._index.field].attr("tabindex","-1")),this._curFocus.field.focus().addClass("e-hoverCell")):(9===i.which&&i.shiftKey||9===i.which)&&e("#"+this._id).find(".e-dialog:visible").length>0?(i.preventDefault(),e("#"+this._id).find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),this._curFocus.filter=null,this._index.filter=0,o=e("#"+this._id).find(".e-dialogOKBtn:visible:not([aria-disabled='true']),.e-dialogCancelBtn:visible,.e-close:visible,#GroupLabelDrop_wrapper:visible,.filterElementTag:visible,.e-dialog .e-text:visible:first,.filterValues:visible,#filterMeasures_wrapper:visible,#filterOptions_wrapper:visible,#filterValue1:visible,#filterValue2:visible,.searchEditorTreeView"),t.isNullOrUndefined(this._curFocus.tree)?(this._index.dialog=this.model.dataSource.enableAdvancedFilter?1:2,this._curFocus.tree=o.eq(this._index.dialog).attr("tabindex","-1").focus()):(this._curFocus.tree.attr("tabindex","0").removeClass("e-hoverCell"),9===i.which&&i.shiftKey?this._index.dialog=this._index.dialog-1<0?o.length-1:this._index.dialog-1:9===i.which&&(this._index.dialog=this._index.dialog+1>o.length-1?0:this._index.dialog+1),this._curFocus.tree=o.eq(this._index.dialog).attr("tabindex","-1").focus()),this._curFocus.tree.hasClass("filterElementTag")?this._curFocus.tree.find(".e-list:first:visible").addClass("e-hoverCell"):this._curFocus.tree.addClass("e-hoverCell")):(9===i.which&&i.shiftKey||9===i.which)&&!e(".e-dialog:visible").length>0&&t.isNullOrUndefined(this._pivotClientObj)&&(i.preventDefault(),e("#"+this._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._schemaData)||e("#"+this._schemaData._id).find(".e-hoverCell").removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)||this._curFocus.grp.mouseleave(),this._index.field=0,this._index.grp=1,this._index.cell=1,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,t.isNullOrUndefined(this._schemaData)||t.isNullOrUndefined(this._schemaData._curFocus)||(this._schemaData._curFocus.tree=null,this._schemaData._curFocus.node=null,this._schemaData._curFocus.button=null),this._curFocus.field=null,this._curFocus.cell=null,this._curFocus.grp=null,this._curFocus.tree=null,this._curFocus.cmenu=null,this._curFocus.cformat=null,this._curFocus.selection=null,o=[],this.model.enableGroupingBar&&e("#"+this._id).find(".e-pivotButton:visible").first().length>0&&o.push(e("#"+this._id).find(".e-pivotButton:visible").first()),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&e("[role='columnheader']:visible:not([p='0,0'])").first().length>0?o.push(e("[role='columnheader']:visible:not([p='0,0'])").first()):e("#"+this._id).find("[role='columnheader']:visible").first().length>0&&o.push(e("[role='columnheader']:not('.e-grpRow'):visible:first")),!t.isNullOrUndefined(this._schemaData)&&e("#"+this._schemaData._id).find(".e-text:visible").first().length>0&&o.push(e("#"+this._schemaData._id).find(".e-text:visible").first()),!t.isNullOrUndefined(this._schemaData)&&e("#"+this._schemaData._id).find(".e-pvtBtn:visible").first().length>0&&o.push(e("#"+this._schemaData._id).find(".e-pvtBtn:visible").first()),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&e("#Pager_CategCurrentPage:visible").length>0&&o.push(e("#Pager_CategCurrentPage:visible")),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&e("#Pager_SeriesCurrentPage:visible").length>0&&o.push(e("#Pager_SeriesCurrentPage:visible")),t.isNullOrUndefined(this._curFocus.tab)?this._curFocus.tab=o[0].attr("tabindex","-1"):(this._curFocus.tab.attr("tabindex","0").removeClass("e-hoverCell"),this._curFocus.tab.hasClass("e-active")&&this._curFocus.tab.removeClass("e-active"),t.isNullOrUndefined(this._schemaData)||(e("#"+this._schemaData._id).find(".e-active").removeClass("e-active"),e("#"+this._schemaData._id).find(".e-node-hover").removeClass("e-node-hover"),e("#"+this._schemaData._id).find(".e-node-focus").removeClass("e-node-focus")),this._curFocus.tab.hasClass("e-node-hover")&&this._curFocus.tab.removeClass("e-node-hover"),this._curFocus.tab.mouseleave(),9===i.which&&i.shiftKey?this._index.index=this._index.index-1<0?o.length-1:this._index.index-1:9===i.which&&(this._index.index=this._index.index+1>o.length-1?0:this._index.index+1),this._curFocus.tab=o[this._index.index].attr("tabindex","-1")),this._curFocus.tab.focus().addClass("e-hoverCell").mouseover(),this.model.hyperlinkSettings.enableColumnHeaderHyperlink&&(this._curFocus.tab.mouseover(),this._curFocus.tab.find("span").mouseover()),e(".e-node-focus").removeClass("e-node-focus"),i.stopImmediatePropagation()),93===i.which&&!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&this.model.enableGroupingBar&&(!t.isNullOrUndefined(this._curFocus.grp)||!t.isNullOrUndefined(this._curFocus.tab))&&(i.preventDefault(),document.activeElement.className.startsWith("e-pivotButton")&&(t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(s={x:e(this._curFocus.tab).offset().left+e(this._curFocus.tab).outerWidth(),y:e(this._curFocus.tab).offset().top+e(this._curFocus.tab).outerHeight()},this._curFocus.tab.find("button").trigger({type:"mouseup",which:3,clientX:s.x,clientY:s.y,pageX:s.x,pageY:s.y})):(s={x:e(this._curFocus.grp).offset().left+e(this._curFocus.grp).outerWidth(),y:e(this._curFocus.grp).offset().top+e(this._curFocus.grp).outerHeight()},this._curFocus.grp.find("button").trigger({type:"mouseup",which:3,clientX:s.x,clientY:s.y,pageX:s.x,pageY:s.y})))),13===i.which&&this.model.hyperlinkSettings.enableColumnHeaderHyperlink)t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.find(".cellValue").click():this._curFocus.cell.find(".cellValue").click();else if(13==i.which&&!e(".pivotTree:visible,.pivotTreeContext:visible,.pivotTreeContextMenu:visible").length>0&&!e(".e-waitpopup-pane:visible").length>0){if(e("#"+this._id).find(".e-dialog:visible").length>0){if(e(i.target).hasClass("e-memberCurrentPage")||e(i.target).hasClass("e-memberCurrentSearchPage")||e(i.target).hasClass("e-memberCurrentDrillPage"))return void t.Pivot.editorTreeNavigatee(i,this);if(e(i.target).hasClass("searchEditorTreeView"))return void t.Pivot._searchEditorTreeNodes(i,this)}e("#"+this._id).find(".e-dialog .e-hoverCell").length>0&&e("#"+this._id).find(".e-dialog .e-hoverCell").hasClass("e-text")?e("#"+this._id).find(".e-dialog .e-hoverCell").parent().find(".e-chkbox-small").click():document.activeElement.className.startsWith("e-pivotGridTable")||"rowheader"==document.activeElement.getAttribute("role")||"columnheader"==document.activeElement.getAttribute("role")?t.isNullOrUndefined(this._curFocus.cell)?t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.find(".e-expand").length>0?this._curFocus.tab.find(".e-expand").click():this._curFocus.tab.find(".e-collapse").length>0&&this._curFocus.tab.find(".e-collapse").click(),this._curFocus.tab=e("#"+this._id).find("[role='"+this._curFocus.tab.attr("role")+"']:contains('"+this._curFocus.tab.text()+"'):visible").first(),this._curFocus.tab.attr("tabindex","-1").focus().addClass("e-hoverCell")):this._curFocus.cell.find(".e-expand,.e-collapse").length>0?(this._curFocus.cell.find(".e-expand,.e-collapse").click(),this._curFocus.cell.removeClass("e-hoverCell").attr("tabindex","0"),this._curFocus.cell=e("#"+this._id).find("[role='"+this._curFocus.cell.attr("role")+"']:contains('"+this._curFocus.cell.text()+"'):visible").first(),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell")):(this._curFocus.cell.click(),this._curFocus.cell.removeClass("e-hoverCell").attr("tabindex","0"),this._curFocus.cell=e("#"+this._id).find("[data-p='"+this._curFocus.cell.attr("data-p")+"']"),this._curFocus.cell.attr("tabindex","-1").focus().addClass("e-hoverCell")):t.isNullOrUndefined(this._curFocus.tree)&&t.isNullOrUndefined(this._curFocus.formula)&&(t.isNullOrUndefined(this._curFocus.field)||!this._curFocus.field.hasClass("editFormula"))||e("#"+this._id).find(".e-dialog .e-hoverCell:visible").length>0&&(e("#"+this._id).find(".e-dialog .e-hoverCell:visible").click(),this._index.tree=1),e(".e-pivotpager[data-targetcontrolid='"+this._id+"']:visible").length>0&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.attr("tabindex","-1").focus()}79==i.keyCode&&e("#"+this._id).find(".e-dialog").length>0&&i.ctrlKey&&(i.preventDefault(),e("#"+this._id).find(".e-dialogOKBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(d=this._curFocus.tab.attr("data-tag"),n=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(d=this._curFocus.grp.attr("data-tag"),n=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),t.isNullOrUndefined(n)||n.mouseover().addClass("e-hoverCell").focus()),67==i.keyCode&&e("#"+this._id).find(".e-dialog:visible").length>0&&i.ctrlKey&&(i.preventDefault(),e("#"+this._id).find(".e-dialogCancelBtn:visible").click(),this._index.field=0,this._index.filter=0,this._index.dialog=this.model.dataSource.enableAdvancedFilter?0:1,this._curFocus.tree=null,t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.mouseleave().removeClass("e-hoverCell"),t.isNullOrUndefined(this._curFocus.grp)?t.isNullOrUndefined(this._curFocus.tab)||(d=this._curFocus.tab.attr("data-tag"),n=this._curFocus.tab=e("#"+this._id).find("[data-tag='"+d+"']")):(d=this._curFocus.grp.attr("data-tag"),n=this._curFocus.grp=e("#"+this._id).find("[data-tag='"+d+"']")),t.isNullOrUndefined(n)||n.mouseover().addClass("e-hoverCell").focus())},_unWireEvents:function(){this._off(this.element,"mousedown",".value",this._initCellEditing),this._off(this.element,"click",".colheader,.cstot,.cgtot,.calc,.stot,.gtot"),this._off(e(document),"keydown",this._keyDownPress),this._off(e(document),"keyup",this._keyUpPress),this._off(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this._off(this.element,"click","#preventDiv"),this._off(this.element,"click","table .e-expand,table .e-collapse"),this._off(this.element,"dblclick",".value, .summary"),this._off(this.element,"click",".value, .summary"),this._off(this.element,"mouseover",".colheader, .rowheader, .e-expand, .e-collapse"),this._off(this.element,"mouseleave",".colheader, .rowheader, .e-expand, .e-collapse"),this._off(this.element,"mouseover",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.addHyperlinkHandler),this._off(this.element,"mouseleave",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary",this.removeHyperlinkHandler),this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value, .rowheader, .colheader":".value, .rowheader, .colheader, .summary"),this._off(this.element,"click",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?".value .cellValue, .rowheader .cellValue, .colheader .cellValue":".value .cellValue, .rowheader .cellValue, .colheader .cellValue, .summary .cellValue"),this._off(this.element,"mouseover",".value"),this._off(this.element,"mouseleave",".value"),this._off(this.element,"mousedown touchstart",".value"),this._off(this.element,"mouseup touchend",".value"),this._off(this.element,"click",".filter"),this._off(this.element,"click",".e-sorting"),this._off(this.element,"click",".e-removeBtn"),this._off(this.element,"mouseover",".e-pvtBtn"),this._off(this.element,"mouseleave",".e-pvtBtn"),e(document).off("keyup",this._endCellSelection),e(document).off("keydown",this._startCellSelection),e(document).off("click",this._clearSelection),this._off(this.element,"click",".calculatedFieldPopup .menuItem "),this._off(this.element,"contextmenu",".values .e-pivotButton"),this._off(this.element,"click",".filter",t.proxy(this._filterBtnClick,this)),this._off(this.element,"click",".e-sorting",t.proxy(this._sortBtnClick,this)),this._off(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this)),this._off(this.element,"click",".e-removeBtn",t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._removePvtBtn:this._clientRemovePvtBtn,this)),this._off(this.element,"click",".e-ascOrder, .e-descOrder"),this._off(this.element,"click",".clearAllFilters, .clearSorting"),this._off(this.element,"contextmenu"),this._off(this.element,"click",".e-dialogOkBtn"),this._off(this.element,"click",".e-cellSelect"),this._off(this.element,"click",".e-columnResize"),this._off(this.element,"click",".e-excelLikeLayout"),this._off(this.element,"click",".e-advancedFiltering"),this._off(this.element,"click",".e-toolTip"),this._off(this.element,"click",".e-collapseByDefault"),this._off(this.element,"click",".rtl"),this._off(this.element,"click",".e-calculatedField"),this._off(this.element,"click",".e-cellEditing"),this._off(this.element,"click",".groupingBar"),this._off(this.element,"click",".e-conditionalFormat"),this._off(this.element,"click",".e-summaryCustomize"),this._off(this.element,"click",".e-summaryTypes"),this._off(this.element,"click",".e-numberFormatting"),this._off(this.element,"click",".e-rowHeaderHyperLink"),this._off(this.element,"click",".e-colHeaderHyperLink"),this._off(this.element,"click",".e-valueCellHyperLink"),this._off(this.element,"click",".e-summaryCellHyperLink"),this._off(this.element,"click",".e-rowFreeze"),this._off(this.element,"click",".e-colFreeze"),this._off(this.element,"click",".bothFreeze"),this._off(this.element,"click",".e-excel"),this._off(this.element,"click",".e-word"),this._off(this.element,"click",".e-pdf"),this._off(this.element,"click",".csv"),this._off(this.element,"click",".e-frozenHeaders"),this._off(this.element,"click",".e-exporting"),this._off(this.element,"click",".e-layouts"),this._off(this.element,"click",".e-hyperlinkOptions"),this._off(this.element,"click",".e-normalLayout"),this._off(this.element,"click",".e-normalTopSummaryLayout"),this._off(this.element,"click",".e-noSummariesLayout"),this._off(this.element,"click",".e-drillThrough"),this._off(this.element,"mousedown touchstart",".value",this._initCellSelection),this._off(this.element,"click",".colheader,.rowheader",this._headerClickCellSelection),this._off(this.element,"click",".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage"),this._off(this.element,"click",".e-searchEditorTree")},_getFieldName:function(i){var l;if(e(i).hasClass("colheader")||"columnheader"==e(i).attr("role")){var a=parseInt(e(i).attr("data-p").split(",")[1]),r=t.isNullOrUndefined(this.model.dataSource.data)||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-fullScreenView").length>0)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns,o=i.textContent.replace("expanded","");return a<r.length?this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?r[a].fieldName:r[a].FieldName:o}if(e(i).hasClass("rowheader")||"rowheader"==e(i).attr("role"))return l=parseInt(e(i).attr("data-p").split(",")[0]),t.isNullOrUndefined(this.model.dataSource.data)||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this.element.parents(".e-pivotclient").length>0||this.element.parents(".e-fullScreenView").length>0)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows[l].FieldName:JSON.parse(this.getOlapReport()).PivotRows[l].FieldName:t.isNullOrUndefined(this.model.dataSource.rows)?"":this.model.dataSource.rows[l].fieldName},_colResizing:function(t){var i,l;if(this.model.enableColumnResizing)if(this._expand){var a=t.clientX,r=t.clientY,o=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").first()[0].getBoundingClientRect();o.left+document.documentElement.scrollLeft+o.width<a||a<o.left+document.documentElement.scrollLeft?this.element.find(".e-reSizeColbg").remove():-1!=this._currentCell&&this.element.find(".e-reSizeColbg").css({left:a,top:this._tableY})}else{if(this.element.find(".e-reSizeColbg").is(":visible"))return;if("columnheader"==e(t.target).attr("role")){var s=this.resCell=t.target,n=s.getBoundingClientRect();a=t.clientX,r=t.clientY;i=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(".pivotGridFrozenTable,.pivotGridColValueTable").width()+e(".pivotGridFrozenTable,.pivotGridColValueTable").find("tr").offset().left:e(this.element).find("thead").width()+e(this.element).find("thead tr").offset().left,(a>=n.left+document.documentElement.scrollLeft+s.offsetWidth-5||a<=n.left+3)&&a<i&&a>=n.left&&r<=n.top+document.documentElement.scrollTop+t.target.offsetHeight?(a>n.left+3?(l=e(t.target).find("span"),this._currentCell=t.target):(l=e(t.target).prevAll("th:visible:first").find("span"),this._currentCell=e(t.target).prev()),l.length&&e(t.target).parents(".e-pivotGridTable tr").css("cursor","col-resize")):(e(t.target).parent("tr").css("cursor","pointer"),this._currentCell=null)}else this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable tr").css("cursor","pointer"),this._currentCell=null}},_startColResizing:function(t){var i,a,r,o,s;if("col-resize"==e(t.target).closest("tr").css("cursor")&&(i=t.clientX,a=t.clientY,this._target=t.target,this._orgX=i,i+=document.documentElement.scrollLeft,2!=t.button))if(e(this._target).parent("tr").find("[role='columnheader']"),null!=this._currentCell&&(r=e(this._currentCell)[0].getBoundingClientRect()),o=this._tableY=(r==l?0:r.top)+document.documentElement.scrollTop,"col-resize"==e(this._target).closest("tr").css("cursor")){var n=e(document.createElement("div")),d=this.model.enableGroupingBar?this.element.height()-this.element.find(".groupingBarPivot").height():this.model.enableVirtualScrolling?this.element.height()-this.element.find(".e-hScrollPanel").parent().height():this.element.height(),h=this.element.find("thead,.pivotGridFrozenTable,.pivotGridColValueTable").find("tr[role='row']"),c=e(this._target).parent("tr")[0]==l?0:e(this._target).parent("tr")[0].rowIndex;for(s=0;s<c;s++)d-=e(h[s]).height();n.addClass("e-reSizeColbg").appendTo(this.element).attr("unselectable","on").css("visibility","hidden"),n.css({visibility:"visible",height:d+"px",cursor:"col-resize",left:i,top:o,position:"fixed"}),this._orgX=i,this._orgY=a,this._expand=!0}else this._currentCell=null},_endColResizing:function(i){var l,a,r,o,s,n,d,h,c,p,u,m;if(this._expand&&(l=i.clientX,i.clientY),this.element.find(".e-reSizeColbg").remove(),l+=document.documentElement.scrollLeft,a=e(this._target).parents("thead,.pivotGridFrozenTable,.pivotGridColValueTable"),null!=this._currentCell&&this._expand){r=30,this._expand=!1;var g=this._currentCell,f=e(g)[0].offsetWidth,b=l-this._orgX,_=(this.model.frozenHeaderSettings.enableFrozenHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&"none"==this._JSONRecords[0].CSS;if(parseInt(b)+parseInt(f)>r&&0!=b){for(a.css("cursor","default"),s=0;s<2;s++)if(n=0==s?e(g):e(g).next(),d=0==s?parseInt(e(g).attr("colspan")):parseInt(e(g).next().attr("colspan")),n.length){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if(this.element.find(".e-pivotGridTable").find("[role='columnheader']").find(".e-expand").length>1||this.element.find(".e-pivotGridTable").find("[role='columnheader']").find(".e-collapse").length>1)if(_)o=parseInt(this.element.find(".pivotGridFrozenTable thead tr:last").find("[data-p^='"+n.attr("data-p").split(",")[0]+"']").index());else if(this.model.enableAdvancedFilter){for(h=0,c=0;c<parseInt(n.attr("data-p").split(",")[0]);c++)"none"==this.element.find(".e-pivotGridTable thead tr:last th:eq("+c+")").css("display")&&h++;o=parseInt(n.attr("data-p").split(",")[0])-(h+(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._JSONRecords[0].ColSpan-1:0))}else o=parseInt(this.element.find(".e-pivotGridTable thead tr:last").find("[data-p^='"+n.attr("data-p").split(",")[0]+"']").index())+(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?1:this._JSONRecords[0].ColSpan);else o=_?parseInt(n.attr("data-p").split(",")[0])-this._JSONRecords[0].ColSpan:this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?t.isNullOrUndefined(n.attr("data-i"))?parseInt(n.attr("data-p").split(",")[0]):parseInt(n.attr("data-i").split(",")[0]):parseInt(n.attr("data-p").split(",")[0]);else o=_?parseInt(n.attr("data-p").split(",")[0])-this._JSONRecords[0].ColSpan:this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?parseInt(n.attr("data-i").split(",")[0]):parseInt(n.attr("data-p").split(",")[0]);p=Math.round(b/d),u=this.element.find("col:eq("+o+")").width()+(0==s?p:-p),this._setWidthColResize(o,d,u)}this.element.find("tr").css("cursor","default")}}this.model.enableGroupingBar&&(this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this.element.find(".groupingBarPivot").css({overflow:"hidden"})),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(m=this.element.find(".e-scroller").data("ejScroller"),t.isNullOrUndefined(m)||m.refresh()),!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders&&((m=this.element.find(".e-scroller").data("ejScroller")).model.enableTouchScroll=!1),this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.element.find("#coltable").width()<this.element.find(".valScrollArea").width()&&this.element.find("#coltable").width(this.element.find(".valScrollArea").width()),this._target=null,this.element.find(".e-reSizeColbg").remove(),this._expand=!1,this._currentCell=null},_setWidthColResize:function(e,t,i){for(var l=i>30?i:30,a=e;a<e+t;a++)this.element.find("colgroup").find("col:eq("+a+")").outerWidth(l)},_resizeColumnsWidth:function(){var i,l,a,r,o,s;if(!(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||t.isNullOrUndefined(this._JSONRecords))){if(this.model.enableAdvancedFilter||this.element.find(".e-pivotGridTable").find("colgroup").remove(),i=e("<colgroup></colgroup>"),(this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode||t.isNullOrUndefined(this.model.dataSource.columns)||0!=this.model.dataSource.columns.length&&1!=this.model.dataSource.columns.length)&&(this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode||t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotColumns)||0!=JSON.parse(this.getOlapReport()).PivotColumns.length&&1!=JSON.parse(this.getOlapReport()).PivotColumns.length))for(s=0;s<this._JSONRecords.length/this._rowCount&&!t.isNullOrUndefined(this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[s]);s++)r="<col style='width:"+this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[s].offsetWidth/Number(e(this.element.find(".e-pivotGridTable tbody tr:first").children(":visible")[s]).attr("colspan"))+"px'></col>",i.append(r);else for(s=0;s<this.element.find(".e-pivotGridTable thead tr:first th").length;s++)for(l=0;l<Number(this.element.find(".e-pivotGridTable thead tr:first th:eq("+s+")").attr("colspan"));l++)a=this.element.find(".e-pivotGridTable thead tr:first th:eq("+s+")"),r="<col style='width:"+(t.isNullOrUndefined(a.offsetWidth)?a.outerWidth():a.offsetWidth)/Number(a.attr("colspan"))+"px'></col>",i.append(r);if(this.model.enableAdvancedFilter&&this.element.find(".e-pivotGridTable").find("colgroup").remove(),this.element.find(".e-pivotGridTable").prepend(i),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&this.element.find(".e-pivotGridTable").css("width","100%"),this.model.enableGroupingBar){if(o=this.element.find(".groupingBarPivot .values").width()>this.element.find(".e-grpRow .e-rows").width()?this.element.find(".groupingBarPivot .values").width():this.element.find(".e-grpRow .e-rows").width(),this._JSONRecords.length>0&&this._JSONRecords[0].ColSpan>=1&&!this.model.resizeColumnsToFit)for(s=0;s<this._JSONRecords[0].ColSpan;s++)this.element.find("colgroup col:eq("+s+")").css("width",o/this._JSONRecords[0].ColSpan);this.element.find(".groupingBarPivot .values").width()<this.element.find(".e-grpRow .e-rows").width()&&this.element.find(".groupingBarPivot .values").css("width",this.element.find(".e-grpRow .e-rows").width()),this.element.find(".e-grpRow").length>0&&this.element.find("colgroup col:eq(0)").width()<140&&this.element.find("colgroup col:eq(0)").css("min-width","140px"),this.element.find(".values").width(this.element.find(".e-grpRow").length>0?this.model.enableDeferUpdate&&0==this.element.find(".colheader").length?this.element.find(".e-grpRow").width():this.element.find(".e-grpRow").width()+4:140),this._createFields(null,this.element.find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())}}},_direction:function(e){return this.model.enableRTL&&!t.isNullOrUndefined(e)&&e.toString().indexOf("-")>-1?e.split("-").reverse().join("-"):e},_clearSelection:function(t){0==e(t.target).parents(".e-pivotGridTable").length&&e(this.element).find(".e-selected").removeClass("e-selected")},_startCellSelection:function(i){var l,a;if("Control"!=this._onholdKey&&!t.isNullOrUndefined(this._selectedCell))if(i.preventDefault(),""==this._onholdKey&&(this._onholdKey="16"==i.which.toString()?"Shift":"17"==i.which.toString()?"Control":""),"40"==i.which){for(r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[1])+this._selectedCell.rowSpan;t.isNullOrUndefined(s)&&o<this._rowCount;)a=e(this.element).find("[data-p='"+r.split(",")[0]+","+o+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(s=a),o++;t.isNullOrUndefined(s)||this._selectCells("Down",s)}else if("38"==i.which){for(r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[1])-1;t.isNullOrUndefined(s)&&o>=0;)a=e(this.element).find("[data-p='"+r.split(",")[0]+","+o+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(s=a),o--;if(t.isNullOrUndefined(s)&&"Shift"!=this._onholdKey&&(e(this._selectedCell).hasClass("colheader")||"columnheader"==e(this._selectedCell).attr("role")))for(column=parseInt(r.split(",")[0])-1;column>0&&t.isNullOrUndefined(s);column--)for(row=parseInt(r.split(",")[1]-1);row>=0&&t.isNullOrUndefined(s);row--)a=e(this.element).find("[data-p='"+column+","+row+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(s=a);t.isNullOrUndefined(s)||this._selectCells("Up",s)}else if("39"==i.which){for(r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[0])+this._selectedCell.colSpan;t.isNullOrUndefined(s)&&o<Math.ceil(this.getJSONRecords().length/this._rowCount);)a=e(this.element).find("[data-p='"+o+","+r.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(s=a),o++;t.isNullOrUndefined(s)||this._selectCells("Right",s)}else if("37"==i.which){for(var r=e(this._selectedCell).attr("data-p"),o=parseInt(r.split(",")[0])-1,s=e(this.element).find("[data-p='"+(parseInt(r.split(",")[0])-1)+","+r.split(",")[1]+"']")[0];t.isNullOrUndefined(s)&&o>=0;)a=e(this.element).find("[data-p='"+o+","+r.split(",")[1]+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role")||e(a).hasClass("colheader")||"columnheader"==e(a).attr("role"))&&(s=a),o--;if(t.isNullOrUndefined(s)&&"Shift"!=this._onholdKey&&(e(this._selectedCell).hasClass("rowheader")||"rowheader"==e(this._selectedCell).attr("role")))for(l=parseInt(r.split(",")[1])-1;t.isNullOrUndefined(s)&&l>0;)a=e(this.element).find("[data-p='"+parseInt(r.split(",")[0]-1)+","+l+"']")[0],!t.isNullOrUndefined(a)&&"none"!=e(a).css("display")&&"none"!=e(e(a).parents("tr")[0]).css("display")&&(e(a).hasClass("rowheader")||"rowheader"==e(a).attr("role"))&&(s=a),l--;t.isNullOrUndefined(s)||this._selectCells("Left",s)}},_endCellSelection:function(i){var l,a,r,o,s;if(!t.isNullOrUndefined(this._selectedCell)&&(i.preventDefault(),(16==i.which||17==i.which)&&(this._onholdKey="",(l=e(this.element).find(".e-selected")).length>0))){for(a=[],r=0;r<l.length;r++)o=e(l[r]).attr("data-p"),(s=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))]).Value=e.trim(e(l[r]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(s.Field=this._getFieldName(l[r])),a.push(s);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:a}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:a})}},_selectCells:function(i,l){var a,r,o,s,n,d,h;if("Shift"==this._onholdKey)(("Up"==i||"Down"==i)&&(e(l).hasClass("rowheader")||"rowheader"==e(l).attr("role"))||("Right"==i||"Left"==i)&&(e(l).hasClass("colheader")||"columnheader"==e(l).attr("role")))&&(a="Up"==i||"Down"==i?1:0,("Up"==i||"Left"==i)&&parseInt(e(l).attr("data-p").split(",")[a])>=parseInt(this._primaryCellPos.split(",")[a])||("Right"==i||"Down"==i)&&parseInt(e(l).attr("data-p").split(",")[a])<=parseInt(this._primaryCellPos.split(",")[a])?e(this._selectedCell).removeClass("e-selected"):"0,0"!=e(l).attr("data-p")&&e(l).addClass("selected"));else if("0,0"!=e(l).attr("data-p")&&(this.element.find(".e-selected").removeClass("e-selected"),e(l).addClass("e-selected"),this._primaryCellPos=e(l).attr("data-p"),(r=e(this.element).find(".e-selected")).length>0)){for(o=[],s=0;s<r.length;s++)n=e(r[s]).attr("data-p"),(d=this.getJSONRecords()[parseInt(parseInt(n.split(",")[0])*this._rowCount+parseInt(n.split(",")[1]))]).Value=e.trim(e(r[s]).text()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(d.Field=this._getFieldName(r[s])),o.push(d);t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",{JSONRecords:o}):this._pivotClientObj._trigger("cellSelection",{JSONRecords:o})}h="Up"==i||"Down"==i?!e(this._selectedCell).hasClass("colheader")&&"columnheader"!=e(this._selectedCell).attr("role"):!e(this._selectedCell).hasClass("rowheader")&&"rowheader"!=e(this._selectedCell).attr("role"),"0,0"!=e(l).attr("data-p")&&("Shift"!=this._onholdKey||h)&&(this._selectedCell=l)},_sortBtnClick:function(i){var l,a,r,o,s,n,d,h;if(t.PivotAnalysis._valueSorting=null,t.isNullOrUndefined(this.model.valueSortSettings)||(this.model.valueSortSettings.headerText=""),this._isUpdateRequired=!0,e(i.delegateTarget).attr("id")==this._id&&(e(i.target).toggleClass("descending"),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".e-pivotButton[data-tag='"+e(i.target).parent().attr("data-tag")+"']").find(".e-sorting").toggleClass("descending")),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)l=e(i.target).siblings(".e-pvtBtn").attr("data-fieldName"),t.Pivot.getReportItemByFieldName(l,this.model.dataSource).item.sortOrder=i.target.className.indexOf("descending")>=0?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending,this.refreshControl();else{for(a=this._ascdes.split("##"),r=0,o=0;o<a.length;o++)a[o]==e(e(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")?r=1:e(i.target).parents().hasClass("e-pivotschemadesigner")&&a[o]==e(e(i.target).siblings(".e-pvtBtn")).text()&&(r=1);s=i.target.className,new RegExp("descending").test(s)?0==r&&(this._ascdes+=e(i.target).parents().hasClass("e-pivotschemadesigner")?e(e(i.target).siblings(".e-pvtBtn")).text()+"##":e(e(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")+"##"):1==r&&(this._ascdes=this._ascdes.replace(e(e(i.target).siblings(".e-pvtBtn")).attr("data-fieldName")+"##","")),d=JSON.stringify(this.model.customObject);try{n=JSON.parse(this.getOlapReport()).Report}catch(e){n=this.getOlapReport()}null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject}),d=JSON.stringify(this.model.customObject),h=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:n,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:d}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.enableDeferUpdate?this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,h,this._sortingSuccess)}},calculateCellWidths:function(){var t,i,l,a,r={rowHeight:0,columnWidths:[]};if(t=null!=this._excelLikeJSONRecords?this._excelLikeJSONRecords.length/this._excelRowCount:null!=this.getJSONRecords()?this.getJSONRecords().length/this._rowCount:0,i=1,l=!1,t>0)for(r.rowHeight=this.element.find("tbody tr:visible").length>0?this.element.find("tbody tr:visible")[0].getBoundingClientRect().height:0,a=0;a<t&&i<=t;a++)e(null!=this._excelLikeJSONRecords?this.element.find("th[data-i^="+a+"]:visible"):this.element.find("th[data-p^="+a+"]:visible")).each(function(){if(e(this).length>0&&e(this).attr("colspan")==i&&(null!=e(this).attr("data-i")?e(this).attr("data-i").split(",")[0]==a:e(this).attr("data-p").split(",")[0]==a))return r.columnWidths.push(this.getBoundingClientRect().width),a+=i-1,i=1,l=!0,!1;l=!1}),l||i==t?i=1:(a--,i++);return r},_deferUpdate:function(){var e,i,l,a,r;if(!this._isUpdateRequired)return!1;this._isUpdateRequired=!1;try{e=JSON.parse(this.getOlapReport()).Report}catch(t){e=this.getOlapReport()}for(i="",l=0;l<this._filterUpdate.length;l++)i+=this._filterUpdate[l]+"%%";a=JSON.stringify(this.model.customObject),r=JSON.stringify({action:"deferUpdate",sortedHeaders:this._ascdes,gridLayout:this.layout(),filterParams:i,currentReport:e,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:a}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.deferUpdate,r,this._renderControlSuccess),this._filterUpdate=[],this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()},_dialogBtnClick:function(i){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T;if(this.element.find(".e-dialog, .e-clientDialog").hide(),"cancel"==i.model.text.toLowerCase()||!this._isMembersFiltered)return t.Pivot.closePreventPanel(this),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),!1;if(this._savedReportItems=e.extend(!0,[],this._currentReportItems),this.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").length>0&&this.element.find(".e-editorTreeView").ejTreeView("removeNode",this.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").closest("li")),this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)if(a=[],r=[],this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)t.PivotAnalysis._valueSorting=null,this.model.enableMemberEditorPaging||this._editorTreeData.length>0?(jQuery.each(this._editorTreeData,function(e,t){"All"!=t.id&&t.checkedStatus&&a.push(t.name)}),jQuery.each(this._editorTreeData,function(e,t){t.checkedStatus||r.push(t.name="(blank)"==t.name?"":t.name)})):(jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:checked"),function(e,t){"All"!=t.value&&a.push(t.value)}),jQuery.each(this._memberTreeObj.element.find(":input.nodecheckbox:not(:checked)"),function(t,i){r.push(i.value="(blank)"==i.value?"":e(i).parents("li").find("a").text())})),this._pivotFilterItems(a,r),(p=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item)&&(p.advancedFilter=[]),this.model.editCellsInfo={},this._populatePivotGrid();else{if(s=this.model.dataSource.providerName==t.olap.Providers.Mondrian,this._waitingPopup.show(),n=this._selectedField.toLocaleLowerCase(),this._currentReportItems=e.grep(this._currentReportItems,function(e){if(e["data-fieldName"]!=l&&e["data-fieldName"].toLocaleLowerCase()!=n)return e}),this._memberTreeObj=t.Pivot.updateTreeView(this),d=t.Pivot.getNodesState(this.model.enableMemberEditorPaging||this._editorTreeData.length>0?this._editorTreeData:this._memberTreeObj),null!=this._schemaData&&(this._schemaData._memberTreeObj=this._memberTreeObj),o=this.model.enableMemberEditorPaging||this._editorTreeData.length>0?e.extend(!0,[],this._editorTreeData):this._memberTreeObj.dataSource(),s){for(h=2,c=0;c<o.length;c++)!t.isNullOrUndefined(o[c].level)&&o[c].level>h&&(h=o[c].level);this.model.dataSource._maxLevel=h}if(this._currentReportItems.push({filterItems:o,fieldName:this._selectedField,pageSettings:this._memberCount}),this.model.enableGroupingBar){var y=t.Pivot._getEditorMember(n,this,!1),x="selectedNodes",M="include";this._fieldSelectedMembers[n]=0==e.map(this._fieldMembers[n],function(e){if(!e.checked)return e}).length?"All":"All"!=y&&"multiple"!=y?y:this._getLocalizedLabels("MultipleItems")}s&&(x="unSelectedNodes",M="exclude"),a=e.map(d[x].split("::"),function(e){return{Id:e.split("||")[0],tag:e.split("||")[1],parentId:e.split("||")[2]}}),p=t.Pivot.getReportItemByFieldName(n,this.model.dataSource).item,t.isNullOrUndefined(p)||(""!=d.unSelectedNodes?(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this),p.advancedFilter=[],p.filterItems={filterType:M,values:this._removeSelectedNodes(a)},this.element.find(".e-pivotButton:contains('"+this._selectedField+"') .filter").addClass("filtered"),null!=this._schemaData&&0==this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] .filter").length&&(this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] div:first .e-text").after(t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").addClass("filtered"))):(delete p.filterItems,null!=this._schemaData&&(this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))),this.getJSONData({action:"filtering"},this.model.dataSource,this)}else{"",u="",u=this.element.find(".e-editorTreeView :input.nodecheckbox");var P=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._getUnSelectedNodes()+"FILTERED"+this._getSelectedNodes(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?"Slicers"==this._curFilteredAxis:"Filter"==this._curFilteredAxis):this.model.enableMemberEditorPaging||this._editorTreeData.length>0?this._editorTreeData:this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),w=!1,L=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.enableMemberEditorPaging||this._editorTreeData.length>0?t.Pivot._getUnSelectedTreeState(this)+"FILTERED"+t.Pivot._getSelectedTreeState(this.model.analysisMode==t.Pivot.AnalysisMode.Olap?"Slicers"==this._curFilteredAxis:"Filter"==this._curFilteredAxis,this):P:this._curFilteredAxis+"::"+this._curFilteredText+"::FILTERED",N=this._curFilteredText,D=[],R={};if(m=this.model.enableMemberEditorPaging||this._editorTreeData.length>0?""!=t.Pivot._getUnSelectedTreeState(this):""!=this._getUnSelectedNodes(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(this.model.enableGroupingBar&&t.isNullOrUndefined(this._fieldMembers[N])&&(this._fieldMembers[N]=this._editorTreeData.length>0?e.map(this._editorTreeData,function(e){if("(All)_0"!=e.id)return e.key||e.name}):t.Pivot._getEditorMember(u,this,!1)),this._removeFilterTag(this._curFilteredText),P.length>0&&"(All)_0"==P[0].id&&P.splice(0,1),f=0;f<P.length;f++)this.model.enableMemberEditorPaging||0!=this._editorTreeData.length?0==P[f].checkedStatus&&D.push(P[f].key||P[f].name):D.push(e(P[f].parentElement).siblings("a").text());for(R[N]=D,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),f=0;f<this._tempFilterData.length;f++)t.isNullOrUndefined(this._tempFilterData[f][N])||(this._tempFilterData[f][N]=D,w=!0);if(w||this._tempFilterData.push(R),null!=this._schemaData&&(this._schemaData._tempFilterData=this._tempFilterData),t.isNullOrUndefined(this._curFilteredAxis)||""!=this._curFilteredAxis)for(f=0;f<P.length;f++)this.model.enableMemberEditorPaging||0!=this._editorTreeData.length?0==P[f].checkedStatus&&(L+="##"+(P[f].key||P[f].name)):L+="##"+e(P[f].parentElement).siblings("a").text()}else{for(this.model.enableGroupingBar&&(y=t.Pivot._getEditorMember(N.split(":")[1],this,!1),this._fieldSelectedMembers[N.split(":")[1]]=0==e.map(this._fieldMembers[N.split(":")[1]],function(e){if(!e.checked)return e}).length?"All":"All"!=y&&"multiple"!=y?y:this._getLocalizedLabels("MultipleItems")),R[this._curFilteredText.split(":")[1]]=L,t.isNullOrUndefined(this._tempFilterData)&&(this._tempFilterData=[]),f=0;f<this._tempFilterData.length;f++)t.isNullOrUndefined(this._tempFilterData[f][this._curFilteredText.split(":")[1]])||(this._tempFilterData[f]=R,w=!0);w||this._tempFilterData.push(R)}if("excel"==this.model.layout?this.element.find(".e-schemaFieldTree li:contains('"+this._curFilteredText+"')"):this.element.find("."+this._curFilteredAxis+" .e-pivotButton:contains("+this._curFilteredText+") .filterBtn"),g=this._curFilteredText,this.model.layout==t.PivotGrid.Layout.Normal&&null!=this._schemaData){for(f=0;f<this._schemaData.element.find(".e-fieldTable").find("li").length;f++)this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._curFilteredText.split(":")[1]==e(this._schemaData.element.find(".e-fieldTable").find("li")[f]).attr("data-tag").replace(/\]/g,"").replace(/\[/g,"")&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".e-fieldTable").find("li")[f],g=this._curFilteredText.split(":")[1].split(".")[1]):this._curFilteredText==this._schemaData.element.find(".e-fieldTable").find("li")[f].id&&(this._schemaData._selectedTreeNode=this._schemaData.element.find(".e-fieldTable").find("li")[f],g=this._curFilteredText);if(e(this._schemaData._selectedTreeNode).parents("li:eq(0)").children().children("span").hasClass("e-hierarchyCDB")&&(this._schemaData._selectedTreeNode=e(e(this._schemaData._selectedTreeNode).parents("li:eq(0)"))),m&&e(this._schemaData._selectedTreeNode).find(".filter").length<=0?(b=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,e(e(this._schemaData._selectedTreeNode).find(".e-text")[0]).after(b),this._schemaData.element.find(".e-pvtBtn:contains('"+g+"')").parent().find(".filter").addClass("filtered")):m||(e(this._schemaData._selectedTreeNode).find(".filter").remove(),this._schemaData.element.find(".e-pvtBtn:contains('"+g+"')").parent().find(".filter").removeClass("filtered")),""==this._curFilteredAxis)return!1}try{_=JSON.parse(this.getOlapReport()).Report}catch(e){_=this.getOlapReport()}if(this.model.enableAdvancedFilter&&this._selectedLevelUniqueName&&3==this._selectedLevelUniqueName.split("].").length&&((v=this._getAdvancedFilterInfo(this._selectedLevelUniqueName.split("].").slice(0,2).join(".").replace(/\[/g,""))).length>0&&this._removeFilterTag(v[0].levelUniqueName)),"KPI"==this._dialogHead&&(L=P),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),C=JSON.stringify(this.model.customObject),S=this.model.customObject!={}&&""!=L?JSON.stringify({action:"filtering",filterParams:L,sortedHeaders:this._ascdes,currentReport:_,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:C,gridLayout:this.model.layout}):this.model.customObject!={}?JSON.stringify({action:"filtering",currentReport:_,customObject:C,gridLayout:this.model.layout}):""!=L?JSON.stringify({action:"filtering",filterParams:L,sortedHeaders:this._ascdes,currentReport:_,gridLayout:this.model.layout}):JSON.stringify({action:"filtering"}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(e(this._schemaData.element).width()).height(e(this._schemaData.element).height()).css({top:e(this._schemaData.element).offset().top,left:e(this._schemaData.element).offset().left}),this.model.enableDeferUpdate){if(this._filterUpdate.push(L),e.each(this.element.find(".e-pivotButton .filter"),function(t,i){e(i).removeClass("filtered")}),!t.isNullOrUndefined(this._tempFilterData))for(O=0;O<this._tempFilterData.length;O++)for(T in this._tempFilterData[O])this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?T==N.split(":")[1]&&this._tempFilterData[O][N.split(":")[1]].split("FILTERED::")[0].length>0&&this.element.find(".e-pivotButton[data-tag='"+N+"']").find("span.filter").addClass("filtered"):T==N&&this._tempFilterData[O][N].length>0&&this.element.find("#pivotButton"+N).next().addClass("filtered");t.Pivot.closePreventPanel(this),this.model.enableGroupingBar&&this._refreshGroupingBar(this),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")}else this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,S,this._filterElementSuccess)}t.isNullOrUndefined(this._schemaData)||this._schemaData._refreshPivotButtons()},_refreshGroupingBar:function(){this._createGroupingBar(JSON.parse(this.getOlapReport())),this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())},_removeSelectedNodes:function(t){for(var i,a=e.extend([],t),r=0;r<t.length;r++)for(i=0;i<a.length;i++)a[i].Id==t[r].parentId&&a.splice(i,1);return e.map(a,function(e){if(""!=e.tag&&e.tag!=l)return e.tag.replace(/\&/g,"&amp;")})},_pivotFilterItems:function(i,l){var a,r,o=this.model.dataSource["Slicers"==this._selectedAxis?"filters":this._selectedAxis.toLowerCase()],s=t.PivotAnalysis.getMembers(this._selectedField);jQuery.each(s,function(e,t){null!=t&&t.toString().replace(/^\s+|\s+$/gm,"")||jQuery.each(l,function(e,i){i.toString().replace(/^\s+|\s+$/gm,"")||(l[e]=t)})});var n=this._selectedField,d=(this._dialogTitle,e.grep(o,function(e){return e.fieldName==n}));for(a=0;a<d.length;a++)d[a].filterItems=i.length==s.length?null:{filterType:t.PivotAnalysis.FilterType.Exclude,values:l};null!=this._schemaData&&(l.length>0&&this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").length<=0?(r=t.buildTag("span.e-icon",{display:"none"}).addClass("filter")[0].outerHTML,this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".e-text").after(r),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").addClass("filtered")):0==l.length&&(this._schemaData.element.find(".e-schemaFieldTree li[id='"+this._selectedField+"']").find(".filter").remove(),this._schemaData.element.find(".e-pvtBtn[data-fieldName='"+this._selectedField+"']").parent().find(".filter").removeClass("filtered")))},_getUnSelectedNodes:function(){var i,l,a=this.element.find(".e-editorTreeView")[0],r="",o=e(a).find(":input.nodecheckbox:not(:checked)");if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)for(i=0;i<o.length;i++)e(o[i].parentElement).find("span:nth-child(1)").attr("class").indexOf("e-chk-act")>-1||"mixed"==e(o[i].parentElement).attr("aria-checked")||(r+="::"+(l=e(o[i]).parents("li:eq(0)"))[0].id+"||"+e(l).attr("data-tag")+("KPI"==this._dialogHead?"~&"+e(e(o[i]).parents("ul:eq(1) li")[1]).attr("data-tag"):""));return r},_getSelectedNodes:function(i){var l,a,r,o,s;if(i){for(this.element.find(".e-editorTreeView").length>0?n=this.element.find(".e-editorTreeView")[0].childNodes[0]:t.isNullOrUndefined(this._schemaData)||(n=this._memberTreeObj.element[0].childNodes[0]),d=[],h=e(n).children(),o=0;o<h.length;o++){if(s=h[o],l={caption:e(s.firstChild).find("a").text(),parentId:s.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":e(s).parents()[1].id,id:s.id,checked:e(s).find(":input.nodecheckbox")[0].checked||e(s).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:e(s.firstChild).find(".e-minus").length>0,childNodes:[],tag:e(s).attr("data-tag")},e(s).find("ul:first").children().length>0)for(a=e(s).find("ul:first").children(),r=0;r<a.length;r++)l.childNodes.push(this._getNodeInfo(a[r]));d.push(l)}return JSON.stringify(d)}var n=this.element.find(".e-editorTreeView")[0],d="",h=e(n).find(":input.nodecheckbox");for(o=0;o<h.length;o++)(h[o].checked||"mixed"==e(h[o].parentElement).attr("aria-checked"))&&(d+="::"+(s=e(h[o]).parents("li:eq(0)"))[0].id+"||"+e(s).attr("data-tag")+("KPI"==this._dialogHead?"~&"+e(e(h[o]).parents("ul:eq(1) li")[1]).attr("data-tag"):""));return d},_getNodeInfo:function(t){var i,l,a={caption:e(t.firstChild).find("a").text(),parentId:t.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":e(t).parents()[1].id,id:t.id,checked:e(t).find(":input.nodecheckbox")[0].checked||e(t).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:e(t.firstChild).find(".e-minus").length>0,childNodes:[],tag:e(t).attr("data-tag")};if(e(t).find("ul:first").children().length>0)for(i=e(t).find("ul:first").children(),l=0;l<i.length;l++)a.childNodes.push(this._getNodeInfo(i[l]));return a},_getLevelInfo:function(t,i){var l=e.map(e(i).find("row"),function(i){if("1"!=parseInt(e(i).children("LEVEL_TYPE").text())&&"[measures]"!=e(i).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase()&&e(i).find("HIERARCHY_UNIQUE_NAME").text()==t.hierarchy)return{value:e(i).find("LEVEL_UNIQUE_NAME").text(),text:e(i).find("LEVEL_CAPTION").text()}});this.olapCtrlObj._currentReportItems.push({fieldName:t.hierarchy,dropdownData:l})},_sortField:function(i){var l,a,r,o,s;if(this.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)return l=this._selectedField,this._ascdes=this._ascdes+l+"##","descOrder"!=e(i.element).attr("id")&&(this._ascdes=e.grep(this._ascdes.split("##"),function(e){return e!=l}).join("##")),this._applySorting(),!1;t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item.sortOrder="descOrder"==e(i.element).attr("id")?t.PivotAnalysis.SortOrder.Descending:t.PivotAnalysis.SortOrder.Ascending,this.refreshControl()}else{if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._waitingPopup&&this._waitingPopup.show();try{a=JSON.parse(this.getOlapReport()).Report}catch(e){a=this.getOlapReport()}r=!1,this._excelFilterInfo.length>0&&(this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]",o=this._selectedLevelUniqueName,s=this._selectedField,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(l){return(l.hierarchyUniqueName==s||t.isNullOrUndefined(s)||t.isNullOrUndefined(l.hierarchyUniqueName))&&l.levelUniqueName==o&&(r=!0,0==e(i.element).find(".e-clrSort").length?l.sortOrder=e(i.element).attr("id"):delete l.sortOrder),l})),r||this._excelFilterInfo.push({hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:e(i.element).attr("id")}),this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]";var n=this._selectedField+"--"+e(i.element).attr("id"),d=JSON.stringify(this.model.customObject),h=JSON.stringify({action:"labelSorting",filterParams:n,currentReport:a,customObject:d,gridLayout:this.model.layout});return this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,h,this._filterElementSuccess),!1}t.olap.base._clearDrilledCellSet(),("descOrder"==e(i.element).attr("id")||"ascOrder"==e(i.element).attr("id"))&&(t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item.sortOrder="descOrder"==e(i.element).attr("id")?t.olap.SortOrder.Descending:t.olap.SortOrder.Ascending,this._waitingPopup.show(),t.olap.base.getJSONData({action:"sorting"},this.model.dataSource,this))}},_applySorting:function(){var e,i,l=JSON.stringify(this.model.customObject);try{e=JSON.parse(this.getOlapReport()).Report}catch(t){e=this.getOlapReport()}null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject}),l=JSON.stringify(this.model.customObject),i=JSON.stringify({action:"sorting",sortedHeaders:this._ascdes,currentReport:e,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:l}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.enableDeferUpdate?t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide():this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.sorting,i,this._sortingSuccess)},_createDialog:function(i,l){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_=this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter,v=!1;_&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this._selectedField=this._curFilteredText,"Slicers"!=this._curFilteredAxis&&(v=this._getAdvancedFilterInfo(this._curFilteredText).length>0),_=!this.element.find(".e-pivotButton button[data-fieldName='"+this._curFilteredText+"']").parents("div:eq(0)").hasClass("e-drag")):_=!(!_||this.element.find(".e-pivotButton[data-tag='"+this._curFilteredText+"']").parents("div:eq(0)").hasClass("e-drag")):_=!(!_||"filters"==t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).axis)),this.element.find(".e-dialog, .e-clientDialog").remove(),this._isOptionSearch=!1,this._currentFilterList={},this._editorSearchTreeData=[],this._isEditorDrillPaging=!1,this._lastSavedTree=[],this._isSearchApplied=!1;var C,S,O,T=this._selectedField,y="",x="";e(document).height();_&&((r=JSON.parse(l))[0].name="(Select All)",this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?(C=this.model.enableMemberEditorPaging?this._memberPagingAvdData:r.splice(r.length-1,1),C=JSON.parse(C[0].levels)):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?0==(C=e.map(this._currentReportItems,function(e){if(e.fieldName==T)return e.dropdownData})).length&&(o=this._getConnectionInfo(this.model.dataSource.data),s='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_LEVELS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+this.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+this.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+this.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+o.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>",this.doAjaxPost("POST",o.url,{XMLA:s},this._getLevelInfo,null,{pvtGridObj:this,action:"loadFieldElements",hierarchy:this._selectedField}),C=e.map(this._currentReportItems,function(e){if(e.fieldName==T)return e.dropdownData})):C=[{value:this._selectedField,text:this._selectedField}],l=JSON.stringify(r),y=t.buildTag("div.e-ddlGroupWrap",this._getLocalizedLabels("SelectField")+t.buildTag("input#GroupLabelDrop.groupLabelDrop").attr("type","text")[0].outerHTML,{})[0].outerHTML,x=t.buildTag("ul.e-filterElementTag")[0].outerHTML,n=t.Pivot.createAdvanceFilterTag({action:"filterTag"},this)),S=t.buildTag("div.e-memberSearchEditorDiv",t.buildTag("input#searchEditorTreeView.searchEditorTreeView").attr("type","text")[0].outerHTML+(this.model.enableMemberEditorPaging&&e.parseJSON(l).length>=this.model.memberEditorPageSize?t.buildTag("span.e-icon e-searchEditorTree",{})[0].outerHTML:""),{padding:_?"5px 5px 0px 9px":"0px"})[0].outerHTML;var M=t.buildTag("div#EditorDiv.e-editorDiv",y+t.buildTag("div",x+S+t.buildTag("div.e-memberEditorDiv",t.buildTag("div#editorTreeView.e-editorTreeView",{"margin-top":this.model.enableAdvancedFilter?"10px":"2px"})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML+(!t.isNullOrUndefined(l)&&this.model.enableMemberEditorPaging&&(e.parseJSON(l).length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage)?"":"</br>"),P=t.buildTag("div",t.buildTag("button#OKBtn.e-dialogOKBtn",this._getLocalizedLabels("OK")).attr({title:this._getLocalizedLabels("OK"),tabindex:0})[0].outerHTML+t.buildTag("button#CancelBtn.e-dialogCancelBtn",this._getLocalizedLabels("Cancel")).attr({title:this._getLocalizedLabels("Cancel"),tabindex:0})[0].outerHTML,{float:"right",margin:(_?"-9px 5px 11px ":"-13px 0px 7px ")+"  0px"})[0].outerHTML,w=t.buildTag("div.e-memberPager",t.buildTag("div#"+this._id+"_NextpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentPage#memberCurrentPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberPageCount#memberPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML)[0].outerHTML,L=t.buildTag("div.e-memberSearchPager",t.buildTag("div#"+this._id+"_NextSearchpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentSearchPage#memberCurrentSearchPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberSearchPageCount#memberSearchPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML,N=t.buildTag("div.e-memberDrillPager",t.buildTag("div#"+this._id+"_NextDrillpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentDrillPage#memberCurrentDrillPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberDrillPageCount#memberDrillPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML;for(O=t.buildTag("div.e-linkOuterPanel",t.buildTag("span.e-infoImg e-icon","",{}).css({float:"left","margin-top":"4px","font-size":"16px"})[0].outerHTML+t.buildTag("a.e-linkPanel",this._getLocalizedLabels("NotAllItemsShowing")).css({display:"inline-block","margin-left":"3px","margin-top":"2px"})[0].outerHTML,{}).css({display:"none","margin-top":"-16px","margin-left":_?"8px":"0px"})[0].outerHTML,d=t.buildTag("div#clientDialog.e-clientDialog",M+(!t.isNullOrUndefined(l)&&this.model.enableMemberEditorPaging?e.parseJSON(l).length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage?N+L+w:N+L:O)+P,{opacity:"1"}).attr("title",i)[0].outerHTML,l=JSON.parse(l),f=0;f<l.length;f++)null!=l[f].name&&l[f].name.toString().replace(/^\s+|\s+$/gm,"")||(l[f].name="(blank)",l[f].id="(blank)"),t.isNullOrUndefined(l[f].id)||"string"!=typeof l[f].id||(l[f].id=l[f].id.replace(/ /g,"_"));if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?!t.isNullOrUndefined(this._fieldMembers):!t.isNullOrUndefined(this._tempFilterData)){if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(f=0;f<Object.keys(this._fieldMembers).length;f++)t.isNullOrUndefined(this._fieldMembers[this._curFilteredText.split(":")[1]])||(h=e.map(this._fieldMembers[this._curFilteredText.split(":")[1]],function(e){if(!e.checked)return e.name}));else for(f=0;f<this._tempFilterData.length;f++)t.isNullOrUndefined(this._tempFilterData[f][i])||(h=this._tempFilterData[f][i]);if(!t.isNullOrUndefined(h))for(f=0;f<h.length;f++)for(c=0;c<l.length;c++)h[f]==l[c].name&&(l[c].checkedStatus=!1)}for(e(d).appendTo("#"+this._id),this.model.enableMemberEditorPaging&&(l.length>=this.model.memberEditorPageSize||this.model.memberEditorPageSize<this._memberPageSettings.endPage)&&(this.element.find(".e-prevPage, .e-firstPage").addClass("e-pageDisabled"),this.element.find(".e-nextPage, .e-lastPage").addClass("e-pageEnabled"),(p=this._memberCount/this.model.memberEditorPageSize)!=Math.round(p)&&(p=parseInt(p)+1),this.element.find(".e-memberPageCount").html("/ "+p),this.element.find(".e-memberCurrentPage").val(this._memberPageSettings.currentMemeberPage),this._memberPageSettings.currentMemeberPage>1?this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),this._memberPageSettings.currentMemeberPage==parseInt(e.trim(this.element.find(".e-memberPageCount").text().split("/")[1]))?this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"),this.element.find(".e-nextPageDiv .e-pageDisabled").css("opacity","0.5")),this.element.find("#searchEditorTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search")+" "+i,maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(function(e){t.Pivot._searchEditorTreeNodes(e,this)},this)}),this.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:this.model.enableRTL,beforeDelete:function(e){if(!t.isNullOrUndefined(e.event)&&"keydown"==e.event.type&&"delete"==e.event.originalEvent.key.toLowerCase())return!1},height:this.model.enableMemberEditorSorting?"200px":_?"inherit":"245px",fields:{id:"id",text:"name",parentId:"pid",expanded:"expanded",isChecked:"checkedStatus",hasChild:"hasChildren",dataSource:t.Pivot._showEditorLinkPanel(l,this,this)}}),_&&(a=this.element.find("[data-tag*='"+(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._selectedField:this._curFilteredText)+"']").offset(),this.element.find(".e-filterElementTag").ejMenu({fields:{dataSource:n,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"},menuType:t.MenuType.NormalMenu,enableRTL:this.model.enableRTL,width:"100%",orientation:t.Orientation.Vertical,click:t.proxy(this._filterElementClick,this)}),this.element.find(".groupLabelDrop").ejDropDownList({width:"99%",enableRTL:this.model.enableRTL,dataSource:C,fields:{id:"id",text:"text",value:"value"},change:t.proxy(this._groupLabelChange,this),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),(u=this.element.find(".groupLabelDrop").data("ejDropDownList")).selectItemByText(u.model.dataSource[0].text),this.element.find(".e-memberEditorDiv").addClass("advancedFilter")),f=0;f<this._editorTreeData.length;f++)null!=this._editorTreeData[f].name&&this._editorTreeData[f].name.toString().replace(/^\s+|\s+$/gm,"")||(this._editorTreeData[f].name="(blank)",this._editorTreeData[f].id="(blank)"),t.isNullOrUndefined(this._editorTreeData[f].id)||"string"!=typeof this._editorTreeData[f].id||(this._editorTreeData[f].id=this._editorTreeData[f].id.replace(/ /g,"_"));for(v&&(this.element.find(".e-editorTreeView").data("ejTreeView").checkAll(),this._editorTreeData=e.map(this._editorTreeData,function(e){return e.checkedStatus=!0,e}),this._editorDrillTreeData=e.map(this._editorTreeData,function(e){return e.checkedStatus=!0,e}),this._editorSearchTreeData=e.map(this._editorTreeData,function(e){return e.checkedStatus=!0,e})),m=this,this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)?this._currentFilterList=JSON.parse(JSON.stringify(this._editorTreeData)):!this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)&&e(l).each(function(e,t){m._currentFilterList[t.id]=t}),e.grep(l,function(e){if(1==e.hasChildren)return e}).length>0||this.element.find(".e-memberEditorDiv").addClass("noChildNode"),g=this.element.find(".e-editorTreeView").find("li"),f=0;f<g.length;f++)g[f].setAttribute("data-tag",l[f].tag);this.element.find(".e-dialogOKBtn, .e-dialogCancelBtn").ejButton({type:t.ButtonType.Button,click:t.proxy(this._dialogBtnClick,this)}),this._dialogOKBtnObj=this.element.find(".e-dialogOKBtn").data("ejButton"),this._memberTreeObj=this.element.find(".e-editorTreeView").data("ejTreeView");var D=this.element.find(".e-editorTreeView li:gt(0)"),R=e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image");e(D).find(":input.nodecheckbox:not(:checked)").length>0&&e(R).removeClass("e-checkmark").addClass("e-stop"),this.model.enableMemberEditorPaging&&(this._isAllMemberChecked||(this._dialogOKBtnObj.disable(),this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),e(R).removeClass("e-checkmark").removeClass("e-stop").addClass("e-chk-inact"))),this.element.find(".e-clientDialog").ejDialog({width:_?"auto":265,target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,this)}),this.element.find("#clientDialog_wrapper").css("top",this.element[0].offsetTop+20),this.element.find(".e-clientDialog").next(".e-scrollbar").hide(),_&&(this.element.find("#clientDialog_wrapper").addClass("e-advancedFilterDlg"),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.element.find("#clientDialog_wrapper").addClass("advancedFilterDlgOSM"),(b=e(".cols-sample-area").position())&&b.left>0?this.element.find("#clientDialog_wrapper").css({left:a.left+50-b.left,top:a.top}):t.isNullOrUndefined(a)||this.element.find("#clientDialog_wrapper").css({left:a.left+50,top:a.top}),this.element.find(".e-clientDialog").css({padding:"0px","min-width":"265px"}).parents().find(".e-titlebar").remove()),this.model.enableMemberEditorSorting&&(this._sortType="",t.Pivot._separateAllMember(this),this.model.enableRTL&&this.element.find(".memberSortDiv, .e-insideDiv").addClass("e-rtl")),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this._memberTreeObj.model.beforeExpand=t.proxy(this._beforeNodeExpand,this):this._memberTreeObj.model.nodeClick=t.proxy(this._nodeExpand,this)),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._memberTreeObj.model.beforeCollapse=t.proxy(t.Pivot._onNodeCollapse,this)),0==this._memberTreeObj.element.find(".e-plus").length&&this._memberTreeObj.element.find(".e-item").css("padding","0px"),this._isMembersFiltered=!1,this._unWireEvents(),this._wireEvents(),this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close")),this.element.find(".e-dialog .e-close").click(function(){var i=e(this).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i._schemaData)||i._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")})},_clearSorting:function(i){var a,r,o;if("disabled"==e(i.target).parent().attr("disabled"))return!1;if(t.Pivot.closePreventPanel(this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._sortField(i):((h=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item).sortOrder=t.PivotAnalysis.SortOrder.None,this.refreshControl());else{if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){this._waitingPopup&&this._waitingPopup.show(),this._selectedField=this._selectedLevelUniqueName.split("].").splice(0,2).join("].")+"]",this._excelFilterInfo.length>0&&(a=this._selectedLevelUniqueName,r=this._selectedField,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){return(e.hierarchyUniqueName==r||t.isNullOrUndefined(r)||t.isNullOrUndefined(e.hierarchyUniqueName))&&e.levelUniqueName==a&&delete e.sortOrder,e}));try{o=JSON.parse(this.getOlapReport()).Report}catch(e){o=this.getOlapReport()}var s=this._selectedField+"--"+e(i.element).attr("id"),n=JSON.stringify(this.model.customObject),d=JSON.stringify({action:"labelSorting",filterParams:s,currentReport:o,customObject:n,gridLayout:this.model.layout});return this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,d,this._filterElementSuccess),!1}var h,c=this.model.dataSource,p=this._selectedField.toLowerCase();0==(h=e.map(c.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==p)return e})).length&&(h=e.map(c.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==p)return e})),h.length>0&&delete h[0].sortOrder,this.model.dataSource=c,this.element.find(".e-dialog").remove(),this.element.find("#preventDiv").remove(),null!=this._schemaData&&this._schemaData.element.find(".e-dialog").remove(),this._waitingPopup.show(),this.getJSONData({action:"clearSorting"},this.model.dataSource,this)}},_clearAllFilters:function(i){var a,r,o,s,n,d,h,c,p;if("disabled"==e(i.target).parent().attr("disabled"))return!1;if(t.Pivot.closePreventPanel(this),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var u=this.model.dataSource,m=this._selectedField.toLowerCase(),g=e.map(u.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==m)return e});0==g.length&&(g=e.map(u.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==m)return e})),g.length>0&&(null!=(a=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):null==this._schemaData?null:this._schemaData.element.find(".groupLabelDrop").data("ejDropDownList"))?(g[0].advancedFilter&&(g[0].advancedFilter=e.map(g[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLowerCase()!=a.getSelectedValue().toLowerCase())return e})),null!=this._schemaData&&(g[0].advancedFilter&&0==g[0].advancedFilter.length&&this._schemaData._tableTreeObj.element.find("li[data-tag ='"+g[0].fileName+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[data-tag='"+a.getSelectedValue()+"'] div:eq(0) .filter").remove())):delete g[0].advancedFilter,delete g[0].filterItems),this._currentReportItems=e.grep(this._currentReportItems,function(e){if(e["data-fieldName"]!=l&&e["data-fieldName"].toLocaleLowerCase()!=m)return e}),this.model.dataSource=u,this.element.find(".e-dialog").remove(),this.element.find("#preventDiv").remove(),null!=this._schemaData&&(this._schemaData._tableTreeObj.element.find("li[data-tag ='"+this._selectedField+"'] .filter").remove(),this._schemaData.element.find(".e-dialog").remove()),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._valueFilterArray=e.grep(t.PivotAnalysis._valueFilterArray,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()!=m)return e}),this.refreshControl()):this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)}else{try{r=JSON.parse(this.getOlapReport()).Report}catch(e){r=this.getOlapReport()}if(this._removeFilterTag(this._curFilteredText),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)d=this._curFilteredAxis+"::"+this._curFilteredText+"## Clear Filter",h=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[h])return e}),c=JSON.stringify(this.model.customObject),p=JSON.stringify({action:"labelfiltering",filterParams:d,sortedHeaders:this._ascdes,currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:c,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,p,this._filterElementSuccess);else{if(!t.isNullOrUndefined(this._tempFilterData))for(o=0;o<this._tempFilterData.length;o++)for(s in this._tempFilterData[o])s==this._curFilteredText.split(":")[1]&&""!=this._tempFilterData[o][this._curFilteredText.split(":")[1]]&&(this._tempFilterData.splice(o,1),delete this._fieldMembers[this._curFilteredText.split(":")[1]]);n=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:n}),d=this._selectedLevelUniqueName+"--Clear Filter",h=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[h])return e}),c=JSON.stringify(this.model.customObject),p=JSON.stringify({action:"labelfiltering",filterParams:d,sortedHeaders:this._ascdes,currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:c,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,p,this._filterElementSuccess)}}},_removeFilterTag:function(i){var l,a=[],r=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot;return(i&&i.indexOf("].")>=0||r)&&(l=i.split("].").length>2||r?"levelUniqueName":"hierarchyUniqueName",this._excelFilterInfo.length>0&&(levelName=this._selectedLevelUniqueName,hierarchyName=this._selectedFieldName,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){if(e[l]!=i)return e;a=e.sortOrder}))),a},_groupLabelChange:function(i){var l,a,r,o,s,n=this.element.find(".e-filterElementTag").data("ejMenu");if(n.disableItemByID("labelClearFilter"),n.disableItemByID("valueClearFilter"),n.disableItemByID("clearAllFilters"),n.disableItemByID("clearSorting"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var d,h=this.element.hasClass("e-pivotschemadesigner")?this.model.pivotControl:this,c=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):[],p=h._getAdvancedFiltervalue(h._selectedField,c.getSelectedValue()),u=t.Pivot.getReportItemByFieldName(h._selectedField,h.model.dataSource).item,m=t.buildTag("span.e-filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,g=t.buildTag("span.e-activeFilter").addClass("e-icon")[0].outerHTML,f=t.Pivot.getReportItemByFieldName(h._selectedField,h.model.dataSource).item;f&&f.sortOrder&&f.sortOrder!=t.Pivot.SortOrder.None&&(d=f&&f.sortOrder==t.Pivot.SortOrder.Descending?"desc":"asc",t.isNullOrUndefined(d)||"asc"==d?this.element.find(".e-clientDialog .ascImage").addClass("e-selectedSort"):this.element.find(".e-clientDialog .e-descImage").addClass("e-selectedSort"),n.enableItemByID("clearSorting")),this.element.find(".e-filterState,.e-activeFilter").remove(),o=this.element.find("#clearAllFilters a").children().clone(),this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+i.text+'"').append(o),p.length>0?(p[0].advancedFilterType==t.Pivot.AdvancedFilterType.LabelFilter?(this.element.find("#labelFilterBtn a:eq(0)").append(m),this.element.find("#labelFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),l="equals"==p[0].labelFilterOperator||"notequals"==p[0].labelFilterOperator||"lessthanorequalto"==p[0].labelFilterOperator||"greaterthanorequalto"==p[0].labelFilterOperator||"greaterthan"==p[0].labelFilterOperator||"lessthan"==p[0].labelFilterOperator?"_labelFilter":"",this.element.find("#labelFilterBtn li#"+p[0].labelFilterOperator+l+" a").append(g),n.enableItemByID("labelClearFilter")):(this.element.find("#valueFilterBtn a:eq(0)").append(m),this.element.find("#valueFilterBtn .clearFilter").css("opacity","1").removeAttr("disabled"),a="equals"==p[0].valueFilterOperator||"notequals"==p[0].valueFilterOperator||"lessthanorequalto"==p[0].valueFilterOperator||"greaterthanorequalto"==p[0].valueFilterOperator||"greaterthan"==p[0].valueFilterOperator||"lessthan"==p[0].valueFilterOperator?"_valueFilter":"",this.element.find("#valueFilterBtn li#"+p[0].valueFilterOperator+a+" a").append(g),n.enableItemByID("valueClearFilter")),n.enableItemByID("clearAllFilters")):u&&u.filterItems&&(this.element.find(".e-memberEditorDiv").before(m),this.element.find(".e-filterState").addClass("memberFilter").css("visibility","hidden"),n.enableItemByID("clearAllFilters"))}else{var b,_=this._selectedLevelUniqueName=i.selectedValue,v=(m=t.buildTag("span.e-filterState").addClass("e-icon").attr("aria-label","filter state")[0].outerHTML,[]);this._excelFilterInfo.length>0&&(_=this._selectedLevelUniqueName,r=this._selectedFieldName,v=e.map(this._excelFilterInfo,function(e){if(e.hierarchyUniqueName==r&&e.levelUniqueName==_)return{action:e.action,operator:e.operator,value1:e.value1,sortInfo:e.sortOrder}})),o=this.element.find("#clearAllFilters a").children().clone(),this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+i.text+'"').append(o),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?e.grep(this._ascdes.split("##"),function(e){if(e==_)return e}).length>0?(this.element.find(".e-descImage").addClass("e-selectedSort"),n.enableItemByID("clearSorting")):this.element.find(".ascImage").addClass("e-selectedSort"):v.length>0&&(t.isNullOrUndefined(v[0].sortInfo)||!t.isNullOrUndefined(v[0].sortInfo)&&0==v[0].sortInfo.length)||0==v.length||v[0].sortInfo.length>0&&(this.element.find("#"+v[0].sortInfo+" span:eq(0)").addClass("e-selectedSort"),n.enableItemByID("clearSorting")),this.element.find(".e-filterElementTag .e-activeFilter,.e-filterIndicator").remove(),v.length>0&&!t.isNullOrUndefined(v[0].operator)?(n.enableItemByID("clearAllFilters"),s="","valuefiltering"==v[0].action?(s="valueFilterBtn",n.enableItemByID("valueClearFilter"),b="equals"==v[0].operator||"not equals"==v[0].operator||"less than or equal to"==v[0].operator||"greater than or equal to"==v[0].operator||"greater than"==v[0].operator||"less than"==v[0].operator?"_valueFilter":""):(s="labelFilterBtn",n.enableItemByID("labelClearFilter"),b="equals"==v[0].operator||"not equals"==v[0].operator||"less than or equal to"==v[0].operator||"greater than or equal to"==v[0].operator||"greater than"==v[0].operator||"less than"==v[0].operator?"_labelFilter":""),this.element.find("#"+s+" a:eq(0)").append(m),"BottomCount"==v[0].operator.replace(/ /g,"")?this.element.find("#"+s+" li#"+v[0].operator.replace(/ /g,"").replace("Bottom","top")+" a").append(e(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML)):this.element.find("#"+s+" li#"+v[0].operator.replace(/ /g,"")+b+" a").append(e(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML))):""!=this._getUnSelectedNodes()&&(this.element.find(".e-memberEditorDiv").before("<div class='e-filterState e-icon' style='margin-top:5px;position:absolute;visibility:hidden' />"),n.enableItemByID("clearAllFilters"))}},_getAdvancedFiltervalue:function(i,a){var r=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,o=[];return r&&r.advancedFilter&&(o=e.map(r.advancedFilter,function(e){if(e.name!=l&&e.name.toLocaleLowerCase()==a.toLowerCase())return e})),o},_filterElementClick:function(i,a){var r,o,s,n,d,h;if("labelFilterBtn"==i.ID||"valueFilterBtn"==i.ID)return!1;if(r=this.element.find(".groupLabelDrop").length>0?this.element.find(".groupLabelDrop").data("ejDropDownList"):a.element.find(".groupLabelDrop").data("ejDropDownList"),this._selectedLevelUniqueName=r.getSelectedValue(),"clearAllFilters"==i.ID||"valueClearFilter"==i.ID&&"pivot"==this.model.analysisMode&&"servermode"==this.model.operationalMode){if(this._clearAllFilters(i),"valueClearFilter"==i.ID&&"pivot"==this.model.analysisMode&&"servermode"==this.model.operationalMode)return!1}else"clearSorting"==i.ID?this._clearSorting(i):("ascOrder"==i.ID||"descOrder"==i.ID)&&this._sortField(i);if(this.element.find(".e-dialog, .e-filterDialog, #preventDiv").remove(),null!=this._schemaData&&this._schemaData.element.find(".e-dialog").remove(),!e(i.element).parent().hasClass("e-filterElementTag")&&"ascOrder"!=i.ID&&"descOrder"!=i.ID&&"clearSorting"!=i.ID&&"clearAllFilters"!=i.ID)if(o=this._selectedField,this._filterAction=t.isNullOrUndefined(i.element)?t.isNullOrUndefined(i.parentId)&&(t.isNullOrUndefined(i.menuId)||""==i.menuId)?"valueFilterBtn"==e(i.selectedItem).attr("id")?"valueFiltering":"labelFilterBtn"==e(i.selectedItem).attr("id")?"labelFiltering":"":"valueFilterBtn"==i.parentId?"valueFiltering":"labelFilterBtn"==i.menuId?"labelFiltering":"":0==e(i.element).parents("#valueFilterBtn").length?"labelFiltering":"valueFiltering",e.trim(i.text)==e.trim(this._getLocalizedLabels("ClearFilter"))){if(this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode){t.Pivot.closePreventPanel(this);var c,p=this._selectedLevelUniqueName.toLowerCase(),u=[];return 0==(c=e.map(this.model.dataSource.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})).length&&(c=e.map(this.model.dataSource.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})),t.PivotAnalysis._valueFilterArray=e.grep(t.PivotAnalysis._valueFilterArray,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()!=o.toLowerCase())return e}),c.length>0&&(c[0].advancedFilter&&(u=e.map(c[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLowerCase()!=p)return e})),c[0].advancedFilter=u,this._schemaData&&(0==c[0].advancedFilter.length&&this._schemaData._tableTreeObj.element.find("li[data-tag ='"+o+"'] div:eq(0) .filter").remove(),this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedLevelUniqueName+"'] div:eq(0) .filter").remove())),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.refreshControl():this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this),!1}this._removeFilterTag(this._selectedLevelUniqueName);try{s=JSON.parse(this.getOlapReport()).Report}catch(e){s=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)g=JSON.stringify(this.model.customObject),f=JSON.stringify({action:this._filterAction.toLowerCase(),filterParams:this._selectedLevelUniqueName+"--Clear Filter",currentReport:s,customObject:g,gridLayout:this.model.layout}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,f,this._filterElementSuccess);else{n=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[n])return e});var m=this._curFilteredAxis+"::"+this._curFilteredText+"## Clear Filter",g=JSON.stringify(this.model.customObject),f=JSON.stringify({action:this._filterAction.toLowerCase(),filterParams:m,sortedHeaders:this._ascdes,currentReport:s,customObject:g,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,f,this._filterElementSuccess)}}else this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(h=[],d=this._selectedLevelUniqueName,this._excelFilterInfo.length>0&&"true"!=e(i.element).siblings("li:eq(0)").attr("disable")&&((h=e.map(this._excelFilterInfo,function(e){if(e.levelUniqueName==d&&!t.isNullOrUndefined(e.operator))return{value1:e.value1,value2:e.value2,operator:e.operator,measure:e.measure}})).length>0&&i.ID.replace("_valueFilter","").replace("_labelFilter","")!=h[0].operator.replace(/ /g,"")&&(h=[])),t.Pivot.createAdvanceFilterTag({action:"labelFiltering"==this._filterAction?"labelFilterDlg":"valueFilterDlg",selectedArgs:i,filterInfo:h},this)):(0==(c=e.map(this.model.dataSource.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})).length&&(c=e.map(this.model.dataSource.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()==o.toLowerCase())return e})),h=[],c[0].advancedFilter&&(h=e.map(c[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLowerCase()!=p)return e})),t.Pivot.createAdvanceFilterTag({action:"labelFiltering"==this._filterAction?"labelFilterDlg":"valueFilterDlg",selectedArgs:i,filterInfo:h},this))},_filterOptionChanged:function(i){var l,a=this._getAdvancedFiltervalue(this._selectedField,this._selectedLevelUniqueName);a=a.length>0?"label"==a[0].advancedFilterType&&i.value.replace(/ /g,"")==a[0].labelFilterOperator?a[0].values:"value"==a[0].advancedFilterType&&i.value.replace(/ /g,"")==a[0].valueFilterOperator?a[0].values:[""]:[""],l=this.element.find(".filterValuesTd")[0],i.value.toLowerCase().indexOf("between")>=0&&e(l).html("<input type='text' id='filterValue1' class='e-filterValues' value='"+a[0]+"' style='display:inline'/> <span>"+this._getLocalizedLabels("and")+"</span> <input type='text' id='filterValue2' value='"+(t.isNullOrUndefined(a[1])?"":a[1])+"' class='e-filterValues' style='display:inline' /> </br>"),i.value.toLowerCase().indexOf("between")<0&&e(l).html("<input type='text' id='filterValue1' class='e-filterValues' value='"+a[0]+"' style='display:inline'/>")},_filterElementOkBtnClick:function(){var i,a,r,o,s,n;t.Pivot.closePreventPanel(this);var d=this.element.find(".filterOptions")[0].value,h=[this.element.find("#filterValue1")[0].value],c=[],p=this._selectedField;if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){h[0].value;var u,m,g=this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:"",f=this._filterAction.toLowerCase();if(m=this._selectedLevelUniqueName+"--"+d+"--"+h[0],this.element.find(".filterMeasures").length>0&&(this.element.find("#filterValue2").length>0&&(m=m+","+g),m=m+"--"+(u=this.element.find(".filterMeasures").data("ejDropDownList").model.value),f="valuefiltering",null==u))return;try{i=JSON.parse(this.getOlapReport()).Report}catch(e){i=this.getOlapReport()}if(_=JSON.stringify(this.model.customObject),v=JSON.stringify({action:f,filterParams:m,currentReport:i,customObject:_,gridLayout:this.model.layout}),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(e(this._schemaData.element).width()).height(e(this._schemaData.element).height()).css({top:e(this._schemaData.element).offset().top,left:e(this._schemaData.element).offset().left}),""!=(a=this._curFilteredText.indexOf(":")>-1?this._curFilteredText.split(":")[1]:"")&&this._tempFilterData&&(this._tempFilterData=e.grep(this._tempFilterData,function(e){if(t.isNullOrUndefined(e[a]))return e})),r=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({action:f,hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,operator:d,measure:u,value1:h[0],value2:g,sortOrder:r}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap)this.model.enableDeferUpdate||this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,v,this._filterElementSuccess);else if("labelFiltering"==this._filterAction){o=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[o])return e});var b=this._curFilteredAxis+"::"+this._curFilteredText+"##"+d+"::"+h[0],_=JSON.stringify(this.model.customObject),v=JSON.stringify({action:f,filterParams:b,sortedHeaders:this._ascdes,currentReport:i,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:_,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,v,this._filterElementSuccess)}else{o=this._curFilteredText,this._tempFilterData=e.map(this._tempFilterData,function(e){if(!e[o])return e}),this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList"),u=this._measureDDL.getSelectedValue();b=this._curFilteredText+"::"+d+"::"+u+"::"+h[0]+"::"+(this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:""),_=JSON.stringify(this.model.customObject),v=JSON.stringify({action:f,filterParams:b,sortedHeaders:this._ascdes,currentReport:i,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:_,gridLayout:this.model.layout});this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filtering,v,this._filterElementSuccess)}return!1}if("valueFiltering"==this._filterAction){if(this._measureDDL=this.element.find(".filterMeasures").data("ejDropDownList"),u=this._measureDDL.getSelectedValue(),isNaN(parseFloat(h[0]))||!isFinite(h[0])||""==u)return;this.element.find("#filterValue2")[0]!=l&&h.push(this.element.find("#filterValue2")[0].value)}if(this.element.find(".e-dialog").remove(),this._schemaData){var C=t.buildTag("span.filter").addClass("e-icon")[0].outerHTML,S=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this._selectedLevelUniqueName+"'] div:eq(0)"),O=this._schemaData._tableTreeObj.element.find("li[data-tag ='"+p+"'] div:eq(0)");0==S.find(".filter").length&&S.append(C),0===O.find(".filter").length&&O.append(C)}s=this._selectedLevelUniqueName.toLowerCase(),0==(n=e.map(this.model.dataSource.columns,function(e){if(e.fieldName!=l&&e.fieldName.toLocaleLowerCase()==p.toLowerCase())return e})).length&&(n=e.map(this.model.dataSource.rows,function(e){if(e.fieldName!=l&&e.fieldName.toLocaleLowerCase()==p.toLowerCase())return e})),n.length>0&&(delete n[0].filterItems,n[0].advancedFilter&&(c=e.map(n[0].advancedFilter,function(e){if(e.name!=l&&e.name.toLocaleLowerCase()!=s)return e})),"labelfiltering"==this._filterAction.toLowerCase()?c.push({name:this._selectedLevelUniqueName,labelFilterOperator:d.replace(/ /g,""),advancedFilterType:t.Pivot.AdvancedFilterType.LabelFilter,values:h}):c.push({name:this._selectedLevelUniqueName,valueFilterOperator:d.replace(/ /g,""),advancedFilterType:t.Pivot.AdvancedFilterType.ValueFilter,values:h,measure:u}),this._currentReportItems=e.grep(this._currentReportItems,function(e){if(e["data-fieldName"]!=p)return e}),n[0].advancedFilter=c,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"filtering"},this))),this._waitingPopup.show(),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.PivotAnalysis._valueSorting=null,t.PivotAnalysis._valueFilterArray=e.grep(t.PivotAnalysis._valueFilterArray,function(e){if(e.fieldName!=l&&e.fieldName.toLowerCase()!=p.toLowerCase())return e}),"valueFiltering"==this._filterAction&&t.PivotAnalysis._valueFilterArray.push(n[0]),this.refreshControl()):this.getJSONData({action:"advancedfiltering"},this.model.dataSource,this)},_nodeCheckChanges:function(i){var a,r,o,s,n;if(this._onDemandNodeExpand){this._isMembersFiltered=!0;var d=this,h=this.element.find(".e-editorTreeView"),c=null,p=!t.isNullOrUndefined(i.model.id)&&"allelement"==i.model.id.toLowerCase()&&!i.isChecked||!t.isNullOrUndefined(i.id)&&("(all)_0"==i.id.toLowerCase()||"all"==i.id.toLowerCase())&&!t.isNullOrUndefined(i.type)&&"nodeUncheck"==i.type,u=!t.isNullOrUndefined(i.model.id)&&"allelement"==i.model.id.toLowerCase()&&i.isChecked||!t.isNullOrUndefined(i.id)&&("(all)_0"==i.id.toLowerCase()||"all"==i.id.toLowerCase())&&!t.isNullOrUndefined(i.type)&&"nodeCheck"==i.type;if(p){if(this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this._isOptionSearch?(c=e(h).find("li[data-isItemSearch='true']")).length>0&&e(c).each(function(t,i){e(h).ejTreeView("uncheckNode",e(i))}):this.model.enableMemberEditorPaging&&e(h).find("li span.e-searchfilterselection").length>0?(e(h).ejTreeView("unCheckAll"),this._isSelectSearchFilter?e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):e(h).ejTreeView("unCheckAll"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),e(h).find("li").length>0&&!e(h).find("li").find("span.e-checkmark").length>0?this._dialogOKBtnObj.disable():e(h).find("li").length>0&&1==e(h).find("li").find("span.e-checkmark").length&&e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0&&this._dialogOKBtnObj.disable(),this.model.enableMemberEditorPaging||this._editorTreeData.length>0){if(this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),this._isAllMemberChecked=!1,this._editorSearchTreeData.length>0)for(n=0;n<this._editorSearchTreeData.length;n++)e(this._editorTreeData).each(function(e,t){if(d._editorSearchTreeData[n].id==t.id)return d._editorSearchTreeData[n].checkedStatus=!1,t.checkedStatus=!1,!1});else e(this._editorTreeData).each(function(e,t){t.checkedStatus=!1});e(this._editorTreeData).each(function(e,t){if(t.checkedStatus)return d._dialogOKBtnObj.enable(),d.element.find(".e-dialogOKBtn").removeAttr("disabled"),!1})}}else if(u){if(this._memberTreeObj.model.nodeCheck="",this._memberTreeObj.model.nodeUncheck="",this._isOptionSearch?(c=e(h).find("li[data-isItemSearch='true']")).length>0&&e(c).each(function(t,i){e(h).ejTreeView("checkNode",e(i))}):this.model.enableMemberEditorPaging&&e(h).find("li span.e-searchfilterselection").length>0?(e(h).ejTreeView("checkAll"),this._isSelectSearchFilter?e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):e(h).ejTreeView("checkAll"),e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop"),this._memberTreeObj.model.nodeCheck=t.proxy(this._nodeCheckChanges,this),this._memberTreeObj.model.nodeUncheck=t.proxy(this._nodeCheckChanges,this),e(h).find("li").length>0&&e(h).find("li").find("span.e-checkmark").length>0&&this._dialogOKBtnObj.enable(),this.model.enableMemberEditorPaging||this._editorTreeData.length>0)if(this.element.find(".e-dialogOKBtn").removeAttr("disabled"),this._isAllMemberChecked=!0,this._editorSearchTreeData.length>0)for(n=0;n<this._editorSearchTreeData.length;n++)e(this._editorTreeData).each(function(e,t){if(d._editorSearchTreeData[n].id==t.id)return d._editorSearchTreeData[n].checkedStatus=!0,t.checkedStatus=!0,!1});else e(this._editorTreeData).each(function(e,t){t.checkedStatus=!0})}else if("searchfilterselection"==i.id.toLowerCase())t.Pivot._updateSearchFilterSelection(i,h,d);else if((t.isNullOrUndefined(i.model.id)||"allelement"!=i.model.id.toLowerCase())&&(t.isNullOrUndefined(i.id)||"(all)_0"!=i.id.toLowerCase()&&"all"==i.id.toLowerCase())||!this.model.enableMemberEditorPaging&&!this._editorTreeData){if(!t.isNullOrUndefined(i.model.id)&&"allelement"==i.model.id.toLowerCase()||!t.isNullOrUndefined(i.id)&&("(all)_0"==i.id.toLowerCase()||"all"!=i.id.toLowerCase()))if(r=this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:not(:checked)"),o=e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),"KPI"==this._dialogHead){for(u=!0,s=this.element.find(".e-editorTreeView ul:eq(0)"),n=0;n<s.children("li").length;n++)if("false"==s.children("li:eq("+n+")").find(".e-check-small").attr("aria-checked")){u=!1;break}u?this._dialogOKBtnObj.enable():(o.removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable())}else 0==r.length||1==r.length&&0==r[0].id[r[0].id.length-1]?(e(o).parent().removeClass("e-chk-inact").removeClass("e-chk-ind").addClass("e-chk-act"),o.removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark")):"nodeCheck"==i.type&&1==r.length&&0==r[0].id[r[0].id.length-1]?(o.removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark")):r.length>0&&(o.removeClass("e-checkmark").addClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop")),this._dialogOKBtnObj.enable(),"nodeUncheck"==i.type&&(r.length+1==this._memberTreeObj.element.find("li").length?(o.removeClass("e-checkmark").removeClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable()):this._isOptionSearch&&e(h).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0&&1==this._memberTreeObj.element.find(":input:gt(0).nodecheckbox:checked").length&&(o.removeClass("e-checkmark").removeClass("e-stop"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop"),this._dialogOKBtnObj.disable()))}else"nodeUncheck"==i.type?(this._isMembersFiltered=!0,a="",t.Pivot._memberPageNodeUncheck(i,this),a=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l).where("checkedStatus","equal",!0)),!t.isNullOrUndefined(a)&&a.length>0&&("All"==a[0].id||"(All)_0"==a[0].id)&&a.splice(0,1),o=e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image"),t.isNullOrUndefined(a)||0!=a.length?(e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),e(this._editorTreeData).each(function(t,i){if(i.checkedStatus)return this._isAllMemberChecked=!1,e(d._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop"),!1})):(this._dialogOKBtnObj.disable(),this.element.find(".e-dialogOKBtn").attr("disabled","disabled"),this._isAllMemberChecked=!1,o.removeClass("e-stop").removeClass("e-checkmark").addClass("e-chk-inact"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-checkmark").addClass("e-chk-inact"))):"nodeCheck"==i.type&&(this._isMembersFiltered=!0,t.Pivot._memberPageNodeCheck(i,this),this.element.find(".e-dialogOKBtn").data("ejButton").enable(),this.element.find(".e-dialogOKBtn").removeAttr("disabled"),this._isAllMemberChecked=!0,e(this._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),this.element.find(".e-checkAllBox").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"),e(this._editorTreeData).each(function(t,i){if(!i.checkedStatus)return this._isAllMemberChecked=!1,e(d._memberTreeObj.element.find("li:first")).find("span.e-chk-image").removeClass("e-checkmark").addClass("e-stop"),!1}))}},_fetchMemberSuccess:function(i){i[0]!=l&&i.length>0?(this._currentMembers=i[0].Value,null!=i[1]&&i[1]!=l&&(this.model.customObject=i[1].Value)):i.d!=l&&i.d.length>0?(this._currentMembers=i.d[0].Value,null!=i.d[1]&&i.d[1]!=l&&(this.model.customObject=i.d[1].Value)):i!=l&&i.length>0?(this._currentMembers=i.EditorTreeInfo,null!=i&&i!=l&&(this.model.customObject=i.customObject)):i!=l&&(this._currentMembers=i.EditorTreeInfo),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&!this.model.enableMemberEditorPaging&&(0==this._editorTreeData.length||this._isFilterBtnClick)&&(this._editorTreeData=JSON.parse(this._currentMembers),this.model.enableAdvancedFilter&&(this._editorTreeData=e.map(this._editorTreeData,function(e){if(t.isNullOrUndefined(e.levels))return e}))),this._savedReportItems=e.extend(!0,[],this._currentReportItems),this._isFilterBtnClick=!1,this._createDialog(this._dialogHead,this._currentMembers),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject}),this.model.dataSource.enableAdvancedFilter?this.element.find(".e-dialog #GroupLabelDrop_wrapper:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"):t.isNullOrUndefined(this.element.find(".e-dialog .e-text:visible").first())||this.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"),this._waitingPopup.hide()},_filterElementSuccess:function(e){e[0]!=l?null!=e[2]&&e[2]!=l&&(this.model.customObject=e[2].Value):e.d!=l?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):null!=e.customObject&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),this._renderControlSuccess(e)},_sortingSuccess:function(e){e[0]!=l?e[2]!=l&&e.length>0&&(this.model.customObject=e[2].Value):e.d!=l&&e.d.length>0?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):e!=l&&e.length>0&&null!=e.customObject&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"sorting",element:this.element,customObject:this.model.customObject}),this._renderControlSuccess(e)},_nodeExpand:function(i){var a,r,o,s,n,d,h,c,p,u,m=t.isNullOrUndefined(i.event)?i.targetElement:i.event.originalEvent!=l&&i.event.originalEvent.target!=l?i.event.originalEvent.target:i.event.target,g="";if(this._isSchemaClick=!!i._isSchemaClick,m!=l&&m.className!=l&&""!=m.className&&m.className.indexOf("e-minus")>-1)return i.olapCtrlObj=i._isSchemaClick?this._schemaData:this,void t.Pivot._onNodeCollapse(i);if(jQuery.each(this._isSchemaClick?this._schemaData._editorTreeData:this._editorTreeData,function(e,t){if(t.id==i.id)return t.expanded=!0,t.isChildMerged=!0,!1}),a=e(m).parents("li").first().children().find("li").length,r=i._isSchemaClick?this._schemaData._memberTreeObj.dataSource():this._memberTreeObj.dataSource(),this.model.enableMemberEditorPaging)for(o=0;o<r.length;o++)if(r[o].parentId==i.id||r[o].pid==i.id)return i.isChildLoaded=!0,void t.Pivot.closePreventPanel(this);if(!t.isNullOrUndefined(this)&&this.model.enableMemberEditorPaging&&t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i.id)).length>0&&m!=l&&m.className!=l&&""!=m.className&&m.className.indexOf("e-plus")>-1&&0==a)return i.isChildLoaded=!0,t.Pivot.closePreventPanel(this),this.pNode=m,void this._fetchChildNodeSuccess({ChildNodes:JSON.stringify(t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i.id))),customObject:this.model.customObject});if(m!=l&&m.className!=l&&""!=m.className&&m.className.indexOf("e-plus")>-1&&0==a){e(m).removeClass("e-plus").addClass("e-load"),s=e(m).parent().find("input.e-checkbox").prop("checked"),d=e(m).parents("li").first().attr("data-tag"),this.pNode=m;try{n=JSON.parse(this.model.pivotControl!=l?this.model.pivotControl.getOlapReport():this.getOlapReport()).Report}catch(e){n=this.model.pivotControl!=l?this.model.pivotControl.getOlapReport():this.getOlapReport()}for(h=this.element.find(".e-pivotButton"),p=0;p<h.length>0;p++)e(h[p]).attr("data-tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&e(h[p]).attr("data-tag").split(":")[1].length==(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?0:this._schemaData._curFilteredText.length:this._curFilteredText.length)?g=e(h[p]).attr("data-tag"):e(h[p]).attr("data-tag").indexOf(t.isNullOrUndefined(this._curFilteredText)?t.isNullOrUndefined(this._schemaData)?"":this._schemaData._curFilteredText:this._curFilteredText)>-1&&(c=e(h[p]).attr("data-tag"));g=""==g?t.isNullOrUndefined(c)?t.isNullOrUndefined(this._curFilteredText)?this._schemaData._curFilteredText:this._curFilteredText:c.split(":")[1]:g.split(":")[1],null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject}),u=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.memberExpand,JSON.stringify({action:"memberExpanded",checkedStatus:s,parentNode:e(m).parents("li")[0].id,tag:d,cubeName:JSON.parse(this._olapReport).CurrentCube+"##"+g,currentReport:n,customObject:u}),this._fetchChildNodeSuccess)}},_fetchChildNodeSuccess:function(i){var a,r,o,s,n,d;i.length>1&&i[0]!=l?(a=JSON.parse(i[0].Value),null!=i[1]&&i[1]!=l&&(this.model.customObject=i[1].Value)):i.d!=l?(a=JSON.parse(i.d[0].Value),null!=i.d[1]&&i.d[1]!=l&&(this.model.customObject=i.d[1].Value)):(a=JSON.parse(i.ChildNodes),null!=i.customObject&&i.customObject!=l&&(this.model.customObject=i.customObject)),r=e(this.pNode).parents("li").length>1?e(this.pNode).parents("li").first():e(this.pNode).parents("li"),e(e(r).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1}),o=this._isSchemaClick?this._schemaData:this,this.model.enableMemberEditorPaging?(s=t.Pivot._generateChildWithAncestors(o,r,this.model.enableMemberEditorPaging,this.model.memberEditorPageSize),a.length>=this.model.memberEditorPageSize||s.lstChildren.length>=this.model.memberEditorPageSize?(o.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),o._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(o,r[0].id),o._isEditorDrillPaging=!0,n=s.allLvlLst.length>1&&s.lstChildren.length>=this.model.memberEditorPageSize?t.Pivot._getParentsTreeList(o,s.lstParents[0].id,o._editorTreeData):e.grep(o._editorTreeData,function(e){return e.id==r[0].id})[0],d={childNodes:s.allLvlLst.length>1&&s.lstChildren.length>=this.model.memberEditorPageSize?s.lstChildren:a,parentNode:n},t.Pivot._drillEditorTreeNode(d,o,this.model.memberEditorPageSize)):t.isNullOrUndefined(this._memberTreeObj)||!this._editorFlag||this._isSchemaClick?t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this._schemaData,this),r):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this,this),r)):(t.isNullOrUndefined(this._memberTreeObj)||!this._editorFlag||this._isSchemaClick?t.isNullOrUndefined(this._schemaData._memberTreeObj)||this._schemaData._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this._schemaData,this),r):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this,this),r),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&e.merge(o._editorTreeData,e.extend(!0,[],a))),a.length>0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.enableMemberEditorPaging&&!t.DataManager(o._editorTreeData).executeLocal(t.Query().where("pid","equal",a[0].pid)).length>0&&e.merge(o._editorTreeData,e.extend(!0,[],a)),e.each(e(r).children().find("li"),function(e,t){t.setAttribute("data-tag",a[e].tag)}),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject}),t.isNullOrUndefined(this._schemaData)||this.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style")},_beforeNodeExpand:function(e){t.Pivot.getChildNodes(e,this._selectedField,this._currentReportItems,this.model.dataSource,this)},_generateAllMember:function(t,i){this.olapCtrlObj._allMember=e(e(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},_generateMembers:function(i,a){var r,o,s,n,d=e(a).find("Axis:eq(0) Tuple"),h=[],c={};for(h.push({id:"All",name:"All",checkedStatus:!0,tag:""}),r=0;r<d.length;r++)o=e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[0]).text(),s=e(e(a).find("Axis:eq(0) Tuple:eq("+r+")").children().children()[1]).text(),c={hasChildren:"0"!=e(d[r]).find("CHILDREN_CARDINALITY").text(),checkedStatus:!0,id:o.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_"),name:s,tag:o,level:parseInt(e(d[r]).find("LNum").text())},h.push(c);t.isNullOrUndefined(this.olapCtrlObj)||(this.olapCtrlObj._waitingPopup.hide(),this.olapCtrlObj._editorTreeData=h,this.olapCtrlObj._currentReportItems.push({filterItems:h,fieldName:this.olapCtrlObj._selectedField,dataSrc:this.olapCtrlObj.model.dataSource,pageSettings:this.olapCtrlObj._memberCount}),this.olapCtrlObj.model.enableMemberEditorPaging?(this.olapCtrlObj._memberCount=t.DataManager(this.olapCtrlObj._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All"))).length,n=t.DataManager(this.olapCtrlObj._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(this.olapCtrlObj._memberPageSettings.currentMemeberPage,this.olapCtrlObj.model.memberEditorPageSize+1)),this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(n)})):this.olapCtrlObj._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(h)}))},_filterBtnClick:function(i){var a,r,o,s;if(this._editorFlag=!0,t.Pivot.openPreventPanel(this),this._isAllMemberChecked=!0,this.model.operationalMode==t.Pivot.OperationalMode.ClientMode)if(this.model.enableMemberEditorPaging&&(this._memberPageSettings.endPage=this.model.memberEditorPageSize,this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var n,d=this._selectedField=e(i.currentTarget.parentNode).attr("data-tag").split(":")[1],h=[];this._dialogHead=e(i.target).siblings(".e-pvtBtn").attr("data-fieldCaption"),h=e.map(this._currentReportItems,function(i){if(i.fieldName==d&&(n=i.pageSettings,!t.isNullOrUndefined(i.filterItems)))return e.map(i.filterItems,function(e){return e.expanded&&(e.expanded=!1),e})}),this.model.enableMemberEditorPaging&&n&&n&&(this._memberCount=n),h.length>0?(this._editorTreeData=h,this.model.enableMemberEditorPaging&&(this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where(t.Predicate("pid","equal",null).and("id","notequal","All"))).length,h=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l).page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize+1))),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(h)})):(this._waitingPopup.show(),t.olap._mdxParser.getMembers(this.model.dataSource,d,this))}else this._selectedField=e(i.target).siblings(".e-pvtBtn").attr("data-fieldName"),this._dialogHead=e(i.target).siblings(".e-pvtBtn").attr("data-fieldCaption"),this._selectedAxis=e(i.target).siblings(".e-pvtBtn").attr("data-axis"),a=this._getTreeViewData(this._selectedField,this._selectedAxis),this.model.enableMemberEditorPaging?(h=a,this._editorTreeData=h,this._memberCount=t.DataManager(this._editorTreeData).executeLocal(t.Query().where("id","notequal","All")).length,h=t.DataManager(this._editorTreeData).executeLocal(t.Query().page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize+1)),this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(h)})):this._fetchMemberSuccess({EditorTreeInfo:JSON.stringify(a)});else{this._isFilterBtnClick=!0,this._curFilteredAxis=i.target.parentElement.getAttribute("data-tag").split(":")[0],this._curFilteredText=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.getAttribute("data-tag"):e(e(i.target).siblings()[1]).attr("data-fieldName"),this._dialogTitle=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?i.target.parentElement.getAttribute("data-tag"):e(e(i.target).siblings()[1]).attr("data-fieldName"),this._dialogHead=e(e(i.target).siblings("button")).attr("data-fieldCaption");try{r=JSON.parse(this.getOlapReport()).Report}catch(e){r=this.getOlapReport()}this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").addClass("freeze").width(e(this._schemaData.element).width()).height(e(this._schemaData.element).height()).css({top:e(this._schemaData.element).offset().top,left:e(this._schemaData.element).offset().left}),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"fetchMembers",element:this.element,customObject:this.model.customObject}),o=JSON.stringify(this.model.customObject),s=JSON.stringify({action:"fetchMembers",headerTag:this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.enableAdvancedFilter?this._dialogTitle+"##"+this.model.enableAdvancedFilter:this._dialogTitle,sortedHeaders:this._ascdes,currentReport:r,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:o}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMembers,s,this.model.enableMemberEditorPaging?t.Pivot._fetchMemberPageSuccess:this._fetchMemberSuccess)}},_getTreeViewData:function(i){var a,r=t.Pivot.getReportItemByFieldName(i,this.model.dataSource).item,o=t.PivotAnalysis.getMembers(i),s=[{id:"All",name:"All",checkedStatus:!0}];if(null!=r.filterItems&&r.filterItems!=l)for(a=0;a<o.length;a++)s.push({id:o[a],name:o[a],checkedStatus:r.filterItems.filterType==t.PivotAnalysis.FilterType.Include?e.inArray(o[a],r.filterItems.values)>=0:e.inArray(o[a],r.filterItems.values)<0});else for(a=0;a<o.length;a++)s.push({id:o[a],name:o[a],checkedStatus:!0});return s},_applyToolTip:function(i){var a,r,o,s,n,d,h,c,p;if(this.model.enableToolTip){var u,m,g,f="",b=e(i.target).hasClass("cellValue")?i.target.parentElement:i.target;if(0==e(b).find("input").length&&!e(b).hasClass("curInput")&&!t.isNullOrUndefined(e(b).attr("role"))){if(null==(g=this.element.find(".summary[role!='gridcell'][data-p$=',"+e(b).attr("data-p").split(",")[1]+"'] , .rowheader[role!='gridcell'][data-p$=',"+e(b).attr("data-p").split(",")[1]+"']").last().attr("data-p"))&&(g=e(b).parent("tr").find(".summary,.rowheader").attr("data-p")),null!=g)if(0==g[0]&&null!=parseInt(g.split(",")[0]))g==this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Index&&(m=this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Value);else for(;g[0]>=0;)g==this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Index&&(u=this.getJSONRecords()[parseInt(parseInt(g.split(",")[0])*this._rowCount+parseInt(g.split(",")[1]))].Value,g=parseInt(g.split(",")[0])-1+","+parseInt(g.split(",")[1])),m=m?""!=u?u+"-"+m:m:u;var _=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,v=this.element.find(_?".pivotGridFrozenTable ":'tr:has("[role=columnheader]")').length-1,C=e(b).attr("data-p");for(C!=l&&C==this.getJSONRecords()[parseInt(parseInt(C.split(",")[0])*this._rowCount+parseInt(C.split(",")[1]))].Index&&(a=parseInt(C.split(",")[0])),r=0;r<=v;r++)o=a+","+r,null!=a&&o==this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Index&&(-1==(u=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))]).CSS.indexOf("value")&&(""==f?f=u.Value:""!=u.Value&&(f=f+"-"+u.Value)));e("#"+this._id+"_gridTooltip").remove(),this.element.find("span#celval").remove(),s=t.isNullOrUndefined(this._pivotClientObj)?b.getBoundingClientRect():e(b).position(),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(n=this.element.find(".e-scroller").data("ejScroller"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(s.left=s.left+this.element.find(".rowhead").width()-n.model.scrollLeft,s.top=s.top-n.model.scrollTop)),e("#"+this._id).append('<div id="'+this._id+'_gridTooltip" class="e-pGridTooltip" role=\'tooltip\'></div>'),e(b).find("span.cellValue").attr("aria-label","row- "+m+": column- "+f),d=e(b).find("span.cellValue:not('#celval')").text(),this.model.enableRTL?(e("#"+this._id+"_gridTooltip").append('<p id="value" class="e-tooltipText">'+(d||this._getLocalizedLabels("NoValue"))+":"+this._getLocalizedLabels("ToolTipValue")+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="row" class="e-tooltipText">'+(m==l||1==this._rowCount?this._getLocalizedLabels("NoValue"):this._direction(m))+":"+this._getLocalizedLabels("ToolTipRow")+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="column" class="e-tooltipText">'+(f==l||""==f?this._getLocalizedLabels("NoValue"):this._direction(f))+":"+this._getLocalizedLabels("ToolTipColumn")+"</p>")):(e("#"+this._id+"_gridTooltip").append('<p id="value" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipValue")+": "+(d||this._getLocalizedLabels("NoValue"))+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="row" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipRow")+": "+(m==l||1==this._rowCount?this._getLocalizedLabels("NoValue"):m)+"</p>"),e("#"+this._id+"_gridTooltip").append('<p id="column" class="e-tooltipText">'+this._getLocalizedLabels("ToolTipColumn")+": "+(f==l||""==f?this._getLocalizedLabels("NoValue"):f)+"</p>")),h=0,h=t.isNullOrUndefined(this._pivotClientObj)?e("#"+this._id).parent().position().left+e("#"+this._id).parent().width():e("#"+this._id).parent().position().left+this._pivotClientObj.element.find(".e-gridContainer").width();var S=s.left+e("#"+this._id+"_gridTooltip").width(),O=0,T=0;t.isNullOrUndefined(this._pivotClientObj)?(O=(s.left>0?s.left:0)+(h-S<0?h-S-20:5),T=e(this.element).height()-s.top<100?s.top-e("#"+this._id+"_gridTooltip").outerHeight()-2:s.top+40,(p=(c=e(i.target).hasClass("cellValue")?i.target.parentElement:i.target).getBoundingClientRect().width/c.offsetWidth)>1&&(T=e(c).position().top/p,T=e(this.element).height()-T*p<100*p?T-e("#"+this._id+"_gridTooltip").outerHeight():T+40)):(O=(s.left>0?s.left:0)+(h-S<50?h-S-40:5)+this._pivotClientObj.element.find(".e-gridContainer").scrollLeft(),T=(this._pivotClientObj.element.find(".e-gridContainer").height()-s.top<150?s.top-e("#"+this._id+"_gridTooltip").outerHeight()-2:s.top+40)+this._pivotClientObj.element.find(".e-gridContainer").scrollTop()),!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableRTL&&(O=e("#"+this._pivotClientObj._id+"_PivotGrid").parent().hasClass("e-maximumView")?s.left:O-(e("#"+this._pivotClientObj._id+"_PivotGrid").position().left+this._pivotClientObj.element.find(".e-gridContainer").scrollLeft())),e("#"+this._id+"_gridTooltip").css({left:O,top:T}),this.model.enableToolTipAnimation?e("#"+this._id+"_gridTooltip").show("fast"):e("#"+this._id+"_gridTooltip").show(),t.isNullOrUndefined(this._pivotClientObj)||"tile"!=this._pivotClientObj.controlPlacement()||e("#"+this._id+"_gridTooltip").css("position","absolute")}}},_applyVScrolling:function(){var i,l,a,r,o,s,n,d,h,c,p=!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling,u=p?this._pivotClientObj.element.find(".e-pivotgrid"):e(this.element).find(".virtualScrollGrid"),m=p?this._pivotClientObj:this,g=p&&!t.isNullOrUndefined(this._pivotClientObj._pivotGrid)?this._pivotClientObj._pivotGrid:this,f=p&&this.model.isResponsive;g._seriesPageCount>1&&(l=function(){return Math.round(m.element.find(".e-vScrollPanel").offset().top)+1},(a=e(m.element).find(".e-vScrollPanel")).height(p?this._pivotClientObj.model.isResponsive?parseInt(this._pivotClientObj.element.find(".e-controlPanel").height()):"tile"==this._pivotClientObj.controlPlacement()?parseInt(this._pivotClientObj.element.find(".e-gridContainer").parents("table:eq(0)").height()):parseInt(this._pivotClientObj.element.find(".e-gridContainer").height()):e(u).height()),a.html(t.buildTag("div.e-vScrollThumb")[0].outerHTML),(r=a.find(".e-vScrollThumb")).height(Math.max(Math.ceil((p?this._pivotClientObj.model.isResponsive?parseInt(this._pivotClientObj.element.find(".e-controlPanel").height()):parseInt(this._pivotClientObj.element.find(".e-gridContainer").height()):e(u).height())/g._seriesPageCount),15)),o=a.height()-r.height()-2,r.offset({top:l()+(g._seriesCurrentPage-1)*(o/(g._seriesPageCount-1))}),e(".e-vScrollPanel").on("mousewheel DOMMouseScroll",function(t){var a,s;e("body").on("mousewheel DOMMouseScroll",function(e){return e.preventDefault(),e.stopPropagation(),!1}),initThumbPos=(f?r.offset().top:r.position().top)-l(),a=g._seriesCurrentPage,movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?t.target.offsetParent.offsetTop+10:-t.target.offsetParent.offsetTop-10,m.element.find(".e-seriesPageIndicator").removeClass("inActive").css({top:r.position().top,left:r.position().left+20}),a=g._seriesCurrentPage,window.navigator.userAgent.indexOf("MSIE ")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges(),movedDistance>0&&initThumbPos+movedDistance<=o||movedDistance<0&&initThumbPos+movedDistance>=0?s=initThumbPos+movedDistance+l():initThumbPos+movedDistance>o?s=l()+o:initThumbPos+movedDistance<0&&(s=l()),r.offset({top:s}),(a=0==Math.ceil(((f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount))?1:Math.ceil(((f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount)))>g._seriesPageCount&&(a=g._seriesPageCount),(movedDistance>0?g._seriesCurrentPage>a:g._seriesCurrentPage<a)&&(a=g._seriesCurrentPage),m.element.find(".e-seriesPageIndicator").css({top:r.position().top}),m.element.find(".series_CurrentPage").html(a),a!=g._seriesCurrentPage&&(g._seriesCurrentPage=a,clearTimeout(i),i=setTimeout(function(){p?g._pivotClientObj.refreshPagedPivotClient("series",g._seriesCurrentPage):g.refreshPagedPivotGrid("series",g._seriesCurrentPage)},250))}),e(r).on("mousedown touchstart",function(t){var i,a,s,n;e(this).addClass("dragging"),i=t.pageY-l(),a=(f?r.offset().top:r.position().top)-l(),m.element.find(".e-seriesPageIndicator").removeClass("inActive").css({top:r.position().top,left:r.position().left+20}),s=t.pageY-l()-i,n=g._seriesCurrentPage,e(document).on("mousemove touchmove",function(t){window.navigator.userAgent.indexOf("Trident")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges();var d=t.pageY-l()-i;0!=d&&(d>0&&a+d<=o?r.offset({top:a+d+l()}):d<0&&a+d>=0?r.offset({top:a+d+l()}):a+d>o?r.offset({top:l()+o}):a+d<0&&r.offset({top:l()}),n=0==Math.floor((Math.round(f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount))?1:Math.floor((Math.round(f?r.offset().top:r.position().top)-l())/(o/g._seriesPageCount)),(s<d?n<g._seriesCurrentPage:n>g._seriesCurrentPage)&&(n=g._seriesCurrentPage)),m.element.find(".e-seriesPageIndicator").css({top:r.position().top}),m.element.find(".series_CurrentPage").html(n),m.element.find(".e-vScrollThumb").attr("title",m.element.find(".e-seriesPageIndicator").text())}),e(document).on("mouseup touchend",function(){e(document).off("selectstart"),e(this).off("mousemove touchmove").off("mouseup touchend"),e(r).removeClass("dragging"),n!=g._seriesCurrentPage?(g._seriesCurrentPage=n,p?g._pivotClientObj.refreshPagedPivotClient("series",g._seriesCurrentPage):g.refreshPagedPivotGrid("series",g._seriesCurrentPage)):m.element.find(".e-seriesPageIndicator").addClass("inActive")})})),g._categPageCount>1&&(s=function(){return Math.round(m.element.find(".e-hScrollPanel").offset().left)+1},this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.element.find(".childsplit").length>0&&this._pivotClientObj.element.find(".childsplit").data("ejSplitter").refresh(),(n=e(m.element).find(".e-hScrollPanel")).width(p?this._pivotClientObj.model.enableSplitter?parseInt(this._pivotClientObj.element.find(".controlPanelTD").width()):parseInt(this._pivotClientObj.element.find(".e-controlPanel").width()):e(u).width()),n.html(t.buildTag("div.e-hScrollThumb")[0].outerHTML),(d=n.find(".e-hScrollThumb")).width(Math.max(Math.ceil((p?this._pivotClientObj.model.enableSplitter?parseInt(this._pivotClientObj.element.find(".controlPanelTD").width()):parseInt(this._pivotClientObj.element.find(".e-controlPanel").width()):e(u).width())/g._categPageCount),15)),h=n.width()-d.width()-2,this.model.enableRTL?d.css({right:(g._categCurrentPage-1)*(h/(g._categPageCount-1))}):d.offset({left:s()+(g._categCurrentPage-1)*(h/(g._categPageCount-1))}),e(".e-hScrollPanel").on("mousewheel DOMMouseScroll",function(t){var l;e("body").on("mousewheel DOMMouseScroll",function(e){return e.preventDefault(),e.stopPropagation(),!1}),initThumbPos=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-s()):(f?d.offset().left:d.position().left)-s(),currentPage=g._categCurrentPage,movedDistance=t.originalEvent.wheelDelta<0||t.originalEvent.detail>0?p?t.target.offsetParent.children[1].offsetLeft+10:t.target.offsetParent.offsetLeft+10:p?-t.target.offsetParent.children[1].offsetLeft-10:-t.target.offsetParent.offsetLeft-10,movedDistance=m.model.enableRTL?-movedDistance:movedDistance,m.element.find(".e-categPageIndicator").removeClass("inActive").css({left:d.position().left,top:d.position().top+20}),window.navigator.userAgent.indexOf("MSIE ")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges(),m.model.enableRTL?movedDistance>0&&initThumbPos+movedDistance<=h||movedDistance<0&&initThumbPos+movedDistance>=0?l=initThumbPos+movedDistance:initThumbPos+movedDistance>h?l=h:initThumbPos+movedDistance<0&&(l=0):movedDistance>0&&initThumbPos+movedDistance<=h||movedDistance<0&&initThumbPos+movedDistance>=0?l=initThumbPos+movedDistance+s():initThumbPos+movedDistance>h?l=s()+h:initThumbPos+movedDistance<0&&(l=s()),m.model.enableRTL?d.css("right",l):d.offset({left:l}),currentPage=m.model.enableRTL?0==Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-s()))/(h/g._categPageCount))?1:Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-s()))/(h/g._categPageCount)):0==Math.floor((Math.round(f?d.offset().left:d.position().left)-s())/(h/g._categPageCount))?1:Math.floor((Math.round(f?d.offset().left:d.position().left)-s())/(h/g._categPageCount)),currentPage=currentPage>g._categPageCount?g._categPageCount:currentPage<1?1:currentPage,(movedDistance>0?g._categCurrentPage>currentPage:g._categCurrentPage<currentPage)&&(currentPage=g._categCurrentPage),m.element.find(".e-categPageIndicator").css({left:d.position().left}),m.element.find(".categ_CurrentPage").html(currentPage),currentPage!=g._categCurrentPage&&(g._categCurrentPage=currentPage,clearTimeout(i),i=setTimeout(function(){p?g._pivotClientObj.refreshPagedPivotClient("categ",g._categCurrentPage):g.refreshPagedPivotGrid("categ",g._categCurrentPage)},250))}),e(d).on("mousedown touchstart",function(t){var i,l,a,r;e(this).addClass("dragging"),i=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-(t.pageX-s()):t.pageX-s(),l=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-s()):(f?d.offset().left:d.position().left)-s(),m.element.find(".e-categPageIndicator").removeClass("inActive").css({left:d.position().left,top:d.position().top+20}),a=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-(t.pageX-s())-i:t.pageX-s()-i,r=g._categCurrentPage,e(document).on("mousemove touchmove",function(t){window.navigator.userAgent.indexOf("Trident")>-1?e(document).on("selectstart",function(e){e.preventDefault()}):window.getSelection().removeAllRanges();var o=m.model.enableRTL?m.element.find(".e-hScrollPanel").width()-(t.pageX-s())-i:t.pageX-s()-i;0!=o&&(o>0&&l+o<=h?m.model.enableRTL?d.css({right:l+o}):d.offset({left:l+o+s()}):o<0&&l+o>=0?m.model.enableRTL?d.css({right:l+o}):d.offset({left:l+o+s()}):l+o>h?m.model.enableRTL?d.css({right:h}):d.offset({left:s()+h}):l+o<0&&(m.model.enableRTL?d.css({right:"0px"}):d.offset({left:s()})),r=(r=m.model.enableRTL?0==Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-s()))/(h/g._categPageCount))?1:Math.floor((m.element.find(".e-hScrollPanel").width()-((f?d.offset().left:d.position().left)+16-s()))/(h/g._categPageCount)):0==Math.floor((Math.round(f?d.offset().left:d.position().left)-s())/(h/g._categPageCount))?1:Math.floor((Math.round(f?d.offset().left:d.position().left)-s())/(h/g._categPageCount)))>g._categPageCount?g._categPageCount:r<1?1:r,(a<o?r<g._categCurrentPage:r>g._categCurrentPage)&&(r=g._categCurrentPage)),m.element.find(".e-categPageIndicator").css({left:d.position().left}),m.element.find(".categ_CurrentPage").html(r),m.element.find(".e-hScrollThumb").attr("title",m.element.find(".e-categPageIndicator").text())}),e(document).on("mouseup touchend",function(){e(document).off("selectstart"),e(this).off("mousemove touchmove").off("mouseup touchend"),e(d).removeClass("dragging"),r!=g._categCurrentPage?(g._categCurrentPage=r,p?g._pivotClientObj.refreshPagedPivotClient("categ",g._categCurrentPage):g.refreshPagedPivotGrid("categ",g._categCurrentPage)):m.element.find(".e-categPageIndicator").addClass("inActive")})})),p&&(g._categPageCount<=1&&(c=this._pivotClientObj.element.find(".e-outerTable").height()-58,this._pivotClientObj.element.find(".e-gridContainer").height(c),this._pivotClientObj.element.find(".e-chartContainer").height(c)),g._seriesPageCount<=1&&(c=this._pivotClientObj.element.find("ul.clientTab").width()-2,this._pivotClientObj.element.find(".e-gridContainer").width(c),this._pivotClientObj.element.find(".e-chartContainer").width(c)),this._pivotClientObj.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._pivotClientObj.element.find(".e-hScrollThumb").length>0?this._pivotClientObj.element.find(".e-gridContainer,.e-chartContainer").height(this._pivotClientObj.element.find(".e-controlPanel").height()-(this._pivotClientObj.element.find("ul.clientTab").height()+23)):this._pivotClientObj.element.find(".e-gridContainer,.e-chartContainer").height(this._pivotClientObj.element.find(".e-controlPanel").height()-this._pivotClientObj.element.find("ul.clientTab").height()-2),this._pivotClientObj.element.find(".e-vScrollPanel").css("margin-left","7px"))),e("body").off("mousewheel DOMMouseScroll")},_getLocalizedLabels:function(e){return t.isNullOrUndefined(t.PivotGrid.Locale[this.locale()])||t.PivotGrid.Locale[this.locale()][e]==l?t.PivotGrid.Locale["en-US"][e]:t.PivotGrid.Locale[this.locale()][e]},_drillDown:function(i){var l,a,r,o,s,n,d,h,c,p,u,m,g,f,b,_;if(this._drillCaption=e(i.target).parent().find(".cellValue").text(),d=i.target.className,this._startDrilldown=!0,l=this,a=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,d=d.split(" "),e(i.target).hasClass("e-expand")?this._drillAction="drilldown":e(i.target).hasClass("e-collapse")&&(this._drillAction="drillup"),r=e(e(i.target).parent()).hasClass("rowheader")||"rowheader"==e(e(i.target).parent()).attr("role")?"rowheader":"colheader",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){t.isNullOrUndefined(a)?this._waitingPopup.show():(a._isTimeOut=!0,setTimeout(function(){a._isTimeOut&&l._waitingPopup.show()},800));for(var v,C=e(i.target).parent().attr("data-p"),S=(v=this.getJSONRecords()[parseInt(parseInt(C.split(",")[0])*this._rowCount+parseInt(C.split(",")[1]))].Info).replace(/&/g,"&amp;"),O=parseInt(C.split(",")[0]),T=parseInt(C.split(",")[1]);O>0;){for(O--,o=this.getJSONRecords()[O*this._rowCount+T].Info,s=T;""==o&&s>0;)s--,o=this.getJSONRecords()[O*this._rowCount+s].Info;v=o+">#>"+v}return"ejPivotClient"==(n=this.element.parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient").data("ejPivotClient"):t.isNullOrUndefined(this._pivotClientObj)?this:this._pivotClientObj).pluginName&&"rowheader"==r&&n.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(n._drillInfo=v,n.setChartDrillParams(v,this._drillAction)),n._pivotRecords={records:this.getJSONRecords(),rowCount:this._rowCount},e(i.target).hasClass("e-collapse")?this.updateDrilledReport({uniqueName:S,index:C,action:"collapse"},r,n):this.updateDrilledReport({uniqueName:S,index:C},r,n),!1}if(this.element.find(".e-dialog").remove(),!this.model.enableDeferUpdate){this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this._off(this.element,"click",".e-expand, .e-collapse"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".colheader, .rowheader, .value").removeClass("e-droppable"),d=i.target.className,h=e(i.target).parent(),this._startDrilldown=!0,"e-expand"==(d=d.split(" "))[0]?this._drillAction="drilldown":"e-collapse"==d[0]&&(this._drillAction="drillup"),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),p=e(i.target).parent().attr("data-p"),this._drillCaption=e(i.target).parent().find(".cellValue").text(),t.isNullOrUndefined(l._pivotClientObj)||t.isNullOrUndefined(l._pivotClientObj._waitingPopup)?t.isNullOrUndefined(a)?this._waitingPopup.show():(a._isTimeOut=!0,setTimeout(function(){a._isTimeOut&&l._waitingPopup.show()},800)):(l._pivotClientObj._isTimeOut=!0,setTimeout(function(){l._pivotClientObj._isTimeOut&&(e("#"+l._pivotClientObj._id+"_maxView")[0]?(e("#"+l._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}),l._maxViewLoading=e("#"+l._pivotClientObj._id+"_maxView").data("ejWaitingPopup")):l._pivotClientObj._waitingPopup.show())},800)),u="relational"==this.model.analysisMode?this._drillHeaders.join("||"):this.getJSONRecords()[parseInt(parseInt(p.split(",")[0])*this._rowCount+parseInt(p.split(",")[1]))].Info;try{_=e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this._pivotClientObj.getOlapReport()).Report:this._pivotClientObj.currentReport:JSON.parse(this.getOlapReport()).Report}catch(i){_=e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._pivotClientObj.getOlapReport():this._pivotClientObj.currentReport:this.getOlapReport()}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){m=null,!t.isNullOrUndefined(this.model.valueSortSettings)&&this.element.find(".valueSorting").length>0&&!t.isNullOrUndefined(t.PivotAnalysis._valueSorting)&&(m=this.element.find(".valueSorting").parent());var y=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableAdvancedFilter||(e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-fullScreenView").length>0)&&this._pivotClientObj.model.enableAdvancedFilter)?e(this.element).find(".e-pivotGridTable").detach():this._table,x=this._getFieldName(e(i.target).parent()[0]),M=e(e(i.target).parent()).hasClass("rowheader")||"rowheader"==e(e(i.target).parent()).attr("role")?"rowheader":e(e(i.target).parent()).hasClass("colheader")||"columnheader"==e(e(i.target).parent()).attr("role")?"columnheader":"";this.model.enablePaging||this.model.enableVirtualScrolling||(e(i.target).hasClass("e-collapse")?(t.isNullOrUndefined(this.model.collapsedMembers)&&(this.model.collapsedMembers={}),t.isNullOrUndefined(this.model.collapsedMembers[x])?this.model.collapsedMembers[x]=[e(e(i.target).parent()[0]).text().trim()]:this.model.collapsedMembers[x].push(e(e(i.target).parent()[0]).text().trim())):e(i.target).hasClass("e-expand")&&(this.model.collapsedMembers[x]=e.grep(this.model.collapsedMembers[x],function(t){return t!=e(e(i.target).parent()[0]).text().trim()})),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableAdvancedFilter||(e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-fullScreenView").length>0)&&this._pivotClientObj.model.enableAdvancedFilter)?(this._collapseMember(y,i.target),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?this.element.find("#"+this._id+"Toolbar").append(y):this.element.append(y)):(this._collapseMember(y,y.find("[data-p='"+p+"']").children("span")[0]),this._cropHtml(y),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&!this.model.isResponsive&&this.element.find(".e-pivotGridTable").removeAttr("style"),this._mergeHtml(M,p,y,this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(this.element).find(".e-pivotGridTable"):e(this.element).find("table")),(this.model.resizeColumnsToFit||!this.model.enableColumnResizing)&&(this.model.enableColumnResizing||this.model.resizeColumnsToFit)||this.element.find(".e-pivotGridTable").css("width","100%")),this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this._applyFrozenHeaderWidth(this._JSONRecords,this._drillAction,h):(this.model.enableColumnResizing&&this.model.resizeColumnsToFit||this.model.enableColumnResizing&&!this.model.resizeColumnsToFit)&&this._resizeColumnsWidth(),this._hideGrandTotal(y),this.model.enableGroupingBar&&(g=e("#"+this._id).find(".e-pivotGridTable").width(),this.element.find(".groupingBarPivot .e-drag").width(g-5),f=e("#"+this._id).find(".e-pivotGridTable").find("th").width(),this.element.find(".groupingBarPivot .values").width(f-2),this.element.find(".groupingBarPivot .columns").width(g-f),this.element.find(".groupingBarPivot .valueColumn").width(g)),this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),t.isNullOrUndefined(a)?t.isNullOrUndefined(l._pivotClientObj)||(l._pivotClientObj._isTimeOut=!1):a._isTimeOut=!1,this._waitingPopup.hide());O=parseInt(p.split(",")[0]),T=parseInt(p.split(",")[1]);if(""==this._drillCaption&&(this._drillCaption=e.trim(e(i.target).parent(":not(span)").text().replace("expanded","").replace("collapsed",""))),v=this._drillCaption,v=e.trim(this._getMemberInfo(v,T,O,M)),b=this.model.operationalMode==t.Pivot.OperationalMode.ClientMode,"rowheader"==M?(this.model.enablePaging||this.model.enableVirtualScrolling)&&("drillup"==this._drillAction?this.model.enableCollapseByDefault?this._drillHeaders.row=this._drillHeaders.row.filter(function(e){if(e!=(b?v:v.split(">#>").join(".")))return e}):this._drillHeaders.row.push(b?v:v.split(">#>").join(".")):this.model.enableCollapseByDefault?this._drillHeaders.row.push(b?v:v.split(">#>").join(".")):this._drillHeaders.row=this._drillHeaders.row.filter(function(e){if(e!=(b?v:v.split(">#>").join(".")))return e})):(this.model.enablePaging||this.model.enableVirtualScrolling)&&(v.startsWith(">#>")&&(v=v.substring(3,v.length)),"drillup"==this._drillAction?this.model.enableCollapseByDefault?this._drillHeaders.column=this._drillHeaders.column.filter(function(e){if(e!=(b?v:v.split(">#>").join(".")))return e}):this._drillHeaders.column.push(b?v:v.split(">#>").join(".")):this.model.enableCollapseByDefault?this._drillHeaders.column.push(b?v:v.split(">#>").join(".")):this._drillHeaders.column=this._drillHeaders.column.filter(function(e){if(e!=(b?v:v.split(">#>").join(".")))return e}),v=""),this.model.enableVirtualScrolling||this.model.enablePaging)if(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){try{_=JSON.parse(this.getOlapReport()).Report}catch(e){_=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",drillHeaders:JSON.stringify(this._drillHeaders),currentReport:_,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}else this._refPaging();this.model.valueSortSettings&&this._refreshValueSortIcons(m),t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("gridDrillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:v,fieldName:x,axis:r,cellPosition:p}),this._trigger("drillSuccess",{gridObj:this,drillAction:this._drillAction,drilledMember:v,fieldName:x,axis:r,cellPosition:p}),this.model.enableGroupingBar&&this._createFields("drilldown",e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this._unWireEvents(),this._wireEvents(),this._drillAction=""}else""!=this.layout()||"normal"!=this.layout()?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:p,currentReport:_,headerInfo:u,layout:this.layout(),customObject:c}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:p,currentReport:_,clientReports:this._pivotClientObj.reports,headerInfo:u,layout:this.layout(),customObject:c}),this._drillDownSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:p,currentReport:_,headerInfo:u,customObject:c}),this._drillDownSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:p,currentReport:_,clientReports:this._pivotClientObj.reports,headerInfo:u,customObject:c}),this._drillDownSuccess)}},_getMemberInfo:function(e,i,l,a){if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this.model.paging||this.model.enableVirtualScrolling))e=this.getJSONRecords()[this._rowCount*l+i].Info;else for(;"rowheader"==a?l>0:i>0;){"rowheader"==a?l--:i--;for(var r=this.getJSONRecords()[this._rowCount*l+i].Value,o=i;""==r&&("rowheader"==a?o>0:l>0);)"rowheader"==a?o--:l--,r=this.getJSONRecords()[this._rowCount*l+o].Value;e=r+">#>"+e}return e},_collapseMember:function(i,a){var r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y,x,M,P;if(!this.model.enablePaging&&!this.model.enableVirtualScrolling){var w=e(a).parent()[0],L=e(w).attr("data-p"),N=e(a).attr("data-tag")!=l?parseInt(e(a).attr("data-tag"))+w.rowSpan:w.rowSpan,D=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(e(w).attr("vfcolspan"))?parseInt(e(w).attr("vfcolspan")):e(a).attr("data-tag")!=l?parseInt(e(a).attr("data-tag"))+w.colSpan:w.colSpan,R=e(a).closest("tr")[0],j=null,I=null,F="false",A=0;if(w.className.indexOf("rowheader")>=0||w.className.indexOf("summary")>=0&&"rowheader"==e(w).attr("role")){if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout){var E="0,0"==this.getJSONRecords()[1].Index?1:0,k=(N=this.getJSONRecords()[parseInt(L.split(",")[0])*this._rowCount+parseInt(L.split(",")[1])+E].RowSpan,R);for(e(a).attr("class").indexOf("e-expand")>-1&&e(R).removeAttr("data-tag"),p=0;p<N;p++)e(a).attr("class")&&e(a).attr("class").indexOf("e-collapse")>-1&&(e(e(R).next()).attr("data-tag")==l&&e(e(R).next()).attr("data-tag",L),e(e(R).next()).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&e(i).find(".pivotGridValueTable  td[data-i$=',"+e(e(R).next()).find("td").attr("data-i").split(",")[1]+"']").css("display","none")),e(a).attr("class").indexOf("e-expand")>-1&&(e(e(R).next()).attr("data-tag")==l||e(e(R).next()).attr("data-tag")==L)&&(e(e(R).next()).css("display","table-row"),e(e(R).next()).removeAttr("data-tag"),(this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&e(R).parents().find(".pivotGridValueTable td[data-i$=',"+e(e(R).next()).find("td").attr("data-i").split(",")[1]+"']").css("display","")),R=e(R).next();var H=this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders?"td":"th",V=this.model.enableRTL?"margin-right":"margin-left",z=e(k).find(H+" span:not(.cellValue)").css(V);return e(k).find(H+" span:not(.cellValue)").remove(),void e(k).find(H).prepend(e(a).attr("class").indexOf("e-collapse")>-1?'<span style="'+V+":"+z+'" class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':'<span style="'+V+":"+z+'" class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>')}var U,B=!e(w).index()>0,G=U=!1;if(e(a).attr("class")&&e(a).attr("class").indexOf("collapse")>-1){for(p=0;p<N;p++){if(j=e(R).next(),B)e(R).find(".stot,.rstot").length>=1&&1==p&&e(e(R).find(".stot,.rstot")).find(".e-expand").length>=1&&(U=!0),(e(e(R).find(".stot,.rstot")).find(".e-expand").length>=1||"none"==e(R).css("display"))&&(G=!0),e(R).css("display","none"),e(R).attr("data-tag",e(R).attr("data-tag")!=l?parseInt(e(R).attr("data-tag"))+1:1),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&(e(i).find(".pivotGridValueTable tr:eq("+e(R).index()+")").css("display","none"),e(i).find(".pivotGridValueTable tr:eq("+e(R).index()+")").attr("data-tag",e(R).attr("data-tag")!=l?parseInt(e(R).attr("data-tag"))+1:1));else{if(s=w,this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)for(y=e(w).prevAll().length;y<e(i).find("[data-p$=',"+e(w).attr("data-p").split(",")[1]+"'] ").length;y++)e(s).css("display","none").attr("data-hc",e(s).attr("data-hc")==l?1:parseInt(e(s).attr("data-hc"))+1),s=e(e(i).find("[data-p$=',"+e(s).attr("data-p").split(",")[1]+"'] ")[y+1]);else for(y=0;y<=e(w).nextAll().length;y++)e(s).css("display","none").attr("data-hc",e(s).attr("data-hc")==l?1:parseInt(e(s).attr("data-hc"))+1),s=e(s).next();!1,F="true"}R=j,B=!0}for(r="true"==F?w.rowSpan-1:w.rowSpan,"none"!=e(R).css("display")&&U&&(o=e(a).attr("subTag")!=l?-1==parseInt(e(a).attr("subTag"))?w.rowSpan+1:parseInt(e(a).attr("subTag"))+w.rowSpan:w.rowSpan),"none"==e(R).css("display")&&(e(R).css("display",""),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&e(i).find('td.value[data-p$=",'+parseInt(e(R).children().eq(0).attr("data-p").split(",")[1])+'"]').parent().css("display",""),G=!0,r-=1),G&&t.isNullOrUndefined(o)&&(o=e(a).attr("subTag")!=l?-1==parseInt(e(a).attr("subTag"))?w.rowSpan:parseInt(e(a).attr("subTag"))+w.rowSpan:w.rowSpan),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&e(i).find(".pivotGridValueTable").length>0?(e(R).find("td").text(e(R).find("td").text().replace(" Total","")),e(R).find("td span:not(.cellValue)").remove(),e(R).find("td").prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+N+":"+F+'">&nbsp;</span>')):(e(R).find("th").text(e(R).find("th").text().replace(" Total","")),e(R).find("th span:not(.cellValue)").remove(),e(R).find("th").prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+N+":"+F+(t.isNullOrUndefined(o)?"":"true"==e(a).attr("isChildSubNode")?'" subTag="'+o+":"+F+'" isChildSubNode="true':'" subTag="'+o+":"+F)+'">&nbsp;</span>')),d=e(R).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),p=0;p<d.length;p++)parseInt(e(d[p]).attr("data-p").split(",")[0])<parseInt(L.split(",")[0])&&parseInt(e(d[p]).attr("data-p").split(",")[1])+d[p].rowSpan+(e(d[p]).find("span").attr("data-tag")!=l?parseInt(e(d[p]).find("span").attr("data-tag")):0)>=parseInt(L.split(",")[1])+N&&(d[p].rowSpan-=r,e(d[p]).find("span").attr("data-tag")==l&&e(d[p]).find("span").attr("isChildSubNode",!0),e(d[p]).find("span").attr("data-tag",e(d[p]).find("span").attr("data-tag")!=l?parseInt(e(d[p]).find("span").attr("data-tag"))+r:r),e(d[p]).find("span").attr("subTag",e(d[p]).find("span").attr("subTag")!=l?parseInt(e(d[p]).find("span").attr("subTag"))+r:r))}else if(e(a).attr("class")&&e(a).attr("class").indexOf("e-expand")>-1){var J=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,q=this._isSubTotalhidden=!1,K=0;for(p=parseInt(e(a).attr("data-tag").split(":")[0]);p>=0;p--)I=e(R).prev(),e(R).attr("data-tag")==l||parseInt(e(R).attr("data-tag"))<=1?(this._hideSubTotal(e(R),K,e(a)),this._isSubTotalHide?(q=!0,this._isSubTotalHide=!1,e(R).css("display","none"),J&&e(i).find(".pivotGridValueTable tr:eq("+e(R).index()+")").css("display","none")):(e(R).css("display","table-row"),(this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders)&&0==e(R).find("td[data-hc]").length&&e(i).find(".pivotGridValueTable tr:eq("+e(R).index()+")").css("display","table-row"))):A++,K=0==K?1:K,e(R).attr("data-tag")!=l&&(0==parseInt(e(R).attr("data-tag")-1)?e(R).removeAttr("data-tag"):e(R).attr("data-tag",parseInt(e(R).attr("data-tag"))-1)),R=I;if("true"==e(a).attr("data-tag").split(":")[1]){for(s=e(i).find((J?".pivotGridRowTable ":"th")+"[data-p='"+parseInt(e(w).attr("data-p").split(",")[0])+","+(parseInt(e(w).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"'], td[data-p='"+parseInt(e(w).attr("data-p").split(",")[0])+","+(parseInt(e(w).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"']"),n=e(s).nextAll().length,J&&(n=e.merge(e(s).nextAll(),e(i).find(".pivotGridValueTable tr:eq("+e(s).parent().index()+") td")).length),y=0;y<=n;y++)e(s).attr("data-hc")==l||parseInt(e(s).attr("data-hc"))<=1?(e(s).removeAttr("data-hc"),e(s).attr("data-hc")==l&&e(s).css("display","")):e(s).attr("data-hc",parseInt(e(s).attr("data-hc"))-1),s=J?e.merge(e(s).nextAll(),e(i).find(".pivotGridValueTable tr:eq("+e(s).parent().index()+") td"))[0]:e(s).next();if(J)for(R=e(a).closest("tr")[0],p=parseInt(e(a).attr("data-tag").split(":")[0]);p>=0;p--)0==e(R).find("td[data-hc]").length&&e(i).find(".pivotGridValueTable tr:eq("+e(R).index()+")").css("display","table-row"),R=e(R).prev()}for(d=e(e(a).closest("tr")[0]).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),h=e(a).attr("subTag")!=l&&q?"true"==e(a).attr("subTag").split(":")[1]?parseInt(e(a).attr("subTag").split(":")[0])-1:parseInt(e(a).attr("subTag").split(":")[0]):("true"==e(a).attr("data-tag").split(":")[1]?parseInt(e(a).attr("data-tag").split(":")[0])-1:parseInt(e(a).attr("data-tag").split(":")[0]))-A,c=e(i).find("th[data-p='"+parseInt(e(w).attr("data-p").split(",")[0])+","+(parseInt(e(w).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"'], td[data-p='"+parseInt(e(w).attr("data-p").split(",")[0])+","+(parseInt(e(w).attr("data-p").split(",")[1])-parseInt(e(a).attr("data-tag").split(":")[0]))+"']"),q&&(h=parseInt(e(c).attr("rowspan")),h=e(a).attr("subTag")!=l?"true"==e(a).attr("subTag").split(":")[1]?h-1:h:"true"==e(a).attr("data-tag").split(":")[1]?h-1:h,h=e(a).attr("subTag")!=l?-1==parseInt(e(a).attr("subTag").split(":")[0])?h:this._isSubTotalhidden?h-1:h:h-1),p=0;p<d.length;p++)parseInt(e(d[p]).attr("data-p").split(",")[0])<parseInt(L.split(",")[0])&&parseInt(e(d[p]).attr("data-p").split(",")[1])+d[p].rowSpan+(e(d[p]).find("span").attr("data-tag")!=l?parseInt(e(d[p]).find("span").attr("data-tag")):0)>=parseInt(L.split(",")[1])&&(q&&(this._isSubTotalhidden=q=!1,"true"==e(a).attr("isChildSubNode")&&e(a).removeAttr("isChildSubNode")),d[p].rowSpan+=h,e(d[p]).find("span").attr("data-tag")!=l&&e(d[p]).find("span").attr("data-tag",parseInt(e(d[p]).find("span").attr("data-tag"))-h),0==parseInt(e(d[p]).find("span").attr("data-tag"))&&e(d[p]).find("span").removeAttr("data-tag"),e(d[p]).find("span").attr("subTag")!=l&&e(d[p]).find("span").attr("subTag",parseInt(e(d[p]).find("span").attr("subTag"))-h),0==parseInt(e(d[p]).find("span").attr("subTag"))&&e(d[p]).find("span").removeAttr("subTag"));e(w).find(".cellValue").length>0?e(w).find(".cellValue").text(e.trim(e(w).find(".cellValue").text())+" Total"):e(w).text(e.trim(e(w).text())+" Total"),e(w).find(".e-expand").remove(),e(w).prepend("<span style='margin-left:10px'></span>")}}if(w.className.indexOf("colheader")>=0||w.className.indexOf("summary")>=0&&"columnheader"==e(w).attr("role"))if(u=parseInt(L.split(",")[0]),e(i).find("tr"),e(a).attr("class")&&e(a).attr("class").indexOf("e-collapse")>-1){if(m=w.colSpan,"none"==e(w).next().css("display")){var W=e(w).next().attr("data-p"),Q=parseInt(W.split(",")[0]),X=(e(i).find("tr"),parseInt(e(w).next().attr("colspan")));if(e(w).next().attr("class").indexOf("stot","cstot")>-1)for(M=0;M<X;M++){for(g=e(R).nextAll().find("th[data-p^='"+(M+Q)+",']"),v=0;v<e(g).length;v++)e(g[v]).css("display","");if(e(g[v]).attr("data-hc")==l||parseInt(e(g[v]).attr("data-hc"))<1)for(e(i).find("td[data-p^='"+(M+Q)+",']").css("display",""),T=0;T<e(i).find("td[data-p^='"+(M+Q)+",']").length;T++)(e(e(i).find("td[data-p^='"+(M+Q)+",']")[T]).attr("data-hc")!=l||e(e(i).find("td[data-p^='"+(M+Q)+",']")[T]).attr("data-hc")>-1)&&e(e(i).find("td[data-p^='"+(M+Q)+",']")[T]).css("display","none")}e(w).next().css("display",""),m=w.colSpan-X}for(M=0;M<D;M++)if(0!=(g=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(R).nextAll().find("td[data-p^='"+(M+u)+",']"):e(R).nextAll().find("th[data-p^='"+(M+u)+",']")).length){for(v=0;v<e(g).length;v++)e(g[v]).attr("data-hc",e(g[v]).attr("data-hc")!=l?parseInt(e(g[v]).attr("data-hc"))+1:1).css("display","none");(e(g[v]).attr("data-hc")==l||parseInt(e(g[v]).attr("data-hc"))<1)&&(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(e(i).find(".pivotGridValueTable td[data-p^='"+(M+u)+",']").css("display","none"),e(i).find(".pivotGridValueTable td[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(M+u)+",']").attr("data-ch",1)):(e(i).find("td[data-p^='"+(M+u)+",']").css("display","none"),e(i).find("th[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(M+u)+",']").attr("data-ch",1)))}for(e(w).attr("data-hc",1).css("display","none"),e(w).next().text(e(w).next().text().replace(" Total","")),e(w).next().find("span:not(.cellValue)").remove(),e(w).next().prepend('<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'" data-tag="'+D+'">&nbsp;</span>'),ee=e(R).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)"),M=0;M<ee.length;M++)P=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(e(ee[M]).attr("vfcolspan"))?parseInt(e(ee[M]).attr("vfcolspan")):ee[M].colSpan,parseInt(e(ee[M]).attr("data-p").split(",")[1])<parseInt(L.split(",")[1])&&parseInt(e(ee[M]).attr("data-p").split(",")[0])<=parseInt(L.split(",")[0])&&parseInt(e(ee[M]).attr("data-p").split(",")[0])+P+(e(ee[M]).find("span").attr("data-tag")!=l?parseInt(e(ee[M]).find("span").attr("data-tag")):0)>=parseInt(L.split(",")[0])+D&&(ee[M].colSpan-=m,e(ee[M]).find("span").attr("data-tag",e(ee[M]).find("span").attr("data-tag")!=l?parseInt(e(ee[M]).find("span").attr("data-tag"))+m:m))}else if(e(a).attr("class")&&e(a).attr("class").indexOf("e-expand")>-1){var Y,$=0;q=Y=this._isSubTotalhidden=!1,K=0,X=parseInt(e(w).attr("colspan"));if(this._hideSubTotal(e(R),K,e(a)),this._isSubTotalHide){Y=q=!0,this._isSubTotalHide=!1;W=e(w).attr("data-p"),Q=parseInt(W.split(",")[0]),e(i).find("tr");if(e(w).attr("class").indexOf("stot","cstot")>-1)for(M=0;M<X;M++){for(_=e(R).nextAll().find("th[data-p^='"+(M+Q)+",']"),v=0;v<e(_).length;v++)e(_[v]).css("display","none");(e(_[v]).attr("data-hc")==l||parseInt(e(_[v]).attr("data-hc"))<1)&&e(i).find("td[data-p^='"+(M+Q)+",']").css("display","none")}e(w).css("display","none")}for(m=D-(X-1),M=1;M<m;M++){for(g=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(R).nextAll().find("td[data-p^='"+(u-M)+",']"):e(R).nextAll().find("th[data-p^='"+(u-M)+",']"),v=0;v<e(g).length;v++){for(Y=!1,f=0;f<e(g[v]).length;f++)(e(e(g[v])[f]).hasClass("stot")||e(e(g[v])[f]).hasClass("cstot"))&&!e(e(g[v])[f]).hasClass("calc")&&this._hideSubTotal(e(e(g[v])[f]),K,e(a));if(this._isSubTotalHide){Y=!0,this._isSubTotalHide=!1;W=e(g[v]).attr("data-p"),Q=parseInt(W.split(",")[0]),e(i).find("tr"),X=parseInt(e(g[v]).attr("colspan"));if(e(g[v]).attr("class").indexOf("stot","cstot")>-1&&!(e(g[v]).find(".e-expand").length>0))for(b=0;b<X;b++){for(_=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(R).nextAll().find("td[data-p^='"+(b+Q)+",']"):e(R).nextAll().find("th[data-p^='"+(b+Q)+",']"),v=0;v<e(_).length;v++)e(_[v]).css("display","none");e(_[v]).attr("data-hc")==l||parseInt(e(_[v]).attr("data-hc"))<1?e(i).find("td[data-p^='"+(b+Q)+",']").css("display","none"):$++}e(g[v]).css("display","none")}e(g[v]).attr("data-hc")==l||1==parseInt(e(g[v]).attr("data-hc"))?(e(g[v]).css("display",""),e(g[v]).removeAttr("data-hc")):parseInt(e(g[v]).attr("data-hc"))-1==0?e(g[v]).removeAttr("data-hc"):e(g[v]).attr("data-hc",parseInt(e(g[v]).attr("data-hc"))-1)}if(K=0==K?1:K,!Y)if(e(g).last().attr("data-hc")==l){if(J=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,e(i).find("td[data-p^='"+(u-M)+",']").css("display",""),C=[],J){for(S=e(i).find("[data-p^='0,']:not(.summary)").parent(),O="",T=0;T<S.length;T++)O=O+(0!=T?" , ":"")+"  .pivotGridValueTable td:eq("+e(S[T]).index()+")";C=e(i).find(O)}else C=e(i).find("[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(u-M)+",']");for(e(C).removeAttr("data-ch"),y=0;y<=e(C).length;y++)e(C[y]).attr("data-hc")!=l&&e(C[y]).css("display","none")}else $++}e(w).prev().removeAttr("data-hc").css("display","");parseInt(e(w).prev().attr("colspan"));var Z=parseInt(e(a).attr("data-tag"))-$,ee=e(R).prevAll().find("th:has(span):not(.summary), td:has(span):not(.summary)");for(q&&(q=!1,x=e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this._pivotClientObj.getOlapReport():this.getOlapReport(),Z=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?parseInt(e(w).prev().attr("colSpan"))-this.model.dataSource.values.length:parseInt(e(w).prev().attr("colSpan"))-JSON.parse(x).PivotCalculations.length),M=0;M<ee.length;M++)P=this.model.enableAdvancedFilter&&!t.isNullOrUndefined(e(ee[M]).attr("vfcolspan"))?parseInt(e(ee[M]).attr("vfcolspan")):ee[M].colSpan,parseInt(e(ee[M]).attr("data-p").split(",")[1])<parseInt(L.split(",")[1])&&parseInt(e(ee[M]).attr("data-p").split(",")[0])<parseInt(L.split(",")[0])&&parseInt(e(ee[M]).attr("data-p").split(",")[0])+ee[M].colSpan+(e(ee[M]).find("span").attr("data-tag")!=l?parseInt(e(ee[M]).find("span").attr("data-tag")):0)>=parseInt(L.split(",")[0])&&(ee[M].colSpan+=Z,e(ee[M]).find("span").attr("data-tag")!=l&&e(ee[M]).find("span").attr("data-tag",parseInt(e(ee[M]).find("span").attr("data-tag"))-Z),0==parseInt(e(ee[M]).find("span").attr("data-tag"))&&e(ee[M]).find("span").removeAttr("data-tag"));e(w).find(".cellValue").length>0?e(w).find(".cellValue").text(e.trim(e(w).find(".cellValue").text())+" Total"):e(w).text(e.trim(e(w).text())+" Total"),e(w).find(".e-expand").remove(),e(w).prepend("<span style='margin-left:10px'></span>")}}},_generateTreeViewData:function(){var e={catalog:this.model.dataSource.catalog,cube:this.model.dataSource.cube,url:this.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"};this._getTreeData(e,this._loadDimensionElements,{pvtGridObj:this,action:"loadFieldElements"})},_dimensionsDetails:function(t,i){t.pvtGridObj._dimension=e(i).find("row")},_loadDimensionElements:function(t,i){var a,r,o,s,n,d,h;t.pvtGridObj._waitingPopup.show();var c,p={},u={},m=t.pvtGridObj._getConnectionInfo(t.pvtGridObj.model.dataSource.data);for(t.pvtGridObj.schemaTreeView=[],t.pvtGridObj.reportItemNames=[],a='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>MDSCHEMA_DIMENSIONS</RequestType><Restrictions><RestrictionList><CATALOG_NAME>'+t.pvtGridObj.model.dataSource.catalog+"</CATALOG_NAME><CUBE_NAME>"+t.pvtGridObj.model.dataSource.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+t.pvtGridObj.model.dataSource.catalog+"</Catalog> <LocaleIdentifier>"+m.LCID+"</LocaleIdentifier></PropertyList></Properties></Discover></Body></Envelope>",t.pvtGridObj.doAjaxPost("POST",m.url,{XMLA:a},t.pvtGridObj._dimensionsDetails,null,{pvtGridObj:t.pvtGridObj,action:"loadFieldElements"}),r=t.pvtGridObj._dimension,o=0;o<e(i).find("row").length;o++){if(n=(s=e(e(i).find("row")[o])).find("DIMENSION_UNIQUE_NAME").text(),t.pvtGridObj.model.enableDrillThrough)for(d=0;d<r.length;d++)n==e(r[d]).find("DIMENSION_UNIQUE_NAME").text()&&(c=e(r[d]).find("DIMENSION_CAPTION").text());else c=s.find("DIMENSION_CAPTION").text();"[measures]"==n.toLowerCase()?u={hasChildren:!0,isSelected:!1,id:n,name:c,spriteCssClass:"[measures]"==n.toLowerCase()?"e-folderCDB e-icon":"e-dimensionCDB e-icon",tag:n}:!e(e(i).find("row")[0]).find("HIERARCHY_CAPTION").length>0&&(p={hasChildren:!0,isSelected:!1,id:n,name:c,spriteCssClass:"e-dimensionCDB e-icon",tag:n},t.pvtGridObj.schemaTreeView.push(p))}t.pvtGridObj.schemaTreeView.splice(0,0,u),h={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},!t.pvtGridObj.model.enableDrillThrough||t.pvtGridObj._schemaData!=l&&t.pvtGridObj._schemaData.model.olap.showNamedSets?(h.request="MDSCHEMA_SETS",t.pvtGridObj._getTreeData(h,t.pvtGridObj._loadNamedSetElements,t)):(h.request="MDSCHEMA_HIERARCHIES",t.pvtGridObj._fieldData.hierarchySuccess==l?t.pvtGridObj._getTreeData(h,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess))},_loadNamedSetElements:function(t,i){var a,r;t.pvtGridObj._waitingPopup.show();var o={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},s=t.pvtGridObj.model.dataSource,n=e.map(s.rows,function(e){if(e.fieldName!=l)return e.fieldName});for(e.merge(n,e.map(s.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(n,e.map(s.filters,function(e){if(e.fieldName!=l)return e.fieldName})),measureGroupItems=[],a=0;a<e(i).find("row").length;a++)r=e(e(i).find("row")[a]),e.inArray(r.find("DIMENSIONS").text().split(".")[0],measureGroupItems)>=0||(treeNodeElement={hasChildren:!0,isSelected:!1,pid:r.find("DIMENSIONS").text().split(".")[0],id:r.find("SET_DISPLAY_FOLDER").text()+"_"+r.find("DIMENSIONS").text().split(".")[0],name:r.find("SET_DISPLAY_FOLDER").text(),spriteCssClass:"e-folderCDB e-icon namedSets"},t.pvtGridObj.schemaTreeView.push(treeNodeElement),measureGroupItems.push(r.find("DIMENSIONS").text().split(".")[0])),treeNodeElement={hasChildren:!0,isSelected:e.inArray("["+e.trim(r.children("SET_NAME").text())+"]",n)>=0,pid:r.find("SET_DISPLAY_FOLDER").text()+"_"+r.find("DIMENSIONS").text().split(".")[0],id:"["+e.trim(r.children("SET_NAME").text()).replace(/\&/g,"&amp;")+"]",name:r.children("SET_CAPTION").text(),spriteCssClass:"e-namedSetCDB e-icon",tag:r.find("EXPRESSION").text()},t.pvtGridObj.schemaTreeView.push(treeNodeElement);o.request="MDSCHEMA_HIERARCHIES",t.pvtGridObj._fieldData.hierarchySuccess==l?t.pvtGridObj._getTreeData(o,t.pvtGridObj._loadHierarchyElements,t):t.pvtGridObj._loadHierarchyElements(t,t.pvtGridObj._fieldData.hierarchySuccess)},_loadHierarchyElements:function(t,i){var a,r;t.pvtGridObj._waitingPopup.show();var o={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},s=t.pvtGridObj.model.dataSource,n=e.map(s.rows,function(e){if(e.fieldName!=l)return e.fieldName});for(e.merge(n,e.map(s.columns,function(e){if(e.fieldName!=l)return e.fieldName})),e.merge(n,e.map(s.filters,function(e){if(e.fieldName!=l)return e.fieldName})),a={},"",r=0;r<e(i).find("row").length;r++){var d=e(e(i).find("row")[r]),h=d.find("DIMENSION_UNIQUE_NAME").text(),c=d.find("HIERARCHY_UNIQUE_NAME").text();e(t.pvtGridObj.schemaTreeView).filter(function(e,t){return t.tag==h}).map(function(e,t){return t}).length>0&&h!=c&&(a={hasChildren:!0,isSelected:e.inArray(c,n)>=0,pid:h,id:c,name:d.find("HIERARCHY_CAPTION").text(),spriteCssClass:"2"!=d.find("HIERARCHY_ORIGIN").text()&&"6"!=d.find("HIERARCHY_ORIGIN").text()?"e-hierarchyCDB e-icon":"e-attributeCDB e-icon",tag:c},t.pvtGridObj.schemaTreeView.push(a))}o.request="MDSCHEMA_LEVELS",t.pvtGridObj._getTreeData(o,t.pvtGridObj._loadLevelElements,t)},_loadLevelElements:function(i,l){var a;i.pvtGridObj._waitingPopup.show(),a=e.map(e(l).find("row"),function(t){if("1"!=parseInt(e(t).children("LEVEL_TYPE").text())&&"[measures]"!=e(t).children("HIERARCHY_UNIQUE_NAME").text().toLowerCase())return treeNodeElement={hasChildren:!1,isChecked:!1,id:e(t).find("LEVEL_UNIQUE_NAME").text(),pid:e(t).find("HIERARCHY_UNIQUE_NAME").text(),name:e(t).find("LEVEL_CAPTION").text(),spriteCssClass:"level"+parseInt(e(t).children("LEVEL_NUMBER").text())+" e-icon",tag:e(t).find("LEVEL_UNIQUE_NAME").text()}}),e.merge(i.pvtGridObj.schemaTreeView,a),!i.pvtGridObj.model.enableDrillThrough&&i.pvtGridObj._fieldData.measureSuccess?i.pvtGridObj._fieldData.measureSuccess?i.pvtGridObj._loadMeasureElements(i,i.pvtGridObj._fieldData.measureSuccess):(l={catalog:i.pvtGridObj.model.dataSource.catalog,cube:i.pvtGridObj.model.dataSource.cube,url:i.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASURES"},i.pvtGridObj._getTreeData(l,i.pvtGridObj._loadMeasureElements,i)):t.Pivot._createDrillThroughDialog(i.pvtGridObj,i.pvtGridObj.schemaTreeView)},_loadMeasureGroups:function(t,i){t.pvtGridObj._fieldData.measuresGroups=e(i).find("row")},_loadMeasureElements:function(t,i){var a,r,o,s,n={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_DIMENSIONS"},d=t.pvtGridObj.model.dataSource,h=e.map(d.values,function(e){if(e.measures!=l)return e.measures});for(this.reportItemNames=e.map(h,function(e){if(e.fieldName!=l)return e.fieldName}),a=[],"","en-US"!=t.pvtGridObj.model.locale&&(n={catalog:t.pvtGridObj.model.dataSource.catalog,cube:t.pvtGridObj.model.dataSource.cube,url:t.pvtGridObj.model.dataSource.data,request:"MDSCHEMA_MEASUREGROUPS"},t.pvtGridObj._getTreeData(n,this._loadMeasureGroups,{pvtGridObj:this,action:"loadFieldElements"})),o=0;o<e(i).find("row").length;o++){var c=e(e(i).find("row")[o]),p=c.children("MEASUREGROUP_NAME").text(),u=c.find("MEASURE_UNIQUE_NAME").text();e.inArray(p,a)>=0||("en-US"!=t.pvtGridObj.model.locale?r=(s=e.map(t.pvtGridObj._fieldData.measuresGroups,function(t){if(e(t).children("MEASUREGROUP_NAME").text()==p)return e(t).children("MEASUREGROUP_CAPTION").text()})).length>0?s[0]:p:r=p,treeNodeElement={hasChildren:!0,isChecked:!1,pid:"[Measures]",id:p,name:r,spriteCssClass:"e-measureGroupCDB e-icon",tag:p},t.pvtGridObj.schemaTreeView.push(treeNodeElement),a.push(p)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(u,this.reportItemNames)>=0,id:u,pid:p,name:c.children("MEASURE_CAPTION").text(),spriteCssClass:"measure",tag:u},t.pvtGridObj.schemaTreeView.push(treeNodeElement),e.inArray(u,t.pvtGridObj.reportItemNames)>=0&&t.pvtGridObj.reportItemNames.splice(t.pvtGridObj.reportItemNames.indexOf(u),1)}t.pvtGridObj._schemaData.model.olap.showKpi?(treeNodeElement={hasChildren:!0,isChecked:!1,id:"folderStruct",name:"KPI",spriteCssClass:"KPICDB e-folderCDB e-icon",tag:""},t.pvtGridObj.schemaTreeView.splice(1,0,treeNodeElement),n.request="MDSCHEMA_KPIS",t.pvtGridObj._getTreeData(n,t.pvtGridObj._loadKPIElements,t)):t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView)},_loadKPIElements:function(t,i){t.pvtGridObj.model.dataSource;for(var l=this.reportItemNames,a=[],r=0;r<e(i).find("row").length;r++){var o=e(e(i).find("row")[r]),s=o.children("KPI_CAPTION").text(),n=o.children("KPI_goal").text(),d=o.children("KPI_STATUS").text(),h=o.children("KPI_TREND").text(),c=o.find("KPI_VALUE").text();e.inArray(o.children("KPI_NAME").text(),a)>=0||(treeNodeElement={hasChildren:!0,isChecked:!1,pid:"folderStruct",id:s,name:s,spriteCssClass:"e-measureGroupCDB e-icon",tag:s},t.pvtGridObj.schemaTreeView.push(treeNodeElement),a.push(s)),treeNodeElement={hasChildren:!0,isSelected:e.inArray(n,l)>=0,id:n,pid:s,name:t.pvtGridObj._getLocalizedLabels("Goal"),spriteCssClass:"kpiGoal e-icon",tag:n},t.pvtGridObj.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(d,l)>=0,id:d,pid:s,name:t.pvtGridObj._getLocalizedLabels("Status"),spriteCssClass:"kpiStatus e-icon",tag:d},t.pvtGridObj.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(h,l)>=0,id:h,pid:s,name:t.pvtGridObj._getLocalizedLabels("Trend"),spriteCssClass:"kpiTrend e-icon",tag:h},t.pvtGridObj.schemaTreeView.push(treeNodeElement),treeNodeElement={hasChildren:!0,isSelected:e.inArray(c,l)>=0,id:c,pid:s,name:t.pvtGridObj._getLocalizedLabels("Value"),spriteCssClass:"kpiValue e-icon",tag:c},t.pvtGridObj.schemaTreeView.push(treeNodeElement)}t.pvtGridObj._schemaData._createTreeView(this,t.pvtGridObj.schemaTreeView),delete t.pvtGridObj.reportItemNames,delete t.pvtGridObj.schemaTreeView},_getTreeData:function(e,i,l){var a=t.olap.base._getConnectionInfo(e.url),r='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+e.request+"</RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+e.catalog+"</CATALOG_NAME><CUBE_NAME>"+e.cube+"</CUBE_NAME></RestrictionList></Restrictions><Properties><PropertyList><Catalog>"+e.catalog+"</Catalog><LocaleIdentifier>"+a.LCID+"</LocaleIdentifier> </PropertyList></Properties></Discover></Body></Envelope>";this.doAjaxPost("POST",a.url,{XMLA:r},i,null,l)},_addHyperlink:function(i){if(e(".hyperlinkValueCell")[0]&&e(e(".hyperlinkValueCell")[0]).removeClass("hyperlinkValueCell"),e(".hyperlinkHeaderCell")[0]&&e(e(".hyperlinkHeaderCell")[0]).removeClass("hyperlinkHeaderCell"),""==e(i.target).text()||null==e(i.target).text())return!1;var l;"value"==i.target.parentElement.className.replace(/^\s+/,"").split(" ")[0]&&(this.enableValueCellHyperlink()||(t.isNullOrUndefined(this._pivotClientObj)?this.model.enableDrillThrough:this._pivotClientObj.model.enableDrillThrough))?e(i.target).addClass("hyperlinkValueCell"):e(i.target.parentElement).hasClass("summary value")&&this.enableSummaryCellHyperlink()?e(i.target).addClass("hyperlinkValueCell"):"rowheader"==i.target.parentElement.className.split(" ")[0]||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"rowheader"==e(i.target.parentElement).attr("role")?this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||0!=e(this.element).parents(".e-pivotclient").length?this.enableRowHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell"):e(i.target.parentElement).hasClass("rgtot")||(l=e(i.target.parentElement).attr("data-p").split(",")[0],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotRows[l])&&JSON.parse(this.getOlapReport()).PivotRows[l].EnableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.dataSource.rows.length>0&&!t.isNullOrUndefined(this.model.dataSource.rows[l].enableHyperlink)&&this.model.dataSource.rows[l].enableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.enableRowHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell")):("colheader"==i.target.parentElement.className.split(" ")[0]||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"columnheader"==e(i.target.parentElement).attr("role"))&&(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enableDeferUpdate||0!=e(this.element).parents(".e-pivotclient").length?this.enableColumnHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell"):e(i.target.parentElement).hasClass("calc")||e(i.target.parentElement).hasClass("cgtot")||e(i.target.parentElement).hasClass("gtot")||(l=e(i.target.parentElement).attr("data-p").split(",")[1],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotColumns[l])&&JSON.parse(this.getOlapReport()).PivotColumns[l].EnableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&!t.isNullOrUndefined(this.model.dataSource.columns[l].enableHyperlink)&&this.model.dataSource.columns[l].enableHyperlink?e(i.target).addClass("hyperlinkHeaderCell"):this.enableColumnHeaderHyperlink()&&e(i.target).addClass("hyperlinkHeaderCell")))},_removeHyperlink:function(t){e(t.target).removeClass("hyperlinkValueCell").removeClass("hyperlinkHeaderCell")},_cellContext:function(i){var l=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),a=(e(i.target).hasClass("cellValue")?e(i.target).parent()[0]:i.target)||(e(i.srcElement).hasClass("cellValue")?e(i.srcElement).parent()[0]:i.srcElement);if(!t.isNullOrUndefined(l)&&1==l.enableCellContext()&&e(a).parents("#"+l._id)[0]&&(r=e(a).attr("data-p"))){var r=null!=l._excelLikeJSONRecords&&l.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(a).attr("data-i"):e(a).attr("data-p"),o=null!=l._excelLikeJSONRecords&&l.model.layout.toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?l._excelLikeJSONRecords[parseInt(parseInt(r.split(",")[0])*l._excelRowCount+parseInt(r.split(",")[1]))].Info:l.getJSONRecords()[parseInt(parseInt(r.split(",")[0])*l._rowCount+parseInt(r.split(",")[1]))].Info,s={cellValue:a.innerHTML,cellPosition:r,cellType:""!=a.className.split(" ")[0]?a.className.split(" ")[0]:a.className.split(" ")[1],role:e(a).attr("role"),uniqueName:o.split("::")[0],args:i,rawdata:o};""!=s.cellType&&(t.isNullOrUndefined(l._pivotClientObj)?l._trigger("cellContext",{args:s}):l._pivotClientObj._trigger("cellContext",{args:s})),i.target?i.preventDefault():window.event.returnValue=!1}},_initCellSelection:function(i){var l,a;e("#"+this._id+" td,th").removeClass("e-highlighted"),this._on(this.element,"mouseup touchend",".value",this._completeCellSelection),this._oriX=i.pageX,this._oriY=i.pageY,l=i.target||window.event.srcElement,e(l).hasClass("cellValue")&&(l=l.parentElement),e(".value").addClass("selection"),e("#"+this._id).append(t.buildTag("div.e-cellSelection#"+this._id+"_cellSelection","",{})),this._startCellPosition=e(l)[0].attributes.getNamedItem("data-p").value,null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(a=this._excelLikeJSONRecords[0*this._rowCount+parseInt(e(l)[0].attributes.getNamedItem("data-i").value.split(",")[1])].Index,this._startCellPosition=this.getJSONRecords()[parseInt(e(l)[0].attributes.getNamedItem("data-p").value.split(",")[0])*this._rowCount+parseInt(a.split(",")[1])].Index),this._on(this.element,"mousemove touchmove",".value, .e-cellSelection",this._cellSelection)},_headerClickCellSelection:function(i){var l,a,r,o=e(i.target).attr("class").indexOf("colheader")&&-1==e(i.target).attr("class").indexOf("rowheader")?-1!=e(i.target).attr("class").indexOf("cellValue")?e(i.target).parent():null:e(i.target);if(null!=o){var s,n,d;for(e("#"+this._id+" td,th").removeClass("e-highlighted"),d="columnheader"==(s=o.attr("role"))?o.attr("data-p").split(",")[0]:o.attr("data-p").split(",")[1],n="columnheader"==s?o.attr("colspan"):o.attr("rowspan"),null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(l=parseInt(o.attr("data-p").split(",")[0])*this._rowCount+parseInt(o.attr("data-p").split(",")[1]),n="columnheader"==s?this._excelLikeJSONRecords[parseInt(o.attr("data-i").split(",")[0])*this._rowCount+parseInt(o.attr("data-i").split(",")[1])].ColSpan:this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&null!=this.getJSONRecords()[l+this._rowCount]&&-1==this.getJSONRecords()[l+this._rowCount].CSS.indexOf("value")?this.getJSONRecords()[l].RowSpan+1:this.getJSONRecords()[l].RowSpan),a=0;a<n;a++)"columnheader"==s?(e("#"+this._id+" [data-p^='"+(parseInt(a)+parseInt(d))+",']").addClass("e-highlighted"),e("#"+this._id+" [data-p^='"+(parseInt(a)+parseInt(d))+",'][role='columnheader']").each(function(t,i){(parseInt(i.attributes["data-p"].value.split(",")[1])<=parseInt(o.attr("data-p").split(",")[1])||parseInt(i.attributes.colspan.value)>parseInt(o.attr("colspan")))&&e(i).removeClass("e-highlighted")})):(e("#"+this._id+" [data-p$=',"+(parseInt(a)+parseInt(d))+"']").addClass("e-highlighted"),e("#"+this._id+" [data-p$=',"+(parseInt(a)+parseInt(d))+"'][role='rowheader']").each(function(t,i){(parseInt(i.attributes["data-p"].value.split(",")[0])<=parseInt(o.attr("data-p").split(",")[0])||parseInt(i.attributes.rowspan.value)>parseInt(o.attr("rowspan")))&&e(i).removeClass("e-highlighted")}));this._startCellPosition="columnheader"==s?e("#"+this._id+" [data-p^='"+(0+parseInt(d))+",'].value").eq(0).attr("data-p"):e("#"+this._id+" [data-p$=',"+(0+parseInt(d))+"'].value").eq(0).attr("data-p"),null==this._excelLikeJSONRecords||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(this._startCellPosition="columnheader"==s?e("#"+this._id+" [data-p^='"+(0+parseInt(d))+",'].value:not(.summary)").eq(0).attr("data-p"):e("#"+this._id+" [data-p$=',"+(0+parseInt(d))+"'].value:not(.summary)").eq(0).attr("data-p")),r="columnheader"==s?e("#"+this._id+" [data-p^='"+(parseInt(n)-1+parseInt(d))+",']").eq(e("#"+this._id+" [data-p^='"+(parseInt(n)-1+parseInt(d))+",']").length-1):e("#"+this._id+" [data-p$=',"+(parseInt(n)-1+parseInt(d))+"']").eq(e("#"+this._id+" [data-p$=',"+(parseInt(n)-1+parseInt(d))+"']").length-1),this._completeCellSelection(r)}},_cellSelection:function(i){e("#"+this._id+"_gridTooltip").hide();var l=e(i.target).parents(".e-pivotclient").length>0,a=i.pageX-this.element.offset().left-(this._oriX-this.element.offset().left),r=i.pageY-this.element.offset().top-(this._oriY-this.element.offset().top),o=this._oriX-this.element.offset().left,s=this._oriY-this.element.offset().top+3;a<0&&(o-=(a=Math.abs(a))-5),r<0&&(s-=(r=Math.abs(r))-12),i.pageX<this._oriX?e("#"+this._id+"_cellSelection").css({left:l?o:i.pageX+2,width:l?a:this._oriX-i.pageX}):e("#"+this._id+"_cellSelection").css({left:l?o:this._oriX-6,width:l?a:i.pageX-this._oriX}),i.pageY<this._oriY?e("#"+this._id+"_cellSelection").css({top:l?s:i.pageY,height:l?r:this._oriY-i.pageY-7}):e("#"+this._id+"_cellSelection").css({top:l?s:this._oriY+7,height:l?r:i.pageY-this._oriY-11}),e(".e-pivotGridTable").mouseleave(function(i){var l=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(i.toElement)||t.isNullOrUndefined(i.toElement.classList)||"e-pivotgrid"!=i.toElement.classList[0]||(e("#"+l._id+"_cellSelection").remove(),e(".value").removeClass("selection"),l._off(l.element,"mouseup mouseend",".value"))})},_completeCellSelection:function(i){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T=[],y=[],x=[];if(this._off(this.element,"mousemove touchmove",".value"),e(".value").removeClass("selection"),a=e(i).hasClass("value")?i:i.target||window.event.srcElement,e(a).hasClass("cellValue")&&(a=a.parentElement),null==e(a)[0].attributes.getNamedItem("data-p"))return!1;for(r=e(a)[0].attributes.getNamedItem("data-p").value,null==this._excelLikeJSONRecords||this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||e(i).hasClass("value")||(n=this._excelLikeJSONRecords[0*this._rowCount+parseInt(e(a)[0].attributes.getNamedItem("i").value.split(",")[1])].Index,r=this.getJSONRecords()[parseInt(e(a)[0].attributes.getNamedItem("data-p").value.split(",")[0])*this._rowCount+parseInt(n.split(",")[1])].Index),d=0,h=parseInt(this._startCellPosition.split(",")[1])<parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]);h<=(parseInt(this._startCellPosition.split(",")[1])>parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]));h++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("td[data-p*=',"+h+"']").parent().is(":visible"))for(c=parseInt(this._startCellPosition.split(",")[0])<parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]);c<=(parseInt(this._startCellPosition.split(",")[0])>parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]));c++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("[data-p*='"+c+",']").last("th").is(":Visible")){T[d]=this.getJSONRecords()[c*this._rowCount+h];var M,P,w,L="",N=0,D=0;if((o=this.element.find(".summary[role!='gridcell'][data-p$=',"+h+"'] , .rowheader[role!='gridcell'][data-p$=',"+h+"']").last().attr("data-p"))==l&&(o=e("#"+this._id).find("tbody").find('[data-p="'+c+","+h+'"]').parent("tr").find(".summary").first().attr("data-p")),P=o,null!=o){for(;o[0]>=0;)o==this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Index&&(M=this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(M=e("#"+this._id).find("td[data-p*='"+c+","+h+"']").prevAll("th").children(".e-expand").length>0?M.replace(this._getLocalizedLabels("Total"),""):M),o=parseInt(o.split(",")[0])-1+","+parseInt(o.split(",")[1])),L&&""!=M?L=M+"##"+L:""!=M&&(L=M);y[d]=L}for(p="",w=m=this.element.find('tr:has(".colheader")').length-1,(s=T[d].Index)!=l&&s==this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Index&&(g=parseInt(s.split(",")[0])),f=0;f<=m;f++){if(null!=g&&g+","+f==this.getJSONRecords()[parseInt(parseInt(g)*this._rowCount+f)].Index){if(u=this.getJSONRecords()[parseInt(parseInt(g)*this._rowCount+f)].Value,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(b=g;b>=0;b--)if(e("#"+this._id).find("th[data-p*='"+b+","+f+"']").length>0){u=e("#"+this._id).find("th[data-p*='"+b+","+f+"']").find(".e-expand").length>0?u.replace(this._getLocalizedLabels("Total"),""):u;break}""==p?p=u:""!=u&&(p=p+"##"+u)}x[d]=p}d++}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap){for(_=this.getJSONRecords()[parseInt(parseInt(P.split(",")[0])*this._rowCount+parseInt(P.split(",")[1]))].Info;_[0]>=0;)((M=this.getJSONRecords()[parseInt(parseInt(_.split(",")[0])*this._rowCount+parseInt(_.split(",")[1]))].Info).split("::")[0].indexOf("Measures")>0||M.split("::")[0].indexOf("MEASURES")>0)&&N++,o=parseInt(o.split(",")[0])-1+","+parseInt(o.split(",")[1]);if(v=parseInt(s.split(",")[0]),0==N)for(C=0;C<=w;C++)null!=v&&(S=this.getJSONRecords()[parseInt(parseInt(v)*this._rowCount+C)].Info),(S.split("::")[0].indexOf("Measures")>0||S.split("::")[0].indexOf("MEASURES")>0)&&D++}else this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotCalculations.length:this.model.dataSource.values.length;O={JSONRecords:T,rowHeader:y,columnHeader:x,measureCount:N>0?"Row:"+N:"Column:"+D},t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",O):this._pivotClientObj._trigger("cellSelection",O),T=y=x=[],e("#"+this._id+"_cellSelection").remove(),this._on(this.element,"mousemove touchmove",".value",this._applyToolTip),this._off(this.element,"mouseup touchend",".value")},exportPivotGrid:function(i,a){var r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C;if(this._rowCount=t.isNullOrUndefined(this._rowLength)?this._rowCount:this._rowLength,this._isExporting=!0,{},r="excel"==i.toLowerCase()||"excelexport"==i.toLowerCase()?{url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?".xls":".xlsx",title:"",description:"",exportType:i,controlName:this,exportWithStyle:!0,exportValueAsNumber:!1}:{url:"",fileName:"PivotGrid",exportMode:t.PivotGrid.ExportMode.JSON,fileFormat:"word"==i.toLowerCase()?".docx":".pdf",title:"",description:"",exportType:i,controlName:this,exportWithStyle:!0},this._trigger("beforeExport",r),o={rowCellColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".rowheader").css("color"),rowCellBGColor:t.isNullOrUndefined(this.element.find(".rowheader"))?"":t.isNullOrUndefined(this.element.find(".rowheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".rowheader").css("background-color"),columnCellColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("color"))?"rgb(51, 51, 51)":this.element.find(".colheader").css("color"),columnCellBGColor:t.isNullOrUndefined(this.element.find(".colheader"))?"":t.isNullOrUndefined(this.element.find(".colheader").css("background-color"))?"rgb(255, 255, 255)":this.element.find(".colheader").css("background-color"),valueCellColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("color"))?"rgb(51, 51, 51)":this._cFormat.length<=0?this.element.find(".value").css("color"):"rgb(51, 51, 51)",valueCellBGColor:t.isNullOrUndefined(this.element.find(".value"))?"":t.isNullOrUndefined(this.element.find(".value").css("background-color"))?"rgb(255, 255, 255)":this._cFormat.length<=0?this.element.find(".value").css("background-color"):"rgb(255, 255, 255)",summaryCellColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("color"))?"rgb(51, 51, 51)":this.element.find(".summary").css("color"),summaryCellBGColor:t.isNullOrUndefined(this.element.find(".summary"))?"":t.isNullOrUndefined(this.element.find(".summary").css("background-color"))?"rgb(255, 255, 255)":"rgba(0, 0, 0, 0)"==this.element.find(".summary").css("background-color")?"rgb(255, 255, 255)":this.element.find(".summary").css("background-color")},this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode||r.exportMode==t.PivotGrid.ExportMode.JSON){if(C={},this.model.enableCompleteDataExport&&(this.model.enablePaging||this.model.enableVirtualScrolling)){if(s={paging:this.model.enablePaging,vScrolling:this.model.enableVirtualScrolling},n=0,this.model.enablePaging=this.model.enableVirtualScrolling=!1,this._isExporting=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(this._fullExportedData.jsonObj=t.PivotAnalysis.pivotEnginePopulate(this.model).json,this._fullExportedData.rowCount=0,u=0;u<this._fullExportedData.jsonObj.length&&0==parseInt(this._fullExportedData.jsonObj[u].Index.split(",")[0]);u++)this._fullExportedData.rowCount++;else t.olap.base.getJSONData({action:"loadFieldElements"},this.model.dataSource,this);else{try{v=JSON.parse(this.getOlapReport()).Report}catch(e){v=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"export",currentReport:v,gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),function(e){if(this._fullExportedData.jsonObj=t.isNullOrUndefined(e[0])?t.isNullOrUndefined(e.d)?JSON.parse(e.JsonRecords):JSON.parse(e.d[0]):JSON.parse(e[0]),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){this._fullExportedData.rowCount=0;for(var i=0;i<this._fullExportedData.jsonObj.length&&0==parseInt(this._fullExportedData.jsonObj[i].Index.split(",")[0]);i++)this._fullExportedData.rowCount++}else this._fullExportedData.rowCount=t.isNullOrUndefined(e[1])?t.isNullOrUndefined(e.d)?JSON.parse(e.RowCount):JSON.parse(e.d[1]):JSON.parse(e[1])})}this.exportRecords=this._fullExportedData.jsonObj,n=this._fullExportedData.rowCount,C={args:JSON.stringify({pGridData:null!=this.exportRecords&&""!=this.exportRecords?this.exportRecords:null,rowCount:n,columnCount:null!=this.exportRecords?Math.floor(this.exportRecords.length/n):0,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})},this.model.enablePaging=s.paging,this.model.enableVirtualScrolling=s.vScrolling,this._isExporting=!1}else{var S,O,T,y=0,x=!1,M=!1,P=0,w=0,L=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap,N=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap,D=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode,R=e.extend(!0,[],this.exportRecords),I=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&JSON.parse(this.getOlapReport()).PivotRows.length>1;if(!(this.model.enableColumnGrandTotal&&this.model.enableGrandTotal&&this.model.enableRowGrandTotal||this.model.enableColumnGrandTotal&&this.model.enableGrandTotal)){if(!L||D)for(u=0;u<R.length;u++)("summary cgtot"==R[u].CSS||"summary gtot"==R[u].CSS&&0==R[u].Index.split(",")[1])&&R.splice(u);if(L)for(u=0;u<R.length;u++)0==R[u].Index.split(",")[1]&&"summary col"==R[u].CSS&&R.splice(u);w=this._rowCount}if(!(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode!=t.PivotGrid.OperationalMode.ClientMode||this.model.enableRowGrandTotal&&this.model.enableGrandTotal||I)){for(d=this._rowCount-1,u=0;u<R.length;u++)R[u].Index.split(",")[1]==d&&(R=R.slice(0,u).concat(R.slice(u+1,R.length)));w=this._rowCount-1}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(JSON.parse(this.getOlapReport()).PivotRows.length>1||JSON.parse(this.getOlapReport()).PivotColumns.length>1)){if(!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)for(u=0;u<R.length;u++)0==R[u].Index.split(",")[1]&&"summary"==R[u].CSS&&R.splice(u);if(!this.model.enableRowGrandTotal||!this.model.enableGrandTotal)for(S=this.exportRecords.length/this._rowCount,u=0;u<R.length;u++)if(0==R[u].Index.split(",")[0]&&"summary"==R[u].CSS){for(h=u,c=this._rowCount-h,g=0;g<R.length;g++)R=R.slice(0,h).slice(0,this._rowCount+P).concat(R.slice(this._rowCount+y,R.length)),P=h-1,h=h+this.element.find("tr").length-c,y=P+1;break}w=c!=l?this.element.find("tr").length-c:this.element.find("tr").length}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(N?(O=this.model.dataSource.rows,T=this.model.dataSource.columns):null!=this.getOlapReport()&&(O=JSON.parse(this.getOlapReport()).PivotRows,T=JSON.parse(this.getOlapReport()).PivotColumns),0==w&&(w=this._rowCount),S=R.length/w,O.length>1&&"excellikelayout"!=this.layout())for(m=0;m<O.length;m++)if(0==O[m].showSubTotal)for(x=!0,u=0;u<R.length;u++)if(R[u].Index.split(",")[0]==m&&"summary rstot"==R[u].CSS||"summary stot"==R[u].CSS)for(p=R[u].Index.split(",")[1],g=0;g<R.length;g++)R[g].Index.split(",")[1]==p&&(R=R.slice(0,g).concat(R.slice(g+1,R.length)),u=0);if(O.length>1&&1==x)for(w=R.length/S,S=R.length/w,m=0;m<S-1;m++)for(g=R[0].RowSpan;g<R.length;g++)if(R[g].Index.split(",")[0]==m&&("rowheader"==R[g].CSS||"summary rstot"==R[g].CSS||"summary stot"==R[g].CSS||"none"==R[g].CSS)&&1==R[g].Expander){var F=R[g].Index.split(",")[1],A=R[g].Index.split(",")[0],E=0;for(j=0;j<R[g].RowSpan;j++)parseInt(F)+R[g].RowSpan>R[g+j].Index.split(",")[1]&&A==R[g+j].Index.split(",")[0]&&E++;R[g].RowSpan=E}if(T.length>1&&"excellikelayout"!=this.layout())for(N&&(valuedata=this.model.dataSource.values),D&&(valuedata=JSON.parse(this.getOlapReport()).PivotCalculations),m=0;m<T.length;m++)if(0==T[m].showSubTotal)for(M=!0,u=0;u<R.length;u++)(R[u].Index.split(",")[1]==m&&"summary cstot"==R[u].CSS||"summary stot"==R[u].CSS)&&(R=R.slice(0,u-m).slice(0,u+w*valuedata.length-m).concat(R.slice(u+w*valuedata.length-m,R.length)));if(T.length>1&&1==M)for(S=R.length/w,m=0;m<R.length;m++)for(g=R[0].ColSpan;g<R.length;g++)if(R[g].Index.split(",")[0]==m&&("colheader"==R[g].CSS||"summary cstot"==R[g].CSS||"summary stot"==R[g].CSS||"none"==R[g].CSS)&&1==R[g].Expander){F=R[g].Index.split(",")[1],A=R[g].Index.split(",")[0];var k=0;for(j=0;j<R.length;j++)g+j<R.length&&parseInt(A)+R[g].ColSpan>R[g+j].Index.split(",")[0]&&F==R[g+j].Index.split(",")[1]&&(k++,j+=w-1);R[g].ColSpan=k}}f=R.length,C=0!=w?I?{args:JSON.stringify({pGridData:null!=R&&""!=R?R:null,rowCount:w,columnCount:JSON.parse(this.getOlapReport()).PivotRows.length>1&&!this.model.enableGrandTotal?f/w:this.model.enableColumnGrandTotal?t.isNullOrUndefined(S)?f/w:S:f/w,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}:{args:JSON.stringify({pGridData:null!=R&&""!=R?R:null,rowCount:w,columnCount:f/w,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}:{args:JSON.stringify({pGridData:null!=this.exportRecords&&""!=this.exportRecords?this.exportRecords:null,rowCount:null!=this._excelLikeJSONRecords?this._excelRowCount:this._rowCount,columnCount:null!=this._excelLikeJSONRecords?Math.floor(this._excelLikeJSONRecords.length/this._excelRowCount):null==this.getJSONRecords()||t.isNullOrUndefined(this._rowLength)?Math.floor(this.getJSONRecords().length/this._rowCount):f/this._rowLength,fileFormat:r.fileFormat+(".xls"==r.fileFormat||".xlsx"==r.fileFormat?"~"+r.exportValueAsNumber:""),fileName:t.isNullOrUndefined(a)?t.isNullOrUndefined(r.fileName)?"PivotGrid":r.fileName:a,colorSettings:o,Formatting:this._cFormat,title:r.title,description:r.description,language:this.model.locale,exportWithStyle:r.exportWithStyle,customObject:JSON.stringify(this.model.customObject)})}}!t.raiseWebFormsServerEvents||"excelExport"!=i&&"wordExport"!=i&&"pdfExport"!=i&&"csvExport"!=i||r.exportMode!=t.PivotGrid.ExportMode.JSON||""!=e.trim(r.url)?this.doPostBack(""!=e.trim(r.url)?r.url:i,C):(b={model:this.model,originalEventType:i},_=C,t.raiseWebFormsServerEvents(i,b,_),setTimeout(function(){t.isOnWebForms=!0},1e3))}else{try{v=JSON.parse(this.getOlapReport()).Report}catch(e){v=this.getOlapReport()}C={args:JSON.stringify({exportOption:i,fileFormat:r.fileFormat,currentReport:v,layout:this.layout(),colorSettings:o!=l?JSON.stringify(o):"",customObject:JSON.stringify(this.model.customObject),title:r.title,description:r.description,completeDataExport:this.model.enableCompleteDataExport,exportWithStyle:r.exportWithStyle})},this.doPostBack(""!=e.trim(r.url)?r.url:this.model.url+"/"+this.model.serviceMethodSettings.exportPivotGrid,C)}this._isExporting=!1},_createCalculatedField:function(){var i,l;t.Pivot.openPreventPanel(this),this.element.find(".calculatedFieldPopup",".e-clientDialog",".e-dialog").remove();var a=this._getLocalizedLabels("CalculatedField"),r=t.buildTag("label#"+this._id+"_lblCalFieldName",this._getLocalizedLabels("Name"))[0].outerHTML,o=t.buildTag("span.fieldDropDown",t.buildTag("input#"+this._id+"_calculateFieldList","",{},{type:"text"})[0].outerHTML+t.buildTag("input#"+this._id+"_calculateFieldName.calculateFieldName","",{"margin-left":this.model.enableRTL?"86px":"2px",outline:"none"},{type:"text"})[0].outerHTML,{})[0].outerHTML,s=t.buildTag("button#"+this._id+"_btnAdd",this._getLocalizedLabels("Add"),{},{name:this._getLocalizedLabels("Add")})[0].outerHTML,n=t.buildTag("label#"+this._id+"_lblCalFieldFormula",this._getLocalizedLabels("Formula"))[0].outerHTML,d=t.buildTag("input.calculatedFieldFormula#"+this._id+"_calculatedFieldFormula","",{width:"192px",height:"27px"},{type:"text",disabled:"disabled"})[0].outerHTML,h=t.buildTag("button#"+this._id+"_btnDelete",this._getLocalizedLabels("Delete"),{"margin-top":"-2px"},{name:this._getLocalizedLabels("Delete")})[0].outerHTML,c=t.buildTag("label#"+this._id+"_pivotGridValueFields",this._getLocalizedLabels("Fields"))[0].outerHTML,p=t.buildTag("ul#"+this._id+"_fieldCollection","")[0].outerHTML,u=t.buildTag("button.calculatorFields","",{"margin-left":this.model.enableRTL?"0px":"10px","margin-right":this.model.enableRTL?"10px":"0px"})[0].outerHTML,m=t.buildTag("span.editFormula e-icon e-cancel","",{padding:"3px","margin-left":"-54px","margin-right":this.model.enableRTL?"-54px":"0px",position:"relative"}).attr("aria-label","cancel")[0].outerHTML,g=t.buildTag("span",t.buildTag("button#"+this._id+"_btnInsert",this._getLocalizedLabels("InsertField"),{},{name:this._getLocalizedLabels("InsertField")})[0].outerHTML,{"margin-right":"150px","margin-left":"150px"})[0].outerHTML,f=t.buildTag("button#"+this._id+"_btnOk",this._getLocalizedLabels("OK"),{"margin-left":"10px"},{name:this._getLocalizedLabels("OK")})[0].outerHTML,b=t.buildTag("button#"+this._id+"_btnCancel",this._getLocalizedLabels("Cancel"),{"margin-left":this.model.enableRTL?"0px":"10px"},{name:this._getLocalizedLabels("Cancel")})[0].outerHTML,_=t.buildTag("div",f+b,{float:this.model.enableRTL?"left":"right","margin-bottom":"15px","margin-top":"4px"})[0].outerHTML,v=t.buildTag("div.e-calcFormulaDiv",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td","+")[0].outerHTML+t.buildTag("td","-")[0].outerHTML+t.buildTag("td","*")[0].outerHTML+t.buildTag("td","/")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","7")[0].outerHTML+t.buildTag("td","8")[0].outerHTML+t.buildTag("td","9")[0].outerHTML+t.buildTag("td","%")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","4")[0].outerHTML+t.buildTag("td","5")[0].outerHTML+t.buildTag("td","6")[0].outerHTML+t.buildTag("td","^")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","1")[0].outerHTML+t.buildTag("td","2")[0].outerHTML+t.buildTag("td","3")[0].outerHTML+t.buildTag("td","(")[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",".")[0].outerHTML+t.buildTag("td","0")[0].outerHTML+t.buildTag("td","C")[0].outerHTML+t.buildTag("td",")")[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{display:"none"})[0].outerHTML,C=t.buildTag("div#calculatedField.e-dlgCalculatedField",'<table class="outerTable"><tr><td>'+r+"</td><td>"+o+"</td><td>"+s+"</td></tr><tr><td>"+n+"</td><td>"+d+u+m+"</td><td>"+h+'</td></tr></table><p class="borderLine"></p><table class="e-fieldTable"><tr><td>'+c+"</td></tr><tr><td>"+p+"</td></tr><tr><td>"+g+"</td></tr></table>")[0].outerHTML,S=t.buildTag("div#clientDialog.e-clientDialog",C+_+v,{opacity:"1"}).attr("title",a)[0].outerHTML;e(S).appendTo("#"+this._id),this.element.find(".e-clientDialog").ejDialog({width:"auto",target:"#"+this._id,enableRTL:this.model.enableRTL,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)}),e("#"+this._id+"_btnAdd,#"+this._id+"_btnDelete,#"+this._id+"_btnOk,#"+this._id+"_btnCancel").ejButton({type:t.ButtonType.Button,width:"80",enableRTL:this.model.enableRTL}),e("#"+this._id+"_btnInsert").ejButton({type:t.ButtonType.Button,enabled:!1,width:"100",enableRTL:this.model.enableRTL}),e(".calculatorFields").ejButton({type:t.ButtonType.Button,contentType:"imageonly",prefixIcon:"e-icon e-sigma",htmlAttributes:{title:"Click Me"},enableRTL:this.model.enableRTL}),e("#"+this._id+"_calculateFieldList").ejDropDownList({width:"230px",enableRTL:this.model.enableRTL,dataSource:this._calculatedField,fields:{text:"name",value:"name"},select:t.proxy(this._calculatedFieldListChange,this),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),i=[],this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(JSON.parse(this.getOlapReport()).PivotCalculations).each(function(){8!=this.CalculationType&&"Formula"!=this.CalculationType&&i.push({fields:this.FieldName})}):e(e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField})).each(function(){i.push({fields:this.fieldName})}),l=e("#"+this._id+"_btnInsert").data("ejButton"),0==this._calculatedField.length&&(e("#"+this._id+"_btnOk").ejButton("disable"),e("#"+this._id+"_btnOk").attr("disabled","disabled")),e("#"+this._id+"_fieldCollection").ejListBox({dataSource:i,enableRTL:this.model.enableRTL,select:function(){l.enable()},height:"130",width:"400"}),l.disable(),this.element.find(".e-dialog .e-close").attr("title",this._getLocalizedLabels("Close")),e(".calculatorFields").click(function(){e("div.e-calcFormulaDiv").removeAttr("style")}),e(".editFormula").click(function(){var t=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=e("#"+t._id+"_calculatedFieldFormula").val().lastIndexOf(" ");""!==e("#"+t._id+"_calculatedFieldFormula").val()&&i>0?i+1==e("#"+t._id+"_calculatedFieldFormula").val().length?e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val().substring(0,i-2)):e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val().substring(0,i)+" "):e("#"+t._id+"_calculatedFieldFormula").val("")}),null!=this.model.pivotEnginePopulated&&this._trigger("pivotEnginePopulated",{JSONRecords:jsonObj}),e(document).click(function(t){e(t.target).hasClass("calculatorFields")||e(t.target).hasClass("e-sigma")||e(t.target).parents(".e-calcFormulaDiv").length>0||e("div.e-calcFormulaDiv").css("display","none")}),e("div.e-calcFormulaDiv").on("click","td",function(){var t=e(this).parents(".e-pivotgrid").data("ejPivotGrid");"C"==this.textContent?e("#"+t._id+"_calculatedFieldFormula").val(""):e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val()+("+-/%^*".indexOf(this.textContent)>-1?" "+this.textContent+" ":this.textContent))}),e("#"+this._id+"_btnInsert").click(function(){var t=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),i=e("#"+t._id+"_fieldCollection").data("ejListBox");e("#"+t._id+"_calculatedFieldFormula").val(e("#"+t._id+"_calculatedFieldFormula").val()+i.value())}),e("#"+this._id+"_btnAdd").click(function(){var i,l,a,r,o=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),s=e("#"+o._id+"_calculatedFieldFormula").val().split(" "),n=-1;if(""!=e("#"+o._id+"_calculateFieldName").val()&&""!=e("#"+o._id+"_calculatedFieldFormula").val()){for(r=0;r<s.length;r++){if((n="+-/%^*".indexOf(s[r])>-1?r:-1)>-1&&s.length>0&&(""==s[0]||"."==s[0]||""==s[s.length-1]||"."==s[s.length-1]||""==s[n+1]||"."==s[n+1]))return void t.Pivot._createErrorDialog(o._getLocalizedLabels("NotValid"),o._getLocalizedLabels("Warning"),o);if(s[r].indexOf("(")==s[r].length-1||0==s[r].indexOf(")")||e("#"+o._id+"_calculatedFieldFormula").val().replace(/[^\(_]/g,"").length!=e("#"+o._id+"_calculatedFieldFormula").val().replace(/[^\)_]/g,"").length)return void t.Pivot._createErrorDialog(o._getLocalizedLabels("NotValid"),o._getLocalizedLabels("Warning"),o)}for(i=[],o.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e(JSON.parse(o.getOlapReport()).PivotCalculations).each(function(){8!=this.CalculationType&&"Formula"!=this.CalculationType&&i.push({fields:this.FieldName})}):e(o.model.dataSource.values).each(function(){i.push({fields:this.fieldName})}),s=e("#"+o._id+"_calculatedFieldFormula").val().replace(/\(|\)/g," ").split(" "),r=0;r<s.length;r++){for(l=!1,a=0;a<i.length;a++)if(s[r].indexOf(i[a].fields)>-1&&s[r]!=i[a].fields)l=!0;else if(s[r]==i[a].fields){l=!1;break}if(l)return void t.Pivot._createErrorDialog(o._getLocalizedLabels("NotPresent"),o._getLocalizedLabels("Warning"),o)}for(r=0;r<o._calculatedField.length;r++)if(o._calculatedField[r].name==e("#"+o._id+"_calculateFieldName").val())return confirm(o._getLocalizedLabels("Confirm"))?(o._calculatedField[r].formula=e("#"+o._id+"_calculatedFieldFormula").val(),e("#"+o._id+"_calculatedFieldFormula").val(""),e("#"+o._id+"_calculateFieldName").val(""),void e("#"+o._id+"_calculateFieldList").ejDropDownList({dataSource:o._calculatedField,fields:{text:"name",value:"name"},enableRTL:o.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}})):void 0;o._calculatedField.push({name:e("#"+o._id+"_calculateFieldName").val(),formula:e("#"+o._id+"_calculatedFieldFormula").val()}),e("#"+o._id+"_calculatedFieldFormula").val(""),e("#"+o._id+"_calculateFieldName").val(""),e("#"+o._id+"_calculateFieldList").ejDropDownList({dataSource:o._calculatedField,fields:{text:"name",value:"name"},enableRTL:o.model.enableRTL,create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),o._calculatedField.length>0&&(e("#"+o._id+"_btnOk").ejButton("enable"),e("#"+o._id+"_btnOk").removeAttr("disabled"))}else t.Pivot._createErrorDialog(o._getLocalizedLabels("EmptyField"),o._getLocalizedLabels("Warning"),o)}),e("#"+this._id+"_btnDelete").click(function(){var i,l,a,r,o,s,n,d=e(this).parents(".e-pivotgrid").data("ejPivotGrid");if(0!=d._calculatedField.length){for(i=hederTag=e("#"+d._id+"_calculateFieldName").val(),o=0;o<d._calculatedField.length;o++)if(d._calculatedField[o].name==e("#"+d._id+"_calculateFieldName").val()){if(d.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)d.model.dataSource.values=e.grep(d.model.dataSource.values,function(e){return e.fieldCaption!=d._calculatedField[o].name}),d._calculatedField.splice(o,1),d._populatePivotGrid();else{for(d._calculatedField.splice(o,1),o=0;o<d._pivotTableFields.length;o++)d._pivotTableFields[o].name==i&&(d._pivotTableFields[o].isSelected=!1,headerTag=d._pivotTableFields[o],d._pivotTableFields.splice(o,1));try{l=JSON.parse(d.getOlapReport()).Report}catch(e){l=d.getOlapReport()}r="schemaRow::"+headerTag.id+"::FILTERED",null==d._schemaData&&(null!=d.model.beforeServiceInvoke&&d.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&d._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:d.element,customObject:d.model.customObject}),s=JSON.stringify(d.model.customObject),a=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(headerTag),dropAxis:"schemaValue::",sortedHeaders:d._ascdes,filterParams:r,currentReport:l,valueSorting:JSON.stringify(d.model.valueSortSettings),customObject:s}),d.model.enableDeferUpdate?d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.nodeStateModified,a.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),d._nodeStateModifiedSuccess):d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.nodeStateModified,a,d._nodeStateModifiedSuccess))}null!=d._schemaData&&(n=d._schemaData._tableTreeObj.element.find("li[id='"+i+"']"),d._schemaData._tableTreeObj.uncheckNode(n),d._schemaData._tableTreeObj.model.beforeDelete=null,d._schemaData._tableTreeObj.removeNode(n),d._schemaData._tableTreeObj.model.beforeDelete=function(){return!1})}else if(o==d._calculatedField.length-1)return void t.Pivot._createErrorDialog(d._getLocalizedLabels("CalculatedFieldNameNotFound"),d._getLocalizedLabels("Warning"),d)}else t.Pivot._createErrorDialog(d._getLocalizedLabels("CalculatedFieldNameNotFound"),d._getLocalizedLabels("Warning"),d)}),e("#"+this._id+"_btnOk").click(function(){var i,l,a,r,o,s,n,d=e(this).parents(".e-pivotgrid").data("ejPivotGrid");for(d.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(d.model.dataSource.values=e.grep(d.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField})),i=0;i<d._calculatedField.length;i++){for(l=d._calculatedField[i].formula.replace(/\(|\)/g," ").replace(/[-+*/^%]/g," ").split(" "),a=0;a<l.length;a++)if(!e.isNumeric(l[a])&&""!=l[a].replace(/\s+|\s+$/gm,"")&&0==(d.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.grep(JSON.parse(d.getOlapReport()).PivotCalculations,function(e){return e.FieldName==l[a]}).length:e.grep(d.model.dataSource.values,function(e){return e.fieldName==l[a]}).length))return void t.Pivot._createErrorDialog(d._getLocalizedLabels("NotPresent"),d._getLocalizedLabels("Warning"),d);r=d._calculatedField[i].formula.replace(/\s+|\s+$/gm,""),r=d._parenthesisAsterisk(r),d.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&0==e.grep(d.model.dataSource.values,function(e){return e.fieldName==d._calculatedField[i].name&&(e.formula=d._calculatedField[i].formula),e.fieldName==d._calculatedField[i].name}).length&&(d.model.dataSource.values.push({fieldName:d._calculatedField[i].name,fieldCaption:d._calculatedField[i].name,isCalculatedField:!0,formula:r,format:d._calculatedField[i].format,formatString:d._calculatedField[i].formatString}),null!=d._schemaData&&d._schemaData._tableTreeObj.element.find("li[id='"+d._calculatedField[i].name+"']").find(".e-chk-inact").length>0&&d._schemaData._tableTreeObj.checkNode(d._calculatedField[i].name))}if(d.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(d),d.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode)d._populatePivotGrid();else{t.isNullOrUndefined(d._waitingPopup)||d._waitingPopup.show();try{o=JSON.parse(d.getOlapReport()).Report}catch(e){o=d.getOlapReport()}null!=d.model.beforeServiceInvoke&&d._trigger("beforeServiceInvoke",{action:"calculatedField",element:d.element,customObject:d.model.customObject}),s=JSON.stringify(d.model.customObject),n=JSON.stringify({action:"calculatedField",headerTag:JSON.stringify(d._calculatedField),currentReport:o,valueSorting:JSON.stringify(d.model.valueSortSettings),customObject:s}),d.model.enableDeferUpdate?(t.isNullOrUndefined(d._waitingPopup)||d._waitingPopup.hide(),d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.calculatedField,n.replace("calculatedField","calculatedFieldDeferUpdate"),null==d._schemaData?d._renderControlSuccess:d._schemaCalculatedField)):d.doAjaxPost("POST",d.model.url+"/"+d.model.serviceMethodSettings.calculatedField,n,null==d._schemaData?d._renderControlSuccess:d._schemaCalculatedField)}}),e("#"+this._id+"_btnCancel").click(function(){var i=e(this).parents(".e-pivotgrid").data("ejPivotGrid");i.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(i)}),this._curFocus.field=this.element.find(".e-dialog .calculateFieldName").attr("tabindex","-1")},_schemaCalculatedField:function(i){var l,a,r;for(this._schemaData._tableTreeObj.model.nodeCheck=null,this._schemaData._tableTreeObj.model.nodeUncheck=null,r=0;r<this._calculatedField.length;r++)l=this._schemaData.element.find(".e-schemaFieldTree").data("ejTreeView"),0==this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").length?(a=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?{id:this._calculatedField[r].name,name:this._calculatedField[r].name,caption:this._calculatedField[r].name,isSelected:!0,spriteCssClass:""}:{id:this._calculatedField[r].name,name:this._calculatedField[r].name,isSelected:!0,calculationType:8,formula:this._calculatedField[r].formula,summaryType:6,format:null,allowRunTimeGroupByField:"false",pivotType:"PivotComputationInfo",spriteCssClass:""},this._pivotTableFields.push(a),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&(this._pivotTableFields=t.PivotAnalysis.getTreeViewData(this.model.dataSource)),this._schemaData._setTableFields(this._pivotTableFields),l.addNode(a),this._schemaData._tableTreeObj.element.find(".e-item").css("padding","0px")):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&null!=this._schemaData&&this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").find(".e-chk-inact").length>0?this._schemaData._tableTreeObj.checkNode(this._calculatedField[r].name):this._schemaData._tableTreeObj.element.find("li[id='"+this._calculatedField[r].name+"']").removeClass("filter").find(".treeDrop , .filter").remove();if(this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),this._schemaData._tableTreeObj.model.nodeCheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this._schemaData._tableTreeObj.model.nodeUncheck=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?t.proxy(this._schemaData._checkedStateModified,this._schemaData):t.proxy(this._schemaData._pivotCheckedStateModified,this._schemaData),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(this.model.enableDeferUpdate?(this._isUpdateRequired=!0,this._deferUpdateSuccess(i)):this._renderControlSuccess(i)),e(this._schemaData.element.find(".e-schemaValue .e-pivotButton")).each(function(){e(this).remove()}),t.isNullOrUndefined(this._pivotClientObj)||void 0===this._pivotClientObj._pivotSchemaDesigner)if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(report=JSON.parse(this.getOlapReport()),r=0;r<report.PivotCalculations.length;r++)this._schemaData._createPivotButton({fieldName:report.PivotCalculations[r].FieldName,fieldCaption:report.PivotCalculations[r].FieldHeader},"value","","","");else for(r=0;r<this.model.dataSource.values.length;r++)this._schemaData._createPivotButton({fieldName:this.model.dataSource.values[r].fieldName,fieldCaption:this.model.dataSource.values[r].fieldCaption},"value","","","");else this._schemaData._refreshPivotButtons();this._schemaData._setPivotBtnWidth()},_calculatedFieldListChange:function(t){e("#"+this._id+"_calculateFieldName").val(t.selectedText);for(var i=0;i<this._calculatedField.length;i++)this._calculatedField[i].name==t.selectedText&&e("#"+this._id+"_calculatedFieldFormula").val(this._calculatedField[i].formula)},_parenthesisAsterisk:function(e){for(var t=1;t<e.length-1;t++)"("==e[t]&&-1=="+-/%^*(".indexOf(e[t-1])&&(e=e.substring(0,t)+"*"+e.substring(t),t--),")"==e[t]&&-1=="+-/%^*)".indexOf(e[t+1])&&(e=e.substring(0,t+1)+"*"+e.substring(t+1),t--);return e},_calcFieldNodeDrop:function(t){for(var i=e.grep(this.model.dataSource.values,function(e){return 1==e.isCalculatedField&&e.formula.indexOf(t.fieldName)>-1}),l=0;l<i.length;l++)this._schemaData._tableTreeObj.uncheckNode(i[l].fieldName)},_schemaButtonCreate:function(){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){e(this._schemaData.element.find(".e-schemaValue .e-pivotButton")).each(function(){e(this).remove()}),report=JSON.parse(this.getOlapReport());for(var i=0;i<report.PivotCalculations.length;i++)this._schemaData._createPivotButton({fieldName:report.PivotCalculations[i].FieldName,fieldCaption:report.PivotCalculations[i].FieldHeader},"value","","","")}this._schemaData._setPivotBtnWidth()},_calculatedFieldNodeRemove:function(i){for(var l=e.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(e){return 8==e.CalculationType&&e.Formula.indexOf(i.id)>-1}),a=0;a<l.length;a++)this._schemaData._tableTreeObj.model.nodeUncheck=null,this._schemaData._tableTreeObj.uncheckNode(l[a].FieldName),this._schemaData._tableTreeObj.element.find("li[id='"+l[a].FieldName+"']").removeClass("filter").find(".treeDrop").remove(),this._schemaData._tableTreeObj.model.nodeUncheck=t.proxy(this._schemaData._checkedStateModified,this._schemaData)},createConditionalDialog:function(){this.openConditionalFormattingDialog()},openConditionalFormattingDialog:function(){var i,a,r,o,s,n,d,h;if(!this.model.enableConditionalFormatting)return!1;t.Pivot.openPreventPanel(this),this.element.find(".e-dialog").remove(),i=t.buildTag("div#"+this._id+"_clientDlg.clientDialog",{opacity:"1"})[0].outerHTML,r=this._getLocalizedLabels("ConditionalFormatting");var c=t.buildTag("label#"+this._id+"_conLbl.e-conditionLbl",this._getLocalizedLabels("Condition"))[0].outerHTML,p=t.buildTag("input#"+this._id+"_conType.conditionType","",{},{type:"text",tabindex:0,accesskey:"f"})[0].outerHTML,u=t.buildTag("label#"+this._id+"_editcond.e-editcondition",this._getLocalizedLabels("FormatName"))[0].outerHTML,m=t.buildTag("label#"+this._id+"_value1.value1",this._getLocalizedLabels("Value1"))[0].outerHTML,g=t.buildTag("label#"+this._id+"_value2.e-value2",this._getLocalizedLabels("Value2"))[0].outerHTML,f=t.buildTag("label#"+this._id+"_backcolorLbl.backcolorLbl",this._getLocalizedLabels("Backcolor"))[0].outerHTML,b=t.buildTag("label#"+this._id+"_bordercolorLbl.bordercolorLbl",this._getLocalizedLabels("Bordercolor"))[0].outerHTML,_=t.buildTag("label#"+this._id+"_borderrangeLbl.e-borderrangeLbl",this._getLocalizedLabels("Borderrange"))[0].outerHTML,v=t.buildTag("label#"+this._id+"_borderstyleLbl.e-borderstyleLbl",this._getLocalizedLabels("Borderstyle"))[0].outerHTML,C=t.buildTag("label#"+this._id+"_fStyleLbl.fStyleLbl",this._getLocalizedLabels("Fontstyle"))[0].outerHTML,S=t.buildTag("label#"+this._id+"_fSizeLbl.e-fSizeLbl",this._getLocalizedLabels("Fontsize"))[0].outerHTML,O=t.buildTag("label#"+this._id+"_fontcolorLbl.fontcolorLbl",this._getLocalizedLabels("Fontcolor"))[0].outerHTML,T=t.buildTag("label#"+this._id+"_fValueLbl.fValueLbl",this._getLocalizedLabels("Measures"))[0].outerHTML,y=t.buildTag("input#"+this._id+"_editCon.editconditionDropDown","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,x=t.buildTag("input#"+this._id+"_editConText.editconditionText","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,M=t.buildTag("button#"+this._id+"_editBtn",this._getLocalizedLabels("Edit"),{},{name:this._getLocalizedLabels("Edit")}).attr("title",this._getLocalizedLabels("Edit")).attr("role","button").attr("aria-label","edit")[0].outerHTML,P=t.buildTag("button#"+this._id+"_removeBtn.e-dialogremoveBtn e-icon","",{},{name:this._getLocalizedLabels("Remove")}).attr("title",this._getLocalizedLabels("RemoveFormat")).attr("role","button").attr("aria-label","remove")[0].outerHTML,w=t.buildTag("input#"+this._id+"_conFrom.e-conditionFrom"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:2})[0].outerHTML,L=t.buildTag("input#"+this._id+"_conTo.e-conditionTo"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:3})[0].outerHTML,N=t.buildTag("input#"+this._id+"_backcolor.backcolor","",{},{type:"text",tabindex:4,accesskey:"d"})[0].outerHTML,D=t.buildTag("input#"+this._id+"_bordercolor.bordercolor","",{},{type:"text",tabindex:5,accesskey:"c"})[0].outerHTML,R=t.buildTag("input#"+this._id+"_borderrange.borderrange","",{},{type:"text",tabindex:6,accesskey:"r"})[0].outerHTML,j=t.buildTag("input#"+this._id+"_borderstyle.borderstyle","",{},{type:"text",tabindex:7,accesskey:"s"})[0].outerHTML,I=t.buildTag("input#"+this._id+"_fStyle.fStyle","",{},{type:"text",tabindex:8,accesskey:"o"})[0].outerHTML,F=t.buildTag("input#"+this._id+"_fSize.fSize","",{},{type:"text",tabindex:9,accesskey:"l"})[0].outerHTML,A=t.buildTag("input#"+this._id+"_fontcolor.fontcolor","",{},{type:"text",tabindex:10,accesskey:"b"})[0].outerHTML,E=t.buildTag("input#"+this._id+"_fValue.fValue","",{},{type:"text",tabindex:11,accesskey:"v"})[0].outerHTML;a=t.buildTag("div#"+this._id+"_conditionDlg.e-conditionDlg","<table class='conditionformatTbl'><tr><td>"+c+"</td><td>"+p+"</td><td>"+u+"</td><td>"+(this.model.conditionalFormatSettings.length>0?y:x)+"</td><td>"+M+"</td><td>"+P+"</td></tr><tr><td>"+m+"</td><td>"+w+"</td><td>"+g+"</td><td>"+L+"</td></tr><tr><td>"+C+"</td><td>"+I+"</td><td>"+_+"</td><td>"+R+"</td></tr><tr><td>"+O+"</td><td>"+A+"</td><td>"+v+"</td><td>"+j+"</td></tr><tr><td>"+f+"</td><td>"+N+"</td><td>"+S+"</td><td>"+F+"</td></tr><tr><td>"+b+"</td><td>"+D+"</td><td>"+T+"</td><td>"+E+"</td></tr></table>")[0].outerHTML;var k=t.buildTag("button#"+this._id+"_OKBtn.e-dialogOKBtn","",{},{name:this._getLocalizedLabels("OK")}).attr("title",this._getLocalizedLabels("OK"))[0].outerHTML,H=t.buildTag("button#"+this._id+"_CancelBtn.e-dialogCancelBtn","",{},{name:this._getLocalizedLabels("Cancel")}).attr("title",this._getLocalizedLabels("Cancel"))[0].outerHTML,V=t.buildTag("div",k+H,{float:this.model.enableRTL?"left":"right",margin:"20px 0px 6px"})[0].outerHTML;e("#"+this._id).after(i),e("#"+this._id+"_clientDlg").append(a+V),n=e(this.element).parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient")[0].id:this._id,e("#"+this._id+"_clientDlg").ejDialog({width:"auto",target:"#"+n,enableResize:!1,enableRTL:this.model.enableRTL,close:t.proxy(t.Pivot.closePreventPanel,this)}),e(".e-titlebar").prepend(t.buildTag("div",r,{display:"inline"})[0].outerHTML)[0],e("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn,#"+this._id+"_removeBtn,#"+this._id+"_editBtn").ejButton({type:t.ButtonType.Button}),e("#"+this._id+"_OKBtn,#"+this._id+"_CancelBtn").css({margin:"0 0 0 10px",width:"67px"}),e("#"+this._id+"_removeBtn").css({margin:this.model.enableRTL?"0px":"0 0 0 10px",width:"38px",height:"29px"}),e("#"+this._id+"_editBtn").css({margin:"0 0 0 10px",width:"70px",height:"29px"}),e("#"+this._id+"_conFrom,#"+this._id+"_conTo").css({width:"196px",height:"26px"}),e("#"+this._id+"_conditionDlg").css({margin:"13px 0 0 0"}),e("#"+this._id+"_editcond,#"+this._id+"_value2,#"+this._id+"_fValueLbl,#"+this._id+"_borderrangeLbl,#"+this._id+"_borderstyleLbl,#"+this._id+"_fSizeLbl").css({margin:"0 0 0 15px"}),e("#"+this._id+"_editConText").length>0&&(this._formatEdit=!0),e("#"+this._id+"_editConText").ejMaskEdit({inputMode:t.InputMode.Text,width:"200px",height:"26px"}),e("#"+this._id+"_conTo").attr("disabled","disabled"),this.removeBtn=e("#"+this._id+"_removeBtn").data("ejButton"),o=e("#"+this._id+"_OKBtn").data("ejButton"),s=e("#"+this._id+"_CancelBtn").data("ejButton"),M=e("#"+this._id+"_editBtn").data("ejButton"),this.removeBtn.setModel({enabled:!1}),o.setModel({text:this._getLocalizedLabels("OK")}),s.setModel({text:this._getLocalizedLabels("Cancel")}),e("#"+this._id+"_conType").ejDropDownList({change:"_activeConditionChange",dataSource:[{option:"Less Than",value:this._getLocalizedLabels("LessThan")},{option:"Less Than Or Equal To",value:this._getLocalizedLabels("LessThanOrEqualTo")},{option:"Greater Than",value:this._getLocalizedLabels("GreaterThan")},{option:"Greater Than Or Equal To",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"Equals",value:this._getLocalizedLabels("Equals")},{option:"Not Equals",value:this._getLocalizedLabels("NotEquals")},{option:"Between",value:this._getLocalizedLabels("Between")},{option:"Not Between",value:this._getLocalizedLabels("NotBetween")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_editCon").ejDropDownList({change:"_editConditionChange",dataSource:this._formatName,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_fontcolor").ejColorPicker({enableRTL:this.model.enableRTL}),e("#"+this._id+"_backcolor").ejColorPicker({enableRTL:this.model.enableRTL}),e("#"+this._id+"_bordercolor").ejColorPicker({enableRTL:this.model.enableRTL}),e("#"+this._id+"_borderrange").ejDropDownList({dataSource:["1","2","3","4","5","6","7","8","9"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_borderstyle").ejDropDownList({dataSource:[{option:"Solid",value:this._getLocalizedLabels("Solid")},{option:"Dashed",value:this._getLocalizedLabels("Dashed")},{option:"Dotted",value:this._getLocalizedLabels("Dotted")},{option:"Double",value:this._getLocalizedLabels("Double")},{option:"Groove",value:this._getLocalizedLabels("Groove")},{option:"Inset",value:this._getLocalizedLabels("Inset")},{option:"Outset",value:this._getLocalizedLabels("Outset")},{option:"Ridge",value:this._getLocalizedLabels("Ridge")},{option:"None",value:this._getLocalizedLabels("None")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_fStyle").ejDropDownList({dataSource:[{option:"Algerian",value:this._getLocalizedLabels("Algerian")},{option:"Arial",value:this._getLocalizedLabels("Arial")},{option:"Bodoni MT",value:this._getLocalizedLabels("BodoniMT")},{option:"Britannic Bold",value:this._getLocalizedLabels("BritannicBold")},{option:"Cambria",value:this._getLocalizedLabels("Cambria")},{option:"Calibri",value:this._getLocalizedLabels("Calibri")},{option:"Courier New",value:this._getLocalizedLabels("CourierNew")},{option:"DejaVu Sans",value:this._getLocalizedLabels("DejaVuSans")},{option:"Forte",value:this._getLocalizedLabels("Forte")},{option:"Gerogia",value:this._getLocalizedLabels("Gerogia")},{option:"Impact",value:this._getLocalizedLabels("Impact")},{option:"Segoe UI",value:this._getLocalizedLabels("SegoeUI")},{option:"Tahoma",value:this._getLocalizedLabels("Tahoma")},{option:"Times New Roman",value:this._getLocalizedLabels("TimesNewRoman")},{option:"Verdana",value:this._getLocalizedLabels("Verdana")},{option:"None",value:this._getLocalizedLabels("None")}],fields:{text:"value",value:"option"},selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_fSize").ejDropDownList({dataSource:["12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}});var z,U=[],B=[];if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){if(e(this.element).parents(".e-pivotclient").length>0)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(d=0;d<this._JSONRecords.length;d++)this._JSONRecords[d].Info.indexOf("Measures")>-1&&-1==e.inArray(this._JSONRecords[d].Value,B)&&B.push(this._JSONRecords[d].Value);else B=JSON.parse(this._pivotClientObj.getOlapReport()).PivotCalculations;else B=JSON.parse(this.getOlapReport()).PivotCalculations;z="FieldHeader"}else if(z="fieldCaption",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)B=this.model.dataSource.values;else for(d=0;d<this.model.dataSource.values.length;d++)B=this.model.dataSource.values[d].measures;for(U=B.length>0?["All"]:U,h=0;h<B.length;h++)e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?U.push(B[h]):U.push(B[h][z]);return U=U.length>0?U:["No Measure"],e("#"+this._id+"_fValue").ejDropDownList({dataSource:U,selectedIndices:[0],enableRTL:this.model.enableRTL,width:"200px",height:"30px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e("#"+this._id+"_conType").ejDropDownList("option","change",t.proxy(this._activeConditionChange,this)),e("#"+this._id+"_editCon").ejDropDownList("option","change",t.proxy(this._editConditionChange,this)),this.isNewFormat=!0,this.ddlEditCondition=e("#"+this._id+"_editCon").data("ejDropDownList"),this.ddlConditionType=e("#"+this._id+"_conType").data("ejDropDownList"),this.ddlFont=e("#"+this._id+"_fStyle").data("ejDropDownList"),this.ddlFontSize=e("#"+this._id+"_fSize").data("ejDropDownList"),this.ddlFontColor=e("#"+this._id+"_fontcolor").data("ejColorPicker"),this.ddlBackColor=e("#"+this._id+"_backcolor").data("ejColorPicker"),this.ddlBorderColor=e("#"+this._id+"_bordercolor").data("ejColorPicker"),this.ddlBorderStyle=e("#"+this._id+"_borderstyle").data("ejDropDownList"),this.ddlBorderWidth=e("#"+this._id+"_borderrange").data("ejDropDownList"),this.ddlFieldValue=e("#"+this._id+"_fValue").data("ejDropDownList"),this.element.find("#"+this._id+"_conFrom,#"+this._id+"_conTo").keypress(function(t){return 8==t.which||0==t.which||!(t.which<45||45==t.which&&(""!=t.target.value||t.target.value.indexOf("-")>-1)||t.which>58)&&((46!=t.which||-1==e(this).val().indexOf("."))&&47!=t.which&&void 0)}),e("#"+this._id+"_OKBtn").click(function(){var i,a,r=null,o=!1;if(r=e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):e(this).parents(".e-pivotgrid").data("ejPivotGrid"),!t.isNullOrUndefined(r.ddlEditCondition))for(i=0;i<r.ddlEditCondition.model.dataSource.length;i++)r.ddlEditCondition.model.dataSource[i]==e("#"+r._id+"_editConText").val()&&i!=r.ddlEditCondition.selectedIndexValue&&(o=!0);this.ddlEditCondition=e("#"+r._id+"_editCon").data("ejDropDownList"),a=e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").data("ejPivotClient"):r,""==e("#"+r._id+"_editConText").val()?t.Pivot._createErrorDialog(r._getLocalizedLabels("EnterFormatName"),r._getLocalizedLabels("Warning"),a):r._formatEdit&&e("#"+r._id+"_editConText").val()!=l&&-1!=e.inArray(e("#"+r._id+"_editConText").val(),r._formatName)||!t.isNullOrUndefined(e("#"+r._id+"_editConText").val())&&o?t.Pivot._createErrorDialog(r._getLocalizedLabels("DuplicateFormatName"),r._getLocalizedLabels("Warning"),a):""==e("#"+r._id+"_conFrom").val()?t.Pivot._createErrorDialog(r._getLocalizedLabels("EnterOperand1"),r._getLocalizedLabels("Warning"),a):e("#"+r._id+"_conTo").attr("disabled")||""!=e("#"+r._id+"_conTo").val()?e("#"+r._id+"_fValue").attr("disabled")&&"No Measure"==e("#"+r._id+"_fValue").val()?t.Pivot._createErrorDialog(r._getLocalizedLabels("NoMeasure"),r._getLocalizedLabels("Warning"),a):(r._applyFormatting(),t.Pivot.closePreventPanel(r)):t.Pivot._createErrorDialog(r._getLocalizedLabels("EnterOperand2"),r._getLocalizedLabels("Warning"),a)}),this.ddlEditCondition!=l&&(this.ddlEditCondition.getListData().length>1?e("#"+this._id+"_editCon").ejDropDownList("enable"):(e("#"+this._id+"_editCon").ejDropDownList("disable"),e("#"+this._id+"_editcond").css("color","#cbcbcb"))),1==this.ddlFieldValue.getListData().length&&"No Measure"==this.ddlFieldValue._selectedValue?(e("#"+this._id+"_fValue").ejDropDownList("disable"),e("#"+this._id+"_fValueLbl").css("color","#cbcbcb")):e("#"+this._id+"_fValue").ejDropDownList("enable"),this.model.conditionalFormatSettings.length>0&&(this.ddlEditCondition.selectItemByValue(this.model.conditionalFormatSettings[this.model.conditionalFormatSettings.length-1].name),this._editConditionChange()),e("#"+this._id+"_removeBtn").click(function(){var t,i,l=null;(l=e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):e(this).parents(".e-pivotgrid").data("ejPivotGrid")).removeBtn.option("enabled")&&(1==(t=confirm(l._getLocalizedLabels("ConditionalFormattingConformMsg")))&&(i=l.ddlEditCondition._selectedIndices[0],l._removeCellFormatting(i,t),e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-dialog, .clientDialog").remove():l.element.find(".e-dialog, .clientDialog").remove()))}),e("#"+this._id+"_CancelBtn").click(function(){var i=null;e(this).parents(".e-pivotclient").length>0?(i=e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"),e(this).parents(".e-pivotclient").find(".e-dialog, .e-clientDialog").remove()):i=e(this).parents(".e-pivotgrid").data("ejPivotGrid"),i.element.find(".e-dialog, .e-clientDialog").remove(),t.Pivot.closePreventPanel(i)}),e("#"+this._id+"_editBtn").click(function(){(e(this).parents(".e-pivotclient").length>0?e(this).parents(".e-pivotclient").find(".e-pivotgrid").data("ejPivotGrid"):e(this).parents(".e-pivotgrid").data("ejPivotGrid"))._editBtnAdd()}),!1},_editBtnAdd:function(){var i,a;0==e("#"+this._id+"_editConText").length&&(this._formatEdit=!0,i=t.buildTag("input#"+this._id+"_editConText.editconditionText","",{},{type:"text",tabindex:1,accesskey:"e"})[0].outerHTML,e(e(".editconditionDropDown").parents("td")[0]).before("<td>"+i+"</td>"),e(e(".editconditionDropDown").parents("td")[0]).css("display","none"),a=this.ddlEditCondition!=l&&this.ddlEditCondition.selectedTextValue!=l&&this.ddlEditCondition.selectedTextValue!=this._getLocalizedLabels("AddNew")?this.ddlEditCondition.selectedTextValue:"",this._formatEdit=this.ddlEditCondition!=l&&this.ddlEditCondition.selectedTextValue!=l&&this.ddlEditCondition.selectedTextValue==this._getLocalizedLabels("AddNew"),e("#"+this._id+"_editConText").ejMaskEdit({inputMode:t.InputMode.Text,value:a,width:"200px",height:"26px"}))},_activeConditionChange:function(t){"Between"==t.selectedValue||"Not Between"==t.selectedValue?e("#"+this._id+"_conTo").removeAttr("disabled"):(e("#"+this._id+"_conTo").attr("disabled","disabled"),e("#"+this._id+"_conTo").val(""))},_editConditionChange:function(){if(this.ddlEditCondition._selectedIndices[0]>0){var t=this.ddlEditCondition._selectedIndices[0]-1,i=this._cFormat[t].split(",");this.ddlConditionType.selectItemByValue(i[1]),e("#"+this._id+"_conFrom").val(i[9]),"undefined"!=i[9]&&"undefined"!=i[10]&&e("#"+this._id+"_conTo").val(i[10]),e("#"+this._id+"_fontcolor").ejColorPicker({value:i[2]}),e("#"+this._id+"_backcolor").ejColorPicker({value:i[3]}),e("#"+this._id+"_bordercolor").ejColorPicker({value:i[4]}),this.ddlBorderStyle.selectItemByValue(i[8]),this.ddlBorderWidth.selectItemByValue(i[5]),this.ddlFont.selectItemByValue(i[6]),this.ddlFontSize.selectItemByValue(i[7]),this.ddlFieldValue.selectItemByValue(i[11]),this.removeBtn.option("enabled",!0),this._conditionTypeChange()}else this._editBtnAdd(),this.removeBtn.option("enabled",!1),this._clearWindow()},_clearWindow:function(){e("#"+this._id+"_clientDlg").find("#"+this._id+"_conFrom,#"+this._id+"_conTo").val(""),e("#"+this._id+"_conTo").disabled=!0},_conditionTypeChange:function(){e("#"+this._id+"_conTo").disabled=!(4==this.ddlConditionType._selectedIndices[0]||5==this.ddlConditionType._selectedIndices[0])},_removeCellFormatting:function(e,t){for(var i,l=e,a=0;a<this._cFormat.length&&e;a++)for(t&&(a=e-1,e=0),i=0;i<this._JSONRecords.length;i++)this._JSONRecords[i].CSS=this._JSONRecords[i].CSS.replace(" "+this._cFormat[a].split(",")[0].replace(/ /g,""),"");t?(this._cFormat.splice(l-1,1),this._list.splice(l-1,1),this.model.conditionalFormatSettings.splice(l-1,1),this._formatName.splice(l,1)):(this._cFormat=[],this._list=[],this.model.conditionalFormatSettings=[],this._formatName=[this._getLocalizedLabels("AddNew")]),this.renderControlFromJSON()},_applyStyle:function(i,l,a,r,o,s,n,d,h){var c,p,u=l.CSS,m="rows"==i?l.Index.split(",")[1]:"columns"==i?l.Index.split(",")[0]:null;h=h.replace(/ /g,""),(l.Value==a||"All"==a)&&-1==e.inArray(Number(m),r)&&r.push(Number(m)),p=1==e.isNumeric(l.Value)?l.Value:e.isNumeric(t.globalize.parseFloat(t.globalize.format(l.Value,"c",this.model.locale),this.model.locale))?t.globalize.parseFloat(t.globalize.format(l.Value,"c",this.model.locale),this.model.locale):l.Value.replace(/[^\d.\-]/g,""),c=-1!=e.inArray(Number(m),r),this._getResult(Number(o),Number(s),p,n)&&!t.isNullOrUndefined(p)&&e.isNumeric(p)&&c&&-1!=l.CSS.indexOf("value")&&(l.CSS=u+" "+h)},_refreshCellFormatting:function(e){for(var t,i,l,a=this._getAxis(),r=0;r<this._cFormat.length;r++)for(t=[],i=this._cFormat[r].split(","),l=0;l<e.length;l++)-1===e[l].CSS.indexOf(i[0].replace(/ /g,""))&&this._applyStyle(a,e[l],i[11],t,i[9],i[10],i[1],l,this._cFormat[r].split(",")[0].replace(/ /g,""));return e},_createDynamicRule:function(e,t,i,l,a,r,o,s){var n="color: "+e+"!important;background-color: "+t+" !important;border:"+i+" "+l+"px "+a+" !important;font:"+r+"px "+o+" !important;";(function(){var e=document.createElement("style");return e.appendChild(document.createTextNode("")),document.head.appendChild(e),e.sheet})().insertRule("."+s.replace(/ /g,"")+"{"+n+"}",0)},_getMDXAxis:function(){for(var e="",i=0;i<this._JSONRecords.length;i++)if(!t.isNullOrUndefined(this._JSONRecords[i].Info)&&this._JSONRecords[i].Info.toLowerCase().indexOf("measures")>-1){e=this._JSONRecords[i].CSS.indexOf("colheader")>-1?"columns":this._JSONRecords[i].CSS.indexOf("rowheader")>-1?"rows":"";break}return e},_getAxis:function(){var i,a,r;if(e(this.element).parents(".e-pivotclient").length>0&&("undefined"!=typeof pivotGridObj&&this.element.hasClass("e-pivotgrid")&&(pivotGridObj=this),this._pivotClientObj.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.setOlapReport(e(this.element).parents(".e-pivotclient").data("ejPivotClient").model.dataSource)),this.getOlapReport())if(i=null,a="",this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(this.getOlapReport()!=l&&""!=this.getOlapReport()&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0&&(i=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader),r=0;r<this._JSONRecords.length;r++)if(this._JSONRecords[r].Value==i){a=this._JSONRecords[r].CSS.indexOf("colheader")>-1?"columns":this._JSONRecords[r].CSS.indexOf("rowheader")>-1?"rows":"";break}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)a="columns";else for(r=0;r<this.getOlapReport().values.length;r++)a=this.getOlapReport().values[r].axis;return""==a&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(a=this._getMDXAxis()),a},_applyCodeBehindFormatting:function(i){var l,a,r,o,s,n,d,h;if(this._isFormatApply=!0,a=this._getAxis(),!t.isNullOrUndefined(this.model.conditionalFormatSettings))for(r=0;r<this.model.conditionalFormatSettings.length;r++)if(o=[],o=this.model.conditionalFormatSettings[r].measures.split(","),-1==e.inArray(this.model.conditionalFormatSettings[r].name,this._formatName)){for(this.model.conditionalFormatSettings[r].className=this._id+"_"+this.model.conditionalFormatSettings[r].name.trim().toLowerCase(),s=0;s<o.length;s++)for(n=[],l=o[s],d=0;d<i.length;d++)this._applyStyle(a,i[d],l,n,t.isNullOrUndefined(this.model.conditionalFormatSettings[r].value.split(",")[0])?"":this.model.conditionalFormatSettings[r].value.split(",")[0],t.isNullOrUndefined(this.model.conditionalFormatSettings[r].value.split(",")[1])?"":this.model.conditionalFormatSettings[r].value.split(",")[1],this.model.conditionalFormatSettings[r].condition,d,this.model.conditionalFormatSettings[r].className);h=this.model.conditionalFormatSettings[r].className+","+this.model.conditionalFormatSettings[r].condition+","+this.model.conditionalFormatSettings[r].style.color+","+this.model.conditionalFormatSettings[r].style.backgroundcolor+","+this.model.conditionalFormatSettings[r].style.bordercolor+","+this.model.conditionalFormatSettings[r].style.borderwidth+","+this.model.conditionalFormatSettings[r].style.fontstyle+","+this.model.conditionalFormatSettings[r].style.fontsize+","+this.model.conditionalFormatSettings[r].style.borderstyle+","+this.model.conditionalFormatSettings[r].value.split(",")[0]+","+this.model.conditionalFormatSettings[r].value.split(",")[1]+","+l,this._cFormat.push(h),this._list.push(this.model.conditionalFormatSettings[r].className),this._formatName.push(this.model.conditionalFormatSettings[r].name),this._createDynamicRule(this.model.conditionalFormatSettings[r].style.color,this.model.conditionalFormatSettings[r].style.backgroundcolor,this.model.conditionalFormatSettings[r].style.borderstyle,this.model.conditionalFormatSettings[r].style.borderwidth,this.model.conditionalFormatSettings[r].style.bordercolor,this.model.conditionalFormatSettings[r].style.fontsize,this.model.conditionalFormatSettings[r].style.fontstyle,this.model.conditionalFormatSettings[r].className)}return this._JSONRecords=i,i},_applyFormatting:function(){var i,a;this._isFormatApply=!0;var r,o,s,n,d,h,c,p,u,m,g,f,b=[],_=e("#"+this._id+"_editConText").val();if(t.isNullOrUndefined(e("#"+this._id+"_conFrom").val())||(this._formatValue1=e("#"+this._id+"_conFrom").val(),this._formatValue2=e("#"+this._id+"_conTo").val(),this.ddlConditionType._selectedValue,h=this.ddlFontColor.model.value,c=this.ddlBackColor.model.value,p=this.ddlBorderColor.model.value,u=this.ddlBorderWidth._selectedValue,m=this.ddlFont._selectedValue,g=this.ddlFontSize._selectedValue,f=this.ddlBorderStyle._selectedValue),n=this.ddlFieldValue._selectedValue!=l?this.ddlFieldValue._selectedValue:"",e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(a=0;a<this._JSONRecords.length&&(this._JSONRecords[a].Info.indexOf("Measures")>-1&&(d="colheader"==this._JSONRecords[a].CSS?"columns":"rowheader"==this._JSONRecords[a].CSS?"rows":""),""==d);a++);else for(field=JSON.parse(this.getOlapReport()).PivotCalculations[0].FieldHeader,a=0;a<this._JSONRecords.length;a++)if(this._JSONRecords[a].Value==field){d="colheader calc"==this._JSONRecords[a].CSS?"columns":"rowheader"==this._JSONRecords[a].CSS?"rows":"";break}}else d=this._getAxis();if(this._formatEdit)r=(o=this._id+"_"+_.trim().toLowerCase())+","+this.ddlConditionType._selectedValue+","+h+","+c+","+p+","+u+","+m+","+g+","+f+","+this._formatValue1+","+this._formatValue2+","+n,this._cFormat.push(r),this._list.push(o),this._formatName.push(_),i={name:_,style:{fontcolor:h,backgroundcolor:c,bordercolor:p,borderstyle:f,borderwidth:u,fontsize:g,fontstyle:m},condition:this.ddlConditionType._selectedValue,value:this._formatValue1+","+this._formatValue2,measures:n,className:o},this.model.conditionalFormatSettings.push(i);else for(_=""!=_&&_!=l?_:this.ddlEditCondition._selectedValue,s=this.ddlEditCondition._selectedIndices[0]-1,this._formatName[s+1]=_,o=this.model.conditionalFormatSettings[s].className,this._cFormat[s]=o+","+this.ddlConditionType._selectedValue+","+h+","+c+","+p+","+u+","+m+","+g+","+f+","+this._formatValue1+","+this._formatValue2+","+n,i={name:_,style:{fontcolor:h,backgroundcolor:c,bordercolor:p,borderstyle:f,borderwidth:u,fontsize:g,fontstyle:m},condition:this.ddlConditionType._selectedValue,value:this._formatValue1+","+this._formatValue2,measures:n,className:o},this.model.conditionalFormatSettings[s]=i,a=0;a<this._JSONRecords.length;a++)this._JSONRecords[a].CSS=this._JSONRecords[a].CSS.replace(" "+o,"");for(a=0;a<this._JSONRecords.length;a++)this._applyStyle(d,this._JSONRecords[a],n,b,this._formatValue1,this._formatValue2,this.ddlConditionType._selectedValue,a,o);this._createDynamicRule(h,c,f,u,p,g,m,o),this.renderControlFromJSON(),e(this.element).parents(".e-pivotclient").length>0&&e(this.element).parents(".e-pivotclient").find(".e-dialog, .e-clientDialog").remove(),this.element.find(".e-dialog, .e-clientDialog").remove(),this._formatEdit=!1},_getResult:function(e,t,i,l){switch(l){case"Less Than":return i<e;case"Less Than Or Equal To":if(i<=e)return i;break;case"Greater Than":return i>e;case"Greater Than Or Equal To":if(i>=e)return i;break;case"Equals":if(i==e)return i;break;case"Not Equals":return i!=e;case"Between":return e<t&&i>e&&i<t||e>t&&i<e&&i>t||i==e&&i==t;case"Not Between":return!(e<t&&i>e&&i<t||e>t&&i<e&&i>t||i==e&&i==t)}},_appendCssClassName:function(e){var i,l,a,r,o,s,n,d,h,c,p=!0,u=l=i=!1,m=!1,g=a=-1;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){for(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(r="FieldHeader",o="CssClass",s=JSON.parse(this.getOlapReport()).PivotRows,n=JSON.parse(this.getOlapReport()).PivotColumns,d=JSON.parse(this.getOlapReport()).PivotCalculations):(r="fieldCaption",o="cssClass",s=this.model.dataSource.rows,n=this.model.dataSource.columns,d=this.model.dataSource.values),c=0;c<s.length&&!u;c++)t.isNullOrUndefined(s[c].cssClass)||(u=!0);for(c=0;c<n.length&&!l;c++)t.isNullOrUndefined(n[c].cssClass)||(l=!0);for(c=0;c<d.length&&!i;c++)t.isNullOrUndefined(d[c].cssClass)||(i=!0);for(h=0;h<e.length&&(u||l||i);h++){for(c=0;c<s.length&&p&&u;c++)t.isNullOrUndefined(s[c][o])||Number(e[h].Index.split(",")[0])!=c||-1!=e[h].CSS.indexOf("none")||-1!=e[h].CSS.indexOf(s[c][o])||(e[h].CSS=e[h].CSS+" "+s[c][o]),p&&e[h].CSS.indexOf("colheader")>-1&&(p=!1);for(c=0;c<n.length&&l;c++)t.isNullOrUndefined(n[c][o])||Number(e[h].Index.split(",")[1])!=c||-1!=e[h].CSS.indexOf("none")||-1!=e[h].CSS.indexOf(n[c][o])||(e[h].CSS=e[h].CSS+" "+n[c][o]);for(c=0;c<d.length&&i;c++)m&&(e[h].CSS.indexOf("colheader")>-1||e[h].CSS.indexOf("cgtot")>-1||e[h].CSS.indexOf("cstot")>-1||e[h].CSS.indexOf("gtot")>-1||e[h].CSS.indexOf("stot")>-1)&&-1==e[h].CSS.indexOf("calc")&&(m=!1),d[c][r]==e[h].Value&&(m=!0,g=e[h].Index.split(",")[0],a=c),!t.isNullOrUndefined(d[c][o])&&m&&g==e[h].Index.split(",")[0]&&a==c&&-1==e[h].CSS.indexOf(d[c][o])&&(e[h].CSS=e[h].CSS+" "+d[c][o])}}return e},_updateReportSettings:function(i){var l=e.map(i,function(e){var t=e.Key;if("JsonRecords"==t||"PivotRecords"==t)return e}),a=e.map(i,function(e){var t=e.Key;if("PivotReport"==t||"OlapReport"==t)return e}),r=e.map(i,function(e){if("SortColIndex"==e.Key)return e});this.setJSONRecords(l.length>0?l[0].Value:null),this.setOlapReport(a[0].Value),r.length>0?(t.PivotAnalysis._valueSorting=JSON.parse(r[0].Value),t.PivotAnalysis._sort=this.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null},_updatePageSettings:function(t,i){var l=e.map(t,function(e){if("PageSettings"==e.Key)return e}),a=e.map(t,function(e){if("HeaderCounts"==e.Key)return e});l.length>0&&null!=i._pagerObj&&(i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(JSON.parse(a[0].Value),JSON.parse(l[0].Value)))},_removeCells:function(i){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y=[],x=[];if(i[0]!=l&&i.length>0?(a=e.map(i,function(e){if("FilteredColumnHeaders"==e.Key)return e}),r=e.map(i,function(e){if("FilteredRowHeaders"==e.Key)return e}),a.length>0&&(y=JSON.parse(a[0].Value)),r.length>0&&(x=JSON.parse(r[0].Value))):i.d!=l?(a=e.map(i.d,function(e){if("FilteredColumnHeaders"==e.Key)return e}),r=e.map(i.d,function(e){if("FilteredRowHeaders"==e.Key)return e}),a.length>0&&(y=JSON.parse(a[0].Value)),r.length>0&&(x=JSON.parse(r[0].Value))):(i.FilteredColumnHeaders&&(y=JSON.parse(i.FilteredColumnHeaders)),i.FilteredRowHeaders&&(x=JSON.parse(i.FilteredRowHeaders))),y.length>0){for(w=y,f=0;f<w.length;f++)for(b=w[f].From;b<=w[f].To;b++)for(p=w[f].Level;p<this._rowCount;p++)this.element.find(".e-pivotGridTable  [data-p='"+b+","+p+"']").remove();for(o=(r=this.element.find(".e-pivotGridTable thead").children()).length-2;o>=0;o--)for(s=e(r[o]).find("th.colheader:visible"),n=0;n<=s.length-1;n++){for(d=e(s[n]).attr("colSpan"),p=0;p<=parseInt(e(s[n]).attr("colSpan"))-1;p++)h=parseInt(e(s[n]).attr("data-p").split(",")[0])+p,c=this.element.find(".e-pivotGridTable  [data-p='"+h+","+(o+1)+"']:visible"),e(c).length>0?d=parseInt(d)+(e(c).attr("colspan")?parseInt(e(c).attr("colspan"))-1:0):d--;if(0==d&&e(s[n]).nextAll(".summary.stot:eq(0)").length>0){var M=e(s[n]).nextAll(".summary.stot:eq(0)").attr("data-p").split(",")[0],P=[],w=[];for(p=0;p<this._rowCount;p++){if(u="[data-p='"+parseInt(M)+","+p+"'] ",w.push(u),this._JSONRecords[parseInt(M)*this._rowCount+p].ColSpan>1&&this.element.find(".e-pivotGridTable [data-p='"+parseInt(M)+","+p+"']:visible").length>0)for(m=1;m<=this._JSONRecords[parseInt(M)*this._rowCount+p].ColSpan-1;m++)P.push(parseInt(M)+m);for(hc=0;hc<P.length;hc++)u+=", [data-p='"+P[hc]+","+p+"'] ";this.element.find(".e-pivotGridTable "+u).remove()}}t.isNullOrUndefined(e(s[n]).attr("vfColSpan"))&&e(s[n]).attr("vfColSpan",e(s[n]).attr("colSpan")),e(s[n]).attr("colSpan",d)}this.element.find(".colheader[colspan='0']:not(.gtot,.calc)").remove()}if(x.length>0){for(w=x,g=parseInt(this.element.find(".e-pivotGridTable td:eq(0)").attr("data-p").split(",")[0])-2,f=0;f<w.length;f++)for(b=w[f].From;b<=w[f].To;b++)this.element.find(".e-pivotGridTable tr:eq("+b+") th:last").css("display","none"),this.element.find(".e-pivotGridTable tr:eq("+b+") td").css("display","none");for(T=g;T>=0;T--)for(_=this.element.find(".e-pivotGridTable tbody").find(" .rowheader[data-p^='"+T+",'] :visible"),v=this.element.find(".e-pivotGridTable th.rowheader").parent(),C=0;C<=_.length;C++){var L=e(_[C]).parent(),N=parseInt(L.attr("rowSpan")),D=L.attr("data-p");if(D){var R=parseInt(D.split(",")[1]),j=(parseInt(D.split(",")[0]),0);for(S=R;S<=R+N;S++)(O=v.children(" [data-p='"+(T+1)+","+S+"']")).length>0&&!O.is(":visible")&&(j=j+parseInt(O.attr("rowSpan"))+(O.next("th.rowheader").length>0||parseInt(O.attr("rowSpan"))>1?1:0));j==N&&L.css("display","none")}}for(T=0;T<e(this.element.find(".summary.stot")).length;T++)""==e(this.element.find(".summary.stot")[T]).nextAll().text()&&(e(this.element.find(".summary.stot")[T]).css("display","none"),e(this.element.find(".summary.stot")[T]).nextAll().css("display","none"))}this.model.enableGroupingBar&&this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())},saveXMLReport:function(e,t){var i={clientReports:JSON.parse(this.getOlapReport()).Report,fileName:e};this.doPostBack(t,i)},_reportModelUpdate:function(i){t.isNullOrUndefined(i)||(this.model.enableGrandTotal=i.ShowGrandTotals,this.model.enableCollapseByDefault=i.enableCollapseByDefault,i.ShowSubTotals||(e.each(i.PivotRows,function(e,t){t.showSubTotal=!1}),e.each(i.PivotColumns,function(e,t){t.showSubTotal=!1})),this.setOlapReport(JSON.stringify(i)),this.model.enableColumnResizing=i.AllowResizeColumns,this.model.resizeColumnsToFit=i.ResizePivotGridToFit,this.model.enableCellSelection=i.AllowSelection,this.model.enableDeferUpdate=i.DeferLayoutUpdate,this.model.frozenHeaderSettings.enableFrozenHeaders=i.FreezeHeaders,this.model.enableGroupingBar=i.ShowGroupingBar,this.model.enablePivotFieldList=i.ShowFieldList,this.model.collapsedMembers={},this.model._isXMLImport=!1)},_renderControlSuccess:function(i){var a,r,o,s,n,d,h,c,p,u,m;try{if(i[0]!=l&&i.length>0?(this._updateReportSettings(i),null!=i[2]&&i[2]!=l&&("PageSettings"==i[2].Key&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[3].Value).Column/JSON.parse(i[2].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[3].Value).Row/JSON.parse(i[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[2].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i[2].Value).SeriesPageSize):null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&null!=this._pagerObj&&this._pagerObj.initPagerProperties(JSON.parse(i[3].Value),JSON.parse(i[2].Value)),t.isNullOrUndefined(i[4])||("DataSet"==i[4].Key?(this._dataSet=i[4].Value,t.isNullOrUndefined(i[5])||(this.model.customObject=i[5].Value)):this.model.customObject=i[4].Value))),t.isNullOrUndefined(i[2])||("DataSet"==i[2].Key?(this._dataSet=i[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i[3].Value)):this.model.customObject=i[2].Value),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._updatePageSettings(i,this._pivotClientObj)):i.d!=l&&i.d.length>0?(this._updateReportSettings(i.d),null!=i.d[2]&&i.d[2]!=l?"PageSettings"==i.d[2].Key&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[3].Value).Column/JSON.parse(i.d[2].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[3].Value).Row/JSON.parse(i.d[2].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[2].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[2].Value).SeriesCurrentPage):null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this._pagerObj.initPagerProperties(JSON.parse(i.d[3].Value),JSON.parse(i.d[2].Value)),t.isNullOrUndefined(i.d[4])||("DataSet"==i.d[4].Key?(this._dataSet=i.d[4].Value,t.isNullOrUndefined(i.d[5])||(this.model.customObject=i.d[5].Value)):this.model.customObject=i.d[4].Value),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._updatePageSettings(i.d,this._pivotClientObj)):t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||2!=i.d.length||(this._pivotClientObj._pagerObj.element.css("opacity","0.5"),this._pivotClientObj._pagerObj.element.find(".e-pagerTextBox").attr("disabled","disabled"),this._pivotClientObj._pagerObj._unwireEvents()),t.isNullOrUndefined(i[2])||"PageSettings"==i.d[2].Key||("DataSet"==i.d[2].Key?(this._dataSet=i.d[2].Value,t.isNullOrUndefined([3])||(this.model.customObject=i.d[3].Value)):this.model.customObject=i.d[2].Value)):!t.isNullOrUndefined(i)&&t.isNullOrUndefined(i.d)&&(i.SortColIndex!=l?(t.PivotAnalysis._valueSorting=JSON.parse(i.SortColIndex)[0],t.PivotAnalysis._sort=this.model.valueSortSettings.sortOrder):t.PivotAnalysis._valueSorting=null,i.PivotRecords!=l?(this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),i.HeaderCounts!=l&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling)?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):i.HeaderCounts!=l&&null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l?this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings)):i.HeaderCounts==l||t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))):i.JsonRecords!=l&&1==this.model.enableJSONRendering?(this.setJSONRecords(JSON.stringify(i.JsonRecords)),this.setOlapReport(JSON.stringify(i.PivotReport)),null!=i.DataSet&&(this._dataSet=i.DataSet)):i.JsonRecords!=l?(this.setJSONRecords(i.JsonRecords),this.setOlapReport(i.PivotReport),null!=i.DataSet&&(this._dataSet=i.DataSet)):i.JsonRecords==l&&(this.setJSONRecords(null),i.PivotReport&&this.setOlapReport(i.PivotReport),i.OlapReport&&this.setOlapReport(i.OlapReport)),i.isXMLLoad!=l&&(this.model._isXMLImport=i.isXMLLoad),null!=i.customObject&&i.customObject!=l&&(this.model.customObject=i.customObject)),t.isNullOrUndefined(this.getJSONRecords())&&!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enablePaging&&(a={CategoricalCurrentPage:1,CategoricalPageSize:1,SeriesCurrentPage:1,SeriesPageSize:1},r={Column:1,Row:1},this._pivotClientObj._pagerObj.initPagerProperties(r,a)),(this.model.enableVirtualScrolling||null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l)&&this.layout("nosummaries"),this.getOlapReport()!=l&&""!=this.getOlapReport()&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode)try{t.isNullOrUndefined(JSON.parse(this.getOlapReport()).DataModel)||(this.model.analysisMode="Olap"==JSON.parse(this.getOlapReport()).DataModel?t.Pivot.AnalysisMode.Olap:t.Pivot.AnalysisMode.Pivot),!t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PagerOptions)&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.enablePaging||this.model.enableVirtualScrolling)&&(this._categPageCount=this.model.enablePaging?JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageCount:Math.ceil(JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageCount/JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageSize),this._seriesPageCount=this.model.enablePaging?JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageCount:Math.ceil(JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageCount/JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageSize),this.model.dataSource.pagerOptions.categoricalPageSize=JSON.parse(this.getOlapReport()).PagerOptions.CategoricalPageSize,this.model.dataSource.pagerOptions.seriesPageSize=JSON.parse(this.getOlapReport()).PagerOptions.SeriesPageSize,this.model.dataSource.pagerOptions.categoricalCurrentPage=JSON.parse(this.getOlapReport()).PagerOptions.CategoricalCurrentPage,this.model.dataSource.pagerOptions.seriesCurrentPage=JSON.parse(this.getOlapReport()).PagerOptions.SeriesCurrentPage),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&null!=this._pagerObj&&(o=this,s=setInterval(function(){clearInterval(s);var e={CategoricalCurrentPage:o.model.dataSource.pagerOptions.categoricalCurrentPage,CategoricalPageSize:o.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:o.model.dataSource.pagerOptions.seriesCurrentPage,SeriesPageSize:o.model.dataSource.pagerOptions.seriesPageSize},t={Column:o._categPageCount,Row:o._seriesPageCount};o._pagerObj.element.css("opacity","1"),o._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),o._pagerObj._unwireEvents(),o._pagerObj._wireEvents(),o._pagerObj.initPagerProperties(t,e)},10))}catch(e){}if(i.isXMLLoad!=l&&i.isXMLLoad&&this._reportModelUpdate(t.isNullOrUndefined(this.getOlapReport())?null:JSON.parse(this.getOlapReport())),1==this.model.enableGroupingBar&&(c=JSON.parse(this.getOlapReport()),n=t.isNullOrUndefined(c.ItemsProperties)?[]:JSON.parse(c.ItemsProperties),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(d=c.PivotRows.concat(c.PivotColumns,c.PivotCalculations,c.Filters),h=e.grep(n,function(t){return e.grep(d,function(e){t.id==(e.FieldHeader||e.DimensionHeader)&&(t.id=e.FieldName||e.DimensionName)}),t}),this._pivotTableFields=h):this._pivotTableFields=n,this._createGroupingBar(c)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)for(c=JSON.parse(this.getOlapReport()),p=0;p<c.PivotCalculations.length;p++)(8==c.PivotCalculations[p].CalculationType||"Formula"==c.PivotCalculations[p].CalculationType)&&0==e.grep(this._calculatedField,function(e){return e.name==c.PivotCalculations[p].FieldName}).length&&this._calculatedField.push({name:c.PivotCalculations[p].FieldName,formula:c.PivotCalculations[p].Formula});null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),null!=this.getJSONRecords()&&this.getJSONRecords().length>0?this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&0==this.model.enableVirtualScrolling&&null==e(".e-pivotpager")[0]?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords()):this.renderControlFromJSON(""),u=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,t.isNullOrUndefined(u)||(u._isTimeOut=!1),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup?this._waitingPopup.hide():e("#"+this._pivotClientObj._id+"_maxView")[0]&&this._maxViewLoading?this._maxViewLoading.hide():this._pivotClientObj._waitingPopup.hide(),t.isNullOrUndefined(this._schemaData)||this._schemaData.element.find(".schemaNoClick").removeClass("freeze").removeAttr("style"),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&null!=this._schemaData&&this._schemaButtonCreate(),m={action:"initialize",customObject:this.model.customObject,element:this.element},this._trigger("renderSuccess",m),t.isNullOrUndefined(i.Exception)||t.Pivot._createErrorDialog(i,"Exception",this),this.model.enableAdvancedFilter&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._removeCells(i)}catch(e){}},_hideGrandTotal:function(i){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_=i.find(".pivotGridFrozenTable");if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this.model.enableRowGrandTotal&&this.model.enableGrandTotal||((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders)&&i.find(".valueCell tr:last,.rowhead tr:last").hide(),i.find("tbody").children().length>0&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?i.find("tr:last .gtot").parent().hide():i.find("tr:last .rgtot").parent().hide())),!(i.find("tr:first th.summary").attr("data-p")==l&&i.find(".pivotGridFrozenTable tr:first td.summary").attr("data-p")==l||this.model.enableColumnGrandTotal&&this.model.enableGrandTotal||this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot))for(a=[],a=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?_.find(".gtot[role^='columnheader']"):_.find(".cgtot[role^='columnheader']"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i.find("th.gtot[role^='columnheader']"):i.find("th.cgtot[role^='columnheader']"),r=0;r<a.length;r++)i.find('[data-p^="'+parseInt(e(a[r]).attr("data-p").split(",")[0])+',"]').hide(),i.find('[data-p^="'+parseInt(e(a[r]).attr("data-p").split(",")[0])+',"]').hide()}else if(o=!0,s=0,this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.analysisMode==t.Pivot.AnalysisMode.Olap){if((!this.model.enableColumnGrandTotal||!this.model.enableGrandTotal)&&((d=e(i).find("thead tr").length||e(i).find(".pivotGridFrozenTable tr").length)>1||1==d&&e(i).find("th.summary[data-p$=',"+s+"']").length>0)){for(;o;)(n=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?e(i).find("td.summary[data-p$=',"+s+"']"):e(i).find("th.summary[data-p$=',"+s+"']")).length&&(o=!1),s++;for(m=0;m<n.length;m++){var v=s,C=n[m],S=e(C).attr("data-p"),O=parseInt(S.split(",")[1])-1,T=e(C).attr("colspan");e(i).find("thead tr").length,e(i).find("tbody tr").length;for(h=0;h<parseInt(T);h++)e(i).find(" [data-p^='"+(parseInt(S.split(",")[0])+h)+",']").css("display","none");for(c=0;c<d;c++)this.model.frozenHeaderSettings.enableFrozenHeaders?1==e(_).find("tr:eq("+c+") td").length&&(p=e(_).find(" tr:eq("+c+") td").attr("colspan"),e(_).find(" tr:eq("+c+") td").attr("colspan",parseInt(p)-parseInt(T))):1==e(i).find("thead tr:eq("+c+") th").length&&(p=e(i).find("thead tr:eq("+c+") th").attr("colspan"),e(i).find("thead tr:eq("+c+") th").attr("colspan",parseInt(p)-parseInt(T)));if(O>=0)for(f=e(i).find(" [data-p^='"+S.split(",")[0]+","+O+"']")[0];v>1;){if(t.isNullOrUndefined(f))for(O=parseInt(S.split(",")[1])-1;O>=0;O--){if(b=e(i).find("[data-p='"+S.split(",")[0]+","+O+"']")[0],t.isNullOrUndefined(b))for(k=parseInt(S.split(",")[0])-1;k>=0;k--)t.isNullOrUndefined(b)&&(b=e(i).find("[data-p='"+k+","+O+"']")[0]);!t.isNullOrUndefined(b)&&"none"!=e(b).css("display")&&"none"!=e(e(b).parents("tr")[0]).css("display")&&(e(b).hasClass("rowheader")||"rowheader"==e(b).attr("role")||e(b).hasClass("colheader")||"columnheader"==e(b).attr("role")||e(b).hasClass("value")||"gridcell"==e(b).attr("role"))&&(f=b),set_spn=parseInt(e(b).attr("colspan"))-parseInt(T),e(b).attr("colspan",set_spn)}t.isNullOrUndefined(b)||v--}}}if(o=!0,s=0,n="",!this.model.enableRowGrandTotal||!this.model.enableGrandTotal){if(u=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,(d=e(i).find("tbody tr").length)>1||1==d&&"summary"==e(i).find(u?"":"th[data-p^='"+s+",']"))for(d=e(i).find("tbody tr").length;o;)(n=u?e(i).find("td.summary[data-p^='"+s+",']"):e(i).find("th.summary[data-p^='"+s+",']")).length&&(o=!1),s++;if(d>0)for(m=0;m<n.length;m++){v=s,C=n[m],S=e(C).attr("data-p"),O=parseInt(S.split(",")[0])-1;var y=e(C).attr("rowspan"),x=e(C).parent();for(g=0;g<C.rowSpan;g++)e(x).css("display","none"),u&&e(i).find(".pivotGridValueTable tr:eq("+e(x).index()+")").css("display","none"),x=e(x).next();if(O>=0)for(f=e(i).find(" [data-p^='"+O+","+S.split(",")[1]+"']")[0];v>1;){if(t.isNullOrUndefined(f))for(O=parseInt(S.split(",")[0])-1;O>=0;O--){if(b=e(i).find("[data-p='"+O+","+S.split(",")[1]+"']")[0],t.isNullOrUndefined(b))for(k=parseInt(S.split(",")[1])-1;k>=0;k--)t.isNullOrUndefined(b)&&(b=e(i).find("[data-p='"+O+","+k+"']")[0]);!t.isNullOrUndefined(b)&&"none"!=e(b).css("display")&&"none"!=e(e(b).parents("tr")[0]).css("display")&&(e(b).hasClass("rowheader")||"rowheader"==e(b).attr("role")||e(b).hasClass("colheader")||"columnheader"==e(b).attr("role")||e(b).hasClass("value")||"gridcell"==e(b).attr("role"))&&(f=b),set_spn=parseInt(e(b).attr("rowspan"))-parseInt(y),e(b).attr("rowspan",set_spn)}t.isNullOrUndefined(b)||v--}}}}},_hideSubTotal:function(i,a,r){var o,s,n,d,h,c,p,u,m,g;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){var f,b={},_=!1,v={},C=!1,S=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows:JSON.parse(this.getOlapReport()).PivotRows,O=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns,T=i[0].querySelectorAll("tbody th.rowheader"),y=i[0].querySelectorAll("thead th, tbody td");for(n=0;n<S.length;n++)0==S[n].showSubTotal&&(_=!0);if(1==_)for(c=0;c<T.length;c++)b[e(T[c]).attr("data-p")]=T[c];for(n=0;n<O.length;n++)0==O[n].showSubTotal&&(C=!0);if(1==C)for(c=0;c<y.length;c++)v[e(y[c]).attr("data-p")]=y[c]}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(S=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.rows:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows:JSON.parse(this.getOlapReport()).PivotRows,O=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource.columns:this.element.parents(".e-pivotclient").length>0?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns:JSON.parse(this.getOlapReport()).PivotColumns,!t.isNullOrUndefined(S))for(n=0;n<S.length;n++)if(0==S[n].showSubTotal)if(o=n.toString(),"row"==e(i).attr("role")&&e(i).parent().is("tbody")){if(0==e(i).find(".stot,.rstot").length||this._isSubTotalhidden&&e(i).find(".stot,.rstot").find(".e-expand").length>=1||e(i).find(".stot,.rstot").attr("data-p").split(",")[0]==o&&1==a&&e(i).find(".stot,.rstot").find(".e-expand").length>=1)break;if(e(i).find(".stot,.rstot").attr("data-p").split(",")[0]==o){e(r).parent().attr("data-p").split(",")[0]==o&&(this._isSubTotalhidden=!0),this._isSubTotalHide=!0;break}}else if(e(i).find("tbody").length>0&&(f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?i.find('.summary.rstot[data-p^="'+n+',"]'):i.find('.summary.stot[data-p^="'+n+',"]')).length>0)for(s=0;s<f.length;s++){var x=e(f[s]).closest("tr"),M=e(x).find(".stot,.rstot").attr("data-p"),P=parseInt(M.split(",")[0])-1,w=parseInt(e(x).find(".stot,.rstot").attr("rowspan"));for(e(x).css("display","none"),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders)&&e(i).find(".valueCell td[data-p$=',"+M.split(",")[1]+"']").closest("tr").css("display","none"),I=parseInt(M.split(",")[1]);P>=0;){for(g=null;t.isNullOrUndefined(g)&&I>=0;){if(g=b[P+","+I],!t.isNullOrUndefined(g)&&"none"!=e(e(g).closest("tr")[0]).css("display")&&e(g).hasClass("rowheader")&&"rowheader"==e(g).attr("role")&&parseInt(e(g).attr("data-p").split(",")[0])<parseInt(M.split(",")[0])&&parseInt(e(g).attr("data-p").split(",")[1])+g.rowSpan+(e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag")):0)>=parseInt(M.split(",")[1])+w){g.rowSpan-=1,e(g).find("span").attr("data-tag",e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag"))+1:1);break}I--}P--}}if(!t.isNullOrUndefined(O))for(n=0;n<O.length;n++)if(0==O[n].showSubTotal)if(d=n.toString(),(e(i).hasClass("stot")||e(i).hasClass("cstot"))&&"columnheader"==e(i).attr("role")){if(this._isSubTotalhidden&&e(i).find(".stot,.cstot").find(".e-expand").length>=1||e(i).attr("data-p").split(",")[1]==d&&1==a&&e(i).find(".e-expand").length>=1)break;if(e(i).attr("data-p").split(",")[1]==d){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if("row"==e(i).attr("role")&&((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&e(i).parent().is("tbody")||e(i).parent().is("thead"))){if(0==e(i).find(".stot,.cstot").length||this._isSubTotalhidden&&e(i).find(".stot,.cstot").find(".e-expand").length>=1||e(i).find(".stot,.cstot").attr("data-p").split(",")[1]==d&&1==a&&e(i).find(".stot,.cstot").find(".e-expand").length>=1)break;if(e(i).find(".stot,.cstot").attr("data-p").split(",")[1]==d){this._isSubTotalhidden=this._isSubTotalHide=!0;break}}else if((e(i).find("thead").length>0||e(i).find(".colhead").length>0)&&(f=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?i.find('td.summary.cstot[data-p$=",'+n+'"]'):i.find('th.summary.cstot[data-p$=",'+n+'"]'):this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders?i.find('td.summary.stot[data-p$=",'+n+'"]'):i.find('th.summary.stot[data-p$=",'+n+'"]')).length>0)for(h=f,c=0;c<h.length;c++){var L=e(h[c]),N=e(i),D=(M=e(h[c]).attr("data-p"),e(h[c]).closest("tr")[0]),R=parseInt(M.split(",")[0]),j=(w=parseInt(e(h[c]).attr("rowspan")),parseInt(e(h[c]).attr("colspan"))),I=parseInt(M.split(",")[1])-1;for(p=0;p<j;p++){for(u=e(D).nextAll().find("[data-p^='"+(p+R)+",']"),m=0;m<e(u).length;m++)e(u[m]).css("display","none");(e(u[m]).attr("data-hc")==l||parseInt(e(u[m]).attr("data-hc"))<1)&&(e(N).find("[data-p^='"+(p+R)+",']").css("display","none"),e(N).find("[data-p^='0,']:not(.summary)").parent().find("td[data-p^='"+(p+R)+",']").attr("data-ch",1))}for(e(L).css("display","none"),P=parseInt(M.split(",")[0]);I>=0;){for(g=null;t.isNullOrUndefined(g)&&P>=0;){if(g=v[P+","+I],!t.isNullOrUndefined(g)&&"none"!=e(e(g).closest("tr")[0]).css("display")&&e(g).hasClass("colheader")&&"columnheader"==e(g).attr("role")&&parseInt(e(g).attr("data-p").split(",")[1])<parseInt(M.split(",")[1])&&parseInt(e(g).attr("data-p").split(",")[0])<=parseInt(M.split(",")[0])&&parseInt(e(g).attr("data-p").split(",")[0])+g.colSpan+(e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag")):0)>=parseInt(M.split(",")[0])+j){g.colSpan-=j,e(g).find("span").attr("data-tag",e(g).find("span").attr("data-tag")!=l?parseInt(e(g).find("span").attr("data-tag"))+j:j);break}P--}I--}}}},_filterReport:function(e){for(var i,l=0;l<e.Filters.length;l++)if(e.PivotColumns.length>=1)for(i=0;i<e.PivotColumns.length;i++)0==e.Filters.length||t.isNullOrUndefined(e.Filters[l])||e.Filters[l].Tag!=e.PivotColumns[i].FieldName||(e.Filters.splice(l,1),l=-1);for(l=0;l<e.Filters.length;l++)if(e.PivotRows.length>=1)for(i=0;i<e.PivotRows.length;i++)0==e.Filters.length||t.isNullOrUndefined(e.Filters[l])||e.Filters[l].Tag!=e.PivotRows[i].FieldName||(e.Filters.splice(l,1),l=-1);for(l=0;l<e.Filters.length;l++)if(e.PivotCalculations.length>=1)for(i=0;i<e.PivotCalculations.length;i++)0==e.Filters.length||t.isNullOrUndefined(e.Filters[l])||e.Filters[l].Tag!=e.PivotCalculations[i].FieldName||(e.Filters.splice(l,1),l=-1);return e},_createGroupingBar:function(e){var i;this._pivotFilter=this._getLocalizedLabels("DragFieldHere"),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(e=this._filterReport(e),i=this._createPivotButtons(null!=this._pivotFilter&&e.Filters.length>1&&e.Filters[0].Tag==e.Filters[1].Tag?e.Filters.slice(1):e.Filters,"filter")):i=this._createPivotButtons(null!=this._pivotFilter&&e.filters.length>0?e.filters:"","filter"),this._pivotFilter=i,this._pivotRow=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotRows:e.rows,"row"),this._pivotColumn=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotColumns:e.columns,"column"),this._pivotCalculation=this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotCalculations:e.values,"values"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&e.values.length>0&&e.values[0].measures&&("columns"==e.values[0].axis&&e.values[0].measures.length>0?this._pivotColumn=this._pivotColumn+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"column"):"rows"==e.values[0].axis&&e.values[0].measures.length>0&&(this._pivotRow=this._pivotRow+this._createPivotButtons(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?e.PivotColumns:[{fieldName:"Measures",fieldCaption:this._getLocalizedLabels("Measures")}],"row")))},_contextOpen:function(e){t.Pivot._contextMenuOpen(e,this)},_pivotContextClick:function(i){var l,a;if(i.text!=this._getLocalizedLabels("CalculatedField"))if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode){var r=i.text==this._getLocalizedLabels("AddToColumn")?"column":i.text==this._getLocalizedLabels("AddToRow")?"row":i.text==this._getLocalizedLabels("AddToValues")?"value":i.text==this._getLocalizedLabels("AddToFilter")?"filter":"",o=e(this._selectedMember).attr("data-fieldName"),s={droppedFieldName:o,droppedFieldCaption:e(this._selectedMember).text(),droppedClass:r,droppedPosition:"",isMeasuresDropped:0==o.toLocaleLowerCase().indexOf("measures")};this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&"values"!=r&&(this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField||1==e.isCalculatedField&&-1==e.formula.indexOf(s.droppedFieldName)})),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this)),t.Pivot.addReportItem(this.model.dataSource,s),this.refreshControl(),t.isNullOrUndefined(this._schemaData)||this._schemaData._refreshPivotButtons()}else l=i.text==this._getLocalizedLabels("AddToColumn")?this.element.find(".columns"):i.text==this._getLocalizedLabels("AddToRow")?0==this.element.find(".e-grpRow").length?this.element.find(".emptyRows").addClass("e-grpRow"):this.element.find(".e-grpRow"):i.text==this._getLocalizedLabels("AddToValues")?this.element.find(".values"):i.text==this._getLocalizedLabels("AddToFilter")?this.element.find(".e-drag"):"",a={element:this._selectedMember,target:l,cancel:!1},this._pvtBtnDropped(a);else this._createCalculatedField()},_getAdvancedFilterInfo:function(i){var l=[];return this._excelFilterInfo.length>0&&(i,l=e.grep(this._excelFilterInfo,function(e){try{if(e.levelUniqueName.replace(/]/g,"").replace(/\[/g,"").indexOf(i)>-1&&!t.isNullOrUndefined(e.operator))return e}catch(e){}})),l},_createPivotButtons:function(i,a){var r,o,s,n,d,h,c,p,u,m,g=this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode;if(!t.isNullOrUndefined(i)){var f="",b="column"==a?"Columns":"row"==a?"Rows":"filter"==a?"Slicers":"Values",_="";if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)for("values"==(b="column"==a?"Columns":"row"==a?"Rows":"filter"==a?"filters":"values")&&g&&(i=e.map(i,function(e){return e.measures})),n=0;n<i.length;n++){_=i[n].fieldCaption;var v=g?"":t.PivotAnalysis.getMembers(i[n].fieldName),C=t.Pivot.getReportItemByFieldName(i[n].fieldName,this.model.dataSource),S=null!=i[n].filterItems&&i[n].filterItems.values.length>0||!t.isNullOrUndefined(i[n].advancedFilter)&&i[n].advancedFilter.length>0&&C.item&&"filters"!=C.axis?"filtered":"";"filter"==a&&("filtered"==S?_=t.Pivot._getFilterState(g,v,i[n],this):g?(t.olap._mdxParser.getAllMember(this.model.dataSource,i[n].fieldName,this),_=this._allMember):_=this._getLocalizedLabels("All")),r=g?"":i[n].sortOrder==t.PivotAnalysis.SortOrder.Descending?"descending":"",o=(i[n].fieldName||i[n]).replace(/[\(\)\[\]{}'"]/g,"").replace(/[\W]/g,"_"),f+=t.buildTag("span.e-pivotButton",t.buildTag("button.e-pvtBtn#pivotButton_"+o,(this.model.showUniqueNameOnPivotButton&&"values"!=a?i[n].fieldName.replace(/\[/g,"").replace(/\]/g,""):i[n].fieldCaption==l?i[n].fieldName:i[n].fieldCaption||i[n])+("filter"==a?" ("+_+")":""),{},{"data-fieldName":i[n].fieldName,"data-fieldCaption":i[n].fieldCaption,"data-axis":b})[0].outerHTML+(!g||"measures"!=i[n].fieldName.toLowerCase()&&(t.isNullOrUndefined(i[n].isNamedSet)||i[n].isNamedSet)?t.buildTag("span.filter e-icon "+S).attr("role","button").attr("aria-label","filter")[0].outerHTML:"")+(g?" ":t.buildTag("span.e-sorting e-icon "+r).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML)+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",b+":"+i[n].fieldName||i[n])[0].outerHTML}else for("Values"==b&&"values"==a&&(s=this.element.find(".e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?this.element.find(".e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").parent()[0].className.split(" ")[0]:"e-schemaColumn",this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(b="e-schemaColumn"==s||"columns"==s?"Columns":"Rows")),n=0;n<i.length;n++){for(d=this._ascdes.split("##"),h=0,r="",S="",c=0;c<d.length;c++)(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&d[c]==i[n].Tag||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&d[c]==i[n])&&(h=1);if(1==h&&(r="descending"),!t.isNullOrUndefined(this._tempFilterData))for(c=0;c<this._tempFilterData.length;c++)for(p in this._tempFilterData[c])this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?p==(i[n].FieldName||i[n].DimensionName)&&""!=this._tempFilterData[c][i[n].FieldName||i[n].DimensionName]&&(S="filtered"):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&p==(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?i[n].Tag:i[n])&&0!=this._tempFilterData[c][i[n].Tag].indexOf("FILTERED")&&(S="filtered");this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(i[n].FieldHeader="Measures"==i[n].FieldHeader?this._getLocalizedLabels("Measures"):i[n].FieldHeader,S="filter"!=a&&this.model.enableAdvancedFilter&&this._getAdvancedFilterInfo(i[n].Tag).length>0?"filtered":S,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(u=t.isNullOrUndefined(this._tempFilterData)?[]:e.map(this._tempFilterData,function(e){return e[i[n].DimensionName]}),"filter"==a&&(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableAdvancedFilter&&this._getAdvancedFilterInfo(i[n].Tag).length>0&&(S="filtered"),_=u.length>0&&S&&this._fieldMembers[i[n].DimensionName]?this._fieldMembers[i[n].DimensionName].length-u.length==1?this._fieldMembers[i[n].DimensionName].filter(function(e){if(-1==u.indexOf(e))return e}):this._getLocalizedLabels("MultipleItems"):this._getLocalizedLabels("All"))):"filter"==a&&(_=("All"==this._fieldSelectedMembers[i[n].Tag]?i[n].AllMember:this._fieldSelectedMembers[i[n].Tag])||i[n].AllMember),m="Measures"==i[n].FieldHeader||"Measures"==i[n].Tag||i[n].Tag.indexOf("::NAMEDSET")>-1?"":t.buildTag("span.filter e-icon "+S).attr("role","button").attr("aria-label","filter")[0].outerHTML,f+=t.buildTag("span.e-pivotButton",t.buildTag("span.e-dropIndicator")[0].outerHTML+t.buildTag("button.e-pvtBtn#pivotButton"+i[n].FieldHeader||i[n].FieldName||i[n].Name||i[n].DimensionHeader||i[n].DimensionName,(this.model.showUniqueNameOnPivotButton&&"values"!=a?i[n].Tag:i[n].FieldHeader||i[n].FieldName||i[n].Name||i[n].DimensionHeader||i[n].DimensionName)+("filter"==a?" ("+_+")":""),{},this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?{"data-fieldName":i[n].FieldName||i[n].DimensionName||i[n].FieldHeader||i[n].DimensionHeader,"data-fieldCaption":i[n].FieldHeader||i[n].DimensionHeader||i[n].FieldName||i[n].DimensionName}:{"data-fieldCaption":i[n].FieldHeader})[0].outerHTML+m+t.buildTag("span.e-sorting e-icon "+r).attr("role","button").attr("aria-label","sort")[0].outerHTML+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",b+":"+i[n].Tag)[0].outerHTML):f+=t.buildTag("span.e-pivotButton",t.buildTag("span.e-dropIndicator")[0].outerHTML+t.buildTag("button.e-pvtBtn#pivotButton"+i[n],i[n])[0].outerHTML+t.buildTag("span.filter e-icon "+S).attr("role","button").attr("aria-label","filter")[0].outerHTML+t.buildTag("span.e-sorting e-icon "+r).attr("role","button").attr("aria-label","sort").attr("aria-expanded","false")[0].outerHTML+t.buildTag("span.e-removeBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML).attr("data-tag",b+":"+i[n])[0].outerHTML}return f}},_createFields:function(){var i,l,a,r,o,s,n,d,h,c,p,u,m,g;if(this.element.find(".groupingBarPivot").remove(),this.model.enableVirtualScrolling&&this.element.find(".virtualScrollGrid").length>0?this.element.find(".virtualScrollGrid").prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML):this.element.prepend(t.buildTag("div#groupingBarPivot.groupingBarPivot")[0].outerHTML),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.valueColumn",t.buildTag("span.values").attr("aria-label","values")[0].outerHTML+t.buildTag("span.columns").attr("aria-label","column")[0].outerHTML,{width:"100%"})),this.element.find(".groupingBarPivot").prepend(t.buildTag("div.e-drag",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("DragFieldHere"),{width:"100%"}).attr("aria-label","filter")[0].outerHTML),""!=this._pivotFilter&&null!=this._pivotFilter&&this.element.find(".e-drag").text("").attr("aria-label","filter"),this.element.find(".e-drag").append(this._pivotFilter),this.element.find(".values").append(this._pivotCalculation),this.element.find(".columns").append(this._pivotColumn),0==this.element.find(".values .e-pivotButton").length&&this.element.find(".values").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ValueArea")),0==this.element.find(".columns .e-pivotButton").length&&this.element.find(".columns").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("ColumnArea")),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&0==this.element.find(".e-rows").length&&!t.isNullOrUndefined(this.getJSONRecords())&&this.getJSONRecords().length>0&&"colheader"==this.getJSONRecords()[0].CSS?(this.element.find(".e-pivotGridTable thead tr:first").prepend(t.buildTag("th.e-grpRow",t.buildTag("div.e-rows",t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))[0].outerHTML,{},{rowspan:this.element.find("thead tr").length})[0].outerHTML),this.element.find(".e-pivotGridTable tbody tr:first").prepend(t.buildTag("td.rowheader",this._getLocalizedLabels("Total"))[0].outerHTML)):0==this.element.find(".e-rows .e-pivotButton").length&&(this.element.find(".e-rows").text("").children("span").remove(),this.element.find(".e-rows").append(t.buildTag("span","",{width:"5px",display:"inline-block"})[0].outerHTML+this._getLocalizedLabels("RowArea"))),(0==this.element.find(".rowheader").length&&0==this.element.find(".colheader").length&&0==this.element.find(".values .e-pivotButton").length||0==this.element.find(".e-pivotGridTable th").length)&&(i=t.buildTag("div.emptyRows",t.buildTag("span.e-rows",""!=this._pivotRow?this._pivotRow:this._getLocalizedLabels("RowArea"),{width:"5px"})[0].outerHTML,{width:140})[0].outerHTML,0==this.element.find(".e-rows").length&&this.element.find(".groupingBarPivot").append(i),this.model.enableDeferUpdate&&""!=this._pivotRow&&(this.element.find(".e-rows").text(""),this.element.find(".e-rows").append(this._pivotRow)),(null==this.getJSONRecords()||0==this.getJSONRecords().length)&&this.element.find(".groupingBarPivot").addClass("emptyPivotGrid"),this.element.find(".emptyRows,.e-rows").ejDroppable({})),this.element.find(".values").find(".filter").remove(),this.element.find(".values").find(".e-sorting").remove(),this.element.find(".e-drag").find(".e-sorting").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.element.find(".e-pivotButton").find(".e-sorting").remove(),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.element.find(".e-rows").width(this.element.find(".pivotGridRowTable").width()),this._setGroupingBarFrozenRowBtnWidth()),this.element.find(".e-pivotButton .e-pvtBtn").ejButton({size:"normal",type:t.ButtonType.Button}).ejDraggable({handle:"button",clone:!0,cursorAt:{left:-5,top:-5},dragStart:t.proxy(function(){this._isDragging=!0},this),dragStop:t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?this._clientPvtBtnDropped:this._pvtBtnDropped,this),helper:t.proxy(function(t){return e(t.element).parent().addClass("dragHover"),e(t.element).addClass("dragHover"),t.sender.target.className.indexOf("e-btn")>-1&&e(t.sender.target).clone().addClass("dragClone").appendTo(this.element)},this)}),t.browserInfo().name.indexOf("moz")>-1&&(this.element.find(".columns .e-btn, .e-rows .e-btn").addClass("e-pvtBtnIndent"),this.element.find(".columns .e-sorting,.e-rows .e-sorting").addClass("e-pvtBtnSort")),this.element.find(".e-drag, .values, .columns, .e-grpRow, .e-rows").ejDroppable({}),this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length>0)this.element.find(".groupingBarPivot").width(this.element.find(".e-pivotGridTable").width());else if(0==this.element.find(".columns .e-pivotButton").length||0==this.element.find(".values .e-pivotButton").length&&1==this.element.find(".columns .e-pivotButton").length)this.element.find(".groupingBarPivot").width(300);else{for(l=0,u=0;u<e(this.element.find(".columns .e-pivotButton")).length;u++)l=Math.max(e(this.element.find(".columns .e-pivotButton")[u]).width(),l);l<140&&this.element.find(".columns").css("min-width",l+"px"),a=l*e(this.element.find(".columns .e-pivotButton")).length+this.element.find(".values").width()+10,this.element.find(".groupingBarPivot").width(a)}for((this.element.find(".e-rows").width()>140||this.model.enableDeferUpdate&&this.element.find(".e-rows").width()<this.element.find(".e-grpRow").width()&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)&&(this.enableDeferUpdate?this.element.find(".e-rows").width(0==this.element.find(".colheader").length?this.element.find(".e-grpRow").width()-140:this.element.find(".e-grpRow").width()):this.model.isResponsive||this.element.find(".e-rows").width(this.model.enableDeferUpdate?this.element.find(".e-grpRow").width()-8:this.element.find(".e-grpRow").width())),(this.element.find(".e-pivotGridTable thead").length>0||this.model.enableDeferUpdate&&0==this.element.find(".e-pivotGridTable thead").length&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this.model.isResponsive&&0==this.element.find(".values .e-pivotButton").length&&0==this.element.find(".columns .e-pivotButton").length?this.element.find(".values").width(140):this.element.find(".values").width(this.element.find(".e-grpRow").length>0?this.model.enableDeferUpdate&&0==this.element.find(".colheader").length?this.element.find(".e-grpRow").width():this.element.find(".e-grpRow").width()+3:140),this.model.enableDeferUpdate&&0==this.element.find(".colheader").length&&0!=this.element.find(".e-pivotGridTable .rowheader").length&&((p=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width())<140&&this.element.find(".groupingBarPivot").width(this.element.find(".groupingBarPivot").width()+140)),this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length>0||this.model.enableDeferUpdate&&0==this.element.find(".columns .e-pivotButton").length||this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?(v=this.element.find(".e-pivotGridTable").width()-this.element.find(".values").width()-4,0==this.element.find(".e-pivotGridTable").find("thead th:eq(2), tbody td:eq(1)").length?(this.element.find(".columns").css("min-width",v>=30&&0==this.element.find(".e-pivotGridTable .colheader").length&&0==this.element.find(".columns .e-pivotButton").length?140:v).width(v>=30&&0==this.element.find(".e-pivotGridTable .colheader").length&&0==this.element.find(".columns .e-pivotButton").length?82:v),this.element.find(".values").height(v>=30&&0==this.element.find(".e-pivotGridTable .colheader").length&&0==this.element.find(".columns .e-pivotButton").length?this.element.find(".columns").height():this.element.find(".values").height()),(0==this.element.find(".columns .e-pivotButton").length||this.model.enableDeferUpdate&&0==this.element.find(".e-pivotGridTable .colheader").length)&&(0==this.element.find(".columns .e-pivotButton").length&&(v=this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-5,this.element.find(".columns").width(v),v<140&&(1==e(".groupingBarPivot .values .e-pivotButton").length||0==e(".groupingBarPivot .values .e-pivotButton").length&&this.model.enableDeferUpdate)&&this.element.find(".columns").css("min-width",v+"px")),this.element.find(".columns").addClass("e-widthSetter"))):v<140?e(".columns .e-pivotButton").length<2?this.element.find(".columns").css("min-width",v).addClass("e-widthSetter"):(this.element.find(".columns").width(v).css("min-width",v),this.element.find(".values").height(this.element.find(".columns").height())):this.element.find(".columns").width(v)):0!=this.element.find(".e-pivotGridTable").find("thead th:eq(1)").length||this.model.enableDeferUpdate||(0==this.element.find(".columns .e-pivotButton").length&&this.element.find(".columns").addClass("e-widthSetter"),r=this.element.find(".columns .e-pivotButton").length<1?1:this.element.find(".columns .e-pivotButton").length,this.element.find(".columns").css("min-width",(this.element.find(".groupingBarPivot").width()-this.element.find(".values").width()-7)/r))),null!=this.model.dataSource.data&&""==this.model.url&&(o=0,e(".columns .e-pivotButton").each(function(){o+=parseInt(e(this).width()+10)}),e(".valueColumn").height()>30&&0==this.element.find(".values button").length&&this.element.find(".columns").width()<o&&(f=this.element.find(".columns .e-pivotButton").length,b=(this.element.find(".valueColumn").width()-this.element.find(".values").width())/(0==f?1:f)-70,this.element.find(".columns .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"}))),this.element.find(".columns").height()>47?(b=this.model.isResponsive?this.element.find(".columns").width()/this.element.find(".columns .e-pivotButton").length-5:this.element.find(".columns").width()/2-60,this.element.find(".columns .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})):this.element.find(".columns .e-pivotButton").width()>this.element.find(".columns").width()&&(b=this.element.find(".columns").width()-(this.element.find(".columns .e-pivotButton").width()-this.element.find(".columns .e-pivotButton .e-pvtBtn").width()+40),this.element.find(".columns .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})),this.element.find(".e-drag").height()>47?(b=this.element.find(".groupingBarPivot").width()/4-35,this.element.find(".e-drag .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})):this.element.find(".e-drag .e-pivotButton").width()>this.element.find(".e-drag").width()&&(b=this.element.find(".e-drag").width()-(this.element.find(".e-drag .e-pivotButton").width()-this.element.find(".e-drag .e-pivotButton .e-pvtBtn").width()+40),this.element.find(".e-drag .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})),this.element.find(".values").height()>47?(b=this.model.isResponsive?this.element.find(".values").width()/this.element.find(".values .e-pivotButton").length-5:this.element.find(".values").width()/2-40,this.element.find(".values .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})):(this.element.find(".values .e-pivotButton").width()>this.element.find(".values").width()||!this.model.enableDeferUpdate&&0==this.element.find(".e-pivotGridTable").find("thead th:eq(1), tbody td.value:eq(0)").length&&this.element.find(".values .e-pivotButton").length>0)&&(b=this.element.find(".values").width()-(this.element.find(".values .e-pivotButton").width()-this.element.find(".values .e-pivotButton .e-pvtBtn").width()+20),this.element.find(".values .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})),s=0,u=0;u<this.element.find(".e-rows .e-pivotButton").length;u++)s+=this.element.find(".e-rows .e-pivotButton:eq("+u+")").width();if(s-20>this.element.find(".e-rows").width()||this.element.find(".colfreeze").length-20>0&&s>this.element.find(".colfreeze").width()||this.element.find(".e-rows").parent(".emptyRows").length>0&&this.element.find(".e-rows").parent(".emptyRows").width()<s){var f,b=0,_=this.element.find(".colfreeze").length>0?".colfreeze":".e-rows";b=this.element.find(_).parent().height()/(this.element.find(_+" .e-pivotButton").eq(0).height()*(f=this.element.find(_+" .e-pivotButton").length))>=1?"auto":this.element.find(_).width()/2-40,this.element.find(".e-rows .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})}if((this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(0==this.element.find(".values .e-pvtBtn").length||0==this.element.find(".columns .e-pvtBtn").length)&&(this.element.find(".e-rows").width()>this.element.find(".values").width()||this.element.find(".e-rows").width()>this.element.find(".columns").width())&&140==this.element.find(".emptyRows").width()||this.model.enableDeferUpdate&&this.element.find(".values .e-pvtBtn").length<=1&&this.element.find(".columns .e-pvtBtn").length<=1)&&(n=this.element.find(".e-rows").width(),d=this.element.find(".values").width()+this.element.find(".columns").width(),this.element.find(".values").css({"min-width":n,width:n}),h=this.element.find(".values").width(),this.element.find(".columns").css({"min-width":d-h,width:d-h}),this.element.find(".columns .e-pvtBtn,.values .e-pvtBtn").width("auto").css({"text-overflow":"ellipsis"}),this.element.find(".emptyRows").width(n)),this.model.enableDeferUpdate&&0!=this.element.find(".columns .e-pivotButton").length&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){for(c=0,p=0,u=0;this.element.find(".columns .e-pivotButton").length>u;u++)c=this.element.find(".columns .e-pivotButton:eq("+u+")").width()+c+7;if(c>=(p=this.element.find(".e-pivotGridFrozenTable").width())){var v;b=(v=0==(this.element.find(".e-pivotGridTable .colheader").length>0?1:0)?140:p)/(this.model.enableDeferUpdate?this.element.find(".columns .e-pivotButton").length:3)-15;this.model.enableDeferUpdate?this.element.find(".columns .e-pvtBtn").width(30).css({"text-overflow":"ellipsis"}):this.element.find(".columns .e-pvtBtn").width(b).css({"text-overflow":"ellipsis"})}}(this.element.find(".values").height()>this.element.find(".columns").height()||this.element.find(".columns").height()>this.element.find(".values").height())&&(this.element.find(".values").height()>this.element.find(".columns").height()?this.element.find(".columns").height(this.element.find(".values").height()):this.element.find(".values").height(this.element.find(".columns").height())),this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),this.element.find(".summary").removeClass("e-droppable"),this.model.enableGroupingBar&&(m=this.element.find(".e-pvtBtn"),g=t.buildTag("ul.pivotTree#pivotTree",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li.e-calculatedFieldMenuItem",t.buildTag("a.menuItem",this._getLocalizedLabels("CalculatedField"))[0].outerHTML)[0].outerHTML:" ")+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToFilter"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToRow"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToColumn"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToValues"))[0].outerHTML)[0].outerHTML)[0].outerHTML,e(this.element).append(g),e("#pivotTree").ejMenu({menuType:t.MenuType.ContextMenu,enableRTL:this.model.enableRTL,openOnClick:!1,contextMenuTarget:m,click:t.proxy(this._pivotContextClick,this),beforeOpen:t.proxy(this._contextOpen,this),close:t.proxy(t.Pivot.closePreventPanel,this)}))},_clientPvtBtnDropped:function(i){var l,a,r,o,s;t.PivotAnalysis._valueSorting=null,this._isDragging=!1,t.Pivot.openPreventPanel(this),i.element.removeClass("dragHover").css("background-color","inherit"),i.element.parent().removeClass("dragHover"),this.element.find(".dragClone").remove(),this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorHover"),this.element.find(".dragClone,.e-dropIndicator").remove();var n=e(i.target).hasClass("columns")||e(i.target).parents(".columns").length>0?"column":e(i.target).hasClass("e-grpRow")||e(i.target).parents(".e-grpRow").length>0||e(i.target).hasClass("e-rows")?"row":e(i.target).hasClass("values")||e(i.target).parents(".values").length>0?"value":e(i.target).hasClass("e-drag")||e(i.target).parents(".e-drag").length>0?"filter":"",d=i.element.text(),h=e(i.element).attr("data-fieldName");if(""!=n&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(h.toLowerCase().indexOf("[measures]")>=0&&"value"!=n||h==this._getLocalizedLabels("Measures")&&"row"!=n&&"column"!=n||h.toLowerCase().indexOf("[measures]")<0&&"value"==n))t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Warning"),this);else{if(""==n&&this._schemaData)if("measures"==d.toLowerCase()&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(l=0;this.model.dataSource.values[0].measures.length>0;)selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this.model.dataSource.values[0].measures[l].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else this._schemaData&&(a=this._schemaData._tableTreeObj.element.find("li:contains('"+d+"')"),this._schemaData._tableTreeObj.uncheckNode(a));if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&""!=n&&"value"!=n&&e.grep(this._calculatedField,function(e){return e.name==h}).length>0)return t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this),void this.element.find(".dragClone,.e-dropIndicator").remove();var c=""==n?"":this._setSplitBtnTargetPos(i.event,n,"drop"),p=""==n?"":this._setSplitBtnTargetPos(i,n,"original"),u=e(i.element).hasClass("columns")||e(i.element).parents(".columns").length>0?"column":e(i.element).hasClass("e-grpRow")||e(i.element).parents(".e-grpRow").length>0||e(i.element).hasClass("e-rows")?"row":e(i.element).hasClass("values")||e(i.element).parents(".values").length>0?"value":e(i.element).hasClass("e-drag")||e(i.element).parents(".e-drag").length>0?"filter":"";""!=n&&n.toLowerCase()==u.toLowerCase()&&c>p&&(c-=1),r={droppedFieldName:h,droppedFieldCaption:d,droppedClass:n,droppedPosition:c,isMeasuresDropped:0==h.toLocaleLowerCase().indexOf("measures")},this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&"value"!=n?this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField||1==e.isCalculatedField&&-1==e.formula.indexOf(r.droppedFieldName)}):this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this._fieldMembers={},this._fieldSelectedMembers={},this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this)),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.Pivot.addReportItem(this.model.dataSource,r),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(o=e.grep(this.model.dataSource.values,function(e){return 1==e.isCalculatedField}),this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField}),e.merge(this.model.dataSource.values,o)),(this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&"filter"==n&&((s=t.Pivot.getReportItemByFieldName(this._selectedField,this.model.dataSource).item)&&s.advancedFilter&&(s.advancedFilter=[])),this.refreshControl(),t.isNullOrUndefined(this._schemaData)||(null==t.Pivot.getReportItemByFieldName(h,this.model.dataSource).item&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._schemaData._tableTreeObj.element.find("li[data-tag='"+h+"']").removeClass("filter").find(".treeDrop,.filter").remove(),this._schemaData._refreshPivotButtons())}},_pvtBtnDropped:function(i){var l,a,r,o,s,n,d,h,c,p,u;t.Pivot.openPreventPanel(this),e(i.element).parent().removeClass("dragHover"),e(i.element).removeClass("dragHover"),this._isUpdateRequired=!0,l="",this._isDragging=!1,this.element.find(".e-dropIndicator").removeClass("e-dropIndicatorHover");var m,g,f=null,b="",_="",v=!1;if(a="e-grpRow"==(a=t.isNullOrUndefined(i.target.className)?e(i.target).hasClass("columns")?"columns":e(i.target).hasClass("e-grpRow")?"e-rows":e(i.target).hasClass("values")?"values":e(i.target).hasClass("e-drag")?"e-drag":"":i.target.className.indexOf("e-droppable")>=0?i.target.className.split(" ")[0]:"")?"e-rows":a,g=e(i.element).parent().find(".filtered").length>0,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(e(i.target).hasClass("e-pvtBtn")&&this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode&&(a=e(i.target).attr("data-axis").toLowerCase()),m=t.isNullOrUndefined(i.element.attr("data-fieldCaption"))?i.element.text():i.element.attr("data-fieldCaption"),v=e(i.element).parent().find(".descending").length>0,""==a&&("BUTTON"==i.target.tagName||"SPAN"==i.target.tagName)&&(a=i.target.parentNode.parentElement.className.split(" ")[0]),r=0;r<this._pivotTableFields.length;r++)this._pivotTableFields[r].name==m&&(this._pivotTableFields[r].isSelected=!0,_=this._pivotTableFields[r]);else t.isNullOrUndefined(i.target.className)?(f=e(i.target),b=e(i.target).hasClass("columns")?"Categorical":e(i.target).hasClass("e-grpRow")?"Series":e(i.target).hasClass("e-drag")?"Slicer":"",a=e(i.target).hasClass("columns")?"columns":e(i.target).hasClass("e-grpRow")?"e-rows":e(i.target).hasClass("values")?"values":e(i.target).hasClass("e-drag")?"e-drag":""):(b="columns"==(f=i.target.className.indexOf("e-pvtBtn")>-1?e(i.target).parents(".e-droppable")[0]:i.target.className.indexOf("e-droppable")?i.target:"td"==i.target[0].tagName.toLowerCase()?i.target.children(":last")[0]:i.target).className.split(" ")[0]?"Categorical":"e-rows"==f.className.split(" ")[0]||"e-grpRow"==f.className.split(" ")[0]?"Series":"filters"==f.className.split(" ")[0]?"Slicer":"",a=f.className.split(" ")[0]),""==b&&(i.element.parent().attr("data-tag").indexOf("[Measures]")>-1||i.element.parent().attr("data-tag").indexOf("KPI")>-1)&&(b=this.element.find(".e-schemaRow .e-pivotButton:contains('"+this._getLocalizedLabels("Measures")+"')").length>0?"Series":"Categorical"),t.isNullOrUndefined(i.element.parent())||(l=i.element.parents(".values").length>0?"values":i.element.parents(".e-drag").length>0?"e-drag":i.element.parents(".e-grpRow").length>0?"e-rows":i.element.parents(".columns").length>0?"columns":""),_=e(i.element.parent()[0]).attr("data-tag"),a="e-grpRow"==a?"e-rows":a,b="e-grpRow"==b?"Series":b,m=i.element.text();if(this.element.find(".dragClone").remove(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(("MEASURES"==_.split(":")[1].toLocaleUpperCase()||"KPI"==_.split(":")[1].toLocaleUpperCase())&&("columns"!=a||"e-rows"!=a)&&("e-drag"==a||"values"==a)||_.toUpperCase().indexOf("[MEASURES]")>-1&&"values"!=a&&("e-rows"==a||"columns"==a||"e-drag"==a)||(-1==_.toUpperCase().indexOf("[MEASURES]")||-1==_.toUpperCase().indexOf("KPI"))&&"values"==a&&a!=l))return t.Pivot._createErrorDialog(this._getLocalizedLabels("GroupingBarAlertMsg"),this._getLocalizedLabels("Error"),this),this.element.find(".dragClone,.e-dropIndicator").remove(),i.element.parent().removeAttr("style"),i.element.css("background-color","inherit"),!1;if("e-rows"==a||"columns"==a||"values"==a||"e-drag"==a){if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"values"!=a&&(e.grep(this._calculatedField,function(e){return e.name==m}).length>0||e.grep(JSON.parse(this.getOlapReport()).PivotCalculations,function(e){return e.FieldHeader==m&&8==e.CalculationType}).length>0))return t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this),i.element.parent().removeAttr("style"),void i.element.css("background-color","inherit");o=this._setSplitBtnTargetPos(i,a,"drop"),s=this._setSplitBtnTargetPos(i,a,"original"),"e-drag"==a&&this.element.find(".e-drag").text("").attr("aria-label","filter");try{n=JSON.parse(this.getOlapReport()).Report}catch(e){n=this.getOlapReport()}if(e(i.element.parent()).remove(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)O=i.element.parents(".e-pivotButton").attr("data-tag").split(":")[0],this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),e.isNumeric(o)&&a==O.toLowerCase()&&o>s&&(o-=1),a="e-rows"==a?"schemaRow":"columns"==a?"schemaColumn":"e-drag"==a?"schemaFilter":"values"==a?"schemaValue":"",this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(this.model.enableAdvancedFilter&&"schemaFilter"==a&&!t.isNullOrUndefined(this._curFilteredText)&&this._curFilteredText.indexOf(":")>-1&&((c=this._getAdvancedFilterInfo(this._curFilteredText.split(":")[1])).length>0&&this._removeFilterTag(c[0].levelUniqueName)),b="schemaFilter"==a?"Slicer":b,d=JSON.parse(this._olapReport).CurrentCube+"--"+_+"--"+b+"--"+o,null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),p=JSON.stringify(this.model.customObject),h=JSON.stringify({action:"nodeDropped",dropType:"SplitButton",nodeInfo:d,currentReport:n,gridLayout:this.model.layout,customObject:p}),this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h,this._pvtBtnDroppedSuccess)):(this._calculatedField.length>0&&"schemaValue"!=a&&null!=this._schemaData&&this._calculatedFieldNodeRemove(_),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),p=JSON.stringify(this.model.customObject),u=t.Pivot._getFilterParams(a,this._tempFilterData,m),h=JSON.stringify({action:"nodeDropped",dropAxis:a+"::"+o,headerTag:JSON.stringify(_),sortedHeaders:this._ascdes,filterParams:u,currentReport:n,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:p}),this._renderControlSuccess,this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h.replace("nodeDropped","nodeDroppedDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,h,this._pvtBtnDroppedSuccess));else{if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&"values"!=a&&e.grep(this._calculatedField,function(e){return e.name==m}).length>0)return t.Pivot._createErrorDialog(this._getLocalizedLabels("CalcValue"),this._getLocalizedLabels("Warning"),this),this.model.editCellsInfo={},void this._populatePivotGrid();var C=this._getDroppedItem(m),S={fieldName:C[0].fieldName,fieldCaption:C[0].fieldCaption},O=i.element.parents(".e-pivotButton").attr("data-tag").split(":")[0];this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&C.length>0&&"e-drag"==a&&(C[0].advancedFilter=[]),e.isNumeric(o)?a==O.toLowerCase()&&o>s?"e-rows"==a?this.model.dataSource.rows.splice(o-1,0,C[0]):"columns"==a?this.model.dataSource.columns.splice(o-1,0,C[0]):"values"==a?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(o-1,0,C[0]):this.model.dataSource.values.splice(o,0,C[0]):this.model.dataSource.filters.splice(o,0,C[0]):"e-rows"==a?this.model.dataSource.rows.splice(o,0,C[0]):"columns"==a?this.model.dataSource.columns.splice(o,0,C[0]):"values"==a?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.splice(o,0,C[0]):this.model.dataSource.values.splice(o,0,C[0]):this.model.dataSource.filters.splice(o,0,C[0]):"e-rows"==a?this.model.dataSource.rows.push(C[0]):"columns"==a?this.model.dataSource.columns.push(C[0]):"values"==a?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures.push(C[0]):this.model.dataSource.values.push(C[0]):this.model.dataSource.filters.push(C[0]),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&"values"!=a&&(null!=this._schemaData&&this._calcFieldNodeDrop(C[0]),this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return t.isNullOrUndefined(e.isCalculatedField)||0==e.isCalculatedField||1==e.isCalculatedField&&-1==e.formula.indexOf(C[0].fieldName)})),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"pvtBtnDropped"},this)),null!=this._schemaData&&(a==O&&o>s&&(o-=1),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData.element.find("button[data-fieldName='"+m+"']").remove():this._schemaData.element.find("#pivotButton"+m).parent().remove(),this._schemaData._createPivotButton(S,"e-rows"==a?"row":"columns"==a?"column":"e-drag"==a?"filter":"values"==a?"value":"",g,v,o)),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.getJSONData({action:"pvtBtnDropped"},this.model.dataSource,this)):(this.model.editCellsInfo={},this._populatePivotGrid())}}else this._removePvtBtn(i);t.isNullOrUndefined(this._schemaData)||this._schemaData._setPivotBtnWidth()},_getDroppedItem1:function(i){this.model.analysisMode,t.Pivot.AnalysisMode.Olap;var l,a=e.grep(this.model.dataSource.columns,function(e){return e.fieldName==i});return a.length>0?this.model.dataSource.columns=e.grep(this.model.dataSource.columns,function(e){return e.fieldName!=i}):(a=e.grep(this.model.dataSource.rows,function(e){return e.fieldName==i})).length>0?this.model.dataSource.rows=e.grep(this.model.dataSource.rows,function(e){return e.fieldName!=i}):(l=this.model.dataSource.values,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(l=this.model.dataSource.values[0].measures),(a=e.grep(l,function(e){return e.fieldName==i})).length>0?this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.dataSource.values[0].measures=e.grep(l,function(e){return e.fieldName!=i}):this.model.dataSource.values=e.grep(l,function(e){return e.fieldName!=i}):(a=e.grep(this.model.dataSource.filters,function(e){return e.fieldName==i})).length>0&&(this.model.dataSource.filters=e.grep(this.model.dataSource.filters,function(e){return e.fieldName!=i}))),a},_clearCollapsedItems:function(t,i,a){return"rowheader"==t?a.rows=e.map(a.rows,function(t){return t.drilledItems!=l&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t}):"colheader"==t&&(a.columns=e.map(a.columns,function(t){return t.drilledItems!=l&&t.drilledItems.length&&(t.drilledItems=e.map(t.drilledItems,function(e){if(e.join("").indexOf(i.repItms.replace(/&/g,"&amp;"))<0)return[e]})),t})),a},_setSplitBtnTargetPos:function(t,i,l){var a,r,o,s="";for(r="drop"==l?e(t.target).parents(".e-pivotButton"):e(t.element).parents(".e-pivotButton"),i="column"==i?"columns":"row"==i?"e-rows":"filter"==i?"e-drag":"value"==i?"values":i,a=this.element.find("."+i).children(".e-pivotButton"),o=0;o<a.length;o++)e(a[o]).attr("data-tag")==e(r).attr("data-tag")&&(s=o);return s},_pvtBtnDroppedSuccess:function(e){!t.isNullOrUndefined(e[0])&&e.length>0?null!=e[2]&&e[2]!=l&&(this.model.customObject=e[2].Value):!t.isNullOrUndefined(e.d)&&e.d.length>0?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):t.isNullOrUndefined(e)||t.isNullOrUndefined(e.OlapReport)||null!=e&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),this.model.enableDeferUpdate?this._deferUpdateSuccess(e):this._renderControlSuccess(e),null!=this._schemaData&&this._schemaData._refreshPivotButtons()},_deferUpdateSuccess:function(i){if(t.isNullOrUndefined(i.PivotReport)&&t.isNullOrUndefined(i.OlapReport)?(this.setOlapReport(i.d[0].Value),null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.d[2].Value),JSON.parse(i.d[1].Value))):(t.isNullOrUndefined(i.PivotReport)?this.setOlapReport(i.OlapReport):this.setOlapReport(i.PivotReport),i.HeaderCounts!=l&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this.model.pivotControl._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),this.model.enableGroupingBar){var a=JSON.parse(this.getOlapReport());this._pivotTableFields=JSON.parse(a.ItemsProperties),this._createGroupingBar(a),this.element.find(".e-grpRow .e-rows").text(""),this.element.find(".e-grpRow .e-rows").children().remove(),this.element.find(".e-grpRow .e-rows").append(this._pivotRow),this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())}this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this._calculatedField.length>0&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&null!=this._schemaData&&this._schemaButtonCreate(),t.Pivot.closePreventPanel(this)},_clientRemovePvtBtn:function(i){t.PivotAnalysis._valueSorting=null,t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show();var l=e(e(i.target).siblings()[0]).attr("data-fieldName");delete this._fieldMembers[l.toLowerCase()],delete this._fieldSelectedMembers[l.toLowerCase()],this._calculatedField.length>0&&e.grep(this.model.dataSource.values,function(e){return e.fieldName==l}).length>0?this.model.dataSource.values=e.grep(this.model.dataSource.values,function(e){return(null==e.isCalculatedField||0==e.isCalculatedField||-1==e.formula.indexOf(l))&&e.fieldName!=l}):t.Pivot.removeReportItem(this.model.dataSource,l,0==l.toLocaleLowerCase().indexOf("measures")),this.refreshControl(),t.isNullOrUndefined(this._schemaData)||(this._schemaData._tableTreeObj.element.find("li[data-tag='"+l+"']").removeClass("filter").find(".treeDrop,.filter").remove(),this._schemaData.refreshControl())},_removePvtBtn:function(i){var l,a,r,o,s,n,d,h;if(this._isUpdateRequired=!0,this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){if("click"==i.type){var c=e(e(i.target).siblings()[0]).attr("data-fieldName"),p="",u="";e(e(i.target).siblings()[0]).text()}else{c=i.element.attr("data-fieldName"),p="",u="";i.element.text()}for(o=0;o<this.element.find(".e-pivotButton").length;o++)(u=e(this.element.find(".e-pivotButton")[o]).find("button").attr("data-fieldName"))==c&&(p=e(this.element.find(".e-pivotButton")[o]));if(e(p).remove(),null!=this._schemaData){if(d=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this._schemaData._tableTreeObj.element.find("li [data-tag='"+c+"']"):this._schemaData._tableTreeObj.element.find("li[id='"+c+"']"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&0==d.length&&"measures"==c.toLowerCase()){for(this._schemaData.element.find("div[data-tag='"+p.attr("data-tag")+"']").remove(),o=0;o<this.model.dataSource.values[0].measures.length;o++)this._schemaData._nodeCheck=!0,selectedTreeNode=this._schemaData._tableTreeObj.element.find("li[data-tag='"+this.model.dataSource.values[0].measures[o].fieldName+"']"),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode),this.element.find("div[data-tag='values:"+this.model.dataSource.values[0].measures[o].fieldName+"']").remove(),this._schemaData.element.find("div[data-tag='values:"+this.model.dataSource.values[0].measures[o].fieldName+"']").remove();this.model.dataSource.values[0].measures=[],t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.getJSONData({action:"removeBtn"},this.model.dataSource,this)}this._schemaData._tableTreeObj.uncheckNode(d)}else this.model.dataSource.columns=e.grep(this.model.dataSource.columns,function(e){return e.fieldName!=c}),this.model.dataSource.rows=e.grep(this.model.dataSource.rows,function(e){return e.fieldName!=c}),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?"measures"==p.attr("data-tag").split(":")[1].toLowerCase()?this.model.dataSource.values[0].measures=[]:this._getItemPosition(this.model.dataSource.values[0].measures,p.attr("data-tag").split(":")[1]).length>0&&this.model.dataSource.values[0].measures.splice(this._getItemPosition(this.model.dataSource.values[0].measures,p.attr("data-tag").split(":")[1])[0],1):this.model.dataSource.values=this._calculatedField.length>0?e.grep(this.model.dataSource.values,function(e){return(null==e.isCalculatedField||0==e.isCalculatedField||-1==e.formula.indexOf(c))&&e.fieldName!=c}):e.grep(this.model.dataSource.values,function(e){return e.fieldName!=c}),this.model.dataSource.filters=e.grep(this.model.dataSource.filters,function(e){return e.fieldName!=c}),this.model.analysisMode!=t.Pivot.AnalysisMode.Olap&&this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode?(this.model.editCellsInfo={},this._populatePivotGrid()):(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.dataSource=this.clearDrilledItems(this.model.dataSource,{action:"removeButton"},this),this.getJSONData({action:"removeButton"},this.model.dataSource,this))}else{if("click"==i.type?(c=e(e(i.target).siblings("button")).attr("data-fieldCaption"),g=e(e(i.target).siblings("button")).parent().attr("data-tag")):(c=i.element.attr("data-fieldCaption"),g=i.element.parent().attr("data-tag")),!t.isNullOrUndefined(this._tempFilterData)&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)for(l=0;l<this._tempFilterData.length;l++)for(a in this._tempFilterData[l])a==g.split(":")[1]&&""!=this._tempFilterData[l][g.split(":")[1]]&&this._tempFilterData.splice(l,1);delete this._fieldMembers[g.split(":")[g.split(":").length-1]],delete this._fieldSelectedMembers[g.split(":")[g.split(":").length-1]];var m="",g=(p="",""),f=(u="","");for(p=this.element.find(".e-pivotButton:contains("+c+")"),o=0;o<this._pivotTableFields.length;o++)this._pivotTableFields[o].name==c&&(this._pivotTableFields[o].isSelected=!1,g=this._pivotTableFields[o]);try{f=JSON.parse(this.getOlapReport()).Report}catch(e){f=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(g=e(p).attr("data-tag"),r=e(p).parents().hasClass("values")&&-1==g.indexOf("[Measures]"),"[Measures]"==(u=g.indexOf("[Measures]")>-1||g.indexOf("KPI")>-1||r||g.indexOf("[")>-1?g.split(":")[1]:this._getNodeUniqueName(g))||"KPI"==u||r){if(g=r?g+":KPI":g,p.remove(),!t.isNullOrUndefined(this._schemaData))for(this._schemaData.element.find(".e-pivotButton:contains("+c+")").remove(),o=0;o<this._schemaData.model.pivotCalculations.length&&(g.indexOf("Measures")>-1||g.indexOf("KPI")>-1||e(p).parents().hasClass("values")&&-1==g.indexOf("[Measures]"));o++)u=this._schemaData.model.pivotCalculations[o].Tag,this._schemaData._isMeasureBtnRemove=!0,selectedTreeNode=this._getNodeByUniqueName(u),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);this._waitingPopup.show(),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"removeButton",element:this.element,customObject:this.model.customObject}),h=JSON.stringify(this.model.customObject),n=JSON.stringify({action:"removeButton",headerInfo:g,currentReport:f,gridLayout:this.model.layout,customObject:h}),!t.isNullOrUndefined(this._schemaData)&&(g.indexOf("[Measures]")<0||g.indexOf("KPI")<0)&&(g.indexOf("Measures")>=0||g.indexOf("KPI")>=0)&&this._schemaData.element.find(".e-schemaValue .e-pivotButton").remove(),this.model.enableDeferUpdate&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?(this._removeButtonDeferUpdate=!0,this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,n.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess),this.element.find(".schemaNoClick").removeClass("freeze"),this._waitingPopup.hide()):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,n,this._pvtBtnDroppedSuccess)}else if(t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),t.isNullOrUndefined(this._schemaData)){if(h=JSON.stringify(this.model.customObject),n=JSON.stringify({action:"removeButton",headerInfo:g,currentReport:f,gridLayout:this.model.layout,customObject:h}),t.isNullOrUndefined(g))return!1;this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,n.replace("removeButton","removeButtonDeferUpdate"),this._pvtBtnDroppedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeButton,n,this._pvtBtnDroppedSuccess)}else selectedTreeNode=this._getNodeByUniqueName(u),this._schemaData._tableTreeObj.uncheckNode(selectedTreeNode);else m="schemaRow::"+g.id+"::FILTERED",s=""!=this._droppedClass?this._droppedClass:"PivotItem"==g.pivotType?"e-schemaRow":"e-schemaValue",this._droppedClass="",e(p).remove(),this._waitingPopup=this.element.data("ejWaitingPopup"),t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),null!=this._schemaData?(d=this._schemaData._tableTreeObj.element.find("li:contains('"+c+"')"),this._schemaData._tableTreeObj.uncheckNode(d)):(null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),h=JSON.stringify(this.model.customObject),n=JSON.stringify({action:"nodeStateModified",headerTag:JSON.stringify(g),dropAxis:s+"::",sortedHeaders:this._ascdes,filterParams:m,currentReport:f,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:h}),this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeStateModified,n.replace("nodeStateModified","nodeStateModifiedDeferUpdate"),this._nodeStateModifiedSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeStateModified,n,this._nodeStateModifiedSuccess))}},_getNodeUniqueName:function(e){for(var t="",i=0;i<e.split(":")[1].split(".").length;i++)""!=t&&(t+="."),t+="["+e.split(":")[1].split(".")[i]+"]";return t},_getNodeByUniqueName:function(t){for(var i=null,l=0;l<e(this._schemaData._tableTreeObj.element.find("li")).length;l++)e(this._schemaData._tableTreeObj.element.find("li")[l]).attr("data-tag").toLowerCase()==t.toLowerCase()&&(i=e(this._schemaData._tableTreeObj.element.find("li")[l]));return i},_nodeStateModifiedSuccess:function(e){e[0]!=l?null!=e[2]&&e[2]!=l&&(this.model.customObject=e[2].Value):e.d!=l?null!=e.d[2]&&e.d[2]!=l&&(this.model.customObject=e.d[2].Value):null!=e.customObject&&e.customObject!=l&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"nodeStateModified",element:this.element,customObject:this.model.customObject}),this.model.enableDeferUpdate?this._deferUpdateSuccess(e):this._renderControlSuccess(e)},_drillDownSuccess:function(i){if(i[0]!=l)this.setJSONRecords(i[0].Value),this.setOlapReport(i[1].Value),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i[1].Value).Report,i[2].Value!=l&&"undefined"!=i[2].Value&&(this._pivotClientObj.reports=i[2].Value)),null!=i[3]&&i[3]!=l&&"PageSettings"==i[3].Key&&(this.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i[4].Value).Column/JSON.parse(i[3].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i[4].Value).Row/JSON.parse(i[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i[3].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i[3].Value).SeriesPageSize):null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l?this._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)):t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i[4].Value),JSON.parse(i[3].Value)),null!=i[5]&&i[5]!=l&&(this.model.customObject=i[5].Value)),null!=i[3]&&i[3]!=l&&"PageSettings"!=i[3].Key&&(this.model.customObject=i[3].Value);else if(i.d!=l)this.setJSONRecords(i.d[0].Value),this.setOlapReport(i.d[1].Value),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i.d[1].Value).Report,i.d[2].Value!=l&&"undefined"!=i.d[2].Value&&(this._pivotClientObj.reports=i.d[2].Value),this._updatePageSettings(i.d,this._pivotClientObj)),null!=i.d[3]&&i.d[3]!=l&&"PageSettings"==i.d[3].Key&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.d[4].Value).Column/JSON.parse(i.d[3].Value).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.d[4].Value).Row/JSON.parse(i.d[3].Value).SeriesPageSize),this._categCurrentPage=JSON.parse(i.d[3].Value).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.d[3].Value).SeriesCurrentPage):null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l?this._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)):t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._pagerObj||this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.d[4].Value),JSON.parse(i.d[3].Value)),null!=i.d[5]&&i.d[5]!=l&&(this.model.customObject=i.d[5].Value)),null!=i.d[3]&&i.d[3]!=l&&"PageSettings"!=i.d[3].Key&&(this.model.customObject=i.d[3].Value);else{if(t.isNullOrUndefined(i.PivotRecords))return(t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup)&&t.isNullOrUndefined(this._pivotClientObj)?t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.hide()):(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._waitingPopup.hide()),!1;this.setJSONRecords(i.PivotRecords),this.setOlapReport(i.OlapReport),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj.currentReport=JSON.parse(i.OlapReport).Report,i.ClientReports!=l&&"undefined"!=i.ClientReports&&(this._pivotClientObj.reports=i.ClientReports),i.PageSettings!=l&&null!=i.PageSettings&&null!=this._pivotClientObj._pagerObj&&this._pivotClientObj._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),i.PageSettings!=l&&null!=i.PageSettings&&(this.model.enableVirtualScrolling||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableVirtualScrolling?(this._categPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Column/JSON.parse(i.PageSettings).CategoricalPageSize),this._seriesPageCount=Math.ceil(JSON.parse(i.HeaderCounts).Row/JSON.parse(i.PageSettings).SeriesPageSize),this._categCurrentPage=JSON.parse(i.PageSettings).CategoricalCurrentPage,this._seriesCurrentPage=JSON.parse(i.PageSettings).SeriesCurrentPage):this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=l&&this._pagerObj.initPagerProperties(JSON.parse(i.HeaderCounts),JSON.parse(i.PageSettings))),null!=i.customObject&&i.customObject!=l&&(this.model.customObject=i.customObject)}null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("afterServiceInvoke",{action:"drillDown",element:this.element,customObject:this.model.customObject}),this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&0==this.model.enableVirtualScrolling&&null==e(".e-pivotpager")[0]?this.excelLikeLayout(this.getJSONRecords()):this.renderControlFromJSON(this.getJSONRecords());try{this.model.currentReport=JSON.parse(this.getOlapReport()).Report}catch(e){this.model.currentReport=this.getOlapReport()}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("gridDrillSuccess",this.element),this._trigger("drillSuccess",this.element),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup?t.isNullOrUndefined(this._pivotClientObj)?t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.hide()):((!this._pivotClientObj||this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._startDrilldown)&&"gridOnly"!=this._pivotClientObj.model.displaySettings.mode||(this._pivotClientObj._isTimeOut=!1),this._pivotClientObj._waitingPopup.hide()):e("#"+this._pivotClientObj._id+"_maxView")[0]&&this._maxViewLoading?(this._maxViewLoading.hide(),this._pivotClientObj._waitingPopup.hide()):"gridOnly"==this._pivotClientObj.model.displaySettings.mode&&this._pivotClientObj._waitingPopup.hide(),t.isNullOrUndefined(this._pivotClientObj)?this._waitingPopup.hide():(this._pivotClientObj._isTimeOut=!1,this._pivotClientObj._pivotGrid._startDrilldown=!1);var a={action:this._drillAction,customObject:this.model.customObject,element:this.element};this._trigger("renderSuccess",a)},saveReport:function(e,i,l){var a,r,o;"local"==i.toLowerCase()?this._trigger("saveReport",{report:this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?this.model.dataSource:this.getOlapReport()}):(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(r=JSON.stringify(this.model.dataSource),a="clientMode"):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(r=JSON.parse(this.getOlapReport()).Report,a="serverMode"),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"saveReport",element:this.element,customObject:this.model.customObject}),o=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:e,clientReports:r,operationalMode:a,customObject:o})))},loadReport:function(e,i,l){var a,r,o,s;if(this._waitingPopup.show(),"local"==i.toLowerCase())if(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode)this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode}),this.refreshPivotGrid();else{this._trigger("loadReport",{targetControl:this,dataModel:this.model.analysisMode});try{o=JSON.parse(this.getOlapReport()).Report}catch(e){o=this.getOlapReport()}null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject}),s=JSON.stringify(this.model.customObject),a=JSON.stringify({action:"loadReport",gridLayout:this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.model.layout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:e,operationalMode:"serverMode",clientReports:o,customObject:s}),this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.loadReport,a,this._loadReportSuccess)}else null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:this.model.customObject}),s=JSON.stringify(this.model.customObject),this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(r="clientMode",this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.loadReport,JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:e,operationalMode:r,customObject:s}),this._loadReportSuccess)):this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(r="serverMode",a=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?JSON.stringify({action:"loadReport",reportName:e,gridLayout:this.model.layout,enablePivotFieldList:this.model.enablePivotFieldList,operationalMode:r,customObject:s}):JSON.stringify({action:"loadReport",gridLayout:this.layout(),enablePivotFieldList:this.model.enablePivotFieldList,reportName:e,operationalMode:r,customObject:s}),this.doAjaxPost("POST",l+"/"+this.model.serviceMethodSettings.loadReport,a,this._loadReportSuccess))},_loadReportSuccess:function(e){this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode?(e.d!=l&&e.d.length>0?this.setOlapReport(JSON.parse(e.d[0].Value)):this.setOlapReport(JSON.parse(e.report)),this.model.dataSource=this.getOlapReport(),this.refreshPivotGrid(),this._unWireEvents(),this._wireEvents()):this._renderControlSuccess(e),!t.isNullOrUndefined(this._schemaData)&&this.model.enablePivotFieldList&&this._schemaData._load()},doAjaxPost:function(i,a,r,o,s,n){var d,h,c,p,u,m;t.isNullOrUndefined(r.XMLA)&&"cellEditing"!=JSON.parse(r).action&&(this.model.editCellsInfo={}),p=!0,u=this.model.enableXHRCredentials||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableXHRCredentials,r.XMLA==l?(d="application/json; charset=utf-8",h="json",c=e.proxy(o,this),p=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9||"export"==JSON.parse(r).action)):(d="text/xml",h="xml",r=r.XMLA,c=e.proxy(o,t.olap.base,n),p=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)&&(!t.isNullOrUndefined(n)&&"loadFieldElements"!=n.action)),m={type:i,url:a,contentType:d,async:p,dataType:h,data:r,success:c,xhrFields:{withCredentials:u},complete:t.proxy(function(i){if(e.proxy(i,this),null!=this.model){var l={action:t.isNullOrUndefined(n)||t.isNullOrUndefined(n.action)?JSON.parse(r).action:n.action,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",l)}},this),error:t.proxy(function(e){void 0!==this._waitingPopup&&null!=this._waitingPopup&&this._waitingPopup.hide(),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup||this._pivotClientObj._waitingPopup.hide();var i={action:""!=this._drillAction?this._drillAction:"initialize",customObject:this.model.customObject,element:this.element,Message:e};this._trigger("renderFailure",i),this.renderControlFromJSON(""),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&t.Pivot._createErrorDialog(e.statusText,this._getLocalizedLabels("Error"),this),e.statusText},this)},u||delete m.xhrFields,e.ajax(m)},doPostBack:function(t,i){var l=e("<form>").attr({action:t,method:"POST",name:"export"}),a=function(t,i){e('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(l)};for(var r in i)a(r,i[r]);l.appendTo(document.body).submit().remove()},_import:function(e){if(window.FormData&&this._isObject(e)){var t,i=new FormData;for(t in e)"async"!=t&&i.append(t,e[t]);return i}return e},_isObject:function(e){return"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)},refreshPagedPivotGrid:function(e,i){var l;if(this._isUpdateRequired=!0,t.isNullOrUndefined(this._pivotClientObj)&&(this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.show()),e=-1!=e.indexOf("categ")?"categorical":"series",this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(this._isNavigation=!0,"categorical"==e?this.model.dataSource.pagerOptions.categoricalCurrentPage=parseInt(i):this.model.dataSource.pagerOptions.seriesCurrentPage=parseInt(i),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){try{l=JSON.parse(this.getOlapReport()).Report}catch(e){l=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",axis:e,pageNo:i,drillHeaders:JSON.stringify(this._drillHeaders),currentReport:l,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}else this._refPaging();return!1}if(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)"categorical"==e?this._categCurrentPage=parseInt(i):this._seriesCurrentPage=parseInt(i),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else{try{l=JSON.parse(this.getOlapReport()).Report}catch(e){l=this.getOlapReport()}this.model.enableDeferUpdate?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"pagingDeferUpdate",pagingInfo:e+":"+i,currentReport:l,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._deferUpdateSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:e+":"+i,currentReport:l,layout:this.layout(),customObject:JSON.stringify(this.model.customObject)}),this._renderControlSuccess)}},_refPaging:function(){t.PivotAnalysis._controlObj=this,t.PivotAnalysis._colKeysCalcValues=e.extend(!0,[],this._colKeysCalcValues),t.PivotAnalysis._rowKeysCalcValues=e.extend(!0,[],this._rowKeysCalcValues),t.PivotAnalysis._tableKeysCalcValues=e.extend(!0,[],this._tableKeysCalcValues);var i=t.PivotAnalysis._fillEngine(this.model);this.setJSONRecords(JSON.stringify(i.json)),this.model.enableGroupingBar&&this._createGroupingBar(this.model.dataSource),this.renderControlFromJSON(i.json)},excelLikeLayout:function(i){var l,a,r,o,s,n,d,h,c,p,u,m,g;for(this._excelRowCount=0,u=0;u<i.length&&0==parseInt(i[u].Index.split(",")[0]);u++)this._excelRowCount++;this._rowCount=this._excelRowCount;var f=jQuery.extend(!0,[],i),b=[],_=[],v=null,C=0;if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&(l=e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._pivotClientObj.getOlapReport():this.getOlapReport()),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&0==this.model.dataSource.rows.length&&null!=this.model.dataSource.data||this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&""!==l&&0==JSON.parse(l).PivotRows.length))return this._excelLikeJSONRecords=null,this._isExporting||this.renderControlFromJSON(),void(this._excelRowCount=0);if(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&null!=f&&""!=f){for(a=null,c="colheader"!=f[0].CSS?f[0].ColSpan*this._excelRowCount:0;c<f.length&&(f[c].Info.toLowerCase().indexOf("[measure")>-1&&(a=parseInt(f[c].Index.split(",")[1])),!(f[c].CSS.indexOf("value")>-1));c++)r=parseInt(f[c].Index.split(",")[1]);for(null!=a&&a!=r&&0!=a&&this._columnExcelLikeLayout(f,a,r),o=f.length/this._excelRowCount,s=0;s<o&&s<f.length;s++)for(n=0;n<=r&&n<f.length;n++)if("colheader"==f[u=s*this._excelRowCount+n].CSS&&"Block"!=f[u].Span&&(-1==f[u].Info.toLowerCase().indexOf("[measure")||f[u].Info.toLowerCase().indexOf("[measure")>-1&&null!=a&&0==a)&&f[u].ColSpan>1){for(m=u;m<u+f[u].RowSpan;m++){for(g=m+this._excelRowCount;g<m+f[u].ColSpan*this._excelRowCount;g+=this._excelRowCount)f[g].Span="Block";m!=u&&(f[m].Span="Block")}if(h=null,f[d=u+(f[u].RowSpan-1)+(f[u].ColSpan-1)*this._excelRowCount+1].CSS.indexOf("summary")>-1&&f[d].Value==this._getLocalizedLabels("Total")&&-1==f[d-this._excelRowCount].CSS.indexOf("summary"))h=d;else if(f[d].CSS.indexOf("summary")>-1&&f[d-this._excelRowCount].CSS.indexOf("e-summary")>-1)for(m=d-this._excelRowCount;m>=0&&m<f.length;m-=this._excelRowCount)if(f[m].ColSpan>1||-1==f[m-this._excelRowCount].CSS.indexOf("e-summary")&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){h=m;break}null!=h&&(f[h].ColSpan=this.model.operationalMode!=t.PivotGrid.OperationalMode.ClientMode?f[h].ColSpan:parseInt(f[d].Index.split(",")[0])-parseInt(f[h].Index.split(",")[0])+1,f[u].ColSpan=f[u].ColSpan-f[h].ColSpan,f[u+f[u].ColSpan*this._excelRowCount]=e.extend(!0,{},f[h]),f[u+f[u].ColSpan*this._excelRowCount].RowSpan=f[h].RowSpan+f[u].RowSpan,f[u+f[u].ColSpan*this._excelRowCount].Value=f[u].Value+" Total")}}if(null!=f&&""!=f&&"colheader"!=f[0].CSS&&(this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||this.model.operationalMode!=t.PivotGrid.OperationalMode.ServerMode)){if("0,0"==f[0].Index&&"colheader"!=f[0].CSS)for(C=f[0].ColSpan,0==f[0].RowSpan&&(f[0].RowSpan=1),m=0;m<f[0].RowSpan&&m<f.length;m++)b.push(f[m]),f[m].Level=1,f[m].Span="Block";for(c=f[0].RowSpan;c<f.length&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.dataSource.rows.length>0;c+=this._excelRowCount)if(f[c].Info.toLowerCase().indexOf("[measure")>-1){v=parseInt(f[c].Index.split(",")[0]);break}for(u=0;u<f.length&&u<this._excelRowCount;u++)if("rowheader"==f[u].CSS&&0==parseInt(f[u].Index.split(",")[0])&&"Block"!=f[u].Span){for(f[u].Level=1,null!=f[u+this._excelRowCount]&&-1==f[u+this._excelRowCount].CSS.indexOf("value")&&(f[u].itemIndex=f[u+f[u].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),b.push(f[u]),null!=v&&0==v&&f[u].Info.toLowerCase().indexOf("[measure")>-1&&_.push(f[u]),m=u+1;m<u+f[u].RowSpan;m++)(-1==f[m].Info.toLowerCase().indexOf("[measure")||null!=v&&v!=C-1)&&(f[m].Span="Block");this._rowExcelLikeLayout(u,f,b,2,v,_,C)}else("summary rgtot"==f[u].CSS||"summary gtot"==f[u].CSS||"summary calc gtot"==f[u].CSS||"colheader"==f[u].CSS&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||("summary"==f[u].CSS&&f[u].Value.indexOf(this._getLocalizedLabels("Total"))>-1||"summary row"==f[u].CSS)&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot)&&0==parseInt(f[u].Index.split(",")[0])&&(null!=v&&v==C-1&&(f[u].Value+=" "+f[u+this._excelRowCount*parseInt(f[u].ColSpan)].Value),f[u].Value=f[u].Value==this._getLocalizedLabels("Total")?this._getLocalizedLabels("GrandTotal"):f[u].Value,b.push(f[u]),f[u].Level=1);if(null!=v&&0==v){for(u=0;u<_.length;u++)b.push(e.extend(!0,{},_[u])),b[b.length-1].CSS="summary",b[b.length-1].Value=this._getLocalizedLabels("Total")+" "+b[b.length-1].Value;_.splice(0,_.length)}var S,O=b.length,T=0,y=!1;for(u=0;u<O;u++){for(T+=u,S=null!=b[u].itemIndex?b[u].itemIndex:b[u].Index,p=parseInt(S.split(",")[0])*this._excelRowCount+parseInt(S.split(",")[1]);p<f.length;p+=this._excelRowCount)(f[p].CSS.indexOf("value")>-1||f[p].CSS.indexOf("colheader")>-1||f[p].CSS.indexOf("calc")>-1||f[p].CSS.indexOf("cstot")>-1||f[p].CSS.indexOf("cgtot")>-1||f[p].CSS.indexOf("none")>-1)&&parseInt(f[p].Index.split(",")[0])>=C&&(y=!0),y&&(b[T+=this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?parseInt(O):this._excelRowCount]=e.extend(!0,{},f[p]));T=0,y=!1}for(u=0;u<O;u++)null!=b[u]&&(b[u].Span="none",isNaN(b[u].Level)&&(b[u].Level=1),"0,0"==b[u].Index&&"colheader"!=b[u].CSS&&0==u||(b[u].RowSpan=1),b[u].ColSpan=null!=v&&v==C-1&&"rowheader"==b[u].CSS&&-1==b[u].Info.toLowerCase().indexOf("[measure")?b.length/O:null!=v&&0==v&&b[u].Info.toLowerCase().indexOf("[measure")>-1&&"rowheader"==b[u].CSS?b.length/O:null!=v&&v!=C-1&&0!=v&&(b[u].Info.toLowerCase().indexOf("[measure")>-1||"rowheader"==b[u].CSS&&parseInt(b[u].Index.split(",")[0])<v)?b.length/O:1);this._excelRowCount=O}for(null!=f&&0==b.length&&(b=f),m=0;m<b.length/this._excelRowCount;m++)for(g=0;g<this._excelRowCount;g++)b[m*this._excelRowCount+g].i=m+","+g,b[m*this._excelRowCount+g].Span="none";this._excelLikeJSONRecords=b,this._isExporting||this.renderControlFromJSON()},_rowExcelLikeLayout:function(e,i,l,a,r,o,s){for(var n,d,h,c=!1,p=e+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?i[e].ColSpan*this._excelRowCount:this._excelRowCount),u=0;u<i[e].RowSpan&&p<i.length&&-1==i[p].CSS.indexOf("value");p++,u++){if(null!=r&&r!=s-1&&0!=r&&i[p].Info.toLowerCase().indexOf("[measure")>-1&&"Block"!=i[p].Span&&(c=!0),n=null!=r&&r==s-1?"summary row"==i[p].CSS&&("summary row"==i[p+this._excelRowCount].CSS||"none"==i[p+this._excelRowCount].CSS||i[p+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1):null!=r&&r!=s-1&&0!=r&&("summary"==i[p].CSS&&("summary"==i[p+this._excelRowCount].CSS||"none"==i[p+this._excelRowCount].CSS||i[p+this._excelRowCount].Info.toLowerCase().indexOf("[measure")>-1||parseInt(i[p].Index.split(",")[0])-1<=r)),("rowheader"==i[p].CSS||"none"==i[p].CSS||n)&&"Block"!=i[p].Span){for(h=p+1;h<p+i[p].RowSpan;h++)(-1==i[h].Info.toLowerCase().indexOf("[measure")||null!=r&&r!=s-1)&&(i[h].Span="Block");if(i[p].Level=a,"none"!=i[p].CSS)if(null!=i[p+this._excelRowCount]&&-1==i[p+this._excelRowCount].CSS.indexOf("value")&&(i[p].itemIndex=i[p+i[p].RowSpan-(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot?1:0)].Index),n){for(d=p-i[e].ColSpan*this._excelRowCount;d>=0&&d<i.length;d--)if(""!=i[d].Value){i[p].Value=i[d].Value,i[p].Level=i[e].Level;break}null!=r&&r!=s-1&&0!=r&&parseInt(i[p].Index.split(",")[0])-1==r?o.push(i[p]):(i[p].Value+=" "+i[p+this._excelRowCount*parseInt(i[p].ColSpan)].Value,l.push(i[p]))}else l.push(i[p]);i[p].Span="Block","summary row"!=i[p].CSS&&"summary"!=i[p].CSS&&this._rowExcelLikeLayout(p,i,l,a+1,r,o,s)}if(c&&u+1==i[e].RowSpan){for(c=!1,h=0;h<o.length;h++)o[h].Value=i[e].Value+" "+o[h].Value,l.push(o[h]);o.splice(0,o.length)}}},_columnExcelLikeLayout:function(t,i,l){for(var a,r,o,s,n,d,h,c,p,u,m=t.length/this._excelRowCount,g=0;g<m&&g<t.length;g++)for(a=0;a<=l&&a<t.length;a++)if("colheader"==t[r=g*this._excelRowCount+a].CSS&&"Block"!=t[r].Span&&-1==t[r].Info.toLowerCase().indexOf("[measure")&&t[r].ColSpan>1){for(n=r;n<r+t[r].RowSpan;n++){for(c=n+this._excelRowCount;c<n+t[r].ColSpan*this._excelRowCount;c+=this._excelRowCount)t[c].Span="Block";n!=r&&(t[n].Span="Block")}if(t[o=r+(t[r].RowSpan-1)+(t[r].ColSpan-1)*this._excelRowCount+1].Info.toLowerCase().indexOf("[measure")>-1&&JSON.parse(this.getOlapReport()).PivotCalculations.length>1&&null!=i&&i!=l&&0!=i){for(s=[],n=r+t[r].RowSpan;n<=o;n+=(t[n].ColSpan+1)*this._excelRowCount)if(t[d=n+(t[n].RowSpan-1)+(t[n].ColSpan-1)*this._excelRowCount+1].CSS.indexOf("summary")>-1){for(t[d-1].RowSpan=t[d-1].RowSpan+t[d].RowSpan,h=parseInt(t[d].Index.split(",")[0])*this._excelRowCount,c=0;c<this._excelRowCount;c++)t.splice(parseInt(t[o].Index.split(",")[0])*this._excelRowCount+this._excelRowCount+c+s.length*this._excelRowCount,0,e.extend(!0,{},t[h+c]));s.push(h),t[n].ColSpan=t[n].ColSpan-1}for(p=s.length-1;p>=0;p--)t.splice(parseInt(t[s[p]].Index.split(",")[0])*this._excelRowCount,this._excelRowCount);s.length>0&&(t[r].ColSpan=t[r].ColSpan-s.length,t[u=r+t[r].ColSpan*this._excelRowCount].ColSpan=s.length,t[u].RowSpan=t[r].RowSpan,t[u].Value=t[r].Value+" Total",t[u].CSS="summary",t[u].Span="none",t[u].State=0)}else t[o].Info.toLowerCase().indexOf("[measure")>-1&&t[o+1].CSS.indexOf("summary")>-1&&1==JSON.parse(this.getOlapReport()).PivotCalculations.length&&null!=i&&i!=l&&0!=i&&(t[r].ColSpan=t[r].ColSpan-1,t[r+t[r].ColSpan*this._excelRowCount]=e.extend(!0,{},t[o+1]),t[o+1].Value="",t[r+t[r].ColSpan*this._excelRowCount].Value=t[r].Value+" Total",t[r+t[r].ColSpan*this._excelRowCount].RowSpan=t[r].RowSpan)}},_getColumnIndices:function(t,i,l,a){var r="rows"==t?i.Index.split(",")[1]:"columns"==t?i.Index.split(",")[0]:null;return i.Value==l&&(-1==e.inArray(Number(r),a)&&a.push(Number(r))),a},_getParentPosition:function(i,l,a){var r="",o="",s="";for(l=this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout||e.isNumeric(l)?l:parseInt(l.split(",")[0])*this._rowCount+parseInt(l.split(",")[1]);o==r&&!t.isNullOrUndefined(this.getJSONRecords()[l]);)o=this.getJSONRecords()[l].Value,(""==r&&""!=o||r==o+" Total"||r+" Total"==o)&&(r=o),"columnheader"==i&&"start"==a?l-=this._rowCount:"rowheader"==i&&"end"==a&&l++,s=o==r?this.getJSONRecords()[l].Index:s,"columnheader"==i&&"end"==a?l+=this._rowCount:"rowheader"==i&&"start"==a&&l--,o=""==o?r:o;return s},_updateRowCells:function(i,l,a,r,o,s){var n,d,h,c,p,u;s&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&l.find("tbody:eq(2) tr:empty").remove();do{if(this.model.enableRTL&&e(e(i).find(".summary,.rowheader,.colheader")).css("text-align","right"),n=e(i).next().children().first().attr("data-p"),d=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?"data-i":"data-p",t.isNullOrUndefined(n))n=e(i).children().first().attr("data-p"),a.find("[data-p='"+n+"']").length>0&&this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout?""!=r&&a.find("[data-p='"+r+"']").parent().length>0?(e(i).clone().insertBefore(a.find("[data-p='"+r+"']").parent()),a.find("[data-p='"+r+"']").parent().remove()):e(i).clone().insertAfter(a.find("[data-p='"+n+"']").parent()):s?(u=l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent(),e(u).eq(1).clone().insertAfter(a.find("tr:last")),e(u).eq(0).clone().insertAfter(a.find(".rowhead tr:last"))):e(i).clone().insertAfter(a.find("tr:last")),a.find("[data-p='"+e(i).children().first().attr("data-p")+"']").parent().last().prev().find("[data-p='"+e(i).children().first().attr("data-p")+"']").parent().remove();else if(s||this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i).children().length>0&&a.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent().remove():a.find("[data-p='"+e(i).children().first().attr("data-p")+"']:not('.e-grpRow')").parent().remove(),""!=r&&a.find("[data-p='"+r+"']").parent().length>0)if(s||e(i).clone().insertBefore(a.find("[data-p='"+r+"']").parent()),s){if(e(i).children().length>0){h=0;do{c=a.find("["+d+"$=',"+parseInt(r.split(",")[1])+"']").parent().eq(h),u=l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent().eq(h).clone(),e(c).length>0?e(u).insertBefore(e(c)):e(u).insertAfter(a.find("["+d+"$=',"+parseInt(l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent().eq(h).prev().children().first().attr(d).split(",")[1])+"']").parent().eq(h)),h++}while(h<2);this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout&&a.find("["+d+"$=',"+parseInt(r.split(",")[1])+"']").parent().remove()}}else this.layout().toLowerCase()!=t.PivotGrid.Layout.ExcelLikeLayout&&a.find("[data-p='"+r+"']").parent().remove();else if(s){if(0==a.find("["+d+"$=',"+parseInt(n.split(",")[1])+"']").parent().length){p=e(i).next();do{n=e(p).next().children().length>0?e(p).next().children().first().attr(d):n,p=e(p).next()}while(0==a.find("["+d+"$=',"+parseInt(n.split(",")[1])+"']").parent().length&&e(p).children().length>0)}e(i).children().length>0&&(c=a.find("["+d+"$=',"+parseInt(n.split(",")[1])+"']").parent(),u=l.find("["+d+"$=',"+parseInt(e(i).children().first().attr(d).split(",")[1])+"']").parent(),e(c).length>0?(e(u).eq(0).clone().insertBefore(e(c).eq(0)),e(u).eq(1).clone().insertBefore(e(c).eq(1))):(e(u).eq(1).clone().insertAfter(a.find("tr:last")),e(u).eq(0).clone().insertAfter(a.find(".rowhead tr:last"))))}else if(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout)e(i).clone().insertAfter(a.find("tr:last"));else{if(0==a.find("[data-p='"+n+"']").parent().length){p=e(i).next();do{n=e(p).next().children().first().attr("data-p"),p=e(p).next()}while(0==a.find("[data-p='"+n+"']").parent().length&&e(p).children().length>0)}a.find("[data-p='"+n+"']").parent().length>0?e(i).clone().insertBefore(a.find("[data-p='"+n+"']").parent()):e(i).clone().insertAfter(a.find("tr:last"))}i=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i).next():e(i).prev()}while(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(i).length>0&&0==e(i).children("[data-p='"+r+"']").length:0==e(i).next().children("[data-p='"+o+"']").length&&e(i).length>0&&e(i).next().children().length>0&&parseInt(e(i).next().children().first().attr("data-p").split(",")[1])>parseInt(o.split(",")[1]))},_getAdjacentRowPos:function(t,i,l){var a,r=[],o=l;do{a=i+","+l,r=e(t.find("[data-p='"+a+"']")),--l<0&&(i-=1,o=l=o+1)}while(0==r.length&&i>-1);return a},_mergeHtml:function(i,l,a,r){var o,s,n,d,h,c,p,u=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,m=a.find("[data-p='"+l+"']").children("span")[0];if("rowheader"==i){var g=parseInt(l.split(",")[1]),f="",b="";if(f=this._getParentPosition(i,this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?l:g,"start"),b=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._getParentPosition(i,l,"end"):b,b=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&0==r.find("[data-p='"+b+"']").parent().length?"drilldown"==this._drillAction?r.find("[data-p='"+l+"']").parent().next().children().first().attr("data-p"):a.find("[data-p='"+l+"']").parent().next().children().first().attr("data-p"):b,"drilldown"==this._drillAction){if(t.isNullOrUndefined(m)){for(o=(parseInt(l.split(",")[0])+1)*this._rowCount+parseInt(l.split(",")[1])-1,b=l;!t.isNullOrUndefined(this._JSONRecords[o])&&this._JSONRecords[o].CSS.indexOf("summary")>-1&&0==e(a.find("[data-p='"+this._JSONRecords[o].Index+"']")).length;)o=o+this._rowCount-1;l=this._JSONRecords[o].Index,l=e(a.find("[data-p='"+l+"']")).length>0?l:this._getAdjacentRowPos(a,parseInt(l.split(",")[0]),parseInt(l.split(",")[1]))}_=e(a.find("[data-p='"+l+"']").children("span")[0]).closest("tr")[0],this._updateRowCells(_,a,r,b,f,u)}else{var _=e(r.find("[data-p='"+l+"']").closest("tr")[0]),v=parseInt(r.find("[data-p='"+l+"']").attr("rowSpan")),C=0,S=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?"data-i":"data-p";do{s=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(_).children().first().attr("data-i"):e(_).children().first().attr("data-p"),_=e(_).next(),u||this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?r.find("["+S+"$=',"+parseInt(s.split(",")[1])+"']").parent().remove():r.find("[data-p='"+s+"']:not('.e-grpRow')").parent().remove(),C++}while(this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?e(_).children().first().attr("data-p")!=b:C<v);_=this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?a.find("[data-p='"+l+"']").parent():a.find("[data-p='"+e(_).children().first().attr("data-p")+"']").parent().length>0?a.find("[data-p='"+e(_).children().first().attr("data-p")+"']").parent():u?e(a).find(".rowhead tr:last"):e(a).find("tr:last"),this._updateRowCells(_,a,r,b,f,u)}}else{var O=parseInt(l.split(",")[0])*this._rowCount;f="",b="";f=this._getParentPosition(i,O,"start"),n=!1,this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns.length>0&&e.each(JSON.parse(this.getOlapReport()).PivotColumns,function(e,t){if(0==t.showSubTotal)return n=!0,!1}):this.model.dataSource.columns.length>0&&e.each(this.model.dataSource.columns,function(e,t){if(0==t.showSubTotal)return n=!0,!1}),("drillup"==this._drillAction||n)&&(b=this._getParentPosition(i,O,"end"),l=b);var T=u?e(a).find(".pivotGridFrozenTable,.pivotGridValueTable").find("tr:not(.hdrTr)"):e(a).find("tr:not(.hdrTr)"),y=u?e(r).find(".pivotGridFrozenTable,.pivotGridValueTable").find("tr:not(.hdrTr)"):e(r).find("tr:not(.hdrTr)");for(this.model.enableRTL&&e(T).find(".summary,.rowheader,.colheader").css("text-align","right"),d=0;d<T.length;d++)h=e(T[d]).children().filter(function(){return e(this).attr("data-p").split(",")[0]>parseInt(f.split(",")[0])&&e(this).attr("data-p").split(",")[0]<=parseInt(l.split(",")[0])}),c=e(y[d]).children().filter(function(){return e(this).attr("data-p").split(",")[0]>parseInt(f.split(",")[0])&&e(this).attr("data-p").split(",")[0]<=parseInt(l.split(",")[0])}),0==e(y[d]).children().length?e(y[d]).append(h):e(y[d]).find("").eq(0).prev().length>0?(p=c.eq(0).prev(),c.remove(),h.insertAfter(p)):(c.remove(),e(y[d]).children(".colheader,.rowheader,.summary,.value").eq(0).length>0?h.eq(0).prev().length>0?h.insertAfter(e(y[d]).find('[data-p="'+h.eq(0).prev().attr("data-p")+'"]')):h.insertBefore(e(y[d]).children(".colheader,.rowheader,.summary,.value").eq(0)):e(y[d]).append(h))}},_cropHtml:function(t){return this._table=e(t).clone(),e(e(t)).find('[style*="display: none"]').remove(),t},renderControlFromJSON:function(){var i,l,a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y,x,M,P,w,L,N,D,R,j,I,F;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this.model.enablePaging||this.model.enableVirtualScrolling)&&0==this._isNavigation&&(i=this,l=setInterval(function(){if(null!=i._pagerObj){clearInterval(l);var e={CategoricalCurrentPage:i.model.dataSource.pagerOptions.categoricalCurrentPage,CategoricalPageSize:i.model.dataSource.pagerOptions.categoricalPageSize,SeriesCurrentPage:i.model.dataSource.pagerOptions.seriesCurrentPage,SeriesPageSize:i.model.dataSource.pagerOptions.seriesPageSize},t={Column:i._categPageCount,Row:i._seriesPageCount};i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(t,e)}},10)),this._isNavigation=!1,a=null,!t.isNullOrUndefined(this.model.valueSortSettings)&&this.element.find(".valueSorting").length>0&&!t.isNullOrUndefined(t.PivotAnalysis._valueSorting)&&(a=this.element.find(".valueSorting").parent()),r=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelLikeJSONRecords:this.getJSONRecords(),!this.model.enableJSONRendering&&!this.model.enableDefaultValue&&!t.isNullOrUndefined(r)&&r.length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?0==JSON.parse(this.getOlapReport()).PivotCalculations.length&&t.isNullOrUndefined(JSON.parse(this.getOlapReport()).CalculatedMeasure):0==this.model.dataSource.values.length||0==this.model.dataSource.values[0].measures.length)&&(r=e.map(r,function(e){return e.CSS.indexOf("value")>-1&&(e.Value=""),e}),this.setJSONRecords(JSON.stringify(r))),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&0==this.model.dataSource.values.length&&0==this.model.dataSource.rows.length&&(r=r.filter(function(e){return e.Index=Number(e.Index.split(",")[0])-1+","+e.Index.split(",")[1],-1!=e.Index.split(",")[0]?e:void 0})),t.isNullOrUndefined(r)||(r=this._appendCssClassName(r)),this.model.enableConditionalFormatting&&this._isFormatApply&&!t.isNullOrUndefined(r)&&r.length>0&&(r=this._refreshCellFormatting(r)),this.model.enableConditionalFormatting&&!this._isFormatApply&&!t.isNullOrUndefined(r)&&r.length>0&&(r=this._applyCodeBehindFormatting(r)),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(o=e("<div id="+this._id+"Toolbar style='width:"+this._pivotClientObj._gridWidth+";height:"+this._pivotClientObj._gridHeight+";overflow:auto;margin-top:5px;margin-left:5px'></div>")),null!=r&&""!=r)for(g=0;g<r.length;g++)"Total"==r[g].Value&&(r[g].Value=this._getLocalizedLabels("Total")),"Grand Total"==r[g].Value&&(r[g].Value=this._getLocalizedLabels("GrandTotal"));if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this._applyLocale(r),s=e("<table class=\"e-pivotGridTable\" role='grid'  aria-readonly='true'></table>"),this.model.isResponsive&&s.addClass("e-table"),this.model.enableColumnResizing&&this.model.resizeColumnsToFit&&s.addClass("e-column-resizeToContent"),(!this.model.enableColumnResizing||this.model.resizeColumnsToFit)&&(this.model.enableColumnResizing||this.model.resizeColumnsToFit)||s.addClass("e-column-resizeToSize"),null!=r&&""!=r||this.model.enableGroupingBar){if(null!=r&&""!=r){for(h=this._rowCount,this._rowCount=0,this,C=0;C<r.length&&0==parseInt(r[C].Index.split(",")[0]);C++)this._rowCount++;if(this._rowCount=null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout?this._excelRowCount:this._rowCount,this.model.analysisMode==t.Pivot.AnalysisMode.Olap){var A,E,k,H,V,z,U,B,G,J,q=this._rowCount,K=!1,W=!1,Q=!1,X=!1,Y=e.extend(!0,[],r),$=t.isNullOrUndefined(this._pivotClientObj)?this.model.subTotalSettings:this._pivotClientObj.model.subTotalSettings,Z=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotRows:this.model.dataSource.rows,ee=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns;if(!t.isNullOrUndefined($))for(T=0;T<$.length;T++){for(y=0;y<Z.length;y++)$[T].name==(t.isNullOrUndefined(Z[y].Tag)?Z[y].fieldName:Z[y].Tag)&&(Q=!0);for(y=0;y<ee.length;y++)$[T].name==(t.isNullOrUndefined(ee[y].Tag)?ee[y].fieldName:ee[y].Tag)&&(X=!0)}if(c=t.isNullOrUndefined(this._pivotClientObj)?this.layout():this._pivotClientObj.gridLayout(),!t.isNullOrUndefined($)&&1==Q)for(0==(p=Y.filter(function(e){return"rowheader"==e.CSS&&1!=e.RowSpan&&1==e.State}))&&(p=Y.filter(function(e){return"rowheader"==e.CSS&&1!=e.RowSpan})),g=0;g<$.length;g++)for(T=0;T<$[g].levels.length;T++)if(1==$[g].levels[T].showSubTotal&&"excellikelayout"!=c)for(y=0;y<p.length;y++)if($[g].levels[T].name==p[y].Info.split(".&")[0])for(k=p[y].Index.split(",")[0],H=p[y].ColSpan,V=p[y].Index.split(",")[1],f=0;f<Y.length;f++)if(("summary"==Y[f].CSS||"summary row"==Y[f].CSS)&&!t.isNullOrUndefined(Y[f].Value)&&!t.isNullOrUndefined(Y[f+1])&&Y[f].Index.split(",")[0]==Y[f+1].Index.split(",")[0]&&Y[f].Index.split(",")[0]==(parseInt(k)+H).toString()&&parseInt(V)<=parseInt(Y[f].Index.split(",")[1])){if(K=!0,z=Y[f].Index.split(",")[1],U=Y[f],B=Y[f].RowSpan,Y.splice(e.inArray(U,Y),1),(G=B)>1)for(;1!=G;)U=Y[f],Y.splice(e.inArray(U,Y),1),G--;for(b=0;b<Y.length;b++)if(Y[b].Index.split(",")[1]==z&&(U=Y[b],G=B,Y.splice(e.inArray(U,Y),1),G>1))for(;1!=G;)U=Y[b],Y.splice(e.inArray(U,Y),1),G--;q-=B;break}if(!t.isNullOrUndefined($)&&1==X)for(0==(u=Y.filter(function(e){return"colheader"==e.CSS&&1!=e.ColSpan&&1==e.State}))&&(u=Y.filter(function(e){return"colheader"==e.CSS&&1!=e.ColSpan})),m=(Y.length/this._rowCount-1).toString(),g=0;g<$.length;g++)for(T=0;T<$[g].levels.length;T++)if(1==$[g].levels[T].showSubTotal&&"excellikelayout"!=c)for(y=0;y<u.length;y++)if($[g].levels[T].name==u[y].Info.split(".&")[0])for(z=u[y].Index.split(",")[1],B=u[y].RowSpan,V=u[y].Index.split(",")[0],ColSpan=parseInt(u[y].ColSpan)-1,f=0;f<Y.length;f++)if(("summary"==Y[f].CSS||"summary col"==Y[f].CSS)&&parseInt(Y[f].Index.split(",")[0])!=m&&parseInt(Y[f].Index.split(",")[1])==parseInt(z)+B&&parseInt(Y[f].Index.split(",")[0])<=parseInt(V)+ColSpan&&parseInt(V)<=parseInt(Y[f].Index.split(",")[0])){for(W=!0,k=Y[f].Index.split(",")[0],U=Y[f],H=Y[f].ColSpan,Index=f,Y.splice(e.inArray(U,Y),1),b=0;b<Y.length;b++)Y[b].Index.split(",")[0]==k&&(U=Y[b],colSpancount=(H-1)*q,Y.splice(e.inArray(U,Y),1),b-=1);if(colSpancount>q)for(;colSpancount>0;)U=Y[f-1],Y.splice(e.inArray(U,Y),1),colSpancount--;f--}if(q!=this._rowCount&&1==K)for(_=Y[0].RowSpan;_<Y.length;_++)if(("rowheader"==Y[_].CSS||"summary"==Y[_].CSS||"summary row"==Y[_].CSS)&&1!=Y[_].RowSpan&&!t.isNullOrUndefined(Y[_].State)){for(z=Y[_].Index.split(",")[1],J=Y[_].Index.split(",")[0],B=0,y=0;y<Y[_].RowSpan;y++)parseInt(z)+Y[_].RowSpan>Y[_+y].Index.split(",")[1]&&J==Y[_+y].Index.split(",")[0]&&B++;Y[_].RowSpan=B}if(1==W)for(_=0;_<Y.length;_++)if(("colheader"==Y[_].CSS||"summary"==Y[_].CSS||"summary col"==Y[_].CSS)&&1!=Y[_].ColSpan&&!t.isNullOrUndefined(Y[_].State)){for(z=Y[_].Index.split(",")[1],J=Y[_].Index.split(",")[0],H=0,y=0;y<Y.length;y++)_+y<Y.length&&parseInt(J)+Y[_].ColSpan>parseInt(Y[_+y].Index.split(",")[0])&&z==Y[_+y].Index.split(",")[1]&&(H++,y+=q-1);Y[_].ColSpan=H}}1==K||1==W?(A=Y,E=t.isNullOrUndefined(q)?this._rowCount:q,this._rowLength=t.isNullOrUndefined(q)?this._rowCount:q):(A=r,E=this._rowCount);var te=e("<thead></thead>"),ie=e("<tbody></tbody>"),le=!0,ae=0;for("none"==A[0].CSS?ae=e(this.element).parents(".e-pivotclient").length>0&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&0==JSON.parse(this._pivotClientObj.getOlapReport()).PivotCalculations.length&&0==JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows.length?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns.length-1:A[0].RowSpan-1:(jQuery.each(A,function(e){return ae+=A[e].RowSpan,"colheader"==A[e].CSS}),ae-=2),re=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,v=!1,C=0;C<A.length;C++)if(C<E)if(le){for(le=!(C>=ae),S="<tr role='row'>",this.model.enableGroupingBar&&"0,0"==A[C].Index&&A[C].CSS.indexOf("colheader")>-1&&(S=S+"<"+(re?"td":"th")+" class='e-grpRow' data-p='-1,-1' colspan= 1 rowspan="+(E-1)+"> <div class=e-rows>"+this._getLocalizedLabels("DragFieldHere")+"</div></th>",v=!0),O=C;O<A.length;O+=E)if("Block"!=A[O].Span)if(S="0,0"==A[O].Index&&-1==A[O].CSS.indexOf("colheader")&&this.model.enableGroupingBar?S+"<"+(re?"td":"th")+" class=e-grpRow data-p="+A[O].Index+" colspan="+A[O].ColSpan+" rowspan="+A[O].RowSpan+" role='columnheader' aria-label='row'"+(null==A[O].i?"":"data-i="+A[O].i)+">"+(0==A[O].State?'<span style="margin-left: 0px"></span>':2==A[O].State?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==A[O].State?'<span class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+A[O].Value+t.buildTag("div.e-rows",this._pivotRow,{})[0].outerHTML+"</th>":S+"<"+(re?"td":"th")+("none"==A[O].CSS?"":' class="'+A[O].CSS)+("none"==A[O].CSS?" data-p="+A[O].Index:'" data-p='+A[O].Index)+" colspan="+A[O].ColSpan+" rowspan="+A[O].RowSpan+" role='columnheader'"+(null==A[O].i?"":"data-i="+A[O].i)+">"+(0==A[O].State?'<span style="margin-left: 10px"></span>':2==A[O].State?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==A[O].State?'<span class="e-collapse e-icon" aria-label=\'expanded\' title=" '+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+A[O].Value+"</th>",A[O].RowSpan>1&&A[O].ColSpan<=1)for(T=O+1;T<O+A[O].RowSpan;T++)t.isNullOrUndefined(A[T])||(A[T].Span="Block");else if(A[O].ColSpan>1&&A[O].RowSpan<=1)for(T=O+E;T<O+A[O].ColSpan*E;T+=E)t.isNullOrUndefined(A[T])||(A[T].Span="Block");else if(A[O].ColSpan>1&&A[O].RowSpan>1)for(T=O;T<O+A[O].RowSpan;T++){for(y=T+E;y<T+A[O].ColSpan*E;y+=E)t.isNullOrUndefined(A[y])||(A[y].Span="Block");T!=O&&(t.isNullOrUndefined(A[T])||(A[T].Span="Block"))}""!=e(S+="</tr>").text()&&e(te).append(S)}else{for(S="<tr role='row'>",0==parseInt(A[C].Index.split(",")[0])&&parseInt(A[C].Index.split(",")[1])==E-1&&v&&(S=S+"<td class='rowheader' data-p='-1,-2' colspan=1 rowspan=1>"+(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||this.model.layout==t.PivotGrid.Layout.ExcelLikeLayout?this._getLocalizedLabels("GrandTotal"):this._getLocalizedLabels("Total"))+"</td>"),O=C;O<A.length;O+=E)if("Block"!=A[O].Span)if(S=A[O].CSS.indexOf("rowheader")>-1||"summary"==A[O].CSS||A[O].CSS.indexOf("summary rstot")>-1||A[O].CSS.indexOf("summary stot")>-1||"summary row"==A[O].CSS||A[O].CSS.indexOf("summary rgtot")>-1?"excellikelayout"==this.layout().toLowerCase()?S+"<"+(re?"td":"th")+("none"==A[O].CSS?"":' class="'+A[O].CSS)+'" data-p='+A[O].Index+" colspan="+A[O].ColSpan+" rowspan="+A[O].RowSpan+" role='rowheader'"+(null==A[O].i?"":"data-i="+A[O].i)+">"+(2==A[O].State?'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+10*A[O].Level+'px" class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==A[O].State?'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+10*A[O].Level+'px" class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':'<span style="margin-'+(this.model.enableRTL?"right:":"left:")+(null!=this._excelLikeJSONRecords&&"summary row"==A[O].CSS?10*A[O].Level:10*(1==A[O].Level?1:A[O].Level+2))+'px">&nbsp;</span>')+A[O].Value+"</th>":S+"<"+(re?"td":"th")+("none"==A[O].CSS?"":' class="'+A[O].CSS)+'" data-p='+A[O].Index+" colspan="+A[O].ColSpan+" rowspan="+A[O].RowSpan+" role='rowheader'>"+(0==A[O].State?'<span style="margin-left: 10px"></span>':2==A[O].State?'<span class="e-expand e-icon" aria-label=\'collapsed\' title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==A[O].State?'<span class="e-collapse e-icon" aria-label=\'expanded\' title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+A[O].Value+"</th>":S+"<td"+("none"==A[O].CSS?"":' class="'+A[O].CSS)+'" data-p='+A[O].Index+" colspan="+A[O].ColSpan+" rowspan="+A[O].RowSpan+" role='gridcell'"+(null==A[O].i?"":"data-i="+A[O].i)+">"+(2==A[O].State?'<span class="e-expand e-icon" title="'+this._getLocalizedLabels("Expand")+'">&nbsp;</span>':1==A[O].State?'<span class="e-collapse e-icon" title="'+this._getLocalizedLabels("Collapse")+'">&nbsp;</span>':"")+A[O].Value+"</td>",A[O].RowSpan>1&&A[O].ColSpan<=1)for(T=O+1;T<O+A[O].RowSpan;T++)t.isNullOrUndefined(A[T])||(A[T].Span="Block");else if(A[O].ColSpan>1&&A[O].RowSpan<=1)for(T=O+E;T<O+A[O].ColSpan*E;T+=E)t.isNullOrUndefined(A[T])||(A[T].Span="Block");else if(A[O].ColSpan>1&&A[O].RowSpan>1)for(T=O;T<O+A[O].RowSpan;T++){for(y=T+E;y<T+A[O].ColSpan*E;y+=E)t.isNullOrUndefined(A[y])||(A[y].Span="Block");T!=O&&(t.isNullOrUndefined(A[T])||(A[T].Span="Block"))}""!=e(S+="</tr>").text()&&e(ie).append(S)}re?this._renderFrozenGridTable(s,te,ie):(e(s).append(te),e(s).append(ie))}}else n=t.buildTag("tr",t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML+t.buildTag("th","",{width:"70px"})[0].outerHTML),d=t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML+t.buildTag("td","",{width:"70px"})[0].outerHTML)[0].outerHTML,e(s).append(n),e(s).append(d),this._rowCount=0;if(this._unWireEvents(),this._wireEvents(),x=!1,this._pivotClientObj&&"olap"==this._pivotClientObj.model.analysisMode&&"clientmode"==this._pivotClientObj.model.operationalMode&&(x=this._pivotClientObj.model.enableVirtualScrolling||this._pivotClientObj.model.enablePaging),this.model.enableVirtualScrolling||x||!(e(s).find("tr:last > td").length>0)||""!=e(s).find("tr:last").find("td").text()||this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot||null!=this._pagerObj||e(s).find("tr:last").hide(),this.model.enablePaging||this.model.enableVirtualScrolling||(this._hideGrandTotal(s),this._hideSubTotal(s)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.model.enableCollapseByDefault||!t.isNullOrUndefined(this.model.collapsedMembers))&&!t.isNullOrUndefined(A))if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.enableCollapseByDefault){var re=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,oe=t.isNullOrUndefined(this.model.dataSource.data)||t.isNullOrUndefined(this.model.dataSource.rows)?e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotRows.length:JSON.parse(this.getOlapReport()).PivotRows.length:this.model.dataSource.rows.length,se=t.isNullOrUndefined(this.model.dataSource.data)||t.isNullOrUndefined(this.model.dataSource.columns)?e(this.element).parents(".e-pivotclient").length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?JSON.parse(this._pivotClientObj.getOlapReport()).PivotColumns.length:JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length;for(this.model.collapsedMembers={},w=oe;w>=0;w--)for(M=re?e(s).find(".pivotGridRowTable [data-p^='"+w+",']:has('span.e-collapse')[class^='rowheader']"):e(s).find("th[data-p^='"+w+",']:has('span.e-collapse')[class^='rowheader']"),N=this._getFieldName(M[0]),this.model.collapsedMembers[N]=[],D=0;D<M.length;D++)this.model.collapsedMembers[N].push(e(M[D]).clone().children().remove().end().text()),this._collapseMember(s,e(M[D]).find(".e-collapse"));for(L=se;L>=0;L--)for(P=e(s).find((re?".pivotGridFrozenTable ":"th")+"[data-p$=',"+L+"']:has('span.e-collapse')[class$='colheader']"),N=this._getFieldName(P[0]),this.model.collapsedMembers[N]=[],D=0;D<P.length;D++)this.model.collapsedMembers[N].push(e(M[D]).clone().children().remove().end().text()),this._collapseMember(s,e(P[D]).find(".e-collapse"))}else t.isNullOrUndefined(this.model.collapsedMembers)||(R=this,e.each(this.model.collapsedMembers,function(i,l){var a,r,o,n,d,h,c,p;l=l;if(R.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode){for(d=0;d<R.model.dataSource.rows.length;d++)R.model.dataSource.rows[d].fieldName==i&&(a=d,r="row");for(d=0;d<R.model.dataSource.columns.length;d++)R.model.dataSource.columns[d].fieldName==i&&(a=d,r="column");if(!t.isNullOrUndefined(a))if("row"==r)for(d=R.model.dataSource.columns.length+1;d<R._rowCount;d+=t.isNullOrUndefined(h)?1:h.rowSpan){for(h=e(s).find("tBody th[data-p='"+a+","+d+"']")[0],c=!1,p=0;p<l.length;p++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[p].toString())){c=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("rowheader")||"rowheader"==e(h).attr("role"))&&c&&e(h).find(".e-collapse").length>0&&R._collapseMember(s,e(h).find(".e-collapse"))}else if("column"==r)for(d=R.model.dataSource.rows.length;d<Math.ceil(R.getJSONRecords().length/R._rowCount);d+=t.isNullOrUndefined(h)?1:h.colSpan){for(h=e(s).find("thead th[data-p='"+d+","+a+"']")[0],c=!1,p=0;p<l.length;p++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[p].toString())){c=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("colheader")||"columnheader"==e(h).attr("role"))&&c&&e(h).find(".e-collapse").length>0&&R._collapseMember(s,e(h).find(".e-collapse"))}}else{for(o=JSON.parse(R.getOlapReport()).PivotRows,n=JSON.parse(R.getOlapReport()).PivotColumns,d=0;d<o.length;d++)o[d].FieldName==i&&(a=d,r="row");for(d=0;d<n.length;d++)n[d].FieldName==i&&(a=d,r="column");if(!t.isNullOrUndefined(a))if("row"==r)for(d=n.length+1;d<R._rowCount;d+=t.isNullOrUndefined(h)?1:h.rowSpan){for(h=e(s).find("tBody th[data-p='"+a+","+d+"']")[0],c=!1,p=0;p<l.length;p++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[p].toString())){c=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("rowheader")||"rowheader"==e(h).attr("role"))&&c&&e(h).find(".e-collapse").length>0&&R._collapseMember(s,e(h).find(".e-collapse"))}else if("column"==r)for(d=o.length;d<Math.ceil(R.getJSONRecords().length/R._rowCount);d+=t.isNullOrUndefined(h)?1:h.colSpan){for(h=e(s).find("thead th[data-p='"+d+","+a+"']")[0],c=!1,p=0;p<l.length;p++)if(e.trim(e(h).text().replace("expanded",""))==e.trim(l[p].toString())){c=!0;break}!t.isNullOrUndefined(h)&&(e(h).hasClass("colheader")||"columnheader"==e(h).attr("role"))&&c&&e(h).find(".e-collapse").length>0&&R._collapseMember(s,e(h).find(".e-collapse"))}}}));if(this.element.html(""),this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||this.model.enablePaging||this.model.enableVirtualScrolling||(this.model.enableAdvancedFilter||e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableAdvancedFilter)&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode||(s=this._cropHtml(s)),this.model.enableGroupingBar?(this.element.append(s),(null==this._JSONRecords||0==this._JSONRecords.length)&&this.element.append(t.buildTag("span",this._getLocalizedLabels("NoRecordsToDisplay"),{display:"inline-block",padding:"10px 0px 0px 0px","font-family":"Segoe UI"})[0].outerHTML),this.model.enableRTL&&this.element.addClass("e-rtl"),this._createFields(s,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth())):e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?(e(o).append(s),this.element.append(e(o))):this.element.append(s),(this.model.enableColumnResizing&&this.model.resizeColumnsToFit||this.model.enableColumnResizing&&!this.model.resizeColumnsToFit)&&this._resizeColumnsWidth(),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&(this._applyFrozenHeaderWidth(A),this.element.find(".e-pivotGridTable").width("auto")),this.model.enableVirtualScrolling&&t.isNullOrUndefined(this._pivotClientObj)&&(this._createVirtualPivotGrid(s),this.model.enableGroupingBar&&this._createFields(null,e("#"+this._id).find(".e-pivotGridTable").width(),e("#"+this._id).find(".e-pivotGridTable th").outerWidth()),this.model.enableRTL&&this.element.addClass("e-rtl"),this._applyVScrolling()),t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj.model.enableVirtualScrolling||this._pivotClientObj.model.enablePaging||(this._pivotClientObj.element.find(".e-categPageIndicator, .e-seriesPageIndicator , .e-vScrollThumb, .e-hScrollThumb").remove(),j=t.buildTag("div.e-seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage")+" : ")[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML,this._seriesPageCount>1?(12!=this._pivotClientObj.element.find(".e-vScrollPanel").width()&&this._pivotClientObj.element.width(this._pivotClientObj.element.width()+12),this._pivotClientObj.element.find(".e-vScrollPanel").width(12),this._pivotClientObj.element.find(".virtualScrolling").append(j),this._pivotClientObj.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&this._pivotClientObj.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartAndGrid?this._pivotClientObj.element.find(".virtualScrolling").css("padding-top","10px"):this._pivotClientObj.element.find(".virtualScrolling").css("padding-left","2px")):12==this._pivotClientObj.element.find(".e-vScrollPanel").width()&&(this._pivotClientObj.element.width(this._pivotClientObj.element.width()-12),this._pivotClientObj.element.find(".e-vScrollPanel").width(0)),I=t.buildTag("div.e-categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage")+" : ")[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML,this._categPageCount>1?(12!=this._pivotClientObj.element.find(".e-hScrollPanel").height()&&this._pivotClientObj.element.find(".e-hScrollPanel").height(12),this._pivotClientObj.controlPlacement()==t.PivotClient.ControlPlacement.title&&this._pivotClientObj.element.find(".hsVirtualScrolling").css("margin-top","3px"),this._pivotClientObj.element.find(".hsVirtualScrolling").append(I)):12==this._pivotClientObj.element.find(".e-hScrollPanel").height()&&(this._pivotClientObj.model.isResponsive?this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height(this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height()-6):this._pivotClientObj.element.find(".e-categoricalAxis, .e-rowAxis,.e-slicerAxis").height(150),this._pivotClientObj.model.enableSplitter||this._pivotClientObj.element.find(".e-cubeBrowser").height(this._pivotClientObj.element.find(".e-cubeBrowser").height()-20),this._pivotClientObj.element.find(".e-hScrollPanel").height(0)),this._applyVScrolling(),this._pivotClientObj.element.find(".e-chartContainer").length>0&&this._pivotClientObj.element.find(".e-gridContainer").height(this._pivotClientObj.element.find(".e-chartContainer").height()+5),this._pivotClientObj.model.enableSplitter&&(t.isNullOrUndefined(this._pivotClientObj.element.find(".e-childsplit").data("ejSplitter"))||this._pivotClientObj.element.find(".e-childsplit").data("ejSplitter").refresh(),t.isNullOrUndefined(this._pivotClientObj.element.find(".e-serverchildsplit").data("ejSplitter"))||this._pivotClientObj.element.find(".e-serverchildsplit").data("ejSplitter").refresh())),this.model.enableColumnResizing?this.element.addClass("e-column-resize"):this.element.removeClass("e-column-resize"),this.model.enableRTL?(this.element.addClass("e-rtl"),this.element.find(".groupingBarPivot").addClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .groupingBarPivot, .e-grpRow").css("text-align","right")):(this.element.removeClass("e-rtl"),this.element.find(".groupingBarPivot").removeClass("e-rtl"),this.element.find("table .rowheader,.colheader,.summary, .e-grpRow, .groupingBarPivot ").css("text-align","left")),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen){e("#"+this._id).prepend("<div class='toolBar' style='height:40px,width:"+this.element.find("#PivotGridToolbar").width()+"px'></div>");var ne,de="",he=t.buildTag("li#frozenHeaders.e-frozenHeaders e-icon","",{}).attr("aria-label",this._getLocalizedLabels("FrozenHeader")).attr({title:this._getLocalizedLabels("FrozenHeader"),tabindex:0})[0].outerHTML;t.buildTag("li.e-cellSelect e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CellSelection")).attr({title:this._getLocalizedLabels("CellSelection"),tabindex:0})[0].outerHTML;this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(de=t.buildTag("li#collapseByDefault.e-collapseByDefault e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CollapseByDefault")).attr({title:this._getLocalizedLabels("CollapseByDefault"),tabindex:0})[0].outerHTML),ne=t.buildTag("li.e-numberFormatting e-icon","",{}).attr("aria-label",this._getLocalizedLabels("NumberFormatting")).attr({title:this._getLocalizedLabels("NumberFormatting"),tabindex:0})[0].outerHTML,t.buildTag("li.e-calculatedField e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CalculatedField")).attr({title:this._getLocalizedLabels("CalculatedField"),tabindex:0})[0].outerHTML,F=t.buildTag("ul",(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?t.buildTag("li#cellEditing.e-cellEditing e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CellEditing")).attr({title:this._getLocalizedLabels("CellEditing"),tabindex:0})[0].outerHTML:" ")+t.buildTag("li#drillThrough.e-drillThrough e-icon","",{}).attr("aria-label",this._getLocalizedLabels("DrillThrough")).attr({title:this._getLocalizedLabels("DrillThrough"),tabindex:0})[0].outerHTML+(this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||this.model.operationalMode!=t.Pivot.OperationalMode.ServerMode?t.buildTag("li.e-advancedFiltering e-icon","",{}).attr("aria-label",this._getLocalizedLabels("AdvancedFiltering")).attr({title:this._getLocalizedLabels("AdvancedFiltering"),tabindex:0})[0].outerHTML:"")+t.buildTag("li#columnResize.e-columnResize e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ColumnResize")).attr({title:this._getLocalizedLabels("ColumnResize"),tabindex:0})[0].outerHTML+t.buildTag("li.e-toolTip e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ToolTip")).attr({title:this._getLocalizedLabels("ToolTip"),tabindex:0})[0].outerHTML+(this._pivotClientObj.displayMode()==t.PivotClient.DisplayMode.GridOnly?de:"")+t.buildTag("li.rtl e-icon","",{}).attr("aria-label",this._getLocalizedLabels("RTL")).attr({title:this._getLocalizedLabels("RTL"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("ul",t.buildTag("li.e-hyperlinkOptions e-icon","",{}).attr("aria-label",this._getLocalizedLabels("HyperLink")).attr({title:this._getLocalizedLabels("HyperLink"),tabindex:0})[0].outerHTML+t.buildTag("li.e-layouts e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Layouts")).attr({title:this._getLocalizedLabels("Layouts"),tabindex:0})[0].outerHTML+he+t.buildTag("li.e-exporting e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Exporting")).attr({title:this._getLocalizedLabels("Exporting"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("ul",t.buildTag("li#summaryCustomize.e-summaryCustomize e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SummaryCustomization")).attr({title:this._getLocalizedLabels("SummaryCustomization"),tabindex:0})[0].outerHTML+t.buildTag("li.e-conditionalFormat e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ConditionalFormatting")).attr({title:this._getLocalizedLabels("ConditionalFormatting"),tabindex:0})[0].outerHTML+("pivot"==this._pivotClientObj.model.analysisMode&&"clientmode"==this._pivotClientObj.model.operationalMode?t.buildTag("li.e-summaryTypes e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SummaryTypes")).attr({title:this._getLocalizedLabels("SummaryTypes"),tabindex:0})[0].outerHTML+ne:""))[0].outerHTML,e(".toolBar").append(F),e(".toolBar").ejToolbar({enableRTL:this.model.enableRTL,height:"35px",enableSeparator:!0})}this._stateMaintenance(),""!=e.trim(this.model.pivotTableFieldListID)&&this._isSchemaInitialize&&this.model.enablePivotFieldList&&this._renderPivotSchemaDesigner(),this.model._isXMLImport&&""!=e.trim(this.model.pivotTableFieldListID)&&(this.model.enablePivotFieldList?(e("#"+this.model.pivotTableFieldListID).css("display",""),this._renderPivotSchemaDesigner()):e("#"+this.model.pivotTableFieldListID).css("display","none"),this.model._isXMLImport=!1),null!=this._schemaData&&this.element.find(".colheader, .rowheader, .value").addClass("e-droppable"),this.exportRecords=1==K||1==W?A:r,t.Pivot.closePreventPanel(this),this._schemaData&&t.Pivot.closePreventPanel(this._schemaData),null!=this._excelLikeJSONRecords&&this.layout().toLowerCase()==t.PivotGrid.Layout.ExcelLikeLayout&&(this._rowCount=h),this.model.valueSortSettings&&this._refreshValueSortIcons(a),this.model.enableGroupingBar&&this.element.find(".e-pivotGridTable").width()>0&&(!(0==this.element.find(".values .e-pvtBtn, .columns .e-pvtBtn").length&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)&&this.element.find("tbody .value").length>0&&this.element.find("thead tr").length>0&&this.element.find(".groupingBarPivot").width(this.element.find(".e-pivotGridTable").width()),this.model.enableColumnResizing&&(this.element.find(".groupingBarPivot").css({overflow:"hidden"}),this.element.find(".e-pivotGridTable").width()+1==this.element.width()&&this.element.find(".groupingBarPivot").css({width:"100%"}))),(this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&this._applyFrozenHeaderWidth(this._JSONRecords),this._applyHeaders()},_refreshValueSortIcons:function(i){var l,a;t.isNullOrUndefined(this.model.valueSortSettings.headerText)||""==this.model.valueSortSettings.headerText||t.isNullOrUndefined(t.PivotAnalysis._valueSorting)?t.isNullOrUndefined(i)||0!=e(i).find(".rowheader").length||this.element.find("[data-p='"+Number(e(i).attr("data-p").split(",")[0])+","+Number(e(i).attr("data-p").split(",")[1])+"']").html(i.html()):(l=this.element.find("[data-p='"+Number(t.PivotAnalysis._valueSorting)+","+Number(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length)+"']"),0!=e(l).find(".valueSorting").length||e(l).hasClass("rowheader")||(a=t.buildTag("span.valueSorting e-icon "+t.PivotAnalysis._sort).css("margin-left","5px").attr("role","button").attr("aria-label","sort")[0].outerHTML,e(l).append(a)))},_applyHeaders:function(){var i,l,a,r,o,s;if(null!=this._JSONRecords){var n=[],d=[],h={},c=[],p=this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode;if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap||!this.model.headerSettings.showColumnItems&&!this.model.headerSettings.showRowItems||this.model.enableGroupingBar){if(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&(this.model.headerSettings.showColumnItems||this.model.headerSettings.showRowItems)&&"excellikelayout"!=this.model.layout&&!this.model.enableGroupingBar&&(p&&JSON.parse(this.getOlapReport()).PivotCalculations.length||!p&&this.model.dataSource.values[0].measures.length)&&("columns"==this._getAxis()||"rows"==this._getAxis())){for(i=0,l=-1,o=0;o<Number(this.element.find(".value:first").attr("data-p").split(",")[1])-1;o++)d[o]="";for(o=0;o<this._JSONRecords.length;o++)if(""!=this._JSONRecords[o].Info&&this._JSONRecords[o].Info.split("::")[1].indexOf("Measures")>-1&&"colheader"==this._JSONRecords[o].CSS){l=Number(this._JSONRecords[o].Index.split(",")[1]);break}for(o=0;o<this._JSONRecords.length;o++)"value"!=this._JSONRecords[o].CSS&&" value"!=this._JSONRecords[o].CSS&&("rowheader"==this._JSONRecords[o].CSS&&""!=this._JSONRecords[o].Info&&-1==e.inArray(e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text(),n)&&-1==e.inArray(this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,""),n)&&-1===this._JSONRecords[o].Info.indexOf("Measure")&&(e(this.element).parents(".e-pivotclient").length>0?n.push(e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text()):n.push(this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,"")),this.element.find("[data-p*='"+this._JSONRecords[o].Index.split(",")[0]+",'] .collapse").parent().not(".colheader").length>0?c.push(e(this.element.find("[data-p*='"+this._JSONRecords[o].Index.split(",")[0]+",'] .collapse").parent().not(".colheader")[0]).width()):c.push(this.element.find("[data-p='"+this._JSONRecords[o].Index.split(",")[0]+","+this._JSONRecords[o].Index.split(",")[1]+"']").width()),o+=this._rowCount-o%this._rowCount),"colheader"==this._JSONRecords[o].CSS&&""!=this._JSONRecords[o].Info&&(-1==e.inArray(e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text(),d)||-1==e.inArray(this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,""),d))&&-1===this._JSONRecords[o].Info.indexOf("Measure")&&(i=-1!=l?l>Number(this._JSONRecords[o].Index.split(",")[1])?0:1:0,d[Number(this._JSONRecords[o].Index.split(",")[1])-i]=e(this.element).parents(".e-pivotclient").length>0?e(".e-cubeTreeView").find("li[data-tag='"+this._JSONRecords[o].Info.split("::")[1]+"'] a:eq(0)").text():this._JSONRecords[o].Info.split("::")[1].replace(/[\[\]]+/g,"")));h={rows:n,columns:d}}}else if(p&&(JSON.parse(this.getOlapReport()).PivotRows.length>0||JSON.parse(this.getOlapReport()).PivotColumns.length>0)&&JSON.parse(this.getOlapReport()).PivotCalculations.length>0||!p&&(this.model.dataSource.rows.length>0||this.model.dataSource.columns.length>0)&&this.model.dataSource.values.length>0){for(o=0;o<(p?JSON.parse(this.getOlapReport()).PivotRows.length:this.model.dataSource.rows.length);o++)n.push(p?JSON.parse(this.getOlapReport()).PivotRows[o].FieldHeader:this.model.dataSource.rows[o].fieldCaption);for(o=0;o<(p?JSON.parse(this.getOlapReport()).PivotColumns.length:this.model.dataSource.columns.length);o++)d.push(p?JSON.parse(this.getOlapReport()).PivotColumns[o].FieldHeader:this.model.dataSource.columns[o].fieldCaption);h={rows:n,columns:d}}if(!e.isEmptyObject(h)&&(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap&&h.rows.length>0||"pivot"==this.model.analysisMode)){for(this.element.find(".e-pivotGridTable")&&(a=this.element.find(".e-pivotGridTable").find("tbody>tr:eq(0)"),t.isNullOrUndefined(a)||jQuery.each(e(a).find("th"),function(t,i){e(i).hasClass("rowheader")&&c.push(e(i).width())})),r=e("<table></table>").css({width:this.element.find(".colfreeze").length>0?this.element.find(".colfreeze").width()+10:this.element.find("[p='0,0']").width()+10,height:this.element.find(".colfreeze").length>0?this.element.find(".colfreeze").height()+10:this.element.find("[p='0,0']").height()+10}).attr({id:"hdrSec"}),o=0;o<h.columns.length+1;o++)if(n=e("<tr></tr>").attr({class:"hdrTr"}).appendTo(r),h.rows.length>0)for(s=0;s<h.rows.length;s++)e('<td class="e-headerItem"></td>').css("width",s==h.rows.length-1&&o<h.columns.length?c[h.rows.length-1]:c[s]).text(s==h.rows.length-1&&o<h.columns.length&&this.model.headerSettings.showColumnItems?this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?h.columns[o].split(".")[h.columns[o].split(".").length-1]:h.columns[o]:o==h.columns.length&&this.model.headerSettings.showRowItems?this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?h.rows[s].split(".")[h.rows[s].split(".").length-1]:h.rows[s]:"").attr("title",s==h.rows.length-1&&o<h.columns.length&&this.model.headerSettings.showColumnItems?h.columns[o]:o==h.columns.length&&this.model.headerSettings.showRowItems?h.rows[s]:"").appendTo(n);else this.model.headerSettings.showColumnItems&&e('<td class="e-headerItem"></td>').css("width",c[0]).text(this.model.analysisMode==t.PivotGrid.AnalysisMode.Olap?h.columns[o].split(".")[h.columns[o].split(".").length-1]:h.columns[o]).attr("title",h.columns[o]).appendTo(n);this.element.find(".colfreeze").length>0?(this.element.find(".colfreeze").css("visibility","visible").html(""),r.appendTo(this.element.find(".colfreeze"))):(this.element.find("[data-p='0,0']").css({padding:"0px"}).html(""),r.appendTo(this.element.find("[data-p='0,0']")))}}},_applyLocale:function(i){var a,r,o,s,n,d,h;if(0!=this.model.dataSource.values.length){for(a=!1,o=0;o<this.model.dataSource.values[0].measures.length;o++)if(this.model.dataSource.values[0].measures[o].format){a=!0;break}if(a)for(r=this._getAxis(),o=0;o<this.model.dataSource.values[0].measures.length;o++){var c,p=[],u=[],m=this.model.dataSource.values[0].measures[o].format;for(s=0;s<i.length;s++)u=this._getColumnIndices(r,i[s],this.model.dataSource.values[0].measures[o].fieldCaption,p);for(n=0;n<u.length;n++)for(d=0;d<i.length;d++)("rows"==r?i[d].Index.split(",")[1]:"columns"==r?i[d].Index.split(",")[0]:null)==u[n]&&""!=i[d].Value&&(c=(c=i[d].Value.replace(/[\s,%]/g,"")).replace(t.preferredCulture(this.model.locale).numberFormat.currency.symbol,""),e.isNumeric(c)&&m!=l&&(h=t.olap.base._getFormatedValue(c,m),i[d].Value=h))}}},_renderPivotSchemaDesigner:function(){var i,l,a;e("#"+this.model.pivotTableFieldListID).length>0&&(null!=(i=e("#"+this.model.pivotTableFieldListID).data("ejPivotSchemaDesigner"))?(i.model.pivotControl=this,i.model.enableWrapper=!0,i._load(),this._waitingPopup&&this._waitingPopup.hide(),this._isSchemaInitialize=!1):(l=this,a=setInterval(function(){var i=e("#"+l.model.pivotTableFieldListID).data("ejPivotSchemaDesigner");null!=i&&(clearInterval(a),i.model.pivotControl=l,i.model.enableWrapper=!0,i._load(),l._waitingPopup&&l._waitingPopup.hide(),l._isSchemaInitialize=!1,t.isNullOrUndefined(i.model.pivotControl)||i.model.pivotControl.element.find(".colheader, .rowheader, .value").addClass("e-droppable"))},10)))},_renderFrozenGridTable:function(i,l,a){var r,o,s,n,d,h,c,p,u,m=e("<table class=\"pivotGridFrozenTable\" style='height:47px' ></table>"),g=e('<table class="pivotGridRowTable" ></table>');r=e('<table class="pivotGridValueTable" ></table>'),o=e("<thead></thead>"),s=e("<tbody></tbody>"),n=e("<tbody></tbody>"),d="<tr role='row'>",h=e("<div class='rowhead' style='position: relative; float: left;display: inline-block'>"),e(o).append(e(l).children()),c=a.children().clone(),p=a.children().clone(),e(p).find(".value").remove(),e(s).append(e(p)),e(g).append(s),e(h).append(g),e(c).find(".rowheader, .summary:not(.summary.value)").remove(),e(n).append(e(c));var f=e(t.buildTag("div.colhead").css({position:"relative",overflow:"hidden"})[0].outerHTML),b=e(t.buildTag("div.colmovable")[0].outerHTML),_=e(t.buildTag("div.colfreeze").css({float:"left",height:"100%",visibility:this.model.enableGroupingBar?"visible":"hidden"})[0].outerHTML);e(f).append(e(m).append(o)),0==e(d).children().length&&(d=e("<tr role='row'></tr>")),e(d).length>0&&(e(b).append(f),e(_).append(e("<table id='colfretable' style='height:100%'></table>").append(d)));var v=e(t.buildTag("div#rowvaluecontent.valScrollArea")[0].outerHTML),C=e(t.buildTag("div.valueCell").css({position:"relative"})[0].outerHTML),S=e(t.buildTag("div.rowHeaderArea")[0].outerHTML);e(C).append(e(r).append(n)),!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(e(i).append("<tr><td style='padding:0px'></td></tr><tr><td style='padding:0px'></td></tr>"),e(i).find("tr:first td:eq(0)").append(e("<div id='headerContent' class='headerContent'></div>")),e(e(i).find("tr:last td:eq(0)")).append(e(v)),e(i).find(".headerContent").append(b),e(i).find(".headerContent .colhead").prepend(_),e(i).find(".headerContent .colhead").append("<div class='headerTable'/>"),e(i).find(".pivotGridFrozenTable").appendTo(e(i).find(".headerTable")),e(i).find(".valScrollArea").append(e(S)),e(i).find(".rowHeaderArea").append(h,C)):this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?(e(i).append("<tr ><td style='padding:0px;border-right:0px' ></td><td style='padding:0px;'></td></tr>"),e(i).find("tr:first td:eq(0)").append(e("<div id='headerContent' class='headerContent' style='position:relative'></div>")),e(i).find(".headerContent").append(_,h),e(i).find("tr td:last").append(e(v)),e(i).find(".valScrollArea").append(e(S)),e(i).find(".rowHeaderArea").append(b,C)):(e(i).append("<tr><td style='padding:0px'></td><td style='padding:0px;'></td></tr><tr><td style='padding:0px'></td><td style='padding:0px' class='valueArea'></td></tr>"),e(i).find("tr:first td:eq(0)").append(_),e(i).find("tr:first").children("td:eq(1)").append(b),e(i).find("tr:last td:eq(0)").append(e(S)),e(i).find(".rowHeaderArea").append(h),e(i).find(".valueArea").append(e(v)),e(i).find(".valScrollArea").append(C)),this.model.enableGroupingBar?e(i).find(".e-grpRow").length>0&&(e(i).find(".e-grpRow").appendTo(e(i).find(".colfreeze table tr:eq(0)")),e(i).find(".e-grpRow").removeAttr("colspan").removeAttr("rowspan")):(e(i).find("[data-p='0,0']").length>0||e(i).find("[data-p='-1,-1']").length>0)&&(this.model.enablePaging||this.model.enableVirtualScrolling?e(i).find(".rowheader").length>0||e(i).find(".rstot").length>0||e(i).find(".rgtot").length>0:e(i).find(".rowheader").length>0)&&(u=e(i).find("[data-p='-1,-1']").length>0?"-1,-1":"0,0",e(i).find("[data-p='"+u+"']").appendTo(e(i).find(".colfreeze table tr:eq(0)")),e(i).find("[data-p='"+u+"']").removeAttr("colspan").removeAttr("rowspan"))},_applyFrozenHeaderWidth:function(i){var l,a,r,o,s;if((this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders)&&!t.isNullOrUndefined(i)&&i.length>0){(l=this.element.find(".e-scroller").data("ejScroller"))&&(l.destroy(),e(this.element).css("overflow",""),this.element.find(".pivotGridRowTable, .pivotGridValueTable , .pivotGridFrozenTable").removeAttr("style")),this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.element.find(".pivotGridValueTable,.pivotGridFrozenTable").addClass("rowFrozenTable"):this.element.find(".pivotGridValueTable,.pivotGridFrozenTable").removeClass("rowFrozenTable"),this.element.find(".pivotGridFrozenTable colgroup, .pivotGridValueTable colgroup").remove();var n=e("<colgroup></colgroup>"),d=this.element.find(".pivotGridFrozenTable"),h=this.element.find(".pivotGridRowTable tr:visible").index(),c=this.element.find(".pivotGridValueTable tr:eq("+h+") td");for(a=0;a<c.length;a++)r=e(c[a]).attr("data-p").split(",")[0],o=d.find("[data-p^='"+r+",']"),o=t.isNullOrUndefined(o.last().attr("colSpan"))||"1"==o.last().attr("colSpan")?e(o).last():o[o.length-2],e(c[a]).is(":visible")&&n.append("<col style='width:"+Math.max(e(o).outerWidth(),e(c[a]).outerWidth())+"px'>");this.element.find(".pivotGridFrozenTable, .pivotGridValueTable").prepend(n),this.model.enableColumnGrandTotal||this.element.find(".pivotGridValueTable tr:visible:eq(0) td:visible").length==e(n).children().length||(s=parseInt(this.element.find(".pivotGridFrozenTable tr:first td:last").attr("colspan")),this.element.find(".pivotGridFrozenTable colgroup col").slice(-s).remove(),this.element.find(".pivotGridValueTable colgroup col").slice(-s).remove()),this._refreshScroller()}},_refreshScroller:function(){var i,l=t.isNullOrUndefined(this.model.frozenHeaderSettings.scrollerSize)?18:this.model.frozenHeaderSettings.scrollerSize,a=!t.isNullOrUndefined(this._pivotClientObj)&&e("#"+this._pivotClientObj._id+"_PivotGridToolbar").length>0,r=a?e("#"+this._pivotClientObj._id+"_PivotGridToolbar"):[];if(this.element.find(".values").width()>this.element.find(".pivotGridRowTable").width()&&this.element.find(".pivotGridRowTable").width(this.element.find(".values").width()),this.element.find(".pivotGridValueTable .value:visible").length>0){if(this.element.find(".pivotGridFrozenTable").height(this.element.find(".colfreeze").height()),!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders){if(this._removeFrozenBorders(),this.element.find(".headerContent").width(this.element.width()),this.element.find(".colfreeze").css({width:this.element.find(".pivotGridRowTable").width(),float:this.model.enableRTL?"right":"left"}),this.element.find(".pivotGridFrozenTable").height()>this.element.find(".colfreeze").height()?this.element.find(".colfreeze").height(this.element.find(".pivotGridFrozenTable").height()):this.element.find(".pivotGridFrozenTable").height(this.element.find(".colfreeze").height()),this.element.find(".valueCell").css({display:"inline-block",width:this.element.width()-this.element.find(".pivotGridRowTable").width()}),this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").css({width:"100%","table-layout":"fixed"}),this.element.find(".headerContent").css({position:"relative",overflow:"hidden"}),this.element.find(".colmovable").css({display:"inline",position:"relative",overflow:"hidden"}),this.element.find(".headerContent").height(this.element.find(".headerTable").height()),u=0,p=0,this.element.find(".pivotGridValueTable").height()>0){var o=this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0,s=this.element.find(".headerContent").height(),n=s+this.element.find(".valueCell").height()+o,d=this.element.height(),h=this.element.find(".e-pivotGridTable").width(),c=this.element.find(".pivotGridValueTable").width()+this.element.find(".pivotGridRowTable").width();a&&(e(r).css("overflow","hidden"),d=e(r).height(),c=this.element.find(".pivotGridValueTable").width()+this.element.find(".pivotGridRowTable").width(),h=e(r).width()),u=(d>n?n:d)-s-o,p=h>c?c:h,a&&(this.element.find(".valueCell").width(e(r).width()-this.element.find(".pivotGridRowTable").width()-5),(p=this.element.find(r).width()-3)<0&&(p=200))}this.element.find("#rowvaluecontent").ejScroller({scroll:this._applyScroll,scrollerSize:l,width:p,height:u,targetControl:this,enableRTL:this.model.enableRTL}),this.model.enableRTL&&this.element.find(".rowhead").css({float:this.model.enableRTL?"right":"left"}),this.element.find(".e-vscrollbar").length>0&&(this.element.find(".valueCell").width(this.element.find(".valueCell").width()-l),this.element.find(".headerContent").width(this.element.find(".headerContent").width()-(a?28.5:18))),this.element.find(".headerTable").css({display:"inline-block",width:this.element.find(".valueCell").width()}),this.model.enableGroupingBar&&(this.element.find(" .groupingBarPivot").width("100%"),i=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(i),this.element.find(".rowhead").width()<this.element.find(".colfreeze").width()&&(this.element.find(".colfreeze").width(this.element.find(".rowhead").width()),this.element.find(".columns").width("auto")),this.element.find(".columns").css({height:"auto",width:"calc(100% -  "+this.element.find(".values").width()+")"}))}else if(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders){if(this._removeFrozenBorders(a),o=this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0,this.element.find(".pivotGridValueTable, .pivotGridFrozenTable").css({width:"100%","table-layout":"fixed"}),this.element.find(".colfreeze").height(this.element.find(".pivotGridFrozenTable").height()),this.element.find(".colhead").css("overflow","visible"),u=0,p=0,this.element.find(".pivotGridValueTable").height()>0){n=this.element.height(),a&&(n=e(r).height()-5);d=this.element.find(".rowHeaderArea").height(),c=this.element.width()-this.element.find(".headerContent").width();p=(h=this.element.find(".pivotGridValueTable").width())>c?c:h,u=(d>n?n:d)-o,a&&p<0&&(p=200)}this.element.find(".pivotGridRowTable").css({width:"100%","table-layout":"fixed"}),this.element.find("#rowvaluecontent").ejScroller({scrollerSize:l,scroll:this._applyScroll,width:p,height:u,targetControl:this,enableRTL:this.model.enableRTL}),this.element.find(".headerContent").css({height:this.element.find("#rowvaluecontent").height(),overflow:"hidden","border-right":"0px"}),this.element.find(".rowhead").css("padding-bottom",this.element.find("#rowvaluecontent .e-hscrollbar").length>0?l:"0px"),this.model.enableGroupingBar&&(this.element.find(" .groupingBarPivot,.colfreeze").width("100%"),i=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(i),this.element.find(".columns").width(this.element.find(".valueColumn").width()-this.element.find(".values").width()-5),this.element.find(".columns").css("height","auto"))}else{this._removeFrozenBorders(),this.element.find(".rowhead").css({overflow:"hidden",width:this.element.find(".pivotGridRowTable").width()}),n=this.element.height()-(this.element.find(".colhead").outerHeight()+(this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0)),a&&(n=e(r).outerHeight()-(this.element.find(".colhead").outerHeight()+(this.model.enableGroupingBar?this.element.find(".groupingBarPivot").height():0))),d=this.element.find(".pivotGridValueTable").height(),this.element.find(".rowhead").height(d>n?n:d),this.element.find(".colfreeze").width(this.element.find(".pivotGridRowTable").width()),this.element.find(".pivotGridFrozenTable, .pivotGridValueTable").css({width:"100%","table-layout":"fixed"});c=this.element.width()-this.element.find(".pivotGridRowTable").width()-3;var p=(h=this.element.find(".pivotGridValueTable").width())>c?c:h,u=this.element.find(".rowhead").height()+(h>c?l:0);a&&(this.element.find(".rowhead").height(this.element.find(".rowhead").height()-10),this.element.find(".rowhead, .colfreeze").width(this.element.find(".pivotGridRowTable").width()-5),u=this.element.find(".rowhead").height(),p<0&&(p=200)),this.element.find("#rowvaluecontent").ejScroller({scroll:this._applyScroll,width:p,height:u,targetControl:this,scrollerSize:l,enableRTL:this.model.enableRTL}),a&&this.element.find(".rowhead, .pivotGridRowTable").width("100%"),this.element.find(".colmovable").width(this.element.find(".valueCell").width()),this.element.find("#rowvaluecontent .e-hscrollbar").length>0?(this.element.find(".rowhead").css("margin-bottom",l),this.element.find(".rowhead").addClass("frozenBorderBtmClr")):(this.element.find(".rowhead").css("margin-bottom","0px"),this.element.find(".rowhead").removeClass("frozenBorderBtmClr")),this.element.find(".colhead , .colfreeze").height(this.element.find(".pivotGridFrozenTable").height()),this.element.find(".e-rows").height()>this.element.find(".colfreeze").height()&&this.element.find(".colmovable .colhead .pivotGridFrozenTable thead tr,.colfreeze").height(this.element.find(".e-rows").height()+15),this.element.find(".pivotGridFrozenTable").height("100%"),this.element.find(".rowhead").height(this.element.find(".valueCell").height()),0!=this.element.find(".e-scroller .e-hscroll").length||this.model.enableVirtualScrolling||this.element.find(".e-scroller").height("auto"),this.model.enableGroupingBar&&(i=this.element.find(".pivotGridRowTable").width(),this.element.find(".e-grpRow ,.values").width(i),this._refreshGroupingBarLayout())}this.element.find(".rowhead").scrollTop(0),this.element.find(".groupingBarPivot ").width(this.element.find(".e-pivotGridTable").width())}else e(this.element).css("overflow","auto"),this.element.find(".headerTable").css("display","inline-block"),this.element.find(".valScrollArea").css("height","100%")},_removeFrozenBorders:function(t){var l,a,r,o=this.model.enableRTL,s=this.element;if(t&&(l=t?e("#"+this._pivotClientObj._id+"_PivotGridToolbar"):[],e(l).css("overflow","hidden"),l.width()<this.element.find(".pivotGridRowTable").width()&&e(l).css("overflow","auto"),l.height()<this.element.find(".e-pivotGridTable").height()&&e(l).css("overflow","auto")),this.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders){for(s.find(".colhead").css({"border-right":"1px solid rgb(200, 200, 200)"}),s.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-collapse":"collapse","border-spacing":"0"}),s.find(".pivotGridRowTable tr td:last-child").css({"border-collapse":"collapse","border-spacing":"0"}),s.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-collapse":"collapse","border-spacing":"0"}),s.find(".pivotGridFrozenTable,  .pivotGridFrozenTable tr:nth-child(1) td").css({"border-collapse":"collapse"," border-spacing":"0","border-top":"0px"}),s.find(".colfretable .e-grpRow").css({"border-top":"0px"}),s.find(".pivotGridValueTable tr:visible:eq(0) td, .pivotGridRowTable tr:visible:eq(0) td").css("border-top","0px"),o?(s.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-right":"0px"}),s.find(".pivotGridRowTable tr td:last-child").css({"border-left":"0px"}),s.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-right":"0px"}),s.find(".colfretable .e-grpRow").css({"border-right":"0px","border-left":"0px"})):(s.find(".pivotGridRowTable, .pivotGridRowTable tr td:first-child").css({"border-left":"0px"}),s.find(".pivotGridRowTable tr td:last-child").css({"border-right":"0px"}),s.find(".pivotGridValueTable, .pivotGridValueTable tr td:first-child").css({"border-left":"0px"}),s.find(".colfretable .e-grpRow").css({"border-left":"0px","border-right":"0px"})),a=s.find(".pivotGridValueTable tr").length,i=0;i<a;i++)o?(s.find(".pivotGridValueTable tr:eq("+i+") td:visible:eq(0)").css("border-right","0px"),s.find(".pivotGridValueTable tr:eq("+i+") td:visible:last").css("border-left","0px")):(s.find(".pivotGridValueTable tr:eq("+i+") td:visible:eq(0)").css("border-left","0px"),s.find(".pivotGridValueTable tr:eq("+i+") td:visible:last").css("border-right","0px"));for(s.find(".pivotGridFrozenTable td").css("border-bottom","0px"),r=this.element.find(".pivotGridFrozenTable tr").length,i=0;i<r;i++)o?(s.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:eq(0)").css("border-right","0px"),s.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:last").css("border-left","0px")):(s.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:eq(0)").css("border-left","0px"),s.find(".pivotGridFrozenTable tr:eq("+i+") td:visible:last").css("border-right","0px"));s.find(".pivotGridRowTable tr:visible:last td").css("border-bottom","0"),s.find(".pivotGridValueTable tr:visible:last td").css("border-bottom","0")}else this.element.find(".pivotGridFrozenTable tr:first td").css("border-top","0px"),this.element.find(".pivotGridRowTable tr td:first-child").css(this.model.enableRTL?"border-right":"border-left","0px"),this.element.find(".pivotGridRowTable tr td:last-child").css(this.model.enableRTL?"border-left":"border-right","0px"),this.element.find(".pivotGridFrozenTable tr:last td").css("border-bottom","0px"),!this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&this.model.frozenHeaderSettings.enableFrozenRowHeaders?(this.element.find(".pivotGridFrozenTable tr td:first-child").css(this.model.enableRTL?"border-right":"border-left","0px"),this.element.find(".pivotGridValueTable tr:last td").css("border-bottom","0px"),this.element.find(".pivotGridValueTable tr td:visible:eq(0)").attr("p")&&this.element.find(".pivotGridValueTable tr td[p^='"+this.element.find(".pivotGridValueTable tr td:visible:eq(0)").attr("p").split(",")[0]+",']").css(this.model.enableRTL?"border-right":"border-left","0")):this.model.frozenHeaderSettings.enableFrozenColumnHeaders&&!this.model.frozenHeaderSettings.enableFrozenRowHeaders&&(this.element.find(".pivotGridRowTable  tr:eq(0) td").css("border-top","0px"),this.element.find(".pivotGridValueTable tr:eq(0) td").css("border-top","0px"))},_applyScroll:function(){this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.targetControl.model.frozenHeaderSettings.enableFrozenHeaders&&!this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&!this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders?(this.isVScroll()&&this.model.targetControl.element.find(".rowhead").scrollTop(this.model.scrollTop),this.isHScroll()&&this.model.targetControl.element.find(".colhead").scrollLeft(this.model.scrollLeft)):!this.model.targetControl.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.targetControl.model.frozenHeaderSettings.enableFrozenColumnHeaders?this.isHScroll()&&this.model.targetControl.element.find(".colhead").scrollLeft(this.model.scrollLeft):this.isVScroll()&&this.model.targetControl.element.find(".headerContent").scrollTop(this.model.scrollTop)},_setGroupingBarFrozenRowBtnWidth:function(){var t,i;(this.model.frozenHeaderSettings.enableFrozenRowHeaders&&this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenHeaders&&(!this.model.frozenHeaderSettings.enableFrozenRowHeaders||!this.model.frozenHeaderSettings.enableFrozenColumnHeaders))&&this.element.find(".pivotGridRowTable").outerWidth()>=this.element.find(".e-grpRow").outerWidth()&&this.element.find(".pivotGridRowTable").css("min-width",this.element.find(".e-grpRow").outerWidth()),this.element.find(".e-grpRow .e-removeBtn, .e-grpRow .filter, .e-grpRow .e-sorting ").css("position","inherit"),this.element.find(".colfreeze .e-pivotButton").width("auto");var l=this.element.find(".pivotGridRowTable").width(),a=this.element.find(".colfreeze .e-pivotButton"),r=l/a.length;if(l<r&&(r=l-40),this.element.find(".e-rows").width()>l){a.length;var o=0,s=0;e.each(this.element.find(".e-rows .e-pivotButton"),function(t,i){o+=e(i).width()}),e.each(this.element.find(".e-rows .e-pivotButton .e-pvtBtn"),function(t,i){s+=e(i).width()}),r-(t=(o-s)/a.length)<40&&(r=t+40)*a.length,this.element.find(".e-rows .e-pivotButton").width(r-20),this.element.find(".e-rows .e-pvtBtn").css({width:r-10-t,"text-overflow":"ellipsis"}),this.element.find(".e-rows").css({"white-space":"nowrap"}),i=this.element.find(".colfreeze .e-pivotButton:eq(0)").outerWidth()*a.length+30,this.element.find(".pivotGridRowTable,.rowhead,.colfreeze table,.valueColumn span.values").width(i)}},_refreshGroupingBarLayout:function(){this.element.find(".e-pivotGridTable .value").length>0||this.element.find(".e-pivotGridTable .colheader").length>0?this.element.find(".groupingBarPivot ").width(this.element.find(".e-pivotGridTable").width()):this.element.find(".pivotGridRowTable").length>0?this.element.find(".groupingBarPivot ").width(this.element.find(".pivotGridRowTable").width()+140):this.element.find(".groupingBarPivot ").width(330);var e=this.element.find(".pivotGridRowTable").width();this.element.find(".e-grpRow ,.values").width(e),this.element.find(".columns").css({height:"auto",width:this.element.find(".valueColumn").width()-this.element.find(".values").width()-1}),this._setGroupingBarFrozenRowBtnWidth()},_cellRangeInfo:function(i){var l,a,r,o,s,n,d=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid"),h=e(this.element).parents(".e-pivotclient").length>0||e(this.element).parents(".e-maximumView").length>0;h&&this._pivotClientObj.model.enableDrillThrough&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(this._dataSet=this._pivotClientObj.dataSet),e(i.target).hasClass("cellValue")&&(i.target=i.target.parentElement);e("thead tr").length;var c=[],p=0,u=e.grep(this.getJSONRecords(),function(t){return(t.CSS.indexOf("colheader")>-1||t.CSS.indexOf("summary cstot")>-1||t.CSS.indexOf(" calc")>-1)&&-1==t.CSS.indexOf("colheader calc")&&t.Index.split(",")[0]==e(i.target).attr("data-p").split(",")[0]}),m=e.grep(this.getJSONRecords(),function(t){return(t.CSS.indexOf("rowheader")>-1||t.CSS.indexOf("summary rstot")>-1)&&t.Index.split(",")[1]==e(i.target).attr("data-p").split(",")[1]});if(1==m.length&&1==u.length&&(m[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||u[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||u[0].CSS.indexOf(" calc")>-1))if([],(u[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0||u[0].CSS.indexOf(" calc")>-1)&&m[0].Value.toString().indexOf("Grand")>=0)for(s=0;s<this.model.dataSource.data.length;s++)c[s]=this.model.dataSource.data[s];else for(m[0].Value.toString().indexOf(this._getLocalizedLabels("GrandTotal"))>=0?l=u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?u[0].Value.replace(" "+this._getLocalizedLabels("Total"),""):u[0].Value:(u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0||u[0].CSS.indexOf(" calc")>-1)&&(l=m[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?m[0].Value.replace(" "+this._getLocalizedLabels("Total"),""):m[0].Value),s=0;s<d.model.dataSource.data.length;s++)e.each(d.model.dataSource.data[s],function(e,t){t==l&&(c[p]=d.model.dataSource.data[s],p++)});else if(m.length>=1&&u.length>=1&&(m[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0||u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0)){for(m[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0?(l=u,a=m):u[0].Value.toString().indexOf(this._getLocalizedLabels("Total"))>=0&&(l=m,a=u),b=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.model.dataSource.data:this._dataSet.length>0?JSON.parse(this._dataSet):[],r=l.length-1;r>=0;r--){for(o=[],s=0;s<b.length;s++)e.each(b[s],function(e,t){t==l[r].Value&&o.push(b[s])});b=o}if(c=o,a[0].Value.toString().indexOf("Grand")<=0)for(o=[],s=0;s<b.length;s++)e.each(b[s],function(e,t){t==a[0].Value.replace(" Total","")&&(c=[],o.push(b[s]))});c=0==c.length?o:c}else{var g=m,f=u,b=this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.model.dataSource.data:this._dataSet.length>0?JSON.parse(this._dataSet):[];for(r=g.length-1;r>=0;r--){for(o=[],s=0;s<b.length;s++)e.each(b[s],function(e,t){(t==g[r].Key||t==g[r].Value)&&o.push(b[s])});b=o}for(r=f.length-1;r>=0;r--)if(-1==f[r].CSS.indexOf("calc")){for(o=[],s=0;s<b.length;s++)e.each(b[s],function(e,t){(t==f[r].Key||t==f[r].Value)&&o.push(b[s])});b=o}c=0==c.length?o:c}n={selectedData:c||[],element:this.element,customObject:this.model.customObject},this.model.enableCellDoubleClick&&null!=this.model.enableCellDoubleClick&&"dblclick"==i.type&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellDoubleClick",n):this._pivotClientObj._trigger("cellDoubleClick",n)),this.model.enableCellClick&&null!=this.model.enableCellClick&&"click"==i.type&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellClick",n):this._pivotClientObj._trigger("cellClick",n)),(this.model.enableDrillThrough||h&&this._pivotClientObj.model.enableDrillThrough)&&c.length>0&&(h&&this._pivotClientObj.model.enableDrillThrough?this._pivotClientObj:this)._trigger("drillThrough",n)},_initCellEditing:function(i){var l;"INPUT"==i.target.tagName||e(i.target).hasClass("summary")||e(i.target).parent().hasClass("summary")?this._off(this.element,"mouseup",".value",this._completeCellEditing):(this._on(this.element,"mouseup",".value",this._completeCellEditing),this._oriX=i.pageX,this._oriY=i.pageY,l=i.target||window.event.srcElement,e(l).hasClass("cellValue")&&(l=e(l).parent()[0]),e(".value").addClass("selection"),e("#"+this._id).append(t.buildTag("div.e-cellSelection#"+this._id+"_cellSelection","",{})),this._startCellPosition=e(l)[0].attributes.getNamedItem("data-p").value,this._on(this.element,"mousemove",".value, .e-cellSelection",this._cellSelection))},_completeCellEditing:function(i){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C=[];if("INPUT"!=i.target.tagName){if(this._off(this.element,"mousemove",".value"),e(".value").removeClass("selection"),a=i.target||window.event.srcElement,e(a).hasClass("cellValue")&&(a=e(a).parent()[0]),r=e(a)[0].attributes.getNamedItem("data-p").value,n=0,this.element.find(".curInput").length>0)return 0==e(a).find(".curInput").length&&this._updateTableCell(),e("#"+this._id+"_cellSelection").remove(),this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip),this._off(this.element,"mouseup",".value"),!1;for(d=parseInt(this._startCellPosition.split(",")[1])<parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]);d<=(parseInt(this._startCellPosition.split(",")[1])>parseInt(r.split(",")[1])?parseInt(this._startCellPosition.split(",")[1]):parseInt(r.split(",")[1]));d++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("td[data-p*=',"+d+"']").parent().is(":visible"))for(h=parseInt(this._startCellPosition.split(",")[0])<parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]);h<=(parseInt(this._startCellPosition.split(",")[0])>parseInt(r.split(",")[0])?parseInt(this._startCellPosition.split(",")[0]):parseInt(r.split(",")[0]));h++)if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap||e("#"+this._id).find("[data-p*='"+h+",']").last("th").is(":Visible")||!this.model.enableGrandTotal||!this.model.enableRowGrandTotal){C[n]=this.getJSONRecords()[h*this._rowCount+d],this.element.find("[data-p='"+h+","+d+"']").hasClass("summary")||(this.element.find("[data-p='"+h+","+d+"'] span.cellValue").length>0?(c=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?""!=this.element.find("[data-p='"+h+","+d+"'] span.cellValue").text()?this.element.find("[data-p='"+h+","+d+"'] span.cellValue").text():this.element.find(".curInput").val():this.element.find("[data-p='"+h+","+d+"'] span.cellValue").text(),this.element.find("[data-p='"+h+","+d+"'] span.cellValue").html("<input type='text' class='curInput' value='"+c+"' />")):this.element.find("[data-p='"+h+","+d+"']").children().length>0?this.element.find("[data-p='"+h+","+d+"']").append("<input type='text' class='curInput' value='' />"):(c=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?""!=this.element.find("[data-p='"+h+","+d+"']").text()?this.element.find("[data-p='"+h+","+d+"']").text():this.element.find(".curInput").val():this.element.find("[data-p='"+h+","+d+"']").text(),this.element.find("[data-p='"+h+","+d+"']").html("<input type='text' class='curInput' value='"+c+"' />")));var S,O="",T=0;if((o=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders?this.element.find(".summary[role!='gridcell'][data-p$=',"+e(a).attr("data-p").split(",")[1]+"'] , .rowheader[role!='gridcell'][data-p$=',"+e(a).attr("data-p").split(",")[1]+"']").last().attr("data-p"):this.element.find(".summary[role!='gridcell'][data-p$=',"+d+"'] , .rowheader[role!='gridcell'][data-p$=',"+d+"']").last().attr("data-p"))==l&&(o=e("#"+this._id).find("tbody").find('[data-p="'+h+","+d+'"]').parent("tr").find(".summary").first().attr("data-p")),o,null!=o){for(;o[0]>=0;)o==this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Index&&(S=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(o.split(",")[0])*this._rowCount+parseInt(o.split(",")[1]))].Value,o=parseInt(o.split(",")[0])-1+","+parseInt(o.split(",")[1])),O&&""!=S?O=S+"#"+O:""!=S&&(O=S);if(this._rowHeader[n]=O,(m=this._rowHeader[n].toString().split("#")).length>1){for(f=0;f<m.length-1;f++)for(g=0;g<m[f].split(".").length;g++)if(m[f].split(".")[g]==m[f+1].split(".")[g]&&m[f].split(".")[g+1]==m[f+1].split(".")[g+1]){m.splice(f,1);break}for(this._rowHeader[n]="",f=0;f<m.length;f++)this._rowHeader[n]+=""==this._rowHeader[n]?m[f]:"#"+m[f]}}var y,x="",M=this.model.frozenHeaderSettings.enableFrozenHeaders||this.model.frozenHeaderSettings.enableFrozenColumnHeaders||this.model.frozenHeaderSettings.enableFrozenRowHeaders,P=this.element.find((M?".pivotGridFrozenTable ":"")+'tr:has(".colheader")').length-1;for(P,(s=C[n].Index)!=l&&s==this.getJSONRecords()[parseInt(parseInt(s.split(",")[0])*this._rowCount+parseInt(s.split(",")[1]))].Index&&(p=parseInt(s.split(",")[0])),u=0;u<=P;u++)null!=p&&p+","+u==this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+u)].Index&&(y=this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+u)].Info.split("::")[0]:this.getJSONRecords()[parseInt(parseInt(p)*this._rowCount+u)].Value,""==x?x=y:""!=y&&(x=x+"#"+y)),this._colHeader[n]=x;if((m=this._colHeader[n].split("#")).length>1){for(f=0;f<m.length-1;f++)for(g=0;g<m[f].split(".").length;g++)if(m[f].split(".")[g]==m[f+1].split(".")[g]&&m[f].split(".")[g+1]==m[f+1].split(".")[g+1]){m.splice(f,1);break}for(this._colHeader[n]="",f=0;f<m.length;f++)this._colHeader[n]+=""==this._colHeader[n]?m[f]:"#"+m[f]}n++}for(this._originalValue="",this._cellInfo=C,b=0;b<this.element.find(".curInput").length;b++)_=this.element.find(".curInput")[b],this._originalValue+=""==this._originalValue?_.value:"#"+_.value;v={JSONRecords:C,rowHeader:this._rowHeader,columnHeader:this._colHeader,measureCount:T>0?"Row:"+T:"Column:0"},t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellSelection",v):this._pivotClientObj._trigger("cellSelection",v),C=[],e("#"+this._id+"_cellSelection").remove(),this.model.enableToolTip&&this._on(this.element,"mousemove",".value",this._applyToolTip),this._off(this.element,"mouseup",".value")}this.element.find(".curInput").keypress(function(i){if(13==i.which){var l=e(i.target).parents(".e-pivotgrid").data("ejPivotGrid");t.isNullOrUndefined(l)||l._updateTableCell()}})},_updateTableCell:function(){var i,l,a,r,o,s,n,d="",h="",c=this.element.find(".curInput");e.each(c,function(e,t){d+=0==e?t.value:"#"+t.value});var p=[],u=this._rowHeader,m=this._colHeader;for(i=(h=d.split("#")).length-1;i>=0;i--)h[i]==this._originalValue.split("#")[i]?(u.splice(i,1),m.splice(i,1),h.splice(i,1),this._cellInfo.splice(i,1)):(p.push(this._originalValue.split("#")[i]),t.isNullOrUndefined(this._cellInfo[i])||(this._cellInfo[i].Value=h[i]=""==h[i]?"":h[i]));for(p=p.reverse(),d="",n=0;n<h.length;n++)d+=""==d?h[n]:"#"+h[n];if(0==d.length){for(n=c.length-1;n>=0;n--)e(c[n]).closest("td").text(this.element.find(".curInput")[n].value);return!1}if(this._waitingPopup.show(),this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode)try{l=JSON.parse(this.getOlapReport()).Report}catch(e){l=this.getOlapReport()}if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){(t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)||0==this.model.editCellsInfo.JSONRecords.length)&&(this.model.editCellsInfo={JSONRecords:[],rowHeader:[],columnHeader:[]});var g=this.model.editCellsInfo.rowHeader,f=this.model.editCellsInfo.columnHeader,b=this.model.editCellsInfo.JSONRecords,_=this._cellInfo;for(a=0;a<_.length;a++){for(r=0,o=0;o<b.length;o++)if(g[o]==u[a]&&f[o]==m[a]){b[o].Value=_[a].Value,r++;break}0==r&&(g.push(u[a]),f.push(m[a]),b.push(_[a]))}if(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}):this._pivotClientObj._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)if(this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode){d="";var v="",C="";for(e.each(this.model.editCellsInfo.JSONRecords,function(e,t){d=""==d?t.Value:d+":"+t.Value,v=""==v?t.Index:v+":"+t.Index,C=""==C?f[e].toString().split("#")[f[e].toString().split("#").length-1]:C+":"+f[e].toString().split("#")[f[e].toString().split("#").length-1]}),s=JSON.stringify({action:"cellEditing",index:v,valueHeaders:C,summaryValues:d,currentReport:l,valueSorting:JSON.stringify(this.model.valueSortSettings),customObject:JSON.stringify(this.model.customObject)}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.cellEditing,s,this._renderControlSuccess),n=c.length-1;n>=0;n--)e(c[n]).closest("td").text(e(c[n]).val())}else this._populatePivotGrid();else{for(n=c.length-1;n>=0;n--)e(c[n]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[n])?"":this._originalValue.split("#")[n]);this._waitingPopup.hide()}}else if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap)if(null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:"writeBack",element:this.element}),this.model.editCellsInfo.JSONRecords=this._cellInfo,this.model.editCellsInfo.rowHeader=u,this.model.editCellsInfo.columnHeader=m,t.isNullOrUndefined(this._pivotClientObj)?this._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}):this._pivotClientObj._trigger("cellEdit",{editCellsInfo:this.model.editCellsInfo}),d="",!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0&&e.each(this.model.editCellsInfo.JSONRecords,function(e,t){d=""==d?t.Value:d+":"+t.Value}),s=JSON.stringify({action:"writeBack",value:d,rowUniqueName:JSON.stringify(this.model.editCellsInfo.rowHeader),columnUniqueName:JSON.stringify(this.model.editCellsInfo.columnHeader),currentReport:l,customObject:JSON.stringify(this.model.customObject)}),!t.isNullOrUndefined(this.model.editCellsInfo.JSONRecords)&&this.model.editCellsInfo.JSONRecords.length>0)this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.writeBack,s,this._renderControlSuccess);else{for(n=c.length-1;n>=0;n--)e(c[n]).closest("td").text(t.isNullOrUndefined(this._originalValue.split("#")[n])?"":this._originalValue.split("#")[n]);this._waitingPopup.hide()}this._rowHeader=[],this._colHeader=[]},_createVirtualPivotGrid:function(e){var i,l,a=this._seriesPageCount>1?t.buildTag("div.e-vScrollPanel")[0].outerHTML:"",r=this._categPageCount>1?t.buildTag("div.e-hScrollPanel")[0].outerHTML:"",o=t.buildTag("td.virtualScrollGrid",e[0].outerHTML)[0],s=t.buildTag("td.virtualScrollElement",a),n=t.buildTag("td.virtualScrollElement",r),d=t.buildTag("tr.virtualScrollElement",o.outerHTML+s[0].outerHTML),h=t.buildTag("tr.virtualScrollElement",n[0].outerHTML+t.buildTag("td.virtualScrollElement")[0].outerHTML),c=t.buildTag("tbody.oGridOuterDiv.virtualScrollElement",d[0].outerHTML+h[0].outerHTML);this.element.html(t.buildTag("table.virtualScrollElement",c[0].outerHTML)),i=t.buildTag("div.e-seriesPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("SeriesPage"))[0].outerHTML+t.buildTag("span.series_CurrentPage",this._seriesCurrentPage)[0].outerHTML+" / "+t.buildTag("span.series_pageCount",this._seriesPageCount)[0].outerHTML)[0].outerHTML,this._seriesPageCount>1&&this.element.append(i),l=t.buildTag("div.e-categPageIndicator inActive",t.buildTag("span.axislabel",this._getLocalizedLabels("CategoricalPage"))[0].outerHTML+t.buildTag("span.categ_CurrentPage",this._categCurrentPage)[0].outerHTML+" / "+t.buildTag("span.categ_pageCount",this._categPageCount)[0].outerHTML)[0].outerHTML,this._categPageCount>1&&this.element.append(l)}}),t.PivotGrid.Layout={Normal:"normal",NormalTopSummary:"normaltopsummary",NoSummaries:"nosummaries",ExcelLikeLayout:"excellikelayout"},t.PivotGrid.Locale=t.PivotGrid.Locale||{},t.PivotGrid.Locale["en-US"]={Sort:"Sort",Search:"Search",SelectField:"Select field",LabelFilterLabel:"Show the items for which the label",ValueFilterLabel:"Show the items for which",ClearSorting:"Clear Sorting",ClearFilterFrom:"Clear Filter From",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",and:"and",LabelFilters:"Label Filters  ",BeginsWith:"Begins With",DoesNotBeginsWith:"Does Not Begin With",EndsWith:"Ends With",NotEndsWith:"Not Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",ValueFilters:"Value Filters",ClearFilter:"Clear Filter",Equals:"Equals",DoesNotEquals:"Does Not Equal",NotEquals:"Not Equals",GreaterThan:"Greater Than",IsGreaterThan:"Is Greater Than",IsGreaterThanOrEqualTo:"Is Greater Than Or Equal To",IsLessThan:"Is Less Than",IsLessThanOrEqualTo:"Is Less Than Or Equal To",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Top10:"Top Count",AddToFilter:"Add to Filter",AddToRow:"Add to Row",AddToColumn:"Add to Column",AddToValues:"Add to Values",Warning:"Warning",Error:"Error",GroupingBarAlertMsg:"The field you are moving cannot be placed in that area of the report",Measures:"Measures",Expand:"Expand",Collapse:"Collapse",ToolTipRow:"Row",ToolTipColumn:"Column",ToolTipValue:"Value",NoValue:"No value",SeriesPage:"Series Page",CategoricalPage:"Categorical Page",DragFieldHere:"Drag field here",ColumnArea:"Drop column here",RowArea:"Drop row here",ValueArea:"Drop values here",Close:"Close",OK:"OK",Cancel:"Cancel",Remove:"Remove",Goal:"Goal",Status:"Status",Trend:"Trend",Value:"Value",ConditionalFormattingErrorMsg:"The given value is not matched",ConditionalFormattingConformMsg:"Are you sure you want to remove the selected format?",EnterOperand1:"Enter Operand1",EnterOperand2:"Enter Operand2",ConditionalFormatting:"Conditional Formatting",Condition:"Conditional Type",Value1:"Value1",Value2:"Value2",Editcondtion:"Edit Condition",AddNew:"Add New",Format:"Format",Fontcolor:"Font Color",Backcolor:"Back Color",Borderrange:"Border Range",Borderstyle:"Border Style",Fontsize:"Font Size",Fontstyle:"Font Style",Bordercolor:"Border Color",NoMeasure:"Please add any measure",Solid:"Solid",Dashed:"Dashed",Dotted:"Dotted",Double:"Double",Groove:"Groove",Inset:"Inset",Outset:"Outset",Ridge:"Ridge",None:"None",Algerian:"Algerian",Arial:"Arial",BodoniMT:"Bodoni MT",BritannicBold:"Britannic Bold",Cambria:"Cambria",Calibri:"Calibri",CourierNew:"Courier New",DejaVuSans:"DejaVu Sans",Forte:"Forte",Gerogia:"Gerogia",Impact:"Impact",SegoeUI:"Segoe UI",Tahoma:"Tahoma",TimesNewRoman:"Times New Roman",Verdana:"Verdana",CubeDimensionBrowser:"Cube Dimension Browser",SelectHierarchy:"Select Hierarchy",CalculatedField:"Calculated Field",Name:"Name:",Add:"Add",Formula:"Formula:",Delete:"Delete",Fields:"Fields:",MultipleItems:"Multiple items",All:"All",CalculatedFieldNameNotFound:"Given CalculatedField name is not found",InsertField:"Insert Field",EmptyField:"Please enter Calculated field name or formula",NotValid:"Given formula is not valid",NotPresent:"Value field used in any of the Calculated Field formula is not present in the PivotGrid",Confirm:"Calculated field with the same name already exists. Do you want to Replace ?",CalcValue:"Calculated field can be inserted only in value area field",NoRecordsToDisplay:"No records to display.",NumberFormatting:"Number Formatting",FrozenHeaders:"Frozen Headers",CellSelection:"Cell Selection",CellContext:"Cell Context",ColumnResize:"Column Resize",Layouts:"Layouts",ExcelLikeLayout:"Excel Like Layout",NormalLayout:"Normal Layout",NormalTopSummary:"NormalTopSummary Layout",NoSummaries:"NoSummaries Layout",FrozenHeader:"Frozen Header",AdvancedFiltering:"Advanced Filtering",Amount:"Amount",Quantity:"Quantity",Measures:"Measures",NumberFormats:"Number Formats",Exporting:"Exporting",FileName:"File Name",ToolTip:"Tool Tip",RTL:"RTL",CollapseByDefault:"Collapse By Default",EnableDisablePaging:"Enable / Disable Paging",PagingOptions:"Paging Options",CategoricalPageSize:"Categorical Page Size",SeriesPageSize:"Series Page Size",HyperLink:"HyperLink",CellEditing:"Cell Editing",GroupingBar:"Grouping Bar",SummaryCustomization:"Summary Customization",SummaryTypes:"Summary Types",SummaryType:"Summary Type",EnableRowHeaderHyperlink:"Enable RowHeaderHyperLink",EnableColumnHeaderHyperlink:"Enable ColumnHeaderHyperLink",EnableValueCellHyperlink:"Enable ValueCellHyperLink",EnableSummaryCellHyperlink:"Enable SummaryCellHyperLink",HideGrandTotal:"Hide GrandTotal",HideSubTotal:"Hide SubTotal",Row:"Row",Column:"Column",Both:"Both",Sum:"Sum",Average:"Average",Count:"Count",Min:"Min",Max:"Max",Excel:"Excel",Word:"Word",PDF:"PDF",CSV:"CSV",Total:"Total",GrandTotal:"Grand Total",DrillThrough:"Drill Through",EnabledState:"Enabled State",Months:"Months",Days:"Days",Quarters:"Quarters",Years:"Years",Qtr:"Qtr",Quarter:"Quarter",AddCurrentSelectionToFilter:"Add current selection to filter",FormatName:"Format Name",RemoveFormat:"Remove Format",Edit:"Edit",DuplicateFormatName:"Duplicate Format Name",EnterFormatName:"Enter Format Name",NotAllItemsShowing:"Not all child nodes are shown",EditorLinkPanelAlert:"The members have more than 1000 items under one or more parent. Only the first 1000 items are displayed under each parent.",Exception:"Exception"},t.PivotGrid.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv"},t.PivotGrid.ConditionalOptions={Equals:"Equals",NotEquals:"Not Equals",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between"},t.PivotGrid.AnalysisMode={Olap:"olap",Relational:"relational"},t.PivotGrid.ExportMode={JSON:"json",PivotEngine:"pivotengine"},t.PivotGrid.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"},t.olap.base&&e.extend(t.PivotGrid.prototype,t.olap.base),t.olap._mdxParser&&e.extend(t.PivotGrid.prototype,t.olap._mdxParser)}(jQuery,Syncfusion)})},1039:function(e,t,i){var l,a,r;
/*!
*  filename: ej.pivotchart.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotchart.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(o){a=[i(15),i(4),i(21),i(65),i(38),i(16),i(55),i(66),i(97),i(1011),i(1009),i(1010)],void 0===(r="function"==typeof(l=o)?l.apply(t,a):l)||(e.exports=r)}(function(){!function(e,t,i){t.widget("ejPivotChart","ej.PivotChart",{_rootCSS:"e-pivotchart",element:null,model:null,_requiresID:!0,validTags:["div","span"],defaults:e.extend(t.datavisualization.Chart.prototype.defaults,{url:"",analysisMode:"pivot",operationalMode:"clientmode",cssClass:"",currentReport:"",customObject:{},enableRTL:!1,enableDefaultValue:!1,isResponsive:!1,enable3D:!1,enableContextMenu:!1,enableMultiLevelLabels:!1,enableXHRCredentials:!1,rotation:0,serviceMethodSettings:{initialize:"InitializeChart",drillDown:"DrillChart",exportPivotChart:"Export",paging:"paging"},dataSource:{data:null,sourceInfo:"",providerName:"ssas",isFormattedValues:!1,columns:[],cube:"",catalog:"",rows:[],values:[],filters:[]},locale:null,drillSuccess:null,load:null,beforeServiceInvoke:null,afterServiceInvoke:null,renderComplete:null,renderFailure:null,renderSuccess:null,beforeExport:null,beforeSeriesRender:null,beforePivotEnginePopulate:null}),dataTypes:{dataSource:{data:"data",columns:"array",rows:"array",values:"array",filters:"array"},marker:"data",crossHair:"data",size:"data",serviceMethodSettings:{initialize:"enum",drillDown:"enum",exportPivotChart:"enum",paging:"enum"},zooming:"data",customObject:"data"},observables:["title.text","commonSeriesOptions.type","locale"],titleText:t.util.valueFunction("title.text"),seriesType:t.util.valueFunction("commonSeriesOptions.type"),locale:t.util.valueFunction("locale"),getOlapReport:function(){return this._olapReport},setOlapReport:function(e){this._olapReport=e},getJSONRecords:function(){return this._JSONRecords},setJSONRecords:function(t){this._JSONRecords=e.parseJSON(t)},getPivotEngine:function(){return this._pivotEngine},setPivotEngine:function(e){this._pivotEngine=e},_init:function(){this._initPrivateProperties(),this._load()},_destroy:function(){this._pivotEngine=null,this.element.empty().removeClass("e-pivotchart"+this.model.cssClass).removeAttr("tabindex"),this._waitingPopup!=i&&this._waitingPopup.destroy(),""==this.element.attr("class")&&this.element.removeAttr("class")},_initPrivateProperties:function(){this._id=this.element.attr("id"),this._olapReport="",this._JSONRecords=null,this._currentAction="initialize",this._selectedItem="",this._selectedIndex=-1,this._selectedTagInfo=null,this._tagCollection=[],this._selectedTags=[],this._labelCurrentTags=[],this._startDrilldown=!1,this._drillAction="",this._initZooming=!1,this._dimensionIndex=-1,this._selectedMenuItem="",this._pivotEngine=null,this._curFocus=null,this._prevDrillElements=[],this._drillParams=[],this._currentDrillInfo=[],this._selectedSeriesInfo=[],this._waitingPopup=null,this._pivotClientObj=null,this._xTitle=null,this._yTitle=null,this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}}},_load:function(){var l,a;if(this.model.locale=!t.isNullOrUndefined(t.util.getVal(this.locale()))&&e.isFunction(this.locale)?this.locale():"en-US",l={action:"initialize",element:this.element,customObject:this.model.customObject},this._trigger("load",l),this.element.addClass(this.model.cssClass),e(this.element).parents(".e-pivotclient").length>0?(this._pivotClientObj=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+this._pivotClientObj._id+"_maxView")[0]?e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()):(this.element.ejWaitingPopup({showOnInit:!0}),this._waitingPopup=this.element.data("ejWaitingPopup"),this._waitingPopup.show()),""!=this.model.zooming&&(this._initZooming=!0),null==this.model.dataSource.data&&""!=this.model.url||this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode){if(this.model.operationalMode=t.PivotChart.OperationalMode.ServerMode,""==this.model.url)return void this.renderChartFromJSON("");null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._currentAction,element:this.element,customObject:this.model.customObject}),a=JSON.stringify(this.model.customObject),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initialize",currentReport:this.model.currentReport,customObject:a}),this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?this._generateData:this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:"initialize"}),this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?this._generateData:this.renderControlSuccess)}else this.model.operationalMode=t.PivotChart.OperationalMode.ClientMode,this.model.analysisMode=""!=this.model.dataSource.cube?t.PivotChart.AnalysisMode.Olap:t.PivotChart.AnalysisMode.Pivot,this.refreshControl()},refreshControl:function(){var i,l,a,r;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if(t.PivotAnalysis.setFieldCaptions(this.model.dataSource),t.isNullOrUndefined(this._pivotClientObj)||(this.model.valueSortSettings=this._pivotClientObj.model.valueSortSettings),i=t.PivotAnalysis.pivotEnginePopulate(this.model),l=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,this._pivotEngine=i.pivotEngine,i.pivotEngine.length>0)if(t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)||this.model.enableMultiLevelLabels)this._generateData(this._pivotEngine);else{for(a=this._cloneEngine(this._pivotEngine),r=0;r<this._labelCurrentTags.expandedMembers.length;r++)this._cropData(a,this._labelCurrentTags.expandedMembers[r],0,!0);this._generateData(a)}else t.isNullOrUndefined(this._waitingPopup)||(t.isNullOrUndefined(l)||(l._isTimeOut=!1),this._waitingPopup.hide());else t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this)},_setFirst:!1,_setModel:function(i){var l,a,r=this.element.find("#"+this._id+"Container").data("ejChart");for(l in i)switch(l){case"olapReport":this.setOlapReport(i[l]),this._load();break;case"jsonData":this.setJSONRecords(i[l]),this.element.renderChartFromJSON(i[l]);break;case"refreshPivotChart":this.element.renderChartFromJSON(i[l]);break;case"customObject":this.model.customObject=i[l];break;case"height":this.model.size.height=i[l],r&&r.redraw();break;case"width":this.model.size.width=i[l],r&&r.redraw();break;case"enableDefaultValue":this.model.enableDefaultValue=i[l];break;case"operationalMode":this.model.operationalMode=i[l];break;case"analysisMode":this.model.analysisMode=i[l];break;case"commonSeriesOptions":if(r){for(!t.isNullOrUndefined(t.util.getVal(i[l]).type)&&e.isFunction(t.util.getVal(i[l]).type)?this.seriesType(i[l].type()):t.isNullOrUndefined(i[l].type)||this.seriesType(i[l].type),r.model.commonSeriesOptions=e.extend({},r.model.commonSeriesOptions,i[l]),r.model.type=r.model.commonSeriesOptions.type=this.seriesType(),a=0;a<r.model.series.length;a++)r.model.series[a].type=r.model.type;r.redraw()}break;case"title":r&&(!t.isNullOrUndefined(t.util.getVal(i[l]).text)&&e.isFunction(t.util.getVal(i[l]).text)?this.titleText(i[l].text()):t.isNullOrUndefined(i[l].text)||this.titleText(i[l].text),r.model.title.text=this.titleText(),r.redraw());break;case"animation":this.model.animation=i[l];break;case"crossHair":this.model.crossHair=i[l];break;case"marker":this.model.marker=i[l];break;case"zooming":this.model.zooming=i[l];break;case"legend":this.model.legend=i[l];break;case"primaryXAxis":this.model.primaryXAxis=i[l];break;case"primaryYAxis":this.model.primaryYAxis=i[l];break;case"dataSource":this.model.dataSource=e.extend({},this.model.dataSource,i[l]),this.refreshControl(),this._schemaData&&this._schemaData._load();break;case"locale":this.locale(t.util.getVal(i[l])),this._load();break;case"enableRTL":this.model.enableRTL=i[l],this._load();break;case"isResponsive":this.model.isResponsive=i[l],r&&r.redraw();break;case"enable3D":this.model.enable3D=i[l],r&&r.redraw();break;case"enableContextMenu":this.model.enableContextMenu=i[l],r&&r.redraw();break;case"enableMultiLevelLabels":this.model.enableMultiLevelLabels=i[l],this._load();break;case"rotation":this.model.rotation=i[l],r&&r.redraw();break;default:e.extend(!0,this.model,{},i[l])}r&&this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()})},_keyDownPress:function(e){var i,l,a;13!==e.which||t.isNullOrUndefined(this._curFocus)||this._curFocus.click(),(39===e.which||37===e.which||38===e.which||40===e.which)&&this.element.find(".e-dialog").length>0&&(e.preventDefault(),(i=this.element.find(".e-dialog")).tabindex=-1,i.focus(),l=i.find("li"),39===e.which||40===e.which?(t.isNullOrUndefined(this._curFocus)?this._curFocus=l.eq(0):(this._curFocus.removeClass("e-hoverCell"),a=this._curFocus.next(),this._curFocus=a.length>0?a:l.eq(0)),this._curFocus.addClass("e-hoverCell")):(37===e.which||38===e.which)&&(t.isNullOrUndefined(this._curFocus)?this._curFocus=l.last():(this._curFocus.removeClass("e-hoverCell"),a=this._curFocus.prev(),this._curFocus=a.length>0?a:l.last()),this._curFocus.addClass("e-hoverCell")))},_wireEvents:function(){this._on(e(document),"keydown",this._keyDownPress),!this.model.enableContextMenu||this.element.parents(".e-pivotclient").length>0||this._on(this.element,"contextmenu","#"+this._id+"Container",t.proxy(function(){var i,l,a="<li class='chartTypes'><a>"+this._getLocalizedLabels("ChartTypes")+"</a><ul><li class='e-line'><a>"+this._getLocalizedLabels("Line")+"</a></li><li class='e-spline'><a>"+this._getLocalizedLabels("Spline")+"</a></li><li class='e-column'><a>"+this._getLocalizedLabels("Column")+"</a></li><li class='e-area'><a>"+this._getLocalizedLabels("Area")+"</a></li><li class='e-splinearea'><a>"+this._getLocalizedLabels("SplineArea")+"</a></li><li class='e-stepline'><a>"+this._getLocalizedLabels("StepLine")+"</a></li><li class='e-steparea'><a>Step Area</a></li><li class='e-pie'><a>Pie</a></li><li class='e-bar'><a>Bar</a></li><li class='e-stackingarea'><a>Stacking Area</a></li><li class='e-stackingcolumn'><a>"+this._getLocalizedLabels("StackingColumn")+"</a></li><li class='e-stackingbar'><a>"+this._getLocalizedLabels("StackingBar")+"</a></li><li class='e-funnel'><a>"+this._getLocalizedLabels("Funnel")+"</a></li><li class='e-pyramid'><a>"+this._getLocalizedLabels("Pyramid")+"</a></li><li class='e-doughnut'><a>"+this._getLocalizedLabels("Doughnut")+"</a></li><li class='e-scatter'><a>"+this._getLocalizedLabels("Scatter")+"</a></li><li class='e-bubble'><a>"+this._getLocalizedLabels("Bubble")+"</a></li></ul></li>",r="<li class='chart3DTypes'><a>"+this._getLocalizedLabels("TDCharts")+"</a><ul><li class='e-column'><a>"+this._getLocalizedLabels("ColumnTD")+"</a></li><li class='e-pie'><a>"+this._getLocalizedLabels("PieTD")+"</a></li><li class='e-bar'><a>"+this._getLocalizedLabels("BarTD")+"</a></li><li class='e-stackingbar'><a>"+this._getLocalizedLabels("StackingBarTD")+"</a></li><li class='e-stackingcolumn'><a>"+this._getLocalizedLabels("StackingColumnTD")+"</a></li><li class='e-disable3D'><a>"+this._getLocalizedLabels("DisableTD")+"</a></li></ul></li>",o="<li class='exportTypes'><a>"+this._getLocalizedLabels("Exporting")+"</a><ul><li class='e-excel'><a>"+this._getLocalizedLabels("Excel")+"</a></li><li class='e-word'><a>"+this._getLocalizedLabels("Word")+"</a></li><li class='e-pdf'><a>"+this._getLocalizedLabels("Pdf")+"</a></li><li class='e-png'><a>"+this._getLocalizedLabels("PNG")+"</a></li><li class='e-emf'><a>"+this._getLocalizedLabels("EMF")+"</a></li><li class='e-gif'><a>"+this._getLocalizedLabels("GIF")+"</a></li><li class='e-jpg'><a>"+this._getLocalizedLabels("JPG")+"</a></li><li class='e-bmp'><a>"+this._getLocalizedLabels("BMP")+"</a></li></ul></li>",s="<li class='e-smartLabels'><a>"+this._getLocalizedLabels("SmartLabels")+"</a><ul><li class='e-rotate45'><a>"+this._getLocalizedLabels("Rotate45")+"</a></li><li class='e-rotate90'><a>"+this._getLocalizedLabels("Rotate90")+"</a></li><li class='e-trim'><a>"+this._getLocalizedLabels("Trim")+"</a></li><li class='e-multipleRows'><a>"+this._getLocalizedLabels("MultipleRows")+"</a></li><li class='e-wrap'><a>"+this._getLocalizedLabels("Wrap")+"</a></li><li class='e-hiding'><a>"+this._getLocalizedLabels("Hide")+"</a></li><li class='e-wrapByWord'><a>"+this._getLocalizedLabels("WrapByWord")+"</a></li></ul></li>",n="<li class='e-interaction'><a>"+this._getLocalizedLabels("Interactions")+"</a><ul><li class='e-crossHair'><a>"+this._getLocalizedLabels("CrossHair")+"</a></li><li class='e-trackBall'><a>"+this._getLocalizedLabels("TrackBall")+"</a></li><li class='none'><a>"+this._getLocalizedLabels("None")+"</a></li></ul></li>",d=t.buildTag("ul#"+this._id+"_ContextMenu",t.buildTag("li.e-toolTip",t.buildTag("a",this._getLocalizedLabels("Tooltip"))[0].outerHTML)[0].outerHTML+t.buildTag("li.e-legend",t.buildTag("a",this._getLocalizedLabels("Legend"))[0].outerHTML)[0].outerHTML+(this.model.enable3D?"":t.buildTag("li.e-zooming",t.buildTag("a",this._getLocalizedLabels("Zooming"))[0].outerHTML)[0].outerHTML)+a+r+o+(this.model.enable3D?"":n+s))[0].outerHTML;e("#"+this._id).append(d),i=this.element.find("#"+this._id+"Container"),this.element.find("#"+this._id+"_ContextMenu").ejMenu({width:"150px",menuType:t.MenuType.ContextMenu,contextMenuTarget:i,enableRTL:this.model.enableRTL,click:t.proxy(this._contextMenuClick,this)}),l=t.buildTag("span.e-enabledState").addClass("e-icon").attr("aria-label",this._getLocalizedLabels("EnabledState"))[0].outerHTML,this.model.enable3D?e("#"+this._id+"_ContextMenu").find(".chart3DTypes ."+this.model.commonSeriesOptions.type+" a:eq(0)").append(l):e("#"+this._id+"_ContextMenu").find(".chartTypes ."+this.model.commonSeriesOptions.type+" a:eq(0)").append(l),this.model.commonSeriesOptions.tooltip.visible&&e("#"+this._id+"_ContextMenu").find(".e-toolTip a:eq(0)").append(l),this.model.zooming.enable&&e("#"+this._id+"_ContextMenu").find(".e-zooming a:eq(0)").append(l),this.model.legend.visible&&e("#"+this._id+"_ContextMenu").find(".e-legend a:eq(0)").append(l),"none"!=this.model.primaryXAxis.labelIntersectAction&&(e("#"+this._id+"_ContextMenu").find(".e-smartLabels a:eq(0)").append(l),e("#"+this._id+"_ContextMenu").find(".e-smartLabels ."+this.model.primaryXAxis.labelIntersectAction+" a:eq(0)").append(l),"hide"==this.model.primaryXAxis.labelIntersectAction&&e("#"+this._id+"_ContextMenu").find(".e-smartLabels .e-hiding a:eq(0)").append(l)),"crosshair"==this.model.crosshair.type&&this.model.crosshair.visible&&(e("#"+this._id+"_ContextMenu").find(".e-interaction a:eq(0)").append(l),e("#"+this._id+"_ContextMenu").find(".e-interaction .e-crossHair a:eq(0)").append(l),this.mode.enable3D||e("#"+this._id+"_ContextMenu").ejMenu("disableItem",this._getLocalizedLabels("Tooltip"))),"trackBall"==this.model.crosshair.type&&this.model.crosshair.visible&&(e("#"+this._id+"_ContextMenu").find(".e-interaction a:eq(0)").append(l),e("#"+this._id+"_ContextMenu").find(".e-interaction .e-trackBall a:eq(0)").append(l),this.mode.enable3D||e("#"+this._id+"_ContextMenu").ejMenu("disableItem",this._getLocalizedLabels("Tooltip"))),this.model.crosshair.visible||e("#"+this._id+"_ContextMenu").find(".e-interaction .none a:eq(0)").append(l)})),this._on(this.element,"click",".e-menuList.exp, .e-menuList.clp, .e-menuList.exit",this._seriesContextClick),t.isNullOrUndefined(this._pivotClientObj)&&e(window).on("resize",e.proxy(this._reSizeHandler,this)),this._on(this.element,"click",".e-chart3DImg",function(i){var l=this;l._createDialog(i),e(".e-chart3DTypesIcon").click(function(e){l._contextMenuClick(e),t.isNullOrUndefined(this._pivotClientObj)||(l._pivotClientObj._unWireEvents(),l._pivotClientObj._wireEvents())})}),this.element.parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(this._on(this.element,"click",".e-toolTipImg",function(){this.model.commonSeriesOptions.tooltip.visible=!this.model.commonSeriesOptions.tooltip.visible,this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()}),this.model.commonSeriesOptions.tooltip.visible?this.element.find(".e-toolTipImg").addClass("e-enabled"):this.element.find(".e-toolTipImg").removeClass("e-enabled")}),this._on(this.element,"click",".e-exportImg",function(t){var i=this;i._createDialog(t),e(".e-exportTypesIcon").click(function(e){i._contextMenuClick(e)})}),this._on(this.element,"click",".e-smartLabels",function(t){var i=this;i._createDialog(t),e(".e-smartLabelsIcon").click(function(e){i._contextMenuClick(e)})}),this._on(this.element,"click",".e-interaction",function(t){var i=this;i._createDialog(t),e(".e-interactionsIcon").click(function(e){i._contextMenuClick(e)})}),this._on(this.element,"click",".e-icon-xAxis-title",function(){this.element.find(".e-icon-xAxis-title").hasClass("e-enabled")?(this.element.find(".e-icon-xAxis-title").removeClass("e-enabled"),this.model.primaryXAxis.title.enable=!1):(this.element.find(".e-icon-xAxis-title").addClass("e-enabled"),this.model.primaryXAxis.title.enable=!0),this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()})}),this._on(this.element,"click",".e-icon-yAxis-title",function(){this.element.find(".e-icon-yAxis-title").hasClass("e-enabled")?(this.element.find(".e-icon-yAxis-title").removeClass("e-enabled"),this.model.primaryYAxis.title.enable=!1):(this.element.find(".e-icon-yAxis-title").addClass("e-enabled"),this.model.primaryYAxis.title.enable=!0),this.renderControlSuccess({JsonRecords:JSON.stringify(this.getJSONRecords()),OlapReport:this.getOlapReport()})}),this._on(this.element,"click",".e-legend",function(e){this._contextMenuClick(e)}),this._on(this.element,"click",".e-zooming",function(e){this._contextMenuClick(e)}))},_unWireEvents:function(){this._off(e(document),"keydown",this._keyDownPress),e(document.body).off("click"),this._off(this.element,"click",".e-menuList.exp, .e-menuList.clp, .e-menuList.exit",this._seriesContextClick),e(window).off("resize",e.proxy(this._reSizeHandler,this)),this._off(this.element,"contextmenu"),this._off(this.element,"click",".e-chartTypesImg"),this._off(this.element,"click",".e-toolTipImg"),this._off(this.element,"click",".e-chart3DImg"),this._off(this.element,"click",".e-exportImg"),this._off(this.element,"click",".e-legend"),this._off(this.element,"click",".e-zooming"),this._off(this.element,"click",".e-smartLabels"),this._off(this.element,"click",".e-interaction"),this._off(this.element,"click",".e-icon-xAxis-title"),this._off(this.element,"click",".e-icon-yAxis-title")},_seriesContextClick:function(l){var a,r,o,s,n,d;if(this._curFocus=null,-1==l.target.innerHTML.indexOf(this._getLocalizedLabels("Expand"))&&-1==l.target.innerHTML.indexOf(this._getLocalizedLabels("Collapse"))&&-1==l.target.innerHTML.indexOf(this._getLocalizedLabels("Exit")))return!1;if(l.target.innerHTML==this._getLocalizedLabels("Exit"))this.element.find("#"+this._id+"ExpandMenu, .e-expandMenu, .e-dialog").remove();else if(l.target.innerHTML.indexOf(this._getLocalizedLabels("Expand"))>-1)if(this._drillAction="drilldown",e(this.element).parents(".e-pivotclient").length>0?(s=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+s._id+"_maxView")[0]?e("#"+s._id+"_maxView").ejWaitingPopup({showOnInit:!0}):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode)h=this.model.enableRTL?l.target.innerHTML.split(" - ")[0]:l.target.innerHTML.split(" - ")[1],this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?this._getChartDrillDown("",h,l):(this._labelCurrentTags.collapsedMembers=e.grep(this._labelCurrentTags.collapsedMembers,function(e){return e!=h}),a=e(this.getJSONRecords().seriesTags).filter(function(e,t){return t.split("::")[2]==h})[0],r=t.olap._mdxParser._splitCellInfo(a),this._getChartDrillDown(a,r,l));else if(o=JSON.stringify(this.model.customObject),this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot)h=this.model.enableRTL?l.target.innerHTML.split(" - ")[0]:l.target.innerHTML.split(" - ")[1],this._selectedItem=h,t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&(this._labelCurrentTags.expandedMembers=[]),this._labelCurrentTags.expandedMembers.push(h),null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers)+(t.isNullOrUndefined(this._pivotClientObj)?"":"-##-"+JSON.stringify(this._pivotClientObj.model.valueSortSettings)),customObject:o,currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers),currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess);else{d=this,this._isDrilled||(this._isDrilled=!0,jQuery.each(l.target.parentElement.children,function(e,t){t.innerHTML==l.target.innerHTML&&(d._dimensionIndex=e)}));try{n=JSON.parse(this.getOlapReport()).Report}catch(e){n=this.getOlapReport()}this._drillAction="drilldown",this._selectedItem=this.model.enableRTL?e.trim(l.target.innerHTML.replace(" - "+this._getLocalizedLabels("Expand"),"")):e.trim(l.target.innerHTML.replace(this._getLocalizedLabels("Expand")+" - ","")),jQuery.each(this._labelCurrentTags,function(e,t){if(t.name==d._selectedItem)return d._tagCollection=[],d._tagCollection=d._selectedTags.slice(),d._selectedTagInfo=t.tag,d._selectedMenuItem=t.name,!1}),this._startDrilldown=!0,null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:n,customObject:o}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:n,clientReports:this._pivotClientObj.reports,customObject:o}),this.renderControlSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:n}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drilldown#fullchart":"drilldown",drilledSeries:this._selectedTagInfo,olapReport:n,clientReports:this._pivotClientObj.reports}),this.renderControlSuccess)}else if(this._drillAction="drillup",e(this.element).parents(".e-pivotclient").length>0?(s=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),e("#"+s._id+"_maxView")[0]?e("#"+s._id+"_maxView").ejWaitingPopup({showOnInit:!0}):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show()):t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode)h=this.model.enableRTL?l.target.innerHTML.split(" - ")[0]:l.target.innerHTML.split(" - ")[1],this._getChartDrillDown("",h,l);else if(o=JSON.stringify(this.model.customObject),this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){var h=this.model.enableRTL?l.target.innerHTML.split(" - ")[0]:l.target.innerHTML.split(" - ")[1],c=!1,p=[];jQuery.map(this._labelCurrentTags.expandedMembers,function(e){e==h&&(c=!0),c||p.push(e)}),this._selectedItem=h,this._labelCurrentTags.expandedMembers=p,this._currentDrillInfo=e.extend([],this._labelCurrentTags.expandedMembers,!0).concat([h]),e(this.element).parents(".e-pivotclient").length>0&&(this._labelCurrentTags.expandedMembers=[],(s=e(this.element).parents(".e-pivotclient").data("ejPivotClient"))._drillParams.length>0&&(s._drillParams=e.grep(s._drillParams,function(e){return e.indexOf(h)<0}),s._getDrilledMember())),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers)+(t.isNullOrUndefined(this._pivotClientObj)?"":"-##-"+JSON.stringify(this._pivotClientObj.model.valueSortSettings)),customObject:o,currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drilldown",drilledSeries:JSON.stringify(this._labelCurrentTags.expandedMembers),currentReport:JSON.parse(this.getOlapReport()).Report}),this.renderControlSuccess)}else{try{n=JSON.parse(this.getOlapReport()).Report}catch(e){n=this.getOlapReport()}this._drillAction="drillup",this._selectedItem=this.model.enableRTL?e.trim(l.target.innerHTML.replace(" - "+this._getLocalizedLabels("Collapse"),"")):e.trim(l.target.innerHTML.replace(this._getLocalizedLabels("Collapse")+" - ","")),this._tagCollection=[],this._tagCollection=this._selectedTags.slice(),d=this,jQuery.each(this._tagCollection,function(e,t){if(t.name==d._selectedItem)return d._selectedIndex=e,d._selectedTagInfo=t.tag,d._tagCollection.splice(e,d._tagCollection.length),!1}),0==this._tagCollection.length&&(this._isDrilled=!1),this._startDrilldown=!0,null!=this.model.beforeServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:n,customObject:o}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:n,clientReports:this._pivotClientObj.reports,customObject:o}),this.renderControlSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:n}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this.model.enableMultiLevelLabels?"drillup#fullchart":"drillup",drilledSeries:this._selectedTagInfo,olapReport:n,clientReports:reports}),this.renderControlSuccess)}},_createDialog:function(l){var a,r,o,s,n=this;e(l.target).hasClass("e-exportImg")?(a=t.buildTag("div.e-exportTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-excel e-exportTypesIcon").attr({title:this._getLocalizedLabels("Excel"),"aria-label":this._getLocalizedLabels("Excel"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-word e-exportTypesIcon").attr({title:this._getLocalizedLabels("Word"),"aria-label":this._getLocalizedLabels("Word"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pdf e-exportTypesIcon").attr({title:this._getLocalizedLabels("Pdf"),"aria-label":this._getLocalizedLabels("Pdf"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-png e-exportTypesIcon").attr({title:this._getLocalizedLabels("PNG"),"aria-label":this._getLocalizedLabels("PNG"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-emf e-exportTypesIcon").attr({title:this._getLocalizedLabels("EMF"),"aria-label":this._getLocalizedLabels("EMF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-gif e-exportTypesIcon").attr({title:this._getLocalizedLabels("GIF"),"aria-label":this._getLocalizedLabels("GIF"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-jpg e-exportTypesIcon").attr({title:this._getLocalizedLabels("JPG"),"aria-label":this._getLocalizedLabels("JPG"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-bmp e-exportTypesIcon").attr({title:this._getLocalizedLabels("BMF"),"aria-label":this._getLocalizedLabels("BMF"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-exportTypesDialog").length&&(e(a).appendTo(this.element),e(a).css("left",l.target.offsetLeft+20+"px").css("top",l.target.offsetTop+15+"px"),this.model.enableRTL&&e(a).addClass("e-rtl"))):e(l.target).hasClass("e-chart3DImg")?(r=t.buildTag("div.e-chart3DTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-column3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("ColumnTD"),"aria-label":this._getLocalizedLabels("ColumnTD"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pie3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("PieTD"),"aria-label":this._getLocalizedLabels("PieTD"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-bar3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("BarTD"),"aria-label":this._getLocalizedLabels("BarTD"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-stackingbar3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("StackingBarTD"),"aria-label":this._getLocalizedLabels("StackingBarTD"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-stackingcolumn3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("StackingColumnTD"),"aria-label":this._getLocalizedLabels("StackingColumnTD"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-disable3D e-chart3DTypesIcon").attr({title:this._getLocalizedLabels("DisableTD"),"aria-label":this._getLocalizedLabels("DisableTD"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-chart3DTypesDialog").length&&(e(r).appendTo(this.element),e(r).css("left",l.target.offsetLeft+20+"px").css("top",l.target.offsetTop+15+"px"),n.model.enable3D&&e("."+this.model.type+"3D").addClass("e-enabled"),this.model.enableRTL&&e(r).addClass("e-rtl"))):e(l.target).hasClass("e-smartLabels")?(o=t.buildTag("div.e-smartLabelsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-rotate45 e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Rotate45"),"aria-label":this._getLocalizedLabels("Rotate45"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-rotate90 e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Rotate90"),"aria-label":this._getLocalizedLabels("Rotate90"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-trim e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Trim"),"aria-label":this._getLocalizedLabels("Trim"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-multipleRows e-smartLabelsIcon").attr({title:this._getLocalizedLabels("MultipleRows"),"aria-label":this._getLocalizedLabels("MultipleRows"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-wrap e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Wrap"),"aria-label":this._getLocalizedLabels("Wrap"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-hiding e-smartLabelsIcon").attr({title:this._getLocalizedLabels("Hide"),"aria-label":this._getLocalizedLabels("Hide"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-wrapByWord smartLabelsIcon").attr({title:this._getLocalizedLabels("WrapByWord"),"aria-label":this._getLocalizedLabels("WrapByWord"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-smartLabelsDialog").length&&(e(o).appendTo(this.element),e(o).css("left",l.target.offsetLeft+20+"px").css("top",l.target.offsetTop+15+"px"),"none"!=n.model.primaryXAxis.labelIntersectAction&&"hide"!=n.model.primaryXAxis.labelIntersectAction&&n.model.primaryXAxis.labelIntersectAction!=i&&e("."+n.model.primaryXAxis.labelIntersectAction).addClass("e-enabled"),"hide"==n.model.primaryXAxis.labelIntersectAction&&e(".e-hiding").addClass("e-enabled"),this.model.enableRTL&&e(o).addClass("e-rtl"))):e(l.target).hasClass("e-interaction")&&(s=t.buildTag("div.e-interactionsDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-crossHair e-interactionsIcon").attr({title:this._getLocalizedLabels("CrossHair"),"aria-label":this._getLocalizedLabels("CrossHair"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-trackBall e-interactionsIcon").attr({title:this._getLocalizedLabels("TrackBall"),"aria-label":this._getLocalizedLabels("TrackBall"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.none e-interactionsIcon").attr({title:this._getLocalizedLabels("None"),"aria-label":this._getLocalizedLabels("None"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML),0==this.element.find("div.e-interactionsDialog").length&&(e(s).appendTo(this.element),e(s).css("left",l.target.offsetLeft+20+"px").css("top",l.target.offsetTop+15+"px"),"crosshair"==this.model.crosshair.type&&this.model.crosshair.visible&&this.element.find(".e-crossHair").addClass("e-enabled"),"trackBall"==this.model.crosshair.type&&this.model.crosshair.visible&&this.element.find(".e-trackBall").addClass("e-enabled"),this.model.crosshair.visible||this.element.find(".none").addClass("e-enabled"),this.model.enableRTL&&e(s).addClass("e-rtl")))},_contextMenuClick:function(i){chrtObj=e("#"+this._id).data("ejPivotChart");var l=e(this.element).parents(".e-pivotclient").length>0?e(i.target).attr("class").split(" ")[0]:e(i.element).attr("class").split(" ")[0];if(e(i.element).parents().hasClass("chartTypes"))chrtObj.model.enable3D=!1,chrtObj.model.type=chrtObj.model.commonSeriesOptions.type=!t.isNullOrUndefined(l)&&l.split("-").length>1?l.split("-")[1]:l,"funnel"==chrtObj.model.type&&(chrtObj.model.commonSeriesOptions.marker={dataLabel:{visible:!0,shape:"none",font:{color:"white",size:"12px",fontWeight:"lighter"}}}),("pie"==chrtObj.model.type||"doughnut"==chrtObj.model.type)&&(chrtObj.model.commonSeriesOptions.explode=!0),chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).hasClass("e-toolTip"))chrtObj.model.commonSeriesOptions.tooltip.visible=!chrtObj.model.commonSeriesOptions.tooltip.visible,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).hasClass("e-legend")||e(i.target).hasClass("e-legend"))chrtObj.model.legend.visible=!chrtObj.model.legend.visible,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).hasClass("e-zooming")||e(i.target).hasClass("e-zooming"))chrtObj.model.zooming.enable=!chrtObj.model.zooming.enable,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).parents().hasClass("e-smartLabels")||e(i.target).hasClass("e-smartLabelsIcon"))chrtObj.model.primaryXAxis.labelIntersectAction="e-hiding"==l?"hide":!t.isNullOrUndefined(l)&&l.split("-").length>1?l.split("-")[1]:l,chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).parents().hasClass("e-interaction")||e(i.target).hasClass("e-interactionsIcon"))"e-crossHair"==l&&(chrtObj.model.crosshair.type=t.datavisualization.Chart.CrosshairType.Crosshair,chrtObj.model.crosshair.visible=!0),"e-trackBall"==l&&(chrtObj.model.crosshair.type=t.datavisualization.Chart.CrosshairType.TrackBall,chrtObj.model.crosshair.visible=!0),"none"==l&&(chrtObj.model.crosshair.visible=!1),chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else if(e(i.element).parents().hasClass("chart3DTypes")||e(i.target).hasClass("e-chart3DTypesIcon"))chrtObj.model.enable3D=!0,"e-disable3D"!=l&&(l=l.split("3")[0]),"e-disable3D"==l&&(chrtObj.model.enable3D=!1,l=chrtObj.model.commonSeriesOptions.type),chrtObj.model.type=chrtObj.model.commonSeriesOptions.type=!t.isNullOrUndefined(l)&&l.split("-").length>1?l.split("-")[1]:l,"e-pie"==l&&(chrtObj.model.rotation=24),chrtObj.renderControlSuccess({JsonRecords:JSON.stringify(chrtObj.getJSONRecords()),OlapReport:chrtObj.getOlapReport()});else switch(e(this.element).parents(".e-pivotclient").length>0&&!t.isNullOrUndefined(this._pivotClientObj)&&(this.model.beforeExport=this._pivotClientObj.model.beforeExport),l=!t.isNullOrUndefined(l)&&l.split("-").length>1?l.split("-")[1]:l){case"excel":case"word":case"pdf":chrtObj.exportPivotChart(l,"Sample");break;case"png":chrtObj.exportPivotChart(l,"Sample",t.PivotChart.ExportOptions.PNG);break;case"emf":chrtObj.exportPivotChart(l,"Sample",t.PivotChart.ExportOptions.EMF);break;case"gif":chrtObj.exportPivotChart(l,"Sample",t.PivotChart.ExportOptions.GIF);break;case"jpg":chrtObj.exportPivotChart(l,"Sample",t.PivotChart.ExportOptions.JPG);break;case"bmp":chrtObj.exportPivotChart(l,"Sample",t.PivotChart.ExportOptions.BMP)}},generateJSON:function(e,i){var l,a,r;if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&this._labelCurrentTags.expandedMembers.length>0&&!this.model.enableMultiLevelLabels)for(l=0,a=0;a<this._labelCurrentTags.expandedMembers.length;a++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[a])&&this._labelCurrentTags.expandedMembers[a].length>0)for(a>0&&!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[a-1])&&this._labelCurrentTags.expandedMembers[a-1].length>0&&this._cropData(i,this._selectedSeriesInfo[a-1].split("::")[2],a-1+l,!1),r=0;r<this._labelCurrentTags.expandedMembers[a].length;r++)this._cropData(i,this._labelCurrentTags.expandedMembers[a][r].split("::")[2],a+l,!0),l++;this._generateData(i)},_jsonToEngine:function(e){for(var i,l=JSON.parse(e),a=[],r=0;r<l.length;r++)i=parseInt(l[r].Index.split(",")[0]),t.isNullOrUndefined(a[i])?(a[i]=[],a[i].push(l[r])):a[i].push(l[r]);return a},_generateData:function(l){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C={};if(!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj._isExporting&&(C=e.extend(!0,{},{pivotEngine:this._pivotEngine,labelCurrentTags:this._labelCurrentTags,drillParams:this._drillParams})),!1,l[2]!=i?"Olap"==l[2].Value||"Olap"==l[2]:l.d!=i?!t.isNullOrUndefined(l.d[2])&&"Olap"==l.d[2].Value:"Olap"==l.AnalysisMode)this.renderControlSuccess(l);else{var S={seriesNames:[],chartLables:[],labelTags:[],multiLevelLabels:[],multiLevelLabelTags:[],seriesTags:[],points_Y:[],labelFormat:[],measureNames:""},O="",T=[];if(this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&(a={},l[0]!=i?(e(this.element).parents(".e-pivotclient").length>0?a.JsonRecords=t.isNullOrUndefined(l[0].Value)?l[0]:l[0].Value:(a.JsonRecords={},a.JsonRecords.ChartJSON=t.isNullOrUndefined(l[0].Value)?l[0]:l[0].Value,a.JsonRecords.GridJSON=t.isNullOrUndefined(l[3].Value)?l[3]:l[3].Value),a.PivotReport=t.isNullOrUndefined(l[1].Value)?l[1]:l[1].Value,l=a):l.d!=i&&(e(this.element).parents(".e-pivotclient").length>0?t.isNullOrUndefined(l.d[0])||(r=l.d[0].Key,a.JsonRecords="JsonRecords"==r?l.d[0].Value:[]):(a.JsonRecords={},a.JsonRecords.ChartJSON=t.isNullOrUndefined(l.d[0])||"JsonRecords"!=l.d[0].Key?[]:l.d[0].Value,a.JsonRecords.GridJSON=t.isNullOrUndefined(l.d[3])||"GridJSON"!=l.d[3].Key?[]:l.d[3].Value),a.PivotReport=t.isNullOrUndefined(l.d[1])||"PivotReport"!=l.d[1].Key&&"OlapReport"!=l.d[1].Key?[]:l.d[1].Value,l=a),O=l.PivotReport||l.OlapReport,l=t.isNullOrUndefined(l.JsonRecords.GridJSON)?t.isNullOrUndefined(l.GridJSON)?l.JsonRecords:this._jsonToEngine(l.GridJSON):this._jsonToEngine(l.JsonRecords.GridJSON),this._pivotEngine=l,T=t.isNullOrUndefined(JSON.parse(O).values)?JSON.parse(O).PivotCalculations:JSON.parse(JSON.parse(O).values),S.labelFormat=e.map(T,function(e){return e.Format.toLowerCase()})),(o=l.length)>0&&l[0].length>0){var y=l[0].length,x=[],M=[];for(s=this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)||this.model.enableMultiLevelLabels?this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?l[0][0].ColSpan:this.model.dataSource.rows.length:this.model.dataSource.rows.length-this._labelCurrentTags.expandedMembers.length:l[0][0].ColSpan,this.model.enableMultiLevelLabels&&(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode||this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)?n=l[0][0].RowSpan:(n=this.model.dataSource.columns.length,this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?n+=this.model.dataSource.values.length>0?1:0:n=l[0][0].RowSpan),d="",v=s;v<o;v++){for(h="",D=!1,b=0;b<n;b++)if(!t.isNullOrUndefined(l[v][b])){if(l[v][b].CSS.indexOf("summary")>=0){D=!0,x.push(v);break}l[v][b].Info.indexOf("Measure")>=0&&d.indexOf(l[v][b].Value)<0&&(d+=""==d?l[v][b].Value:"~~"+l[v][b].Value),h+=(""==h?"":""==l[v][b].Value?"":"~~")+l[v][b].Value}D||""==h||S.seriesNames.push(h)}for(v=n;v<y;v++)if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){if(this.model.enableMultiLevelLabels&&s>1){this._drillParams=""!=this._drillAction?this._drillParams:[];var P=e.extend(!0,[],this._drillParams.sort()),w=P.length>0?-1:0,L="";for(v=n;v<y;v++)for(c=P[0],p="",b=0;b<s;b++)p+=""==p?l[b][v].Value:">#>"+l[b][v].Value,(-1==w||""==L||p==P[1])&&(p==c||p==P[1])&&(p==P[1]&&(c=P[1],P.splice(0,1)),w=b+1,L=p),!t.isNullOrUndefined(c)&&w>0&&w==s-1&&b==s-1?(M.push(v),S.chartLables.push(c.split(">#>").join("~~")+"~~"+l[b][v].Value)):!t.isNullOrUndefined(c)&&w>0&&w==b&&l[b][v].CSS.indexOf("summary")>-1?(M.push(v),S.chartLables.push(c.split(">#>").join("~~")+"~~"+l[b][v].Value.split(" Total")[0])):w-1==b&&l[b][v].CSS.indexOf("summary")>-1?(""!=L&&(P[0]=P[0].split(">#>").slice(0,P[0].split(">#>").length-1).join(">#>"),""==P[0]&&(P.splice(0,1),L="")),w-=1):(0==w||""==L)&&0==b&&l[0][v].CSS.indexOf("summary")>-1&&(t.isNullOrUndefined(c)||c.split(">#>")[0]!=l[0][v].Value.split(" Total")[0])&&"Grand Total"!=l[b][v].Value&&(M.push(v),S.chartLables.push(l[b][v].Value.split(" Total")[0]))}else s>1?"summary rstot"==l[0][v].CSS&&"Grand Total"!=l[0][v].Value&&S.chartLables.push(l[0][v].Value.replace(" Total","")):"rowheader"==l[0][v].CSS&&S.chartLables.push(l[0][v].Value);this.model.enableMultiLevelLabels&&(S.multiLevelLabels=e.extend(!0,[],S.chartLables))}else if(t.isNullOrUndefined(this._labelCurrentTags.collapsedMembers)&&(this._labelCurrentTags.collapsedMembers=[]),s>1){var N="",D=!1,R="";for(b=0;b<s;b++)if("rowheader"==l[b][v].CSS)N+=""==N?l[b][v].Value:(""!=l[b][v].Info&&""!=l[b-1][v].Info&&l[b][v].Info.split("::")[3]==l[b-1][v].Info.split("::")[0]?"#":"~~")+l[b][v].Value,-1==l[b][v].Info.indexOf("[Measures]")&&(R+=""==R?l[b][v].Info:(""!=l[b][v].Info&&""!=l[b-1][v].Info&&l[b][v].Info.split("::")[3]==l[b-1][v].Info.split("::")[0]?"#":"~~")+l[b][v].Info),e.inArray(l[b][v].Value,this._labelCurrentTags.collapsedMembers)<0&&2==l[b][v].State&&this._labelCurrentTags.collapsedMembers.push(l[b][v].Value),e.inArray(l[b][v].Info,S.seriesTags)<0&&-1==l[b][v].Info.indexOf("[Measures]")&&S.seriesTags.push(l[b][v].Info);else if((!this.model.enableMultiLevelLabels||""==N||l[b][v].CSS.indexOf("summary")>=0)&&(this.model.enableMultiLevelLabels||-1==l[b][v].CSS.indexOf("none")&&-1==l[b][v].CSS.indexOf("value"))){D=!0,M.push(v);break}D||(S.chartLables.push(N),S.labelTags.push(R))}else"rowheader"==l[0][v].CSS&&(S.chartLables.push(l[0][v].Value),S.labelTags.push(l[0][v].Info),S.seriesTags.push(l[0][v].Info)),2==l[0][v].State&&this._labelCurrentTags.collapsedMembers.push(l[0][v].Value);if(this.model.enableMultiLevelLabels)if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){for(u=0,b=0;b<S.multiLevelLabels.length;b++)S.multiLevelLabels[b]=e.map(S.multiLevelLabels[b].split("~~"),function(e){return e+"#1"}).join("~~"),u=S.multiLevelLabels[b].split("~~").length>u?S.multiLevelLabels[b].split("~~").length:u;for(m=0;m<S.multiLevelLabels.length;m++)if(u>1&&S.multiLevelLabels[m].split("~~").length<u){g=S.multiLevelLabels[m].split("~~")[S.multiLevelLabels[m].split("~~").length-1].split("#1")[0];do{S.multiLevelLabels[m]+="~~"+g+"#0"}while(S.multiLevelLabels[m].split("~~").length<u)}}else for(v=n;v<y;v++)if(s>1){N="",R="",D=!1;for(b=0;b<s;b++)if("rowheader"==l[b][v].CSS)N+=""==N?l[b][v].Value+"#"+l[b][v].Expander:"~~"+l[b][v].Value+"#"+l[b][v].Expander,R+=""==R?l[b][v].Info+"::"+l[b][v].State:"~~"+l[b][v].Info+"::"+l[b][v].State;else if(l[b][v].CSS.indexOf("none")>=0&&""!=N)N+="~~"+N.split("~~")[N.split("~~").length-1].split("#")[0]+"#"+l[b][v].Expander,R+="~~"+R.split("~~")[R.split("~~").length-1];else if(""==N||l[b][v].CSS.indexOf("summary")>=0||l[b][v].CSS.indexOf("value")>=0){D=l[b][v].CSS.indexOf("summary")>=0;break}D||""==N||(S.multiLevelLabels.push(N),S.multiLevelLabelTags.push(R))}else"rowheader"==l[0][v].CSS&&(S.multiLevelLabels.push(l[0][v].Value+"#"+l[0][v].Expander),S.multiLevelLabelTags.push(l[0][v].Info+"::"+l[0][v].State));for(v=n;v<y;v++)if(f=[],s>1){if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot){if(this.model.enableMultiLevelLabels){if(e.inArray(v,M)>-1){for(b=s;b<o;b++)e.inArray(b,x)<0&&f.push(l[b][v].Value);S.points_Y.push(f)}}else if("summary rstot"==l[0][v].CSS&&"Grand Total"!=l[0][v].Value){for(b=s;b<o;b++)e.inArray(b,x)<0&&f.push(l[b][v].Value);S.points_Y.push(f)}}else if(e.inArray(v,M)<0){for(b=s;b<o;b++)e.inArray(b,x)<0&&l[b][v].CSS.indexOf("value")>-1&&(f.push(""==l[b][v].Value?0:t.parseFloat(l[b][v].ActualValue)),t.isNullOrUndefined(l[b][v].Format)||(S.labelFormat=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?S.labelFormat.length>0?S.labelFormat==l[b][v].Format?l[b][v].Format:S.labelFormat+"_"+l[b][v].Format:l[b][v].Format:"Number"));S.points_Y.push(f)}}else if("rowheader"==l[0][v].CSS){for(b=l[0][0].ColSpan;b<o;b++)e.inArray(b,x)<0&&(f.push(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?""==l[b][v].Value?0:t.parseFloat(l[b][v].ActualValue):l[b][v].Value),t.isNullOrUndefined(l[b][v].Format)||(S.labelFormat=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?S.labelFormat.length>0?S.labelFormat==l[b][v].Format?l[b][v].Format:S.labelFormat+"_"+l[b][v].Format:l[b][v].Format:"Number"));S.points_Y.push(f)}}if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)S.measureNames=d;else for(_=this.model.enableMultiLevelLabels&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?e(T).map(function(e,t){return t.FieldHeader}):e(this.model.dataSource.values).map(function(e,t){return t.fieldCaption}),v=0;v<_.length;v++)S.measureNames+=""==S.measureNames?_[v]:"~"+_[v];if(this.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode)this.renderControlSuccess({JsonRecords:JSON.stringify(S),OlapReport:O});else{if(!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj._isExporting)return C=e.extend(!0,{},{pivotEngine:this._pivotEngine,labelCurrentTags:this._labelCurrentTags,drillParams:this._drillParams}),this._pivotEngine=C.pivotEngine,this._labelCurrentTags=C.labelCurrentTags,this._drillParams=C.drillParams,this._getChartSeries(S);this.renderControlSuccess({JsonRecords:JSON.stringify(S),OlapReport:JSON.stringify(this.model.dataSource)})}S={}}},_cloneEngine:function(t){for(var i=e.extend(!0,[],t),l=0;l<t.length;l++)i[l]=e.extend(!0,[],t[l]);return i},_cropData:function(e,i,l,a){var r,o,s,n=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?e[0][0].RowSpan:this.model.dataSource.columns.length+(0==this.model.dataSource.values.length||"rows"==this.model.dataSource.values[0].axis?0:1);if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap){r=l;do{for(o=!1,s=0;s<e[l].length;){if(e[l][s].Value==i){o=!0;break}s++}if(o)break;l=l==r?e[0][0].ColSpan:l,r="",l--}while(!o&&l>-1)}for(l=-1==l?0:l;n<e[l].length;)if(e[l][n].Value!=i)for(s=0;s<e.length;s++)e[s].splice(n,1);else n+=e[l][n].RowSpan;this.model.analysisMode!=t.PivotChart.AnalysisMode.Olap&&a&&e.splice(l,1)},refreshPagedPivotChart:function(e,i){if("undefined"!=typeof ochartWaitingPopup&&null!=ochartWaitingPopup&&ochartWaitingPopup.show(),e=-1!=e.indexOf("categ")?"categorical":"series",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.dataSource.providerName==t.olap.Providers.Mondrian)"categorical"==e?this._categCurrentPage=parseInt(i):this._seriesCurrentPage=parseInt(i),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else{var l;try{l=JSON.parse(this.getOlapReport())}catch(e){l=this.getOlapReport()}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:e+":"+i,currentReport:l,customObject:JSON.stringify(this.model.customObject)}),this.renderControlSuccess)}},_updatePageSettings:function(t,i){var l=e.map(t,function(e){if("PageSettings"==e.Key)return e}),a=e.map(t,function(e){if("HeaderCounts"==e.Key)return e});l.length>0&&null!=i._pagerObj&&(i._pagerObj.element.css("opacity","1"),i._pagerObj.element.find(".e-pagerTextBox").removeAttr("disabled"),i._pagerObj._unwireEvents(),i._pagerObj._wireEvents(),i._pagerObj.initPagerProperties(JSON.parse(a[0].Value),JSON.parse(l[0].Value)))},_setTitleText:function(i,l){var a,r,o,s,n,d,h;this._xTitle=t.isNullOrUndefined(this._xTitle)?t.isNullOrUndefined(this.model.primaryXAxis.title.text)||this.model.primaryXAxis.title.enable?this._xTitle:this.model.primaryXAxis.title.text:this._xTitle,this._yTitle=t.isNullOrUndefined(this._yTitle)?t.isNullOrUndefined(this.model.primaryYAxis.title.text)||this.model.primaryYAxis.title.enable?this._yTitle:this.model.primaryYAxis.title.text:this._yTitle;var c,p="",u="";if(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(a=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this.getOlapReport()).PivotRows:this.model.dataSource.rows,r=this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?JSON.parse(this.getOlapReport()).PivotColumns:this.model.dataSource.columns,this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(a=JSON.parse(this.getOlapReport()).PivotRows,r=JSON.parse(this.getOlapReport()).PivotColumns,c="FieldName"):(a=this.model.dataSource.rows,r=this.model.dataSource.columns,c="fieldCaption"),!t.isNullOrUndefined(a))for(d=0;d<a.length;d++)p+=(""==p?"":"~")+a[d][c];if(!t.isNullOrUndefined(r))for(h=0;h<r.length;h++)u+=(""==u?"":"~")+r[h][c];if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)for(o=0;o<this.model.dataSource.values[0].measures.length;o++)"rows"==this.model.dataSource.values[0].axis?p+=(""==p?"":"~")+this.model.dataSource.values[0].measures[o].fieldCaption:u+=(""==u?"":"~")+this.model.dataSource.values[0].measures[o].fieldCaption}else{for(s=i.split("><")[0].split("||"),n=i.split("><")[1].split("||"),d=0;d<s.length;d++)p+=(""==p?"":"~")+l.element.find(".e-cubeTreeView").find("li[data-tag='"+s[d]+"'] a:eq(0)").text();for(h=0;h<n.length;h++)u+=(""==u?"":"~")+l.element.find(".e-cubeTreeView").find("li[data-tag='"+n[h]+"'] a:eq(0)").text()}this.model.primaryXAxis.title=this.model.primaryXAxis.title.enable?e.extend({},{enable:!0,enableTrim:!0,text:p}):e.extend({},{enable:!1,enableTrim:!0,text:p}),this.model.primaryYAxis.title=this.model.primaryYAxis.title.enable?e.extend({},{enable:!0,enableTrim:!0,text:u}):e.extend({},{enable:!1,enableTrim:!0,text:u})},renderControlSuccess:function(l){var a,r,o,s,n,d,h,c,p,u,m,g,f;t.isNullOrUndefined(this._pivotClientObj)||this.model.operationalMode!=t.PivotChart.OperationalMode.ServerMode||t.Pivot._updateValueSortingIndex(l,this._pivotClientObj),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&(e("#"+this._pivotClientObj._id+"_maxView")[0]?e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!0}):oclientWaitingPopup.show());try{if(l[0]!=i){if(this.setJSONRecords(l[0].Value),this.setOlapReport(l[1].Value),t.isNullOrUndefined(l[2])||"AnalysisMode"==(a=l[2].Key)&&"Olap"==l[2].Value&&(this.model.analysisMode=t.PivotChart.AnalysisMode.Olap),!t.isNullOrUndefined(this._pivotClientObj)){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this._pivotClientObj.currentReport=JSON.parse(this.getOlapReport()).Report;else try{this._pivotClientObj.currentReport=JSON.parse(l[1].Value).Report}catch(e){this._pivotClientObj.currentReport=l[1].Value}null!=l[2]&&l[2]!=i&&("ClientReports"==(a=l[2].Key)&&(this._pivotClientObj.reports=l[2].Value)),l[3]&&("Title"==(a=l[3].Key)&&""!=l.d[3].Value&&this._setTitleText(l[3].Value,this._pivotClientObj)),this._updatePageSettings(l,this._pivotClientObj)}null!=l[2]&&l[2]!=i&&("ClientReports"==!(a=l[2].Key)&&"AnalysisMode"!=a&&(this.model.customObject=l[2].Value)),null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=i&&null!=this._pagerObj&&null!=l[2]&&l.d[2]!=i&&this._pagerObj.initPagerProperties(JSON.parse(l.d[3].Value),JSON.parse(l.d[2].Value))}else if(l.d!=i){if(this.setJSONRecords(l.d[0].Value),this.setOlapReport(l.d[1].Value),"AnalysisMode"==l.d[2].Key&&"Olap"==l.d[2].Value&&(this.model.analysisMode=t.PivotChart.AnalysisMode.Olap),!t.isNullOrUndefined(this._pivotClientObj)){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this._pivotClientObj.currentReport=JSON.parse(this.getOlapReport()).Report;else try{this._pivotClientObj.currentReport=JSON.parse(l.d[1].Value).Report}catch(e){this._pivotClientObj.currentReport=l.d[1].Value}null!=l.d[2]&&l.d[2]!=i&&("ClientReports"==(a=l.d[2].Key)&&(this._pivotClientObj.reports=l.d[2].Value)),l.d[3]&&("Title"==(a=l.d[3].Key)&&""!=l.d[3].Value&&this._setTitleText(l.d[3].Value,this._pivotClientObj)),this._updatePageSettings(l.d,this._pivotClientObj)}null!=l.d[2]&&l.d[2]!=i&&("ClientReports"==(a=l.d[2].Key)||(this.model.customObject=l.d[2].Value)),null!=this._pagerObj&&null!=e(".e-pivotpager")[0]&&e(".e-pivotpager")[0]!=i&&(null!=l.d[2]&&l.d[2]!=i&&("PageSettings"==(a=l.d[2].Key)&&this._pagerObj.initPagerProperties(JSON.parse(l.d[3].Value),JSON.parse(l.d[2].Value))),null!=l.d[3]&&l.d[3]!=i&&("PageSettings"==(a=l.d[3].Key)&&this._pagerObj.initPagerProperties(JSON.parse(l.d[4].Value),JSON.parse(l.d[3].Value))))}else if(this.setJSONRecords(l.JsonRecords),this.setOlapReport(l.OlapReport),"Olap"==l.AnalysisMode&&(this.model.analysisMode=t.PivotChart.AnalysisMode.Olap),null!=l.customObject&&null!=l.customObject&&(this.model.customObject=l.customObject),!t.isNullOrUndefined(this._pivotClientObj)){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)this._pivotClientObj.currentReport=JSON.parse(this.getOlapReport()).Report;else try{this._pivotClientObj.currentReport=JSON.parse(l.OlapReport).Report}catch(e){this._pivotClientObj.currentReport=l.OlapReport}void 0!==this._pivotClientObj.reports&&l.reports!=i&&"undefined"!=l.reports&&(this._pivotClientObj.reports=l.reports),l&&l.Title&&this._setTitleText(l.Title,this._pivotClientObj)}if(null!=this.model.afterServiceInvoke&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&(r=""!=this._drillAction?{action:this._drillAction,element:this.element,customObject:this.model.customObject}:{action:this._currentAction,element:this.element,customObject:this.model.customObject},this._trigger("afterServiceInvoke",r)),n=this.model.size.height,d=this.model.size.width,o=t.isNullOrUndefined(n)?this.element.height()>0?this.element.height():450:"string"==typeof n&&-1!=n.indexOf("%")?this.element.height()/100*parseInt(n):n,s=t.isNullOrUndefined(d)?this.element.width()>0?this.element.width():600:"string"==typeof d&&-1!=d.indexOf("%")?this.element.width()/100*parseInt(d):d,e(this.element).parents(".e-pivotclient").length>0||(this.model.size.height=o+"px",this.model.size.width=s+"px",this.model.isResponsive||this.element.width(s)),h=t.buildTag("div#"+this._id+"Container","",{height:t.isNullOrUndefined(this._pivotClientObj)?o:this._pivotClientObj._chartHeight,width:t.isNullOrUndefined(this._pivotClientObj)?s:this._pivotClientObj.model.enableSplitter?this._pivotClientObj.element.find(".controlPanelTD").width():this._pivotClientObj._toggleExpand?this._pivotClientObj.element.find(".controlPanelTD").width()-15:e("#"+this._pivotClientObj._id+"_maxView").length>0&&this._pivotClientObj._pivotChart?e("#"+this._pivotClientObj._pivotChart._id+"Container").width():this._pivotClientObj._chartWidth})[0].outerHTML,e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen?(c=this._pivotClientObj.model.enableSplitter?e("<div id="+this._id+"toolBar style='width:"+this._pivotClientObj._chartWidth+";height:"+this._pivotClientObj._chartHeight+";margin-top:35px;margin-left:5px'></div>"):e("<div id="+this._id+"toolBar style='width:"+this._pivotClientObj._chartWidth+";height:"+this._pivotClientObj._chartHeight+";overflow:auto;margin-top:35px;margin-left:5px'></div>"),e(c).html(h),this.element.html(c)):this.element.html(h),this.model.commonSeriesOptions.type==t.PivotChart.ChartTypes.Funnel||this.model.commonSeriesOptions.type==t.PivotChart.ChartTypes.Pyramid?(this.model.legend.toggleSeriesVisibility=!1,this.model.commonSeriesOptions.marker={dataLabel:{visible:!0,shape:"none",font:{color:this.element.css("color"),size:"12px",fontWeight:"lighter"}}}):this.model.legend.toggleSeriesVisibility=!0,this.model.operationalMode!=t.PivotChart.OperationalMode.ClientMode&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot||t.isNullOrUndefined(this._pivotClientObj)||this._setTitleText("Title",this._pivotClientObj),this.renderChartFromJSON(this.getJSONRecords()),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&(e("#"+this._id).prepend("<div class='e-chartToolBar' style='height:40px;width:"+this._pivotClientObj.element.find(".chartContainer").width()+"px'></div>"),p=t.buildTag("ul",t.buildTag("li.e-chart3DImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("TDCharts")).attr({title:this._getLocalizedLabels("TDCharts"),tabindex:0})[0].outerHTML+t.buildTag("li.e-exportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Exporting")).attr({title:this._getLocalizedLabels("Exporting"),tabindex:0})[0].outerHTML+(this.model.enable3D?"":t.buildTag("li.e-smartLabels e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SmartLabels")).attr({title:this._getLocalizedLabels("SmartLabels"),tabindex:0})[0].outerHTML)+(this.model.enable3D?"":t.buildTag("li.e-interaction e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Interactions")).attr({title:this._getLocalizedLabels("Interactions"),tabindex:0})[0].outerHTML))[0].outerHTML+t.buildTag("ul",t.buildTag("li#"+this._id+"_toolTipImg.e-toolTipImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Tooltip")).attr({title:this._getLocalizedLabels("Tooltip"),tabindex:0})[0].outerHTML+t.buildTag("li.e-legend e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Legend")).attr({title:this._getLocalizedLabels("Legend"),tabindex:0})[0].outerHTML+(this.model.enable3D?"":t.buildTag("li.e-zooming e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Zooming")).attr({title:this._getLocalizedLabels("Zooming"),tabindex:0})[0].outerHTML)+t.buildTag("li.e-icon-xAxis-title e-icon","",{}).attr("aria-label","X-Axis title").attr({title:"X-Axis title",tabindex:0})[0].outerHTML+t.buildTag("li.e-icon-yAxis-title e-icon","",{}).attr("aria-label","Y-Axis title").attr({title:"Y-Axis title",tabindex:0})[0].outerHTML)[0].outerHTML,e(".e-chartToolBar").append(e(p)),e(".e-chartToolBar").ejToolbar({enableRTL:this.model.enableRTL,enableSeparator:!0,height:"35px"}),this.model.enable3D&&this.element.find(".e-chart3DImg").addClass("e-enabled"),this.model.zooming.enable&&this.element.find(".e-zooming").addClass("e-enabled"),this.model.legend.visible&&this.element.find(".e-legend").addClass("e-enabled"),t.isNullOrUndefined(this.model.primaryXAxis.labelIntersectAction)||this.element.find(".e-smartLabels").addClass("e-enabled"),this.model.primaryXAxis.title.enable&&this.element.find(".e-icon-xAxis-title").addClass("e-enabled"),this.model.primaryYAxis.title.enable&&this.element.find(".e-icon-yAxis-title").addClass("e-enabled"),this.model.commonSeriesOptions.tooltip.visible&&this.element.find(".e-toolTipImg").addClass("e-enabled"),this.model.crosshair.visible&&this.element.find(".e-interaction").addClass("e-enabled"),"trackball"==this.model.crosshair.type&&this.element.find(".e-trackBall").addClass("e-enabled"),"crosshair"==this.model.crosshair.type&&this.element.find(".e-crossHair").addClass("e-enabled"),this.model.crosshair.visible||this.element.find(".none").addClass("e-enabled"),this._pivotClientObj._unWireEvents(),this._pivotClientObj._wireEvents()),this._unWireEvents(),this._wireEvents(),""!=this._drillAction){if(this.model.currentReport=this.getOlapReport(),this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&!this.model.enableMultiLevelLabels)if(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode){if(m=this.getJSONRecords(),this.model.dataSource.rows.length-this._labelCurrentTags.expandedMembers.length>1)for(this._labelCurrentTags.collapsedMembers=[],g=0;g<m.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(m.chartLables[g])}else if(m=this.getJSONRecords(),u=t.isNullOrUndefined(JSON.parse(this.getOlapReport()).rows)?JSON.parse(this.getOlapReport()).PivotRows:JSON.parse(JSON.parse(this.getOlapReport()).rows),this._labelCurrentTags.collapsedMembers=[],u.length-this._labelCurrentTags.expandedMembers.length>1)for(g=0;g<m.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(m.chartLables[g]);t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("chartDrillSuccess",this.element),this._trigger("drillSuccess",this.element)}else if(this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot)if(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode){if(m=this.getJSONRecords(),this._labelCurrentTags={collapsedMembers:[]},this.model.dataSource.rows.length>1)for(g=0;g<m.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(m.chartLables[g])}else if(m=this.getJSONRecords(),this.model.currentReport=JSON.parse(this.getOlapReport()),this._labelCurrentTags={collapsedMembers:[]},e(this.element).parents(".e-pivotclient").length>0?this.model.currentReport.PivotRows.length>1:JSON.parse(this.model.currentReport.rows).length>1)for(g=0;g<m.chartLables.length;g++)this._labelCurrentTags.collapsedMembers.push(m.chartLables[g]);f=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,t.isNullOrUndefined(f)||(f._isTimeOut=!1),t.isNullOrUndefined(this._pivotClientObj)||null==this._pivotClientObj._waitingPopup?this._waitingPopup.hide():(e("#"+this._pivotClientObj._id+"_maxView")[0]?(e("#"+this._pivotClientObj._id+"_maxView").ejWaitingPopup({showOnInit:!1}),this._pivotClientObj._waitingPopup.hide()):t.isNullOrUndefined(this._pivotClientObj._pivotGrid)||(this._pivotClientObj&&this._pivotClientObj._pivotGrid._drillAction&&!this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._drillAction&&!this._pivotClientObj._pivotChart._startDrilldown?this._pivotClientObj._waitingPopup.hide():!this._pivotClientObj||""!=this._pivotClientObj._pivotGrid._drillAction||""!=this._pivotClientObj._pivotChart._drillAction||this._pivotClientObj._pivotGrid._startDrilldown||this._pivotClientObj._pivotChart._startDrilldown||null==this._pivotClientObj._pivotGrid._JSONRecords&&null!=this._pivotClientObj._pivotChart._JSONRecords?!this._pivotClientObj._pivotChart._startDrilldown||this._pivotClientObj._pivotGrid._startDrilldown||e("#"+this._pivotClientObj._id+"_maxView")[0]?this._pivotClientObj._pivotChart._startDrilldown||this._pivotClientObj._pivotGrid._startDrilldown||""!=this._pivotClientObj._pivotChart._drillAction||""!=this._pivotClientObj._pivotGrid._drillAction||null==this._pivotClientObj._pivotGrid._JSONRecords&&null!=this._pivotClientObj._pivotChart._JSONRecords||this._pivotClientObj._waitingPopup.hide():this._pivotClientObj._waitingPopup.show():this._pivotClientObj._waitingPopup.hide()),"chartonly"==this._pivotClientObj.model.displaySettings.mode&&this._pivotClientObj._waitingPopup.hide()),t.isNullOrUndefined(this._pivotClientObj)||(this._pivotClientObj._pivotChart._startDrilldown=!1)}catch(e){}t.isNullOrUndefined(l.Exception)||t.Pivot._createErrorDialog(l,"Exception",this),this._trigger("renderSuccess",this)},_getChartSeries:function(l){var a,r,o,s=this,n=[];this.model.enableRTL&&(l.chartLables=e.map(l.chartLables,function(e){return e.split("~~").map(function(e){return e.split("#").reverse().join("#")}).reverse().join("~~")}),l.seriesNames=e.map(l.seriesNames,function(e){return e.split("~~").map(function(e){return e.split("#").reverse().join("#")}).reverse().join("~~")})),a=[];var d,h,c=[],p=(a=s.model.analysisMode==t.PivotChart.AnalysisMode.Olap?e.map(e.extend([],l.chartLables,!0),function(e){return e.split("#").join("~~")}):e.map(e.extend([],l.chartLables,!0),function(e){return!t.isNullOrUndefined(s._labelCurrentTags.expandedMembers)&&s._labelCurrentTags.expandedMembers.length>0?s._labelCurrentTags.expandedMembers.join("~~")+"~~"+e:e}),[]),u=0,m=0,g=this.model.series[0].trendlines[0];if(h=""!=l.measureInfo?parseInt(l.measureInfo):0,jQuery.each(a,function(e){var r,o,n,p=[];if(h>1&&"DrillChart"!=l.addInfo.action||h>1&&"1"==l.addInfo.levelHash){for(r=(e+1)*h-h,o=0;o<h;o++)if(l.points_Y[r+o]!=i&&a[e].split("~~")[0]==l.points_Y[r+o][0].Item1)for(n=0;n<l.points_Y[e].length;n++)(d={xValues:a[e],yValues:l.points_Y[r+o][n].Item2.indexOf(",")>-1?t.globalize.parseFloat(t.globalize.format(l.points_Y[r+o][n].Item2,"c",s.locale()),s.locale()):""==l.points_Y[r+o][n].Item2?0:t.globalize.parseFloat(l.points_Y[r+o][n].Item2),text:""==l.points_Y[r+o][n].Item2?0:l.points_Y[r+o][n].Item2}).yValues=t.isNullOrUndefined(d.yValues)?d.yValues:jQuery.isNumeric(d.yValues)?d.yValues:t.globalize.parseFloat(l.points_Y[r+o][n].Item2.toString().replace(/[^\d.,-]/g,"")),p.push(d)}else for(n=0;n<l.points_Y[e].length;n++)s.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&s.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(d="bubble"==s.seriesType()?{xValues:a[e],yValues:""==l.points_Y[e][n].Item2?0:l.points_Y[e][n].Item2,size:""==l.points_Y[e][n].Item2?0:l.points_Y[e][n].Item2}:{xValues:a[e],yValues:""==l.points_Y[e][n].Item2?0:t.globalize.parseFloat(l.points_Y[e][n].Item2),text:""==l.points_Y[e][n].Item2?"0":l.points_Y[e][n].Item2.toString()}).yValues=t.isNullOrUndefined(d.yValues)?d.yValues:jQuery.isNumeric(d.yValues)?d.yValues:t.globalize.parseFloat(l.points_Y[e][n].Item2.toString().replace(/[^\d.,-]/g,"")):(d="bubble"==s.seriesType()?{xValues:a[e].toString().split("#")[a[e].toString().split("#").length-1],yValues:""==l.points_Y[e][n]?0:l.points_Y[e][n],size:""==l.points_Y[e][n]?0:l.points_Y[e][n]}:{xValues:a[e].toString().split("#")[a[e].toString().split("#").length-1],yValues:""==l.points_Y[e][n]?0:l.points_Y[e][n],text:""==l.points_Y[e][n]?"0":l.points_Y[e][n].toString()}).yValues=t.isNullOrUndefined(d.yValues)?d.yValues:jQuery.isNumeric(d.yValues)?d.yValues:t.globalize.parseFloat(l.points_Y[e][n].toString().replace(/[^\d.,-]/g,"")),p.push(d);c.push(p)}),h>1&&"DrillChart"!=l.addInfo.action||h>1&&"1"==l.addInfo.levelHash)for(r=0;r<h*l.seriesNames.length;r++)p.push([]);else jQuery.each(l.seriesNames,function(){p.push([])});if(jQuery.each(a,function(e){for(var i=0;i<c[e].length;i++)t.isNullOrUndefined(p[i])&&(p[i]=[]),p[i].push(c[e][i])}),h>1&&"DrillChart"!=l.addInfo.action||h>1&&"1"==l.addInfo.levelHash)for(o=0;o<h*l.seriesNames.length;o++)n[m]={dataSource:p[o],xName:"xValues",yName:"yValues",name:l.seriesNames[u],trendlines:[g]},m++,++u==l.seriesNames.length&&(u=0);else"bubble"==this.seriesType()?jQuery.each(l.seriesNames,function(e){n[u]={dataSource:p[e],xName:"xValues",yName:"yValues",size:"size",name:l.seriesNames[u],trendlines:[g]},u++}):jQuery.each(l.seriesNames,function(e){n[u]={dataSource:p[e],xName:"xValues",yName:"yValues",name:l.seriesNames[u],marker:{dataLabel:{textMappingName:"text"}},trendlines:[g]},u++});return n},renderChartFromJSON:function(i){var l,a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y,x,M,P,w,L,N,D,R,j;if(!this.model.enableDefaultValue&&!t.isNullOrUndefined(i)&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&""==i.measureNames&&!t.isNullOrUndefined(i.points_Y)&&i.points_Y.length>0&&(i.points_Y=e.map(i.points_Y,function(i){return e.map(i,function(e){return t.isNullOrUndefined(e.Item2)?e=0:e.Item2="",e})})),this.setJSONRecords(JSON.stringify(i)),l=[],null==i||""==i)""==i&&(a=t.buildTag("div#"+this._id+"Container")[0].outerHTML,this.element.html(a)),l=[],this.model.primaryXAxis.multiLevelLabels=[];else if(null!=i&&i.chartLables.length>0&&i.points_Y.length>0){if(l=this._getChartSeries(i),r={series:e.extend(!0,[],l),axes:this.model.axes},this.model.axes.length<=l.length)for(y=0;y<this.model.axes.length;y++)if(this.model.axes[y].name.indexOf(":")>-1)for(o=this.model.axes[y].name.split(":").length>0?this.model.axes[y].name.split(":")[0]:"y",s=this.model.axes[y].name.split(":")[1].split(","),n=0;n<s.length;n++)t.isNullOrUndefined(o)||(-1==o.toLowerCase().indexOf("x")?l[parseInt(s[n])].yAxisName=this.model.axes[y].name:l[parseInt(s[n])].xAxisName=this.model.axes[y].name);if(this._trigger("beforeSeriesRender",r),t.isNullOrUndefined(this.model.beforeSeriesRender)||(l=r.series),this.model.enableMultiLevelLabels&&!t.isNullOrUndefined(i.multiLevelLabels)){for(this.model.primaryXAxis.majorTickLines={size:0},d=[],h=[],y=0;y<i.multiLevelLabels.length;y++)h.push(i.multiLevelLabels[y].split("~~"));for(y=i.multiLevelLabels[0].split("~~").length-1;y>=0;y--){for(c=[],x=0;x<i.multiLevelLabels.length;x++){if((p={}).name=i.multiLevelLabels[x].split("~~")[y].split("#")[0],this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode)p.rowSpan=parseInt(i.multiLevelLabels[x].split("~~")[y].split("#")[1]),p.colSpan=parseInt(i.multiLevelLabels[x].split("~~")[y].split("#")[2]),p.tag=i.multiLevelLabelTags[x].split("~~")[y];else{if(y==i.multiLevelLabels[0].split("~~").length-1)p.colSpan=1;else{for(u="",m=0,g=x;g<h.length;g++){for(f="",b=y;b>=0;b--)f+=""==f?h[g][b]:"$"+h[g][b];if(m+=""==u||u==f?1:0,u!=f&&""!=u)break;u=f}p.colSpan=m}if(0==parseInt(i.multiLevelLabels[x].split("~~")[y].split("#")[1])){for(C=0,_=y;_>=0&&(C++,!(parseInt(h[x][_].split("#")[1])>0));_--);p.rowSpan=C}else p.rowSpan=1;p.tag=t.isNullOrUndefined(i.multiLevelLabelTags[x])?"":i.multiLevelLabelTags[x].split("~~")[y]}c.push(p)}d.push(c)}if(v=[],this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode){for(x=0;x<d[0].length;x++)for(y=d.length-1;y>=0;y--)if(!t.isNullOrUndefined(d[y][x])&&d[y][x].rowSpan>1&&-1==v.indexOf(y+"-"+x)){C=d[y][x].rowSpan,S=1;do{delete d[y-S][x],S++}while(C>S);v.push(y+"-"+x)}}else for(x=0;x<d[0].length;x++)for(y=0;y<d.length;y++)if(!t.isNullOrUndefined(d[y][x])&&d[y][x].rowSpan>1&&-1==v.indexOf(y+"-"+x)){C=d[y][x].rowSpan,S=0;do{delete d[y+S][x],S++}while(C>S+1);d[y+S][x].rowSpan=C,v.push(y+S+"-"+x)}for(O=[],T=this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotRows)?JSON.parse(JSON.parse(this.getOlapReport()).rows).length:JSON.parse(this.getOlapReport()).PivotRows.length:this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode?this.model.dataSource.rows.length:0,y=0;y<d.length;y++)for(x=0;x<d[y].length;x++)t.isNullOrUndefined(d[y][x])||(M=x-.5,(P={}).visible=!0,P.text=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?d[y][x].tag.endsWith("2")?"+ "+d[y][x].name:d[y][x].tag.endsWith("1")?"- "+d[y][x].name:d[y][x].name:T==d.length&&0==y?d[y][x].name:0==y||d[y][x].rowSpan>1?"+ "+d[y][x].name:"- "+d[y][x].name,P.tag=this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?d[y][x].tag:T==d.length&&0==y?d[y][x].name+"#0":0==y||d[y][x].rowSpan>1?d[y][x].name+"#1":d[y][x].name+"#2",P.start=M,P.end=M+d[y][x].colSpan,P.level=y,P.span=d[y][x].rowSpan>1,O.push(P),x+=d[y][x].colSpan-1);this.model.primaryXAxis.multiLevelLabels=O,this.model.zooming.enableScrollbar=!0}else i.chartLables.length>10&&""==this.model.zooming?this.model.zooming={enable:!0,type:"x,y",enableMouseWheel:!0}:i.chartLables.length<10&&""==this._initZooming&&(this.model.zooming=this._initZooming);if(this.model.crosshair.visible?this.model.commonSeriesOptions.tooltip.format="#point.x# : #point.y#":this.model.enableRTL?this.model.commonSeriesOptions.tooltip={visible:!0,template:"toolTipTemplate"}:this.model.commonSeriesOptions.tooltip.format=this._getLocalizedLabels("Measure")+" : "+i.measureNames+" <br/>"+this._getLocalizedLabels("Column")+" : #series.name# <br/>"+this._getLocalizedLabels("Row")+" : #point.x# <br/>"+this._getLocalizedLabels("Value")+" : #point.y#",this.model.analysisMode==t.PivotChart.AnalysisMode.Olap?this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(w="",null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?i.labelFormat.indexOf("#")>-1&&i.measureNames.indexOf("~")<0&&!(i.labelFormat.indexOf("$")>-1)?"#,#"==i.labelFormat?w="Number":i.labelFormat.indexOf("#,#")>-1&&i.labelFormat.split("#")[i.labelFormat.split("#").length-1].indexOf(")")>-1?i.labelFormat.indexOf(";")>-1?w="n"+("0"==(L=i.labelFormat.split(";")[0]).split("#")[L.split("#").length-1]?0:L.split("#")[L.split("#").length-1].split(".")[1].split("0").length-1):w="":w=e.isNumeric(i.labelFormat.split("#")[i.labelFormat.split("#").length-1])?"n"+("0"==i.labelFormat.split("#")[i.labelFormat.split("#").length-1]?0:i.labelFormat.split("#")[i.labelFormat.split("#").length-1].split(".")[1].split("0").length-1):"{value}"+i.labelFormat.split("##")[i.labelFormat.split("##").length-1]:w=i.labelFormat.toLowerCase().indexOf("percent")>-1&&i.measureNames.indexOf("~")<0?"{value}%":(i.labelFormat.toLowerCase().indexOf("currency")>-1||i.labelFormat.indexOf("$")>-1)&&i.measureNames.indexOf("~")<0?"Currency":"":w=this.model.primaryYAxis.labelFormat,this.model.primaryYAxis.labelFormat=w):1==this.model.dataSource.values[0].measures.length&&(t.isNullOrUndefined(this.model.dataSource.values[0].measures[0].format)||(this.model.primaryYAxis.labelFormat=null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?"decimal"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"n2":"number"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"n":"percent"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"p2":"currency"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"c":"date"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"MM/dd/yyyy":"time"==this.model.dataSource.values[0].measures[0].format.toLowerCase()?"hh:mm:ss":"":this.model.primaryYAxis.labelFormat)):this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot&&(this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode?1==this.model.dataSource.values.length&&(t.isNullOrUndefined(this.model.dataSource.values[0].format)||(this.model.primaryYAxis.labelFormat=null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?"decimal"==this.model.dataSource.values[0].format.toLowerCase()?"n2":"number"==this.model.dataSource.values[0].format.toLowerCase()?"n":"percentage"==this.model.dataSource.values[0].format.toLowerCase()?"p2":"currency"==this.model.dataSource.values[0].format.toLowerCase()?"c":"date"==this.model.dataSource.values[0].format.toLowerCase()?t.isNullOrUndefined(this.model.dataSource.values[0].formatString)?"dd/MMMM/yyyy":this.model.dataSource.values[0].formatString:"time"==this.model.dataSource.values[0].format.toLowerCase()?"hh:mm:ss":"":this.model.primaryYAxis.labelFormat)):(N=t.isNullOrUndefined(JSON.parse(this.getOlapReport()).PivotCalculations)?JSON.parse(JSON.parse(this.getOlapReport()).values):JSON.parse(this.getOlapReport()).PivotCalculations,1==i.labelFormat.length&&1==N.length&&(this.model.primaryYAxis.labelFormat=null==this.model.primaryYAxis.labelFormat&&""==this.model.primaryYAxis.labelFormat||!this.model.primaryYAxis.labelFormat?"#.##"==i.labelFormat[0].toLowerCase()?"n2":"###"==i.labelFormat[0].toLowerCase()?"n":"p"==i.labelFormat[0].toLowerCase()?"p2":"c"==i.labelFormat[0].toLowerCase()?"c":"":this.model.primaryYAxis.labelFormat))),this.model.zooming.enableScrollbar){t.isNullOrUndefined(this.model.size.width)&&(this.model.size.width="800px"),t.isNullOrUndefined(this.model.size.height)&&(this.model.size.height="400px");var I=this.model.size.width.indexOf("%")>-1?this.element.width()*this.model.size.width.split("%")[0]/100:this.model.size.width.split("px")[0],F=this.model.size.height.indexOf("%")>-1?this.element.height()*this.model.size.height.split("%")[0]/100:this.model.size.height.split("px")[0],A="bar"==this.seriesType()||"stackingbar"==this.seriesType()?F/100*6:I/100*3;this.model.primaryXAxis.zoomFactor=A/(i.chartLables.length*i.seriesNames.length)}else this.model.primaryXAxis.zoomFactor=1;this.model.primaryXAxis.labelRotation=t.isNullOrUndefined(this.model.primaryXAxis.labelRotation)?270:this.model.primaryXAxis.labelRotation}else this.model.primaryXAxis.multiLevelLabels=[];var E=jQuery.extend(!0,{},this.model.primaryXAxis),k=jQuery.extend(!0,{},this.model.primaryYAxis);t.isNullOrUndefined(this._pivotClientObj)||(t.isNullOrUndefined(this._xTitle)?this.model.primaryXAxis.title.enable||(E.title.text=""):E.title.text=this._xTitle),t.isNullOrUndefined(this._pivotClientObj)||(t.isNullOrUndefined(this._yTitle)?this.model.primaryYAxis.title.enable||(k.title.text=""):k.title.text=this._yTitle),e("#"+this._id+"Container").ejChart({axes:this.model.axes,border:this.model.border,backGroundImageUrl:this.model.backGroundImageUrl,palette:this.model.palette,chartArea:this.model.chartArea,primaryXAxis:E,primaryYAxis:k,secondaryX:this.model.secondaryX,secondaryY:this.model.secondaryY,striplineDefault:this.model.striplineDefault,title:{text:this.titleText(),textAlignment:this.model.title.textAlignment,font:{color:this.model.title.color,fontFamily:this.model.title.fontFamily,fontWeight:this.model.title.fontWeight,opacity:this.model.title.opacity,size:this.model.title.size,fontStyle:this.model.title.fontStyle}},locale:this.locale(),lineCap:this.model.lineCap,lineJoin:this.model.lineJoin,legendAlignment:this.model.legendAlignment,legendPosition:this.model.legendPosition,legend:this.model.legend,animation:this.model.animation,crosshair:this.model.crosshair,commonSeriesOptions:{doughnutCoefficient:this.model.commonSeriesOptions.doughnutCoefficient,explodeOffset:this.model.commonSeriesOptions.explodeOffset,pyramidMode:this.model.commonSeriesOptions.pyramidMode,gapRatio:this.model.commonSeriesOptions.gapRatio,pieCoefficient:this.model.commonSeriesOptions.pieCoefficient,doughnutSize:this.model.commonSeriesOptions.doughnutSize,startAngle:this.model.commonSeriesOptions.startAngle,xAxisName:this.model.commonSeriesOptions.xAxisName,yAxisName:this.model.commonSeriesOptions.yAxisName,explodeAll:this.model.commonSeriesOptions.explodeAll,explodeIndex:this.model.commonSeriesOptions.explodeIndex,tooltipOptions:this.model.commonSeriesOptions.tooltipOptions,marker:this.model.commonSeriesOptions.marker||this.model.marker,font:this.model.commonSeriesOptions.font,type:this.seriesType(),enableAnimation:this.model.commonSeriesOptions.enableAnimation,style:this.model.commonSeriesOptions.style,explode:this.model.commonSeriesOptions.explode,labelPosition:this.model.commonSeriesOptions.labelPosition,tooltip:this.model.commonSeriesOptions.tooltip,zOrder:this.model.commonSeriesOptions.zOrder,drawType:this.model.commonSeriesOptions.drawType,isStacking:this.model.commonSeriesOptions.isStacking,enableSmartLabels:this.model.commonSeriesOptions.enableSmartLabels},seriesStyle:this.model.seriesStyle,pointStyle:this.model.pointStyle,textStyle:this.model.textStyle,initSeriesRender:this.model.initSeriesRender,theme:this.model.theme,canResize:this.model.isResponsive,rotation:this.model.rotation,enable3D:this.model.enable3D,zooming:this.model.zooming,margin:this.model.margin,elementSpacing:this.model.elementSpacing,seriesColors:this.model.seriesColors,seriesBorderColors:this.model.seriesBorderColors,pointColors:this.model.pointColors,pointBorderColors:this.model.pointBorderColors,series:l,size:this.model.size,load:this.model.enableMultiLevelLabels?this._onChartLoad:this.model.load,loaded:this.model.enableMultiLevelLabels?t.proxy(this._onChartLoaded,this):null,axesRangeCalculate:this.model.axesRangeCalculate,axesTitleRendering:this.model.axesTitleRendering,chartAreaBoundsCalculate:this.model.chartAreaBoundsCalculate,legendItemRendering:this.model.legendItemRendering,lengendBoundsCalculate:this.model.lengendBoundsCalculate,preRender:this.model.preRender,seriesRendering:this.model.seriesRendering,symbolRendering:this.model.symbolRendering,titleRendering:this.model.titleRendering,axesLabelsInitialize:this.model.axesLabelsInitialize,pointRegionMouseMove:this.model.pointRegionMouseMove,legendItemClick:this.model.legendItemClick,legendItemMouseMove:this.model.legendItemMouseMove,displayTextRendering:this.model.displayTextRendering,toolTipInitialize:this.model.toolTipInitialize,trackAxisToolTip:this.model.trackAxisToolTip,trackToolTip:this.model.trackToolTip,animationComplete:this.model.animationComplete,destroy:this.model.destroy,create:this.model.create,axesLabelRendering:t.proxy(this._labelRenders,this),multiLevelLabelClick:t.isNullOrUndefined(this._pivotClientObj)?t.proxy(this._multiLevelLabelClick,this):this._pivotClientObj.model.enableDeferUpdate?null:t.proxy(this._multiLevelLabelClick,this),pointRegionClick:t.isNullOrUndefined(this._pivotClientObj)?t.proxy(this._seriesClick,this):this._pivotClientObj.model.enableDeferUpdate?null:t.proxy(this._seriesClick,this)}),this.model.enableRTL&&null!=i&&(D=t.buildTag("div#toolTipTemplate.e-toolTip",t.buildTag("div.toolTipInfo",t.buildTag("div",i.measureNames+" : "+this._getLocalizedLabels("Measure")+" <br/>")[0].outerHTML+t.buildTag("div","#series.name#: "+this._getLocalizedLabels("Row")+" <br/>")[0].outerHTML+t.buildTag("div","#point.x# : "+this._getLocalizedLabels("Column")+" <br/>")[0].outerHTML+t.buildTag("div","#point.y# : "+this._getLocalizedLabels("Value"))[0].outerHTML).addClass("e-rtl")[0].outerHTML,{display:"none",width:"auto","min-width":"200px","font-size":"12px",padding:"2px 5px","background-color":"rgb(255, 255, 255)",border:"1px solid rgb(0, 0, 0)"})[0].outerHTML,e("#"+this._id).append(D)),e("#"+this._id+"progressContainer").hide(),this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode&&null!=i&&""!=i&&(this._labelCurrentTags.splice(0,this._labelCurrentTags.length),R=this,jQuery.each(i.labelTags,function(e,t){var i,l=t.split("::");i={name:l[2],state:l[l.length-1],tag:t},R._labelCurrentTags.push(i)}),t.isNullOrUndefined(R._selectedTagInfo)||jQuery.each(this._labelCurrentTags,function(e,t){if(t.tag.split("::")[0]==R._selectedTagInfo.split("::")[0]&&"drillup"==R._drillAction)return R._selectedTagInfo=R._labelCurrentTags[e].tag,!1})),j=e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejPivotClient"):null,t.isNullOrUndefined(j)||(j._isTimeOut=!1),null!=this._waitingPopup&&this._waitingPopup.hide(),e(this.element).parents(".e-pivotclient").length>0&&this._pivotClientObj.model.enableToolBar&&!this._pivotClientObj.model.displaySettings.enableFullScreen&&this.model.commonSeriesOptions.tooltip.visible&&this.element.find(".e-toolTipImg").addClass("e-enabled"),t.isNullOrUndefined(this._pivotClientObj)||t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj.model.isResponsive||e("#"+this._id+"Container").width("100%")},_onChartLoad:function(e){for(var i,l=t.isNullOrUndefined(e.model.primaryXAxis.multiLevelLabels)?[]:e.model.primaryXAxis.multiLevelLabels,a=0;a<l.length;a++)if(l[a].span)for(l[a].border={type:"withouttopborder"},i=0;i<l[a].level;i++)l.push({start:l[a].start,end:l[a].end,visible:!0,text:" ",tag:l[a].tag,level:i,border:{type:"withouttopandbottomborder"}});return this.model.load},_onChartLoaded:function(){this.element.find("#"+this._id+"Container_svg_XAxisMultiLevelLabels_0").attr("cursor","pointer")},_setDrillParams:function(t,i){for(var l,a=this.getJSONRecords().chartLables[i.start+.5].split("~~"),r="",o=0;o<a.length&&(r+=""==r?a[o]:">#>"+a[o],t!=a[o]);o++);return l=r,"drilldown"==this._drillAction?this._drillParams.push(r):this._drillParams=e.map(this._drillParams,function(e){if(-1==e.indexOf(r))return e}),e(this.element).parents(".e-pivotclient").length>0&&(e(this.element).parents(".e-pivotclient").data("ejPivotClient")._drillParams=this._drillParams),l},_getChartDrillDown:function(i,l,a){var r,o,s,n,d,h,c,p,u,m,g,f,b,_=this.model.dataSource.providerName==t.olap.Providers.Mondrian;if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap){for("drillup"==this._drillAction&&((r=e.map(this.model.dataSource.rows,function(e,t){if(e.fieldName==l.hierarchyUniqueName)return{index:t,item:e}})).length>0&&!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[r[0].index])&&(o=0,e.each(this._labelCurrentTags.expandedMembers[r[0].index],function(e,t){i==t&&o++}),0==o&&this._labelCurrentTags.expandedMembers[r[0].index].push(i.split("&").join("&amp;")))),S=[],b=0;b<this.model.dataSource.rows.length;b++){if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers))for(d=0;d<this._labelCurrentTags.expandedMembers.length;d++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[d]))for(s=0;s<this._labelCurrentTags.expandedMembers[d].length;s++)this._labelCurrentTags.expandedMembers[d][s].indexOf(this.model.dataSource.rows[b].fieldName)>=0&&S.indexOf(this._labelCurrentTags.expandedMembers[d][s].replace("&amp;","&"))<0&&S.indexOf(this._labelCurrentTags.expandedMembers[d][s])<0&&S.push(this._labelCurrentTags.expandedMembers[d][s]);for(d=0;d<this._selectedSeriesInfo.length;d++)this._selectedSeriesInfo[d].indexOf(this.model.dataSource.rows[b].fieldName)>=0&&S.indexOf(this._selectedSeriesInfo[d])<0&&S.indexOf(this._selectedSeriesInfo[d].replace(/&/g,"&amp;"))<0&&S.push(this._selectedSeriesInfo[d].replace(/&/g,"&amp;"))}for(b=0;b<this._selectedSeriesInfo.length;b++)this._selectedSeriesInfo[b]=this._selectedSeriesInfo[b].replace(/&/g,"&amp;");if(n=S,"drillup"==this._drillAction){for(b=0;b<this._labelCurrentTags.expandedMembers.length;b++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[b]))for(d=0;d<this._labelCurrentTags.expandedMembers[b].length;d++)this.model.enableMultiLevelLabels&&""!=i?this._labelCurrentTags.expandedMembers[b][d]==i&&(S=[],jQuery.map(this._labelCurrentTags.expandedMembers[b],function(e){e==i&&(u=!0),u||S.push(e)}),this._labelCurrentTags.expandedMembers[b]=S):this._labelCurrentTags.expandedMembers[b][d].split("::")[2]==l&&(i=this._labelCurrentTags.expandedMembers[b][d],S=[],jQuery.map(this._labelCurrentTags.expandedMembers[b],function(e){e.split("::")[2]==l&&(u=!0),u||S.push(e)}),this._labelCurrentTags.expandedMembers[b]=S);l=t.olap._mdxParser._splitCellInfo(i)}else i=-1==i.indexOf("&amp")?i.replace(/&/g,"&amp;"):i;for(h=-1,b=0;b<this.model.dataSource.rows.length;b++)if(this.model.dataSource.rows[b].fieldName==l.hierarchyUniqueName){h=b;break}for(_&&"drillup"==this._drillAction&&!t.isNullOrUndefined(this._selectedSeriesInfo[h])&&(this._selectedSeriesInfo[h]=i),C=e.inArray(i,this._selectedSeriesInfo),S=[],b=0;b<=C;b++)S.push(this._selectedSeriesInfo[b]);var v=S,C=e.inArray(i,n),S=[];for(b=0;b<=C;b++)S.push(n[b]);if(n=S,c=e(this.element).parents(".e-pivotclient").length>0?this.element.parents(".e-pivotclient").data("ejPivotClient"):t.isNullOrUndefined(this._pivotClientObj)?this:this._pivotClientObj,"drilldown"==this._drillAction)t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&(this._labelCurrentTags.expandedMembers=[]),t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[h])&&(this._labelCurrentTags.expandedMembers[h]=[]),this._labelCurrentTags.expandedMembers[h].push(i),this.element.parents(".e-pivotclient").length>0&&(c=this.element.parents(".e-pivotclient").data("ejPivotClient"))._drillParams.push(e.map(n,function(e){return e.split("&amp;").join("&")}).join(">#>"));else if(this.element.parents(".e-pivotclient").length>0){c=this.element.parents(".e-pivotclient").data("ejPivotClient");var O=[],T="",y=[];for(e.each(n,function(e,t){(""==T||T.split("::")[0]!=t.split("::")[3])&&O.push(t),T=t}),e.each(O,function(e,t){e<h&&t.length>0&&y.push(t.split("&amp;").join("&"))}),c._drillParams=e.grep(c._drillParams,function(t){return h<1?-1==t.indexOf(i.split("&amp;").join("&")):!(t.indexOf(i.split("&amp;").join("&"))>-1&&e.map(t.split(">#>"),function(e){if(y.indexOf(e)>-1)return e}).length==y.length)}),u=!1,b=0;b<this._labelCurrentTags.expandedMembers.length;b++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[b])&&this._labelCurrentTags.expandedMembers[b].length>0){u=!0;break}if(c._drillParams.length>0&&this._drilledCellSet.length>0&&!u&&!t.isNullOrUndefined(c._drillParams[c._drillParams.length-1])){C=0;var x="",M="",P=!1;for(b=0;b<c._drillParams[c._drillParams.length-1].split(">#>").length;b++)-1==(M=c._drillParams[c._drillParams.length-1].split(">#>")[b]).indexOf("undefined")&&(C=""==x?0:M.split("::")[0].split(".")[0]+"."+M.split("::")[0].split(".")[1]==x.split("::")[0].split(".")[0]+"."+x.split("::")[0].split(".")[1]?C:C+1,e.each(this._drilledCellSet,function(t,i){(e.map(i[0].key.split("][").join("]>#>[").split(">#>"),function(e){if(y.indexOf(e)>-1)return e}).length!=y.length||0==y.length)&&e.each(i[0].key.split("][").join("]>#>[").split(">#>"),function(e,t){M.split("::")[0]+" !#rowheader"==t&&(P=!0)})}),P&&(M=M.split("&").join("&amp;"),t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[C])?this._labelCurrentTags.expandedMembers[C]=M:this._labelCurrentTags.expandedMembers[C].push(M),P=!1),x=M)}}"drilldown"==this._drillAction?t.olap._mdxParser.updateDrilledReport({uniqueName:i,seriesInfo:v,uniqueNameArray:n},"rowheader",c):t.olap._mdxParser.updateDrilledReport({uniqueName:i,seriesInfo:v,uniqueNameArray:n,action:"collapse"},"rowheader",c)}else{if(p="",""==this._drillAction&&this.model.enableMultiLevelLabels)return this._waitingPopup.hide(),!1;if("drilldown"==this._drillAction){if(this.model.enableMultiLevelLabels)p=this._setDrillParams(l,i),this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(this._selectedItem=l,this._generateData({JsonRecords:this._pivotEngine,PivotReport:this.getOlapReport()})):this._generateData(this._pivotEngine);else{for(t.isNullOrUndefined(this._labelCurrentTags.expandedMembers)&&(this._labelCurrentTags.expandedMembers=[]),this._labelCurrentTags.expandedMembers.push(l),f=this._cloneEngine(this._pivotEngine),b=0;b<this._labelCurrentTags.expandedMembers.length;b++)this._cropData(f,this._labelCurrentTags.expandedMembers[b],0,!0);this._generateData(f)}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("chartDrillSuccess",{chartObj:this,drillAction:"drilldown",drilledMember:this.model.enableMultiLevelLabels?p:this._labelCurrentTags.expandedMembers.join(">#>"),event:a}),this._trigger("drillSuccess",{chartObj:this,drillAction:"drilldown",drilledMember:this.model.enableMultiLevelLabels?p:this._labelCurrentTags.expandedMembers.join(">#>"),event:a})}else{if(this.model.enableMultiLevelLabels)p=this._setDrillParams(l,i),this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode?(this._selectedItem=l,this._generateData({JsonRecords:this._pivotEngine,PivotReport:this.getOlapReport()})):this._generateData(this._pivotEngine);else{for(u=!1,S=[],jQuery.map(this._labelCurrentTags.expandedMembers,function(e){e==l&&(u=!0),u||S.push(e)}),this._labelCurrentTags.expandedMembers=S,p=0==this._labelCurrentTags.expandedMembers.length?l:this._labelCurrentTags.expandedMembers.join(">#>")+">#>"+l,m=this.model.operationalMode==t.PivotChart.OperationalMode.ClientMode,(0==this._labelCurrentTags.expandedMembers.length||m)&&e(this.element).parents(".e-pivotclient").length>0&&((g=e(this.element).parents(".e-pivotclient").data("ejPivotClient"))._drillParams.length>0&&(g._drillParams=e.grep(g._drillParams,function(e){return e.indexOf(m?p:l)<0}),g._getDrilledMember())),f=this._cloneEngine(this._pivotEngine),b=0;b<this._labelCurrentTags.expandedMembers.length;b++)this._cropData(f,this._labelCurrentTags.expandedMembers[b],0,!0);this._generateData(f)}t.isNullOrUndefined(this._pivotClientObj)||this._pivotClientObj._trigger("chartDrillSuccess",{chartObj:this,drillAction:"drillup",drilledMember:p,event:a}),this._trigger("drillSuccess",{chartObj:this,drillAction:"drillup",drilledMember:p,event:a})}}},_multiLevelLabelClick:function(l){var a,r,o,s,n,d;if(e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejWaitingPopup").show():t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.show(),this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)if(this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode){if(a=parseInt(l.data.multiLevelLabel.tag.split("::")[l.data.multiLevelLabel.tag.split("::").length-1]),l.data.multiLevelLabel.tag.startsWith("[Measures]")||0==a)return e(this.element).parents(".e-pivotclient").length>0?e(this.element).parents(".e-pivotclient").data("ejWaitingPopup").hide():t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide(),!1;this._selectedTagInfo=l.data.multiLevelLabel.tag,this._drillAction=2==a?"drilldown":"drillup",this._startDrilldown=!0,r=JSON.stringify(this.model.customObject),o=this.getOlapReport(),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:this._drillAction,element:this.element,customObject:this.model.customObject}),""!=this.model.customObject&&null!=this.model.customObject&&this.model.customObject!=i?t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:o,customObject:r}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:o,clientReports:this._pivotClientObj.reports,customObject:r}),this.renderControlSuccess):t.isNullOrUndefined(this._pivotClientObj)?this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:o,clientReports:this._pivotClientObj.reports}),this.renderControlSuccess):this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._drillAction+"#fullchart",drilledSeries:this._selectedTagInfo,olapReport:o}),this.renderControlSuccess)}else{if(l.data.multiLevelLabel.tag.endsWith("0"))return t.isNullOrUndefined(this._waitingPopup)||this._waitingPopup.hide(),!1;var h=l.data.multiLevelLabel.tag.split("::").splice(0,l.data.multiLevelLabel.tag.split("::").length-1).join("::"),c=t.olap._mdxParser._splitCellInfo(h),p=this.getJSONRecords().labelTags[l.data.multiLevelLabel.start+.5].split("~~");for(this._selectedSeriesInfo=[],s=0;s<p.length;s++)this._selectedSeriesInfo.push(p[s].split("#")[p[s].split("#").length-1]);if(this._labelCurrentTags.collapsedMembers=e.grep(this._labelCurrentTags.collapsedMembers,function(e){return e!=l.data.multiLevelLabel.text.slice(2,l.data.multiLevelLabel.text.length)}),this._drillAction="2"==l.data.multiLevelLabel.tag.split("::")[l.data.multiLevelLabel.tag.split("::").length-1]?"drilldown":"1"==l.data.multiLevelLabel.tag.split("::")[l.data.multiLevelLabel.tag.split("::").length-1]?"drillup":"",!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers))for(n=0;n<this._labelCurrentTags.expandedMembers.length;n++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[n]))for(d=0;d<this._labelCurrentTags.expandedMembers[n].length;d++)if(this._labelCurrentTags.expandedMembers[n][d].indexOf(h.replace(/&/g,"&amp;"))>=0||this._labelCurrentTags.expandedMembers[n][d].indexOf(h)>=0){h=h.replace(/&/g,"&amp;");break}this._getChartDrillDown(h,c,l)}else c=l.data.multiLevelLabel.tag.split("#")[0],this._drillAction=l.data.multiLevelLabel.tag.endsWith("1")?"drilldown":l.data.multiLevelLabel.tag.endsWith("2")?"drillup":"",this._getChartDrillDown(l.data.multiLevelLabel,c,l)},_labelRenders:function(l){if(!t.isNullOrUndefined(this.model)&&this.model.enableMultiLevelLabels&&("bar"==this.seriesType()||"stackingbar"==this.seriesType()?"vertical"==l.data.axis.orientation.toLowerCase():"horizontal"==l.data.axis.orientation.toLowerCase()))l.data.label.Text="";else if((t.isNullOrUndefined(this._pivotClientObj)||!this._pivotClientObj._isExporting)&&(t.isNullOrUndefined(this._pivotClientObj)?this._trigger("axesLabelRendering",l):this._pivotClientObj._trigger("axesLabelRendering",l),("horizontal"==l.data.axis.orientation.toLowerCase()&&l.data.label.Text!=i||("bar"==this.seriesType()||"stackingbar"==this.seriesType())&&"vertical"==l.data.axis.orientation.toLowerCase()&&l.data.label.Text!=i)&&this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)){var a=this.model.enableRTL?l.data.label.Text.toString().split("~~").reverse():l.data.label.Text.toString().split("~~");t.isNullOrUndefined(this.getJSONRecords())||e.each(e.extend([],this.getJSONRecords().chartLables,!0),function(e,t){if(t.toString().split("#").join("~~")==a.join("~~"))return l.data.label.Text=t.toString().split("~~").map(function(e){return e.split("#")[e.split("#").length-1]}).join("~~"),!1})}},_reSizeHandler:function(){if(!t.isNullOrUndefined(this.element)){var e=this.element.find("#"+this._id+"Container").height(this.element.height()).width(this.element.width()).data("ejChart");t.isNullOrUndefined(e)||e.redraw()}},_getLocalizedLabels:function(e){return t.isNullOrUndefined(t.PivotChart.Locale[this.locale()])||t.PivotChart.Locale[this.locale()][e]==i?t.PivotChart.Locale["en-US"][e]:t.PivotChart.Locale[this.locale()][e]},_onPreventPanelClose:function(i){e("body").find("#preventDiv").remove(),!e(".e-pivotgrid").data("ejWaitingPopup")||!t.isNullOrUndefined(i)&&(e(i.target).hasClass("pivotTree")||e(i.target).hasClass("pivotTreeContext")||e(i.target).hasClass("pivotTreeContextMenu"))||e(".e-pivotgrid").data("ejWaitingPopup").hide()},_seriesClick:function(l){var a,r,o,s,n,d,h,c,p,u,m;if(!this.model.enableMultiLevelLabels){this.element.find("#"+this._id+"ExpandMenu, .e-expandMenu, .e-dialog").remove();var g,f=[],b=this.element.position(),_=this,v=this;if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&this.model.operationalMode==t.PivotChart.OperationalMode.ServerMode)this._selectedTags=[],null!=l.data.region&&l.data.region!=i?(o=this.model.enableRTL?e.map(l.model.primaryXAxis.labels,function(e){return e.split("~~").reverse().join("~~")}):l.model.primaryXAxis.labels,g=o[l.data.region.Region.PointIndex],r=l.data.region.Region.PointIndex):null!=l.data.point.x&&l.data.point.x!=i&&""!=l.data.point.x&&(o=this.model.enableRTL?e.map(l.data.series.xAxis.labels,function(e){return e.split("~~").reverse().join("~~")}):l.data.series.xAxis.labels,g=o[l.data.point.X],r=l.data.point.X),this.model.enableMultiLevelLabels?a=l.model.primaryXAxis.labels[r].split("~~")[l.model.primaryXAxis.labels[r].split("~~").length-1]:e(e("#"+this._id+"Container_vml_XAxisLabels_0")[0]).children()[r]!=i?a=e(e("#"+this._id+"Container_vml_XAxisLabels_0")[0]).children()[r].innerHTML:e("#"+this._id+"Container_svg_XAxisLabels_0").children()[r]?a=e("#"+this._id+"Container_svg_XAxisLabels_0").children()[r].textContent:"bar"==this.seriesType()||"stackingbar"==this.seriesType()?e(e("#"+this._id+"Container_vml_YAxisLabels_0")[0]).children()[r]!=i?a=e(e("#"+this._id+"Container_vml_YAxisLabels_0")[0]).children()[r].innerHTML:e("#"+this._id+"Container_svg_YAxisLabels_0").children()[r]?a=e("#"+this._id+"Container_svg_YAxisLabels_0").children()[r].textContent:a=(s=l.model.primaryXAxis.labels[r].split("~~"))[s.length-1]:a=(s=l.model.primaryXAxis.labels[r].split("~~"))[s.length-1],a&&(e("#"+this._id).find("#"+this._id+"ExpandMenu, .e-expandMenu, .e-dialog").remove(),n=g.split("~~"),jQuery.each(n,function(t,i){jQuery.each(v._labelCurrentTags,function(t,l){if(e.trim(i)==l.name)return v._selectedTags.push(l),!1})}),jQuery.each(this._selectedTags,function(i,l){l.state>1&&(_.model.enableRTL?f.push(e(t.buildTag("li.e-menuList exp",l.name+" - "+v._getLocalizedLabels("Expand"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList exp",v._getLocalizedLabels("Expand")+" - "+l.name)[0]).attr("role","presentation")[0].outerHTML))}),jQuery.each(this._selectedTags,function(i,l){for(var a=0;a<g.split("~~").length-1;a++)g.split("~~")[a]==l.name&&1==l.state&&(_.model.enableRTL?f.push(e(t.buildTag("li.e-menuList clp",l.name+" - "+v._getLocalizedLabels("Collapse"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList clp",v._getLocalizedLabels("Collapse")+" - "+g.split("~~")[a])[0]).attr("role","presentation")[0].outerHTML))}));else{if(g=null!=l.data.region&&l.data.region!=i?this.getJSONRecords().chartLables[l.data.region.Region.PointIndex]:l.data.series.xAxis.labels[l.data.point.X],this.model.analysisMode==t.PivotChart.AnalysisMode.Olap&&(g=g.split("~~").map(function(e){return e.split("#")[e.split("#").length-1]}).join("~~")),!t.isNullOrUndefined(this._labelCurrentTags.collapsedMembers))if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap)for(d=g.split("~~"),this.model.dataSource.values[0].axis==t.olap.AxisName.Row&&(h=e.map(this.model.dataSource.values[0].measures,function(e){return e.fieldName}),e.inArray(d[d.length-1],h)>=0&&d.splice(d.length-1,1)),this._selectedSeriesInfo=[],u=0;u<d.length;u++)c=d[u].split("#")[d[u].split("#").length-1],e(this.getJSONRecords().seriesTags).filter(function(e,t){return t.split("::")[2]==c}).length>0&&this._selectedSeriesInfo.push(e(this.getJSONRecords().seriesTags).filter(function(e,t){return t.split("::")[2]==c})[0]),e.inArray(c,this._labelCurrentTags.collapsedMembers)>=0&&(_.model.enableRTL?f.push(e(t.buildTag("li.e-menuList exp",c+" - "+this._getLocalizedLabels("Expand"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList exp",this._getLocalizedLabels("Expand")+" - "+c)[0]).attr("role","presentation")[0].outerHTML));else e.inArray(g,this._labelCurrentTags.collapsedMembers)>=0&&(_.model.enableRTL?f.push(e(t.buildTag("li.e-menuList exp",g+" - "+this._getLocalizedLabels("Expand"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList exp",this._getLocalizedLabels("Expand")+" - "+g)[0]).attr("role","presentation")[0].outerHTML));if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers))if(this.model.analysisMode==t.PivotChart.AnalysisMode.Olap){for(p=0;p<this._labelCurrentTags.expandedMembers.length;p++)if(!t.isNullOrUndefined(this._labelCurrentTags.expandedMembers[p]))for(u=0;u<this._labelCurrentTags.expandedMembers[p].length;u++)_.model.enableRTL?f.push(e(t.buildTag("li.e-menuList clp",this._labelCurrentTags.expandedMembers[p][u].split("::")[2]+" - "+this._getLocalizedLabels("Collapse"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList clp",this._getLocalizedLabels("Collapse")+" - "+this._labelCurrentTags.expandedMembers[p][u].split("::")[2])[0]).attr("role","presentation")[0].outerHTML)}else for(u=0;u<this._labelCurrentTags.expandedMembers.length;u++)_.model.enableRTL?f.push(e(t.buildTag("li.e-menuList clp",this._labelCurrentTags.expandedMembers[u]+" - "+this._getLocalizedLabels("Collapse"))[0]).attr("role","presentation")[0].outerHTML):f.push(e(t.buildTag("li.e-menuList clp",this._getLocalizedLabels("Collapse")+" - "+this._labelCurrentTags.expandedMembers[u])[0]).attr("role","presentation")[0].outerHTML)}f.length>0&&(f.push(e(t.buildTag("li.e-menuList exit",this._getLocalizedLabels("Exit"))[0]).attr("role","presentation")[0].outerHTML),m=e(t.buildTag("div#"+this._id+"ExpandMenu.e-expandMenu",f)[0]).attr("role","presentation")[0].outerHTML,e(m).ejDialog({width:"auto",target:"#"+this._id,enableResize:!1,enableRTL:this.model.enableRTL}),e("#"+this._id+"ExpandMenu_wrapper").appendTo(this.element).css({left:l.data.location.x+8+b.left,top:l.data.location.y+8+b.top,"min-height":navigator.userAgent.toLowerCase().indexOf("webkit")>0?"initial":"auto"}),e("#"+this._id+"ExpandMenu").css({"min-height":navigator.userAgent.toLowerCase().indexOf("webkit")>0?"initial":"auto"})),this.element.find(".e-titlebar, .e-header").remove()}t.isNullOrUndefined(this._pivotClientObj)?this._trigger("pointRegionClick",l):this._pivotClientObj._trigger("pointRegionClick",l)},_getExportModel:function(){var i,l,a;if("msie"!=t.browserInfo().name||!(t.browserInfo().version<=8)){l=(i=e("#"+this._id+"Container").data("ejChart")).model.primaryXAxis.zoomFactor,i.model.primaryXAxis.zoomFactor=1,i.model.enableCanvasRendering=!0,i.redraw(),a=i.export().toDataURL("image/png"),i.model.primaryXAxis.zoomFactor=l,i.model.enableCanvasRendering=!1,i.redraw();var r=""!=e(this.element).css("background-color")?e(this.element).css("background-color"):"rgb(255, 255, 255)";return{args:JSON.stringify({fileName:"Export",chartdata:a.split(",")[1],bgColor:r,exportFormat:"xls",title:"",description:"PivotChart"})}}},exportPivotChart:function(i,l,a){var r,o,s,n,d,h,c,p={},u=null;if(r=t.isNullOrUndefined(a)||"excel"!=a.toLowerCase()?{url:"",fileName:"PivotChart",exportMode:t.PivotChart.ExportMode.ClientMode,title:"",description:"",exportType:i,controlName:this}:{url:"",fileName:"PivotChart",exportMode:t.PivotChart.ExportMode.ClientMode,title:"",description:"",exportType:i,controlName:this,exportChartAsImage:!0},this._trigger("beforeExport",r),"msie"!=t.browserInfo().name||!(t.browserInfo().version<=8)){(t.isNullOrUndefined(l)||""==l)&&(l="Sample");var m=e("#"+this._id+"Container").data("ejChart"),g={height:m.model.size.height,width:m.model.size.width},f=m.model.primaryXAxis.zoomFactor;m.model.primaryXAxis.zoomFactor=1,m.model.enableCanvasRendering=!0,m.model.size=u={height:t.isNullOrUndefined(r.height)?m.model.size.height:r.height,width:t.isNullOrUndefined(r.width)?m.model.size.width:r.width},m.redraw(),o=m.export().toDataURL("image/png"),m.model.primaryXAxis.zoomFactor=f,m.model.enableCanvasRendering=!1,m.model.size={height:g.height,width:g.width},m.redraw(),s=""!=e(this.element).css("background-color")?e(this.element).css("background-color"):"rgb(255, 255, 255)",t.isNullOrUndefined(r.exportChartAsImage)||r.exportChartAsImage||(m.model.size=u,p=(p=this._excelExport(m,g.height,g.width)).replace(new RegExp("<br/>","g"),"")),r.exportMode==t.PivotChart.ExportMode.ClientMode?(h={fileName:t.isNullOrUndefined(l)?t.isNullOrUndefined(r.fileName)?"PivotChart":r.fileName:l,chartdata:o.split(",")[1],bgColor:s,exportFormat:a,title:r.title,description:r.description},t.isNullOrUndefined(r.exportChartAsImage)||r.exportChartAsImage||(h.chartModel=p),c={args:JSON.stringify(h)},!t.raiseWebFormsServerEvents||"excelExport"!=i&&"pdfExport"!=i&&"wordExport"!=i&&"imageExport"!=i||r.exportMode!=t.PivotChart.ExportMode.ClientMode||""!=e.trim(r.url)?this.doPostBack(""!=e.trim(r.url)?r.url:i,c):(n={model:this.model,originalEventType:i},d=c,t.raiseWebFormsServerEvents(i,n,d),setTimeout(function(){t.isOnWebForms=!0},1e3))):(h={exportOption:i,chartdata:o.split(",")[1],bgColor:s,title:r.title,description:r.description},t.isNullOrUndefined(r.exportChartAsImage)||r.exportChartAsImage||(h.chartModel=p),c={args:JSON.stringify(h)},this.doPostBack(""!=e.trim(r.url)?r.url:this.model.url+"/"+this.model.serviceMethodSettings.exportPivotChart,c))}},_excelExport:function(t,i,l){var a,r,o,s=e.extend(!0,{},t.model),n=(t.svgHeight,t.svgWidth,i),d=l;if(s.event=null,s.primaryXAxis.range=s.primaryXAxis.actualRange,s.primaryYAxis.range=s.primaryYAxis.actualRange,t._ignoreOnExport)for(a=s.series,r=0;r<a.length;r++)delete a[r].dataSource,delete a[r].query,a[r].fill="array"==jQuery.type(a[r].fill)?a[r].fill[0].color:a[r].fill;return s.size.height&&-1!=s.size.height.indexOf("%")&&(s.size.height=e(t.svgObject).height().toString()),s.size.width&&-1!=s.size.width.indexOf("%")&&(s.size.width=e(t.svgObject).width().toString()),o=JSON.stringify(s),s.size={width:d,height:n},o},doAjaxPost:function(l,a,r,o,s,n){var d,h,c,p,u=!0,m=this.model.enableXHRCredentials||!t.isNullOrUndefined(this._pivotClientObj)&&this._pivotClientObj.model.enableXHRCredentials;r.XMLA==i?(d="application/json; charset=utf-8",h="json",c=e.proxy(o,this)):(d="text/xml",h="xml",r=r.XMLA,c=e.proxy(o,t.olap.base,n),u=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)),p={type:l,url:a,data:r,async:u,contentType:d,dataType:h,success:c,xhrFields:{withCredentials:m},complete:t.proxy(function(){var e={action:t.isNullOrUndefined(n)||t.isNullOrUndefined(n.action)?JSON.parse(r).action:n.action,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",e)},this),error:t.proxy(function(e){void 0!==this._waitingPopup&&null!=this._waitingPopup&&this._waitingPopup.hide(),"undefined"!=typeof oclientWaitingPopup&&null!=oclientWaitingPopup&&oclientWaitingPopup.hide();var t={action:this._currentAction,customObject:this.model.customObject,element:this.element,Message:e};this._trigger("renderFailure",t),this.renderChartFromJSON("")},this)},m||delete p.xhrFields,e.ajax(p)},doPostBack:function(t,i){var l=e("<form>").attr({action:t,method:"POST",name:"export"}),a=function(t,i){e('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(l)};for(var r in i)a(r,i[r]);l.appendTo(document.body).submit().remove()}}),t.PivotChart.Locale=t.PivotChart.Locale||{},t.PivotChart.Locale["en-US"]={Measure:"Measure",Row:"Row",Column:"Column",Value:"Value",Expand:"Expand",Collapse:"Collapse",Exit:"Exit",ChartTypes:"Chart Types",TDCharts:"3D Charts",Tooltip:"Tooltip",Exporting:"Exporting",Line:"Line",Spline:"Spline",Column:"Column",Area:"Area",SplineArea:"Spline Area",StepLine:"Step Line",StepArea:"Step Area",Pie:"Pie",Bar:"Bar",StackingArea:"Stacking Area",StackingColumn:"Stacking Column",StackingBar:"Stacking Bar",Pyramid:"Pyramid",Funnel:"Funnel",Doughnut:"Doughnut",Scatter:"Scatter",Bubble:"Bubble",TreeMap:"TreeMap",ColumnTD:"Column 3D",PieTD:"Pie 3D",BarTD:"Bar 3D",StackingBarTD:"StackingBar 3D",StackingColumnTD:"StackingColumn 3D",Excel:"Excel",Word:"Word",Pdf:"PDF",PNG:"PNG",EMF:"EMF",GIF:"GIF",JPG:"JPG",BMP:"BMP",ZoomIn:"Zoom In",ZoomOut:"Zoom Out",Legend:"Legend",SmartLabels:"Smart Labels",Interactions:"Interactions",Zooming:"Zooming",Rotate45:"Rotate45",Rotate90:"Rotate90",Trim:"Trim",MultipleRows:"Multiple Rows",Wrap:"Wrap",Hide:"Hide",WrapByWord:"Wrap By word",CrossHair:"Cross Hair",TrackBall:"Track Ball",DisableTD:"Disable 3D Charts",None:"None",Exception:"Exception",OK:"OK"},t.PivotChart.ChartTypes={Line:"line",Spline:"spline",Column:"column",Area:"area",SplineArea:"splinearea",StepLine:"stepline",StepArea:"steparea",Pie:"pie",Bar:"bar",StackingArea:"stackingarea",StackingColumn:"stackingcolumn",StackingBar:"stackingbar",Pyramid:"pyramid",Funnel:"funnel",Doughnut:"doughnut",Scatter:"scatter",Bubble:"bubble",WaterFall:"waterfall"},t.PivotChart.ExportOptions={Excel:"excel",Word:"word",PDF:"pdf",CSV:"csv",PNG:"png",JPG:"jpg",EMF:"emf",GIF:"gif",BMP:"bmp"},t.PivotChart.SymbolShapes={None:"none",LeftArrow:"leftarrow",RightArrow:"rightarrow",Circle:"circle",Cross:"cross",HorizLine:"horizline",VertLine:"vertline",Diamond:"diamond",Rectangle:"rectangle",Triangle:"triangle",InvertedTriangle:"invertedtriangle",Hexagon:"hexagon",Pentagon:"pentagon",Star:"star",Ellipse:"ellipse",Wedge:"wedge",Trapezoid:"trapezoid",UpArrow:"uparrow",DownArrow:"downarrow",Image:"image"},t.PivotChart.AnalysisMode={Olap:"olap",Pivot:"pivot"},t.PivotChart.OperationalMode={ClientMode:"clientmode",ServerMode:"servermode"},t.PivotChart.ExportMode={ClientMode:"clientmode",ServerMode:"servermode"}}(jQuery,Syncfusion)})},1337:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.reportName="Default Report",this.title="Relational Browser",this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values()}return e.prototype.saveReportSettings=function(e){return e.fetchReportSetting?e.fetchReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.loadReportSetting?e.loadReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.saveReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap",e},e.prototype.export=function(e){e.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap/Export"},e.prototype.onChange=function(e){var t=$(".e-pivotclient").data("ejPivotClient"),i=$("#rdbRelational").data("ejRadioButton"),l=$("#rdbOlap").data("ejRadioButton");$(t.element).html(""),t.model.operationalMode="clientmode";var a={reportName:"DefaultReport",data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}],filters:[]};t.model.dataSource=i.model.checked?a:l.model.checked?{reportName:"DefaultReport",data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]}:a,t.model.title=i.model.checked?"Relational Browser":l.model.checked?"OLAP Browser":"Relational Browser",t.model.url="",t._load()},e=l([r.Component({selector:"ej-app",template:i(1836),styles:[i(2004)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.AdvancedFilteringComponent=s},1338:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.title="OLAP Browser",this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_Olapvalues(),this.Export="Export",this.exportOptions=["chartandgrid","chartonly","gridonly"],this.value="chartandgrid"}return e.prototype.onChange=function(e){var t=$(".e-pivotclient").data("ejPivotClient"),i=$("#exportOptions").data("ejDropDownList");t.model.clientExportMode=i.selectedTextValue.toLowerCase()},e.prototype.saveReportSettings=function(e){return e.fetchReportSetting?e.fetchReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.loadReportSetting?e.loadReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.saveReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap",e},e.prototype.export=function(e){e.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap/Export"},e=l([r.Component({selector:"ej-app",template:i(1837),styles:[i(2005)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.ExportingComponent=s},1339:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.title="OLAP Browser",this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_Olapvalues()}return e.prototype.saveReportSettings=function(e){return e.fetchReportSetting?e.fetchReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.loadReportSetting?e.loadReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.saveReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap",e},e.prototype.export=function(e){e.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap/Export"},e=l([r.Component({selector:"ej-app",template:i(1838),styles:[i(2006)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.OlapComponent=s},1340:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.title="Relational Browser",this.data=e.pivot_data(),this.rows=e.pivot_rows(),this.columns=e.pivot_columns(),this.values=e.pivot_values(),this.Export="Export",this.exportOptions=["Excel","Word","PDF","CSV"],this.value="Excel"}return e.prototype.onChange=function(e){var t=$(".e-pivotclient").data("ejPivotClient"),i=$("#rdbRelational").data("ejRadioButton"),l=$("#rdbOlap").data("ejRadioButton");$(t.element).html(""),t.model.operationalMode="clientmode";var a={data:this.data,cube:"",rows:[{fieldName:"Country",fieldCaption:"Country"},{fieldName:"State",fieldCaption:"State"}],columns:[{fieldName:"Product",fieldCaption:"Product"}],values:[{fieldName:"Amount",fieldCaption:"Amount"},{fieldName:"Quantity",fieldCaption:"Quantity"}],filters:[]};t.model.dataSource=i.model.checked?a:l.model.checked?{data:"//bi.syncfusion.com/olap/msmdpump.dll",catalog:"Adventure Works DW 2008 SE",cube:"Adventure Works",rows:[{fieldName:"[Date].[Fiscal]"}],columns:[{fieldName:"[Customer].[Customer Geography]"}],values:[{measures:[{fieldName:"[Measures].[Internet Sales Amount]"}],axis:"columns"}],filters:[]}:a,t.model.url="",t._load()},e.prototype.saveReportSettings=function(e){return e.fetchReportSetting?e.fetchReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.loadReportSetting?e.loadReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.saveReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap",e},e.prototype.export=function(e){e.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap/Export"},e=l([r.Component({selector:"ej-app",template:i(1839),styles:[i(2007)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.RelationalComponent=s},1341:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var r=i(5),o=i(1007),s=function(){function e(e){this.pivotdataservice=e,this.title="Olap Browser",this.data=e.pivot_datacube(),this.cube=e.pivot_cube(),this.catalog=e.pivot_catelog(),this.rows=e.pivot_Olaprows(),this.columns=e.pivot_Olapcolumns(),this.values=e.pivot_Olapvalues()}return e.prototype.saveReportSettings=function(e){return e.fetchReportSetting?e.fetchReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.loadReportSetting?e.loadReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap":e.saveReportSetting.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap",e},e.prototype.export=function(e){e.url="//js.syncfusion.com/demos/ejServices/api/PivotClient/Olap/Export"},e=l([r.Component({selector:"ej-app",template:i(1840),styles:[i(2008)],providers:[o.PivotDataService]}),a("design:paramtypes",[o.PivotDataService])],e)}();t.RTLComponent=s},1499:function(e,t,i){"use strict";var l=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function l(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(l.prototype=i.prototype,new l)}}();Object.defineProperty(t,"__esModule",{value:!0}),i(2040);var a=i(12),r=i(5),o=function(e){function t(t,i,l,a){var o=e.call(this,"PivotClient",t,i,[],l,a)||this;return o.el=t,o.cdRef=i,o._ejIterableDiffers=l,o._ejkeyvaluediffers=a,o.afterServiceInvoke_output=new r.EventEmitter,o.beforeServiceInvoke_output=new r.EventEmitter,o.saveReport_output=new r.EventEmitter,o.loadReport_output=new r.EventEmitter,o.fetchReport_output=new r.EventEmitter,o.beforeExport_output=new r.EventEmitter,o.chartLoad_output=new r.EventEmitter,o.schemaLoad_output=new r.EventEmitter,o.treeMapLoad_output=new r.EventEmitter,o.valueCellHyperlinkClick_output=new r.EventEmitter,o.cellClick_output=new r.EventEmitter,o.pointRegionClick_output=new r.EventEmitter,o.axesLabelRendering_output=new r.EventEmitter,o.drillThrough_output=new r.EventEmitter,o.load_output=new r.EventEmitter,o.renderComplete_output=new r.EventEmitter,o.renderFailure_output=new r.EventEmitter,o.renderSuccess_output=new r.EventEmitter,o}return l(t,e),t.decorators=[{type:r.Component,args:[{selector:"ej-pivotclient",template:""}]}],t.ctorParameters=function(){return[{type:r.ElementRef},{type:r.ChangeDetectorRef},{type:r.IterableDiffers},{type:r.KeyValueDiffers}]},t.propDecorators={analysisMode_input:[{type:r.Input,args:["analysisMode"]}],chartType_input:[{type:r.Input,args:["chartType"]}],clientExportMode_input:[{type:r.Input,args:["clientExportMode"]}],cssClass_input:[{type:r.Input,args:["cssClass"]}],customObject_input:[{type:r.Input,args:["customObject"]}],dataSource_input:[{type:r.Input,args:["dataSource"]}],enableDrillThrough_input:[{type:r.Input,args:["enableDrillThrough"]}],displaySettings_input:[{type:r.Input,args:["displaySettings"]}],toolbarIconSettings_input:[{type:r.Input,args:["toolbarIconSettings"]}],showUniqueNameOnPivotButton_input:[{type:r.Input,args:["showUniqueNameOnPivotButton"]}],showReportCollection_input:[{type:r.Input,args:["showReportCollection"]}],enableSplitter_input:[{type:r.Input,args:["enableSplitter"]}],enableAdvancedFilter_input:[{type:r.Input,args:["enableAdvancedFilter"]}],enableDeferUpdate_input:[{type:r.Input,args:["enableDeferUpdate"]}],enableLocalStorage_input:[{type:r.Input,args:["enableLocalStorage"]}],enablePaging_input:[{type:r.Input,args:["enablePaging"]}],enablePivotTreeMap_input:[{type:r.Input,args:["enablePivotTreeMap"]}],enableRTL_input:[{type:r.Input,args:["enableRTL"]}],enableMeasureGroups_input:[{type:r.Input,args:["enableMeasureGroups"]}],enableCellClick_input:[{type:r.Input,args:["enableCellClick"]}],enableCellDoubleClick_input:[{type:r.Input,args:["enableCellDoubleClick"]}],enableVirtualScrolling_input:[{type:r.Input,args:["enableVirtualScrolling"]}],maxNodeLimitInMemberEditor_input:[{type:r.Input,args:["maxNodeLimitInMemberEditor"]}],enableMemberEditorPaging_input:[{type:r.Input,args:["enableMemberEditorPaging"]}],memberEditorPageSize_input:[{type:r.Input,args:["memberEditorPageSize"]}],enableMemberEditorSorting_input:[{type:r.Input,args:["enableMemberEditorSorting"]}],gridLayout_input:[{type:r.Input,args:["gridLayout"]}],collapseCubeBrowserByDefault_input:[{type:r.Input,args:["collapseCubeBrowserByDefault"]}],enableKPI_input:[{type:r.Input,args:["enableKPI"]}],isResponsive_input:[{type:r.Input,args:["isResponsive"]}],size_input:[{type:r.Input,args:["size"]}],locale_input:[{type:r.Input,args:["locale"]}],operationalMode_input:[{type:r.Input,args:["operationalMode"]}],serviceMethodSettings_input:[{type:r.Input,args:["serviceMethodSettings"]}],valueSortSettings_input:[{type:r.Input,args:["valueSortSettings"]}],title_input:[{type:r.Input,args:["title"]}],url_input:[{type:r.Input,args:["url"]}],enableCompleteDataExport_input:[{type:r.Input,args:["enableCompleteDataExport"]}],enableXHRCredentials_input:[{type:r.Input,args:["enableXHRCredentials"]}],dataSource_cube_input:[{type:r.Input,args:["dataSource.cube"]}],dataSource_sourceInfo_input:[{type:r.Input,args:["dataSource.sourceInfo"]}],dataSource_providerName_input:[{type:r.Input,args:["dataSource.providerName"]}],dataSource_data_input:[{type:r.Input,args:["dataSource.data"]}],dataSource_catalog_input:[{type:r.Input,args:["dataSource.catalog"]}],dataSource_enableAdvancedFilter_input:[{type:r.Input,args:["dataSource.enableAdvancedFilter"]}],dataSource_reportName_input:[{type:r.Input,args:["dataSource.reportName"]}],dataSource_pagerOptions_input:[{type:r.Input,args:["dataSource.pagerOptions"]}],dataSource_pagerOptions_categoricalPageSize_input:[{type:r.Input,args:["dataSource.pagerOptions.categoricalPageSize"]}],dataSource_pagerOptions_seriesPageSize_input:[{type:r.Input,args:["dataSource.pagerOptions.seriesPageSize"]}],dataSource_pagerOptions_categoricalCurrentPage_input:[{type:r.Input,args:["dataSource.pagerOptions.categoricalCurrentPage"]}],dataSource_pagerOptions_seriesCurrentPage_input:[{type:r.Input,args:["dataSource.pagerOptions.seriesCurrentPage"]}],displaySettings_controlPlacement_input:[{type:r.Input,args:["displaySettings.controlPlacement"]}],displaySettings_defaultView_input:[{type:r.Input,args:["displaySettings.defaultView"]}],displaySettings_enableFullScreen_input:[{type:r.Input,args:["displaySettings.enableFullScreen"]}],displaySettings_enableTogglePanel_input:[{type:r.Input,args:["displaySettings.enableTogglePanel"]}],displaySettings_mode_input:[{type:r.Input,args:["displaySettings.mode"]}],toolbarIconSettings_enableAddReport_input:[{type:r.Input,args:["toolbarIconSettings.enableAddReport"]}],toolbarIconSettings_enableNewReport_input:[{type:r.Input,args:["toolbarIconSettings.enableNewReport"]}],toolbarIconSettings_enableRenameReport_input:[{type:r.Input,args:["toolbarIconSettings.enableRenameReport"]}],toolbarIconSettings_enableDBManipulation_input:[{type:r.Input,args:["toolbarIconSettings.enableDBManipulation"]}],toolbarIconSettings_enableWordExport_input:[{type:r.Input,args:["toolbarIconSettings.enableWordExport"]}],toolbarIconSettings_enableExcelExport_input:[{type:r.Input,args:["toolbarIconSettings.enableExcelExport"]}],toolbarIconSettings_enablePdfExport_input:[{type:r.Input,args:["toolbarIconSettings.enablePdfExport"]}],toolbarIconSettings_enableMDXQuery_input:[{type:r.Input,args:["toolbarIconSettings.enableMDXQuery"]}],toolbarIconSettings_enableDeferUpdate_input:[{type:r.Input,args:["toolbarIconSettings.enableDeferUpdate"]}],toolbarIconSettings_enableFullScreen_input:[{type:r.Input,args:["toolbarIconSettings.enableFullScreen"]}],toolbarIconSettings_enableSortOrFilterColumn_input:[{type:r.Input,args:["toolbarIconSettings.enableSortOrFilterColumn"]}],toolbarIconSettings_enableSortOrFilterRow_input:[{type:r.Input,args:["toolbarIconSettings.enableSortOrFilterRow"]}],toolbarIconSettings_enableToggleAxis_input:[{type:r.Input,args:["toolbarIconSettings.enableToggleAxis"]}],toolbarIconSettings_enableChartTypes_input:[{type:r.Input,args:["toolbarIconSettings.enableChartTypes"]}],toolbarIconSettings_enableRemoveReport_input:[{type:r.Input,args:["toolbarIconSettings.enableRemoveReport"]}],toolbarIconSettings_enableCalculatedMember_input:[{type:r.Input,args:["toolbarIconSettings.enableCalculatedMember"]}],serviceMethodSettings_cubeChanged_input:[{type:r.Input,args:["serviceMethodSettings.cubeChanged"]}],serviceMethodSettings_exportPivotClient_input:[{type:r.Input,args:["serviceMethodSettings.exportPivotClient"]}],serviceMethodSettings_fetchMemberTreeNodes_input:[{type:r.Input,args:["serviceMethodSettings.fetchMemberTreeNodes"]}],serviceMethodSettings_fetchReportList_input:[{type:r.Input,args:["serviceMethodSettings.fetchReportList"]}],serviceMethodSettings_filterElement_input:[{type:r.Input,args:["serviceMethodSettings.filterElement"]}],serviceMethodSettings_initialize_input:[{type:r.Input,args:["serviceMethodSettings.initialize"]}],serviceMethodSettings_loadReport_input:[{type:r.Input,args:["serviceMethodSettings.loadReport"]}],serviceMethodSettings_removeDBReport_input:[{type:r.Input,args:["serviceMethodSettings.removeDBReport"]}],serviceMethodSettings_renameDBReport_input:[{type:r.Input,args:["serviceMethodSettings.renameDBReport"]}],serviceMethodSettings_mdxQuery_input:[{type:r.Input,args:["serviceMethodSettings.mdxQuery"]}],serviceMethodSettings_measureGroupChanged_input:[{type:r.Input,args:["serviceMethodSettings.measureGroupChanged"]}],serviceMethodSettings_memberExpand_input:[{type:r.Input,args:["serviceMethodSettings.memberExpand"]}],serviceMethodSettings_nodeDropped_input:[{type:r.Input,args:["serviceMethodSettings.nodeDropped"]}],serviceMethodSettings_removeSplitButton_input:[{type:r.Input,args:["serviceMethodSettings.removeSplitButton"]}],serviceMethodSettings_saveReport_input:[{type:r.Input,args:["serviceMethodSettings.saveReport"]}],serviceMethodSettings_toggleAxis_input:[{type:r.Input,args:["serviceMethodSettings.toggleAxis"]}],serviceMethodSettings_toolbarServices_input:[{type:r.Input,args:["serviceMethodSettings.toolbarServices"]}],serviceMethodSettings_updateReport_input:[{type:r.Input,args:["serviceMethodSettings.updateReport"]}],serviceMethodSettings_paging_input:[{type:r.Input,args:["serviceMethodSettings.paging"]}],serviceMethodSettings_calculatedMember_input:[{type:r.Input,args:["serviceMethodSettings.calculatedMember"]}],serviceMethodSettings_valueSorting_input:[{type:r.Input,args:["serviceMethodSettings.valueSorting"]}],serviceMethodSettings_drillThroughHierarchies_input:[{type:r.Input,args:["serviceMethodSettings.drillThroughHierarchies"]}],serviceMethodSettings_drillThroughDataTable_input:[{type:r.Input,args:["serviceMethodSettings.drillThroughDataTable"]}],valueSortSettings_headerText_input:[{type:r.Input,args:["valueSortSettings.headerText"]}],valueSortSettings_headerDelimiters_input:[{type:r.Input,args:["valueSortSettings.headerDelimiters"]}],valueSortSettings_sortOrder_input:[{type:r.Input,args:["valueSortSettings.sortOrder"]}],dataSource_columns_input:[{type:r.Input,args:["dataSource.columns"]}],dataSource_rows_input:[{type:r.Input,args:["dataSource.rows"]}],dataSource_values_input:[{type:r.Input,args:["dataSource.values"]}],dataSource_filters_input:[{type:r.Input,args:["dataSource.filters"]}],options:[{type:r.Input,args:["options"]}],afterServiceInvoke_output:[{type:r.Output,args:["afterServiceInvoke"]}],beforeServiceInvoke_output:[{type:r.Output,args:["beforeServiceInvoke"]}],saveReport_output:[{type:r.Output,args:["saveReport"]}],loadReport_output:[{type:r.Output,args:["loadReport"]}],fetchReport_output:[{type:r.Output,args:["fetchReport"]}],beforeExport_output:[{type:r.Output,args:["beforeExport"]}],chartLoad_output:[{type:r.Output,args:["chartLoad"]}],schemaLoad_output:[{type:r.Output,args:["schemaLoad"]}],treeMapLoad_output:[{type:r.Output,args:["treeMapLoad"]}],valueCellHyperlinkClick_output:[{type:r.Output,args:["valueCellHyperlinkClick"]}],cellClick_output:[{type:r.Output,args:["cellClick"]}],pointRegionClick_output:[{type:r.Output,args:["pointRegionClick"]}],axesLabelRendering_output:[{type:r.Output,args:["axesLabelRendering"]}],drillThrough_output:[{type:r.Output,args:["drillThrough"]}],load_output:[{type:r.Output,args:["load"]}],renderComplete_output:[{type:r.Output,args:["renderComplete"]}],renderFailure_output:[{type:r.Output,args:["renderFailure"]}],renderSuccess_output:[{type:r.Output,args:["renderSuccess"]}]},t}(a.EJComponents);t.PivotClientComponent=o,t.EJ_PIVOTCLIENT_COMPONENTS=[o]},1836:function(e,t){e.exports='<ej-pivotclient id="PivotClient1" [title]="title" [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.reportName]="reportName" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [enableAdvancedFilter]="true"  (beforeExport)="export($event)" (saveReport)="saveReportSettings($event)" (fetchReport)="saveReportSettings($event)" (loadReport)="saveReportSettings($event)">\r\n</ej-pivotclient>\r\n<div id="property-window" class="box wide" style="width: 350px">\r\n    <div class="row" style="margin-top: 20px">\r\n        <table width="300px">\r\n            <tr>\r\n                <td> Data Source </td>\r\n                <td>\r\n                    <input id="rdbRelational" type="radio" ej-radiobutton name="radio1" [checked]="true" value="relational" (ejchange)="onChange($event)" /> Relational</td>\r\n                <td>\r\n                    <input id="rdbOlap" ej-radiobutton type="radio" name="radio1" value="olap" (ejchange)="onChange($event)" /> OLAP</td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n<div>'},1837:function(e,t){e.exports='<ej-pivotclient id="PivotClient1" [title]="title" [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [clientExportMode] ="value"  (beforeExport)="export($event)" (saveReport)="saveReportSettings($event)" (fetchReport)="saveReportSettings($event)" (loadReport)="saveReportSettings($event)">\r\n</ej-pivotclient>\r\n<div id="property-window" class="box wide" style="width: 350px">\r\n\r\n    <div class="row" style="margin-top: 20px">\r\n        <table width="300px">\r\n            <tr>\r\n                <td class="chkrad">\r\n                    Export Mode:\r\n                </td>\r\n                <td class="chkrad" colspan="2">\r\n                    <input id="exportOptions" ej-dropdownlist  [dataSource]="exportOptions" [(value)]="value" (ejchange)="onChange($event)"/>\r\n                </td>\r\n            </tr>\r\n        </table>\r\n    </div>\r\n</div>'},1838:function(e,t){e.exports='<ej-pivotclient id="PivotClient1" [title]="title" [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" (beforeExport)="export($event)" (saveReport)="saveReportSettings($event)" (fetchReport)="saveReportSettings($event)" (loadReport)="saveReportSettings($event)">\r\n</ej-pivotclient>'},1839:function(e,t){e.exports='<ej-pivotclient id="PivotClient1" [dataSource.data]="data" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values"  [title]="title" (beforeExport)="export($event)" (saveReport)="saveReportSettings($event)" (fetchReport)="saveReportSettings($event)" (loadReport)="saveReportSettings($event)">\r\n</ej-pivotclient>'},1840:function(e,t){e.exports='<ej-pivotclient id="PivotClient1" [title]="title" [dataSource.data]="data" [dataSource.catalog]="catalog" [dataSource.cube]="cube" [dataSource.rows]="rows" [dataSource.columns]="columns" [dataSource.values]="values" [enableRTL]="true" (beforeExport)="export($event)" (saveReport)="saveReportSettings($event)" (fetchReport)="saveReportSettings($event)" (loadReport)="saveReportSettings($event)">\r\n</ej-pivotclient>'},2004:function(e,t){e.exports="ej-pivotclient {\r\n    display: block;\r\n    height: 700px;\r\n    width: 100%; \r\n}\r\n.e-pivotclient{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},2005:function(e,t){e.exports="ej-pivotclient {\r\n    display: block;\r\n    height: 700px;\r\n    width: 100%; \r\n}\r\n.e-pivotclient{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},2006:function(e,t){e.exports="ej-pivotclient {\r\n    display: block;\r\n    height: 700px;\r\n    width: 100%; \r\n}\r\n.e-pivotclient{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},2007:function(e,t){e.exports="ej-pivotclient {\r\n    display: block;\r\n    height: 700px;\r\n    width: 100%; \r\n}\r\n.e-pivotclient{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},2008:function(e,t){e.exports="ej-pivotclient {\r\n    display: block;\r\n    height: 700px;\r\n    width: 100%; \r\n}\r\n.e-pivotclient{\r\n    position: inherit !important;\r\n}\r\n.e-ddl {\r\n    margin: -25px 0 0 100px;\r\n}"},2040:function(e,t,i){var l,a,r;
/*!
*  filename: ej.pivotclient.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pivotclient.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(o){a=[i(15),i(4),i(21),i(65),i(38),i(16),i(47),i(31),i(92),i(55),i(79),i(224),i(66),i(96),i(155),i(1039),i(1022),i(416),i(97),i(1011),i(1009),i(1010)],void 0===(r="function"==typeof(l=o)?l.apply(t,a):l)||(e.exports=r)}(function(){!function(e,t,i){t.widget("ejPivotClient","ej.PivotClient",{_rootCSS:"e-pivotclient",element:null,model:null,validTags:["div","span"],defaults:{url:"",cssClass:"",title:"",gridLayout:"normal",chartType:"column",clientExportMode:"chartandgrid",enableDeferUpdate:!1,enablePivotTreeMap:!1,enableRTL:!1,enableDefaultValue:!1,enableAdvancedFilter:!1,enablePaging:!1,enableSplitter:!1,enableToolBar:!1,enableCellSelection:!1,enableLocalStorage:!1,enableVirtualScrolling:!1,enableMemberEditorPaging:!1,showUniqueNameOnPivotButton:!1,isResponsive:!1,collapseCubeBrowserByDefault:!1,enableKPI:!1,showReportCollection:!1,enableValueCellHyperlink:!1,enableRowHeaderHyperlink:!1,enableColumnHeaderHyperlink:!1,enableSummaryCellHyperlink:!1,enableCellContext:!1,enableDrillThrough:!1,enableCellEditing:!1,enableCellDoubleClick:!1,enableCellClick:!1,enableXHRCredentials:!1,enableCompleteDataExport:!1,enableMemberEditorSorting:!1,enableCheckStateOnSearch:!0,dataSource:{data:null,sourceInfo:"",providerName:"ssas",enableAdvancedFilter:!1,isFormattedValues:!1,reportName:"Default",columns:[],cube:"",catalog:"",rows:[],values:[],filters:[],pagerOptions:{categoricalPageSize:0,seriesPageSize:0,categoricalCurrentPage:0,seriesCurrentPage:0}},displaySettings:{mode:"chartandgrid",defaultView:"grid",controlPlacement:"tab",enableTogglePanel:!1,enableFullScreen:!1},serviceMethodSettings:{initialize:"InitializeClient",removeSplitButton:"RemoveSplitButton",filterElement:"FilterElement",nodeDropped:"NodeDropped",toggleAxis:"ToggleAxis",fetchMemberTreeNodes:"FetchMemberTreeNodes",cubeChanged:"CubeChanged",measureGroupChanged:"MeasureGroupChanged",toolbarServices:"ToolbarOperations",memberExpand:"MemberExpanded",saveReport:"SaveReportToDB",fetchReportList:"FetchReportListFromDB",loadReport:"LoadReportFromDB",updateReport:"UpdateReport",exportPivotClient:"Export",mdxQuery:"GetMDXQuery",drillThroughHierarchies:"DrillThroughHierarchies",drillThroughDataTable:"DrillThroughDataTable",paging:"Paging",removeDBReport:"RemoveReportFromDB",renameDBReport:"RenameReportInDB",calculatedMember:"CalculatedMember",valueSorting:"ValueSorting",changeSummaryType:"ChangeSummaryType"},size:{height:"685px",width:"1000px"},sortCubeMeasures:t.Pivot.SortOrder.Ascending,toolbarIconSettings:{enableAddReport:!0,enableNewReport:!0,enableRenameReport:!0,enableDBManipulation:!0,enableWordExport:!0,enableExcelExport:!0,enablePdfExport:!0,enableMDXQuery:!0,enableDeferUpdate:!1,enableFullScreen:!1,enableSortOrFilterColumn:!0,enableSortOrFilterRow:!0,enableToggleAxis:!0,enableChartTypes:!0,enableRemoveReport:!0,enableCalculatedMember:!1},valueSortSettings:{headerText:"",headerDelimiters:"##",sortOrder:"none"},customObject:{},calculatedMembers:[],enableMeasureGroups:!1,locale:"en-US",analysisMode:"olap",operationalMode:"clientmode",renderSuccess:null,renderFailure:null,renderComplete:null,load:null,chartLoad:null,treeMapLoad:null,drillThrough:null,beforeExport:null,beforeServiceInvoke:null,afterServiceInvoke:null,saveReport:null,loadReport:null,fetchReport:null,cellSelection:null,gridDrillSuccess:null,chartDrillSuccess:null,treeMapDrillSuccess:null,axesLabelRendering:null,pointRegionClick:null,valueCellHyperlinkClick:null,rowHeaderHyperlinkClick:null,columnHeaderHyperlinkClick:null,summaryCellHyperlinkClick:null,cellContext:null,cellEdit:null,cellDoubleClick:null,cellClick:null,drillThrough:null,memberEditorPageSize:100,maxNodeLimitInMemberEditor:1e3},dataTypes:{dataSource:{data:"data",columns:"array",rows:"array",values:"array",filters:"array"},serviceMethodSettings:{initialize:"enum",removeSplitButton:"enum",filterElement:"enum",nodeDropped:"enum",toggleAxis:"enum",fetchMemberTreeNodes:"enum",cubeChanged:"enum",measureGroupChanged:"enum",toolbarServices:"enum",memberExpand:"enum",saveReport:"enum",fetchReportList:"enum",loadReport:"enum",updateReport:"enum",exportPivotClient:"enum",mdxQuery:"enum",drillThroughHierarchies:"enum",drillThroughDataTable:"enum",paging:"enum",removeDBReport:"enum",renameDBReport:"enum",calculatedMember:"enum",valueSorting:"enum"},displaySettings:"data",customObject:"data"},observables:["title","gridLayout","displaySettings.mode","displaySettings.defaultView","displaySettings.controlPlacement","displaySettings.enableTogglePanel","locale"],title:t.util.valueFunction("title"),gridLayout:t.util.valueFunction("gridLayout"),displayMode:t.util.valueFunction("displaySettings.mode"),defaultView:t.util.valueFunction("displaySettings.defaultView"),controlPlacement:t.util.valueFunction("displaySettings.controlPlacement"),enableTogglePanel:t.util.valueFunction("displaySettings.enableTogglePanel"),locale:t.util.valueFunction("locale"),_init:function(){this._initPrivateProperties(),this._load()},_initPrivateProperties:function(){this._isCollapseCB=!1,this._id=this.element.attr("id"),this.oclientProxy=this,this.currentReport="",this.currentCubeName="",this.reportsCount=0,this._pivotGrid=null,this._pivotChart=null,this._pivotSchemaDesigner=null,this._deferReport="",this._keypress=!1,this._memberTreeObj=null,this._chartHeight=0,this._chartWidth=0,this._gridHeight=0,this._gridWidth=0,this._maxInitialChartHeight=0,this._maxInitialChartWidth=0,this._maxInitialGridWidth=0,this._initStyles=[],this._toggleStyles=[],this._initToggle=!0,this._toggleExpand=!1,this._treemapRender=!1,this._dimensionName="",this._dllSortMeasure=null,this._selectedFieldName="",this._axis="",this._isSorted=!1,this._isFiltered=!1,this._sortOrFilterTab="",this._currentAxis="",this._parentElwidth=0,this.pNode="",this.progressPos=null,this._selectedReport="",this._isMembersFiltered=!1,this._pagerObj=null,this._dialogTitle="",this._dataModel=" ",this._clientReportCollection=[],this._prevDrillElements=[],this._drillParams=[],this._drillInfo=[],this.draggedSplitBtn=null,this.isDragging=!1,this.isDropped=!1,this.measureGroupInfo="",this._currentTab=this.defaultView(),this._currentItem=null,this._currentReportItems=[],this._savedReportItems=[],this._treeViewData={},this._slicerBtnTextInfo={},this._memberPageSettings={currentMemeberPage:1,startPage:0,endPage:0},this._memberSearchPageSettings={currentMemberSearchPage:1,startSearchPage:0,endSearchPage:0},this._memberDrillPageSettings={currentMemberDrillPage:1,startDrillPage:0,endDrillPage:0},this._isNodeOrButtonDropped=!1,this._ischartTypesChanged=!1,this._isrenderTreeMap=!1,this._isRemoved=!1,this._waitingPopup=null,this._isGridDrillAction=!1,this._isChartDrillAction=!1,this._olapReport="",this._jsonRecords=null,this._excelFilterInfo=[],this._index={tab:0,icon:1,chartimg:0,button:1,dialog:0,editor:0,tree:0},this._curFocus={tab:null,icon:null,chartimg:null,button:null,dialog:null,editor:null,tree:null},this._seriesCurrentPage=1,this._categCurrentPage=1,this._isReportListAction=!0,this._currentRecordName="",this._pagingSavedObjects={drillEngine:[],savedHdrEngine:[],curDrilledItem:{}},this._fieldMembers={},this._fieldSelectedMembers={},this._allMember="",this._editorTreeData=[],this._editorSearchTreeData=[],this._editorDrillTreeData={},this._editorDrillTreePageSettings={},this._lastSavedTree=[],this._isSearchApplied=!1,this._isTimeOut=!1,this._isOptionSearch=!1,this._isEditorDrillPaging=!1,this._isEditorCollapseDrillPaging=!1,this._isSelectSearchFilter=!0,this._calcMemberTreeObj=null,this._cubeTreeView=null,this._calcMemberDialog=null,this._calcMembers=[],this._selectedCalcMember=null,this._args_className=null,this._args_innerHTML=null,this._hierarchyCaption=null,this._currentCollection="",this._currentFilterList={},this._repCol=[],this._reportIndex=0,this._isExporting=!1,this._fullExportedData={},this._parentNodeCollection={},this._parentSearchNodeCollection={},this._initialSlicerName=""},getOlapReport:function(){return JSON.parse(this._olapReport)},setOlapReport:function(e){this._olapReport=JSON.stringify(e)},getJSONRecords:function(){return JSON.parse(this._jsonRecords)},setJSONRecords:function(e){this._jsonRecords=JSON.stringify(e)},getActiveTab:function(){return this._currentTab},_destroy:function(){this.element.empty().removeClass("e-pivotclient"+this.model.cssClass).removeAttr("tabindex"),this._waitingPopup!=i&&this._waitingPopup.destroy(),""==this.element.attr("class")&&this.element.removeAttr("class"),delete this.oclientProxy},_load:function(){var l,a,r={element:this.element,customObject:this.model.customObject};if((this.model.enableAdvancedFilter||this.model.dataSource.enableAdvancedFilter)&&(this.model.dataSource.enableAdvancedFilter=this.model.enableAdvancedFilter=!0),this.model.toolbarIconSettings.enableFullScreen=this.model.displaySettings.enableFullScreen=!(!this.model.toolbarIconSettings.enableFullScreen&&!this.model.displaySettings.enableFullScreen),this.model.toolbarIconSettings.enableDeferUpdate=this.model.enableDeferUpdate=!!this.model.enableDeferUpdate,this._trigger("load",r),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&""!=this.model.dataSource.cube){var o=this.model.dataSource.values.length>0?this.model.dataSource.values[0].measures:[],s=this.model.dataSource.rows,n=this.model.dataSource.columns,d=[];this.model.dataSource.rows=this._reArrangeCalcFields(s).reportItem,d=this._reArrangeCalcFields(s).calcMems,this.model.dataSource.columns=this._reArrangeCalcFields(n).reportItem,d=e.merge(d,this._reArrangeCalcFields(n).calcMems),o=e.grep(o,function(l){return l.expression!=i&&(d.push({caption:l.fieldName,expression:l.expression,hierarchyUniqueName:l.hierarchyUniqueName,formatString:l.formatString?l.formatString:null,format:l.format?l.format:null,memberType:t.PivotClient.MemberType.Measure}),l.caption=t.isNullOrUndefined(l.fieldCaption)?l.fieldName:l.fieldCaption,l.fieldName=l.fieldName.toLowerCase().indexOf("measure")>-1?l.fieldName:"[Measures].["+e.trim(l.fieldName)+"]"),l}),this.model.calculatedMembers.length>0?(e.grep(this.model.calculatedMembers,function(t){t=t;d=e.grep(d,function(e){if(t.caption!=e.caption&&!(e.caption.toLowerCase().indexOf("measure")>-1&&"[Measures].["+t.caption+"]"!=e.caption))return t})}),this.model.calculatedMembers=e.merge(d,this.model.calculatedMembers)):(this.model.calculatedMembers=[],this.model.calculatedMembers=e.merge(d,this.model.calculatedMembers))}this.element.addClass(this.model.cssClass),this.element.ejWaitingPopup({showOnInit:!0}),this._waitingPopup=this.element.data("ejWaitingPopup"),null==this.model.dataSource.data&&""!=this.model.url||this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(this.model.operationalMode=t.Pivot.OperationalMode.ServerMode,t.isNullOrUndefined(this.model.beforeServiceInvoke)||this._trigger("beforeServiceInvoke",{action:"initializeClient",element:this.element,customObject:this.model.customObject}),l=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.initialize,JSON.stringify({action:this.model.enableDrillThrough&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?"initializeClient:getDataSet":"initializeClient",customObject:l,clientParams:this.model.enableMeasureGroups+"-"+this.model.chartType+"-"+this.model.enableKPI+"-"+this.model.sortCubeMeasures+"-##-"+JSON.stringify(this.model.valueSortSettings)}),this._renderControlSuccess)):(this.model.operationalMode=t.Pivot.OperationalMode.ClientMode,this.model.analysisMode=""!=this.model.dataSource.cube?t.Pivot.AnalysisMode.Olap:t.Pivot.AnalysisMode.Pivot,a=this,setTimeout(function(){a._renderLayout(),a._createControl(),a.model.enableSplitter&&a._createSplitter()},0))},_reArrangeCalcFields:function(l){var a=[],r=[];l=e.grep(l,function(e){if(e.expression==i)return e;r.push({caption:e.fieldName,expression:e.expression,hierarchyUniqueName:e.hierarchyUniqueName,format:e.format?e.format:null,formatString:e.formatString?e.formatString:null,memberType:t.PivotClient.MemberType.Dimension}),a.push(e)});return{reportItem:e.merge(a,l),calcMems:r}},_renderClientControls:function(t){this._renderLayout(),this.setOlapReport(t.PivotReport);e.parseJSON(t.PivotReport);this.currentReport=""!=this.getOlapReport()?JSON.parse(this.getOlapReport()).Report:"",this.setJSONRecords({GridJSON:t.GridJSON,ChartJSON:t.ChartJSON}),this._createControl(),this.model.enableSplitter&&this._createSplitter(),this.model.enableAdvancedFilter&&this._pivotGrid&&this._pivotGrid._removeCells(t)},_createControl:function(){var l,a,r,o,s,n;if(this.element.find("#"+this._id+"_PivotSchemaDesigner").ejPivotSchemaDesigner({pivotControl:this,_waitingPopup:this._waitingPopup,enableRTL:this.model.enableRTL,enableMemberEditorSorting:this.model.enableMemberEditorSorting,enableCheckStateOnSearch:this.model.enableCheckStateOnSearch,layout:t.PivotSchemaDesigner.Layouts.OneByOne,olap:{showKPI:!1,showNamedSets:!1},serviceMethods:{nodeDropped:this.model.serviceMethodSettings.nodeDropped,memberExpand:this.model.serviceMethodSettings.memberExpand},locale:this.model.locale,width:this.model.enableSplitter?"100%":this.element.width()/3,height:this.element.find(".e-controlPanel").height()}),this.model.enablePaging&&(this.element.find("#"+this._id+"_Pager").ejPivotPager({locale:this.model.locale,mode:t.PivotPager.Mode.Both,targetControlID:this._id}),this.element.find(".e-controlPanel").height(this.element.find(".e-controlPanel").height()-(this.element.find("#"+this._id+"_Pager").height()+5)),this.element.find(".e-gridContainer").height(this.element.find(".e-gridContainer").height()-(this.element.find("#"+this._id+"_Pager").height()+5)),this.element.find(".e-chartContainer").height(this.element.find(".e-chartContainer").height()-(this.element.find("#"+this._id+"_Pager").height()+10))),l=t.buildTag("div.searchDiv",t.buildTag("input#"+this._id+"_SearchTreeView.searchTreeView").attr("type","text")[0].outerHTML,{margin:"5px 5px 0px 5px"})[0].outerHTML,this.element.find(".parentSchemaFieldTree").prepend(l),this.element.find("#"+this._id+"_SearchTreeView").ejMaskEdit({name:"inputbox",width:"100%",height:"25px",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search"),maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(t.Pivot._searchTreeNodes,this)}),this.model.enableMeasureGroups&&this._createMeasureGroup(),a=this._clientReportCollection.length>0?e.map(this._clientReportCollection,function(e){return e.reportName!=i?{name:e.reportName}:e.name!=i?{name:e.name}:void 0}):[{name:this.model.dataSource.reportName}],this.element.find(".reportlist").ejDropDownList({dataSource:a,enableRTL:this.model.enableRTL,fields:{text:"name",value:"name"},height:"26px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.element.find(".reportlist").attr("tabindex",0),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(this._clientReportCollection=[this.model.dataSource]),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode){var d=this.element.find(".e-csHeader").width()-this.element.find(".cubeText").width()-this.element.find(".e-toggleExpandButton").width()-(this.model.enableSplitter?50:20),h=this.enableTogglePanel()?d-25:d;this.element.find(".cubeSelector").ejDropDownList({dataSource:"",enableRTL:this.model.enableRTL,fields:{text:"name",value:"name"},width:this.model.enableSplitter&&!this.model.isResponsive?"100%":h+"px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.ddlTarget=this.element.find(".cubeSelector").data("ejDropDownList"),this.ddlTarget.selectItemByText(this.currentCubeName)}this.reportDropTarget=this.element.find("#reportList").data("ejDropDownList"),this._isReportListAction=!1,this.reportDropTarget.model.dataSource.length&&this.reportDropTarget.selectItemByText(this.reportDropTarget.model.dataSource[0].name),this._isReportListAction=!0,this._selectedReport=this.reportDropTarget._currentText,this.element.find(".cubeSelector").ejDropDownList("option","change",t.proxy(this._cubeChanged,this)),this.element.find(".cubeSelector").attr("tabindex",0),this.element.find(".reportlist").ejDropDownList("option","change",t.proxy(this._reportChanged,this)),this.model.enableMeasureGroups&&this.element.find(".measureGroupSelector").ejDropDownList("option","change",t.proxy(this._measureGroupChanged,this)),this.element.find("#clientTab").ejTab({enableRTL:this.model.enableRTL,itemActive:t.proxy(this._onTabClick,this)}),this.model.enableSplitter||this.element.find(".e-controlPanel").width(this.element.width()-this.element.find("#"+this._id+"_PivotSchemaDesigner").width()-(this.model.displaySettings.enableTogglePanel?30:10)),r=0,"tile"==this.controlPlacement()&&"chartandgrid"==this.displayMode()&&(r=this.element.find("#"+this._id+"_PivotChart").parent().height()),"chartonly"!=this.displayMode()&&(o=this.element.find("#"+this._id+"_PivotGrid").parent().height(),this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({locale:this.model.locale,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,isResponsive:this.model.isResponsive,drillSuccess:t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._gridDrillSuccess:this._clientGridDrillSuccess,this),enableCollapseByDefault:!0}),this._pivotGrid=this.element.find("#"+this._id+"_PivotGrid").data("ejPivotGrid"),this._pivotGrid.model.operationalMode=this.model.operationalMode,this._pivotGrid.model.analysisMode=this.model.analysisMode,this._pivotGrid._waitingPopup=this._waitingPopup,this._pivotGrid.model.url=this.model.url,this._pivotGrid.model.dataSource=this.model.dataSource,this._pivotGrid.model.valueSortSettings=this.model.valueSortSettings,this.model.enableVirtualScrolling&&"chartandgrid"==this.displayMode()&&this.element.find("#"+this._id+"_PivotGrid").parent().height(o)),"gridonly"!=this.displayMode()&&(this.element.find("#"+this._id+"_PivotChart").ejPivotChart({locale:this.model.locale,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,axesLabelRendering:this.model.axesLabelRendering,pointRegionClick:this.model.pointRegionClick,canResize:this.model.isResponsive,drillSuccess:t.proxy(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this._chartDrillSuccess:this._clientChartDrillSuccess,this),size:{height:this._chartHeight,width:this._chartWidth},commonSeriesOptions:{type:this.model.chartType,tooltip:{visible:!0}}}),this._pivotChart=this.element.find("#"+this._id+"_PivotChart").data("ejPivotChart"),this._pivotChart.model.operationalMode=this.model.operationalMode,this._pivotChart.model.analysisMode=this.model.analysisMode,this._pivotChart._waitingPopup=this._waitingPopup,this._pivotChart.model.url=this.model.url,this._pivotChart.model.dataSource=this.model.dataSource,this.model.enableVirtualScrolling&&r>0&&this.element.find("#"+this._id+"_PivotChart").parent().height(r)),this._pivotSchemaDesigner=this.element.find("#"+this._id+"_PivotSchemaDesigner").data("ejPivotSchemaDesigner"),s={},null!=this._pivotChart&&(this.element.find("#"+this._id+"_PivotChart").width(this._pivotChart.model.size.width),s.chartModelWidth=this._pivotChart.model.size.width),s.controlPanelWidth=this.element.find(".e-controlPanel").width(),s.chartOuterWidth=this._chartWidth,s.gridOuterWidth=this._gridWidth,this._initStyles.push(s),this.model.isResponsive&&(this._enableResponsive(),this._parentElwidth=e("#"+this._id).parent().width(),this._parentElwidth<850?this._rwdToggleCollapse():this._parentElwidth>850&&this._rwdToggleExpand(),this.model.enableRTL?this._pivotSchemaDesigner.element.width((this._pivotSchemaDesigner.element.width()-37)/this._pivotSchemaDesigner.element.width()*100+"%"):this._pivotSchemaDesigner.element.width((this._pivotSchemaDesigner.element.width()-27)/this._pivotSchemaDesigner.element.width()*100+"%"),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&"chart"==this._currentTab&&this.element.find(".e-chartContainer").css({width:"99.6%"})),this.enableTogglePanel()&&this.element.find(".pivotFieldList").length>0&&(this.element.find(".e-togglePanel").height(this.element.find("#"+this._id+"_PivotSchemaDesigner").height()).width(14),this.element.find(".e-toggleExpandButton,.e-toggleCollapseButton").css("margin-top",(this.element.find("#"+this._id+"_PivotSchemaDesigner").parents("td:eq(0)").height()-9)/2),this.element.find(".e-togglePanel").children().addClass("e-toggleButtons")),this._trigger("renderSuccess",this),this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this),this.element.find(".e-fieldTable").css("border","none"),this.element.find(".parentSchemaFieldTree").addClass("e-olapFieldList")):this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&(this._pivotGrid.setJSONRecords(this.getJSONRecords().GridJSON),this._pivotGrid.setOlapReport(this.getOlapReport()),"excellikelayout"==this.model.gridLayout?this._pivotGrid.excelLikeLayout(this._pivotGrid.getJSONRecords()):this._pivotGrid.renderControlFromJSON()),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this._pivotChart.model.enableMultiLevelLabels?this._pivotChart._generateData({JsonRecords:this.getJSONRecords(),PivotReport:this.getOlapReport()}):this._pivotChart.renderControlSuccess({JsonRecords:this.getJSONRecords().ChartJSON,OlapReport:this.getOlapReport()})),this.currentReport=""!=this.getOlapReport()?JSON.parse(this.getOlapReport()).Report:""):(n=t.PivotAnalysis.pivotEnginePopulate(this.model),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&(this._pivotGrid.setJSONRecords(JSON.stringify(n.json)),"excellikelayout"==this.model.gridLayout?this._pivotGrid.excelLikeLayout(n.json):this._pivotGrid.renderControlFromJSON()),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this._pivotChart.setPivotEngine(n.pivotEngine),this._pivotChart._generateData(n.pivotEngine))),this._unWireEvents(),this._wireEvents(),!this.model.enableSplitter&&this.model.collapseCubeBrowserByDefault&&(this._collapseCubeBrowser(),this._isCollapseCB=!0)},_createMeasureGroup:function(){var i,l;this.element.find(".measureGroupselector").remove(),i="<div class ='measureGroupselector' style='margin:5px 5px 0px 5px'><input type='text' id='measureGroupSelector' class='measureGroupSelector' /></div>",e(this.element).find(".e-cubeBrowser").prepend(i),this.element.find(".measureGroupSelector").ejDropDownList({dataSource:this.measureGroupInfo,enableRTL:this.model.enableRTL,fields:{text:"name",value:"name"},height:"25px",width:"100%",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.element.find(".measureGroupSelector").attr("tabindex",0),(l=this.element.find(".measureGroupSelector").data("ejDropDownList")).selectItemByText(l.model.dataSource[0].name),this.element.find(".measureGroupSelector").ejDropDownList("option","change",t.proxy(this._measureGroupChanged,this))},refreshControl:function(l){var a,r;if(t.isNullOrUndefined(this._pivotSchemaDesigner)||this._pivotSchemaDesigner._refreshPivotButtons(),this.element.find(".e-chartTypesDialog").length>0&&this.element.find(".e-chartTypesDialog").remove(),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this._pivotChart._labelCurrentTags={}),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode){var o=null,s=null,n=null;l[0]!=i?(o=l[0].Value,s=l[1].Value,n=l[2].Value):t.isNullOrUndefined(l.d)?(o=l.PivotReport,s=l.GridJSON,n=l.ChartJSON):(o=l.d[0].Value,s=l.d[1].Value,n=l.d[2].Value),a=this,this._clientReportCollection=e.map(this._clientReportCollection,function(e){return e.report=e.name==a._currentReportName?JSON.parse(o).Report:e.report,e}),this.setJSONRecords({GridJSON:s,ChartJSON:n}),this.setOlapReport(o),t.isNullOrUndefined(this._pivotGrid)||(this._pivotGrid.setJSONRecords(s),this._pivotGrid.renderControlFromJSON(),this._pivotGrid._removeCells(l)),t.isNullOrUndefined(this._pivotChart)||(this._pivotChart._drillAction&&(this._pivotChart._drillAction=""),this._pivotChart.model.enableMultiLevelLabels&&this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?(this._pivotChart._drillParams=this._drillParams=[],this._pivotChart._generateData({JsonRecords:l,PivotReport:o})):this._pivotChart.renderControlSuccess({OlapReport:o,JsonRecords:n}))}else this.model.analysisMode==t.PivotChart.AnalysisMode.Pivot?(r=t.PivotAnalysis.pivotEnginePopulate(this.model),this.generateJSON({tranposeEngine:r.pivotEngine,jsonObj:r.json})):t.olap.base.getJSONData({action:"initialLoad"},this.model.dataSource,this);this.model.isResponsive&&"chartonly"==this.defaultView()&&(this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)||this.element.find("#"+this.chartObj._id).ejChart("option",{model:{size:{height:this._chartHeight}}})),this.model.enableSplitter&&!t.isNullOrUndefined(this.element.find(".e-childsplit").data("ejSplitter"))&&this.element.find(".e-childsplit").data("ejSplitter").refresh(),this._unWireEvents(),this._wireEvents(),this._isTimeOut=!1},_setFirst:!1,_setModel:function(i){for(var l in i)switch(l){case"title":this.title(t.util.getVal(i[l])),this.element.find(".e-titleText").text(this.title());break;case"currentCubeName":this.currentCubeName=i[l];break;case"gridLayout":this.gridLayout(t.util.getVal(i[l])),this._renderPivotGrid();break;case"olapReport":this.currentReport=i[l];break;case"clientReports":this.reports=i[l];break;case"customObject":this.model.customObject=i[l];break;case"locale":this.locale(t.util.getVal(i[l])),(this._pivotGrid||this._pivotChart)&&this._load();break;case"displaySettings":this._setDisplaySettings(i[l]),(this._pivotGrid||this._pivotChart)&&this._load();break;case"operationalMode":this.model.operationalMode=i[l];break;case"analysisMode":this.model.analysisMode=i[l];break;case"enableRTL":this.model.enableRTL=i[l],this._load();break;case"enableAdvancedFilter":this.model.enableAdvancedFilter=i[l];break;case"enableDefaultValue":this.model.enableDefaultValue=i[l];break;case"enablePaging":this.model.enablePaging=i[l],this._load();break;case"enableSplitter":this.model.enableSplitter=i[l],this._load();break;case"enableToolBar":this.model.enableToolBar=i[l],this._load();break;case"enableLocalStorage":this.model.enableLocalStorage=i[l];break;case"enableVirtualScrolling":this.model.enableVirtualScrolling=i[l],this._load();break;case"enableMemberEditorPaging":this.model.enableMemberEditorPaging=i[l];break;case"enableDrillThrough":this.model.enableDrillThrough=i[l],this._load();break;case"showUniqueNameOnPivotButton":this.model.showUniqueNameOnPivotButton=i[l],this._load();break;case"isResponsive":this.model.isResponsive=i[l],this._load();break;case"collapseCubeBrowserByDefault":this.model.collapseCubeBrowserByDefault=i[l],this._load();break;case"dataSource":this.model.dataSource=e.extend({},this.model.dataSource,i[l]),this._load();break;case"enableMeasureGroups":this.model.enableMeasureGroups=i[l],this._load();break;case"size":this.model.size=e.extend({},this.model.size,i[l]),this._load();break;case"toolbarIconSettings":this.model.toolbarIconSettings=e.extend({},this.model.toolbarIconSettings,i[l]),this._load();break;case"sortCubeMeasures":this.model.sortCubeMeasures=i[l]}},_setDisplaySettings:function(i){!t.isNullOrUndefined(t.util.getVal(i).displayMode)&&e.isFunction(t.util.getVal(i).displayMode)?this.displayMode(i.displayMode()):t.isNullOrUndefined(i.displayMode)||this.displayMode(i.displayMode),!t.isNullOrUndefined(t.util.getVal(i).defaultView)&&e.isFunction(t.util.getVal(i).defaultView)?this.defaultView(i.defaultView()):t.isNullOrUndefined(i.defaultView)||this.defaultView(i.defaultView),!t.isNullOrUndefined(t.util.getVal(i).controlPlacement)&&e.isFunction(t.util.getVal(i).controlPlacement)?this.controlPlacement(i.controlPlacement()):t.isNullOrUndefined(i.controlPlacement)||this.controlPlacement(i.controlPlacement),!t.isNullOrUndefined(t.util.getVal(i).enableTogglePanel)&&e.isFunction(t.util.getVal(i).enableTogglePanel)?this.enableTogglePanel(i.enableTogglePanel()):t.isNullOrUndefined(i.enableTogglePanel)||this.enableTogglePanel(i.enableTogglePanel)},_getMeasuresList:function(){var t="";return this.element.find(".e-memberEditorDiv").find("div").each(function(){t+=e(this)[0].id+","}),t},_getUnSelectedNodes:function(){var e,i="";if(this._currentItem.indexOf("Measures")<0)for(e=0;e<this._memberTreeObj.dataSource().length;e++)0==this._memberTreeObj.dataSource()[e].checkedStatus&&(i+="::"+this._memberTreeObj.dataSource()[e].id+"||"+this._memberTreeObj.dataSource()[e].tag+(0==this._currentItem.indexOf(this._getLocalizedLabels("KPIs"))?t.isNullOrUndefined(this._memberTreeObj.dataSource()[e].pid)&&t.isNullOrUndefined(this._memberTreeObj.dataSource()[e].parentId)?"~&":"~&"+(this._memberTreeObj.dataSource()[e].pid||this._memberTreeObj.dataSource()[e].parentId):""));return i},_getSelectedNodes:function(i){var l,a,r,o,s;if(i){var n=this.element.find(".e-editorTreeView")[0].childNodes[0],d=[],h=e(n).children();for(s=0;s<h.length;s++){if(l=h[s],a={caption:e(l.firstChild).find("a").text(),parentId:l.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":e(l).parents()[1].id,id:l.id,checked:e(l).find(":input.nodecheckbox")[0].checked||e(l).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:e(l.firstChild).find(".e-minus").length>0,childNodes:[],tag:e(l).attr("data-tag")},e(l).find("ul:first").children().length>0)for(r=e(l).find("ul:first").children(),o=0;o<r.length;o++)a.childNodes.push(this._getNodeInfo(r[o]));d.push(a)}return JSON.stringify(d)}if(d="",this._currentItem.indexOf(this._getLocalizedLabels("Measures"))<0)for(s=0;s<this._memberTreeObj.dataSource().length;s++)1==this._memberTreeObj.dataSource()[s].checkedStatus&&(d+="::"+this._memberTreeObj.dataSource()[s].id+"||"+this._memberTreeObj.dataSource()[s].tag+(0==this._currentItem.indexOf(this._getLocalizedLabels("KPIs"))?t.isNullOrUndefined(this._memberTreeObj.dataSource()[s].pid)&&t.isNullOrUndefined(this._memberTreeObj.dataSource()[s].parentId)?"":"~&"+(this._memberTreeObj.dataSource()[s].pid||this._memberTreeObj.dataSource()[s].parentId):""));return d},_getNodeInfo:function(t){var i,l,a={caption:e(t.firstChild).find("a").text(),parentId:t.parentElement.parentElement.className.indexOf("e-editorTreeView")>-1?"None":e(t).parents()[1].id,id:t.id,checked:e(t).find(":input.nodecheckbox")[0].checked||e(t).find("span:nth-child(1)").attr("class").indexOf("e-chk-indeter")>-1,expanded:e(t.firstChild).find(".e-minus").length>0,childNodes:[],tag:e(t).attr("data-tag")};if(e(t).find("ul:first").children().length>0)for(i=e(t).find("ul:first").children(),l=0;l<i.length;l++)a.childNodes.push(this._getNodeInfo(i[l]));return a},_removeSplitBtn:function(){var i,l,a,r=e(document).find(".dragClone"),o=this,s=this.element.find(".e-splitBtn");jQuery.each(s,function(t,l){e(e(l).children()[0]).attr("title")==e(r).attr("title")&&(i=e(l).attr("data-tag"),e(l).remove())}),0!=this._currentReportItems.length&&this._treeViewData.hasOwnProperty(e(r).attr("title"))&&(delete this._treeViewData[e(r).attr("title")],this._currentReportItems.splice(e.inArray(e(r).attr("title"),this._currentReportItems),1)),this.model.enableAdvancedFilter&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(l=i.split(":")[1].split("."),t.isNullOrUndefined(l)||2!=l.length||(this._setUniqueNameFrmBtnTag(l),this._removeFilterTag(this._selectedFieldName))),e(".dragClone").remove(),this._isTimeOut=!0,setTimeout(function(){o._isTimeOut&&o._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"removeSplitButton",element:this.element,customObject:this.model.customObject}),a=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeSplitButton,JSON.stringify({action:"removeSplitButton",clientParams:i,olapReport:this.currentReport,clientReports:this.reports,customObject:a}),this._removeSplitButtonSuccess),this._isNodeOrButtonDropped=!0},_removeDialog:function(t){-1==t.target.className.indexOf("e-chartTypesImg")&&e(".e-chartTypesDialog").remove(),-1==t.target.className.indexOf("e-reportDBImg")&&e(".e-reportDBDialog").remove(),-1==t.target.className.indexOf("e-exportImg")&&e(".e-exportTypesDialog").remove(),-1==t.target.className.indexOf("e-chart3DImg")&&e(".e-chart3DTypesDialog").remove(),-1==t.target.className.indexOf("smartLabels")&&e(".e-smartLabelsDialog").remove(),-1==t.target.className.indexOf("e-interaction")&&e(".e-interactionsDialog").remove()},_wireEvents:function(){if(this._wireDialogEvent(),this._wireEditorRemoveEvent(),this._wireMeasureRemoveEvent(),this._on(e(document),"click",this._removeDialog),this._on(e(document),"keydown",this._keyPressDown),this._on(e(document),"keyup",this._keyPressUp),this._on(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this.element.find("#sep1").hover(function(){e(this).removeClass("e-mhover")}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find("button").ejDraggable({clientObj:this,handle:"button",clone:!0,cursorAt:{top:-10,left:-10},dragStart:function(i){i.event.preventDefault(),e(this.element.find(".e-txt")).off("touchstart"),e(this.element.find(".e-txt")).off(t.eventType.click),this.model.clientObj.isDragging=!0,this.element.find(".e-dialog").hide(),this.model.clientObj.draggedSplitBtn=i.event.target},dragStop:function(t){var l,a,r,o;this.element.find(".targetAxis").removeClass("targetAxis"),this.model.clientObj.isDragging=!1,l=null,r=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),a="touchend"==t.event.type?r._setSplitBtnTargetPos(t):r._setSplitBtnTargetPos(t.event),r._dropAxisClassName!=i&&""!=r._dropAxisClassName?("outOfAxis"==r._dropAxisClassName?r._removeSplitBtn():l=r._dropAxisClassName,r._dropAxisClassName=""):t.target!=i?e(t.target).hasClass("e-btn")||e(t.target).hasClass("e-removeSplitBtn")?l=e(t.target).parents("div:eq(1)").attr("class"):"string"!=jQuery.type(t.target.className)?r._removeSplitBtn():l=t.target.className.indexOf("e-splitBtn")>-1?e(t.target).parents("div:eq(0)").attr("class"):t.target.className:l=e(t.event.originalEvent.srcElement).hasClass("e-btn")||e(t.event.originalEvent.srcElement).hasClass("e-removeSplitBtn")?e(t.event.originalEvent.srcElement).parents("div:eq(1)").attr("class"):t.event.originalEvent.srcElement.className.indexOf("e-splitBtn")>-1?e(t.event.originalEvent.srcElement).parents("div:eq(0)").attr("class"):t.event.originalEvent.srcElement.className,l!=i&&null!=l&&(null!=(o=l.indexOf("e-categoricalAxis")>l.indexOf("e-rowAxis")?l.indexOf("e-categoricalAxis")>l.indexOf("e-slicerAxis")?"Categorical":"Slicer":l.indexOf("e-rowAxis")>l.indexOf("e-slicerAxis")?"Series":l.indexOf("e-slicerAxis")>=0?"Slicer":null)?r._splitButtonDropped(o,a):r._removeSplitBtn(),r._setSplitBtnTitle())},helper:function(t){var i=e(t.sender.target).parents(".e-pivotclient").data("ejPivotClient");return t.sender.target.className.indexOf("e-btn")>-1&&e(t.sender.target).clone().addClass("dragClone").appendTo(i.element)}}),this.element.find(".e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage").click(function(i){var l=e(this).parents(".e-pivotclient").data("ejPivotClient");t.Pivot.editorTreeNavigatee(i,l)}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").mouseover(function(){e(this).parents(".e-pivotclient").data("ejPivotClient").isDragging&&e(this).addClass("targetAxis")}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").mouseleave(function(){e(this).removeClass("targetAxis")}),this.element.find(".e-btn").mouseover(function(t){e(t.target.parentNode).find("span").css("display","inline")}),!t.isNullOrUndefined(this._pivotGrid)&&this.model.enableDrillThrough&&(this._pivotGrid.model.enableDrillThrough=!0,e.proxy(this._pivotGrid._addHyperlink,this)),this.element.find(".e-splitBtn").mouseover(function(){e(this).parents(".e-pivotclient").data("ejPivotClient").isDragging&&e(this).addClass("e-dropIndicator")}),this.element.find(".e-splitBtn").mouseleave(function(){e(this).removeClass("e-dropIndicator")}),this._on(this.element,"click","#preventDiv",t.proxy(function(){this.element.find(".e-dialog.e-advancedFilterDlg:visible").length>0&&(this.element.find(".e-dialog.e-advancedFilterDlg").hide(),this.element.find("#preventDiv").remove())},this)),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode||this._on(this.element,"mouseover",".e-pvtBtn",t.proxy(function(t){var i=e(t.currentTarget).parents(".e-pivotclient").data("ejPivotClient");(i.isDragging||i._pivotSchemaDesigner._isDragging)&&e(t.target).siblings(".e-dropIndicator").addClass("e-dropIndicatorActive")},this)),this._on(this.element,"mouseleave",".e-pvtBtn",t.proxy(function(t){e(t.target).siblings(".e-dropIndicator").removeClass("e-dropIndicatorActive")},this)),this.element.find(".e-sortDisable, .e-sortEnable, .e-filterDisable, .e-filterEnable ").on(t.eventType.click,function(t){var i=e(this).parents(".e-pivotclient").data("ejPivotClient");"e-sortDisable"==t.target.className?(e(".measuresList_wrapper,.e-radioBtnAsc, .e-radioBtnDesc, .e-preserveHrchy").attr("disabled","disabled"),e(".e-measureListLbl, .e-orderLbl, .e-radioBtnAscLbl, .e-radioBtnDescLbl, .e-preserveHrchyLbl").addClass("e-sortFilterDisable"),i._dllSortMeasure.disable()):"e-sortEnable"==t.target.className?(e(".measuresList_wrapper,.e-radioBtnAsc, .e-radioBtnDesc, .e-preserveHrchy").removeAttr("disabled"),e(".e-measureListLbl, .e-orderLbl, .e-radioBtnAscLbl, .e-radioBtnDescLbl, .e-preserveHrchyLbl").removeClass("e-sortFilterDisable"),i._dllSortMeasure.enable()):"e-filterDisable"==t.target.className?(e(".filterFrom, .filterTo").attr("disabled","disabled"),e(".filterMeasureListLbl, .e-conditionLbl, .e-filterValueLbl, .e-filterBtw").addClass("e-sortFilterDisable"),i._dllFilterCondition.disable(),i._dllfMeasuresList.disable()):"e-filterEnable"==t.target.className&&(e(".filterFrom, .filterTo").removeAttr("disabled"),e(".filterMeasureListLbl, .e-conditionLbl, .e-filterValueLbl, .e-filterBtw").removeClass("e-sortFilterDisable"),i._dllFilterCondition.enable(),i._dllfMeasuresList.enable())}),this.element.find(".filterFrom , .filterTo").keypress(function(t){return 8==t.which||0==t.which||!(t.which<46||t.which>58)&&((46!=t.which||-1==e(this).val().indexOf("."))&&47!=t.which&&void 0)}),this.element.find(".e-toggleExpandButton").click(function(){var t=e(this).parents(".e-pivotclient").data("ejPivotClient");t._isCollapseCB=!0,t._collapseCubeBrowser()}),this.element.find(".e-toggleCollapseButton").click(function(){var i,l=e(this).parents(".e-pivotclient").data("ejPivotClient");l._isCollapseCB=!1,l.model.isResponsive?(l._rwdToggleExpand(),l.model.enableSplitter&&(l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l.element.find(".e-serversplitresponsive").data("ejSplitter").refresh():l.element.find(".e-splitresponsive").data("ejSplitter").refresh())):(i=l.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&l.model.analysisMode==t.Pivot.AnalysisMode.Olap,l._toggleExpand=!1,l._performToggleAction(l._initStyles),l.element.find(".e-csHeader, .e-cubeTable,.e-toggleExpandButton, .pivotFieldList").show(),l.element.find(".e-toggleCollapseButton").hide(),l.element.find(".e-toggleText").hide(),l.displayMode()!=t.PivotClient.DisplayMode.GridOnly||i?l.displayMode()==t.PivotClient.DisplayMode.GridOnly&&i?l.element.find(".e-gridContainer").width(l.element.find(".e-controlPanel").width()-2):l.displayMode()==t.PivotClient.DisplayMode.ChartOnly?l.element.find(".e-chartContainer").width(l.element.find(".e-controlPanel").width()-6):l.controlPlacement()==t.PivotClient.ControlPlacement.Tile?(l.defaultView(),t.PivotClient.DefaultView.Grid,l.element.find(".e-gridContainer").width(l.element.find(".e-controlPanel").width()-3),l.element.find(".e-chartContainer").width(l.element.find(".e-controlPanel").width()-8)):l.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&(l.defaultView(),t.PivotClient.DefaultView.Grid,l.element.find(".e-gridContainer").width(l.element.find(".e-controlPanel").width()-2),l.element.find(".e-chartContainer").width(l.element.find(".e-controlPanel").width()-7)):l.element.find(".e-gridContainer").width(l.element.find(".e-controlPanel").width()),l.model.enableToolBar&&(l.element.find("#"+this._id+"_PivotCharttoolBar").width(l.element.find(".e-chartContainer").width()),l.element.find("#"+this._id+"_PivotGridToolbar").width(l.element.find(".e-gridContainer").width()-10),l.element.find(".e-chartToolBar").width(l.element.find(".e-chartContainer").width()),l.element.find(".e-toolBar").width(l.element.find(".e-gridContainer").width())),l.model.enablePivotTreeMap&&l.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(l.chartObj=null,l.chartObj=l.element.find("#"+l._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(l.chartObj)&&!t.isNullOrUndefined(l.otreemapObj)&&(l.chartObj=l.element.find("#"+l.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),t.isNullOrUndefined(l.chartObj)||("treemap"==l.chartObj.sfType.split(".").pop().toLowerCase()?l.otreemapObj._treeMap.refresh():l.chartObj.redraw())))}),this._on(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this)),this.element.find(".maximizedView").click(function(){e(this).parents(".e-pivotclient").data("ejPivotClient")._maxViewBtnClick()}),e(document).on("click",".e-winCloseBtn",function(t){e("#"+e(t.target).attr("clientID")).data("ejPivotClient")._maxViewClsBtnClick()}),this.model.isResponsive&&e(window).on("resize",e.proxy(this._reSizeHandler,this)),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&this.model.enableSplitter){var l=this;this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l.element.find(".e-shadowbar").parent(".e-serverchildsplit").length>0||l.element.find(".e-serverparentsplit").mouseup(function(){l._splitterChartResizing(l)}):l.element.find(".e-shadowbar").parent(".e-childsplit").length>0||l.element.find(".e-parentsplit").mouseup(function(){l._splitterChartResizing(l)})}},_collapseCubeBrowser:function(){var e,i;if(this.model.isResponsive)this._rwdToggleCollapse();else{if(e=this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap,this._toggleExpand=!0,this._initToggle){this._initToggle=!1;var l={},a=e||this.controlPlacement()==t.PivotClient.ControlPlacement.Tile?0:23,r=(this.element.find(".e-cubeTable").width()||this.element.find(".pivotFieldList").width())+this.element.find(".e-controlPanel").width()-17;l.controlPanelWidth=this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?r-(this.model.collapseCubeBrowserByDefault&&e&&this.controlPlacement()==t.PivotClient.ControlPlacement.Tab?0:5)+a:r-(this.model.collapseCubeBrowserByDefault&&e&&this.controlPlacement()==t.PivotClient.ControlPlacement.Tab?0:3)+a,l.chartOuterWidth=l.chartModelWidth=l.gridOuterWidth=r-(this.defaultView()==t.PivotClient.DefaultView.Grid?24:-3),this._toggleStyles.push(l)}this.displayMode()!=t.PivotClient.DisplayMode.GridOnly||e?this.displayMode()==t.PivotClient.DisplayMode.GridOnly&&e?this.element.find(".e-gridContainer").width(this.element.width()-39):this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly||e?this.displayMode()==t.PivotClient.DisplayMode.ChartOnly&&e?this.element.find(".e-chartContainer").width(this.element.width()-50):this.controlPlacement()==t.PivotClient.ControlPlacement.Tile?this.defaultView()==t.PivotClient.DefaultView.Grid?(i=e?7:0,this.element.find(".e-gridContainer").width(this.element.width()-(33+i)),this.element.find(".e-chartContainer").width(this.element.width()-(38+i))):(this.element.find(".e-gridContainer").width(this.element.width()-33),this.element.find(".e-chartContainer").width(this.element.width()-38)):this.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&(e?(this.element.find(".e-gridContainer").width(this.element.width()-42),this.element.find(".e-chartContainer").width(this.element.width()-47)):this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(this.element.find(".e-gridContainer").width(this.element.width()-30),this.element.find(".e-chartContainer").width(this.element.width()-35)):(this.element.find(".e-gridContainer").width(this.element.width()-32),this.element.find(".e-chartContainer").width(this.element.width()-37))):this.element.find(".e-chartContainer").width(this.element.width()-36):this.element.find(".e-gridContainer").width(this.element.width()-30),this._performToggleAction(this._toggleStyles),this.element.find(".e-csHeader, .e-cubeTable,.e-toggleExpandButton, .pivotFieldList").hide(),this.element.find(".e-toggleCollapseButton").show(),this.element.find(".e-toggleText").show(),this.model.enablePivotTreeMap&&this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),t.isNullOrUndefined(this.chartObj)||("treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw()))}},_keyPressUp:function(e){if(93===e.keyCode&&!this.element.find(".e-dialog:visible").length>0&&this.element.find(".e-hoverCell:visible").length>0&&(e.preventDefault(),!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-text"))){var i={x:this.element.find(".e-hoverCell").offset().left+this.element.find(".e-hoverCell").outerWidth(),y:this.element.find(".e-hoverCell").offset().top+this.element.find(".e-hoverCell").outerHeight()};this.element.find(".e-hoverCell").trigger({type:"mouseup",which:3,clientX:i.x,clientY:i.y,pageX:i.x,pageY:i.y})}},_splitterChartResizing:function(t){var i,l;t.element.find(".e-shadowbar").length>0&&(i=t.element.find(".e-controlPanel").width(),t.element.find(".e-shadowbar").parents(".e-parentsplit")?(t.element.find(".e-shadowbar").parent(".e-parentsplit").length>0||t.element.find(".e-shadowbar").parent(".e-serverparentsplit").length>0)&&(l=t.model.enableRTL?i+(t.element.find(".e-shadowbar").offset().left-t.element.find(".e-split-divider").offset().left):i+(t.element.find(".e-controlPanel").offset().left-t.element.find(".e-shadowbar").offset().left)):l=i,e("#"+t._pivotChart._id+"Container").width(l-15),t.chartObj=null,t.chartObj=t.element.find("#"+t._pivotChart._id+"Container").data("ejChart"),t.chartObj.redraw())},_createSplitter:function(){this.model.isResponsive?this.model.isResponsive&&this.element.find(".e-splitresponsive, .e-serversplitresponsive").ejSplitter({cssClass:"customCSS",isResponsive:!0,height:this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+25):"",properties:[{expandable:!1,collapsible:!1,paneSize:"48%"},{enableAutoResize:!0,collapsible:!1}]}):(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.enableVirtualScrolling||this.element.find(".e-parentsplit, .e-serverparentsplit").ejSplitter({cssClass:"customCSS",isResponsive:!0,enableRTL:this.model.enableRTL,height:this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+5):this.element.find(".e-outerTable").height(),properties:[{expandable:!1,collapsible:!1,paneSize:"50%",maxSize:this.model.enablePaging?"400%":""},{enableAutoResize:!0,collapsible:!1,paneSize:"50%",minSize:this.model.enableRTL?225:""}],resize:function(){var i=this.element.find(".e-childsplit, .e-serverchildsplit").data("ejSplitter");pivotClientObj=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),i.option("properties",[{expandable:!1,collapsible:!1,enableAutoResize:!0,paneSize:"50%",enableRTL:this.model.enableRTL},{paneSize:"50%",collapsible:!1}]),pivotClientObj.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&pivotClientObj.element.find(".e-fieldTable").css("height",pivotClientObj.element.find(".outerTable").height()-13+"px"),pivotClientObj.model.enableRTL?(pivotClientObj.element.find(".e-childsplit.e-rtl > span.e-splitbar.e-h-bar").css("left","-5.5px"),pivotClientObj.element.find(".e-serverchildsplit.e-rtl > span.e-splitbar.e-h-bar").css("left","-2.5px")):(pivotClientObj.element.find(".e-childsplit > span.e-splitbar.e-h-bar").css("left","5.5px"),pivotClientObj.element.find(".e-splitresponsive > span.e-splitbar.e-h-bar").css("left","5.5px"))}}),this.element.find(".e-childsplit, .e-serverchildsplit").ejSplitter({cssClass:"customCSS",height:this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+(this.model.enableVirtualScrolling?25:15)):"",isResponsive:!0,enableRTL:this.model.enableRTL,properties:[{expandable:!1,collapsible:!1,enableAutoResize:!0,paneSize:"50%",enableRTL:this.model.enableRTL},{paneSize:"50%",collapsible:!1}]}),this.model.enableRTL&&(this.element.find(".e-serverparentsplit.e-rtl > span.e-splitbar.e-h-bar").css("left","-3.5px"),this.element.find(".e-serverchildsplit.e-rtl > span.e-splitbar.e-h-bar").css("left","-3.5px"))),"msie"==t.browserInfo().name&&("8.0"==t.browserInfo().version||"9.0"==t.browserInfo().version)&&this.element.find(".e-splitbar.e-h-bar").css("height","inherit"),this.model.enableRTL?this.element.find(".e-childsplit.e-rtl > span.e-splitbar.e-h-bar").css("left","-5.5px"):(this.element.find(".e-childsplit>span.e-splitbar.e-h-bar").css("left","5.5px"),this.element.find(".e-splitresponsive>span.e-splitbar.e-h-bar").css("left","5.5px"))},_keyPressDown:function(i){var l,a,r,o,s;if(t.isNullOrUndefined(this._curFocus.button)?t.isNullOrUndefined(this._curFocus.tab)||(l=this._curFocus.tab):l=this._curFocus.button,93===i.keyCode&&!t.isNullOrUndefined(l)&&!this.element.find(".e-dialog:visible").length>0&&this.element.find(".e-hoverCell:visible").length>0&&(i.preventDefault(),a={x:e(l).offset().left+e(l).outerWidth(),y:e(l).offset().top+e(l).outerHeight()},l.trigger({type:"mouseup",which:3,clientX:a.x,clientY:a.y,pageX:a.x,pageY:a.y})),(46===i.which||82===i.which&&i.ctrlKey)&&!this.element.find(".e-dialog:visible").length>0&&!t.isNullOrUndefined(l)?(i.preventDefault(),l.parent().find(".e-removeSplitBtn:visible").click()):(46===i.which||82===i.which&&i.ctrlKey&&(!t.isNullOrUndefined(this._curFocus.dialog)&&this._curFocus.dialog.hasClass("e-measureEditor")||!t.isNullOrUndefined(this._curFocus.editor)&&this._curFocus.editor.hasClass("e-measureEditor")))&&(t.isNullOrUndefined(this._curFocus.editor)?t.isNullOrUndefined(this._curFocus.dialog)||this._curFocus.dialog.find(".e-removeMeasure:visible").click():this._curFocus.editor.find(".e-removeMeasure:visible").click()),79==i.keyCode&&this.element.find(".e-dialog:visible").length>0&&i.ctrlKey&&(i.preventDefault(),!t.isNullOrUndefined(this._curFocus.icon)&&this._curFocus.icon.hasClass("e-mdxImg")?this.element.find(".e-dialogCancelBtn:visible").click():this.element.find(".e-dialogOKBtn:visible").click(),this._curFocus.dialog=null),70===i.which&&i.ctrlKey&&!t.isNullOrUndefined(l)&&l.click(),67==i.keyCode&&this.element.find(".e-dialog:visible").length>0&&"MDX Query"!=this.element.find(".e-dialog .e-titlebar").attr("data-tag")&&i.ctrlKey&&(i.preventDefault(),this.element.find(".e-dialogCancelBtn:visible").click(),this._curFocus.dialog=null),this.element.find(".e-dialog:visible").length>0&&27==i.keyCode?(t.isNullOrUndefined(this._curFocus.icon)?t.isNullOrUndefined(this._curFocus.editor)?t.isNullOrUndefined(this._curFocus.dialog)||this._curFocus.dialog.attr("tabindex","-1").addClass("e-hoverCell").focus().mouseover():this._curFocus.editor.attr("tabindex","-1").addClass("e-hoverCell").focus().mouseover():this._curFocus.icon.attr("tabindex","-1").addClass("e-hoverCell").focus().mouseover(),this._curFocus.dialog=null,this._index.editor=0):0==this.element.find(".e-dialog:visible").length&&27==i.keyCode&&0!=e(".e-fullScreenView").length?(this._maxViewClsBtnClick(),t.isNullOrUndefined(this._pivotGrid._curFocus.cell)?this._curFocus.tab.hasClass("e-icon")||this._curFocus.tab.focus().mouseover():this._pivotGrid._curFocus.cell.focus().mouseover()):this.element.find(".e-chartTypesDialog:visible").length>0&&27===i.which?(this.element.find(".e-chartTypesDialog").remove(),this._curFocus.chartimg=null):e(".pivotTree:visible,.pivotTreeContext:visible").length>0&&27===i.which&&(t.isNullOrUndefined(this._curFocus.tree)?t.isNullOrUndefined(l)||l.attr("tabindex","-1").focus().addClass("e-hoverCell"):this._curFocus.tree.attr("tabindex","-1").focus().addClass("e-hoverCell")),(9===i.which&&i.shiftKey||9===i.which)&&this.element.find(".e-dialog:visible").length>0?(i.preventDefault(),this._curFocus.editor=null,this.element.find(".e-dialog .e-hoverCell:visible").removeClass("e-hoverCell"),r=!t.isNullOrUndefined(this._dllSortMeasure)&&this._dllSortMeasure.model.enabled&&this.element.find("#measuresList_container:visible").length>0||!t.isNullOrUndefined(this._dllfMeasuresList)&&this._dllfMeasuresList.model.enabled&&this.element.find("#fMeasuresList_container:visible").length>0?this.element.find(".e-dialog .e-filterEnable:visible,#measuresList_container:visible,#fMeasuresList_container:visible,#filterCondition_container:visible,.e-dialog .filterFrom:visible:not([disabled='disabled']),.e-dialog .filterTo:visible:not([disabled='disabled']),.e-dialog .e-radioBtnAsc:visible:not([disabled='disabled']),.e-dialog .e-preserveHrchy:visible:not([disabled='disabled']),.e-dialog .e-dialogOKBtn:visible:not([aria-disabled='true']),.e-dialog .e-dialogCancelBtn:visible,.e-dialog .e-close:visible,.e-dialog .e-checkAll:visible,.e-dialog .e-unCheckAll:visible,.e-dialog .e-sortfiltTab .e-active:visible,.e-dialog .e-measureEditor:visible:first,.e-dialog .e-text:visible:first,.e-dialog .e-sortEnable:visible,.e-dialog .reportName:visible,#reportNameList_container:visible"):this.element.find(".e-dialog .e-filterEnable:visible,.e-dialog .filterFrom:visible:not([disabled='disabled']),.e-dialog .filterTo:visible:not([disabled='disabled']),.e-dialog .e-radioBtnAsc:visible:not([disabled='disabled']),.e-dialog .e-preserveHrchy:visible:not([disabled='disabled']),.e-dialog .e-dialogOKBtn:visible:not([aria-disabled='true']),.e-dialog .e-dialogCancelBtn:visible,.e-dialog .e-close:visible,.e-dialog .e-checkAll:visible,.e-dialog .e-unCheckAll:visible,.e-dialog .e-sortfiltTab .e-active:visible,.e-dialog .e-measureEditor:visible:first,.e-dialog .e-text:visible:first,.e-dialog .e-sortEnable:visible,.e-dialog .reportName:visible,#reportNameList_container:visible"),t.isNullOrUndefined(this._curFocus.dialog)?(this._index.dialog=r.length>4?4:2,this._curFocus.dialog=r.eq(this._index.dialog)):(this._curFocus.dialog.attr("tabindex","0").removeClass("e-hoverCell").mouseleave(),9===i.which&&i.shiftKey?this._index.dialog=this._index.dialog-1<0?r.length-1:this._index.dialog-1:9===i.which&&(this._index.dialog=this._index.dialog+1>r.length-1?0:this._index.dialog+1),this._curFocus.dialog=r.eq(this._index.dialog)),this._curFocus.dialog.hasClass("e-input")||"radio"==this._curFocus.dialog.attr("type")?this._curFocus.dialog.attr("tabindex","-1").focus():this._curFocus.dialog.attr("tabindex","-1").focus().addClass("e-hoverCell").mouseover):(9===i.which&&i.shiftKey||9===i.which)&&!e(".pivotTree:visible,.pivotTreeContext:visible").length>0&&(i.preventDefault(),this.element.find(".e-hoverCell").removeClass("e-hoverCell").mouseleave(),this.element.find(".e-node-focus").removeClass("e-node-focus"),this._index.button=1,this._index.icon=1,this._index.chartimg=0,this._index.tree=0,this._index.dialog=0,this._curFocus.button=null,this._curFocus.icon=null,this._curFocus.chartimg=null,this._curFocus.tree=null,this._curFocus.editor=null,this._curFocus.dialog=null,0!=e(".e-fullScreenView").length?e("[role='columnheader']:visible:not([p='0,0'])").first().length>0&&(r=e("[role='columnheader']:visible:not([p='0,0']):first")):r=this.element.find("[role='columnheader']:visible:not([p='0,0']):first,.e-schemaFieldTree .e-text:visible:first,.e-reportToolbar li:visible:first,#reportList_wrapper:visible,#cubeList_wrapper:visible,#cubeSelector_wrapper:visible, .e-cubeTreeView .e-text:visible:first,.e-categoricalAxis button:visible:first,.e-rowAxis button:visible:first,.e-slicerAxis button:visible:first,.e-schemaColumn button:visible:first,.schemaRow button:visible:first,.schemaFilter button:visible:first,.e-schemaValue button:visible:first,.e-toggleExpandButton:visible:first,.e-toggleCollapseButton:visible:first,#clientTab .e-active:visible"),t.isNullOrUndefined(this._curFocus.tab)?(this._index.tab=0,this._curFocus.tab=r.eq(this._index.tab).attr("tabindex","-1").focus().addClass("e-hoverCell").mouseover(),this._curFocus.tab.hasClass("e-button")&&this._curFocus.tab.parent().find(".e-removeSplitBtn:visible").addClass("e-hoverCell")):(this._curFocus.tab.attr("tabindex","0").removeClass("e-hoverCell").mouseleave(),9===i.which&&i.shiftKey?this._index.tab=this._index.tab-1<0?r.length-1:this._index.tab-1:9===i.which&&(this._index.tab=this._index.tab+1>r.length-1?0:this._index.tab+1),this._curFocus.tab=r.eq(this._index.tab).attr("tabindex","-1").focus().addClass("e-hoverCell").mouseover(),this._curFocus.tab.hasClass("e-button")&&this._curFocus.tab.parent().find(".e-removeSplitBtn:visible").addClass("e-hoverCell"))),this.element.find(".e-dialog:visible").length>0&&13==i.keyCode){if(0==e(i.target).parents(".e-pivotschemadesigner").length&&(e(i.target).hasClass("e-memberCurrentPage")||e(i.target).hasClass("e-memberCurrentSearchPage")||e(i.target).hasClass("e-memberCurrentDrillPage")))return void t.Pivot.editorTreeNavigatee(i,this);if(e(i.target).hasClass("searchEditorTreeView")&&0==e(i.target).parents(".e-pivotschemadesigner").length)return void t.Pivot._searchEditorTreeNodes(i,this);i.preventDefault(),t.isNullOrUndefined(this._curFocus.editor)?t.isNullOrUndefined(this._curFocus.dialog)?t.isNullOrUndefined(this._curFocus.icon)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","-1").focus().mouseover():this._curFocus.icon.attr("tabindex","-1").focus().mouseover():this._curFocus.dialog.hasClass("e-text")?this.element.find(".e-dialog .e-hoverCell").parent().find(".e-chkbox-small").click():(this._curFocus.dialog.click(),(this._curFocus.dialog.hasClass("e-dialogOKBtn")||this._curFocus.dialog.hasClass("e-dialogCancelBtn")||this._curFocus.dialog.hasClass("e-close"))&&(this._curFocus.dialog=null),this._index.editor=0):this._curFocus.editor.hasClass("e-text")&&this.element.find(".e-dialog .e-hoverCell").parent().find(".e-chkbox-small").click()}else 13!=i.keyCode||t.isNullOrUndefined(this._curFocus.tab)||"columnheader"==this._curFocus.tab.attr("role")||(i.preventDefault(),(!t.isNullOrUndefined(this._curFocus.icon)||!t.isNullOrUndefined(this._curFocus.tab)&&!e(".pivotTree:visible,.pivotTreeContext:visible").length>0&&this.element.find(".e-hoverCell:visible").length>0)&&this.element.find(".e-hoverCell:visible")[0].click(),t.isNullOrUndefined(this.element.find(".e-chartTypesDialog"))||t.isNullOrUndefined(this._curFocus.chartimg)||(this._curFocus.chartimg.click(),t.isNullOrUndefined(this._curFocus.icon)||this._curFocus.icon.attr("tabindex","-1").focus().mouseover(),this._index.chartimg=0,this._curFocus.chartimg=null));(39===i.which||37===i.which)&&this.element.find(".e-dialog:visible").length>0&&this.element.find(".e-dialog .e-text:visible").hasClass("e-hoverCell")?this.element.find(".e-dialog .e-hoverCell").parent().find(".e-plus,.e-minus").click():(39===i.which||37===i.which)&&this.element.find(".e-cubeTreeView .e-text:visible").hasClass("e-hoverCell")&&!this.element.find(".e-editorTreeView:visible").length>0?this.element.find(".e-cubeTreeView .e-hoverCell").parent().find(".e-plus,.e-minus").click():37!==i.which&&39!==i.which&&38!==i.which&&40!==i.which||!(this.element.find(".e-chartTypesDialog").length>0||this.element.find(".e-reportDBDialog").length>0)?(37===i.which||39===i.which)&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-icon")&&!this._curFocus.tab.hasClass("e-toggleCollapseButton")&&!this._curFocus.tab.hasClass("e-toggleExpandButton")&&!this.element.find(".e-dialog:visible").length>0&&(i.preventDefault(),this._curFocus.tab.removeClass("e-hoverCell").mouseleave(),s=this.element.find(".e-reportToolbar .e-icon:visible:not(.e-reportCol)"),t.isNullOrUndefined(this._curFocus.icon)?(this._index.icon=39==i.which?1:37==i.which?s.length-2:0,this._curFocus.icon=s.eq(this._index.icon).addClass("e-hoverCell").mouseover()):(this._curFocus.icon.removeClass("e-hoverCell").mouseleave(),39===i.which?this._index.icon=this._index.icon+1>s.length-2?0:this._index.icon+1:37===i.which&&(this._index.icon=this._index.icon-1<0?s.length-2:this._index.icon-1),this._curFocus.icon=s.eq(this._index.icon).addClass("e-hoverCell").mouseover())):(i.preventDefault(),(o=this.element.find(".e-chartTypesDialog").length>0?this.element.find(".e-chartTypesDialog"):this.element.find(".e-reportDBDialog")).tabindex=-1,o.focus(),s=o.find(".e-chartTypesIcon").length>0?o.find(".e-chartTypesIcon"):this.element.find(".e-reportDBIcon"),t.isNullOrUndefined(this._curFocus.chartimg)?(this._index.chartimg=39==i.which?0:37==i.which?s.length-1:0,this._curFocus.chartimg=s.eq(this._index.chartimg).addClass("e-hoverCell").mouseover()):(this._curFocus.chartimg.removeClass("e-hoverCell").mouseleave(),39===i.which?this._index.chartimg=this._index.chartimg+1>s.length-1?0:this._index.chartimg+1:37===i.which?this._index.chartimg=this._index.chartimg-1<0?s.length-1:this._index.chartimg-1:40===i.which&&o.find(".e-chartTypesIcon").length>0?this._index.chartimg=this._index.chartimg+5>s.length-1?(this._index.chartimg+5)%10:this._index.chartimg+5:38===i.which&&o.find(".e-chartTypesIcon").length>0&&(this._index.chartimg=this._index.chartimg-5<0?s.length-1:this._index.chartimg-5),this._curFocus.chartimg=s.eq(this._index.chartimg).addClass("e-hoverCell").mouseover())),(40===i.which||38===i.which)&&this.element.find(".e-dialog:visible").length>0&&!e(".pivotTree:visible,.pivotTreeContext:visible").length>0&&(this.element.find(".e-dialog .e-text").hasClass("e-hoverCell")||this.element.find(".e-dialog .e-measureEditor").hasClass("e-hoverCell"))?(i.preventDefault(),this.element.find(".e-dialog .e-hoverCell").removeClass("e-hoverCell"),this.element.find(".e-dialog .e-node-focus").removeClass("e-node-focus"),t.isNullOrUndefined(this._curFocus.dialog)||this._curFocus.dialog.mouseleave(),s=this.element.find(".e-dialog .e-measureEditor:visible,.e-dialog .e-text:visible"),t.isNullOrUndefined(this._curFocus.editor)?(this._index.editor=s.length>1?40==i.which?1:38==i.which?s.length-1:0:0,this._curFocus.editor=s.eq(this._index.editor).attr("tabindex","0").focus().addClass("e-hoverCell")):(this._curFocus.editor.attr("tabindex","0").removeClass("e-hoverCell"),40===i.which?this._index.editor=this._index.editor+1>s.length-1?0:this._index.editor+1:38===i.which&&(this._index.editor=this._index.editor-1<0?s.length-1:this._index.editor-1),this._curFocus.editor=s.eq(this._index.editor).attr("tabindex","0").focus().addClass("e-hoverCell"))):(40===i.which||38===i.which)&&!this.element.find(".e-dialog:visible").length>0&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-text")&&!e(".pivotTree:visible,.pivotTreeContext:visible").length>0&&t.isNullOrUndefined(this._schemaData)?(this.element.find(".e-hoverCell").removeClass("e-hoverCell"),this._curFocus.tab.mouseleave(),i.preventDefault(),s=this.element.find(".e-cubeTreeView .e-text:visible"),t.isNullOrUndefined(this._curFocus.tree)?(this._index.tree=40==i.which?1:38==i.which?s.length-1:0,this._curFocus.tree=s.eq(this._index.tree).attr("tabindex","-1").focus().addClass("e-hoverCell").mouseover(),this.element.find(".e-node-focus").removeClass("e-node-focus")):(this._curFocus.tree.attr("tabindex","0").removeClass("e-hoverCell").mouseleave(),40===i.which?this._index.tree=this._index.tree+1>s.length-1?0:this._index.tree+1:38===i.which&&(this._index.tree=this._index.tree-1<0?s.length-1:this._index.tree-1),this._curFocus.tree=s.eq(this._index.tree).attr("tabindex","-1").focus().addClass("e-hoverCell").mouseover(),this.element.find(".e-node-focus").removeClass("e-node-focus"))):(40===i.which||38===i.which)&&!t.isNullOrUndefined(this._curFocus.tab)&&this._curFocus.tab.hasClass("e-button")&&!e(".pivotTree:visible,.pivotTreeContext:visible").length>0&&!this.element.find(".e-dialog:visible").length>0&&t.isNullOrUndefined(this._schemaData)&&(i.preventDefault(),s=null,(this._curFocus.tab.parent().parent().hasClass("e-categoricalAxis")||this._curFocus.tab.parent().parent().hasClass("e-rowAxis")||this._curFocus.tab.parent().parent().hasClass("e-slicerAxis"))&&(this._curFocus.tab.parent().parent().hasClass("e-categoricalAxis")?s=this.element.find(".e-categoricalAxis button"):this._curFocus.tab.parent().parent().hasClass("e-rowAxis")?s=this.element.find(".e-rowAxis button"):this._curFocus.tab.parent().parent().hasClass("e-slicerAxis")&&(s=this.element.find(".e-slicerAxis button")),t.isNullOrUndefined(this._curFocus.tab)||(this._curFocus.tab.removeClass("e-hoverCell").attr("tabindex","0").mouseleave(),this._curFocus.tab.parent().find(".e-removeSplitBtn:visible").focus().removeClass("e-hoverCell")),t.isNullOrUndefined(this._curFocus.button)?(this._index.button=40==i.which?s.length>1?1:0:38==i.which?s.length-1:0,this._curFocus.button=s.eq(this._index.button).attr("tabindex","0").focus().addClass("e-hoverCell"),this._curFocus.button.parent().find(".e-removeSplitBtn:visible").addClass("e-hoverCell")):(this._curFocus.button.attr("tabindex","0").removeClass("e-hoverCell"),this._curFocus.button.parent().find(".e-removeSplitBtn:visible").removeClass("e-hoverCell"),40===i.which?this._index.button=this._index.button+1>s.length-1?0:this._index.button+1:38===i.which&&(this._index.button=this._index.button-1<0?s.length-1:this._index.button-1),this._curFocus.button=s.eq(this._index.button).attr("tabindex","0").focus().addClass("e-hoverCell"),this._curFocus.button.parent().find(".e-removeSplitBtn:visible").addClass("e-hoverCell"))))},_wireMeasureRemoveEvent:function(){this.element.find(".e-removeMeasure").click(function(t){e(this).parents(".e-pivotclient").data("ejPivotClient")._isMembersFiltered=!0,e(e(t.target).parent()).remove()})},_wireEditorRemoveEvent:function(){this.element.find(".e-removeSplitBtn").click(function(i){var l,a,r=e(i.target).parents(".e-pivotclient").data("ejPivotClient");this._isTimeOut=!0,setTimeout(function(){r._isTimeOut&&r._waitingPopup.show()},800),e(e(i.target).parent()).remove(),0!=r._currentReportItems.length&&r._treeViewData.hasOwnProperty(e(i.target).parent().find("button").attr("title"))&&(delete r._treeViewData[e(i.target).parent().find("button").attr("title")],r._currentReportItems.splice(e.inArray(e(i.target).parent().find("button").attr("title"),r._currentReportItems),1)),r._off(this.element,"click",".e-removeSplitBtn"),r.model.enableAdvancedFilter&&r.model.analysisMode==t.Pivot.AnalysisMode.Olap&&r.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(l=e(e(i.target)).parent("div:eq(0)").attr("data-tag").split(":")[1].split("."),t.isNullOrUndefined(l)||2!=l.length||(r._setUniqueNameFrmBtnTag(l),r._removeFilterTag(r._selectedFieldName))),null!=r.model.beforeServiceInvoke&&r._trigger("beforeServiceInvoke",{action:"removeSplitButton",element:this.element,customObject:r.model.customObject}),a=JSON.stringify(r.model.customObject),delete r._fieldSelectedMembers[e(i.target).parent().find("button").attr("title")],r.doAjaxPost("POST",r.model.url+"/"+r.model.serviceMethodSettings.removeSplitButton,JSON.stringify({action:"removeSplitButton",clientParams:e(i.target).parent().attr("data-tag"),olapReport:r.currentReport,clientReports:r.reports,customObject:a}),r._removeSplitButtonSuccess),r._isNodeOrButtonDropped=!0})},_setUniqueNameFrmBtnTag:function(t){var i,l;if(t.length>0)if((i=this.element.find(".e-cubeTreeView li[data-tag^='["+t[0]+"'][data-tag$='"+t[1]+"]']")).length>0){for(l=0;l<i.length;l++)if(2==e(i[l]).attr("data-tag").split("].").length){this._selectedFieldName=e(i[l]).attr("data-tag");break}}else this._selectedFieldName=i.attr("data-tag")},_getExportModel:function(){var i,l,a,r,o,s,n,d=this,h="clientMode",c=t.isNullOrUndefined(d._pivotGrid)?0:null!=d._pivotGrid._excelLikeJSONRecords?d._pivotGrid._excelRowCount:d._pivotGrid._rowCount,p=t.isNullOrUndefined(d._pivotGrid)?0:null!=d._pivotGrid._excelLikeJSONRecords?Math.floor(d._pivotGrid._excelLikeJSONRecords.length/d._pivotGrid._excelRowCount):null!=d._pivotGrid.getJSONRecords()?Math.floor(d._pivotGrid.getJSONRecords().length/d._pivotGrid._rowCount):0,u=(d.element.find(".reportlist").data("ejDropDownList").getSelectedValue(),{}),m="PivotClient",g=t.PivotClient.ExportMode.JSON,f="",b="",_=!0,v="xls",C=!0,S=!1;if(d.model.displaySettings.mode!=t.PivotClient.DisplayMode.GridOnly&&d.model.clientExportMode!=t.PivotClient.ClientExportMode.GridOnly&&(d.chartObj=null,l=[],a=!1,d.chartObj=d.element.find("#"+d._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(d.chartObj)&&!t.isNullOrUndefined(d.otreemapObj)&&(d.chartObj=d.element.find("#"+d.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),"treemap"!=d.chartObj.sfType.split(".").pop().toLowerCase()&&(r=d.chartObj.model.primaryXAxis.zoomFactor,d.chartObj.model.primaryXAxis.zoomFactor=1,d.chartObj.model.enableCanvasRendering=!0,o=e.extend(!0,[],d.chartObj.model.series),a&&(d.chartObj.model.series=l),d.chartObj.redraw(),s=d.chartObj.export(),chartString=s.toDataURL("image/png"),d.chartObj.model.primaryXAxis.zoomFactor=r,d.chartObj.model.enableCanvasRendering=!1,a&&(d.chartObj.model.series=o),d.chartObj.redraw())),d._isExporting=!1,d.model.displaySettings.mode!=t.PivotClient.DisplayMode.ChartOnly&&d.model.clientExportMode!=t.PivotClient.ClientExportMode.ChartOnly&&{valueCellColor:d._pivotGrid.element.find(".value").css("color"),valueCellBGColor:d._pivotGrid.element.find(".value").css("background-color"),summaryCellColor:d._pivotGrid.element.find(".summary").css("color"),summaryCellBGColor:d._pivotGrid.element.find(".summary").css("background-color")},d.model.displaySettings.mode==t.PivotClient.DisplayMode.GridOnly||d.model.clientExportMode==t.PivotClient.ClientExportMode.GridOnly)mode=t.PivotClient.ClientExportMode.GridOnly,(d.model.operationalMode==t.Pivot.OperationalMode.ClientMode||null!=d._pivotGrid&&null!=d._pivotGrid._excelLikeJSONRecords&&g==t.PivotClient.ExportMode.JSON||g==t.PivotClient.ExportMode.JSON)&&(i={args:JSON.stringify({exportMode:mode,exportOption:h,fileFormat:v+(g!=t.PivotClient.ExportMode.JSON||".xls"!=v&&".xlsx"!=v?"":"~"+S),pGridData:null!=d._pivotGrid.exportRecords&&""!=d._pivotGrid.exportRecords?d._pivotGrid.exportRecords:null,rowCount:c,columnCount:p,fileName:m,customObject:JSON.stringify(d._pivotGrid.model.customObject),title:f,description:b,completeDataExport:d.model.enableCompleteDataExport,exportWithStyle:C,multiControlExport:!0})});else{if(d.model.displaySettings.mode!=t.PivotClient.DisplayMode.ChartOnly&&d.model.clientExportMode!=t.PivotClient.ClientExportMode.ChartOnly)return mode=t.PivotClient.ClientExportMode.ChartAndGrid,(d.model.operationalMode==t.Pivot.OperationalMode.ClientMode||null!=d._pivotGrid._excelLikeJSONRecords&&g==t.PivotClient.ExportMode.JSON||g==t.PivotClient.ExportMode.JSON)&&(n={exportMode:mode,exportOption:h,fileFormat:v+(g!=t.PivotClient.ExportMode.JSON||".xls"!=v&&".xlsx"!=v?"":"~"+S),pGridData:null!=d._pivotGrid.exportRecords&&""!=d._pivotGrid.exportRecords?d._pivotGrid.exportRecords:null,rowCount:c,columnCount:p,fileName:m,customObject:JSON.stringify(d._pivotGrid.model.customObject),chartdata:chartString.split(",")[1],bgColor:e(d._pivotChart.element).css("background-color"),title:f,description:b,completeDataExport:d.model.enableCompleteDataExport,exportWithStyle:C,multiControlExport:!0},t.isNullOrUndefined(_)||_||(n.chartModel=u),i={args:JSON.stringify(n)}),i;mode=t.PivotClient.ClientExportMode.ChartOnly,(d.model.operationalMode==t.Pivot.OperationalMode.ClientMode||null!=d._pivotGrid&&null!=d._pivotGrid._excelLikeJSONRecords&&g==t.PivotClient.ExportMode.JSON||g==t.PivotClient.ExportMode.JSON)&&(n={exportMode:mode,exportOption:h,fileFormat:v,fileName:m,chartdata:chartString.split(",")[1],bgColor:e(d._pivotChart.element).css("background-color"),title:f,description:b},t.isNullOrUndefined(_)||_||(n.chartModel=u),i={args:JSON.stringify(n)})}},_wireDialogEvent:function(){this.element.find(".e-newReportImg, .e-addReportImg, .e-removeReportImg, .e-renameReportImg, .e-pvtBtn, .e-mdxImg,.e-colSortFilterImg, .e-rowSortFilterImg, .e-autoExecuteImg").on(t.eventType.click,function(i){var l=e(this).parents(".e-pivotclient").data("ejPivotClient");if(i.currentTarget.parentElement.className.indexOf("e-splitBtn")>-1){if(e(e(i.currentTarget).parents(".e-splitBtn")[0]).attr("data-tag").indexOf("NAMEDSET")>-1)return!1;l._currentAxis=e(e(i.currentTarget).parents(".e-splitBtn")[0]).attr("data-tag").split(":")[0]}i.preventDefault(),i.target.innerHTML!=l._getLocalizedLabels("Cancel")&&i.target.innerHTML!=l._getLocalizedLabels("OK")&&i.target.parentElement.innerHTML!=l._getLocalizedLabels("Cancel")&&i.target.parentElement.innerHTML!=l._getLocalizedLabels("OK")&&(l._off(l.element,"click",".e-newReportImg, .e-addReportImg, .e-removeReportImg, .e-renameReportImg, .e-mdxImg, .e-txt,.e-colSortFilterImg, .e-rowSortFilterImg, .e-chartTypesImg, .e-autoExecuteImg"),i.target.className.indexOf("e-colSortFilterImg")>=0||i.target.className.indexOf("e-rowSortFilterImg")>=0?(l._sortOrFilterTab=i.target.className.indexOf("SortImg")>=0?"sort":"filter",i.target.className.indexOf("e-colSortFilterImg")>=0||i.target.className.indexOf("e-rowSortFilterImg")>=0||""!=l.element.find(".e-rowAxis").html()||""!=l.element.find(".e-categoricalAxis").html()||(l._isTimeOut=!0,setTimeout(function(){l._isTimeOut&&l._waitingPopup.show()},800)),l._isSorted=!1,l._isFiltered=!1,l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"FetchSortState",toolbarOperation:null,clientInfo:l._axis=i.target.className.indexOf("e-colSortFilterImg")>=0?"Column":"Row",olapReport:l.currentReport,clientReports:"",customObject:JSON.stringify(l.model.customObject)}),l._fetchSortState)):i.target.className.indexOf("mdx")>=0?l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.operationalMode==t.Pivot.OperationalMode.ClientMode?l._mdxQuery(t.olap.base._getParsedMDX(l.model.dataSource,l.model.dataSource.cube)):l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.mdxQuery,JSON.stringify({olapReport:l.currentReport,customObject:JSON.stringify(l.model.customObject)}),l._mdxQuery):i.target.className.indexOf("autoExecute")>=0?(l.model.enableDeferUpdate=!1,l._renderControls(),l._deferReport=l.currentReport,l.model.enableDeferUpdate=!0):(l.model.operationalMode!=t.Pivot.OperationalMode.ServerMode||l.model.analysisMode!=t.Pivot.AnalysisMode.Olap)&&e(i.currentTarget).hasClass("e-pvtBtn")||l._createDialogRequest(i),l._dimensionName=e(i.currentTarget).parent().attr("data-tag")),l.isDropped=!1}),this.element.find(".e-excelExportImg, .e-wordExportImg, .e-pdfExportImg").click(function(i){var l,a,r,o,s,n,d,h,c,p,u,m,g,f=e(this).parents(".e-pivotclient").data("ejPivotClient");if(f.model.displaySettings.mode==f.model.clientExportMode||f.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartAndGrid||f.model.clientExportMode==t.PivotClient.ClientExportMode.ChartAndGrid){"msie"==t.browserInfo().name&&t.browserInfo().version<=8&&(f.model.clientExportMode=t.PivotClient.ClientExportMode.GridOnly);var b,_=i.target.className.indexOf("e-excel")>=0?"Excel":i.target.className.indexOf("e-word")>=0?"Word":"Pdf",v="Excel"==_?f.model.operationalMode==t.Pivot.OperationalMode.ServerMode?".xls":".xlsx":"Word"==_?".docx":".pdf",C=t.isNullOrUndefined(f._pivotGrid)?0:null!=f._pivotGrid._excelLikeJSONRecords?f._pivotGrid._excelRowCount:t.isNullOrUndefined(f._pivotGrid._rowLength)?f._pivotGrid._rowCount:f._pivotGrid._rowLength,S=t.isNullOrUndefined(f._pivotGrid)?0:(null!=f._pivotGrid._excelLikeJSONRecords?Math.floor(f._pivotGrid._excelLikeJSONRecords.length/f._pivotGrid._excelRowCount):null==f._pivotGrid.exportRecords||t.isNullOrUndefined(f._pivotGrid._rowLength)?!t.isNullOrUndefined(f._pivotGrid.getJSONRecords()):Math.floor(f._pivotGrid.exportRecords.length/f._pivotGrid._rowLength))?Math.floor(f._pivotGrid.getJSONRecords().length/f._pivotGrid._rowCount):0,O=f.element.find(".reportlist").data("ejDropDownList").getSelectedValue(),T={};b="Excel"==_?{url:"",fileName:"PivotClient",exportMode:t.PivotClient.ExportMode.JSON,title:null!=O&&""!=O?O:"",description:"",exportChartAsImage:!0,fileFormat:v,exportWithStyle:!0,exportValueAsNumber:!1}:{url:"",fileName:"PivotClient",exportMode:t.PivotClient.ExportMode.JSON,title:null!=O&&""!=O?O:"",description:"",fileFormat:v,exportWithStyle:!0},f._trigger("beforeExport",b),l=f.model.enableCompleteDataExport&&(f.model.enablePaging||f.model.enableVirtualScrolling),f._isExporting=!0,l&&f.model.analysisMode==t.Pivot.AnalysisMode.Olap&&f.model.displaySettings.mode!=t.PivotClient.DisplayMode.ChartOnly&&f.model.clientExportMode!=t.PivotClient.ClientExportMode.ChartOnly&&b.exportMode==t.PivotClient.ExportMode.JSON&&(f.model.operationalMode==t.Pivot.OperationalMode.ClientMode?(a={paging:f.model.enablePaging,virualScrolling:f.model.enableVirtualScrolling},f.model.enablePaging=f.model.enableVirtualScrolling=!1,t.olap.base.getJSONData({action:"loadFieldElements"},f.model.dataSource,f),f.model.enablePaging=a.paging,f.model.enableVirtualScrolling=a.virualScrolling):f.doAjaxPost("POST",f.model.url+"/"+f._pivotGrid.model.serviceMethodSettings.initialize,JSON.stringify({action:"export",currentReport:f._pivotGrid.model.currentReport}),function(e){f._fullExportedData.jsonObj=t.isNullOrUndefined(e[0])?t.isNullOrUndefined(e.d)?JSON.parse(e.JsonRecords):JSON.parse(e.d[0]):JSON.parse(e[0]),f._fullExportedData.rowCount=t.isNullOrUndefined(e[1])?t.isNullOrUndefined(e.d)?JSON.parse(e.RowCount):JSON.parse(e.d[1]):JSON.parse(e[1])}),f._pivotGrid.exportRecords=f._fullExportedData.jsonObj,C=f._fullExportedData.rowCount,S=Math.floor(f._fullExportedData.jsonObj.length/C)),f.model.displaySettings.mode!=t.PivotClient.DisplayMode.GridOnly&&f.model.clientExportMode!=t.PivotClient.ClientExportMode.GridOnly&&(f.chartObj=null,n=[],d=l&&f.model.analysisMode==t.Pivot.AnalysisMode.Olap,f.chartObj=f.element.find("#"+f._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(f.chartObj)&&!t.isNullOrUndefined(f.otreemapObj)&&(f.chartObj=f.element.find("#"+f.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),"treemap"!=f.chartObj.sfType.split(".").pop().toLowerCase()&&(d&&(f.model.operationalMode==t.Pivot.OperationalMode.ServerMode?f.doAjaxPost("POST",f.model.url+"/"+f.chartObj.model.serviceMethodSettings.initialize,JSON.stringify({action:"export",currentReport:f._pivotChart.model.currentReport}),function(e){n=f._pivotChart._getChartSeries(t.isNullOrUndefined(e[0])?t.isNullOrUndefined(e.d)?JSON.parse(e.JsonRecords):JSON.parse(e.d):JSON.parse(e[0]))}):n=f._pivotChart._generateData(f._fullExportedData.tranposeEngine)),h=f.chartObj.model.primaryXAxis.zoomFactor,f.chartObj.model.primaryXAxis.zoomFactor=1,f.chartObj.model.enableCanvasRendering=!0,c=e.extend(!0,[],f.chartObj.model.series),d&&(f.chartObj.model.series=n),f.chartObj.redraw(),o=f.chartObj.export().toDataURL("image/png"),f.chartObj.model.primaryXAxis.zoomFactor=h,f.chartObj.model.enableCanvasRendering=!1,d&&(f.chartObj.model.series=c),f.chartObj.redraw())),"Excel"!=_||b.exportChartAsImage||f.model.displaySettings.mode==t.PivotClient.DisplayMode.GridOnly||f.model.clientExportMode==t.PivotClient.ClientExportMode.GridOnly||(T=(T=f._pivotChart._excelExport(f.chartObj)).replace(new RegExp("<br/>","g"),"")),f._isExporting=!1,f.model.displaySettings.mode!=t.PivotClient.DisplayMode.ChartOnly&&f.model.clientExportMode!=t.PivotClient.ClientExportMode.ChartOnly&&(p={valueCellColor:f._pivotGrid.element.find(".value").css("color"),valueCellBGColor:f._pivotGrid.element.find(".value").css("background-color"),summaryCellColor:f._pivotGrid.element.find(".summary").css("color"),summaryCellBGColor:f._pivotGrid.element.find(".summary").css("background-color")}),f.model.displaySettings.mode==t.PivotClient.DisplayMode.GridOnly||f.model.clientExportMode==t.PivotClient.ClientExportMode.GridOnly?(s=t.PivotClient.ClientExportMode.GridOnly,r=f.model.operationalMode==t.Pivot.OperationalMode.ClientMode||null!=f._pivotGrid&&null!=f._pivotGrid._excelLikeJSONRecords&&b.exportMode==t.PivotClient.ExportMode.JSON||""!=e.trim(b.url)&&b.exportMode==t.PivotClient.ExportMode.JSON?{args:JSON.stringify({exportMode:s,exportOption:_,fileFormat:b.fileFormat+(b.exportMode!=t.PivotClient.ExportMode.JSON||".xls"!=b.fileFormat&&".xlsx"!=b.fileFormat?"":"~"+b.exportValueAsNumber),pGridData:null!=f._pivotGrid.exportRecords&&""!=f._pivotGrid.exportRecords?f._pivotGrid.exportRecords:null,rowCount:C,columnCount:S,fileName:b.fileName,customObject:JSON.stringify(f._pivotGrid.model.customObject),title:b.title,description:b.description,completeDataExport:f.model.enableCompleteDataExport,exportWithStyle:b.exportWithStyle,formatting:!t.isNullOrUndefined(f._pivotGrid)&&f._pivotGrid.model.enableConditionalFormatting?f._pivotGrid._cFormat:b.exportMode==t.PivotClient.ExportMode.JSON?[]:""})}:{args:JSON.stringify({exportMode:s,exportOption:_,fileFormat:b.fileFormat,currentReport:f.model.enableDeferUpdate?f._deferReport:f.currentReport,layout:f.gridLayout(),colorSettings:JSON.stringify(p),title:b.title,description:b.description,completeDataExport:f.model.enableCompleteDataExport,exportWithStyle:b.exportWithStyle,formatting:!t.isNullOrUndefined(f._pivotGrid)&&f._pivotGrid.model.enableConditionalFormatting?f._pivotGrid._cFormat:b.exportMode==t.PivotClient.ExportMode.JSON?[]:""})}):f.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartOnly||f.model.clientExportMode==t.PivotClient.ClientExportMode.ChartOnly?(s=t.PivotClient.ClientExportMode.ChartOnly,f.model.operationalMode==t.Pivot.OperationalMode.ClientMode||null!=f._pivotGrid&&null!=f._pivotGrid._excelLikeJSONRecords&&b.exportMode==t.PivotClient.ExportMode.JSON||""!=e.trim(b.url)&&b.exportMode==t.PivotClient.ExportMode.JSON?(u={exportMode:s,exportOption:_,fileFormat:b.fileFormat,fileName:b.fileName,chartdata:o.split(",")[1],bgColor:e(f._pivotChart.element).css("background-color"),title:b.title,description:b.description},t.isNullOrUndefined(b.exportChartAsImage)||b.exportChartAsImage||(u.chartModel=T),r={args:JSON.stringify(u)}):(u={exportMode:s,exportOption:_,fileFormat:b.fileFormat,currentReport:f.model.enableDeferUpdate?f._deferReport:f.currentReport,chartdata:o.split(",")[1],legenddata:"",bgColor:e(f._pivotChart.element).css("background-color"),title:b.title,description:b.description},t.isNullOrUndefined(b.exportChartAsImage)||b.exportChartAsImage||(u.chartModel=T),r={args:JSON.stringify(u)})):(s=t.PivotClient.ClientExportMode.ChartAndGrid,f.model.operationalMode==t.Pivot.OperationalMode.ClientMode||null!=f._pivotGrid._excelLikeJSONRecords&&b.exportMode==t.PivotClient.ExportMode.JSON||""!=e.trim(b.url)&&b.exportMode==t.PivotClient.ExportMode.JSON?(u={exportMode:s,exportOption:_,fileFormat:b.fileFormat+(b.exportMode!=t.PivotClient.ExportMode.JSON||".xls"!=b.fileFormat&&".xlsx"!=b.fileFormat?"":"~"+b.exportValueAsNumber),pGridData:null!=f._pivotGrid.exportRecords&&""!=f._pivotGrid.exportRecords?f._pivotGrid.exportRecords:null,rowCount:C,columnCount:S,fileName:b.fileName,customObject:JSON.stringify(f._pivotGrid.model.customObject),chartdata:o.split(",")[1],bgColor:e(f._pivotChart.element).css("background-color"),title:b.title,description:b.description,completeDataExport:f.model.enableCompleteDataExport,exportWithStyle:b.exportWithStyle,formatting:!t.isNullOrUndefined(f._pivotGrid)&&f._pivotGrid.model.enableConditionalFormatting?f._pivotGrid._cFormat:b.exportMode==t.PivotClient.ExportMode.JSON?[]:""},t.isNullOrUndefined(b.exportChartAsImage)||b.exportChartAsImage||(u.chartModel=T),r={args:JSON.stringify(u)}):(u={exportMode:s,exportOption:_,fileFormat:b.fileFormat,currentReport:f.model.enableDeferUpdate?f._deferReport:f.currentReport,layout:f.gridLayout(),colorSettings:JSON.stringify(p),chartdata:o.split(",")[1],legenddata:"",bgColor:e(f._pivotChart.element).css("background-color"),title:b.title,description:b.description,completeDataExport:f.model.enableCompleteDataExport,exportWithStyle:b.exportWithStyle,formatting:!t.isNullOrUndefined(f._pivotGrid)&&f._pivotGrid.model.enableConditionalFormatting?f._pivotGrid._cFormat:b.exportMode==t.PivotClient.ExportMode.JSON?[]:""},t.isNullOrUndefined(b.exportChartAsImage)||b.exportChartAsImage||(u.chartModel=T),r={args:JSON.stringify(u)})),t.raiseWebFormsServerEvents&&""!=e.trim(b.url)&&"pivotClientExport"==b.url&&b.exportMode==t.PivotClient.ExportMode.JSON?(m={model:f.model,originalEventType:b.url},g=r,t.raiseWebFormsServerEvents(b.url,m,g),setTimeout(function(){t.isOnWebForms=!0},1e3)):f.doPostBack(""!=e.trim(b.url)?b.url:f.model.url+"/"+f.model.serviceMethodSettings.exportPivotClient,r)}}),this.element.find(".e-toggleaxisImg").click(function(){var i,l=e(this).parents(".e-pivotclient").data("ejPivotClient");l._isTimeOut=!0,l.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(l.chartObj=null,l.chartObj=l.element.find("#"+l._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(l.chartObj)&&!t.isNullOrUndefined(l.otreemapObj)&&(l.chartObj=l.element.find("#"+l.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),l.model.operationalMode==t.Pivot.OperationalMode.ClientMode?(setTimeout(function(){l._isTimeOut&&l._waitingPopup.show()},800),i=l.model.dataSource.rows,l.model.dataSource.rows=l.model.dataSource.columns,l.model.dataSource.columns=i,l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&l.model.dataSource.values.length>0&&(l.model.dataSource.values[0].axis="rows"==l.model.dataSource.values[0].axis?"columns":"columns"==l.model.dataSource.values[0].axis?"rows":"columns"),l.model.analysisMode==t.Pivot.AnalysisMode.Olap&&t.olap.base.clearDrilledItems(l.model.dataSource,{action:"nodeDropped"},l),l.refreshControl()):l.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(l._waitingPopup&&l._waitingPopup.show(),l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"toggleAxis",args:JSON.stringify({currentReport:JSON.parse(l.getOlapReport()).Report,sortedHeaders:t.isNullOrUndefined(l._ascdes)?"":l._ascdes}),customObject:JSON.stringify(l.model.customObject)}),l._toggleAxisSuccess)):(""!=l.element.find(".e-rowAxis").html()||""!=l.element.find(".e-categoricalAxis").html())&&(l._waitingPopup&&l._waitingPopup.show(),l.doAjaxPost("POST",l.model.url+"/"+l.model.serviceMethodSettings.toggleAxis,JSON.stringify({action:"toggleAxis",currentReport:l.currentReport,clientReports:l.reports,customObject:JSON.stringify(l.model.customObject)}),l._toggleAxisSuccess)),t.isNullOrUndefined(l.chartObj)||l.chartObj.redraw()}),this.element.find(".e-reportDBImg").click(function(){var i=e(this).parents(".e-pivotclient").data("ejPivotClient"),l=t.buildTag("div.e-reportDBDialog#reportDBDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-saveReportImg e-reportDBIcon").attr({title:i._getLocalizedLabels("Save"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-saveAsReportImg e-reportDBIcon").attr({title:i._getLocalizedLabels("SaveAs"),tabindex:0})[0].outerHTML)[0].outerHTML+(i.model.showReportCollection?"":t.buildTag("td",t.buildTag("div.e-loadReportImg e-reportDBIcon").attr({title:i._getLocalizedLabels("Load"),tabindex:0})[0].outerHTML)[0].outerHTML)+t.buildTag("td",t.buildTag("div.e-removeDBReportImg e-reportDBIcon").attr({title:i._getLocalizedLabels("Remove"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-renameDBReportImg e-reportDBIcon").attr({title:i._getLocalizedLabels("Rename"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML);0==i.element.find("div.e-reportDBDialog").length&&(e(l).appendTo(i.element),e(l).css("left",this.offsetLeft+20+"px").css("top",this.offsetTop+20+"px")),i.element.find(".e-reportDBIcon").click(function(a){var r,o,s,n,d;if(e(l).remove(),(i=i)._off(i.element,"click",".e-reportDBIcon"),a.target.className.indexOf("e-loadReportImg")>=0||a.target.className.indexOf("e-removeDBReportImg")>=0||a.target.className.indexOf("e-renameDBReportImg")>=0)r=a.target.className.indexOf("e-loadReportImg")>=0?"LoadReport":a.target.className.indexOf("e-removeDBReportImg")>=0?"RemoveDBReport":"RenameDBReport",i._isTimeOut=!0,setTimeout(function(){i._isTimeOut&&i._waitingPopup.show()},800),"servermode"==i.model.operationalMode?(null!=i.model.beforeServiceInvoke&&i._trigger("beforeServiceInvoke",{action:"FetchingReportList",element:i.element,customObject:i.model.customObject}),d=JSON.stringify(i.model.customObject),i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.fetchReportList,JSON.stringify({customObject:d,action:r,operationalMode:i.model.operationalMode,analysisMode:i.model.analysisMode}),i._fetchReportListSuccess)):(o={url:"",reportCollection:i._clientReportCollection,reportList:"",mode:i.model.analysisMode},i._trigger("fetchReport",{targetControl:i,fetchReportSetting:o}),i.model.enableLocalStorage?i._fetchReportListSuccess({d:[{Name:"ReportNameList",Value:o.reportList},{Name:"Action",Value:r}]}):(d=JSON.stringify(i.model.customObject),i.doAjaxPost("POST",o.url+"/"+i.model.serviceMethodSettings.fetchReportList,JSON.stringify({customObject:d,action:r,operationalMode:i.model.operationalMode,analysisMode:i.model.analysisMode}),i._fetchReportListSuccess)));else if(a.target.className.indexOf("e-saveReportImg")>=0){if(""==i._currentRecordName)return i._createDialogRequest(a),!1;i._isTimeOut=!0,setTimeout(function(){i._isTimeOut&&i._waitingPopup.show()},800),i.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(s=i._updateReportCollection(!0)),i.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(null!=i.model.beforeServiceInvoke&&i._trigger("beforeServiceInvoke",{action:"saveReport",element:this.element,customObject:i.model.customObject}),d=JSON.stringify(i.model.customObject),i.doAjaxPost("POST",i.model.url+"/"+i.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:i._currentRecordName,operationalMode:i.model.operationalMode,analysisMode:i.model.analysisMode,olapReport:i.currentReport,clientReports:"pivot"==i.model.analysisMode?JSON.stringify(i._clientReportCollection):t.isNullOrUndefined(s)?i.reports:s,customObject:d}),i._toolbarOperationSuccess)):(n={url:"",reportName:i._currentRecordName,reportCollection:i._clientReportCollection,mode:i.model.analysisMode,filterCollection:i._currentReportItems},i._trigger("saveReport",{targetControl:i,saveReportSetting:n}),i.model.enableLocalStorage||(d=JSON.stringify(i.model.customObject),i.doAjaxPost("POST",n.url+"/"+i.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:n.reportName,operationalMode:i.model.operationalMode,analysisMode:i.model.analysisMode,olapReport:JSON.stringify(i.model.dataSource),clientReports:(t.isNullOrUndefined(s)?JSON.stringify(i._clientReportCollection):s)+":>>:"+JSON.stringify(i._currentReportItems),customObject:d}),i._toolbarOperationSuccess)))}else(i.model.operationalMode!=t.Pivot.OperationalMode.ServerMode||i.model.analysisMode!=t.Pivot.AnalysisMode.Olap)&&e(a.currentTarget).hasClass("e-pvtBtn")||i._createDialogRequest(a)})}),this.element.find(".e-chartTypesImg").click(function(i){var l=e(this).parents(".e-pivotclient").data("ejPivotClient"),a=t.buildTag("div.e-chartTypesDialog#chartTypesDialog",t.buildTag("table",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-line e-chartTypesIcon").attr({title:l._getLocalizedLabels("Line"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-spline e-chartTypesIcon").attr({title:l._getLocalizedLabels("Spline"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-column e-chartTypesIcon").attr({title:l._getLocalizedLabels("Column"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-area e-chartTypesIcon").attr({title:l._getLocalizedLabels("Area"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-splinearea e-chartTypesIcon").attr({title:l._getLocalizedLabels("SplineArea"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-stepline e-chartTypesIcon").attr({title:l._getLocalizedLabels("StepLine"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-steparea e-chartTypesIcon").attr({title:l._getLocalizedLabels("StepArea"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pie e-chartTypesIcon").attr({title:l._getLocalizedLabels("Pie"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-bar e-chartTypesIcon").attr({title:l._getLocalizedLabels("Bar"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-stackingarea e-chartTypesIcon").attr({title:l._getLocalizedLabels("StackingArea"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-stackingcolumn e-chartTypesIcon").attr({title:l._getLocalizedLabels("StackingColumn"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-stackingbar e-chartTypesIcon").attr({title:l._getLocalizedLabels("StackingBar"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-funnel e-chartTypesIcon").attr({title:l._getLocalizedLabels("Funnel"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-pyramid e-chartTypesIcon").attr({title:l._getLocalizedLabels("Pyramid"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-doughnut e-chartTypesIcon").attr({title:l._getLocalizedLabels("Doughnut"),tabindex:0})[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("tr",t.buildTag("td",t.buildTag("div.e-scatter e-chartTypesIcon").attr({title:l._getLocalizedLabels("Scatter"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.e-bubble e-chartTypesIcon").attr({title:l._getLocalizedLabels("Bubble"),tabindex:0})[0].outerHTML)[0].outerHTML+t.buildTag("td",t.buildTag("div.waterfall e-chartTypesIcon").attr({title:l._getLocalizedLabels("WaterFall"),tabindex:0})[0].outerHTML)[0].outerHTML+(l.model.enablePivotTreeMap?t.buildTag("td",t.buildTag("div.treemap e-chartTypesIcon").attr({title:l._getLocalizedLabels("TreeMap"),tabindex:0})[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML);0==l.element.find("div.e-chartTypesDialog").length&&(e(a).appendTo(l.element),l.model.enableToolBar?e(a).css("left",e(i.target).offset().left+10+"px").css("top",e(i.target).offset().top+15+"px"):e(a).css("left",this.offsetLeft+20+"px").css("top",this.offsetTop+20+"px"),l._pivotChart.model.enable3D||l.element.find(".e-"+l._pivotChart.seriesType()).addClass("e-activeChartType")),e(".e-chartTypesIcon").click(function(i){var l,r,o=e(this).parents(".e-pivotclient").data("ejPivotClient");o.element.find(".e-chartTypesIcon").removeClass("e-activeChartType"),e(a).remove(),l=i.target.className.split(" ")[0].replace("e-",""),o.model.chartType=l,o._pivotChart.model.enable3D=!1,o._pivotChart.model.type=l,o._pivotChart.model.commonSeriesOptions.type=l,o._pivotChart.model.commonSeriesOptions.marker="funnel"==l||"pyramid"==l?{dataLabel:{visible:!0,shape:"none",font:{color:o.element.css("color"),size:"12px",fontWeight:"lighter"}}}:{dataLabel:{visible:!1}},jQuery.inArray(l,["line","spline","area","splinearea","stepline","steparea","stackingarea","scatter"])>-1&&!o._pivotChart.model.commonSeriesOptions.marker.visible&&(o._pivotChart.model.commonSeriesOptions.marker={shape:t.PivotChart.SymbolShapes.Circle,size:{height:12,width:12},visible:!0,connectorLine:{height:30,type:"line"},dataLabel:{visible:!1},border:{width:3,color:"white"}}),null!=o._pivotChart.getJSONRecords()?(o.model.operationalMode!=t.Pivot.OperationalMode.ClientMode?(o.chartObj=null,o.chartObj=o.element.find("#"+o._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(o.chartObj)&&!t.isNullOrUndefined(o.otreemapObj)&&(o.chartObj=o.element.find("#"+o.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),t.isNullOrUndefined(o.chartObj)||(o.model.enableDeferUpdate?(o._ischartTypesChanged=!0,o.model.enablePivotTreeMap&&"treemap"==this.title.toLocaleLowerCase()?o.model.enablePivotTreeMap&&(o.element.find("#"+o._id+"_PivotChartContainer").remove(),o.element.find("#"+o._id+"_PivotChart").removeClass("e-pivotchart"),o.element.find("#"+o._id+"_PivotChart").hasClass("e-pivottreemap")?o.otreemapObj.renderTreeMapFromJSON(o._pivotChart.getJSONRecords()):(o.element.find("#"+o._id+"_PivotChart").ejPivotTreeMap({url:o.model.url,customObject:this.model.customObject,canResize:o.model.isResponsive,currentReport:o.currentReport,locale:o.locale(),size:{height:o._chartHeight,width:o._chartWidth},drillSuccess:t.proxy(o._treemapDrillSuccess,o),beforeServiceInvoke:o.model.treeMapLoad}),o.otreemapObj=o.element.find("#"+o._id+"_PivotChart").data("ejPivotTreeMap"),o._isrenderTreeMap=!0,o.chartObj=null)):(o.element.find("#"+o._id+"_PivotChartTreeMapContainer").remove(),o.element.find("#"+o._id+"_PivotChart").removeClass("e-pivottreemap"),o.element.find("#"+o._id+"_PivotChart").hasClass("e-pivotchart")?o._pivotChart.renderControlSuccess({JsonRecords:JSON.stringify(o._pivotChart.getJSONRecords()),OlapReport:o._pivotChart.getOlapReport()}):(o.element.find("#"+o._id+"_PivotChart").ejPivotChart({url:o.model.url,customObject:this.model.customObject,enableRTL:o.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,axesLabelRendering:o.model.axesLabelRendering,pointRegionClick:o.model.pointRegionClick,canResize:o.model.isResponsive,currentReport:o.currentReport,customObject:o.model.customObject,locale:o.locale(),showTooltip:!0,size:{height:o._chartHeight,width:o._chartWidth},commonSeriesOptions:{type:o.model.chartType,tooltip:{visible:!0}},beforeServiceInvoke:o.model.chartLoad,drillSuccess:t.proxy(o._chartDrillSuccess,o)}),o._pivotChart=o.element.find("#"+o._id+"_PivotChart").data("ejPivotChart"),o.chartObj=null))):o.model.enablePivotTreeMap&&"treemap"==this.title.toLocaleLowerCase()?(o._isrenderTreeMap=!0,o.model.enablePivotTreeMap&&(o.element.find("#"+o._id+"_PivotChartContainer").remove(),o.element.find("#"+o._id+"_PivotChart").removeClass("e-pivotchart"),o.element.find("#"+o._id+"_PivotChart").hasClass("e-pivottreemap")?o.otreemapObj.renderControlSuccess({JsonRecords:JSON.stringify(o._pivotChart.getJSONRecords()),OlapReport:o._pivotChart.getOlapReport()}):(o.element.find("#"+o._id+"_PivotChart").ejPivotTreeMap({url:o.model.url,customObject:o.model.customObject,canResize:o.model.isResponsive,currentReport:o.currentReport,locale:o.locale(),size:{height:o._chartHeight,width:o._chartWidth},drillSuccess:t.proxy(o._treemapDrillSuccess,o),beforeServiceInvoke:o.model.treeMapLoad}),o.otreemapObj=o.element.find("#"+o._id+"_PivotChart").data("ejPivotTreeMap"),o.chartObj=null))):(o.element.find("#"+o._id+"_PivotChartTreeMapContainer").remove(),o.element.find("#"+o._id+"_PivotChart").removeClass("e-pivottreemap"),o.element.find("#"+o._id+"_PivotChart").hasClass("e-pivotchart")?o._pivotChart.renderControlSuccess({JsonRecords:JSON.stringify(o._pivotChart.getJSONRecords()),OlapReport:o._pivotChart.getOlapReport()}):(o.element.find("#"+o._id+"_PivotChart").ejPivotChart({url:o.model.url,customObject:o.model.customObject,enableRTL:o.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,axesLabelRendering:o.model.axesLabelRendering,pointRegionClick:o.model.pointRegionClick,canResize:o.model.isResponsive,currentReport:o.currentReport,customObject:o.model.customObject,locale:o.locale(),showTooltip:!0,size:{height:o._chartHeight,width:o._chartWidth},commonSeriesOptions:{type:o.model.chartType,tooltip:{visible:!0}},beforeServiceInvoke:o.model.chartLoad,drillSuccess:t.proxy(o._chartDrillSuccess,o)}),o._pivotChart=o.element.find("#"+o._id+"_PivotChart").data("ejPivotChart"),o.chartObj=null)),o.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(r=JSON.stringify(o.model.customObject),o.doAjaxPost("POST",o.model.url+"/"+o.model.serviceMethodSettings.updateReport,JSON.stringify({action:"chartTypeChanged",clientParams:l,olapReport:o.currentReport,clientReports:o.reports,customObject:r}),o._chartTypeChangedSuccess)))):o._pivotChart.renderControlSuccess({JsonRecords:JSON.stringify(o._pivotChart.getJSONRecords()),OlapReport:o._pivotChart.getOlapReport()}),o.model.isResponsive&&(o.chartObj=o.element.find("#"+o._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(o.chartObj)||o.element.find("#"+o.chartObj._id).ejChart("option",{model:{size:{height:o._chartHeight}}}))):(o._isTimeOut=!1,o._waitingPopup.hide())})}),this.element.find(".e-dialogCancelBtn").on(t.eventType.click,function(i){var l=e(this).parents(".e-pivotclient").data("ejPivotClient");i.preventDefault(),l.element.find(".e-dialog").hide(),l.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),t.Pivot.closePreventPanel(l)}),this.element.find(".e-dialogOKBtn").on(t.eventType.click,function(l){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y,x,M,P,w,L=e(this).parents(".e-pivotclient").data("ejPivotClient");if(l.preventDefault(),L.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(L.chartObj=L.element.find("#"+L._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(L.chartObj)&&L.model.enablePivotTreeMap&&!t.isNullOrUndefined(L.otreemapObj)&&(L.chartObj=L.element.find("#"+L.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),(a="msie"==t.browserInfo().name&&t.browserInfo().version<=8?L._dialogTitle:L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar")[0].textContent==i?L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar")[0].innerText:L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar")[0].textContent)==L._getLocalizedLabels("Load")){if(L._currentRecordName=L.element.find(".reportNameList")[0].value,""==(s=L.element.find(".reportNameList")[0].value))return t.Pivot._createErrorDialog(L._getLocalizedLabels("SelectRecordAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;L._isTimeOut=!0,L.model.operationalMode==t.Pivot.OperationalMode.ServerMode?L._waitingPopup.show():setTimeout(function(){L._isTimeOut&&L._waitingPopup.show()},800),L._fieldMembers={},L._fieldSelectedMembers={},L._measureSortOrder=L.model.sortCubeMeasures,L.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(null!=L.model.beforeServiceInvoke&&L._trigger("beforeServiceInvoke",{action:"loadReport",element:this.element,customObject:L.model.customObject}),S=JSON.stringify(L.model.customObject),L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.loadReport,JSON.stringify({reportName:s,operationalMode:L.model.operationalMode,analysisMode:L.model.analysisMode,olapReport:L.currentReport,clientReports:L.reports,customObject:S,clientParams:JSON.stringify(L.model.enableMeasureGroups+"-"+L.model.sortCubeMeasures)}),L.model.analysisMode==t.Pivot.AnalysisMode.Pivot?L._renderControlSuccess:L._toolbarOperationSuccess)):(r={url:"",reportCollection:L._clientReportCollection,selectedReport:s,mode:L.model.analysisMode},L._trigger("loadReport",{targetControl:L,loadReportSetting:r}),L.model.enableLocalStorage?(L.model.dataSource=r.reportCollection[0],L._clientReportCollection=r.reportCollection,L.refreshControl(),L._refreshReportList(),L._pivotSchemaDesigner&&L._pivotSchemaDesigner._refreshPivotButtons()):(S=JSON.stringify(L.model.customObject),L.doAjaxPost("POST",r.url+"/"+L.model.serviceMethodSettings.loadReport,JSON.stringify({reportName:s,operationalMode:L.model.operationalMode,analysisMode:L.model.analysisMode,olapReport:L.currentReport,clientReports:L.reports,customObject:S,clientParams:JSON.stringify(L.model.enableMeasureGroups+"-"+L.model.sortCubeMeasures)}),L._clientToolbarOperationSuccess)))}else if(a==L._getLocalizedLabels("Remove")){if(""==(s=L.element.find(".reportNameList")[0].value)||t.isNullOrUndefined(s))return t.Pivot._createErrorDialog(L._getLocalizedLabels("SelectRecordAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;L._currentRecordName=s==L._currentRecordName?"":L._currentRecordName,L._isTimeOut=!0,setTimeout(function(){L._isTimeOut&&L._waitingPopup.show()},800),L.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(n={url:"",selectedReport:s,mode:L.model.analysisMode},L._trigger("loadReport",{targetControl:L,fetchReportSetting:n})),null!=L.model.beforeServiceInvoke&&L._trigger("beforeServiceInvoke",{action:"removeDBReport",element:this.element,customObject:L.model.customObject,currentReportName:s}),S=JSON.stringify(L.model.customObject),L._fieldMembers={},L._fieldSelectedMembers={},L.model.enableLocalStorage||L.doAjaxPost("POST",(L.model.operationalMode==t.Pivot.OperationalMode.ClientMode?n.url:L.model.url)+"/"+L.model.serviceMethodSettings.removeDBReport,JSON.stringify({reportName:s,operationalMode:L.model.operationalMode,analysisMode:L.model.analysisMode,customObject:S}),L._toolbarOperationSuccess)}else if(a==L._getLocalizedLabels("Rename")){if(o=L.element.find(".renameReport").val(),""==(s=L.element.find(".reportNameList")[0].value)||t.isNullOrUndefined(s)||""==o||t.isNullOrUndefined(o))return""==s||t.isNullOrUndefined(s)?t.Pivot._createErrorDialog(L._getLocalizedLabels("SelectRecordAlertMsg"),L._getLocalizedLabels("Warning"),L):(""==o||t.isNullOrUndefined(o))&&t.Pivot._createErrorDialog(L._getLocalizedLabels("SetReportNameAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;L._isTimeOut=!0,setTimeout(function(){L._isTimeOut&&L._waitingPopup.show()},800),L.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&(n={url:"",selectedReport:s,mode:L.model.analysisMode},L._trigger("loadReport",{targetControl:L,fetchReportSetting:n})),null!=L.model.beforeServiceInvoke&&L._trigger("beforeServiceInvoke",{action:"renameDBReport",element:this.element,customObject:L.model.customObject,currentReportName:s,renameReportName:o}),S=JSON.stringify(L.model.customObject),L.model.enableLocalStorage||L.doAjaxPost("POST",(L.model.operationalMode==t.Pivot.OperationalMode.ClientMode?n.url:L.model.url)+"/"+L.model.serviceMethodSettings.renameDBReport,JSON.stringify({selectedReport:s,renameReport:o,operationalMode:L.model.operationalMode,analysisMode:L.model.analysisMode,customObject:S}),L._toolbarOperationSuccess)}else if(L.element.find(".e-sortingDlg").length>0){if(1==L.element.find(".e-sortEnable")[0].checked&&""==L.element.find(".e-measuresList")[0].value)return t.Pivot._createErrorDialog(L._getLocalizedLabels("FilterMeasureSelectionAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;if(1==L.element.find(".e-filterEnable")[0].checked){if(""==L.element.find(".fMeasuresList")[0].value)return t.Pivot._createErrorDialog(L._getLocalizedLabels("FilterMeasureSelectionAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;if(""==L.element.find(".e-filterCondition")[0].value)return t.Pivot._createErrorDialog(L._getLocalizedLabels("FilterConditionAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;if(""==L.element.find(".filterFrom")[0].value)return t.Pivot._createErrorDialog(L._getLocalizedLabels("FilterStartValueAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;if(("Between"==L.element.find(".e-filterCondition")[0].value||"NotBetween"==L.element.find(".e-filterCondition")[0].value)&&""==L.element.find(".filterTo")[0].value)return t.Pivot._createErrorDialog(L._getLocalizedLabels("FilterEndValueAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;L._excelFilterInfo=[]}if(d=null,h=null,0!=L._isSorted&&1!=L._isSorted||1!=L.element.find(".e-sortEnable")[0].checked?d=1==L._isSorted&&1==L.element.find(".e-sortDisable")[0].checked?"Disable Sorting:: ::"+L._axis+":: ":" :: ::"+L._axis+":: ":((c=L.element.find("li[data-tag*='"+L.element.find(".e-measuresList")[0].value+"']")).length>1&&(c=L.element.find("li[data-tag^='[Measures].["+L.element.find(".e-measuresList")[0].value+"']li[data-tag*='"+L.element.find(".e-measuresList")[0].value+"']")||L.element.find("li[data-tag^='[MEASURES].["+L.element.find(".e-measuresList")[0].value+"']li[data-tag*='"+L.element.find(".e-measuresList")[0].value+"']")),d=e(c).attr("data-tag")+"::"+(1==L.element.find(".e-radioBtnAsc")[0].checked?"ASC":"DESC")+"::"+L._axis+"::"+(1==L.element.find(".e-preserveHrchy")[0].checked?"PHT":"PHF")),0!=L._isFiltered&&1!=L._isFiltered||1!=L.element.find(".e-filterEnable")[0].checked?h=1==L._isFiltered&&1==L.element.find(".e-filterDisable")[0].checked?"Disable Filtering":"":((c=L.element.find("li[data-tag*='"+L.element.find(".fMeasuresList")[0].value+"']")).length>1&&(c=L.element.find("li[data-tag^='[Measures].["+L.element.find(".fMeasuresList")[0].value+"']li[data-tag*='"+L.element.find(".fMeasuresList")[0].value+"']")||L.element.find("li[data-tag^='[MEASURES].["+L.element.find(".fMeasuresList")[0].value+"']li[data-tag*='"+L.element.find(".fMeasuresList")[0].value+"']")),h=e(c).attr("data-tag")+"::"+L.element.find(".e-filterCondition")[0].value+"::"+L.element.find(".filterFrom")[0].value+"::"+L.element.find(".filterTo")[0].value),L._SortFilterDetails=d+"||"+h,L._isTimeOut=!0,setTimeout(function(){L._isTimeOut&&L._waitingPopup.show()},800),1==L.element.find(".e-sortEnable")[0].checked||1==L.element.find(".e-filterEnable")[0].checked)L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"toolbarOperation",toolbarOperation:"SortOrFilter",clientInfo:L._SortFilterDetails,olapReport:L.currentReport,clientReports:L.reports,customObject:JSON.stringify(L.model.customObject)}),L._toolbarOperationSuccess);else if(1==L.element.find(".e-sortDisable")[0].checked||1==L.element.find(".e-filterDisable")[0].checked){if(1!=L._isSorted&&1!=L._isFiltered)return t.Pivot._createErrorDialog(L._getLocalizedLabels("FilterInvalidAlertMsg"),L._getLocalizedLabels("Warning"),L),L._isTimeOut=!1,L._waitingPopup.hide(),!1;L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"toolbarOperation",toolbarOperation:"SortOrFilter",clientInfo:L._SortFilterDetails,olapReport:L.currentReport,clientReports:L.reports,customObject:JSON.stringify(L.model.customObject)}),L._toolbarOperationSuccess),L._isSorted=!1}}else{if(e(".e-memberEditorDiv").length>0&&"OKBtn"==l.target.id){if(L.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").length>0&&L.element.find(".e-editorTreeView").ejTreeView("removeNode",L.element.find(".e-editorTreeView").find("li span.e-searchfilterselection").closest("li")),L.model.enableAdvancedFilter&&L._excelFilterInfo.length>0&&(L._removeFilterTag(L._selectedFieldName),L._selectedLevelUniqueName&&L._removeFilterTag(L._selectedLevelUniqueName)),L._currentItem.indexOf(L._getLocalizedLabels("Measures"))<0&&t.Pivot.updateTreeView(L),!L.model.enableMemberEditorPaging&&""==t.Pivot._getSelectedTreeState("Slicers"==L._currentAxis,L)&&L._args_innerHTML!=L._getLocalizedLabels("Measures")&&"ToolbarButtons"!=L._args_innerHTML)return!1;if(L._currentItem.indexOf(L._getLocalizedLabels("Measures"))<0){if(0!=L._currentReportItems.length)for(p=!1,O=0;O<L._currentReportItems.length;O++)if(L._currentReportItems[O]==L._currentItem){p=!0;break}p&&0!=L._currentReportItems.length||L._currentReportItems.push(L._currentItem),L._treeViewData[L._currentItem]=L._memberTreeObj.dataSource()}}if(u=null,"ToolbarButtons"!=L._args_innerHTML){if(!L._isMembersFiltered&&!L.model.enableMemberEditorPaging)return L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),void t.Pivot.closePreventPanel(L);L._args_innerHTML==L._getLocalizedLabels("Measures")?u="Measures:"+L._getMeasuresList():"ToolbarButtons"!=L._args_innerHTML&&L._args_innerHTML!=i&&(t.Pivot.updateTreeView(L),u=("KPIs"==L._args_innerHTML?L._getUnSelectedNodes():t.Pivot._getUnSelectedTreeState(L))+"CHECKED"+("KPIs"==L._args_innerHTML?L._getSelectedNodes("Slicers"==L._currentAxis):t.Pivot._getSelectedTreeState("Slicers"==L._currentAxis,L))),L._isTimeOut=!0,setTimeout(function(){L._isTimeOut&&L._waitingPopup.show()},800),L._args_innerHTML==L._getLocalizedLabels("Measures")&&null!=u&&""==u.split(":")[1]&&e(L.element).find(".e-splitBtn").each(function(t,i){i.firstChild.innerHTML==L._getLocalizedLabels("Measures")&&e(i).remove()}),e(L).find(".e-dialog").hide(),L.model.enableMemberEditorPaging&&L._args_innerHTML!=L._getLocalizedLabels("Measures")&&L._args_innerHTML!=L._getLocalizedLabels("KPIs")&&L.element.find(".e-nextPageDiv").length>0&&(u=t.Pivot._getUnSelectedTreeState(L)+"CHECKED"+t.Pivot._getSelectedTreeState("Slicers"==L._currentAxis,L)),null!=L.model.beforeServiceInvoke&&L._trigger("beforeServiceInvoke",{action:"filtering",element:this.element,customObject:L.model.customObject}),m=t.Pivot._getEditorMember(L._dimensionName.split(":").length>1?L._dimensionName.split(":")[1]:L._dialogTitle,L,!1),L._fieldSelectedMembers[L._dimensionName.split(":").length>1?L._dimensionName.split(":")[1]:L._dialogTitle]=0==e.map(L._fieldMembers[L._dimensionName.split(":").length>1?L._dimensionName.split(":")[1]:L._dialogTitle],function(e){if(!e.checked)return e}).length?"All":"All"!=m&&"multiple"!=m?m:L._getLocalizedLabels("MultipleItems"),L.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&L.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(g=L.element.find("#reportList").data("ejDropDownList"),L._slicerBtnTextInfo[g.selectedIndexValue]=L._fieldSelectedMembers),L._setSplitBtnTitle(),S=JSON.stringify(L.model.customObject),L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.filterElement,JSON.stringify({action:"filtering",clientParams:u,olapReport:L.currentReport,clientReports:L.reports,customObject:S}),L._filterElementSuccess)}else if(L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").first().text()==L._getLocalizedLabels("RemoveReport")&&L.reportsCount<2)L.element.find(".e-dialog").hide();else{if(""===e.trim(L.element.find(".reportName").val())&&L.element.find(".reportName").val()!=i)return L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").first().text()==L._getLocalizedLabels("NewReport")||L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").first().text()==L._getLocalizedLabels("AddReport")||(L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").first().text(),L._getLocalizedLabels("RenameReport")),t.Pivot._createErrorDialog(L._getLocalizedLabels("SetReportNameAlertMsg"),L._getLocalizedLabels("Warning"),L),!1;this.reportDropTarget=L.element.find("#reportList").data("ejDropDownList");var N=e.trim(L.element.find(".reportName").val())||this.reportDropTarget.selectedTextValue,D=L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").first().attr("data-tag"),R="New Report"==D?"":L.currentReport,j="New Report"==D?"":L.reports;if(L._currentRecordName="New Report"==D?"":L._currentRecordName,L.element.find(".e-dialog").hide(),L._isTimeOut=!0,L.model.operationalMode==t.Pivot.OperationalMode.ServerMode?L._waitingPopup.show():setTimeout(function(){L._isTimeOut&&L._waitingPopup.show()},800),"SaveAs Report"==D&&L.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(f=L._updateReportCollection(!0)),("Add Report"==D||"New Report"==D||"Remove Report"==D)&&L.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(L.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&L._pivotSchemaDesigner&&(L._pivotSchemaDesigner._tempFilterData=[]),"New Report"==D?L._repCol=e.grep(L._repCol,function(e){e.CubeName==L.currentCubeName&&(e.slicerBtnTextInfo={})}):"Add Report"==D&&(L._slicerBtnTextInfo[this.reportDropTarget.selectedIndexValue]=L._fieldSelectedMembers,f=L._updateReportCollection(!1)),"Remove Report"==D?(delete L._slicerBtnTextInfo[this.reportDropTarget.selectedIndexValue],L._fieldSelectedMembers=L._slicerBtnTextInfo[this.reportDropTarget.selectedIndexValue-1]):L._fieldSelectedMembers={}),L.model.operationalMode==t.Pivot.OperationalMode.ClientMode)b={data:L.model.dataSource.data,reportName:N,enableAdvancedFilter:L.model.dataSource.enableAdvancedFilter,columns:[],cube:L.model.dataSource.cube,catalog:L.model.dataSource.catalog,reportName:N,rows:[],values:[],filters:[],pagerOptions:L.model.dataSource.pagerOptions},y=L.element.find(".reportlist").data("ejDropDownList"),L.element.find(".reportlist").ejDropDownList("option","change",t.proxy(L._reportChanged,L)),("New Report"==D||"Add Report"==D)&&L.model.enableVirtualScrolling&&(L._pivotGrid._categPageCount=null,L._pivotGrid._seriesPageCount=null),"New Report"==D?(L.model.dataSource=b,L._clientReportCollection=[b],L.element.find(".reportlist").ejDropDownList("option","dataSource",[{name:N}]),y.selectItemByText(N),L._fieldMembers={},L._fieldSelectedMembers={}):"Add Report"==D?(L.model.dataSource=b,L.model.dataSource.reportName=N,_=e.map(L._clientReportCollection,function(e){if(e.reportName==L.model.dataSource.reportName)return e}),L._clientReportCollection=e.map(L._clientReportCollection,function(e){if(e.reportName!=L.model.dataSource.reportName)return e}),L._clientReportCollection.push(L.model.dataSource),L._fieldMembers={},L._fieldSelectedMembers={},0==_.length?((y=L.element.find(".reportlist").data("ejDropDownList")).model.dataSource.push({name:N}),x=JSON.stringify(y.model.dataSource),L.element.find(".reportlist").ejDropDownList("option","dataSource",JSON.parse(x)),y.selectItemByText(N)):L._clientReportCollection.length>0&&L._reportChanged()):"Rename Report"==D?(L._clientReportCollection=e.map(L._clientReportCollection,function(e){return e.reportName==L.model.dataSource.reportName&&(e.reportName=N),e}),x=JSON.stringify(e.map(y.model.dataSource,function(e){return e.name!=y.getValue()?e:{name:N}})),L.model.dataSource.reportName=N,L.element.find(".reportlist").ejDropDownList("option","dataSource",JSON.parse(x)),y.selectItemByText(N),L._currentItem=""):"Remove Report"==D?(L._clientReportCollection=e.map(L._clientReportCollection,function(e){if(e.reportName!=N)return e}),v=e(y.getSelectedItem()).index()>=L._clientReportCollection.length?L._clientReportCollection.length-1:e(y.getSelectedItem()).index(),L.model.dataSource=L._clientReportCollection[v],x=JSON.stringify(e.map(y.model.dataSource,function(e){if(e.name!=y.getValue())return e})),L.element.find(".reportlist").ejDropDownList("option","dataSource",JSON.parse(x)),L._fieldMembers={},L._fieldSelectedMembers={},y.model.dataSource.length>0&&y.selectItemByText(L.model.dataSource.reportName)):"SaveAs Report"==D?(L._currentRecordName=N,C={url:"",reportName:N,reportCollection:L._clientReportCollection,mode:L.model.analysisMode,filterCollection:L._currentReportItems},L._trigger("saveReport",{targetControl:L,saveReportSetting:C}),L.model.enableLocalStorage||(S=JSON.stringify(L.model.customObject),L.doAjaxPost("POST",C.url+"/"+L.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:C.reportName,operationalMode:L.model.operationalMode,analysisMode:L.model.analysisMode,olapReport:JSON.stringify(L.model.dataSource),clientReports:(t.isNullOrUndefined(f)?JSON.stringify(L._clientReportCollection):f)+":>>:"+JSON.stringify(L._currentReportItems),customObject:S}),L._toolbarOperationSuccess))):"Rename Report"!=D&&(L.refreshControl(),L._pivotSchemaDesigner&&L._pivotSchemaDesigner._refreshPivotButtons()),L._isTimeOut=!1,L._waitingPopup.hide();else if(y=L.element.find(".reportlist").data("ejDropDownList"),L._clientReportCollection=e.map(L._clientReportCollection,function(e){return e.name==y.getValue()&&(e.report=R),e}),"SaveAs Report"==D)L._currentRecordName=N,null!=L.model.beforeServiceInvoke&&L._trigger("beforeServiceInvoke",{action:"saveReport",element:this.element,customObject:L.model.customObject}),S=JSON.stringify(L.model.customObject),L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.saveReport,JSON.stringify({reportName:N,operationalMode:L.model.operationalMode,analysisMode:L.model.analysisMode,olapReport:R,clientReports:"pivot"==L.model.analysisMode?JSON.stringify(L._clientReportCollection):t.isNullOrUndefined(f)?JSON.stringify(L._clientReportCollection):f,customObject:S}),L._toolbarOperationSuccess);else if(null!=L.model.beforeServiceInvoke&&L._trigger("beforeServiceInvoke",{action:"toolbarOperation",element:this.element,customObject:L.model.customObject}),S=JSON.stringify(L.model.customObject),L.model.analysisMode==t.Pivot.AnalysisMode.Olap)L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"toolbarOperation",toolbarOperation:D,clientInfo:N,olapReport:R,clientReports:j,customObject:S}),L._toolbarOperationSuccess);else{if(D==L._getLocalizedLabels("NewReport"))L._currentReportName=N,L._fieldMembers={},L._fieldSelectedMembers={};else if(D==L._getLocalizedLabels("AddReport"))L._fieldMembers={},L._fieldSelectedMembers={},y.model.dataSource.push({name:N}),y.selectItemByText(N),L._currentReportName=N;else if(D==L._getLocalizedLabels("RemoveReport")){for(O=0;O<L._clientReportCollection.length;O++)L._clientReportCollection[O].name==L._currentReportName&&L._clientReportCollection.splice(O,1);for(y=L.element.find(".reportlist").data("ejDropDownList"),O=0;O<y.model.dataSource.length;O++)y.model.dataSource[O].name==L._currentReportName&&y.model.dataSource.splice(O,1);y.selectItemByText(y.model.dataSource[0].name),R=L._clientReportCollection[0].report,N=L._clientReportCollection[0].name,L._currentReport="",L._currentReportName=N,L._fieldMembers={},L._fieldSelectedMembers={}}else if(D==L._getLocalizedLabels("RenameReport")){T="";try{T=JSON.parse(L.getOlapReport()).Report}catch(e){T=L.getOlapReport()}return L._clientReportCollection=e.map(L._clientReportCollection,function(e){return e.name==L._currentReportName&&(e.name=N),e}),y=L.element.find(".reportlist").data("ejDropDownList"),x=JSON.stringify(e.map(y.model.dataSource,function(e){return e.name!=y.getValue()?e:{name:N,report:T}})),L.element.find(".reportlist").ejDropDownList("option","dataSource",JSON.parse(x)),L._isReportListAction=!1,y.selectItemByText(N),L._isReportListAction=!0,L._currentReportName=N,L._isTimeOut=!1,L._waitingPopup.hide(),void t.Pivot.closePreventPanel(L)}L.doAjaxPost("POST",L.model.url+"/"+L.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:D,args:JSON.stringify({clientInfo:N,currentReport:R}),customObject:S}),L._toolbarOperationSuccess)}}}L._isTimeOut&&(L._isTimeOut=!1),L.model.showReportCollection&&a!=L._getLocalizedLabels("NewReport")&&a!=L._getLocalizedLabels("AddReport")&&a!=L._getLocalizedLabels("RenameReport")&&a!=L._getLocalizedLabels("RemoveReport")&&a!=L._getLocalizedLabels("MemberEditor")&&a!=L._getLocalizedLabels("MeasureEditor")&&(M=L.element.find(".e-collectionlist").data("ejDropDownList").model.dataSource.slice(),P=t.isNullOrUndefined(L.element.find(".e-collectionlist").data("ejDropDownList").selectedTextValue)?"":L.element.find(".e-collectionlist").data("ejDropDownList").selectedTextValue,a==L._getLocalizedLabels("Rename")?(M[w=M.indexOf(L.element.find(".reportNameList")[0].value)]=L.element.find(".renameReport").val(),P=L.element.find(".reportNameList")[0].value==P?L.element.find(".renameReport").val():P):a==L._getLocalizedLabels("Remove")?(w=M.indexOf(L.element.find(".reportNameList")[0].value),M.splice(w,1)):(P=L.element.find(".reportName")[0].value,M.push(L.element.find(".reportName")[0].value)),L.element.find(".e-collectionlist").data("ejDropDownList").option("dataSource",M),P=-1==e.inArray(P,M)?"":P,M.length>0&&""!=P&&(L.element.find(".e-collectionlist").data("ejDropDownList").option("change",""),L.element.find(".e-collectionlist").data("ejDropDownList").selectItemByText(P),L.element.find(".e-collectionlist").ejDropDownList("option","change",t.proxy(L._collectionChange,L)))),L.model.showReportCollection&&a==L._getLocalizedLabels("NewReport")&&L.element.find(".e-collectionlist").length>0&&L.element.find(".e-collectionlist").data("ejDropDownList").selectItemByText(),L.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),L.element.find("#preventDiv").remove()}),this.element.find(".e-searchEditorTree").click(function(i){var l=e(this).parents(".e-pivotclient").data("ejPivotClient");t.Pivot._searchEditorTreeNodes(i,l)}),this.element.find(".e-calcMemberImg").click(function(){var i,l,a,r,o=e(this).parents(".e-pivotclient").data("ejPivotClient");o.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&o.element.find(".e-calcMemberDialog").remove(),o.element.find(".e-calcMemberDialog").length>0?(o._calcMemberTreeObj.collapseAll(),t.Pivot.openPreventPanel(o),o._calcMemberDialog.open(),o.element.find("#"+o._id+"_captionFieldCM").val(""),o.element.find("#"+o._id+"_expressionFieldCM").val(""),o.element.find("#"+o._id+"_memberTypeFieldCM").data("ejDropDownList").selectItemsByIndices(0),o.element.find("#"+o._id+"_dimensionFieldCM").data("ejDropDownList").selectItemsByIndices(0),o.element.find("#"+o._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(0),o.element.find("#"+o._id+"_customFormatFieldCM").val("")):(o._waitingPopup.show(),o.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(null!=o.model.beforeServiceInvoke&&o._trigger("beforeServiceInvoke",{action:"fetchCalcMemberTreeView",element:o.element,customObject:o.model.customObject}),i=JSON.stringify(o.model.customObject),o.doAjaxPost("POST",o.model.url+"/"+o.model.serviceMethodSettings.fetchMemberTreeNodes,JSON.stringify({action:"fetchCalcMemberTreeView",dimensionName:"calcMember>#>"+o.model.sortCubeMeasures,olapReport:o.currentReport,customObject:i}),t.proxy(t.Pivot._createCalcMemberDialog,o))):(l=[],a=o.element.find(".e-schemaFieldTree").data("ejTreeView").model.fields.dataSource,a=e.grep(a,function(e){return e.id&&(e.id=e.id.replace(/\]/g,"_").replace(/\[/g,"_").replace(/\./g,"_").replace(/ /g,"_")),e.pid&&(e.pid=e.pid.replace(/\]/g,"_").replace(/\[/g,"_").replace(/\./g,"_").replace(/ /g,"_")),e.spriteCssClass.indexOf("e-level")>-1&&l.push({id:e.id+"_1",pid:e.id,name:"(Blank)",hasChildren:!1,spriteCssClass:""}),e}),a=e.merge(l,a),o._selectedCalcMember=null,r={CubeTreeInfo:JSON.stringify(a)},t.Pivot._createCalcMemberDialog(r,o)))}),this.element.find(".e-unCheckAll,.e-checkAll").click(function(t){var i=e(this).parents(".e-pivotclient").data("ejPivotClient"),l=i.element.find(".e-editorTreeView"),a=null;t.target.className.indexOf("e-checkAll")>-1?(i._isOptionSearch?(a=e(l).find("li[data-isItemSearch='true']")).length>0&&e(a).each(function(t,i){e(l).ejTreeView("checkNode",e(i))}):e(l).ejTreeView("checkAll"),e(l).find("li").length>0&&e(l).find("li").find("span.e-checkmark").length>0&&(i.element.find(".e-dialogOKBtn").data("ejButton").enable(),i.element.find(".e-dialogOKBtn").removeAttr("disabled"),i._isMembersFiltered=!0),(i.model.enableMemberEditorPaging||i._editorTreeData.length>0)&&setTimeout(function(){if(i._waitingPopup.show(),i._editorSearchTreeData.length>0)for(var t=0;t<i._editorSearchTreeData.length;t++)e(i._editorTreeData).each(function(e,l){if(i._editorSearchTreeData[t].id==l.id)return i._editorSearchTreeData[t].checkedStatus=!0,l.checkedStatus=!0,!1});else e(i._editorTreeData).each(function(e,t){t.checkedStatus=!0});i._waitingPopup.hide()},0)):(i._isOptionSearch?(a=e(l).find("li[data-isItemSearch='true']")).length>0&&e(a).each(function(t,i){e(l).ejTreeView("uncheckNode",e(i))}):i.model.enableMemberEditorPaging&&e(l).find("li span.e-searchfilterselection").length>0?(e(l).ejTreeView("unCheckAll"),i._isSelectSearchFilter?e(l).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-stop").addClass("e-checkmark"):e(l).find("li span.e-searchfilterselection").closest("li").find("span.e-chk-image").removeClass("e-checkmark").removeClass("e-stop")):e(l).ejTreeView("unCheckAll"),(e(l).find("li").length>0&&!e(l).find("li").find("span.e-checkmark").length>0||e(l).find("li").length>0&&1==e(l).find("li").find("span.e-checkmark").length&&e(l).find("li span.e-searchfilterselection").closest("li").find("span.e-checkmark").length>0)&&(i.element.find(".e-dialogOKBtn").data("ejButton").disable(),i.element.find(".e-dialogOKBtn").attr("disabled","disabled")),(i.model.enableMemberEditorPaging||i._editorTreeData.length>0)&&setTimeout(function(){if(i._waitingPopup.show(),i._editorSearchTreeData.length>0)for(var t=0;t<i._editorSearchTreeData.length;t++)e(i._editorTreeData).each(function(e,l){if(i._editorSearchTreeData[t].id==l.id)return i._editorSearchTreeData[t].checkedStatus=!1,l.checkedStatus=!1,!1});else e(i._editorTreeData).each(function(e,t){t.checkedStatus=!1});e(i._editorTreeData).each(function(e,t){if(t.checkedStatus)return i.element.find(".e-dialogOKBtn").data("ejButton").enable(),i.element.find(".e-dialogOKBtn").removeAttr("disabled"),i._isMembersFiltered=!0,!1}),i._waitingPopup.hide()},0))})},_generateCalculatedMember:function(t,i){for(var l,a,r,o,s,n=e(i).find("Axis:eq(0) Tuple"),d=[],h={},c=0;c<n.length;c++)l=e(e(i).find("Axis:eq(0) Tuple:eq("+c+")").children().children()[0]).text(),a=""==e(e(i).find("Axis:eq(0) Tuple:eq("+c+")").children().children()[1]).text()?"(Blank)":e(e(i).find("Axis:eq(0) Tuple:eq("+c+")").children().children()[1]).text(),h={hasChildren:"0"!=e(n[c]).find("CHILDREN_CARDINALITY").text(),checkedStatus:!0,id:l.replace(/\]*\]/g,"-").replace(/\[*\[/g,"-").replace(/ /g,"_").replace(/&/g,"_"),name:a,tag:l,level:parseInt(e(n[c]).find("LNum").text())},d.push(h);for(o=d,(r=this.element.find(".e-cubeTreeViewCalcMember").data("ejTreeView")).addNodes(o,this._calcExpanded.id),c=0;c<o.length;c++)0==c&&r.element.find("#"+this._calcExpanded.id).find("li:eq(0)").remove(),s=o[c].tag,r.element.find("#"+this._calcExpanded.id).find("li:eq("+c+")").attr("data-tag",s);this._waitingPopup.hide()},_updateReportCollection:function(i){var l,a,r,o,s,n,d=-1;return this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?(n=this.model.dataSource.cube,o=jQuery.extend(!0,{},this.model.dataSource),s=JSON.parse(JSON.stringify(this._clientReportCollection))):(n=this.currentCubeName,o=this.currentReport,s=this.reports),l=this.element.find("#reportList").data("ejDropDownList"),!t.isNullOrUndefined(this._pivotSchemaDesigner)&&this._pivotSchemaDesigner.element.find(".cubeList").length>0?(this._pivotSchemaDesigner.element.find(".cubeList").data("ejDropDownList"),this._repCol=this._pivotSchemaDesigner._repCollection):this.element.find("#cubeSelector").data("ejDropDownList"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(this._slicerBtnTextInfo[l.selectedIndexValue]=this._fieldSelectedMembers),a={CubeName:n,CurrentReport:o,Reports:s,ReportIndex:l.selectedIndexValue,ReportList:JSON.parse(JSON.stringify(l.model.dataSource)),_fieldSelectedMembers:this._fieldSelectedMembers,slicerBtnTextInfo:this._slicerBtnTextInfo,calculatedMembers:this.model.calculatedMembers,measureSortOrder:this.model.sortCubeMeasures},e.map(this._repCol,function(e,t){e.CubeName==n&&(d=t)}),-1!=d?(this._repCol[d]=a,r=d):(r=this._repCol.length,this._repCol.push(a)),i&&this._repCol.push({cubeIndex:r}),JSON.stringify(this._repCol)},_getLocalizedLabels:function(e){return t.isNullOrUndefined(t.PivotClient.Locale[this.locale()])||t.PivotClient.Locale[this.locale()][e]==i?t.PivotClient.Locale["en-US"][e]:t.PivotClient.Locale[this.locale()][e]},_unWireEvents:function(){e(this.element.find(".e-dialogCancelBtn, .e-dialogOKBtn, .e-newReportImg, .e-addReportImg, .e-removeReportImg, .e-renameReportImg, .e-pvtBtn, .e-removeSplitBtn, .e-unCheckAll, .e-checkAll, .e-removeMeasure, .e-toggleCollapseButton, .e-toggleExpandButton, .e-reportDBImg, .e-saveAsReportImg, .e-saveReportImg, .e-loadReportImg, .e-removeDBReportImg, .e-renameDBReportImg, .e-mdxImg,.maximizedView,.e-colSortFilterImg, .e-rowSortFilterImg, .e-chartTypesImg, .e-toggleaxisImg, .e-autoExecuteImg, .e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage, .e-searchEditorTree, .e-calcMemberImg, .e-excelExportImg, .e-wordExportImg, .e-pdfExportImg")).off(t.eventType.click),e(this.element.find(".e-dialogCancelBtn, .e-dialogOKBtn, .e-newReportImg, .e-addReportImg, .e-removeReportImg, .e-renameReportImg, .e-pvtBtn, .e-removeSplitBtn, .e-unCheckAll, .e-checkAll, .e-removeMeasure, .e-toggleCollapseButton, .e-toggleExpandButton, .e-reportDBImg, .e-saveAsReportImg, .e-saveReportImg, .e-loadReportImg, .e-removeDBReportImg, .e-renameDBReportImg, .e-mdxImg,.maximizedView,.e-colSortFilterImg, .e-rowSortFilterImg, .e-chartTypesImg, .e-toggleaxisImg,.e-autoExecuteImg, .e-nextPage, .e-prevPage, .e-firstPage, .e-lastPage, .e-searchEditorTree,.e-calcMemberImg,  .e-excelExportImg, .e-wordExportImg, .e-pdfExportImg")).off("click"),e(document).find(".e-winCloseBtn").off(t.eventType.click),e(this._off(this.element,"mouseup",".e-parentsplit")),this._off(this.element,"click","#preventDiv"),e(document).find(".e-winCloseBtn").off("click"),this._off(e(document),"click",this._removeDialog),this._off(e(document),"keydown",this._keyPressDown),this._off(e(document),"keyup",this._keyPressUp),this._off(this.element.find("a.e-linkPanel"),"click",t.Pivot._editorLinkPanelClick),this._off(this.element,"click",".e-memberAscendingIcon, .e-memberDescendingIcon",t.proxy(t.Pivot._memberSortBtnClick,this)),this.model.isResponsive&&e(window).off("resize",e.proxy(this._reSizeHandler,this))},_calculateHeight:function(){var i,l,a;e(this.element).height(e(this.element).height()<450?450:e(this.element).height()),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(i=this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+5),this.element.find(".oClientTbl").css("height",i+"px"),this.element.find(".e-outerTable").css("height",i+"px"),this.model.enableVirtualScrolling?(this.element.find(".e-controlPanel").css("height",i-25+"px"),this._pivotGrid._applyVScrolling()):this.model.enablePaging?this.model.displaySettings.controlPlacement==t.PivotClient.ControlPlacement.Tab?(this.element.find(".e-controlPanel").height(i-this.element.find("#"+this._id+"_Pager").height()),this.model.isResponsive&&this.element.find("#"+this._id+"_Pager").css({"margin-top":"-1px"})):this.element.find(".e-controlPanel").height(i-this.element.find("#"+this._id+"_Pager").height()-5):this.element.find(".e-controlPanel").css("height",i+"px"),this.element.find(".e-cubeTable").css("height",this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+38)+"px"),cdbHeight=this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+38),this.element.find(".e-cubeBrowser").css("height",cdbHeight+7-this.element.find(".e-cdbHeader").height()),this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-this.element.find(".e-cubeName").height()-(7+(this.model.enableMeasureGroups?this.element.find(".measureGroupselector").height()+13:0))),aebHeight=cdbHeight-(3*this.element.find(".e-axisHeader").height()+(this.model.enableSplitter?8:5)),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").css("height",aebHeight/3+"px"),this.model.enableSplitter&&this.element.find(".e-serversplitresponsive").height(this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+30))):(i=this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+5),this.element.find(".e-outerTable, .controlPanelTD").css("height",i+"px"),this.model.enableVirtualScrolling?(this.element.find(".e-controlPanel").height(i-15),this.model.displaySettings.mode!=t.PivotClient.DisplayMode.ChartOnly&&this._pivotGrid._applyVScrolling()):this.model.enablePaging?this.model.displaySettings.controlPlacement==t.PivotClient.ControlPlacement.Tab?this.element.find(".e-controlPanel").height(i-this.element.find("#"+this._id+"_Pager").height()):this.element.find(".e-controlPanel").height(i-this.element.find("#"+this._id+"_Pager").height()-5):this.element.find(".e-controlPanel").height(i),this.element.find("#"+this._id+"_PivotSchemaDesigner").height(i),this._pivotSchemaDesigner._reSizeHandler(),this.enableTogglePanel()&&this.element.find(".pivotFieldList").length>0&&(this.element.find("div.e-togglePanel").remove(),this.model.enableRTL&&this.element.find(".e-pivotschemadesigner").css({"margin-left":"0px","margin-right":"0px"}),this.element.find(".e-controlPanel").width(this.element.width()-(this.element.width()/3+(this.model.enableVirtualScrolling?39:20))),e(t.buildTag("div.e-togglePanel",t.buildTag("div.e-toggleExpandButton e-icon","",{}).attr("aria-label","toggle expanded")[0].outerHTML+t.buildTag("div.e-toggleCollapseButton e-icon",{},{display:"none"}).attr("aria-label","toggle collapsed")[0].outerHTML)[0].outerHTML).appendTo(this.element.find(".pivotFieldList").parent()),this.element.find(".e-togglePanel").height(this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+5)+"px").width(14),this.element.find(".e-toggleExpandButton,.e-toggleCollapseButton").css("margin-top",(this.element.find("#"+this._id+"_PivotSchemaDesigner").parents("td:eq(0)").height()-9)/2),this.element.find(".e-togglePanel").children().addClass("e-toggleButtons"),this.model.enableRTL&&this.element.find(".e-pivotschemadesigner").css({"margin-left":"2px","margin-right":"4px"}),this._unWireEvents(),this._wireEvents())),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?(this.model.enableVirtualScrolling&&this.element.find(".e-controlPanel").height(this.element.find(".e-controlPanel").height()-5),this.defaultView(),t.PivotClient.DefaultView.Grid,this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()/2-10)):this.displayMode()==t.PivotClient.DisplayMode.GridOnly?this.model.enablePaging?this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-10):this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-20):this.model.enableVirtualScrolling?this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+30)):this.model.isResponsive?this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+19)):this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+15))),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?this.defaultView()==t.PivotClient.DefaultView.Grid?this.model.isResponsive?this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-10):this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-15):this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-10):this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-15):this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?this.model.isResponsive?this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()-25):this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()-17):(l=this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+20),this.model.enableVirtualScrolling?this.element.find(".e-chartContainer").height(l-5):this.model.isResponsive?this.element.find(".e-chartContainer").height(l-4):this.element.find(".e-chartContainer").height(l-2))),a=this.element.find(".e-chartContainer").height(),this._chartHeight=this.model.enableToolBar?a-68+"px":this.model.isResponsive&&this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid||this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?a-4+"px":a-5+"px":a-3+"px",this._gridHeight=this.model.enableToolBar?this.element.find(".e-gridContainer").height()-46+"px":this.element.find(".e-gridContainer").height()-10+"px",this.model.enableToolBar&&(this.element.find("#"+this._id+"_PivotGridToolbar").height(this._gridHeight),this.element.find("#"+this._id+"_PivotCharttoolBar").height(this._chartHeight))},_performToggleAction:function(e){this.element.find(".e-controlPanel").width(e[0].controlPanelWidth),("horizontal"!=this.controlPlacement()||"horizontal"==this.controlPlacement()&&"chartOnly"==this.displayMode()||"horizontal"==this.controlPlacement()&&"gridOnly"==this.displayMode())&&(this.element.find(".e-pivotchart").width(e[0].chartOuterWidth),this.element.find(".e-pivotgrid").width(e[0].gridOuterWidth),this.element.find("#"+this._id+"_PivotChart").css({width:e[0].chartOuterWidth,overflow:""}),this.element.find("#"+this._id+"_PivotGrid").css({width:e[0].gridOuterWidth}),this.model.enableVirtualScrolling&&this._pivotGrid._applyVScrolling(),t.isNullOrUndefined(this._pivotChart)&&t.isNullOrUndefined(this.otreemapObj)||(this.element.find("#"+this._pivotChart._id).hasClass("e-pivotchart")?(this.element.find("#"+this._pivotChart._id).ejPivotChart("option","width",e[0].chartOuterWidth+"px"),this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)||(this.element.find("#"+this.chartObj._id).ejChart("option",{model:{size:{width:e[0].chartOuterWidth+"px"}}}),this.element.find("#"+this.chartObj._id+"_svg").width(e[0].chartOuterWidth),this.chartObj.redraw())):this.element.find("#"+this._pivotChart._id).hasClass("e-pivottreemap")&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&this.otreemapObj._treeMap.refresh()),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ClientMode&&this._toggleExpand&&!t.isNullOrUndefined(this.chartObj)&&(this.element.find("#"+this._id+"_PivotChartContainer").css("width",this.chartObj.model.size.width),this.chartObj.redraw()),this.model.enableToolBar&&(this.element.find("#"+this._id+"_PivotCharttoolBar").width(this.element.find(".e-chartContainer").width()),this.element.find("#"+this._id+"_PivotGridToolbar").width(this.element.find(".e-gridContainer").width()-10),this.element.find(".e-chartToolBar").width(this.element.find(".e-chartContainer").width()),this.element.find(".e-toolBar").width(this.element.find(".e-gridContainer").width())))},_rwdToggleExpand:function(){this.element.find(".e-csHeader, .e-cubeTable,.e-pivotschemadesigner,.e-toggleExpandButton").show(),this.element.find(".e-toggleCollapseButton").hide(),this.element.find(".e-toggleText").hide(),this._calculateHeight(),this.model.displaySettings.enableFullScreen&&this.element.find("#"+this._id+"_PivotGrid").css("width",""),this._parentElwidth<850&&(this.element.find(".e-outerTable").css({position:"absolute",float:this.model.enableRTL?"right":"left",tableLayout:"auto","z-index":"10000"}),this.element.find(".pivotFieldList").width("91%"),this.element.find("table.e-cubeTable").css({width:"71%"}),this.element.find(".e-csHeader").css({width:"100%"}),this.element.find("#cubeSelector_wrapper").css({width:"100%"}),this.element.find(".controlPanelTD").css({width:this.element.find(".oClientTbl").width()-this.element.find("table.e-cubeTable").width(),float:this.model.enableRTL?"left":"right",left:this.model.enableRTL?"0px":"15px",right:this.model.enableRTL?"15px":"0px",position:"relative"}),this.element.find(".e-controlPanel").css({width:this.element.find(".controlPanelTD").width()-20})),this._parentElwidth>850&&(this.element.find(".controlPanelTD").css({width:"56%",left:"inherit",float:"left","margin-left":"5px"}),this.element.find("table.e-cubeTable").css({width:"98%"}),this.element.find(".e-outerTable,.controlPanelTD").css({position:"inherit"}),"grid"==this._currentTab||"chart"==this._currentTab?e(".e-controlPanel").width(55*e("#"+this._id).width()/100+"px"):e(".e-controlPanel").width("100%"),window.navigator.userAgent.indexOf("Trident")>0?(this.element.find(".e-outerTable").width(43*e("#"+this._id).width()/100),this.element.find(".e-csHeader").width(41*e("#"+this._id).width()/100+"px"),this.element.find("#cubeSelector_wrapper").width(29*e("#"+this._id).width()/100-60+"px"),this.model.enableSplitter||this.element.find(".cubeTableTD, .e-cubeBrowser, .e-cdbHeader").css({width:e(".e-cubeTable").width()/2-4+"px"}),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&this.element.find(".e-gridPanel").width(56*e("#"+this._id).width()/100+"px")):(this.element.find(".e-outerTable").css({width:e("#"+this._id).width()*(this.model.enableVirtualScrolling?41:42)/100+"px",tableLayout:"auto"}),this.element.find(".e-csHeader").css({width:42*e("#"+this._id).width()/100+"px"}),this.element.find("#cubeSelector_wrapper").css({width:32*e("#"+this._id).width()/100-60+"px"}),this.model.enableSplitter||this.element.find(".cubeTableTD, .e-cubeBrowser, .e-cdbHeader").css({width:e(".e-cubeTable").width()/2-4+"px"}),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&this.element.find(".e-gridPanel").css({width:55*e("#"+this._id).width()/100+"px"}))),this.model.isResponsive&&"gridonly"==this.displayMode()&&e(".e-controlPanel").width(55*e("#"+this._id).width()/100+15+"px"),this.model.isResponsive&&"gridonly"==this.displayMode()&&this.element.find(".e-controlPanel").width(55*e("#"+this._id).width()/100+15+"px"),this.model.enableVirtualScrolling&&this._pivotGrid._applyVScrolling(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.enableVirtualScrolling&&this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&(this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()/2-5),this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-10).css("overflow","")),"gridonly"!=this.displayMode()&&(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()?(this.element.find(".e-gridPanel").width(e(".e-controlPanel").width()+8),this.model.enableToolBar?e("#"+this._pivotChart._id).width(e(".e-controlPanel").width()-30):e("#"+this._pivotChart._id).width(e(".e-controlPanel").width()-7),this.model.isResponsive&&"chart"==this._currentTab&&this.element.find(".e-chartContainer").css({width:"98.8%"})):e("#"+this._pivotChart._id).width(e(".e-controlPanel").width()-2),this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),!t.isNullOrUndefined(this.chartObj)&&this.model.displaySettings.enableFullScreen&&(this.chartObj.model.size.width=this.element.find(".e-chartContainer").width()-7,this.chartObj.model.size.height=this.element.find(".e-chartContainer").height(),this.element.find("#"+this._pivotChart._id+"Container").width(this.chartObj.model.size.width)),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),t.isNullOrUndefined(this.chartObj)||("treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw())),this._overflow(),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&this._pivotGrid.element.length>0&&this._pivotGrid._applyFrozenHeaderWidth(this._pivotGrid._JSONRecords)},_overflow:function(){this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.element.find(".e-ellipse").remove(),this.element.find(".e-cdbHeader")[0].scrollHeight>this.element.find(".e-cdbHeader")[0].offsetHeight?(this.element.find(".e-cdbHeader").attr("title",this.element.find(".e-cdbHeader").text()),this.element.find(".e-cdbHeader").after("<span class='e-ellipse' style='margin-top:-"+78*this.element.find(".e-cdbHeader").height()/100+"px'>....</span>")):this.element.find(".e-cdbHeader").removeAttr("title"))},_rwdToggleCollapse:function(){if(this._parentElwidth<850&&(this.element.find(".e-outerTable").css({position:"absolute"}),this.element.find(".controlPanelTD").css({left:this.model.enableRTL?"0px":"35px",right:this.model.enableRTL?"35px":"0px",position:"relative"})),"grid"==this._currentTab?e(".e-controlPanel").css({width:91*e("#"+this._id).width()/100+"px"}):this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?this.element.find(".e-controlPanel").css({width:91*e("#"+this._id).width()/100+"px"}):this.element.find(".e-controlPanel").css({width:"100%"}),this.model.displaySettings.enableFullScreen&&this.element.find("#"+this._id+"_PivotGrid").css("width",""),"chartandgrid"==this.displayMode()&&(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.element.find(".e-gridPanel").css({width:92.65*e("#"+this._id).width()/100+"px"}),e(".e-controlPanel").css({width:91*e("#"+this._id).width()/100+"px"})),this.element.find(".e-csHeader, .e-cubeTable, .e-pivotschemadesigner,.e-toggleExpandButton").hide(),this.element.find(".controlPanelTD").css({left:this.model.enableRTL?"0":"1%",right:this.model.enableRTL?"2%":"0px",position:"relative",width:"95%",tableLayout:"auto",float:""}),this.element.find(".e-gridContainer").length>0&&this.element.find(".e-gridContainer").css({width:this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chart"==this._currentTab?"100%":"99.8%"}),"gridonly"==this.displayMode()&&this.model.isResponsive&&(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.operationalMode,t.PivotGrid.OperationalMode.ServerMode),this.element.find(".e-controlPanel").css({width:91*e("#"+this._id).width()/100+76+"px"})),"chartonly"==this.displayMode()&&this.model.isResponsive&&(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.PivotGrid.OperationalMode.ServerMode?this.element.find(".e-controlPanel").css({width:91*e("#"+this._id).width()/100+87+"px"}):this.element.find(".e-controlPanel").css({width:91*e("#"+this._id).width()/100+86+"px"})),e("#"+this._id).width("100%"),this.element.find(".e-outerTable").css({position:"absolute",width:"0px",tableLayout:"fixed"}),this.element.find(".e-toggleCollapseButton").show(),this.element.find(".e-toggleText").show(),this.model.enableVirtualScrolling&&this._pivotGrid._applyVScrolling(),"gridonly"!=this.displayMode()){if(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()){if(this.model.enableToolBar)e("#"+this._pivotChart._id).width(e(".e-controlPanel").width()-45);else{var i=this.element.find(".e-controlPanel").width()-("grid"==this._currentTab?0:17);e("#"+this._pivotChart._id).width(i),e("#"+this._id+"_PivotChartContainer").width("99.6%")}this.element.find(".e-chartContainer").css({width:"grid"==this._currentTab?"99.2%":"100%"})}else e("#"+this._pivotChart._id).width(e(".e-controlPanel").width()-26),this.displayMode()==t.PivotClient.DisplayMode.ChartOnly&&this.element.find(".e-chartContainer").css({width:"100%"});this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),!t.isNullOrUndefined(this.chartObj)&&this.model.displaySettings.enableFullScreen&&(this.chartObj.model.size.width=this.element.find(".e-chartContainer").width()+"px"!="0px"?this.element.find(".e-chartContainer").width()+"px":this.element.find(".e-pivotchart").width()+"px",this.chartObj.model.size.height=this.element.find(".e-chartContainer").height(),this.element.find("#"+this._pivotChart._id+"Container").width(this.chartObj.model.size.width)),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),t.isNullOrUndefined(this.chartObj)||("treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw())}this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&this._pivotGrid.element.length>0&&this._pivotGrid._applyFrozenHeaderWidth(this._pivotGrid._JSONRecords)},_removeFilterTag:function(i){var l,a=[];if(i&&i.indexOf("].")>=0){if(l=i.split("].").length>2?"levelUniqueName":"hierarchyUniqueName",this._excelFilterInfo.length>0){var r=this.element.find(".cubeSelector").data("ejDropDownList").model.value,o=this.element.find("#reportList").data("ejDropDownList").model.value;this._selectedLevelUniqueName,this._selectedFieldName;this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){if(e.cubeName==r&&e.report==o&&e[l]!=i)return e;a=e.sortOrder})}return a}i&&this._excelFilterInfo.length>0&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(o=this.element.find("#reportList").data("ejDropDownList").model.value,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){if(e.report==o&&e.levelUniqueName!=i)return e}))},_groupLabelChange:function(i){var l,a,r,o;if(this._selectedLevelUniqueName=i.selectedValue,l=[],[],this._excelFilterInfo.length>0){var s=this.element.find(".cubeSelector").data("ejDropDownList").model.value,n=this.element.find("#reportList").data("ejDropDownList").model.value,d=this._selectedLevelUniqueName,h=this._selectedFieldName;l=e.map(this._excelFilterInfo,function(e){if(e.cubeName==s&&e.report==n&&e.hierarchyUniqueName==h&&e.levelUniqueName==d)return{action:e.action,operator:e.operator,value1:e.value1,sortInfo:e.sortOrder}})}a=this.element.find("#clearAllFilters a").children().clone(),this.element.find("#clearAllFilters a").text(this._getLocalizedLabels("ClearFilter")+' from "'+this.element.find(".groupLabelDrop").data("ejDropDownList").model.text+'"').append(a),this.element.find(".e-filterElementTag .e-activeFilter,.e-filterIndicator").remove(),l.length>0&&(t.isNullOrUndefined(l[0].sortInfo)||!t.isNullOrUndefined(l[0].sortInfo)&&0==l[0].sortInfo.length)||0==l.length?this.element.find(".e-clrSort").parents("li:eq(0)").css("opacity","0.5").attr("disable",!0):l[0].sortInfo.length>0&&this.element.find("#"+l[0].sortInfo+" span:eq(0)").addClass("e-selectedSort"),this.element.find(".e-clrFilter").parents("li:eq(0)").css("opacity","0.5").attr("disable",!0),this.element.find("#labelClearFilter").css("opacity","0.5").attr("disable",!0),this.element.find("#valueClearFilter").css("opacity","0.5").attr("disable",!0),l.length>0&&!t.isNullOrUndefined(l[0].operator)?(r="",o="","valuefiltering"==l[0].action?(r="valueFilterBtn",o=o="equals"==l[0].operator||"not equals"==l[0].operator||"less than or equal to"==l[0].operator||"greater than or equal to"==l[0].operator||"greater than"==l[0].operator||"less than"==l[0].operator?"_valueFilter":""):(r="labelFilterBtn",o="equals"==l[0].operator||"not equals"==l[0].operator||"less than or equal to"==l[0].operator||"greater than or equal to"==l[0].operator||"greater than"==l[0].operator||"less than"==l[0].operator?"_labelFilter":""),this.element.find("#"+r+" a:eq(0)").append("<span class='e-filterState e-icon'/>"),this.element.find(".e-clrFilter").parents("li:eq(0)").removeAttr("style disable"),this.element.find("#"+r+" #labelClearFilter").removeAttr("style disable"),this.element.find("#"+r+" #valueClearFilter").removeAttr("style disable"),"BottomCount"==l[0].operator.replace(/ /g,"")?this.element.find("#"+r+" li#"+l[0].operator.replace(/ /g,"").replace("Bottom","top")+" a").append(e(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML)):this.element.find("#"+r+" li#"+l[0].operator.replace(/ /g,"")+o+" a").append(e(t.buildTag("span.e-activeFilter e-icon")[0].outerHTML))):""!=this._getUnSelectedNodes()&&this.element.find(".e-clientDialog").prepend("<div class='e-filterIndicator e-icon' style='margin-top:120px' />")},_filterElementClick:function(i){var l,a,r,o;if(e(i.element).hasClass("clearFilter")&&"0.5"==e(i.element).css("opacity"))return i.Cancel;this._selectedLevelUniqueName=this.element.find(".groupLabelDrop").data("ejDropDownList").model.value||this.element.find(".groupLabelDrop").data("ejDropDownList").model.dataSource[0].value;var s=this.element.find(".cubeSelector").length>0?this.element.find(".cubeSelector").data("ejDropDownList").model.value:"",n=this.element.find("#reportList").data("ejDropDownList").model.value,d=this._selectedLevelUniqueName,h=this._selectedFieldName;if("labelClearFilter"!=e(i.element).attr("id")&&"valueClearFilter"!=e(i.element).attr("id")&&!e(i.element).parent(".e-filterElementTag").length>0)l=e(i.element).parents("li:eq(0)#valueFilterBtn").length>0?"valueFilterDlg":"labelFilterDlg",a=[],this._excelFilterInfo.length>0&&"true"!=e(i.element).siblings("li:eq(0)").attr("disable")&&(a=e.map(this._excelFilterInfo,function(e){if(e.cubeName==s&&e.report==n&&e.hierarchyUniqueName==h&&e.levelUniqueName==d)return{value1:e.value1,value2:e.value2,operator:e.operator,measure:e.measure}}),e(i.element).attr("id").replace("_labelFilter","").replace("_valueFilter","")!=a[0].operator.replace(/ /g,"")&&a.length>0&&(a=[])),this._schemaData&&(this._schemaData._selectedLevelUniqueName=this._selectedLevelUniqueName,this._schemaData.selectedFieldName=this._selectedFieldName),t.Pivot.createAdvanceFilterTag({action:l,selectedArgs:i,filterInfo:a},this);else if("descOrder"==e(i.element).attr("id")||"ascOrder"==e(i.element).attr("id")||e(i.element).find(".e-clrSort").length>0){if(r=!1,this._excelFilterInfo.length>0){s=this.element.find(".cubeSelector").data("ejDropDownList").model.value,n=this.element.find("#reportList").data("ejDropDownList").model.value,d=this._selectedLevelUniqueName,h=this._selectedFieldName;this._excelFilterInfo=e.grep(this._excelFilterInfo,function(t){return t.cubeName==s&&t.report==n&&t.hierarchyUniqueName==h&&t.levelUniqueName==d&&(r=!0,0==e(i.element).find(".e-clrSort").length?t.sortOrder=e(i.element).attr("id"):delete t.sortOrder),t})}r||this._excelFilterInfo.push({cubeName:this.element.find(".cubeSelector").length>0?this.element.find(".cubeSelector").data("ejDropDownList").model.value:"",report:this.element.find("#reportList").data("ejDropDownList").model.value,hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:e(i.element).attr("id")}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filterElement,JSON.stringify({action:"labelSorting",clientParams:this._selectedFieldName+"--"+e(i.element).attr("id"),olapReport:this.currentReport,clientReports:this.reports,customObject:JSON.stringify(this.model.customObject)}),this._filterElementSuccess)}else o=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({cubeName:this.element.find(".cubeSelector").length>0?this.element.find(".cubeSelector").data("ejDropDownList").model.value:"",report:this.element.find("#reportList").data("ejDropDownList").model.value,hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,sortOrder:o}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filterElement,JSON.stringify({action:"labelfiltering",clientParams:this._selectedLevelUniqueName+"--Clear Filter",olapReport:this.currentReport,clientReports:this.reports,customObject:JSON.stringify(this.model.customObject)}),this._filterElementSuccess)},_filterOptionChanged:function(e){var i=this.element.find("#filterDialog_wrapper .e-titlebar").text().indexOf("Value")>=0?"valueFilterDlg":"labelFilterDlg";"valueFilterDlg"==i&&t.Pivot.createAdvanceFilterTag({action:i,selectedArgs:e,filterInfo:[]},this)},_filterElementOkBtnClick:function(){var e,i=this;t.isNullOrUndefined(this._waitingPopup)||(i._isTimeOut=!0,setTimeout(function(){i._isTimeOut&&i._waitingPopup.show()},800));var l,a,r=this.element.find("#filterOptions").data("ejDropDownList").model.value||this.element.find("#filterOptions")[0].value,o=this.element.find("#filterValue1")[0].value,s=this.element.find("#filterValue2").length>0?this.element.find("#filterValue2")[0].value:"",n="labelfiltering";a=this._selectedLevelUniqueName+"--"+r+"--"+o,this.element.find(".filterMeasures").length>0&&(this.element.find("#filterValue2").length>0&&(a=a+","+s),a=a+"--"+(l=this.element.find(".filterMeasures").data("ejDropDownList").model.value),n="valuefiltering"),e=this._removeFilterTag(this._selectedLevelUniqueName),this._excelFilterInfo.push({cubeName:this.element.find(".cubeSelector").length>0?this.element.find(".cubeSelector").data("ejDropDownList").model.value:"",report:this.element.find("#reportList").data("ejDropDownList").model.value,action:n,hierarchyUniqueName:this._selectedFieldName,levelUniqueName:this._selectedLevelUniqueName,operator:r,measure:l,value1:o,value2:s,sortOrder:e}),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.filterElement,JSON.stringify({action:n,clientParams:a,olapReport:this.currentReport,clientReports:this.reports,customObject:JSON.stringify(this.model.customObject)}),this._filterElementSuccess)},_splitButtonDropped:function(i,l){var a,r,o,s;this.isDropped=!0;var n=this,d="Series"==i?"row":i.toLowerCase(),h=this.element.find("button.dragClone").attr("title");return""==e.trim(l)&&this.element.find(".e-"+d+"Axis").find("button:last").attr("title")==h||""!=e.trim(l)&&this.element.find(e(".e-"+d+"Axis").find(".e-splitBtn")[l]).attr("data-tag").split(":")[1].replace("."," - ")==h||"slicer"==d&&""!=e.trim(l)&&this.element.find(".e-"+d+"Axis").find("button[title="+JSON.stringify(h).replace(/"/g,"'")+"]").length>0?(this.element.find("button.dragClone").remove(),!1):"slicer"==d&&null!=this.draggedSplitBtn&&(e(this.draggedSplitBtn).parent("div:eq(0)").attr("data-tag").indexOf("Measure")>-1||e(this.draggedSplitBtn).parent("div:eq(0)").attr("data-tag").indexOf("KPIs")>-1)&&(this.element.find(".e-splitBtn[tag*=Measures]").length>1||this.element.find(".e-splitBtn[data-tag*=KPIs]").length>=1)?(a=(e(this.draggedSplitBtn).parent("div:eq(0)").attr("data-tag").indexOf("KPIs")>-1||e(this.draggedSplitBtn).parent("div:eq(0)").attr("data-tag").indexOf("Measure")>-1)&&this.element.find(".e-splitBtn[data-tag*=KPIs]").length>=1?this._getLocalizedLabels("KpiAlertMsg"):this._getLocalizedLabels("MultipleMeasure"),this.element.find("button.dragClone").remove(),t.Pivot._createErrorDialog(a,this._getLocalizedLabels("Warning"),this),!1):((""==e.trim(l)||null!=this.draggedSplitBtn&&this.element.find(e(".e-"+d+"Axis").find(".e-splitBtn")[l]).attr("data-tag").split(":")[1].replace("."," - ")!=h)&&(r=this.element.find(".e-cubeName").html()+"--"+e(this.draggedSplitBtn).parent("div:eq(0)").attr("data-tag")+"--"+i+"--"+l,this.model.enableAdvancedFilter&&"Slicer"==i&&(o=e(this.draggedSplitBtn).parent("div:eq(0)").attr("data-tag").split(":")[1].split("."),this._setUniqueNameFrmBtnTag(o),this._removeFilterTag(this._selectedFieldName)),this.element.find("button.dragClone").remove(),this.draggedSplitBtn=null,this._isTimeOut=!0,setTimeout(function(){n._isTimeOut&&n._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),s=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,JSON.stringify({action:"nodeDropped",dropType:"SplitButton",nodeInfo:r,olapReport:this.currentReport,clientReports:this.reports,customObject:s}),this._nodeDroppedSuccess)),void(this._isNodeOrButtonDropped=!0))},_filterElementSuccess:function(e){this._isSearchApplied=!1,t.Pivot.closePreventPanel(this),e[0]!=i?(this.currentReport=e[0].Value,this.reports=e[1].Value,null!=e[2]&&e[2]!=i&&(this.model.customObject=e[2].Value)):e.d!=i?(this.currentReport=e.d[0].Value,this.reports=e.d[1].Value,null!=e.d[2]&&e.d[2]!=i&&(this.model.customObject=e.d[2].Value)):(this.currentReport=e.UpdatedReport,this.reports=e.ClientReports,null!=e.customObject&&e.customObject!=i&&(this.model.customObject=e.customObject)),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"filtering",element:this.element,customObject:this.model.customObject}),this._renderControls(),this._unWireEvents(),this._wireEvents(),this._successAction="Filter",this._trigger("renderSuccess",this)},_maxViewBtnClick:function(){var i,l=e(window).width()-150,a=e(window).height()-100;t.isNullOrUndefined(this._pivotChart)||(this._maxInitialChartHeight=this.element.find("#"+this._pivotChart._id+"Container").height(),this._maxInitialChartWidth=this.element.find("#"+this._pivotChart._id+"Container").width()-7),this._maxInitialGridWidth=this.element.find("#"+this._id+"_PivotGrid").width();var r=t.buildTag("div.e-fullScreenView","",{width:e(document).width(),height:e(document).height()}),o=t.buildTag("div#"+this._id+"_maxView.e-maximumView","",{width:l,height:a}),s=t.buildTag("div#Winclose.e-winCloseBtn e-icon","").attr("role","button").attr("aria-label","close").attr("clientID",this._id);this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),this.displayMode()==t.PivotClient.DisplayMode.ChartOnly&&(e("#"+this._pivotChart._id+"Container_svg")[0]||e("#"+this.otreemapObj._id+"TreeMapContainer").children().length>0)&&(this._fullScreenView(100,160),t.isNullOrUndefined(this.chartObj)||"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()&&(e("#"+this.otreemapObj._id).css({width:"99%"}),e("#"+this.otreemapObj._id+"TreeMapContainer").css({width:"100%"})),o.append(this.element.find("#"+this._id+"_PivotChart"))),this.displayMode()==t.PivotClient.DisplayMode.GridOnly&&o.append(this.element.find("#"+this._id+"_PivotGrid").css({"max-height":a,width:l,overflow:"auto"})),this.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&"chartandgrid"==this.displayMode()?"grid"==this._currentTab?o.append(this.element.find("#"+this._id+"_PivotGrid").css({"max-height":a,width:l})):"chart"==this._currentTab&&(e("#"+this._pivotChart._id+"Container_svg")[0]||e("#"+this.otreemapObj._id+"TreeMapContainer").children().length>0)&&(this._fullScreenView(100,160),t.isNullOrUndefined(this.chartObj)||"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()&&(e("#"+this.otreemapObj._id).css({width:"99%"}),e("#"+this.otreemapObj._id+"TreeMapContainer").css({width:"100%"})),o.append(this.element.find("#"+this._id+"_PivotChart"))):this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&(i=e(window).height()/2-50,this.element.find("#"+this._id+"_PivotGrid").css({"max-height":i,"margin-left":"0px",overflow:"auto"}),t.isNullOrUndefined(this.chartObj)||"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()&&(e("#"+this.otreemapObj._id).css({width:"99%"}),e("#"+this.otreemapObj._id+"TreeMapContainer").css({width:"100%"})),this._fullScreenView(50,160),(e("#"+this._pivotChart._id+"Container_svg")[0]||e("#"+this.otreemapObj._id+"TreeMapContainer").children().length>0)&&("chart"==this.defaultView()?o.append(this.element.find("#"+this._id+"_PivotChart")).append(this.element.find("#"+this._id+"_PivotGrid").width(e(window).width()-160)):o.append(this.element.find("#"+this._id+"_PivotGrid").width(e(window).width()-160)).append(this.element.find("#"+this._id+"_PivotChart"))),o.append(this.element.find("#"+this._id+"_PivotGrid").width(e(window).width()-160))),o.append(s),r.append(o),e("body").append(r),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(t.isNullOrUndefined(this.chartObj)||(this.model.enablePivotTreeMap&&"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw()))},_maxViewClsBtnClick:function(){var i=e(".e-fullScreenView");this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.operationalMode,t.Pivot.OperationalMode.ServerMode);i.find("#"+this._id+"_PivotGrid").css("margin-left","7px"),i.find("#"+this._id+"_PivotChart").appendTo(this.element.find(".e-chartContainer")),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),this.displayMode()==t.PivotClient.DisplayMode.ChartOnly&&e("#"+this._pivotChart._id+"Container_svg")[0]&&this._fullScreenViewCls(this._maxInitialChartHeight,this._maxInitialChartWidth+(this.model.isResponsive?7:0)),this.displayMode()==t.PivotClient.DisplayMode.GridOnly&&i.find("#"+this._id+"_PivotGrid").css({width:"inherit","max-height":"",overflow:"initial"}),this.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&"chartandgrid"==this.displayMode()&&("chart"==this._currentTab&&e("#"+this._pivotChart._id+"Container_svg")[0]?this._fullScreenViewCls(this._maxInitialChartHeight,this._maxInitialChartWidth-(this.model.isResponsive?7:0)):i.find("#"+this._id+"_PivotGrid").css({"max-height":"",width:this._maxInitialGridWidth+"px"})),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&(e("#"+this._pivotChart._id+"Container_svg")[0]?(this._fullScreenViewCls(this._maxInitialChartHeight,this._maxInitialChartWidth-(this.model.isResponsive?7:0)),i.find("#"+this._id+"_PivotGrid").css({width:this._maxInitialGridWidth+"px","max-height":"",overflow:"auto"})):i.find("#"+this._id+"_PivotGrid").css({"max-height":"",width:this._maxInitialGridWidth+"px"})),this.enableTogglePanel()&&(0==this.element.find(".e-cubeTable").is(":visible")||0==this.element.find(".e-outerTable").is(":visible"))&&i.find("#"+this._id+"_PivotGrid").css("width",this._maxInitialGridWidth+"px"),i.find("#"+this._id+"_PivotGrid").appendTo(this.element.find(".e-gridContainer")),e(".e-maximumView").remove(),e(".e-fullScreenView").remove(),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(t.isNullOrUndefined(this.chartObj)||(this.model.enablePivotTreeMap&&"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw()))},_enableResponsive:function(){this.element.find(".outerPanel").css({width:"100%"}),e(".e-pivotclient").css({width:"100%"}),this.element.find(".e-outerTable").css({float:this.model.enableRTL?"right":"left"}),this.model.enableSplitter&&this.element.find(".e-cdbHeader, .e-cubeBrowser").css("width","99%"),this.element.find(".e-rowAxis, .e-slicerAxis, .e-categoricalAxis").width("99%"),this.element.find(".controlPanelTD").width("56%"),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&this.element.find(".controlPanelTD").css("display","inline-block"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?(this.element.find(".e-cubeTable").width("100%"),this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?this.element.find(".e-pivotschemadesigner").width("95%"):this.element.find(".e-pivotschemadesigner").width("100%")):this.element.find(".e-cubeTable").width("98%"),window.navigator.userAgent.indexOf("Trident")>0?("grid"==this._currentTab?e(".e-controlPanel").css({width:55*e("#"+this._id).width()/100+"px"}):e(".e-controlPanel").css({width:"99%"}),this.element.find(".e-outerTable").width(39*e("#"+this._id).width()/100),this.element.find(".e-csHeader").width(38*e("#"+this._id).width()/100),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&this.element.find(".e-gridPanel").width(55*e("#"+this._id).width()/100)):(this.element.find(".e-outerTable").width(38*e("#"+this._id).width()/100),this.element.find(".e-csHeader").width(38*e("#"+this._id).width()/100))},_fullScreenView:function(l,a){var r,o;null!=this._pivotChart&&this._pivotChart!=i&&e("#"+this._pivotChart._id+"Container_svg")[0]&&(this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),r=this.chartObj.model.size.width=this._pivotChart.model.size.width=e(window).width()-a+"px",o=this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()?this._pivotChart.model.size.height=this.chartObj.model.size.height=e(window).height()/2-l+"px":this._pivotChart.model.size.height=this.chartObj.model.size.height=e(window).height()-l+"px",this.element.find("#"+this._id+"_PivotChart").css({"min-height":o,width:r}),this.element.find("#"+this._id+"_PivotChartContainer").css({width:r,height:o}),this.chartObj.redraw())},_fullScreenViewCls:function(e,l){var a,r;null!=this._pivotChart&&this._pivotChart!=i&&(this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),a=this.chartObj.model.size.height=this._pivotChart.model.size.height=e+"px",r=this.enableTogglePanel()&&0==this.element.find(".e-cubeTable").is(":visible")&&0==this.element.find(".e-outerTable").is(":visible")?this.chartObj.model.size.width=this._pivotChart.model.size.width="950px":this.chartObj.model.size.width=this._pivotChart.model.size.width=l+"px",this.element.find("#"+this._id+"_PivotChart").css({"min-height":a,width:r}),this.element.find("#"+this._pivotChart._id+"Container").width(r),this.displayMode()==t.PivotClient.DisplayMode.ChartOnly&&this.element.find("#"+this._pivotChart._id+"Container").height(a),this.chartObj.redraw())},_calcMemberDroppedSuccess:function(e){var t;if(e[0]!=i){for(t=0;t<e.length;t++)if("calcMemberTreeData"==e[t].Key){this._calcMembers=JSON.parse(e[t].Value),e.splice(t,1);break}}else if(e.d!=i){for(t=0;t<e.d.length;t++)if("calcMemberTreeData"==e.d[t].Key){this._calcMembers=JSON.parse(e.d[t].Value),e.d.splice(t,1);break}}else this._calcMembers=JSON.parse(e.calcMemberTreeData),delete e.calcMemberTreeData;this._calcMemberTreeViewUpdate(),this._nodeDroppedSuccess(e)},_nodeDroppedSuccess:function(l){var a,r,o,s,n,d,h,c;if(l[0]!=i?(a=l[0].Value,r=l[1].Value,o=l[2].Value,this.currentReport=l[3].Value,this.reports=l[4].Value,null!=l[5]&&l[5]!=i&&(this.model.customObject=l[5].Value)):l.d!=i?(a=l.d[0].Value,r=l.d[1].Value,o=l.d[2].Value,this.currentReport=l.d[3].Value,this.reports=l.d[4].Value,null!=l.d[5]&&l.d[5]!=i&&(this.model.customObject=l.d[5].Value)):(a=l.Columns,r=l.Rows,o=l.Slicers,this.currentReport=l.UpdatedReport,this.reports=l.ClientReports,null!=l.customObject&&l.customObject!=i&&(this.model.customObject=l.customObject)),this._isRemoved&&(this._isRemoved=!1,s=[],a.length>0&&s.push(a),r.length>0&&s.push(r),o.length>0&&s.push(o),s.length>0))for(n=0;n<s.length;n++)if(h=s[n],!t.isNullOrUndefined(h))for(c=0;c<h.split("#").length;c++)d=""==h.split("#")[c]||"Measures"==h.split("#")[c]?null:h.split("#")[c].split(".").length>0?h.split("#")[c].replace("."," - "):h.split("#")[c],t.isNullOrUndefined(d)||0!=this._currentReportItems.length&&this._treeViewData.hasOwnProperty(d)&&(delete this._treeViewData[d],this._currentReportItems.splice(e.inArray(d,this._currentReportItems),1));null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find(".e-splitBtn, .e-btn").remove(),e(this._createSplitButtons(a,"Columns")).appendTo(".e-categoricalAxis"),e(this._createSplitButtons(r,"Rows")).appendTo(".e-rowAxis"),e(this._createSplitButtons(o,"Slicers")).appendTo(".e-slicerAxis"),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find("button").ejButton({height:"20px",type:t.ButtonType.Button}),this._setSplitBtnTitle(),this.model.showUniqueNameOnPivotButton&&(e(".e-pvtBtn").addClass("e-splitBtnUnique"),this._addSplitButtonHeight()),this._renderControls(),this._unWireEvents(),this._wireEvents(),this._successAction="NodeDrop",this._trigger("renderSuccess",this),this._buttonContextMenu()},_buttonContextMenu:function(){var i=t.buildTag("ul.pivotTree#pivotTree",t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToColumn"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToRow"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToSlicer"))[0].outerHTML)[0].outerHTML)[0].outerHTML;this.element.append(i),e("#pivotTree").ejMenu({menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:this.element.find(".e-button"),click:t.proxy(this._contextClick,this),beforeOpen:t.proxy(this._contextOpen,this),close:t.proxy(t.Pivot.closePreventPanel,this)})},_editorTreeInfoSuccess:function(e){e[0]!=i?null!=e[2]&&e[2]!=i&&(this.model.customObject=e[2].Value):e.d!=i?null!=e.d[2]&&e.d[2]!=i&&(this.model.customObject=e.d[2].Value):null!=e.customObject&&e.customObject!=i&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"fetchMemberTreeNodes",element:this.element,customObject:this.model.customObject}),this._createDialog(this._args_className,this._args_innerHTML,e),this._isTimeOut=!1,this._waitingPopup.hide(),this._successAction="EditorTreeInfo",this._trigger("renderSuccess",this),this.element.find(".e-dialog .e-text:visible").first().length>0?this._curFocus.editor=this.element.find(".e-dialog .e-text:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"):this.element.find(".e-dialog .e-measureEditor:visible").first().length>0&&(this._curFocus.editor=this.element.find(".e-dialog .e-measureEditor:visible").first().attr("tabindex","-1").focus().addClass("e-hoverCell"))},_generateAllMember:function(t,i){this.olapCtrlObj._allMember=e(e(i).find("Axis:eq(0) Tuple:eq(0)").children().children()[1]).text()},generateJSON:function(i){this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this._pivotChart.model.analysisMode=this.model.analysisMode,this._pivotChart.model.operationalMode=this.model.operationalMode,this._pivotChart.model.dataSource=this.model.dataSource,this._pivotChart.setPivotEngine(i.tranposeEngine),this._pivotChart._drillAction="",this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&""!=this._pivotGrid._drillAction?(this._setChartDrillMembers(i.tranposeEngine,this._pivotGrid._drillAction),this._drillInfo=[]):this._pivotChart.generateJSON(this,i.tranposeEngine),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this._pivotChart._drilledCellSet=this._drilledCellSet.length>0?this._drilledCellSet:[],this._pivotChart.XMLACellSet=this.XMLACellSet.length>0?this.XMLACellSet:[]),this._pivotChart._drillAction=""),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&(this._pivotGrid.model.analysisMode=this.model.analysisMode,this._pivotGrid.model.operationalMode=this.model.operationalMode,this._pivotGrid.model.dataSource=this.model.dataSource,this._pivotGrid.setJSONRecords(JSON.stringify(i.jsonObj)),this._pivotGrid.model.collapsedMembers=null,"excellikelayout"==this.model.gridLayout?this._pivotGrid.excelLikeLayout(i.jsonObj):this._pivotGrid.renderControlFromJSON(),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this._pivotGrid._drilledCellSet=this._drilledCellSet.length>0?this._drilledCellSet:[],this._pivotGrid.XMLACellSet=this.XMLACellSet.length>0?this.XMLACellSet:[]),this._pivotGrid._drillAction=""),this._pivotSchemaDesigner&&this._pivotSchemaDesigner._refreshPivotButtons(),this.model.showUniqueNameOnPivotButton&&(e(".e-pivotButton").addClass("e-pvtBtnUnique"),e(".e-pvtBtn").addClass("e-schemaBtnUnique"),e(".e-removeClientPivotBtn").addClass("e-schemaRemoveBtnUnqiue")),this.model.isResponsive&&this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)||this.element.find("#"+this.chartObj._id).ejChart("option",{model:{size:{height:this._chartHeight}}}))},_renderLayout:function(){var i,l,a,r;(this.model.isResponsive||this.model.collapseCubeBrowserByDefault)&&(this.model.displaySettings.enableTogglePanel=!0),i=t.buildTag("div.e-reportToolbar#reportToolbar",this._reportToolbar(),{width:"410px",height:"29px"})[0].outerHTML,this.model.enableSplitter?this.model.isResponsive?this.model.isResponsive&&(l=t.buildTag("div#"+this._id+"_PivotSchemaDesigner.pivotFieldList","",{}).addClass("e-splitresponsive")[0].outerHTML,a=t.buildTag("div.outerPanel","").append(t.buildTag("div.e-titleText",t.buildTag("span",this.title(),{"padding-left":"10px"})[0].outerHTML)[0].outerHTML+i+t.buildTag("table.oClientTbl",t.buildTag("tr",t.buildTag("td",t.buildTag("table.e-outerTable",t.buildTag("tr",t.buildTag("td",l).attr("width","100%")[0].outerHTML).attr("width","100%")[0].outerHTML)[0].outerHTML+t.buildTag("table.controlPanelTD",t.buildTag("tr",t.buildTag("td",this._controlPanel())[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{width:"100%"})[0].outerHTML)):this.model.enableRTL&&!this.model.enableVirtualScrolling?(l=t.buildTag("div#"+this._id+"_PivotSchemaDesigner.pivotFieldList","",{}).attr("class","e-childsplit")[0].outerHTML,a=t.buildTag("div.outerPanel","",{}).append("<div class=\"e-titleText\"><span style='padding-left:10px'>"+this.model.title+"</span></div>"+i+"<table class=\"e-outerTable\" style='width:100%'><tr class='e-parentsplit' style='width:100%'><td class=\"controlPanelTD\" style='width:50%'>"+this._controlPanel()+"</td><td style='width:50%'>"+l+"</td></tr></table>")):this.model.enableVirtualScrolling||this.model.enableRTL&&this.model.enableVirtualScrolling?(l=t.buildTag("div#"+this._id+"_PivotSchemaDesigner.pivotFieldList","",{}).attr("class","e-childsplit")[0].outerHTML,a=t.buildTag("div.outerPanel","",{}).append("<div class=\"e-titleText\"><span style='padding-left:10px'>"+this.model.title+"</span></div>"+i+"<table class=\"e-outerTable\" style='width:100%'><tr style='width:98%'><td style='width:49%'>"+l+"</td><td class=\"controlPanelTD\" style='width:49%'>"+this._controlPanel()+"</td>"+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:"")+"</tr></table>")):(l=t.buildTag("div#"+this._id+"_PivotSchemaDesigner.pivotFieldList","",{}).attr("class","e-childsplit")[0].outerHTML,a=t.buildTag("div.outerPanel","",{}).append("<div class=\"e-titleText\"><span style='padding-left:10px'>"+this.model.title+"</span></div>"+i+"<table class=\"e-outerTable\" style='width:100%'><tr class='e-parentsplit' style='width:100%'><td style='width:50%'>"+l+"</td><td class=\"controlPanelTD\" style='width:50%'>"+this._controlPanel()+"</td></tr></table>")):this.model.isResponsive?this.model.isResponsive&&(l=t.buildTag("div#"+this._id+"_PivotSchemaDesigner.pivotFieldList","",{})[0].outerHTML,a=t.buildTag("div.outerPanel","").append((""!=e.trim(this.model.title)?t.buildTag("div.e-titleText",t.buildTag("span",this.title(),{"padding-left":"10px"})[0].outerHTML)[0].outerHTML:"")+i+t.buildTag("table.oClientTbl",t.buildTag("tr",t.buildTag("td",t.buildTag("table.e-outerTable",t.buildTag("tr",t.buildTag("td",l)[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("table.controlPanelTD",t.buildTag("tr",t.buildTag("td",this._controlPanel())[0].outerHTML+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{width:"100%"})[0].outerHTML)):(l=t.buildTag("div#"+this._id+"_PivotSchemaDesigner.pivotFieldList","",{})[0].outerHTML,a=t.buildTag("div.outerPanel","",{}).append((""!=e.trim(this.model.title)?"<div class=\"e-titleText\"><span style='padding-left:10px'>"+this.model.title+"</span></div>":"")+i+"<table class=\"e-outerTable\" style='display:block'><tr><td>"+l+"</td><td class=\"controlPanelTD\"style='display:block'>"+this._controlPanel()+"</td>"+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:"")+"</tr></table>")),this.element.html(a),this.element.find(".e-reportToolbar").ejToolbar({enableRTL:this.model.enableRTL,height:"35px"}),this._calculateSize(),this.model.enableRTL&&this.element.addClass("e-rtl"),(this.enableTogglePanel()&&!this.model.enableSplitter||this.model.isResponsive)&&(this.element.find(".e-controlPanel").width(this.element.width()-(this.element.width()/3+(this.model.enableVirtualScrolling?39:20))),e(t.buildTag("div.e-togglePanel",t.buildTag("div.e-toggleExpandButton e-icon","",{}).attr("aria-label","toggle expanded")[0].outerHTML+t.buildTag("div.e-toggleCollapseButton e-icon",{},{display:"none"}).attr("aria-label","toggle collapsed")[0].outerHTML)[0].outerHTML).appendTo(this.element.find(".pivotFieldList").parent())),(this.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&this.defaultView()==t.PivotClient.DefaultView.Grid||this.displayMode()==t.PivotClient.DisplayMode.GridOnly)&&this.element.find(".e-chartTypesImg").addClass("e-chartTypesOnGridView"),this.model.enableSplitter&&this.model.enableRTL?this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?this.element.find(".e-controlPanel").css("right",-3):this.element.find(".e-controlPanel").css("right",7):this.element.find(".e-controlPanel").css("right",3),r="<div class ='reportList' ><input type='text' id='reportList' class='reportlist' title='"+this._getLocalizedLabels("ReportList")+"'/></div>",e(this.element).find(".e-reportCol").append(r),this.model.showReportCollection&&this._fetchCollectionList()},_calculateSize:function(){var i,l,a,r;e(this.element).height(this.model.size.height).width(this.model.size.width),this.model.isResponsive||e(this.element).height(e(this.element).height()<500?500:e(this.element).height()),e(this.element).width(e(this.element).width()<600?600:e(this.element).width()),i=this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+5),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(this.model.isResponsive||this.model.enableSplitter||(a=this.element.width()/2.5,this.element.find(".e-csHeader").width(a+15),this.element.find(".axisBuilderTD").width(a/2),this.element.find(".e-cdbHeader, .e-cubeBrowser").width(a/2),this.element.find(".e-controlPanel").width(this.element.width()-(a+25))),this.model.enableVirtualScrolling?this.element.find(".e-controlPanel").height(i-15):this.model.enablePaging?this.element.find(".e-controlPanel").height(i-5):this.element.find(".e-controlPanel").height(i),this.element.find(".e-cubeTable").height(this.element.height()-((this.element.find("div.e-titleText").length>0?50:0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+38)),this.model.isResponsive?(this.element.find(".e-cubeBrowser").height(this.element.find(".e-cubeTable").height()-this.element.find(".e-cdbHeader").height()),this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-(56+(this.model.enableMeasureGroups?35:0))),l=this.element.find(".e-cubeTable").height()-(3*this.element.find(".e-axisHeader").height()+4)):(this.element.find(".cdbTD, .cubeTableTD").height(this.element.find(".e-cubeTable").height()),this.element.find(".e-cubeBrowser").height(this.element.find(".cdbTD, .cubeTableTD").height()+9-this.element.find(".e-cdbHeader").height()),this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-(61+(this.model.enableMeasureGroups?30:0))),l=this.element.find(".e-cubeTable").height()-(3*this.element.find(".e-axisHeader").height()+(this.model.enableSplitter?14:3))),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").height(l/3)):(this.model.isResponsive||this.model.enableSplitter||(this.element.find(".e-outerTable").width(this.element.width()),this.element.find(".e-controlPanel").width(this.element.width()*(2/3)),this.enableTogglePanel()&&this.element.find(".pivotFieldList").length>0&&this.element.find(".e-controlPanel").width(this.element.width()-(this.element.width()/3+(this.model.enableVirtualScrolling?39:20)))),this.element.find(".controlPanelTD, .e-outerTable").height(i),this.model.enableVirtualScrolling?this.element.find(".e-controlPanel").height(i-20):this.element.find(".e-controlPanel").height(i)),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?(this.model.enableVirtualScrolling&&this.element.find(".e-controlPanel").width(this.element.find(".e-controlPanel").width()-5),this.defaultView()==t.PivotClient.DefaultView.Grid?(this.model.enablePaging?this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()/2+5):this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()/2-10),this.model.isResponsive||this.model.enableSplitter||this.element.find(".e-gridContainer").width(this.element.find(".e-controlPanel").width()-15)):(this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()/2-10),this.model.isResponsive||this.model.enableSplitter||this.element.find(".e-gridContainer").width(this.element.find(".e-controlPanel").width()-(this.enableTogglePanel()&&"chart"==this._currentTab?15:16)))):this.displayMode()==t.PivotClient.DisplayMode.GridOnly?(this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode?12:14)),this.model.isResponsive||this.model.enableSplitter||this.element.find(".e-gridContainer").width(this.element.find(".e-controlPanel").width()-15)):this.model.enableVirtualScrolling?this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+30)):this.element.find(".e-gridContainer").height(this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+17))),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?this.defaultView()==t.PivotClient.DefaultView.Grid?(this.model.enablePaging?this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2+15):this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-10),this.model.isResponsive||this.model.enableSplitter||this.element.find(".e-chartContainer").width(this.element.find(".e-controlPanel").width()-21)):(this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()/2-15),this.model.isResponsive||this.model.enableSplitter||this.element.find(".e-chartContainer").width(this.element.find(".e-controlPanel").width()-20)):this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?(this.element.find(".e-chartContainer").height(this.element.find(".e-controlPanel").height()-22),this.model.isResponsive||this.model.enableSplitter||this.element.find(".e-chartContainer").width(this.element.find(".e-controlPanel").width()-20)):(r=this.element.find(".e-controlPanel").height()-(this.element.find("ul.clientTab").height()+20),this.model.enableVirtualScrolling?this.element.find(".e-chartContainer").height(r-5):this.model.enablePaging?this.element.find(".e-chartContainer").height(r):this.element.find(".e-chartContainer").height(r-2))),this._chartHeight=this.model.enableToolBar?(this.model.enablePaging?this.element.find(".e-chartContainer").height()-105:this.element.find(".e-chartContainer").height()-68)+"px":(this.model.enablePaging?this.element.find(".e-chartContainer").height()-40:"chart"==this.defaultView()?this.element.find(".e-chartContainer").height()-3:this.element.find(".e-chartContainer").height()-2)+"px",this._chartWidth=this.model.isResponsive||this.model.enableSplitter?"99%":this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-chartContainer").width()-7+"px":this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid||this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?this.element.find(".e-chartContainer").width()-8+"px":this.element.find(".e-chartContainer").width()-15+"px",this._gridHeight=this.model.enableToolBar?this.model.enablePaging?this.element.find(".e-gridContainer").height()-78+"px":this.element.find(".e-gridContainer").height()-46+"px":this.element.find(".e-gridContainer").height()-10+"px",this._gridWidth=this.model.isResponsive||this.model.enableSplitter?"98%":!this.model.enableToolBar||this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-gridContainer").width()-6+"px":this.element.find(".e-gridContainer").width()-16+"px"},_reportToolbar:function(){return t.buildTag("ul",(this.model.toolbarIconSettings.enableNewReport?t.buildTag("li.e-newReportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("NewReport")).attr({title:this._getLocalizedLabels("NewReport"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableAddReport?t.buildTag("li.e-addReportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("AddReport")).attr({title:this._getLocalizedLabels("AddReport"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableRemoveReport?t.buildTag("li.e-removeReportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("RemoveReport")).attr({title:this._getLocalizedLabels("RemoveReport"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableRenameReport?t.buildTag("li.e-renameReportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("RenameReport")).attr({title:this._getLocalizedLabels("RenameReport"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableDBManipulation?t.buildTag("li.e-reportDBImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("DBReport")).attr({title:this._getLocalizedLabels("DBReport"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableMDXQuery&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?t.buildTag("li.e-mdxImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("MDXQuery")).attr({title:this._getLocalizedLabels("MDXQuery"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableDeferUpdate&&this.model.enableDeferUpdate&&this.model.analysisMode!=t.Pivot.AnalysisMode.Pivot&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?t.buildTag("li.e-autoExecuteImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("DeferUpdate")).attr({title:this._getLocalizedLabels("DeferUpdate"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableCalculatedMember?t.buildTag("li.e-calcMemberImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("CalculatedMember")).attr({title:this._getLocalizedLabels("CalculatedMember"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableExcelExport?t.buildTag("li.e-excelExportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ExportToExcel")).attr({title:this._getLocalizedLabels("ExportToExcel"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableWordExport?t.buildTag("li.e-wordExportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ExportToWord")).attr({title:this._getLocalizedLabels("ExportToWord"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enablePdfExport?t.buildTag("li.e-pdfExportImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ExportToPdf")).attr({title:this._getLocalizedLabels("ExportToPdf"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableFullScreen&&this.model.displaySettings.enableFullScreen?t.buildTag("li.maximizedView e-icon","",{}).attr("aria-label",this._getLocalizedLabels("FullScreen")).attr({title:this._getLocalizedLabels("FullScreen"),tabindex:0})[0].outerHTML:"")+(this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?(this.model.toolbarIconSettings.enableSortOrFilterColumn?t.buildTag("li.e-colSortFilterImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SortOrFilterColumn")).attr({title:this._getLocalizedLabels("SortOrFilterColumn"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableSortOrFilterRow?t.buildTag("li.e-rowSortFilterImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("SortOrFilterRow")).attr({title:this._getLocalizedLabels("SortOrFilterRow"),tabindex:0})[0].outerHTML:""):"")+(this.model.toolbarIconSettings.enableToggleAxis?t.buildTag("li.e-toggleaxisImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ToggleAxis")).attr({title:this._getLocalizedLabels("ToggleAxis"),tabindex:0})[0].outerHTML:"")+(this.model.toolbarIconSettings.enableChartTypes?t.buildTag("li.e-chartTypesImg e-icon","",{}).attr("aria-label",this._getLocalizedLabels("ChartTypes")).attr({title:this._getLocalizedLabels("ChartTypes"),tabindex:0})[0].outerHTML:"")+(this.model.showReportCollection?t.buildTag("li.e-collectionli",t.buildTag("label.e-collectionLbl",this._getLocalizedLabels("Collection")+": ",{})[0].outerHTML+t.buildTag("div.e-collectiondiv",t.buildTag("input.e-collectionlist","",{})[0].outerHTML)[0].outerHTML,{}).attr("aria-label",this._getLocalizedLabels("Collection")).attr({title:this._getLocalizedLabels("Collection"),tabindex:0})[0].outerHTML+t.buildTag("li.e-reportli",(this.model.showReportCollection?t.buildTag("label.e-reportLbl",this._getLocalizedLabels("Report")+": ",{})[0].outerHTML:"")+t.buildTag("li.e-reportCol e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Report")).attr({title:this._getLocalizedLabels("ReportList"),tabindex:0})[0].outerHTML)[0].outerHTML:t.buildTag("li.e-reportCol e-icon","",{}).attr("aria-label",this._getLocalizedLabels("Report")).attr({title:this._getLocalizedLabels("ReportList"),tabindex:0})[0].outerHTML))[0].outerHTML},_clientGridDrillSuccess:function(i){if(this._isChartDrillAction)this._isChartDrillAction=!1;else if("rowheader"==i.axis&&this.displayMode()!=t.PivotClient.DisplayMode.GridOnly){"drilldown"==i.drillAction?this._drillParams.push(i.drilledMember):this._drillParams=e.grep(this._drillParams,function(e){return e.indexOf(i.drilledMember)<0}),this._pivotChart._drillParams=this._drillParams;var l=i.drilledMember.split(">#>");this._pivotChart._labelCurrentTags.expandedMembers=l,"drillup"==i.drillAction&&(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(this._pivotChart._labelCurrentTags.expandedMembers=[],this._drillParams.length>0&&this._getDrilledMember(i.drillAction)):0==this._pivotChart._labelCurrentTags.expandedMembers.length&&this._drillParams.length>0&&this._getDrilledMember(i.drillAction)),this._pivotChart._drillAction=i.drillAction,this._pivotChart.refreshControl()}},_getDrilledMember:function(){var i,l,a,r,o=this._drillParams[this._drillParams.length-1],s=e.grep(this._drillParams,function(e){return e.indexOf(o)>=0});if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)for(r=0;r<s.length;r++)s[r].split(">#>").length>this._pivotChart._labelCurrentTags.expandedMembers.length&&(this._pivotChart._labelCurrentTags.expandedMembers=s[r].split(">#>"));else{for(i=s[0].split(">#>").length,l=0,r=1;r<s.length;r++)if(s[r].split(">#>").length>i){l=r;break}for(this._drillInfo=s[l].split(">#>"),a=0,this._pivotChart._labelCurrentTags.expandedMembers=[],r=0;r<this._drillInfo.length;r++)t.isNullOrUndefined(this._pivotChart._labelCurrentTags.expandedMembers[a])&&(this._pivotChart._labelCurrentTags.expandedMembers[a]=[]),r+1<this._drillInfo.length?t.isNullOrUndefined(t.olap._mdxParser._splitCellInfo(this._drillInfo[r]))||t.isNullOrUndefined(t.olap._mdxParser._splitCellInfo(this._drillInfo[r+1]))||t.olap._mdxParser._splitCellInfo(this._drillInfo[r]).hierarchyUniqueName!=t.olap._mdxParser._splitCellInfo(this._drillInfo[r+1]).hierarchyUniqueName?a++:this._pivotChart._labelCurrentTags.expandedMembers[a].push(this._drillInfo[r]):(this._pivotChart._labelCurrentTags.expandedMembers[a].push(this._drillInfo[r]),this._isChartDrillAction=!0)}},_clearSorting:function(l){if("disabled"==e(l.target).parent().attr("disabled"))return!1;t.Pivot.closePreventPanel(this);var a=this,r=this.model.dataSource,o=this._schemaData._selectedFieldName.toLowerCase(),s=e.map(r.columns,function(e){if(e.fieldName!=i&&e.fieldName.toLowerCase()==o)return e});0==s.length&&(s=e.map(r.rows,function(e){if(e.fieldName!=i&&e.fieldName.toLowerCase()==o)return e})),s.length>0&&delete s[0].sortOrder,this.model.dataSource=r,this.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog)").remove(),null!=this._schemaData&&this._schemaData.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog)").remove(),a._isTimeOut=!0,setTimeout(function(){a._isTimeOut&&a._waitingPopup.show()},800),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this.refreshControl():t.olap.base.getJSONData({action:"clearSorting"},this.model.dataSource,this)},_clientChartDrillSuccess:function(i){var l,a,r,o,s,n=[];if(""!=i.drilledMember&&(n=i.drilledMember.split(">#>"),this._isChartDrillAction=!0),"drilldown"!=i.drillAction||t.isNullOrUndefined(this._pivotChart._labelCurrentTags.expandedMembers)||-1!=this._drillParams.indexOf(this._pivotChart._labelCurrentTags.expandedMembers.join(">#>"))||this._drillParams.push(this._pivotChart._labelCurrentTags.expandedMembers.join(">#>")),"chartonly"!=this.displayMode())for(l=0,a=this._pivotGrid._rowCount,r=0;r<n.length;r++)o=r==n.length-1&&"drilldown"==i.drillAction?this._pivotGrid.element.find(".e-pivotGridTable th.summary[data-p^='"+r+"']"):this._pivotGrid.element.find(".e-pivotGridTable th.rowheader[data-p^='"+r+"']"),s=e.grep(o,function(t){return e(t).clone().children().remove().end().text()==n[r]}),s=e.grep(s,function(t){return parseInt(e(t).attr("data-p").split(",")[1])>=l&&parseInt(e(t).attr("data-p").split(",")[1])<=a}),r==n.length-1?e(s).find("."+("drilldown"==i.drillAction?"e-expand":"e-collapse")).trigger("click"):(l=parseInt(e(s).attr("data-p").split(",")[1]),a=l+parseInt(e(s).find("span").attr("data-tag"))+s[0].rowSpan)},setChartDrillParams:function(i,l){var a,r;"drilldown"==l?this._drillParams.push(i):this._drillParams=e.grep(this._drillParams,function(e){return e.indexOf(i)<0}),this._drillInfo=i.split(">#>"),a=0,this._pivotChart._labelCurrentTags.expandedMembers=[];var o=this._drillInfo.length-1,s="drillup"==l&&this._drillParams.length>0&&this._drillParams[this._drillParams.length-1]!=this._drillInfo.join(">#>")&&this._drillParams[this._drillParams.length-1].split(">#>").filter(function(e){return e<o}).join(">#>")==this._drillInfo.filter(function(e){return e<o}).join(">#>"),n=s?this._drillParams[this._drillParams.length-1].split(">#>"):this._drillInfo;for(r=0;r<n.length;r++)t.isNullOrUndefined(this._pivotChart._labelCurrentTags.expandedMembers[a])&&(this._pivotChart._labelCurrentTags.expandedMembers[a]=[]),r+1<n.length||s?(t.isNullOrUndefined(t.olap._mdxParser._splitCellInfo(n[r]))||t.isNullOrUndefined(t.olap._mdxParser._splitCellInfo(n[r+1]))?r==n.length-1:t.olap._mdxParser._splitCellInfo(n[r]).hierarchyUniqueName==t.olap._mdxParser._splitCellInfo(n[r+1]).hierarchyUniqueName)?this._pivotChart._labelCurrentTags.expandedMembers[a].push(n[r]):a++:"drilldown"==l&&(this._pivotChart._labelCurrentTags.expandedMembers[a].push(n[r]),this._isChartDrillAction=!0);0==e.grep(this._pivotChart._labelCurrentTags.expandedMembers,function(e){return e.length>0}).length&&this._drillParams.length>0&&(this._getDrilledMember(l),this._pivotGrid._drillAction="drilldown")},_setChartDrillMembers:function(e){var i,l,a,r,o,s,n;if(this._drillInfo.length>0&&!this._pivotChart.model.enableMultiLevelLabels){var d=0,h=this._pivotChart._cloneEngine(e),c=!1;for(o=0;o<this._pivotChart._labelCurrentTags.expandedMembers.length;o++)for(n=0;n<this._pivotChart._labelCurrentTags.expandedMembers[o].length;n++)c=!0;if(c){for(l=this._drillInfo[this._drillInfo.length-1],o=0;o<this.model.dataSource.rows.length;o++)a=t.olap._mdxParser._splitCellInfo(l).hierarchyUniqueName,this.model.dataSource.rows[o].fieldName==a&&(i=o);var p="rows"==this.model.dataSource.values[0].axis?1:0,u=this._drillInfo.length-1;if("drillup"==this._pivotGrid._drillAction&&this._drillParams.length>0&&this._drillParams[this._drillParams.length-1].split(">#>").filter(function(e){return e<u}).join(">#>")==this._drillInfo.filter(function(e){return e<u}).join(">#>"))for(o=0;o<this._drillParams[this._drillParams.length-1].split(">#>").length;o++)t.isNullOrUndefined(t.olap._mdxParser._splitCellInfo(this._drillParams[this._drillParams.length-1].split(">#>")[o]))||""==t.olap._mdxParser._splitCellInfo(this._drillParams[this._drillParams.length-1].split(">#>")[o]).hierarchyUniqueName||(r=t.olap._mdxParser._splitCellInfo(this._drillParams[this._drillParams.length-1].split(">#>")[o]).leveName,this._pivotChart._cropData(h,r,o+d,!1));else{if(h[0+d][0].ColSpan>(this._drillInfo.length+this._pivotGrid._drillAction=="drilldown"?1:0))for(o=this._drillInfo.length+("drilldown"==this._pivotGrid._drillAction?1:0)+(this.model.dataSource.rows.length-(i+1));o+p<h[0+d][0].ColSpan;o++)h.splice(o,1),h[0][0].ColSpan--;for(o=0;o<this._drillInfo.length-("drillup"==this._pivotGrid._drillAction?1:0);o++)t.isNullOrUndefined(t.olap._mdxParser._splitCellInfo(this._drillInfo[o]))||""==t.olap._mdxParser._splitCellInfo(this._drillInfo[o]).hierarchyUniqueName||(r=t.olap._mdxParser._splitCellInfo(this._drillInfo[o]).leveName,this._pivotChart._cropData(h,r,o+d,!1))}if(0,!t.isNullOrUndefined(this._pivotChart._labelCurrentTags.expandedMembers))for(o=0;o<this._pivotChart._labelCurrentTags.expandedMembers.length;o++)if(!t.isNullOrUndefined(this._pivotChart._labelCurrentTags.expandedMembers[o]))if(o>i)for(n=0;n<this._pivotChart._labelCurrentTags.expandedMembers[o].length;n++)s=this._pivotChart._labelCurrentTags.expandedMembers[o][n].split("::")[2],this._pivotChart._cropData(h,s,o+d,!0),d++;else for(n=0;n<this._pivotChart._labelCurrentTags.expandedMembers[o].length;n++)d++}this._drillInfo=[],this._pivotChart._generateData(h)}else this._pivotChart.generateJSON(this,e)},refreshPagedPivotClient:function(e,i){var l,a=this;if(t.isNullOrUndefined(this._waitingPopup)||(a._isTimeOut=!0,setTimeout(function(){a._isTimeOut&&a._waitingPopup.show()},800)),e=-1!=e.indexOf("categ")?"categorical":"series",this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap)"categorical"==e?this._categCurrentPage=parseInt(i):this._seriesCurrentPage=parseInt(i),t.olap.base.getJSONData({action:"navPaging"},this.model.dataSource,this);else if(""!=this.currentReport){try{l=JSON.parse(this.currentReport)}catch(e){l=this.currentReport}this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.paging,JSON.stringify({action:"paging",pagingInfo:e+":"+i,currentReport:l,layout:t.PivotGrid.Layout.NoSummaries,customObject:null}),this.refreshPagedPivotClientSuccess)}},refreshPagedPivotClientSuccess:function(l){var a=[];l.d!=i?(a=e.map(l.d,function(e){if("JsonRecords"==e.Key)return e}),e.merge(a,e.map(l.d,function(e){if("OlapReport"==e.Key)return e})),this.reports=e.map(l.d,function(e){if("ClientReports"==e.Key)return e.Value}).toString()):(this.reports=l.ClientReports,delete l.ClientReports,a=l),this.model.displaySettings.mode==t.PivotClient.DisplayMode.GridOnly?this._pivotGrid._renderControlSuccess(l):this.model.displaySettings.mode==t.PivotClient.DisplayMode.ChartOnly?this._pivotChart.renderControlSuccess(a):(this.model.displaySettings.mode=t.PivotClient.DisplayMode.ChartAndGrid)&&(this._pivotGrid._renderControlSuccess(l),this._pivotChart.renderControlSuccess(a))},_hiddenCellInfo:function(t){var i=e.map(t,function(e){if("FilteredColumnHeaders"==e.Key)return e.Value}),l=e.map(t,function(e){if("FilteredRowHeaders"==e.Key)return e.Value});return{columnArea:i.length>0?i[0]:i,rowArea:l.length>0?l[0]:[]}},_loadCollectionList:function(l){var a="";a=""!=(a=l[0]!=i?t.isNullOrUndefined(l[0].Value)?"":l[0].Value:l.d!=i?t.isNullOrUndefined(l.d[0].Value)?"":l.d[0].Value:l.ReportNameList)?a.split("__"):[],this.element.find(".e-collectionlist").ejDropDownList({dataSource:a,enableRTL:this.model.enableRTL,fields:{text:"name",value:"name"},height:"26px",change:t.proxy(this._collectionChange,this),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),""!=this._currentCollection&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this.element.find(".e-collectionlist").data("ejDropDownList").option("change",""),this.element.find(".e-collectionlist").data("ejDropDownList").selectItemByText(this._currentCollection),this.element.find(".e-collectionlist").ejDropDownList("option","change",t.proxy(this._collectionChange,this)))},_fetchCollectionList:function(){var e,i;this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(i=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchReportList,JSON.stringify({customObject:i,action:"LoadReport",operationalMode:this.model.operationalMode,analysisMode:this.model.analysisMode}),function(e){this._loadCollectionList(e)})):(e={url:"",reportCollection:this._clientReportCollection,reportList:"",mode:this.model.analysisMode},this._trigger("fetchReport",{targetControl:this,fetchReportSetting:e}),this.model.enableLocalStorage?this._loadCollectionList({d:[{Key:"ReportNameList",Value:e.reportList}]}):(i=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",e.url+"/"+this.model.serviceMethodSettings.fetchReportList,JSON.stringify({customObject:i,action:"LoadReport",operationalMode:this.model.operationalMode,analysisMode:this.model.analysisMode}),function(e){this._loadCollectionList(e)})))},_renderControlSuccess:function(l){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v;if(t.isNullOrUndefined(this.model))return!1;t.Pivot._updateValueSortingIndex(l,this),(this.model.isResponsive||this.model.collapseCubeBrowserByDefault)&&(this.model.displaySettings.enableTogglePanel=!0),a={element:this.element,customObject:this.model.customObject},this._trigger("load",a);var C="",S="",O="",T="",y="";if(l[0]!=i)C=l[0].Value,S=l[1].Value,O=l[2].Value,T=l[3].Value,y=l[4].Value,this.currentReport=this._deferReport=l[5].Value,this.reports=l[6].Value,this.reportsCount=l[7].Value,o=e.parseJSON(l[8].Value),this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l[9].Value)),this.currentCubeName=l[10].Value,null!=l[11]&&l[11]!=i&&(this.model.customObject=l[11].Value);else if(l.d!=i){if(t.isNullOrUndefined(l.d[3])||"Pivot"==l.d[3].Value)return this.model.analysisMode=t.Pivot.AnalysisMode.Pivot,this._currentReportName="Default",r=this._hiddenCellInfo(l.d),void(l.d.length>4&&"LoadReport"==l.d[4].Value?(this._clientReportCollection=JSON.parse(l.d[5].Value),this._renderClientControls({PivotReport:l.d[0].Value,GridJSON:l.d[1].Value,ChartJSON:l.d[2].Value,FilteredColumnHeaders:r.columnArea.length>0?r.columnArea:"[]",FilteredRowHeaders:r.rowArea.length>0?r.rowArea:"[]"}),o=e.map(this._clientReportCollection,function(e){if(e.name!=i)return{name:e.name}}),s=this.element.find(".reportlist").data("ejDropDownList"),this.element.find(".reportlist").ejDropDownList("option","dataSource",o),s.selectItemByText(o[0].name),this._unWireEvents(),this._wireEvents()):(this.model.enableDrillThrough&&!t.isNullOrUndefined(l.d[4].Value)&&(this.dataSet=l.d[4].Value),this._clientReportCollection=[{name:"Default",report:e.parseJSON(l.d[0].Value).Report}],this._renderClientControls({PivotReport:l.d[0].Value,GridJSON:l.d[1].Value,ChartJSON:l.d[2].Value,FilteredColumnHeaders:r.columnArea.length>0?r.columnArea[0]:"[]",FilteredRowHeaders:r.rowArea.length>0?r.rowArea[0]:"[]"})));C=l.d[0].Value,S=l.d[1].Value,O=l.d[2].Value,T=l.d[3].Value,y=l.d[4].Value,this.currentReport=this._deferReport=l.d[5].Value,this.reports=l.d[6].Value,this.reportsCount=l.d[7].Value,o=e.parseJSON(l.d[8].Value),this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l.d[9].Value)),this.currentCubeName=l.d[10].Value,null!=l.d[11]&&l.d[11]!=i&&(this.model.customObject=l.d[11].Value)}else if(""!=l){if(!t.isNullOrUndefined(l.DataModel)&&"Olap"!=l.DataModel)return this.model.analysisMode=t.Pivot.AnalysisMode.Pivot,this._currentReportName=t.isNullOrUndefined(l.ReportCollection)?"Default":JSON.parse(l.ReportCollection)[0].name,this._clientReportCollection=t.isNullOrUndefined(l.ReportCollection)?[{name:"Default",report:e.parseJSON(l.PivotReport).Report,_fieldSelectedMembers:this._fieldSelectedMembers}]:JSON.parse(l.ReportCollection),t.isNullOrUndefined(l.DataSet)||(this.dataSet=l.DataSet),void this._renderClientControls(l);this.model.analysisMode=t.Pivot.AnalysisMode.Olap,C=l.Cubes,S=l.Columns,O=l.Rows,T=l.Slicers,y=l.CubeTreeInfo,this.currentReport=l.CurrentReport,this.reports=l.ClientReports,o=e.parseJSON(l.ReportList),this.reportsCount=l.ReportsCount,this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l.MeasureGroups)),this.currentCubeName=l.CurrentCubeName,null!=l.customObject&&l.customObject!=i&&(this.model.customObject=l.customObject)}null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"initialize",element:this.element,customObject:this.model.customObject}),n=null,""!=l&&(n=e.parseJSON(y)),d=t.buildTag("div.e-reportToolbar#reportToolbar",this._reportToolbar(),{width:"410px",height:"29px"})[0].outerHTML,this.model.enableSplitter?this.model.isResponsive?(h=this._createCubeSelector()+t.buildTag("table.e-cubeTable",t.buildTag("tbody",t.buildTag("tr.e-serversplitresponsive",t.buildTag("td.cubeTableTD",this._createCubeBrowser(y)).attr({valign:"bottom"}).css("width","50%")[0].outerHTML+t.buildTag("td.cubeTableTD",this._createAxisElementBuilder(S,O,T)).attr({valign:"bottom"}).css("width","50%")[0].outerHTML).css("width","100%")[0].outerHTML)[0].outerHTML)[0].outerHTML,c=t.buildTag("div.outerPanel","").append((""!=e.trim(this.model.title)?t.buildTag("div.e-titleText",t.buildTag("span",this.title(),{"padding-left":"10px"})[0].outerHTML)[0].outerHTML:"")+d+t.buildTag("table.oClientTbl",t.buildTag("tr",t.buildTag("td",t.buildTag("table.e-outerTable",t.buildTag("tr",t.buildTag("td",h)[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("table.controlPanelTD",t.buildTag("tr",t.buildTag("td",this._controlPanel())[0].outerHTML+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{width:"100%"})[0].outerHTML)):this.model.enableRTL?this.model.enableVirtualScrolling?(h=this._createCubeSelector()+"<table class=e-cubeTable style='width:100%'><tr class='e-serverchildsplit' style='width:98%'><td class=axisBuilderTD valign=\"bottom\" style='width:47%'>"+this._createAxisElementBuilder(S,O,T)+"</td><td class=cdbTD valign=\"bottom\" style='width:47%;'>"+this._createCubeBrowser(y)+"</td></tr></table>",c=t.buildTag("div.outerPanel","",{}).append('<div class="e-titleText"><span>'+this.title()+"</span></div>"+d+"<table class=\"e-outerTable\" style='width:100%'><tr class='e-serverparentsplit' style='width:100%'><td style='width:49%'>"+h+"</td><td class=\"controlPanelTD\" style='width:49%;'>"+this._controlPanel()+"</td>"+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:"")+"</tr></table>")):(h=this._createCubeSelector()+"<table class=e-cubeTable style='width:98%'><tr class='e-serverchildsplit'><td class=axisBuilderTD valign=\"bottom\" style='"+(this.model.enableRTL?"padding-right:0px;":"0px")+"'>"+this._createAxisElementBuilder(S,O,T)+'</td><td class=cdbTD valign="bottom"\'>'+this._createCubeBrowser(y)+"</td></tr></table>",c=t.buildTag("div.outerPanel","",{}).append('<div class="e-titleText"><span>'+this.title()+"</span></div>"+d+"<table class=\"e-outerTable\" style='width:100%'><tr class='e-serverparentsplit'><td class=\"controlPanelTD\">"+this._controlPanel()+"</td><td>"+h+"</td>"+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:"")+"</tr></table>")):(h=this._createCubeSelector()+"<table class=e-cubeTable style='width:100%'><tr class='e-serverchildsplit' style='width:100%'><td class=cdbTD valign=\"bottom\" style='width:47%;'>"+this._createCubeBrowser(y)+'</td><td class=axisBuilderTD valign="bottom" style=\''+(this.model.enableRTL?"padding-right:5px;":"0px")+"width:47%'>"+this._createAxisElementBuilder(S,O,T)+"</td></tr></table>",c=t.buildTag("div.outerPanel","",{}).append('<div class="e-titleText"><span>'+this.title()+"</span></div>"+d+"<table class=\"e-outerTable\" style='width:100%'><tr class='e-serverparentsplit' style='width:100%'><td style='width:49%'>"+h+"</td><td class=\"controlPanelTD\" style='width:49%'>"+this._controlPanel()+"</td>"+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:"")+"</tr></table>")):this.model.isResponsive?this.model.isResponsive&&(h=this._createCubeSelector()+t.buildTag("table.e-cubeTable",t.buildTag("tbody",t.buildTag("tr",t.buildTag("td.cubeTableTD",this._createCubeBrowser(y)).attr({valign:"bottom",width:"50%",height:"100%"}).css({"table-layout":"fixed",display:"initial"})[0].outerHTML+t.buildTag("td.cubeTableTD",this._createAxisElementBuilder(S,O,T)).attr({valign:"bottom",width:"50%",height:"100%"})[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,c=t.buildTag("div.outerPanel","").append((""!=e.trim(this.model.title)?t.buildTag("div.e-titleText",t.buildTag("span",this.title(),{"padding-left":"10px"})[0].outerHTML)[0].outerHTML:"")+d+t.buildTag("table.oClientTbl",t.buildTag("tr",t.buildTag("td",t.buildTag("table.e-outerTable",t.buildTag("tr",t.buildTag("td",h)[0].outerHTML)[0].outerHTML)[0].outerHTML+t.buildTag("table.controlPanelTD",t.buildTag("tr",t.buildTag("td",this._controlPanel())[0].outerHTML+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:""))[0].outerHTML)[0].outerHTML)[0].outerHTML)[0].outerHTML,{width:"100%","table-layout":"fixed"})[0].outerHTML)):(h=this._createCubeSelector()+"<table class=e-cubeTable><tr><td class=cdbTD valign=\"bottom\" style='display:block'>"+this._createCubeBrowser(y)+'</td><td class=axisBuilderTD valign="bottom" style=\''+(this.model.enableRTL?"padding-right:5px;":"padding-left:5px;")+"'>"+this._createAxisElementBuilder(S,O,T)+"</td></tr></table>",c=t.buildTag("div.outerPanel","",{}).append('<div class="e-titleText"><span>'+this.title()+"</span></div>"+d+'<table class="e-outerTable"><tr><td>'+h+"</td><td class=\"controlPanelTD\" style='display:block'>"+this._controlPanel()+"</td>"+(this.model.enableVirtualScrolling?t.buildTag("td.virtualScrolling",t.buildTag("div.e-vScrollPanel")[0].outerHTML)[0].outerHTML:"")+"</tr></table>")),this.element.html(c),this.element.find(".e-reportToolbar").ejToolbar({enableRTL:this.model.enableRTL,height:"35px"}),this._calculateSize(),this.model.enableRTL&&this.element.addClass("e-rtl"),(this.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&this.defaultView()==t.PivotClient.DefaultView.Grid||this.displayMode()==t.PivotClient.DisplayMode.GridOnly)&&this.element.find(".e-chartTypesImg").addClass("e-chartTypesOnGridView"),p="<div class ='reportList' ><input type='text' id='reportList' class='reportlist' title='"+this._getLocalizedLabels("ReportList")+"'/></div>",this.model.enableMeasureGroups&&this._createMeasureGroup(),e(this.element).find(".e-reportCol").append(p),this.element.find(".reportlist").ejDropDownList({dataSource:o,enableRTL:this.model.enableRTL,fields:{text:"name",value:"name"},height:"26px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.model.showReportCollection&&this._fetchCollectionList(),this.element.find(".reportlist").attr("tabindex",0);var x=this.element.find(".e-csHeader").width()-this.element.find(".cubeText").width()-(this.element.find(".e-toggleExpandButton").length>0?this.element.find(".e-toggleExpandButton").width():0)-("olap"==this.model.analysisMode&&"servermode"==this.model.operationalMode||this.model.enableSplitter?20:50),M=this.enableTogglePanel()?x-25:x,P=""==C?"":e.parseJSON(C);for(this.element.find(".cubeSelector").ejDropDownList({dataSource:P,enableRTL:this.model.enableRTL,fields:{text:"name",value:"name"},width:this.model.enableSplitter&&!this.model.isResponsive?"100%":M+"px"}),this.ddlTarget=this.element.find(".cubeSelector").data("ejDropDownList"),this.reportDropTarget=this.element.find("#reportList").data("ejDropDownList"),""==l||t.isNullOrUndefined(this.ddlTarget)||(this.ddlTarget.selectItemByText(this.currentCubeName),this.reportDropTarget.model.dataSource.length&&this.reportDropTarget.selectItemByText(this.reportDropTarget.model.dataSource[0].name),this._selectedReport=this.reportDropTarget.currentValue),this.element.find(".cubeSelector").ejDropDownList("option","change",t.proxy(this._cubeChanged,this)),this.element.find(".cubeSelector").attr("tabindex",0),this.element.find(".reportlist").ejDropDownList("option","change",t.proxy(this.reportChanged,this)),this.model.enableMeasureGroups&&this.element.find(".measureGroupSelector").ejDropDownList("option","change",t.proxy(this._measureGroupChanged,this)),this.element.find(".e-cubeTreeView").ejTreeView({clientObj:this,fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:n,parentUniqueName:"parentUniqueName"},allowDragAndDrop:!0,enableRTL:this.model.enableRTL,allowDropChild:!1,allowDropSibling:!1,dragAndDropAcrossControl:!0,nodeDragStart:function(){this.model.clientObj.isDragging=!0},beforeDelete:function(){return!1},cssClass:"pivotTreeViewDragedNode",nodeDropped:t.proxy(this._nodeDropped,this)}),this.element.find(".e-cubeTreeView").attr("tabindex",0),u=this.element.find(".e-cubeTreeView").find("li"),f=0;f<u.length;f++)!t.isNullOrUndefined(u[f].id)&&u[f].id.indexOf("'").length>-1&&u[f].setAttribute("id",u[f].id.replace(/'/g,"")),u[f].setAttribute("data-tag",n[f].tag),t.isNullOrUndefined(n[f].parentUniqueName)||""==n[f].parentUniqueName||u[f].setAttribute("data-parentUniqueName",t.isNullOrUndefined(n[f].parentUniqueName)?"":n[f].parentUniqueName.split(">>||>>")[1]);for(m=this.element.find(".e-cubeTreeView .e-folderCDB"),f=0;f<m.length;f++)e(m[f].parentElement).removeClass("e-draggable");if(this.element.find(".e-cubeTreeView .e-kpiRootCDB").length>0&&this.element.find(".e-cubeTreeView .e-kpiRootCDB").parent().removeClass("e-draggable"),this.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").length>0&&(this.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").parent().removeClass("e-draggable"),(g=this.element.find(".e-cubeTreeView .e-calcMemberCDB").parents("li").find("li")).length>0))for(f=0;f<g.length;f++)this._calcMembers.push(n[f+1]),g[f].setAttribute("expression",n[f+1].expression),g[f].setAttribute("formatString",n[f+1].formatString),g[f].setAttribute("nodeType",n[f+1].nodeType);if(this._cubeTreeView=this.element.find(".e-cubeTreeView").data("ejTreeView"),b=t.buildTag("div.searchDiv",t.buildTag("input#"+this._id+"_SearchTreeView.searchTreeView").attr("type","text")[0].outerHTML,{margin:"5px 5px 0px 0px"})[0].outerHTML,_=t.buildTag("div.e-cubeName",this.currentCubeName+b),e(this.element).find(".e-cubeBrowser").prepend(_),this.element.find("#"+this._id+"_SearchTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search"),maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(t.Pivot._searchTreeNodes,this)}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").ejDroppable({drop:t.proxy(this._onDropped,this)}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find("button").ejButton({height:"20px",type:t.ButtonType.Button}),this.enableTogglePanel()&&(e(t.buildTag("div.e-toggleExpandButton e-icon","",{}).attr("aria-label","toggle expanded")[0].outerHTML).appendTo(this.element.find(".e-csHeader")),e(this.element.find(".e-outerTable").find("td")[0]).append(t.buildTag("div.e-toggleCollapseButton e-icon","",{}).attr("aria-label","toggle collapsed")[0].outerHTML),e(t.buildTag("div.e-toggleText")[0].outerHTML).insertAfter(this.element.find(".e-toggleCollapseButton")),this.element.find(".e-toggleCollapseButton").hide(),this.element.find(".e-toggleText").hide()),this._overflow(),this._setSplitBtnTitle(),this.element.find("#clientTab").ejTab({enableRTL:this.model.enableRTL,itemActive:t.proxy(this._onTabClick,this)}),this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode){if(this.defaultView()==t.PivotClient.DefaultView.Chart?(this.element.find("#"+this._id+"_PivotChart").ejPivotChart({url:this.model.url,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,axesLabelRendering:this.model.axesLabelRendering,pointRegionClick:this.model.pointRegionClick,canResize:this.model.isResponsive,currentReport:this.currentReport,locale:this.locale(),showTooltip:!0,size:{height:this._chartHeight,width:this._chartWidth},commonSeriesOptions:{type:this.model.chartType,tooltip:{visible:!0}},beforeServiceInvoke:this.model.chartLoad,drillSuccess:t.proxy(this._chartDrillSuccess,this)}),this.gridLayout()!=t.PivotGrid.Layout.Normal?this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({url:this.model.url,customObject:this.model.customObject,isResponsive:this.model.isResponsive,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,currentReport:this.currentReport,layout:this.gridLayout(),locale:this.locale(),drillSuccess:t.proxy(this._gridDrillSuccess,this)}):this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({url:this.model.url,customObject:this.model.customObject,isResponsive:this.model.isResponsive,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,currentReport:this.currentReport,locale:this.locale(),drillSuccess:t.proxy(this._gridDrillSuccess,this)})):(this.gridLayout()!=t.PivotGrid.Layout.Normal?this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({url:this.model.url,customObject:this.model.customObject,isResponsive:this.model.isResponsive,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,currentReport:this.currentReport,locale:this.locale(),layout:this.gridLayout(),drillSuccess:t.proxy(this._gridDrillSuccess,this)}):this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({url:this.model.url,customObject:this.model.customObject,isResponsive:this.model.isResponsive,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,currentReport:this.currentReport,locale:this.locale(),drillSuccess:t.proxy(this._gridDrillSuccess,this)}),this.element.find("#"+this._id+"_PivotChart").ejPivotChart({url:this.model.url,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,axesLabelRendering:this.model.axesLabelRendering,pointRegionClick:this.model.pointRegionClick,canResize:this.model.isResponsive,currentReport:this.currentReport,locale:this.locale(),showTooltip:!0,size:{height:this._chartHeight,width:this._chartWidth},commonSeriesOptions:{type:this.model.chartType,tooltip:{visible:!0}},drillSuccess:t.proxy(this._chartDrillSuccess,this),beforeServiceInvoke:this.model.chartLoad})),this.model.enablePaging&&(this.element.find("#"+this._id+"_Pager").ejPivotPager({mode:t.PivotPager.Mode.Both,targetControlID:this._id}),this.element.find("#"+this._id+"_Pager").css("margin-top","5px"),this.element.find(".e-controlPanel").height(this.element.find(".e-controlPanel").height()-(this.element.find("#"+this._id+"_Pager").height()+5)),this.element.find(".e-gridContainer").height(this.element.find(".e-gridContainer").height()-(this.element.find("#"+this._id+"_Pager").height()+5)),this.element.find(".e-chartContainer").height(this.element.find(".e-chartContainer").height()-(this.element.find("#"+this._id+"_Pager").height()+10))),"chartonly"!=this.displayMode()&&(this._pivotGrid=this.element.find("#"+this._id+"_PivotGrid").data("ejPivotGrid")),"gridOnly"!=this.displayMode()&&(this._pivotChart=this.element.find("#"+this._id+"_PivotChart").data("ejPivotChart")),v={},null!=this._pivotChart&&(this.element.find("#"+this._id+"_PivotChart").width(this._pivotChart.model.size.width),this.element.find("#"+this._id+"_PivotChartContainer").width(this._pivotChart.model.size.width),v.chartModelWidth=this._pivotChart.model.size.width),v.controlPanelWidth=this.element.find(".e-controlPanel").width(),v.chartOuterWidth=this._chartWidth,v.gridOuterWidth=this._gridWidth,this._initStyles.push(v),this._wireEvents(),this.model.isResponsive&&(this._enableResponsive(),this._parentElwidth=e("#"+this._id).parent().width(),this._parentElwidth<850?this._rwdToggleCollapse():this._parentElwidth>850&&this._rwdToggleExpand(),this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&"chartandgrid"==this.displayMode()&&"chart"==this._currentTab&&this.element.find(".e-chartContainer").css({width:"99.6%"})),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode!=t.Pivot.OperationalMode.ClientMode){x=this.element.find(".e-csHeader").width()-this.element.find(".cubeText").width()-this.element.find(".e-toggleExpandButton").width()-(this.model.enableSplitter?50:20),M=this.enableTogglePanel()?x-25:x,P=""==C?"":e.parseJSON(C);this.element.find(".cubeSelector").ejDropDownList({width:this.model.enableSplitter&&!this.model.isResponsive?"100%":M+"px"})}this._trigger("renderSuccess",this),this._successAction="ClientRender",this.progressPos=e("#"+this._id).position(),this._treeContextMenu(),this._buttonContextMenu(),"olap"==this.model.analysisMode&&"servermode"==this.model.operationalMode&&this.model.enableSplitter&&this._createSplitter(),t.isNullOrUndefined(l.Exception)||t.Pivot._createErrorDialog(l,"Exception",this),this.model.showUniqueNameOnPivotButton&&(e(".e-pvtBtn").addClass("e-splitBtnUnique"),this._addSplitButtonHeight())}this.model.collapseCubeBrowserByDefault&&(this._collapseCubeBrowser(),this._isCollapseCB=!0)},_collectionChange:function(e){var i,l;this._currentCollection=e.selectedText,this._waitingPopup.show(),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?(this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),l=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.loadReport,JSON.stringify({reportName:e.selectedText,operationalMode:this.model.operationalMode,analysisMode:this.model.analysisMode,olapReport:this.currentReport,clientReports:this.reports,customObject:l,clientParams:JSON.stringify(this.model.enableMeasureGroups)}),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?this._renderControlSuccess:this._toolbarOperationSuccess)):(i={url:"",reportCollection:this._clientReportCollection,selectedReport:e.selectedText,mode:this.model.analysisMode},this._trigger("loadReport",{targetControl:this,loadReportSetting:i}),this.model.enableLocalStorage?(this.model.dataSource=i.reportCollection[0],this._clientReportCollection=i.reportCollection,this.refreshControl(),this._refreshReportList(),this._pivotSchemaDesigner&&this._pivotSchemaDesigner._refreshPivotButtons()):(l=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",i.url+"/"+this.model.serviceMethodSettings.loadReport,JSON.stringify({reportName:e.selectedText,operationalMode:this.model.operationalMode,analysisMode:this.model.analysisMode,olapReport:this.currentReport,clientReports:this.reports,customObject:l,clientParams:JSON.stringify(this.model.enableMeasureGroups)}),this._clientToolbarOperationSuccess)))},_contextOpen:function(i){if(this.element.find(".dragClone").length>0)return 0;t.Pivot.openPreventPanel(this);var l=e("#pivotTree").data("ejMenu");this._selectedMember=e(i.target),l.enableItem(this._getLocalizedLabels("AddToColumn")),l.enableItem(this._getLocalizedLabels("AddToRow")),l.enableItem(this._getLocalizedLabels("AddToSlicer"))},_contextClick:function(e){var i,l;t.Pivot.closePreventPanel(this);var a=e.events.text,r=this;if("Slicer"==(a=a==this._getLocalizedLabels("AddToSlicer")?"Slicer":a==this._getLocalizedLabels("AddToColumn")?"Categorical":a==this._getLocalizedLabels("AddToRow")?"Series":"")&&null!=this._selectedMember&&this._selectedMember.parent().attr("data-tag").indexOf("Measure")>-1&&this.element.find(".e-splitBtn[data-tag*=Measures]").length>1)return t.Pivot._createErrorDialog(this._getLocalizedLabels("MultipleMeasure"),this._getLocalizedLabels("Warning"),this),!1;r._isTimeOut=!0,setTimeout(function(){r._isTimeOut&&r._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),i=JSON.stringify(this.model.customObject),l=this.currentCubeName+"--"+this._selectedMember.parent().attr("data-tag")+"--"+a+"--",this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.nodeDropped,JSON.stringify({action:"nodeDropped",dropType:"SplitButton",nodeInfo:l,olapReport:this.currentReport,clientReports:this.reports,customObject:i}),this._nodeDroppedSuccess)},_onContextOpen:function(i){if(e(i.target).find(".e-folderCDB").length>0||e(i.target).find(".e-calcMemberGroupCDB").length>0)return!1;t.Pivot.openPreventPanel(this);var l=e("#pivotTreeContext").data("ejMenu");this._selectedMember=e(i.target),l.enableItem(this._getLocalizedLabels("AddToColumn")),l.enableItem(this._getLocalizedLabels("AddToRow")),e(i.target).find(".e-calcMemberCDB").length>0?l.showItems(["#Remove"]):l.hideItems(["#Remove"]),e(i.target.parentElement).find(".e-namedSetCDB").length>0?l.disableItem(this._getLocalizedLabels("AddToSlicer")):l.enableItem(this._getLocalizedLabels("AddToSlicer"))},_onTreeContextClick:function(i){var l,a,r;t.isNullOrUndefined(this._curFocus.tree)?t.isNullOrUndefined(this._curFocus.tab)||this._curFocus.tab.attr("tabindex","-1").focus().addClass("e-hoverCell"):this._curFocus.tree.attr("tabindex","-1").focus().addClass("e-hoverCell"),delete this._fieldMembers[this._dimensionName.split(":").length>1?this._dimensionName.split(":")[1]:this._dialogTitle],delete this._fieldSelectedMembers[this._dimensionName.split(":").length>1?this._dimensionName.split(":")[1]:this._dialogTitle],t.Pivot.closePreventPanel(this);var o=i.events.text,s=this;if(s._isTimeOut=!0,o==this._getLocalizedLabels("Remove"))setTimeout(function(){s._isTimeOut&&s._waitingPopup.show()},800),l=this.element.find(".e-splitBtn"),jQuery.each(l,function(t,i){e(l[t]).attr("data-tag").split(":")[1]==s._selectedMember.parent().parent().attr("data-tag").replace(/\[/g,"").replace(/\]/g,"")&&e(i).remove()}),s._cubeTreeView.model.beforeDelete=null,s._cubeTreeView.removeNode(s._selectedMember.parent().parent().attr("id").replace(/'/g,"")),s._cubeTreeView.model.beforeDelete=function(){return!1},t.isNullOrUndefined(s._calcMemberTreeObj)||s._calcMemberTreeObj.removeNode(s._selectedMember.parent().parent().attr("id")),0==s.element.find(".e-cubeTreeView .e-calcMemberCDB").length&&s.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").parents("li").length>0&&(s._cubeTreeView.model.beforeDelete=null,s._cubeTreeView.removeNode(s.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").parents("li").attr("id").replace(/'/g,"")),s._cubeTreeView.model.beforeDelete=function(){return!1}),0==s.element.find(".e-cubeTreeViewCalcMember .e-calcMemberCDB").length&&s.element.find(".e-cubeTreeViewCalcMember .e-calcMemberGroupCDB").parents("li").length>0&&s._calcMemberTreeObj.removeNode(s.element.find(".e-cubeTreeViewCalcMember .e-calcMemberGroupCDB").parents("li").attr("id")),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"removeCalculatedMember",element:this.element,customObject:this.model.customObject}),a=JSON.stringify(this.model.customObject),r=this._selectedMember.parent().parent().attr("data-tag"),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.removeSplitButton,JSON.stringify({action:"removeCalculatedMember",clientParams:r,olapReport:s.currentReport,clientReports:s.reports,customObject:a}),s._removeSplitButtonSuccess);else{if("Slicer"==(o=o==s._getLocalizedLabels("AddToSlicer")?"Slicer":o==s._getLocalizedLabels("AddToColumn")?"Categorical":o==s._getLocalizedLabels("AddToRow")?"Series":"")&&null!=this._selectedMember.parent().parent().attr("data-tag")&&this._selectedMember.parent().parent().attr("data-tag").indexOf("Measure")>-1&&this.element.find(".e-splitBtn[data-tag*=Measures]").length>1||"Slicer"==o&&this._selectedMember.parent().parent().attr("data-tag").indexOf("Measure")>-1&&this._selectedMember.parent().parent().find(".e-calcMemberCDB").length>0&&1==this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").length&&this._selectedMember.parent().parent().attr("data-tag").replace(/\[/g,"").replace(/\]/g,"")!=this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").attr("data-tag").split(":")[1].split("::")[0]||"Slicer"==o&&this._selectedMember.parent().parent().attr("data-tag").indexOf("Measure")>-1&&0==this._selectedMember.parent().parent().find(".e-calcMemberCDB").length&&1==this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").length||"Slicer"==o&&this._selectedMember.parent().parent().attr("data-tag").indexOf("Measure")>-1&&1==this._selectedMember.parent().parent().find(".e-calcMemberCDB").length&&0==this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").length&&1==this.element.find(".e-splitBtn[data-tag*=Measure]").length)return t.Pivot._createErrorDialog(this._getLocalizedLabels("MultipleMeasure"),this._getLocalizedLabels("Warning"),this),!1;setTimeout(function(){s._isTimeOut&&s._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),a=JSON.stringify(this.model.customObject),r=s.currentCubeName+"--"+this._selectedMember.parent().parent().attr("data-tag")+"--"+o+"--",s.doAjaxPost("POST",s.model.url+"/"+s.model.serviceMethodSettings.nodeDropped,JSON.stringify({action:"nodeDropped",dropType:"TreeNode",nodeInfo:r,olapReport:s.currentReport,clientReports:s.reports,customObject:a}),s._nodeDroppedSuccess)}},_toggleAxisSuccess:function(l){var a,r,o,s;t.Pivot._updateValueSortingIndex(l,this),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot?(t.isNullOrUndefined(l.d)?this.setOlapReport(l.PivotReport):this.setOlapReport(e.grep(l.d,function(e){return"PivotReport"==e.Key})[0].Value),this.refreshControl(l)):(l[0]!=i?(a=l[0].Value,r=l[1].Value,o=l[2].Value,this.currentReport=l[3].Value,this.reports=l[4].Value):l.d!=i?(a=l.d[0].Value,r=l.d[1].Value,o=l.d[2].Value,this.currentReport=l.d[3].Value,this.reports=l.d[4].Value):(a=l.Columns,r=l.Rows,o=l.Slicers,this.currentReport=l.CurrentReport,this.reports=l.ClientReports),this.model.OperationalMode==t.Pivot.AnalysisMode.ServerMode&&(this.element.find(".e-cubeTable").find(".e-categoricalAxis").parent().html("").html(this._createAxisElementBuilder(a,r,o)),this.model.enableSplitter&&!t.isNullOrUndefined(this.element.find(".e-serverchildsplit").data("ejSplitter"))&&this.element.find(".e-serverchildsplit > .e-splitbar").css("height",this.element.find(".e-cubeTable").height()),this.element.find(".e-cubeTable").height(this.element.height()-((this.element.find("div.e-titleText").length>0?this.element.find("div.e-titleText").height():0)+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+38)),this.element.find(".cdbTD, .cubeTableTD").height(this.element.find(".e-cubeTable").height()),s=this.element.find(".cdbTD, .cubeTableTD").height()-(3*this.element.find(".e-axisHeader").height()+(this.model.enableSplitter?this.model.isResponsive?18:24:this.model.isResponsive?14:3)),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").height(s/3)),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find("button").ejButton({height:"20px",type:t.ButtonType.Button}),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").addClass("e-droppable"),this._renderControls(),this._setSplitBtnTitle(),this.model.showUniqueNameOnPivotButton&&(e(".e-pvtBtn").addClass("e-splitBtnUnique"),this._addSplitButtonHeight()),this._unWireEvents(),this._wireEvents(),this._trigger("renderSuccess",this),this._buttonContextMenu())},_measureGroupChangedSuccess:function(l){var a,r,o,s;for(l[0]!=i&&(a=l[0].Value),a=l.d!=i?l.d[0].Value:l.CubeTreeInfo,this.element.find(".e-treeview, .e-cubeTreeView").remove(),l=t.buildTag("div#cubeTreeView.e-cubeTreeView")[0].outerHTML,this.element.find(".e-cubeBrowser").append(l),r=e.parseJSON(a),this.element.find(".e-cubeTreeView").ejTreeView({clientObj:this,fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:r,parentUniqueName:"parentUniqueName"},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:this.model.enableRTL,dragAndDropAcrossControl:!0,nodeDragStart:function(){this.model.clientObj.isDragging=!0},nodeDropped:t.proxy(this._nodeDropped,this),beforeDelete:function(){return!1},cssClass:"pivotTreeViewDragedNode",height:"464px"}),o=this.element.find(".e-cubeTreeView").find("li"),s=0;s<o.length;s++)!t.isNullOrUndefined(o[s].id)&&o[s].id.indexOf("'").length>-1&&o[s].setAttribute("id",o[s].id.replace(/'/g,"")),o[s].setAttribute("data-tag",r[s].tag),t.isNullOrUndefined(r[s].parentUniqueName)||""==r[s].parentUniqueName||o[s].setAttribute("data-parentUniqueName",t.isNullOrUndefined(r[s].parentUniqueName)?"":r[s].parentUniqueName.split(">>||>>")[1]);this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-this.element.find(".e-cubeName").height()-(7+(this.model.enableMeasureGroups?this.element.find(".measureGroupselector").height()+13:0))),this._cubeTreeView=this.element.find(".e-cubeTreeView").data("ejTreeView"),this._unWireEvents(),this._wireEvents(),this._isTimeOut=!1,this._waitingPopup.hide(),this._successAction="MeasureGroupChange"},_cubeChangedSuccess:function(l){var a,r,o,s,n,d,h,c,p;l[0]!=i?(this.currentReport=l[0].Value,a=l[1].Value,this.reports=l[2].Value,this.reportsCount=l[3].Value,o=e.parseJSON(l[4].Value),this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l[5].Value)),r=e.parseJSON(l[6].Value),null!=l[7]&&l[7]!=i&&(this.model.customObject=l[7].Value)):l.d!=i?(this.currentReport=l.d[0].Value,a=l.d[1].Value,this.reports=l.d[2].Value,this.reportsCount=l.d[3].Value,o=e.parseJSON(l.d[4].Value),this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l.d[5].Value)),r=e.parseJSON(l.d[6].Value),null!=l.d[7]&&l.d[7]!=i&&("Columns"!=(s=l.d[7].Key)&&(this.model.customObject=l.d[7].Value),"Columns"==s&&(l.Columns=l.d[7].Value),"Rows"==s&&(l.Rows=l.d[8].Value),"Slicers"==s&&(l.Slicers=l.d[9].Value))):(this.currentReport=l.NewReport,a=l.CubeTreeInfo,this.reports=l.ClientReports,this.reportsCount=l.ReportsCount,o=e.parseJSON(l.ReportList),this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l.MeasureGroups)),r=e.parseJSON(l.ControlSettings),null!=l.customObject&&l.customObject!=i&&(this.model.customObject=l.customObject)),n=this.currentCubeName,d=e.map(this._repCol,function(e){if(e.CubeName==n)return e.slicerBtnTextInfo}),this.slicerBtnTextInfo=d.length>0?d[0]:{},this.model.chartType=r.ChartType.toLowerCase(),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"cubeChanged",element:this.element,customObject:this.model.customObject}),this.model.enableDeferUpdate?this.element.find(".e-splitBtn, .e-treeview, .e-cubeTreeView, .e-cubeName, .searchDiv").remove():this.element.find(".e-splitBtn, .e-pivotgrid, .e-pivotchart, .e-treeview, .e-cubeTreeView, .e-cubeName, .searchDiv").remove();var u=t.buildTag("div#cubeTreeView.e-cubeTreeView")[0].outerHTML,m=t.buildTag("div.searchDiv",t.buildTag("input#"+this._id+"_SearchTreeView.searchTreeView").attr("type","text")[0].outerHTML,{margin:"5px 5px 0px 5px"})[0].outerHTML,g=t.buildTag("div.e-cubeName",this.currentCubeName+m)[0].outerHTML;for(this.model.enableMeasureGroups&&this._createMeasureGroup(),h=e.parseJSON(a),e(u).appendTo(".e-cubeBrowser"),this.element.find(".e-cubeTreeView").ejTreeView({clientObj:this,fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:h,parentUniqueName:"parentUniqueName"},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:this.model.enableRTL,dragAndDropAcrossControl:!0,nodeDragStart:function(){this.model.clientObj.isDragging=!0},nodeDropped:t.proxy(this._nodeDropped,this),beforeDelete:function(){return!1},cssClass:"pivotTreeViewDragedNode",height:this.model.enableMeasureGroups?"464px":""}),c=this.element.find(".e-cubeTreeView").find("li"),p=0;p<c.length;p++)!t.isNullOrUndefined(c[p].id)&&c[p].id.indexOf("'").length>-1&&c[p].setAttribute("id",c[p].id.replace(/'/g,"")),c[p].setAttribute("data-tag",h[p].tag),t.isNullOrUndefined(h[p].parentUniqueName)||""==h[p].parentUniqueName||c[p].setAttribute("data-parentUniqueName",t.isNullOrUndefined(h[p].parentUniqueName)?"":h[p].parentUniqueName.split(">>||>>")[1]);this._cubeTreeView=this.element.find(".e-cubeTreeView").data("ejTreeView"),this.element.find(".reportlist").ejDropDownList("option","change",t.proxy(this._reportChanged,this)),this.element.find(".reportlist").ejDropDownList("option","dataSource",o),this.element.find(".reportlist").ejDropDownList("option","value",o[this._reportIndex].name),e(this.element).find(".e-cubeBrowser").prepend(g),this.element.find("#"+this._id+"_SearchTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search"),maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(t.Pivot._searchTreeNodes,this)}),this.model.enableSplitter&&!t.isNullOrUndefined(this.element.find(".e-serverchildsplit").data("ejSplitter"))&&(this.element.find(".e-serverchildsplit > .e-splitbar").css("height",this.element.find(".e-cubeTable").height()),this.element.find(".e-serverchildsplit").data("ejSplitter").refresh()),this.element.find(".e-cubeTable").height(this.element.height()-(this.element.find("div.e-titleText").height()+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+38)),this.element.find(".cdbTD, .cubeTableTD").height(this.element.height()-(this.element.find("div.e-titleText").height()+this.element.find("#reportToolbar").height()+this.element.find(".e-csHeader").height()+38)),this.element.find(".e-cubeBrowser").height(this.element.find(".cdbTD, .cubeTableTD").height()-(this.element.find(".e-cdbHeader").height()+5)+(this.model.isResponsive?0:14)),e(this._createSplitButtons(l.Columns,"Columns")).appendTo(".e-categoricalAxis"),t.isNullOrUndefined(l.Rows)?e(this._createSplitButtons("","Rows")).appendTo(".e-rowAxis"):e(this._createSplitButtons(l.Rows,"Rows")).appendTo(".e-rowAxis"),t.isNullOrUndefined(l.Slicers)?e(this._createSplitButtons("","Slicers")).appendTo(".e-slicerAxis"):e(this._createSplitButtons(l.Slicers,"Slicers")).appendTo(".e-slicerAxis"),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find("button").ejButton({height:"20px",type:t.ButtonType.Button}),this._setSplitBtnTitle(),this._renderControls(),this._unWireEvents(),this._wireEvents(),this._isTimeOut=!1,this._waitingPopup.hide(),this._successAction="CubeChange",this._trigger("renderSuccess",this),this._treeContextMenu(),this._buttonContextMenu(),this.model.showUniqueNameOnPivotButton&&(this.element.find(".e-pvtBtn").addClass("e-splitBtnUnique"),this._addSplitButtonHeight()),this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-this.element.find(".e-cubeName").height()-(7+(this.model.enableMeasureGroups?this.element.find(".measureGroupselector").height()+13:0)))},_treeContextMenu:function(){var i=t.buildTag("ul.pivotTreeContext#pivotTreeContext",t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToColumn"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToRow"))[0].outerHTML)[0].outerHTML+t.buildTag("li",t.buildTag("a",this._getLocalizedLabels("AddToSlicer"))[0].outerHTML)[0].outerHTML+t.buildTag("li#Remove",t.buildTag("a",this._getLocalizedLabels("Remove"))[0].outerHTML)[0].outerHTML)[0].outerHTML;e(this.element).append(i),e("#pivotTreeContext").ejMenu({menuType:t.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:this.element.find(".e-cubeTreeView")[0],click:t.proxy(this._onTreeContextClick,this),beforeOpen:t.proxy(this._onContextOpen,this),close:t.proxy(t.Pivot.closePreventPanel,this)})},_removeSplitButtonSuccess:function(e){e[0]!=i?(this.currentReport=e[0].Value,this.reports=e[1].Value,null!=e[2]&&e[2]!=i&&(this.model.customObject=e[2].Value)):e.d!=i?(this.currentReport=e.d[0].Value,this.reports=e.d[1].Value,null!=e.d[2]&&e.d[2]!=i&&(this.model.customObject=e.d[2].Value)):(this.currentReport=e.UpdatedReport,this.reports=e.ClientReports,null!=e.customObject&&e.customObject!=i&&(this.model.customObject=e.customObject)),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"removeSplitButton",element:this.element,customObject:this.model.customObject}),this._renderControls(),this._unWireEvents(),this._wireEvents(),this._successAction="ButtonRemove",this._trigger("renderSuccess",this)},_chartTypeChangedSuccess:function(e){e[0]!=i?(this.currentReport=e[0].Value,this.reports=e[1].Value):e.d!=i?(this.currentReport=e.d[0].Value,this.reports=e.d[1].Value):(this.currentReport=e.CurrentReport,this.reports=e.ClientReports)},_mdxQuery:function(e){this.element.find(".e-dialog").hide(),this.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),e.d!=i?this._createDialog("mdx",e.d,""):this._createDialog("mdx",e,"")},_refreshReportList:function(){var t=e.map(this._clientReportCollection,function(e){if(e.reportName!=i)return{name:e.reportName}}),l=this.element.find(".reportlist").data("ejDropDownList");this.element.find(".reportlist").ejDropDownList("option","dataSource",t),l.selectItemByText(this.model.dataSource.reportName),this._unWireEvents(),this._wireEvents()},_clientToolbarOperationSuccess:function(e){var l,a="";null!=e&&(l="",e&&e.d?a=e.d[0].Value:e&&e.report&&(a=e.report),a.indexOf(":>>:")>-1&&(this._currentReportItems=JSON.parse(a.split(":>>:")[1])),a=l=this._pivotSchemaDesigner._repCollection=JSON.parse(a.split(":>>:")[0]),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&a[a.length-1].cubeIndex!=i?(l=a[a[a.length-1].cubeIndex].Reports,this.model.calculatedMembers=a[a[a.length-1].cubeIndex].calculatedMembers,this.reportDropTarget.selectItemByIndex(a[a[a.length-1].cubeIndex].ReportIndex)):this.reportDropTarget.selectItemByIndex(0),l.length>0&&(this.model.dataSource=l[0]),this._clientReportCollection=l,this.model.dataSource?(!t.isNullOrUndefined(this._pivotSchemaDesigner)&&this._pivotSchemaDesigner.element.find(".cubeList").length>0&&!t.isNullOrUndefined(l[a[a[a.length-1].cubeIndex].ReportIndex])&&!t.isNullOrUndefined(l[a[a[a.length-1].cubeIndex].ReportIndex].cube)&&(this._pivotSchemaDesigner.element.find(".cubeList").data("ejDropDownList").selectItemByText(l[a[a[a.length-1].cubeIndex].ReportIndex].cube),this._pivotSchemaDesigner._repCollection.splice(a.length-1,1)),this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&this.refreshControl(this.model.dataSource),this._refreshReportList()):this._waitingPopup&&(this._isTimeOut=!1,this._waitingPopup.hide()))},_successDialog:function(e){var i="Save"==e?this._getLocalizedLabels("SaveMsg"):"Rename"==e?this._getLocalizedLabels("RenameMsg"):"Remove"==e?this._getLocalizedLabels("RemoveMsg"):"";""!=i&&t.Pivot._createErrorDialog(i,this._getLocalizedLabels("Success"),this),this._isTimeOut=!1},_toolbarOperationSuccess:function(l){var a,r,o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y;if(null!=l&&(l.CurrentAction!=i&&"Load Report"!=l.CurrentAction&&"Add Report"!=l.CurrentAction&&"Remove Report"!=l.CurrentAction&&"New Report"!=l.CurrentAction&&"Rename Report"!=l.CurrentAction&&"Report Change"!=l.CurrentAction?this._successDialog(l.CurrentAction):l.d!=i&&l.d[0]!=i&&("CurrentAction"==(p=l.d[0].Key)&&l.d[0].Value!=i&&"Load Report"!=l.d[0].Value&&"Add Report"!=l.d[0].Value&&"Remove Report"!=l.d[0].Value&&"New Report"!=l.d[0].Value&&"Rename Report"!=l.d[0].Value&&"Report Change"!=l.d[0].Value&&(this._successDialog(l.d[0].Value),l.d=null)),l.d!=i&&l.d||l[0]!=i&&l[0]||l.CurrentReport||l.PivotReport)){if(l.length>1&&l[0]!=i)this.currentReport=l[0].Value,this.reports=l[1].Value,this.reportsCount=l[2].Value,a=l[3].Value,r=l[4].Value,o=l[5].Value,s=l[6].Value,m=e.parseJSON(l[7].Value),n=l[8].Value,d=e.parseJSON(l[9].Value),h=l[10].Value,c=l[11].Value,this.model.enableMeasureGroups&&null!=l[12]&&l[12]!=i&&(this.measureGroupInfo=e.parseJSON(l[12].Value)),null!=l[13]&&l[13]!=i&&("Collection"!=(p=l[13].Key)?this.model.customObject=l[13].Value:"Collection"==p&&(this._repCol=JSON.parse(l[13].Value),t.isNullOrUndefined(this._repCol[this._repCol.length-1].cubeIndex)||(f=this._repCol[this._repCol[this._repCol.length-1].cubeIndex].slicerBtnTextInfo,b=this._repCol[this._repCol[this._repCol.length-1].cubeIndex]._fieldSelectedMembers,this._slicerBtnTextInfo=t.isNullOrUndefined(f)?{}:f,this._fieldSelectedMembers=t.isNullOrUndefined(b)?{}:b)));else if(l.d!=i){if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)return s=e.grep(l.d,function(e){return"CurrentAction"==e.Key})[0].Value,this.setOlapReport(e.grep(l.d,function(e){return"PivotReport"==e.Key})[0].Value),this.currentReport=e.parseJSON(this.getOlapReport()).Report,a=e.parseJSON(this.getOlapReport()).PivotColumns,r=e.parseJSON(this.getOlapReport()).PivotRows,o=e.parseJSON(this.getOlapReport()).Filters,"NewReport"==s?(this._clientReportCollection=[{name:this._currentReportName,report:this.currentReport}],this.refreshControl({GridJSON:JSON.stringify(""),ChartJSON:JSON.stringify(""),PivotReport:e.grep(l.d,function(e){return"PivotReport"==e.Key})[0].Value})):"AddReport"==s?(this._clientReportCollection.push({name:this._currentReportName,report:this.currentReport}),this.refreshControl({GridJSON:JSON.stringify(""),ChartJSON:JSON.stringify(""),PivotReport:e.grep(l.d,function(e){return"PivotReport"==e.Key})[0].Value})):("RemoveReport"==s||"ChangeReport"==s)&&(u=this._hiddenCellInfo(l.d),this.refreshControl({GridJSON:e.grep(l.d,function(e){return"GridJSON"==e.Key})[0].Value,ChartJSON:e.grep(l.d,function(e){return"ChartJSON"==e.Key})[0].Value,PivotReport:e.grep(l.d,function(e){return"PivotReport"==e.Key})[0].Value,FilteredColumnHeaders:u.columnArea.length>0?u.columnArea:"[]",FilteredRowHeaders:u.rowArea.length>0?u.rowArea:"[]"})),m=e.map(this._clientReportCollection,function(e){return{name:e.name}}),this.element.find(".reportlist").ejDropDownList("option","dataSource",m),g=this.element.find(".reportlist").data("ejDropDownList"),this._isReportListAction=!1,g.selectItemByText(this._currentReportName),void(this._isReportListAction=!0);this.currentReport=l.d[0].Value,this.reports=l.d[1].Value,this.reportsCount=l.d[2].Value,a=l.d[3].Value,r=l.d[4].Value,o=l.d[5].Value,s=l.d[6].Value,m=e.parseJSON(l.d[7].Value),n=l.d[8].Value,d=e.parseJSON(l.d[9].Value),h=l.d[10].Value,c=l.d[11].Value,this.model.enableMeasureGroups&&null!=l.d[12]&&l.d[12]!=i&&(this.measureGroupInfo=e.parseJSON(l.d[12].Value)),null!=l.d[13]&&l.d[13]!=i&&"Collection"!=l.d[13].Key?this.model.customObject=l.d[13].Value:null!=l.d[13]&&l.d[13]!=i&&"Collection"==l.d[13].Key&&(this._repCol=JSON.parse(l.d[13].Value),t.isNullOrUndefined(this._repCol[this._repCol.length-1].cubeIndex)||(f=this._repCol[this._repCol[this._repCol.length-1].cubeIndex].slicerBtnTextInfo,this._slicerBtnTextInfo=t.isNullOrUndefined(f)?{}:f,b=this._repCol[this._repCol[this._repCol.length-1].cubeIndex]._fieldSelectedMembers,this._fieldSelectedMembers=t.isNullOrUndefined(b)?{}:b))}else{if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)return s=l.CurrentAction,this.setOlapReport(l.PivotReport),this.currentReport=e.parseJSON(this.getOlapReport()).Report,a=e.parseJSON(this.getOlapReport()).PivotColumns,r=e.parseJSON(this.getOlapReport()).PivotRows,o=e.parseJSON(this.getOlapReport()).Filters,"NewReport"==s?(this._clientReportCollection=[{name:this._currentReportName,report:this.currentReport}],this.refreshControl({GridJSON:JSON.stringify(""),ChartJSON:JSON.stringify(""),PivotReport:l.PivotReport})):"AddReport"==s?(this._clientReportCollection.push({name:this._currentReportName,report:this.currentReport}),this.refreshControl({GridJSON:JSON.stringify(""),ChartJSON:JSON.stringify(""),PivotReport:l.PivotReport})):("RemoveReport"==s||"ChangeReport"==s)&&this.refreshControl({GridJSON:l.GridJSON,ChartJSON:l.ChartJSON,PivotReport:l.PivotReport,FilteredColumnHeaders:t.isNullOrUndefined(l.FilteredColumnHeaders)?"[]":l.FilteredColumnHeaders,FilteredRowHeaders:t.isNullOrUndefined(l.FilteredRowHeaders)?"[]":l.FilteredRowHeaders}),m=e.map(this._clientReportCollection,function(e){return{name:e.name}}),this.element.find(".reportlist").ejDropDownList("option","dataSource",m),g=this.element.find(".reportlist").data("ejDropDownList"),this._isReportListAction=!1,g.selectItemByText(this._currentReportName),void(this._isReportListAction=!0);this._repCol=t.isNullOrUndefined(l.Collection)?this._repCol:JSON.parse(l.Collection),this.currentReport=l.CurrentReport,this.reports=l.Reports,this.reportsCount=l.ReportsCount,a=l.Columns,r=l.Rows,o=l.Slicers,s=l.CurrentAction,m=e.parseJSON(l.ReportList),n=l.RenamedReport,d=e.parseJSON(l.ControlSettings),h=l.CubeTreeInfo,c=l.CubeSelector,this.model.enableMeasureGroups&&(this.measureGroupInfo=e.parseJSON(l.MeasureGroups)),null!=l.customObject&&l.customObject!=i&&(this.model.customObject=l.customObject),this._repCol!=i&&this._repCol.length>0&&!t.isNullOrUndefined(this._repCol[this._repCol.length-1].cubeIndex)&&(f=this._repCol[this._repCol[this._repCol.length-1].cubeIndex].slicerBtnTextInfo,this._slicerBtnTextInfo=t.isNullOrUndefined(f)?{}:f,b=this._repCol[this._repCol[this._repCol.length-1].cubeIndex]._fieldSelectedMembers,this._fieldSelectedMembers=t.isNullOrUndefined(b)?{}:b)}if(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&(this.model.chartType=d.ChartType.toLowerCase()),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"toolbarOperation",element:this.element,customObject:this.model.customObject}),"Report Change"!=s){if(this.element.find(".reportlist").ejDropDownList("option","change",""),this.element.find(".reportlist").ejDropDownList("option","dataSource",m),"Load Report"==s){for(this.ddlTarget._initValue=!0,this.ddlTarget.selectItemByText(c),this.currentCubeName=c,this.ddlTarget._initValue=!1,!t.isNullOrUndefined(l.Collection)||l.d!=i&&l.d[13]!=i&&"Collection"==l.d[13].Key?this.reportDropTarget.selectItemByIndex(this._repCol[this._repCol[this._repCol.length-1].cubeIndex].ReportIndex):this.reportDropTarget.selectItemByText(this.reportDropTarget.model.dataSource[0].name),this._repCol.splice(this._repCol.length-1,1),this._selectedReport=this.reportDropTarget.currentValue,this.element.find(".searchDiv").remove(),this.model.enableMeasureGroups&&this._createMeasureGroup(),_=t.buildTag("div.searchDiv",t.buildTag("input#"+this._id+"_SearchTreeView.searchTreeView").attr("type","text")[0].outerHTML,{margin:"5px 5px 0px 0px"})[0].outerHTML,O=e(this.element).find(".e-cubeName").html(c+_),e(this.element).find(".e-cubeBrowser").prepend(O),this.element.find("#"+this._id+"_SearchTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search"),maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(t.Pivot._searchTreeNodes,this)}),T=e.parseJSON(h),this.element.find(".e-cubeTreeView").ejTreeView({clientObj:this,fields:{id:"id",parentId:"pid",text:"name",spriteCssClass:"spriteCssClass",dataSource:T,parentUniqueName:"parentUniqueName"},allowDragAndDrop:!0,allowDropChild:!1,allowDropSibling:!1,enableRTL:this.model.enableRTL,dragAndDropAcrossControl:!0,nodeDragStart:function(){this.model.clientObj.isDragging=!0},nodeDropped:t.proxy(this._nodeDropped,this),beforeDelete:function(){return!1},cssClass:"pivotTreeViewDragedNode",height:this.model.enableMeasureGroups?"464px":"495px"}),v=this.element.find(".e-cubeTreeView").find("li"),S=0;S<v.length;S++)!t.isNullOrUndefined(v[S].id)&&v[S].id.indexOf("'").length>-1&&v[S].setAttribute("id",v[S].id.replace(/'/g,"")),v[S].setAttribute("data-tag",T[S].tag),t.isNullOrUndefined(T[S].parentUniqueName)||""==T[S].parentUniqueName||v[S].setAttribute("data-parentUniqueName",t.isNullOrUndefined(T[S].parentUniqueName)?"":T[S].parentUniqueName.split(">>||>>")[1]);for(C=this.element.find(".e-cubeTreeView .e-folderCDB"),S=0;S<C.length;S++)e(C[S].parentElement).removeClass("e-draggable");for(C=this.element.find(".e-cubeTreeViewCalcMember .e-folderCDB"),S=0;S<C.length;S++)e(C[S].parentElement).removeClass("e-draggable");this._cubeTreeView=this.element.find(".e-cubeTreeView").data("ejTreeView"),this.model.isResponsive?this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-(56+(this.model.enableMeasureGroups?35:0))):this.element.find(".e-cubeTreeView").height(this.element.find(".e-cubeBrowser").height()-(61+(this.model.enableMeasureGroups?30:0)))}else"Rename Report"!=s?(this._isReportListAction=!1,this.reportDropTarget.selectItemByText(this.reportDropTarget.model.dataSource[m.length-1].name),this._isReportListAction=!0,this._selectedReport=this.reportDropTarget.currentValue):(this._excelFilterInfo.length>0&&(O=this.element.find(".cubeSelector").data("ejDropDownList").model.value,this.element.find("#reportList").data("ejDropDownList").model.value,this._excelFilterInfo=e.grep(this._excelFilterInfo,function(e){return e.cubeName==O&&e.report==this.reportDropTarget.model.itemValue&&(e.report=n),e})),this._isReportListAction=!1,this.reportDropTarget.selectItemByText(n),this._isReportListAction=!0,this._selectedReport=this.reportDropTarget.currentValue);this.element.find(".reportlist").ejDropDownList("option","change",t.proxy(this._reportChanged,this))}"Rename Report"!=s&&(this.model.enableDeferUpdate?this.element.find(".e-splitBtn").remove():this.element.find(".e-splitBtn, .e-pivotgrid, .e-pivotchart").remove()),("Add Report"==s||"New Report"==s||"Remove Report"==s||"Report Change"==s||"Load Report"==s||"SortOrFilter"==s||"Save Report"==s)&&(T=e.parseJSON(h),y=t.DataManager(T).executeLocal(t.Query().where("spriteCssClass","contains","e-calcMemberGroupCDB")),this._cubeTreeView.model.beforeDelete=null,this._cubeTreeView.removeNode(this.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").parents("li")),this._cubeTreeView.model.beforeDelete=function(){return!1},t.isNullOrUndefined(this._calcMemberTreeObj)||this._calcMemberTreeObj.removeNode(this.element.find(".e-cubeTreeViewCalcMember .e-calcMemberGroupCDB").parents("li")),y.length>0&&!t.isNullOrUndefined(this._cubeTreeView)&&(this._calcMembers=[],this._calcMembers.push(y),e.merge(this._calcMembers,t.DataManager(T).executeLocal(t.Query().where("spriteCssClass","contains","e-calcMemberCDB"))),this._calcMemberTreeViewUpdate())),("Remove Report"==s||"Report Change"==s||"Load Report"==s||"SortOrFilter"==s||"Save Report"==s)&&(e(this._createSplitButtons(a,"Columns")).appendTo(".e-categoricalAxis"),e(this._createSplitButtons(r,"Rows")).appendTo(".e-rowAxis"),e(this._createSplitButtons(o,"Slicers")).appendTo(".e-slicerAxis"),this.element.find(".e-categoricalAxis, .e-rowAxis, .e-slicerAxis").find("button").ejButton({height:"20px",type:t.ButtonType.Button}),this._renderControls()),("Add Report"==s||"New Report"==s)&&this._renderControls()}this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&(this._treeContextMenu(),this._buttonContextMenu()),this._setSplitBtnTitle(),this.model.showUniqueNameOnPivotButton&&(e(".e-pvtBtn").addClass("e-splitBtnUnique"),this._addSplitButtonHeight()),this._unWireEvents(),this._wireEvents(),this._isTimeOut=!1,this._waitingPopup.hide(),this._successAction="ToolbarOperation",this._trigger("renderSuccess",this)},_calcMemberTreeViewUpdate:function(){var e,i,l;if(this._cubeTreeView.model.beforeDelete=null,this._cubeTreeView.removeNode(this.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").parents("li")),this._cubeTreeView.model.beforeDelete=function(){return!1},t.isNullOrUndefined(this._calcMemberTreeObj)||this._calcMemberTreeObj.removeNode(this.element.find(".e-cubeTreeViewCalcMember .e-calcMemberGroupCDB").parents("li")),this.element.find(".e-cubeTreeView").find("li").first().length>0){for(this._cubeTreeView.insertBefore(this._calcMembers[0],this.element.find(".e-cubeTreeView").find("li").first()),l=0;l<this._calcMembers.length;l++)!t.isNullOrUndefined(this._calcMembers[l].id)&&this._calcMembers[l].id.indexOf("'")>-1&&(this._calcMembers[l].id=this._calcMembers[l].id.replace(/'/g,""));this._cubeTreeView.addNodes(t.DataManager(this._calcMembers).executeLocal(t.Query().skip(1)),this._calcMembers[0].id),this.element.find(".e-cubeTreeView").find("#"+this._calcMembers[0].id).find("> div > div:first").removeClass("e-process"),this._cubeTreeView.collapseNode(this._calcMembers[0].id)}else this._calcMembers.length>0&&(this._cubeTreeView.addNodes(this._calcMembers[0]),this.element.find(".e-cubeTreeView").find("#"+this._calcMembers[0].id).find("> div > div:first").removeClass("e-process"),this._cubeTreeView.addNodes(t.DataManager(this._calcMembers).executeLocal(t.Query().skip(1)),this._calcMembers[0].id));if(!t.isNullOrUndefined(this._calcMemberTreeObj)&&this.element.find(".e-cubeTreeViewCalcMember").find("li").first().length>0){for(this._calcMemberTreeObj.insertBefore(this._calcMembers[0],this.element.find(".e-cubeTreeViewCalcMember").find("li").first()),l=0;l<this._calcMembers.length;l++)!t.isNullOrUndefined(this._calcMembers[l].id)&&this._calcMembers[l].id.indexOf("'")>-1&&(this._calcMembers[l].id=this._calcMembers[l].id.replace(/'/g,""));this._calcMemberTreeObj.addNodes(t.DataManager(this._calcMembers).executeLocal(t.Query().skip(1)),this._calcMembers[0].id),this.element.find(".e-cubeTreeViewCalcMember").find("#"+this._calcMembers[0].id).find("> div > div:first").removeClass("e-process"),this._calcMemberTreeObj.collapseNode(this._calcMembers[0].id)}else!t.isNullOrUndefined(this._calcMemberTreeObj)&&this._calcMembers.length>0&&(this._calcMemberTreeObj.addNodes(this._calcMembers[0]),this.element.find(".e-cubeTreeViewCalcMember").find("#"+this._calcMembers[0].id).find("> div > div:first").removeClass("e-process"),this._calcMemberTreeObj.addNodes(t.DataManager(this._calcMembers).executeLocal(t.Query().skip(1)),this._calcMembers[0].id));if(this.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").length>0&&(this.element.find(".e-cubeTreeView .e-calcMemberGroupCDB").parent().removeClass("e-draggable"),this.element.find(".e-cubeTreeViewCalcMember .e-calcMemberGroupCDB").parent().removeClass("e-draggable"),e=this.element.find(".e-cubeTreeView .e-calcMemberCDB").parents("li").find("li"),i=this.element.find(".e-cubeTreeViewCalcMember .e-calcMemberCDB").parents("li").find("li"),e.length>0))for(l=0;l<e.length;l++)e[l].setAttribute("data-tag",this._calcMembers[l+1].tag),e[l].setAttribute("expression",this._calcMembers[l+1].expression),e[l].setAttribute("formatString",this._calcMembers[l+1].formatString),e[l].setAttribute("nodeType",this._calcMembers[l+1].nodeType),i.length>0&&(i[l].setAttribute("data-tag",this._calcMembers[l+1].tag),i[l].setAttribute("expression",this._calcMembers[l+1].expression),i[l].setAttribute("formatString",this._calcMembers[l+1].formatString),i[l].setAttribute("nodeType",this._calcMembers[l+1].nodeType))},_fetchChildNodeSuccess:function(l){var a,r,o,s,n;a=l.length>1&&l[0]!=i?JSON.parse(l[0].Value):l.d!=i?JSON.parse(l.d[0].Value):JSON.parse(l.ChildNodes),l[0]!=i?null!=l[2]&&l[2]!=i&&(this.model.customObject=l[2].Value):l.d!=i?null!=l.d[2]&&l.d[2]!=i&&(this.model.customObject=l.d[2].Value):null!=l.customObject&&l.customObject!=i&&(this.model.customObject=l.customObject),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject}),r=e(this.pNode).parents("li").length>1?e(this.pNode).parents("li").first():e(this.pNode).parents("li"),e(e(r).find("input.nodecheckbox")[0]).ejCheckBox({checked:!1}),this.model.enableMemberEditorSorting&&(a=t.DataManager(a).executeLocal(t.Query().sortBy("name",this._sortType))),!t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",a[0].pid)).length>0&&e.merge(this._editorTreeData,e.extend(!0,[],a)),this.element.find(".nodeExpand").remove(),this.model.enableMemberEditorPaging?(o=t.Pivot._generateChildWithAncestors(this,r,this.model.enableMemberEditorPaging,this.model.memberEditorPageSize),a.length>=this.model.memberEditorPageSize||o.lstChildren.length>=this.model.memberEditorPageSize?(this.element.find(".searchEditorTreeView").data("ejMaskEdit").clear(),this._lastSavedTree=[],t.Pivot._makeAncestorsExpandable(this,r[0].id),this._isEditorDrillPaging=!0,s=o.allLvlLst.length>1&&o.lstChildren.length>=this.model.memberEditorPageSize?t.Pivot._getParentsTreeList(this,o.lstParents[0].id,this._editorTreeData):e.grep(this._editorTreeData,function(e){return e.id==r[0].id})[0],n={childNodes:o.allLvlLst.length>1&&o.lstChildren.length>=this.model.memberEditorPageSize?o.lstChildren:a,parentNode:s},t.Pivot._drillEditorTreeNode(n,this,this.model.memberEditorPageSize)):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this,this),r)):this._memberTreeObj.addNode(t.Pivot._showEditorLinkPanel(a,this,this),r),e.each(e(r).children().find("li"),function(e,i){t.isNullOrUndefined(a[e])||i.setAttribute("data-tag",a[e].tag)}),this._successAction="FetchChildNode",this._trigger("renderSuccess",this),this.element.find(".e-dialog #preventDiv").remove()},_createCubeSelector:function(){return t.buildTag("div.e-csHeader",t.buildTag("span.cubeText",this._getLocalizedLabels("CubeSelector"),{"padding-left":"6px",float:"left","margin-bottom":"10px",width:this.model.enableSplitter&&!this.model.isResponsive?"25%":"","text-overflow":"ellipsis"})[0].outerHTML+t.buildTag("div.cubeSelect","<input type='text' id='cubeSelector' class ='cubeSelector' />",{display:"inline",float:"left","padding-left":this.model.enableSplitter?"1%":"8px",position:"relative",top:"-3px",width:this.model.enableSplitter&&!this.model.isResponsive?"70.5%":""})[0].outerHTML,{width:this.model.isResponsive||this.model.enableSplitter?"100%":"",height:"20px"})[0].outerHTML},_createCubeBrowser:function(){return t.buildTag("div.e-cdbHeader",t.buildTag("span",this._getLocalizedLabels("CubeDimensionBrowser"))[0].outerHTML,{width:this.model.enableSplitter?"100%":"",height:"30px"})[0].outerHTML+t.buildTag("div.e-cubeBrowser",t.buildTag("div.e-cubeTreeView.visibleHide")[0].outerHTML,{width:this.model.enableSplitter?"100%":""})[0].outerHTML},_createAxisElementBuilder:function(e,i,l){return this.model.enableSplitter?t.buildTag("div.e-axisHeader",t.buildTag("span",this._getLocalizedLabels("Column"))[0].outerHTML,{height:"30px",width:"99%"})[0].outerHTML+t.buildTag("div.e-categoricalAxis",this._createSplitButtons(e,"Columns"),{width:this.model.isResponsive||this.model.enableSplitter?"99%":""}).attr("aria-label","column")[0].outerHTML+t.buildTag("div.e-axisHeader",t.buildTag("span",this._getLocalizedLabels("Row"))[0].outerHTML,{height:"30px",width:"99%"})[0].outerHTML+t.buildTag("div.e-rowAxis",this._createSplitButtons(i,"Rows"),{width:this.model.isResponsive||this.model.enableSplitter?"99%":""}).attr("aria-label","row")[0].outerHTML+t.buildTag("div.e-axisHeader",t.buildTag("span",this._getLocalizedLabels("Slicer"))[0].outerHTML,{height:"30px",width:"99%"})[0].outerHTML+t.buildTag("div.e-slicerAxis",this._createSplitButtons(l,"Slicers"),{width:this.model.isResponsive||this.model.enableSplitter?"99%":""}).attr("aria-label","slicer")[0].outerHTML:t.buildTag("div.e-axisHeader",t.buildTag("span",this._getLocalizedLabels("Column"))[0].outerHTML,{height:"30px"})[0].outerHTML+t.buildTag("div.e-categoricalAxis",this._createSplitButtons(e,"Columns"),{width:this.model.isResponsive?"99%":""}).attr("aria-label","column")[0].outerHTML+t.buildTag("div.e-axisHeader",t.buildTag("span",this._getLocalizedLabels("Row"))[0].outerHTML,{height:"30px"})[0].outerHTML+t.buildTag("div.e-rowAxis",this._createSplitButtons(i,"Rows"),{width:this.model.isResponsive?"99%":""}).attr("aria-label","row")[0].outerHTML+t.buildTag("div.e-axisHeader",t.buildTag("span",this._getLocalizedLabels("Slicer"))[0].outerHTML,{height:"30px"})[0].outerHTML+t.buildTag("div.e-slicerAxis",this._createSplitButtons(l,"Slicers"),{width:this.model.isResponsive?"99%":""}).attr("aria-label","slicer")[0].outerHTML},_createSplitButtons:function(e,l){var a,r,o,s,n,d="",h="";if(e.indexOf("~")>-1)for(a=0;a<e.split("~")[0].split("#").length-1;a++)"Measures"==(h=e.split("~")[0].split("#")[a+1].split(".")[0])?h=this._getLocalizedLabels("Measures"):"KPIs"==h?h=this._getLocalizedLabels("KPIs"):e.startsWith("#Measure")?e.indexOf("#Measure")>-1&&(h=e.split("~")[a+1]):h=e.split("~")[a+2],h==i&&(h=e.split("~")[a+1]),d+=t.buildTag("div.e-splitBtn",t.buildTag("button.e-pvtBtn",h).attr({title:e.split("~")[0].split("#")[a+1].replace("."," - ").split("$")[0],fieldCaption:h,allMember:t.isNullOrUndefined(e.split("~")[0].split("#")[a+1].replace("."," - ").split("$")[1])||"multiple items"!=e.split("~")[0].split("#")[a+1].replace("."," - ").split("$")[1].toLowerCase().trim()?e.split("~")[0].split("#")[a+1].replace("."," - ").split("$")[1]:this._getLocalizedLabels("MultipleItems")})[0].outerHTML+t.buildTag("span.e-removeSplitBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML,"",{"data-tag":l+":"+e.split("~")[0].split("#")[a+1].split("$")[0]})[0].outerHTML;else for(a=0;a<e.split("#").length-1;a++)n=e.split("#")[a+1].split("$")[0],"CalculatedMember"==e.split("#")[a+1].split("::")[1]?(r=(o=e.split("#")[a+1].split("::")[0]).split(".")[o.split(".").length-1],o=o.replace("."," - ")):((r="Measures"==e.split("#")[a+1].split(".")[0]?this._getLocalizedLabels("Measures"):e.split("#")[a+1].split(".")[0]).split("::")[1]!=i&&null!=r.split("::")[1]&&"NAMEDSET"==r.split("::")[1].split(">>")[0]&&(s=e.split("#")[a+1].split("::")[1].split(">>")[1],r=r.split("::")[0],n=e.split("#")[a+1].split("$")[0].split(">>")[0]),o="Measures"==e.split("#")[a+1].replace("."," - ").split("$")[0]?this._getLocalizedLabels("Measures"):e.split("#")[a+1].replace("."," - ").split("$")[0]),this.model.enableRTL&&o.indexOf("-")>0&&(o=o.split("-").reverse().join(" - ")),d+=t.buildTag("div.e-splitBtn",t.buildTag("button.e-pvtBtn",this.model.showUniqueNameOnPivotButton?o:r).attr({title:o,fieldCaption:r,allMember:t.isNullOrUndefined(e.split("#")[a+1].split("$")[1])||"multiple items"!=e.split("#")[a+1].split("$")[1].toLowerCase().trim()?e.split("#")[a+1].split("$")[1]:this._getLocalizedLabels("MultipleItems")})[0].outerHTML+t.buildTag("span.e-removeSplitBtn e-icon").attr("role","button").attr("aria-label","remove")[0].outerHTML,"",{"data-parenthierarchy":s,"data-tag":l+":"+n})[0].outerHTML;return d},_setSplitBtnTitle:function(){for(var t,i,l,a,r,o,s=this.element.find(".e-splitBtn"),n=0;n<s.length;n++){var d=e(s[n]).attr("data-tag").split(":")[1].split("."),h="";for(t=0;t<d.length;t++)h+="[Measures]"!=d[0].toUpperCase()?"["+d[t]+"]"+(t%2==0?".":""):d[t]+(t%2==0?".":"");this.element.find(".e-cubeTreeView").length>0&&!(h.indexOf("Measures")>=0)&&((h=h.indexOf("<>")>0?h.replace("<>","."):h).indexOf("'")>0&&(h=h.replace(/'/g,"~@")),i="",l="All"!=(l=e(s[n]).find("button").attr("allMember"))?l:this._getLocalizedLabels("All"),""==(a=this.element.find(".e-cubeTreeView").find("li[data-tag='"+h+"'] a:eq(0)").text())&&(a=this.element.find(".e-cubeTreeView").find("li[data-tag='["+d[1]+"]'] a:eq(0)").text()),a.indexOf(".")>0?e(s[n]).find("button").attr("title",this.model.enableRTL?a.split(".").reverse().join(" - "):a.replace("."," - ")):(r=this.element.find(".e-cubeTreeView").find("li[data-tag='"+h+"'] a:eq(0)").text()||this.element.find(".e-cubeTreeView").find("li[data-tag='"+h.toUpperCase()+"'] a:eq(0)").text()||a,i=e(s[n]).find("button").attr("fieldCaption")==this._getLocalizedLabels("KPIs")?this._getLocalizedLabels("KPIs"):e(s[n]).find("button").attr("fieldCaption")+(""!=r?" - "+r:""),i=this.model.enableRTL&&i.indexOf("-")>0?i.split("-").reverse().join(" - "):i,e(s[n]).find("button").attr("title",i)),"Slicers"==e(s[n]).attr("data-tag").split(":")[0]&&e(s[n]).attr("data-tag").indexOf("::CalculatedMember")<0&&(i=e(s[n]).attr("data-tag").split(":")[1],o=("All"==this._fieldSelectedMembers[i]?l:this._fieldSelectedMembers[i])||l,e(s[n]).find("button").text((this.model.showUniqueNameOnPivotButton?e(s[n]).find("button").parent().attr("data-tag").split(":")[1].replace("."," - "):e(s[n]).find("button").attr("fieldCaption"))+" ("+o+")"),e(s[n]).find("button").attr("title",e(s[n]).find("button").attr("title")+" ("+o+")")))}},_addSplitButtonHeight:function(){for(var t=this.element.find(".e-splitBtn"),i=0;i<t.length;i++)e(t[i]).find(".e-removeSplitBtn").height(e(t[i]).height()-9),e(t[i]).find(".e-removeSplitBtn").css("line-height",e(t[i]).find(".e-removeSplitBtn").height()+"px")},_controlPanel:function(){var e,i,l;if(this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&(i=this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?this.defaultView()==t.PivotClient.DefaultView.Grid?t.buildTag("div#gridPanel.e-gridPanel",t.buildTag("div.e-gridContainer",t.buildTag("div#"+this._id+"_PivotGrid","",{margin:this.model.enableToolBar?"5px 0px 7px":"5px 7px 7px",padding:"1px"})[0].outerHTML,{position:"relative",overflow:this.model.enableToolBar?"":"auto",left:"5px",top:"5px",width:this.model.isResponsive?"100%":this.model.enableSplitter?"inherit":""})[0].outerHTML,{width:this.model.enableSplitter?"99%":"auto",height:"auto"})[0].outerHTML:t.buildTag("div#gridPanel.e-gridPanel",t.buildTag("div.e-gridContainer",t.buildTag("div#"+this._id+"_PivotGrid","",{margin:this.model.enableToolBar?"10px 0px 7px":"10px 7px 7px",padding:"1px",width:this.model.isResponsive&&!this.model.enableSplitter?"auto":this.model.enableSplitter?"inherit":""})[0].outerHTML,{position:"relative",left:"7px","border-top":"none","margin-top":"-7px",overflow:this.model.enableToolBar?"":"auto",height:this.model.enablePaging?"277px":"",width:this.model.isResponsive?"100%":""})[0].outerHTML,{width:"auto",height:"auto"})[0].outerHTML:this.displayMode()==t.PivotClient.DisplayMode.GridOnly?t.buildTag("div#gridPanel.e-gridPanel",t.buildTag("div.e-gridContainer",t.buildTag("div#"+this._id+"_PivotGrid","",{margin:this.model.enableToolBar?"5px 0px 7px":"5px 7px 7px",padding:"1px"})[0].outerHTML,{overflow:this.model.enableToolBar?"":"auto",position:"absolute",left:this.model.enableSplitter?this.model.enableRTL?"13px":"5px":"7px","padding-top":"2px",width:this.model.isResponsive?"100%":this.model.enableSplitter?"98%":"",top:"3px"})[0].outerHTML,{width:"auto",height:"auto"})[0].outerHTML:t.buildTag("div#gridPanel.e-gridPanel",t.buildTag("div.e-gridContainer",t.buildTag("div#"+this._id+"_PivotGrid","",{margin:this.model.enableToolBar?"5px 0px 7px":"5px 7px 7px",padding:"1px"})[0].outerHTML,{overflow:this.model.enableToolBar?"":"auto",position:"relative",width:this.model.isResponsive?"100%":"",left:window.navigator.userAgent.indexOf("Trident")>0?this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.model.enableRTL?"15px":this.model.enableSplitter?"5px":"0px":this.model.enableRTL?"5px":this.model.enableSplitter?"4px":"7px":this.model.enableRTL?"5px":this.model.enableSplitter?this.model.enableVirtualScrolling?"8px":"5px":"7px","padding-top":"5px","border-top":"none"})[0].outerHTML,{width:"100%",height:"auto"})[0].outerHTML),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(l=this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?this.defaultView()==t.PivotClient.DefaultView.Grid?t.buildTag("div#chartPanel.e-chartPanel",t.buildTag("div.e-chartContainer",t.buildTag("div#"+this._id+"_PivotChart","",{overflow:this.model.enableToolBar||this.model.isResponsive?"":"auto",border:this.model.enableToolBar?"none":""})[0].outerHTML,{position:"relative",overflow:this.model.enableToolBar||this.model.enableSplitter?"":"auto",left:"-2px",padding:this.model.enableToolBar?"5px 0px 5px 0px":this.model.enableSplitter?"5px 3px 5px 5px":"5px 0px 5px 5px",width:this.model.isResponsive?"99.2%":this.model.enableSplitter?"inherit":"","border-top":"none","margin-right":"-11px"})[0].outerHTML,{width:"100%",height:"auto"})[0].outerHTML:t.buildTag("div#chartPanel.e-chartPanel",t.buildTag("div.e-chartContainer",t.buildTag("div#"+this._id+"_PivotChart","",{"min-height":this.model.enablePaging?"255px":"",border:this.model.enableToolBar?"none":""})[0].outerHTML,{position:"relative",overflow:this.model.enableToolBar||this.model.enableSplitter||this.model.isResponsive?"":"auto",padding:this.model.enableToolBar?"5px 0px 5px 0px":"5px 0px 5px 5px",width:this.model.isResponsive?"99.6%":this.model.enableSplitter?"inherit":""})[0].outerHTML,{width:"98%",height:"auto"})[0].outerHTML:this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?t.buildTag("div#chartPanel.e-chartPanel",t.buildTag("div.e-chartContainer",t.buildTag("div#"+this._id+"_PivotChart","",{border:this.model.enableToolBar?"none":""})[0].outerHTML,{position:"relative",overflow:this.model.enableToolBar||this.model.enableSplitter||this.model.isResponsive?"":"auto",padding:this.model.enableRTL?this.model.enableSplitter&&!this.model.isResponsive?"5px 4px 2px 6px":"5px 25px 2px 6px":this.model.enableToolBar?"5px 0px 5px 0px":"5px 0px 5px 5px","margin-right":this.model.enableRTL?"1px":"-11px"})[0].outerHTML,{width:this.model.enableSplitter?"96%":this.model.isResponsive?"99%":"98%",margin:this.model.enableSplitter?this.model.enableRTL?this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?"5px -5px 7px":"5px 2px 7px":"5px 5px 7px":"5px 7px 7px",height:"auto"})[0].outerHTML:t.buildTag("div#chartPanel.e-chartPanel",t.buildTag("div.e-chartContainer",t.buildTag("div#"+this._id+"_PivotChart","",{border:this.model.enableToolBar?"none":""})[0].outerHTML,{position:"relative",overflow:this.model.enableToolBar||this.model.enableSplitter||this.model.isResponsive?"":"auto",top:"-5px",left:window.navigator.userAgent.indexOf("Trident")>0?this.model.enableSplitter?"-1px":"-7px":this.model.enableRTL?"12px":"0px",padding:this.model.enableRTL?"5px 5px 0px 5px":this.model.enableToolBar?"5px 0px 5px 0px":"5px 0px 5px 5px","border-top":"none","margin-right":this.model.enableRTL?"0px":this.model.enableSplitter?"-9px":"-11px","margin-left":this.model.enableRTL?"-11px":"0px"})[0].outerHTML,{margin:this.model.enableSplitter?this.model.enableRTL?"5px -3px 7px":"5px 5px 7px":this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?"5px 5px 7px":"5px 7px 7px",width:this.model.isResponsive&&this.model.enableSplitter?this.model.enableRTL?"96%":"99%":"98.5%",left:this.model.enableSplitter?"7px":"",height:"auto"})[0].outerHTML),this.controlPlacement()==t.PivotClient.ControlPlacement.Tab&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid){var a,r,o="<a style='font: bold 12px Segoe UI' href='#gridPanel' tabindex='0'>"+this._getLocalizedLabels("Grid")+"</a>",s="<a style='font: bold 12px Segoe UI' href='#chartPanel' tabindex='0'>"+this._getLocalizedLabels("Chart")+"</a>",n=window.navigator.userAgent.indexOf("Trident")>0?this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.model.enableRTL?"15px":this.model.enableSplitter?"5px":"0px":this.model.enableRTL?"5px":this.model.enableSplitter?"4px":"7px":this.model.enableRTL?"5px":this.model.enableSplitter?this.model.enableVirtualScrolling?"8px":"5px":"7px",d=0;this.model.enableRTL&&(d="-"+n,n=0),this.defaultView()==t.PivotClient.DefaultView.Chart?(a=t.buildTag("ul.clientTab",t.buildTag("li",s)[0].outerHTML+t.buildTag("li",o)[0].outerHTML,{"margin-left":n,"margin-right":d})[0].outerHTML,r=t.buildTag("div#clientTab",a+l+i)[0].outerHTML):(a=t.buildTag("ul.clientTab",t.buildTag("li",o)[0].outerHTML+t.buildTag("li",s)[0].outerHTML,{"margin-left":n,"margin-right":d})[0].outerHTML,r=t.buildTag("div#clientTab",a+i+l,{height:"100%"})[0].outerHTML),e=r}else e=this._createControlContainer(this.controlPlacement(),l,i);return t.buildTag("div.e-controlPanel",e,{width:this.model.isResponsive?"100%":"tab"==this.model.displaySettings.controlPlacement?"olap"==this.model.analysisMode&&"servermode"==this.model.operationalMode||!this.model.enableSplitter?"":"99%":"auto",top:this.model.displaySettings.mode==t.PivotClient.DisplayMode.GridOnly?"3px":"none","margin-bottom":this.model.displaySettings.controlPlacement==t.PivotClient.ControlPlacement.Tile&&(this.model.enablePaging||this.model.enableVirtualScrolling)?"5px":"0"})[0].outerHTML+(this.model.enablePaging?t.buildTag("div#"+this._id+"_Pager")[0].outerHTML:this.model.enableVirtualScrolling?t.buildTag("div#hsVirtualScrolling.hsVirtualScrolling",t.buildTag("div.e-hScrollPanel")[0].outerHTML,{width:"10px"})[0].outerHTML:"")},_createControlContainer:function(e,i,l){return this.displayMode()==t.PivotClient.DisplayMode.ChartOnly?"<table style='width:100%'><tr><td>"+i+"</td></tr></table>":this.displayMode()==t.PivotClient.DisplayMode.GridOnly?"<table style='width:100%'><tr><td>"+l+"</td></tr></table>":this.controlPlacement()==t.PivotClient.ControlPlacement.Tile?this.defaultView()==t.PivotClient.DefaultView.Chart?"<table style='width:100%'><tr><td>"+i+"</td></tr><tr><td>"+l+"</td></tr></table>":"<table style='width:100%'><tr><td>"+l+"</td></tr><tr><td>"+i+"</td></tr></table>":this.defaultView()==t.PivotClient.DefaultView.Chart?"<table style='width:100%'><tr><td valign='top'>"+i+"</td><td valign='top'>"+l+"</td></tr></table>":"<table style='width:100%'><tr><td valign='top'>"+l+"</td><td valign='top'>"+i+"</td></tr></table>"},_renderPivotGrid:function(l){var a,r,o;if(l=t.isNullOrUndefined(l)?"":l,this.element.find(".e-dialog").hide(),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly)if(this._pivotChart!=i&&this._pivotChart._startDrilldown){try{r=JSON.parse(this._pivotGrid.getOlapReport()).Report}catch(e){r=this._pivotGrid.getOlapReport()}this._pivotGrid.doAjaxPost("POST",this.model.url+"/"+this._pivotGrid.model.serviceMethodSettings.drillDown,JSON.stringify({action:"drillDownGrid",cellPosition:"",currentReport:r,clientReports:this.reports,headerInfo:l,layout:this.gridLayout(),enableRTL:this.model.enableRTL}),this._pivotGrid._drillDownSuccess)}else this.model.enableDeferUpdate?(this._isTimeOut=!1,this._waitingPopup.hide()):(o=this._pivotGrid.model.enableConditionalFormatting?this._pivotGrid.model.conditionalFormatSettings:[],this.element.find(".e-pivotgrid, #"+this._id+"_PivotGrid").remove(),a=this.controlPlacement()==t.PivotClient.ControlPlacement.Tile&&this.displayMode()==t.PivotClient.DisplayMode.ChartAndGrid?t.buildTag("div#"+this._id+"_PivotGrid","",{margin:this.model.enableToolBar?"5px 0px 7px":"5px 7px 7px",width:this.model.isResponsive?"auto":" ",padding:"1px"})[0].outerHTML:t.buildTag("div#"+this._id+"_PivotGrid","",{margin:this.model.enableToolBar?"5px 0px 7px":"5px 7px 7px",padding:"1px"})[0].outerHTML,e(a).appendTo(this.element.find(".e-gridContainer")),this.gridLayout()!=t.PivotGrid.Layout.Normal?this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({url:this.model.url,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,isResponsive:this.model.isResponsive,currentReport:this.currentReport,locale:this.locale(),layout:this.gridLayout(),drillSuccess:t.proxy(this._gridDrillSuccess,this),conditionalFormatSettings:o,enableConditionalFormatting:this._pivotGrid.model.enableConditionalFormatting}):this.element.find("#"+this._id+"_PivotGrid").ejPivotGrid({url:this.model.url,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,enableCellSelection:this.model.enableCellSelection,cellSelection:this.model.cellSelection,hyperlinkSettings:{enableValueCellHyperlink:this.model.enableValueCellHyperlink,enableRowHeaderHyperlink:this.model.enableRowHeaderHyperlink,enableColumnHeaderHyperlink:this.model.enableColumnHeaderHyperlink,enableSummaryCellHyperlink:this.model.enableSummaryCellHyperlink},enableCellContext:this.model.enableCellContext,enableDrillThrough:this.model.enableDrillThrough,enableCellEditing:this.model.enableCellEditing,enableCellDoubleClick:this.model.enableCellDoubleClick,enableCellClick:this.model.enableCellClick,valueCellHyperlinkClick:this.model.valueCellHyperlinkClick,rowHeaderHyperlinkClick:this.model.rowHeaderHyperlinkClick,columnHeaderHyperlinkClick:this.model.columnHeaderHyperlinkClick,summaryCellHyperlinkClick:this.model.summaryCellHyperlinkClick,cellContext:this.model.cellContext,cellEdit:this.model.cellEdit,cellDoubleClick:this.model.cellDoubleClick,enableCellClick:this.model.enableCellClick,drillThrough:this.model.drillThrough,isResponsive:this.model.isResponsive,currentReport:this.currentReport,locale:this.locale(),drillSuccess:t.proxy(this._gridDrillSuccess,this),conditionalFormatSettings:o,enableConditionalFormatting:this._pivotGrid.model.enableConditionalFormatting}),this._pivotGrid=this.element.find("#"+this._id+"_PivotGrid").data("ejPivotGrid"))},_renderPivotChart:function(l,a){var r,o,s;if(this.element.find(".e-dialog").hide(),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly)if(this._pivotGrid!=i&&this._pivotGrid._startDrilldown){try{r=JSON.parse(this._pivotChart.getOlapReport()).Report}catch(e){r=this._pivotChart.getOlapReport()}this._pivotChart.doAjaxPost("POST",this.model.url+"/"+this._pivotChart.model.serviceMethodSettings.drillDown,JSON.stringify({action:this._pivotChart.model.enableMultiLevelLabels?a+"#fullchart":a,drilledSeries:l,olapReport:r,clientReports:this.reports}),this._pivotChart.renderControlSuccess)}else this.model.enableDeferUpdate?(this._isTimeOut=!1,this._waitingPopup.hide()):(o=null,this.element.find(".e-pivotchart").length>0&&(o=this.element.find(".e-pivotchart").data("ejPivotChart").model.renderSuccess),this.element.find(".e-pivotchart").remove(),s=t.buildTag("div#"+this._id+"_PivotChart","",{height:"auto"})[0].outerHTML,0==this.element.find(".e-chartContainer").children().length&&e(s).appendTo(this.element.find(".e-chartContainer")),this.element.find("#"+this._id+"_PivotChart").ejPivotChart({url:this.model.url,customObject:this.model.customObject,enableRTL:this.model.enableRTL,enableDefaultValue:this.model.enableDefaultValue,axesLabelRendering:this.model.axesLabelRendering,pointRegionClick:this.model.pointRegionClick,canResize:this.model.isResponsive,currentReport:this.currentReport,customObject:this.model.customObject,locale:this.locale(),showTooltip:!0,size:{height:this._chartHeight,width:this._chartWidth},commonSeriesOptions:{type:this.model.chartType,tooltip:{visible:!0}},beforeServiceInvoke:this.model.chartLoad,drillSuccess:t.proxy(this._chartDrillSuccess,this),renderSuccess:o}),this._pivotChart=this.element.find("#"+this._id+"_PivotChart").data("ejPivotChart"),this.element.find("#"+this._id+"_PivotChart").width(this._pivotChart.model.size.width),this.model.enableToolBar&&this.element.find("#"+this._id+"_PivotChart").css("border","none"));this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&this._toggleExpand&&!this.model.isResponsive&&"treemap"!=this.chartObj.sfType.split(".").pop().toLowerCase()&&this.element.find(".e-toggleExpandButton").click()},_renderPivotTreeMap:function(l,a){var r,o;this.element.find(".e-dialog").hide(),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this._pivotGrid!=i&&this._pivotGrid._startDrilldown?(r=this.otreemapObj.getOlapReport(),this.otreemapObj.doAjaxPost("POST",this.model.url+"/"+this.otreemapObj.model.serviceMethodSettings.drillDown,JSON.stringify({action:a,drillInfo:l,olapReport:r,clientReports:this.reports}),this.otreemapObj.renderControlSuccess),t.isNullOrUndefined(this.chartObj)||(this.model.displaySettings.enableFullScreen||this.enableTogglePanel()&&"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase())&&(e("#"+this.otreemapObj._id+"TreeMapContainer").css({width:"100%"}),this.otreemapObj._treeMap.refresh())):this.model.enableDeferUpdate?(this._isTimeOut=!1,this._waitingPopup.hide()):(this.element.find(".e-pivottreemap").remove(),o=t.buildTag("div#"+this._id+"_PivotChart","",{height:"auto"})[0].outerHTML,0==this.element.find(".e-chartContainer").children().length&&e(o).appendTo(this.element.find(".e-chartContainer")),this.element.find("#"+this._id+"_PivotChart").ejPivotTreeMap({url:this.model.url,customObject:this.model.customObject,canResize:this.model.isResponsive,currentReport:this.currentReport,customObject:this.model.customObject,locale:this.locale(),size:{height:this._chartHeight,width:this._chartWidth},beforeServiceInvoke:this.model.treeMapLoad,drillSuccess:t.proxy(this._treemapDrillSuccess,this)}),this.otreemapObj=this.element.find("#"+this._id+"_PivotChart").data("ejPivotTreeMap"),this.element.find("#"+this._id+"_PivotChart").width(this.otreemapObj.model.size.width))),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&this._toggleExpand&&!this.model.isResponsive&&"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()&&this.element.find(".e-toggleExpandButton").click()},_renderControls:function(){(this._isNodeOrButtonDropped&&t.isNullOrUndefined(this.chartObj)||this._isrenderTreeMap)&&this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this._isNodeOrButtonDropped=!1,this._isrenderTreeMap=!1,this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),this.displayMode()==t.PivotClient.DisplayMode.GridOnly?this.defaultView()==t.PivotClient.DefaultView.Chart?(this._renderPivotChart(),this._renderPivotGrid()):(this._renderPivotGrid(),this._renderPivotChart()):this.defaultView()==t.PivotClient.DefaultView.Chart?(t.isNullOrUndefined(this.chartObj)?this.element.find("#"+this._pivotChart._id+"Container").length>0?this._renderPivotChart():this.model.enablePivotTreeMap&&this._renderPivotTreeMap():"treemap"!=this.chartObj.sfType.split(".").pop().toLowerCase()?this._renderPivotChart():this.model.enablePivotTreeMap&&this._renderPivotTreeMap(),this._renderPivotGrid()):(this._renderPivotGrid(),t.isNullOrUndefined(this.chartObj)?this.element.find("#"+this._pivotChart._id+"Container").length>0?this._renderPivotChart():this.model.enablePivotTreeMap&&this._renderPivotTreeMap():"treemap"!=this.chartObj.sfType.split(".").pop().toLowerCase()?this._renderPivotChart():this.model.enablePivotTreeMap&&this._renderPivotTreeMap())},_createDialogRequest:function(l){var a,r,o,s,n,d,h,c;if(!(l.target.className.indexOf("e-dialogOKBtn")>=0)){if("button"==l.target.type&&e(l.target).parent().attr("data-tag").indexOf("::CalculatedMember")>-1){if(this._selectedCalcMember=e(l.target).parent().text(),this.element.find(".calcMemberDialog").length>0){if(this._calcMemberTreeObj.collapseAll(),t.Pivot.closePreventPanel(this),this._calcMemberDialog.open(),(a=t.DataManager(this._calcMembers).executeLocal(t.Query().where("name","equal",this._selectedCalcMember))).length>0){if(this.element.find("#"+this._id+"_captionFieldCM").val(a[0].name),this.element.find("#"+this._id+"_expressionFieldCM").val(a[0].expression),this.element.find("#"+this._id+"_memberTypeFieldCM").data("ejDropDownList").selectItemsByIndices(a[0].nodeType),1==a[0].nodeType)for(r=a[0].tag.split(".")[0].replace(/\[/g,"").replace(/\]/g,""),o=this.element.find("#"+this._id+"_dimensionFieldCM").data("ejDropDownList").model.dataSource,h=0;h<o.length;h++)o[h].value==r&&this.element.find("#"+this._id+"_dimensionFieldCM").data("ejDropDownList").selectItemsByIndices(h);t.isNullOrUndefined(a[0].formatString)||("Currency"==a[0].formatString?this.element.find("#"+this._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(1):"Percent"==a[0].formatString?this.element.find("#"+this._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(2):(this.element.find("#"+this._id+"_formatFieldCM").data("ejDropDownList").selectItemsByIndices(2),this.element.find("#"+this._id+"_customFormatFieldCM").val(a[0].formatString)))}}else this._waitingPopup.show(),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"fetchCalcMemberTreeView",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMemberTreeNodes,JSON.stringify({action:"fetchCalcMemberTreeView",dimensionName:"calcMember>#>"+this.model.sortCubeMeasures,olapReport:this.currentReport,customObject:c}),t.proxy(t.Pivot._createCalcMemberDialog,this));return}if(this.model.enableMemberEditorPaging&&(this._memberPageSettings.startPage=0,this._memberPageSettings.currentMemeberPage=1,this._selectedFieldName=e(l.target).parent().attr("data-tag"),this._memberPageSettings.filterReportCollection={}),s=this,this._args_className=l.target.className,this._args_innerHTML=""==l.target.innerHTML?"ToolbarButtons":l.target.innerHTML,this._dialogTitle=this._hierarchyCaption="msie"==t.browserInfo().name&&t.browserInfo().version<=8?e(l.currentTarget)[0].title:""==l.currentTarget.attributes?"":e(l.currentTarget).attr("title")||e(l.currentTarget).attr("aria-label"),this._currentItem=this._hierarchyCaption,this.element.find(".e-dialog:not(.calcMemberDialog, .calcMemberDialog .e-dialog), .e-clientDialog").remove(),"ToolbarButtons"!=this._args_innerHTML&&this._args_innerHTML!=i&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap){if(e(l.target).parent().attr("data-tag").indexOf(":")>=0&&e(l.target).parent().attr("data-tag").split(":")[1].indexOf(".")>=0)if(n=e(l.target).parent().attr("data-tag").split(":")[1].split("."),(d=this.element.find(".e-cubeTreeView li[data-tag^='["+n[0]+"'][data-tag$='"+n[1]+"]']")).length>0){for(h=0;h<d.length;h++)if(2==e(d[h]).attr("data-tag").split("].").length){this._selectedFieldName=e(d[h]).attr("data-tag");break}}else this._selectedFieldName=d.attr("data-tag");else this._selectedFieldName="";s._isTimeOut=!0,setTimeout(function(){s._isTimeOut&&s._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"fetchMemberTreeNodes",element:this.element,customObject:this.model.customObject}),c=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.fetchMemberTreeNodes,JSON.stringify({action:"fetchMemberTreeNodes",dimensionName:e(l.target).parent().attr("data-tag"),olapReport:this.currentReport,customObject:c}),this._editorTreeInfoSuccess)}else this._createDialog(this._args_className,this._args_innerHTML,"")}},_fetchReportListSuccess:function(e){var l="";e[0]!=i?null!=e[2]&&e[2]!=i&&(this.model.customObject=e[2].Value):e.d!=i?null!=e.d[2]&&e.d[2]!=i&&(this.model.customObject=e.d[2].Value):null!=e.customObject&&e.customObject!=i&&(this.model.customObject=e.customObject),null!=this.model.afterServiceInvoke&&this._trigger("afterServiceInvoke",{action:"fetchReportList",element:this.element,customObject:this.model.customObject,reports:e}),this.element.find(".e-dialog:not(.calcMemberDialog, .calcMemberDialog .e-dialog), .e-clientDialog").remove(),e[0]!=i?(l=t.isNullOrUndefined(e[1].Value)?"":e[1].Value,e=t.isNullOrUndefined(e[0].Value)?"":e[0].Value):e.d!=i?(l=t.isNullOrUndefined(e.d[1].Value)?"":e.d[1].Value,e=t.isNullOrUndefined(e.d[0].Value)?"":e.d[0].Value):(l=e.action,e=e.ReportNameList),""==e?(t.Pivot._createErrorDialog(this._getLocalizedLabels("NoReports"),this._getLocalizedLabels("Warning"),this),this._isTimeOut=!1):this._createDialog(l,e,"")},_fetchSortState:function(e){this._isTimeOut=!1,this._waitingPopup.hide(),e[0]!=i?this._createDialog("e-SortFilterDlg",e[0].Value,""):e.d!=i?this._createDialog("e-SortFilterDlg",e.d[0].Value,""):this._createDialog("e-SortFilterDlg",e.FetchSortState,"")},_createDialog:function(l,a,r){var o,s,n,d,h,c,p,u,m,g,f,b,_,v,C,S,O,T,y,x,M,P,w,L,N,D,R,j,I,F,A,E,k=!1;if(t.Pivot.openPreventPanel(this),this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&("e-SortFilterDlg"==l||"mdx"==l)){if(o=this.element.find(".e-splitBtn"),s=jQuery.grep(o,function(t){return"Measures"==e(t).attr("data-tag").split(":")[1]}).length,n=jQuery.grep(o,function(t){return"Measures"!=e(t).attr("data-tag").split(":")[1]&&"Rows"==e(t).attr("data-tag").split(":")[0]}).length,d=jQuery.grep(o,function(t){return"Measures"!=e(t).attr("data-tag").split(":")[1]&&"Columns"==e(t).attr("data-tag").split(":")[0]}).length,"mdx"==l&&0==s&&0==d)return t.Pivot._createErrorDialog(this._getLocalizedLabels("MDXAlertMsg"),this._getLocalizedLabels("Warning"),this),!1;if(s>0&&0!=this.element.find(".e-categoricalAxis ")[0].childElementCount){if(!n&&document.activeElement.className.indexOf("e-rowSortFilterImg")>-1)return t.Pivot._createErrorDialog(this._getLocalizedLabels("FilterSortRowAlertMsg"),this._getLocalizedLabels("Warning"),this),!1;if(!d&&document.activeElement.className.indexOf("e-colSortFilterImg")>-1)return t.Pivot._createErrorDialog(this._getLocalizedLabels("FilterSortColumnAlertMsg"),this._getLocalizedLabels("Warning"),this),!1}else if("mdx"!=l)return s||"Column"!=this._axis?s||"Row"!=this._axis?e(".e-categoricalAxis ")[0].childElementCount||t.Pivot._createErrorDialog(this._getLocalizedLabels("FilterSortElementAlertMsg"),this._getLocalizedLabels("Warning"),this):t.Pivot._createErrorDialog(this._getLocalizedLabels("FilterSortrowMeasureAlertMsg"),this._getLocalizedLabels("Warning"),this):t.Pivot._createErrorDialog(this._getLocalizedLabels("FilterSortcolMeasureAlertMsg"),this._getLocalizedLabels("Warning"),this),!1}this.model.analysisMode!=t.Pivot.AnalysisMode.Olap||t.isNullOrUndefined(this._selectedFieldName)||(k=this.element.find(".e-pvtBtn").parent("[data-tag='Slicers:"+this._selectedFieldName.replace(/\[/g,"").replace(/\]/g,"")+"']").length>0);var H,V="",z="",U="",B=[];if(H=r[0]!=i?r[0].Value:r.d!=i?r.d[0].Value:r.EditorTreeInfo,h=t.buildTag("div#"+(this.model.enableAdvancedFilter?"clientDialog":this._id+"_ClientDialog")+".e-clientDialog",{opacity:"1"})[0].outerHTML,b="","e-newReportImg"==l.split(" ")[0])p=this._getLocalizedLabels("NewReport"),u="New Report",_="<p class='e-dialogPara'>"+this._getLocalizedLabels("ReportName")+"</p>",v="<input type=text id=reportName class='reportName'/></br>",c=t.buildTag("div#"+this._id+"_ReportDlg.e-reportDlg","<table><tr><td>"+_+"</td><td>"+v+"</td></tr></table>")[0].outerHTML;else if("e-addReportImg"==l.split(" ")[0])p=this._getLocalizedLabels("AddReport"),u="Add Report",C="<p class='e-dialogPara'>"+this._getLocalizedLabels("ReportName")+"</p>",S="<input type=text id=reportName class='reportName'/></br>",c=t.buildTag("div#"+this._id+"_ReportDlg.e-reportDlg","<table><tr><td>"+C+"</td><td>"+S+"</td></tr></table>")[0].outerHTML;else if("e-removeReportImg"==l.split(" ")[0])p=this._getLocalizedLabels("RemoveReport"),u="Remove Report",(this.model.operationalMode==t.Pivot.OperationalMode.ClientMode||this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)&&(this.reportsCount=this._clientReportCollection.length),c=this.reportsCount>1?"<p>"+this._getLocalizedLabels("AreYouSureToDeleteTheReport")+"?</p>":"<p>"+this._getLocalizedLabels("CannotRemoveSingleReport")+"!</p>";else if("e-SortFilterDlg"==l.split(" ")[0]){""!=(V=a.split("||"))[1]&&(z=V[1].split("<<")),""!=V[2]&&(U=V[2].split("<<")),this.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog), .e-clientDialog").remove(),p=this._getLocalizedLabels("SortingAndFiltering");var G=t.buildTag("label#sortingLbl.e-sortingLbl",this._getLocalizedLabels("Sorting"))[0].outerHTML,J=t.buildTag("label#measureListLbl.e-measureListLbl",this._getLocalizedLabels("Measure"))[0].outerHTML,q=t.buildTag("label#orderLbl.e-orderLbl",this._getLocalizedLabels("Order"))[0].outerHTML,K=t.buildTag("input#measuresList.e-measuresList","",{},{type:"text",accesskey:"M"})[0].outerHTML,W=t.buildTag("input#sortDisable.e-sortDisable","",{},{name:"sort",type:"radio",checked:"checked",tabindex:0,accesskey:"i"})[0].outerHTML+t.buildTag("label.e-sortDisableLbl",this._getLocalizedLabels("Disable"))[0].outerHTML,Q=t.buildTag("input#sortEnable.e-sortEnable","",{},{name:"sort",type:"radio",tabindex:1,accesskey:"n"})[0].outerHTML+t.buildTag("label.e-sortEnableLbl",this._getLocalizedLabels("Enable"))[0].outerHTML+"<br/>",X=t.buildTag("input#radioBtnAsc.e-radioBtnAsc","",{},{name:"order",type:"radio",checked:"checked",tabindex:0,accesskey:"A"})[0].outerHTML+t.buildTag("label.e-radioBtnAscLbl",this._getLocalizedLabels("Ascending"))[0].outerHTML+"<br/>",Y=t.buildTag("input#radioBtnDesc.e-radioBtnDesc","",{},{name:"order",type:"radio",tabindex:2,accesskey:"e"})[0].outerHTML+t.buildTag("label.e-radioBtnDescLbl",this._getLocalizedLabels("Descending"))[0].outerHTML,$=t.buildTag("input#preserveHrchy.e-preserveHrchy","",{},{type:"checkbox",checked:"checked",tabindex:0,accesskey:"r"})[0].outerHTML+t.buildTag("label.e-preserveHrchyLbl",this._getLocalizedLabels("PreserveHierarchy"))[0].outerHTML,Z=t.buildTag("label#filterLbl.e-filterLbl",this._getLocalizedLabels("Filtering"))[0].outerHTML,ee=t.buildTag("input#filterDisable.e-filterDisable","",{},{name:"filter",type:"radio",checked:"checked",tabindex:0,accesskey:"i"})[0].outerHTML+t.buildTag("label.e-filterDisableLbl",this._getLocalizedLabels("Disable"))[0].outerHTML,te=t.buildTag("input#filterEnable.e-filterEnable","",{},{name:"filter",type:"radio",tabindex:0,accesskey:"n"})[0].outerHTML+t.buildTag("label.e-filterDisableLbl",this._getLocalizedLabels("Enable"))[0].outerHTML+"<br/>",ie=t.buildTag("label#conditionLbl.e-conditionLbl",this._getLocalizedLabels("Condition"))[0].outerHTML,le=t.buildTag("input#filterCondition.e-filterCondition","",{},{type:"text",tabindex:0,accesskey:"o"})[0].outerHTML,ae=t.buildTag("div#filterfrom.e-filterFrmDiv",t.buildTag("input#filterFrom.filterFrom"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:0})[0].outerHTML)[0].outerHTML,re=t.buildTag("div#filterbtw.e-filterBtw","<p>"+this._getLocalizedLabels("and")+"</p>")[0].outerHTML,oe=t.buildTag("div#filterto.e-filterToDiv",t.buildTag("input#filterTo.filterTo"+(t.isMobile()?" inputConditionMbl":""),"",{},{name:"inputVal",type:t.isMobile()?"number":"text",inputmode:t.isMobile()?"numeric":"",pattern:t.isMobile()?"[0-9]*":"",tabindex:0,accesskey:"d"})[0].outerHTML)[0].outerHTML,se=t.buildTag("label#filterMeasureListLbl.filterMeasureListLbl",this._getLocalizedLabels("Measure"))[0].outerHTML,ne=t.buildTag("input#fMeasuresList.fMeasuresList","",{},{type:"text",tabindex:0,accesskey:"M"})[0].outerHTML,de=t.buildTag("label#filterValueLbl.e-filterValueLbl",this._getLocalizedLabels("Value"),{},{tabindex:0,accesskey:"a"})[0].outerHTML,he=t.buildTag("div#sortingDlg.e-sortingDlg","<table class='e-sortReportTbl'><tr><td style='vertical-align:top;'>"+G+"</td><td>"+Q+W+"</td></tr><tr><td>"+J+"</td><td>"+K+"</td></tr> <tr><td>"+q+"</td><td>"+X+Y+"</td></tr><tr><td></td><td>"+$+"</td></tr></table>")[0].outerHTML,ce=t.buildTag("div#filteringDlg.e-filteringDlg","<table class='e-sortReportTbl'><tr><td>"+Z+"</td><td>"+te+ee+"</td></tr><tr><td>"+se+"</td><td>"+ne+"</td></tr><tr><td>"+ie+"</td><td>"+le+"</td></tr><tr><td>"+de+"</td><td>"+ae+re+oe+"</td></tr></table>")[0].outerHTML,pe="<li><a style='font: bold 12px Segoe UI' href='#sortingDlg'>"+this._getLocalizedLabels("Sorting")+"</a></li>",ue="<li><a style='font: bold 12px Segoe UI' href='#filteringDlg'>"+this._getLocalizedLabels("Filtering")+"</a></li>";c=t.buildTag("div#sortfilterTab.sortfilterTab","<ul class ='e-sortfiltTab'>"+(pe+ue)+"</ul>"+he+ce)[0].outerHTML}else if("e-renameReportImg"==l.split(" ")[0]){p=this._getLocalizedLabels("RenameReport"),u="Rename Report";var me=t.isNullOrUndefined(this._currentReportName)?this.element.find(".reportlist").val():this._currentReportName,ge="<p class='e-dialogPara'>"+this._getLocalizedLabels("ReportName")+"</p>",fe="<input type=text id=reportName class='reportName' value='"+me+"' /></br>";c=t.buildTag("div#"+this._id+"_ReportDlg.e-reportDlg","<table><tr><td>"+ge+"</td><td>"+fe+"</td></tr></table>")[0].outerHTML}else if("e-saveAsReportImg"==l.split(" ")[0]||"e-saveReportImg"==l.split(" ")[0])p="e-saveAsReportImg"==l.split(" ")[0]?this._getLocalizedLabels("SaveAs"):this._getLocalizedLabels("Save"),u="SaveAs Report",be="<p class='e-dialogPara'>"+this._getLocalizedLabels("ReportName")+"</p>",O="<input type=text id=reportName class='reportName'/></br>",c=t.buildTag("div#"+this._id+"_ReportDlg.e-reportDlg","<table><tr><td>"+be+"</td><td>"+O+"</td></tr></table>")[0].outerHTML;else if("LoadReport"==l.split(" ")[0])p=this._getLocalizedLabels("Load"),u="Load Report",c=(be="<table class='e-loadReportTbl'><tr><td class='e-loadReportTd'>"+this._getLocalizedLabels("ReportName")+"</td>")+"<td><input type='text' id='reportNameList' class='reportNameList'/></td></tr></table>";else if("RemoveDBReport"==l.split(" ")[0])p=this._getLocalizedLabels("Remove"),u="RemoveDB Report",c=(be="<table class='e-removeDBReportTbl'><tr><td class='e-removeDBReportTd'>"+this._getLocalizedLabels("ReportName")+"</td>")+"<td><input type='text' id='reportNameList' class='reportNameList'/></td></tr></table>";else if("RenameDBReport"==l.split(" ")[0]){var be;p=this._getLocalizedLabels("Rename"),u="RenameDB Report",c=(be="<table class='e-renameDBReportTbl'><tr><td class='e-renameDBReportTd'>"+this._getLocalizedLabels("SelectReport")+"</td>")+"<td><input type='text' id='reportNameList' class='reportNameList'/></td></tr>"+("<tr><td class='e-renameDBReportTd'>"+this._getLocalizedLabels("RenameReport")+"</td>")+"<td><input type='text' id='renameReport' class='renameReport' style='width:146px'/></td></tr></table>"}else if("mdx"==l.split(" ")[0])p=this._getLocalizedLabels("MDXQuery"),u="MDX Query",c="<textarea readonly='readonly' style='width:460px; height:180px; resize:none; margin:3px'>"+a+"</textarea>";else if("e-chartTypesImg"==l.split(" ")[0])p=this._getLocalizedLabels("ChartTypes"),u="Chart Types",c="<p class='e-dialogPara'>"+this._getLocalizedLabels("ChartTypes")+"</p>"+(Oe="<input type=text id=reportName class='reportName'/></br>");else if(l.indexOf("e-txt")>-1){a==this._getLocalizedLabels("Measures")?(p=this._getLocalizedLabels("MeasureEditor"),c="<p class='e-editorPara'>"+this._getLocalizedLabels("Measures")+"</p>"):(this._isOptionSearch=!1,this._isEditorDrillPaging=!1,this._currentFilterList={},this._editorSearchTreeData=[],this._editorDrillTreeData={},this._editorDrillTreePageSettings={},this._lastSavedTree=[],p=this._getLocalizedLabels("MemberEditor"),c=this._hierarchyCaption!=this._getLocalizedLabels("KPIs")&&this.model.enableAdvancedFilter&&!k?"":"<p class='e-editorPara'>"+this._hierarchyCaption+"</p>"),T="",x="",e(L).appendTo(N),a!=this._getLocalizedLabels("Measures")&&(M=t.buildTag("div.e-checkAll e-icon").attr("role","button").attr("aria-label","checkall")[0].outerHTML,P=t.buildTag("div.e-unCheckAll e-icon").attr("role","button").attr("aria-label","uncheckall")[0].outerHTML,x=t.buildTag("div.e-checkOptions",M+P,{height:"19px",margin:"10px 0px 0px 31px"})[0].outerHTML,T=t.buildTag("div.e-memberSearchEditorDiv",t.buildTag("input#searchEditorTreeView.searchEditorTreeView").attr("type","text")[0].outerHTML+(!t.isNullOrUndefined(H)&&a!=this._getLocalizedLabels("Measures")&&this.model.enableMemberEditorPaging&&e.parseJSON(H).length>=this.model.memberEditorPageSize?t.buildTag("span.e-icon e-searchEditorTree",{})[0].outerHTML:""),{padding:this.model.enableAdvancedFilter?"5px 0px 0px 0px":0})[0].outerHTML),a==this._getLocalizedLabels("Measures")?(this._isMembersFiltered=!1,y=this._createMeasureEditor(r)):y=t.buildTag("div#editorTreeView.e-editorTreeView")[0].outerHTML;var _e=t.buildTag("div.e-memberEditorDiv",(""!=this._selectedFieldName||a==this._getLocalizedLabels("KPIs")?x:"")+y)[0].outerHTML,ve="",Ce="";""!=this._selectedFieldName&&!k&&this.model.enableAdvancedFilter?(Ce=t.buildTag("div.e-ddlGroupWrap",this._getLocalizedLabels("SelectField")+":"+t.buildTag("input#GroupLabelDrop.groupLabelDrop").attr("type","text")[0].outerHTML,{})[0].outerHTML,ve=t.buildTag("div.e-filterElementTag")[0].outerHTML,w=t.Pivot.createAdvanceFilterTag({action:"filterTag"},this),B=e.map(this.element.find(".e-treeview li[data-tag='"+this._selectedFieldName+"'] li"),function(t){return{text:e(t).text(),value:e(t).attr("data-tag")}})):delete this._selectedLevelUniqueName,L=t.buildTag("div",(""!=ve&&!k&&this.model.enableAdvancedFilter?Ce+t.buildTag("div.e-seperator",{},{padding:"2px"},j)[0].outerHTML+ve+t.buildTag("div.e-seperator",{},{padding:"2px"})[0].outerHTML:"")+T+_e)[0].outerHTML,c+=N=t.buildTag("div#EditorDiv.e-editorDiv",L,{"margin-left":this.model.enableAdvancedFilter?"5px":"0px"})[0].outerHTML,m=t.buildTag("div.e-memberPager",t.buildTag("div#NextpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentPage#memberCurrentPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberPageCount#memberPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{})[0].outerHTML,g=t.buildTag("div.e-memberSearchPager",t.buildTag("div#NextSearchpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentSearchPage#memberCurrentSearchPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberSearchPageCount#memberSearchPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML,f=t.buildTag("div.e-memberDrillPager",t.buildTag("div#NextDrillpageDiv.e-nextPageDiv",t.buildTag("div.e-icon e-media-backward_01 e-firstPage",{})[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-left e-prevPage",{})[0].outerHTML+t.buildTag("input.e-memberCurrentDrillPage#memberCurrentDrillPage",{},{width:"20px",height:"10px"})[0].outerHTML+t.buildTag("span.e-memberDrillPageCount#memberDrillPageCount")[0].outerHTML+t.buildTag("div.e-icon e-arrowhead-right e-nextPage",{})[0].outerHTML+t.buildTag("div.e-icon e-media-forward_01 e-lastPage",{})[0].outerHTML)[0].outerHTML,{}).css("display","none")[0].outerHTML,b=t.buildTag("div.e-linkOuterPanel",t.buildTag("span.e-infoImg e-icon","",{}).css({float:"left","margin-top":"4px","font-size":"16px"})[0].outerHTML+t.buildTag("a.e-linkPanel",this._getLocalizedLabels("NotAllItemsShowing")).css({display:"inline-block","margin-left":"3px","margin-top":"4px"})[0].outerHTML,{}).css({display:"none","margin-left":"3px","margin-left":I?"6px":"0px"})[0].outerHTML}if("mdx"==l.split(" ")[0]?(j="<button id=CancelBtn class='e-dialogCancelBtn' title="+this._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,"")+" >"+this._getLocalizedLabels("OK")+"</button>",D=t.buildTag("div.e-dialogFooter",j)[0].outerHTML,e(h).appendTo("#"+this._id),e(c+D).appendTo(this.element.find(".e-clientDialog")),this.element.find(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:500,target:"#"+this._id,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)})):(R="<button id=OKBtn class='e-dialogOKBtn' title="+("RemoveDBReport"==l.split(" ")[0]?this._getLocalizedLabels("Remove"):this._getLocalizedLabels("OK").replace(/(<([^>]+)>)/gi,""))+">"+("RemoveDBReport"==l.split(" ")[0]?this._getLocalizedLabels("Remove"):this._getLocalizedLabels("OK"))+"</button>",j="<button id=CancelBtn class='e-dialogCancelBtn' title="+this._getLocalizedLabels("Cancel").replace(/(<([^>]+)>)/gi,"")+">"+this._getLocalizedLabels("Cancel")+"</button>",D=t.buildTag("div.e-dialogFooter",R+("e-removeReportImg"==l.split(" ")[0]&&1==this.reportsCount?"":j))[0].outerHTML,e(h).appendTo("#"+this._id),e(c+(!t.isNullOrUndefined(H)&&a!=this._getLocalizedLabels("Measures")&&this.model.enableMemberEditorPaging?e.parseJSON(H).length>=this.model.memberEditorPageSize?f+g+m:f+g:b)+D).appendTo(this.element.find(".e-clientDialog")),"e-SortFilterDlg"==l.split(" ")[0]?this.element.find(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:"auto",target:"#"+this._id,cssClass:"e-SortFilterDlg",enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)}):this.element.find(".e-clientDialog").ejDialog({enableRTL:this.model.enableRTL,width:"auto",target:"#"+this._id,enableResize:!1,close:t.proxy(t.Pivot.closePreventPanel,this)}),"e-removeReportImg"==l.split(" ")[0]&&(this.element.find(".e-clientDialog").css("min-height","60px"),this.element.find("#"+this._id+"_ClientDialog_wrapper").css("min-height","100px"))),this.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").prepend(t.buildTag("div",p,{display:"inline"})[0].outerHTML)[0].setAttribute("data-tag",u),this.element.find(".reportName, .renameReport").ejMaskEdit({width:"149px",textAlign:this.model.enableRTL?"right":"left"}),this.element.find(".e-reportDlg .e-mask").css("padding-left","6px"),this.element.find(".e-memberSearchEditorDiv .e-mask").addClass("e-dialogInput"),this.element.find(".e-prevPage, .e-firstPage").addClass("e-pageDisabled"),this.element.find(".e-nextPage, .e-lastPage").addClass("e-pageEnabled"),this.element.find(".e-dialogOKBtn, .e-dialogCancelBtn").ejButton({type:t.ButtonType.Button}),e(".sortfilterTab").ejTab({enableRTL:this.model.enableRTL}),e(".reportNameList").ejDropDownList({dataSource:a.split("__"),enableRTL:this.model.enableRTL,width:"150px",height:"20px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),l.indexOf("e-txt")>-1&&this.element.find("#searchEditorTreeView").ejMaskEdit({name:"inputbox",width:"100%",inputMode:t.InputMode.Text,watermarkText:this._getLocalizedLabels("Search")+" "+this._hierarchyCaption,maskFormat:"",textAlign:this.model.enableRTL?"right":"left",change:t.proxy(function(e){t.Pivot._searchEditorTreeNodes(e,this)},this)}),this.element.find(".e-filterElementTag").ejMenu({fields:{dataSource:w,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"},menuType:t.MenuType.NormalMenu,width:"100%",height:"25px",enableRTL:this.model.enableRTL,orientation:t.Orientation.Vertical,click:t.proxy(this._filterElementClick,this)}),this.element.find(".groupLabelDrop").ejDropDownList({width:"100%",height:"25px",enableRTL:this.model.enableRTL,dataSource:B,fields:{id:"id",text:"text",value:"value"},selectedIndices:[0],change:t.proxy(this._groupLabelChange,this),create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e(".filterFrom,.filterTo").ejMaskEdit({width:"80px",height:"20px",textAlign:this.model.enableRTL?"right":"left"}),e(".e-measuresList").ejDropDownList({dataSource:a.split("||")[0].split("__"),enableRTL:this.model.enableRTL,width:"80%",height:"20px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e(".fMeasuresList").ejDropDownList({dataSource:a.split("||")[0].split("__"),width:"80%",enableRTL:this.model.enableRTL,height:"20px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),e(".e-filterCondition").ejDropDownList({change:"_onActiveConditionChange",enableRTL:this.model.enableRTL,dataSource:[{option:"EqualTo",value:this._getLocalizedLabels("EqualTo")},{option:"NotEquals",value:this._getLocalizedLabels("NotEquals")},{option:"GreaterThan",value:this._getLocalizedLabels("GreaterThan")},{option:"GreaterThanOrEqualTo",value:this._getLocalizedLabels("GreaterThanOrEqualTo")},{option:"LessThan",value:this._getLocalizedLabels("LessThan")},{option:"LessThanOrEqualTo",value:this._getLocalizedLabels("LessThanOrEqualTo")},{option:"Between",value:this._getLocalizedLabels("Between")},{option:"NotBetween",value:this._getLocalizedLabels("NotBetween")}],fields:{text:"value",value:"option"},width:"80%",height:"20px",create:function(){e(this.wrapper.find(".e-input")).focus(function(){e(this).blur()})}}),this.element.find(".e-filterCondition").ejDropDownList("option","change",t.proxy(this._onActiveConditionChange,this)),this._dllSortMeasure=e(".e-measuresList").data("ejDropDownList"),this._dllFilterCondition=e(".e-filterCondition").data("ejDropDownList"),this._dllfMeasuresList=e(".fMeasuresList").data("ejDropDownList"),""!=z&&(this.element.find(".e-radioBtnAsc")[0].checked="ASC"==z[0],this.element.find(".e-radioBtnDesc")[0].checked="DESC"==z[0],this.element.find(".e-sortDisable")[0].checked=!(this.element.find(".e-sortEnable")[0].checked=!0),this.element.find(".e-preserveHrchy")[0].checked="PH"==z[1],this._isSorted=!0,this._dllSortMeasure.setModel({value:z[2]})),""!=U&&(this.element.find(".e-filterEnable")[0].checked=!0,this._dllfMeasuresList.setModel({value:U[0]}),this._dllFilterCondition.setModel({value:U[1]}),this.element.find(".filterFrom").val(U[2]),U[3]==i||""==U[3]||"Between"!=U[1]&&"NotBetween"!=U[1]?e(".filterTo").attr("disabled","disabled"):this.element.find(".filterTo").val(U[3]),this._isFiltered=!0),this.element.find(".e-sortDisable")[0]!=i&&1==this.element.find(".e-sortDisable")[0].checked&&(e(".measuresList_wrapper,.e-radioBtnAsc, .e-radioBtnDesc, .e-preserveHrchy").attr("disabled","disabled"),e(".e-measureListLbl, .e-orderLbl, .e-radioBtnAscLbl, .e-radioBtnDescLbl, .e-preserveHrchyLbl").addClass("e-sortFilterDisable"),this._dllSortMeasure.disable()),this.element.find(".e-filterDisable")[0]!=i&&1==this.element.find(".e-filterDisable")[0].checked&&(e(".filterFrom, .filterTo").attr("disabled","disabled"),e(".filterMeasureListLbl, .e-conditionLbl, .e-filterValueLbl, .e-filterBtw").addClass("e-sortFilterDisable"),this._dllFilterCondition.disable(),this._dllfMeasuresList.disable()),this.element.find(".e-widget-content").height("auto"),I=!1,this._excelFilterInfo.length>0){var Se=this.element.find(".cubeSelector").length>0?this.element.find(".cubeSelector").data("ejDropDownList").model.value:"",Oe=this.element.find("#reportList").data("ejDropDownList").model.value,Te=this._selectedLevelUniqueName,ye=this._selectedFieldName;this.model.analysisMode==t.Pivot.AnalysisMode.Olap?e.map(this._excelFilterInfo,function(e){e.cubeName==Se&&e.report==Oe&&(e.hierarchyUniqueName==ye||e.levelUniqueName==Te)&&(I=!0)}):e.map(this._excelFilterInfo,function(e){e.report==Oe&&(e.hierarchyUniqueName==ye||e.levelUniqueName==Te)&&(I=!0)})}if(""!=r&&r!=i&&a!=this._getLocalizedLabels("Measures")){if(F=null,!I&&0!=this._currentReportItems.length)for(A=0;A<this._currentReportItems.length;A++)if(this._currentReportItems[A]==this._currentItem){F=JSON.parse(JSON.stringify(this._treeViewData[this._currentItem]));break}null!=F&&I||(F=e.parseJSON(H)),this._editorTreeData=e.parseJSON(H),this.model.enableMemberEditorPaging&&a!=this._getLocalizedLabels("Measures")&&this.element.find(".e-nextPageDiv").length>0&&((E=this._editorTreeData.length/this.model.memberEditorPageSize)!=Math.round(E)&&(E=parseInt(E)+1),this._memberPageSettings.currentMemeberPage==E&&this.element.find(".e-nextPage, .e-lastPage").addClass("disabled"),this.element.find(".e-memberPageCount").html("/ "+E),this.element.find(".e-memberCurrentPage").val(this._memberPageSettings.currentMemeberPage),this._memberPageSettings.currentMemeberPage>1?this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageDisabled").addClass("e-pageEnabled"):this.element.find(".e-prevPage, .e-firstPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"),this._memberPageSettings.currentMemeberPage==parseInt(e.trim(this.element.find(".e-memberPageCount").text().split("/")[1]))?this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageEnabled").addClass("e-pageDisabled"):this.element.find(".e-nextPage, .e-lastPage").removeClass("e-pageDisabled").addClass("e-pageEnabled")),this._appendTreeViewData(this.model.enableMemberEditorPaging&&this.element.find(".e-nextPageDiv").length>0?t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",i).page(this._memberPageSettings.currentMemeberPage,this.model.memberEditorPageSize)):F,k),this.model.enableAdvancedFilter||this.element.find(".e-memberEditorDiv").css({height:"286px"}),this.model.enableAdvancedFilter&&(this.element.find("#clientDialog_wrapper").addClass("e-advancedFilterDlg"),this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.element.find("#clientDialog_wrapper").addClass("e-advanceFltrElement"))}this.model.enableMemberEditorSorting&&(this._sortType="",t.Pivot._separateAllMember(this)),this._dialogOKBtnObj=this.element.find(".e-dialogOKBtn").data("ejButton"),this.element.find("#"+this._id+"_ClientDialog_closebutton").attr("title",this._getLocalizedLabels("Close")),this._unWireEvents(),this._wireEvents(),this._isTimeOut=!1,this._waitingPopup.hide()},_appendTreeViewData:function(i,l){var a,r,o;if(!this._isSearchApplied&&0==this._editorSearchTreeData.length&&i.length>0&&(this._lastSavedTree=i),this.element.find(".e-editorTreeView").ejTreeView({showCheckbox:!0,loadOnDemand:!0,enableRTL:this.model.enableRTL,height:this.model.enableMemberEditorSorting?"235px":"initial",nodeUncheck:function(i){var l,a,r,o;t.isNullOrUndefined(i.event)||""==i.event||(l=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),a=e(i.currentElement).parents(".e-treeview"),l._isMembersFiltered=!0,"SearchFilterSelection"==e(i.currentElement).attr("id")&&(r=e(a).find("li:not([data-isItemSearch='true'])"),l._isSelectSearchFilter=!1,l._isOptionSearch?r.length>0&&e(r).each(function(t,i){"SearchFilterSelection"!=e(i).attr("id")&&e(a).ejTreeView("uncheckNode",e(i))}):r.length>0&&e(l._editorTreeData).each(function(t,i){for(var l=0;l<r.length;l++){if(r[l].id==i.id){i.checkedStatus=e(r[l]).find(".checked").length>0;break}i.checkedStatus=!1}})),0!=e(a).find(".e-checkbox:checked").length||l.model.enableMemberEditorPaging||l.element.find(".e-dialogOKBtn").data("ejButton").disable(),l.model.operationalMode!=t.Pivot.OperationalMode.ClientMode&&(t.Pivot._memberPageNodeUncheck(i,l),o=!0,e(l._editorTreeData).each(function(e,t){if(t.checkedStatus)return o=!1,!1}),o&&l._editorTreeData.length>0?(l.element.find(".e-dialogOKBtn").data("ejButton").disable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")):(l.element.find(".e-dialogOKBtn").data("ejButton").enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled"))))},nodeCheck:function(i){var l,a,r,o,s,n,d;if(!t.isNullOrUndefined(i.event)&&""!=i.event){if(l=e(this.element).parents(".e-pivotclient").data("ejPivotClient"),a=e(i.currentElement).parents(".e-treeview"),l._isMembersFiltered=!0,l.element.find(".e-editorPara").text()==l._getLocalizedLabels("KPIs")){for(r=!0,o=l.element.find(".e-editorTreeView ul:eq(0)"),s=0;s<o.children("li").length;s++)if("false"==o.children("li:eq("+s+")").find(".e-check-small").attr("aria-checked")){r=!1;break}r?(l.element.find(".e-dialogOKBtn").data("ejButton").enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")):(l.element.find(".e-dialogOKBtn").data("ejButton").disable(),l.element.find(".e-dialogOKBtn").attr("disabled","disabled"))}"SearchFilterSelection"==e(i.currentElement).attr("id")&&(l._isSelectSearchFilter=!0,n=e(a).find("li:not([data-isItemSearch='true'])"),l._isOptionSearch?n.length>0&&e(n).each(function(i,r){"SearchFilterSelection"!=e(r).attr("id")&&!t.isNullOrUndefined(l._currentFilterList[e(r).attr("id")])&&l._currentFilterList[e(r).attr("id")].checkedStatus&&e(a).ejTreeView("checkNode",e(r))}):n.length>0&&e(l._editorTreeData).each(function(i,a){for(var r=0;r<n.length;r++){if(n[r].id==a.id){a.checkedStatus=e(n[r]).find(".checked").length>0;break}t.isNullOrUndefined(l._currentFilterList)||(a.checkedStatus=l._currentFilterList[e(a).attr("id")].checkedStatus)}})),l.model.enableMemberEditorPaging&&l._editorTreeData.length>0?e(l._editorTreeData).each(function(e,t){if(t.checkedStatus)return l.element.find(".e-dialogOKBtn").data("ejButton").enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled"),!1}):(l.element.find(".e-dialogOKBtn").data("ejButton").enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")),l.model.operationalMode!=t.Pivot.OperationalMode.ClientMode&&(t.Pivot._memberPageNodeCheck(i,l),d=!0,e(l._editorTreeData).each(function(e,t){if(t.checkedStatus)return d=!1,!1}),d&&l._editorTreeData.length>0?(l.element.find(".e-dialogOKBtn").data("ejButton").disable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")):(l.element.find(".e-dialogOKBtn").data("ejButton").enable(),l.element.find(".e-dialogOKBtn").removeAttr("disabled")))}},beforeDelete:function(e){if(!t.isNullOrUndefined(e.event)&&"keydown"==e.event.type&&"delete"==e.event.originalEvent.key.toLowerCase())return!1},cssClass:"pivotTreeViewDragedNode",height:e(".e-memberEditorDiv").height(),fields:{id:"id",hasChild:"hasChildren",parentId:"pid",text:"name",isChecked:"checkedStatus",expanded:"expanded",dataSource:t.Pivot._showEditorLinkPanel(i,this,this)},beforeExpand:t.proxy(this._onNodeExpand,this),beforeCollapse:t.proxy(t.Pivot._onNodeCollapse,this)}),a=this,this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)?this._currentFilterList=JSON.parse(JSON.stringify(this._editorTreeData)):!this.model.enableMemberEditorPaging&&jQuery.isEmptyObject(this._currentFilterList)&&e(i).each(function(e,t){a._currentFilterList[t.id]=t}),r=this.element.find(".e-editorTreeView").find("li"),this._isSearchApplied)for(o=0;o<r.length;o++)t.isNullOrUndefined(e(r[o]).attr("id"))||e(r[o]).attr("data-tag",t.DataManager(i).executeLocal(t.Query().where("id","equal",e(r[o]).attr("id")))[0].tag);else for(o=0;o<r.length;o++)e(r[o]).attr("data-tag",i[o].tag);this._memberTreeObj=this.element.find(".e-editorTreeView").data("ejTreeView"),e.grep(i,function(e){if(1==e.hasChildren)return e}).length>0||this.element.find(".e-memberEditorDiv").addClass("noChildNode"),this.model.enableMemberEditorSorting?this.element.find(".e-editorTreeView").height(235):this.element.find(".e-editorTreeView").height(256),this.element.find(".e-editorPara").text()!=this._getLocalizedLabels("KPIs")&&!l&&this.model.enableAdvancedFilter&&!t.isNullOrUndefined(this._memberTreeObj)&&this.element.find(".groupLabelDrop").length>0?(t.isNullOrUndefined(this.element.find(".e-treeview li[data-tag='"+this._selectedLevelUniqueName+"']").attr("labelFiltering"))||this._memberTreeObj.element.find("."+this.element.find(".e-treeview li[data-tag='"+this._selectedLevelUniqueName+"']").attr("labelFiltering").split("--")[1].replace(" ","")+" a").append(t.buildTag("div.e-activeFilter").addClass("e-icon")[0].outerHTML),this.element.find(".e-dialog:not(.e-calcMemberDialog, .e-calcMemberDialog .e-dialog) .e-titlebar").hide(),this._groupLabelChange({selectedValue:this.element.find(".groupLabelDrop").data("ejDropDownList").model.value||this.element.find(".groupLabelDrop").data("ejDropDownList").model.dataSource[0].value}),this.element.find(".e-memberEditorDiv").height(286),this.model.enableMemberEditorSorting?this.element.find(".e-editorTreeView").height(235):this.element.find(".e-editorTreeView").height(256)):this.element.find(".e-memberEditorDiv").height(286)},_createMeasureEditor:function(t){var l,a,r;for(l=t[0]!=i?e.parseJSON(t[0].Value):t.d!=i?e.parseJSON(t.d[0].Value):e.parseJSON(t.EditorTreeInfo),a="",r=0;r<l.length;r++)a+='<div id="'+l[r].uniqueName+'"class=e-measureEditor>'+l[r].name+"<span class='e-removeMeasure e-icon' role='button' aria-label='remove'></span></div>";return a},_onNodeExpand:function(l){var a,r,o,s,n,d=l.targetElement;for(this.model.enableMemberEditorPaging||(this._isSearchApplied=!1),a=t.buildTag("span.nodeExpand e-load e-icon")[0].outerHTML,e(d).parents("li").first().children().find("li").length,jQuery.each(this._editorTreeData,function(e,t){if(t.id==l.id)return t.expanded=!0,t.isChildMerged=!0,!1}),s=0;s<this._memberTreeObj.dataSource().length;s++)if(this._memberTreeObj.dataSource()[s].parentId==l.id||this._memberTreeObj.dataSource()[s].pid==l.id)return l.isChildLoaded=!0,void t.Pivot.closePreventPanel(this);if(!t.isNullOrUndefined(this)&&t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l.id)).length>0)return l.isChildLoaded=!0,t.Pivot.closePreventPanel(this),this.pNode=d,void this._fetchChildNodeSuccess({ChildNodes:JSON.stringify(t.DataManager(this._editorTreeData).executeLocal(t.Query().where("pid","equal",l.id))),customObject:this.model.customObject});if(!l.isChildLoaded){if(e(d).parents("li").first().prepend(a),r=e(d).parent().find("input.e-checkbox").prop("checked"),(o=e(d).parents("li").first().attr("data-tag"))==i)for(s=0;s<this._memberTreeObj.dataSource().length;s++)if(this._memberTreeObj.dataSource()[s].id==l.id){o=this._memberTreeObj.dataSource()[s].tag,e(l.currentElement[0]).attr("data-tag",this._memberTreeObj.dataSource()[s].tag);break}this.pNode=d,null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"memberExpanded",element:this.element,customObject:this.model.customObject}),n=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.memberExpand,JSON.stringify({action:"memberExpanded",checkedStatus:r,parentNode:e(d).parents("li")[0].id,tag:o,dimensionName:this._dimensionName,cubeName:this.currentCubeName,olapReport:this.currentReport,clientReports:this.reports,customObject:n}),this._fetchChildNodeSuccess)}},_onActiveConditionChange:function(t){"Between"==t.selectedValue||"NotBetween"==t.selectedValue?(e(".filterTo").removeAttr("disabled"),e(".e-filterBtw").removeClass("e-sortFilterDisable")):(e(".filterTo").attr("disabled","disabled"),this.element.find(".filterTo").val(""),e(".e-filterBtw").addClass("e-sortFilterDisable"))},_reSizeHandler:function(){if(!t.isNullOrUndefined(this)){if(this._parentHeight=e("#"+this._id).parent().height(),this.element.height(this._parentHeight),this._calculateHeight(),this.model.isResponsive&&this._parentHeight!=e("#"+this._id).parent().height()){var i=e("#"+this._id).parent().height()-this._parentHeight;this.element.height(this._parentHeight-i),this._calculateHeight()}this._parentElwidth=e("#"+this._id).parent().width(),(this._parentElwidth<850||this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this._parentElwidth<910)&&this._rwdToggleCollapse(),(this._parentElwidth>850||this.model.operationalMode==t.Pivot.OperationalMode.ClientMode&&this._parentElwidth>910)&&this._rwdToggleExpand(),this.model.isResponsive&&this.model.enableSplitter&&(this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?this.element.find(".e-serversplitresponsive").data("ejSplitter").refresh():this.element.find(".e-splitresponsive").data("ejSplitter").refresh()),this._overflow(),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),e("#"+this._pivotChart._id+"Container").height(this._chartHeight),t.isNullOrUndefined(this.chartObj)||(this.chartObj.model.size.height=this._chartHeight),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap")),t.isNullOrUndefined(this.chartObj)||("treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw())),this._isCollapseCB&&this._collapseCubeBrowser(),this.displayMode()!=t.PivotClient.DisplayMode.ChartOnly&&this._pivotGrid.element.length>0&&this._pivotGrid._applyFrozenHeaderWidth(this._pivotGrid._JSONRecords)}},_chartDrillSuccess:function(l){var a,r,o,s,n;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot)if(this._isGridDrillAction)this._isGridDrillAction=!1;else{this._isGridDrillAction=!1,this._isChartDrillAction=!0,a=this._pivotChart._selectedItem,"drilldown"==(r=this._pivotChart._drillAction)?t.isNullOrUndefined(this._pivotChart._labelCurrentTags.expandedMembers)||-1!=this._drillParams.indexOf(this._pivotChart._labelCurrentTags.expandedMembers.join(">#>"))||this._drillParams.push(this._pivotChart._labelCurrentTags.expandedMembers.join(">#>")):this._drillParams=e.grep(this._drillParams,function(e){return e.indexOf(a)<0});var d=this._pivotChart.model.enableMultiLevelLabels?l.drilledMember.split(">#>"):"drilldown"==r?this._pivotChart._labelCurrentTags.expandedMembers:this._pivotChart._currentDrillInfo,h=0,c=this._pivotGrid._rowCount;for(o=0;o<d.length;o++)s=o==d.length-1&&"drilldown"==r?this._pivotGrid.element.find(".e-pivotGridTable th.summary[data-p^='"+o+"']"):this._pivotGrid.element.find("th.rowheader").length>0?this._pivotGrid.element.find(".e-pivotGridTable th.rowheader[data-p^='"+o+"']"):e(this._pivotGrid._table).find("th.rowheader[data-p^='"+o+"']"),n=e.grep(s,function(t){return e(t).clone().children().remove().end().text()==d[o]}),n=e.grep(n,function(t){return parseInt(e(t).attr("data-p").split(",")[1])>=h&&parseInt(e(t).attr("data-p").split(",")[1])<=c}),o==d.length-1?e(n).find("."+("drilldown"==r?"e-expand":"e-collapse")).trigger("click"):(h=parseInt(e(n).attr("data-p").split(",")[1]),c=h+(t.isNullOrUndefined(e(n).find("span").attr("data-tag"))?0:parseInt(e(n).find("span").attr("data-tag")))+n[0].rowSpan);0==d.length&&(s=this._pivotGrid.element.find(".e-pivotGridTable th.rowheader[data-p^='0']"),n=e.grep(s,function(t){return e(t).clone().children().remove().end().text()==a}),e(n).find(".e-collapse").trigger("click"))}else this._pivotChart._startDrilldown&&null!=this._pivotGrid&&this._pivotGrid!=i?this._renderPivotGrid(this._pivotChart._selectedTagInfo):this._pivotGrid!=i&&"block"==this._pivotGrid.element.find("table")&&(this._isTimeOut=!1,this._waitingPopup.hide())},_treemapDrillSuccess:function(){this.otreemapObj._startDrilldown&&null!=this._pivotGrid&&this._pivotGrid!=i?this._renderPivotGrid(this.otreemapObj._selectedTagInfo):this._pivotGrid!=i&&"block"==this._pivotGrid.element.find("table")&&(this._isTimeOut=!1,this._waitingPopup.hide()),t.isNullOrUndefined(this.chartObj)||(this.model.displaySettings.enableFullScreen||this.enableTogglePanel()&&"treemap"==this.chartObj.sfType.split(".").pop().toLowerCase())&&(e("#"+this.otreemapObj._id+"TreeMapContainer").css({width:"100%"}),this.otreemapObj._treeMap.refresh())},_gridDrillSuccess:function(l){var a,r,o,s,n,d,h,c,p;if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(!this._isChartDrillAction){if(this._isGridDrillAction=!0,this._isChartDrillAction=!1,"rowheader"==l.axis&&this.displayMode()!=t.PivotClient.DisplayMode.GridOnly){"drilldown"==l.drillAction?this._drillParams.push(l.drilledMember):this._drillParams=e.grep(this._drillParams,function(e){return e.indexOf(l.drilledMember)<0}),a=l.drilledMember.split(">#>"),this._pivotChart._labelCurrentTags.expandedMembers=a,"drillup"==l.drillAction&&(this._pivotChart._labelCurrentTags.expandedMembers=[],this._drillParams.length>0&&this._getDrilledMember(l.drillAction),a=this._pivotChart._labelCurrentTags.expandedMembers),a=this._pivotChart.model.enableMultiLevelLabels?"drillup"==l.drillAction?l.drilledMember.split(">#>").slice(0,-1):l.drilledMember.split(">#>"):a,this._pivotChart._drillAction=l.drillAction,this._pivotChart._drillParams=this._drillParams;try{r=JSON.parse(this.currentReport).Report}catch(e){r=this.currentReport}this._pivotChart.model.enableMultiLevelLabels?this._pivotChart._generateData({JsonRecords:this.getJSONRecords(),PivotReport:this.getOlapReport()}):(o=JSON.stringify(this.model.customObject),s={action:l.drillAction,currentReport:r,drilledSeries:JSON.stringify(a)+"-##-"+JSON.stringify(this.model.valueSortSettings),clientReports:this.reports,customObject:o},this._pivotChart.doAjaxPost("POST",this.model.url+"/"+this._pivotChart.model.serviceMethodSettings.drillDown,JSON.stringify(s),this._pivotChart.renderControlSuccess))}else this._isGridDrillAction=!1;return}this._isChartDrillAction=!1}if(this._pivotGrid._startDrilldown&&!t.isNullOrUndefined(this._pivotChart)){if(d=this._pivotGrid._drillCaption,this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.model.displaySettings.enableFullScreen&&e("#"+this._id+"_maxView").length>0?e("#"+this._id+"_maxView").find("#"+this._pivotChart._id+"Container").data("ejChart"):this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),c=this,!t.isNullOrUndefined(this.chartObj))if("treemap"!=this.chartObj.sfType.split(".").pop().toLowerCase())jQuery.each(this._pivotChart._labelCurrentTags,function(e,t){t!=i&&t.name==d&&(h=t.tag,n=t)}),this._pivotChart._drillAction=this._pivotGrid._drillAction,this._pivotChart._selectedItem=d,"drilldown"!=this._pivotGrid._drillAction||t.isNullOrUndefined(n)?t.isNullOrUndefined(n)||(jQuery.each(this.element.find(".e-rowAxis").find("button"),function(e,t){t.innerHTML==n.tag.split("[")[1].split("]")[0]&&(c._pivotChart._dimensionIndex=e)}),jQuery.each(this._pivotChart._tagCollection,function(e,t){if(t!=i&&t.name==d)return c._pivotChart._selectedIndex=e+c._pivotChart._dimensionIndex,c._pivotChart._tagCollection.splice(e,c._pivotChart._tagCollection.length),!1})):this._pivotChart._tagCollection.push(n),null!=h&&h!=i?this._renderPivotChart(h,this._pivotGrid._drillAction):(this._isTimeOut=!1,this._waitingPopup.hide());else{for(p=0;p<this.otreemapObj.getJsonRecords().labelTags.length;p++)if(this.otreemapObj.getJsonRecords().labelTags[p].split("::")[2]==d){h=this.otreemapObj.getJsonRecords().labelTags[p];break}this.otreemapObj_currentAction=this._pivotGrid._drillAction,this.otreemapObj._selectedItem=d,"drilldown"!=this._pivotGrid._drillAction||t.isNullOrUndefined(n)?t.isNullOrUndefined(n)||(jQuery.each(this.element.find(".e-rowAxis").find("button"),function(e,t){t.innerHTML==n.tag.split("[")[1].split("]")[0]&&(c.otreemapObj._dimensionIndex=e)}),jQuery.each(this.otreemapObj._tagCollection,function(e,t){if(t!=i&&t.name==d)return c.otreemapObj._selectedIndex=e+c.otreemapObj._dimensionIndex,c.otreemapObj._tagCollection.splice(e,c.otreemapObj._tagCollection.length),!1})):this.otreemapObj._tagCollection.push(n),null!=h&&h!=i?this._renderPivotTreeMap(h,this._pivotGrid._drillAction):(this._isTimeOut=!1,this._waitingPopup.hide())}}else"block"==e("#"+this._waitingPopup._id+"_WaitingPopup")[0].style.display&&(this._isTimeOut=!1,this._waitingPopup.hide())},_nodeDropped:function(l){var a,r,o,s,n,d,h,c,p,u,m,g,f,b=e(l.dropTarget).hasClass("e-pvtBtn")&&e(l.dropTarget).parent("div.e-splitBtn").length>0?e(l.dropTarget).parent("div.e-splitBtn"):e(l.dropTarget),_=this;if(b.prevObject!=i?b.prevObject.removeClass("targetAxis"):e(b).removeClass("targetAxis"),_.isDragging=!1,a=this._setSplitBtnTargetPos(l.event),b.prevObject!=i?b.prevObject.parents().find(".e-dialog").hide():e(b).parents().find(".e-dialog").hide(),r=null,e(b).hasClass("e-splitBtn"))r=e(b).parents("div:eq(0)").attr("class");else if("touchend"==l.event.type)r=b[0].className;else if(l.event.target!=i){if(l.event.target.className==i||null==l.event.target.className||e(l.event.target).parents(".e-chartContainer").length>0)return!1;r=l.event.target.className.toLowerCase().indexOf("e-splitBtn")>-1||e(l.event.target).hasClass("e-button")?e(b).attr("class"):l.event.target.className}else r=l.event.originalEvent.srcElement.className.toLowerCase().indexOf("e-splitBtn")>-1?b[0].className:l.event.originalEvent.srcElement.className;if(t.isNullOrUndefined(this._dimensionName)||(delete _._fieldMembers[this._dimensionName.split(":").length>1?this._dimensionName.split(":")[1]:this._dialogTitle],delete _._fieldSelectedMembers[this._dimensionName.split(":").length>1?this._dimensionName.split(":")[1]:this._dialogTitle]),p=r.indexOf("e-categoricalAxis")>r.indexOf("e-rowAxis")?r.indexOf("e-categoricalAxis")>r.indexOf("e-slicerAxis")?"Categorical":"Slicer":r.indexOf("e-rowAxis")>r.indexOf("e-slicerAxis")?"Series":r.indexOf("e-slicerAxis")>=0?"Slicer":null,o=e(l.droppedElement).parents("[data-tag='KPI']").length>0?"Value"==e(l.droppedElement).text()||"Goal"==e(l.droppedElement).text()||"Status"==e(l.droppedElement).text()||"Trend"==e(l.droppedElement).text()?e(l.droppedElement).attr("data-tag")+":"+e(l.droppedElement).parent().closest("li").attr("data-tag")+":"+this._getLocalizedLabels("KPIs"):e(l.droppedElement).attr("data-tag")+":"+this._getLocalizedLabels("KPIs"):e(l.droppedElement).attr("data-tag"),"Slicer"==p&&null!=o&&(o.indexOf("Measure")>-1||o.indexOf("KPIs")>-1)&&(this.element.find(".e-splitBtn[tag*=Measures]").length>1||this.element.find(".e-splitBtn[data-tag*='KPIs']").length>=1)||"Slicer"==p&&o.indexOf("Measure")>-1&&e(l.droppedElement).find(".e-calcMemberCDB").length>0&&1==this.element.find(".e-splitBtn[tag*=CalculatedMember][tag*=Measure]").length&&e(l.droppedElement).attr("data-tag").replace(/\[/g,"").replace(/\]/g,"")!=this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").attr("data-tag").split(":")[1].split("::")[0]||"Slicer"==p&&o.indexOf("Measure")>-1&&0==e(l.droppedElement).find(".e-calcMemberCDB").length&&1==this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").length||"Slicer"==p&&o.indexOf("Measure")>-1&&1==e(l.droppedElement).find(".e-calcMemberCDB").length&&0==this.element.find(".e-splitBtn[data-tag*=CalculatedMember][data-tag*=Measure]").length&&1==this.element.find(".e-splitBtn[data-tag*=Measure]").length)return s=(o.indexOf("KPIs")>-1||o.indexOf("Measure")>-1)&&this.element.find(".e-splitBtn[data-tag*='KPIs']").length>=1?this._getLocalizedLabels("KpiAlertMsg"):this._getLocalizedLabels("MultipleMeasure"),t.Pivot._createErrorDialog(s,this._getLocalizedLabels("Warning"),this),!1;for(n=this.element.find(".e-splitBtn"),d=0;d<n.length;d++)if(!t.isNullOrUndefined(e(l.droppedElement).attr("data-parentuniquename"))&&!t.isNullOrUndefined(e(e(n)[d]).attr("data-parenthierarchy"))&&e(e(n)[d]).attr("data-parenthierarchy")==e(l.droppedElement).attr("data-parentuniquename"))return h=this._getLocalizedLabels("NamedSetAlert").replace("<Set 1>",e(e(n)[d]).find(".e-btn").text()).replace("<Set 2>",e(l.droppedElement).find(".e-text").text()),c=t.buildTag("div.data-namedSetDialog#NamedSetDialog",t.buildTag("div.data-namedSetDialogContent",h)[0].outerHTML+t.buildTag("div",t.buildTag("button#OKBtn.e-okBtn","OK",{margin:"20px 0 10px 120px"}).attr("title","OK")[0].outerHTML+t.buildTag("button#CancelBtn.e-cancelBtn","Cancel",{margin:"20px 0 10px 10px"}).attr("title","Cancel")[0].outerHTML)[0].outerHTML).attr("title","Warning")[0].outerHTML,_.element.append(c),p=r.indexOf("e-categoricalAxis")>r.indexOf("e-rowAxis")?r.indexOf("e-categoricalAxis")>r.indexOf("e-slicerAxis")?"Categorical":"Slicer":r.indexOf("e-rowAxis")>r.indexOf("e-slicerAxis")?"Series":r.indexOf("e-slicerAxis")>=0?"Slicer":null,u=e(e(".e-splitBtn")[d]),_.element.find(".data-namedSetDialog").ejDialog({target:"#"+_._id,enableResize:!1,enableRTL:!1,width:"400px"}),m=this,_.element.find(".e-okBtn,.e-cancelBtn").ejButton({type:t.ButtonType.Button,width:"70px"}),_.element.find(".e-cancelBtn").on(t.eventType.click,function(){m.element.find(".e-dialog").remove()}),_.element.find(".e-okBtn").on(t.eventType.click,function(){null!=_.model.beforeServiceInvoke&&_._trigger("beforeServiceInvoke",{action:"nodeDropped",element:_.element,customObject:_.model.customObject});var t=JSON.stringify(_.model.customObject),i=_.currentCubeName+"--"+e(l.droppedElement).attr("data-tag")+"--"+p+"--"+a+"##"+e(u).attr("data-tag");_.doAjaxPost("POST",_.model.url+"/"+_.model.serviceMethodSettings.nodeDropped,JSON.stringify({action:"nodeDroppedNamedSet",dropType:"TreeNode",nodeInfo:i,olapReport:_.currentReport,clientReports:_.reports,customObject:t}),_._nodeDroppedSuccess)}),0;null!=p&&"Measures"!=o&&o.lastIndexOf(".DF")!=o.length-3&&("Slicer"==p&&(o.indexOf("Measures")>=0||e(l.droppedElement[0].childNodes[0]).find(".e-namedSetCDB").length>0)||(this._isTimeOut=!0,setTimeout(function(){_._isTimeOut&&_._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"nodeDropped",element:this.element,customObject:this.model.customObject}),g=JSON.stringify(this.model.customObject),f=_.currentCubeName+"--"+o+"--"+p+"--"+a,_.doAjaxPost("POST",_.model.url+"/"+_.model.serviceMethodSettings.nodeDropped,JSON.stringify({action:"nodeDropped",dropType:"TreeNode",nodeInfo:f,olapReport:_.currentReport,clientReports:_.reports,customObject:g}),_._nodeDroppedSuccess))),_._isRemoved=!0,_._isNodeOrButtonDropped=!0},_setSplitBtnTargetPos:function(t){var l,a,r,o,s="";if(t.event!=i&&"touchend"==t.event.type?(a=null!=t.event.originalEvent.target?e(t.event.originalEvent.target).parents(".e-splitBtn"):e(t.event.originalEvent.srcElement).parents(".e-splitBtn"),r=null!=t.event.originalEvent.target?t.event.originalEvent.target.className:t.event.originalEvent.srcElement.className):(a=null!=t.originalEvent.target?e(t.originalEvent.target).parents(".e-splitBtn"):e(t.originalEvent.srcElement).parents(".e-splitBtn"),r=null!=t.originalEvent.target?t.originalEvent.target.className:t.originalEvent.srcElement.className),a[0]||r!=i&&null!=r&&"string"==jQuery.type(r)&&r.indexOf("e-splitBtn")>-1)if(a=a[0]?a[0]:null!=t.originalEvent.target?t.originalEvent.target:t.originalEvent.srcElement,(l=t.event!=i&&"touchend"==t.event.type?t.target:null!=this._dropAxisClassName&&this._dropAxisClassName!=i&&""!=this._dropAxisClassName?this.element.find("."+this._dropAxisClassName)[0]:a.parentNode)!=i)for(o=0;o<e(l).find(".e-splitBtn").length;o++)e(l).find(".e-splitBtn")[o]==a&&(s=o);else this._dropAxisClassName="";return s},_cubeChanged:function(i){var l,a,r,o,s=this,n=-1,d=this.element.find("#reportList").data("ejDropDownList"),h=(s.element.find("#cubeSelector").data("ejDropDownList"),e.extend(!0,{},this._slicerBtnTextInfo));if(h[d.selectedIndexValue]=this._fieldSelectedMembers,l={CubeName:this.currentCubeName,CurrentReport:this.currentReport,Reports:this.reports,ReportIndex:d.selectedIndexValue,slicerBtnTextInfo:h},e.map(this._repCol,function(e,t){e.CubeName==s.currentCubeName&&(n=t)}),-1!=n?this._repCol[n]=l:this._repCol.push(l),this._currentRecordName="",this._fieldMembers={},this._fieldSelectedMembers={},this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=null,this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),this.currentCubeName==i.text)return!1;this.currentCubeName=i.text,a="",r="",e.map(this._repCol,function(e){e.CubeName==s.currentCubeName&&(a=e.CurrentReport,r=e.Reports,s._reportIndex=e.ReportIndex)}),s._isTimeOut=!0,setTimeout(function(){s._isTimeOut&&s._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"cubeChanged",element:this.element,customObject:this.model.customObject}),o=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.cubeChanged,JSON.stringify({action:"cubeChanged",cubeName:this.currentCubeName,olapReport:a,clientReports:r,customObject:o,clientParams:JSON.stringify(this.model.enableMeasureGroups)+"-"+this.model.enableKPI+"-"+this.model.sortCubeMeasures}),this._cubeChangedSuccess)},_measureGroupChanged:function(e){var t,i;this._isTimeOut=!0,t=this,setTimeout(function(){t._isTimeOut&&t._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"cubeChanged",element:this.element,customObject:this.model.customObject}),i=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.measureGroupChanged,JSON.stringify({action:"measureGroupChanged",measureGroupName:e.text,olapReport:this.currentReport,clientReports:this.reports,customObject:i}),this._measureGroupChangedSuccess)},_updateSlicerBtnText:function(i){var l=this.element.find("#reportList").data("ejDropDownList").selectedIndexValue,a=e.map(this._repCol,function(e){if(e.CubeName==i&&!t.isNullOrUndefined(e.slicerBtnTextInfo[l]))return e.slicerBtnTextInfo[l]});this._fieldSelectedMembers=a.length>0?a[0]:this._fieldSelectedMembers},_reportChanged:function(i){var l,a,r;if(this._fieldMembers={},this._fieldSelectedMembers={},l=this,this.model.analysisMode==t.Pivot.AnalysisMode.Olap&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode?l._updateSlicerBtnText(l.currentCubeName):this._pivotSchemaDesigner&&this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Pivot&&(this._pivotSchemaDesigner._tempFilterData=[]),this.reportDropTarget=this.element.find("#reportList").data("ejDropDownList"),this.model.operationalMode==t.Pivot.OperationalMode.ClientMode)a=e.map(this._clientReportCollection,function(e){if(e.reportName==l.reportDropTarget.getValue())return e}),this.model.dataSource=a[0],"Rename Report"!=this._currentItem&&(this.refreshControl(),this._pivotSchemaDesigner._refreshPivotButtons()),this._isTimeOut=!1,this._waitingPopup.hide();else if(this.model.analysisMode==t.Pivot.AnalysisMode.Pivot){if(!this._isReportListAction)return;l._isTimeOut=!0,setTimeout(function(){l._isTimeOut&&l._waitingPopup.show()},800),a=e.map(this._clientReportCollection,function(e){if(e.name==l.reportDropTarget.getValue())return e}),this._currentReportName=a[0].name,null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"toolbarOperation",element:this.element,customObject:this.model.customObject}),r=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"Change Report",args:JSON.stringify({currentReport:a[0].report}),customObject:r}),this._toolbarOperationSuccess)}else i.selectedText!=this._selectedReport&&(l._isTimeOut=!0,setTimeout(function(){l._isTimeOut&&l._waitingPopup.show()},800),null!=this.model.beforeServiceInvoke&&this._trigger("beforeServiceInvoke",{action:"toolbarOperation",element:this.element,customObject:this.model.customObject}),r=JSON.stringify(this.model.customObject),this.doAjaxPost("POST",this.model.url+"/"+this.model.serviceMethodSettings.toolbarServices,JSON.stringify({action:"toolbarOperation",toolbarOperation:"Report Change",clientInfo:i.text,olapReport:null,clientReports:this.reports,customObject:r}),this._toolbarOperationSuccess));this._selectedReport=this.reportDropTarget._currentText},_onDropped:function(e){if(e.target.className.indexOf("e-button")>-1){var t=this._getAxisPosition(this.element.find(".e-categoricalAxis")),l=this._getAxisPosition(this.element.find(".e-rowAxis")),a=this._getAxisPosition(this.element.find(".e-slicerAxis"));this._dropAxisClassName,e.pageX!=i&&e.pageY!=i&&(this._dropAxisClassName=e.pageX>t.left&&e.pageX<t.right&&e.pageY>t.top&&e.pageY<t.bottom?"e-categoricalAxis":e.pageX>l.left&&e.pageX<l.right&&e.pageY>l.top&&e.pageY<l.bottom?"e-rowAxis":e.pageX>a.left&&e.pageX<a.right&&e.pageY>a.top&&e.pageY<a.bottom?"e-slicerAxis":"outOfAxis")}},_getAxisPosition:function(t){var i=t.position(),l={};return l.top=i.top,l.right=i.left+e(t).width(),l.bottom=i.top+e(t).height(),l.left=i.left,l},_onTabClick:function(i){this.model.enableSplitter&&!t.isNullOrUndefined(this.element.find(".e-childsplit").data("ejSplitter"))&&this.element.find(".e-childsplit").data("ejSplitter").refresh(),this.displayMode()!=t.PivotClient.DisplayMode.GridOnly&&(this.chartObj=this.element.find("#"+this._pivotChart._id+"Container").data("ejChart"),t.isNullOrUndefined(this.chartObj)&&this.model.enablePivotTreeMap&&!t.isNullOrUndefined(this.otreemapObj)&&(this.chartObj=this.element.find("#"+this.otreemapObj._id+"TreeMapContainer").data("ejTreeMap"))),this._currentTab="chart",e(i.activeHeader).find("a").text()==this._getLocalizedLabels("Grid")?(this._currentTab="grid",this.element.find(".e-chartTypesImg").addClass("e-chartTypesOnGridView"),this.element.find(".e-gridPanel").css("display","inline")):t.isNullOrUndefined(this.chartObj)||(this._currentTab="chart",this.model.enableRTL&&"msie"==t.browserInfo().name&&(this.model.operationalMode==t.Pivot.OperationalMode.ServerMode&&this.model.analysisMode==t.Pivot.AnalysisMode.Olap?this.element.find(".e-chartPanel").addClass("e-serverChartTabRtl"):this.element.find(".e-chartPanel").addClass("e-clientChartTabRtl")),this.element.find(".e-chartTypesImg").removeClass("e-chartTypesOnGridView"),t.isNullOrUndefined(this.chartObj)||("treemap"==this.chartObj.sfType.split(".").pop().toLowerCase()?this.otreemapObj._treeMap.refresh():this.chartObj.redraw()),this.model.enableSplitter&&this._splitterChartResizing(this),this.model.enableToolBar&&(this._unWireEvents(),this._wireEvents()))},doAjaxPost:function(l,a,r,o,s,n){var d,h,c,p,u=!0,m=this.model.enableXHRCredentials;r.XMLA==i?(d="application/json; charset=utf-8",h="json",c=e.proxy(o,this),u=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9||"export"==JSON.parse(r).action)):(d="text/xml",h="xml",r=r.XMLA,c=e.proxy(o,t.olap.base,n),u=!("msie"==t.browserInfo().name&&t.browserInfo().version<=9)&&(!t.isNullOrUndefined(n)&&"loadFieldElements"!=n.action)),p={type:l,url:a,contentType:d,dataType:h,async:u,data:r,success:c,xhrFields:{withCredentials:m},complete:t.proxy(function(){if(t.isNullOrUndefined(this.model))return!1;var e={action:t.isNullOrUndefined(n)||t.isNullOrUndefined(n.action)?JSON.parse(r).action:n.action,customObject:this.model.customObject,element:this.element};this._trigger("renderComplete",e)},this),error:t.proxy(function(e){this._waitingPopup=this.element.data("ejWaitingPopup"),this._isTimeOut=!1,this._waitingPopup.hide();var t={customObject:this.model.customObject,element:this.element,Message:e};this._trigger("renderFailure",t),this._renderControlSuccess("")},this)},m||delete p.xhrFields,e.ajax(p)},doPostBack:function(t,i){var l=e("<form>").attr({action:t,method:"POST",name:"export"}),a=function(t,i){e('<input type="hidden" title="params">').attr({id:t,name:t,value:i}).appendTo(l)};for(var r in i)a(r,i[r]);l.appendTo(document.body).submit().remove()}}),t.PivotClient.Locale=t.PivotClient.Locale||{},t.PivotClient.Locale["en-US"]={NoReports:"No Reports Found in DB",Sort:"Sort",Search:"Search",SelectField:"Select field",LabelFilterLabel:"Show the items for which the label",ValueFilterLabel:"Show the items for which",ClearSorting:"Clear Sorting",ClearFilterFrom:"Clear Filter From",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",LabelFilters:"Label Filters  ",BeginsWith:"Begins With",DoesNotBeginsWith:"Does Not Begin With",EndsWith:"Ends With",NotEndsWith:"Not Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",ValueFilters:"Value Filters",ClearFilter:"Clear Filter",Equals:"Equals",DoesNotEquals:"Does Not Equal",NotEquals:"Not Equals",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Top10:"Top Count",GreaterThan:"Greater Than",IsGreaterThan:"Is Greater Than",IsGreaterThanOrEqualTo:"Is Greater Than Or Equal To",IsLessThan:"Is Less Than",IsLessThanOrEqualTo:"Is Less Than Or Equal To",DeferUpdate:"Defer Update",MDXQuery:"MDX Query",Column:"Column",Row:"Row",Slicer:"Slicer",CubeSelector:"Cube Selector",ReportName:"Report Name",NewReport:"New Report",CubeDimensionBrowser:"Cube Dimension Browser",AddReport:"Add Report",RemoveReport:"Remove Report",CannotRemoveSingleReport:"Cannot remove single report",AreYouSureToDeleteTheReport:"Are you sure to delete the Report",RenameReport:"Rename Report",ChartTypes:"Chart Types",ToggleAxis:"Toggle Axis",Load:"Load",ExportToExcel:"Export To Excel",ExportToWord:"Export To Word",ExportToPdf:"Export To Pdf",FullScreen:"Full Screen",Grid:"Grid",Chart:"Chart",OK:"<u>O</u>K",Cancel:"<u>C</u>ancel",Close:"Close",AddToColumn:"Add to Column",AddToRow:"Add to Row",AddToSlicer:"Add to Slicer",MeasureEditor:"Measure Editor",MemberEditor:"Member Editor",Measures:"Measures",SortOrFilterColumn:"Sort/Filter (Column)",SortOrFilterRow:"Sort/Filter (Row)",SortingAndFiltering:"Sorting And Filtering",Sorting:"Sorting",Measure:"<u>M</u>easure",Order:"Order",Filtering:"Filtering",Condition:"C<u>o</u>ndition",Value:"Val<u>u</u>e",PreserveHierarchy:"P<u>r</u>eserve  Hierarchy",Ascending:"<u>A</u>scending",Descending:"D<u>e</u>scending",Enable:"E<u>n</u>able",Disable:"D<u>i</u>sable",and:"<u>a</u>nd",EqualTo:"EqualTo",NotEquals:"NotEquals",GreaterThan:"GreaterThan",GreaterThanOrEqualTo:"GreaterThanOrEqualTo",LessThan:"LessThan",LessThanOrEqualTo:"LessThanOrEqualTo",Between:"Between",NotBetween:"NotBetween",ReportList:"Report List",Line:"Line",Spline:"Spline",Column:"Column",Area:"Area",SplineArea:"Spline Area",StepLine:"Step Line",StepArea:"Step Area",Pie:"Pie",Bar:"Bar",StackingArea:"Stacking Area",StackingColumn:"Stacking Column",StackingBar:"Stacking Bar",Pyramid:"Pyramid",Funnel:"Funnel",Doughnut:"Doughnut",Scatter:"Scatter",Bubble:"Bubble",WaterFall:"WaterFall",TreeMap:"TreeMap",Alert:"Alert",MDXAlertMsg:"Please add a measure, dimension, or hierarchy in an appropriate axis to view the MDX Query.",FilterSortRowAlertMsg:"Dimension is not found in the row axis. Please add Dimension element in the row axis for sorting/filtering.",FilterSortColumnAlertMsg:"Dimension is not found in the column axis. Please add Dimension element in the column axis for sorting/filtering.",FilterSortcolMeasureAlertMsg:"Please add measure to the column axis",FilterSortrowMeasureAlertMsg:"Please add measure to the row axis",FilterSortElementAlertMsg:"Element is not found in the column axis. Please add an element in column axis for sorting/filtering.",SelectRecordAlertMsg:"Please select a valid report.",FilterMeasureSelectionAlertMsg:"Please select a valid measure.",FilterConditionAlertMsg:"Please set a valid condition.",FilterStartValueAlertMsg:"Please set a start value.",FilterEndValueAlertMsg:"Please set a end value.",FilterInvalidAlertMsg:"Invalid operation !",Remove:"Remove",Save:"Save",SaveAs:"Save As",SelectReport:"Select Report",DBReport:"Report Manipulation in DB",Rename:"Rename",Remove:"Remove",SetReportNameAlertMsg:"Please set report name.",MultipleItems:"Multiple items",All:"All",CalculatedMember:"Calculated Member",Caption:"Caption:",Expression:"Expression:",MemberType:"MemberType:",FormatString:"Format String:",MultipleMeasure:"More than one measure cannot be sliced.",DuplicateCalcMeasure:"Calculated Member with same name already exists.",EmptyField:"Calculated Member name or Expression should not be empty.",EmptyFormat:"Format String for Calculated Member is empty.",Warning:"Warning",Confirm:"Calculated Member with the same name already exists. Do you want to replace?",KPIs:"KPIs",Collection:"Collection",Report:"Report",AddCurrentSelectionToFilter:"Add current selection to filter",SaveMsg:"Report saved successfully!!!",RenameMsg:"Report renamed successfully!!!",RemoveMsg:"Report removed successfully!!!",Success:"Success",KpiAlertMsg:"The field you are moving cannot be placed in that area of the report",NotAllItemsShowing:"Not all child nodes are shown",EditorLinkPanelAlert:"The members have more than 1000 items under one or more parent. Only the first 1000 items are displayed under each parent.",NamedSetAlert:"Named sets of same field cannot be added to the PivotTable report at the same time. Click OK to remove ' <Set 1> ' named set and add ' <Set 2> ' named set.",Exception:"Exception"},t.PivotClient.ControlPlacement={Tab:"tab",Tile:"tile"},t.PivotClient.DisplayMode={ChartOnly:"chartonly",GridOnly:"gridonly",ChartAndGrid:"chartandgrid"},t.PivotClient.ClientExportMode={ChartAndGrid:"chartandgrid",ChartOnly:"chartonly",GridOnly:"gridonly"},t.PivotClient.ExportMode={JSON:"json",PivotEngine:"pivotengine"},t.PivotClient.DefaultView={Chart:"chart",Grid:"grid"},t.PivotClient.MemberType={Dimension:"dimension",Measure:"measure"}}(jQuery,Syncfusion)})},447:function(e,t,i){"use strict";var l=this&&this.__decorate||function(e,t,i,l){var a,r=arguments.length,o=r<3?t:null===l?l=Object.getOwnPropertyDescriptor(t,i):l;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,l);else for(var s=e.length-1;s>=0;s--)(a=e[s])&&(o=(r<3?a(o):r>3?a(t,i,o):a(t,i))||o);return r>3&&o&&Object.defineProperty(t,i,o),o};Object.defineProperty(t,"__esModule",{value:!0});var a=i(5),r=i(78),o=i(64),s=i(1499),n=i(413),d=i(1340),h=i(1338),c=i(1337),p=i(1339),u=i(1341);t.pivotclientAppRoutes=[{path:"relational",component:d.RelationalComponent,data:{name:"Relational",location:"app/components/pivotclient/relational.component"}},{path:"olap",component:p.OlapComponent,data:{name:"OLAP",location:"app/components/pivotclient/olap.component"}},{path:"advancedFiltering",component:c.AdvancedFilteringComponent,data:{name:"Advanced Filtering",location:"app/components/pivotclient/advancedFiltering.component"}},{path:"exporting",component:h.ExportingComponent,data:{name:"Exporting",location:"app/components/pivotclient/exporting.component"}},{path:"rtl",component:u.RTLComponent,data:{name:"RTL",location:"app/components/pivotclient/rtl.component"}},{path:"",redirectTo:"relational"}],t.PivotClientRouting=r.RouterModule.forChild(t.pivotclientAppRoutes);var m=function(){function e(){}return e=l([a.NgModule({imports:[t.PivotClientRouting,o.FormsModule,n.SharedModule],declarations:[d.RelationalComponent,p.OlapComponent,h.ExportingComponent,c.AdvancedFilteringComponent,u.RTLComponent,s.EJ_PIVOTCLIENT_COMPONENTS]})],e)}();t.PivotClientModule=m}});