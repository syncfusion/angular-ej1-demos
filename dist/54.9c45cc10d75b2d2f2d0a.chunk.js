webpackJsonp([54],{1330:function(e,t,i){"use strict";var o=this&&this.__decorate||function(e,t,i,o){var n,s=arguments.length,a=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(s<3?n(a):s>3?n(t,i,a):n(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(5),a=function(){function e(){this.service="//js.syncfusion.com/demos/ejservices/api/PdfViewer"}return e=o([s.Component({selector:"ej-app",template:i(1829)}),n("design:paramtypes",[])],e)}();t.DefaultComponent=a},1331:function(e,t,i){"use strict";var o=this&&this.__decorate||function(e,t,i,o){var n,s=arguments.length,a=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(s<3?n(a):s>3?n(t,i,a):n(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a},n=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};Object.defineProperty(t,"__esModule",{value:!0});var s=i(5),a=function(){function e(){this.service="//js.syncfusion.com/demos/ejservices/api/PdfViewer"}return e=o([s.Component({selector:"ej-app",template:i(1830)}),n("design:paramtypes",[])],e)}();t.LocalizationComponent=a,ej.PdfViewer.Locale["es-ES"]={toolbar:{print:{headerText:"Impresión",contentText:"Imprimir el documento PDF."},first:{headerText:"primero",contentText:"Ir a la primera página del documento PDF."},previous:{headerText:"Anterior",contentText:"Ir a la página anterior del documento PDF."},next:{headerText:"Siguiente",contentText:"Ir a la página siguiente del documento PDF."},last:{headerText:"Último",contentText:"Ir a la última página del documento PDF."},zoomIn:{headerText:"Acercarse",contentText:"Acercar al documento PDF."},zoomOut:{headerText:"Disminuir el zoom",contentText:"Alejar la imagen del documento PDF."},pageIndex:{headerText:"Número de página",contentText:"número de página actual para ver."},zoom:{headerText:"Enfocar",contentText:"Zoom para acercar o alejar el documento PDF."},fitToWidth:{headerText:"Ajustar al ancho",contentText:"Ajuste a la página PDF a la anchura del contenedor ."},fitToPage:{headerText:"Ajustar a la página",contentText:"Ajuste a la página PDF al contenedor ."},download:{headerText:"Descargar",contentText:"Descargar el documento PDF ."},search:{headerText:"Buscar texto",contentText:"Buscar texto en las páginas PDF ."},highlight:{headerText:"Subrayar el texto",contentText:"Resaltar texto en las páginas PDF."},strikeout:{headerText:"Texto de StrikeOut",contentText:"Strike Out en las páginas PDF."},underline:{headerText:"Subrayar el texto",contentText:"Subraye el texto en las páginas PDF."},signature:{headerText:"Firma",contentText:"Agregue o cree la firma escrita a mano."},select:{headerText:"Selección",contentText:"Herramienta de selección de texto."},scroll:{headerText:"Panning",contentText:"Haga clic para desplazarse alrededor del documento"}},contextMenu:{copy:{contentText:"Dupdo"},googleSearch:{contentText:"Busca en Google"},Find:{contentText:"Encontrar:"},matchCase:{contentText:"MatchCase"},auto:{contentText:"Auto"},openPopup:{contentText:"OpenPopup"},Delete:{contentText:"Borrar"},properties:{contentText:"Propiedades...."}},propertyWindow:{underlineProperties:{contentText:"Subrayar propiedades"},strikeOutProperties:{contentText:"StrikeOutProperties"},highlightProperties:{contentText:"DestacadosProperties"},signatureProperties:{contentText:"Firma propiedades"},appearance:{contentText:"apariencia"},general:{contentText:"general"},color:{contentText:"kleur:"},opacity:{contentText:"opacidad:"},author:{contentText:"autor:"},subject:{contentText:"tema:"},modified:{contentText:"modificado:"},ok:{contentText:"De acuerdo"},cancel:{contentText:"cancelar"},locked:{contentText:"Bloqueado"}},signatureWindow:{Signature:{contentText:"Añadir firma"},Add:{contentText:"Añadir"},clear:{contentText:"Claro"}},waitingPopup:{print:{contentText:"Preparación del documento para imprimir ..."}}}},1496:function(e,t,i){"use strict";var o=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(t,i){function o(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}}();Object.defineProperty(t,"__esModule",{value:!0}),i(2039);var n=i(12),s=i(5),a=function(e){function t(t,i,o,n){var a=e.call(this,"PdfViewer",t,i,[],o,n)||this;return a.el=t,a.cdRef=i,a._ejIterableDiffers=o,a._ejkeyvaluediffers=n,a.documentLoad_output=new s.EventEmitter,a.documentUnload_output=new s.EventEmitter,a.pageChange_output=new s.EventEmitter,a.ajaxRequestFailure_output=new s.EventEmitter,a.ajaxRequestSuccess_output=new s.EventEmitter,a.zoomChange_output=new s.EventEmitter,a.hyperlinkClick_output=new s.EventEmitter,a.beforePrint_output=new s.EventEmitter,a.afterPrint_output=new s.EventEmitter,a.pageClick_output=new s.EventEmitter,a.annotationAdd_output=new s.EventEmitter,a.annotationRemove_output=new s.EventEmitter,a.annotationPropertiesChange_output=new s.EventEmitter,a.signatureAdd_output=new s.EventEmitter,a.signatureDelete_output=new s.EventEmitter,a.signaturePropertiesChange_output=new s.EventEmitter,a.signatureResize_output=new s.EventEmitter,a.bufferStart_output=new s.EventEmitter,a.bufferEnd_output=new s.EventEmitter,a.downloadStart_output=new s.EventEmitter,a.downloadEnd_output=new s.EventEmitter,a.destroy_output=new s.EventEmitter,a}return o(t,e),t.decorators=[{type:s.Component,args:[{selector:"ej-pdfviewer",template:""}]}],t.ctorParameters=function(){return[{type:s.ElementRef},{type:s.ChangeDetectorRef},{type:s.IterableDiffers},{type:s.KeyValueDiffers}]},t.propDecorators={locale_input:[{type:s.Input,args:["locale"]}],toolbarSettings_input:[{type:s.Input,args:["toolbarSettings"]}],serverActionSettings_input:[{type:s.Input,args:["serverActionSettings"]}],serviceUrl_input:[{type:s.Input,args:["serviceUrl"]}],documentPath_input:[{type:s.Input,args:["documentPath"]}],enableTextMarkupAnnotations_input:[{type:s.Input,args:["enableTextMarkupAnnotations"]}],enableHighlightAnnotation_input:[{type:s.Input,args:["enableHighlightAnnotation"]}],enableUnderlineAnnotation_input:[{type:s.Input,args:["enableUnderlineAnnotation"]}],enableStrikethroughAnnotation_input:[{type:s.Input,args:["enableStrikethroughAnnotation"]}],enableSignature_input:[{type:s.Input,args:["enableSignature"]}],strikethroughSettings_input:[{type:s.Input,args:["strikethroughSettings"]}],underlineSettings_input:[{type:s.Input,args:["underlineSettings"]}],highlightSettings_input:[{type:s.Input,args:["highlightSettings"]}],signatureSettings_input:[{type:s.Input,args:["signatureSettings"]}],textSelectionContextMenu_input:[{type:s.Input,args:["textSelectionContextMenu"]}],annotationContextMenu_input:[{type:s.Input,args:["annotationContextMenu"]}],annotationType_input:[{type:s.Input,args:["annotationType"]}],pageCount_input:[{type:s.Input,args:["pageCount"]}],currentPageNumber_input:[{type:s.Input,args:["currentPageNumber"]}],zoomPercentage_input:[{type:s.Input,args:["zoomPercentage"]}],pdfService_input:[{type:s.Input,args:["pdfService"]}],interactionMode_input:[{type:s.Input,args:["interactionMode"]}],bufferingMode_input:[{type:s.Input,args:["bufferingMode"]}],hyperlinkOpenState_input:[{type:s.Input,args:["hyperlinkOpenState"]}],enableHyperlink_input:[{type:s.Input,args:["enableHyperlink"]}],enableTextSelection_input:[{type:s.Input,args:["enableTextSelection"]}],isResponsive_input:[{type:s.Input,args:["isResponsive"]}],isDocumentEdited_input:[{type:s.Input,args:["isDocumentEdited"]}],allowClientBuffering_input:[{type:s.Input,args:["allowClientBuffering"]}],fileName_input:[{type:s.Input,args:["fileName"]}],toolbarSettings_showToolTip_input:[{type:s.Input,args:["toolbarSettings.showToolTip"]}],toolbarSettings_toolbarItem_input:[{type:s.Input,args:["toolbarSettings.toolbarItem"]}],serverActionSettings_load_input:[{type:s.Input,args:["serverActionSettings.load"]}],serverActionSettings_fileUpload_input:[{type:s.Input,args:["serverActionSettings.fileUpload"]}],serverActionSettings_print_input:[{type:s.Input,args:["serverActionSettings.print"]}],serverActionSettings_download_input:[{type:s.Input,args:["serverActionSettings.download"]}],strikethroughSettings_color_input:[{type:s.Input,args:["strikethroughSettings.color"]}],strikethroughSettings_author_input:[{type:s.Input,args:["strikethroughSettings.author"]}],strikethroughSettings_opacity_input:[{type:s.Input,args:["strikethroughSettings.opacity"]}],strikethroughSettings_subject_input:[{type:s.Input,args:["strikethroughSettings.subject"]}],strikethroughSettings_modifiedDate_input:[{type:s.Input,args:["strikethroughSettings.modifiedDate"]}],strikethroughSettings_isLocked_input:[{type:s.Input,args:["strikethroughSettings.isLocked"]}],underlineSettings_color_input:[{type:s.Input,args:["underlineSettings.color"]}],underlineSettings_author_input:[{type:s.Input,args:["underlineSettings.author"]}],underlineSettings_opacity_input:[{type:s.Input,args:["underlineSettings.opacity"]}],underlineSettings_subject_input:[{type:s.Input,args:["underlineSettings.subject"]}],underlineSettings_modifiedDate_input:[{type:s.Input,args:["underlineSettings.modifiedDate"]}],underlineSettings_isLocked_input:[{type:s.Input,args:["underlineSettings.isLocked"]}],highlightSettings_color_input:[{type:s.Input,args:["highlightSettings.color"]}],highlightSettings_author_input:[{type:s.Input,args:["highlightSettings.author"]}],highlightSettings_opacity_input:[{type:s.Input,args:["highlightSettings.opacity"]}],highlightSettings_subject_input:[{type:s.Input,args:["highlightSettings.subject"]}],highlightSettings_modifiedDate_input:[{type:s.Input,args:["highlightSettings.modifiedDate"]}],highlightSettings_isLocked_input:[{type:s.Input,args:["highlightSettings.isLocked"]}],signatureSettings_color_input:[{type:s.Input,args:["signatureSettings.color"]}],signatureSettings_opacity_input:[{type:s.Input,args:["signatureSettings.opacity"]}],textSelectionContextMenu_isEnable_input:[{type:s.Input,args:["textSelectionContextMenu.isEnable"]}],textSelectionContextMenu_isCopyEnable_input:[{type:s.Input,args:["textSelectionContextMenu.isCopyEnable"]}],textSelectionContextMenu_isSearchEnable_input:[{type:s.Input,args:["textSelectionContextMenu.isSearchEnable"]}],textSelectionContextMenu_isHighlightEnable_input:[{type:s.Input,args:["textSelectionContextMenu.isHighlightEnable"]}],textSelectionContextMenu_isStrikeoutEnable_input:[{type:s.Input,args:["textSelectionContextMenu.isStrikeoutEnable"]}],annotationContextMenu_isEnable_input:[{type:s.Input,args:["annotationContextMenu.isEnable"]}],annotationContextMenu_isPopupEnable_input:[{type:s.Input,args:["annotationContextMenu.isPopupEnable"]}],annotationContextMenu_isDeleteEnable_input:[{type:s.Input,args:["annotationContextMenu.isDeleteEnable"]}],annotationContextMenu_isPropertiesEnable_input:[{type:s.Input,args:["annotationContextMenu.isPropertiesEnable"]}],options:[{type:s.Input,args:["options"]}],documentLoad_output:[{type:s.Output,args:["documentLoad"]}],documentUnload_output:[{type:s.Output,args:["documentUnload"]}],pageChange_output:[{type:s.Output,args:["pageChange"]}],ajaxRequestFailure_output:[{type:s.Output,args:["ajaxRequestFailure"]}],ajaxRequestSuccess_output:[{type:s.Output,args:["ajaxRequestSuccess"]}],zoomChange_output:[{type:s.Output,args:["zoomChange"]}],hyperlinkClick_output:[{type:s.Output,args:["hyperlinkClick"]}],beforePrint_output:[{type:s.Output,args:["beforePrint"]}],afterPrint_output:[{type:s.Output,args:["afterPrint"]}],pageClick_output:[{type:s.Output,args:["pageClick"]}],annotationAdd_output:[{type:s.Output,args:["annotationAdd"]}],annotationRemove_output:[{type:s.Output,args:["annotationRemove"]}],annotationPropertiesChange_output:[{type:s.Output,args:["annotationPropertiesChange"]}],signatureAdd_output:[{type:s.Output,args:["signatureAdd"]}],signatureDelete_output:[{type:s.Output,args:["signatureDelete"]}],signaturePropertiesChange_output:[{type:s.Output,args:["signaturePropertiesChange"]}],signatureResize_output:[{type:s.Output,args:["signatureResize"]}],bufferStart_output:[{type:s.Output,args:["bufferStart"]}],bufferEnd_output:[{type:s.Output,args:["bufferEnd"]}],downloadStart_output:[{type:s.Output,args:["downloadStart"]}],downloadEnd_output:[{type:s.Output,args:["downloadEnd"]}],destroy_output:[{type:s.Output,args:["destroy"]}]},t}(n.EJComponents);t.PdfViewerComponent=a,t.EJ_PDFVIEWER_COMPONENTS=[a]},1829:function(e,t){e.exports='<div style="width:100%">\r\n    <ej-pdfviewer [(serviceUrl)]="service" id="pdfviewer1" style="width:100%;min-height:600px;display:block">\r\n    </ej-pdfviewer>\r\n</div>'},1830:function(e,t){e.exports='<div style="width:100%">\r\n    <ej-pdfviewer [(serviceUrl)]="service" id="pdfviewer1" locale="es-ES" style="width:100%;min-height:600px;display:block">\r\n\t</ej-pdfviewer>\r\n</div>  '},2039:function(e,t,o){var n,s,a;
/*!
*  filename: ej.pdfviewer.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
/*!
*  filename: ej.pdfviewer.min.js
*  version : 17.2.0.46
*  Copyright Syncfusion Inc. 2001 - 2018. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(i){s=[o(15),o(4),o(21),o(16),o(47),o(92),o(79),o(80),o(66),o(31),o(93)],void 0===(a="function"==typeof(n=i)?n.apply(t,s):n)||(e.exports=a)}(function(){!function(e,t,o){t.widget("ejPdfViewer","ej.PdfViewer",{_rootCSS:"e-pdfviewer",_requiresID:!0,element:null,model:null,validTags:["div"],defaults:{serviceUrl:"",hyperlinkOpenState:1,serverActionSettings:{load:"Load",fileUpload:"FileUpload",print:"Load",download:"Download",unload:"Unload"},documentPath:null,toolbarSettings:{toolbarItem:255,showTooltip:!0},enableHyperlink:!0,enableTextSelection:!0,pdfService:1,locale:"en-US",interactionMode:1,bufferingMode:1,pageChange:"",documentLoad:"",hyperlinkClick:"",beforePrint:"",afterPrint:"",zoomchange:"",bufferStart:"",bufferEnd:"",annotationAdd:"",annotationRemove:"",annotationPropertiesChange:"",annotationResize:"",signatureDelete:"",signatureAdd:"",signatureResize:"",signaturePropertiesChange:"",isResponsive:!0,pageClick:"",allowClientBuffering:!1,documentUnload:"",ajaxRequestFailure:"",ajaxRequestSuccess:"",annotationType:null,enableTextMarkupAnnotations:!0,enableHighlightAnnotation:!0,enableStrikethroughAnnotation:!0,enableUnderlineAnnotation:!0,enableSignature:!0,shouldFlattenDocument:!1,enableRequiredFormFieldValidation:!1,validateRequiredFormField:"",downloadStart:"",downloadEnd:"",strikethroughSettings:{color:"#ff0000",author:"Guest",opacity:1,subject:"Strikethrough",modifiedDate:null,isLocked:!1},underlineSettings:{color:"#00ff00",author:"Guest",opacity:1,subject:"Underline",modifiedDate:null,isLocked:!1},highlightSettings:{color:"#ffff00",author:"Guest",opacity:1,subject:"Highlight",modifiedDate:null,isLocked:!1},signatureSettings:{color:"#000000",opacity:1,width:0,height:0},textSelectionContextMenu:{isEnable:!0,isCopyEnable:!0,isSearchEnable:!0,isHighlightEnable:!0,isStrikeoutEnable:!0},annotationContextMenu:{isEnable:!0,isPopupEnable:!0,isDeleteEnable:!0,isPropertiesEnable:!0}},dataTypes:{toolbarSettings:"data"},_isToolbarClick:!1,_curYPos:0,_curXPos:0,_curDown:!1,_pageModel:null,_currentPage:1,_zoomLevel:2,_preZoomVal:1,_fitType:null,_higherZoomIndex:0,_lowerZoomIndex:0,_actionUrl:null,_isDevice:!1,_contextMenu:!1,_zoomVal:1,_currentPageBackup:0,_zoomValBackup:0,_zoomLevelBackup:0,_fitTypeBackup:null,_scrollTop:0,_bgRenderTimer:0,_renderCount:0,_prevDiff:-1,_pointerCount:0,_searchText:null,_selectedIndex:0,_searchPageIndex:0,_isRenderedByPinch:!1,_isPinchLimitReached:!1,_isRerenderCanvasCreated:!1,_isPrinting:!1,_isContainImage:!1,_isPercentHeight:-1,_isPercentWidth:-1,_isHeight:!1,_isWidth:!1,_isFindboxPresent:!1,_isTextSearch:!1,_isTextHighlighted:!1,_isRequestFired:!1,_isPageScrollHighlight:!1,_isPageScrolledForSearch:!1,_searchAjaxRequestState:null,_isPrevSearch:!1,_isMatchCase:!1,_isPrintHidden:!1,_isNavigationHidden:!1,_isMagnificationHidden:!1,_isDownloadHidden:!1,_isTextSearchHidden:!1,_isZoomCntlHidden:!1,_isDownloadCntlHidden:!1,_isToolbarHidden:!1,_isSignatureHidden:!1,_viewerAction:{getPageModel:"GetPageModel"},_scrollTimer:null,_isDestroyed:!1,_pdfService:null,_toolbar:null,_printIframe:null,_currentPrintPage:0,_abortPrinting:!1,_isWindowResizing:!1,_ejViewerInstance:null,_isAutoZoom:!1,_isAutoSelected:!1,_ejDropDownInstance:null,_clientx:null,_clienty:null,_curPosX:null,_curPosY:null,_previousBounds:null,_topValue:!1,_clearText:!1,_timers:null,_scrollMove:null,_rangePosition:null,_selectedRanges:null,_longTouch:!1,_ranges:!1,_touchcontextMenu:!1,_selectionNodes:null,_selectionRange:null,_touched:!1,_lockTimer:null,_timer:null,_displaySearch:!1,_isCopyRestrict:!1,_isPrintRestrict:!1,_isPageExtraction:!1,_isFormFieldsDisabled:!1,_isTargetPage:!1,_targetPage:0,_isBuffering:!1,_isBufferStart:!1,_pagesGot:null,_isPrintingProcess:!1,_isRequestSuccess:!1,_fileId:null,_isFormFields:!1,_imageObj:null,_isJsondataAvailable:!1,_highestWidth:0,_horizontalResolution:null,_isAsynchronousDownload:!0,_searchedText:null,_annotationActive:!1,_isHighlight:!1,_isUnderline:!1,_isStrikeout:!1,_drawColor:null,_selectedAnnotation:null,_selectedAnnotationObject:null,_isPopupNoteFocused:!1,_colorpickerObject:null,_toolbarColorpickerObject:null,_isBackwardSelection:!1,_isPropertiesWindowOpen:!1,_isAnnotationSelected:!1,_currentAnnotationRectangle:[],_currentAnnotationRectangleBackup:[],_annotationBackupNoteSave:[],_isPopupNoteVisible:!1,_isUnderlineEnabled:!1,_isHighlightEnabled:!1,_isStrikeOutEnabled:!1,_isContextMenuPresent:!1,_isDefaultColorSet:!1,_isTextSelection:!1,_colorPickerStatus:null,_annotationsDeletedNo:null,_selectedValue:null,_highestHeight:0,_removeSearch:!1,_ajaxInProgress:!1,_isNonBreackingCharacter:!1,_mouseDetection:!1,_oldX:null,_mouseX:null,_oldY:null,_mouseY:null,_newObject:[],_newx:null,_newy:null,_outputString:"",_completeSign:[],_outputPath:{},_valueChanges:{},_totalSignature:[],_isCanvasClicked:!1,_isCanasResized:!1,_tempCanvas:null,_previousZoomValue:1,_canvasTopPosition:0,_canvasLeftPosition:0,_newpoints:[],_maxpointsX:0,_minpointsX:0,_maxpointsY:0,_minpointsY:0,_controlSelectionRange:null,_selectionObject:null,_cancelDownloads:!1,_downloadfileName:null,_signatureLayer:[],_renderedCanvasList:null,_textureobj:[],_isToolbarHeightChanged:!1,_isPinchZoomed:!1,_isTouchEnded:!1,_prevZoomX:0,_zoomX:0,_zoomY:0,_textlayout:[],_responseData:null,_isSelectionDisabled:!1,_ispdfium:!1,_ispageCleared:!1,_isControlHided:!1,_isTouchAdded:!1,_maxTabindex:0,_minTabindex:-1,_maintainTabindex:{},_maintanMinTabindex:{},pageCount:0,currentPageNumber:1,zoomPercentage:100,fileName:null,isDocumentEdited:!1,_init:function(){var i,o,n;if(this._actionUrl=this.model.serviceUrl+"/"+this.model.serverActionSettings.load,this._renderViewer(),this._initViewer(),this._createContextMenu(),this._createHighlightContextMenu(),this._createWaterDropDiv(),this._createTouchContextMenu(),this._createPopupMenu(),this._createNote(),this._createPropertiesMenu(),this._createColorPalette(),this._createSignatureControl(),(i=document.getElementById(this._id+"_pdfviewer_colorpicker"))&&(i.style.display="none"),this._isToolbarColorPicker=!1,this._ejDropDownInstance=e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList"),this._getPdfService(this.model.pdfService),this.model.serviceUrl){if((o={}).viewerAction="GetPageModel",o.controlId=this._id,o.pageindex="1",o.isInitialLoading="true",o.zoomValue=this._zoomVal,this.model.allowClientBuffering&&(o.enableOfflineMode=!0,this.model.bufferingMode==t.PdfViewer.BufferingMode.Default?o.bufferingMode="default":this.model.bufferingMode==t.PdfViewer.BufferingMode.Complete&&(o.bufferingMode="complete"),this._isPrintingProcess||(o.isPageScrolled=!1)),this.model.documentPath){var s=this.model.documentPath;s.split("base64,")[1]||(-1!=this.model.documentPath.indexOf("\\")||-1!=this.model.documentPath.indexOf("/")?(!0,!0,this.model.documentPath.toLowerCase().endsWith(".pdf")||(s=this.model.documentPath+".pdf")):((n=s.split(",")).length>1?(o.newFileName=n[1],o.password=n[0]):o.newFileName=s,this._fileName=o.newFileName)),o.file=s}o.id=this._createGUID(),this._fileId=o.id,null!=this._ajaxState&&(this._ajaxState.abort(),this._ajaxState=null,this._scrollTriggered=!1),this.model.allowClientBuffesring?this.model.bufferingMode==t.PdfViewer.BufferingMode.Default?this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPost("POST",this._actionUrl,JSON.stringify(o),"_getPageModel",!0):this._doAjaxPost("POST",this.model.serviceUrl,JSON.stringify({jsonResult:o}),"_getPageModel",!0):this.model.bufferingMode==t.PdfViewer.BufferingMode.Complete&&(this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPost("POST",this._actionUrl,JSON.stringify(o),"_getPageModel"):this._doAjaxPost("POST",this.model.serviceUrl,JSON.stringify({jsonResult:o}),"_getPageModel")):this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPost("POST",this._actionUrl,JSON.stringify(o),"_getPageModel"):this._doAjaxPost("POST",this.model.serviceUrl,JSON.stringify({jsonResult:o}),"_getPageModel")}this._printIframe=document.createElement("iframe")},_getPdfService:function(e){this._pdfService=1==e?t.PdfViewer.PdfService.Local:t.PdfViewer.PdfService.Remote},_initViewer:function(){this._wireEvents(),this._initToolbar(),this._ideviceScrolling(),this._currentPage=1,this._textMarkupAnnotationList=[],this._newAnnotationList=[],this._colorModifiedAnnotationList=[],this._existingAnnotationsModified=[],this._deletedAnnotationList=[],this._undoAnnotationCollection=[],this._redoAnnotationCollection=[],this._deletedAnnotationCollection=[],this._recentOperation=[],this._annotationsDeletedNo=[],this._redoActions=[],this._totalAnnotations=[];var i=this.model.toolbarSettings;i.templateId||(this._showToolbar(!0),this._showPrintButton(i.toolbarItem&t.PdfViewer.ToolbarItems.PrintTools),this._showZoomControl(i.toolbarItem&t.PdfViewer.ToolbarItems.MagnificationTools),this._showFittoPage(i.toolbarItem&t.PdfViewer.ToolbarItems.MagnificationTools),this._showPageNavigationControls(i.toolbarItem&t.PdfViewer.ToolbarItems.PageNavigationTools),this._showDownloadButton(i.toolbarItem&t.PdfViewer.ToolbarItems.DownloadTool),this._showTextSearchButton(i.toolbarItem&t.PdfViewer.ToolbarItems.TextSearchTool),this._showTextMarkupButtons(i.toolbarItem&t.PdfViewer.ToolbarItems.TextMarkupAnnotationTools),this._showSignatureButtons(i.toolbarItem&t.PdfViewer.ToolbarItems.SignatureTool),this._showSelectionButtons(i.toolbarItem&t.PdfViewer.ToolbarItems.SelectionTool)),this._showViewerBlock(!1),this._setContainerSize(),this._showloadingIndicator(!0),this._on(e("#"+this._id+"e-pdf-viewer"),"keydown",this._keyboardShortcutFind)},_unLoad:function(){var t,i,o;for(null!=this._ajaxRequestState&&(this._ajaxRequestState.abort(),this._ajaxRequestState=null),t=this,0!=this.pageCount&&e.ajax({type:"POST",url:this.model.serviceUrl+"/"+this.model.serverActionSettings.unload,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",traditional:!0,error:function(e){t._raiseClientEvent("ajaxRequestFailure",e.responseText)}}),e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(" / 0"),e("#"+this._id+"_txtpageNo").val(0),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_fitPage"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_zoomin"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_zoomout"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_zoom"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_Print"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_download"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_search"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_underline"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_signature"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_select"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_scroll"),(i=e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList"))._selectItemByIndex(0),i.disable(),clearTimeout(this._scrollTimer),o=this._canvascount;o>=1;)e("#"+this._id+"pageDiv_"+o).remove(),e("#"+this._id+"selectioncanvas_"+o).remove(),o--;this._renderedCanvasList&&(this._renderedCanvasList.length=0),this._rerenderCanvasList&&(this._rerenderCanvasList.length=0),this._pageContents&&(this._pageContents=null),this._currentPage=1,this._totalPages=0,this._showloadingIndicator(!1),this._showPageLoadingIndicator(!1),this._raiseClientEvent("documentUnload",null)},_destroy:function(){var t,i;for(this._isDestroyed=!0,e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(" / 0"),e("#"+this._id+"_txtpageNo").val(0),clearTimeout(this._scrollTimer),this._unwireEvents(),t=this._canvascount;t>=1;)e("#"+this._id+"pageDiv_"+t).remove(),e("#"+this._id+"selectioncanvas_"+t).remove(),t--;e("#"+this._id+"_PropertiesDialogTab").data("ejTab")._destroy(),e("#"+this._id+"_signatureContainerDialogTab").data("ejDialog")._destroy(),e("#"+this._id+"_pdfviewer_colorpicker").data("ejColorPicker")._destroy(),e("#"+this._id+"_colorpicker").data("ejColorPicker")._destroy(),e("#"+this._id+"_containerDialogTab").data("ejDialog")._destroy(),e("#"+this._id+"_pdfviewer_colorpicker_Presets").parent().remove(),e("#"+this._id+"_signatureContainerDialogTab").remove(),e("#"+this._id+"_containerDialogTab").remove(),e("#"+this._id+"_pageviewContainer").remove(),e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList")._destroy(),e("#"+this._id+"_pdfviewer_searchbox").data("ejToolbar")._destroy(),this._toolbar._destroy(),e("#"+this._id+"_toolbarContainer").remove(),e("#"+this._id+"_viewerContainer").remove(),e("#"+this._id+"_viewBlockContainer").remove(),e("#"+this._id+"_rptTooltip").remove(),e("#"+this._id+"_loadingIndicator_WaitingPopup").remove(),e("#"+this._id+"_viewerContainer_WaitingPopup").remove(),e("#"+this._id+"_WaitingPopup").remove(),e(this.element).find(".e-pdfviewer-viewer").remove(),this.element.html(""),(i=e(this.element).clone()).removeClass("e-pdfviewer e-js"),this.element.replaceWith(i),this._renderedCanvasList.length=0,this._raiseClientEvent("destroy",null)},_renderToolTip:function(){var e=t.buildTag("div.e-pdfviewer-tbdiv e-pdfviewer-tooltip","",{display:"none","min-width":"200px",width:""},{id:this._id+"_rptTooltip"}),i=t.buildTag("span.e-pdfviewer-headerspan","",{display:"block"},{id:this._id+"_rptTooltip_Header"}),o=t.buildTag("span.e-pdfviewer-contentspan","",{display:"block"},{id:this._id+"_rptTooltip_Content"});return e.append(i),e.append(o),e},_renderToolBar:function(i){var o,n,s,a,r,l,d,h,_,c,p,g;this.model.toolbarSettings.templateId?(g=document.getElementById(this.model.toolbarSettings.templateId),i.append(g),g.ejToolbar({enableSeparator:!0,height:g.height(),click:this.model.toolbarSettings.click,isResponsive:!0}),g.css("display","block")):(o=t.buildTag("div.e-pdfviewer-toolbarcontainer .e-pdfviewer-viewer","",{width:"100%"},{id:this._id+"_toolbarContainer"}),i.append(o),this._isDevice?(n=t.buildTag("ul.e-pdfviewer-toolbarul","",{}),this._appendToolbarItems(n,"zoomin"),this._appendToolbarItems(n,"zoomout"),this._appendToolbarItems(n,"fitWidth"),this._appendToolbarItems(n,"fitPage"),o.append(n)):(s=t.buildTag("ul.e-pdfviewer-toolbarul","",{"padding-right":"10px"},{}),this._appendToolbarItems(s,"gotoprevious"),this._appendToolbarItems(s,"gotonext"),this._appendToolbarItems(s,"gotopage"),o.append(s),a=t.buildTag("ul.e-pdfviewer-toolbarul","",{"padding-right":"10px"},{id:this._id+"_pdfviewer_zoomul"}),this._appendToolbarItems(a,"zoomin"),this._appendToolbarItems(a,"zoomout"),this._appendToolbarItems(a,"zoom"),this._appendToolbarItems(a,"fitWidth"),this._appendToolbarItems(a,"fitPage"),o.append(a),r=t.buildTag("ul.e-pdfviewer-toolbarul","",{"padding-right":"10px"},{id:this._id+"_pdfviewer_textmarkupul"}),this._appendToolbarItems(r,"underline"),this._appendToolbarItems(r,"strikeout"),this._appendToolbarItems(r,"highlight"),o.append(r),l=t.buildTag("ul.e-pdfviewer-toolbarul","",{"padding-right":"10px"},{id:this._id+"_pdfviewer_signatureul"}),this._appendToolbarItems(l,"signature"),o.append(l),d=t.buildTag("ul.e-pdfviewer-toolbarul","",{"padding-right":"10px"},{id:this._id+"_pdfviewer_selectul"}),this._appendToolbarItems(d,"selection"),this._appendToolbarItems(d,"scrolling"),o.append(d),h=t.buildTag("ul.e-pdfviewer-toolbarul","",{float:"right"},{id:this._id+"_pdfviewer_downloadul"}),this._appendToolbarItems(h,"download"),o.append(h),_=t.buildTag("ul.e-pdfviewer-toolbarul","",{float:"right"},{id:this._id+"_pdfviewer_printul"}),this._appendToolbarItems(_,"print"),o.append(_),c=t.buildTag("ul.e-pdfviewer-toolbarul","",{float:"right"},{id:this._id+"_pdfviewer_searchul"}),this._appendToolbarItems(c,"search"),o.append(c),e("#"+this._id+"_toolbar_zoomSelection").ejDropDownList({height:"27px",width:"75px",cssClass:"e-pdfviewer-ddl",change:this._zoomValChange,selectedItem:0}),(p=e("#"+this._id+"_toolbar_zoomSelection_hidden"))&&e(p).attr("aria-label","zoomselection hidden")),o.ejToolbar({enableSeparator:!this._isDevice,click:e.proxy(this._toolbarClick,this),itemHover:e.proxy(this._toolbarHover,this),isResponsive:!0,overflowClose:e.proxy(this._overflowToolbarClose,this)}),this._toolbar=e("#"+this._id+"_toolbarContainer").data("ejToolbar"),e("#"+this._id+"_toolbarContainer_hiddenlist").removeClass("e-responsive-toolbar").addClass("e-pdfviewer e-pdfviewer-responsivesecondarytoolbar"),e("#"+this._id+"_pdfviewer_searchul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_printul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_signatureul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_selectul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_downloadul").removeClass("e-separator"),e("#"+this._id+"_toolbarContainer_hiddenlist").removeClass("e-toolbarspan"))},_appendToolbarItems:function(e,i){var o,n,s,a,r,l,d,h,_,c,p,g,u;t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default;switch(i){case"print":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_Print"}),n=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-print","",{},{id:this._id+"_toolbar_Print"}),o.append(n);break;case"download":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_download"}),s=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-download","",{},{id:this._id+"_toolbar_download"}),o.append(s);break;case"gotofirst":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_gotofirst"}),a=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-gotofirst","",{}),o.append(a);break;case"gotolast":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_gotolast"}),r=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-gotolast","",{}),o.append(r);break;case"gotonext":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_gotonext"}),l=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-gotonext","",{}),o.append(l);break;case"gotoprevious":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_gotoprevious"}),d=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-gotoprevious","",{}),o.append(d);break;case"gotopage":o=t.buildTag("li.e-pdfviewer-toolbarli-label","",{},{id:this._id+"_pdfviewer_toolbar_pageli"});var f=t.buildTag("div.e-pdfviewer-tbpage","",{display:"block",overflow:"visible"},{}),m=t.buildTag("input.e-pdfviewer-pagenumber e-pdfviewer-elementalignments ejinputtext","",{},{type:"text",value:"0",id:this._id+"_txtpageNo","data-role":"none","aria-label":"pageNo"}),v=t.buildTag("span.e-pdfviewer-labelpageno","",{},{});f.append(m),f.append(v),o.append(f);break;case"zoomin":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_zoomin"}),h=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-zoomin","",{},{id:this._id+"_toolbar_zoomin"}),o.append(h);break;case"zoomout":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_zoomout"}),_=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-zoomout","",{},{id:this._id+"_toolbar_zoomout"}),o.append(_);break;case"zoom":o=t.buildTag("li.e-pdfviewer-toolbarli-label","",{},{id:this._id+"_pdfviewer_toolbar_zoomli"});f=t.buildTag("div.e-pdfviewer-ejdropdownlist","",{},{id:this._id+"_pdfviewer_toolbar_zoom"});var w=t.buildTag("select.e-pdfviewer-tbdiv e-pdfviewer-zoomlist","",{},{id:this._id+"_toolbar_zoomSelection","data-role":"none","aria-label":"zoomSelection"}),x=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.auto.contentText;w.append("<option Selected>"+x+"</option>"),w.append("<option>50%</option>"),w.append("<option>75%</option>"),w.append("<option>100%</option>"),w.append("<option>125%</option>"),w.append("<option>150%</option>"),w.append("<option>200%</option>"),w.append("<option>400%</option>"),f.append(w),o.append(f);break;case"fitWidth":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_fitWidth"}),c=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-fitwidth","",{},{id:this._id+"_fitWidth"}),o.append(c);break;case"fitPage":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_fitPage"}),p=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-fitpage","",{},{id:this._id+"_fitPage"}),o.append(p);break;case"search":o=t.buildTag("li.e-pdfviewer-toolbarli","",{},{id:this._id+"_pdfviewer_toolbar_search"}),g=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-find","",{},{id:this._id+"_find"}),o.append(g);break;case"highlight":o=t.buildTag("li.e-pdfviewer-toolbarli e-pdfviewer-toolbar-highlight","",{},{id:this._id+"_pdfviewer_toolbar_highlight"});var b=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-highlight-markup","",{},{id:this._id+"_highlight_markup"}),y=t.buildTag("span.e-pdfviewer-dropdown-wrapper","",{},{id:this._id+"_highlight_dropdown"}),P=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-dropdown-arrow","",{},{id:this._id+"_highlight_dropdown_arrow"});y.append(P),o.append(b),o.append(y);break;case"underline":o=t.buildTag("li.e-pdfviewer-toolbarli e-pdfviewer-toolbar-underline","",{},{id:this._id+"_pdfviewer_toolbar_underline"});var C=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-underline-markup","",{},{id:this._id+"_underline_markup"});y=t.buildTag("span.e-pdfviewer-dropdown-wrapper","",{},{id:this._id+"_underline_dropdown"}),P=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-dropdown-arrow","",{},{id:this._id+"_underline_dropdown_arrow"});y.append(P),o.append(C),o.append(y);break;case"strikeout":o=t.buildTag("li.e-pdfviewer-toolbarli e-pdfviewer-toolbar-strikeout","",{},{id:this._id+"_pdfviewer_toolbar_strikeout"});var S=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-strikeout-markup","",{},{id:this._id+"_strikeout_markup"});y=t.buildTag("span.e-pdfviewer-dropdown-wrapper","",{},{id:this._id+"_strikeout_dropdown"}),P=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-dropdown-arrow","",{},{id:this._id+"_strikeout_dropdown_arrow"});y.append(P),o.append(S),o.append(y);break;case"signature":o=t.buildTag("li.e-pdfviewer-toolbarli e-pdfviewer-toolbar-sign","",{},{id:this._id+"_pdfviewer_toolbar_signature"}),u=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-sign","",{},{id:this._id+"_sign"}),o.append(u);break;case"selection":o=t.buildTag("li.e-pdfviewer-toolbarli e-pdfviewer-toolbar-select","",{},{id:this._id+"_pdfviewer_toolbar_select"}),u=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-select","",{},{id:this._id+"_select"}),o.append(u);break;case"scrolling":o=t.buildTag("li.e-pdfviewer-toolbarli e-pdfviewer-toolbar-scroll","",{},{id:this._id+"_pdfviewer_toolbar_scroll"}),u=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-scroll","",{},{id:this._id+"_scroll"}),o.append(u)}e.append(o)},_renderViewerBlockinWeb:function(e){var i=t.buildTag("div.e-pdfviewer-viewer e-pdfviewer-viewerblock","",{},{id:this._id+"_viewBlockContainer"});e.append(i);var o=t.buildTag("table.e-pdfviewer-viewerblockcellcontent","",{margin:"1px",padding:"5px 5px 10px"}),n=t.buildTag("tr","",{width:"100%"}),s=t.buildTag("td.e-pdfviewer-viewerblockcontent","",{});return n.append(s),o.append(n),i.append(o),i},_renderViewerContainer:function(e){var i=t.buildTag("div","",{},{id:this._id+"_pdfviewerContainer"});e.append(i);var o=t.buildTag("div.e-pdfviewer-viewer e-pdfviewer-scrollcontainer e-pdfviewer-viewercontainer","",{height:"100%",width:"100%","font-size":"8pt"},{id:this._id+"_viewerContainer"}),n=t.buildTag("div","",{margin:"0px",height:"99.8%",width:"100%"},{id:this._id+"_loadingIndicator"}),s=t.buildTag("div","",{margin:"0px",height:"99.8%",width:"100%","background-color":"rgba(164, 183, 216, 0.18)",display:"block"},{id:this._id+"_loadingIndicatorBackView"}),a=t.buildTag("div","",{},{id:this._id+"_pageviewContainer"});return n.append(s),o.append(n),o.append(a),this._isDevice&&this._renderViewerBlockinDevice(o),i.append(o),i},_renderViewer:function(){var e,i=this.element.height(),o=this.element.width(),n=t.buildTag("div.e-pdfviewer-viewer","",{},{id:this._id+"e-pdf-viewer"});this.element[0].style.height||0==this.element[0].parentElement.clientHeight||(this._isHeight=!0),this.element[0].style.width||0==this.element[0].parentElement.clientWidth||(this._isWidth=!0),0===i&&0!=this.element[0].parentElement.clientHeight&&this.element.height(this.element[0].parentElement.clientHeight),0===o&&0!=this.element[0].parentElement.clientWidth&&this.element.width(this.element[0].parentElement.clientWidth),this.element.append(n),this._renderToolBar(n),this._toolbarResizeHandler(),this._isDevice||(this._renderViewerBlockinWeb(n),e=this._renderToolTip()),this._renderViewerContainer(n).append(e),this._renderSearchBox()},_renderSearchBox:function(){var i,o,n,s=t.buildTag("div.e-pdfviewer-searchbox e-pdfviewer-arrow","",{},{id:this._id+"_pdfviewer_searchbox"}),a=t.buildTag("ul.e-pdfviewer-toolbarul-search","",{});s.append(a);var r=t.buildTag("li.e-pdfviewer-toolbarli-label","",{},{}),l=t.buildTag("div.e-pdfviewer-searchboxitem e-pdfviewer-search-inputcontainer","",{},{}),d=t.buildTag("span.e-pdfviewer-label e-pdfviewer-searchboxitem","Find : ",{float:"left","padding-top":"1px","margin-right":"5px",width:"32px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},{id:this._id+"_pdfviewer_findlabel"}),h=t.buildTag("input.e-pdfviewer-searchinput e-pdfviewer-elementalignments ejinputtext","",{width:"150px"},{id:this._id+"_pdfviewer_searchinput","aria-label":"search input"});l.append(d),l.append(h),r.append(l);var _=t.buildTag("li.e-pdfviewer-toolbarli-search e-pdfviewer-search-previous","",{float:"left"},{id:this._id+"_pdfviewer_previous_search"}),c=t.buildTag("li.e-pdfviewer-toolbarli-search e-pdfviewer-search-next","",{float:"left"},{id:this._id+"_pdfviewer_next_search"}),p=t.buildTag("li.e-pdfviewer-toolbarli-search e-pdfviewer-search-close","",{float:"left","margin-left":"4px"},{id:this._id+"_pdfviewer_close_search"}),g=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-prevfind","",{},{id:this._id+"_prevfind"});_.append(g),e(_).css({"pointer-events":"none",opacity:"0.6"}),e(c).css({"pointer-events":"none",opacity:"0.6"}),i=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-nextfind","",{},{id:this._id+"_nextfind"}),c.append(i);var u=t.buildTag("li.e-pdfviewer-toolbarli-label","",{},{}),f=t.buildTag("div.e-pdfviewer-searchboxitem e-pdfviewer-search-checkboxcontainer","",{float:"left",overflow:"visible"},{}),m=t.buildTag("input","",{},{type:"checkbox","aria-label":"search matchcase"}),v=t.buildTag("span.e-pdfviewer-label e-pdfviewer-searchboxitem","Match case",{float:"left","padding-top":"3px","margin-left":"5px","margin-top":"4px",width:"70.5px",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap"},{id:this._id+"_pdfviewer_matchlabel"});f.append(m),f.append(v),u.append(f),o=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-closefind","",{},{id:this._id+"_closefind"}),p.append(o),a.append(r),a.append(_),a.append(c),a.append(u),a.append(p),s.ejToolbar({enableSeparator:!1,isResponsive:!1,width:"400px",hide:!0,itemHover:e.proxy(this._toolbarHover,this)}),m.ejCheckBox({cssClass:"e-pdfviewer-match-checkbox",id:this._id+"_search_matchcase",size:t.CheckboxSize.Medium,change:e.proxy(this._matchcase,this)}),m.ejCheckBox("disable"),e("#"+this._id+"_pdfviewerContainer").append(s),(n=e("#"+this._id+"_search_matchcase_hidden"))&&e(n).attr("aria-label","search hidden matchcase")},_createColorPalette:function(){var i=t.buildTag("div.e-pdfviewer-colorpicker","",{},{id:this._id+"_pdfviewer_colorpicker"});e("#"+this._id+"_pdfviewerContainer").append(i),i.ejColorPicker({displayInline:!0,modelType:"palette",change:e.proxy(this._setDrawColor,this)}),this._toolbarColorpickerObject=i.data("ejColorPicker")},_setContainerSize:function(){var t,i,o,n,s,a=document.getElementById(this._id);a&&(0==(t=a.clientHeight)&&(this._isControlHided=!0,t=parseFloat(a.style.height),i=parseFloat(a.style.width),e("#"+this._id+"_viewerContainer").css({width:i+"px"})),o=0,this._isDevice||"block"==(n=e("#"+this._id+"_viewBlockContainer")).css("display").toLowerCase()&&(o=n.height()),s=t-o-(this.model.toolbarSettings.templateId?e("#"+this.model.toolbarSettings.templateId).height():e("#"+this._id+"_toolbarContainer").height())-4,e("#"+this._id+"_viewerContainer").css({height:s+"px"}))},_setPageSize:function(t,i,o){e("#"+this._id+"_pageviewContainer")[0].getBoundingClientRect();var n=this;this._renderPreviousPage=!1,e("#"+this._id+"_viewerContainer").unbind("scroll").on("scroll",function(){n._computeCurrentPage(t)}),e("#"+this._id+"_pageviewContainer").mouseup(function(e){n._raiseClientEvent("pageClick",e)}),this._scrollTimer=setInterval(function(){n._pageviewscrollchanged(t)},500),n._backgroundPage=1,this._previousZoom=1,n._previousPage=n._currentPage,this._canvascount=this._totalPages,this.model.allowClientBuffering||(this._pageLocation=[],this._renderedCanvasList=[],this._pageContents=[],this._pageText=[],this._textDivs=[],this._textContents=[],this._searchMatches=[],this._searchCollection=[],this._pageLocation[1]=0,this._searchedPages=[],this._pointers=[],this._imageObj=[],this._pagesGot=[],this._imageSrcCollection=[],this._selectionPages=[]),this._designPageCanvas()},_designPageCanvas:function(){var i,o,n,s,a,r=5,l=e("#"+this._id+"_pageviewContainer"),d=e("#"+this._id+"_viewerContainer"),h=(e("#"+this._id+"_pageviewOuterline"),d.width()),_=(d.height(),this._pageWidth),c=(this._pageHeight,1);for(c=(h-25)/_,c=Math.min(1,c),this._zoomVal=c,i=1;i<=this._totalPages;i++){(o=90==this._pageSize[i-1].PageRotation||270==this._pageSize[i-1].PageRotation?(this.element.width()-this._pageSize[i-1].PageHeight)/2:(this.element.width()-this._pageSize[i-1].PageWidth)/2)<0&&(o=5),n=t.buildTag("div","",{},{id:this._id+"pageDiv_"+i}),l.append(n),n.css("position","absolute"),n.css("top",this._zoomVal*r),n.css("left",o+"px"),this._pageLocation[i]=r;var p=document.createElement("canvas");p.id=this._id+"_secondarycanvas_"+i,p.className="e-pdfviewer-secondarycanvas",p.style.position="absolute",p.style.left=0,p.style.top=0,p.style.backgroundColor="transparent",n.append(p),this,(s=document.createElement("canvas")).id=this._id+"pagecanvas_"+i,s.className="e-pdfviewer-pageCanvas",90==this._pageSize[i-1].PageRotation||270==this._pageSize[i-1].PageRotation?(s.width=this._zoomVal*this._pageSize[i-1].PageHeight,s.height=this._zoomVal*this._pageSize[i-1].PageWidth,s.style.height=this._zoomVal*this._pageSize[i-1].PageWidth+"px",s.style.width=this._zoomVal*this._pageSize[i-1].PageHeight+"px"):(s.style.height=this._zoomVal*this._pageSize[i-1].PageHeight+"px",s.style.width=this._zoomVal*this._pageSize[i-1].PageWidth+"px",s.height=this._zoomVal*this._pageSize[i-1].PageHeight,s.width=this._zoomVal*this._pageSize[i-1].PageWidth),s.style.backgroundColor="white",n.append(s),p.height=s.height,p.width=s.width,p.style.height=s.height+"px",p.style.width=s.width+"px",(a=document.createElement("div")).id=this._id+"selectioncanvas_"+i,a.className="e-pdfviewer-selectiondiv",a.style.height=s.height+"px",a.style.width=s.width+"px",a.style.position="absolute",a.style.left=0,a.style.top=0,a.style.backgroundColor="transparent",a.style.zIndex="2",a.style.overflow="hidden",n.append(a),this._isControlHided||(e("#"+this._id+"pageDiv_"+i).ejWaitingPopup({showOnInit:!0,appendTo:"#"+this._id+"pageDiv_"+i,target:"#"+this._id+"pageDiv_"+i}),e("#"+this._id+"pageDiv_"+i+"_WaitingPopup").appendTo(e("#"+this._id+"pageDiv_"+i)).css({left:"0px",top:"0px","background-color":"#dbdbdb"})),r=90==this._pageSize[i-1].PageRotation||270==this._pageSize[i-1].PageRotation?parseFloat(r)+parseFloat(this._pageSize[i-1].PageWidth)+8:parseFloat(r)+parseFloat(this._pageSize[i-1].PageHeight)+8}this._cummulativeHeight=r,this._isControlHided=!1},_computeCurrentPage:function(){var t,i,n,s=0,a=0,r=document.getElementById(this._id+"_viewerContainer"),l=r.scrollTop;1!=this._zoomVal&&(l+=this._currentPage*(8-8*this._zoomVal));var d,h,_={currentPageNumber:0};for(t=0;t<this._totalPages;t++){if(this._isDestroyed)return;if(s>l&&l>=0){if(a=t,i=document.getElementById(this._id+"_viewerContainer"),(n=e("#"+this._id+"pageDiv_"+a)[0])!=o&&null!=n){var c=n.getBoundingClientRect().bottom,p=e("#"+this._id+"e-pdf-viewer")[0],g=parseInt(p.getBoundingClientRect().height),u=this.model.toolbarSettings.templateId?e("#"+this.model.toolbarSettings.templateId).height():e("#"+this._id+"_toolbarContainer").height(),f=g-(parseInt(e(i).css("height"))-u),m=parseFloat(s)-parseFloat(l),v=r.clientHeight,w=r.clientHeight-m;r.clientHeight<this._pageSize[t-1].PageHeight*this._zoomVal+this._pageSize[t].PageHeight*this._zoomVal&&parseInt(this._pageLocation[t]*this._zoomVal)<i.scrollTop?w>m&&c<=290+f&&(a=parseFloat(a)+1,e("#"+this._id+"pageDiv_"+a).css("visibility",""),this._renderPreviousPage=!0):"Landscape"==this._pageSize[t-1].PageOrientation&&i.scrollTop>parseInt(this._pageLocation[t]*this._zoomVal)&&v<=600&&(a=parseFloat(a)+1,e("#"+this._id+"pageDiv_"+a).css("visibility",""),this._renderPreviousPage=!0),this._renderPreviousPage=!1;break}}else s=90==this._pageSize[t].PageRotation||270==this._pageSize[t].PageRotation?parseFloat(s)+parseFloat(this._pageSize[t].PageWidth*this._zoomVal)+8:parseFloat(s)+parseFloat(this._pageSize[t].PageHeight*this._zoomVal)+8;a=l>=0?t+1:1}if("fitToPage"==this._fitType){var x=parseFloat(e("#"+this._id+"pageDiv_"+a).css("height")),b=this._pageLocation[a]*this._zoomVal,y=(parseFloat(e(i).css("height"))-x)/2;e("#"+this._id+"pageDiv_"+a).css("top",b+y+"px"),e("#"+this._id+"pageDiv_"+(a+1)).css("visibility","hidden"),e("#"+this._id+"pageDiv_"+(a-1)).css("visibility","hidden")}e("#"+this._id+"pageDiv_"+a).css("visibility",""),e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(" / "+this._totalPages),d=document.getElementById(this._id+"_txtpageNo").value,e("#"+this._id+"_txtpageNo").val(a),this._updatePageNavigation(a,this._totalPages),h=document.getElementById(this._id+"_txtpageNo").value,_.currentPageNumber=h,this._currentPage=a,this.currentPageNumber=this._currentPage,d!=h&&this._raiseClientEvent("pageChange",_)},_pageviewscrollchanged:function(){var i,n,s,a,r,l,d,h=0,_=e("#"+this._id+"_viewerContainer").scrollTop();this._isTargetPage&&this.model.allowClientBuffering&&this.model.bufferingMode==t.PdfViewer.BufferingMode.Default&&(this._isTargetPage=!1,this._isBuffering=!0,this._targetPage<=this._totalPages&&(this._isBufferStart||(this._raiseClientEvent("bufferStart",this._isBuffering),this._isBufferStart=!0),i={viewerAction:this._viewerAction.getPageModel,id:this._fileId,pageindex:this._targetPage.toString(),enableOfflineMode:!0,bufferingMode:"default",isPageScrolled:!1},d=this,this._ajaxRequestState=e.ajax({type:"POST",url:this.model.serviceUrl+"/"+this.model.serverActionSettings.load,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:JSON.stringify(i),traditional:!0,success:function(e){var t,i,n,s;if(jsondata="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(e),jsondata=jsondata.pdf,t=0,i=!1,jsondata){for(s=d._targetPage;s<=d._totalPages;s++){if(!(n=jsondata[s])){i=!0;break}d._pageContents[parseInt(n.currentpage)]=JSON.stringify(n),d._pageText[parseInt(n.currentpage)]=n.pageContents,d._pagesGot.push(parseInt(n.currentpage)),t++}if(n==o&&!i)for(s=d._targetPage;s<=d._totalPages;s++)d._pagesGot.indexOf(s)&&t++;d._targetPage=t?d._targetPage+t:d._targetPage,d._targetPage>=d._totalPages&&(d._raiseClientEvent("bufferEnd",this._isBuffering),d._isBufferStart=!1),d._isTargetPage=!0,d._isBuffering=!1}},error:function(){}}))),_==this._previousPosition&&(h=this._currentPage,this._totalPages&&this._previousPage!=h&&(n=parseInt(h),this._previousPage=h,n>=1&&n<=this._totalPages&&(this._isJsondataAvailable?(e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(" / "+this._totalPages),e("#"+this._id+"_txtpageNo").val(n)):(this._showloadingIndicator(!0),e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(""),e("#"+this._id+"_txtpageNo").val("0")),this._currentPage=n,this._updatePageNavigation(this._currentPage,this._totalPages),-1!=this._renderedCanvasList.indexOf(parseInt(this._currentPage))||this._scrollTriggered&&!this.model.allowClientBuffering||this._pageContents[parseInt(this._currentPage)]||this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=this._currentPage.toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r})))))),-1==this._renderedCanvasList.indexOf(parseInt(this._currentPage))&&(!this._scrollTriggered||this.model.allowClientBuffering)&&this._currentPage<=this._totalPages&&(this._pageContents[parseInt(this._currentPage)]?(l=this._pageContents[parseInt(this._currentPage)],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=this._currentPage.toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r})))),s=parseInt(this._currentPage)+1,this.model.allowClientBuffering?this._renderPreviousPage?-1==this._renderedCanvasList.indexOf(parseInt(this._currentPage)-1)&&(!this._scrollTriggered||this.model.allowClientBuffering)&&parseInt(this._currentPage)-1>0?this._pageContents[parseInt(this._currentPage)-1]?(l=this._pageContents[parseInt(this._currentPage)-1],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=(parseInt(this._currentPage)-1).toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this.model.allowClientBuffering&&(r.isPageScrolled=!0),this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r}))):-1==this._renderedCanvasList.indexOf(parseInt(s))&&(!this._scrollTriggered||this.model.allowClientBuffering)&&s<=this._totalPages&&(this._pageContents[parseInt(s)]?(l=this._pageContents[parseInt(s)],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=s.toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this.model.allowClientBuffering&&(r.isPageScrolled=!0),this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r})))):-1==this._renderedCanvasList.indexOf(parseInt(this._currentPage)-1)&&(!this._scrollTriggered||this.model.allowClientBuffering)&&parseInt(this._currentPage)-1>0?this._pageContents[parseInt(this._currentPage)-1]?(l=this._pageContents[parseInt(this._currentPage)-1],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=(parseInt(this._currentPage)-1).toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this.model.allowClientBuffering&&(r.isPageScrolled=!0),this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r}))):-1==this._renderedCanvasList.indexOf(parseInt(s))&&(!this._scrollTriggered||this.model.allowClientBuffering)&&s<=this._totalPages&&(this._pageContents[parseInt(s)]?(l=this._pageContents[parseInt(s)],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=s.toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this.model.allowClientBuffering&&(a=!0,this._isPrintingProcess||(r.isPageScrolled=!1)),this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r),a):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r})))):this._renderPreviousPage?-1==this._renderedCanvasList.indexOf(parseInt(this._currentPage)-1)&&(!this._scrollTriggered||this.model.allowClientBuffering)&&parseInt(this._currentPage)-1>0?this._pageContents[parseInt(this._currentPage)-1]?(l=this._pageContents[parseInt(this._currentPage)-1],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=(parseInt(this._currentPage)-1).toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r}))):-1==this._renderedCanvasList.indexOf(parseInt(s))&&(!this._scrollTriggered||this.model.allowClientBuffering)&&s<=this._totalPages&&(this._pageContents[parseInt(s)]?(l=this._pageContents[parseInt(s)],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=s.toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r})))):-1==this._renderedCanvasList.indexOf(parseInt(s))&&(!this._scrollTriggered||this.model.allowClientBuffering)&&s<=this._totalPages?this._pageContents[parseInt(s)]?(l=this._pageContents[parseInt(s)],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=s.toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r}))):-1==this._renderedCanvasList.indexOf(parseInt(this._currentPage)-1)&&(!this._scrollTriggered||this.model.allowClientBuffering)&&parseInt(this._currentPage)-1>0&&(this._pageContents[parseInt(this._currentPage)-1]?(l=this._pageContents[parseInt(this._currentPage)-1],this._drawPdfPage(l)):this._scrollTriggered||(this._scrollTriggered=!0,(r={}).viewerAction=this._viewerAction.getPageModel,r.pageindex=(parseInt(this._currentPage)-1).toString(),r.id=this._fileId,r.zoomValue=this._zoomVal,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostscroll("POST",this._actionUrl,JSON.stringify(r)):this._doAjaxPostscroll("POST",this.model.serviceUrl,JSON.stringify({jsonResult:r})))),this._previousPosition=_,d=this,setTimeout(function(){var i;if(e(".e-pdfviewer-formFields").show(),d.model){var o=(t.PdfViewer.Locale[d.model.locale]?t.PdfViewer.Locale[d.model.locale]:t.PdfViewer.Locale.default).contextMenu.auto.contentText,n=e("#"+d._id+"_toolbar_zoomSelection").data("ejDropDownList");n&&((i=e("#"+d._id+"_toolbar_zoomSelection_hidden").val())!=o&&(e("#"+d._id+"_toolbar_zoomSelection_popup li")[0].innerHTML=o,0==n.selectedIndex()&&isNaN(parseFloat(i))&&(e("#"+d._id+"_toolbar_zoomSelection_hidden").val(o),d._ejDropDownInstance.model.value=o),d._searchBoxLocalization()))}null==d._selectionRange||d._displaySearch||(d._selectionNodes.addRange(d._selectionRange),d._selectionRange=null,d._selectionNodes=null)},5e3)},_doAjaxPostscroll:function(i,o,n,s){var a=this;null!=this._ajaxRequestState&&(this._ajaxRequestState.abort(),this._ajaxRequestState=null),this._ajaxInProgress=!0,this._ajaxState=e.ajax({type:i,url:o,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:n,traditional:!0,success:function(e){var i,o;a._ajaxInProgress=!1,e=a._ajaxResponseData(e),a._scrollTriggered=!1,"object"==typeof e?a._drawPdfPage(JSON.stringify(e)):a._drawPdfPage(e),a._searchText&&a._isRequestFired&&(i="object"==typeof e?JSON.stringify(e):e,jsondata="object"==typeof e?a._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(e).d):a._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(e):JSON.parse(e.d),a._pageContents[parseInt(jsondata.currentpage)]=i,a._pageText[parseInt(jsondata.currentpage)]=jsondata.pageContents,a._searchText&&a._isRequestFired&&a._initSearch(a._searchPageIndex)),s&&a.model.allowClientBuffering&&(o="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(e),a._pagesGot.push(parseInt(o.currentpage)),parseInt(o.currentpage)<=a._totalPages&&(a._targetPage=o.currentpage+1,a._isTargetPage=!0))},error:function(e){0!=e.readyState&&a._raiseClientEvent("ajaxRequestFailure",e.responseText)}})},_drawPdfPage:function(i){var n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w,x,b=i;if(i=this._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(i):JSON.parse(i.d),this._renderedCanvasList.push(parseInt(i.currentpage)),n=parseInt(i.currentpage),this._isWindowResizing||this._showPageLoadingIndicator(n,!0),s=i.imagestream,(a=document.getElementById(this._id+"pagecanvas_"+parseInt(i.currentpage)))&&this.model){if(he=a.getContext("2d"),_e=this._scalingTextContent(he),90==this._pageSize[n-1].PageRotation||this._pageSize[n-1].PageRotation,a.width=this._zoomVal*this._pageSize[n-1].PageWidth*_e,a.height=this._zoomVal*this._pageSize[n-1].PageHeight*_e,a.style.height=this._zoomVal*this._pageSize[n-1].PageHeight+"px",a.style.width=this._zoomVal*this._pageSize[n-1].PageWidth+"px",this._pageContents[parseInt(i.currentpage)]=b,this._pageText[parseInt(i.currentpage)]=i.pageContents,this._imageObj=[],e("#"+this._id+"selectioncanvas_"+n).hasClass("text_container")?this._resizeSelection(i,n,he):(this._textSelection(i,n,he),this._textMarkupAnnotationList[parseInt(i.currentpage)]=i.textMarkupAnnotation,this._textMarkupAnnotationList[parseInt(i.currentpage)]&&(this._totalAnnotations[n]=i.textMarkupAnnotation.slice())),e("#"+this._id+"selectioncanvas_"+n).hasClass("input_container")?this._generateFormFields(i,n):this._createFormFields(i,n),-1!=navigator.userAgent.indexOf("Firefox"))for(k=s.textelements,r=0;r<k.length;r++)if(ne=(U=k[r]).textureBrushs){var y="data:image/png;base64,"+U.texturFields[0].Image;(le=new Image).src=y,this._imageSrcCollection.push(le.src)}for(this._isTextSearch&&(W=this,setTimeout(function(){W._isPageScrollHighlight=!0,W._isPageScrolledForSearch=!0,W._highlightOtherOccurrences()},100)),l=e("#"+this._id+"selectioncanvas_"+n).children(),g=0;g<l.length;g++)l[g].hasAttribute("href")&&e(l[g]).remove();var P=i.linkannotation,C=i.annotpagenum,S=this;if(this.model.enableHyperlink)for(d=0;d<P.length;d++){if((h=document.createElement("a")).id="linkdiv_"+d,_=P[d].AnnotRectangle,h.style.background="transparent",h.style.position="absolute",h.style.left=this._convertPointToPixel(_.Left*this._zoomVal)+"px",h.style.top=this._convertPointToPixel(_.Top*this._zoomVal)+"px",h.style.width=this._convertPointToPixel(_.Width*this._zoomVal)+"px",h.style.height=this._convertPointToPixel(_.Height*this._zoomVal)+"px",h.style.color="transparent",-1!=P[d].URI.indexOf("mailto:")?(c=P[d].URI.substring(P[d].URI.indexOf("mailto:"),P[d].URI.length),h.title=c,h.setAttribute("href",c)):(h.title=P[d].URI,h.setAttribute("href",P[d].URI)),this.model.hyperlinkOpenState==t.PdfViewer.LinkTarget.Default?(h.target="_self",h.onclick=function(){var e={hyperlink:this.href};S._raiseClientEvent("hyperlinkClick",e)}):this.model.hyperlinkOpenState==t.PdfViewer.LinkTarget.NewTab?(h.target="_blank",h.onclick=function(){var e={hyperlink:this.href};S._raiseClientEvent("hyperlinkClick",e)}):this.model.hyperlinkOpenState==t.PdfViewer.LinkTarget.NewWindow&&(h.onclick=function(){var e={hyperlink:this.href};return S._raiseClientEvent("hyperlinkClick",e),window.open(this.href,"_blank","scrollbars=yes,resizable=yes"),!1}),C[d]!=o){var T=this._pageSize[n-1].PageHeight-this._convertPointToPixel(P[d].AnnotLocation),I=parseFloat(this._pageLocation[C[d]]*this._zoomVal)+parseFloat(T*this._zoomVal);h.name=I,h.onclick=function(){return document.getElementById(S._id+"_viewerContainer").scrollTop=this.name,!1}}document.getElementById(this._id+"selectioncanvas_"+n).appendChild(h)}this._textMarkupAnnotationList[n]&&this._renderTextMarkupAnnotation(this._textMarkupAnnotationList[n],n);var k,z=parseInt(i.currentpage),A=[],D=[],B=[],R=[],E=[],N=[],O=[],V=0,L=navigator.userAgent,M=0,F=[];if(null!=(k=s.textelements).imagedata&&i.isPdfRenderingEngine){var j=k.imagedata,H=new Image,W=this;this._ispdfium=!0,this._isContainImage=!0,H.onload=function(){W._renderImages(a,H,a.width,a.height,_e)},H.src=j[0]}for(p=0;p<k.length;p++){var U,Y=(U=k[p]).color,X=U.matrix;null!=X&&(X=X.Elements);var Z=U.brush,J=U.pathValue,G=U.iscliping,q=U.restorecanvas,K=(y=U.imagedata,U.fillrule),$=U.isFillandStroke,Q=U.fillcolor,ee=U.strokecolor,te=U.linewidth,ie=U.linecap,oe=U.linearGradientBrush,ne=U.textureBrushs,se=U.charID,ae=(U.rectvalue,U.alpha),re=U.dashPattern;if(null!=re&&re.length>0&&he.setLineDash(re),null!=J?(J=J.split(";"),se&&(F[se]=J)):null==J&&se&&(J=F[se]),0==q&&he.save(),J!=o&&he.setTransform(X[0]*this._zoomVal*_e,X[1]*this._zoomVal*_e,X[2]*this._zoomVal*_e,X[3]*this._zoomVal*_e,X[4]*this._zoomVal*_e,X[5]*this._zoomVal*_e),null!=J){for(he.beginPath(),g=0;g<J.length;g++)"M"==(f=(u=J[g])[0])?(u=(u=u.substring(1,u.length)).split(" "),he.moveTo(u[0],u[1])):"L"==f?(u=(u=u.substring(1,u.length)).split(" "),he.lineTo(u[0],u[1])):"C"==f?(u=(u=u.substring(1,u.length)).split(" "),he.bezierCurveTo(u[0],u[1],u[2],u[3],u[4],u[5])):"Z"==f&&he.closePath();1==G?("evenodd"==K&&(he.msFillRule="evenodd",he.mozFillRule="evenodd",he.clip(K)),he.clip()):$==o?"Fill"==Z?(oe!=o?he.fillStyle=this._getGradientBrush(oe,he):ne!=o?he.fillStyle=this._createTextureBrush(ne,he,U):(ae!=o&&(he.globalAlpha=ae),he.fillStyle=Y),"evenodd"==K&&(he.msFillRule="evenodd",he.mozFillRule="evenodd",he.fill(K)),he.fill()):"FillandStroke"==Z?(he.fillStyle=Y,he.fill(),he.strokeStyle=ee,he.stroke()):"Stroke"==Z?(he.strokeStyle=ee,he.lineWidth=te,he.lineCap=ie,he.stroke()):(he.strokeStyle=Y,he.lineWidth=te,he.lineCap=ie,he.stroke()):(he.strokeStyle=ee,he.lineWidth=te,he.lineCap=ie,he.stroke(),he.fillStyle=oe!=o?this._getGradientBrush(oe,he):ne!=o?this._createTextureBrush(ne,he,U):Q,"evenodd"==K&&(he.msFillRule="evenodd",he.mozFillRule="evenodd",he.fill(K)),he.fill())}if(q&&he.restore(),y!=o){if(-1!=L.indexOf("Firefox")||-1!=L.indexOf("Chrome")||-1!=L.indexOf("Safari")||-1!=L.indexOf("AppleWebKit")){A.push(y),D.push(X),E.push(k),R.push(p),this._zoomVal,this._isContainImage=!0;break}(m=new Image).src=y,he.setTransform(X[0]*this._zoomVal*_e,X[1]*this._zoomVal*_e,X[2]*this._zoomVal*_e,X[3]*this._zoomVal*_e,X[4]*this._zoomVal*_e,X[5]*this._zoomVal*_e),he.drawImage(m,0,0,1,1)}if(ne!=o){if(U=k[p],ne){var le;y="data:image/png;base64,"+U.texturFields[0].Image;(le=new Image).src=y,N.push(le.src)}D.push(X),E.push(k),R.push(p),this._zoomVal;break}}for(v=0;v<N.length;v++)this._textureBrushRendering(k,O,N,D,he,v,E,R,F,a,z,V),V++;if(-1!=L.indexOf("Firefox")||-1!=L.indexOf("Chrome")||-1!=L.indexOf("Safari")||-1!=L.indexOf("AppleWebKit"))for(w=0;w<A.length;w++)this._imageRendering(k,B,A,D,he,w,E,R,F,a,z,M),M++;if(x=a,W=this,0!=this._pageSize[z-1].PageRotation&&!this._isContainImage&&(y==o||-1==L.indexOf("Firefox"))){var de=(x=document.getElementById(this._id+"pagecanvas_"+parseInt(i.currentpage))).toDataURL(),he=x.getContext("2d"),_e=W._scalingTextContent(he),ce=new Image;ce.onload=function(){he.clearRect(0,0,x.width,x.height),90==W._pageSize[z-1].PageRotation||270==W._pageSize[z-1].PageRotation?(x.width=W._zoomVal*W._pageSize[z-1].PageHeight*_e,x.height=W._zoomVal*W._pageSize[z-1].PageWidth*_e,x.style.height=W._zoomVal*W._pageSize[z-1].PageWidth+"px",x.style.width=W._zoomVal*W._pageSize[z-1].PageHeight+"px"):(x.width=W._zoomVal*W._pageSize[z-1].PageWidth*_e,x.height=W._zoomVal*W._pageSize[z-1].PageHeight*_e,x.style.width=W._zoomVal*W._pageSize[z-1].PageWidth+"px",x.style.height=W._zoomVal*W._pageSize[z-1].PageHeight+"px"),he.save(),he.translate(x.width/2,x.height/2),he.rotate(W._pageSize[z-1].PageRotation/2*Math.PI/2),he.drawImage(ce,-ce.width/2,-ce.height/2),he.restore()},ce.src=de}return this._showPageLoadingIndicator(n,!1),this._changingImageCanvasPosition(n),this._showSignature(),x}},_renderImages:function(e,t){var i=e.getContext("2d"),o=window.innerWidth/screen.width,n=window.innerHeight/screen.height;i.drawImage(t,0,0,e.width-o,e.height-n)},_textureBrushRendering:function(e,t,i,n,s,a,r,l,d,h,_,c){var p=this._zoomVal,g=new Image,u=this;navigator.userAgent;g.onload=function(){for(var a,g,f,m,v,w,x,b=!1,y=u._scalingTextContent(s),P=0;P<n.length;P++)if(0==b){if(a=n[P],s.setTransform(a[0]*p*y,a[1]*p*y,a[2]*p*y,a[3]*p*y,a[4]*p*y,a[5]*p*y),t[c]!=o){var C=t[c],S=document.createElement("canvas"),T=S.getContext("2d");S.width=C.width,S.height=C.height,T.drawImage(C,0,0,C.width,C.height,0,0,S.width,S.height),g=s.createPattern(S,"repeat"),s.fillStyle=g,s.fill()}for(f=l[P],f+=1,m=r[P];f<m.length;){var I=m[f],k=I.color,z=I.matrix;null!=z&&(z=z.Elements);var A=I.brush,D=I.pathValue,B=I.iscliping,R=I.restorecanvas,E=I.imagedata,N=I.fillrule,O=I.isFillandStroke,V=I.fillcolor,L=I.strokecolor,M=I.linewidth,F=I.linecap,j=I.linearGradientBrush,H=I.textureBrushs,W=I.charID;I.rectvalue;if(null!=D?(D=D.split(";"),W&&(d[W]=D)):null==D&&W&&(D=d[W]),0==R&&s.save(),D!=o&&s.setTransform(z[0]*p*y,z[1]*p*y,z[2]*p*y,z[3]*p*y,z[4]*p*y,z[5]*p*y),null!=D){for(s.beginPath(),v=0;v<D.length;v++)"M"==(x=(w=D[v])[0])?(w=(w=w.substring(1,w.length)).split(" "),s.moveTo(w[0],w[1])):"L"==x?(w=(w=w.substring(1,w.length)).split(" "),s.lineTo(w[0],w[1])):"C"==x?(w=(w=w.substring(1,w.length)).split(" "),s.bezierCurveTo(w[0],w[1],w[2],w[3],w[4],w[5])):"Z"==x&&s.closePath();1==B?("evenodd"==N&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.clip(N)),s.clip()):O==o?"Fill"==A?(s.fillStyle=j!=o?u._getGradientBrush(j,s):H!=o?u._createTextureBrush(H,s,I):k,"evenodd"==N&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(N)),s.fill()):"FillandStroke"==A?(s.fillStyle=k,s.fill(),s.strokeStyle=L,s.stroke()):"Stroke"==A?(s.strokeStyle=L,s.lineWidth=M,s.lineCap=F,s.stroke()):(s.strokeStyle=k,s.lineWidth=M,s.lineCap=F,s.stroke()):(s.strokeStyle=L,s.lineWidth=M,s.lineCap=F,s.stroke(),s.fillStyle=j!=o?u._getGradientBrush(j,s):H!=o?u._createTextureBrush(H,s,I):V,"evenodd"==N&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(N)),s.fill())}if(R&&s.restore(),H!=o){b=!0,i.pop(),n.pop(),r.pop(),l.pop(),i.push(E),n.push(z),r.push(e),l.push(f),P=-1,c++;break}f++}}else u._textureBrushRendering(e,t,i,n,s,P,r,l,d,h,_,c),c++;if(f==e.length&&0!=u._pageSize[_-1].PageRotation){var U=document.getElementById(u._id+"pagecanvas_"+_),Y=U.toDataURL(),X=U.getContext("2d"),Z=new Image;Z.onload=function(){X.clearRect(0,0,U.width,U.height),90==u._pageSize[_-1].PageRotation||270==u._pageSize[_-1].PageRotation?(U.width=u._zoomVal*u._pageSize[_-1].PageHeight,U.height=u._zoomVal*u._pageSize[_-1].PageWidth,U.style.height=u._zoomVal*u._pageSize[_-1].PageWidth+"px",U.style.width=u._zoomVal*u._pageSize[_-1].PageHeight+"px"):(U.width=u._zoomVal*u._pageSize[_-1].PageWidth,U.height=u._zoomVal*u._pageSize[_-1].PageHeight,U.style.width=u._zoomVal*u._pageSize[_-1].PageWidth+"px",U.style.height=u._zoomVal*u._pageSize[_-1].PageHeight+"px"),X.save(),X.translate(U.width/2,U.height/2),X.rotate(u._pageSize[_-1].PageRotation/2*Math.PI/2),X.drawImage(Z,-Z.width/2,-Z.height/2),X.restore()},Z.src=Y}},g.src=i[a],t.push(g),this._textureobj.push(g)},_hidingSignature:function(){e(".e-pdfviewer-imagecanvasDraw").hide();var t=document.getElementById(this._id+"e-pdfviewer-selector"),i=document.getElementsByClassName("e-pdfviewer-buttons");e(t).remove(),e(i).remove()},_showSignature:function(){e(".e-pdfviewer-imagecanvasDraw").show();var t=document.getElementById(this._id+"e-pdfviewer-selector"),i=document.getElementsByClassName("e-pdfviewer-buttons");e(t).remove(),e(i).remove()},_changingImageCanvasPosition:function(){var t=e(".e-pdfviewer-imagecanvasDraw");this._calculatingPositions(t),this._previousZoomValue=this._zoomVal},_calculatingPositions:function(t){for(var i,o=0;o<t.length;o++){var n=parseFloat(e(t[o]).css("left"))/this._previousZoomValue*this._zoomVal,s=parseFloat(e(t[o]).css("top"))/this._previousZoomValue*this._zoomVal,a=parseFloat(e(t[o]).css("width"))/this._previousZoomValue*this._zoomVal,r=parseFloat(e(t[o]).css("height"))/this._previousZoomValue*this._zoomVal;e(t[o]).css("top",s+"px"),e(t[o]).css("left",n+"px"),"e-pdfviewer-buttons"!=t[o].className&&(e(t[o]).css("width",a+"px"),e(t[o]).css("height",r+"px")),i=this._outputPath[t[o].id],this._reDrawSignature(i,t[o],a,r)}},_reDrawSignature:function(t,i,o,n){var s,a,r,l,d,h,_,c=document.getElementById(this._id+"_imageTemp"),p=(parseFloat(e(c).css("width")),parseFloat(e(c).css("height")),this._valueChanges[i.id]),g=p.differenceX/o,u=p.differenceY/n,f=this.element[0].parentElement.clientWidth;for(f>=500?(s=n/400,a=o/470):(s=n/100,a=o/f),(s<=0||a<=0)&&(s=1,a=1),l=(r=i.getContext("2d")).strokeStyle,i.width=o,i.height=n,i.style.width=o+"px",i.style.height=n+"px",d=t.split("<br>").length,r.beginPath(),h=0;h<d;h++)if(_=t.split("<br>")[h].split(".").slice(1).join(".")){var m=_.substring(0,6),v=_.substring(6).replace(/[{()}]/g,"").split(","),w=(parseFloat(v[0])-p.minimumX)/g,x=(parseFloat(v[1])-p.minimumY)/u;"moveTo"==m?r.moveTo(w,x):"lineTo"==m&&r.lineTo(w,x)}r.lineWidth=4,r.scale(a,s),r.strokeStyle=l,r.stroke()},_scalingTextContent:function(){return 2},_convertPointToPixel:function(e){return this._horizontalResolution?parseFloat(e)*(this._horizontalResolution/72):parseFloat(e)*(96/72)},_getRandomNum:function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},_createGUID:function(){return"Syncfusion_PDFviewer_"+(this._getRandomNum()+this._getRandomNum()+"-"+this._getRandomNum()+"-4"+this._getRandomNum().substr(0,3)+"-"+this._getRandomNum()+this._getRandomNum()+this._getRandomNum()).toLowerCase()},_createSignatureID:function(){return"Signature_"+(this._getRandomNum()+this._getRandomNum()+"-"+this._getRandomNum()+"-4"+this._getRandomNum().substr(0,3)+"-"+this._getRandomNum()+this._getRandomNum()+this._getRandomNum()).toLowerCase()},_updateFontSize:function(e,t,i){for(var o,n,s,a=this._convertPointToPixel(i.Width*this._zoomVal)+"px",r=!0,l=0;l<t.children.length;l++)if((o=document.createElement("canvas").getContext("2d")).fontFamily="sans-serif",o.fontSize=e,n=o.fontSize+"px",o.font=n+" "+o.fontFamily,s=o.measureText(t.children[l].innerHTML).width,parseFloat(a)<s){r=!1;break}return r},_createFormFields:function(t,o){var n,s,a,r,l,d,h,_,c,p,g,u,f,m,v;this._minTabindex=-1,this._maxTabindex=0;var w=t.pdfRenderedFields,x=t.cropBoxValue,b=navigator.userAgent,y=this;if(null!=w)for(n=0;n<w.length;n++)if(w[n].PageIndex+1==o){if(a=w[n].LineBounds,"Textbox"==w[n].Name){if(1==w[n].Visible)continue;w[n].Multiline?(s=document.createElement("textarea"),e(s).css("resize","none")):(s=document.createElement("input")).type="text",c=w[n].BackColor,r=w[n].FontColor,y._addAlignmentPropety(w[n],s),w[n].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+c.R+","+c.G+","+c.B+",0.2)"),e(s).css("color","rgb("+r.R+","+r.G+","+r.B+")"),w[n].IsRequired?e(s).css("border","1px solid red"):e(s).css("border",w[n].BorderWidth),e(s).attr("name",w[n].FieldName),l=this._convertPointToPixel(w[n].Font.Height*this._zoomVal)+"px",w[n].MaxLength>0&&e(s).attr("maxlength",w[n].MaxLength),w[n].InsertSpaces&&e(s).css("letter-spacing",l),""!=w[n].Text?e(s).val(w[n].Text):e(s).val("")}else if("Password"==w[n].Name)(s=document.createElement("input")).type="password",c=w[n].BackColor,r=w[n].FontColor,w[n].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+c.R+","+c.G+","+c.B+",0.2)"),e(s).css("color","rgb("+r.R+","+r.G+","+r.B+")"),w[n].IsRequired?e(s).css("border","1px solid red"):e(s).css("border",w[n].BorderWidth),(w[n].IsReadonly||this._isFormFieldsDisabled)&&e(s).attr("disabled",!0),y._addAlignmentPropety(w[n],s),e(s).attr("name",w[n].FieldName),l=this._convertPointToPixel(w[n].Font.Height*this._zoomVal)+"px",w[n].MaxLength>0&&e(s).attr("maxlength",w[n].MaxLength),w[n].InsertSpaces&&e(s).css("letter-spacing",l),""!=w[n].Text?e(s).val(w[n].Text):e(s).val("");else if("RadioButton"==w[n].Name)(s=document.createElement("input")).type="radio",w[n].IsRequired?(e(s).css("border","1px solid red"),e(s).css("outline","1px solid red")):e(s).css("border",w[n].BorderWidth),1==w[n].Selected&&e(s).prop("checked",!0),e(s).val(w[n].Value),e(s).attr("name",w[n].GroupName),e(s).css("cursor","pointer"),(w[n].IsReadonly||this._isFormFieldsDisabled)&&(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")),-1!=b.indexOf("Chrome")&&e(s).css("-webkit-apperance","none");else if("CheckBox"==w[n].Name)(s=document.createElement("input")).type="checkbox",w[n].IsRequired&&(e(s).css("border","1px solid red"),e(s).css("outline","1px solid red")),1==w[n].Selected?e(s).prop("checked",!0):-1!=b.indexOf("Chrome")&&e(s).css("-webkit-appearance","none"),e(s).attr("name",w[n].GroupName),c=w[n].BackColor,w[n].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):(e(s).css("background-color","rgba("+c.R+","+c.G+","+c.B+",0.2)"),e(s).css("cursor","pointer"));else if("DropDown"==w[n].Name){for(s=document.createElement("select"),w[n].IsRequired?e(s).css("border","1px solid red"):e(s).css("border",w[n].BorderWidth),e(s).css({transform:"rotate("+-w[n].RotationAngle+"deg)"}),e(s).attr("name",w[n].Text),""==w[n].SelectedValue&&((h=document.createElement("option")).id="dropdownhide",e(h).css("display","none"),h.selected="selected",h.innerHTML="",s.appendChild(h)),d=0;d<w[n].TextList.length;d++)(h=document.createElement("option")).className="e-dropdownSelect",w[n].SelectedValue==w[n].TextList[d]?e(h).prop("selected",!0):e(h).prop("selected",!1),h.innerHTML=w[n].TextList[d],s.appendChild(h);c=w[n].BackColor,w[n].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+c.R+","+c.G+","+c.B+",0.2)"),e(s).css("color","black")}else if("ListBox"==w[n].Name){for(s=document.createElement("select"),e(s).attr("multiple","multiple"),w[n].IsRequired?e(s).css("border","1px solid red"):e(s).css("border",w[n].BorderWidth),e(s).attr("name",w[n].Text),d=0;d<w[n].TextList.length;d++){for((h=document.createElement("option")).className="e-pdfviewer-ListBox",_=0;_<w[n].SelectedList.length;_++)w[n].SelectedList[_]==d&&e(h).prop("selected",!0);h.innerHTML=w[n].TextList[d],s.appendChild(h),c=w[n].BackColor,c=w[n].BackColor,w[n].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+c.R+","+c.G+","+c.B+",0.2)")}e(s).css("color","black"),(w[n].IsReadonly||this._isFormFieldsDisabled)&&e(s).attr("disabled",!0)}null!=w[n].Font&&((w[n].Font.Bold||w[n].Font.Italic||w[n].Font.Strikeout||w[n].Font.Underline)&&(w[n].Font.Italic&&(s.style.fontStyle="italic"),w[n].Font.Bold&&(s.style.fontWeight="Bold")),e(s).css("font-family",w[n].Font.Name),w[n].IsAutoSize?(p=this._convertPointToPixel(w[n].Font.Height*this._zoomVal),this._updateFontSize(p,s,a)?e(s).css("font-size",p):(g=10*this._zoomVal+"px",e(s).css("font-size",g))):(p=this._convertPointToPixel(w[n].Font.Height*this._zoomVal)+"px",e(s).css("font-size",p))),("rgba(255, 255, 255, 0.2)"==e(s).css("background-color")||"rgba(0, 0, 0, 0.2)"==e(s).css("background-color"))&&e(s).css("background-color","rgba(0, 20, 200, 0.2)"),x||(x=0),this._maxTabindex=Math.max(this._maxTabindex,w[n].TabIndex),-1==this._minTabindex&&(this._minTabindex=w[n].TabIndex),this._minTabindex=Math.min(this._minTabindex,w[n].TabIndex),this._maintainTabindex[o.toString()]=this._maxTabindex,this._maintanMinTabindex[o.toString()]=this._minTabindex,s.tabIndex=w[n].TabIndex,e(s).css("box-sizing","border-box"),e(s).attr("aria-label","form fields"),e(s).css("margin","0px"),s.style.borderStyle="solid",u=w[n].BorderColor,w[n].IsRequired?e(s).attr("required",!0):e(s).css("border-color","rgba("+u.R+","+u.G+","+u.B+",1)"),s.id=this._id+"input_"+o+"_"+n,s.className="e-pdfviewer-formFields",s.style.zIndex=1e3,s.style.maxWidth="none",90==w[n].RotationAngle||270==w[n].RotationAngle?(s.style.width=this._convertPointToPixel(a.Height*this._zoomVal)+"px",s.style.height=this._convertPointToPixel(a.Width*this._zoomVal)+"px",s.style.left=this._convertPointToPixel((a.X+x)*this._zoomVal)-this._convertPointToPixel(a.Width*this._zoomVal)+"px",s.style.top=this._convertPointToPixel((a.Y+x)*this._zoomVal)+this._convertPointToPixel(a.Width*this._zoomVal)+"px"):(s.style.left=this._convertPointToPixel((a.X+x)*this._zoomVal)+"px",s.style.top=this._convertPointToPixel((a.Y+x)*this._zoomVal)+"px",s.style.width=this._convertPointToPixel(a.Width*this._zoomVal)+"px",s.style.height=this._convertPointToPixel(a.Height*this._zoomVal)+"px"),s.style.position="absolute",f=document.getElementById(this._id+"selectioncanvas_"+o),e("#"+this._id+"selectioncanvas_"+o).addClass("input_container"),f.appendChild(s),y=this,v=-1!=navigator.userAgent.indexOf("Chrome"),e(s).on("focus",function(t){var i=e(t.target).attr("type"),o=(e(t.target)[0].type,e(t.target).css("background-color")),n=o.lastIndexOf(","),s=o.slice(0,n+1)+0+")";"checkbox"==i&&v&&e(t.target).css("-webkit-appearance",""),e(t.target).css("background-color",s),m=t.target.style.borderWidth,e(t.target).css("border-width","0"),y._isFormFields=!0}),e(s).on("blur",function(t){var i,o,n,s,a=e(t.target).attr("type");e(t.target)[0].type;o=(i=v?e(t.target).css("background-color"):t.target.style["background-color"]).lastIndexOf(","),"checkbox"==a&&1==e(t.target).prop("checked")?(n=i.slice(0,o+1)+0+")",e(t.target).css("background-color",n)):("checkbox"==a&&e(t.target).css("-webkit-appearance","none"),s=i.slice(0,o+1)+.2+")",e(t.target).css("background-color",s)),e(t.target).css("border-width",m),y._isFormFields=!1}),e(s).on("change",function(){y.isDocumentEdited=!0}),e(s).unbind("click").on("click touchstart",function(t){var o,n,s,a,r=e(t.target).attr("type"),l=e(t.target)[0].type;if("password"!=r&&"text"!=r||(a=e(t.target)[0],e(a).on("keypress",function(t){var i,o=e(a).attr("maxlength");e(a).val().length+1==o&&(i=e(a).val()+String.fromCharCode(t.keyCode),e(a).val(i),e(a).blur()),y.isDocumentEdited=!0}),e(a).on("keyup",function(t){var o,n=e(a).val(),s=y._pageContents[y._currentPage],r=JSON.parse(s).pdfRenderedFields,l=a.id.split("_"),d=l[l.length-1],h=e(t.target).attr("type"),_=e(t.target).attr("name"),c=e(".e-pdfviewer-formFields");if("text"==h||"password"==h||"textarea"==input[i].type)for(o=0;o<c.length;o++)e(c[o]).attr("name")==_&&e(c[o]).val(n);y.isDocumentEdited=n!=r[d].Text}),e(a).unbind("change").on("change",function(){var t=e(a).val();e(a).val(t)})),"radio"==r){for(o=e(t.target).attr("name"),n=e(".e-pdfviewer-formFields:radio"),s=0;s<n.length;s++)e(n[s]).attr("name")==o&&e(n[s]).prop("checked",!1);e(t.target).prop("checked",!0)}else"checkbox"==r?1==e(t.target).prop("checked")?(e(t.target).prop("checked",!0),v&&e(t.target).css("-webkit-appearance",""),e(t.target).css("border-width","1px")):e(t.target).prop("checked",!1):"select-one"==l&&(y.isDocumentEdited=!0,a=e(t.target)[0],e(a).unbind("change").on("change",function(t){for(var i=e(t.target)[0],o=i.options[i.selectedIndex].text,n=i.children,s=0;s<n.length;s++)n[s].text==o?e(n[s]).prop("selected",!0):e(n[s]).prop("selected",!1)}))})}},_addAlignmentPropety:function(t,i){switch(t.Alignment){case 0:e(i).css("text-align","left");break;case 1:e(i).css("text-align","center");break;case 2:e(i).css("text-align","right");break;case 3:e(i).css("text-align","justify")}},_checkvalidation:function(){var t,i,o,n,s,a=!1,r={},l=e(".e-pdfviewer-formFields");if(null!=l)for(t=0;t<l.length;t++)if("text"==l[t].type||"password"==l[t].type||"textarea"==l[t].type)e(l[t]).attr("required")&&""==l[t].value&&(r[l[t].name]=l[t].value,a=!0);else if("radio"==l[t].type&&e(l[t]).attr("required")&&!e(l[t]).prop("checked"))r[l[t].name]=l[t].value,a=!0;else if("checkbox"==l[t].type&&e(l[t]).attr("required")&&!e(l[t]).prop("checked"))r[l[t].name]=e(l[t]).prop("checked"),a=!0;else if("select-multiple"==l[t].type&&e(l[t]).attr("required")&&-1==l[t].selectedIndex){for(a=!0,i=[],o=e(l[t]).children(),n=0;n<o.length;n++)1==e(o[n]).prop("selected")&&i.push(o[n].text);i=JSON.stringify(i),r[l[t].name]=i}return a&&(s={responseData:JSON.stringify(r),status:"Please fill required fields"},this._raiseClientEvent("validateRequiredFormField",s)),a},_saveFormFieldsValue:function(){var t,i,o,n,s,a,r,l,d,h,_,c,p,g,u,f,m,v;if(!this._checkvalidation()||!this.model.enableRequiredFormFieldValidation){if(t={},i={},e("#"+this._id+"_toolbar_download").parent().parents(".e-pdfviewer-toolbarul").css("visibility",""),null!=(o=e(".e-pdfviewer-formFields")))for(d=0;d<o.length;d++)if("text"==o[d].type||"password"==o[d].type||"textarea"==o[d].type)t[o[d].name]=o[d].value;else if("radio"==o[d].type&&1==e(o[d]).prop("checked"))t[o[d].name]=o[d].value;else if("checkbox"==o[d].type)t[o[d].name]=(e(o[d]).prop("checked"),e(o[d]).prop("checked"));else if("select-one"==o[d].type)t[o[d].name]=o[d].options[o[d].selectedIndex].text;else if("select-multiple"==o[d].type){for(n=[],s=e(o[d]).children(),_=0;_<s.length;_++)1==e(s[_]).prop("selected")&&n.push(s[_].text);n=JSON.stringify(n),t[o[d].name]=n}for(a=[],d=1;d<=this._totalPages;d++){if(h=[],r=this._textMarkupAnnotationList[d])for(_=0;_<r.length;_++)if(c=r[_])for(p=c.Opacity,"Highlight"==c.TextMarkupAnnotationType&&(p*=.5),null==c.Author&&(c.Author=this.model.strikethroughSettings.author),u=(g=new Date(c.ModifiedDate.toString())).getMonth()+1+"/"+g.getDate()+"/"+g.getFullYear()+" "+g.getHours()+":"+g.getMinutes()+":"+g.getSeconds(),f=0;f<c.Bounds.length;f++)m={index:c.index,colorA:255*c.Opacity,colorR:c.Color.R,colorG:c.Color.G,colorB:c.Color.B,opacity:p,type:c.TextMarkupAnnotationType,author:c.Author,subject:c.Subject,text:c.Note,xPosition:c.Bounds[f].X,yPosition:c.Bounds[f].Y,height:c.Bounds[f].Height,width:c.Bounds[f].Width,modifiedDate:u},h.push(m);a[d-1]=h}for(l=[],d=1;d<=this._totalPages;d++){for(h=[],l[d-1]=h,_=0;_<this._newAnnotationList[d-1].length;_++)for(p=(c=this._newAnnotationList[d-1][_]).opacity,"Highlight"==c.type&&(p*=.5),u=(g=new Date(c.modifiedDate.toString())).getMonth()+1+"/"+g.getDate()+"/"+g.getFullYear()+" "+g.getHours()+":"+g.getMinutes()+":"+g.getSeconds(),f=0;f<c.bounds.length;f++)m={type:c.type,xPosition:c.bounds[f].xPosition,yPosition:c.bounds[f].yPosition,height:c.bounds[f].height,width:c.bounds[f].width,colorA:c.colorA,colorR:c.colorR,colorG:c.colorG,colorB:c.colorB,opacity:p,author:c.author,subject:c.subject,text:c.note,modifiedDate:u},h.push(m);l[d-1]=h}this._saveSignatureControl(),i.savetextMarkupAnnotation=JSON.stringify(l),i.existingAnnotations=JSON.stringify(a),i.savedFields=JSON.stringify(t),i.isEdited=this.isDocumentEdited,i.signatureFields=JSON.stringify(this._completeSign),i.id=this._fileId,this._completeSign.length>0&&(v=this._createSignatureID(),this._signatureLayer.push(v)),i.signatureValues=JSON.stringify(this._signatureLayer),i.newFileID=v,this._saveAs("POST",this.model.serviceUrl,JSON.stringify(i))}},_saveSignatureControl:function(){var t;this._completeSign=[];var i=e(".e-pdfviewer-imagecanvasDraw");for(t=0;t<i.length;t++){var o=i[t],n=[],s=o.getContext("2d"),a=o.id.split("imagecanvasDraw_")[1].split("_")[0],r=s.strokeStyle,l=parseInt(r.slice(1,3),16),d=parseInt(r.slice(3,5),16),h=parseInt(r.slice(5,7),16),_={id:o.id,xPosition:parseFloat(e(o).css("left"))/this._zoomVal,yPosition:parseFloat(e(o).css("top"))/this._zoomVal,height:parseInt(parseFloat(e(o).css("height"))/this._zoomVal),width:parseInt(parseFloat(e(o).css("width"))/this._zoomVal),path:this._outputPath[o.id],pageIndex:a,rotation:0,valueChange:this._valueChanges[o.id],zoomValue:this._zoomVal,colorA:255*parseFloat(e(o).css("opacity")),colorR:l,colorG:d,colorB:h};n.push(_),this._completeSign.push(n)}},_saveAs:function(t,i,o){var n=this;null!=this._ajaxDownloaded&&(this._ajaxDownloaded.abort(),this._ajaxDownloaded=null),this._ajaxDownloaded=e.ajax({type:t,url:i+"/"+this.model.serverActionSettings.download,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:o,traditional:!0,async:this._isAsynchronousDownload,success:function(e){var t,i;n._cancelDownloads?n._downloadAborted():(t={responseData:e,type:"Download"},n._raiseClientEvent("ajaxRequestSuccess",t),e&&(n._save(e),(i={}).fileName=n._downloadfileName,i.status="is completed",n._raiseClientEvent("downloadEnd",i)))},error:function(e,t,i){n._cancelDownloads&&"abort"==i&&n._downloadAborted(),n._raiseClientEvent("ajaxRequestFailure",e.responseText)}})},_downloadAborted:function(){var e={};e.fileName=this._downloadfileName,e.status="is aborted",this._raiseClientEvent("downloadEnd",e)},_generateFormFields:function(t,i){var o,n,s,a,r,l,d,h,_,c,p,g,u=t.pdfRenderedFields,f=t.cropBoxValue;if(null!=u)for(o=0;o<u.length;o++)if(n=u[o].LineBounds,s=document.getElementById(this._id+"input_"+i+"_"+o),u[o].PageIndex+1==i){if("Password"==u[o].Name||"Textbox"==u[o].Name){if(1==u[o].Visible)continue;_=u[o].BackColor,a=u[o].FontColor,this._addAlignmentPropety(u[o],s),u[o].IsRequired&&e(s).css("border","1px solid red"),u[o].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+_.R+","+_.G+","+_.B+",0.2)"),e(s).css("color","rgb("+a.R+","+a.G+","+a.B+")"),r=this._convertPointToPixel(u[o].Font.Height*this._zoomVal)+"px",u[o].MaxLength>0&&e(s).attr("maxlength",u[o].MaxLength),u[o].InsertSpaces&&e(s).css("letter-spacing",r),l=e(s).val(),e(s).val(l)}else if("RadioButton"==u[o].Name)u[o].IsRequired?(e(s).css("border","1px solid red"),e(s).css("outline","1px solid red")):e(s).css("border",u[o].BorderWidth),(u[o].IsReadonly||this._isFormFieldsDisabled)&&e(s).css("disabled",!0),1==e(s).prop("checked")&&e(s).prop("checked",!0),e(s).attr("name",u[o].GroupName),u[o].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("cursor","pointer");else if("CheckBox"==u[o].Name)_=u[o].BackColor,u[o].IsRequired&&(e(s).css("border","1px solid red"),e(s).css("outline","1px solid red")),(u[o].IsReadonly||this._isFormFieldsDisabled)&&e(s).css("disabled",!0),1==e(s).prop("checked")&&e(s).prop("checked",!0),u[o].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):(e(s).css("background-color","rgba("+_.R+","+_.G+","+_.B+",0.2)"),e(s).css("cursor","pointer"));else if("DropDown"==u[o].Name){for(u[o].IsRequired?e(s).css("border","1px solid red"):e(s).css("border",u[o].BorderWidth),e(s).css({transform:"rotate("+-u[o].RotationAngle+"deg)"}),(u[o].IsReadonly||this._isFormFieldsDisabled)&&e(s).css("disabled",!0),""==u[o].SelectedValue&&((h=e(s).children()[0]).id="dropdownhide",e(h).css("display","none"),1==e(h).prop("selected")&&e(h).prop("selected",!0),h.innerHTML=""),d=0;d<u[o].TextList.length;d++)h="dropdownhide"==e(s).children()[0].id?e(s).children()[d+1]:e(s).children()[d],1==e(h).prop("selected")&&e(h).prop("selected",!0),h.innerHTML=u[o].TextList[d],_=u[o].BackColor,u[o].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+_.R+","+_.G+","+_.B+",0.2)");e(s).css("color","black")}else if("ListBox"==u[o].Name){for(e(s).attr("multiple","multiple"),u[o].IsRequired?e(s).css("border","1px solid red"):e(s).css("border",u[o].BorderWidth),(u[o].IsReadonly||this._isFormFieldsDisabled)&&e(s).css("disabled",!0),d=0;d<u[o].TextList.length;d++)h=e(s).children()[d],1==e(h).prop("selected")?e(h).prop("selected",!0):e(h).prop("selected",!1),h.innerHTML=u[o].TextList[d],_=u[o].BackColor,u[o].IsReadonly||this._isFormFieldsDisabled?(e(s).attr("disabled",!0),e(s).css("background-color","none"),e(s).css("cursor","default")):e(s).css("background-color","rgba("+_.R+","+_.G+","+_.B+",0.2)");e(s).css("color","black")}null!=u[o].Font&&((u[o].Font.Bold||u[o].Font.Italic||u[o].Font.Strikeout||u[o].Font.Underline)&&(u[o].Font.Italic&&(s.style.fontStyle="italic"),u[o].Font.Bold&&(s.style.fontWeight="Bold")),e(s).css("font-family",u[o].Font.Name),u[o].IsAutoSize?(c=this._convertPointToPixel(u[o].Font.Height*this._zoomVal),this._updateFontSize(c,s,n)?e(s).css("font-size",c):(p=10*this._zoomVal+"px",e(s).css("font-size",p))):(c=this._convertPointToPixel(u[o].Font.Height*this._zoomVal)+"px",e(s).css("font-size",c))),("rgba(255, 255, 255, 0.2)"==e(s).css("background-color")||"rgba(0, 0, 0, 0.2)"==e(s).css("background-color"))&&e(s).css("background-color","rgba(0, 20, 200, 0.2)"),f||(f=0),e(s).css("box-sizing","border-box"),e(s).attr("aria-label","form fields"),e(s).css("margin","0px"),s.style.borderStyle="solid",g=u[o].BorderColor,u[o].IsRequired?e(s).attr("required",!0):e(s).css("border-color","rgba("+g.R+","+g.G+","+g.B+",1)"),s.style.zIndex=1e3,s.style.maxWidth="none",90==u[o].RotationAngle||270==u[o].RotationAngle?(s.style.width=this._convertPointToPixel(n.Height*this._zoomVal)+"px",s.style.height=this._convertPointToPixel(n.Width*this._zoomVal)+"px",s.style.left=this._convertPointToPixel((n.X+f)*this._zoomVal)-this._convertPointToPixel(n.Width*this._zoomVal)+"px",s.style.top=this._convertPointToPixel((n.Y+f)*this._zoomVal)+this._convertPointToPixel(n.Width*this._zoomVal)+"px"):(s.style.left=this._convertPointToPixel((n.X+f)*this._zoomVal)+"px",s.style.top=this._convertPointToPixel((n.Y+f)*this._zoomVal)+"px",s.style.width=this._convertPointToPixel(n.Width*this._zoomVal)+"px",s.style.height=this._convertPointToPixel(n.Height*this._zoomVal)+"px"),s.style.position="absolute"}},_textSelection:function(t,i,o){navigator.userAgent.indexOf("Edge"),document.documentMode||/Edge/.test(navigator.userAgent),-1!=navigator.userAgent.indexOf("MSIE")||document.documentMode;for(var n,s,a,r,l,d,h,_,c=t.selection,p=[],g=[],u=new RegExp(String.fromCharCode(160),"g"),f=0;f<c.length;f++){var m=" ",v=c[f].LineBounds,w=document.createElement("DIV");w.id=this._id+"text_"+i+"_"+f,w.className="e-pdfviewer-textLayer",n=(n=(n=c[f].Line).replace(/</g,"&lt;")).replace(/>/g,"&gt;");var x=new RegExp("[\0-]+").test(n),b=this._isRtl(n);!x&&b?(u=new RegExp(String.fromCharCode(160),"g"),n=(n=n.replace(u," ")).split("").reverse().join(""),g.push(n)):g.push(c[f].Line.toString()),(this._previousBounds==parseInt(v.Y)||this._previousBounds==parseInt(v.Y+1)||this._previousBounds==parseInt(v.Y-1))&&(" "!=(m=document.getElementById(this._id+"text_"+i+"_"+(f-1))).innerHTML&&(m.innerHTML=m.innerHTML.replace(/&nbsp;/g," "),m.innerHTML=m.innerHTML.replace(/(\r\n|\n|\r)/gm,""),this._textlayout.pop(m))),this._previousBounds=parseInt(v.Y),w.innerHTML=n+"\r\n",e(w).filter(function(){_=e(w).html().match(/&nbsp;/)}),null!==_&&(this._isNonBreackingCharacter=!0),w.innerHTML=w.innerHTML.replace(/&nbsp;/g," "),w.innerHTML=w.innerHTML.replace(/&nbsp;/g," ")," "!=n.replace(/  +/g," ")&&(w.style.whiteSpace="pre"),w.style.background="transparent",w.style.position="absolute",w.style.left=this._convertPointToPixel(v.X*this._zoomVal)+"px",w.style.top=this._convertPointToPixel(v.Y*this._zoomVal)+"px",w.style.width=this._convertPointToPixel(v.Width*this._zoomVal)+"px",w.style.color="transparent",w.style.fontSize=this._convertPointToPixel(v.Height*this._zoomVal)+"px",w.style.fontFamily="sans-serif",w.style.opacity="0.2",w.style.transformOrigin="0%",o.fontFamily="sans-serif",o.fontSize=w.style.fontSize,o.font=w.style.fontSize+" "+w.style.fontFamily,s=o.measureText(c[f].Line).width,a=parseFloat(w.style.width)/s,w.style.transform="scaleX("+a+")",r=document.getElementById(this._id+"selectioncanvas_"+i),e("#"+this._id+"selectioncanvas_"+i).addClass("text_container"),r.appendChild(w),l=r.getBoundingClientRect(),((d=w.getBoundingClientRect()).width+d.left>=l.width+l.left||d.width>l.width)&&(e(w).css("width","auto"),h=w.clientWidth,e(w).css("width",h+"px")),p.push(w),this._textlayout.push(w)}this._previousBounds=null,this._textDivs[i]=p,this._textContents[i]=g},_resizeSelection:function(t,i,o){for(var n,s,a,r,l,d,h=t.selection,_=0;_<h.length;_++)if(n=h[_].LineBounds,s=document.getElementById(this._id+"text_"+i+"_"+_)){a=h[_].Line,s.style.position="absolute",s.style.left=this._convertPointToPixel(n.X*this._zoomVal)+"px",s.style.top=this._convertPointToPixel(n.Y*this._zoomVal)+"px",s.style.width=this._convertPointToPixel(n.Width*this._zoomVal)+"px"," "!=a.replace(/  +/g," ")&&(s.style.whiteSpace="pre"),s.style.transformOrigin="0%",s.style.opacity="0.2",s.style.fontSize=this._convertPointToPixel(n.Height*this._zoomVal)+"px",o.font=s.style.fontSize+" "+s.style.fontFamily,o.fontSize=s.style.fontSize,r=o.measureText(h[_].Line).width,l=parseFloat(s.style.width)/r,s.style.transform="scaleX("+l+")";var c=document.getElementById(this._id+"selectioncanvas_"+i).getBoundingClientRect(),p=s.getBoundingClientRect();(p.width+p.left>=c.width+c.left||p.width>c.width)&&(e(s).css("width","auto"),d=s.clientWidth,e(s).css("width",d+"px"))}},_maintainSelection:function(){var e,t,i=this._selectionNodes,o=document.createRange();null!=i.anchorNode&&(t=!1,(!(e=i.anchorNode.compareDocumentPosition(i.focusNode))&&i.anchorOffset>i.focusOffset||e===Node.DOCUMENT_POSITION_PRECEDING)&&(t=!0),t?(o.setStart(i.focusNode,i.focusOffset),o.setEnd(i.anchorNode,i.anchorOffset)):(o.setStart(i.anchorNode,i.anchorOffset),o.setEnd(i.focusNode,i.focusOffset)),this._selectionRange=o),i.removeAllRanges()},_showPageLoadingIndicator:function(t,i){i?e("#"+this._id+"pageDiv_"+t+"_WaitingPopup").css("display","block"):e("#"+this._id+"pageDiv_"+t+"_WaitingPopup").css("display","none")},_imageRendering:function(e,t,i,n,s,a,r,l,d,h,_,c){var p=this._zoomVal,g=new Image,u=this;g.onload=function(){for(var a,g,f,m,v,w,x=!1,b=u._scalingTextContent(s),y=0;y<n.length;y++)if(0==x)for(a=n[y],s.setTransform(a[0]*p*b,a[1]*p*b,a[2]*p*b,a[3]*p*b,a[4]*p*b,a[5]*p*b),t[c]!=o&&s.drawImage(t[c],0,0,1,1),g=l[y],g+=1,f=r[y];g<f.length;){var P=f[g],C=P.color,S=P.matrix;null!=S&&(S=S.Elements);var T=P.brush,I=P.pathValue,k=P.iscliping,z=P.restorecanvas,A=P.imagedata,D=P.fillrule,B=P.isFillandStroke,R=P.fillcolor,E=P.strokecolor,N=P.linewidth,O=P.linecap,V=P.linearGradientBrush,L=P.textureBrushs,M=P.charID,F=(P.rectvalue,P.alpha),j=P.dashPattern;if(null!=j&&j.length>0&&s.setLineDash(j),null!=I?(I=I.split(";"),M&&(d[M]=I)):null==I&&M&&(I=d[M]),0==z&&s.save(),I!=o&&s.setTransform(S[0]*p*b,S[1]*p*b,S[2]*p*b,S[3]*p*b,S[4]*p*b,S[5]*p*b),null!=I){for(s.beginPath(),m=0;m<I.length;m++)"M"==(w=(v=I[m])[0])?(v=(v=v.substring(1,v.length)).split(" "),s.moveTo(v[0],v[1])):"L"==w?(v=(v=v.substring(1,v.length)).split(" "),s.lineTo(v[0],v[1])):"C"==w?(v=(v=v.substring(1,v.length)).split(" "),s.bezierCurveTo(v[0],v[1],v[2],v[3],v[4],v[5])):"Z"==w&&s.closePath();1==k?("evenodd"==D&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.clip(D)),s.clip()):B==o?"Fill"==T?(V!=o?s.fillStyle=u._getGradientBrush(V,s):L!=o?s.fillStyle=u._createTextureBrush(L,s,P):(F!=o&&(s.globalAlpha=F),s.fillStyle=C),"evenodd"==D&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(D)),s.fill()):"FillandStroke"==T?(s.fillStyle=C,s.fill(),s.strokeStyle=E,s.stroke()):"Stroke"==T?(s.strokeStyle=E,s.lineWidth=N,s.lineCap=O,s.stroke()):(s.strokeStyle=C,s.lineWidth=N,s.lineCap=O,s.stroke()):(s.strokeStyle=E,s.lineWidth=N,s.lineCap=O,s.stroke(),s.fillStyle=V!=o?u._getGradientBrush(V,s):L!=o?u._createTextureBrush(L,s,P):R,"evenodd"==D&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(D)),s.fill())}if(z&&s.restore(),A!=o){x=!0,i.pop(),n.pop(),r.pop(),l.pop(),i.push(A),n.push(S),r.push(e),l.push(g),y=-1,c++;break}g++}else u._imageRendering(e,t,i,n,s,y,r,l,d,h,_,c),c++;if(g==e.length&&0!=u._pageSize[_-1].PageRotation){var H=document.getElementById(u._id+"pagecanvas_"+_),W=H.toDataURL(),U=H.getContext("2d"),Y=(b=u._scalingTextContent(s),new Image);Y.onload=function(){U.clearRect(0,0,H.width,H.height),90==u._pageSize[_-1].PageRotation||270==u._pageSize[_-1].PageRotation?(H.width=u._zoomVal*u._pageSize[_-1].PageHeight*b,H.height=u._zoomVal*u._pageSize[_-1].PageWidth*b,H.style.height=u._zoomVal*u._pageSize[_-1].PageWidth+"px",H.style.width=u._zoomVal*u._pageSize[_-1].PageHeight+"px"):(H.width=u._zoomVal*u._pageSize[_-1].PageWidth*b,H.height=u._zoomVal*u._pageSize[_-1].PageHeight*b,H.style.width=u._zoomVal*u._pageSize[_-1].PageWidth+"px",H.style.height=u._zoomVal*u._pageSize[_-1].PageHeight+"px"),U.save(),U.translate(H.width/2,H.height/2),U.rotate(u._pageSize[_-1].PageRotation/2*Math.PI/2),U.drawImage(Y,-Y.width/2,-Y.height/2),U.restore()},Y.src=W}},g.src=i[a],t.push(g),this._imageObj.push(g)},_createTextureBrush:function(e,t,i){var o=i.texturFields[0].Image,n=i.texturFields[0].Width,s=i.texturFields[0].Height,a="data:image/png;base64,"+o,r=new Image;-1!=navigator.userAgent.indexOf("Firefox")?(r.src=this._imageSrcCollection[0],this._loadimages(r,n,s,t),this._imageSrcCollection.shift()):(r.src=a,this._loadimages(r,n,s,t))},_loadimages:function(e,t,i,o){var n,s=document.createElement("canvas"),a=s.getContext("2d");return s.width=t,s.height=i,a.drawImage(e,0,0,e.width,e.height,0,0,s.width,s.height),n=o.createPattern(s,"repeat"),o.fillStyle=n,o.fill(),n},_getGradientBrush:function(e,t){for(var i,o,n=e.Rectangle,s=e.InterpolationColors,a=s.Colors,r=s.Positions,l=n.X<=0&&0==n.Y?t.createLinearGradient(n.X,n.Height,n.X,n.Y):t.createLinearGradient(n.X,n.Y,n.Width,n.Height),d=0;d<r.length;d++)i=(i=a[d]).split(","),o=this._rgb2Color(i[0],i[1],i[2]),l.addColorStop(r[d],o);return l},_rgb2Color:function(e,t,i){return"#"+this._byte2Hex(e)+this._byte2Hex(t)+this._byte2Hex(i)},_byte2Hex:function(e){var t="0123456789ABCDEF";return String(t.substr(e>>4&15,1))+t.substr(15&e,1)},_ajaxResponseData:function(e){var t,i=this;return i._responseData=null,t={responseData:e,type:"Rendering"},i._raiseClientEvent("ajaxRequestSuccess",t),null!=i._responseData&&""!=i._responseData&&"object"==typeof i._responseData?e=JSON.stringify(i._responseData):null!=i._responseData&&""!=i._responseData&&(e=i._responseData),e},_doAjaxPost:function(t,i,o,n,s){var a=this,r=n;null!=this._ajaxRequestState&&(this._ajaxRequestState.abort(),this._ajaxRequestState=null),this._ajaxRequestState=e.ajax({type:t,url:i,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:o,traditional:!0,success:function(e){var t,i,o,n,l,d,h,_;if(e=a._ajaxResponseData(e),a.model.allowClientBuffering){if(a._initPages(),jsondata="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(e),jsondata=jsondata.pdf,t=a._getObjectSize(jsondata),jsondata){for(i=1;i<=t;i++)(o=jsondata[i])&&(a._pageContents[parseInt(o.currentpage)]=JSON.stringify(o),a._pageText[parseInt(o.currentpage)]=o.pageContents);e=a._pageContents[parseInt(1)]}}else"object"==typeof e&&(e=JSON.stringify(e));0==(n=JSON.parse(e)).pagecount?(this.pageCount=0,a._unLoad()):("object"==typeof e?a[r](JSON.stringify(e)):a[r](e),h={fileName:d=(l=n.filename.split("\\")).length>0?l[l.length-1]:""!=a._fileName&&null!=a._fileName?a._fileName:null},a._downloadfileName=d,a.model&&(a._raiseClientEvent("documentLoad",h),a.model.allowClientBuffering&&(_="object"==typeof e?JSON.parse(JSON.stringify(e)):JSON.parse(e),a._pagesGot.push(parseInt(_.currentpage))))),a.model.allowClientBuffering&&s&&(a._pagesGot.push(parseInt(_.currentpage)+1),2<=a._totalPages&&(a._targetPage=_.currentpage+2,a._isTargetPage=!0))},error:function(e){("_clearCurrentServerCache"==r||0!=e.readyState)&&a._raiseClientEvent("ajaxRequestFailure",e.responseText)}})},_initPages:function(){this._pageLocation=[],this._renderedCanvasList=[],this._pageContents=[],this._pageText=[],this._textDivs=[],this._textlayout=[],this._textContents=[],this._searchMatches=[],this._searchCollection=[],this._pageLocation[1]=0,this._searchedPages=[],this._canvascount=this._totalPages,this._pointers=[],this._imageObj=[],this._pagesGot=[],this._imageSrcCollection=[],this._selectionPages=[]},_getObjectSize:function(e){var t=0;for(var i in e)e.hasOwnProperty(i)&&t++;return t},_raiseClientEvent:function(i,o){var n,s=this.model[i];s&&("string"==typeof s&&(s=t.util.getObject(s,window)),e.isFunction(s)&&("pageChange"==i?n={currentPageNumber:parseInt(o.currentPageNumber)}:"zoomChange"==i?n={previousZoomPercentage:o.previousZoomPercentage,currentZoomPercentage:o.currentZoomPercentage}:"hyperlinkClick"==i?n={hyperlink:o.hyperlink}:"pageClick"==i?n={XCoordinate:o.offsetX,YCoordinate:o.offsetY}:"bufferStart"==i?n={isBuffering:!0}:"bufferEnd"==i?n={isBuffering:!1}:"documentLoad"==i?n={fileName:o.fileName}:"ajaxRequestFailure"==i?n={message:o}:"ajaxRequestSuccess"==i?n={responseData:o.responseData,requestType:o.type}:"annotationAdd"==i?n={annotationSettings:o.annotationSettings,annotationID:o.annotationId,pageID:o.pageId,annotationBound:o.annotationBound,annotationType:o.annotationType}:"annotationRemove"==i?n={annotationID:o.annotationId,pageID:o.pageId,annotationType:o.annotationType}:"annotationPropertiesChange"==i?n={annotationID:o.annotationId,pageID:o.pageId,annotationType:o.annotationType,isColorChanged:o.isColorChanged,isOpacityChanged:o.isOpacityChanged}:"annotationResize"==i?n={annotationSettings:o.annotationSettings,annotationID:o.annotationID,pageID:o.pageID,annotationBound:o.annotationBound,annotationType:o.annotationType}:"signatureDelete"==i?n={pageNumber:o.pageNumber}:"signatureAdd"==i?n={signatureSettings:o.signatureSettings,pageNumber:o.pageNumber,signatureBound:o.signatureBound,signatureID:o.signatureID}:"signatureResize"==i?n={signatureSettings:o.signatureSettings,pageNumber:o.pageNumber,signatureCurrentBound:o.signatureCurrentBound,signaturePreviousBound:o.signaturePreviousBound}:"signaturePropertiesChange"==i?n={pageID:o.pageId,isColorChange:o.isColorChange,isOpacityChange:o.isOpacityChange,perviousColor:o.perviousColor,currentColor:o.currentColor,previousOpacity:o.previousOpacity,currentOpacity:o.currentOpacity}:"downloadStart"==i?n={fileName:o.fileName,status:o.status}:"downloadEnd"==i?n={fileName:o.fileName,status:o.status}:"validateRequiredFormField"==i&&(n={responseData:o.responseData,status:o.status}),this._trigger(i,n)))},_getPageModel:function(i){var o,n,s;if(this._on(e(window),"resize",this._viewerResize),i&&(this._isJsondataAvailable=!0),(""==i||null==i)&&(this._showloadingIndicator(!0),e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(""),e("#"+this._id+"_txtpageNo").val("0")),(o=this._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(i):JSON.parse(i.d))&&this.model){for(this._pageWidth=o.pagewidth,this._pageHeight=o.pageheight,this._imageUrl=o.imageurl,this._pageSize=o.pagesize,this._totalPages=o.pagecount,this.pageCount=this._totalPages,this._pdfFileName=o.filename,this.fileName?this._pdfFileName=this.fileName:this._pdfFileName&&(this.fileName=this._pdfFileName),this._currentPage=o.currentpage,this._restrictionSummary=o.restrictionSummary,this._horizontalResolution=o.horizontalResolution,this._isRestrictionEnabled(),this._isPrintRestrict?this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_Print"):this._isPrintRestrict||this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_Print"),this.currentPageNumber=this._currentPage,this._isToolbarClick||this._enableToolbarItems(),this._isSelectionHidden||(this.model.enableTextSelection&&(this._isEnabled=!0),this.model.interactionMode==t.PdfViewer.InteractionMode.TextSelection&&this.model.enableTextSelection?this.model.enableTextSelection=!0:this.model.interactionMode==t.PdfViewer.InteractionMode.Pan&&(this.model.enableTextSelection=!1),n=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),this._isCopyRestrict?this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_select"):this._isCopyRestrict||this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_select"),this.model.enableTextSelection&&!n?this._highlightSelectItems():(!this.model.enableTextSelection||n)&&(this._isEnabled||this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_select"),this._highlightScrollItems())),this._gotoPage(this._currentPage),this._toolbarResizeHandler(),this._setSearchToolbarTop(),this._resizeSearchToolbar(),this._drawPdfPage(i),s=0;s<this._totalPages;s++)this._newAnnotationList[s]=[],this._colorModifiedAnnotationList[s]=[],this._deletedAnnotationList[s]=[],this._existingAnnotationsModified[s]=[],this._redoAnnotationCollection[s]=[],this._annotationsDeletedNo[s]=0,this._totalAnnotations[s+1]=[];this._showNavigationIndicator(!1),this._showloadingIndicator(!1)}},_isRestrictionEnabled:function(){if(this._restrictionSummary)for(var e=0;e<this._restrictionSummary.length;e++)switch(this._restrictionSummary[e]){case"Print":this._isPrintRestrict=!0;break;case"CopyContent":this._isCopyRestrict=!0,this.model.enableTextSelection=!1;break;case"PageExtraction":this._isPageExtraction=!0;break;case"FillFields":this._isFormFieldsDisabled=!0;break;case"EditAnnotations":this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_underline")}},_print:function(){this._abortPrinting=!1,this._isPrintingProcess=!0,this._raiseClientEvent("beforePrint",null),this._showPrintLoadingIndicator(!0),this._setViewerForPrint(),this._scrollPageByPage()},_setViewerForPrint:function(){this._isPrinting=!0,this._currentPageBackup=this._currentPage,this._scrollTop=e("#"+this._id+"_viewerContainer").scrollTop(),this._zoomValBackup=this._zoomVal,this._zoomLevelBackup=this._zoomLevel,1!=this._zoomVal&&(this._zoomVal=1,this._zoomLevel=2,this._fitTypeBackup=this._fitType,this._zoomContainer(this._zoomVal,!1))},_scrollPageByPage:function(){for(var e,t,i,o=1;o<=this._totalPages&&(this._scrollTriggered=!1,!(e=this._scrollToPageNo(o)));o++);this._isPrinting=!1,e||(-1!=(t=navigator.userAgent).indexOf("Chrome")||-1!=t.indexOf("Safari")||-1!=t.indexOf("Firefox")?(i=this,setTimeout(function(){i._printPages()},1e3)):this._printPages(),this._raiseClientEvent("afterPrint",null))},_scrollToPageNo:function(e){var t;this._currentPage;if(this._totalPages&&((t=parseInt(e))>=1&&t<=this._totalPages))return this._currentPage=t,document.getElementById(this._id+"_viewerContainer").scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),this._scrollPage(this._pageHeight)},_scrollPage:function(){var e,i;return this._scrollTriggered=!0,(e={}).viewerAction=this._viewerAction.getPageModel,e.pageindex=this._currentPage.toString(),e.id=this._fileId,e.isPrinting=!0,e.signatureValues=JSON.stringify(this._signatureLayer),i=this.model.serviceUrl+"/"+this.model.serverActionSettings.print,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostPrint("POST",i,JSON.stringify(e)):this._doAjaxPostPrint("POST",this.model.serviceUrl,JSON.stringify({jsonResult:e})),!0},_printPages:function(){var t,i,o,n,s,a,r,l,d,h,_,c,p,g,u,f,m=navigator.userAgent,v=this,w=this._printIframe;for(w.name="printFrame",w.style.position="absolute",w.style.top="-100000000px",document.body.appendChild(w),(t=w.contentWindow?w.contentWindow:w.contentDocument.document?w.contentDocument.document:w.contentDocument).document.open(),-1==m.indexOf("Edge")?-1!=m.indexOf("Chrome")||-1!=m.indexOf("Safari")||-1!=m.indexOf("Firefox")?(t.document.write("<!DOCTYPE html>"),t.document.write("<html moznomarginboxes mozdisallowselectionprint><head><style>html, body { height: 100%; } img { height: 100%; width: 100%; display: block; }@media print { body { margin: 0cm; }img { box-sizing: border-box; }br, button { display: none; }} @page{margin:0cm; size: 816px 1056px;}</style></head><body><center>")):(t.document.write("<!DOCTYPE html>"),t.document.write("<html><head><style>html, body { height: 99%; } img { height: 99%; width: 100%; }@media print { body { margin: 0cm; }img { box-sizing: border-box; }br, button { display: none; }} @page{margin:0.5cm; size: 816px 1056px;}</style></head><body><center>")):(t.document.write("<!DOCTYPE html>"),t.document.write("<html><head><style>html, body { height: 99%; } img { height: 99%; width: 100%; }@media print { body { margin: 0cm; }img { box-sizing: border-box; }br, button { display: none; }} @page{margin:0cm; size: 816px 1056px;}</style></head><body><center>")),i=1;i<=v._totalPages;i++){var x="",b="",y=document.getElementById(this._id+"pagecanvas_"+i),P=document.getElementById(this._id+"selectioncanvas_"+i),C=document.getElementById(this._id+"_secondarycanvas_"+i),S=document.getElementById(this._id+"pageDiv_"+i);for(x=y.toDataURL(),o=C.toDataURL(),window.innerWidth<screen.width&&!v._ispdfium?(b=v._zoomVal,v._topValue=!0,n=v._pageContents[parseInt(i)],x=v._printPdfPages(n).toDataURL(),o=C.toDataURL()):b=1,t.document.write('<div style="margin:0px;width:816px;height:1056px;position:relative"><img src="'+x+'" id="image_'+i+'" /><img src="'+o+'" id = "secimage_'+i+'" style="margin:0px;top:0px;left:0px;position:absolute;width:816px;height:1056px;z-index:2" /><div id="fields_'+i+'"></div><div id="signaturefields_'+i+'"style="margin:0px;top:0px;left:0px;position:absolute;z-index:1000"></div></div><br/>'),s=e(P).find(".e-pdfviewer-formFields").length,2,a=0;a<s;a++){var T="",I=e(P).find(".e-pdfviewer-formFields")[a],k=I.cloneNode(!0);if("select-one"==I.type&&(T=I.selectedIndex,r=k.children,e(r[T]).prop("selected",!0)),(l=v._pageSize[i-1].PageWidth*v._zoomVal)>(d=v._pageSize[i-1].PageHeight*v._zoomVal)?(h=d/816,_=l/1056):(h=d/1056,_=l/816),(-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode||-1!=m.indexOf("Edge"))&&(e(k).css("left",parseFloat(e(k).css("left"))+"px"),e(k).css("top",parseFloat(e(k).css("top"))-6+"px")),window.innerWidth<screen.width&&(e(k).css("left",parseFloat(e(k).css("left"))/b+"px"),e(k).css("top",parseFloat(e(k).css("top"))/b+"px")),e(k).css("left",parseFloat(e(k).css("left"))/_+"px"),e(k).css("top",parseFloat(e(k).css("top"))/h+"px"),e(k).css("width",parseFloat(e(k).css("width"))/_+"px"),e(k).css("height",parseFloat(e(k).css("height"))/h+"px"),l>d){e(k).css({transform:"rotate(-90deg)"});var z=parseFloat(e(k).css("left")),A=parseFloat(e(k).css("width"))/2,D=parseFloat(e(k).css("height"))/2;e(k).css("left",D-A+parseFloat(e(k).css("top"))+"px"),e(k).css("top",A-D+z+"px")}e(k).css("margin","-1px"),e(t.document.getElementById("fields_"+i)).append(k)}for(c=e(S).find(".e-pdfviewer-imagecanvasDraw"),p=0;p<c.length;p++)g=e(c)[p],(u=document.createElement("img")).src=g.toDataURL(),e(u).css("position","absolute"),e(u).css("left",e(g).css("left")),e(u).css("top",e(g).css("top")),e(u).css("width",e(g).css("width")),e(u).css("height",e(g).css("height")),e(t.document.getElementById("signaturefields_"+i)).append(u)}if(this._topValue=!1,t.document.write("</center></body></html>"),navigator.userAgent.match("Firefox")?window.frames.printFrame.close():t.document.close(),-1==m.indexOf("Edge"))if(-1!=m.indexOf("Chrome")||-1!=m.indexOf("Safari")||-1!=m.indexOf("Firefox"))v=this,setTimeout(function(){window.frames.printFrame.focus(),window.frames.printFrame.print(),document.body.removeChild(w)},500);else{f=e("iframe")[0];try{f.contentWindow.document.execCommand("print",!1,null)}catch(e){f.contentWindow.print()}}else{f=e("iframe")[0];try{f.contentWindow.document.execCommand("print",!1,null)}catch(e){f.contentWindow.print()}}this._restoreViewer()},_printCancel:function(){this._abortPrinting=!0,this._restoreViewer(),this._raiseClientEvent("afterPrint",null)},_restoreViewer:function(){var e,t,i;for(this._isPrintingProcess=!1,this._isViewerRestored=!0,this._currentPage=this._currentPageBackup,this._zoomVal=this._zoomValBackup,this._zoomLevel=this._zoomLevelBackup,e=1;e<=this._totalPages;e++)t=document.getElementById(this._id+"pagecanvas_"+e),this._pageSize[e-1].PageWidth>this._pageSize[e-1].PageHeight&&(t.style.height=this._pageSize[e-1].PageHeight+"px",t.style.width=this._pageSize[e-1].PageWidth+"px",t.width=this._pageSize[e-1].PageWidth,t.height=this._pageSize[e-1].PageHeight,this._renderedCanvasList.length=0);null==this._fitTypeBackup?this._zoomContainer(this._zoomVal,!1):(i=this._fitToPage(this._fitTypeBackup),this._applyDropDownVal(i,!0,!1),this._updatePageFitModel(this._fitType)),document.getElementById(this._id+"_viewerContainer").scrollTop=this._scrollTop,this._showPrintLoadingIndicator(!1)},_doAjaxPostPrint:function(i,o,n){var s,a,r,l,d,h=JSON.parse(n);if(this._pdfService==t.PdfViewer.PdfService.Local?this._currentPrintPage=h.pageindex:(s=h.jsonResult,this._currentPrintPage=s.pageindex),this.model.allowClientBuffering&&this._isBuffering&&null!=this._ajaxRequestState&&(this._ajaxRequestState.abort(),this._ajaxRequestState=null),this._pageContents[this._currentPrintPage]){if("object"==typeof(a=this._pageContents[this._currentPrintPage])?this._printPdfPages(JSON.stringify(a)):this._printPdfPages(a),this._scrollTriggered=!1,this._abortPrinting)return;parseFloat(this._currentPrintPage)<this.pageCount?((n={}).viewerAction=this._viewerAction.getPageModel,n.pageindex=(parseFloat(this._currentPrintPage)+1).toString(),n.id=this._fileId,n.isPrinting=!0,n.signatureValues=JSON.stringify(this._signatureLayer),r=this.model.serviceUrl+"/"+this.model.serverActionSettings.print,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPostPrint("POST",r,JSON.stringify(n)):this._doAjaxPostPrint("POST",this.model.serviceUrl,JSON.stringify({jsonResult:n}))):(-1!=(l=navigator.userAgent).indexOf("Chrome")||-1!=l.indexOf("Safari")||-1!=l.indexOf("Firefox")?(d=this,setTimeout(function(){d._printPages()},1e3)):this._printPages(),this._raiseClientEvent("afterPrint",null))}else d=this,e.ajax({type:i,url:o,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:n,traditional:!0,success:function(e){var i,o,n;"object"==typeof(e=d._ajaxResponseData(e))?d._printPdfPages(JSON.stringify(e)):d._printPdfPages(e),d._scrollTriggered=!1,d._abortPrinting||(parseFloat(d._currentPrintPage)<d.pageCount?((i={}).viewerAction=d._viewerAction.getPageModel,i.pageindex=(parseFloat(d._currentPrintPage)+1).toString(),i.id=d._fileId,i.isPrinting=!0,i.signatureValues=JSON.stringify(d._signatureLayer),o=d.model.serviceUrl+"/"+d.model.serverActionSettings.print,d._pdfService==t.PdfViewer.PdfService.Local?d._doAjaxPostPrint("POST",o,JSON.stringify(i)):d._doAjaxPostPrint("POST",d.model.serviceUrl,JSON.stringify({jsonResult:i}))):(-1!=(n=navigator.userAgent).indexOf("Chrome")||-1!=n.indexOf("Safari")||-1!=n.indexOf("Firefox")?setTimeout(function(){d._printPages()},1e3):d._printPages(),d._raiseClientEvent("afterPrint",null)))},error:function(e){0!=e.readyState&&d._raiseClientEvent("ajaxRequestFailure",e.responseText)}})},_printPdfPages:function(i){var n,s,a,r,l,d,h,_,c,p,g,u,f,m=0,v=i;if(n=this._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(i):JSON.parse(i.d),s=parseInt(n.currentpage),this._showPageLoadingIndicator(s,!0),a=n.imagestream,r=parseInt(n.currentpage),-1==this._renderedCanvasList.indexOf(r)&&this._renderedCanvasList.push(parseInt(n.currentpage)),this._pageContents[s]||(this._textMarkupAnnotationList[parseInt(n.currentpage)]=n.textMarkupAnnotation),this._pageContents[parseInt(n.currentpage)]=v,(this._textMarkupAnnotationList[s]||this._newAnnotationList[s-1])&&this._renderTextMarkupAnnotation(this._textMarkupAnnotationList[s],s),1==this._topValue){var w=parseInt(n.currentpage),x=document.createElement("canvas"),b=this._pageSize[w-1].PageHeight,y=this._pageSize[w-1].PageWidth;x.style.visibility="hidden",x.style.width=y+"px",x.style.height=b+"px",x.style.backgroundColor="white",x.className="e-pdfviewer-pageCanvas",x.height=b,x.width=y}else x=document.getElementById(this._id+"pagecanvas_"+parseInt(n.currentpage));ee=x.getContext("2d"),D=this._scalingTextContent(ee),90==this._pageSize[r-1].PageRotation||270==this._pageSize[r-1].PageRotation?(x.height=this._zoomVal*this._pageSize[r-1].PageHeight*D,x.width=this._zoomVal*this._pageSize[r-1].PageWidth*D,x.style.width=this._zoomVal*this._pageSize[r-1].PageWidth+"px",x.style.height=this._zoomVal*this._pageSize[r-1].PageHeight+"px"):(x.width=this._pageSize[s-1].PageWidth*D,x.height=this._pageSize[s-1].PageHeight*D,x.style.height=this._pageSize[s-1].PageHeight+"px",x.style.width=this._pageSize[s-1].PageWidth+"px");var P,C=[],S=[],T=[],I=[],k=[],z=navigator.userAgent,A=[];for(this._regenerateFormFields(n,s),l=e("#"+this._id+"selectioncanvas_"+s).children(),_=0;_<l.length;_++)(l[_].hasAttribute("href")||e(l[_]).hasClass("e-pdfviewer-formFields"))&&e(l[_]).remove();if(this._createFormFields(n,s),null!=(d=a.textelements).imagedata&&n.isPdfRenderingEngine){var D=1,B=d.imagedata,R=new Image,E=this;R.onload=function(){E._renderImages(x,R,x.width,x.height,D),"Landscape"==E._pageSize[r-1].PageOrientation&&E._renderLandspaceImages(!1,x,r,P)},R.src=B[0]}for(h=0;h<d.length;h++){var N=d[h],O=N.color,V=N.matrix;null!=V&&(V=V.Elements);var L=N.brush,M=N.pathValue,F=N.iscliping,j=N.restorecanvas,H=N.imagedata,W=N.fillrule,U=N.isFillandStroke,Y=N.fillcolor,X=N.strokecolor,Z=N.linewidth,J=N.linecap,G=N.linearGradientBrush,q=N.textureBrushs,K=N.charID,$=N.alpha;if(null!=M?(M=M.split(";"),K&&(A[K]=M)):null==M&&K&&(M=A[K]),0==j&&ee.save(),M!=o&&ee.setTransform(V[0]*D,V[1]*D,V[2]*D,V[3]*D,V[4]*D,V[5]*D),null!=M){for(ee.beginPath(),_=0;_<M.length;_++)"M"==(p=(c=M[_])[0])?(c=(c=c.substring(1,c.length)).split(" "),ee.moveTo(c[0],c[1])):"L"==p?(c=(c=c.substring(1,c.length)).split(" "),ee.lineTo(c[0],c[1])):"C"==p?(c=(c=c.substring(1,c.length)).split(" "),ee.bezierCurveTo(c[0],c[1],c[2],c[3],c[4],c[5])):"Z"==p&&ee.closePath();1==F?("evenodd"==W&&(ee.msFillRule="evenodd",ee.mozFillRule="evenodd",ee.clip(W)),ee.clip()):U==o?"Fill"==L?(G!=o?ee.fillStyle=this._getGradientBrush(G,ee):q!=o?ee.fillStyle=this._createTextureBrush(q,ee,N):($!=o&&(ee.globalAlpha=$),ee.fillStyle=O),"evenodd"==W&&(ee.msFillRule="evenodd",ee.mozFillRule="evenodd",ee.fill(W)),ee.fill()):"FillandStroke"==L?(ee.fillStyle=O,ee.fill(),ee.strokeStyle=X,ee.stroke()):"Stroke"==L?(ee.strokeStyle=X,ee.lineWidth=Z,ee.lineCap=J,ee.stroke()):(ee.strokeStyle=O,ee.lineWidth=Z,ee.lineCap=J,ee.stroke()):(ee.strokeStyle=X,ee.lineWidth=Z,ee.lineCap=J,ee.stroke(),ee.fillStyle=G!=o?this._getGradientBrush(G,ee):q!=o?this._createTextureBrush(q,ee,N):Y,"evenodd"==W&&(ee.msFillRule="evenodd",ee.mozFillRule="evenodd",ee.fill(W)),ee.fill())}if(j&&ee.restore(),H!=o){if(!(-1==(P=z.indexOf("Firefox"))&&-1==(P=z.indexOf("Chrome"))&&-1==(P=z.indexOf("Safari"))&&-1==(P=z.indexOf("AppleWebKit"))||this._topValue)){C.push(H),S.push(V),k.push(d),I.push(h),this._isContainImage=!0;break}(g=new Image).src=H,ee.setTransform(V[0]*D,V[1]*D,V[2]*D,V[3]*D,V[4]*D,V[5]*D),ee.drawImage(g,0,0,1,1)}}if(-1!=(P=z.indexOf("Firefox"))||-1!=(P=z.indexOf("Chrome"))||-1!=(P=z.indexOf("Safari"))||-1!=(P=z.indexOf("AppleWebKit")))for(u=0;u<C.length;u++)this._printWinImageRendering(d,T,C,S,ee,u,k,I,A,x,r,m),m++;if(f=x,E=this,0!=this._pageSize[r-1].PageRotation&&90!=this._pageSize[r-1].PageRotation&&(0==C.length||-1==z.indexOf("Firefox")&&-1==z.indexOf("Chrome"))){var Q=(f=document.getElementById(this._id+"pagecanvas_"+parseInt(n.currentpage))).toDataURL(),ee=f.getContext("2d"),te=(D=E._scalingTextContent(ee),new Image);-1!=z.indexOf("Firefox")?(te.onload=function(){ee.clearRect(0,0,f.width,f.height),270==E._pageSize[r-1].PageRotation?(f.width=E._zoomVal*E._pageSize[r-1].PageHeight*D,f.height=E._zoomVal*E._pageSize[r-1].PageWidth*D,f.style.height=E._zoomVal*E._pageSize[r-1].PageWidth+"px",f.style.width=E._zoomVal*E._pageSize[r-1].PageHeight+"px"):(f.width=E._zoomVal*E._pageSize[r-1].PageWidth*D,f.height=E._zoomVal*E._pageSize[r-1].PageHeight*D,f.style.height=E._zoomVal*E._pageSize[r-1].PageHeight+"px",f.style.width=E._zoomVal*E._pageSize[r-1].PageWidth+"px"),ee.save(),ee.translate(f.width/2,f.height/2),ee.rotate(E._pageSize[r-1].PageRotation/2*Math.PI/2),ee.drawImage(te,-te.width/2,-te.height/2),ee.restore()},te.src=Q):(ee.clearRect(0,0,f.width,f.height),270==E._pageSize[r-1].PageRotation?(f.width=E._zoomVal*E._pageSize[r-1].PageHeight*D,f.height=E._zoomVal*E._pageSize[r-1].PageWidth*D,f.style.height=E._zoomVal*E._pageSize[r-1].PageWidth+"px",f.style.width=E._zoomVal*E._pageSize[r-1].PageHeight+"px"):(f.width=E._zoomVal*E._pageSize[r-1].PageWidth*D,f.height=E._zoomVal*E._pageSize[r-1].PageHeight*D,f.style.height=E._zoomVal*E._pageSize[r-1].PageHeight+"px",f.style.width=E._zoomVal*E._pageSize[r-1].PageWidth+"px"),ee.save(),ee.translate(f.width/2,f.height/2),ee.rotate(E._pageSize[r-1].PageRotation/2*Math.PI/2),te.src=Q,ee.drawImage(te,-te.width/2,-te.height/2),ee.restore())}return this._renderLandspaceImages(n.isPdfRenderingEngine,x,r,P),this._showPageLoadingIndicator(s,!1),this._changingImageCanvasPosition(s),this._showSignature(),f},_renderLandspaceImages:function(e,t,i,o){var n,s=navigator.userAgent,a=this._scalingTextContent();if(this._pageSize[i-1].PageWidth>this._pageSize[i-1].PageHeight&&!e){var r=new Image,l=new Image,d=t.toDataURL(),h=this._pageSize[i-1].PageHeight,_=this._pageSize[i-1].PageWidth,c=document.getElementById(this._id+"_secondarycanvas_"+i);-1!=s.indexOf("Firefox")||-1!=s.indexOf("Chrome")||-1!=s.indexOf("Safari")||-1!=s.indexOf("AppleWebKit")?(n=this,r.onload=function(){n._renderRotatedImages(t,r,h,_,a)},r.src=d,l.onload=function(){n._renderRotatedImages(c,l,h,_,a)},l.src=c.toDataURL()):(r.src=d,this._renderRotatedImages(t,r,h,_,a),c.src=c.toDataURL(),this._renderRotatedImages(c,l,h,_,a))}},_renderRotatedImages:function(e,t,i,o,n){var s=e.getContext("2d");e.width=i*n,e.height=o*n,e.style.height=o+"px",e.style.width=i+"px",s.save(),s.translate(e.width/2,e.height/2),s.rotate(-Math.PI/2),s.drawImage(t,-t.width/2,-t.height/2),s.restore()},_printWinImageRendering:function(e,t,i,n,s,a,r,l,d,h,_,c){var p=this,g=new Image;g.onload=function(){for(var g,u,f,m,v,w=!1,x=n[a],b=0;b<n.length;b++)if(W=p._scalingTextContent(s),0==w)for(x=n[b],s.setTransform(x[0]*W,x[1]*W,x[2]*W,x[3]*W,x[4]*W,x[5]*W),t[c]!=o&&s.drawImage(t[c],0,0,1,1),g=l[b],g+=1,u=r[b];g<u.length;){var y=u[g],P=y.color,C=y.matrix;null!=C&&(C=C.Elements);var S=y.brush,T=y.pathValue,I=y.iscliping,k=y.restorecanvas,z=y.imagedata,A=y.fillrule,D=y.isFillandStroke,B=y.fillcolor,R=y.strokecolor,E=y.linewidth,N=y.linecap,O=y.linearGradientBrush,V=y.textureBrushs,L=y.charID,M=(y.rectvalue,y.alpha);if(null!=T?(T=T.split(";"),L&&(d[L]=T)):null==T&&L&&(T=d[L]),0==k&&s.save(),T!=o&&s.setTransform(C[0]*W,C[1]*W,C[2]*W,C[3]*W,C[4]*W,C[5]*W),null!=T){for(s.beginPath(),f=0;f<T.length;f++)"M"==(v=(m=T[f])[0])?(m=(m=m.substring(1,m.length)).split(" "),s.moveTo(m[0],m[1])):"L"==v?(m=(m=m.substring(1,m.length)).split(" "),s.lineTo(m[0],m[1])):"C"==v?(m=(m=m.substring(1,m.length)).split(" "),s.bezierCurveTo(m[0],m[1],m[2],m[3],m[4],m[5])):"Z"==v&&s.closePath();1==I?("evenodd"==A&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.clip(A)),s.clip()):D==o?"Fill"==S?(O!=o?s.fillStyle=p._getGradientBrush(O,s):V!=o?s.fillStyle=p._createTextureBrush(V,s,y):(M!=o&&(s.globalAlpha=M),s.fillStyle=P),"evenodd"==A&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(A)),s.fill()):"FillandStroke"==S?(s.fillStyle=P,s.fill(),s.strokeStyle=R,s.stroke()):"Stroke"==S?(s.strokeStyle=R,s.lineWidth=E,s.lineCap=N,s.stroke()):(s.strokeStyle=P,s.lineWidth=E,s.lineCap=N,s.stroke()):(s.strokeStyle=R,s.lineWidth=E,s.lineCap=N,s.stroke(),s.fillStyle=O!=o?p._getGradientBrush(O,s):V!=o?p._createTextureBrush(V,s,y):B,"evenodd"==A&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(A)),s.fill())}if(k&&s.restore(),z!=o){w=!0,i.pop(),n.pop(),r.pop(),l.pop(),i.push(z),n.push(C),r.push(e),l.push(g),b=-1,c++;break}g++}else p._printWinImageRendering(e,t,i,n,s,b,r,l,d,h,_,c),c++;if(t.length-1==a&&0!=p._pageSize[_-1].PageRotation){var F=document.getElementById(p._id+"pagecanvas_"+_),j=F.toDataURL(),H=F.getContext("2d"),W=p._scalingTextContent(s);(U=new Image).onload=function(){H.clearRect(0,0,F.width,F.height),90==p._pageSize[_-1].PageRotation||270==p._pageSize[_-1].PageRotation?(F.width=p._zoomVal*p._pageSize[_-1].PageHeight*W,F.height=p._zoomVal*p._pageSize[_-1].PageWidth*W,F.style.height=p._zoomVal*p._pageSize[_-1].PageWidth+"px",F.style.width=p._zoomVal*p._pageSize[_-1].PageHeight+"px"):(F.width=p._zoomVal*p._pageSize[_-1].PageWidth*W,F.height=p._zoomVal*p._pageSize[_-1].PageHeight*W,F.style.width=p._zoomVal*p._pageSize[_-1].PageWidth+"px",F.style.height=p._zoomVal*p._pageSize[_-1].PageHeight+"px"),H.save(),H.translate(F.width/2,F.height/2),H.rotate(p._pageSize[_-1].PageRotation/2*Math.PI/2),H.drawImage(U,-U.width/2,-U.height/2),H.restore()},U.src=j}if(p._pageSize[_-1].PageWidth>p._pageSize[_-1].PageHeight){var U=new Image,Y=new Image,X=(j=h.toDataURL(),p._pageSize[_-1].PageHeight),Z=p._pageSize[_-1].PageWidth,J=document.getElementById(p._id+"_secondarycanvas_"+_),G=navigator.userAgent;-1!=(offsett=G.indexOf("Firefox"))||-1!=(offsett=G.indexOf("Chrome"))||-1!=(offsett=G.indexOf("Safari"))||-1!=(offsett=G.indexOf("AppleWebKit"))?(U.onload=function(){p._renderRotatedImages(h,U,X,Z,W)},U.src=j,Y.onload=function(){p._renderRotatedImages(J,Y,X,Z,W)},Y.src=J.toDataURL()):(U.src=j,p._renderRotatedImages(h,U,X,Z,W),Y.onload=function(){p._renderRotatedImages(J,Y,X,Z,W)},Y.src=J.toDataURL())}},g.src=i[a],t.push(g),this._imageObj.push(g)},_showPrintButton:function(t){t?(e("#"+this._id+"_toolbar_Print").parent().parents(".e-pdfviewer-toolbarul").css("display","block"),this._isPrintHidden=!1):(e("#"+this._id+"_toolbar_Print").parent().parents(".e-pdfviewer-toolbarul").css("display","none"),this._isPrintHidden=!0)},_showDownloadButton:function(t){t?(e("#"+this._id+"_toolbar_download").parent().parents(".e-pdfviewer-toolbarul").css("display","block"),this._isDownloadHidden=!1):(e("#"+this._id+"_toolbar_download").parent().parents(".e-pdfviewer-toolbarul").css("display","none"),this._isDownloadHidden=!0)},_updatePageNavigation:function(e,t){e>1&&e<t?(this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotofirst"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotolast")):1==e&&e<t?(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotofirst"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotolast")):e==t&&1!=t?(this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotofirst"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotolast")):(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotofirst"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotolast")),this._isJsondataAvailable||(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotofirst"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotolast")),this.currentPageNumber=this._currentPage},_gotoFirstPage:function(){this._totalPages&&this._totalPages>0&&(this._currentPage=1,document.getElementById(this._id+"_viewerContainer").scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),this._pageviewscrollchanged(this._pageHeight),this._updatePageNavigation(this._currentPage,this._totalPages))},_gotoLastPage:function(){this._totalPages&&this._totalPages>0&&(this._currentPage=this._totalPages,document.getElementById(this._id+"_viewerContainer").scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),this._pageviewscrollchanged(this._pageHeight),this._updatePageNavigation(this._currentPage,this._totalPages))},_gotoNextPage:function(){this._totalPages&&this._currentPage<this._totalPages&&(this._currentPage=this._currentPage+1,document.getElementById(this._id+"_viewerContainer").scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),this._pageviewscrollchanged(this._pageHeight),this._updatePageNavigation(this._currentPage,this._totalPages))},_gotoPreviousPage:function(){this._totalPages&&this._currentPage>1&&(this._currentPage=this._currentPage-1,document.getElementById(this._id+"_viewerContainer").scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),this._pageviewscrollchanged(this._pageHeight),this._updatePageNavigation(this._currentPage,this._totalPages))},_gotoPageNo:function(e){var t,i={currentPageNumber:0},o=e,n=this._currentPage;this._totalPages&&((t=parseInt(e))>=1&&t<=this._totalPages&&this._currentPage!=t&&(this._currentPage=t,document.getElementById(this._id+"_viewerContainer").scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),this._pageviewscrollchanged(this._pageHeight),this._updatePageNavigation(this._currentPage,this._totalPages))),n!=o&&(i.currentPageNumber=o,this._raiseClientEvent("pageChange",i))},_gotoPage:function(t){var i,o;this._setPageSize(this._pageHeight,this._pageWidth,null,null),i=parseInt(t),this._updatePageNavigation(i,this._totalPages),o=parseFloat(e("#"+this._id+"_toolbarContainer").css("height")),this._totalPages>0&&this._totalPages&&(e("#"+this._id+"_toolbarContainer span.e-pdfviewer-labelpageno").html(" / "+this._totalPages),o!=parseFloat(e("#"+this._id+"_toolbarContainer").css("height"))&&(this._isToolbarHeightChanged=!0),e("#"+this._id+"_txtpageNo").val(i))},_allowOnlyNumbers:function(e){return!(e.which<48||e.which>57)||8==e.which||13==e.which},_onkeyPress:function(t){if(13==t.which){t.preventDefault();try{var i=parseInt(e(t.currentTarget).val());i>0&&i<=this.pageCount?this._gotoPageNo(i):e(t.currentTarget).val(this.currentPageNumber)}catch(e){}}},_showPageNavigationControls:function(t){t?(e("#"+this._id+"_txtpageNo").parents(".e-pdfviewer-toolbarul").css("display","block"),e("#"+this._id+"_toolbar_Print").parent().parents(".e-pdfviewer-toolbarul").css("border-right-width","1px"),this._isNavigationHidden=!1):(e("#"+this._id+"_txtpageNo").parents(".e-pdfviewer-toolbarul").css("display","none"),this._isNavigationHidden=!0,!this._isPrintHidden&&this._isNavigationHidden&&this._isMagnificationHidden&&e("#"+this._id+"_toolbar_Print").parent().parents(".e-pdfviewer-toolbarul").css("border-right-width","0px"))},_showFittoPage:function(t){t?(e("#"+this._id+"_fitWidth").parents("li.e-pdfviewer-toolbarli").css("display","block"),e("#"+this._id+"_fitPage").parents("li.e-pdfviewer-toolbarli").css("display","block"),e("#"+this._id+"_fitPage").parents("ul.e-pdfviewer-toolbarul").css("display","block")):(e("#"+this._id+"_fitWidth").parents("li.e-pdfviewer-toolbarli").css("display","none"),e("#"+this._id+"_fitPage").parents("li.e-pdfviewer-toolbarli").css("display","none"),e("#"+this._id+"_fitPage").parents("ul.e-pdfviewer-toolbarul").css("display","none"))},_resetPage:function(){var t=e("#"+this._id+"_pageviewContainer"),i=e("#"+this._id+"_pageviewOuterline");t[0]!=o&&(i.css({width:t.width(),height:t.height()}),i.css({width:t[0].getBoundingClientRect().width,height:t[0].getBoundingClientRect().height}))},_applyFitToWidth:function(){this._isAutoZoom=!1,this._isAutoSelected=!1;var e=this._fitToPage("fitToWidth");this._applyDropDownVal(e,!0,!1),this._updatePageFitModel(this._fitType),this.model.isResponsive=!1},_applyFitToPage:function(){this._isAutoZoom=!1,this._isAutoSelected=!1;var e=this._fitToPage("fitToPage");this._applyDropDownVal(e,!1,!0),this._updatePageFitModel(this._fitType),this.model.isResponsive=!1},_updatePageFitModel:function(t){"fitToWidth"==t?(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"),e("#"+this._id+"_pageviewContainer").find(".e-waitingpopup").css("visibility",""),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitPage")):"fitToPage"==t&&(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_fitPage"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"))},_applyFitToWidthAuto:function(){var e=this._fitToAuto("fitToWidth");this._applyDropDownValAuto(e,!0,!1)},_fitToAuto:function(){this._resetPage();var t=e("#"+this._id+"_viewerContainer");e("#"+this._id+"_pageviewContainer"),e("#"+this._id+"_pageviewOuterline");if(t[0]!=o){var i,n=t.width(),s=(t.height(),this._pageWidth),a=(this._pageHeight,1);return a=(n-25)/s,this._isAutoZoom&&(window.innerHeight!=screen.height&&(a=Math.min(1,a)),1==a&&(this._zoomLevelBackup=this._zoomLevel=3)),window.innerWidth>=screen.width&&(this._isWindowResizing=!1),i=a,this._zoomVal=a,this._fitToAutoSize(),this._calculateZoomLevel(this._zoomVal),this._initRerendering(),this._updateZoomButtons(),{scalX:a,scalY:i}}},_fitToPage:function(t){var i,n,s,a,r;if(this._pageSize!=o){this._resetPage();var l=e("#"+this._id+"_viewerContainer"),d=(e("#"+this._id+"_pageviewContainer"),e("#"+this._id+"_pageviewOuterline"),l.width()),h=l.height();if("fitToWidth"==t)for(n=0;n<this._pageSize.length;n++)i=0,(i=90==this._pageSize[n].PageRotation||270==this._pageSize[n].PageRotation?this._pageSize[n].PageHeight:this._pageSize[n].PageWidth)>this._highestWidth&&(this._highestWidth=i);else this._highestWidth=this._pageWidth;if("fitToPage"==t)for(n=0;n<this._pageSize.length;n++)s=0,(s=90==this._pageSize[n].PageRotation||270==this._pageSize[n].PageRotation?this._pageSize[n].PageWidth:this._pageSize[n].PageHeight)>this._highestHeight&&(this._highestHeight=s);else this._highestHeight=this._PageHeight;var _=this._highestWidth,c=this._highestHeight,p=1,g=1;return this._fitType=t,"fitToPage"==t?(p=(d-25)/_,g=h/c,h>c&&(g=this._preZoomVal),d>_&&(p=this._preZoomVal),p="fitToPage"==this._fitType&&"Landscape"==this._pageSize[this._currentPage-1].PageOrientation&&p<g?p:g,this._zoomVal=p,this._zoomInContainer(),this._calculateZoomLevel(this._zoomVal),e("#"+this._id+"pageDiv_"+(this._currentPage+1)).css("visibility","hidden"),a=this,r=document.getElementById(this._id+"_viewerContainer"),e("#"+this._id+"_viewerContainer").on("mousewheel DOMMouseScroll",function(t){var i=document.getElementById(a._id+"_viewerContainer");"true"==e("#"+a._id+"_pdfviewer_toolbar_fitPage").attr("aria-disabled")&&(t.originalEvent.wheelDelta>0||t.originalEvent.detail<0?a._currentPage>1&&(e("#"+a._id+"pageDiv_"+(a._currentPage-1)).css("visibility",""),i.scrollTop=parseFloat(a._pageLocation[a._currentPage-1]*a._zoomVal),e("#"+a._id+"pageDiv_"+a._currentPage).css("visibility","hidden")):a._currentPage!=a._totalPages&&(e("#"+a._id+"pageDiv_"+(a._currentPage+1)).css("visibility",""),i.scrollTop=parseFloat(a._pageLocation[a._currentPage+1]*a._zoomVal),a._currentPage+1==a._totalPages?e("#"+a._id+"pageDiv_"+a._currentPage).css("visibility","hidden"):e("#"+a._id+"pageDiv_"+(a._currentPage+2)).css("visibility","hidden")),t.preventDefault())}),e(window).on("keydown",function(t){var i=document.getElementById(a._id+"_viewerContainer");"true"==e("#"+a._id+"_pdfviewer_toolbar_fitPage").attr("aria-disabled")&&(a._currentPage>1&&"38"==t.keyCode?(e("#"+a._id+"pageDiv_"+(a._currentPage-1)).css("visibility",""),i.scrollTop=parseFloat(a._pageLocation[a._currentPage-1]*a._zoomVal),e("#"+a._id+"pageDiv_"+a._currentPage).css("visibility","hidden")):a._currentPage!=a._totalPages&&"40"==t.keyCode&&(e("#"+a._id+"pageDiv_"+(a._currentPage+1)).css("visibility",""),i.scrollTop=parseFloat(a._pageLocation[a._currentPage+1]*a._zoomVal),a._currentPage+1==a._totalPages?e("#"+a._id+"pageDiv_"+a._currentPage).css("visibility","hidden"):e("#"+a._id+"pageDiv_"+(a._currentPage+2)).css("visibility","hidden")))}),r.scrollTop=parseFloat(this._pageLocation[this._currentPage]*this._zoomVal),e("#"+a._id+"pageDiv_"+(a._currentPage-1)).css("visibility","hidden"),e("#"+a._id+"pageDiv_"+(a._currentPage+1)).css("visibility","hidden")):"fitToWidth"==t&&(g=p=(d-25)/_,this._zoomVal=p,this._zoomInContainer(),this._calculateZoomLevel(this._zoomVal)),this._updateZoomButtons(),{scalX:p,scalY:g}}},_selectDropDownIndex:function(t){var i=e(e("#"+this._id+"_toolbar_zoomSelection_popup li")[t]);i.addClass("e-active"),e("#"+this._id+"_toolbar_zoomSelection_input").val(i.text())},_applyDropDownVal:function(t,i,n){if(t!=o)if(n){var s=t.scalX>t.scalY?t.scalY:t.scalX;e("#"+this._id+"_toolbar_zoomSelection_hidden").val(Math.round(100*s)+"%"),this._ejDropDownInstance.model.value=Math.round(100*s)+"%",this._ejDropDownInstance.model.selectedIndices[0]="",e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active")}else i?(e("#"+this._id+"_toolbar_zoomSelection_hidden").val(Math.round(100*t.scalX)+"%"),this._ejDropDownInstance.model.value=Math.round(100*t.scalX)+"%",this._ejDropDownInstance.model.selectedIndices[0]="",e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active")):(e("#"+this._id+"_toolbar_zoomSelection_hidden").val(Math.round(100*t.scalY)+"%"),this._ejDropDownInstance.model.value=Math.round(100*t.scalY)+"%",this._ejDropDownInstance.model.selectedIndices[0]="",e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active"))},_applyDropDownValAuto:function(i){if(this._isAutoZoom){var o=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.auto.contentText;e("#"+this._id+"_toolbar_zoomSelection_hidden").val(o),this._ejDropDownInstance.model.value=o}else e("#"+this._id+"_toolbar_zoomSelection_hidden").val(Math.round(100*i.scalY)+"%"),this._ejDropDownInstance.model.value=Math.round(100*i.scalY)+"%",this._ejDropDownInstance.model.selectedIndices[0]="";e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active")},_showFitToPagetip:function(){var t,i,o=e("#"+this._id+"_toolbar_fittoPagePopup");o.length>0||(o=this._renderPageFitPopup(),e("body").append(o),this._on(e("#"+this._id+"_toolbar_fittoPagePopup li.e-pdfviewer-popupli"),"click",this._pageFitMenuClick)),"block"==o.css("display")?o.css("display","none"):o.css("display","block"),t=e("#"+this._id+"_toolbarContainer .e-pdfviewer-pagefit")[0].getBoundingClientRect(),i=e(e("#"+this._id+"_toolbarContainer .e-pdfviewer-pagefit")[0]).offset(),o.css({top:i.top+t.height-3,left:i.left-5})},_zoomValChange:function(i){var n,s,a;if(!this._ejViewerInstance)var r=this._id.split("_toolbar")[0],l=e("#"+r).ejPdfViewer("instance");s=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.auto.contentText,i.value!=o?(i.value==s||0==i.model.selectedItemIndex?(l.model.isResponsive=!0,n=1,l._zoomLevel=3,l._isAutoZoom=!0,l._isAutoSelected=!0):(n=parseInt(i.value)/100,l.model.isResponsive=!1,l._zoomLevel=i.itemId,l._isAutoZoom=!1,l._isAutoSelected=!1),l._zoomContainer(n,!1)):i.target.innerHTML!=o&&(a=i.target.innerHTML,i.target.innerHTML==s?(l.model.isResponsive=!0,n=1,l._isAutoZoom=!0):(a=a.substring(0,a.length-1),n=parseInt(a)/100,l.model.isResponsive=!1,l._isAutoZoom=!1),l._zoomContainer(n,!1))},_zoomIn:function(){(this._zoomLevel>=7?this._zoomLevel=7:this._zoomLevel++,this._isDevice)?this._mobileLayoutZoomChange():e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList")._selectItemByIndex(this._zoomLevel);this.model.isResponsive=!1},_zoomOut:function(){(this._zoomLevel<=1?this._zoomLevel=1:this._zoomLevel--,this._isDevice)?this._mobileLayoutZoomChange():e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList")._selectItemByIndex(this._zoomLevel);this.model.isResponsive=!1},_zoomInContainer:function(t,i){var n,s,a,r,l,d,h,_,c,p,g,u,f;this._hidingSignature();var m=i,v=e("#"+this._id+"_viewerContainer"),w=e("#"+this._id+"_pageviewContainer");this._selectionNodes=window.getSelection(),e(".e-pdfviewer-formFields").hide(),0==this._selectionNodes.anchorOffset&&0==this._selectionNodes.focusOffset||this._maintainSelection(),t&&(this._zoomVal=this._zoomVal+m);var x=w.width(),b=(w.height(),{currentZoomPercentage:0,previousZoomPercentage:0}),y=document.getElementById(this._id+"_viewerContainer"),P=y.scrollTop/this._previousZoom*this._zoomVal;this._zoomVal,this._zoomVal;for(u=1;u<=this._totalPages;u++)this._ispdfium&&this._zoomVal>1&&(this._pageContents[u]=null),s=0,90==this._pageSize[u-1].PageRotation||270==this._pageSize[u-1].PageRotation?(n=(this.element.width()-this._pageSize[u-1].PageHeight*this._zoomVal)/2,s=this._pageSize[u-1].PageHeight):(n=(this.element.width()-this._pageSize[u-1].PageWidth*this._zoomVal)/2,s=this._pageSize[u-1].PageWidth),a=n+this._pageSize[u-1].PageWidth*this._zoomVal,(n<0||"fitToWidth"==this._fitType&&s==this._highestWidth||"fitToPage"==this._fitType&&"Landscape"==this._pageSize[u-1].PageOrientation&&a>x)&&(n=5),(r=document.getElementById(this._id+"pagecanvas_"+u))!=o&&(l=document.getElementById(this._id+"_secondarycanvas_"+u),d=r.getContext("2d"),90==this._pageSize[u-1].PageRotation||270==this._pageSize[u-1].PageRotation?(r.height=this._pageSize[u-1].PageWidth*this._zoomVal,r.width=this._pageSize[u-1].PageHeight*this._zoomVal,r.style.height=this._pageSize[u-1].PageWidth*this._zoomVal+"px",r.style.width=this._pageSize[u-1].PageHeight*this._zoomVal+"px",h=this._pageSize[u-1].PageWidth*this._zoomVal,_=this._pageSize[u-1].PageHeight*this._zoomVal,r.style.width=_+"px",r.style.height=h+"px",l.width=_,l.height=h,l.style.width=_+"px",l.style.height=h+"px"):(r.height=this._pageSize[u-1].PageHeight*this._zoomVal,r.width=this._pageSize[u-1].PageWidth*this._zoomVal,r.style.height=this._pageSize[u-1].PageHeight*this._zoomVal+"px",r.style.width=this._pageSize[u-1].PageWidth*this._zoomVal+"px",h=this._pageSize[u-1].PageHeight*this._zoomVal,_=this._pageSize[u-1].PageWidth*this._zoomVal,r.style.width=_+"px",r.style.height=h+"px",l.width=_,l.height=h,l.style.width=_+"px",l.style.height=h+"px"),d.clearRect(0,0,r.clientWidth,r.clientHeight),(c=e("#"+this._id+"pageDiv_"+u))[0].style.top=this._pageLocation[u]*this._zoomVal+"px",c[0].style.left=n+"px",c[0].style.width=_+"px",c[0].style.height=h+"px",(p=document.getElementById(this._id+"selectioncanvas_"+u)).style.height=r.height+"px",p.style.width=r.width+"px",p.style.position="absolute",p.style.left=0,p.style.top=0,p.style.backgroundColor="transparent",p.style.zIndex="2",e("#"+this._id+"selectioncanvas_"+u).hasClass("text_container")&&null!=this._pageContents[parseInt(u)]&&this._resizeSelection(JSON.parse(this._pageContents[parseInt(u)]),u,d),this._isAutoZoom||(e("#"+this._id+"pageDiv_"+u+"_WaitingPopup").css({display:"block",height:r.height+"px",width:r.width+"px",left:"0px",top:"0px"}),(g=document.getElementById(this._id+"pageDiv_"+u+"_WaitingPopup").childNodes[0]).style.top=(r.height-g.clientHeight)/2+"px"));if(this._renderedCanvasList&&(this._renderedCanvasList.length=0),this._zoomVal<1?v.css({"-ms-scroll-limit-y-max":this._cummulativeHeight*this._zoomVal-this.element.height()+50+"px"}):v.css({"-ms-scroll-limit-y-max":""}),this._imageObj)for(u=0;u<this._imageObj.length;u++)this._imageObj[u].onload=null;e("#"+this._id+"_popupmenu").hide(),this._isPopupNoteVisible=!1,y.scrollTop=P,this._eventpreviouszoomvalue=this._preZoomVal,this._eventzoomvalue=this._zoomVal,this._preZoomVal=this._zoomVal,this._previousZoom=this._zoomVal,b.previousZoomPercentage=Math.round(100*this._eventpreviouszoomvalue),b.currentZoomPercentage=Math.round(100*this._eventzoomvalue),this._raiseClientEvent("zoomChange",b),this.zoomPercentage=Math.round(100*this._zoomVal),this._highestWidth=0,this._highestHeight=0,f=[],this._selectedAnnotationObject&&(f.push(this._selectedAnnotationObject.annotation),this._drawAnnotSelectRect(this._selectedAnnotationObject.pageIndex,f))},_zoomOutContainer:function(t,i){var o,n,s,a,r,l,d,h;this._hidingSignature();var _=i,c=e("#"+this._id+"_viewerContainer"),p=e("#"+this._id+"_pageviewContainer");this._selectionNodes=window.getSelection(),e(".e-pdfviewer-formFields").hide(),0==this._selectionNodes.anchorOffset&&0==this._selectionNodes.focusOffset||this._maintainSelection(),t&&(this._zoomVal=this._zoomVal+_);p.width(),p.height();var g={currentZoomPercentage:0,previousZoomPercentage:0},u=document.getElementById(this._id+"_viewerContainer"),f=u.scrollTop/this._previousZoom*this._zoomVal;this._zoomVal,this._zoomVal;for(d=1;d<=this._totalPages;d++){this._ispdfium&&this._zoomVal>1&&(this._pageContents[d]=null),(o=90==this._pageSize[d-1].PageRotation||270==this._pageSize[d-1].PageRotation?(this.element.width()-this._pageSize[d-1].PageHeight*this._zoomVal)/2:(this.element.width()-this._pageSize[d-1].PageWidth*this._zoomVal)/2)<0&&(o=5);var m=document.getElementById(this._id+"pagecanvas_"+d),v=m.getContext("2d"),w=document.getElementById(this._id+"_secondarycanvas_"+d);90==this._pageSize[d-1].PageRotation||270==this._pageSize[d-1].PageRotation?(m.height=this._pageSize[d-1].PageWidth*this._zoomVal,m.width=this._pageSize[d-1].PageHeight*this._zoomVal,m.style.height=this._pageSize[d-1].PageWidth*this._zoomVal+"px",m.style.width=this._pageSize[d-1].PageHeight*this._zoomVal+"px",n=this._pageSize[d-1].PageWidth*this._zoomVal,s=this._pageSize[d-1].PageHeight*this._zoomVal,m.style.width=s+"px",m.style.height=n+"px",w.width=s,w.height=n,w.style.width=s+"px",w.style.height=n+"px"):(m.height=this._pageSize[d-1].PageHeight*this._zoomVal,m.width=this._pageSize[d-1].PageWidth*this._zoomVal,m.style.height=this._pageSize[d-1].PageHeight*this._zoomVal+"px",m.style.width=this._pageSize[d-1].PageWidth*this._zoomVal+"px",n=this._pageSize[d-1].PageHeight*this._zoomVal,s=this._pageSize[d-1].PageWidth*this._zoomVal,m.style.width=s+"px",m.style.height=n+"px",w.width=s,w.height=n,w.style.width=s+"px",w.style.height=n+"px"),v.clearRect(0,0,m.clientWidth,m.clientHeight),(a=e("#"+this._id+"pageDiv_"+d))[0].style.top=this._pageLocation[d]*this._zoomVal+"px",a[0].style.left=o+"px",a[0].style.width=s+"px",a[0].style.height=n+"px",(r=document.getElementById(this._id+"selectioncanvas_"+d)).style.height=m.height+"px",r.style.width=m.width+"px",r.style.position="absolute",r.style.left=0,r.style.top=0,r.style.backgroundColor="transparent",r.style.zIndex="2",e("#"+this._id+"selectioncanvas_"+d).hasClass("text_container")&&null!=this._pageContents[parseInt(d)]&&this._resizeSelection(JSON.parse(this._pageContents[parseInt(d)]),d,v),e("#"+this._id+"pageDiv_"+d+"_WaitingPopup").css({display:"block",height:m.height+"px",width:m.width+"px",left:"0px",top:"0px"}),(l=document.getElementById(this._id+"pageDiv_"+d+"_WaitingPopup").childNodes[0]).style.top=(m.height-l.clientHeight)/2+"px"}if(this._renderedCanvasList&&(this._renderedCanvasList.length=0),this._zoomVal<1?c.css({"-ms-scroll-limit-y-max":this._cummulativeHeight*this._zoomVal-this.element.height()+50+"px"}):c.css({"-ms-scroll-limit-y-max":""}),this._imageObj)for(d=0;d<this._imageObj.length;d++)this._imageObj[d].onload=null;e("#"+this._id+"_popupmenu").hide(),this._isPopupNoteVisible=!1,u.scrollTop=f,this._eventpreviouszoomvalue=this._preZoomVal,this._eventzoomvalue=this._zoomVal,this._previousZoom=this._zoomVal,g.previousZoomPercentage=Math.round(100*this._eventpreviouszoomvalue),g.currentZoomPercentage=Math.round(100*this._eventzoomvalue),this._raiseClientEvent("zoomChange",g),this.zoomPercentage=Math.round(100*this._zoomVal),h=[],this._selectedAnnotationObject&&(h.push(this._selectedAnnotationObject.annotation),this._drawAnnotSelectRect(this._selectedAnnotationObject.pageIndex,h))},_zoomContainer:function(t,i){if(this._fitType=null,this._zoomVal=t,e("#"+this._id+"_pageviewContainer").find(".e-waitingpopup").css("visibility",""),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitPage"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"),this._isAutoZoom&&this._renderedCanvasList&&(this._isWindowResizing||this._isAutoSelected)&&!this._isViewerRestored)this._applyFitToWidthAuto(),t=this._zoomVal;else{var o=Math.abs(this._preZoomVal-t);if(0==o)return!1;this._preZoomVal>t?this._zoomOutContainer(i,o):this._zoomInContainer(i,o)}this._preZoomVal=t,this._updateZoomButtons()},_calculateZoomLevel:function(e){var t;this._calculateZoomArrayValues();for(var i=e,o=0,n=this._zoomArray.length-1;o<=n&&(0!=o||0!=n);)t=Math.round((o+n)/2),this._zoomArray[t]<=i?o=t+1:this._zoomArray[t]>=i&&(n=t-1);this._lowerZoomIndex=n,this._higherZoomIndex=o,this._zoomLevel=this._lowerZoomIndex},_applyLowerZoomIndex:function(){var e,t=0;for(this._calculateZoomArrayValues(),e=0;e<this._zoomArray.length;e++)this._preZoomVal!=this._zoomArray[e]&&t++;t==this._zoomArray.length&&(this._zoomLevel=this._lowerZoomIndex),this._fitType=null},_applyHigherZoomIndex:function(){var e,t=0;for(this._calculateZoomArrayValues(),e=0;e<this._zoomArray.length;e++)this._preZoomVal!=this._zoomArray[e]&&t++;t==this._zoomArray.length&&(this._zoomLevel=this._higherZoomIndex),this._fitType=null},_calculateZoomArrayValues:function(){var e,t,i;if(this._zoomArray==o)for(e=document.getElementById(this._id+"_toolbar_zoomSelection_popup").getElementsByTagName("li"),t=[],this._zoomArray=t,i=0;i<e.length;i++)t.push(parseInt(e[i].textContent)/100)},_updateZoomButtons:function(){this._zoomVal<=.5?(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_zoomout"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_zoomin")):4==this._zoomVal?(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_zoomin"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_zoomout")):(this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_zoomout"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_zoomin"))},_showZoomControl:function(t){t?(e("#"+this._id+"_toolbar_zoomin").parents("li.e-pdfviewer-toolbarli").css("display","block"),e("#"+this._id+"_toolbar_zoomout").parents("li.e-pdfviewer-toolbarli").css("display","block"),e("#"+this._id+"_toolbar_zoomSelection").parents("div.e-pdfviewer-ejdropdownlist").css("display","block"),this._isMagnificationHidden=!1):(e("#"+this._id+"_toolbar_zoomin").parents("li.e-pdfviewer-toolbarli").css("display","none"),e("#"+this._id+"_toolbar_zoomout").parents("li.e-pdfviewer-toolbarli").css("display","none"),e("#"+this._id+"_toolbar_zoomSelection").parents("div.e-pdfviewer-ejdropdownlist").css("display","none"),this._isMagnificationHidden=!0)},_fitToAutoSize:function(){this._zoomVal;for(var i,n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w,x=e("#"+this._id+"_viewerContainer"),b=e("#"+this._id+"_pageviewContainer"),y=(b.width(),b.height(),{currentZoomPercentage:0,previousZoomPercentage:0}),P=document.getElementById(this._id+"_viewerContainer"),C=P.scrollTop,S=C/this._previousZoom*this._zoomVal,T=(this._zoomVal,this._zoomVal,1);T<=this._totalPages;T++){if(this._ispdfium&&(this._pageContents[parseInt(T)]=null),i=90==this._pageSize[T-1].PageRotation||270==this._pageSize[T-1].PageRotation?(this.element.width()-this._pageSize[T-1].PageHeight*this._zoomVal)/2:(this.element.width()-this._pageSize[T-1].PageWidth*this._zoomVal)/2,(this._isAutoZoom&&this._zoomVal<1||i<0)&&(i=5),n=document.getElementById(this._id+"pagecanvas_"+T),s=document.getElementById(this._id+"_secondarycanvas_"+T),n!=o)if(a=n.getContext("2d"),90==this._pageSize[T-1].PageRotation||270==this._pageSize[T-1].PageRotation?(r=this._pageSize[T-1].PageWidth*this._zoomVal,l=this._pageSize[T-1].PageHeight*this._zoomVal):(r=this._pageSize[T-1].PageHeight*this._zoomVal,l=this._pageSize[T-1].PageWidth*this._zoomVal),n.style.height=r+"px",n.style.width=l+"px",-1!=this._renderedCanvasList.indexOf(T)?(s.style.width=l+"px",s.style.height=r+"px",s.height=this._pageSize[T-1].PageHeight*this._zoomVal,s.width=this._pageSize[T-1].PageWidth*this._zoomVal,this._clearRectOnClick(T)):(s.style.width=l+"px",s.style.height=r+"px",s.height=this._pageSize[T-1].PageHeight*this._zoomVal,s.width=this._pageSize[T-1].PageWidth*this._zoomVal),(d=e("#"+this._id+"pageDiv_"+T))[0].style.top=this._pageLocation[T]*this._zoomVal+"px",d[0].style.left=i+"px",d[0].style.width=l+"px",d[0].style.height=r+"px",h=document.getElementById(this._id+"selectioncanvas_"+T),this._isPinchZoomed)h.style.display="none";else if(h.style.display="block",h.style.height=r+"px",h.style.width=l+"px",h.style.position="absolute",h.style.left=0,h.style.top=0,h.style.backgroundColor="transparent",h.style.zIndex="2",_=this._pageContents[parseInt(T)],this._isTouchEnded,_||-1!=this._renderedCanvasList.indexOf(T)){for(c=this._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(_):JSON.parse(_.d),p=e("#"+this._id+"selectioncanvas_"+T).children(),g=0;g<p.length;g++)e(p[g]).hasClass("e-pdfviewer-textLayer")&&(e(p[g]).remove(),e("#"+this._id+"selectioncanvas_"+T).removeClass("text_container"));e("#"+this._id+"selectioncanvas_"+T).hasClass("text_container")||null==this._pageContents[parseInt(T)]?null!=this._pageContents[parseInt(T)]&&this._resizeSelection(c,T,a):this._textSelection(c,T,a)}e("#"+this._id+"pageDiv_"+T+"_WaitingPopup").css({display:"none",height:r+"px",width:l+"px",left:"0px",top:"0px"}),(u=document.getElementById(this._id+"pageDiv_"+T+"_WaitingPopup"))&&((f=u.childNodes[0]).style.top=(n.height-f.clientHeight)/2+"px")}if(this._ispdfium&&(this._ispageCleared=!0),this._zoomVal<1?x.css({"-ms-scroll-limit-y-max":this._cummulativeHeight*this._zoomVal-this.element.height()+50+"px"}):x.css({"-ms-scroll-limit-y-max":""}),e("#"+this._id+"_popupmenu").hide(),this._isPopupNoteVisible=!1,m=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,this._isPinchZoomed&&!m){var I=C,k=document.getElementById(this._id+"pagecanvas_"+this._currentPage).getBoundingClientRect(),z=(k.top-5*this._currentPage)*this._preZoomVal+5*this._currentPage,A=this._zoomY,D=I+A;S=(k.top-5*this._currentPage)*this._zoomVal+5*this._currentPage+(D-z<0?D-z:(D-z)*(this._zoomVal/this._preZoomVal))-A,v=(P.scrollLeft+this._prevZoomX)*(this._zoomVal/this._preZoomVal)-this._zoomX,P.scrollLeft=v,this._prevZoomX=this._zoomX}P.scrollTop=S,this._eventpreviouszoomvalue=this._preZoomVal,this._eventzoomvalue=this._zoomVal,this._previousZoom=this._zoomVal,this._preZoomVal=this._zoomVal,y.previousZoomPercentage=Math.round(100*this._eventpreviouszoomvalue),y.currentZoomPercentage=Math.round(100*this._eventzoomvalue),this._raiseClientEvent("zoomChange",y),this.zoomPercentage=Math.round(100*this._zoomVal),w=[],this._selectedAnnotationObject&&(w.push(this._selectedAnnotationObject.annotation),this._drawAnnotSelectRect(this._selectedAnnotationObject.pageIndex,w))},_initRerendering:function(){var e,t,i,o,n;this._isRerenderCanvasCreated||(this._designNewCanvas(),e=[],t=this._currentPage,e.push(parseInt(this._currentPage)),this._renderedCanvasList?(i=parseInt(this._currentPage)-1,-1!=this._renderedCanvasList.indexOf(i)&&e.push(i),o=parseInt(this._currentPage)+1,-1!=this._renderedCanvasList.indexOf(o)&&e.push(o)):(i=parseInt(this._currentPage)-1,e.push(i),o=parseInt(this._currentPage)+1,e.push(o)),this._rerenderCanvasList=e,n=this,clearInterval(n._scrollTimer),n._bgRenderTimer=setInterval(function(){n._rerenderCanvas(t)},10),this._renderedCanvasList.length=0)},_designNewCanvas:function(){for(var t,i=1;i<=this._totalPages;i++){var o,n,s=document.getElementById(this._id+"pageDiv_"+i),a=document.getElementById(this._id+"pagecanvas_"+i),r=document.createElement("canvas");90==this._pageSize[i-1].PageRotation||270==this._pageSize[i-1].PageRotation?(o=this._pageSize[i-1].PageWidth*this._zoomVal,n=this._pageSize[i-1].pageHeight*this._zoomVal):(o=this._pageSize[i-1].PageHeight*this._zoomVal,n=this._pageSize[i-1].PageWidth*this._zoomVal),r.style.display="none",r.style.width=n+"px",r.style.height=o+"px",r.style.backgroundColor="white",r.height=o,r.width=n,r.id=a.id,r.className="e-pdfviewer-pageCanvas",a.id=this._id+"oldcanvas_"+i,s.appendChild(r),e(r).css({"user-select":"none"}),(t=document.getElementById(this._id+"_secondarycanvas_"+i)).style.width=n+"px",t.style.height=o+"px",t.width=n,t.height=o}this._isRerenderCanvasCreated=!0},_replaceOldCanvas:function(){for(var e,t=1;t<=this._totalPages;t++){var i=document.getElementById(this._id+"pageDiv_"+t),n=document.getElementById(this._id+"pagecanvas_"+t),s=document.getElementById(this._id+"oldcanvas_"+t);n!=o&&null!=n&&(n.style.display="block"),s!=o&&null!=s&&i.removeChild(s)}this._isRerenderCanvasCreated=!1,e=this,clearInterval(e._bgRenderTimer),this._pageContents&&(e._scrollTimer=setInterval(function(){e._pageviewscrollchanged(e._pageHeight)},500))},_rerenderCanvas:function(t){var i,n,s,a,r;if(-1==this._renderedCanvasList.indexOf(parseInt(t))&&t<=this._totalPages&&-1!=this._rerenderCanvasList.indexOf(parseInt(t))?(i=this._pageContents[parseInt(t)])!=o&&null!=i&&(this._rerenderPdfPage(i),this._renderCount=this._renderCount+1):-1==this._renderedCanvasList.indexOf(parseInt(t)-1)&&t-1<=this._totalPages&&-1!=this._rerenderCanvasList.indexOf(parseInt(t)-1)?(i=this._pageContents[parseInt(t)-1])!=o&&null!=i&&(this._rerenderPdfPage(i),this._renderCount=this._renderCount+1):-1==this._renderedCanvasList.indexOf(parseInt(t)+1)&&t+1<=this._totalPages&&-1!=this._rerenderCanvasList.indexOf(parseInt(t)+1)&&((i=this._pageContents[parseInt(t)+1])!=o&&null!=i&&(this._rerenderPdfPage(i),this._renderCount=this._renderCount+1)),this._renderCount==this._rerenderCanvasList.length||this._ispageCleared&&this._ispdfium){for(this._replaceOldCanvas(),n=1;n<=this._totalPages;n++)-1==this._renderedCanvasList.indexOf(n)&&e("#"+this._id+"pageDiv_"+n+"_WaitingPopup").css({display:"block"}),(s=document.getElementById(this._id+"pageDiv_"+n+"_WaitingPopup"))&&(a=document.getElementById(this._id+"pagecanvas_"+n),(r=s.childNodes[0]).style.top=(a.height-r.clientHeight)/2+"px");this._renderCount=0,this._rerenderCanvasList.length=0}},_rerenderPdfPage:function(i){var n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w,x,b=i;if(i!=o&&null!=i){for(i=this._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(i):JSON.parse(i.d),this._renderedCanvasList.push(parseInt(i.currentpage)),n=parseInt(i.currentpage),s=i.imagestream,this._pageContents[parseInt(i.currentpage)]=b,this._regenerateFormFields(i,n),a=e("#"+this._id+"selectioncanvas_"+n).children(),u=0;u<a.length;u++)(a[u].hasAttribute("href")||e(a[u]).hasClass("e-pdfviewer-formFields"))&&e(a[u]).remove();this._createFormFields(i,n);var y=i.linkannotation,P=i.annotpagenum,C=this;if(this.model.enableHyperlink)for(r=0;r<y.length;r++){if((l=document.createElement("a")).id="linkdiv_"+r,d=y[r].AnnotRectangle,l.style.background="transparent",l.style.position="absolute",l.style.left=this._convertPointToPixel(d.Left*this._zoomVal)+"px",l.style.top=this._convertPointToPixel(d.Top*this._zoomVal)+"px",l.style.width=this._convertPointToPixel(d.Width*this._zoomVal)+"px",l.style.height=this._convertPointToPixel(d.Height*this._zoomVal)+"px",l.style.color="transparent",-1!=y[r].URI.indexOf("mailto:")?(h=y[r].URI.substring(y[r].URI.indexOf("mailto:"),y[r].URI.length),l.title=h,l.setAttribute("href",h)):(l.title=y[r].URI,l.setAttribute("href",y[r].URI)),this.model.hyperlinkOpenState==t.PdfViewer.LinkTarget.Default?(l.target="_self",l.onclick=function(){var e={hyperlink:this.href};C._raiseClientEvent("hyperlinkClick",e)}):this.model.hyperlinkOpenState==t.PdfViewer.LinkTarget.NewTab?(l.target="_blank",l.onclick=function(){var e={hyperlink:this.href};C._raiseClientEvent("hyperlinkClick",e)}):this.model.hyperlinkOpenState==t.PdfViewer.LinkTarget.NewWindow&&(l.onclick=function(){var e={hyperlink:this.href};return C._raiseClientEvent("hyperlinkClick",e),window.open(this.href,"_blank","scrollbars=yes,resizable=yes"),!1}),P[r]!=o){var S=this._pageSize[n-1].PageHeight-this._convertPointToPixel(y[r].AnnotLocation),T=parseFloat(this._pageLocation[P[r]]*this._zoomVal)+parseFloat(S*this._zoomVal);l.name=T,l.onclick=function(){return document.getElementById("container_viewerContainer").scrollTop=this.name,!1}}(_=document.getElementById(this._id+"selectioncanvas_"+n))&&_.appendChild(l)}if(this._textMarkupAnnotationList[n]&&this._renderTextMarkupAnnotation(this._textMarkupAnnotationList[n],n),c=parseInt(i.currentpage),(p=document.getElementById(this._id+"pagecanvas_"+parseInt(i.currentpage)))!=o&&null!=p){I=p.getContext("2d"),V=this._scalingTextContent(I),90==this._pageSize[c-1].PageRotation||270==this._pageSize[c-1].PageRotation?(p.height=this._zoomVal*this._pageSize[c-1].PageHeight*V,p.width=this._zoomVal*this._pageSize[c-1].PageWidth*V,p.style.width=this._zoomVal*this._pageSize[c-1].PageWidth+"px",p.style.height=this._zoomVal*this._pageSize[c-1].PageHeight+"px"):(p.width=this._zoomVal*this._pageSize[n-1].PageWidth*V,p.height=this._zoomVal*this._pageSize[n-1].PageHeight*V,p.style.height=this._zoomVal*this._pageSize[n-1].PageHeight+"px",p.style.width=this._zoomVal*this._pageSize[n-1].PageWidth+"px");var I=p.getContext("2d"),k=[],z=[],A=[],D=[],B=[],R=navigator.userAgent,E=0,N=[],O=s.textelements;if(null!=O.imagedata&&i.isPdfRenderingEngine){var V=1,L=O.imagedata,M=new Image,F=this;M.onload=function(){F._renderImages(p,M,p.width,p.height,V)},M.src=L[0]}for(g=0;g<O.length;g++){var j=O[g],H=j.color,W=j.matrix;null!=W&&(W=W.Elements);var U=j.brush,Y=j.pathValue,X=j.iscliping,Z=j.restorecanvas,J=j.imagedata,G=j.fillrule,q=j.isFillandStroke,K=j.fillcolor,$=j.strokecolor,Q=j.linewidth,ee=j.linecap,te=j.linearGradientBrush,ie=j.textureBrushs,oe=j.charID,ne=j.alpha,se=j.dashPattern;if(null!=se&&se.length>0&&I.setLineDash(se),null!=Y?(Y=Y.split(";"),oe&&(N[oe]=Y)):null==Y&&oe&&(Y=N[oe]),0==Z&&I.save(),Y!=o&&I.setTransform(W[0]*this._zoomVal*V,W[1]*this._zoomVal*V,W[2]*this._zoomVal*V,W[3]*this._zoomVal*V,W[4]*this._zoomVal*V,W[5]*this._zoomVal*V),null!=Y){for(I.beginPath(),u=0;u<Y.length;u++)"M"==(m=(f=Y[u])[0])?(f=(f=f.substring(1,f.length)).split(" "),I.moveTo(f[0],f[1])):"L"==m?(f=(f=f.substring(1,f.length)).split(" "),I.lineTo(f[0],f[1])):"C"==m?(f=(f=f.substring(1,f.length)).split(" "),I.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5])):"Z"==m&&I.closePath();1==X?("evenodd"==G&&(I.msFillRule="evenodd",I.mozFillRule="evenodd",I.clip(G)),I.clip()):q==o?"Fill"==U?(te!=o?I.fillStyle=this._getGradientBrush(te,I):ie!=o?I.fillStyle=this._createTextureBrush(ie,I,j):(ne!=o&&(I.globalAlpha=ne),I.fillStyle=H),"evenodd"==G&&(I.msFillRule="evenodd",I.mozFillRule="evenodd",I.fill(G)),I.fill()):"FillandStroke"==U?(I.fillStyle=H,I.fill(),I.strokeStyle=$,I.stroke()):"Stroke"==U?(I.strokeStyle=$,I.lineWidth=Q,I.lineCap=ee,I.stroke()):(I.strokeStyle=H,I.lineWidth=Q,I.lineCap=ee,I.stroke()):(I.strokeStyle=$,I.lineWidth=Q,I.lineCap=ee,I.stroke(),I.fillStyle=te!=o?this._getGradientBrush(te,I):ie!=o?this._createTextureBrush(ie,I,j):K,"evenodd"==G&&(I.msFillRule="evenodd",I.mozFillRule="evenodd",I.fill(G)),I.fill())}if(Z&&I.restore(),J!=o){if(-1!=R.indexOf("Firefox")||-1!=R.indexOf("Chrome")||-1!=R.indexOf("Safari")||-1!=R.indexOf("AppleWebKit")){k.push(J),z.push(W),B.push(O),D.push(g),this._zoomVal,this._isContainImage=!0;break}(v=new Image).src=J,I.setTransform(W[0]*this._zoomVal*V,W[1]*this._zoomVal*V,W[2]*this._zoomVal*V,W[3]*this._zoomVal*V,W[4]*this._zoomVal*V,W[5]*this._zoomVal*V),I.drawImage(v,0,0,1,1)}}if(-1!=R.indexOf("Firefox")||-1!=R.indexOf("Chrome")||-1!=R.indexOf("Safari")||-1!=R.indexOf("AppleWebKit"))for(w=0;w<k.length;w++)this._imageRenderingPinch(O,A,k,z,I,w,B,D,N,p,c,E),E++;if(x=p,F=this,0!=this._pageSize[c-1].PageRotation&&!this._isContainImage){var ae=(x=document.getElementById(this._id+"pagecanvas_"+parseInt(i.currentpage))).toDataURL(),re=(I=x.getContext("2d"),V=F._scalingTextContent(I),new Image);re.onload=function(){I.clearRect(0,0,x.width,x.height),90==F._pageSize[c-1].PageRotation||270==F._pageSize[c-1].PageRotation?(x.width=F._zoomVal*F._pageSize[c-1].PageHeight*V,x.height=F._zoomVal*F._pageSize[c-1].PageWidth*V,x.style.height=F._zoomVal*F._pageSize[c-1].PageWidth+"px",x.style.width=F._zoomVal*F._pageSize[c-1].PageHeight+"px"):(x.width=F._zoomVal*F._pageSize[c-1].PageWidth*V,x.height=F._zoomVal*F._pageSize[c-1].PageHeight*V,x.style.height=F._zoomVal*F._pageSize[c-1].PageHeight+"px",x.style.width=F._zoomVal*F._pageSize[c-1].PageWidth+"px"),I.save(),I.translate(x.width/2,x.height/2),I.rotate(F._pageSize[c-1].PageRotation/2*Math.PI/2),I.drawImage(re,-re.width/2,-re.height/2),I.restore()},re.src=ae}return this._changingImageCanvasPosition(n),this._showSignature(),this._showPageLoadingIndicator(n,!1),x}}},_regenerateFormFields:function(t,i){var o,n,s,a,r,l,d=t.pdfRenderedFields;if(null!=d)for(o=0;o<d.length;o++)if(d[o].PageIndex+1==i)if(d[o].LineBounds,n=document.getElementById(this._id+"input_"+i+"_"+o),"Textbox"==d[o].Name){if(1==d[o].Visible)continue;s=e(n).attr("name"),d[o].FieldName==s&&(d[o].Text=e(n).val())}else if("Password"==d[o].Name)s=e(n).attr("name"),d[o].FieldName==s&&(d[o].Text=e(n).val());else if("RadioButton"==d[o].Name)s=e(n).attr("name"),d[o].GroupName==s&&(d[o].Selected=1==e(n).prop("checked"));else if("CheckBox"==d[o].Name)s=e(n).attr("name"),d[o].GroupName==s&&(d[o].Selected=1==e(n).prop("checked"));else if("DropDown"==d[o].Name){if(s=e(n).attr("name"),d[o].Text==s)for(""==d[o].SelectedValue&&((l=e(n).children()[0]).id="dropdownhide",1==e(l).prop("selected")&&(d[o].SelectedValue="")),r=0;r<d[o].TextList.length;r++)l="dropdownhide"==e(n).children()[0].id?e(n).children()[r+1]:e(n).children()[r],1==e(l).prop("selected")&&(d[o].SelectedValue=d[o].TextList[r])}else if("ListBox"==d[o].Name)for(a=0,r=0;r<d[o].TextList.length;r++)l=e(n).children()[r],1==e(l).prop("selected")&&(d[o].SelectedList[a]=r,a++)},_imageRenderingPinch:function(e,t,i,n,s,a,r,l,d,h,_,c){var p=this,g=p._zoomVal,u=new Image;u.onload=function(){for(var a,u,f,m,v,w,x=!1,b=p._scalingTextContent(s),y=0;y<n.length;y++)if(0==x)for(a=n[y],s.setTransform(a[0]*g*b,a[1]*g*b,a[2]*g*b,a[3]*g*b,a[4]*g*b,a[5]*g*b),t[c]!=o&&s.drawImage(t[c],0,0,1,1),u=l[y],u+=1,f=r[y];u<f.length;){var P=f[u],C=P.color,S=P.matrix;null!=S&&(S=S.Elements);var T=P.brush,I=P.pathValue,k=P.iscliping,z=P.restorecanvas,A=P.imagedata,D=P.fillrule,B=P.isFillandStroke,R=P.fillcolor,E=P.strokecolor,N=P.linewidth,O=P.linecap,V=P.linearGradientBrush,L=P.textureBrushs,M=P.charID,F=P.alpha,j=P.dashPattern;if(null!=j&&j.length>0&&s.setLineDash(j),null!=I?(I=I.split(";"),M&&(d[M]=I)):null==I&&M&&(I=d[M]),0==z&&s.save(),I!=o&&s.setTransform(S[0]*g*b,S[1]*g*b,S[2]*g*b,S[3]*g*b,S[4]*g*b,S[5]*g*b),null!=I){for(s.beginPath(),m=0;m<I.length;m++)"M"==(w=(v=I[m])[0])?(v=(v=v.substring(1,v.length)).split(" "),s.moveTo(v[0],v[1])):"L"==w?(v=(v=v.substring(1,v.length)).split(" "),s.lineTo(v[0],v[1])):"C"==w?(v=(v=v.substring(1,v.length)).split(" "),s.bezierCurveTo(v[0],v[1],v[2],v[3],v[4],v[5])):"Z"==w&&s.closePath();1==k?("evenodd"==D&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.clip(D)),s.clip()):B==o?"Fill"==T?(V!=o?s.fillStyle=p._getGradientBrush(V,s):L!=o?s.fillStyle=p._createTextureBrush(L,s,P):(F!=o&&(s.globalAlpha=F),s.fillStyle=C),"evenodd"==D&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(D)),s.fill()):"FillandStroke"==T?(s.fillStyle=C,s.fill(),s.strokeStyle=E,s.stroke()):"Stroke"==T?(s.strokeStyle=E,s.lineWidth=N,s.lineCap=O,s.stroke()):(s.strokeStyle=C,s.lineWidth=N,s.lineCap=O,s.stroke()):(s.strokeStyle=E,s.lineWidth=N,s.lineCap=O,s.stroke(),s.fillStyle=V!=o?p._getGradientBrush(V,s):L!=o?p._createTextureBrush(L,s,P):R,"evenodd"==D&&(s.msFillRule="evenodd",s.mozFillRule="evenodd",s.fill(D)),s.fill())}if(z&&s.restore(),A!=o){x=!0,i.pop(),n.pop(),r.pop(),l.pop(),i.push(A),n.push(S),r.push(e),l.push(u),y=-1,c++;break}u++}else p._imageRenderingPinch(e,t,i,n,s,y,r,l,d,h,_,c),c++;if(u==e.length&&0!=p._pageSize[_-1].PageRotation){var H=document.getElementById(p._id+"pagecanvas_"+_),W=H.toDataURL(),U=H.getContext("2d"),Y=(b=p._scalingTextContent(s),new Image);Y.onload=function(){U.clearRect(0,0,H.width,H.height),90==p._pageSize[_-1].PageRotation||270==p._pageSize[_-1].PageRotation?(H.width=p._zoomVal*p._pageSize[_-1].PageHeight*b,H.height=p._zoomVal*p._pageSize[_-1].PageWidth*b,H.style.height=p._zoomVal*p._pageSize[_-1].PageWidth+"px",H.style.width=p._zoomVal*p._pageSize[_-1].PageHeight+"px"):(H.width=p._zoomVal*p._pageSize[_-1].PageWidth*b,H.height=p._zoomVal*p._pageSize[_-1].PageHeight*b,H.style.width=p._zoomVal*p._pageSize[_-1].PageWidth+"px",H.style.height=p._zoomVal*p._pageSize[_-1].PageHeight+"px"),U.save(),U.translate(H.width/2,H.height/2),U.rotate(p._pageSize[_-1].PageRotation/2*Math.PI/2),U.drawImage(Y,-Y.width/2,-Y.height/2),U.restore()},Y.src=W}},u.src=i[a],t.push(u)},_touchStart:function(t){var i,o=t.touches;o.length>1&&t.preventDefault(),(i=e(t.target).parents(".e-pdfviewer.e-js").ejPdfViewer("instance"))._touched=!1,i._zoomY=o[0].clientY,i._zoomX=o[0].clientX},_touchMove:function(t){var i,o,n=t.touches;n.length>1&&((i=e(t.target).parents(".e-pdfviewer.e-js").ejPdfViewer("instance"))._touched=!0,i._isRerenderCanvasCreated||(e(".e-pdfviewer-formFields").hide(),o=Math.sqrt(Math.pow(n[0].clientX-n[1].clientX,2)+Math.pow(n[0].clientY-n[1].clientY,2)),i._zoomY=(n[0].clientY+n[1].clientY)/2,i._zoomX=(n[0].clientX+n[1].clientX)/2,i._isPinchZoomed=!0,i._prevDiff>-1?o>i._prevDiff?i._pinchOut(t):o<i._prevDiff&&i._pinchIn(t):i._zoomVal<2?-1!=i._prevDiff&&o>i._prevDiff&&i._pinchIn(t):-1==i._prevDiff&&i._zoomVal>2&&o>i._prevDiff&&i._pinchIn(t),i._prevDiff=o))},_touchEnd:function(t){var i,o,n,s,a,r=e(t.target).parents(".e-pdfviewer.e-js").ejPdfViewer("instance");r._isPinchZoomed&&(r._isPinchZoomed=!1,r._isTouchEnded=!0,r._fitToAutoSize(),r._calculateZoomLevel(r._zoomVal)),r._prevDiff=-1,r._isRenderedByPinch&&(0!=r._renderedCanvasList.length&&(r._isRerenderCanvasCreated||(r._designNewCanvas(),i=[],o=r._currentPage,i.push(parseInt(r._currentPage)),n=parseInt(r._currentPage)-1,-1!=r._renderedCanvasList.indexOf(n)&&i.push(n),s=parseInt(r._currentPage)+1,-1!=r._renderedCanvasList.indexOf(s)&&i.push(s),r._rerenderCanvasList=i,a=r,window.clearInterval(a._scrollTimer),a._bgRenderTimer=setInterval(function(){a._rerenderCanvas(o)},10),r._renderedCanvasList.length=0)),r._isRenderedByPinch=!1)},_pointerdown:function(e){"touch"==e.originalEvent.pointerType&&(this._pointerCount=this._pointerCount+1,this._pointerCount<=2&&"e-pdfviewer-formFields"!=e.target.className&&(e.preventDefault(),this._pointers.push(e.originalEvent),2==this._pointerCount&&(this._pointerCount=0)),this._zoomY=e.originalEvent.clientY,this._zoomX=e.originalEvent.clientX)},_pointermove:function(e){var t,i;if("touch"==e.originalEvent.pointerType&&2==this._pointers.length){for(e.preventDefault(),t=0;t<this._pointers.length;t++)if(e.originalEvent.pointerId==this._pointers[t].pointerId){this._pointers[t]=e.originalEvent;break}this._isRerenderCanvasCreated||(i=Math.sqrt(Math.pow(this._pointers[0].clientX-this._pointers[1].clientX,2)+Math.pow(this._pointers[0].clientY-this._pointers[1].clientY,2)),this._zoomY=(this._pointers[0].clientY+this._pointers[1].clientY)/2,this._zoomX=(this._pointers[0].clientX+this._pointers[1].clientX)/2,this._isPinchZoomed=!0,this._prevDiff>-1&&(i>this._prevDiff?this._pinchOut(e):i<this._prevDiff&&this._pinchIn(e)),0==document.getElementById(this._id+"_viewerContainer").scrollTop||(i>this._prevDiff?this._pinchOut(e):i<this._prevDiff&&this._pinchIn(e)),this._prevDiff=i)}},_pointerup:function(e){var t,i,o,n,s;"touch"==e.originalEvent.pointerType&&(this._pointers=[],this._pointerCount=0,this._prevDiff=-1,this._isRenderedByPinch&&(e.preventDefault(),0!=this._renderedCanvasList.length&&(this._isRerenderCanvasCreated||(this._isPinchZoomed&&(this._isPinchZoomed=!1,this._isTouchEnded=!0,this._fitToAutoSize(),this._calculateZoomLevel(this._zoomVal)),this._designNewCanvas(),t=[],i=this._currentPage,t.push(parseInt(this._currentPage)),o=parseInt(this._currentPage)-1,-1!=this._renderedCanvasList.indexOf(o)&&t.push(o),n=parseInt(this._currentPage)+1,-1!=this._renderedCanvasList.indexOf(n)&&t.push(n),this._rerenderCanvasList=t,s=this,window.clearInterval(s._scrollTimer),s._bgRenderTimer=setInterval(function(){s._rerenderCanvas(i)},10),this._renderedCanvasList.length=0)),this._isRenderedByPinch=!1))},_pinchOut:function(){this._isAutoSelected=!1,this._isAutoZoom=!1,this._zoomVal=this._zoomVal+.05,this._zoomVal>2&&(this._zoomVal=this._zoomVal+.05),this._zoomVal>4&&(this._zoomVal=4,this._isPinchLimitReached=!0),this._zoomVal<=4?(this._isPinchLimitReached||(this._changingImageCanvasPosition(this._currentPage),this._fitType=null,this._fitToAutoSize(),this._calculateZoomLevel(this._zoomVal),e("#"+this._id+"_toolbar_zoomSelection_hidden").val(Math.round(100*this._zoomVal)+"%"),this._ejDropDownInstance.model.value=100*this._zoomVal+"%",this._ejDropDownInstance.model.selectedIndices[0]="",e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active"),this._updateZoomButtons(),e("#"+this._id+"_pageviewContainer").find(".e-waitingpopup").css("visibility",""),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitPage"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"),this._isRenderedByPinch=!0),this._isPinchLimitReached=!1):this._zoomVal=4},_pinchIn:function(){this._isAutoSelected=!1,this._isAutoZoom=!1,this._zoomVal=this._zoomVal-.04,this._zoomVal<4&&this._zoomVal>2&&(this._zoomVal=this._zoomVal-.04),this._zoomVal<.5&&(this._zoomVal=.5,this._isPinchLimitReached=!0),this._zoomVal>=.5?(this._isPinchLimitReached||(this._changingImageCanvasPosition(this._currentPage),this._fitType=null,this._fitToAutoSize(),this._calculateZoomLevel(this._zoomVal),e("#"+this._id+"_toolbar_zoomSelection_hidden").val(Math.round(100*this._zoomVal)+"%"),this._ejDropDownInstance.model.value=100*this._zoomVal+"%",this._ejDropDownInstance.model.selectedIndices[0]="",e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active"),this._updateZoomButtons(),e("#"+this._id+"_pageviewContainer").find(".e-waitingpopup").css("visibility",""),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitPage"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"),this._isRenderedByPinch=!0),this._isPinchLimitReached=!1):this._zoomVal=.5},_textSearch:function(){var t;if(this._removeSearch=!1,this._clearAllOccurrences(),this._selectedIndex=0,this._isTextSearch=!0,this._searchedPages=[],this._searchCollection=[],t=this._isToolbarHidden||"block"!=e("#"+this._id+"_pdfviewer_searchbox").css("display")?this._searchText:e("#"+this._id+"_pdfviewer_searchinput").val(),this._searchText=t,this._searchText&&""!=this._searchText?this._enableSearchIcons():this._disableSearchIcons(),""==t||" "==t||!t)return e("#"+this._id+"_pdfviewer_searchinput").removeClass("e-pdfviewer-progressloader"),!0;this._searchPageIndex=parseInt(this._currentPage),this._initSearch(this._searchPageIndex),this._highlightOtherOccurrences()},_disableSearchIcons:function(){e("#"+this._id+"_pdfviewer_previous_search").css({"pointer-events":"none",opacity:"0.6"}),e("#"+this._id+"_pdfviewer_next_search").css({"pointer-events":"none",opacity:"0.6"}),e("#"+this._id+"_search_matchcase").data("ejCheckBox").disable()},_enableSearchIcons:function(){e("#"+this._id+"_pdfviewer_previous_search").css({"pointer-events":"",opacity:""}),e("#"+this._id+"_pdfviewer_next_search").css({"pointer-events":"",opacity:""}),e("#"+this._id+"_search_matchcase").data("ejCheckBox").enable()},_prevSearch:function(){this._searchText&&(this._clearAllOccurrences(),this._isPrevSearch=!0,this._isTextSearch=!0,this._selectedIndex=this._selectedIndex-1,this._selectedIndex<0?(this._searchPageIndex=this._searchPageIndex-1,this._searchPageIndex<1&&(this._searchPageIndex=parseInt(this._totalPages)),this._initSearch(this._searchPageIndex)):this._highlightText(this._searchPageIndex,this._selectedIndex),this._highlightOtherOccurrences())},_nextSearch:function(){this._searchText&&(this._clearAllOccurrences(),this._isPrevSearch=!1,this._isTextSearch=!0,this._selectedIndex=this._selectedIndex+1,this._searchCollection[this._searchPageIndex]?this._selectedIndex>=this._searchCollection[this._searchPageIndex].length?(this._selectedIndex=0,this._searchPageIndex=this._searchPageIndex<this._totalPages?this._searchPageIndex+1:1,this._initSearch(this._searchPageIndex)):this._highlightText(this._searchPageIndex,this._selectedIndex):(this._searchPageIndex=this._currentPage,this._selectedIndex=0,this._initSearch(this._searchPageIndex)),this._highlightOtherOccurrences())},_matchcase:function(){var t=e("#"+this._id+"_search_matchcase").data("ejCheckBox");this._isMatchCase="check"==t.model.checkState,this._textSearch()},_searchKeypressHandler:function(t){13==t.which&&(t.preventDefault(),this._searchText=e("#"+this._id+"_pdfviewer_searchinput").val(),this._searchMatches[this._searchPageIndex]&&""!=this._searchText?0==this._searchMatches[this._searchPageIndex].length?this._initSearch(this._searchPageIndex):this._nextSearch():""!=this._searchText&&(this._searchPageIndex=this._currentPage,this._selectedIndex=0,this._initSearch(this._searchPageIndex)))},_initSearch:function(e){var t=this._searchText.length,i=this._searchText;""==i&&" "==i&&i||this._getPossibleMatches(e,i,t)},_getPossibleMatches:function(t,i,o){if(!this._pageText[parseInt(t)]&&t==this._searchPageIndex){this._isRequestFired=!0;var n={};n.viewerAction=this._viewerAction.getPageModel,n.pageindex=t.toString(),n.id=this._fileId,e("#"+this._id+"_pdfviewer_searchinput").addClass("e-pdfviewer-progressloader"),this._ajaxInProgress||this._doAjaxPostSearch(JSON.stringify(n),t)}this._searchPageText(t,i,o)},_searchPageText:function(t,i,o){var n,s,a=this._pageText[t];if(a){this._isMatchCase||(a=a.toLowerCase(),i=i.toLowerCase());var r=[],l=-o,d=/[^\u0000-\u00ff]/.test(a),h=new RegExp("[\0-]+").test(a),_=this._isRtl(a);for(!h&&_&&(n=new RegExp(String.fromCharCode(160),"g"),a=a.replace(n," "),i=(i=i.split("").reverse().join("")).replace(/\s/g," ")),this._isNonBreackingCharacter&&d&&(n=new RegExp(String.fromCharCode(160),"g"),a=a.replace(n," "));""!=i&&" "!=i&&i&&-1!=(l=a.indexOf(i,l+o));)r.push(l);this._searchMatches[t]=r,t==this._searchPageIndex?(this._selectedIndex<0&&this._isPrevSearch&&(this._selectedIndex=this._searchMatches[t].length-1),(this._isRequestFired&&0!=this._searchMatches[t].length||-1==this._renderedCanvasList.indexOf(t)&&0!=this._searchMatches[t].length)&&(this._gotoPageNo(t),this._isPageScrolledForSearch=!0),0==this._searchMatches[t].length?(t!=this._totalPages?(-1==this._searchedPages.indexOf(parseInt(t))&&this._searchedPages.push(t),this._isPrevSearch?(this._searchPageIndex=this._searchPageIndex-1,this._searchPageIndex<=0&&(this._searchPageIndex=this._totalPages)):this._searchPageIndex=this._searchPageIndex+1):(-1==this._searchedPages.indexOf(parseInt(t))&&this._searchedPages.push(t),this._searchPageIndex=this._isPrevSearch?this._searchPageIndex-1:1),this._searchedPages.length!=this._totalPages||0!=this._searchMatches[t].length?this._initSearch(this._searchPageIndex):(""!=i&&e("#"+this._id+"_pdfviewer_searchinput").addClass("e-pdfviewer-nooccurrence"),e("#"+this._id+"_pdfviewer_searchinput").removeClass("e-pdfviewer-progressloader"),this._isRequestFired=!1)):this._isRequestFired?(e("#"+this._id+"_pdfviewer_searchinput").removeClass("e-pdfviewer-progressloader"),s=this,setTimeout(function(){s._convertMatches(t,o),s._isRequestFired=!1,s._isPageScrolledForSearch=!1},100)):this._convertMatches(t,o)):0!=this._searchMatches[t].length&&this._convertMatches(t,o),this._isRequestFired||this._isPageScrollHighlight||(this._isPageScrolledForSearch=!1)}},_convertMatches:function(e,t){for(var i,o,n=0,s=this._searchMatches[e],a=this._textDivs[e],r=0,l=a.length-1,d=[],h=0,_=s.length;h<_;h++){if(i=s[h],this._isPageScrolledForSearch)for(;n!=l&&i>=r+a[n].textContent.split("\n")[0].length;)r+=a[n].textContent.split("\n")[0].length,n++;else for(;n!=l&&i>=r+a[n].textContent.length;)r+=a[n].textContent.length,n++;for(o={begin:{divId:n,offsetValue:i-r}},i+=t;n!=l&&i>r+a[n].textContent.length;)r+=a[n].textContent.length,n++;o.end={divId:n,offsetValue:i-r},d.push(o)}this._searchCollection[e]=d,this._highlightText(e,this._selectedIndex)},_highlightText:function(e){for(var t,i,n,s,a=this._searchCollection[e],r=this._textDivs[e],l=null,d=a.length,h=0;h<d;h++){var _=a[h],c=_.begin,p=_.end;if(h==this._selectedIndex&&e==this._searchPageIndex?(s="e-pdfviewer-texthighlight",n=c.divId):s="e-pdfviewer-text-highlightother",l&&c.divId===l.divId?this._addSpanForSearch(l.divId,l.offsetValue,c.offsetValue,e,r,null):(null!==l&&this._addSpanForSearch(l.divId,l.offsetValue,o,e,r,null),this._beginText(c,r,e,null)),c.divId==p.divId)this._addSpanForSearch(c.divId,c.offsetValue,p.offsetValue,e,r,s);else{for(this._addSpanForSearch(c.divId,c.offsetValue,o,e,r,s),t=c.divId+1,i=p.divId;t<i;t++)this._addSpanForSearch(t,0,o,e,r,s+" middle");this._beginText(p,r,e,s)}l=p}l&&this._addSpanForSearch(l.divId,l.offsetValue,o,e,r,null),e==this._searchPageIndex&&this._scrollToSearchStr(r[n],{y:-70,x:-400}),this._isTextHighlighted=!0},_beginText:function(e,t,i,o){var n=e.divId;t[n].textContent="",this._addSpanForSearch(n,0,e.offsetValue,i,t,o)},_addSpanForSearch:function(t,i,o,n,s,a){var r,l,d,h=new RegExp(String.fromCharCode(160),"g"),_=this._textContents[n],c=_[t].length;new RegExp("[\0-]+");if(this._isRtl(_[t])){if(r=_[t].substring(c-i,c-o),l=document.createTextNode(r),a)return this._isTextHighlighted=!0,(d=document.createElement("span")).className=a+" e-pdfviewer-textLayer",e(d).hasClass("middle")&&(s[t].textContent=""),l.textContent=l.textContent.replace(h," "),e(d).prepend(l),e(s[t]).prepend(d),void s[t].innerHTML.replace(/&nbsp;/g," ");l.textContent=l.textContent.replace(h," "),e(s[t]).prepend(l),s[t].innerHTML=s[t].innerHTML.replace(h," ")}else{if(r=_[t].substring(i,o),l=document.createTextNode(r),a)return this._isTextHighlighted=!0,(d=document.createElement("span")).className=a+" e-pdfviewer-textLayer",e(d).hasClass("middle")&&(s[t].textContent=""),l.textContent=l.textContent.replace(h," "),d.appendChild(l),d.innerHTML=d.innerHTML.replace(h," "),s[t].appendChild(d),void(s[t].innerHTML=s[t].innerHTML.replace(h," "));l.textContent=l.textContent.replace(h," "),s[t].appendChild(l),s[t].innerHTML=s[t].innerHTML.replace(h," ")}},_isRtl:function(e){return new RegExp("^[^A-Za-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02B8\\u0300-\\u0590\\u0800-\\u1FFF\\u2C00-\\uFB1C\\uFDFE-\\uFE6F\\uFEFD-\\uFFFF]*[\\u0591-\\u07FF\\uFB1D-\\uFDFD\\uFE70-\\uFEFC]").test(e)},_scrollToSearchStr:function(e,t){for(var i=e.offsetParent,o=e.offsetTop+e.clientTop,n=e.offsetLeft+e.clientLeft;i.id!=this._id+"_viewerContainer";)o+=i.offsetTop,n+=i.offsetLeft,i=i.offsetParent;t&&(o+=t.y,n+=t.x,this._zoomVal>1.5&&(i.scrollLeft=n)),i.scrollTop=o},_highlightOtherOccurrences:function(){for(var e=1;e<=this._totalPages;e++)-1!=this._renderedCanvasList.indexOf(e)&&e!=this._searchPageIndex&&this._initSearch(e);this._isPageScrollHighlight=!1},_clearAllOccurrences:function(){var t,i,n,s,a,r,l;if(this._searchedText="",this._isTextSearch)for(t=document.getElementById(this._id+"custom-menu"),e(t).hide(),this._isTextHighlighted=!1,this._isTextSearch=!1,null!=this._searchAjaxRequestState&&(this._searchAjaxRequestState.abort(),this._searchAjaxRequestState=null),null!=this._ajaxRequestState&&(this._ajaxRequestState.abort(),this._ajaxRequestState=null),e("#"+this._id+"_pdfviewer_searchinput").removeClass("e-pdfviewer-nooccurrence"),i=1;i<=this._totalPages;i++)if(-1!==this._renderedCanvasList.indexOf(parseInt(i))){if(n=this._textDivs[i],s=this._textContents[i],!n||n==o)break;for(a=0;a<n.length;a++)if(r=!1,n[a].textContent=s[a],!this._isFindboxPresent||this._removeSearch){for(n[a].textContent="",l=0;l<this._textlayout.length;l++)if(this._textlayout[l].id==n[a].id){r=!0;break}n[a].textContent=r?s[a]+"\r\n":s[a]}}},_doAjaxPostSearch:function(i,o){var n=this;this._searchAjaxRequestState=e.ajax({type:"POST",url:this.model.serviceUrl+"/"+this.model.serverActionSettings.load,crossDomain:!0,contentType:"application/json; charset=utf-8",dataType:"json",data:i,traditional:!0,success:function(e){var i;i="object"==typeof(e=n._ajaxResponseData(e))?JSON.stringify(e):e,jsondata="object"==typeof e?n._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(JSON.stringify(e)):JSON.parse(JSON.stringify(e).d):n._pdfService==t.PdfViewer.PdfService.Local?JSON.parse(e):JSON.parse(e.d),n._pageContents[parseInt(jsondata.currentpage)]=i,n._pageText[parseInt(jsondata.currentpage)]=jsondata.pageContents,n._initSearch(o)},error:function(e){n._raiseClientEvent("ajaxRequestFailure",e.responseText)}})},_keyboardShortcutFind:function(e){e.ctrlKey&&70==e.which&&(e.preventDefault(),this._isTextSearchHidden||this._displaySearchBox())},_setSearchToolbarTop:function(){var e=document.getElementById(this._id+"_pdfviewer_searchbox");e&&(e.style.top="0px")},_searchBoxLocalization:function(){var i=e("#"+this._id+"_pdfviewer_searchbox").find(".e-pdfviewer-label")[0],o=e("#"+this._id+"_pdfviewer_searchbox").find(".e-pdfviewer-label")[1],n=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,s=n.contextMenu.Find.contentText,a=n.contextMenu.matchCase.contentText;e(i).text(s),e(o).text(a)},_displaySearchBox:function(){this._isToolbarHidden||("none"==e("#"+this._id+"_pdfviewer_searchbox").css("display")?(this._searchBoxLocalization(),this._clearSelector(),this._displaySearch=!0,e("#"+this._id+"_pdfviewer_searchbox").css({position:"absolute",display:"block"}),this._resizeSearchToolbar(),e("#"+this._id+"_pdfviewer_searchinput").focus().select(),this._isFindboxPresent=!0):(this._displaySearch=!1,this._isFindboxPresent=!1,this._clearAllOccurrences(),e("#"+this._id+"_pdfviewer_searchinput").removeClass("e-pdfviewer-progressloader"),e("#"+this._id+"_pdfviewer_searchbox").css({display:"none"})))},_showTextSearchButton:function(t){t?(e("#"+this._id+"_find").parent().parents(".e-pdfviewer-toolbarul").css("display","block"),this._isTextSearchHidden=!1):(e("#"+this._id+"_find").parent().parents(".e-pdfviewer-toolbarul").css("display","none"),this._isFindboxPresent&&this._displaySearchBox(),this._isTextSearchHidden=!0)},_renderTextMarkupAnnotation:function(e,t){var i,n,s,a,r,l,d=document.getElementById(this._id+"_secondarycanvas_"+t);if(d!=o&&null!=d){if((i=d.getContext("2d")).setLineDash([]),d.height=this._pageSize[t-1].PageHeight*this._zoomVal,d.width=this._pageSize[t-1].PageWidth*this._zoomVal,e)for(n=0;n<e.length;n++)if("StrikeOut"==(s=e[n]).TextMarkupAnnotationType){for(a=s.Color,s.isLocked=this.model.strikethroughSettings.isLocked,r=0;r<s.Bounds.length;r++)l=s.Bounds[r],i.globalAlpha=s.Opacity,i.beginPath(),i.moveTo(this._convertPointToPixel(l.X)*this._zoomVal,this._convertPointToPixel(l.Y+l.Height/2)*this._zoomVal),i.lineTo(this._convertPointToPixel(l.Width+l.X)*this._zoomVal,this._convertPointToPixel(l.Y+l.Height/2)*this._zoomVal),i.strokeStyle="rgb("+a.R+","+a.G+","+a.B+")",i.closePath(),i.msFillRule="nonzero",i.stroke();i.lineWidth=s.BorderWidth,i.save()}else if("Highlight"==s.TextMarkupAnnotationType){for(s.isLocked=this.model.highlightSettings.isLocked,r=0;r<s.Bounds.length;r++)l=s.Bounds[r],i.beginPath(),i.rect(this._convertPointToPixel(l.X)*this._zoomVal,this._convertPointToPixel(l.Y)*this._zoomVal,this._convertPointToPixel(l.Width)*this._zoomVal,this._convertPointToPixel(l.Height)*this._zoomVal),i.lineWidth=s.BorderWidth,a=s.Color,i.globalAlpha=.5*s.Opacity,i.closePath(),i.fillStyle="rgb("+a.R+","+a.G+","+a.B+")",i.msFillRule="nonzero",i.fill();i.save()}else if("Underline"==s.TextMarkupAnnotationType){for(s.isLocked=this.model.underlineSettings.isLocked,a=s.Color,r=0;r<s.Bounds.length;r++)l=s.Bounds[r],i.globalAlpha=s.Opacity,i.beginPath(),i.moveTo(this._convertPointToPixel(l.X)*this._zoomVal,this._convertPointToPixel(l.Y+l.Height)*this._zoomVal),i.lineTo(this._convertPointToPixel(l.Width+l.X)*this._zoomVal,this._convertPointToPixel(l.Y+l.Height)*this._zoomVal),i.lineWidth=s.BorderWidth,i.closePath(),i.strokeStyle="rgb("+a.R+","+a.G+","+a.B+")",i.msFillRule="nonzero",i.stroke();i.save()}this._newAnnotationList[t-1]&&0!=this._newAnnotationList[t-1].length&&this._renderNewAnnotations(this._newAnnotationList[t-1],i)}},_renderNewAnnotations:function(e,t){for(var i,o,n,s=0;s<e.length;s++)if("StrikeOut"==(i=e[s]).type){for(t.globalAlpha=i.opacity,o=0;o<i.bounds.length;o++)n=i.bounds[o],t.beginPath(),t.moveTo(n.xPosition*this._zoomVal,(n.yPosition+n.height/2)*this._zoomVal),t.lineTo((n.xPosition+n.width)*this._zoomVal,(n.yPosition+n.height/2)*this._zoomVal),t.strokeStyle="rgb("+i.colorR+","+i.colorG+","+i.colorB+")",t.closePath(),t.msFillRule="nonzero",t.stroke();t.save()}else if("Highlight"==i.type){for(t.globalAlpha=.5*i.opacity,o=0;o<i.bounds.length;o++)n=i.bounds[o],t.beginPath(),t.rect(n.xPosition*this._zoomVal,n.yPosition*this._zoomVal,n.width*this._zoomVal,n.height*this._zoomVal),t.closePath(),t.fillStyle="rgb("+i.colorR+","+i.colorG+","+i.colorB+")",t.msFillRule="nonzero",t.fill();t.save()}else if("Underline"==i.type){for(t.globalAlpha=i.opacity,o=0;o<i.bounds.length;o++)n=i.bounds[o],t.beginPath(),t.moveTo(n.xPosition*this._zoomVal,(n.yPosition+n.height)*this._zoomVal),t.lineTo((n.xPosition+n.width)*this._zoomVal,(n.yPosition+n.height)*this._zoomVal),t.strokeStyle="rgb("+i.colorR+","+i.colorG+","+i.colorB+")",t.closePath(),t.msFillRule="nonzero",t.stroke();t.save()}},_addAnnotation:function(e){var t=document.getElementById(this._id+"_secondarycanvas_"+this._currentPage);t.getContext("2d");switch(t.style.zIndex="2",window.getSelection().toString(),e){case"StrikeOut":window.getSelection().toString()?(this._drawStrikeOutAnnotation(),this._isHighlight=!1,this._annotationActive=!0):(this._annotationActive=!0,this._isHighlight=!1,this._isStrikeout=!0,this._isUnderline=!1);break;case"Underline":window.getSelection().toString()?(this._drawUnderlineAnnotation(),this._annotationActive=!0,this._isHighlight=!1):(this._annotationActive=!0,this._isHighlight=!1,this._isUnderline=!0,this._isStrikeout=!1);break;case"Highlight":window.getSelection().toString()?(this._drawHighlightAnnotation(),this._annotationActive=!0,this._isHighlight=!0):(this._annotationActive=!0,this._isHighlight=!0,this._isUnderline=!1,this._isStrikeout=!1)}},_initHighlight:function(){this._isHighlightEnabled?(this._isToolbarColorPicker||(this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._isHighlightEnabled=!1,this._annotationActive=!1,this._isHighlight=!1,this._isUnderline=!1,this._isStrikeout=!1,this._isUnderlineEnabled=!1,this._isStrikeOutEnabled=!1,this._drawColor=null,this._isDefaultColorSet=!1),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1):(this._toolbar.selectItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_underline"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._addAnnotation("Highlight"),this._isHighlightEnabled=!0,this._isUnderlineEnabled=!1,this._isStrikeOutEnabled=!1,this._isHighlight=!0)},_initStrikeOut:function(){this._isStrikeOutEnabled?(this._isToolbarColorPicker||(this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._isHighlightEnabled=!1,this._annotationActive=!1,this._isHighlight=!1,this._isUnderline=!1,this._isStrikeout=!1,this._isUnderlineEnabled=!1,this._isStrikeOutEnabled=!1,this._drawColor=null,this._isDefaultColorSet=!1),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1):(this._toolbar.selectItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_underline"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._addAnnotation("StrikeOut"),this._isStrikeOutEnabled=!0,this._isUnderlineEnabled=!1,this._isHighlightEnabled=!1,this._isStrikeout=!0)},_initUnderline:function(){this._isUnderlineEnabled?(this._isToolbarColorPicker||(this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_underline"),this._isHighlightEnabled=!1,this._annotationActive=!1,this._isHighlight=!1,this._isUnderline=!1,this._isStrikeout=!1,this._isUnderlineEnabled=!1,this._isStrikeOutEnabled=!1,this._drawColor=null,this._isDefaultColorSet=!1),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1):(this._toolbar.selectItemByID(this._id+"_pdfviewer_toolbar_underline"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._addAnnotation("Underline"),this._isUnderlineEnabled=!0,this._isHighlightEnabled=!1,this._isStrikeOutEnabled=!1,this._isUnderline=!0)},_showSignatureDialog:function(){if(this.model.enableSignature){var i=document.getElementById(this._id+"_imageTemp"),o=this.element[0].parentElement.clientWidth;this.element[0].parentElement.clientHeight;o>=500?(i.width=470,i.style.width="470px",window.innerHeight>=500?(i.height=400,i.style.height="400px"):(i.height=100,i.style.height="100px")):(i.width=o,i.height=100,i.style.width=o+"px",i.style.height="100px");var n=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,s=n.signatureWindow.Signature.contentText,a=n.signatureWindow.Add.contentText,r=n.signatureWindow.clear.contentText;this._replaceTextLocale(e("#"+this._id+"_addSignature")[0],a),this._replaceTextLocale(e("#"+this._id+"_clearSignature")[0],r),e("#"+this._id+"_signatureContainerDialogTab").ejDialog({title:s}),e("#"+this._id+"_popupmenu").hide(),this._clearRectOnClick(this._currentPage),e("#"+this._id+"_signatureContainerDialogTab").ejDialog("open")}},_createSignatureControl:function(){var i,o,n,s,a;this._minX=this._minY=0,this._maxX=this._maxY=0;var r=this,l=e("#"+this._id+"_pageviewContainer"),d=document.createElement("div");d.id=this._id+"_signatureContainerDialogTab",i=document.createElement("div"),(o=document.createElement("div")).id=this._id+"_signatureContainer",(n=document.createElement("canvas")).id=this._id+"_imageTemp",(s=r.element[0].parentElement)&&((a=s.clientWidth)>=500?(n.width=470,n.height=400,n.style.width="470px",n.style.height="400px"):(n.width=a,n.height=100,n.style.width=a+"px",n.style.height="100px")),o.appendChild(n);var h=n.getContext("2d"),_=t.buildTag("button","Add",{"margin-bottom":"5px","margin-top":"6px","margin-right":"10px",float:"right",opacity:"0.2",cursor:"default","pointer-events":"none"},{id:this._id+"_addSignature"}),c=t.buildTag("button","Clear",{"margin-bottom":"5px","margin-top":"6px","margin-right":"10px",float:"right"},{id:this._id+"_clearSignature"});i.appendChild(c[0]),i.appendChild(_[0]),d.appendChild(o),d.appendChild(i),l.append(d),_.ejButton({showRoundedCorner:!1,size:"small"}),c.ejButton({showRoundedCorner:!1,size:"small"}),r=this,e("#"+this._id+"_imageTemp").on("mousedown touchstart",function(e){3!=e.which&&"contextmenu"!=e.type&&(e.preventDefault(),r._findMouse(e),r._mouseDetection=!0,r._oldX=r._mouseX,r._oldY=r._mouseY,r._newObject=[],r._newpoints=[],r._mouseEvent(e))}),e("#"+this._id+"_imageTemp").on("mousemove touchmove",function(t){r._mouseDetection&&(r._findMouse(t),e("#"+r._id+"_addSignature").css({opacity:"",cursor:"pointer","pointer-events":""}),r._mouseEvent(t))}),e(window).on("mouseup touchend",function(){1==r._mouseDetection&&r._convertToString(r._newObject,h),r._mouseDetection=!1}),e("#"+this._id+"_addSignature").on("click touchend",function(t){r._newCanvas=null,r._signatureAdded=!0,r._isNewlyAdded=!0;var i=document.getElementById(r._id+"pageDiv_"+r._currentPage);"touchend"==t.type&&(t.preventDefault(),r._signatureAdded=!1,r._isNewlyAdded=!1,r._addSignature(t)),e(i).on("mousemove",function(e){r._isNewlyAdded&&(r._isNewlyAdded=!1,r._addSignature(e))}),e("#"+r._id+"_signatureContainerDialogTab").ejDialog("close")}),e("#"+this._id+"_clearSignature").on("click",function(t){e("#"+r._id+"_addSignature").css({opacity:"0.2",cursor:"default","pointer-events":"none"}),r._clearSignature(t)}),e("#"+this._id+"_signatureContainerDialogTab").ejDialog({showOnInit:!1,enableResize:!1,allowDraggable:!1,zIndex:1e8,backgroundScroll:!1,enableModal:!0,open:function(t){e("#"+r._id+"_addSignature").css({opacity:"0.2",cursor:"default","pointer-events":"none"}),r._clearSignature(t)},close:function(){e("#"+r._id+"_addSignature").css({opacity:"0.2",cursor:"default","pointer-events":"none"});var t=document.getElementById(r._id+"_imageTemp");t.getContext("2d").clearRect(0,0,t.width,t.height)}}),a>=500?e("#"+this._id+"_signatureContainerDialogTab").ejDialog({width:"500px"}):e("#"+this._id+"_signatureContainerDialogTab").ejDialog({width:"auto"}),e("#"+this._id+"_signatureContainerDialogTab").addClass("e-pdfviewer-sign-dialog")},_convertToString:function(e,t){this._addMoveTo(e[0],e[1],t),this._addLineTo(e[0],e[1],t);for(var i=2;i<e.length;i+=2)this._addLineTo(e[i],e[i+1],t)},_addLineTo:function(e,t){this._newx=e,this._newy=t,this._outputString+="<br>.lineTo("+this._newx+","+this._newy+");"},_addMoveTo:function(e,t){this._newx=e,this._newy=t,this._outputString+="<br>.moveTo("+this._newx+","+this._newy+");"},_findMouse:function(e){var t,i;"touchstart"==e.type||"touchmove"==e.type?(i={},t=e.originalEvent.target.getBoundingClientRect(),this._mouseX=e.originalEvent.touches[0].pageX-t.left,this._mouseY=e.originalEvent.touches[0].pageY-t.top,i={x:this._mouseX,y:this._mouseY},this._newpoints.push(i)):e.offsetX?(i={},this._mouseX=e.offsetX,this._mouseY=e.offsetY,i={x:this._mouseX,y:this._mouseY},this._newpoints.push(i)):e.layerX&&(this._mouseX=e.layerX,this._mouseY=e.layerY)},_mouseEvent:function(e){this._mouseDetection&&(this._draw(2,e),this._oldX=this._mouseX,this._oldY=this._mouseY)},_draw:function(e){var t=document.getElementById(this._id+"_imageTemp").getContext("2d");t.beginPath(),t.moveTo(this._oldX,this._oldY),t.lineTo(this._mouseX,this._mouseY),t.stroke(),t.lineWidth=e,t.arc(this._oldX,this._oldY,e/2,0,2*Math.PI,!0),t.closePath(),this._newObject.push(this._mouseX,this._mouseY)},_appendChildElement:function(e){var t=document.createElement("div");t.style.position="absolute",t.style.border="1px solid #4f80ff",t.style.backgroundColor="white",t.style.width="8px",t.style.height="8px",t.className=e.className,t.id=e.id,t.style.zIndex="100000000",t.style.left=parseFloat(e.style.width)/2-parseFloat(t.style.width)/2+"px",t.style.top=parseFloat(e.style.height)/2-parseFloat(t.style.height)/2+"px",e.appendChild(t)},_addSignature:function(t){var i,o,n,s,a,r,l,d,h,_,c,p,g,u,f=this._currentPage,m=document.getElementById(this._id+"pageDiv_"+f),v=document.getElementById(this._id+"pagecanvas_"+f),w=document.getElementById(this._id+"_imageTemp"),x=this._totalSignature.length,b=(parseFloat(e(w).css("width")),parseFloat(e(w).css("height")),document.createElement("canvas"));if(b.id=this._id+"imagecanvasDraw_"+f+"_"+x,b.className="e-pdfviewer-imagecanvasDraw",u=this._outputString.split("<br>")[1].split(".").slice(1).join(".")){var y=u.substring(0,6),P=u.substring(6).replace(/[{()}]/g,"").split(","),C=parseFloat(P[0]),S=parseFloat(P[1]);this._maxpointsX=this._minpointsX=C,this._maxpointsY=this._minpointsY=S}for(x=this._outputString.split("<br>").length,i=0;i<x;i++)if(u=this._outputString.split("<br>")[i].split(".").slice(1).join(".")){y=u.substring(0,6),P=u.substring(6).replace(/[{()}]/g,"").split(","),C=parseFloat(P[0]),S=parseFloat(P[1]);this._minpointsX>=C&&(this._minpointsX=C),this._minpointsY>=S&&(this._minpointsY=S),this._maxpointsX<=C&&(this._maxpointsX=C),this._maxpointsY<=S&&(this._maxpointsY=S)}for(this._minpointsX=this._minpointsX-5,this._minpointsY=this._minpointsY-5,this._maxpointsX=this._maxpointsX+5,this._maxpointsY=this._maxpointsY+5,o=this._maxpointsX-this._minpointsX,n=this._maxpointsY-this._minpointsY,this._differenceX=o,this._differenceY=n,s=0==this.model.signatureSettings.height?140:this.model.signatureSettings.height,a=0==this.model.signatureSettings.width?200:this.model.signatureSettings.width,b.width=a*this._zoomVal,b.height=s*this._zoomVal,b.style.width=a*this._zoomVal+"px",b.style.height=s*this._zoomVal+"px",r=b.width,l=b.height,b.style.position="absolute","touchend"==t.type?(t=t.originalEvent.changedTouches[0],h=e("#"+this._id+"_viewerContainer"),b.style.left=parseFloat(e(h).css("width"))/2-e(m).offset().left+"px",b.style.top=parseFloat(e(h).css("height"))/2-e(m).offset().top+"px",parseFloat(b.style.top)+l>e(m).height()?b.style.top=parseFloat(b.style.top)-l+"px":parseFloat(b.style.top)<0&&(b.style.top=parseFloat(b.style.top)+l+"px"),this._isTouchAdded=!0):(t.pageX-e(m).offset().left+r/2<v.clientWidth&&t.pageX-e(m).offset().left-r/2>0?b.style.left=t.pageX-e(m).offset().left-r/2+"px":t.pageX-e(m).offset().left-r<=0?b.style.left="0px":t.pageX-e(m).offset().left+r>=v.clientWidth&&(b.style.left=t.pageX-e(m).offset().left-r+"px"),b.style.top=t.pageY-e(m).offset().top+l<v.clientHeight&&t.pageY-e(m).offset().top-l>0?t.pageY-e(m).offset().top-l+"px":"0px"),this._canvasTopPosition=t.pageX,this._canvasLeftPosition=t.pageY,this._newCanvas=b,b.style.zIndex="10000000",m.appendChild(b),d=this,h=e("#"+this._id+"_viewerContainer"),e(window).on("mousemove",function(t){var i;if(d._signatureAdded&&d._newCanvas){(i=d._newCanvas).getContext("2d"),d._isCanasResized=!1,d._startWidth=i.clientWidth,d._startHeight=i.clientHeight;i.getBoundingClientRect();var o=t.pageX-d._canvasTopPosition,n=t.pageY-d._canvasLeftPosition;d._canvasTopPosition=t.pageX,d._canvasLeftPosition=t.pageY;parseFloat(i.style.top),parseFloat(i.style.left),document.getElementById(d._id+"e-pdfviewer-buttons");i.style.left=t.pageX-e(m).offset().left+d._startWidth/2<v.clientWidth&&t.pageX-e(m).offset().left-d._startWidth/2>0?t.pageX-e(m).offset().left-d._startWidth/2+"px":i.style.left,i.style.top=t.pageY-e(m).offset().top+d._startHeight/2<v.clientHeight&&t.pageY-e(m).offset().top-d._startHeight/2>0?t.pageY-e(m).offset().top-d._startHeight/2+"px":i.style.top}}),e(window).on("mouseup touchend",function(){d._isCanasResized=!1,d._isCanvasClicked=!1;var e=d._tempCanvas;d._tempCanvas||(e=d._newCanvas),d._signatureAdded&&d._signatureAddEvent(e),d._signatureAdded=!1,d._isCanvasMoved&&d._addingHistoryMove(e),d._isCanvasResizeOver&&d._addingHistoryResize(e)}),e(m).on("mousedown touchstart",function(t){var i,o=document.getElementById(d._id+"e-pdfviewer-selector"),n=document.getElementsByClassName("e-pdfviewer-buttons");d._signatureAdded&&d._signatureAddEvent(d._newCanvas),"e-pdfviewer-imagecanvasDraw"!=t.target.className&&"e-pdfviewer-buttons"!=t.target.className&&(i=document.getElementById(this._id+"highlight-menu"),e(i).hide(),d._tempCanvas=null,d._isCanasResized=!1,d._isCanvasClicked=!1),o&&!d._isCanvasClicked&&!d._isCanasResized&&n&&(e(o).remove(),e(n).remove()),d._signatureAdded=!1,e(b).on("mousedown touchstart",function(t){var i,o,n;d._signatureAdded=!1,d._clearRectOnClick(d._AnnotationPage),"touchstart"==t.type&&(t.preventDefault(),t=t.originalEvent.changedTouches[0]);var s=t.target.id,a=document.getElementById(s),r=document.getElementById(d._id+"pageDiv_"+f);d._tempCanvas=a,d._canvasTopPosition=t.pageX,d._canvasLeftPosition=t.pageY,d._isCanvasClicked=!0,d._isCanasResized=!1,d._initialCoordinates={},d._initialCoordinates.left=parseFloat(a.style.left),d._initialCoordinates.top=parseFloat(a.style.top),d._removeSelector(),(i=document.createElement("div")).style.position="absolute",i.style.borderRadius="3px",i.style.border="1px solid #4f80ff",i.id=d._id+"e-pdfviewer-selector",o=d._getBounds(t),i.style.width=o.width+"px",i.style.height=o.height+"px",i.style.left=o.x,i.style.top=o.y,i.style.zIndex="100000",r.appendChild(i),(n=document.createElement("div")).style.position="absolute",n.id=d._id+"e-pdfviewer-rightbottombtn",n.className="e-pdfviewer-buttons",n.style.width="20px",n.style.height="20px",n.style.left=parseFloat(o.width)-parseFloat(n.style.width)/2+"px",n.style.top=parseFloat(o.height)-parseFloat(n.style.height)/2+"px",n.style.zIndex="100000000",n.style.cursor="se-resize",i.appendChild(n),d._appendChildElement(n),e(".e-pdfviewer-buttons").on("mousedown touchstart",function(t){var i;"touchstart"==t.type&&(t.preventDefault(),t=t.originalEvent.changedTouches[0]),document.getElementById(d._id+"e-pdfviewer-selector"),d._target=t.target,i=d._tempCanvas,d._startX=t.clientX,d._startY=t.clientY,d._startWidth=i.clientWidth,d._startHeight=i.clientHeight,d._initialSize={height:parseInt(d._startHeight),width:parseInt(d._startWidth)},d._canvasTopPosition=parseFloat(e(i).css("top")),d._canvasLeftPosition=parseFloat(e(i).css("left")),d._isCanasResized=!0}),e(window).on("mousemove touchmove",function(t){var i,o,n,s=document.getElementById(d._id+"pagecanvas_"+d._currentPage),a=document.getElementById(d._id+"e-pdfviewer-selector");if("touchmove"==t.type&&(t=t.originalEvent.changedTouches[0]),1==d._isCanasResized){i=document.getElementById(d._id+"pageDiv_"+d._currentPage),"e-pdfviewer-buttons"!=(o=t.target).className&&(o.style.cursor="auto"),(n=d._tempCanvas).getContext("2d"),d._isCanvasClicked=!1;var r=d._startWidth+(t.clientX-d._startX),l=d._startHeight+(t.clientY-d._startY),h=d._canvasLeftPosition-(d._startX-t.clientX),_=d._canvasTopPosition-(d._startY-t.clientY);r-=e(n).outerWidth()-parseInt(e(n).css("width")),r+="px",l-=e(n).outerHeight()-parseInt(e(n).css("height")),l+="px",h+="px",_+="px",d._applyNewBounds(t,n,r,l,h,_,d._startX,d._startY,t.pageX,t.clientY,d._target,s,i),d._calculateIconPosition(t)}if(1==d._isCanvasClicked&&a){(n=d._tempCanvas).getContext("2d"),d._isCanasResized=!1,d._startWidth=n.clientWidth,d._startHeight=n.clientHeight;document.getElementById(d._id+"e-pdfviewer-buttons");var c=t.pageX-d._canvasTopPosition,p=t.pageY-d._canvasLeftPosition;d._canvasTopPosition=t.pageX,d._canvasLeftPosition=t.pageY;_=p+parseFloat(n.style.top),h=c+parseFloat(n.style.left),parseFloat(n.clientWidth),parseFloat(n.style.left);h>0&&h+d._startWidth<s.clientWidth?(_>0&&_+d._startHeight<s.clientHeight&&(n.style.top=p+parseFloat(n.style.top)+"px"),n.style.left=c+parseFloat(n.style.left)+"px",d._calculateIconPosition(t)):(n.style.top=n.style.top+"px",n.style.left=n.style.left+"px"),d._isCanvasMoved=!0}}),e(".e-pdfviewer-buttons").on("mouseup touchend",function(){d._isCanasResized=!1,d._isCanvasClicked=!1,d._target=null,d._isCanvasResizeOver&&d._addingHistoryResize(b)})}),e(b).on("mouseup touchend",function(){d._isCanvasClicked=!1,d._isCanasResized=!1,d._isCanvasMoved&&d._addingHistoryMove(b)})}),_=b.getContext("2d"),x=this._outputString.split("<br>").length,this._totalSignature.push(b),this._outputPath[b.id]=this._outputString,_.beginPath(),c=o/b.clientWidth,p=n/b.clientHeight,g=0;g<x;g++)if(u=this._outputString.split("<br>")[g].split(".").slice(1).join(".")){y=u.substring(0,6),P=u.substring(6).replace(/[{()}]/g,"").split(","),C=(parseFloat(P[0])-this._minpointsX)/c,S=(parseFloat(P[1])-this._minpointsY)/p;"moveTo"==y?_.moveTo(C,S):"lineTo"==y&&_.lineTo(C,S)}_.lineWidth=4,_.scale(.5,.5),_.strokeStyle=this.model.signatureSettings.color,_.stroke();var T=this._minpointsX,I=this._minpointsY,k={};k.minimumX=T,k.minimumY=I,k.differenceX=o,k.differenceY=n,this._valueChanges[b.id]=k,e(b).css("opacity",this.model.signatureSettings.opacity),e("#"+this._id+"_containerDialogTab").ejDialog("close"),this._isTouchAdded&&(this._signatureAddEvent(b),this._isTouchAdded=!1)},_signatureAddEvent:function(t){var i,o={width:0,height:0,x:0,y:0};t&&(o.width=t.clientWidth/this._zoomVal,o.height=t.clientHeight/this._zoomVal,o.x=parseFloat(e(t).css("left"))/this._zoomVal,o.y=parseFloat(e(t).css("top"))/this._zoomVal),(i={}).signatureSettings=this.model.signatureSettings,i.signatureID=t.id,i.pageNumber=parseInt(t.id.split("imagecanvasDraw_")[1].split("_")[0]),i.signatureBound=o,this.isDocumentEdited=!0,this._raiseClientEvent("signatureAdd",i)},_addingHistoryMove:function(e){var t,i=this,o={};o.operation="signatureMoved",t=parseInt(e.id.split("imagecanvasDraw_")[1].split("_")[0]),o.pageNumber=t,o.signCanvas=e,document.getElementById(i._id+"pageDiv_"+t).getBoundingClientRect(),i._newinitialCoordinates={},i._newinitialCoordinates.left=parseFloat(e.style.left),i._newinitialCoordinates.top=parseFloat(e.style.top),o.Coordinates=i._newinitialCoordinates,o.initialCoordinates=i._initialCoordinates,i._recentOperation.push(o),i._isCanvasMoved=!1},_addingHistoryResize:function(t){var i,o,n,s=this,a=s._outputPath[t.id],r=t.clientWidth,l=t.clientHeight;s._reDrawSignature(a,t,r,l),(i={}).operation="signatureResized",o=parseInt(t.id.split("imagecanvasDraw_")[1].split("_")[0]),i.pageNumber=o,i.signCanvas=t,i.initialSize=s._initialSize,i.size=s._size,s._recentOperation.push(i),s._isCanvasResizeOver=!1,n={width:0,height:0,x:0,y:0},t&&(n.width=t.clientWidth/s._zoomVal,n.height=t.clientHeight/s._zoomVal,n.x=parseFloat(e(t).css("left"))/s._zoomVal,n.y=parseFloat(e(t).css("top"))/s._zoomVal);var d={},h={color:t.getContext("2d").strokeStyle,opacity:e(t).css("opacity")};d.signatureSettings=h,d.pageNumber=t.id,d.pageId=parseInt(t.id.split("imagecanvasDraw_")[1].split("_")[0]),d.signatureCurrentBound=n,d.signaturePreviousBound=s._size,s._raiseClientEvent("signatureResize",d)},_moveSignatureArrowKey:function(t){var i,o,n,s,a,r=this;if(37==t.keyCode||38==t.keyCode||39==t.keyCode||40==t.keyCode){if((i=r._tempCanvas)&&t.preventDefault(),o=document.getElementById(r._id+"e-pdfviewer-selector"),n=document.getElementById(r._id+"pagecanvas_"+r._currentPage),i&&(l=parseFloat(i.style.left),d=parseFloat(i.style.top),r._keyInitialCoordinates={},r._keyInitialCoordinates.left=l,r._keyInitialCoordinates.top=d),e("#"+this._id+"_viewerContainer"),i&&o){var l=parseFloat(i.style.left),d=parseFloat(i.style.top),h=parseFloat(i.style.width),_=parseFloat(i.style.height),c=parseFloat(e(o).css("left")),p=parseFloat(e(o).css("top"));switch(t.keyCode){case 37:l+h>0&&l-20>0&&(i.style.left=parseFloat(i.style.left)-20+"px",e(o).css("left",c-20+"px"));break;case 39:l+h+20<n.clientWidth&&(i.style.left=parseFloat(i.style.left)+20+"px",e(o).css("left",c+20+"px"));break;case 38:d+_>0&&d-20>0&&(i.style.top=parseFloat(i.style.top)-20+"px",e(o).css("top",p-20+"px"));break;case 40:d+_+20<n.clientHeight&&(i.style.top=parseFloat(i.style.top)+20+"px",e(o).css("top",p+20+"px"))}(s={}).operation="keyMoved",a=parseInt(i.id.split("imagecanvasDraw_")[1].split("_")[0]),s.pageNumber=a,s.signCanvas=i,document.getElementById(r._id+"pageDiv_"+a).getBoundingClientRect(),r._newinitialPosition={},r._newinitialPosition.left=parseFloat(i.style.left),r._newinitialPosition.top=parseFloat(i.style.top),s.Coordinates=r._newinitialPosition,s.keyinitialCoordinates=r._keyInitialCoordinates,r._recentOperation.push(s)}}else 46==t.keyCode&&r._deleteSignatureCanvas()},_applyNewBounds:function(t,i,o,n,s,a,r,l,d,h,_,c){var p,g,u=this;u._size={},p=e(i).css("left"),g=e(i).css("top"),_.id==u._id+"e-pdfviewer-rightbottombtn"&&(parseFloat(p)>0&&parseFloat(o)+parseFloat(p)<c.clientWidth&&e(i).css("width",o),u._size.width=o),_.id==u._id+"e-pdfviewer-rightbottombtn"&&(parseFloat(g)>0&&parseFloat(n)+parseFloat(g)<c.clientHeight&&e(i).css("height",n),u._size.height=n),u._isCanvasResizeOver=!0},_calculateIconPosition:function(e){var t=this,i=document.getElementById(t._id+"e-pdfviewer-selector"),o=document.getElementById(t._id+"e-pdfviewer-rightbottombtn"),n=(document.getElementById(t._id+"e-pdfviewer-leftBottomBtn"),document.getElementById(t._id+"e-pdfviewer-rightTopBtn"),document.getElementById(t._id+"e-pdfviewer-leftTopBtn"),document.getElementsByClassName("e-pdfviewer-rotatebuttons")[0],document.getElementsByClassName("e-pdfviewer-rotate")[0],t._getBounds(e));i.style.width=n.width+"px",i.style.height=n.height+"px",i.style.left=n.x,i.style.top=n.y,o.style.left=parseFloat(n.width)-parseFloat(o.style.width)/2+"px",o.style.top=parseFloat(n.height)-parseFloat(o.style.height)/2+"px"},_removeSelector:function(){var t=document.getElementById(this._id+"e-pdfviewer-selector"),i=e(".e-pdfviewer-buttons");t&&(e(t).remove(),e(i).remove())},_getBounds:function(){var t={width:0,height:0,x:0,y:0},i=this._tempCanvas;return i&&(t.width=i.clientWidth,t.height=i.clientHeight,t.x=e(i).css("left"),t.y=e(i).css("top")),t},_clearSignature:function(){var e=document.getElementById(this._id+"_imageTemp");e.getContext("2d").clearRect(0,0,e.width,e.height),this._outputString="",this._newObject=[],this._minX=this._minY=0,this._maxX=this._maxY=0},_getPagePosition:function(e){return document.getElementById(this._id+"selectioncanvas_"+e).getBoundingClientRect()},_getTextNodes:function(e,t){var i,o,n,s,a,r=[],l=document.createRange(),d=e.getRangeAt(0),h=d.getBoundingClientRect();if(e.anchorNode==e.focusNode)this._isBackwardSelection?(l.setStart(e.focusNode,e.focusOffset),l.setEnd(e.anchorNode,e.anchorOffset)):e.anchorOffset<e.focusOffset?(l.setStart(e.anchorNode,e.anchorOffset),l.setEnd(e.focusNode,e.focusOffset)):(l.setStart(e.focusNode,e.focusOffset),l.setEnd(e.anchorNode,e.anchorOffset)),i=l.getBoundingClientRect(),r.push(i);else if(this._isBackwardSelection)this._getAnnotationOffsets(d,e.focusNode,e.anchorNode,e.focusOffset,e.anchorOffset,r);else{var _=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,c=-1!=navigator.userAgent.indexOf("Edge"),p=document.documentMode||/Edge/.test(navigator.userAgent);if(_||c||p){for(!1,s=0;s<this._textDivs[t].length;s++)(a=this._textDivs[t][s].textContent)==e.anchorNode.data&&(o=s),a==e.focusNode.data&&(n=s),s!=this._textDivs[t].length-1||n||(n=this._textDivs[t].length-1);o<n||!o?this._getAnnotationOffsets(d,e.anchorNode,e.focusNode,e.anchorOffset,e.focusOffset,r):this._getAnnotationOffsets(d,e.focusNode,e.anchorNode,e.focusOffset,e.anchorOffset,r)}else this._getAnnotationOffsets(d,e.anchorNode,e.focusNode,e.anchorOffset,e.focusOffset,r)}return{rectangleBound:h,bounds:r}},_getAnnotationOffsets:function(e,t,i,o,n,s){var a,r,l,d,h,_,c,p,g,u,f,m,v,w,x;for("e-pdfviewer-selectiondiv text_container"==t.parentNode.className?(a=parseInt(t.id.split("text_")[1]),r=parseInt(t.id.split("text_"+a+"_")[1])):(a=parseInt(t.parentNode.id.split("text_")[1]),r=parseInt(t.parentNode.id.split("text_"+a+"_")[1])),"e-pdfviewer-selectiondiv text_container"==i.parentNode.className?(l=parseInt(i.id.split("text_")[1]),d=parseInt(i.id.split("text_"+l+"_")[1])):(l=parseInt(i.parentNode.id.split("text_")[1]),d=parseInt(i.parentNode.id.split("text_"+l+"_")[1])),this._isFindboxPresent&&this._clearAllOccurrences(),p=a!=l&&this._isBackwardSelection?l:a;p<=l;p++){if(g=this._textDivs[p],p==a)c=r;else{if(!this._isBackwardSelection)break;c=0}for(u=c;u<this._textDivs[p].length;u++){for(f=g[u],m=document.createRange(),h=u==r?o:0,_=u==d?n:f.textContent.length,v=0;v<f.childNodes.length;v++)w=f.childNodes[v],m.setStart(w,h),m.setEnd(w,_);if(x=m.getBoundingClientRect(),m.detach(),s.push(x),p==l&&u==d)break}}},_drawStrikeOutAnnotation:function(){var t,i,o,n,s,a,r;if(this.model.enableTextMarkupAnnotations&&this.model.enableStrikethroughAnnotation){if(window.getSelection().toString()){var l,d=window.getSelection(),h=this._getAnchorId(d),_=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,c=-1!=navigator.userAgent.indexOf("Edge"),p=document.documentMode||/Edge/.test(navigator.userAgent);(_||c||p)&&((h=(t=this._getSelectionNodes(d)).anchorIds)<(l=t.focusIds)?this._isBackwardSelection=!1:h>l&&(this._isBackwardSelection=!0));var g,u=[],f=this._getTextNodes(d,h),m=this._drawColor?this._drawColor:this.model.strikethroughSettings.color;"object"==typeof m?(g=JSON.parse(JSON.stringify(m)),m="rgb("+m.r+","+m.g+","+m.b+")"):"string"==typeof m&&(g=this._toolbarColorpickerObject.hexCodeToRGB(m));var v=new Date,w=this.model.strikethroughSettings.modifiedDate?this.model.strikethroughSettings.modifiedDate:v.toLocaleString(),x={type:"StrikeOut",bounds:[],author:this.model.strikethroughSettings.author,subject:this.model.strikethroughSettings.subject,modifiedDate:w,colorR:g.r,colorG:g.g,colorB:g.b,colorA:255,opacity:this.model.strikethroughSettings.opacity,note:"",pageNumber:h,isLocked:this.model.strikethroughSettings.isLocked};for(a=0;a<f.bounds.length;a++){var b,y=this._getPagePosition(h),P=f.bounds[a],C=P.left-y.left;(b=P.top-y.top)>this._pageSize[h-1].PageHeight&&(h++,y=this._getPagePosition(h),b=P.top-y.top);var S=document.getElementById(this._id+"_secondarycanvas_"+h),T=(S.getBoundingClientRect(),S.getContext("2d"));T.beginPath(),b-=1.2*this._zoomVal,T.moveTo(C,b+P.height/2),T.lineTo(C+P.width,b+P.height/2),T.closePath(),T.strokeStyle=m,T.stroke(),i={xPosition:C/this._zoomVal,yPosition:b/this._zoomVal,width:P.width/this._zoomVal,height:P.height/this._zoomVal},x.bounds.push(i)}for(this._newAnnotationList[h-1].push(x),this._totalAnnotations[h].push(JSON.parse(JSON.stringify(x))),(o={}).annotationSettings=this.model.strikethroughSettings,o.annotationId=this._totalAnnotations[h].length-1,o.pageId=h,o.annotationBound=x.bounds,o.annotationType="StrikeOut",this._raiseClientEvent("annotationAdd",o),n=this._newAnnotationList[h-1].length-1,u.push(n),s={operation:"AddedStrikeOut",pageNumber:h,indexes:u},this._recentOperation.push(s),this._redoActions=[],a=0;a<this._totalPages;a++)r=[],this._redoAnnotationCollection[a]=r;window.getSelection().removeAllRanges(),this.isDocumentEdited=!0}e("#"+this._id+"custom-menu")&&e("#"+this._id+"custom-menu").hide(),this._waterDropletDivHide(),e("#"+this._id+"touchcustom-menu").hide()}},_drawUnderlineAnnotation:function(){var t,i,o,n,s,a,r;if(this.model.enableTextMarkupAnnotations&&this.model.enableUnderlineAnnotation&&window.getSelection().toString()){var l,d=window.getSelection(),h=this._getAnchorId(d),_=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,c=-1!=navigator.userAgent.indexOf("Edge"),p=document.documentMode||/Edge/.test(navigator.userAgent);(_||c||p)&&((h=(t=this._getSelectionNodes(d)).anchorIds)<(l=t.focusIds)?this._isBackwardSelection=!1:h>l&&(this._isBackwardSelection=!0));var g,u=[],f=this._drawColor?this._drawColor:this.model.underlineSettings.color;"object"==typeof f?(g=JSON.parse(JSON.stringify(f)),f="rgb("+f.r+","+f.g+","+f.b+")"):"string"==typeof f&&(g=this._toolbarColorpickerObject.hexCodeToRGB(f));var m=this._getTextNodes(d,h),v=new Date,w=this.model.underlineSettings.modifiedDate?this.model.underlineSettings.modifiedDate:v.toLocaleString(),x={type:"Underline",bounds:[],author:this.model.underlineSettings.author,subject:this.model.underlineSettings.subject,modifiedDate:w,colorR:g.r,colorG:g.g,colorB:g.b,colorA:255,opacity:this.model.underlineSettings.opacity,note:"",pageNumber:h,isLocked:this.model.underlineSettings.isLocked};for(a=0;a<m.bounds.length;a++){var b,y=this._getPagePosition(h),P=m.bounds[a],C=P.left-y.left;(b=P.top-y.top)>this._pageSize[h-1].PageHeight&&(h++,y=this._getPagePosition(h),b=P.top-y.top);var S=document.getElementById(this._id+"_secondarycanvas_"+h),T=(S.getBoundingClientRect(),S.getContext("2d"));T.beginPath(),b-=1.2*this._zoomVal,T.moveTo(C,b+P.height),T.lineTo(C+P.width,b+P.height),T.closePath(),T.strokeStyle=f,T.stroke(),i={xPosition:C/this._zoomVal,yPosition:b/this._zoomVal,width:P.width/this._zoomVal,height:P.height/this._zoomVal},x.bounds.push(i)}for(this._newAnnotationList[h-1].push(x),this._totalAnnotations[h].push(JSON.parse(JSON.stringify(x))),(o={}).annotationSettings=this.model.underlineSettings,o.annotationId=this._totalAnnotations[h].length-1,o.pageId=h,o.annotationBound=x.bounds,o.annotationType="Underline",this._raiseClientEvent("annotationAdd",o),n=this._newAnnotationList[h-1].length-1,u.push(n),s={operation:"AddedUnderline",pageNumber:h,indexes:u},this._recentOperation.push(s),this._redoActions=[],a=0;a<this._totalPages;a++)r=[],this._redoAnnotationCollection[a]=r;this.isDocumentEdited=!0,window.getSelection().removeAllRanges(),this._waterDropletDivHide(),e("#"+this._id+"touchcustom-menu").hide()}},_getAnchorId:function(e){return"e-pdfviewer-selectiondiv text_container"==e.anchorNode.parentNode.className?parseInt(e.anchorNode.id.split("text_")[1]):parseInt(e.anchorNode.parentNode.id.split("text_")[1])},_getSelectionNodes:function(e){return{anchorIds:"e-pdfviewer-selectiondiv text_container"==e.anchorNode.parentNode.className?parseInt(e.anchorNode.id.split("text_")[1]):parseInt(e.anchorNode.parentNode.id.split("text_")[1]),focusIds:"e-pdfviewer-selectiondiv text_container"==e.focusNode.parentNode.className?parseInt(e.focusNode.id.split("text_")[1]):parseInt(e.focusNode.parentNode.id.split("text_")[1])}},_drawHighlightAnnotation:function(){var t,i,o,n,s,a,r;if(this.model.enableTextMarkupAnnotations&&this.model.enableHighlightAnnotation){if(window.getSelection().toString()){var l,d=window.getSelection(),h=this._getAnchorId(d),_=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,c=-1!=navigator.userAgent.indexOf("Edge"),p=document.documentMode||/Edge/.test(navigator.userAgent);(_||c||p)&&((h=(t=this._getSelectionNodes(d)).anchorIds)<(l=t.focusIds)?this._isBackwardSelection=!1:h>l&&(this._isBackwardSelection=!0));var g,u=[],f=this._getTextNodes(d,h),m=this._drawColor?this._drawColor:this.model.highlightSettings.color;"object"==typeof m?(g=JSON.parse(JSON.stringify(m)),m="rgb("+m.r+","+m.g+","+m.b+")"):"string"==typeof m&&(g=this._toolbarColorpickerObject.hexCodeToRGB(m));var v=new Date,w=this.model.highlightSettings.modifiedDate?this.model.highlightSettings.modifiedDate:v.toLocaleString(),x={type:"Highlight",bounds:[],author:this.model.highlightSettings.author,subject:this.model.highlightSettings.subject,modifiedDate:w,colorR:g.r,colorG:g.g,colorB:g.b,colorA:255,opacity:this.model.highlightSettings.opacity,note:"",pageNumber:h,isLocked:this.model.highlightSettings.isLocked};for(a=0;a<f.bounds.length;a++){var b,y=this._getPagePosition(h),P=f.bounds[a],C=P.left-y.left;(b=P.top-y.top)>this._pageSize[h-1].PageHeight&&(h++,y=this._getPagePosition(h),b=P.top-y.top);var S=document.getElementById(this._id+"_secondarycanvas_"+h),T=(S.getBoundingClientRect(),S.getContext("2d"));T.beginPath(),b-=1.2*this._zoomVal,T.rect(C,b,P.width,P.height),T.closePath(),T.globalAlpha=.5,T.fillStyle=m,T.fill(),i={xPosition:C/this._zoomVal,yPosition:b/this._zoomVal,width:P.width/this._zoomVal,height:P.height/this._zoomVal},x.bounds.push(i)}for(this._newAnnotationList[h-1].push(x),this._totalAnnotations[h].push(JSON.parse(JSON.stringify(x))),(o={}).annotationSettings=this.model.highlightSettings,o.annotationId=this._totalAnnotations[h].length-1,o.pageId=h,o.annotationBound=x.bounds,o.annotationType="Highlight",this._raiseClientEvent("annotationAdd",o),n=this._newAnnotationList[h-1].length-1,u.push(n),s={operation:"AddedHighlight",pageNumber:h,indexes:u},this._recentOperation.push(s),this._redoActions=[],a=0;a<this._totalPages;a++)r=[],this._redoAnnotationCollection[a]=r;this.isDocumentEdited=!0,window.getSelection().removeAllRanges()}e("#"+this._id+"custom-menu")&&e("#"+this._id+"custom-menu").hide(),this._waterDropletDivHide(),e("#"+this._id+"touchcustom-menu").hide()}},_drawAnnotationRect:function(e,t,i,o,n){var s,a=document.getElementById(this._id+"_secondarycanvas_"+e);a&&((s=a.getContext("2d")).beginPath(),s.setLineDash([4]),s.globalAlpha=1,s.rect(t,i,o,n),s.closePath(),s.strokeStyle="blue",s.stroke(),s.save())},_drawAnnotSelectRect:function(e,t){var i,o,n,s,a,r;if(this._tempCanvas=null,this._removeSelector(),i=t[t.length-1],this._selectedAnnotation=i,this._selectedAnnotationObject={},this._selectedAnnotationObject.annotation=i,this._selectedAnnotationObject.pageIndex=e,(o=this._getAnnotation(t,e)).isExistingAnnotation)for(n=this._textMarkupAnnotationList[e][o.currentAnnotationIndex],a=0;a<n.Bounds.length;a++)r=n.Bounds[a],this._drawAnnotationRect(e,this._convertPointToPixel(r.X)*this._zoomVal,this._convertPointToPixel(r.Y)*this._zoomVal,this._convertPointToPixel(r.Width)*this._zoomVal,this._convertPointToPixel(r.Height)*this._zoomVal);else if((s=t[0]).bounds)for(a=0;a<s.bounds.length;a++)r=s.bounds[a],this._drawAnnotationRect(e,(r.xPosition-.5)*this._zoomVal,(r.yPosition-.5)*this._zoomVal,(r.width+.5)*this._zoomVal,(r.height+.5)*this._zoomVal);this._isAnnotationSelected=!0},_clearRectOnClick:function(e){var t=document.getElementById(this._id+"_secondarycanvas_"+e);t&&(t.getContext("2d").setLineDash([]),this._renderTextMarkupAnnotation(this._textMarkupAnnotationList[e],e),this._isAnnotationSelected=!1,this._selectedAnnotationObject=null)},_onCanvasMousedown:function(t,i,o){var n=t.getContext("2d"),s=parseInt(i-e(t.parentNode).offset().left),a=parseInt(o-e(t.parentNode).offset().top),r=n.getImageData(s,a,1,1).data;this._annotationColor=this._rgb2Color(r[0],r[1],r[2])},_showPopupNote:function(t){var i,o,n,s=document.getElementById(this._id+"_note_content"),a=this._currentAnnotationRectangle[0],r=a.Note?a.Note:a.note;if(r){s.innerText=r;var l=a.Color?a.Color.R:a.colorR,d=a.Color?a.Color.G:a.colorG,h=a.Color?a.Color.B:a.colorB,_=document.getElementById(this._id+"_author_content");_.style.borderBottom="1px solid black",_.style.fontWeight="bold",i=a.Author?a.Author:a.author,_.textContent=i,s.style.backgroundColor="rgb("+l+","+d+","+h+")",o=e("#"+this._id+"_popup_note"),n=this._setPopupMenuPosition(t,o),o.css({display:"block","background-color":"rgb("+l+","+d+","+h+")",position:"absolute"}),o.show(),o.offset({top:n.y+5,left:n.x+5}).show(),o.show(),o.offset({top:n.y+5,left:n.x+5}).show(),o.show()}},_showPopupMenu:function(t){var i,o,n,s,a,r,l,d,h,_,c,p,g;if(!this._isPropertiesWindowOpen){if(this._isPopupNoteVisible=!0,e("#"+this._id+"_popup_note").hide(),document.getElementById(this._id+"_popupinnercontent").innerText="",i=document.getElementById(this._id+"highlight-menu"),e(i).hide(),this._isContextMenuPresent=!1,o=document.getElementById(this._id+"_popupinnercontent"),e(o).focus(),o.contentEditable=!0,r=this._currentAnnotationRectangle.length>0?this._currentAnnotationRectangle:this._currentAnnotationRectangleBackup,this._annotationBackupNoteSave=r,(l=this._getAnnotation(r,this._AnnotationPage)).isExistingAnnotation)n=(d=this._textMarkupAnnotationList[this._AnnotationPage][l.currentAnnotationIndex]).Author,s=d.ModifiedDate,d.Note&&(a=d.Note);else for(h=0;h<this._currentAnnotations.length;h++){n=(_=this._currentAnnotations[h]).author,s=_.modifiedDate,_.note&&(a=_.note);break}document.getElementById(this._id+"_username").innerText=n,document.getElementById(this._id+"_currentTime").innerText=s,a&&(document.getElementById(this._id+"_popupinnercontent").innerText=a),c=document.getElementById(this._id+"_popupmenu"),e(c).css("z-index",1e9),p=e(c),g=this._setPopupMenuPosition(t,p),e(c).show(),e(c).offset({top:g.y,left:g.x}).show(),e(c).show(),e(c).offset({top:g.y,left:g.x}).show(),e(c).show()}},_saveNote:function(){var e,t,i,o,n;e=this._annotationBackupNoteSave?this._annotationBackupNoteSave:this._currentAnnotationRectangle.length>0?this._currentAnnotationRectangle:this._currentAnnotationRectangleBackup;var s=new Date,a=this._getAnnotation(e,this._AnnotationPage),r=document.getElementById(this._id+"_popupinnercontent");if(a.isExistingAnnotation)(t=this._textMarkupAnnotationList[this._AnnotationPage][a.currentAnnotationIndex]).Note!=r.textContent&&("Highlight"==(n=t.TextMarkupAnnotationType)?t.ModifiedDate=this.model.highlightSettings.modifiedDate?this.model.highlightSettings.modifiedDate:s.toLocaleString():"Underline"==n?t.ModifiedDate=this.model.underlineSettings.modifiedDate?this.model.underlineSettings.modifiedDate:s.toLocaleString():"StrikeOut"==n&&(t.ModifiedDate=this.model.strikethroughSettings.modifiedDate?this.model.strikethroughSettings.modifiedDate:s.toLocaleString()),t.Note=r.textContent);else for(i=0;i<this._currentAnnotations.length;i++){(o=this._currentAnnotations[i]).note!=r.textContent&&("Highlight"==(n=o.type)?o.modifiedDate=this.model.highlightSettings.modifiedDate?this.model.highlightSettings.modifiedDate:s.toLocaleString():"Underline"==n?o.modifiedDate=this.model.underlineSettings.modifiedDate?this.model.underlineSettings.modifiedDate:s.toLocaleString():"StrikeOut"==n&&(o.modifiedDate=this.model.strikethroughSettings.modifiedDate?this.model.strikethroughSettings.modifiedDate:s.toLocaleString()),o.note=r.innerText);break}r.innerText=""},_setPropertiesWindowLocale:function(t){var i=t.propertyWindow.appearance.contentText,o=t.propertyWindow.general.contentText,n=t.propertyWindow.color.contentText,s=t.propertyWindow.opacity.contentText,a=t.propertyWindow.author.contentText,r=t.propertyWindow.subject.contentText,l=t.propertyWindow.modified.contentText,d=t.propertyWindow.ok.contentText,h=t.propertyWindow.cancel.contentText,_=t.propertyWindow.locked.contentText;this._replaceTextLocale(e("#"+this._id+"_appearanceli").children("a")[0],i),this._replaceTextLocale(e("#"+this._id+"_generalli").children("a")[0],o),this._replaceTextLocale(e("#"+this._id+"_colorspan")[0],n),this._replaceTextLocale(e("#"+this._id+"_opacityspan")[0],s),this._replaceTextLocale(e("#"+this._id+"_authorspan")[0],a),this._replaceTextLocale(e("#"+this._id+"_subjectspan")[0],r),this._replaceTextLocale(e("#"+this._id+"_modifiedspan")[0],l),this._replaceTextLocale(e("#"+this._id+"_ok")[0],d),this._replaceTextLocale(e("#"+this._id+"_cancel")[0],h),this._replaceTextLocale(e("#"+this._id+"_lockedprop")[0],_)},_showPropertiesMenu:function(){var i,o,n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w;if(this._isPropertiesWindowOpen=!0,i=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,this._setPropertiesWindowLocale(i),o=document.getElementById(this._id+"highlight-menu"),e(o).hide(),e("#"+this._id+"_generalli").css("display",""),e(".e-pdfviewer-lockedcheckbox").css("visibility",""),e("#"+this._id+"_lockedprop").css("visibility",""),this._isContextMenuPresent=!1,e("#"+this._id+"_PropertiesDialogTab").data("ejTab").showItem(0),h=this._getAnnotation(this._currentAnnotationRectangleBackup,this._AnnotationPage),this._tempCanvas){e("#"+this._id+"_lockedcheckbox").data("ejCheckBox").option("checked",!1);var x=this._tempCanvas,b=x.getContext("2d").strokeStyle;n={r:parseInt(b.slice(1,3),16),g:parseInt(b.slice(3,5),16),b:parseInt(b.slice(5,7),16)},s=parseFloat(e(x).css("opacity")),_="Signature",e("#"+this._id+"_generalli").css("display","none"),e(".e-pdfviewer-lockedcheckbox").css("visibility","hidden"),e("#"+this._id+"_lockedprop").css("visibility","hidden"),this._hided=!0}else if(h.isExistingAnnotation)n={r:(c=this._textMarkupAnnotationList[this._AnnotationPage][h.currentAnnotationIndex]).Color.R,g:c.Color.G,b:c.Color.B},s=c.Opacity,a=c.Author,r=c.Subject,l=c.ModifiedDate,d=c.isLocked,_=c.TextMarkupAnnotationType;else if(this._currentAnnotations.length>0)for(p=0;p<this._currentAnnotations.length;p++){n={r:(g=this._currentAnnotations[p]).colorR,g:g.colorG,b:g.colorB},s=g.opacity,a=g.author,r=g.subject,l=g.modifiedDate,d=g.isLocked,_=g.type;break}n&&this._colorpickerObject.option("value",this._rgb2Color(n.r,n.g,n.b)),w=e("#"+this._id+"_slider").data("ejSlider"),u=parseInt(100*s),w.option("value",u),e("#"+this._id+"_opacity").val(u+"%"),e("#"+this._id+"_author_input").val(a),e("#"+this._id+"_subject_input").val(r),document.getElementById(this._id+"_modifieddate").childNodes[0].textContent=l,e("#"+this._id+"_containerDialogTab").ejDialog({title:_+" Properties"}),f=e("#"+this._id+"_containerDialogTab_title").children("span")[0],"Highlight"==_?f.textContent=i.propertyWindow.highlightProperties.contentText:"StrikeOut"==_?f.textContent=i.propertyWindow.strikeOutProperties.contentText:"Underline"==_?f.textContent=i.propertyWindow.underlineProperties.contentText:"Signature"==_&&(f.textContent=i.propertyWindow.signatureProperties.contentText),e("#"+this._id+"_containerDialogTab").ejDialog("open"),m=Math.max(0,(e(window).height()-e("#"+this._id+"_containerDialogTab").outerHeight())/2+e(window).scrollTop())+"px",v=Math.max(0,(e(window).width()-e("#"+this._id+"_containerDialogTab").outerWidth())/2+e(window).scrollLeft())+"px",e("#"+this._id+"_containerDialogTab").ejDialog({position:{X:v,Y:m}}),d?(this._colorpickerObject.option("enabled",!1),document.getElementById(this._id+"_opacity").disabled=!0,e("#"+this._id+"_opacity").addClass("e-disable"),(w=e("#"+this._id+"_slider").data("ejSlider")).disable(),document.getElementById(this._id+"_author_input").disabled=!0,e("#"+this._id+"_author_input").addClass("e-disable"),document.getElementById(this._id+"_subject_input").disabled=!0,e("#"+this._id+"_subject_input").addClass("e-disable"),e("#"+this._id+"_lockedcheckbox").data("ejCheckBox").option("checked",!0)):(this._colorpickerObject.option("enabled",!0),document.getElementById(this._id+"_opacity").disabled=!1,e("#"+this._id+"_opacity").removeClass("e-disable"),document.getElementById(this._id+"_author_input").disabled=!1,e("#"+this._id+"_author_input").removeClass("e-disable"),document.getElementById(this._id+"_subject_input").disabled=!1,e("#"+this._id+"_subject_input").removeClass("e-disable"),(w=e("#"+this._id+"_slider").data("ejSlider")).enable(),e("#"+this._id+"_lockedcheckbox").data("ejCheckBox").option("checked",!1))},_lockProperties:function(){"check"==e("#"+this._id+"_lockedcheckbox").data("ejCheckBox").model.checkState?(this._colorpickerObject.option("enabled",!1),document.getElementById(this._id+"_opacity").disabled=!0,e("#"+this._id+"_opacity").addClass("e-disable"),document.getElementById(this._id+"_author_input").disabled=!0,e("#"+this._id+"_author_input").addClass("e-disable"),document.getElementById(this._id+"_subject_input").disabled=!0,e("#"+this._id+"_subject_input").addClass("e-disable"),e("#"+this._id+"_slider").data("ejSlider").disable()):(this._colorpickerObject.option("enabled",!0),document.getElementById(this._id+"_opacity").disabled=!1,e("#"+this._id+"_opacity").removeClass("e-disable"),document.getElementById(this._id+"_author_input").disabled=!1,e("#"+this._id+"_author_input").removeClass("e-disable"),document.getElementById(this._id+"_subject_input").disabled=!1,e("#"+this._id+"_subject_input").removeClass("e-disable"),e("#"+this._id+"_slider").data("ejSlider").enable())},_setDrawColor:function(e){this._isDefaultColorSet&&(this._drawColor=this._toolbarColorpickerObject.hexCodeToRGB(e.value),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1,this._isDefaultColorSet=!1)},_createNote:function(){var i=e("#"+this._id+"_viewerContainer"),o=t.buildTag("div.e-pdfviewer-annotation-note","",{display:"none"},{id:this._id+"_popup_note"}),n=t.buildTag("div.e-pdfviewer-annotation-authorcontent","",{},{id:this._id+"_author_content"}),s=t.buildTag("div.e-pdfviewer-annotation-notecontent","",{},{id:this._id+"_note_content"});o.append(n),o.append(s),i.append(o)},_createPopupMenu:function(){var i,o,n,s,a,r,l,d,h,_,c,p,g=e("#"+this._id+"_viewerContainer"),u=document.createElement("DIV");u.id=this._id+"_popupmenu",u.className="e-pdfviewer-popupmenu",g.append(u),(i=document.createElement("DIV")).className="e-pdfviewer-header",i.id=this._id+"_popupheader",u.appendChild(i),(o=document.createElement("DIV")).className="e-pdfviewer-username",o.id=this._id+"_username",o.innerHTML="Guest",i.appendChild(o),n=t.buildTag("div.e-pdfviewer-closepopup","",{},{id:this._id+"_popup_close"}),s=t.buildTag("span.e-pdfviewer-icon e-pdfviewer-closeicon"),n[0].appendChild(s[0]),i.appendChild(n[0]),a=this,e(".e-pdfviewer-closeicon").on("click touchend",function(){a._saveNote(),e(".e-pdfviewer-popupmenu").hide(),a._isPopupNoteVisible=!1}),r=document.createElement("DIV"),l=document.createElement("DIV"),r.className="e-pdfviewer-currenttime",l.id=this._id+"_currentTime",d=new Date,l.innerHTML=d.toLocaleString(),r.appendChild(l),u.appendChild(r),(h=document.createElement("DIV")).className="e-pdfviewer-content",h.id=this._id+"_popupcontent",(_=document.createElement("DIV")).className="e-pdfviewer-innercontent",_.id=this._id+"_popupinnercontent",_.innerText=" ",_.style.width="366.667px",_.style.height="132.073px",_.style.overflow="hidden",_.style.overflowY="auto",h.appendChild(_),u.appendChild(h),(c=document.createElement("DIV")).className="e-pdfviewer-footer",c.id=this._id+"_popupfooter",u.appendChild(c),p=document.getElementById(this._id+"_popupmenu"),_.addEventListener("paste",function(e){e.preventDefault();var t=e.clipboardData.getData("text/plain");document.execCommand("insertHTML",!1,t)}),this._on(e(p),"mousedown touchstart",this._popupNoteMousedown),this._on(e(p),"mouseup touchend",this._popupNoteMouseup),this._on(e(window),"touchmove mousemove",this._movePopupNote)},_popupNoteMousedown:function(e){if("touchstart"==e.type&&(e=e.originalEvent.changedTouches[0]),3!=e.which||"touchstart"==e.type){this._isPopupNoteFocused=!0;var t=document.getElementById(this._id+"_popupmenu");this._xpos=e.clientX-t.offsetLeft,this._ypos=e.clientY-t.offsetTop}},_popupNoteMouseup:function(){this._enableSelection(),this._isPopupNoteFocused=!1},_movePopupNote:function(t){var i,o;if("touchmove"==t.type&&(t=t.originalEvent.changedTouches[0]),this._isPopupNoteFocused||"touchmove"==t.type){i=document.getElementById(this._id+"_viewerContainer"),o=document.getElementById(this._id+"_popupmenu"),this._isContextMenuPresent=!0;var n=t.clientX-this._xpos,s=t.clientY-this._ypos,a=this._calulateCurrentPosition(s,o),r=parseFloat(e(o).css("width"));parseFloat(e(o).css("height"));n>0&&n+r<=i.clientWidth&&(o.style.left=n+"px"),a&&(o.style.top=s+"px")}},_calulateCurrentPosition:function(t,i){for(var o,n,s=5,a=parseFloat(e(i).css("height")),r=1;r<=this._totalPages;r++)o=this._pageSize[r-1].PageHeight*this._zoomVal,r==this._AnnotationPage&&t>s&&t+a<o+s&&(n=s),s+=o;if(n)return!0},_createPropertiesMenu:function(){var i,o,n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w,x,b,y,P,C,S,T,I,k,z,A,D,B,R,E,N=e("#"+this._id+"_pageviewContainer"),O=document.createElement("div");O.id=this._id+"_containerDialogTab";var V=document.createElement("div"),L=t.buildTag("div","",{height:"auto"},{id:this._id+"_PropertiesDialogTab"}),M=document.createElement("ul");M.innerHTML="<li id= '"+this._id+"_appearanceli'><a href=#"+this._id+"_apperanceProperties>Appearance</a></li><li id= '"+this._id+"_generalli'><a href=#"+this._id+"_generalProperties>General</a></li>",i=t.buildTag("div","",{},{id:this._id+"_apperanceProperties"}),o=t.buildTag("div","",{},{id:this._id+"_generalProperties"}),V.appendChild(L[0]),L[0].appendChild(M),L[0].appendChild(i[0]),L[0].appendChild(o[0]),(n=document.createElement("div")).style.paddingBottom="11px";var F=t.buildTag("button.e-pdfviewer-properties-okbtn","OK",{float:"right","margin-right":"18px"},{id:this._id+"_ok"}),j=t.buildTag("button.e-pdfviewer-properties-cancelbtn","Cancel",{float:"right"},{id:this._id+"_cancel"}),H=t.buildTag("input","",{},{type:"checkbox","aria-label":"locked Checkbox"}),W=document.createElement("label");W.id=this._id+"_lockedprop",W.className="e-pdfviewer-properties-label",W.style.marginRight="18px",W.innerHTML="Locked",n.appendChild(H[0]),n.appendChild(W),n.appendChild(j[0]),n.appendChild(F[0]),H.ejCheckBox({cssClass:"e-pdfviewer-lockedcheckbox",id:this._id+"_lockedcheckbox",size:t.CheckboxSize.Small,change:e.proxy(this._lockProperties,this)}),i[0].style.height="300px",o[0].style.height="300px",V.appendChild(n),O.appendChild(V),N.append(O),F.ejButton({showRoundedCorner:!0,size:"small"}),j.ejButton({showRoundedCorner:!0,size:"small"}),e("#"+this._id+"_PropertiesDialogTab").ejTab({}),this.element.width()>=500?e("#"+this._id+"_containerDialogTab").ejDialog({showOnInit:!1,width:"500px",enableResize:!1,close:e.proxy(this._closePropertiesWindow,this),backgroundScroll:!1,enableModal:!0}):e("#"+this._id+"_containerDialogTab").ejDialog({showOnInit:!1,width:"auto",enableResize:!1,close:e.proxy(this._closePropertiesWindow,this),backgroundScroll:!1,enableModal:!0}),s=document.createElement("div"),(a=document.createElement("div")).className="e-pdfviewer-color-container",s.appendChild(a),(r=document.createElement("div")).className="e-pdfviewer-color-span",(l=document.createElement("div")).className="e-pdfviewer-color-picker",a.appendChild(r),a.appendChild(l),(d=document.createElement("SPAN")).id=this._id+"_colorspan",d.innerHTML="Color:",r.appendChild(d),(h=document.createElement("input")).type="text",h.id=this._id+"_colorpicker",e(h).attr("aria-label","colorpicker"),l.appendChild(h),(_=document.createElement("div")).className="e-pdfviewer-opacity-container",s.appendChild(_),(c=document.createElement("div")).className="e-pdfviewer-opacity-span",(p=document.createElement("div")).className="e-pdfviewer-opacity-field",_.appendChild(c),_.appendChild(p),(g=document.createElement("SPAN")).id=this._id+"_opacityspan",g.innerHTML="Opacity:",c.appendChild(g),(u=document.createElement("input")).type="text",u.id=this._id+"_opacity",u.className="e-inputchangeval",u.value="100%",u.style.width="50px",u.style.height="20px",e(u).attr("aria-label","opacity"),p.appendChild(u),(f=document.createElement("div")).className="e-pdfviewer-slider-control",f.style.width="100px",_.appendChild(f),(m=document.createElement("DIV")).id=this._id+"_slider",f.appendChild(m),i.append(s),e("#"+this._id+"_colorpicker").ejColorPicker({modelType:"palette"}),e("#"+this._id+"_colorpicker").ejColorPicker("hide"),this._colorpickerObject=e("#"+this._id+"_colorpicker").data("ejColorPicker"),e("#"+this._id+"_slider").ejSlider({cssClass:"e-pdfviewer-opacity-slider",value:100,minValue:0,maxValue:100,incrementStep:1,showRoundedCorner:!0,change:this._slidervaluechange,slide:this._slidervaluechange}),(v=document.createElement("div")).style.border="0px",(w=document.createElement("div")).className="e-pdfviewer-author-container",v.appendChild(w),(x=document.createElement("div")).className="e-pdfviewer-author-span",w.appendChild(x),(b=document.createElement("SPAN")).id=this._id+"_authorspan",b.innerHTML="Author:",x.appendChild(b),(y=document.createElement("div")).className="e-pdfviewer-author-inputdiv",w.appendChild(y),(P=document.createElement("input")).id=this._id+"_author_input",P.className="e-pdfviewer-author-input",e(P).attr("aria-label","author input"),y.appendChild(P),(C=document.createElement("div")).className="e-pdfviewer-subject-container",v.appendChild(C),(S=document.createElement("div")).className="e-pdfviewer-subject-span",C.appendChild(S),(T=document.createElement("SPAN")).id=this._id+"_subjectspan",T.innerHTML="Subject:",S.appendChild(T),(I=document.createElement("div")).className="e-pdfviewer-subject-inputdiv",C.appendChild(I),(k=document.createElement("input")).id=this._id+"_subject_input",k.className="e-pdfviewer-subject-input",e(k).attr("aria-label","subject input"),I.appendChild(k),(z=document.createElement("div")).className="e-pdfviewer-modifieddate-container",z.style.height="18.67px",v.appendChild(z),(A=document.createElement("div")).className="e-pdfviewer-modified-labeldiv",(D=document.createElement("SPAN")).id=this._id+"_modifiedspan",D.innerHTML="Modified:",A.appendChild(D),z.appendChild(A),(B=document.createElement("div")).className="e-pdfviewer-modifieddate-labeldiv",B.id=this._id+"_modifieddate",(R=document.createElement("SPAN")).innerHTML="",B.appendChild(R),z.appendChild(B),o.append(v),e("#"+this._id+"_containerDialogTab_title").addClass("e-pdfviewer-propertiestitle"),e("#"+this._id+"_containerDialogTab").addClass("e-pdfviewer-propertiestab"),e("#"+this._id+"_PropertiesDialogTab").addClass("e-pdfviewer-innertab"),e("#"+this._id+"_apperanceProperties").addClass("e-pdfviewer-appearanceprop"),e("#"+this._id+"_generalProperties").addClass("e-pdfviewer-generalprop"),e("#"+this._id+"_appearanceli").addClass("e-pdfviewer-tab-li"),e("#"+this._id+"_generalli").addClass("e-pdfviewer-tab-li"),e(u).addClass("e-pdfviewer-elementalignments"),e(u).addClass("ejinputtext"),e(P).addClass("e-pdfviewer-elementalignments"),e(P).addClass("ejinputtext"),e(k).addClass("e-pdfviewer-elementalignments"),e(k).addClass("ejinputtext"),this._tabObject=e("#"+this._id+"_PropertiesDialogTab").data("ejTab"),this._on(e("#"+this._id+"_ok"),"click",this._applyAnnotationProperties),this._on(e("#"+this._id+"_cancel"),"click",this._cancelAnnotationProperties),(E=document.getElementById(this._id+"_lockedcheckbox_hidden"))&&e(E).attr("aria-label","hidden checkbox")},_applyAnnotationProperties:function(){this._tabObject;var t=this._colorpickerObject.rgb,i=parseInt(e("#"+this._id+"_opacity").val().split("%")[0])/100,o=e("#"+this._id+"_author_input").val(),n=e("#"+this._id+"_subject_input").val(),s=this._getAnnotation(this._currentAnnotationRectangleBackup,this._AnnotationPage);this._changeAnnotationProperties(t,i,o,n,s.currentAnnotationIndex,this._AnnotationPage,s.isExistingAnnotation),e("#"+this._id+"_containerDialogTab").ejDialog("close")},_cancelAnnotationProperties:function(){e("#"+this._id+"_containerDialogTab").ejDialog("close")},_getAnnotation:function(e,t){for(var i,o,n,s=this._textMarkupAnnotationList[t],a=[],r=null,l=!1,d=0;d<e.length;d++)if(s)for(i=0;i<s.length;i++)e[d]==s[i]&&(a.push(s[i]),r=i,l=!0);for(s=this._newAnnotationList[t-1],d=0;d<e.length;d++){if(s)for(n=0;n<s.length;n++)e[d]==s[n]&&(a.push(s[n]),r=n,l=!1,o=s[n]);if(e[d]==o)break}return this._currentAnnotations=a,{currentAnnotationIndex:r,isExistingAnnotation:l}},_changeAnnotationProperties:function(t,i,o,n,s,a,r){var l,d,h,_,c,p,g,u=document.getElementById(this._id+"_secondarycanvas_"+a);if(u&&!this._tempCanvas){u.getContext("2d").clearRect(0,0,u.width,u.height),this._selectedAnnotationObject=null;var f,m,v=!1,w=!1,x={},b=new Date;this._drawAnnotSelectRect(a,this._currentAnnotationRectangleBackup)}if(this._tempCanvas){var y=!1,P=!1,C=this._tempCanvas,S=C.getContext("2d"),T=S.strokeStyle,I=e(C).css("opacity");S.strokeStyle="rgb("+t.r+","+t.g+","+t.b+")",S.stroke(),e(C).css("opacity",i),I!=i&&(y=!0),T!=S.strokeStyle&&(P=!0),(y||P)&&((x={}).isColorChange=P,x.isOpacityChange=y,x.signatureID=this._tempCanvas.id,x.currentColor=S.strokeStyle,x.perviousColor=T,x.previousOpacity=I,x.currentOpacity=i,x.pageId=parseInt(this._tempCanvas.id.split("imagecanvasDraw_")[1].split("_")[0]),this._raiseClientEvent("signaturePropertiesChange",x)),c={operation:"SignatureModifed",pageNumber:this._currentPage,sign:C,newstrokeStyle:S.strokeStyle,newsopacity:e(C).css("opacity"),previousstrokeStyle:T,previousOpacity:I},_=e("#"+this._id+"_lockedcheckbox").data("ejCheckBox"),this._recentOperation.push(c)}else r?(((d=this._textMarkupAnnotationList[a][s]).Color.R!=t.r||d.Color.G!=t.g||d.Color.B!=t.b||d.Opacity!=i||d.Author!=o||d.Subject!=n)&&(h={},h=JSON.parse(JSON.stringify(d)),this._colorModifiedAnnotationList[a-1].push(h),d.Color.R!=t.r||d.Color.G!=t.g||d.Color.B!=t.b?v=!0:d.Opacity!=i&&(w=!0),d.Color.R=t.r,d.Color.G=t.g,d.Color.B=t.b,d.Color.A=t.a,d.Opacity=i,d.Author=o,d.Subject=n,"Highlight"==(f=d.TextMarkupAnnotationType)?d.ModifiedDate=this.model.highlightSettings.modifiedDate?this.model.highlightSettings.modifiedDate:b.toLocaleString():"Underline"==f?d.ModifiedDate=this.model.underlineSettings.modifiedDate?this.model.underlineSettings.modifiedDate:b.toLocaleString():"StrikeOut"==f&&(d.ModifiedDate=this.model.strikethroughSettings.modifiedDate?this.model.strikethroughSettings.modifiedDate:b.toLocaleString()),m=s,this._totalAnnotations[a][s]=JSON.parse(JSON.stringify(d)),(l={}).index=s,l.annotation=d,l.action="propertyChanged",this._existingAnnotationsModified[a-1].push(l),c={operation:"propertiesModifiedForExistingAnnot",pageNumber:this._AnnotationPage,indexes:s},this._recentOperation.push(c)),_=e("#"+this._id+"_lockedcheckbox").data("ejCheckBox"),d.isLocked="check"==_.model.checkState):((d=this._newAnnotationList[a-1][s]).colorR!=t.r||d.colorG!=t.g||d.colorB!=t.b||d.opacity!=i||d.author!=o||d.subject!=n)&&(h={},h=JSON.parse(JSON.stringify(d)),this._colorModifiedAnnotationList[a-1].push(h),d.colorR!=t.r||d.colorG!=t.g||d.colorB!=t.b?v=!0:d.opacity!=i&&(w=!0),d.colorR=t.r,d.colorG=t.g,d.colorB=t.b,d.opacity=i,d.colorA=255*d.opacity,d.author=o,d.subject=n,"Highlight"==(f=d.type)?d.modifiedDate=this.model.highlightSettings.modifiedDate?this.model.highlightSettings.modifiedDate:b.toLocaleString():"Underline"==f?d.modifiedDate=this.model.underlineSettings.modifiedDate?this.model.underlineSettings.modifiedDate:b.toLocaleString():"StrikeOut"==f&&(d.modifiedDate=this.model.strikethroughSettings.modifiedDate?this.model.strikethroughSettings.modifiedDate:b.toLocaleString()),m=this._textMarkupAnnotationList[a]?this._textMarkupAnnotationList[a].length+s:s,this._totalAnnotations[a][m]=JSON.parse(JSON.stringify(d)),_=e("#"+this._id+"_lockedcheckbox").data("ejCheckBox"),d.isLocked="check"==_.model.checkState,c={operation:"propertiesModifiedForNewAnnot",pageNumber:this._AnnotationPage,indexes:s},this._recentOperation.push(c));for((v||w)&&(x.isColorChanged=v,x.isOpacityChanged=w,x.annotationType=f,x.annotationId=m,x.pageId=a,this._raiseClientEvent("annotationPropertiesChange",x)),this._redoActions=[],p=0;p<this._totalPages;p++)g=[],this._redoAnnotationCollection[p]=g;this.isDocumentEdited=!0,this._tempCanvas||this._renderTextMarkupAnnotation(this._textMarkupAnnotationList[a],a)},_slidervaluechange:function(t){var i=t.value,o=this._id.split("_slider")[0];e("#"+o+"_opacity").val(i+"%")},_deleteAnnotation:function(){var e,t,i,o,n,s,a;if(this._isAnnotationSelected){var r,l=[],d={},h=this._getAnnotation(this._currentAnnotationRectangleBackup,this._AnnotationPage);if(h.isExistingAnnotation){for(e=(r=this._textMarkupAnnotationList[this._AnnotationPage])[h.currentAnnotationIndex],d.annotationType=e.TextMarkupAnnotationType,this._deletedAnnotationList[this._AnnotationPage-1].push(e),(t={}).index=e.Index,d.annotationId=e.Index,d.pageId=this._AnnotationPage,t.annotation=e,t.action="deleted",this._existingAnnotationsModified[this._AnnotationPage-1].push(t),this._annotationsDeletedNo[this._AnnotationPage-1]=this._annotationsDeletedNo[this._AnnotationPage-1]+1,s=0;s<r.length;s++)r[s]!=e&&l.push(r[s]);n={operation:"existingAnnotationDeleted",pageNumber:this._AnnotationPage,indexes:h.currentAnnotationIndex},this._recentOperation.push(n),this._textMarkupAnnotationList[this._AnnotationPage]=l,this._totalAnnotations[this._AnnotationPage].splice(h.currentAnnotationIndex,1)}else i=(r=this._newAnnotationList[this._AnnotationPage-1])[h.currentAnnotationIndex],d.annotationType=i.type,this._deletedAnnotationList[this._AnnotationPage-1].push(i),this._newAnnotationList[this._AnnotationPage-1].splice(h.currentAnnotationIndex,1),o=this._textMarkupAnnotationList[this._AnnotationPage]?this._textMarkupAnnotationList[this._AnnotationPage].length+h.currentAnnotationIndex:h.currentAnnotationIndex,d.annotationId=o,d.pageId=this._AnnotationPage,this._totalAnnotations[this._AnnotationPage].splice(o,1),n={operation:"newAnnotationDeleted",pageNumber:this._AnnotationPage,indexes:h.currentAnnotationIndex},this._recentOperation.push(n);for(this._redoActions=[],s=0;s<this._totalPages;s++)a=[],this._redoAnnotationCollection[s]=a;this._raiseClientEvent("annotationRemove",d),this.isDocumentEdited=!0,this._clearRectOnClick(this._AnnotationPage),this._isAnnotationSelected=!1}this._deleteSignatureCanvas()},_createHighlightContextMenu:function(){var t,i=document.createElement("div"),o=e("#"+this._id+"_pageviewContainer");i.id=this._id+"highlight-menu",i.className="e-pdfviewer-highlight-menu",o.append(i),(t=document.createElement("ol")).className="highlightorderedList",i.appendChild(t),window.getSelection().toString(),e(t).append("<li class='popupnoteli'><a href='javascript:void(0);' class='popupnote' id = '"+this._id+"_openPopup'>Open Pop-Up Note</a></li>"),e(t).append("<li class='deleteAnnotationli'><a href='javascript:void(0);' id='"+this._id+"_deleteannot' class='deleteAnnotation'>Delete </a></li>"),e(t).append("<li class='Propertiesli'><a href='javascript:void(0);' class='Properties' id = '"+this._id+"_propAnnot'>Properties.... </a></li>")},_setPopupMenuPosition:function(t,i){var o;("touchstart"==t.type&&i[0].id==this._id+"_popupmenu"||"touchmove"==t.type&&i[0].id==this._id+"_popup_note")&&(t=t.originalEvent.changedTouches[0]);var n={},s={},a={};return a.x=i.outerWidth(),a.y=i.outerHeight(),n.x=t.pageX,n.y=t.pageY,s.x=n.x+a.x>e(window).width()+e(window).scrollLeft()?n.x-a.x:n.x,s.y=n.y+a.y>e(window).height()+e(window).scrollTop()?n.y-a.y:n.y,i[0].id==this._id+"_popupmenu"&&(o=document.getElementById(this._id+"_viewerContainer"),s.x+a.x>o.clientWidth&&(s.x=s.x-a.x/4)),s},_setDeleteContextMenuPostion:function(t){var i=e("#"+this._id+"custom-menu");"touchstart"==t.type&&(t=t.originalEvent.changedTouches[0]);var o={},n={},s={};return s.x=i.outerWidth(),s.y=i.outerHeight(),o.x=t.pageX,o.y=t.pageY,n.x=o.x+s.x>e(window).width()+e(window).scrollLeft()?o.x-s.x:o.x,n.y=o.y+s.y>e(window).height()+e(window).scrollTop()?o.y-s.y:o.y,n},_setHighLightContextMenuPostion:function(t){var i=e("#"+this._id+"custom-menu"),o={},n={},s={};return s.x=i.outerWidth(),s.y=i.outerHeight(),o.x=t.pageX,o.y=t.pageY,n.x=o.x+s.x>e(window).width()+e(window).scrollLeft()?o.x-s.x:o.x,n.y=o.y+s.y>e(window).height()+e(window).scrollTop()?o.y-s.y:o.y,n},_onViewerKeypress:function(t){var i,o,n,s;if(this._moveSignatureArrowKey(t),t.ctrlKey&&90==t.which||t.ctrlKey&&90==t.keyCode?this._isPropertiesWindowOpen||this._undo():(t.ctrlKey&&89==t.which||t.ctrlKey&&89==t.keyCode)&&(this._isPropertiesWindowOpen||this._redo()),9==t.which&&t.target&&"e-pdfviewer-formFields"==t.target.className)if(i=t.target.id.split("input_")[1].split("_")[0],o=parseInt(i),this._maintainTabindex[i]==t.target.tabIndex){if(a=document.getElementById(this._id+"selectioncanvas_"+(o+1)))(r=e(a).find(".e-pdfviewer-formFields")).length>0&&(r[0].focus(),t.preventDefault());else if(a=document.getElementById(this._id+"selectioncanvas_1"))for(r=e(a).find(".e-pdfviewer-formFields"),n=0;n<r.length;n++)if(r[n].tabIndex==this._maintanMinTabindex[1]){r[n].focus(),t.preventDefault();break}}else{var a=document.getElementById(this._id+"selectioncanvas_"+o),r=e(a).find(".e-pdfviewer-formFields"),l=!0;for(s=0;s<r.length;s++)if(l=!1,r[s].tabIndex==t.target.tabIndex+1){r[s].focus(),l=!0,t.preventDefault();break}l||(t.target.nextElementSibling.focus(),t.preventDefault(),l=!0)}},_undo:function(){var e,t,i;if(this._removeSelector(),e=this._recentOperation.pop()){if("AddedHighlight"==e.operation||"AddedUnderline"==e.operation||"AddedStrikeOut"==e.operation){for(t=0;t<e.indexes.length;t++)i=this._newAnnotationList[e.pageNumber-1].pop(),this._redoAnnotationCollection[e.pageNumber-1].push(i);this._redoActions.push(e)}else"propertiesModifiedForExistingAnnot"==e.operation||"propertiesModifiedForNewAnnot"==e.operation?(this._undoModifiedProperty(e),this._redoActions.push(e)):"existingAnnotationDeleted"==e.operation||"newAnnotationDeleted"==e.operation?(this._undoDeletedItem(e),this._redoActions.push(e)):"signatureAdded"==e.operation?(this._undoSignatureAdd(e),this._redoActions.push(e)):"signatureResized"==e.operation?(this._undoSignatureResize(e),this._redoActions.push(e)):"signatureMoved"==e.operation?(this._undoSignatureMove(e),this._redoActions.push(e)):"signatureDeleted"==e.operation?(this._undoSignatureDeletion(e),this._redoActions.push(e)):"keyMoved"==e.operation?(this._undoSignatureKeyMoved(e),this._redoActions.push(e)):"SignatureModifed"==e.operation&&(this._undoSignatureProperties(e),this._redoActions.push(e));this._clearRectOnClick(e.pageNumber)}},_undoSignatureProperties:function(t){var i=t.sign,o=i.getContext("2d");o.strokeStyle=t.previousstrokeStyle,o.stroke(),e(i).css("opacity",t.previousOpacity)},_undoModifiedProperty:function(e){var t,i,o;"propertiesModifiedForExistingAnnot"==e.operation?(t=this._textMarkupAnnotationList[e.pageNumber][e.indexes],i=JSON.parse(JSON.stringify(t)),this._redoAnnotationCollection[e.pageNumber-1].push(i),o=this._colorModifiedAnnotationList[e.pageNumber-1].pop(),t.Color.R=o.Color.R,t.Color.G=o.Color.G,t.Color.B=o.Color.B,t.Opacity=o.Opacity,this._existingAnnotationsModified[e.pageNumber-1].pop()):(t=this._newAnnotationList[e.pageNumber-1][e.indexes],i=JSON.parse(JSON.stringify(t)),this._redoAnnotationCollection[e.pageNumber-1].push(i),o=this._colorModifiedAnnotationList[e.pageNumber-1].pop(),t.colorR=o.colorR,t.colorG=o.colorG,t.colorB=o.colorB,t.opacity=o.opacity,t.colorA=o.colorA)},_undoDeletedItem:function(e){var t,i;"existingAnnotationDeleted"==e.operation?(t=this._deletedAnnotationList[e.pageNumber-1].pop(),this._textMarkupAnnotationList[e.pageNumber].splice(e.indexes,0,t),this._totalAnnotations[e.pageNumber].splice(e.indexes,0,t),this._existingAnnotationsModified[e.pageNumber-1].pop()):(t=this._deletedAnnotationList[e.pageNumber-1].pop(),this._newAnnotationList[e.pageNumber-1].splice(e.indexes,0,t),i=this._textMarkupAnnotationList[e.pageNumber]?this._textMarkupAnnotationList[e.pageNumber].length+e.indexes:e.indexes,this._totalAnnotations[e.pageNumber].splice(i,0,t))},_undoSignatureAdd:function(t){var i=t.signCanvas;e(i).remove()},_undoSignatureDeletion:function(e){var t=e.signCanvas;document.getElementById(this._id+"pageDiv_"+e.pageNumber).appendChild(t)},_undoSignatureMove:function(e){var t=e.signCanvas;e.initialCoordinates&&(t.style.left=e.initialCoordinates.left+"px",t.style.top=e.initialCoordinates.top+"px")},_undoSignatureKeyMoved:function(e){var t=e.signCanvas;e.keyinitialCoordinates&&(t.style.left=e.keyinitialCoordinates.left+"px",t.style.top=e.keyinitialCoordinates.top+"px")},_undoSignatureResize:function(e){var t=e.signCanvas;e.initialSize&&(t.style.height=e.initialSize.height+"px",t.style.width=e.initialSize.width+"px")},_redo:function(){var e,t,i;if(this._removeSelector(),e=this._redoActions.pop()){if(this._recentOperation.push(e),"AddedHighlight"==e.operation||"AddedUnderline"==e.operation||"AddedStrikeOut"==e.operation)for(t=0;t<e.indexes.length;t++)i=this._redoAnnotationCollection[e.pageNumber-1].pop(),this._newAnnotationList[e.pageNumber-1].push(i);else"propertiesModifiedForExistingAnnot"==e.operation||"propertiesModifiedForNewAnnot"==e.operation?this._redoModifiedProperty(e):"existingAnnotationDeleted"==e.operation||"newAnnotationDeleted"==e.operation?this._redoDeletedItem(e):"signatureAdded"==e.operation?this._redoSignatureAdd(e):"signatureResized"==e.operation?this._redoSignatureResize(e):"signatureMoved"==e.operation?this._redoSignatureMove(e):"signatureDeleted"==e.operation?this._redoSignatureDelete(e):"keyMoved"==e.operation?this._redoSignatureKeyMoved(e):"SignatureModifed"==e.operation&&this._redoSignatureProperties(e);this._clearRectOnClick(e.pageNumber)}},_redoSignatureProperties:function(t){var i=t.sign,o=i.getContext("2d");o.strokeStyle=t.newstrokeStyle,o.stroke(),e(i).css("opacity",t.newsopacity)},_redoModifiedProperty:function(e){var t;if("propertiesModifiedForExistingAnnot"==e.operation){var i=this._textMarkupAnnotationList[e.pageNumber][e.indexes],o=JSON.parse(JSON.stringify(i)),n=this._redoAnnotationCollection[e.pageNumber-1].pop();this._colorModifiedAnnotationList[e.pageNumber-1].push(o),i.Color.R=n.Color.R,i.Color.G=n.Color.G,i.Color.B=n.Color.B,i.Opacity=n.Opacity,(t={}).index=e.indexes,t.annotation=i,t.action="propertyChanged",this._existingAnnotationsModified[e.pageNumber-1].push(t)}else{i=this._newAnnotationList[e.pageNumber-1][e.indexes],o=JSON.parse(JSON.stringify(i)),n=this._redoAnnotationCollection[e.pageNumber-1].pop();this._colorModifiedAnnotationList[e.pageNumber-1].push(o),i.colorR=n.colorR,i.colorG=n.colorG,i.colorB=n.colorB,i.opacity=n.opacity,i.colorA=n.colorA}},_redoDeletedItem:function(e){var t,i;"existingAnnotationDeleted"==e.operation?(t=this._textMarkupAnnotationList[e.pageNumber][e.indexes],this._deletedAnnotationList[e.pageNumber-1].push(t),this._textMarkupAnnotationList[e.pageNumber].splice(e.indexes,1),this._totalAnnotations[e.pageNumber].splice(e.indexes,1)):(t=this._newAnnotationList[e.pageNumber-1][e.indexes],this._deletedAnnotationList[e.pageNumber-1].push(t),this._newAnnotationList[e.pageNumber-1].splice(e.indexes,1),i=this._textMarkupAnnotationList[e.pageNumber]?this._textMarkupAnnotationList[e.pageNumber].length+e.indexes:e.indexes,this._totalAnnotations[e.pageNumber].splice(i,1))},_redoSignatureAdd:function(e){var t=e.signCanvas;document.getElementById(this._id+"pageDiv_"+e.pageNumber).appendChild(t)},_redoSignatureDelete:function(t){var i=t.signCanvas;e(i).remove()},_redoSignatureMove:function(e){var t=e.signCanvas;e.Coordinates&&(t.style.left=e.Coordinates.left+"px",t.style.top=e.Coordinates.top+"px")},_redoSignatureKeyMoved:function(e){var t=e.signCanvas;e.Coordinates&&(t.style.left=e.Coordinates.left+"px",t.style.top=e.Coordinates.top+"px")},_redoSignatureResize:function(e){var t=e.signCanvas;e.size&&(t.style.height=e.size.height,t.style.width=e.size.width)},_displayColorPicker:function(t){var i=document.getElementById(this._id+"_pdfviewer_colorpicker");"none"!=e(i).css("display")||this._isToolbarColorPicker?this._colorPickerStatus==t?(i.style.display="none",this._isToolbarColorPicker=!1):("Highlight"==t?this._toolbarColorpickerObject.option("value",this.model.highlightSettings.color):"Underline"==t?this._toolbarColorpickerObject.option("value",this.model.underlineSettings.color):"StrikeOut"==t&&this._toolbarColorpickerObject.option("value",this.model.strikethroughSettings.color),this._colorPickerStatus=t,this._isDefaultColorSet=!0):(i.style.display="block",this._isToolbarColorPicker=!0,this._colorPickerStatus!=t&&(this._drawColor=null,"Highlight"==t?this._toolbarColorpickerObject.option("value",this.model.highlightSettings.color):"Underline"==t?this._toolbarColorpickerObject.option("value",this.model.underlineSettings.color):"StrikeOut"==t&&this._toolbarColorpickerObject.option("value",this.model.strikethroughSettings.color)),this._colorPickerStatus=t,this._isDefaultColorSet=!0)},_setPickerPosition:function(t){var i,o,n,s,a=e("#"+this._id+"_toolbarContainer");this._toolbarColorpickerObject.refresh(),o=(i=document.getElementById(this._id+"_pdfviewer_colorpicker")).getBoundingClientRect(),e("#"+this._id+"_pdfviewer_textmarkupul").parent()[0]==a[0]?(i.style.top="0px",i.style.left=t.parentNode.offsetLeft+t.offsetLeft-a[0].offsetLeft-o.width+t.clientWidth+"px"):(n=document.getElementById(this._id+"_toolbarContainer_hiddenlist"),secondaryToolbarPosition=n.getBoundingClientRect(),s=document.getElementById(this._id+"_pdfviewer_textmarkupul").getBoundingClientRect(),i.style.top=secondaryToolbarPosition.bottom-s.bottom+"px",i.style.left=t.parentNode.parentNode.offsetLeft-a[0].offsetLeft+t.offsetLeft-o.width+t.clientWidth+"px")},_showSignatureButtons:function(t){t?(e("#"+this._id+"_pdfviewer_signatureul").css("display","block"),e("#"+this._id+"_pdfviewer_textmarkupul").addClass("e-separator"),this._isSignatureHidden=!1):(e("#"+this._id+"_pdfviewer_signatureul").css("display","none"),e("#"+this._id+"_pdfviewer_textmarkupul").removeClass("e-separator"),this._isSignatureHidden=!0)},_showTextMarkupButtons:function(t){t?(e("#"+this._id+"_pdfviewer_textmarkupul").css("display","block"),e("#"+this._id+"_pdfviewer_zoomul").addClass("e-separator")):(e("#"+this._id+"_pdfviewer_textmarkupul").css("display","none"),e("#"+this._id+"_pdfviewer_zoomul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_colorpicker").css("display","none"),this._isToolbarColorPicker=!1)},_wireEvents:function(){var t,i=-1!=navigator.userAgent.indexOf("Chrome"),o=-1!=navigator.userAgent.indexOf("Firefox"),n=-1!=navigator.userAgent.indexOf("Safari"),s=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,a=-1!=navigator.userAgent.indexOf("Edge"),r=document.documentMode||/Edge/.test(navigator.userAgent),l=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent),d=this;this.model.toolbarSettings.templateId||(this._on(e("#"+this._id+"_txtpageNo"),"keypress",this._allowOnlyNumbers),this._on(e("#"+this._id+"_txtpageNo"),"keypress",this._onkeyPress),this._on(e("#"+this._id+"_txtpageNo"),"click ",this._onToolbarItemClick),this._on(e("#"+this._id+"_zoomSelection"),"change",this._zoomValChange),this._on(e("#"+this._id+"_toolbar_zoomSelection_container"),"click ",this._onToolbarItemClick),this._on(e("#"+this._id+"_toolbarContainer"),"mousedown",this._onToolBarContainerMouseDown),this._on(e(".e-pdfviewer-ejdropdownlist"),"mousedown",this._onToolBarContainerMouseDown),this._on(e("#"+this._id+"_viewerContainer"),"mousewheel",this._onContainerScroll),document.documentMode||s?(this._on(e("#"+this._id+"_viewerContainer"),"keydown",this._onTextKeyboardCopy),this._on(e("#"+this._id+"_viewerContainer"),"dblclick",this._selectingTextOnDblClick),this._on(e("#"+this._id+"_viewerContainer"),"click",this._selectingTextOnClick)):r||(o?(this._on(e("#"+this._id+"_viewerContainer"),"keydown",this._onTextKeyboardCopy),this._on(e("#"+this._id+"_viewerContainer"),"touchstart",this._onTextContainerTouch),this._on(e("#"+this._id+"_viewerContainer"),"touchmove",this._onTextContainerTouchMove),this._on(e("#"+this._id+"_viewerContainer"),"touchend",this._onTextContainerTouchEnd)):(i||l)&&(this._on(e("#"+this._id+"_viewerContainer"),"touchstart",this._onTextContainerTouch),this._on(e("#"+this._id+"_viewerContainer"),"touchmove",this._onTextContainerTouchMove),this._on(e("#"+this._id+"_viewerContainer"),"touchend",this._onTextContainerTouchEnd)),this._on(e("#"+this._id+"_viewerContainer"),"mouseleave",this._onTextContainerMouseLeave),this._on(e("#"+this._id+"_viewerContainer"),"mouseenter",this._onTextContainerMouseEnter),this._on(e("#"+this._id+"_viewerContainer"),"mouseover",this._onTextContainerMouseIn),this._on(e("#"+this._id+"_viewerContainer"),"dragstart",this._onTextContainerDragStart)),i||o||s||a||r||l?(this._on(e("#"+this._id+"_viewerContainer"),"mouseup",this._onTextContainerMouseUp),this._on(e("#"+this._id+"_viewerContainer"),"mousemove",this._onTextContainerMouseMove),this._on(e("#"+this._id+"_viewerContainer"),"mousedown",this._onTextContainerMouseDown),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.copy",this._copySelectedText),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.googleSearch",this._openInNewTab),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.e-highlight-text",this._drawHighlightAnnotation),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.e-strikeout-text",this._drawStrikeOutAnnotation),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.deleteAnnotation",this._deleteAnnotation),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.popupnote",this._showPopupMenu),this._on(e("#"+this._id+"_pageviewContainer"),"click touchstart","a.Properties",this._showPropertiesMenu),this._on(e("#"+this._id+"_pageviewContainer"),"contextmenu",this._onTextContainerMouseUp),this._on(e("#"+this._id+"_viewerContainer"),"click",this._onTextContainerclick)):n&&(this._on(e("#"+this._id+"_viewerContainer"),"mouseup",this._onTextContainerMouseUp),this._on(e("#"+this._id+"_viewerContainer"),"mousemove",this._onTextContainerMouseMove),this._on(e("#"+this._id+"_viewerContainer"),"mousedown",this._onTextContainerMouseDown))),e(window).on("keydown",function(t){d._onViewerKeypress(t),d._onTextKeyboardCopy(t),!t.ctrlKey||65!=t.keyCode&&97!=t.keyCode?46==t.keyCode&&(0==d._currentAnnotationRectangleBackup.length||d._isPropertiesWindowOpen||d._isPopupNoteVisible||(d._deleteAnnotation(),e("#"+d._id+"_popupmenu").hide(),d._isPopupNoteVisible=!1)):t.preventDefault()}),t=document.getElementById(this._id+"_viewerContainer"),e("#"+this._id+"_viewerContainer").css({"touch-action":"pan-x pan-y"}),e("#"+this._id+"_pdfviewerContainer").css({"touch-action":"pan-x pan-y",position:"relative"}),(navigator.userAgent.match("Firefox")||navigator.userAgent.match("Chrome")||n)&&t&&(t.addEventListener("touchstart",this._touchStart),t.addEventListener("touchmove",this._touchMove),t.addEventListener("touchleave",this._touchEnd),t.addEventListener("touchend",this._touchEnd),t.addEventListener("touchcancel",this._touchEnd)),this._on(e("#"+this._id+"_pdfviewer_searchinput"),"input",this._textSearch),this._on(e("#"+this._id+"_pdfviewer_searchinput"),"keypress",this._searchKeypressHandler),this._on(e("#"+this._id+"_pdfviewer_previous_search"),"click",this._prevSearch),this._on(e("#"+this._id+"_pdfviewer_next_search"),"click",this._nextSearch),this._on(e("#"+this._id+"_pdfviewer_close_search"),"click ",this._displaySearchBox),this._on(e("#"+this._id+"_viewerContainer"),"pointerdown",this._pointerdown),this._on(e("#"+this._id+"_viewerContainer"),"pointermove",this._pointermove),this._on(e("#"+this._id+"_viewerContainer"),"pointerup",this._pointerup),this._on(e("#"+this._id+"_viewerContainer"),"pointerleave",this._pointerup),this._on(e("#"+this._id+"_toolbarContainer li,#"+this._id+"_toolbarContainer .e-pdfviewer-ejdropdownlist,#"+this._id+"_toolbarContainer .e-pdfviewer-tbpage"),"mouseover",this._showIconToolTip),this._on(e("#"+this._id+"_toolbarContainer li,#"+this._id+"_toolbarContainer .e-pdfviewer-ejdropdownlist,#"+this._id+"_toolbarContainer .e-pdfviewer-tbpage"),"mouseout",this._hideIconToolTip),this._on(e("#"+this._id+"_pdfviewer_findlabel, #"+this._id+"_pdfviewer_matchlabel"),"mouseover",this._showLocalizationTooltip),this._on(e("#"+this._id+"_pdfviewer_findlabel, #"+this._id+"_pdfviewer_matchlabel"),"mouseout",this._hideLocalizationTooltip),this._on(e(".e-pdfviewer-toolbarli-label"),"mousedown",this._preventClick),this._on(e(window),"mousedown",this._windowMaintainSelection),this._on(e(window),"touchstart",this._windowOnTextContainerTouch)},_unwireEvents:function(){var t,i=-1!=navigator.userAgent.indexOf("Chrome"),o=-1!=navigator.userAgent.indexOf("Firefox"),n=(navigator.userAgent.indexOf("Safari"),-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode),s=-1!=navigator.userAgent.indexOf("Edge"),a=document.documentMode||/Edge/.test(navigator.userAgent);this.model.toolbarSettings.templateId||(this._on(e("#"+this._id+"_txtpageNo"),"keypress",this._allowOnlyNumbers),this._off(e("#"+this._id+"_txtpageNo"),"keypress",this._onkeyPress),this._off(e("#"+this._id+"_txtpageNo"),"click ",this._onToolbarItemClick),this._off(e("#"+this._id+"_zoomSelection"),"change",this._zoomValChange),this._off(e("#"+this._id+"_toolbar_zoomSelection_container"),"click ",this._onToolbarItemClick),this._off(e("#"+this._id+"_viewerContainer"),"mousewheel",this._onContainerScroll),this._off(e(window),"keypress",this._onViewerKeypress)),t=document.getElementById(this._id+"_viewerContainer"),document.documentMode||s||n||a?(this._off(e("#"+this._id+"_viewerContainer"),"keydown",this._onTextKeyboardCopy),this._off(e("#"+this._id+"_viewerContainer"),"dblclick",this._selectingTextOnDblClick),this._off(e("#"+this._id+"_viewerContainer"),"click",this._selectingTextOnClick)):(o&&this._off(e("#"+this._id+"_viewerContainer"),"keydown",this._onTextKeyboardCopy),this._off(e("#"+this._id+"_viewerContainer"),"mousemove",this._onTextContainerMouseMove),this._off(e("#"+this._id+"_viewerContainer"),"mousedown",this._onTextContainerMouseDown),this._off(e("#"+this._id+"_viewerContainer"),"mouseleave",this._onTextContainerMouseLeave),this._off(e("#"+this._id+"_viewerContainer"),"mouseover",this._onTextContainerMouseIn),this._off(e("#"+this._id+"_viewerContainer"),"touchstart",this._onTextContainerTouch),this._off(e("#"+this._id+"_viewerContainer"),"touchend",this._onTextContainerTouchEnd),this._off(e("#"+this._id+"_viewerContainer"),"touchmove",this._onTextContainerTouchMove),this._off(e("#"+this._id+"_viewerContainer"),"dragstart",this._onTextContainerDragStart),this._off(e("#"+this._id+"_viewerContainer"),"click",this._onTextContainerclick)),(i||o||n||a||s)&&(this._off(e("#"+this._id+"_viewerContainer"),"mouseup",this._onTextContainerMouseUp),this._off(e("#"+this._id+"_pageviewContainer"),"click","a.copy",this._copySelectedText),this._off(e("#"+this._id+"_pageviewContainer"),"click","a.googleSearch",this._openInNewTab),this._off(e("#"+this._id+"_pageviewContainer"),"contextmenu",this._onTextContainerMouseUp)),(navigator.userAgent.match("Firefox")||navigator.userAgent.match("Chrome"))&&(t.removeEventListener("touchstart",this._touchStart),t.removeEventListener("touchmove",this._touchMove),t.removeEventListener("touchleave",this._touchEnd),t.removeEventListener("touchend",this._touchEnd),t.removeEventListener("touchcancel",this._touchEnd)),this._off(e("#"+this._id+"_viewerContainer"),"pointerdown",this._pointerdown),this._off(e("#"+this._id+"_viewerContainer"),"pointermove",this._pointermove),this._off(e("#"+this._id+"_viewerContainer"),"pointerup",this._pointerup),this._off(e("#"+this._id+"_viewerContainer"),"pointerleave",this._pointerup),this._off(e("#"+this._id+"_pdfviewer_searchinput"),"input",this._textSearch),this._off(e("#"+this._id+"_pdfviewer_searchinput"),"keypress",this._searchKeypressHandler),this._off(e("#"+this._id+"_pdfviewer_previous_search"),"click",this._prevSearch),this._off(e("#"+this._id+"_pdfviewer_next_search"),"click",this._nextSearch),this._off(e("#"+this._id+"_pdfviewer_close_search"),"click ",this._displaySearchBox),this._off(e("#"+this._id+"_toolbarContainer li,#"+this._id+"_toolbarContainer .e-pdfviewer-ejdropdownlist,#"+this._id+"_toolbarContainer .e-pdfviewer-tbpage"),"mouseover",this._showIconToolTip),this._off(e("#"+this._id+"_toolbarContainer li,#"+this._id+"_toolbarContainer .e-pdfviewer-ejdropdownlist,#"+this._id+"_toolbarContainer .e-pdfviewer-tbpage"),"mouseout",this._hideIconToolTip),this._off(e("#"+this._id+"_pdfviewer_findlabel, #"+this._id+"_pdfviewer_matchlabel"),"mouseover",this._showLocalizationTooltip),this._off(e("#"+this._id+"_pdfviewer_findlabel, #"+this._id+"_pdfviewer_matchlabel"),"mouseout",this._hideLocalizationTooltip),this._off(e(".e-pdfviewer-toolbarli-label"),"mousedown",this._preventClick),this._off(e(window),"mousedown",this._windowMaintainSelection),this._off(e(window),"touchstart",this._windowOnTextContainerTouch),this._off(e(window),"resize",this._viewerResize)},_windowMaintainSelection:function(t){var i,o,n,s;t.target&&!e(t.target).parents().hasClass("e-pdfviewer")&&("INPUT"!==t.target.nodeName||"INPUT"!==t.target.tagName)&&(i=window.getSelection(),this._selectionNodes=i,o=document.createRange(),(e(i.anchorNode).parent().hasClass("e-pdfviewer-textLayer")&&e(i.focusNode).parent().hasClass("e-pdfviewer-textLayer")||e(i.anchorNode).hasClass("e-pdfviewer-textLayer")&&e(i.focusNode).hasClass("e-pdfviewer-textLayer"))&&(n=i.anchorNode.compareDocumentPosition(i.focusNode),s=!1,this._selectionObject={},this._selectionObject.isBackward=!1,(!n&&i.anchorOffset>i.focusOffset||n===Node.DOCUMENT_POSITION_PRECEDING)&&(s=!0),s?(this._selectionObject.isBackward=s,this._selectionObject.anchorOffset=i.focusOffset,this._selectionObject.focusOffset=i.anchorOffset,o.setStart(i.focusNode,i.focusOffset),o.setEnd(i.anchorNode,i.anchorOffset)):(this._selectionObject.anchorOffset=i.anchorOffset,this._selectionObject.focusOffset=i.focusOffset,o.setStart(i.anchorNode,i.anchorOffset),o.setEnd(i.focusNode,i.focusOffset)),this._controlSelectionRange=o,e("#"+this._id+"custom-menu")&&e("#"+this._id+"custom-menu").hide(),this._waterDropletDivHide(),e("#"+this._id+"touchcustom-menu").hide(),t.preventDefault()))},_windowOnTextContainerTouch:function(t){var i=this,o=setTimeout(function(){i._controlSelectionRange=null,i._selectionObject=null,clearTimeout(o),e(t.target).parents().hasClass("e-pdfviewer")||(e("#"+i._id+"custom-menu")&&e("#"+i._id+"custom-menu").hide(),i._waterDropletDivHide(),e("#"+i._id+"touchcustom-menu").hide(),i._clearHighlightDiv())},1e3)},_clearHighlightDiv:function(){for(var e,t,i,n=1;n<=this._totalPages;n++)if(-1!==this._renderedCanvasList.indexOf(parseInt(n))){if(e=this._textDivs[n],t=this._textContents[n],!e||e==o)break;for(i=0;i<e.length;i++)e[i].textContent=t[i],this._isFindboxPresent||(e[i].textContent="",e[i].textContent=t[i]+"\r\n")}},_deleteSignatureCanvas:function(){var t,i=this._tempCanvas;if(i){var o={},n=document.getElementById(this._id+"e-pdfviewer-selector"),s=document.getElementsByClassName("e-pdfviewer-buttons");o.annotationID=i.id,o.pageNumber=parseInt(i.id.split("imagecanvasDraw_")[1].split("_")[0]),(t={}).operation="signatureDeleted",t.signCanvas=i,t.pageNumber=parseInt(i.id.split("imagecanvasDraw_")[1].split("_")[0]),this._recentOperation.push(t),e(i).remove(),e(n).remove(),e(s).remove(),this._raiseClientEvent("signatureDelete",o)}},_onContainerScroll:function(e){document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1,this._isPropertiesWindowOpen&&e.preventDefault()},_closePropertiesWindow:function(){this._isPropertiesWindowOpen=!1},_onToolBarContainerMouseDown:function(t){return e(t.target).hasClass("e-pdfviewer-ddl")||e(t.target).parents().hasClass("e-pdfviewer-ddl")||document.activeElement.id==this._id+"_toolbar_zoomSelection_wrapper"&&e("#"+this._id+"_toolbar_zoomSelection_wrapper").blur(),t.preventDefault(),!1},_onToolbarItemClick:function(t){t.target.id==this._id+"_txtpageNo"&&e("#"+this._id+"_txtpageNo").select(),e("#"+this._id+"_rptTooltip").css("display","none")},_selectingTextOnClick:function(e){this._timers&&this._clientx==e.clientX&&this._clienty==e.clientY&&(clearTimeout(this._timers),this._timers=null,this._selectingEntireLine(e))},_selectingEntireLine:function(t){var i,o,n,s,a=[],r=t.target.getBoundingClientRect(),l=e(".e-pdfviewer-textLayer").length;if(e(t.target).hasClass("e-pdfviewer-textLayer")){for(i=0;i<l;i++){var d=e(".e-pdfviewer-textLayer")[i].getBoundingClientRect(),h=parseInt(d.top),_=parseInt(r.top);(h==_||h+1==_||h-1==_)&&(""!=(o=e(".e-pdfviewer-textLayer")[i].id)&&a.push(o))}(n=window.getSelection()).removeAllRanges();var c=document.createRange(),p=a.length-1,g=document.getElementById(a[0]),u=document.getElementById(a[p]),f=u.childNodes.length;f>0?(s=u.childNodes[f-1],c.setStart(g,0),c.setEnd(s,s.length)):(c.setStart(g,0),c.setEnd(u,1)),n.addRange(c)}},_selectingTextOnDblClick:function(e){this._clientx=e.clientX,this._clienty=e.clientY,this._isAnnotationSelected&&(this._showPopupMenu(e),this._clearSelector(e)),this._timers=setTimeout(function(){this._timers=null},200)},_onTextContainerMouseIn:function(e){if(this.Clicked)return e.preventDefault(),!1},_onTextContainerMouseUp:function(i){var o,n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w,x,b,y,P,C,S,T;if(this._dragstate&&(this._dragstate=!1),e("#"+this._id+"_toolbarContainer_hiddenlist").addClass("e-display-none"),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1,this._isDefaultColorSet=!1,(r=i.target)==(s=e("#"+this._id+"_popupinnercontent"))[0]?s.focus():s.blur(),this._isPopupNoteFocused=!1,this._isPropertiesWindowOpen||i.target.id==this._id+"_popupinnercontent"||i.target.id==this._id+"_popupcontent")i.preventDefault();else{if(this._curDown=!1,a=[],r=i.target,this._currentAnnotationRectangle=[],l=document.getElementById(this._id+"custom-menu"),d=document.getElementById(this._id+"highlight-menu"),"popupnoteli"!=i.target.className&&"deleteAnnotationli"!=i.target.className&&"Propertiesli"!=i.target.className&&"e-pdfviewer-highlight-menu"!=i.target.className&&e(d).hide(),this._isContextMenuPresent=!1,(h=parseInt(i.target.id.split("text_")[1])||parseInt(i.target.id.split("selectioncanvas_")[1])||parseInt(i.target.id.split("_secondarycanvas_")[1]))&&this.model.enableTextMarkupAnnotations){for(w=1;w<=this._totalPages;w++)(this._textMarkupAnnotationList[w]||this._newAnnotationList[w-1])&&this._clearRectOnClick(w);_=document.getElementById(this._id+"_secondarycanvas_"+h),this._onCanvasMousedown(_,i.pageX,i.pageY),this._contextClickPosition(i,h)}if(window.getSelection().toString()||0!=this._currentAnnotationRectangle.length&&("StrikeOut"==(n=(o=this._currentAnnotationRectangle[0]).TextMarkupAnnotationType?o.TextMarkupAnnotationType:o.type)&&this.model.enableStrikethroughAnnotation?(this._AnnotationPage=h,this._drawAnnotSelectRect(h,this._currentAnnotationRectangle)):"Highlight"==n&&this.model.enableHighlightAnnotation?(this._AnnotationPage=h,this._drawAnnotSelectRect(h,this._currentAnnotationRectangle)):"Underline"==n&&this.model.enableUnderlineAnnotation&&(this._AnnotationPage=h,this._drawAnnotSelectRect(h,this._currentAnnotationRectangle))),c=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,p=window.getSelection().toString(),"contextmenu"==i.type){if((g=window.getSelection()).anchorNode){var I=g.getRangeAt(0),k=I.cloneContents(),z=k.childNodes,A=I.startContainer.parentNode.className,D=e(k).find("span");if(D.length>0&&("e-pdfviewer-texthighlight e-pdfviewer-textLayer"==D[0].className||"e-pdfviewer-text-highlightother e-pdfviewer-textLayer"==D[0].className)&&I.startContainer.id&&a.push(I.startContainer.id),u=document.documentMode||/Edge/.test(navigator.userAgent),(c||u)&&0==e(k).children().length&&("e-pdfviewer-textLayer"==A&&I.startContainer.parentNode?a.push(I.startContainer.parentNode.id):a.push(I.startContainer.id)),0==k.childElementCount)"e-pdfviewer-textLayer"==A?a.push(I.startContainer.parentElement.id):a.push(I.startContainer.id);else if(z.length>0)if("e-waitingpopup e-js"==z[0].className)for(f=0;f<z.length;f++)for(v=e(z[f]).find(".text_container").children(),m=0;m<v.length;m++)a.push(v[m].id);else if("e-pdfviewer-selectiondiv text_container"==z[0].className)for(v=e(".text_container").children(),P=0;P<v.length;P++)a.push(v[P].id);else for(w=0;w<z.length;w++)x=z[w].id,a.push(x);for(b=0;b<a.length;b++){if((e(r).hasClass("e-pdfviewer-text-highlightother")||e(r).hasClass("e-pdfviewer-texthighlight"))&&(r=r.parentElement),r.id==a[b]){this._contextMenu=!0;break}this._contextMenu=!1}}"e-pdfviewer-imagecanvasDraw"==i.target.className&&(this._contextMenu=!0)}if(3==i.which&&"e-pdfviewer-imagecanvasDraw"==i.target.className&&(this._contextMenu=!0),3==i.which&&this._contextMenu&&"contextmenu"==i.type&&!this._isCopyRestrict&&"e-pdfviewer-imagecanvasDraw"==i.target.className)i.preventDefault(),this._showSignatureContext(i,d),this._contextMenu=!1;else if(""!=p&&3==i.which&&this._contextMenu&&"contextmenu"==i.type&&!this._isCopyRestrict&&-1==i.target.className.indexOf("input_container")&&this.model.textSelectionContextMenu.isEnable){i.preventDefault(),this._searchedText="";var B=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,R=B.contextMenu.copy.contentText,E=B.contextMenu.googleSearch.contentText,N=B.toolbar.highlight.headerText,O=B.toolbar.strikeout.headerText;e(l).css("z-index",1e9),e(l).find("li a.copy").text(R),e(l).find("li a.googleSearch").text(E),e(l).find("li a.e-highlight-text").text(N),e(l).find("li a.e-strikeout-text").text(O),p.length>20?(S=p.substring(0,18)+"...",e(l).find("li a.googleSearch").text(E+"'"+S+"'")):e(l).find("li a.googleSearch").text(E+"'"+p+"'"),T=this._setContextMenuPostion(i),this.model.enableTextMarkupAnnotations?(this.model.enableHighlightAnnotation?e("#"+this._id+"_highlight_contextmenu").removeClass("e-disable"):e("#"+this._id+"_highlight_contextmenu").addClass("e-disable"),this.model.enableStrikethroughAnnotation?e("#"+this._id+"_strikeout_contextmenu").removeClass("e-disable"):e("#"+this._id+"_strikeout_contextmenu").addClass("e-disable")):(e("#"+this._id+"_highlight_contextmenu").addClass("e-disable"),e("#"+this._id+"_strikeout_contextmenu").addClass("e-disable")),this.model.textSelectionContextMenu.isCopyEnable||this.model.textSelectionContextMenu.isSearchEnable||this.model.textSelectionContextMenu.isHighlightEnable||this.model.textSelectionContextMenu.isStrikeoutEnable?(e(l).show(),e(l).offset({top:T.y,left:T.x}).show(),e(l).show(),e(l).offset({top:T.y,left:T.x}).show()):e(l).hide(),this._contextMenu=!1}else if(3==i.which&&"contextmenu"==i.type&&!this._isCopyRestrict&&(e(i.target).hasClass("e-pdfviewer-text-highlightother e-pdfviewer-textLayer")||e(i.target).hasClass("e-pdfviewer-texthighlight e-pdfviewer-textLayer")||e(i.target).hasClass("e-pdfviewer-texthighlight middle e-pdfviewer-textLayer"))&&this.model.textSelectionContextMenu.isEnable){if(i.preventDefault(),this._searchedText="",(y=e(".e-pdfviewer-textLayer").find(".e-pdfviewer-texthighlight")).length>1)for(y=e(".e-pdfviewer-textLayer").find(".e-pdfviewer-texthighlight"),P=0;P<y.length;P++)C=y[P].innerHTML,this._searchedText+=C;else this._searchedText=i.target.innerHTML;this._searchedText.length>20?(S=this._searchedText.substring(0,18)+"...",e(l).find("li a.googleSearch").text("Search Google For '"+S+"'")):e(l).find("li a.googleSearch").text("Search Google For '"+this._searchedText+"'"),T=this._setContextMenuPostion(i),this.model.enableTextMarkupAnnotations?(this.model.enableHighlightAnnotation?e("#"+this._id+"_highlight_contextmenu").removeClass("e-disable"):e("#"+this._id+"_highlight_contextmenu").addClass("e-disable"),this.model.enableStrikethroughAnnotation?e("#"+this._id+"_strikeout_contextmenu").removeClass("e-disable"):e("#"+this._id+"_strikeout_contextmenu").addClass("e-disable")):(e("#"+this._id+"_highlight_contextmenu").addClass("e-disable"),e("#"+this._id+"_strikeout_contextmenu").addClass("e-disable")),this.model.textSelectionContextMenu.isCopyEnable||this.model.textSelectionContextMenu.isSearchEnable||this.model.textSelectionContextMenu.isHighlightEnable||this.model.textSelectionContextMenu.isStrikeoutEnable?(e(l).show(),e(l).offset({top:T.y,left:T.x}).show(),e(l).show(),e(l).offset({top:T.y,left:T.x}).show()):e(l).hide(),this._contextMenu=!1}else 0==e(l).has(i.target).length&&(e(l).hide(),"contextmenu"!=i.type||this._contextMenu||"e-pdfviewer-formFields"==i.target.className?this._contextMenu&&i.preventDefault():this._clearSelector(),"contextmenu"==i.type&&(3!=i.which||this._contextMenu&&this.model.textSelectionContextMenu.isEnable&&""!=p||"contextmenu"!=i.type||0==this._currentAnnotationRectangle.length&&"#000000"==this._annotationColor||!this.model.annotationContextMenu.isEnable?(0==this._currentAnnotationRectangle.length&&("#000000"==this._annotationColor||this.model.annotationContextMenu.isEnable)||i.preventDefault(),e(d).hide()):(this.model.enableTextMarkupAnnotations&&("StrikeOut"==n&&this.model.enableStrikethroughAnnotation?this._showAnnotationContextMenu(i,d):"Highlight"==n&&this.model.enableHighlightAnnotation?this._showAnnotationContextMenu(i,d):"Underline"==n&&this.model.enableUnderlineAnnotation&&this._showAnnotationContextMenu(i,d)),i.preventDefault())));this._annotationActive&&(this._isStrikeout?this._drawStrikeOutAnnotation():this._isUnderline?this._drawUnderlineAnnotation():this._isHighlight&&this._drawHighlightAnnotation())}},_replaceTextLocale:function(e,t){e.textContent=t},_showSignatureContext:function(i,o){var n,s=e(o).find(".popupnoteli");e(s).css("display","none"),this._showHideAnnotationMenu(o,"Signature");var a=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,r=a.contextMenu.openPopup.contentText,l=a.contextMenu.properties.contentText;this._replaceTextLocale(e("#"+this._id+"_openPopup")[0],r),this._replaceTextLocale(e("#"+this._id+"_propAnnot")[0],l),n=this._setDeleteContextMenuPostion(i),this.model.annotationContextMenu.isPropertiesEnable||this.model.annotationContextMenu.isDeleteEnable?this.model.annotationContextMenu.isEnable&&(e(o).show(),e(o).offset({top:n.y,left:n.x}).show(),e(o).show(),e(o).offset({top:n.y,left:n.x}).show(),e(o).css("z-index",1e9)):e(o).hide()},_showAnnotationContextMenu:function(i,o){var n,s;e("#"+this._id+"_popup_note").hide(),e("#"+this._id+"_popupmenu").hide(),n=e(o).find(".popupnoteli"),e(n).css("display",""),this._showHideAnnotationMenu(o,"annotation"),this._isPopupNoteVisible=!1;var a=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,r=a.contextMenu.openPopup.contentText,l=a.contextMenu.Delete.contentText,d=a.contextMenu.properties.contentText;this._replaceTextLocale(e("#"+this._id+"_openPopup")[0],r),this._replaceTextLocale(e("#"+this._id+"_deleteannot")[0],l),this._replaceTextLocale(e("#"+this._id+"_propAnnot")[0],d),s=this._setHighLightContextMenuPostion(i),this._isContextMenuPresent=!0,this.model.annotationContextMenu.isPopupEnable||this.model.annotationContextMenu.isPropertiesEnable||this.model.annotationContextMenu.isDeleteEnable?this.model.annotationContextMenu.isEnable&&(e(o).show(),e(o).offset({top:s.y,left:s.x}).show(),e(o).show(),e(o).offset({top:s.y,left:s.x}).show()):e(o).hide()},_showHideSelectionContextMenu:function(t){this.model.textSelectionContextMenu.isEnable?(e(t).css("display",""),this.model.textSelectionContextMenu.isCopyEnable?e(t).find(".copyli").css("display",""):e(t).find(".copyli").css("display","none"),this.model.textSelectionContextMenu.isSearchEnable?e(t).find(".googlesearchli").css("display",""):e(t).find(".googlesearchli").css("display","none"),this.model.textSelectionContextMenu.isHighlightEnable?e(t).find(".e-highlight-textli").css("display",""):e(t).find(".e-highlight-textli").css("display","none"),this.model.textSelectionContextMenu.isStrikeoutEnable?e(t).find(".e-strikeout-textli").css("display",""):e(t).find(".e-strikeout-textli").css("display","none")):e(t).css("display","none")},_showHideAnnotationMenu:function(t,i){this.model.annotationContextMenu.isEnable?(this.model.annotationContextMenu.isPopupEnable?"annotation"==i&&e(t).find(".popupnoteli").css("display",""):e(t).find(".popupnoteli").css("display","none"),this.model.annotationContextMenu.isPropertiesEnable?e(t).find(".Propertiesli").css("display",""):e(t).find(".Propertiesli").css("display","none"),this.model.annotationContextMenu.isDeleteEnable?e(t).find(".deleteAnnotationli").css("display",""):e(t).find(".deleteAnnotationli").css("display","none")):e(t).css("display","none")},_contextClickPosition:function(e,t){var i,o,n,s,a,r,l,d;if(this._currentAnnotationRectangleBackup=[],o=[],n=!1,t&&(i=(s=document.getElementById(this._id+"_secondarycanvas_"+t)).getBoundingClientRect()),s){var h=e.clientX-i.left,_=e.clientY-i.top,c=this._newAnnotationList[t-1];for(a=0;a<c.length;a++)for(l=c[a],d=0;d<l.bounds.length;d++)if(h>=(p=l.bounds[d]).xPosition*this._zoomVal&&h<=(p.xPosition+p.width)*this._zoomVal&&_>=p.yPosition*this._zoomVal&&_<=(p.yPosition+p.height)*this._zoomVal)this._currentAnnotationRectangle.push(c[a]),this._currentAnnotationRectangleBackup.push(c[a]),n=!0,o.push(l);else{if(n){n=!1;break}this._isPopupNoteVisible||(this._currentAnnotationRectangleBackup=[]),this._currentAnnotationRectangle=[]}if(c=this._textMarkupAnnotationList[t])for(r=0;r<c.length;r++)for(l=c[r],d=0;d<l.Bounds.length;d++){var p=l.Bounds[d],g=this._convertPointToPixel(p.X),u=this._convertPointToPixel(p.Y),f=this._convertPointToPixel(p.Width),m=this._convertPointToPixel(p.Height);if(h>=g*this._zoomVal&&h<=(g+f)*this._zoomVal&&_>=u*this._zoomVal&&_<=(u+m)*this._zoomVal)this._currentAnnotationRectangle.push(l),this._currentAnnotationRectangleBackup.push(l),n=!0,o.push(l);else{if(n){n=!1;break}this._isPopupNoteVisible||(this._currentAnnotationRectangleBackup=[]),this._currentAnnotationRectangle=[]}}o.length>1&&(o=this._compareAnnotations(o)),this._currentAnnotationRectangle=o,this._currentAnnotationRectangleBackup=o}},_compareAnnotations:function(e){for(var t,i,o=0;o<e.length&&o!=e.length-1;o++){var n=e[o].bounds?e[o].bounds:e[o].Bounds,s=n[0].X?n[0].X:n[0].xPosition,a=n[0].Y?n[0].Y:n[0].yPosition,r=e[o+1].bounds?e[o+1].bounds:e[o+1].Bounds,l=r[0].X?r[0].X:r[0].xPosition,d=r[0].Y?r[0].Y:r[0].yPosition;s<l||a<d?(t=l,i=e[o+1]):(t=s,i=e[o]),t&&o==e.length-2&&t==s&&t==l&&(t=l,i=e[o+1])}return(e=[]).push(i),e},_setContextMenuPostion:function(t){var i=e("#"+this._id+"custom-menu");this._showHideSelectionContextMenu(i);var o={},n={},s={};return s.x=i.outerWidth(),s.y=i.outerHeight(),o.x=t.pageX,o.y=t.pageY,n.x=o.x+s.x>e(window).width()+e(window).scrollLeft()?o.x-s.x:o.x,n.y=o.y+s.y>e(window).height()+e(window).scrollTop()?o.y-s.y:o.y,n},_createWaterDropDiv:function(){var t,i,o,n=e("#"+this._id+"_pageviewContainer"),s=document.createElement("DIV");s.id=this._id+"droplet1",s.className="e-pdfviewer-droplet1",(t=document.createElement("DIV")).id=this._id+"droplet2",t.className="e-pdfviewer-droplet2",n.append(s),n.append(t),i=e("#"+this._id+"_viewerContainer"),o=this,e("#"+this._id+"droplet2").on("touchmove",function(t){var n,s,a,r,l;if(o.model.enableTextSelection){o._enableSelection();var d=window.getSelection(),h=parseInt(d.anchorNode.parentNode.id.split("text_")[1]),_=parseInt(d.focusNode.parentNode.id.split("text_")[1]);(h!=parseInt(o._selectionStartPage)||_!=parseInt(o._selectionStartPage))&&o._annotationActive||(o._longTouch=!0,n=e(i).scrollTop(),e("#"+o._id+"touchcustom-menu").hide(),t.preventDefault(),r=e("#"+o._id+"droplet1").offset(),"touchmove"==t.type&&(t.originalEvent.changedTouches[0].clientX,t.originalEvent.changedTouches[0].clientY,e(t.target).css("z-index",0),s=t.originalEvent.changedTouches[0].clientX,a=t.originalEvent.changedTouches[0].clientY,e(t.target).css("z-index",1e3)),a>=r.top?(document.caretPositionFromPoint?(range=document.caretPositionFromPoint(s,a),textNode=range.offsetNode):document.caretRangeFromPoint&&(range=document.caretRangeFromPoint(s,a),null!=range?(textNode=range.startContainer,e(textNode).hasClass("e-pdfviewer-toolbarcontainer")?e(i).scrollTop(n+30):offset=range.startOffset):e(i).scrollTop(n+30)),parent=textNode.parentElement,o._selectingTextByTouch(parent,s,a,!0)):(document.caretPositionFromPoint?(range=document.caretPositionFromPoint(s,a),textNode=range.offsetNode):document.caretRangeFromPoint&&(range=document.caretRangeFromPoint(s,a),null!=range?(textNode=range.startContainer,e(textNode).hasClass("e-pdfviewer-toolbarcontainer")?e(i).scrollTop(n-30):offset=range.startOffset):e(i).scrollTop(n-30)),parent=textNode.parentElement,o._selectingTextByTouch(parent,s,a,!1)),e(parent).hasClass("e-pdfviewer-textLayer")&&(l=e("#"+o._id+"droplet2").width(),e("#"+o._id+"droplet2").offset({top:a+window.scrollY,left:s-l})))}else o.model.enableTextSelection||o._disableSelection()}),e("#"+this._id+"droplet1").on("touchmove",function(t){var n,s,a,r,l;if(o.model.enableTextSelection){o._enableSelection();var d=window.getSelection(),h=parseInt(d.anchorNode.parentNode.id.split("text_")[1]),_=parseInt(d.focusNode.parentNode.id.split("text_")[1]);(h!=parseInt(o._selectionStartPage)||_!=parseInt(o._selectionStartPage))&&o._annotationActive||(n=e(i).scrollTop(),e("#"+o._id+"touchcustom-menu").hide(),t.preventDefault(),r=e("#"+o._id+"droplet2").offset(),"touchmove"==t.type&&(o._longTouch=!0,t.originalEvent.changedTouches[0].clientX,t.originalEvent.changedTouches[0].clientY,e(t.target).css("z-index",0),s=t.originalEvent.changedTouches[0].clientX,a=t.originalEvent.changedTouches[0].clientY,e(t.target).css("z-index",1e3)),a<=r.top?(document.caretPositionFromPoint?(range=document.caretPositionFromPoint(s,a),textNode=range.offsetNode):document.caretRangeFromPoint&&(range=document.caretRangeFromPoint(s,a),null!=range?(textNode=range.startContainer,e(textNode).hasClass("e-pdfviewer-toolbarcontainer")?e(i).scrollTop(n-30):offset=range.startOffset):e(i).scrollTop(n-30)),parent=textNode.parentElement,o._selectingTextByTouch(parent,s,a,!1)):(document.caretPositionFromPoint?(range=document.caretPositionFromPoint(s,a),textNode=range.offsetNode):document.caretRangeFromPoint&&(range=document.caretRangeFromPoint(s,a),null!=range?(textNode=range.startContainer,e(textNode).hasClass("e-pdfviewer-toolbarcontainer")?e(i).scrollTop(n+30):offset=range.startOffset):e(i).scrollTop(n+30)),parent=textNode.parentElement,o._selectingTextByTouch(parent,s,a,!0)),e(t.target).css("z-index",1e3),e(parent).hasClass("e-pdfviewer-textLayer")&&(l=e("#"+o._id+"droplet1").width(),e("#"+o._id+"droplet1").offset({top:a+window.scrollY,left:s-l})))}else o.model.enableTextSelection||o._disableSelection()})},_disableSelection:function(){this.model.enableTextSelection||(e("#"+this._id+"_viewerContainer").attr("unselectable","on").css({"-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"}).bind("selectstart",function(){return!1}),this._isSelectionDisabled=!0)},_enableSelection:function(){this.model.enableTextSelection&&this._isSelectionDisabled&&(e("#"+this._id+"_viewerContainer").removeAttr("unselectable").css({"-moz-user-select":"text","-o-user-select":"text","-khtml-user-select":"text","-webkit-user-select":"text","-ms-user-select":"text","user-select":"text"}).unbind("selectstart").bind("selectstart",function(){return!0}),this._isSelectionDisabled=!1)},_selectingTextByTouch:function(e,t,i,o){var n,s,a,r,l,d;if(e.nodeType==e.TEXT_NODE)for(d=e.ownerDocument.createRange(),n=window.getSelection(),d.selectNodeContents(e),s=0,a=d.endOffset;s<a;){if(d.setStart(e,s),d.setEnd(e,s+1),d.getBoundingClientRect().left<=t&&d.getBoundingClientRect().right>=t&&d.getBoundingClientRect().top<=i&&d.getBoundingClientRect().bottom>=i)return r=d.toString(),d.getBoundingClientRect(),null!=n.anchorNode&&"e-pdfviewer-textLayer"==n.anchorNode.parentNode.className&&o?(d.setStart(n.anchorNode,n.anchorOffset),n.removeAllRanges(),n.addRange(d),n.extend(e,s)):null==n.anchorNode||o||(d.setEnd(n.focusNode,n.focusOffset),n.removeAllRanges(),n.addRange(d)),d.detach(),r;s+=1}else for(l=0;l<e.childNodes.length;l++){if((d=e.childNodes[l].ownerDocument.createRange()).selectNodeContents(e.childNodes[l]),d.getBoundingClientRect().left<=t&&d.getBoundingClientRect().right>=t&&d.getBoundingClientRect().top<=i&&d.getBoundingClientRect().bottom>=i)return d.detach(),this._selectingTextByTouch(e.childNodes[l],t,i,o);d.detach()}return null},_onTextContainerTouchMove:function(t){var i,o,n,s,a,r;if(e("#"+this._id+"_toolbarContainer_hiddenlist").addClass("e-display-none"),e(t.target).hasClass("e-pdfviewer-textLayer")&&this._lockTimer){var l=t.originalEvent.changedTouches[0].clientX,d=t.originalEvent.changedTouches[0].clientY,h=document.getElementById(this._id+"touchcustom-menu");parseInt(l)!=parseInt(this._curPosX)&&parseInt(d)!=parseInt(this._curPosY)&&(e(".e-pdfviewer-formFields").css("visibility","visible"),e(h).hide())}i=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,o=parseInt(t.target.id.split("text_")[1])||parseInt(t.target.id.split("selectioncanvas_")[1])||parseInt(t.target.id.split("secondarycanvas_")[1]),this.model.enableTextMarkupAnnotations&&(this._isPopupNoteVisible||this._isContextMenuPresent||(i||this._contextClickPosition(t.originalEvent.changedTouches[0],o),0==this._currentAnnotationRectangle.length||i?(e("#"+this._id+"_popup_note").css({display:"none"}),this.model.enableTextSelection?(t.target.style.cursor="auto",t.preventDefault(),this._enableSelection()):this.model.enableTextSelection||this._isCanasResized||this._isCanvasClicked||(e("#"+this._id+"pageDiv_"+this._currentPage),this._dragstate?(this._deltax=this._dragx-t.pageX,this._deltay=this._dragy-t.pageY,a=e("#"+this._id+"_viewerContainer").scrollTop(),r=e("#"+this._id+"_viewerContainer").scrollLeft(),this._deltay>3?e("#"+this._id+"_viewerContainer").scrollTop(a+20):this._deltay<-2&&e("#"+this._id+"_viewerContainer").scrollTop(a-20),this._deltax>3?e("#"+this._id+"_viewerContainer").scrollLeft(r+20):this._deltax<-2&&e("#"+this._id+"_viewerContainer").scrollLeft(r-20),t.target.style.cursor="move",t.target.style.cursor="-webkit-grabbing",t.target.style.cursor="-moz-grabbing",t.target.style.cursor="grabbing",this._dragx=t.pageX,this._dragy=t.pageY):(t.target.style.cursor="move",t.target.style.cursor="-webkit-grab",t.target.style.cursor="-moz-grab",t.target.style.cursor="grab"))):"StrikeOut"==(s=(n=this._currentAnnotationRectangle[0]).TextMarkupAnnotationType?n.TextMarkupAnnotationType:n.type)&&this.model.enableStrikethroughAnnotation?(this._showPopupNote(t),t.target.style.cursor="pointer"):"Underline"==s&&this.model.enableUnderlineAnnotation?(this._showPopupNote(t),t.target.style.cursor="point_setPopupMenuPosition:er"):"Highlight"==s&&this.model.enableHighlightAnnotation&&(this._showPopupNote(t),t.target.style.cursor="pointer")))},_setTouchContextMenu:function(t){var i=e("#"+this._id+"touchcustom-menu"),o={},n={},s={};return s.x=i.outerWidth(),s.y=i.outerHeight(),o.x=t.originalEvent.changedTouches[0].pageX,o.y=t.originalEvent.changedTouches[0].pageY,n.x=o.x+s.x>e(window).width()+e(window).scrollLeft()?o.x:o.x-s.x/2,o.y&&(n.y=o.y-s.y),n},_onTextContainerTouch:function(t){var i,o=e("#"+this._id+"_popup_note");o&&o.hide(),t.originalEvent.touches.length,this._curPosX=t.originalEvent.changedTouches[0].clientX,this._curPosY=t.originalEvent.changedTouches[0].clientY,this.model.enableTextSelection&&!this._isSelectionHidden&&"e-pdfviewer-formFields"!=event.target.className&&t.preventDefault(),this._lockTimer||(i=this,this._timer=setTimeout(function(){i._onlongtouch(t)},1e3),this._lockTimer=!0)},_onlongtouch:function(t){var i,o,n;"touchstart"==t.type&&t.target.id!=this._id+"droplet2"||t.target.id!=this._id+"droplet2"&&this.model.enableTextSelection?(this._enableSelection(),this._longTouch=!0,e(".text_container").css("visibility",""),this._curXPos=t.originalEvent.changedTouches[0].clientX,this._curYPos=t.originalEvent.changedTouches[0].clientY,i=parseInt(t.target.id.split("text_")[1])||parseInt(t.target.id.split("selectioncanvas_")[1])||parseInt(t.target.id.split("_secondarycanvas_")[1]),this._selectionStartPage=i,this._isPropertiesWindowOpen||i&&this.model.enableTextMarkupAnnotations&&this._contextClickPosition(t.originalEvent.changedTouches[0],i),this._isAnnotationSelected&&this._selectedAnnotation==this._currentAnnotationRectangle[0]||(this._getElementTouch(t.target,this._curXPos,this._curYPos,!0),i&&this._clearRectOnClick(i)),"e-pdfviewer-imagecanvasDraw"!=t.target.className||this._isCanasResized||this._isCanvasMoved||(o=document.getElementById(this._id+"highlight-menu"),this._showSignatureContext(t,o)),t.preventDefault()):this.model.enableTextSelection||(this._disableSelection(),n=document.getElementById(this._id+"touchcustom-menu"),e(n).hide(),this._waterDropletDivHide())},_onTextContainerTouchEnd:function(t){var i,o,n,s,a,r,l,d,h,_,c,p,g,u;e("#"+this._id+"_toolbarContainer_hiddenlist").addClass("e-display-none");var f,m=[],v=t.target;t.originalEvent.touches.length;if(this._timer){this._enableSelection(),i=e("a.popupnote"),o=e("#"+this._id+"_popupinnercontent"),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1,v==o[0]?o.focus():o.blur(),v.id!=this._id+"highlight-menu"&&v!=i[0]&&v!=o[0]&&"e-pdfviewer-imagecanvasDraw"!=v.className&&(this._isPropertiesWindowOpen||(n=document.getElementById(this._id+"highlight-menu"),e(n).hide(),this._isContextMenuPresent=!1,(r=parseInt(t.target.id.split("text_")[1])||parseInt(t.target.id.split("selectioncanvas_")[1])||parseInt(t.target.id.split("_secondarycanvas_")[1]))&&this.model.enableTextMarkupAnnotations&&this._contextClickPosition(t.originalEvent.changedTouches[0],r),0!=this._currentAnnotationRectangleBackup.length&&this._isAnnotationSelected&&this._selectedAnnotation==this._currentAnnotationRectangleBackup[0]&&(window.getSelection().removeAllRanges(),w=document.getElementById(this._id+"touchcustom-menu"),e(w).hide(),this._waterDropletDivHide()),this._longTouch&&this._isAnnotationSelected&&0!=this._currentAnnotationRectangleBackup.length&&this._selectedAnnotation==this._currentAnnotationRectangleBackup[0]&&(this.model.enableTextMarkupAnnotations&&("StrikeOut"==(a=(s=this._currentAnnotationRectangleBackup[0]).TextMarkupAnnotationType?s.TextMarkupAnnotationType:s.type)&&this.model.enableStrikethroughAnnotation?this._showAnnotationContextMenu(t.originalEvent.changedTouches[0],n):"Highlight"==a&&this.model.enableHighlightAnnotation?this._showAnnotationContextMenu(t.originalEvent.changedTouches[0],n):"Underline"==a&&this.model.enableUnderlineAnnotation&&this._showAnnotationContextMenu(t.originalEvent.changedTouches[0],n)),this._longTouch=!1),this._isContextMenuPresent||((r=parseInt(t.target.id.split("text_")[1])||parseInt(t.target.id.split("selectioncanvas_")[1])||parseInt(t.target.id.split("_secondarycanvas_")[1]))&&this.model.enableTextMarkupAnnotations&&(this._clearRectOnClick(r),l=document.getElementById(this._id+"_secondarycanvas_"+r),this._onCanvasMousedown(l,t.originalEvent.changedTouches[0].pageX,t.originalEvent.changedTouches[0].pageY),this._contextClickPosition(t.originalEvent.changedTouches[0],r)),window.getSelection().toString()||0!=this._currentAnnotationRectangle.length&&("StrikeOut"==(a=(s=this._currentAnnotationRectangle[0]).TextMarkupAnnotationType?s.TextMarkupAnnotationType:s.type)&&this.model.enableStrikethroughAnnotation?(this._AnnotationPage=r,this._drawAnnotSelectRect(r,this._currentAnnotationRectangle)):"Highlight"==a&&this.model.enableHighlightAnnotation?(this._AnnotationPage=r,this._drawAnnotSelectRect(r,this._currentAnnotationRectangle)):"Underline"==a&&this.model.enableUnderlineAnnotation&&(this._AnnotationPage=r,this._drawAnnotSelectRect(r,this._currentAnnotationRectangle)))))),clearTimeout(this._timer),this._lockTimer=!1;var w=document.getElementById(this._id+"touchcustom-menu");t.originalEvent.changedTouches[0].clientX,t.originalEvent.changedTouches[0].clientY;if((T=window.getSelection()).anchorNode){var x=(f=T.getRangeAt(0)).cloneContents(),b=x.childNodes,y=f.startContainer.parentElement.className;if(0!=x.childElementCount||this._longTouch){if(b.length>0)if("e-waitingpopup e-js"==b[0].className)for(d=0;d<b.length;d++)for(h=e(b[d]).find(".text_container").children(),_=0;_<h.length;_++)m.push(h[_].id);else for(c=0;c<b.length;c++)p=b[c].id,m.push(p)}else"e-pdfviewer-textLayer"==y?m.push(f.startContainer.parentElement.id):m.push(f.startContainer.id);for(g=0;g<m.length;g++){if(v.id==m[g]){this._touchcontextMenu=!0;break}this._touchcontextMenu=!1}}else this._touchcontextMenu=!1;if(this._rangePosition&&this._longTouch){e(".text_container").css("visibility","");var P=e(w).outerHeight(),C=e(w).outerWidth(),S=this._rangePosition.width/2;window.getSelection().toString();this._ranges||this._touchcontextMenu||t.target.id==this._id+"droplet1"||t.target.id==this._id+"droplet2"?(t.target.id==this._id+"droplet1"||t.target.id==this._id+"droplet2"&&this.model.textSelectionContextMenu.isEnable?(e(w).show(),u=this._setTouchContextMenu(t),e(w).show(),e(w).offset({top:u.y,left:u.x}).show(),this._annotationActive&&(this._isStrikeout?this._drawStrikeOutAnnotation():this._isUnderline?this._drawUnderlineAnnotation():this._isHighlight&&this._drawHighlightAnnotation())):!this._annotationActive&&this.model.textSelectionContextMenu.isEnable&&(e(w).show(),e(w).offset({top:this._rangePosition.top-P+window.scrollY,left:this._rangePosition.left+S-C/2})),this._ranges=!1,e(".text_container").css("visibility","")):e(t.target).hasClass("copy")||e(t.target).hasClass("googleSearch")?e(w).hide():(e(w).hide(),this._waterDropletDivHide()),this._longTouch=!1}else e(w).hide(),this._annotationActive&&(this._isStrikeout?this._drawStrikeOutAnnotation():this._isUnderline?this._drawUnderlineAnnotation():this._isHighlight&&this._drawHighlightAnnotation());if(this._annotationActive){if(this._touchcontextMenu){var T=window.getSelection(),I=document.createRange(),k=T.anchorNode.compareDocumentPosition(T.focusNode),z=!1;(!k&&T.anchorOffset>T.focusOffset||k===Node.DOCUMENT_POSITION_PRECEDING)&&(z=!0),z?(I.setStart(T.focusNode,T.focusOffset),I.setEnd(T.anchorNode,T.anchorOffset)):(I.setStart(T.anchorNode,T.anchorOffset),I.setEnd(T.focusNode,T.focusOffset));P=e(w).outerHeight(),C=e(w).outerWidth();var A=I.getBoundingClientRect(),D=I.getClientRects(),B=D.length-1,R=(A.width,document.getElementById(this._id+"droplet1")),E=document.getElementById(this._id+"droplet2");S=e(R).outerWidth(),e(R).outerHeight();""!=window.getSelection().toString()&&this.model.textSelectionContextMenu.isEnable&&(u=this._setTouchContextMenu(t),e(R).show(),e(R).offset({top:D[0].top+window.scrollY,left:D[0].left-S}).show(),e(E).show(),e(E).offset({top:D[B].top+window.scrollY,left:D[B].left+D[B].width-S}).show(),e(w).show(),e(w).offset({top:u.y,left:u.x}).show()),t.preventDefault()}}else"none"!=e(w).css("display")||t.target.id==this._id+"droplet2"||t.target.id==this._id+"droplet1"||"copy"==t.target.className||"googleSearch"==t.target.className||"none"!=e("#"+this._id+"custom-menu").css("display")||this._touched||this._touchcontextMenu||this.model.textSelectionContextMenu.isEnable&&(this._clearSelector(),this._clearText=!0);this._clearText&&(e(w).hide(),this._waterDropletDivHide(),this._clearText=!1)}else this.model.enableTextSelection||(R=document.getElementById(this._id+"droplet1"),E=document.getElementById(this._id+"droplet2"),e(R).hide(),e(E).hide(),this._disableSelection())},_onTextContainerMouseDown:function(t){var i,o,n,s;document.activeElement.id==this._id+"_toolbar_zoomSelection_wrapper"&&e("#"+this._id+"_toolbar_zoomSelection_wrapper").blur(),this.model.enableTextSelection||(this._dragx=t.pageX,this._dragy=t.pageY,this._dragstate=!0),i=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,t.target.id==this._id+"_popupinnercontent"||t.target.id==this._id+"_popupcontent"||!this.model.enableTextSelection||i?this.model.enableTextSelection||(s=e("#"+this._id+"selectioncanvas_"+this._currentPage)[0].id,this._isCanasResized||this._isCanvasClicked||t.target.id!=s||(t.target.style.cursor="move",t.target.style.cursor="-webkit-grabbing",t.target.style.cursor="-moz-grabbing",t.target.style.cursor="grabbing"),this._disableSelection()):(this._enableSelection(),e(".text_container").css("visibility",""),o=t.target,this._waterDropletDivHide(),e("#"+this._id+"touchcustom-menu").hide(),this._curYPos=t.clientY,this._curXPos=t.clientX,e(t.target).hasClass("text_container")||e(t.target).hasClass("e-pdfviewer-viewercontainer")||3==t.which||(this._curDown=!0,this._removeSearch=!0,(n=t.target.id.split("text_")[1])&&(this._selectedValue=n.split("_")[0]),this._selectionStartPage=parseInt(t.target.id.split("text_")[1])||parseInt(t.target.id.split("selectioncanvas_")[1])||parseInt(t.target.id.split("secondarycanvas_")[1])),"none"!=e("#"+this._id+"custom-menu").css("display")||3==t.which||e(o).hasClass("e-pdfviewer-secondarycanvas")||this._clearSelector(),e(o).hasClass("e-pdfviewer-formFields")||e(o).hasClass("e-pdfviewer-ListBox")||this._isFormFields||e(o).hasClass("e-dropdownSelect")||t.preventDefault())},_onTextContainerclick:function(t){this._waterDropletDivHide();var i=t.target;2==t.originalEvent.detail&&e(i).hasClass("e-pdfviewer-textLayer")&&this.model.enableTextSelection&&(t.preventDefault(),this._clearAllOccurrences(),this._enableSelection(),this._getElementTouch(i,t.clientX,t.clientY,!1),this._annotationActive&&!this._isAnnotationSelected&&(this._isStrikeout?this._drawStrikeOutAnnotation():this._isUnderline?this._drawUnderlineAnnotation():this._isHighlight&&this._drawHighlightAnnotation()),this._isAnnotationSelected&&(this._showPopupMenu(t),this._clearSelector(t)),t.preventDefault()),3==t.originalEvent.detail&&e(i).hasClass("e-pdfviewer-textLayer")&&this.model.enableTextSelection?(this._enableSelection(),this._annotationActive||this._selectingEntireLine(t)):this.model.enableTextSelection||this._disableSelection()},_onTextContainerMouseMove:function(t){var i,o,n,s,a,r,l,d,h,_,c,p;this.model.enableTextSelection||"e-pdfviewer-imagecanvasDraw"==t.target.className||"a"==t.target.tagName.toLowerCase()?"e-pdfviewer-buttons"!=t.target.className&&"a"!=t.target.tagName.toLowerCase()&&(t.target.style.cursor="auto"):e("#"+this._id+"pageDiv_"+this._currentPage).css("cursor","-webkit-grab"),i=-1!=navigator.userAgent.indexOf("MSIE")||1==!!document.documentMode,t.target.id==this._id+"_popupinnercontent"||t.target.id==this._id+"_popupcontent"||"e-pdfviewer-formFields"==t.target.className||(t.preventDefault(),this._enableSelection(),this._currentAnnotationRectangle=[],(o=parseInt(t.target.id.split("text_")[1])||parseInt(t.target.id.split("selectioncanvas_")[1])||parseInt(t.target.id.split("secondarycanvas_")[1]))&&!this._isPropertiesWindowOpen&&(i||(n=document.getElementById(this._id+"_secondarycanvas_"+o),this._onCanvasMousedown(n,t.pageX,t.pageY)),this.model.enableTextMarkupAnnotations&&(this._isPopupNoteVisible||this._isContextMenuPresent||(i||this._contextClickPosition(t,o),0==this._currentAnnotationRectangle.length||i?(e("#"+this._id+"_popup_note").css({display:"none"}),this.model.enableTextSelection?(t.target.style.cursor="auto",t.preventDefault(),this._enableSelection()):this.model.enableTextSelection||this._isCanasResized||this._isCanvasClicked||(e("#"+this._id+"pageDiv_"+this._currentPage),this._dragstate?(this._deltax=this._dragx-t.pageX,this._deltay=this._dragy-t.pageY,r=e("#"+this._id+"_viewerContainer").scrollTop(),l=e("#"+this._id+"_viewerContainer").scrollLeft(),this._deltay>3?e("#"+this._id+"_viewerContainer").scrollTop(r+20):this._deltay<-2&&e("#"+this._id+"_viewerContainer").scrollTop(r-20),this._deltax>3?e("#"+this._id+"_viewerContainer").scrollLeft(l+20):this._deltax<-2&&e("#"+this._id+"_viewerContainer").scrollLeft(l-20),t.target.style.cursor="move",t.target.style.cursor="-webkit-grabbing",t.target.style.cursor="-moz-grabbing",t.target.style.cursor="grabbing",this._dragx=t.pageX,this._dragy=t.pageY):(t.target.style.cursor="move",t.target.style.cursor="-webkit-grab",t.target.style.cursor="-moz-grab",t.target.style.cursor="grab"))):"StrikeOut"==(a=(s=this._currentAnnotationRectangle[0]).TextMarkupAnnotationType?s.TextMarkupAnnotationType:s.type)&&this.model.enableStrikethroughAnnotation?(this._showPopupNote(t),t.target.style.cursor="pointer"):"Underline"==a&&this.model.enableUnderlineAnnotation?(this._showPopupNote(t),t.target.style.cursor="pointer"):"Highlight"==a&&this.model.enableHighlightAnnotation&&(this._showPopupNote(t),t.target.style.cursor="pointer")))),e(".text_container").css("visibility",""),_=t.target,(c=t.target.id.split("text_")[1])&&(p=c.split("_")[0],this._isTextSelection=p==this._selectedValue),window.getSelection().toString()?-1==this._selectionPages.indexOf(o)&&o&&0!=o&&this._selectionPages.push(o):this._selectionPages=[],this.pageY=t.pageY,1==this._curDown&&"none"==e("#"+this._id+"custom-menu").css("display")&&(this._removeSearch&&(this._clearAllOccurrences(),this._removeSearch=!1),d=t.clientY,h=t.clientX,(0==this._currentAnnotationRectangle.length||this._annotationActive&&this._isTextSelection)&&this._getWordAtPoint(_,h,d),t.preventDefault()))},_onTextContainerMouseLeave:function(t){var i,o,n,s;t.target.id!=this._id+"_popupinnercontent"&&t.target.id!=this._id+"_popupcontent"&&this.model.enableTextSelection?(this._enableSelection(),1==this._curDown&&(i=this,t.preventDefault(),o=e("#"+this._id+"_viewerContainer"),n=e(o).offset().top,this._scrollMove=t.clientY>n?setInterval(function(){e(o).animate({scrollTop:e(o).scrollTop()+200},"fast")},500):setInterval(function(){e(o).animate({scrollTop:e(o).scrollTop()-200},"fast")},500),e(window).on("mouseup",function(e){return this._curDown=!1,i._onMouseClickedOutside(e),e.preventDefault(),e.stopPropagation(),!1}))):this.model.enableTextSelection||(s=this,e(window).on("mouseup",function(e){return s._dragstate=!1,e.preventDefault(),e.stopPropagation(),!1}),this._disableSelection())},_onTextContainerMouseEnter:function(e){e.target.id!=this._id+"_popupinnercontent"&&e.target.id!=this._id+"_popupcontent"&&this.model.enableTextSelection?(this._enableSelection(),this._scrollMove&&clearInterval(this._scrollMove)):this.model.enableTextSelection||this._disableSelection()},_onMouseClickedOutside:function(e){this._curDown=!1,this._scrollMove&&clearInterval(this._scrollMove),e.preventDefault(),e.stopPropagation()},_onTextContainerDragStart:function(e){e.preventDefault()},_clearSelector:function(){window.getSelection&&(window.getSelection().removeAllRanges?window.getSelection().removeAllRanges():document.selection&&document.selection.empty())},_createContextMenu:function(){var t,i=document.createElement("div"),o=e("#"+this._id+"_pageviewContainer");i.id=this._id+"custom-menu",i.className="e-pdfviewer-custom-menu",o.append(i),(t=document.createElement("ol")).className="orderedList",i.appendChild(t),window.getSelection().toString(),e(t).append("<li class='copyli'><a href='javascript:void(0);' class='copy'>Copy</a></li>"),e(t).append("<li class='googlesearchli'><a href='javascript:void(0);' class='googleSearch'>Search Google For </a></li>"),e(t).append("<li class='e-highlight-textli'><a href='javascript:void(0);' id = '"+this._id+"_highlight_contextmenu' class='e-highlight-text'>Highlight Text </a></li>"),e(t).append("<li class='e-strikeout-textli'><a href='javascript:void(0);' id = '"+this._id+"_strikeout_contextmenu' class='e-strikeout-text'>Strikethrough Text </a></li>")},_createTouchContextMenu:function(){var t=document.createElement("div"),i=e("#"+this._id+"_pageviewContainer");t.id=this._id+"touchcustom-menu",t.className="e-pdfviewer-touchcustom-menu",i.append(t),window.getSelection().toString(),e(t).append("<div class='e-pdfviewer-touchCopy'><a href='javascript:void(0);' class='copy'>Copy</a></div>"),e(t).append("<div class='e-pdfviewer-touchDot'><a href='javascript:void(0);' class='googleSearch'>Search</a></div>")},_onTextKeyboardCopy:function(e){e.ctrlKey&&67==e.keyCode&&(e.preventDefault(),this._isCopyRestrict||this._copySelectedText(e))},_copySelectedText:function(t){var i,o,n,s,a,r,l="",d=document.documentMode||/Edge/.test(navigator.userAgent);if(!this._isCopyRestrict&&this._searchedText&&this._searchedText.length>0&&""!=this._searchedText&&this.model.enableTextSelection){if(this._enableSelection(),window.clipboardData&&window.clipboardData.setData)return n=clipboardData.setData("Text",this._searchedText),e("#"+this._id+"custom-menu")&&e("#"+this._id+"custom-menu").hide(),n;r=document.createElement("textarea"),e(r).css("contenteditable","true"),r.textContent=this._searchedText,r.style.position="fixed",document.body.appendChild(r),r.select();try{return document.execCommand("copy")}catch(e){console.warn("Copy to clipboard failed.",e)}finally{r&&document.body.removeChild(r),e("#"+this._id+"custom-menu").hide()}t.preventDefault()}else if(!this._isCopyRestrict&&this.model.enableTextSelection){if(this._enableSelection(),o=window.getSelection().getRangeAt(0).toString(),navigator.userAgent.indexOf("Firefox")>-1,window.clipboardData&&window.clipboardData.setData)return n=clipboardData.setData("Text",o),e("#"+this._id+"custom-menu")&&e("#"+this._id+"custom-menu").hide(),n;document.queryCommandSupported&&document.queryCommandSupported("copy")&&(i=window.getSelection(),l=document.createRange(),a=!1,(!(s=i.anchorNode.compareDocumentPosition(i.focusNode))&&i.anchorOffset>i.focusOffset||s===Node.DOCUMENT_POSITION_PRECEDING)&&(a=!0),a?(l.setStart(i.focusNode,i.focusOffset),l.setEnd(i.anchorNode,i.anchorOffset)):(l.setStart(i.anchorNode,i.anchorOffset),l.setEnd(i.focusNode,i.focusOffset)),r=document.createElement("textarea"),e(r).css("contenteditable","true"),r.textContent=o,r.style.position="fixed",document.body.appendChild(r),r.select(),d||(i.removeAllRanges(),i.addRange(l)));try{return document.execCommand("copy")}catch(e){console.warn("Copy to clipboard failed.",e)}finally{r&&document.body.removeChild(r),e("#"+this._id+"custom-menu").hide(),d&&(i.removeAllRanges(),i.addRange(l))}t.preventDefault()}},_openInNewTab:function(){var t;t="http://www.google.com/search?q="+(this._searchedText&&this._searchedText.length>0&&""!=this._searchedText?this._searchedText:window.getSelection().toString()),window.open(t,"_blank").focus(),e("#"+this._id+"custom-menu").hide()},_waterDropletDivHide:function(){e(document.getElementById(this._id+"droplet1")).hide(),e(document.getElementById(this._id+"droplet2")).hide()},_getWordAtPoint:function(e,t,i){var o,n,s,a,r,l,d,h;if(!this._isPopupNoteFocused&&!this._isCanvasClicked&&!this._isCanasResized){if(e.nodeType==e.TEXT_NODE)for(o=!1,this._isBackwardSelection=!1,h=e.ownerDocument.createRange(),null!=(n=window.getSelection()).anchorNode&&((!(s=n.anchorNode.compareDocumentPosition(n.focusNode))&&n.anchorOffset>n.focusOffset||s===Node.DOCUMENT_POSITION_PRECEDING)&&(o=!0,this._isBackwardSelection=!0)),h.selectNodeContents(e),a=0,r=h.endOffset;a<r;){if(h.setStart(e,a),h.setEnd(e,a+1),h.getBoundingClientRect().left<=t&&h.getBoundingClientRect().right>=t&&h.getBoundingClientRect().top<=i&&h.getBoundingClientRect().bottom>=i)return l=h.toString(),null!=n.anchorNode&&"e-pdfviewer-textLayer"==n.anchorNode.parentNode.className&&h.setStart(n.anchorNode,n.anchorOffset),n.removeAllRanges(),n.addRange(h),o?n.extend(e,a):n.extend(e,a+1),h.detach(),this._isTextSelection=!0,l;a+=1}else for(d=0;d<e.childNodes.length;d++){if((h=e.childNodes[d].ownerDocument.createRange()).selectNodeContents(e.childNodes[d]),h.getBoundingClientRect().left<=t&&h.getBoundingClientRect().right>=t&&h.getBoundingClientRect().top<=i&&h.getBoundingClientRect().bottom>=i)return h.detach(),this._isTextSelection=!0,this._getWordAtPoint(e.childNodes[d],t,i);h.detach()}return this._isTextSelection=!1,null}},_getElementTouch:function(t,i,o,n){var s,a,r,l,d,h,_;if(t.nodeType==t.TEXT_NODE)for(s=window.getSelection(),(_=t.ownerDocument.createRange()).selectNodeContents(t),a=0,p=_.endOffset;a<p;){if(_.setStart(t,a),_.setEnd(t,a+1),_.getBoundingClientRect().left<=i&&_.getBoundingClientRect().right>=i&&_.getBoundingClientRect().top<=o&&_.getBoundingClientRect().bottom>=o){var c,p,g=_.toString(),u=t.textContent,f=[];for(h=0;h<u.length;h++)" "==u[h]&&f.push(h);for(r=0;r<f.length;r++){if(a==f[r]&&(c=f[r],p=f[r]),f[0]>a){c=0,p=f[r];break}a>f[r]&&a<f[r+1]?(c=f[r],p=f[r+1]):a>f[r]&&(f[r+1]||(c=f[r]))}if(this.startelem=c,this.endelem=p,0==c?_.setStart(t,c):_.setStart(t,c+1),_.setEnd(t,p),s.removeAllRanges(),s.addRange(_),n&&this.model.enableTextSelection){l=_.getBoundingClientRect(),this._rangePosition=l,this._ranges=!0,this._selectedRanges=_;var m=document.getElementById(this._id+"droplet1"),v=document.getElementById(this._id+"droplet2"),w=e(m).width(),x=e(m).height();e(m).show(),e(m).offset({top:l.top+window.scrollY+x/2,left:l.left-w}).show(),e(v).show(),e(v).offset({top:l.top+window.scrollY+x/2,left:l.left+l.width-w}).show()}else this.model.enableTextSelection||(this._disableSelection(),d=document.getElementById(this._id+"touchcustom-menu"),e(d).hide(),this._waterDropletDivHide());return _.detach(),g}a+=1}else for(h=0;h<t.childNodes.length;h++){if((_=t.childNodes[h].ownerDocument.createRange()).selectNodeContents(t.childNodes[h]),_.getBoundingClientRect().left<=i&&_.getBoundingClientRect().right>=i&&_.getBoundingClientRect().top<=o&&_.getBoundingClientRect().bottom>=o)return _.detach(),this._getElementTouch(t.childNodes[h],i,o,n);_.detach()}return null},_preventClick:function(t){var i;e(t.target).hasClass("e-pdfviewer-toolbarli-label")?(i=t.target,e(i).removeClass("e-active"),e(i).removeClass("e-hover")):((i=e(t.target).parents(".e-pdfviewer-toolbarli-label")).removeClass("e-active"),i.removeClass("e-hover"))},_toolbarHover:function(t){var i;(e(t.target).hasClass("e-pdfviewer-toolbarli-label")||e(t.target).parents().hasClass("e-pdfviewer-toolbarli-label"))&&(e(t.target).hasClass("e-pdfviewer-toolbarli-label")?(i=t.target,e(i).removeClass("e-hover")):(i=e(t.target).parents(".e-pdfviewer-toolbarli-label")).removeClass("e-hover"))},_toolbarClick:function(t){var i,o,n,s=e("#"+this._id+"_popup_note");if(s&&s.hide(),t.target,i=t.target,this._isToolbarClick)if(e("#"+this._id+"_rptTooltip").css("display","none"),e(i).hasClass("e-pdfviewer-highlight-markup")||e(i).hasClass("e-pdfviewer-strikeout-markup")||e(i).hasClass("e-pdfviewer-underline-markup")||e(i).hasClass("e-pdfviewer-toolbar-highlight")||e(i).hasClass("e-pdfviewer-toolbar-underline")||e(i).hasClass("e-pdfviewer-toolbar-strikeout")||e(i).hasClass("e-pdfviewer-dropdown-wrapper")||e(i).hasClass("e-pdfviewer-dropdown-arrow")||(this._selectionNodes=window.getSelection(),this._maintainSelection(),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1),(e(i).hasClass("e-pdfviewer-highlight-markup")||e(i).hasClass("e-pdfviewer-strikeout-markup")||e(i).hasClass("e-pdfviewer-underline-markup")||e(i).hasClass("e-pdfviewer-toolbar-highlight")||e(i).hasClass("e-pdfviewer-toolbar-underline")||e(i).hasClass("e-pdfviewer-toolbar-strikeout"))&&(document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1),this._displaySearch=!1,this._isDefaultColorSet=!1,e(i).hasClass("e-pdfviewer-toolbarli")&&(i=e(i).find("span")),e(i).hasClass("e-pdfviewer-print"))this._isPrintRestrict||this._print();else if(e(i).hasClass("e-pdfviewer-download")){if(this._isAsynchronousDownload=!0,this._cancelDownloads=!1,(o={}).fileName=this._downloadfileName,o.status="is started",this._raiseClientEvent("downloadStart",o),this._cancelDownloads)return;this._saveFormFieldsValue()}else if(e(i).hasClass("e-pdfviewer-gotofirst")&&!e(i).hasClass("e-pdfviewer-disabled"))this._gotoFirstPage();else if(e(i).hasClass("e-pdfviewer-gotolast")&&!e(i).hasClass("e-pdfviewer-disabled"))this._gotoLastPage();else if(e(i).hasClass("e-pdfviewer-gotonext")&&!e(i).hasClass("e-pdfviewer-disabled"))this._gotoNextPage();else if(e(i).hasClass("e-pdfviewer-gotoprevious")&&!e(i).hasClass("e-pdfviewer-disabled"))this._gotoPreviousPage();else if(e(i).hasClass("e-pdfviewer-zoomin"))this._applyLowerZoomIndex(),this._zoomIn();else if(e(i).hasClass("e-pdfviewer-select")||e(i).hasClass("e-pdfviewer-toolbar-select"))this._highlightSelectItems();else if(e(i).hasClass("e-pdfviewer-scroll")||e(i).hasClass("e-pdfviewer-toolbar-scroll"))this._highlightScrollItems();else if(e(i).hasClass("e-pdfviewer-sign")||e(i).hasClass("e-pdfviewer-toolbar-sign"))this._showSignatureDialog();else if(e(i).hasClass("e-pdfviewer-zoomout"))this._applyHigherZoomIndex(),this._zoomOut();else if(e(i).hasClass("e-pdfviewer-fitpage")||e(i).hasClass("e-pdfviewer-fitwidth"))switch(e(i).attr("id")){case this._id+"_fitWidth":this._applyFitToWidth();break;case this._id+"_fitPage":this._applyFitToPage()}else e(i).hasClass("e-pdfviewer-find")?this._displaySearchBox():e(i).hasClass("e-pdfviewer-highlight-markup")||e(i).hasClass("e-pdfviewer-toolbar-highlight")?this.model.enableTextMarkupAnnotations&&this.model.enableHighlightAnnotation&&(this._drawColor=null,this._toolbarColorpickerObject.option("value",this.model.highlightSettings.color),this._isDefaultColorSet=!0,this._initHighlight(),this._highlightSelectItems()):e(i).hasClass("e-pdfviewer-underline-markup")||e(i).hasClass("e-pdfviewer-toolbar-underline")?this.model.enableTextMarkupAnnotations&&this.model.enableUnderlineAnnotation&&(this._drawColor=null,this._toolbarColorpickerObject.option("value",this.model.underlineSettings.color),this._isDefaultColorSet=!0,this._initUnderline(),this._highlightSelectItems()):e(i).hasClass("e-pdfviewer-strikeout-markup")||e(i).hasClass("e-pdfviewer-toolbar-strikeout")?this.model.enableTextMarkupAnnotations&&this.model.enableStrikethroughAnnotation&&(this._drawColor=null,this._toolbarColorpickerObject.option("value",this.model.strikethroughSettings.color),this._isDefaultColorSet=!0,this._initStrikeOut(),this._highlightSelectItems()):(e(i).hasClass("e-pdfviewer-dropdown-wrapper")||e(i).hasClass("e-pdfviewer-dropdown-arrow"))&&((n=e(i).parents(".e-pdfviewer-toolbarli")).hasClass("e-pdfviewer-toolbar-underline")?this.model.enableTextMarkupAnnotations&&this.model.enableUnderlineAnnotation&&(this._displayColorPicker("Underline"),this._setPickerPosition(n[0]),this._isUnderlineEnabled=!1,this._initUnderline(),this._highlightSelectItems()):n.hasClass("e-pdfviewer-toolbar-highlight")?this.model.enableTextMarkupAnnotations&&this.model.enableHighlightAnnotation&&(this._displayColorPicker("Highlight"),this._setPickerPosition(n[0]),this._isHighlightEnabled=!1,this._initHighlight(),this._highlightSelectItems()):n.hasClass("e-pdfviewer-toolbar-strikeout")&&this.model.enableTextMarkupAnnotations&&this.model.enableStrikethroughAnnotation&&(this._displayColorPicker("StrikeOut"),this._setPickerPosition(n[0]),this._isStrikeOutEnabled=!1,this._initStrikeOut(),this._highlightSelectItems()))},_enableSelectionOnly:function(){e("#"+this._id+"_pdfviewer_toolbar_select").hasClass("e-disable")?(this.model.enableTextSelection=!1,this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_select"),this._toolbar.selectItemByID(this._id+"_pdfviewer_toolbar_scroll")):this._isCopyRestrict||(this.model.enableTextSelection=!0,this._enableSelection())},_enableScrollingOnly:function(){this.model.enableTextSelection=!1,this._disableSelection()},_highlightSelectItems:function(){this._toolbar.selectItemByID(this._id+"_pdfviewer_toolbar_select"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_scroll"),this._enableSelectionOnly()},_highlightScrollItems:function(){this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_select"),this._toolbar.selectItemByID(this._id+"_pdfviewer_toolbar_scroll"),this._waterDropletDivHide(),this._enableScrollingOnly()},_cancelDownload:function(){this._cancelDownloads=!0,null!=this._ajaxDownloaded&&(this._ajaxDownloaded.abort(),this._ajaxDownloaded=null)},_save:function(e){var t=-1==this.fileName.indexOf("\\")?this.fileName:this.fileName.replace(/^.*[\\\/]/,""),i=navigator.userAgent,o=this._base64toBlob(e.documentStream,"application/pdf",512);-1==i.indexOf("Edge")&&(-1!=i.indexOf("Firefox")||-1!=i.indexOf("Chrome")||-1!=i.indexOf("Safari")||-1!=i.indexOf("AppleWebKit"))?this._download(o,"",t):window.navigator.msSaveOrOpenBlob(o,t)},_base64toBlob:function(e,t,i){var o,n,s,a,r,l,d;for(t=t||"",i=i||512,o=atob(e),n=[],s=0;s<o.length;s+=i){for(a=o.slice(s,s+i),r=new Array(a.length),l=0;l<a.length;l++)r[l]=a.charCodeAt(l);d=new Uint8Array(r),n.push(d)}return new Blob(n,{type:t})},_createBlob:function(e,t){if("undefined"!=typeof Blob)return new Blob([e],{type:t});warn('The "Blob" constructor is not supported.')},_download:function(e,t,i){var o,n=URL.createObjectURL(e),s=document.createElement("a");s.click?(s.href=n,s.target="_parent","download"in s&&(s.download=i),(document.body||document.documentElement).appendChild(s),s.click(),s.parentNode.removeChild(s)):(window.top===window&&n.split("#")[0]===window.location.href.split("#")[0]&&(o=-1===n.indexOf("?")?"?":"&",n=n.replace(/#|$/,o+"$&")),window.open(n,"_parent"))},_showToolbar:function(t){t?(e("#"+this._id+"_toolbarContainer").css("display","block"),this._setSearchToolbarTop(),this._isToolbarHidden=!1):(e("#"+this._id+"_toolbarContainer").css("display","none"),this._isFindboxPresent&&this._displaySearchBox(),this._isToolbarHidden=!0),this._setViewerContainerHeight()},_setViewerContainerHeight:function(){var t,i,o,n,s=document.getElementById(this._id).clientHeight,a=0;this._isDevice||"block"==(t=e("#"+this._id+"_viewBlockContainer")).css("display").toLowerCase()&&(a=t.height()),i=this.model.toolbarSettings.templateId?e("#"+this.model.toolbarSettings.templateId).height():e("#"+this._id+"_toolbarContainer").height(),"block"==(o=e("#"+this._id+"_toolbarContainer").css("display")).toLowerCase()?n=s-a-i-4:"none"==o.toLowerCase()&&(n=s-a-4),e("#"+this._id+"_viewerContainer").css({height:n+"px"})},_initToolbar:function(){if(this._isToolbarClick=!1,!this.model.toolbarSettings.templateId&&!this._isDevice){var t=e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList");t&&(t._selectItemByIndex(0),t.disable()),e("#"+this._id+"_txtpageNo").attr("disabled","disabled"),this._toolbar&&(this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotofirst"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotoprevious"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotonext"),this._toolbar.disableItemByID(this._id+"_pdfviewer_toolbar_gotolast"))}},_enableToolbarItems:function(){this._isToolbarClick=!0,this.model&&!this.model.toolbarSettings.templateId&&(this._isDevice||(e("#"+this._id+"_txtpageNo").removeAttr("disabled"),e("#"+this._id+"_toolbar_zoomSelection").data("ejDropDownList").enable()))},_showLocalizationTooltip:function(t){"none"==e("#"+this._id+"_rptTooltip").css("display")&&this._showLocaleTooltip(t)},_hideLocalizationTooltip:function(){e("#"+this._id+"_rptTooltip").css("display","none")},_showLocaleTooltip:function(i){var o,n,s,a,r,l=i.target;if(l.id==this._id+"_pdfviewer_findlabel"&&((a=e("#"+this._id+"_pdfviewer_findlabel")[0]).scrollWidth>e(a).innerWidth()&&(a&&(o=a.getBoundingClientRect()),n="",s=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.Find.contentText)),l.id==this._id+"_pdfviewer_matchlabel"&&((a=e("#"+this._id+"_pdfviewer_matchlabel")[0]).scrollWidth>e(a).innerWidth()&&(a&&(o=a.getBoundingClientRect()),n="",s=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.matchCase.contentText)),s){r=this._viewerMaxZindex(),e("#"+this._id+"_rptTooltip_Header").html(n),e("#"+this._id+"_rptTooltip_Content").html(s);var d=document.getElementById(this._id+"_pdfviewer_searchbox").getBoundingClientRect(),h=e("#"+this._id+"_toolbarContainer")[0].getBoundingClientRect(),_=this.element[0].clientWidth,c=parseFloat(e("#"+this._id+"_rptTooltip").css("min-width"));_<=o.left+c?(e("#"+this._id+"_rptTooltip").css({zIndex:r+1,top:o.top-d.top+d.height-18,left:o.left-h.left+o.width/2-c,display:"block",position:"absolute"}),parseFloat(e("#"+this._id+"_rptTooltip").css("left"))<0&&e("#"+this._id+"_rptTooltip").css("left","0px")):_<=o.left+2*o.width?e("#"+this._id+"_rptTooltip").css({zIndex:r+1,top:o.top-d.top+d.height-18,left:o.left-h.left-3*o.width,display:"block",position:"absolute"}):e("#"+this._id+"_rptTooltip").css({zIndex:r+1,top:o.top-d.top+d.height-18,left:o.left-h.left+o.width/2,display:"block",position:"absolute"})}},_showIconToolTip:function(t){"none"==e("#"+this._id+"_rptTooltip").css("display")&&this._showTooltipContent(t)},_hideIconToolTip:function(){e("#"+this._id+"_rptTooltip").css("display","none")},_viewpopupBlockNone:function(e){return"block"!=e.css("display")},_showTooltipContent:function(t){var i,o,n,s,a,r,l,d,h,_,c,p,g,u,f,m,v,w,x,b,y,P,C,S,T,I=t.target;if(this.model&&this.model.toolbarSettings.showTooltip&&!this._isDevice){if(n=!0,e(I).hasClass("e-pdfviewer-toolbarli")&&(I=e(I).find("span")),s=e(I).prev(),e(I).hasClass("e-pdfviewer-print")&&(i=(a=e("#"+this._id+"_toolbarContainer .e-pdfviewer-print")[0])?a.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-print")[0].getBoundingClientRect(),o=this._getTootipText("print")),e(I).hasClass("e-pdfviewer-download"))i=(a=e("#"+this._id+"_toolbarContainer .e-pdfviewer-download")[0])?a.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-download")[0].getBoundingClientRect(),o=this._getTootipText("download");else if(e(I).hasClass("e-pdfviewer-gotofirst")||e(s).hasClass("e-pdfviewer-gotofirst"))i=(r=e("#"+this._id+"_toolbarContainer .e-pdfviewer-gotofirst")[0])?r.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-gotofirst")[0].getBoundingClientRect(),o=this._getTootipText("first");else if(e(I).hasClass("e-pdfviewer-gotolast")||e(s).hasClass("e-pdfviewer-gotolast"))i=(l=e("#"+this._id+"_toolbarContainer .e-pdfviewer-gotolast")[0])?l.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-gotolast")[0].getBoundingClientRect(),o=this._getTootipText("last");else if(e(I).hasClass("e-pdfviewer-gotonext")||e(s).hasClass("e-pdfviewer-gotonext"))i=(d=e("#"+this._id+"_toolbarContainer .e-pdfviewer-gotonext")[0])?d.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-gotonext")[0].getBoundingClientRect(),o=this._getTootipText("next");else if(e(I).hasClass("e-pdfviewer-gotoprevious")||e(s).hasClass("e-pdfviewer-gotoprevious"))i=(h=e("#"+this._id+"_toolbarContainer .e-pdfviewer-gotoprevious")[0])?h.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-gotoprevious")[0].getBoundingClientRect(),o=this._getTootipText("previous");else if(e(I).hasClass("e-pdfviewer-zoomin")||e(s).hasClass("e-pdfviewer-zoomin"))i=(_=e("#"+this._id+"_toolbarContainer .e-pdfviewer-zoomin")[0])?_.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-zoomin")[0].getBoundingClientRect(),o=this._getTootipText("zoomin");else if(e(I).hasClass("e-pdfviewer-zoomout")||e(s).hasClass("e-pdfviewer-zoomout"))i=(c=e("#"+this._id+"_toolbarContainer .e-pdfviewer-zoomout")[0])?c.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-zoomout")[0].getBoundingClientRect(),o=this._getTootipText("zoomout");else if(e(I).hasClass("e-pdfviewer-tbpage")||e(I).hasClass("e-pdfviewer-pagenumber")||e(I).hasClass("e-pdfviewer-labelpageno"))i=(p=e("#"+this._id+"_toolbarContainer .e-pdfviewer-tbpage")[0])?p.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-tbpage")[0].getBoundingClientRect(),o=this._getTootipText("pageIndex");else if(e(I).hasClass("e-pdfviewer-ejdropdownlist")||e(I).hasClass("e-dropdownlist")||e(I).hasClass("e-select")||e(I).hasClass("e-down-arrow"))i=(g=e("#"+this._id+"_toolbarContainer .e-pdfviewer-ejdropdownlist")[0])?g.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-ejdropdownlist")[0].getBoundingClientRect(),o=this._getTootipText("zoom"),n=this._viewpopupBlockNone(e("#"+this._id+"_toolbar_zoomSelection_popup_list_wrapper"));else if(e(I).hasClass("e-pdfviewer-fitwidth")||e(I).hasClass("e-pdfviewer-fitpage")||e(s).hasClass("e-pdfviewer-fitwidth")||e(s).hasClass("e-pdfviewer-fitpage"))switch(e(u=I).attr("id")){case this._id+"_fitWidth":i=(f=e("#"+this._id+"_toolbarContainer .e-pdfviewer-fitwidth")[0])?f.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-fitwidth")[0].getBoundingClientRect(),o=this._getTootipText("fittoWidth");break;case this._id+"_fitPage":i=(m=e("#"+this._id+"_toolbarContainer .e-pdfviewer-fitpage")[0])?m.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-fitpage")[0].getBoundingClientRect(),o=this._getTootipText("fittopage");break;default:v=e(u).prev(),e(v).hasClass("e-pdfviewer-fitwidth")?(i=(f=e("#"+this._id+"_toolbarContainer .e-pdfviewer-fitwidth")[0])?f.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-fitwidth")[0].getBoundingClientRect(),o=this._getTootipText("fittoWidth")):e(v).hasClass("e-pdfviewer-fitpage")&&(i=(m=e("#"+this._id+"_toolbarContainer .e-pdfviewer-fitpage")[0])?m.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-fitpage")[0].getBoundingClientRect(),o=this._getTootipText("fittopage"))}else e(I).hasClass("e-pdfviewer-find")?this._isFindboxPresent||(i=(w=e("#"+this._id+"_toolbarContainer .e-pdfviewer-find")[0])?w.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-find")[0].getBoundingClientRect(),o=this._getTootipText("search")):e(I).hasClass("e-pdfviewer-highlight-markup")||e(I).hasClass("e-pdfviewer-toolbar-highlight")?(i=(x=e("#"+this._id+"_toolbarContainer .e-pdfviewer-highlight-markup")[0])?x.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-highlight-markup")[0].getBoundingClientRect(),o=this._getTootipText("highlight")):e(I).hasClass("e-pdfviewer-strikeout-markup")||e(I).hasClass("e-pdfviewer-toolbar-strikeout")?(i=(b=e("#"+this._id+"_toolbarContainer .e-pdfviewer-strikeout-markup")[0])?b.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-strikeout-markup")[0].getBoundingClientRect(),o=this._getTootipText("strikeout")):e(I).hasClass("e-pdfviewer-underline-markup")||e(I).hasClass("e-pdfviewer-toolbar-underline")?(i=(y=e("#"+this._id+"_toolbarContainer .e-pdfviewer-underline-markup")[0])?y.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-underline-markup")[0].getBoundingClientRect(),o=this._getTootipText("underline")):e(I).hasClass("e-pdfviewer-sign")||e(I).hasClass("e-pdfviewer-toolbar-sign")?(i=(P=e("#"+this._id+"_toolbarContainer .e-pdfviewer-sign")[0])?P.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist  .e-pdfviewer-sign")[0].getBoundingClientRect(),o=this._getTootipText("signature")):e(I).hasClass("e-pdfviewer-select")||e(I).hasClass("e-pdfviewer-toolbar-select")?(i=(C=e("#"+this._id+"_toolbarContainer .e-pdfviewer-select")[0])?C.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist  .e-pdfviewer-select")[0].getBoundingClientRect(),o=this._getTootipText("select")):(e(I).hasClass("e-pdfviewer-scroll")||e(I).hasClass("e-pdfviewer-toolbar-scroll"))&&(i=(S=e("#"+this._id+"_toolbarContainer .e-pdfviewer-scroll")[0])?S.getBoundingClientRect():e("#"+this._id+"_toolbarContainer_hiddenlist  .e-pdfviewer-scroll")[0].getBoundingClientRect(),o=this._getTootipText("scroll"));if(o&&n){T=this._viewerMaxZindex(),e("#"+this._id+"_rptTooltip_Header").html(o.header),e("#"+this._id+"_rptTooltip_Content").html(o.content);var k=document.getElementById(this._id+"_toolbarContainer").getBoundingClientRect(),z=this.element[0].clientWidth,A=parseFloat(e("#"+this._id+"_rptTooltip").css("min-width"));z<=i.left+A?(e("#"+this._id+"_rptTooltip").css({zIndex:T+1,top:i.top-k.top-21,left:i.left-k.left+i.width/2-A,display:"block",position:"absolute"}),parseFloat(e("#"+this._id+"_rptTooltip").css("left"))<0&&e("#"+this._id+"_rptTooltip").css("left","0px")):z<=i.left+2*i.width?"Zoom"==o.header?e("#"+this._id+"_rptTooltip").css({zIndex:T+1,top:i.top-k.top-21,left:i.left-k.left-2*i.width,display:"block",position:"absolute"}):e("#"+this._id+"_rptTooltip").css({zIndex:T+1,top:i.top-k.top-21,left:i.left-k.left-3*i.width,display:"block",position:"absolute"}):e("#"+this._id+"_rptTooltip").css({zIndex:T+1,top:i.top-k.top-21,left:i.left-k.left+i.width/2,display:"block",position:"absolute"})}}},_viewerMaxZindex:function(){var t,i,o,n=this.element.parents(),s=e("body").children(),a=s.index(this.popup);return s.splice(a,1),e(s).each(function(e,t){n.push(t)}),i=(t=e(this.model.target).children()).index(this.popup),t.splice(i,1),e(t).each(function(e,t){n.push(t)}),!(o=Math.max.apply(o,e.map(n,function(t){if("static"!=e(t).css("position"))return parseInt(e(t).css("z-index"))||1})))||o<1e4?o=1e4:o+=1,o},_getTootipText:function(e){var i=t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default,o="",n="";switch(e){case"print":o=i.toolbar.print.headerText,n=i.toolbar.print.contentText;break;case"download":o=i.toolbar.download.headerText,n=i.toolbar.download.contentText;break;case"first":o=i.toolbar.first.headerText,n=i.toolbar.first.contentText;break;case"previous":o=i.toolbar.previous.headerText,n=i.toolbar.previous.contentText;break;case"next":o=i.toolbar.next.headerText,n=i.toolbar.next.contentText;break;case"last":o=i.toolbar.last.headerText,n=i.toolbar.last.contentText;break;case"zoomin":o=i.toolbar.zoomIn.headerText,n=i.toolbar.zoomIn.contentText;break;case"zoomout":o=i.toolbar.zoomOut.headerText,n=i.toolbar.zoomOut.contentText;break;case"pageIndex":o=i.toolbar.pageIndex.headerText,n=i.toolbar.pageIndex.contentText;break;case"zoom":o=i.toolbar.zoom.headerText,n=i.toolbar.zoom.contentText;break;case"fittoWidth":o=i.toolbar.fitToWidth.headerText,n=i.toolbar.fitToWidth.contentText;break;case"fittopage":o=i.toolbar.fitToPage.headerText,n=i.toolbar.fitToPage.contentText;break;case"search":o=i.toolbar.search.headerText,n=i.toolbar.search.contentText;break;case"highlight":o=i.toolbar.highlight.headerText,n=i.toolbar.highlight.contentText;break;case"strikeout":o=i.toolbar.strikeout.headerText,n=i.toolbar.strikeout.contentText;break;case"underline":o=i.toolbar.underline.headerText,n=i.toolbar.underline.contentText;break;case"signature":o=i.toolbar.signature.headerText,n=i.toolbar.signature.contentText;break;case"select":o=i.toolbar.select.headerText,n=i.toolbar.select.contentText;break;case"scroll":o=i.toolbar.scroll.headerText,n=i.toolbar.scroll.contentText}return{header:o,content:n}},_setInitialization:function(){this._canvascount=0,this._fileName="",this._isToolbarClick=!1,this._pageModel=null,this._currentPage=1,this._zoomLevel=2,this._pageImageStream=null,this._pageWidth,this._pageHeight,this._pageLocation=[],this._scrollTriggered=!1,this._previousPage=1,this._totalPages,this._previousPosition,this._cummulativeHeight,this._backgroundPage=1,this._renderedCanvasList=[],this._pageContents=[],this._pageText=[],this._searchMatches=[],this._pagePrinted=!1,this._printingPage=1,this._printingTimer,this._previousZoom=1,this._renderPreviousPage=!1,this._pageSize,this._eventpreviouszoomvalue,this._eventzoomvalue,this._pdfFileName,this._zoomArray=[],this._rerenderCanvasList=[],this._ajaxRequestState=null,this._ajaxDownloaded=null},_showViewerBlock:function(t){if(t){e("#"+this._id+"_viewBlockContainer").css("display","block");var i=e("#"+this._id+"_viewBlockContainer .e-pdfviewer-viewerblockcellcontent").find("table");this._selectparamToolItem(i.is("[isviewclick]"))}else e("#"+this._id+"_viewBlockContainer").css("display","none");this._isDevice&&e("#"+this._id+"_viewBlockContainer.e-pdfviewer-blockstyle").css("z-index",t?"10":"0")},_showNavigationIndicator:function(t){e("#"+this._id+"_viewerContainer").ejWaitingPopup({showOnInit:t,appendTo:"#"+this._id+"_viewerContainer"}),e("#"+this._id+"_viewerContainer_WaitingPopup").addClass("e-pdfviewer-waitingpopup")},_showSelectionButtons:function(t){t?(e("#"+this._id+"_pdfviewer_selectul").css("display","block"),e("#"+this._id+"_pdfviewer_signatureul").addClass("e-separator"),this._isSelectionHidden=!1):(e("#"+this._id+"_pdfviewer_selectul").css("display","none"),e("#"+this._id+"_pdfviewer_signatureul").removeClass("e-separator"),this._isSelectionHidden=!0)},_showloadingIndicator:function(t){t?(e("#"+this._id+"_loadingIndicator").css("display","block"),e("#"+this._id+"_pageviewOuterContainer").css("display","none")):(e("#"+this._id+"_loadingIndicator").css("display","none"),e("#"+this._id+"_pageviewOuterContainer").css("display","block")),e("#"+this._id+"_loadingIndicator").ejWaitingPopup({showOnInit:t,appendTo:"#"+this._id+"_loadingIndicator"}),e("#"+this._id+"_loadingIndicator_WaitingPopup").addClass("e-pdfviewer-waitingpopup")},_showPrintLoadingIndicator:function(i){e("#"+this._id+"e-pdf-viewer").css({position:"relative"});var o=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).waitingPopup.print.contentText;e("#"+this._id+"e-pdf-viewer").ejWaitingPopup({showOnInit:i,text:o,cssClass:"e-pdfviewer-waitingpopup-print",appendTo:"#"+this._id+"e-pdf-viewer"})},_viewerResize:function(){var t,i,n,s,a,r,l,d,h;null==this.element&&(this.element=e("#"+this._id)),null==this.model&&(this.model=e("#"+this._id).ejPdfViewer("instance").model),(t=this)._isPinchZoomed=!1;var _=t._isWidth?t.element[0].parentElement.style.width:t.element[0].style.width,c=t._isHeight?t.element[0].parentElement.style.height:t.element[0].style.height,p=e(t.element).height(),g=e(t.element).width();if(-1!=c.indexOf("%")?(t._isPercentHeight=parseInt(c),i=t._isHeight?e(t.element).parent().height():p,p=t._isHeight?i:i/100*t._isPercentHeight):0!=t.element[0].parentElement.clientHeight&&-1!=t._isPercentHeight?p=t._isHeight?t.element[0].parentElement.clientHeight:t.element[0].parentElement.clientHeight/100*t._isPercentHeight:t._isHeight&&0!=t.element[0].parentElement.clientHeight&&(p=t.element[0].parentElement.clientHeight),t.element.height(p),s=0,t.element[0].parentElement&&(a=getComputedStyle(t.element[0].parentElement),n=parseFloat(a.paddingLeft),s=parseFloat(a.paddingRight)),-1!=_.indexOf("%")?(t._isPercentWidth=parseInt(_),r=t._isWidth?e(t.element).parent().width():g,g=t._isWidth?r:r/100*t._isPercentWidth):0!=t.element[0].parentElement.clientWidth&&-1!=t._isPercentWidth?(l=t.element[0].parentElement.clientWidth-n-s,g=t._isWidth?l:l/100*t._isPercentWidth):t._isWidth&&0!=t.element[0].parentElement.clientWidth&&(g=t.element[0].parentElement.clientWidth-n-s),t.element.width(g),t._toolbar._activeItem=o,t._toolbar._reSizeHandler(),g<=500?e("#"+this._id+"_containerDialogTab").ejDialog({position:{X:g/2-153.5+"px",Y:p/2+"px"},width:"auto",height:"auto"}):e("#"+this._id+"_containerDialogTab").ejDialog({position:{X:g/2-250+"px",Y:p/2+"px"},width:"500px",height:"322px"}),d=Math.max(0,(e(window).height()-e("#"+this._id+"_containerDialogTab").outerHeight())/2+e(window).scrollTop())+"px",f=Math.max(0,(e(window).width()-e("#"+this._id+"_containerDialogTab").outerWidth())/2+e(window).scrollLeft())+"px",e("#"+this._id+"_containerDialogTab").ejDialog({position:{X:f,Y:d}}),g<=500||window.innerHeight<=500){e("#"+this._id+"_signatureContainerDialogTab").ejDialog({width:"auto",height:"auto"}),(h=e("#"+this._id+"_imageTemp")[0]).height=100,h.width=g,h.style.height="100px",h.style.width=g+"px";var u,f=(u=t.element[0].parentElement.parentElement.parentElement).offsetWidth,m=(u.offsetHeight,f/2-h.width/2),v=window.innerHeight/2-h.height/2;e("#"+this._id+"_signatureContainerDialogTab").ejDialog({position:{X:m+"px",Y:v+"px"}})}else if((h=e("#"+this._id+"_imageTemp")[0]).height=400,h.width=470,h.style.height="400px",h.style.width="470px",u=t.element[0].parentElement.parentElement.parentElement){f=u.offsetWidth,u.offsetHeight,m=f/2-h.width/2,v=window.innerHeight/2-h.height/2;e("#"+this._id+"_signatureContainerDialogTab").ejDialog({height:"503px"}),e("#"+this._id+"_signatureContainerDialogTab").ejDialog({position:{X:m+"px",Y:v+"px"}})}e("#"+t._id+"_pdfviewer_searchul").removeClass("e-separator"),e("#"+t._id+"_pdfviewer_downloadul").removeClass("e-separator"),document.getElementById(t._id+"_pdfviewer_colorpicker").style.display="none",t._isToolbarColorPicker=!1,t._toolbarResizeHandler(),t._resizeSearchToolbar(),this.model.toolbarSettings.templateId?e("#"+this.model.toolbarSettings.templateId).height():e("#"+this._id+"_toolbarContainer").height(),t.model&&t.model.isResponsive&&t._renderedCanvasList.length>0&&t._isAutoZoom&&t._applyFitToWidthAuto(),t.model&&"fitToWidth"==t._fitType&&!t.model.isResponsive&&t._applyFitToWidth(),t._isViewerRestored=!1,t._isAutoSelected=!1,t._isWindowResizing=!0,t._applyLeftPosition()},_applyLeftPosition:function(){for(var t,i,o=1;o<=this._totalPages;o++){var n=(t="fitToWidth"==this._fitType||this._isAutoZoom&&this._zoomVal<1?5:90==this._pageSize[o-1].PageRotation||270==this._pageSize[o-1].PageRotation?(this.element.width()-this._pageSize[o-1].PageHeight*this._zoomVal)/2:(this.element.width()-this._pageSize[o-1].PageWidth*this._zoomVal)/2)+this._pageSize[o-1].PageWidth*this._zoomVal,s=e("#"+this._id+"_pageviewContainer").width();(t<0||"fitToPage"==this._fitType&&"Landscape"==this._pageSize[o-1].PageOrientation&&n>s)&&(t=n>s?0:5),(i=document.getElementById(this._id+"pageDiv_"+o))&&(i.style.left=t+"px")}},_toolbarResizeHandler:function(){var t=e("#"+this._id+"_toolbarContainer");e("#"+this._id+"_pdfviewer_printul").parent()[0]!=t[0]?(this._isDownloadCntlHidden||(t.append(e("#"+this._id+"_pdfviewer_printul")[0]),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_downloadul")[0]),this._isDownloadCntlHidden=!0),t.append(e("#"+this._id+"_pdfviewer_searchul")[0]),e("#"+this._id+"_pdfviewer_searchul").css({float:"right"})):e("#"+this._id+"_pdfviewer_printul").parent()[0]==t[0]&&(e("#"+this._id+"_pdfviewer_printul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_printul").css({float:"right"}),e("#"+this._id+"_pdfviewer_searchul").css({float:"right"}),e("#"+this._id+"_pdfviewer_selectul").removeClass("e-separator")),e("#"+this._id+"_pdfviewer_downloadul").parent()[0]!=t[0]?this._isDownloadCntlHidden&&(this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_printul")[0]),this._isDownloadCntlHidden=!1,e("#"+this._id+"_pdfviewer_searchul").css({float:"left"})):e("#"+this._id+"_pdfviewer_downloadul").parent()[0]==t[0]&&(e("#"+this._id+"_pdfviewer_downloadul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_downloadul").css({float:"right"}),t.append(e("#"+this._id+"_pdfviewer_downloadul")[0]),t.append(e("#"+this._id+"_pdfviewer_printul")[0]),t.append(e("#"+this._id+"_pdfviewer_searchul")[0]),e("#"+this._id+"_toolbarContainer_target").addClass("e-display-none"),e("#"+this._id+"_toolbarContainer_target").removeClass("e-display-block")),e("#"+this._id+"_pdfviewer_searchul").parent()[0]!=t[0]&&(this._isSearchHidden||(this._isSearchHidden=!1,t.append(e("#"+this._id+"_pdfviewer_selectul")[0]),t.append(e("#"+this._id+"_pdfviewer_searchul")[0]),e("#"+this._id+"_pdfviewer_searchul").css({float:"left"}),e("#"+this._id+"_pdfviewer_printul").css({float:"left","padding-right":"10px"}),e("#"+this._id+"_pdfviewer_downloadul").css({float:"left"}),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_printul")[0]),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_downloadul")[0]),e("#"+this._id+"_pdfviewer_searchul").addClass("e-separator"),e("#"+this._id+"_pdfviewer_printul").addClass("e-separator"))),e("#"+this._id+"_pdfviewer_selectul").parent()[0]!=t[0]&&(e("#"+this._id+"_pdfviewer_textmarkupul").parent()[0]!=t[0]&&(this._isZoomCntlHidden=!0,this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_zoomul")[0])),this._isSearchHidden=!0,t.append(e("#"+this._id+"_pdfviewer_selectul")[0]),t.append(e("#"+this._id+"_pdfviewer_searchul")[0]),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_textmarkupul")[0]),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_signatureul")[0]),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_printul")[0]),this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_downloadul")[0]),e("#"+this._id+"_pdfviewer_printul").css({float:"left","padding-right":"10px"}),e("#"+this._id+"_pdfviewer_downloadul").css({float:"left"}),e("#"+this._id+"_pdfviewer_searchul").css({float:"left"}),e("#"+this._id+"_pdfviewer_selectul").addClass("e-separator"),e("#"+this._id+"_pdfviewer_printul").addClass("e-separator")),e("#"+this._id+"_pdfviewer_zoomul").parent()[0]==t[0]&&this._isZoomCntlHidden&&(t.append(e("#"+this._id+"_pdfviewer_zoomul")[0]),t.append(e("#"+this._id+"_pdfviewer_textmarkupul")[0]),t.append(e("#"+this._id+"_pdfviewer_signatureul")[0]),t.append(e("#"+this._id+"_pdfviewer_selectul")[0]),t.append(e("#"+this._id+"_pdfviewer_searchul")[0]),e("#"+this._id+"_pdfviewer_printul").css({float:"right","padding-right":"0px"}),e("#"+this._id+"_pdfviewer_downloadul").css({float:"right"}),e("#"+this._id+"_pdfviewer_searchul").css({float:"right","padding-right":"0px"}),e("#"+this._id+"_pdfviewer_printul").removeClass("e-separator"),e("#"+this._id+"_pdfviewer_selectul").removeClass("e-separator"),this._isZoomCntlHidden=!1),this._isToolbarHeightChanged&&(this._toolbar._liTemplte.append(e("#"+this._id+"_pdfviewer_signatureul")[0]),this._isToolbarHeightChanged=!1),e("#"+this._id+"_toolbarContainer_target").hasClass("e-display-block")&&2==e("#"+this._id+"_toolbarContainer_hiddenlist")[0].childElementCount&&(e("#"+this._id+"_pdfviewer_searchul").css({float:"left"}),e("#"+this._id+"_pdfviewer_selectul").addClass("e-separator"))},_overflowToolbarClose:function(){document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1},_resizeSearchToolbar:function(){var t,i,o,n,s,a=document.getElementById(this._id+"_pdfviewer_searchbox");a&&((t=e("#"+this._id+"_toolbarContainer .e-pdfviewer-find")[0])||(t=e("#"+this._id+"_toolbarContainer_hiddenlist .e-pdfviewer-find")[0]),i=t.getBoundingClientRect(),(o=document.getElementById("e-pdfviewer-arrow-responsive"))&&document.head.removeChild(o),e("#"+this._id+"_toolbarContainer_target").hasClass("e-display-block")?(document.getElementById(this._id+"_toolbarContainer"),a.style.left="0px",(s=e("#"+this._id+"_pdfviewer_searchinput")[0]).style.width="150px",a.style.width="400px"):(a.style.left=t.parentNode.parentNode.offsetLeft-t.parentNode.parentNode.parentNode.offsetLeft-2+"px",(s=e("#"+this._id+"_pdfviewer_searchinput")[0]).style.width="150px",a.style.width="400px"),(n=document.getElementById(this._id+"e-pdf-viewer")).clientWidth<a.offsetLeft+a.clientWidth?(s=e("#"+this._id+"_pdfviewer_searchinput")[0],this._isZoomCntlHidden?(s.style.width=parseInt(s.style.width)-(a.offsetLeft+a.clientWidth-n.clientWidth)+"px",a.style.width=parseInt(a.style.width)-(a.offsetLeft+a.clientWidth-n.clientWidth)+"px"):a.style.left=parseInt(a.style.left)-(a.offsetLeft+a.clientWidth-n.clientWidth)+"px"):e("#"+this._id+"_toolbarContainer_target").hasClass("e-display-block")&&(a.style.left=parseInt(a.style.left)-(a.offsetLeft+a.clientWidth-n.clientWidth)+"px"),this._responsiveArrow(i,a))},_responsiveArrow:function(t,i){var o,n,s,a=document.createElement("Style");a.id="e-pdfviewer-arrow-responsive",document.head.appendChild(a),o=a.sheet,!navigator.userAgent.match("Firefox")&&o?(n=i.getBoundingClientRect(),s=t.left-n.left,o.addRule(".e-pdfviewer-arrow::before","left:"+s+"px"),o.addRule(".e-pdfviewer-arrow::after","left:"+s+"px")):e("#"+this._id+"_pdfviewer_searchbox").removeClass("e-pdfviewer-arrow")},_ideviceScrolling:function(){var e;/iPhone|iPad|iPod/i.test(navigator.userAgent)&&((e=document.createElement("Style")).id=this._id+"-pdfviewer-scrolling",document.head.appendChild(e),e.sheet.addRule("#"+this._id+"_viewerContainer","-webkit-overflow-scrolling:touch"))},goToPage:function(e){this._gotoPageNo(e)},goToLastPage:function(){this._gotoLastPage()},goToFirstPage:function(){this._gotoFirstPage()},goToNextPage:function(){this._gotoNextPage()},goToPreviousPage:function(){this._gotoPreviousPage()},print:function(){this._print()},abortPrint:function(){this._printCancel()},abortDownload:function(){this._cancelDownload()},showPrintTools:function(e){this._showPrintButton(e)},showDownloadTool:function(e){this._showDownloadButton(e)},showTextSearchTool:function(e){this._showTextSearchButton(e)},showPageNavigationTools:function(e){this._showPageNavigationControls(e)},showMagnificationTools:function(e){this._showZoomControl(e),this._showFittoPage(e)},showTextMarkupAnnotationTools:function(e){this._showTextMarkupButtons(e)},showSignatureTool:function(e){this._showSignatureButtons(e)},addSignature:function(){this._showSignatureDialog()},showSelectionTool:function(e){this._showSelectionButtons(e)},showToolbar:function(e){this._showToolbar(e)},setJSONData:function(e){null!=e&&""!=e&&(this._responseData=e)},updateViewerSize:function(){this._setViewerContainerHeight()},unload:function(){this._unLoad()},load:function(i){var n,s,a,r,l;if(e("#"+this._id+"_viewerContainer").scrollTop(0),this._showloadingIndicator(!0),this.isDocumentEdited=!1,this._fitType=null,this.model.isResponsive=!0,this.model.enableTextSelection=!0,this._isAutoZoom=!0,e("#"+this._id+"_pageviewContainer").find(".e-waitingpopup").css("visibility",""),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitPage"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_fitWidth"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_zoomin"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_zoomout"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_download"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_search"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_underline"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_signature"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_select"),this._toolbar.enableItemByID(this._id+"_pdfviewer_toolbar_scroll"),document.getElementById(this._id+"_pdfviewer_colorpicker").style.display="none",this._isToolbarColorPicker=!1,this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_highlight"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_underline"),this._toolbar.deselectItemByID(this._id+"_pdfviewer_toolbar_strikeout"),this._isHighlightEnabled=!1,this._isUnderlineEnabled=!1,this._isStrikeOutEnabled=!1,this._isHighlight=!1,this._isUnderline=!1,this._isStrikeout=!1,this._annotationActive=!1,this._isCopyRestrict=!1,this._isPrintRestrict=!1,this._isFormFieldsDisabled=!1,this._zoomVal=1,this._zoomLevel=3,this._pdfFileName==this.fileName&&(this._fileName="",this.fileName=null),this._textlayout=[],this._signatureLayer=[],this._newAnnotationList=[],n=(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.auto.contentText,e("#"+this._id+"_toolbar_zoomSelection_hidden").val(n),this._ejDropDownInstance.model.value=n,this._initToolbar(),i)for(s=this._canvascount;s>=1;)e("#"+this._id+"pageDiv_"+s).remove(),s--;null!=this._ajaxState&&(this._ajaxState.abort(),this._ajaxState=null,this._scrollTriggered=!1),window.clearInterval(this._scrollTimer),(a={}).viewerAction="GetPageModel",a.controlId=this._id,a.pageindex="1",a.isInitialLoading="true",a.zoomValue=this._zoomVal,(r=i.split("base64,")[1])==o?(this._fileName=i,a.newFileName=this._fileName,this._fileId=this._createGUID(),a.id=this._fileId,this._actionUrl=this.model.serviceUrl+"/"+this.model.serverActionSettings.load,this._pdfService==t.PdfViewer.PdfService.Local?this._doAjaxPost("POST",this._actionUrl,JSON.stringify(a),"_getPageModel"):this._doAjaxPost("POST",this.model.serviceUrl,JSON.stringify({jsonResult:a}),"_getPageModel")):(l=this.model.serviceUrl,a.uploadedFile=r,this._fileId=this._createGUID(),a.id=this._fileId,this._pdfService==t.PdfViewer.PdfService.Local?(l=this.model.serviceUrl+"/"+this.model.serverActionSettings.fileUpload,this._doAjaxPost("POST",l,JSON.stringify(a),"_getPageModel")):(l=l.replace(this.model.serverActionSettings.load,this.model.serverActionSettings.fileUpload),this._doAjaxPost("POST",l,JSON.stringify({jsonResult:a}),"_getPageModel")))},searchText:function(e){this._searchText=e,this._displaySearch=!0,this._isFindboxPresent=!0,this._textSearch()},searchNext:function(){this._nextSearch()},searchPrevious:function(){this._prevSearch()},matchCase:function(e){this._isMatchCase=!!e,this._textSearch()},cancelSearchText:function(){this._searchText="",this._displaySearch=!1,this._isFindboxPresent=!1,this._clearAllOccurrences()},fitToPage:function(){this._applyFitToPage()},fitToWidth:function(){this._applyFitToWidth()},download:function(e){this._isAsynchronousDownload="boolean"!=typeof e||e,this._saveFormFieldsValue()},zoomIn:function(){this._applyLowerZoomIndex(),this._zoomIn()},zoomOut:function(){this._applyHigherZoomIndex(),this._zoomOut()},zoomTo:function(i){i<50?i=50:i>400&&(i=400);var o=parseInt(i)/100;i==(t.PdfViewer.Locale[this.model.locale]?t.PdfViewer.Locale[this.model.locale]:t.PdfViewer.Locale.default).contextMenu.auto.contentText?(o=1,this.model.isResponsive=!0,this._isAutoZoom=!0):(i+="%",this.model.isResponsive=!1,this._isAutoZoom=!1),this._calculateZoomLevel(o),this._zoomContainer(o,!1),e("#"+this._id+"_toolbar_zoomSelection_hidden").val(i),this._ejDropDownInstance.model.selectedIndices[0]="",e("#"+this._id+"_toolbar_zoomSelection_popup li").removeClass("e-active"),this._ejDropDownInstance.model.value=i},undo:function(){this._isPropertiesWindowOpen||this._undo()},redo:function(){this._isPropertiesWindowOpen||this._redo()},addAnnotation:function(e){e==t.PdfViewer.AnnotationType.Highlight?this._addAnnotation("Highlight"):e==t.PdfViewer.AnnotationType.Underline?this._addAnnotation("Underline"):e==t.PdfViewer.AnnotationType.Strikethrough&&this._addAnnotation("StrikeOut")}}),t.PdfViewer.ToolbarItems={MagnificationTools:1,PageNavigationTools:2,PrintTools:4,DownloadTool:8,TextSearchTool:16,TextMarkupAnnotationTools:32,SignatureTool:64,SelectionTool:128,All:255},t.PdfViewer.PdfService={Local:1,Remote:2},t.PdfViewer.LinkTarget={Default:1,NewTab:2,NewWindow:4},t.PdfViewer.AnnotationType={Underline:1,Strikethrough:2,Highlight:4},t.PdfViewer.InteractionMode={TextSelection:1,Pan:2},t.PdfViewer.BufferingMode={Default:1,Complete:2},t.PdfViewer.Locale=t.PdfViewer.Locale||{},t.PdfViewer.Locale.default=t.PdfViewer.Locale["en-US"]={toolbar:{print:{headerText:"Print",contentText:"Print the PDF document."},download:{headerText:"Download",contentText:"Download the PDF document."},first:{headerText:"First",contentText:"Go to the first page of the PDF document."},previous:{headerText:"Previous",contentText:"Go to the previous page of the PDF document."},next:{headerText:"Next",contentText:"Go to the next page of the PDF document."},last:{headerText:"Last",contentText:"Go to the last page of the PDF document."},zoomIn:{headerText:"Zoom-In",contentText:"Zoom in to the PDF document."},zoomOut:{headerText:"Zoom-Out",contentText:"Zoom out of the PDF document."},pageIndex:{headerText:"Page Number",contentText:"Current page number to view."},zoom:{headerText:"Zoom",contentText:"Zoom in or out on the PDF document."},fitToWidth:{headerText:"Fit to Width",contentText:"Fit the PDF page to the width of the container."},fitToPage:{headerText:"Fit to Page",contentText:"Fit the PDF page to the container."},search:{headerText:"Search Text",contentText:"Search text in the PDF pages."},highlight:{headerText:"Highlight Text",contentText:"Highlight text in the PDF pages."},strikeout:{headerText:"Strikethrough Text",contentText:"Strikethrough text in the PDF pages."},underline:{headerText:"Underline Text",contentText:"Underline text in the PDF pages."},signature:{headerText:"Signature",contentText:"Add or create hand-written signature."},select:{headerText:"Selection",contentText:"Selection tool for text."},scroll:{headerText:"Panning",contentText:"Click to pan around the document"}},contextMenu:{copy:{contentText:"Copy"},googleSearch:{contentText:"Search google"},openPopup:{contentText:"Open Pop-Up Note"},Delete:{contentText:"Delete"},properties:{contentText:"Properties...."},Find:{contentText:"Find:"},matchCase:{contentText:"Match Case"},auto:{contentText:"Auto"}},propertyWindow:{underlineProperties:{contentText:"Underline Properties"},strikeOutProperties:{contentText:"StrikeOut Properties"},highlightProperties:{contentText:"Highlight Properties"},signatureProperties:{contentText:"Signature Properties"},appearance:{contentText:"Appearance"},general:{contentText:"General"},color:{contentText:"Color:"},opacity:{contentText:"Opacity:"},author:{contentText:"Author:"},subject:{contentText:"Subject:"},modified:{contentText:"Modified:"},ok:{contentText:"OK"},cancel:{contentText:"Cancel"},locked:{contentText:"Locked"}},signatureWindow:{Signature:{contentText:"Add Signature"},Add:{contentText:"Add"},clear:{contentText:"Clear"}},waitingPopup:{print:{contentText:"Preparing document for printing..."}}}}(jQuery,Syncfusion)})},445:function(e,t,i){"use strict";var o=this&&this.__decorate||function(e,t,i,o){var n,s=arguments.length,a=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,o);else for(var r=e.length-1;r>=0;r--)(n=e[r])&&(a=(s<3?n(a):s>3?n(t,i,a):n(t,i))||a);return s>3&&a&&Object.defineProperty(t,i,a),a};Object.defineProperty(t,"__esModule",{value:!0});var n=i(5),s=i(78),a=i(64),r=i(1496),l=i(1330),d=i(1331);t.pdfviewerAppRoutes=[{path:"default",component:l.DefaultComponent,data:{name:"Default",location:"app/components/pdfviewer/default.component"}},{path:"localization",component:d.LocalizationComponent,data:{name:"Localization",location:"app/components/pdfviewer/localization.component"}},{path:"",redirectTo:"default"}],t.PdfViewerRouting=s.RouterModule.forChild(t.pdfviewerAppRoutes);var h=function(){function e(){}return e=o([n.NgModule({imports:[t.PdfViewerRouting,a.FormsModule],declarations:[l.DefaultComponent,r.EJ_PDFVIEWER_COMPONENTS,d.LocalizationComponent]})],e)}();t.PdfViewerModule=h}});